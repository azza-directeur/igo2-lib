(self.webpackChunk_igo_demo=self.webpackChunk_igo_demo||[]).push([[179],{98255:function(e){function t(e){return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}t.keys=function(){return[]},t.resolve=t,t.id=98255,e.exports=t},36438:function(e,t,o){var i={"./en.auth.json":50257,"./en.common.json":35488,"./en.context.json":88952,"./en.core.json":63154,"./en.geo.json":10711,"./en.integration.json":32766,"./en.json":10503,"./fr.auth.json":8555,"./fr.common.json":20551,"./fr.context.json":68079,"./fr.core.json":5415,"./fr.geo.json":27268,"./fr.integration.json":63031,"./fr.json":65962};function r(e){var t=s(e);return o(t)}function s(e){if(!o.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}r.keys=function(){return Object.keys(i)},r.resolve=s,e.exports=r,r.id=36438},88214:function(e,t,o){"use strict";var i=o(4919),r=o(91477),s=o(99613),n=o(45159),a=o(3323),l=o(43635),c=o(80902),u=o(63266),p=o(30620),d=o(3259),h=o(40093),g=o(74354),m=o(73393),f=o(87227),y=o(34301),v=o(71435),b=o(18293),x=o(33927),w=o(80639),S=o(1143),C=o(76491),T=o(45871),A=o(81134),Z=o(79097),L=o(82516),F=o(13492),O=o(79441),M=o(83720);let I=(()=>{class e{static getByte(e,t){return e.charCodeAt(t)}static getByte64(e,t){return this.ALPHA.indexOf(e.charAt(t))}static decode(e){let t,o,i=0,r=e.length,s=[];if(e=String(e),0===r)return e;for(e.charAt(r-1)===this.PADCHAR&&(i=1,e.charAt(r-2)===this.PADCHAR&&(i=2),r-=4),t=0;t<r;t+=4)o=this.getByte64(e,t)<<18|this.getByte64(e,t+1)<<12|this.getByte64(e,t+2)<<6|this.getByte64(e,t+3),s.push(String.fromCharCode(o>>16,o>>8&255,255&o));switch(i){case 1:o=this.getByte64(e,t)<<18|this.getByte64(e,t+1)<<12|this.getByte64(e,t+2)<<6,s.push(String.fromCharCode(o>>16,o>>8&255));break;case 2:o=this.getByte64(e,t)<<18|this.getByte64(e,t+1)<<12,s.push(String.fromCharCode(o>>16))}return s.join("")}static encode(e){let t,o,i=[],r=(e=String(e)).length-e.length%3;if(0===e.length)return e;for(t=0;t<r;t+=3)o=this.getByte(e,t)<<16|this.getByte(e,t+1)<<8|this.getByte(e,t+2),i.push(this.ALPHA.charAt(o>>18)),i.push(this.ALPHA.charAt(o>>12&63)),i.push(this.ALPHA.charAt(o>>6&63)),i.push(this.ALPHA.charAt(63&o));switch(e.length-r){case 1:o=this.getByte(e,t)<<16,i.push(this.ALPHA.charAt(o>>18)+this.ALPHA.charAt(o>>12&63)+this.PADCHAR+this.PADCHAR);break;case 2:o=this.getByte(e,t)<<16|this.getByte(e,t+1)<<8,i.push(this.ALPHA.charAt(o>>18)+this.ALPHA.charAt(o>>12&63)+this.ALPHA.charAt(o>>6&63)+this.PADCHAR)}return i.join("")}}return e.PADCHAR="=",e.ALPHA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e})();const k=F.getParser(window.navigator.userAgent);class P{static copy(e){let t=!1;if("string"==typeof e){const o=P.createTextArea(e);P.selectText(o),t=P.copyTextToClipboard(),P.destroyTextArea(o)}else P.selectText(e),t=P.copyTextToClipboard();return t}static createTextArea(e){const t=document.createElement("textArea");return t.value=e,document.body.appendChild(t),t}static destroyTextArea(e){document.body.removeChild(e)}static selectText(e){if("iOS"===k.getOSName()){const t=e.contentEditable,o=e.readOnly,i=document.createRange(),r=window.getSelection();e.contenteditable=!0,e.readonly=!1,i.selectNodeContents(e),r.removeAllRanges(),r.addRange(i),e.setSelectionRange(0,999999),e.contentEditable=t,e.readOnly=o}else e.select()}static copyTextToClipboard(){return("iOS"!==k.getOSName()||!k.compareVersion("<10"))&&document.execCommand("copy")}}class _{static resolve(e,t){const o=t.replace(/\[/g,".").replace(/\]/g,"").split(".");let i=e;for(;o.length;){if("object"!=typeof i)return;i=i[o.shift()]}return i}static isObject(e){return e&&"object"==typeof e&&!Array.isArray(e)&&null!==e&&!(e instanceof Date)}static mergeDeep(e,t,o=!1){const i=Object.assign({},e);return _.isObject(e)&&_.isObject(t)&&Object.keys(t).filter(e=>!o||void 0!==t[e]).forEach(r=>{_.isObject(t[r])?r in e?i[r]=_.mergeDeep(e[r],t[r],o):Object.assign(i,{[r]:t[r]}):Object.assign(i,{[r]:t[r]})}),i}static copyDeep(e){const t=Array.isArray(e)?[]:{};for(const o in e)if(e.hasOwnProperty(o)){const i=e[o];t[o]=i&&"object"==typeof i?this.copyDeep(i):i}return t}static removeDuplicateCaseInsensitive(e){const t={},o={},i=[];for(const r in e)if(e.hasOwnProperty(r)){const o=r.toUpperCase();t.hasOwnProperty(o)?t[o].push({[r]:e[r]}):t[o]=[{[r]:e[r]}],i.push({key:r,count:r.replace(/[^A-Z]/g,"").length})}for(const r in t)if(t.hasOwnProperty(r)&&t.hasOwnProperty(r)){const s=t[r];if(1===s.length){const e=s[0];o[r]=e[Object.keys(e)[0]]}else if(s.length>1){const t=i.filter(e=>e.key.toLowerCase()===r.toLowerCase()).reduce((e,t)=>e.y<t.y?e:t);o[t.key.toUpperCase()]=e[t.key]}}for(const r in e)e.hasOwnProperty(r)&&delete e[r];for(const r in o)o.hasOwnProperty(r)&&(e[r]=o[r])}static removeUndefined(e){const t={};return _.isObject(e)?(Object.keys(e).filter(t=>void 0!==e[t]).forEach(o=>{t[o]=_.isObject(e[o])||Array.isArray(e[o])?_.removeUndefined(e[o]):e[o]}),t):Array.isArray(e)?e.map(e=>_.removeUndefined(e)):e}static removeNull(e){const t={};return _.isObject(e)?(Object.keys(e).filter(t=>null!==e[t]).forEach(o=>{t[o]=_.isObject(e[o])||Array.isArray(e[o])?_.removeNull(e[o]):e[o]}),t):Array.isArray(e)?e.map(e=>_.removeNull(e)):e}static naturalCompare(e,t,o="asc",i){if("desc"===o&&(t=[e,e=t][0]),null===e||""===e||void 0===e||null===t||""===t||void 0===t){const r=e===t?0:void 0===e?3:void 0===t?-3:null===e?2:null===t?-2:""===e?1:-1;return"desc"===o?!1!==i?r:-1*r:!0===i?-1*r:r}const r=[],s=[];for(t=""+t,(e=""+e).replace(/(\d+)|(\D+)/g,(e,t,o)=>{r.push([t||1/0,o||""])}),t.replace(/(\d+)|(\D+)/g,(e,t,o)=>{s.push([t||1/0,o||""])});r.length&&s.length;){const e=r.shift(),t=s.shift(),o=e[0]-t[0]||e[1].localeCompare(t[1]);if(o)return o}return r.length-s.length}static objectsAreEquivalent(e,t){if(e===t)return!0;const o=Object.getOwnPropertyNames(e),i=Object.getOwnPropertyNames(t);if(o.length!==i.length)return!1;for(const r of o)if(e[r]!==t[r])return!1;return!0}static removeKeys(e,t){return Object.keys(e).filter(e=>t.indexOf(e)<0).reduce((t,o)=>(t[o]=e[o],t),{})}}function $(e){return e.reduce((e,t)=>(e[t]=t,e),Object.create(null))}function q(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function D(){return`${q()}${q()}-${q()}-${q()}-${q()}-${q()}${q()}${q()}`.toLowerCase()}var E=(()=>{return(e=E||(E={}))[e.Error=0]="Error",e[e.Done=1]="Done",e[e.Working=2]="Working",e[e.Waiting=3]="Waiting",E;var e})();class R{constructor(){this.status$=new O.xQ}get status(){return this._status}set status(e){this._status=e,this.status$.next(e)}subscribe(e,t){this.watch(),this.status$$=this.status$.pipe((0,M.x)()).subscribe(o=>{this.handleStatusChange(o),e.call(t,this)})}unsubscribe(){this.unwatch(),void 0!==this.status$$&&(this.status$$.unsubscribe(),this.status$$=void 0),this.status=E.Waiting}handleStatusChange(e){}}var U=o(13828),N=o(14994),J=o(13216);let B=(()=>{class e{constructor(){this.counter$=new C.X(0),this.ids=[]}register(){const e=D();return this.ids.push(e),this.counter$.next(this.ids.length),e}unregister(e){const t=this.ids.indexOf(e);-1!==t&&(this.ids.splice(t,1),this.counter$.next(this.ids.length))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),j=(()=>{class e{constructor(e){this.activityService=e}intercept(e,t){const o=e.headers.get("activityInterceptor");if(o){const i=e.clone({headers:e.headers.delete("activityInterceptor")});if("false"===o)return t.handle(i)}const i=this.activityService.register();return t.handle(e).pipe((0,v.x)(()=>{this.activityService.unregister(i)}))}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(B))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})(),G=(()=>{class e{static forRoot(){return{ngModule:e,providers:[{provide:y.TP,useClass:j,multi:!0}]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[]]}),e})();const Q={lib:"1.9.0",releaseDate:1632149524409};let z=(()=>{class e{constructor(e){this.injector=e,this.config={}}getConfig(e){return _.resolve(this.config,e)}load(e){const t=e.default||{};if(!e.path)return this.config=t,!0;const o=this.injector.get(y.eN);return new Promise((i,r)=>{o.get(e.path).pipe((0,b.K)(t=>(console.log(`Configuration file ${e.path} could not be read`),i(!0),(0,T._)(t.error||"Server error")))).subscribe(e=>{this.config=_.mergeDeep(_.mergeDeep({version:Q},t),e),i(!0)})})}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(r.zs3))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Y=new r.OlP("configOptions");function H(e){return{provide:Y,useValue:e}}function V(e,t){return()=>e.load(t)}let W=(()=>{class e{static forRoot(){return{ngModule:e,providers:[H({}),{provide:r.ip1,useFactory:V,multi:!0,deps:[z,Y]}]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[]]}),e})();class X{constructor(e,t,o=".json",i){this.http=e,this.prefix=t,this.suffix=o,this.config=i}getTranslation(e){const t=o(36438)(`./${e}.json`),i=(0,A.of)(t);if(this.config&&!this.prefix){const e=this.config.getConfig("language.prefix");this.prefix=!e||Array.isArray(e)?e:[e]}if(!this.prefix||0===this.prefix.length)return i;const r=this.prefix.map(t=>this.http.get(`${t}${e}${this.suffix}`));return(0,Z.aj)([i,...r]).pipe((0,x.U)(e=>e.reduce((e,t)=>_.mergeDeep(e,t),{})))}}function K(e,t){return new X(e,void 0,void 0,t)}function ee(e){return{provide:U.Zw,useFactory:e||K,deps:[y.eN,z]}}class te{handle(e){if(!e.translateService.langs.length)throw new Error("Translations are not yet loaded.          Check that the LanguageService is injected.");if("igo."===e.key.substr(0,4))throw new Error(`The Key "${e.key}" is missing in locale file.`);return e.key}}let oe=(()=>{class e{static forRoot(){return{ngModule:e,providers:[ee()]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[U.aw.forRoot({missingTranslationHandler:{provide:U.gC,useClass:te}})],U.aw]}),e})();const ie=function(e){return{closeIcon:e}};let re=(()=>{class e{constructor(){this._options={}}get options(){return Object.assign({},e.defaultOptions,this._options)}set options(e){this._options=e}}return e.defaultOptions={timeOut:5e3,hasCloseIcon:!1,showProgressBar:!0,pauseOnHover:!0,clickToClose:!0,maxLength:100,maxStack:3,preventDuplicates:!0},e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-message-center"]],inputs:{options:"options"},decls:1,vars:4,consts:[[1,"mat-typography",3,"ngClass","options"]],template:function(e,t){1&e&&r._UZ(0,"simple-notifications",0),2&e&&r.Q6J("ngClass",r.VKq(2,ie,t.options.hasCloseIcon))("options",t.options)},directives:[N.F0,h.mk],styles:['[_nghost-%COMP%]     div.simple-notification-wrapper{bottom:0;right:calc(50% - 150px)}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){[_nghost-%COMP%]     div.simple-notification-wrapper{right:0;left:0;width:100%}}[_nghost-%COMP%]     .closeIcon   .sn-title:after{content:"close";font-family:"Material Icons";font-feature-settings:"liga" 1;font-size:24px;font-weight:normal;right:5px;top:5px;position:absolute}[_nghost-%COMP%]     .simple-notification .icon{top:0;left:0;width:45px;height:45px;height:100%;padding:7px}[_nghost-%COMP%]     .simple-notification .icon mat-icon{display:flex;align-items:center;height:100%;font-size:32px}[_nghost-%COMP%]     div.simple-notification{min-height:50px;margin-bottom:5px;padding-left:45px;padding-right:25px}[_nghost-%COMP%]     div.simple-notification.noIcon{padding-left:25px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){[_nghost-%COMP%]     div.simple-notification{margin-bottom:0}}[_nghost-%COMP%]     div.simple-notification .sn-title{line-height:23px;font-size:15px;font-weight:bold}[_nghost-%COMP%]     div.simple-notification .sn-content{line-height:18px;font-size:15px}']}),e})(),se=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,N.CT.forRoot()]]}),e})(),ne=(()=>{class e{constructor(e){this.translate=e,this.language=this.translate.getBrowserLang();const t=this.getLanguage();this.translate.setDefaultLang(t)}getLanguage(){return this.language.match(/en|fr/)?this.language:"en"}setLanguage(e){this.language=e.match(/en|fr/)?e:"en",this.translate.use(this.language),this.translate.reloadLang(this.language)}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(U.sK))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var ae=(()=>{return(e=ae||(ae={})).ERROR="error",e.ALERT="alert",e.INFO="info",e.SUCCESS="success",ae;var e})();let le=(()=>{class e{constructor(e,t){this.notificationService=e,this.configService=t,this.messages$=new C.X([]),this.options=this.configService.getConfig("message")||{}}showError(e){return e.error.caught=!0,this.error(e.error.message,e.error.title)}message(e){this.messages$.next(this.messages$.value.concat([e])),e.options=e.options||{};const t=new Date;if(e.options.from=e.options.from?e.options.from:new Date("1 jan 1900"),e.options.to=e.options.to?e.options.to:new Date("1 jan 3000"),"string"==typeof e.options.from&&(e.options.from=new Date(Date.parse(e.options.from.replace(/-/g," ")))),"string"==typeof e.options.to&&(e.options.to=new Date(Date.parse(e.options.to.replace(/-/g," ")))),t>e.options.from&&t<e.options.to){let t;if((e=this.handleTemplate(e)).text)t=this.notificationService.create(e.title,e.text,e.type,e.options);else{if(!e.html)return;e.icon||(e.options.theClass=e.options.theClass?e.options.theClass+" noIcon":"noIcon"),t=this.notificationService.html(e.html,e.type,e.options)}return void 0!==e.icon&&this.addIcon(t,e.icon),e.options.id=t.id,t}}success(e,t,o={}){return this.message({text:e,title:t,icon:o.icon||"check",options:o,type:ae.SUCCESS})}error(e,t,o={}){return this.message({text:e,title:t,icon:o.icon||"error_outline",options:o,type:ae.ERROR})}info(e,t,o={}){return this.message({text:e,title:t,icon:o.icon||"info_outline",options:o,type:ae.INFO})}alert(e,t,o={}){return this.message({text:e,title:t,icon:o.icon||"access_alarm",options:o,type:ae.ALERT})}remove(e){this.notificationService.remove(e)}removeAllAreNotError(){for(const e of this.messages$.value)"error"!==e.type&&this.remove(e.options.id)}addIcon(e,t){e.icon=`\n      <mat-icon class="material-icons mat-icon mat-list-avatar" svgIcon="${t}">\n      </mat-icon>`}handleTemplate(e){if(!this.options.template||e.html)return e;let t=this.options.template;return t=t.replace("${text}",e.text),t=t.replace("${title}",e.title),t=t.replace("${icon}",e.icon),e.html=t,e.text=void 0,e.title=void 0,e.icon=void 0,e}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(N.TF),r.LFG(z))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),ce=(()=>{class e{constructor(e,t){this.messageService=e,this.injector=t}intercept(e,t){const o={httpError:void 0};return t.handle(e).pipe((0,b.K)(e=>this.handleError(e,o)),(0,v.x)(()=>{this.handleCaughtError(o),this.handleUncaughtError(o)}))}handleError(e,t){if(e instanceof y.UA){const t="object"===e.error?e.error:{};t.message=e.error.message||e.statusText,t.caught=!1,e=new y.UA({error:t,headers:e.headers,status:e.status,statusText:e.statusText,url:e.url})}return t.httpError=e,(0,T._)(e)}handleCaughtError(e){const t=e.httpError;t&&t.error.toDisplay&&(t.error.caught=!0,this.messageService.error(t.error.message,t.error.title))}handleUncaughtError(e){const t=e.httpError;if(t&&!t.error.caught){const e=this.injector.get(ne).translate,o=e.instant("igo.core.errors.uncaught.message"),i=e.instant("igo.core.errors.uncaught.title");t.error.caught=!0,this.messageService.error(o,i)}}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(le),r.LFG(r.zs3))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),ue=(()=>{class e{constructor(e){if(e)throw new Error("IgoErrorModule is already loaded. Import it in the AppModule only")}static forRoot(){return{ngModule:e,providers:[{provide:y.TP,useClass:ce,multi:!0}]}}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(e,12))},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[]]}),e})(),pe=new r.OlP("routeServiceOptions"),de=(()=>{class e{constructor(e,t){this.route=e,this.options=Object.assign({},{centerKey:"center",zoomKey:"zoom",projectionKey:"projection",contextKey:"context",searchKey:"search",visibleOnLayersKey:"visiblelayers",visibleOffLayersKey:"invisiblelayers",directionsCoordKey:"routing",toolKey:"tool",wmsUrlKey:"wmsUrl",wmsLayersKey:"wmsLayers",wmtsUrlKey:"wmtsUrl",wmtsLayersKey:"wmtsLayers",arcgisUrlKey:"arcgisUrl",arcgisLayersKey:"arcgisLayers",iarcgisUrlKey:"iarcgisUrl",iarcgisLayersKey:"iarcgisLayers",tarcgisUrlKey:"tarcgisUrl",tarcgisLayersKey:"tarcgisLayers",vectorKey:"vector"},t)}get queryParams(){return this.route.queryParams}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(d.gz),r.LFG(pe,8))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var he=(()=>{return(e=he||(he={})).Mobile="mobile",e.Tablet="tablet",e.Desktop="desktop",he;var e})(),ge=(()=>{return(e=ge||(ge={})).Portrait="portrait",e.Landscape="landscape",ge;var e})();let me=(()=>{class e{constructor(e){this.media$=new C.X(void 0),this.orientation$=new C.X(void 0),e.observe([J.u3.HandsetLandscape]).subscribe(e=>{e.matches&&(this.media$.next(he.Mobile),this.orientation$.next(ge.Landscape))}),e.observe([J.u3.HandsetPortrait]).subscribe(e=>{e.matches&&(this.media$.next(he.Mobile),this.orientation$.next(ge.Portrait))}),e.observe([J.u3.TabletLandscape]).subscribe(e=>{e.matches&&(this.media$.next(he.Tablet),this.orientation$.next(ge.Landscape))}),e.observe([J.u3.TabletPortrait]).subscribe(e=>{e.matches&&(this.media$.next(he.Tablet),this.orientation$.next(ge.Portrait))}),e.observe([J.u3.WebLandscape]).subscribe(e=>{e.matches&&(this.media$.next(he.Desktop),this.orientation$.next(ge.Landscape))}),e.observe([J.u3.WebPortrait]).subscribe(e=>{e.matches&&(this.media$.next(he.Desktop),this.orientation$.next(ge.Portrait))})}getMedia(){return this.media$.value}getOrientation(){return this.orientation$.value}isTouchScreen(){return"ontouchstart"in document.documentElement}isMobile(){return"mobile"===this.getMedia()}isDesktop(){return"desktop"===this.getMedia()}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(J.Yg))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var fe=(()=>{return(e=fe||(fe={})).SESSION="Session",e.LOCAL="Local",fe;var e})(),ye=(()=>{return(e=ye||(ye={})).ADDED="Added",e.MODIFIED="Modified",e.REMOVED="Removed",e.CLEARED="Cleared",ye;var e})();let ve=(()=>{class e{constructor(e){this.config=e,this.storageChange$=new C.X(void 0),this.options=this.config.getConfig("storage")||{key:"igo"}}get(e,t){let o;if((!t||t===fe.SESSION)&&(o=sessionStorage.getItem(`${this.options.key}.${e}`)),(t===fe.LOCAL||!o&&!t)&&(o=localStorage.getItem(`${this.options.key}.${e}`)),o)try{o=JSON.parse(o)}catch(i){o=o}return o}set(e,t,o=fe.LOCAL){const i=this.get(e,o);o===fe.SESSION?sessionStorage.setItem(`${this.options.key}.${e}`,JSON.stringify(t)):localStorage.setItem(`${this.options.key}.${e}`,JSON.stringify(t));const r=this.get(e,o);r!==i&&this.storageChange$.next({key:e,scope:o,event:void 0!==i?ye.MODIFIED:ye.ADDED,previousValue:i,currentValue:r})}remove(e,t=fe.LOCAL){const o=this.get(e,t);t===fe.SESSION?sessionStorage.removeItem(`${this.options.key}.${e}`):localStorage.removeItem(`${this.options.key}.${e}`),this.storageChange$.next({key:e,scope:t,event:ye.REMOVED,previousValue:o})}clear(e=fe.LOCAL){e===fe.SESSION?sessionStorage.clear():localStorage.clear(),this.storageChange$.next({scope:e,event:ye.CLEARED})}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(z))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),be=(()=>{class e{constructor(e,t){this.messageService=e,this.injector=t,this.stateChangeEventEmitter=new r.vpe,this.state={connection:window.navigator.onLine},this.checkNetworkState()}checkNetworkState(){this.onlineSubscription=(0,L.R)(window,"online").subscribe(()=>{const e=this.injector.get(ne).translate,t=e.instant("igo.core.network.online.message"),o=e.instant("igo.core.network.online.title");this.messageService.info(t,o),this.state.connection=!0,this.emitEvent()}),this.offlineSubscription=(0,L.R)(window,"offline").subscribe(()=>{const e=this.injector.get(ne).translate,t=e.instant("igo.core.network.offline.message"),o=e.instant("igo.core.network.offline.title");this.messageService.info(t,o),this.state.connection=!1,this.emitEvent()})}emitEvent(){this.stateChangeEventEmitter.emit(this.state)}ngOnDestroy(){try{this.offlineSubscription.unsubscribe(),this.onlineSubscription.unsubscribe()}catch(e){}}currentState(e=!0){return e?this.stateChangeEventEmitter.pipe((0,w.b)(300),(0,S.O)(this.state)):this.stateChangeEventEmitter.pipe((0,w.b)(300))}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(le),r.LFG(r.zs3))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var xe=o(24411),we=o(84224),Se=o(89544),Ce=o(64674),Te=o(89919),Ae=o(84515),Ze=o(79902),Le=o(14921),Fe=o(85816),Oe=o(65318),Me=o(22663),Ie=o(9170),ke=o(53466),Pe=o(63176),_e=o(77820),$e=o(66360),qe=o(33579),De=o(40062),Ee=o(836),Re=o(9636),Ue=o(3786),Ne=o(94757),Je=o(22297),Be=o(72012),je=o(18931),Ge=o(16529),Qe=o(74813),ze=o(59298),Ye=o(87013),He=o(91039),Ve=o(14613),We=o(80198),Xe=o(82458),Ke=(()=>{return(e=Ke||(Ke={})).Default="Default",e.HTML="HTML",e.UnsanitizedHTML="UnsanitizedHTML",e.Icon="Icon",e.ButtonGroup="ButtonGroup",Ke;var e})(),et=(()=>{return(e=et||(et={})).Auto="auto",e.Instant="instant",e.Smooth="smooth",et;var e})(),tt=(()=>{return(e=tt||(tt={})).None="None",e.All="All",e.Some="Some",tt;var e})();function ot(e,t){return(0,xe.ZP)(e,t).safeObject}function it(e){const t=e.meta||{};return t.id?t.id:ot(e,t.idProperty||"id")}function rt(e){const t=e.meta||{};return t.title?t.title:ot(e,t.titleProperty||"title")}function st(e){const t=e.meta||{};return t.icon?t.icon:ot(e,t.iconProperty||"icon")}class nt{constructor(e={}){this.index=new Map,this.change$=new we.t(1),this.store=e.store?e.store:void 0,this.getKey=e.getKey?e.getKey:this.store?this.store.getKey:it,this.next()}clear(){this.index.size>0&&(this.index.clear(),this.next())}get(e){return this.index.get(this.getKey(e))||{}}set(e,t){this.setMany([e],t)}setMany(e,t){e.forEach(e=>{this.index.set(this.getKey(e),Object.assign({},t))}),this.next()}setAll(e){Array.from(this.index.keys()).forEach(t=>{this.index.set(t,Object.assign({},e))}),this.next()}update(e,t,o=!1){this.updateMany([e],t,o)}updateMany(e,t,o=!1){if(!0===o)return this.updateManyExclusive(e,t);e.forEach(e=>{const o=Object.assign({},this.get(e),t);this.index.set(this.getKey(e),o)}),this.next()}reverse(e,t){this.reverseMany([e],t)}reverseMany(e,t){e.forEach(e=>{const o=this.get(e),i=t.reduce((e,t)=>(e[t]=o[t]||!1,e),{}),r=this.reverseChanges(i),s=Object.assign({},o,r);this.index.set(this.getKey(e),s)}),this.next()}updateAll(e){const t=this.getAllKeys();Array.from(t).forEach(t=>{const o=Object.assign({},this.index.get(t),e);this.index.set(t,o)}),this.next()}updateManyExclusive(e,t){const o=this.reverseChanges(t),i=e.map(e=>this.getKey(e));new Set(i.concat(Array.from(this.getAllKeys()))).forEach(e=>{const r=this.index.get(e)||{};i.indexOf(e)>=0?this.index.set(e,Object.assign({},r,t)):!0===Object.keys(o).some(e=>void 0!==r[e]&&r[e]!==o[e])&&this.index.set(e,Object.assign({},r,o))}),this.next()}reverseChanges(e){return Object.entries(e).reduce((e,t)=>{const[o,i]=t;return"boolean"==typeof i&&(e[o]=!i),e},{})}getAllKeys(){const e=this.store?Array.from(this.store.index.keys()):[];return new Set(Array.from(this.index.keys()).concat(e))}next(){this.change$.next()}}class at{constructor(e){this.source$=e,this.values$=new C.X([]),this.lifted=!1,this.joins=[],this.filter$=new C.X(void 0),this.filters$=new C.X([]),this.filterIndex=new Map,this.sort$=new C.X(void 0),this.getKey$=new C.X(void 0),this.count$=new C.X(0),this.empty$=new C.X(!0)}get getKey(){return this.getKey$.value}get count(){return this.count$.value}get empty(){return this.empty$.value}get index(){return this._index}get(e){if(void 0===this._index)throw new Error("This view has no index, therefore, this method is unavailable.");return this.index.get(e)}all(){return this.values$.value}all$(){return this.values$}firstBy(e){return this.values$.value.find(e)}firstBy$(e){return this.values$.pipe((0,x.U)(t=>t.find(e)))}manyBy(e){return this.values$.value.filter(e)}manyBy$(e){return this.values$.pipe((0,x.U)(t=>t.filter(e)))}clear(){this.filter(void 0),this.sort(void 0)}destroy(){void 0!==this.values$$&&this.values$$.unsubscribe(),this.clear()}createIndex(e){return this._index=new Map,this.getKey$.next(e),this}join(e){if(!0===this.lifted)throw new Error("This view has already been lifted, therefore, no join is allowed.");return this.joins.push(e),this}filter(e){return this.filter$.next(e),this}addFilter(e){const t=D();return this.filterIndex.set(t,e),this.filters$.next(Array.from(this.filterIndex.values())),t}removeFilter(e){this.filterIndex.delete(e),this.filters$.next(Array.from(this.filterIndex.values()))}sort(e){return this.sort$.next(e),this}lift(){this.lifted=!0;const e=[this.joins.length>0?this.liftJoinedSource():this.liftSource(),this.filters$,this.filter$,this.sort$,this.getKey$];this.values$$=(0,Z.aj)(e).pipe((0,Ae.T)(1),(0,w.b)(5)).subscribe(e=>{const[t,o,i,r,s]=e,n=this.processValues(t,o,i,r);this.setValues(n,void 0!==s)})}liftSource(){return this.source$}liftJoinedSource(){const e=[this.source$,(0,Z.aj)(this.joins.map(e=>e.source))];return(0,Z.aj)(e).pipe((0,x.U)(e=>{const[t,o]=e;return t.reduce((e,t)=>{const i=this.computeJoinedValue(t,o);return void 0!==i&&e.push(i),e},[])}))}computeJoinedValue(e,t){let o=e,i=0;for(;void 0!==o&&i<this.joins.length;)o=this.joins[i].reduce(o,t[i]),i+=1;return o}processValues(e,t,o,i){return e=e.slice(0),e=this.filterValues(e,t.concat([o])),this.sortValues(e,i)}filterValues(e,t){return 0===t.length?e:e.filter(e=>t.filter(e=>void 0!==e).every(t=>t(e)))}sortValues(e,t){return void 0===t?e:e.sort((e,o)=>_.naturalCompare(t.valueAccessor(e),t.valueAccessor(o),t.direction,t.nullsFirst))}setValues(e,t){!0===t&&(this._index=this.generateIndex(e)),this.values$.next(e);const o=e.length,i=0===o;this.count$.next(o),this.empty$.next(i)}generateIndex(e){const t=e.map(e=>[this.getKey(e),e]);return new Map(t)}}class lt{constructor(e,t={}){this.entities$=new C.X([]),this.count$=new C.X(0),this.empty$=new C.X(!0),this._pristine=!0,this.strategies=[],this.getKey=t.getKey?t.getKey:it,this.getProperty=t.getProperty?t.getProperty:ot,this.state=this.createStateManager(),this.view=this.createDataView(),this.stateView=this.createStateView(),this.view.lift(),this.stateView.lift(),e.length>0?this.load(e):this._index=this.generateIndex(e)}get count(){return this.count$.value}get empty(){return this.empty$.value}get index(){return this._index}get pristine(){return this._pristine}get(e){return this.index.get(e)}all(){return this.entities$.value}load(e,t=!0){this._index=this.generateIndex(e),this._pristine=t,this.next()}softClear(){this.index&&this.index.size>0?(this.index.clear(),this._pristine=!0,this.next()):this.index&&this.updateCount()}clear(){this.stateView.clear(),this.view.clear(),this.state.clear(),this.softClear()}destroy(){this.stateView.destroy(),this.view.destroy(),this.clear()}insert(e){this.insertMany([e])}insertMany(e){e.forEach(e=>this.index.set(this.getKey(e),e)),this._pristine=!1,this.next()}update(e){this.updateMany([e])}updateMany(e){e.forEach(e=>this.index.set(this.getKey(e),e)),this._pristine=!1,this.next()}delete(e){this.deleteMany([e])}deleteMany(e){e.forEach(e=>this.index.delete(this.getKey(e))),this._pristine=!1,this.next()}addStrategy(e,t=!1){if(void 0!==this.strategies.find(t=>e.constructor===t.constructor))throw new Error("A strategy of this type already exists on that EntityStore.");return this.strategies.push(e),e.bindStore(this),!0===t&&e.activate(),this}removeStrategy(e){const t=this.strategies.indexOf(e);return t>=0&&(this.strategies.splice(t,1),e.unbindStore(this)),this}getStrategyOfType(e){return this.strategies.find(t=>t instanceof e)}activateStrategyOfType(e){const t=this.getStrategyOfType(e);void 0!==t&&t.activate()}deactivateStrategyOfType(e){const t=this.getStrategyOfType(e);void 0!==t&&t.deactivate()}generateIndex(e){const t=e.map(e=>[this.getKey(e),e]);return new Map(t)}next(){this.entities$.next(Array.from(this.index.values())),this.updateCount()}updateCount(){const e=this.index.size,t=0===e;this.count$.next(e),this.empty$.next(t)}createStateManager(){return new nt({store:this})}createDataView(){return new at(this.entities$)}createStateView(){return new at(this.view.all$()).join({source:this.state.change$,reduce:e=>{const t=this.getKey(e),o=this.state.get(e),i=this.stateView.get(t);if(void 0!==i&&i.entity===e&&this.statesAreTheSame(i.state,o))return i;const r=i?i.revision+1:1;return{entity:e,state:o,revision:r,ref:`${t}-${r}`}}}).createIndex(e=>this.getKey(e.entity))}statesAreTheSame(e,t){if(e===t)return!0;const o=0===Object.keys(e).length,i=0===Object.keys(t).length;return o&&i}}class ct{constructor(e,t){this.innerStateIndex=new Map,this.setChangeDetector(t),this.setStore(e)}destroy(){this.setChangeDetector(void 0),this.setStore(void 0)}setStore(e){if(void 0===e)return this.teardownObservers(),this.innerStateIndex.clear(),void(this.store=void 0);this.setStore(void 0),this.store=e,this.setupObservers(),this.detectChanges()}setChangeDetector(e){this.cdRef=e}setupObservers(){this.teardownObservers(),this.entities$$=this.store.entities$.subscribe(e=>this.onEntitiesChange(e)),this.state$$=this.store.state.change$.pipe((0,Ae.T)(1)).subscribe(()=>this.onStateChange())}teardownObservers(){void 0!==this.entities$$&&this.entities$$.unsubscribe(),void 0!==this.state$$&&this.state$$.unsubscribe(),this.entities$$=void 0,this.state$$=void 0}onEntitiesChange(e){this.detectChanges()}onStateChange(){let e=!1;const t=this.store.state.index,o=this.innerStateIndex;t.size!==o.size&&(e=this.detectChanges());const i=Array.from(t.keys());for(const r of i){const i=t.get(r),s=o.get(r);!1===e&&(void 0===s?e=this.detectChanges():_.objectsAreEquivalent(i,s)||(e=this.detectChanges())),this.innerStateIndex.set(r,Object.assign({},i))}}detectChanges(){return void 0!==this.cdRef&&this.cdRef.detectChanges(),!0}}class ut{constructor(e={}){this.options=e,this.stores=[],this.active$=new C.X(!1),this.options=e}get active(){return this.active$.value}activate(){!0===this.active&&this.doDeactivate(),this.active$.next(!0),this.doActivate()}deactivate(){this.active$.next(!1),this.doDeactivate()}bindStore(e){this.stores.indexOf(e)<0&&this.stores.push(e)}unbindStore(e){const t=this.stores.indexOf(e);t>=0&&this.stores.splice(t,1)}doActivate(){}doDeactivate(){}}class pt extends ut{constructor(e){super(e),this.options=e,this.filters=new Map}bindStore(e){super.bindStore(e),!0===this.active&&this.filterStore(e)}unbindStore(e){super.unbindStore(e),!0===this.active&&this.unfilterStore(e)}doActivate(){this.filterAll()}doDeactivate(){this.unfilterAll()}filterAll(){this.stores.forEach(e=>this.filterStore(e))}unfilterAll(){this.stores.forEach(e=>this.unfilterStore(e))}filterStore(e){this.filters.set(e,e.stateView.addFilter(this.options.filterClauseFunc))}unfilterStore(e){const t=this.filters.get(e);void 0!==t&&(e.stateView.removeFilter(t),this.filters.delete(e))}}class dt extends ut{constructor(){super(...arguments),this.filters=new Map}bindStore(e){super.bindStore(e),!0===this.active&&this.filterStore(e)}unbindStore(e){super.unbindStore(e),!0===this.active&&this.unfilterStore(e)}doActivate(){this.filterAll()}doDeactivate(){this.unfilterAll()}filterAll(){this.stores.forEach(e=>this.filterStore(e))}unfilterAll(){this.stores.forEach(e=>this.unfilterStore(e))}filterStore(e){this.filters.has(e)||this.filters.set(e,e.stateView.addFilter(e=>!0===e.state.selected))}unfilterStore(e){const t=this.filters.get(e);void 0!==t&&(e.stateView.removeFilter(t),this.filters.delete(e))}}function ht(e,t){if(1&e&&(r.TgZ(0,"mat-option",4),r._uU(1),r.qZA()),2&e){const e=r.oxw();r.Q6J("value",e.emptyValue),r.xp6(1),r.Oqu(e.emptyText)}}function gt(e,t){if(1&e&&(r.TgZ(0,"mat-option",4),r._uU(1),r.ALo(2,"async"),r.qZA()),2&e){const e=r.oxw();r.Q6J("value",e.multiSelectValue),r.xp6(1),r.Oqu(r.lcZ(2,2,e.multiText$))}}function mt(e,t){if(1&e&&(r.TgZ(0,"mat-option",4),r._uU(1),r.qZA()),2&e){const e=t.$implicit,o=r.oxw();r.Q6J("value",e.entity),r.xp6(1),r.hij(" ",o.titleAccessor(e.entity)," ")}}let ft=(()=>{class e{constructor(e){this.cdRef=e,this.selected$=new C.X(void 0),this.multiText$=new C.X(void 0),this.multiSelectValue={id:"IGO_MULTI_SELECT"},this.emptyValue={id:"IGO_EMPTY_SELECT"},this.titleAccessor=rt,this.emptyText=void 0,this.multi=!1,this.multiAllText="All",this.multiNoneText="None",this.disabled=!1,this.selectedChange=new r.vpe}ngOnInit(){this.watcher=new ct(this.store,this.cdRef),this.selected$$=this.store.stateView.manyBy$(e=>!0===e.state.selected).subscribe(e=>{const t=e.map(e=>e.entity);this.onSelectFromStore(t)})}ngOnDestroy(){this.watcher.destroy(),this.selected$$.unsubscribe()}onSelectionChange(e){const t=e.value instanceof Array?e.value:[e.value],o=t.find(e=>e===this.multiSelectValue);let i=t.filter(e=>e!==this.multiSelectValue);void 0!==o&&(i.length===this.store.count?i=[]:i.length<this.store.count&&(i=this.store.all())),i=i.filter(e=>e!==this.emptyValue),0===i.length?this.store.state.updateAll({selected:!1}):this.store.state.updateMany(i,{selected:!0},!0),this.selectedChange.emit({selected:!0,value:this.multi?i:e.value})}onSelectFromStore(e){this.selected$.next(!0===this.multi?e:e.length>0?e[0]:void 0),this.updateMultiToggleWithEntities(e)}updateMultiToggleWithEntities(e){e.length===this.store.count&&this.multiText$.value!==this.multiNoneText?this.multiText$.next(this.multiNoneText):e.length<this.store.count&&this.multiText$.value!==this.multiAllText&&this.multiText$.next(this.multiAllText)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.sBO))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-entity-selector"]],inputs:{store:"store",titleAccessor:"titleAccessor",emptyText:"emptyText",multi:"multi",multiAllText:"multiAllText",multiNoneText:"multiNoneText",placeholder:"placeholder",disabled:"disabled"},outputs:{selectedChange:"selectedChange"},decls:7,vars:11,consts:[[1,"igo-entity-selector"],[3,"disabled","value","multiple","placeholder","selectionChange"],[3,"value",4,"ngIf"],["ngFor","",3,"ngForOf"],[3,"value"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-form-field",0),r.TgZ(1,"mat-select",1),r.NdJ("selectionChange",function(e){return t.onSelectionChange(e)}),r.ALo(2,"async"),r.YNc(3,ht,2,2,"mat-option",2),r.YNc(4,gt,3,4,"mat-option",2),r.YNc(5,mt,2,2,"ng-template",3),r.ALo(6,"async"),r.qZA(),r.qZA()),2&e&&(r.xp6(1),r.Q6J("disabled",t.disabled)("value",r.lcZ(2,7,t.selected$))("multiple",t.multi)("placeholder",t.placeholder),r.xp6(2),r.Q6J("ngIf",void 0!==t.emptyText&&!1===t.multi),r.xp6(1),r.Q6J("ngIf",!0===t.multi),r.xp6(1),r.Q6J("ngForOf",r.lcZ(6,9,t.store.stateView.all$())))},directives:[Pe.KE,_e.gD,h.O5,h.sg,$e.ey],pipes:[h.Ov],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}"],changeDetection:0}),e})(),yt=(()=>{class e{onClick(e){e.stopPropagation()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=r.lG2({type:e,selectors:[["","igoStopPropagation",""]],hostBindings:function(e,t){1&e&&r.NdJ("click",function(e){return t.onClick(e)})}}),e})(),vt=(()=>{class e{constructor(e,t){this.renderer=e,this.el=t,this.selection=!1,this.selectOnClick=!0,this.highlightSelection=!0,this._selected=!1,this.scrollBehavior=et.Auto,this.select=new r.vpe}set selected(e){!1!==this.selection&&e!==this._selected&&(this.toggleSelected(e),this.scroll())}get selected(){return this._selected}onClick(){!1===this.selection||!1===this.selectOnClick||(this.toggleSelected(!0),this.select.emit(this))}toggleSelected(t){this._selected=t,!0===t?(this.addCls(e.selectedCls),!0===this.highlightSelection&&this.addCls(e.highlightedCls)):(this.removeCls(e.selectedCls),this.removeCls(e.highlightedCls))}scroll(){!0===this._selected&&(0,Ee.Z)(this.el.nativeElement,{scrollMode:"if-needed",behavior:"smooth",block:"end",inline:"nearest"})}addCls(e){this.renderer.addClass(this.el.nativeElement,e)}removeCls(e){this.renderer.removeClass(this.el.nativeElement,e)}}return e.selectedCls="igo-entity-table-row-selected",e.highlightedCls="igo-entity-table-row-highlighted",e.\u0275fac=function(t){return new(t||e)(r.Y36(r.Qsj),r.Y36(r.SBq))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoEntityTableRow",""]],hostBindings:function(e,t){1&e&&r.NdJ("click",function(){return t.onClick()})},inputs:{selection:"selection",selectOnClick:"selectOnClick",highlightSelection:"highlightSelection",selected:"selected",scrollBehavior:"scrollBehavior"},outputs:{select:"select"}}),e})(),bt=(()=>{class e{constructor(e,t){this.languageService=e,this.mediaService=t,this.disabled=!1,this.hidePageSize=!1,this.pageIndex=0,this.pageSize=50,this.pageSizeOptions=[5,10,20,50,100,200],this.showFirstLastButtons=!0,this.paginationLabelTranslation$$=[],this.entitySortChange$=new C.X(!1),this.length=0,this.paginatorChange=new r.vpe,this.rangeLabel=(e,t,o)=>{const i=new C.X("");if(this.paginationLabelTranslation$$.push(this.languageService.translate.get("igo.common.paginator.of").subscribe(e=>{i.next(e)})),0===o||0===t)return`0 ${i.value} ${o}`;const r=e*t;return`${r+1} - ${r<(o=Math.max(o,0))?Math.min(r+t,o):r+t} ${i.value} ${o}`}}ngOnChanges(){this.unsubscribeAll(),this.count$$=this.store.stateView.count$.subscribe(e=>{this.length=e,this.emitPaginator()}),this.entitySortChange$$=this.entitySortChange$.subscribe(()=>{this.paginator&&this.paginator.firstPage()}),this.initPaginatorOptions(),this.translateLabels()}initPaginatorOptions(){var e,t,o,i,r,s;this.disabled=(null===(e=this.paginatorOptions)||void 0===e?void 0:e.disabled)||this.disabled,this.pageIndex=(null===(t=this.paginatorOptions)||void 0===t?void 0:t.pageIndex)||this.pageIndex,this.pageSize=(null===(o=this.paginatorOptions)||void 0===o?void 0:o.pageSize)||this.pageSize,this.pageSizeOptions=(null===(i=this.paginatorOptions)||void 0===i?void 0:i.pageSizeOptions)||this.pageSizeOptions,this.mediaService.isMobile()?(this.showFirstLastButtons=!1,this.hidePageSize=!0):(this.showFirstLastButtons=(null===(r=this.paginatorOptions)||void 0===r?void 0:r.showFirstLastButtons)||this.showFirstLastButtons,this.hidePageSize=(null===(s=this.paginatorOptions)||void 0===s?void 0:s.hidePageSize)||this.hidePageSize)}translateLabels(){this.paginationLabelTranslation$$.push(this.languageService.translate.get("igo.common.paginator.firstPageLabel").subscribe(e=>{this.paginator._intl.firstPageLabel=e})),this.paginator._intl.getRangeLabel=this.rangeLabel,this.paginationLabelTranslation$$.push(this.languageService.translate.get("igo.common.paginator.itemsPerPageLabel").subscribe(e=>{this.paginator._intl.itemsPerPageLabel=e})),this.paginationLabelTranslation$$.push(this.languageService.translate.get("igo.common.paginator.lastPageLabel").subscribe(e=>{this.paginator._intl.lastPageLabel=e})),this.paginationLabelTranslation$$.push(this.languageService.translate.get("igo.common.paginator.nextPageLabel").subscribe(e=>{this.paginator._intl.nextPageLabel=e})),this.paginationLabelTranslation$$.push(this.languageService.translate.get("igo.common.paginator.previousPageLabel").subscribe(e=>{this.paginator._intl.previousPageLabel=e}))}unsubscribeAll(){this.paginationLabelTranslation$$.map(e=>e.unsubscribe()),this.count$$&&this.count$$.unsubscribe(),this.entitySortChange$$&&this.entitySortChange$$.unsubscribe()}ngOnDestroy(){this.unsubscribeAll()}emitPaginator(){this.paginatorChange.emit(this.paginator)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ne),r.Y36(me))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-entity-table-paginator"]],viewQuery:function(e,t){if(1&e&&r.Gf(Re.NW,7),2&e){let e;r.iGM(e=r.CRH())&&(t.paginator=e.first)}},inputs:{entitySortChange$:"entitySortChange$",store:"store",paginatorOptions:"paginatorOptions"},outputs:{page:"page",paginatorChange:"paginatorChange"},features:[r.TTD],decls:1,vars:7,consts:[[3,"disabled","hidePageSize","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons","page"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-paginator",0),r.NdJ("page",function(){return t.emitPaginator()}),r.qZA()),2&e&&r.Q6J("disabled",t.disabled)("hidePageSize",t.hidePageSize)("length",t.length)("pageIndex",t.pageIndex)("pageSize",t.pageSize)("pageSizeOptions",t.pageSizeOptions)("showFirstLastButtons",t.showFirstLastButtons)},directives:[Re.NW],styles:["[_nghost-%COMP%]{margin-top:-10px;padding-right:15px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){[_nghost-%COMP%]{margin-top:0;padding-right:5px}}"],changeDetection:0}),e})(),xt=(()=>{class e{constructor(e){this.http=e}transform(e){const t=new y.WM({"Content-Type":"text/plain",activityInterceptor:"false"});return this.http.get(e,{headers:t,responseType:"blob"}).pipe((0,Ze.w)(e=>new Se.y(t=>{const o=new FileReader;o.readAsDataURL(e),o.onloadend=()=>{t.next(o.result),t.complete()}})))}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(y.eN,16))},e.\u0275pipe=r.Yjl({name:"secureImage",type:e,pure:!0}),(0,Ue.gn)([(0,Ne.q)({maxCacheCount:20})],e.prototype,"transform",null),e})(),wt=(()=>{class e{constructor(e){this._sanitizer=e}transform(e){return this._sanitizer.bypassSecurityTrustHtml(e)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(i.H7,16))},e.\u0275pipe=r.Yjl({name:"sanitizeHtml",type:e,pure:!0}),e})();function St(e,t){if(1&e){const e=r.EpF();r.ynx(0),r.TgZ(1,"mat-checkbox",11),r.NdJ("change",function(t){return r.CHM(e),r.oxw(3).onToggleRows(t.checked)}),r.qZA(),r.BQk()}if(2&e){const e=t.ngIf,o=r.oxw(3);r.xp6(1),r.Q6J("checked",e===o.entityTableSelectionState.All)("indeterminate",e===o.entityTableSelectionState.Some)}}function Ct(e,t){if(1&e&&(r.ynx(0),r.YNc(1,St,2,2,"ng-container",10),r.ALo(2,"async"),r.BQk()),2&e){const e=r.oxw(2);r.xp6(1),r.Q6J("ngIf",r.lcZ(2,1,e.selectionState$))}}function Tt(e,t){if(1&e&&(r.TgZ(0,"th",9),r.YNc(1,Ct,3,3,"ng-container",10),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf",e.selectMany)}}function At(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"td",12),r.TgZ(1,"mat-checkbox",13),r.NdJ("mousedown",function(e){return e.shiftKey?e.preventDefault():null})("click",function(t){const o=r.CHM(e).$implicit,i=r.oxw();return t.shiftKey?i.onShiftToggleRow(!i.rowIsSelected(o),o,t):t.stopPropagation()})("change",function(t){const o=r.CHM(e).$implicit;return r.oxw().onToggleRow(t.checked,o)}),r.qZA(),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw();r.xp6(1),r.Q6J("checked",o.rowIsSelected(e))}}function Zt(e,t){if(1&e&&(r.TgZ(0,"th",16),r._uU(1),r.qZA()),2&e){const e=r.oxw(2).$implicit;r.xp6(1),r.hij(" ",e.title," ")}}function Lt(e,t){1&e&&(r.ynx(0),r.YNc(1,Zt,2,1,"th",15),r.BQk())}function Ft(e,t){if(1&e&&(r.TgZ(0,"th",9),r._uU(1),r.qZA()),2&e){const e=r.oxw(2).$implicit;r.xp6(1),r.hij(" ",e.title," ")}}function Ot(e,t){1&e&&(r.ynx(0),r.YNc(1,Ft,2,1,"th",3),r.BQk())}function Mt(e,t){if(1&e&&(r.TgZ(0,"td",20),r._uU(1),r.qZA()),2&e){const e=r.oxw().$implicit,t=r.oxw(3).$implicit,o=r.oxw();r.Q6J("ngClass",o.getCellClass(e,t)),r.xp6(1),r.hij(" ",o.getValue(e,t)," ")}}function It(e,t){if(1&e&&(r._UZ(0,"img",24),r.ALo(1,"async"),r.ALo(2,"secureImage")),2&e){const e=r.oxw(2).$implicit,t=r.oxw(3).$implicit,o=r.oxw();r.s9C("src",r.lcZ(1,1,r.lcZ(2,3,o.getValue(e,t))),r.LSH)}}function kt(e,t){1&e&&(r.TgZ(0,"span"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij("",r.lcZ(2,1,"igo.common.entity-table.targetHtmlUrl")," "))}function Pt(e,t){if(1&e&&(r.TgZ(0,"td",20),r.TgZ(1,"a",21),r.NdJ("click",function(e){return e.stopPropagation()}),r.YNc(2,It,3,5,"img",22),r.YNc(3,kt,3,3,"ng-template",null,23,r.W1O),r.qZA(),r.qZA()),2&e){const e=r.MAs(4),t=r.oxw().$implicit,o=r.oxw(3).$implicit,i=r.oxw();r.Q6J("ngClass",i.getCellClass(t,o)),r.xp6(1),r.s9C("href",i.getValue(t,o),r.LSH),r.xp6(1),r.Q6J("ngIf",i.isImg(i.getValue(t,o)))("ngIfElse",e)}}function _t(e,t){if(1&e&&(r.ynx(0),r.YNc(1,Mt,2,2,"td",18),r.YNc(2,Pt,5,4,"ng-template",null,19,r.W1O),r.BQk()),2&e){const e=t.$implicit,o=r.MAs(3),i=r.oxw(3).$implicit,s=r.oxw();r.xp6(1),r.Q6J("ngIf",!s.isUrl(s.getValue(e,i)))("ngIfElse",o)}}function $t(e,t){1&e&&(r.ynx(0),r.YNc(1,_t,4,2,"ng-container",17),r.BQk())}function qt(e,t){if(1&e&&r._UZ(0,"td",27),2&e){const e=r.oxw().$implicit,t=r.oxw(3).$implicit,o=r.oxw();r.Q6J("ngClass",o.getCellClass(e,t))("innerHTML",o.getValue(e,t),r.oJD)}}function Dt(e,t){if(1&e&&(r._UZ(0,"img",24),r.ALo(1,"async"),r.ALo(2,"secureImage")),2&e){const e=r.oxw(2).$implicit,t=r.oxw(3).$implicit,o=r.oxw();r.s9C("src",r.lcZ(1,1,r.lcZ(2,3,o.getValue(e,t))),r.LSH)}}function Et(e,t){1&e&&(r.TgZ(0,"span"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij("",r.lcZ(2,1,"igo.geo.targetHtmlUrl")," "))}function Rt(e,t){if(1&e&&(r.TgZ(0,"td",20),r.TgZ(1,"a",21),r.NdJ("click",function(e){return e.stopPropagation()}),r.YNc(2,Dt,3,5,"img",22),r.YNc(3,Et,3,3,"ng-template",null,23,r.W1O),r.qZA(),r.qZA()),2&e){const e=r.MAs(4),t=r.oxw().$implicit,o=r.oxw(3).$implicit,i=r.oxw();r.Q6J("ngClass",i.getCellClass(t,o)),r.xp6(1),r.s9C("href",i.getValue(t,o),r.LSH),r.xp6(1),r.Q6J("ngIf",i.isImg(i.getValue(t,o)))("ngIfElse",e)}}function Ut(e,t){if(1&e&&(r.ynx(0),r.YNc(1,qt,1,2,"td",25),r.YNc(2,Rt,5,4,"ng-template",null,26,r.W1O),r.BQk()),2&e){const e=t.$implicit,o=r.MAs(3),i=r.oxw(3).$implicit,s=r.oxw();r.xp6(1),r.Q6J("ngIf",!s.isUrl(s.getValue(e,i)))("ngIfElse",o)}}function Nt(e,t){1&e&&(r.ynx(0),r.YNc(1,Ut,4,2,"ng-container",17),r.BQk())}function Jt(e,t){if(1&e&&(r._UZ(0,"td",27),r.ALo(1,"sanitizeHtml")),2&e){const e=r.oxw().$implicit,t=r.oxw(3).$implicit,o=r.oxw();r.Q6J("ngClass",o.getCellClass(e,t))("innerHTML",r.lcZ(1,2,o.getValue(e,t)),r.oJD)}}function Bt(e,t){if(1&e&&(r._UZ(0,"img",24),r.ALo(1,"async"),r.ALo(2,"secureImage")),2&e){const e=r.oxw(2).$implicit,t=r.oxw(3).$implicit,o=r.oxw();r.s9C("src",r.lcZ(1,1,r.lcZ(2,3,o.getValue(e,t))),r.LSH)}}function jt(e,t){1&e&&(r.TgZ(0,"span"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij("",r.lcZ(2,1,"igo.geo.targetHtmlUrl")," "))}function Gt(e,t){if(1&e&&(r.TgZ(0,"td",20),r.TgZ(1,"a",21),r.NdJ("click",function(e){return e.stopPropagation()}),r.YNc(2,Bt,3,5,"img",22),r.YNc(3,jt,3,3,"ng-template",null,23,r.W1O),r.qZA(),r.qZA()),2&e){const e=r.MAs(4),t=r.oxw().$implicit,o=r.oxw(3).$implicit,i=r.oxw();r.Q6J("ngClass",i.getCellClass(t,o)),r.xp6(1),r.s9C("href",i.getValue(t,o),r.LSH),r.xp6(1),r.Q6J("ngIf",i.isImg(i.getValue(t,o)))("ngIfElse",e)}}function Qt(e,t){if(1&e&&(r.ynx(0),r.YNc(1,Jt,2,4,"td",25),r.YNc(2,Gt,5,4,"ng-template",null,28,r.W1O),r.BQk()),2&e){const e=t.$implicit,o=r.MAs(3),i=r.oxw(3).$implicit,s=r.oxw();r.xp6(1),r.Q6J("ngIf",!s.isUrl(s.getValue(e,i)))("ngIfElse",o)}}function zt(e,t){1&e&&(r.ynx(0),r.YNc(1,Qt,4,2,"ng-container",17),r.BQk())}function Yt(e,t){if(1&e&&(r.TgZ(0,"td",20),r._UZ(1,"mat-icon",30),r.qZA()),2&e){const e=t.$implicit,o=r.oxw(3).$implicit,i=r.oxw();r.Q6J("ngClass",i.getCellClass(e,o)),r.xp6(1),r.s9C("svgIcon",i.getValue(e,o))}}function Ht(e,t){1&e&&(r.ynx(0),r.YNc(1,Yt,2,2,"td",29),r.BQk())}function Vt(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",34),r.NdJ("click",function(){r.CHM(e);const t=r.oxw().$implicit,o=r.oxw().$implicit;return r.oxw(4).onButtonClick(t.click,o)}),r._UZ(1,"mat-icon",30),r.qZA()}if(2&e){const e=r.oxw().$implicit;r.Q6J("color",e.color),r.xp6(1),r.s9C("svgIcon",e.icon)}}function Wt(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",35),r.NdJ("click",function(){r.CHM(e);const t=r.oxw().$implicit,o=r.oxw().$implicit;return r.oxw(4).onButtonClick(t.click,o)}),r._UZ(1,"mat-icon",30),r.qZA()}if(2&e){const e=r.oxw().$implicit;r.Q6J("color",e.color),r.xp6(1),r.s9C("svgIcon",e.icon)}}function Xt(e,t){if(1&e&&(r.TgZ(0,"span"),r.YNc(1,Vt,2,2,"button",32),r.YNc(2,Wt,2,2,"button",33),r.qZA()),2&e){const e=t.$implicit;r.xp6(1),r.Q6J("ngIf","mat-icon-button"===e.style),r.xp6(1),r.Q6J("ngIf","mat-icon-button"!==e.style)}}function Kt(e,t){if(1&e&&(r.TgZ(0,"td",20),r.YNc(1,Xt,3,2,"span",31),r.qZA()),2&e){const e=t.$implicit,o=r.oxw(3).$implicit,i=r.oxw();r.Q6J("ngClass",i.getCellClass(e,o)),r.xp6(1),r.Q6J("ngForOf",i.getValue(e,o))}}function eo(e,t){1&e&&(r.ynx(0),r.YNc(1,Kt,2,2,"td",29),r.BQk())}function to(e,t){if(1&e&&(r.ynx(0),r.YNc(1,$t,2,0,"ng-container",10),r.YNc(2,Nt,2,0,"ng-container",10),r.YNc(3,zt,2,0,"ng-container",10),r.YNc(4,Ht,2,0,"ng-container",10),r.YNc(5,eo,2,0,"ng-container",10),r.BQk()),2&e){const e=t.ngIf,o=r.oxw(2);r.xp6(1),r.Q6J("ngIf",e===o.entityTableColumnRenderer.Default),r.xp6(1),r.Q6J("ngIf",e===o.entityTableColumnRenderer.HTML),r.xp6(1),r.Q6J("ngIf",e===o.entityTableColumnRenderer.UnsanitizedHTML),r.xp6(1),r.Q6J("ngIf",e===o.entityTableColumnRenderer.Icon),r.xp6(1),r.Q6J("ngIf",e===o.entityTableColumnRenderer.ButtonGroup)}}function oo(e,t){if(1&e&&(r.ynx(0,14),r.YNc(1,Lt,2,0,"ng-container",10),r.YNc(2,Ot,2,0,"ng-container",10),r.YNc(3,to,6,5,"ng-container",10),r.BQk()),2&e){const e=t.$implicit,o=r.oxw();r.Q6J("matColumnDef",e.name),r.xp6(1),r.Q6J("ngIf",o.columnIsSortable(e)),r.xp6(1),r.Q6J("ngIf",!o.columnIsSortable(e)),r.xp6(1),r.Q6J("ngIf",o.getColumnRenderer(e))}}function io(e,t){if(1&e&&r._UZ(0,"tr",36),2&e){const e=r.oxw();r.Q6J("ngClass",e.getHeaderClass())}}function ro(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"tr",37),r.NdJ("select",function(){const t=r.CHM(e).$implicit;return r.oxw().onRowSelect(t)})("click",function(){const t=r.CHM(e).$implicit;return r.oxw().onRowClick(t)}),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw();r.Q6J("scrollBehavior",o.scrollBehavior)("ngClass",o.getRowClass(e))("selection",o.selection)("selected",o.rowIsSelected(e))}}function so(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-entity-table-paginator",38),r.NdJ("paginatorChange",function(t){return r.CHM(e),r.oxw().paginatorChange(t)}),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("store",e.store)("paginatorOptions",e.paginatorOptions)("entitySortChange$",e.entitySortChange$)}}let no=(()=>{class e{constructor(e){this.cdRef=e,this.entitySortChange$=new C.X(!1),this.entityTableColumnRenderer=Ke,this.entityTableSelectionState=tt,this.selectionState$=new C.X(void 0),this.scrollBehavior=et.Auto,this.sortNullsFirst=!1,this.withPaginator=!1,this.entityClick=new r.vpe,this.entitySelectChange=new r.vpe,this.entitySortChange=new r.vpe(void 0),this.dataSource=new qe.by}set paginator(e){this._paginator=e,this.dataSource.paginator=e}get paginator(){return this._paginator}get headers(){let e=this.template.columns.filter(e=>!1!==e.visible).map(e=>e.name);return!0===this.selectionCheckbox&&(e=["selectionCheckbox"].concat(e)),e}get selection(){return this.template.selection||!1}get selectionCheckbox(){return this.template.selectionCheckbox||!1}get selectMany(){return this.template.selectMany||!1}get fixedHeader(){return void 0===this.template.fixedHeader||this.template.fixedHeader}ngOnInit(){this.handleDatasource(),this.dataSource.paginator=this.paginator}ngOnChanges(e){const t=e.store;t&&t.currentValue!==t.previousValue&&this.handleDatasource()}handleDatasource(){this.unsubscribeStore(),this.selection$$=this.store.stateView.manyBy$(e=>!0===e.state.selected).subscribe(e=>{const t=e[0],o=this.store.stateView.all().indexOf(t),i=this.paginator?this.paginator.pageSize*(this.paginator.pageIndex+1):0;if(this.paginator&&(o<(this.paginator?i-this.paginator.pageSize:0)||o>=i)){const e=Math.floor(o/this.paginator.pageSize);this.dataSource.paginator.pageIndex=e}this.selectionState$.next(this.computeSelectionState(e))}),this.dataSource$$=this.store.stateView.all$().subscribe(e=>{this.dataSource.data=e})}ngOnDestroy(){this.unsubscribeStore()}unsubscribeStore(){this.selection$$&&this.selection$$.unsubscribe(),this.dataSource$$&&this.dataSource$$.unsubscribe()}getTrackByFunction(){return(e,t)=>t.ref}refresh(){this.cdRef.detectChanges()}paginatorChange(e){this.paginator=e}onSort(e){const t=e.direction,o=this.template.columns.find(t=>t.name===e.active);"asc"===t||"desc"===t?(this.store.stateView.sort({valueAccessor:e=>this.getValue(e,o),direction:t,nullsFirst:this.sortNullsFirst}),this.entitySortChange.emit({column:o,direction:t}),this.entitySortChange$.next(!0)):this.store.stateView.sort(void 0)}onRowClick(e){this.lastRecordCheckedKey=this.store.stateView.getKey(e),this.entityClick.emit(e.entity)}onRowSelect(e){if(!1===this.selection)return;const t=e.entity;this.store.state.update(t,{selected:!0},!0),this.entitySelectChange.emit({added:[t]})}onToggleRows(e){if(!1!==this.selection&&(this.store.state.updateAll({selected:e}),!0===e)){const e=this.store.stateView.all().map(e=>e.entity);this.entitySelectChange.emit({added:[e]})}}onToggleRow(e,t){if(!1===this.selection)return;const o=t.entity;this.store.state.update(o,{selected:e},!0===e&&!this.selectMany),!0===e&&this.entitySelectChange.emit({added:[o]}),this.lastRecordCheckedKey=this.store.stateView.getKey(t)}onShiftToggleRow(e,t,o){if(!1===this.selection)return;if(!1===this.selectMany||void 0===this.lastRecordCheckedKey)return void this.onToggleRow(e,t);const i=window.document.createRange();i.selectNode(o.target),window.getSelection().removeAllRanges(),window.getSelection().addRange(i),o.stopImmediatePropagation();const r=this.store.stateView.all(),s=r.indexOf(t),n=this.store.stateView.get(this.lastRecordCheckedKey),a=[s,r.indexOf(n)],l=r.slice(Math.min(...a),Math.max(...a)+1).map(e=>e.entity);this.store.state.updateMany(l,{selected:e}),!0===e&&this.entitySelectChange.emit({added:l}),this.lastRecordCheckedKey=this.store.stateView.getKey(t)}computeSelectionState(e){const t=e.length;return 0===t?tt.None:t===this.store.stateView.count?tt.All:tt.Some}columnIsSortable(e){let t=e.sort;return void 0===t&&(t=void 0!==this.template.sort&&this.template.sort),t}rowIsSelected(e){const t=e.state;return!!t.selected&&t.selected}isImg(e){return!!this.isUrl(e)&&-1!==["jpg","png","gif"].indexOf(e.split(".").pop().toLowerCase())}isUrl(e){return"string"==typeof e&&("https://"===e.slice(0,8)||"http://"===e.slice(0,7))}getValue(e,t){const o=e.entity;return void 0!==t.valueAccessor?t.valueAccessor(o,e):void 0!==this.template.valueAccessor?this.template.valueAccessor(o,t.name,e):this.store.getProperty(o,t.name)}getColumnRenderer(e){return void 0!==e.renderer?e.renderer:Ke.Default}getTableClass(){return{"igo-entity-table-with-selection":this.selection}}getHeaderClass(){const e=this.template.headerClassFunc;return e instanceof Function?e():{}}getRowClass(e){const t=this.template.rowClassFunc;return t instanceof Function?t(e.entity,e):{}}getCellClass(e,t){const o=e.entity,i={},r=this.template.cellClassFunc;r instanceof Function&&Object.assign(i,r(o,t,e));const s=t.cellClassFunc;return s instanceof Function&&Object.assign(i,s(o,e)),i}onButtonClick(e,t){"function"==typeof e&&e(t.entity,t)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.sBO))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-entity-table"]],inputs:{store:"store",paginator:"paginator",template:"template",scrollBehavior:"scrollBehavior",sortNullsFirst:"sortNullsFirst",withPaginator:"withPaginator",paginatorOptions:"paginatorOptions"},outputs:{entityClick:"entityClick",entitySelectChange:"entitySelectChange",entitySortChange:"entitySortChange"},features:[r.TTD],decls:9,vars:8,consts:[[1,"table-container"],["mat-table","","matSort","",3,"ngClass","dataSource","trackBy","matSortChange"],["matColumnDef","selectionCheckbox",1,"mat-cell-checkbox"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],[3,"matColumnDef",4,"ngFor","ngForOf"],["mat-header-row","",3,"ngClass",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","igoEntityTableRow","",3,"scrollBehavior","ngClass","selection","selected","select","click",4,"matRowDef","matRowDefColumns"],[3,"store","paginatorOptions","entitySortChange$","paginatorChange",4,"ngIf"],["mat-header-cell",""],[4,"ngIf"],[3,"checked","indeterminate","change"],["mat-cell",""],[3,"checked","mousedown","click","change"],[3,"matColumnDef"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-header-cell","","mat-sort-header",""],[4,"matCellDef"],["mat-cell","","class","mat-cell-text",3,"ngClass",4,"ngIf","ngIfElse"],["isAnUrlDefault",""],["mat-cell","",1,"mat-cell-text",3,"ngClass"],["target","_blank","rel","noopener noreferrer",3,"href","click"],["width","50","heigth","auto",3,"src",4,"ngIf","ngIfElse"],["notImg",""],["width","50","heigth","auto",3,"src"],["mat-cell","","class","mat-cell-text",3,"ngClass","innerHTML",4,"ngIf","ngIfElse"],["isAnUrlHTML",""],["mat-cell","",1,"mat-cell-text",3,"ngClass","innerHTML"],["isAnUrlUnsanitizedHTML",""],["mat-cell","","class","mat-cell-text",3,"ngClass",4,"matCellDef"],[3,"svgIcon"],[4,"ngFor","ngForOf"],["igoStopPropagation","","mat-icon-button","",3,"color","click",4,"ngIf"],["igoStopPropagation","","mat-mini-fab","",3,"color","click",4,"ngIf"],["igoStopPropagation","","mat-icon-button","",3,"color","click"],["igoStopPropagation","","mat-mini-fab","",3,"color","click"],["mat-header-row","",3,"ngClass"],["mat-row","","igoEntityTableRow","",3,"scrollBehavior","ngClass","selection","selected","select","click"],[3,"store","paginatorOptions","entitySortChange$","paginatorChange"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"table",1),r.NdJ("matSortChange",function(e){return t.onSort(e)}),r.ynx(2,2),r.YNc(3,Tt,2,1,"th",3),r.YNc(4,At,2,1,"td",4),r.BQk(),r.YNc(5,oo,4,4,"ng-container",5),r.YNc(6,io,1,1,"tr",6),r.YNc(7,ro,1,4,"tr",7),r.qZA(),r.YNc(8,so,1,3,"igo-entity-table-paginator",8),r.qZA()),2&e&&(r.xp6(1),r.Q6J("ngClass",t.getTableClass())("dataSource",t.dataSource)("trackBy",t.getTrackByFunction()),r.xp6(4),r.Q6J("ngForOf",t.template.columns),r.xp6(1),r.Q6J("matHeaderRowDef",t.headers)("matHeaderRowDefSticky",t.fixedHeader),r.xp6(1),r.Q6J("matRowDefColumns",t.headers),r.xp6(1),r.Q6J("ngIf",t.withPaginator))},directives:[qe.BZ,De.YE,h.mk,qe.w1,qe.fO,qe.Dz,h.sg,qe.as,qe.nj,h.O5,qe.ge,m.oG,qe.ev,De.nU,a.Hw,n.lW,yt,qe.XQ,qe.Gk,vt,bt],pipes:[h.Ov,xt,U.X$,wt],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:block}.table-compact[_nghost-%COMP%]   tr.mat-header-row[_ngcontent-%COMP%], .table-compact[_nghost-%COMP%]     .mat-checkbox .mat-checkbox-ripple{height:36px}.table-compact[_nghost-%COMP%]   tr.mat-row[_ngcontent-%COMP%], .table-compact[_nghost-%COMP%]     .mat-checkbox .mat-checkbox-ripple{height:28px}.table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;overflow:auto;flex:1 1 auto}.mat-cell-text[_ngcontent-%COMP%]{overflow:hidden;word-wrap:break-word}th.mat-header-cell[_ngcontent-%COMP%], td.mat-cell[_ngcontent-%COMP%], td.mat-footer-cell[_ngcontent-%COMP%]{padding:0 3px}entity-table[_ngcontent-%COMP%]   table.igo-entity-table-with-selection[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{-o-box-shadow:2px 0px 2px 0px #dddddd;box-shadow:2px 0 2px #ddd;cursor:pointer}table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:7px}"],changeDetection:0}),e})();var ao=(()=>{return(e=ao||(ao={})).Dock="dock",e.Overlay="overlay",e.Context="context",ao;var e})();function lo(e,t){if(1&e&&(r._UZ(0,"mat-icon",7),r.ALo(1,"async")),2&e){const e=r.oxw(3);r.s9C("svgIcon",r.lcZ(1,1,e.icon$))}}function co(e,t){if(1&e&&(r.TgZ(0,"button",5),r.ALo(1,"async"),r.YNc(2,lo,2,3,"mat-icon",6),r.qZA()),2&e){const e=r.oxw(2);r.Q6J("color",e.color)("disabled",r.lcZ(1,3,e.disabled$)),r.xp6(2),r.Q6J("ngIf",e.withIcon)}}function uo(e,t){if(1&e&&(r.TgZ(0,"h4",8),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.Oqu(r.lcZ(2,1,e.title))}}function po(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-list-item",2),r.NdJ("click",function(){return r.CHM(e),r.oxw().onClick()}),r.ALo(1,"translate"),r.ALo(2,"async"),r.ALo(3,"async"),r.YNc(4,co,3,5,"button",3),r.YNc(5,uo,3,3,"h4",4),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("matTooltip",e.withTooltip?r.lcZ(1,4,r.lcZ(2,6,e.tooltip$)||e.title):"")("ngClass",r.lcZ(3,8,e.ngClass$)),r.xp6(4),r.Q6J("ngIf",e.withIcon),r.xp6(1),r.Q6J("ngIf",e.withTitle)}}function ho(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-checkbox",11),r.NdJ("change",function(){return r.CHM(e),r.oxw(2).action.handler()}),r.ALo(1,"async"),r._uU(2),r.ALo(3,"translate"),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("checked",r.lcZ(1,2,e.checkCondition$)),r.xp6(2),r.hij(" ",r.lcZ(3,4,e.title)," ")}}function go(e,t){if(1&e&&(r.TgZ(0,"mat-list-item",9),r.ALo(1,"translate"),r.ALo(2,"async"),r.ALo(3,"async"),r.YNc(4,ho,4,6,"mat-checkbox",10),r.qZA()),2&e){const e=r.oxw();r.Q6J("matTooltip",e.withTooltip?r.lcZ(1,3,r.lcZ(2,5,e.tooltip$)||e.title):"")("ngClass",r.lcZ(3,7,e.ngClass$)),r.xp6(4),r.Q6J("ngIf",e.withTitle)}}let mo=(()=>{class e{constructor(){this.disabled$=new C.X(!1),this.checkCondition$=new C.X(void 0),this.icon$=new C.X(void 0),this.tooltip$=new C.X(void 0),this.noDisplay$=new C.X(!1),this.ngClass$=new C.X({}),this.color="default",this.withTitle=!0,this.withIcon=!0,this.withTooltip=!0,this.trigger=new r.vpe}set disabled(e){this.disabled$.next(e)}get disabled(){return this.disabled$.value}set noDisplay(e){this.noDisplay$.next(e)}get noDisplay(){return this.noDisplay$.value}get title(){return this.action.title}ngOnInit(){const e=this.action.args||[];void 0!==this.action.ngClass&&(this.ngClass$$=this.action.ngClass(...e).subscribe(e=>this.updateNgClass(e))),(0,Ce.b)(this.action.icon)?this.icon$$=this.action.icon.subscribe(e=>this.updateIcon(e)):this.updateIcon(this.action.icon),(0,Ce.b)(this.action.checkCondition)?this.checkCondition$$=this.action.checkCondition.subscribe(e=>this.updateCheckCondition(e)):this.updateCheckCondition(this.action.checkCondition),(0,Ce.b)(this.action.tooltip)?this.tooltip$$=this.action.tooltip.subscribe(e=>this.updateTooltip(e)):this.updateTooltip(this.action.tooltip),void 0!==this.action.availability&&(this.availability$$=this.action.availability(...e).subscribe(e=>this.disabled=!e)),this.disabled$$=this.disabled$.subscribe(e=>this.updateNgClass({"igo-actionbar-item-disabled":e})),void 0!==this.action.display&&(this.display$$=this.action.display(...e).subscribe(e=>this.noDisplay=!e)),this.noDisplay$$=this.noDisplay$.subscribe(e=>this.updateNgClass({"igo-actionbar-item-no-display":e}))}ngOnDestroy(){void 0!==this.ngClass$$&&(this.ngClass$$.unsubscribe(),this.ngClass$$=void 0),void 0!==this.availability$$&&(this.availability$$.unsubscribe(),this.availability$$=void 0),void 0!==this.display$$&&(this.display$$.unsubscribe(),this.display$$=void 0),void 0!==this.checkCondition$$&&(this.checkCondition$$.unsubscribe(),this.checkCondition$$=void 0),void 0!==this.icon$$&&(this.icon$$.unsubscribe(),this.icon$$=void 0),void 0!==this.tooltip$$&&(this.tooltip$$.unsubscribe(),this.tooltip$$=void 0),this.disabled$$.unsubscribe(),this.noDisplay$$.unsubscribe()}onClick(){!0!==this.disabled&&this.trigger.emit(this.action)}updateNgClass(e){this.ngClass$.next(Object.assign({},this.ngClass$.value,e))}updateTooltip(e){this.tooltip$.next(e)}updateCheckCondition(e){this.checkCondition$.next(e)}updateIcon(e){this.icon$.next(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-actionbar-item"]],inputs:{action:"action",color:"color",withTitle:"withTitle",withIcon:"withIcon",withTooltip:"withTooltip",disabled:"disabled",noDisplay:"noDisplay"},outputs:{trigger:"trigger"},decls:2,vars:2,consts:[["matTooltipClass","actionbarItemTooltip","matTooltipShowDelay","500",3,"matTooltip","ngClass","click",4,"ngIf"],["class","item-checkbox","matTooltipClass","actionbarItemTooltip","matTooltipShowDelay","500",3,"matTooltip","ngClass",4,"ngIf"],["matTooltipClass","actionbarItemTooltip","matTooltipShowDelay","500",3,"matTooltip","ngClass","click"],["mat-list-avatar","","mat-icon-button","",3,"color","disabled",4,"ngIf"],["matLine","",4,"ngIf"],["mat-list-avatar","","mat-icon-button","",3,"color","disabled"],[3,"svgIcon",4,"ngIf"],[3,"svgIcon"],["matLine",""],["matTooltipClass","actionbarItemTooltip","matTooltipShowDelay","500",1,"item-checkbox",3,"matTooltip","ngClass"],[3,"checked","change",4,"ngIf"],[3,"checked","change"]],template:function(e,t){1&e&&(r.YNc(0,po,6,10,"mat-list-item",0),r.YNc(1,go,5,9,"mat-list-item",1)),2&e&&(r.Q6J("ngIf",!t.action.checkbox),r.xp6(1),r.Q6J("ngIf",t.action.checkbox))},directives:[h.O5,l.Tg,p.gM,h.mk,n.lW,l.eA,a.Hw,$e.X2,m.oG],pipes:[U.X$,h.Ov],styles:["mat-list-item.igo-actionbar-item-disabled[_ngcontent-%COMP%]{color:#00000042;cursor:default!important}mat-list-item.igo-actionbar-item-no-display[_ngcontent-%COMP%]{display:none}mat-checkbox[_ngcontent-%COMP%]{padding:12px}.item-checkbox[_ngcontent-%COMP%]{height:56px}.item-checkbox[_ngcontent-%COMP%]     .mat-checkbox-label{margin-left:20px}"],changeDetection:0}),e})();function fo(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",5),r.TgZ(1,"button",6),r.NdJ("click",function(){return r.CHM(e),r.oxw(2).scrollUp()}),r.ALo(2,"translate"),r._UZ(3,"mat-icon",7),r.qZA(),r.qZA()}2&e&&(r.xp6(1),r.Q6J("matTooltip",r.lcZ(2,1,"igo.common.actionbar.scrollUp")))}function yo(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-actionbar-item",8),r.NdJ("trigger",function(){r.CHM(e);const t=r.oxw(2);return t.onTriggerAction(t.toggleCollapseAction)}),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("withTitle",!1)("withIcon",!0)("color",e.color)("disabled",e.store.view.empty)("action",e.toggleCollapseAction)}}function vo(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-actionbar-item",11),r.NdJ("trigger",function(){const t=r.CHM(e).$implicit;return r.oxw(3).onTriggerAction(t)}),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(3);r.Q6J("withTitle",o.withTitle)("withIcon",o.withIcon)("withTooltip",o.withTooltip)("color",o.color)("disabled",o.store.state.get(e).disabled)("action",e)}}function bo(e,t){if(1&e&&(r.YNc(0,vo,1,6,"ng-template",9,10,r.W1O),r.ALo(2,"async")),2&e){const e=r.oxw(2);r.Q6J("ngForOf",r.lcZ(2,1,e.store.view.all$()))}}function xo(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",12),r.TgZ(1,"button",6),r.NdJ("click",function(){return r.CHM(e),r.oxw(2).scrollDown()}),r.ALo(2,"translate"),r._UZ(3,"mat-icon",13),r.qZA(),r.qZA()}2&e&&(r.xp6(1),r.Q6J("matTooltip",r.lcZ(2,1,"igo.common.actionbar.scrollDown")))}function wo(e,t){if(1&e&&(r.TgZ(0,"mat-list"),r.YNc(1,fo,4,3,"div",2),r.YNc(2,yo,1,5,"igo-actionbar-item",3),r.YNc(3,bo,3,3,void 0,0),r.YNc(4,xo,4,3,"div",4),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf",e.heightCondition&&e.positionConditionTop&&e.isDesktop),r.xp6(1),r.Q6J("ngIf",e.withToggleButton),r.xp6(1),r.Q6J("ngIf",!e.collapsed),r.xp6(1),r.Q6J("ngIf",e.heightCondition&&e.positionConditionLow&&e.isDesktop)}}function So(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-actionbar-item",18),r.NdJ("trigger",function(){const t=r.CHM(e).$implicit;return r.oxw(2).onTriggerAction(t)}),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(2);r.Q6J("withTitle",o.withTitle)("withIcon",o.withIcon)("color",o.color)("action",e)}}function Co(e,t){if(1&e&&(r.TgZ(0,"div"),r.TgZ(1,"button",14),r.ALo(2,"translate"),r._UZ(3,"mat-icon",15),r.qZA(),r.TgZ(4,"mat-menu",16,17),r.TgZ(6,"mat-list"),r.YNc(7,So,1,4,"ng-template",9),r.ALo(8,"async"),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.MAs(5),t=r.oxw();r.xp6(1),r.Q6J("matTooltip",r.lcZ(2,10,"igo.common.actionbar.icon"))("matMenuTriggerFor",e)("disabled",t.store.view.empty)("color",t.iconColor),r.xp6(2),r.Q6J("svgIcon",t.icon),r.xp6(1),r.Tol(t.overlayClass),r.Q6J("xPosition",t.xPosition)("yPosition",t.yPosition),r.xp6(3),r.Q6J("ngForOf",r.lcZ(8,12,t.store.view.all$()))}}function To(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-actionbar-item",18),r.NdJ("trigger",function(){const t=r.CHM(e).$implicit;return r.oxw(2).onTriggerAction(t)}),r.qZA(),r._UZ(1,"br")}if(2&e){const e=t.$implicit,o=r.oxw(2);r.Q6J("withTitle",o.withTitle)("withIcon",o.withIcon)("color",o.color)("action",e)}}function Ao(e,t){if(1&e&&(r.TgZ(0,"mat-card",19),r.TgZ(1,"mat-list"),r.YNc(2,To,2,4,"ng-template",9),r.ALo(3,"async"),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(2),r.Q6J("ngForOf",r.lcZ(3,1,e.store.view.all$()))}}let Zo=(()=>{class e{constructor(e,t,o,i){this.overlay=e,this.elRef=t,this.cdRef=o,this.mediaService=i,this.actionbarMode=ao,this.collapsed=!1,this.toggleCollapseAction={id:"actionbar_toggle",icon:"dots-vertical",handler:()=>{this.collapsed=!this.collapsed}},this.heightCondition$=new C.X(!1),this.positionConditionTop$=new C.X(!0),this.positionConditionLow$=new C.X(!0),this.mode=ao.Dock,this.withToggleButton=!1,this.horizontal=!1,this.color="default",this.iconColor="default",this.withTitle=!0,this.withTooltip=!0,this.scrollActive=!0,this.withIcon=!0,this.icon="dots-horizontal",this.xPosition="before",this.yPosition="above",this._overlayClass=""}set overlayClass(e){this._overlayClass=e}get overlayClass(){return[this._overlayClass,"igo-actionbar-overlay"].join(" ")}get withTitleClass(){return this.withTitle}get withIconClass(){return this.withIcon}get horizontalClass(){return this.horizontal}get heightCondition(){const e=this.elRef.nativeElement;return!1===this.scrollActive&&e.clientHeight<e.scrollHeight}get positionConditionTop(){return 0!==this.elRef.nativeElement.scrollTop}get positionConditionLow(){const e=this.elRef.nativeElement;return!(e.scrollTop>=e.scrollHeight-e.clientHeight)}get isDesktop(){return this.mediaService.getMedia()===he.Desktop}ngOnChanges(e){const t=e.store;t&&t.currentValue!==t.previousValue&&(void 0!==this.watcher&&this.watcher.destroy(),this.watcher=new ct(this.store,this.cdRef))}ngOnDestroy(){this.watcher.destroy()}onTriggerAction(e){e.handler(...e.args||[])}scrollDown(){this.elRef.nativeElement.scrollBy(0,52)}scrollUp(){this.elRef.nativeElement.scrollBy(0,-52)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Je.aV),r.Y36(r.SBq),r.Y36(r.sBO),r.Y36(me))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-actionbar"]],hostVars:6,hostBindings:function(e,t){2&e&&r.ekj("with-title",t.withTitleClass)("with-icon",t.withIconClass)("horizontal",t.horizontalClass)},inputs:{store:"store",mode:"mode",withToggleButton:"withToggleButton",horizontal:"horizontal",color:"color",iconColor:"iconColor",withTitle:"withTitle",withTooltip:"withTooltip",scrollActive:"scrollActive",withIcon:"withIcon",icon:"icon",xPosition:"xPosition",yPosition:"yPosition",overlayClass:"overlayClass"},features:[r.TTD],decls:3,vars:3,consts:[[4,"ngIf"],["class","context-menu-card mat-elevation-z4",4,"ngIf"],["id","topChevron",4,"ngIf"],["color","accent",3,"withTitle","withIcon","color","disabled","action","trigger",4,"ngIf"],["id","lowChevron",4,"ngIf"],["id","topChevron"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","click"],["svgIcon","chevron-up"],["color","accent",3,"withTitle","withIcon","color","disabled","action","trigger"],["ngFor","",3,"ngForOf"],["buttonContent",""],["color","accent",3,"withTitle","withIcon","withTooltip","color","disabled","action","trigger"],["id","lowChevron"],["svgIcon","chevron-down"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",1,"buttonOverlay",3,"matTooltip","matMenuTriggerFor","disabled","color"],[3,"svgIcon"],["overlapTrigger","true",1,"igo-compact-menu","igo-no-min-width-menu",3,"xPosition","yPosition"],["actionbarMenu","matMenu"],["color","accent",3,"withTitle","withIcon","color","action","trigger"],[1,"context-menu-card","mat-elevation-z4"]],template:function(e,t){1&e&&(r.YNc(0,wo,5,4,"mat-list",0),r.YNc(1,Co,9,14,"div",0),r.YNc(2,Ao,4,3,"mat-card",1)),2&e&&(r.Q6J("ngIf",t.mode===t.actionbarMode.Dock),r.xp6(1),r.Q6J("ngIf",t.mode===t.actionbarMode.Overlay),r.xp6(1),r.Q6J("ngIf",t.mode===t.actionbarMode.Context))},directives:[h.O5,l.i$,n.lW,p.gM,a.Hw,mo,h.sg,f.p6,f.VK,g.a8],pipes:[U.X$,h.Ov],styles:["[_nghost-%COMP%]{display:block;height:100%;overflow:auto;position:relative}button[_ngcontent-%COMP%]{margin:4px}.buttonOverlay[_ngcontent-%COMP%]{margin:0}mat-list[_ngcontent-%COMP%]{padding-top:0}.horizontal[_nghost-%COMP%]{max-width:100%;overflow:unset}.horizontal[_nghost-%COMP%]   mat-list[_ngcontent-%COMP%]{width:auto;white-space:nowrap}.horizontal[_nghost-%COMP%]   igo-actionbar-item[_ngcontent-%COMP%]{display:inline-block}[_nghost-%COMP%]     .mat-list .mat-list-item .mat-list-text>*{white-space:normal;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;max-height:36px;line-height:18px;-webkit-box-orient:vertical;-webkit-line-clamp:2}[_nghost-%COMP%]     .mat-list-base .mat-list-item.mat-list-item-with-avatar{height:46px}[_nghost-%COMP%]     .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content{display:-webkit-flex;height:46px;padding:3px}[_nghost-%COMP%]     .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content>mat-icon{padding:8px}igo-actionbar-item[_ngcontent-%COMP%]     mat-list-item [mat-list-avatar]{height:auto;width:40px}igo-actionbar-item[_ngcontent-%COMP%]     mat-list-item:hover{cursor:pointer}.context-menu-card[_ngcontent-%COMP%]{padding:8px 3px;margin:10px}#topChevron[_ngcontent-%COMP%]{position:sticky;top:0;background-color:#fff;z-index:3}@media all and (-ms-high-contrast: none),(-ms-high-contrast: active){#topChevron[_ngcontent-%COMP%]{position:fixed;top:unset}}@supports (-ms-accelerator: true){#topChevron[_ngcontent-%COMP%]{position:fixed;top:unset}}#lowChevron[_ngcontent-%COMP%]{position:fixed;position:sticky;bottom:0;background-color:#fff;z-index:3}"],changeDetection:0}),e})(),Lo=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,oe,n.ot,a.Ps,p.AV,f.Tx,l.ie,g.QW,m.p9]]}),e})(),Fo=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[],imports:[[h.ez,Lo],Lo]}),e})(),Oo=(()=>{class e{constructor(e,t){this.el=e,this.matIconRegistry=t,this.hidden=!1,this.disabled=!1,this.inverseColor=!1,this.inheritColor=!1}set igoMatBadgeIcon(e){this.matIconRegistry.getNamedSvgIcon(e).subscribe(e=>{this.svg=e,this.updateSvg()})}set matBadgeHidden(e){this.hidden=e,this.updateHidden()}set matBadgeDisabled(e){this.disabled=e,this.updateDisabled()}set igoMatBadgeInverseColor(e){this.inverseColor=e,this.updateColor()}set igoMatBadgeInheritColor(e){this.inheritColor=e,this.updateColor()}get badge(){return this.el.nativeElement.querySelector(".mat-badge-content")}ngOnInit(){this.badge.style.alignItems="center",this.badge.style.justifyContent="center",this.updateHidden(),this.updateColor(),this.updateSvg()}updateSvg(){!this.badge||(this.badge.innerHTML="",this.svg&&this.badge.appendChild(this.svg))}updateColor(){!this.badge||(this.inheritColor?this.inverseColor?(this.badge.style.color="currentColor",this.badge.style.background="none"):(this.badge.style.color="",this.badge.style.background="currentColor"):this.inverseColor?(this.badge.style.color=window.getComputedStyle(this.badge,null).getPropertyValue("background-color"),this.badge.style.background="none"):(this.badge.style.color="",this.badge.style.background=""),this.originalColor=this.badge.style.color,this.updateDisabled())}updateHidden(){!this.badge||(this.badge.style.display=this.hidden?"none":"flex")}updateDisabled(){!this.badge||!this.inverseColor||(this.disabled?(this.originalColor=this.badge.style.color,this.badge.style.color="#b9b9b9"):this.badge.style.color=this.originalColor)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.SBq),r.Y36(a.jv))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoMatBadgeIcon",""]],inputs:{igoMatBadgeIcon:"igoMatBadgeIcon",matBadgeHidden:"matBadgeHidden",matBadgeDisabled:"matBadgeDisabled",igoMatBadgeInverseColor:"igoMatBadgeInverseColor",igoMatBadgeInheritColor:"igoMatBadgeInheritColor"}}),e})(),Mo=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[Be.g,a.Ps],Be.g]}),e})(),Io=(()=>{class e{constructor(e){this.el=e,this.clickout=new r.vpe}handleMouseClick(e,t){!t||this.el.nativeElement.contains(t)||this.clickout.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.SBq))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoClickout",""]],hostBindings:function(e,t){1&e&&r.NdJ("click",function(e){return t.handleMouseClick(e,e.target)},!1,r.evT)},outputs:{clickout:"clickout"}}),e})(),ko=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[]]}),e})(),Po=(()=>{class e{constructor(e,t){this.renderer=e,this.el=t,this._collapsed=!1,this.toggle=new r.vpe}get target(){return this._target}set target(e){this._target=e}get collapsed(){return this._collapsed}set collapsed(e){e?this.collapseTarget():this.expandTarget(),this._collapsed=e,this.toggle.emit(e)}click(){this.collapsed=!this.collapsed}collapseTarget(){this.renderer.addClass(this.target,"igo-collapsed"),this.renderer.addClass(this.el.nativeElement,"collapsed")}expandTarget(){this.renderer.removeClass(this.target,"igo-collapsed"),this.renderer.removeClass(this.el.nativeElement,"collapsed")}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.Qsj),r.Y36(r.SBq))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoCollapse",""]],hostBindings:function(e,t){1&e&&r.NdJ("click",function(){return t.click()})},inputs:{target:"target",collapsed:"collapsed"},outputs:{toggle:"toggle"}}),e})();const _o=["*"];let $o=(()=>{class e{constructor(){this._title="",this._collapsed=!1,this.toggle=new r.vpe}get title(){return this._title}set title(e){this._title=e}get collapsed(){return this._collapsed}set collapsed(e){this._collapsed=e,this.toggle.emit(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-collapsible"]],inputs:{title:"title",collapsed:"collapsed"},outputs:{toggle:"toggle"},ngContentSelectors:_o,decls:7,vars:3,consts:[["svgIcon","chevron-up","mat-list-avatar","","igoCollapse","",1,"igo-chevron",3,"target","collapsed","toggle"],["matLine",""],["content",""]],template:function(e,t){if(1&e&&(r.F$t(),r.TgZ(0,"mat-list-item"),r.TgZ(1,"mat-icon",0),r.NdJ("toggle",function(e){return t.collapsed=e}),r.qZA(),r.TgZ(2,"h4",1),r._uU(3),r.qZA(),r.qZA(),r.TgZ(4,"div",null,2),r.Hsn(6),r.qZA()),2&e){const e=r.MAs(5);r.xp6(1),r.Q6J("target",e)("collapsed",t.collapsed),r.xp6(2),r.Oqu(t.title)}},directives:[l.Tg,a.Hw,l.eA,Po,$e.X2],styles:["[_nghost-%COMP%]     .mat-list .mat-list-item.mat-list-avatar{height:auto;width:auto;padding:0}mat-list-item[_ngcontent-%COMP%]{overflow:hidden}"]}),e})(),qo=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[a.Ps,l.ie]]}),e})(),Do=(()=>{class e{constructor(e){this.dialogRef=e}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(je.so))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-confirm-dialog"]],decls:12,vars:10,consts:[["mat-dialog-title","",1,"mat-typography"],["mat-dialog-content","",1,"mat-typography"],["mat-dialog-actions",""],["mat-button","","color","primary",3,"click"],["mat-button","",3,"click"]],template:function(e,t){1&e&&(r.TgZ(0,"h2",0),r._uU(1),r.ALo(2,"translate"),r.qZA(),r.TgZ(3,"div",1),r._uU(4),r.qZA(),r.TgZ(5,"div",2),r.TgZ(6,"button",3),r.NdJ("click",function(){return t.dialogRef.close(!0)}),r._uU(7),r.ALo(8,"translate"),r.qZA(),r.TgZ(9,"button",4),r.NdJ("click",function(){return t.dialogRef.close(!1)}),r._uU(10),r.ALo(11,"translate"),r.qZA(),r.qZA()),2&e&&(r.xp6(1),r.Oqu(r.lcZ(2,4,"igo.common.confirmDialog.title")),r.xp6(3),r.Oqu(t.confirmMessage),r.xp6(3),r.Oqu(r.lcZ(8,6,"igo.common.confirmDialog.confirmBtn")),r.xp6(3),r.Oqu(r.lcZ(11,8,"igo.common.confirmDialog.cancelBtn")))},directives:[je.uh,je.xY,je.H8,n.lW],pipes:[U.X$],styles:["h2[_ngcontent-%COMP%]{margin:5px 0 10px}div[mat-dialog-content][_ngcontent-%COMP%]{max-width:200px}div[mat-dialog-actions][_ngcontent-%COMP%]{margin:10px 0 0}"]}),e})(),Eo=(()=>{class e{constructor(e){this.dialog=e}open(e){const t=this.dialog.open(Do,{disableClose:!1});return t.componentInstance.confirmMessage=e,t.afterClosed()}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(je.uw))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})(),Ro=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[Eo],imports:[[n.ot,je.Is,oe]]}),e})(),Uo=(()=>{class e{constructor(e,t,o){this.overlay=e,this.viewContainerRef=t,this.elementRef=o,this.isDragging=!1,this.touchDelayMs=500,this.menuPosition=new r.vpe;const i=(0,L.R)(o.nativeElement,"touchstart"),s=(0,L.R)(o.nativeElement,"touchmove"),n=(0,L.R)(o.nativeElement,"touchend");s.subscribe(()=>{this.isDragging=!0,this.close()}),n.subscribe(()=>this.isDragging=!1);const a=i.pipe((0,Le.b)(e=>{e.preventDefault(),window.document.body.style["-webkit-user-select"]="none"}),(0,Fe.zg)(e=>(0,A.of)(e).pipe((0,Oe.g)(this.touchDelayMs),(0,Me.R)(n))));this.longTouch$$=a.pipe((0,Le.b)(e=>{this.onContextMenu(e)}),(0,Oe.g)(2e3)).subscribe(()=>window.document.body.style["-webkit-user-select"]="auto")}ngOnDestroy(){this.longTouch$$&&this.longTouch$$.unsubscribe(),this.touchmove$$&&this.touchmove$$.unsubscribe(),this.touchend$$&&this.touchend$$.unsubscribe()}onContextMenu(e){if(this.isDragging)return;let t=0,o=0;if(e instanceof TouchEvent){if(e.touches.length>1)return;t=e.touches[0].clientX,o=e.touches[0].clientY}else t=e.x,o=e.y;this.close(),e.preventDefault(),this.menuPosition.emit({x:t,y:o}),this.overlayRef=null;const i=this.overlay.position().flexibleConnectedTo({x:t,y:o}).withPositions([{originX:"end",originY:"bottom",overlayX:"start",overlayY:"top"}]);this.overlayRef=this.overlay.create({positionStrategy:i,scrollStrategy:this.overlay.scrollStrategies.close()}),this.overlayRef.attach(new Ge.UE(this.menuContext,this.viewContainerRef,{$implicit:void 0})),this.sub=(0,L.R)(document,"click").pipe((0,Ie.h)(e=>{const t=e.target;return this.close(),!!this.overlayRef&&!this.overlayRef.overlayElement.contains(t)}),(0,ke.q)(1)).subscribe(()=>this.close()),this.sub=(0,L.R)(document,"contextmenu").pipe((0,Ie.h)(e=>{const t=e.target;if(t&&!this.elementRef.nativeElement.contains(t)&&!this.overlayRef.overlayElement.contains(t))return!0;e.preventDefault()}),(0,ke.q)(1)).subscribe(()=>this.close())}close(){this.overlayRef&&(this.overlayRef.dispose(),this.overlayRef=null),this.sub&&this.sub.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Je.aV),r.Y36(r.s_b),r.Y36(r.SBq))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoContextMenu",""]],hostBindings:function(e,t){1&e&&r.NdJ("contextmenu",function(e){return t.onContextMenu(e)})},inputs:{menuContext:["igoContextMenu","menuContext"],touchDelayMs:"touchDelayMs"},outputs:{menuPosition:"menuPosition"}}),e})(),No=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[]]}),e})(),Jo=(()=>{class e{static forRoot(){return{ngModule:e}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,a.Ps,p.AV,Qe.c,n.ot,oe]]}),e})(),Bo=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[]]}),e})();class jo{constructor(e){this.componentFactory=e,this.subscriptions=[],this.inputs={},this.inputs$$={},this.subscribers={}}setTarget(e){this.target=e,this.componentRef=e.createComponent(this.componentFactory),this.updateInputs(this.inputs),this.updateSubscribers(this.subscribers)}destroy(){void 0!==this.target&&this.target.clear(),void 0!==this.componentRef&&(this.componentRef.destroy(),this.componentRef=void 0),this.unobserveAllInputs(),this.unsubscribeAll()}updateInputs(e){if(this.inputs=e,void 0===this.componentRef)return;const t=this.componentRef.instance;this.componentFactory.inputs.forEach(o=>{const i=o.propName;this.unobserveInput(i);const r=e[i];e.hasOwnProperty(i)&&(r instanceof Se.y?this.observeInput(i,r):this.setInputValue(t,i,r))}),"function"==typeof t.onUpdateInputs&&t.onUpdateInputs()}setInputValue(e,t,o){if(o===e[t])return;const i=Object.getPrototypeOf(e),r=Object.getOwnPropertyDescriptor(i,t);void 0!==r&&void 0!==r.set?r.set.call(e,o):e[t]=o}updateSubscribers(e){if(this.subscribers=e,void 0===this.componentRef)return;const t=this.componentRef.instance;this.componentFactory.outputs.forEach(o=>{const i=o.propName;if(e.hasOwnProperty(i)){const o=t[i],r=e[i];Array.isArray(r)?r.forEach(e=>{this.subscriptions.push(o.subscribe(e))}):this.subscriptions.push(o.subscribe(r))}})}observeInput(e,t){this.inputs$$[e]=t.subscribe(t=>{const o=this.componentRef.instance;this.setInputValue(o,e,t),"function"==typeof o.onUpdateInputs&&o.onUpdateInputs()})}unobserveInput(e){void 0!==this.inputs$$[e]&&(this.inputs$$[e].unsubscribe(),this.inputs$$[e]=void 0)}unobserveAllInputs(){Object.values(this.inputs$$).forEach(e=>{void 0!==e&&e.unsubscribe()}),this.inputs$$={}}unsubscribeAll(){this.subscriptions.forEach(e=>e.unsubscribe()),this.subscriptions=[]}}let Go=(()=>{class e{constructor(e){this.resolver=e}create(e){const t=this.resolver.resolveComponentFactory(e);return new jo(t)}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(r._Vd))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const Qo=["target"];function zo(e,t){}let Yo=(()=>{class e{constructor(e,t){this.dynamicComponentService=e,this.cdRef=t,this.inputs={},this.subscribers={}}ngOnChanges(e){const t=e.component,o=e.inputs,i=e.subscribers,r=_.objectsAreEquivalent;if(t&&t.currentValue!==t.previousValue)this.createComponent(t.currentValue);else{const e=o&&r(o.currentValue||{},o.previousValue||{}),t=i&&r(i.currentValue||{},i.previousValue||{});!1===e&&this.updateInputs(),!1===t&&this.updateSubscribers()}this.cdRef.detectChanges()}ngOnDestroy(){this.dynamicComponent&&this.dynamicComponent.destroy()}createComponent(e){void 0!==this.dynamicComponent&&this.dynamicComponent.destroy(),this.dynamicComponent=e instanceof jo?e:this.dynamicComponentService.create(e),this.renderComponent()}renderComponent(){this.updateInputs(),this.updateSubscribers(),this.dynamicComponent.setTarget(this.target)}updateInputs(){this.dynamicComponent.updateInputs(this.inputs)}updateSubscribers(){this.dynamicComponent.updateSubscribers(this.subscribers)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Go),r.Y36(r.sBO))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-dynamic-outlet"]],viewQuery:function(e,t){if(1&e&&r.Gf(Qo,7,r.s_b),2&e){let e;r.iGM(e=r.CRH())&&(t.target=e.first)}},inputs:{component:"component",inputs:"inputs",subscribers:"subscribers"},features:[r.TTD],decls:2,vars:0,consts:[["target",""]],template:function(e,t){1&e&&r.YNc(0,zo,0,0,"ng-template",null,0,r.W1O)},styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}"],changeDetection:0}),e})(),Ho=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez]]}),e})(),Vo=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[Go],imports:[[h.ez,Ho],Ho]}),e})(),Wo=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[]]}),e})();const Xo=["buttons"],Ko=["*",[["","formButtons",""]]],ei=function(e){return{"igo-form-body-with-buttons":e}},ti=["*","[formButtons]"];let oi=(()=>{class e{constructor(){this.autocomplete="off",this.submitForm=new r.vpe}get hasButtons(){return 0!==this.buttons.nativeElement.children.length}ngOnChanges(e){const t=e.formData;t&&t.currentValue!==t.previousValue&&(void 0===t.currentValue?this.clear():this.setData(t.currentValue))}onSubmit(){this.submitForm.emit(this.getData())}getData(){const e={};return function(e){return e.groups.reduce((e,t)=>e.concat(t.fields),[].concat(e.fields))}(this.form).forEach(t=>{this.updateDataWithFormField(e,t)}),e}setData(e){this.form.fields.forEach(t=>{t.control.setValue((0,xe.ZP)(e,t.name).safeObject)}),this.form.groups.forEach(t=>{t.fields.forEach(t=>{t.control.setValue((0,xe.ZP)(e,t.name).safeObject)})})}updateDataWithFormField(e,t){const o=t.control;o.disabled||(e[t.name]=o.value)}clear(){this.form.control.reset()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-form"]],viewQuery:function(e,t){if(1&e&&r.Gf(Xo,7),2&e){let e;r.iGM(e=r.CRH())&&(t.buttons=e.first)}},inputs:{form:"form",formData:"formData",autocomplete:"autocomplete"},outputs:{submitForm:"submitForm"},features:[r.TTD],ngContentSelectors:ti,decls:7,vars:5,consts:[[3,"autocomplete","formGroup","ngSubmit"],[1,"igo-form-body",3,"ngClass"],[1,"igo-form-content"],[1,"igo-form-buttons"],["buttons",""]],template:function(e,t){1&e&&(r.F$t(Ko),r.TgZ(0,"form",0),r.NdJ("ngSubmit",function(){return t.onSubmit()}),r.TgZ(1,"div",1),r.TgZ(2,"div",2),r.Hsn(3),r.qZA(),r.TgZ(4,"div",3,4),r.Hsn(6,1),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.Q6J("autocomplete",t.autocomplete)("formGroup",t.form.control),r.xp6(1),r.Q6J("ngClass",r.VKq(3,ei,t.hasButtons)))},directives:[ze._Y,ze.JL,ze.sg,h.mk],styles:["[_nghost-%COMP%]{display:block}form[_ngcontent-%COMP%]{width:100%;height:100%}.igo-form-body[_ngcontent-%COMP%], .igo-form-content[_ngcontent-%COMP%]{height:100%}.igo-form-body-with-buttons[_ngcontent-%COMP%]   .igo-form-content[_ngcontent-%COMP%]{height:calc(100% - 56px)}.igo-form-content[_ngcontent-%COMP%]{display:flex}"],changeDetection:0}),e})(),ii=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,ze.u5,ze.UX],ze.u5,ze.UX]}),e})(),ri=(()=>{class e{constructor(e){this.formBuilder=e}form(e,t){const o=this.formBuilder.group({});return e.forEach(e=>{o.addControl(e.name,e.control)}),t.forEach(e=>{o.addControl(e.name,e.control)}),{fields:e,groups:t,control:o}}group(e,t){const o=e.options||{},i=this.formBuilder.group({});t.forEach(e=>{i.addControl(e.name,e.control)});const r=this.getValidators(o.validator);return i.setValidators(r),Object.assign({},e,{fields:t,control:i})}field(e){const t=e.options||{},o=this.formBuilder.control({value:"",disabled:t.disabled}),i=this.getValidators(t.validator);return o.setValidators(i),Object.assign({type:"text"},e,{control:o})}extendFieldConfig(e,t){const o=Object.assign({},e.options||{},t.options||{}),i=Object.assign({},e.inputs||{},t.inputs||{}),r=Object.assign({},e.subscribers||{},t.subscribers||{});return Object.assign({},e,{options:o,inputs:i,subscribers:r})}getValidators(e){return Array.isArray(e)?e.map(e=>this.getValidator(e)):this.getValidator(e)}getValidator(e){if("string"!=typeof e)return e;const t=e.match(/^([a-zA-Z]{3,15})\((.{0,20})\)$/);return t?ze.kI[t[1]](t[2]):ze.kI[e]}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(ze.qu))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),si=(()=>{class e{constructor(){}static register(t,o){e.fields[t]=o}getFieldByType(t){return e.fields[t]}}return e.fields={},e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function ni(e,t){if(1&e&&(r.ynx(0),r._UZ(1,"igo-dynamic-outlet",1),r.BQk()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("component",e.getFieldComponent())("inputs",e.getFieldInputs())("subscribers",e.getFieldSubscribers())}}let ai=(()=>{class e{constructor(e){this.formFieldService=e,this.fieldInputs=void 0,this.fieldSubscribers=void 0}get fieldOptions(){return this.field.options||{}}getFieldComponent(){return this.formFieldService.getFieldByType(this.field.type||"text")}getFieldInputs(){if(void 0!==this.fieldInputs)return this.fieldInputs;const e=this.fieldOptions.errors||{};return this.fieldInputs=Object.assign({placeholder:this.field.title,disableSwitch:this.fieldOptions.disableSwitch||!1},Object.assign({},this.field.inputs||{}),{formControl:this.field.control,errors:Object.assign({},{required:"igo.common.form.errors.required"},e)}),this.fieldInputs}getFieldSubscribers(){return void 0!==this.fieldSubscribers||(this.fieldSubscribers=Object.assign({},this.field.subscribers||{})),this.fieldSubscribers}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(si))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-form-field"]],inputs:{field:"field"},decls:1,vars:1,consts:[[4,"ngIf"],[3,"component","inputs","subscribers"]],template:function(e,t){1&e&&r.YNc(0,ni,2,3,"ng-container",0),2&e&&r.Q6J("ngIf",void 0!==t.field)},directives:[h.O5,Yo],styles:["mat-form-field{width:100%}  .igo-form-disable-switch{margin-right:8px}"],changeDetection:0}),e})(),li=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,ze.u5,ze.UX,a.Ps,Pe.lN,Qe.c,_e.LD,oe,Ho]]}),e})();function ci(e,t){if(1&e&&(r.TgZ(0,"div",5),r._UZ(1,"igo-form-field",6),r.qZA()),2&e){const e=t.$implicit,o=r.oxw(2);r.Q6J("ngClass",o.getFieldNgClass(e)),r.xp6(1),r.Q6J("field",e)}}function ui(e,t){if(1&e&&(r.TgZ(0,"div",3),r.YNc(1,ci,2,2,"div",4),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngForOf",e.group.fields)}}function pi(e,t){if(1&e&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Oqu(r.lcZ(2,1,e.getErrorMessage()))}}const di=["*"];let hi=(()=>{class e{constructor(){}get formControl(){return this.group.control}getFieldColSpan(e){let t=2;const o=e.options||{};return o.cols&&o.cols>0&&(t=Math.min(o.cols,2)),t}getFieldNgClass(e){return{[`igo-form-field-colspan-${this.getFieldColSpan(e)}`]:!0}}getErrorMessage(){return function(e,t){const o=Object.keys(e.errors||{}).map(e=>t[e]).filter(e=>void 0!==e);return o.length>0?o[0]:""}(this.formControl,(this.group.options||{}).errors||{})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-form-group"]],inputs:{group:"group",errors:"errors"},ngContentSelectors:di,decls:4,vars:2,consts:[["class","igo-form-group-fields",4,"ngIf"],[1,"igo-form-group-extra-content"],[4,"ngIf"],[1,"igo-form-group-fields"],["class","igo-form-field-wrapper",3,"ngClass",4,"ngFor","ngForOf"],[1,"igo-form-field-wrapper",3,"ngClass"],[3,"field"]],template:function(e,t){1&e&&(r.F$t(),r.YNc(0,ui,2,1,"div",0),r.TgZ(1,"div",1),r.Hsn(2),r.qZA(),r.YNc(3,pi,3,3,"mat-error",2)),2&e&&(r.Q6J("ngIf",t.group&&t.group.fields.length>0),r.xp6(3),r.Q6J("ngIf",t.formControl.errors))},directives:[h.O5,h.sg,h.mk,ai,Pe.TO],pipes:[U.X$],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:block;overflow:auto;padding:10px 5px}.igo-form-field-wrapper[_ngcontent-%COMP%]{display:inline-block;padding:0 5px}.igo-form-field-colspan-2[_ngcontent-%COMP%]{width:100%}.igo-form-field-colspan-1[_ngcontent-%COMP%]{width:50%}"],changeDetection:0}),e})(),gi=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,Pe.lN,oe,li]]}),e})(),mi=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[ri,si],imports:[[h.ez,gi,li],ii,gi,li]}),e})(),fi=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,ze.u5,_e.LD]]}),e})(),yi=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[]]}),e})(),vi=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[Re.TU]]}),e})(),bi=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[]]}),e})(),xi=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,qe.p0,De.JX,a.Ps,n.ot,m.p9,Re.TU,yi,Jo,vi,bi,oe]]}),e})(),wi=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez],fi,xi,vi]}),e})(),Si=(()=>{class e{constructor(e,t){this.http=e,this.configService=t,this.jsonURL=this.getPathToConfigFile()}loadConfigTour(){this.getJSON().subscribe(e=>{this.allToursOptions=e},e=>{throw new Error("Problem with Interactive tour configuration file: interactiveTour.json not find. Check if the file and is path is set correctly.")})}getPathToConfigFile(){return this.configService.getConfig("interactiveTour.pathToConfigFile")||"./config/interactiveTour.json"}getJSON(){return this.http.get(this.jsonURL).pipe((0,b.K)(e=>{throw e.error.caught=!0,e}))}getTourOptionData(e){if(void 0===this.allToursOptions)return;let t=e;return t=t.replace(/\s/g,""),this.allToursOptions[t]}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(z))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})(),Ci=(()=>{class e{constructor(e,t,o,i,r){this.configService=e,this.mediaService=t,this.languageService=o,this.interactiveTourLoader=i,this.shepherdService=r,this.nextIndex=1,this.isAppHaveTour()&&this.interactiveTourLoader.loadConfigTour()}isAppHaveTour(){const e=this.configService.getConfig("interactiveTour.activateInteractiveTour");return void 0===e||e}isToolHaveTourConfig(e){return void 0!==this.interactiveTourLoader.getTourOptionData(e)}disabledTourButton(e){const t=this.interactiveTourLoader.getTourOptionData(e);if(null==t?void 0:t.conditions)for(const o of null==t?void 0:t.conditions)if(null===document.querySelector(o))return!0;return!1}isMobile(){return this.mediaService.isMobile()}isTourDisplayInMobile(){return void 0===this.configService.getConfig("interactiveTour.tourInMobile")||this.configService.getConfig("interactiveTour.tourInMobile")}getButtons(e){return"noBackButton"===e?[{classes:"shepherd-button-primary",text:this.languageService.translate.instant("igo.common.interactiveTour.nextButton"),type:"next"}]:"first"===e?[{classes:"shepherd-button-secondary",text:this.languageService.translate.instant("igo.common.interactiveTour.exitButton"),type:"cancel"},{classes:"shepherd-button-primary",text:this.languageService.translate.instant("igo.common.interactiveTour.nextButton"),type:"next"}]:"last"===e?[{classes:"shepherd-button-secondary",text:this.languageService.translate.instant("igo.common.interactiveTour.backButton"),type:"back"},{classes:"shepherd-button-primary",text:this.languageService.translate.instant("igo.common.interactiveTour.exitButton"),type:"cancel"}]:[{classes:"shepherd-button-secondary",text:this.languageService.translate.instant("igo.common.interactiveTour.backButton"),type:"back"},{classes:"shepherd-button-primary",text:this.languageService.translate.instant("igo.common.interactiveTour.nextButton"),type:"next"}]}getAction(e){return{click:"click"}[e.toLowerCase()]}addProgress(){const e=this;let t=0;const o=setInterval(()=>{if(e.getCurrentStep()){if(e.getCurrentStep().options.attachTo.element&&!document.querySelector(e.getCurrentStep().options.attachTo.element))return e.cancel(),void clearInterval(o);{const i=e.getCurrentStep().getElement();i&&i.querySelectorAll(".shepherd-content, .shepherd-text").forEach(e=>{e.classList.add("mat-typography")});const r=i?i.querySelector(".shepherd-header"):void 0;if(t++,(r||t>21)&&clearInterval(o),r){const t=e.steps,o=document.createElement("span");o.className="shepherd-progress",o.innerText=`${t.indexOf(e.getCurrentStep())+1}/${t.length}`,r.insertBefore(o,i.querySelector(".shepherd-cancel-icon"))}}}},100)}checkNext(e,t,o){if(t.getCurrentStep()){if(t.getCurrentStep().options.attachTo.element&&document.querySelector(t.getCurrentStep().options.attachTo.element))return void t.complete();if(e.index===t.steps.length-1)return void t.complete();t.steps.splice(e.index,1);const i=t.steps[e.index];i.options.attachTo.element&&!document.querySelector(i.options.attachTo.element)?o.checkNext(e,t,o):(t._setupModal(),t.show(i.id))}}executeAction(e,t){if(!t||t.condition&&("!"===t.condition.charAt(0)&&document.querySelector(t.condition.slice(1))||"!"!==t.condition.charAt(0)&&!document.querySelector(t.condition)))return;const o=document.querySelector(t.element||e.element),i=this.getAction(t.action);o&&i&&o[i]()}executeActionPromise(e,t){return new Promise(o=>{if(this.executeAction(e,t),!t||!t.waitFor)return void o();let i=0;const r=t.maxWait?t.maxWait/100:20,s=setInterval(()=>{i++,(i>r||document.querySelector(t.waitFor))&&(clearInterval(s),o())},100)})}getShepherdSteps(e){const t=[];let o=0;for(const i of e.steps)t.push({attachTo:{element:i.element,on:i.position||e.position},popperOptions:{modifiers:[{name:"offset",options:{offset:[0,15]}}]},beforeShowPromise:()=>Promise.all([this.executeActionPromise(this.previousStep,this.previousStep?this.previousStep.beforeChange:void 0),this.executeActionPromise(i,i.beforeShow)]),buttons:this.getButtons(0===o?"first":o+1===e.steps.length?"last":e.steps[o].noBackButton?"noBackButton":void 0),classes:i.class,highlightClass:i.highlightClass,scrollTo:i.scrollToElement||e.scrollToElement||!0,canClickTarget:i.disableInteraction?!i.disableInteraction:void 0,title:this.languageService.translate.instant(i.title||e.title),text:[this.languageService.translate.instant(i.text)],when:{show:()=>{this.executeAction(i,i.onShow)},hide:()=>{this.previousStep=i,this.executeAction(i,i.onHide)}}}),o++;return t}startTour(e){const t=this.interactiveTourLoader.getTourOptionData(e);this.shepherdService.defaultStepOptions={classes:t.class,highlightClass:t.highlightClass,canClickTarget:!t.disableInteraction||!t.disableInteraction,cancelIcon:{enabled:!0}};const o=this.getShepherdSteps(t);this.shepherdService.modal=!0,this.shepherdService.confirmCancel=!1,this.shepherdService.addSteps(o),this.shepherdService.tourObject.on("show",this.addProgress),this.shepherdService.tourObject.on("cancel",e=>{this.checkNext(e,this.shepherdService.tourObject,this)}),this.shepherdService.start()}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(z),r.LFG(me),r.LFG(ne),r.LFG(Si),r.LFG(Ye.a))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class Ti{constructor(e={}){this.options=e,this.activeTool$=new C.X(void 0),this.toolbar$=new C.X([]),this.activeToolHistory=[],this.store=new lt([],{getKey:e=>e.name}),this.setToolbar(e.toolbar),this.initStore()}get tools$(){return this.store.entities$}destroy(){this.activeTool$$.unsubscribe(),this.store.destroy()}getTool(e){return this.store.get(e)}getTools(){return this.store.all()}setTools(e){this.store.load(e)}getToolbar(){return this.toolbar$.getValue()}setToolbar(e){this.toolbar$.next(e||[])}activateTool(e,t={}){const o=this.getTool(e);void 0!==o&&this.store.state.update(o,{active:!0,options:t},!0)}activatePreviousTool(){if(this.activeToolHistory.length<=1)return void this.deactivateTool();const[e,t]=this.activeToolHistory.splice(-2,2);this.activateTool(e)}deactivateTool(){this.clearActiveToolHistory(),this.store.state.updateAll({active:!1})}initStore(){this.store=new lt([],{getKey:e=>e.name}),this.activeTool$$=this.store.stateView.firstBy$(e=>!0===e.state.active).subscribe(e=>{if(void 0===e)return void this.setActiveTool(void 0);const t=e.entity,o=Object.assign({},t.options||{},e.state.options||{});this.setActiveTool(Object.assign({},t,{options:o}))})}setActiveTool(e){this.activeTool$.next(e),void 0===e?this.clearActiveToolHistory():this.activeToolHistory=this.activeToolHistory.filter(t=>t!==e.name).concat([e.name])}clearActiveToolHistory(){this.activeToolHistory=[]}}let Ai=(()=>{class e{constructor(){this.toolbox=new Ti,this.toolbox.setTools(this.getTools())}static register(t){e.tools[t.name]=t}getTool(t){return e.tools[t]}getTools(){return Object.values(e.tools)}}return e.tools={},e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Zi(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",1),r.NdJ("click",function(){return r.CHM(e),r.oxw().startInteractiveTour()}),r.TgZ(1,"span",2),r._uU(2),r.ALo(3,"translate"),r.ALo(4,"translate"),r.ALo(5,"async"),r.qZA(),r._UZ(6,"mat-icon",3),r.ALo(7,"translate"),r.ALo(8,"translate"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("ngClass",e.getClass())("disabled",e.disabledTourButton),r.xp6(2),r.AsE("",r.lcZ(3,5,"igo.common.interactiveTour.buttonTitle")," ",r.lcZ(4,7,r.lcZ(5,9,e.discoverTitleInLocale$)),""),r.xp6(4),r.Q6J("matTooltip",e.disabledTourButton?r.lcZ(7,11,"igo.common.interactiveTour.disaledTooltipTourToolButton"):r.lcZ(8,13,"igo.common.interactiveTour.tooltipTourToolButton"))}}let Li=(()=>{class e{constructor(e,t){this.interactiveTourService=e,this.toolService=t,this.tourToStart="",this.discoverTitleInLocale$=(0,A.of)("IGO")}getClass(){return{"tour-button-tool-icon":"icon"===this.styleButton,"tour-button-tool":"raised"===this.styleButton}}get toolbox(){return this.toolService.toolbox}getTourToStart(){return this.tourToStart?this.tourToStart:this.activeToolName}get activeToolName(){if(this.toolbox)return this.isActiveTool?this.toolbox.activeTool$.getValue().name:"global"}get isActiveTool(){if(this.toolbox)return void 0!==this.toolbox.activeTool$.getValue()}get isToolHaveTour(){return!("about"===this.activeToolName&&!this.tourToStart)&&this.interactiveTourService.isToolHaveTourConfig(this.getTourToStart())}get showTourButton(){let e,t;return e=this.isToolHaveTour,!1!==e&&!(this.interactiveTourService.isMobile()&&(t=this.isTourDisplayInMobile,!1===t))}get isTourDisplayInMobile(){return this.interactiveTourService.isTourDisplayInMobile()}get disabledTourButton(){return this.interactiveTourService.disabledTourButton(this.activeToolName)}startInteractiveTour(){const e=this.getTourToStart();e&&this.interactiveTourService.startTour(e)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Ci),r.Y36(Ai))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-interactive-tour"]],inputs:{tourToStart:"tourToStart",styleButton:"styleButton",discoverTitleInLocale$:"discoverTitleInLocale$"},decls:1,vars:1,consts:[["mat-raised-button","","tooltip-position","below","matTooltipShowDelay","500",3,"ngClass","disabled","click",4,"ngIf"],["mat-raised-button","","tooltip-position","below","matTooltipShowDelay","500",3,"ngClass","disabled","click"],[1,"interactive-tour-button-title"],["svgIcon","presentation-play",3,"matTooltip"]],template:function(e,t){1&e&&r.YNc(0,Zi,9,15,"button",0),2&e&&r.Q6J("ngIf",t.showTourButton)},directives:[h.O5,n.lW,h.mk,a.Hw,p.gM],pipes:[U.X$,h.Ov],styles:[".shepherd-has-title .shepherd-content .shepherd-header{padding:.5em .75em}.shepherd-title{margin:0!important;font-weight:revert!important}.shepherd-progress{margin-right:15px;color:#737373}.shepherd-text{font-size:14px!important}.shepherd-element{border:1px solid;border-color:#474747;box-shadow:4px 5px #65656599}\n"],encapsulation:2}),e})(),Fi=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[Ci,Si],imports:[[h.ez,a.Ps,n.ot,p.AV,oe]]}),e})(),Oi=(()=>{class e{transform(e,t){const o=[];return Object.getOwnPropertyNames(e).forEach(t=>o.push({key:t,value:e[t]})),o}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=r.Yjl({name:"keyvalue",type:e,pure:!0}),e})(),Mi=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[]]}),e})(),Ii=(()=>{class e{constructor(e,t){this.renderer=e,this.el=t,this._color="primary",this._focused=!1,this._selected=!1,this._disabled=!1,this.beforeSelect=new r.vpe,this.beforeFocus=new r.vpe,this.beforeUnselect=new r.vpe,this.beforeUnfocus=new r.vpe,this.beforeDisable=new r.vpe,this.beforeEnable=new r.vpe,this.focus=new r.vpe,this.unfocus=new r.vpe,this.select=new r.vpe,this.unselect=new r.vpe,this.disable=new r.vpe,this.enable=new r.vpe}get color(){return this._color}set color(e){this._color=e}get focused(){return this._focused}set focused(e){e!==this._focused&&(this.disabled||(e?this.beforeFocus.emit(this):this.beforeUnfocus.emit(this),this._focused=e,!0!==this.selected&&this.toggleFocusedClass(),e?this.focus.emit(this):this.unfocus.emit(this)))}get selected(){return this._selected}set selected(e){e!==this._selected&&(this.disabled||(e?this.beforeSelect.emit(this):this.beforeUnselect.emit(this),this._selected=e,this._focused=e,this.toggleSelectedClass(),e?this.select.emit(this):this.unselect.emit(this)))}get disabled(){return this._disabled}set disabled(e){e!==this._disabled&&(!0===e&&(this.selected=!1),e?this.beforeDisable.emit(this):this.beforeEnable.emit(this),this._disabled=e,this.toggleDisabledClass(),e?this.disable.emit(this):this.enable.emit(this))}onClick(){this.selected=!0}getOffsetTop(){return this.el.nativeElement.offsetTop-5}toggleFocusedClass(){this.focused?this.addCls(e.focusedCls):this.removeCls(e.focusedCls)}toggleSelectedClass(){this.selected?(this.addCls(e.selectedCls),this.removeCls(e.focusedCls)):this.removeCls(e.selectedCls)}toggleDisabledClass(){this.disabled?this.addCls(e.disabledCls):this.removeCls(e.disabledCls)}addCls(e){this.renderer.addClass(this.el.nativeElement,e)}removeCls(e){this.renderer.removeClass(this.el.nativeElement,e)}}return e.focusedCls="igo-list-item-focused",e.selectedCls="igo-list-item-selected",e.disabledCls="igo-list-item-disabled",e.\u0275fac=function(t){return new(t||e)(r.Y36(r.Qsj),r.Y36(r.SBq))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoListItem",""]],hostBindings:function(e,t){1&e&&r.NdJ("click",function(){return t.onClick()})},inputs:{color:"color",focused:"focused",selected:"selected",disabled:"disabled"},outputs:{beforeSelect:"beforeSelect",beforeFocus:"beforeFocus",beforeUnselect:"beforeUnselect",beforeUnfocus:"beforeUnfocus",beforeDisable:"beforeDisable",beforeEnable:"beforeEnable",focus:"focus",unfocus:"unfocus",select:"select",unselect:"unselect",disable:"disable",enable:"enable"}}),e})();const ki=function(e){return{selectable:e}},Pi=["*"];let _i=(()=>{class e{constructor(e){this.el=e,this._navigation=!0,this._selection=!0,this.subscriptions=[]}get navigation(){return this._navigation}set navigation(e){this._navigation=e}get selection(){return this._selection}set selection(e){this._selection=e}get selectedItem(){return this._selectedItem}set selectedItem(e){this.focusedItem=e,this._selectedItem=e}get focusedItem(){return this._focusedItem}set focusedItem(e){this._focusedItem=e}handleKeyboardEvent(e){this.navigationEnabled&&("ArrowUp"===e.key||"ArrowDown"===e.key?(e.preventDefault(),this.navigate(e.key)):"Enter"===e.key&&this.select(this.focusedItem))}ngOnInit(){this.enableNavigation()}ngAfterViewInit(){this.listItems.length&&this.init(),this.listItems$$=this.listItems.changes.subscribe(e=>this.init())}ngOnDestroy(){this.listItems$$.unsubscribe()}focus(e){!this.selection||(this.unfocus(),void 0!==e&&(e.focused=!0))}unfocus(){void 0!==this.focusedItem&&(this.focusedItem.focused=!1),this.focusedItem=void 0}focusNext(){const e=this.listItems.toArray();let t;const o=this.el.nativeElement;let i=!0,r=this.getFocusedIndex();for(void 0===r&&(r=-1);i&&r<e.length-1;)r+=1,t=e[r],i=t.disabled;void 0!==t&&this.focus(t),e[r+1]?void 0!==t&&!this.isScrolledIntoView(t.el.nativeElement)&&(o.scrollTop=t.el.nativeElement.offsetTop+t.el.nativeElement.children[0].offsetHeight-o.clientHeight):o.scrollTop=o.scrollHeight-o.clientHeight}focusPrevious(){const e=this.listItems.toArray();let t;const o=this.el.nativeElement;let i=!0,r=this.getFocusedIndex();for(;i&&r>0;)r-=1,t=e[r],i=t.disabled;void 0!==t&&this.focus(t),e[r-1]?void 0===t||this.isScrolledIntoView(t.el.nativeElement)||(o.scrollTop=t.el.nativeElement.offsetTop-3):o.scrollTop=0}select(e){!this.selection||(this.unselect(),void 0!==e&&(e.selected=!0))}unselect(){this.unfocus(),void 0!==this.selectedItem&&(this.selectedItem.selected=!1),this.selectedItem=void 0}enableNavigation(){this.navigation&&(this.navigationEnabled=!0)}disableNavigation(){this.navigationEnabled=!1}scrollToItem(e){this.el.nativeElement.scrollTop=e.getOffsetTop()}isScrolledIntoView(e){const t=this.el.nativeElement.scrollTop+this.el.nativeElement.offsetTop,o=e.offsetTop;return o+e.children[0].offsetHeight<=t+this.el.nativeElement.clientHeight&&o>=t}init(){this.subscribe(),this.selectedItem=this.findSelectedItem(),this.focusedItem=this.findFocusedItem(),this.enableNavigation()}subscribe(){this.unsubscribe(),this.listItems.toArray().forEach(e=>{this.subscriptions.push(e.beforeSelect.subscribe(e=>this.handleItemBeforeSelect(e))),this.subscriptions.push(e.select.subscribe(e=>this.handleItemSelect(e))),this.subscriptions.push(e.beforeFocus.subscribe(e=>this.handleItemBeforeFocus(e))),this.subscriptions.push(e.focus.subscribe(e=>this.handleItemFocus(e)))},this)}unsubscribe(){this.subscriptions.forEach(e=>e.unsubscribe()),this.subscriptions=[]}handleItemBeforeFocus(e){e!==this.focusedItem&&this.unfocus()}handleItemFocus(e){this.focusedItem=e}handleItemBeforeSelect(e){e!==this.focusedItem&&this.unselect()}handleItemSelect(e){this.selectedItem=e}findSelectedItem(){return this.listItems.toArray().find(e=>e.selected)}findFocusedItem(){return this.listItems.toArray().find(e=>e.focused)}getFocusedIndex(){return this.listItems.toArray().findIndex(e=>e===this.focusedItem)}navigate(e){switch(e){case"ArrowUp":this.focusPrevious();break;case"ArrowDown":this.focusNext()}}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.SBq))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-list"]],contentQueries:function(e,t,o){if(1&e&&r.Suo(o,Ii,5),2&e){let e;r.iGM(e=r.CRH())&&(t.listItems=e)}},hostBindings:function(e,t){1&e&&r.NdJ("keydown",function(e){return t.handleKeyboardEvent(e)},!1,r.evT)("enter",function(e){return t.handleKeyboardEvent(e)},!1,r.evT)},inputs:{navigation:"navigation",selection:"selection"},ngContentSelectors:Pi,decls:2,vars:3,consts:[["igoClickout","",3,"ngClass","clickout","click"]],template:function(e,t){1&e&&(r.F$t(),r.TgZ(0,"mat-list",0),r.NdJ("clickout",function(){return t.disableNavigation()})("click",function(){return t.enableNavigation()}),r.Hsn(1),r.qZA()),2&e&&r.Q6J("ngClass",r.VKq(1,ki,t.selection))},directives:[l.i$,Io,h.mk],styles:["[_nghost-%COMP%]{display:block;height:100%;overflow:auto;position:relative}mat-list[_ngcontent-%COMP%]{padding-top:0}[_nghost-%COMP%]{position:static}[_nghost-%COMP%]     .mat-list .mat-list-item .mat-list-text>*{white-space:normal;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;max-height:36px;line-height:18px;-webkit-box-orient:vertical;-webkit-line-clamp:2}[_nghost-%COMP%]     .mat-list .mat-list-item.mat-list-item-avatar .mat-list-item-content{display:-webkit-flex;height:46px;padding:3px}[_nghost-%COMP%]     .mat-list .mat-list-item.mat-list-item-avatar{height:46px}[_nghost-%COMP%]     .mat-list   igo-collapsible>.mat-list-item>.mat-list-item-content>.mat-list-text>.mat-line{font-weight:bold;opacity:.9}[_nghost-%COMP%]     .mat-list .mat-list-item.mat-list-item-avatar .mat-list-item-content>mat-icon{padding:8px}[_nghost-%COMP%]     [igolistitem] mat-list-item [mat-list-avatar]{height:auto;width:40px}[_nghost-%COMP%]   mat-list.selectable[_ngcontent-%COMP%]     [igolistitem]:not(.igo-list-item-disabled) mat-list-item:hover{cursor:pointer}[_nghost-%COMP%]     [igolistitem]:focus{outline:none}"]}),e})(),$i=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,a.Ps,l.ie,ko]]}),e})();function qi(e,t){if(1&e&&(r.TgZ(0,"div",2),r.TgZ(1,"h3"),r.Hsn(2,1),r.TgZ(3,"div",3),r._uU(4),r.Hsn(5,2),r.qZA(),r.Hsn(6,3),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(4),r.hij(" ",e.title," ")}}const Di=["*",[["","panelLeftButton",""]],[["","panelHeader",""]],[["","panelRightButton",""]]],Ei=["*","[panelLeftButton]","[panelHeader]","[panelRightButton]"];let Ri=(()=>{class e{constructor(){this._withHeader=!0}get title(){return this._title}set title(e){this._title=e}get withHeader(){return this._withHeader}set withHeader(e){this._withHeader=e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-panel"]],hostVars:2,hostBindings:function(e,t){2&e&&r.ekj("igo-panel-with-header",t.withHeader)},inputs:{title:"title",withHeader:"withHeader"},ngContentSelectors:Ei,decls:3,vars:1,consts:[["class","igo-panel-header mat-typography","title","",4,"ngIf"],["title","",1,"igo-panel-content"],["title","",1,"igo-panel-header","mat-typography"],[1,"igo-panel-title"]],template:function(e,t){1&e&&(r.F$t(Di),r.YNc(0,qi,7,1,"div",0),r.TgZ(1,"div",1),r.Hsn(2),r.qZA()),2&e&&r.Q6J("ngIf",t.withHeader)},directives:[h.O5],styles:["[_nghost-%COMP%]{display:block}.igo-panel-header[_ngcontent-%COMP%]{height:46px;padding:3px;text-align:center}.igo-panel-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;height:40px}.igo-panel-header[_ngcontent-%COMP%]     [panelleftbutton]{float:left;margin-right:-40px}.igo-panel-header[_ngcontent-%COMP%]     [panelrightbutton]{float:right}.igo-panel-content[_ngcontent-%COMP%]{overflow:auto}.igo-panel-with-header[_nghost-%COMP%]   .igo-panel-content[_ngcontent-%COMP%]{height:calc(100% - 46px)}[_nghost-%COMP%]:not(.igo-panel-with-header)   .igo-panel-content[_ngcontent-%COMP%]{height:100%}.igo-panel-title[_ngcontent-%COMP%]{display:block;width:calc(100% - 80px);margin-left:40px;height:100%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;line-height:40px;float:left;font-weight:bold;font-size:1.17em}"],changeDetection:0}),e})(),Ui=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez]]}),e})();const Ni=function(e){return{"igo-spinner-container":!0,"igo-spinner-shown":e}};let Ji=(()=>{class e{constructor(){this.shown$=new C.X(!1)}set shown(e){this.shown$.next(e)}get shown(){return this.shown$.value}show(){this.shown=!0}hide(){this.shown=!1}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-spinner"]],inputs:{shown:"shown"},decls:4,vars:5,consts:[[3,"ngClass"],[1,"igo-spinner-background"],["diameter","40","mode","indeterminate"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.ALo(1,"async"),r._UZ(2,"div",1),r._UZ(3,"mat-progress-spinner",2),r.qZA()),2&e&&r.Q6J("ngClass",r.VKq(3,Ni,r.lcZ(1,1,t.shown$)))},directives:[h.mk,He.Ou],pipes:[h.Ov],styles:[".igo-spinner-container[_ngcontent-%COMP%]{display:none;pointer-events:none}.igo-spinner-container.igo-spinner-shown[_ngcontent-%COMP%]{display:block}mat-progress-spinner[_ngcontent-%COMP%]{height:40px;width:40px;border-radius:50%}.igo-spinner-background[_ngcontent-%COMP%]{height:36px;width:36px;border-radius:50%;border:4px solid #ffffff;position:absolute;top:2px;left:2px}"]}),e})(),Bi=(()=>{class e{constructor(e,t){this.spinner=e,this.activityService=t}ngOnInit(){this.counter$$=this.activityService.counter$.pipe((0,w.b)(50)).subscribe(e=>{e>0?this.spinner.show():this.spinner.hide()})}ngOnDestroy(){this.counter$$.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Ji,2),r.Y36(B))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoSpinnerActivity",""]]}),e})(),ji=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,He.Cq]]}),e})();class Gi extends We.o2{constructor(e,t,o){super(),this._database=e,this._model=t,this._sort=o,this._filterChange=new C.X("")}get filter(){return this._filterChange.value}set filter(e){this._filterChange.next(e)}connect(){return this._database?(0,Te.T)(this._database.dataChange,this._filterChange,this._sort.sortChange).pipe((0,x.U)(()=>this.getFilteredData(this._database.data)),(0,x.U)(e=>this.getSortedData(e))):(0,Te.T)([])}disconnect(){}getFilteredData(e){return this.filter?e.slice().filter(e=>-1!==this._model.columns.filter(e=>e.filterable).map(t=>_.resolve(e,t.name)).join(" ").toLowerCase().indexOf(this.filter.toLowerCase())):e}getSortedData(e){return this._sort.active&&""!==this._sort.direction?e.sort((e,t)=>{const o=_.resolve(e,this._sort.active),i=_.resolve(t,this._sort.active);return _.naturalCompare(i,o,this._sort.direction)}):e}}var Qi=(()=>{return(e=Qi||(Qi={}))[e.primary=0]="primary",e[e.accent=1]="accent",e[e.warn=2]="warn",Qi;var e})();const zi=["filter"];function Yi(e,t){1&e&&(r.TgZ(0,"div",12),r.TgZ(1,"mat-form-field",13),r._UZ(2,"input",14,15),r.ALo(4,"translate"),r.qZA(),r.qZA()),2&e&&(r.xp6(2),r.Q6J("placeholder",r.lcZ(4,1,"igo.common.table.filter")))}function Hi(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"th",16),r.TgZ(1,"mat-checkbox",17),r.NdJ("change",function(t){r.CHM(e);const o=r.oxw();return t?o.masterToggle():null}),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(1),r.Q6J("checked",e.selection.hasValue()&&e.isAllSelected())("indeterminate",e.selection.hasValue()&&!e.isAllSelected())}}function Vi(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"td",18),r.TgZ(1,"mat-checkbox",19),r.NdJ("click",function(e){return e.stopPropagation()})("change",function(t){const o=r.CHM(e).$implicit,i=r.oxw();return t?i.selection.toggle(o):null}),r.qZA(),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw();r.xp6(1),r.Q6J("checked",o.selection.isSelected(e))}}function Wi(e,t){if(1&e&&(r.TgZ(0,"th",25),r._uU(1),r.qZA()),2&e){const e=r.oxw(2).$implicit;r.xp6(1),r.hij(" ",e.title," ")}}function Xi(e,t){1&e&&(r.ynx(0),r.YNc(1,Wi,2,1,"th",24),r.BQk())}function Ki(e,t){if(1&e&&(r.TgZ(0,"th",16),r._uU(1),r.qZA()),2&e){const e=r.oxw(2).$implicit;r.xp6(1),r.hij(" ",e.title," ")}}function er(e,t){1&e&&(r.ynx(0),r.YNc(1,Ki,2,1,"th",6),r.BQk())}const tr=function(){return{}};function or(e,t){if(1&e&&(r.TgZ(0,"td",27),r._uU(1),r.qZA()),2&e){const e=t.$implicit,o=r.oxw(2).$implicit,i=r.oxw();r.Q6J("ngClass",i.model.cellClassFunc?i.model.cellClassFunc(e,o):r.DdM(2,tr)),r.xp6(1),r.hij(" ",i.getValue(e,o.name)," ")}}function ir(e,t){1&e&&(r.ynx(0),r.YNc(1,or,2,3,"td",26),r.BQk())}function rr(e,t){if(1&e&&r._UZ(0,"td",29),2&e){const e=t.$implicit,o=r.oxw(2).$implicit,i=r.oxw();r.Q6J("ngClass",i.model.cellClassFunc?i.model.cellClassFunc(e,o):r.DdM(2,tr))("innerHTML",i.getValue(e,o.name),r.oJD)}}function sr(e,t){1&e&&r.YNc(0,rr,1,3,"td",28)}function nr(e,t){if(1&e&&(r.ynx(0,20),r.YNc(1,Xi,2,0,"ng-container",21),r.YNc(2,er,2,0,"ng-container",21),r.YNc(3,ir,2,0,"ng-container",22),r.YNc(4,sr,1,0,"ng-template",null,23,r.W1O),r.BQk()),2&e){const e=t.$implicit,o=r.MAs(5);r.Q6J("matColumnDef",e.name),r.xp6(1),r.Q6J("ngIf",e.sortable),r.xp6(1),r.Q6J("ngIf",!e.sortable),r.xp6(1),r.Q6J("ngIf",!e.html)("ngIfElse",o)}}function ar(e,t){1&e&&r._UZ(0,"th",16)}function lr(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",31),r.NdJ("click",function(t){const o=r.CHM(e).$implicit,i=r.oxw().$implicit;return r.oxw().handleClickAction(t,o,i)}),r._UZ(1,"mat-icon",32),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(2);r.Q6J("color",o.getActionColor(e.color)),r.xp6(1),r.s9C("svgIcon",e.icon)}}function cr(e,t){if(1&e&&(r.TgZ(0,"td",18),r.YNc(1,lr,2,2,"button",30),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngForOf",e.model.actions)}}function ur(e,t){1&e&&r._UZ(0,"tr",33)}function pr(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"tr",34),r.NdJ("click",function(){const t=r.CHM(e).$implicit;return r.oxw().selection.toggle(t)}),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw();r.Q6J("ngClass",o.model.rowClassFunc?o.model.rowClassFunc(e):r.DdM(1,tr))}}let dr=(()=>{class e{constructor(){this._hasFIlterInput=!0,this.selection=new We.Ov(!0,[]),this.select=new r.vpe}get database(){return this._database}set database(e){this._database=e}get model(){return this._model}set model(e){this._model=e}get hasFilterInput(){return this._hasFIlterInput}set hasFilterInput(e){this._hasFIlterInput=e}ngOnInit(){this.dataSource=new Gi(this.database,this.model,this.sort),this.model&&(this.displayedColumns=this.model.columns.filter(e=>!1!==e.displayed).map(e=>e.name),this.model.selectionCheckbox&&this.displayedColumns.unshift("selectionCheckbox"),this.model.actions&&this.model.actions.length&&this.displayedColumns.push("action")),this.selection.changed.subscribe(e=>this.select.emit(e))}ngAfterViewInit(){this.filter&&(0,L.R)(this.filter.nativeElement,"keyup").pipe((0,w.b)(150),(0,M.x)()).subscribe(()=>{!this.dataSource||(this.dataSource.filter=this.filter.nativeElement.value)})}ngOnChanges(e){e.database&&(this.dataSource=new Gi(this.database,this.model,this.sort),this.selection.clear())}getActionColor(e){return Qi[e]}getValue(e,t){return _.resolve(e,t)}isAllSelected(){return this.selection.selected.length===this.database.data.length}masterToggle(){this.isAllSelected()?this.selection.clear():this.database.data.forEach(e=>this.selection.select(e))}handleClickAction(e,t,o){e.stopPropagation(),t.click(o)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-table"]],viewQuery:function(e,t){if(1&e&&(r.Gf(zi,5),r.Gf(De.YE,7)),2&e){let e;r.iGM(e=r.CRH())&&(t.filter=e.first),r.iGM(e=r.CRH())&&(t.sort=e.first)}},inputs:{database:"database",model:"model",hasFilterInput:"hasFilterInput"},outputs:{select:"select"},features:[r.TTD],decls:14,vars:5,consts:[[1,"table-box"],["class","table-header",4,"ngIf"],[1,"table-container"],["mat-table","","matSort","",3,"dataSource"],["table",""],["matColumnDef","selectionCheckbox"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"ngClass","click",4,"matRowDef","matRowDefColumns"],[1,"table-header"],["floatPlaceholder","never"],["matInput","",3,"placeholder"],["filter",""],["mat-header-cell",""],[3,"checked","indeterminate","change"],["mat-cell",""],[3,"checked","click","change"],[3,"matColumnDef"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["cellHTML",""],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell","","class","mat-cell-text",3,"ngClass",4,"matCellDef"],["mat-cell","",1,"mat-cell-text",3,"ngClass"],["mat-cell","","class","mat-cell-text",3,"ngClass","innerHTML",4,"matCellDef"],["mat-cell","",1,"mat-cell-text",3,"ngClass","innerHTML"],["mat-mini-fab","",3,"color","click",4,"ngFor","ngForOf"],["mat-mini-fab","",3,"color","click"],[3,"svgIcon"],["mat-header-row",""],["mat-row","",3,"ngClass","click"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.YNc(1,Yi,5,3,"div",1),r.TgZ(2,"div",2),r.TgZ(3,"table",3,4),r.ynx(5,5),r.YNc(6,Hi,2,2,"th",6),r.YNc(7,Vi,2,1,"td",7),r.BQk(),r.YNc(8,nr,6,5,"ng-container",8),r.ynx(9,9),r.YNc(10,ar,1,0,"th",6),r.YNc(11,cr,2,1,"td",7),r.BQk(),r.YNc(12,ur,1,0,"tr",10),r.YNc(13,pr,1,2,"tr",11),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.xp6(1),r.Q6J("ngIf",t.hasFilterInput),r.xp6(2),r.Q6J("dataSource",t.dataSource),r.xp6(5),r.Q6J("ngForOf",t.model.columns),r.xp6(4),r.Q6J("matHeaderRowDef",t.displayedColumns),r.xp6(1),r.Q6J("matRowDefColumns",t.displayedColumns))},directives:[h.O5,qe.BZ,De.YE,qe.w1,qe.fO,qe.Dz,h.sg,qe.as,qe.nj,Pe.KE,Qe.Nt,qe.ge,m.oG,qe.ev,De.nU,h.mk,n.lW,a.Hw,qe.XQ,qe.Gk],pipes:[U.X$],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:block}.table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;overflow:auto;flex:1 1 auto}.table-box[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}.table-header[_ngcontent-%COMP%]{min-height:64px;max-width:500px;display:flex;flex:0 1 auto;align-items:baseline;padding:8px 24px 0;font-size:20px;justify-content:space-between}tr[mat-header-row][_ngcontent-%COMP%], tr[mat-row][_ngcontent-%COMP%]{height:60px}.mat-cell-text[_ngcontent-%COMP%]{overflow:hidden;word-wrap:break-word}td[mat-cell][_ngcontent-%COMP%]{padding-right:15px}th.mat-header-cell[_ngcontent-%COMP%]{padding-right:5px}button[_ngcontent-%COMP%]{margin-right:10px}"]}),e})(),hr=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,ze.u5,Ve.HT,a.Ps,n.ot,qe.p0,Pe.lN,Qe.c,De.JX,m.p9,oe]]}),e})();class gr extends lt{}var mr=(()=>{return(e=mr||(mr={})).White="white",e.Grey="grey",e.Primary="primary",mr;var e})();function fr(e="300ms",t="ease-in-out"){return(0,Xe.X$)("toolSlideInOut",[(0,Xe.SB)("enter",(0,Xe.oB)({transform:"translate3d(0, 0, 0)"})),(0,Xe.eR)("void => enter",(0,Xe.jt)(e+" "+t))])}function yr(e,t){if(1&e&&(r._UZ(0,"igo-actionbar",2),r.ALo(1,"async"),r.ALo(2,"async"),r.ALo(3,"async")),2&e){const e=r.oxw();r.Q6J("store",e.actionStore)("withIcon",!0)("withTitle",r.lcZ(1,6,e.toolbarWithTitle$))("withTooltip",!r.lcZ(2,8,e.toolbarWithTitle$))("scrollActive",r.lcZ(3,10,e.toolbarWithTitle$))("horizontal",!1)}}const vr=function(e,t){return{"igo-tool-container-with-toolbar":e,"igo-tool-container-with-animation":t}};function br(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",3),r.NdJ("@toolSlideInOut.start",function(){return r.CHM(e),r.oxw().onAnimationStart()})("@toolSlideInOut.done",function(){return r.CHM(e),r.oxw().onAnimationComplete()}),r.ALo(1,"async"),r._UZ(2,"igo-dynamic-outlet",4),r.qZA()}if(2&e){const e=t.ngIf,o=r.oxw();r.Q6J("ngClass",r.WLB(6,vr,!o.actionStore.empty,o.animate))("@toolSlideInOut",r.lcZ(1,4,o.animation$)),r.xp6(2),r.Q6J("component",e.component)("inputs",o.getToolInputs(e))}}let xr=(()=>{class e{constructor(){this.activeTool$=new C.X(void 0),this.actionStore=new gr([]),this.animation$=new C.X("none"),this.toolbar$=new C.X([]),this.toolbarWithTitle$=this.activeTool$.pipe((0,x.U)(e=>void 0===e)),this.animating$=new C.X(!1),this.animate=!1,this.color=mr.White}get classColorGrey(){return this.color===mr.Grey}get classColorPrimary(){return this.color===mr.Primary}ngOnInit(){this.toolbar$$=this.toolbox.toolbar$.subscribe(e=>this.onToolbarChange(e)),this.activeTool$$=this.toolbox.activeTool$.subscribe(e=>this.onActiveToolChange(e))}ngOnDestroy(){this.toolbar$$.unsubscribe(),this.activeTool$$.unsubscribe(),this.actionStore.destroy()}onAnimationStart(){this.animating$.next(!0)}onAnimationComplete(){this.animating$.next(!1)}getToolInputs(e){return e.options||{}}onToolbarChange(e){this.setToolbar(e)}onActiveToolChange(e){this.animate?this.onAnimate(()=>this.setActiveTool(e)):this.setActiveTool(e)}setActiveTool(e){if(void 0===e)this.actionStore.state.updateAll({active:!1});else{const t=this.actionStore.get(e.name);void 0!==t&&this.actionStore.state.update(t,{active:!0},!0)}this.activeTool$.next(e),this.animate&&this.animation$.next("enter")}setToolbar(e){const t=e.reduce((e,t)=>{const o=this.toolbox.getTool(t);return void 0===o||e.push({id:o.name,title:o.title,icon:o.icon,tooltip:o.tooltip,args:[o,this.toolbox],handler:(e,t)=>{t.activateTool(e.name)},ngClass:(e,t)=>this.toolbox.activeTool$.pipe((0,x.U)(t=>{let o=!1;void 0!==t&&e.name===t.name&&(o=!0);let i=!1;return void 0!==t&&e.name===t.parent&&(i=!0),{"tool-activated":o,"children-tool-activated":i}}))}),e},[]);this.actionStore.load(t),this.toolbar$.next(e)}onAnimate(e){this.unAnimate(),this.animating$$=this.animating$.subscribe(t=>{t||(e.call(this),this.unAnimate())})}unAnimate(){this.animating$$&&this.animating$$.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-toolbox"]],hostVars:4,hostBindings:function(e,t){2&e&&r.ekj("color-grey",t.classColorGrey)("color-primary",t.classColorPrimary)},inputs:{toolbox:"toolbox",animate:"animate",color:"color"},decls:4,vars:6,consts:[[3,"store","withIcon","withTitle","withTooltip","scrollActive","horizontal",4,"ngIf"],["class","igo-tool-container",3,"ngClass",4,"ngIf"],[3,"store","withIcon","withTitle","withTooltip","scrollActive","horizontal"],[1,"igo-tool-container",3,"ngClass"],[3,"component","inputs"]],template:function(e,t){1&e&&(r.YNc(0,yr,4,12,"igo-actionbar",0),r.ALo(1,"async"),r.YNc(2,br,3,9,"div",1),r.ALo(3,"async")),2&e&&(r.Q6J("ngIf",r.lcZ(1,2,t.toolbar$).length>0),r.xp6(2),r.Q6J("ngIf",r.lcZ(3,4,t.activeTool$)))},directives:[h.O5,Zo,h.mk,Yo],pipes:[h.Ov],styles:["[_nghost-%COMP%]{display:block;position:relative;overflow:hidden;width:100%;height:100%}.igo-tool-container[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0}.igo-tool-container-with-animation[_ngcontent-%COMP%]{transform:translate(100%)}.igo-tool-container-with-toolbar[_ngcontent-%COMP%]{left:50px}igo-actionbar[_ngcontent-%COMP%]{height:100%}igo-actionbar.with-title[_ngcontent-%COMP%]{width:100%;overflow:auto}igo-actionbar[_ngcontent-%COMP%]:not(.with-title){width:48px;overflow:hidden;-o-box-shadow:2px 0px 2px 0px #dddddd;box-shadow:2px 0 2px #ddd}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){igo-actionbar[_ngcontent-%COMP%]:not(.with-title){overflow:auto}}igo-dynamic-outlet[_ngcontent-%COMP%]{overflow:auto}"],data:{animation:[fr()]},changeDetection:0}),e})(),wr=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,Fo,Vo]]}),e})(),Sr=(()=>{class e{static forRoot(){return{ngModule:e,providers:[Ai]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez],wr]}),e})();function Cr(e,t){if(1&e&&r._UZ(0,"igo-dynamic-outlet",1),2&e){const e=r.oxw();r.Q6J("component",e.widget)("inputs",e.inputs)("subscribers",e.getEffectiveSubscribers())}}let Tr=(()=>{class e{constructor(){this.baseSubscribers={cancel:e=>this.onCancel(e),complete:e=>this.onComplete(e)},this.subscribers={},this.complete=new r.vpe,this.cancel=new r.vpe}ngOnDestroy(){this.destroyWidget()}getEffectiveSubscribers(){const e=Object.assign({},this.subscribers);return Object.keys(this.baseSubscribers).forEach(t=>{const o=e[t],i=this.baseSubscribers[t];e[t]=void 0!==o?e=>{o(e),i(e)}:i}),e}onCancel(e){this.cancel.emit(e),this.destroyWidget()}onComplete(e){this.complete.emit(e),this.destroyWidget()}destroyWidget(){void 0!==this.widget&&this.widget.destroy(),this.widget=void 0}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-widget-outlet"]],inputs:{widget:"widget",inputs:"inputs",subscribers:"subscribers"},outputs:{complete:"complete",cancel:"cancel"},decls:1,vars:1,consts:[[3,"component","inputs","subscribers",4,"ngIf"],[3,"component","inputs","subscribers"]],template:function(e,t){1&e&&r.YNc(0,Cr,1,3,"igo-dynamic-outlet",0),2&e&&r.Q6J("ngIf",t.widget)},directives:[h.O5,Yo],styles:["igo-dynamic-outlet[_ngcontent-%COMP%]{height:100%}"],changeDetection:0}),e})(),Ar=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,Vo]]}),e})(),Zr=(()=>{class e{constructor(e){this.dynamicComponentService=e}create(e){return this.dynamicComponentService.create(e)}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(Go))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Lr=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[Zr],imports:[[h.ez,Ar],Ar]}),e})(),Fr=(()=>{class e{constructor(){this.selectedChange=new r.vpe}getWorkspaceTitle(e){return rt(e)}onSelectedChange(e){const t=e.value;this.store.activateWorkspace(t),this.selectedChange.emit({selected:!0,value:t})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-workspace-selector"]],inputs:{store:"store"},outputs:{selectedChange:"selectedChange"},decls:1,vars:3,consts:[[3,"store","multi","titleAccessor","selectedChange"]],template:function(e,t){1&e&&(r.TgZ(0,"igo-entity-selector",0),r.NdJ("selectedChange",function(e){return t.onSelectedChange(e)}),r.qZA()),2&e&&r.Q6J("store",t.store)("multi",!1)("titleAccessor",t.getWorkspaceTitle)},directives:[ft],styles:["igo-entity-selector[_ngcontent-%COMP%]     mat-form-field .mat-form-field-infix{padding:0}igo-entity-selector[_ngcontent-%COMP%]     mat-form-field .mat-form-field-wrapper{padding-bottom:1.75em}"],changeDetection:0}),e})(),Or=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,fi]]}),e})();function Mr(e,t){if(1&e){const e=r.EpF();r.ynx(0),r.TgZ(1,"igo-widget-outlet",1),r.NdJ("cancel",function(){const t=r.CHM(e).ngIf;return r.oxw().onWidgetCancel(t)})("complete",function(){const t=r.CHM(e).ngIf;return r.oxw().onWidgetComplete(t)}),r.ALo(2,"async"),r.ALo(3,"async"),r.qZA(),r.BQk()}if(2&e){const e=t.ngIf,o=r.oxw();r.xp6(1),r.Q6J("widget",e)("inputs",r.lcZ(2,3,o.widgetInputs$))("subscribers",r.lcZ(3,5,o.widgetSubscribers$))}}let Ir=(()=>{class e{constructor(){this.deactivateWidget=new r.vpe}get widget$(){return this.workspace.widget$}get widgetInputs$(){return this.workspace.widgetInputs$}get widgetSubscribers$(){return this.workspace.widgetSubscribers$}onWidgetCancel(e){this.workspace.deactivateWidget(),this.deactivateWidget.emit(e)}onWidgetComplete(e){this.workspace.deactivateWidget(),this.deactivateWidget.emit(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-workspace-widget-outlet"]],inputs:{workspace:"workspace"},outputs:{deactivateWidget:"deactivateWidget"},decls:2,vars:3,consts:[[4,"ngIf"],[3,"widget","inputs","subscribers","cancel","complete"]],template:function(e,t){1&e&&(r.YNc(0,Mr,4,7,"ng-container",0),r.ALo(1,"async")),2&e&&r.Q6J("ngIf",r.lcZ(1,1,t.widget$))},directives:[h.O5,Tr],pipes:[h.Ov],styles:["igo-widget-outlet[_ngcontent-%COMP%]{height:100%}"],changeDetection:0}),e})(),kr=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,Ar]]}),e})(),Pr=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez],Or,kr]}),e})();class _r{constructor(e){this.dataChange=new C.X([]),e&&this.dataChange.next(e)}get data(){return this.dataChange.value}set(e){this.dataChange.next(e)}add(e){const t=this.data.slice();t.push(e),this.set(t)}remove(e){const t=this.data.slice(),o=t.indexOf(e);t.splice(o,1),this.set(t)}}function $r(e){return t=>{Ai.register(Object.assign({},e,{component:t}))}}class qr extends lt{constructor(){super(...arguments),this.activeWorkspace$=new C.X(void 0)}activateWorkspace(e){const t=this.activeWorkspace$.value;void 0!==t&&t.deactivate(),this.deactivateWorkspace(),void 0!==e&&(this.state.update(e,{active:!0,selected:!0},!0),this.activeWorkspace$.next(e),e.activate())}deactivateWorkspace(){const e=this.activeWorkspace$.value;void 0!==e&&(e.deactivate(),this.activeWorkspace$.next(void 0))}}class Dr{constructor(e){this.options=e,this.widget$=new C.X(void 0),this.widgetInputs$=new C.X({}),this.widgetSubscribers$=new C.X({}),this.change=new O.xQ,this.active$=new C.X(!1)}get id(){return this.options.id}get title(){return this.options.title}get meta(){return this.options.meta||{}}get entityStore(){return this.options.entityStore}get actionStore(){return this.options.actionStore}get widget(){return this.widget$.value}get hasWidget(){return void 0!==this.widget}get active(){return this.active$.value}activate(){!0===this.active&&this.deactivate(),this.active$.next(!0),void 0!==this.entityStore&&(this.entities$$=this.entityStore.stateView.all$().subscribe(()=>this.onStateChange())),this.change.next()}deactivate(){this.active$.next(!1),this.deactivateWidget(),void 0!==this.entities$$&&this.entities$$.unsubscribe(),void 0!==this.change$&&this.change$.unsubscribe()}activateWidget(e,t={},o={}){this.widget$.next(e),this.widgetInputs$.next(t),this.widgetSubscribers$.next(o),this.change.next()}deactivateWidget(){this.widget$.next(void 0),this.change.next()}onStateChange(){this.change.next()}}const Er=d.Bz.forChild([{path:"home",component:(()=>{class e{constructor(e){this.interactiveTourService=e}startTour(){this.interactiveTourService.startTour("global")}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Ci))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-home"]],decls:56,vars:0,consts:[[2,"text-align","center"],["id","igo-title"],["width","180","src","assets/igo2/core/logo.png",1,"igo-logo"],["tourToStart","global","menuIsOpen","true","styleButton","raised"],["target","_blank","rel","noopener","href","https://github.com/infra-geo-ouverte/igo2-lib/blob/master/README.md#user-installation"],["target","_blank","rel","noopener","href","https://angular.io/docs"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"h1",1),r._uU(2," Welcome to IGO "),r.qZA(),r._UZ(3,"img",2),r.qZA(),r.TgZ(4,"p"),r._UZ(5,"igo-interactive-tour",3),r.qZA(),r.TgZ(6,"p"),r._uU(7," IGO2 library contains many components and services that may benefit any web application. "),r._UZ(8,"br"),r._uU(9," IGO2 library is open source project using Angular, Angular Material and OpenLayers.\n"),r.qZA(),r.TgZ(10,"h3"),r._uU(11,"IGO2 library is divided into several elements: "),r.qZA(),r.TgZ(12,"ul"),r.TgZ(13,"li"),r.TgZ(14,"b"),r._uU(15,"@igo2/utils"),r.qZA(),r._uU(16," : Basic utilies without dependency (ex: base64, clipboard, uuid)"),r.qZA(),r.TgZ(17,"li"),r.TgZ(18,"b"),r._uU(19,"@igo2/core"),r.qZA(),r._uU(20," : Element affecting the core of the application (ex: config, language, message, media, request)"),r.qZA(),r.TgZ(21,"li"),r.TgZ(22,"b"),r._uU(23,"@igo2/common"),r.qZA(),r._uU(24," : Library containing reusable components (ex: clickout, drag-drop, list, panel, spinner, table)"),r.qZA(),r.TgZ(25,"li"),r.TgZ(26,"b"),r._uU(27,"@igo2/auth"),r.qZA(),r._uU(28," : Library grouping the authentication and security module"),r.qZA(),r.TgZ(29,"li"),r.TgZ(30,"b"),r._uU(31,"@igo2/geo"),r.qZA(),r._uU(32," : Library containing the geomatic components. Depends on Openlayers."),r.qZA(),r.TgZ(33,"li"),r.TgZ(34,"b"),r._uU(35,"@igo2/context"),r.qZA(),r._uU(36," : Library of components uniting @igo2/geo and @igo2/auth"),r.qZA(),r.TgZ(37,"li"),r.TgZ(38,"b"),r._uU(39,"@igo2/integration"),r.qZA(),r._uU(40," : Library integrate basic components"),r.qZA(),r.qZA(),r.TgZ(41,"h2"),r._uU(42,"Here are some links to help you start: "),r.qZA(),r.TgZ(43,"ul"),r.TgZ(44,"li"),r.TgZ(45,"h2"),r.TgZ(46,"a",4),r._uU(47,"Installation"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(48,"li"),r.TgZ(49,"h2"),r.TgZ(50,"a",5),r._uU(51,"Angular Documentation"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r._uU(52," *** Modules in "),r.TgZ(53,"code"),r._uU(54,"@igo2/core"),r.qZA(),r._uU(55," must be imported only once\n"))},directives:[Li],styles:[""]}),e})()}]);let Rr=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[Er,Fi,p.AV,a.Ps,n.ot]]}),e})();const Ur=d.Bz.forChild([{path:"activity",component:(()=>{class e{constructor(e){this.activityService=e,this.idsActivity=[]}register(){this.idsActivity.push(this.activityService.register())}unregister(){this.activityService.unregister(this.idsActivity.pop())}get counter(){return this.activityService.counter$.value}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(B))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-activity"]],decls:31,vars:1,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/activity"],["mat-raised-button","",3,"click"],["igoSpinnerActivity",""]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Core"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Activity"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"p"),r._uU(7,"Register activities in service. Use to display a loading icon"),r.qZA(),r.TgZ(8,"li"),r._uU(9,"Import "),r.TgZ(10,"code"),r._uU(11,"IgoActivityModule"),r.qZA(),r._uU(12," only if you want register http calls"),r.qZA(),r.TgZ(13,"li"),r._uU(14,"Import "),r.TgZ(15,"code"),r._uU(16,"IgoActivityModule"),r.qZA(),r._uU(17," only once"),r.qZA(),r._UZ(18,"br"),r._uU(19," See the "),r.TgZ(20,"a",0),r._uU(21," code of this example"),r.qZA(),r._UZ(22,"hr"),r.qZA(),r.TgZ(23,"mat-card-actions"),r.TgZ(24,"button",1),r.NdJ("click",function(){return t.register()}),r._uU(25,"Register"),r.qZA(),r.TgZ(26,"button",1),r.NdJ("click",function(){return t.unregister()}),r._uU(27,"Unregister"),r.qZA(),r.qZA(),r.TgZ(28,"p"),r._uU(29),r.qZA(),r._UZ(30,"igo-spinner",2),r.qZA()),2&e&&(r.xp6(29),r.hij("Counter: ",t.counter,""))},directives:[g.a8,g.$j,g.n5,g.dn,g.hq,n.lW,Ji,Bi],styles:[""]}),e})()}]);let Nr=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[Ur,g.QW,n.ot,G.forRoot(),ji]]}),e})();const Jr={production:!0,igo:{projections:[{code:"EPSG:32198",alias:"Quebec Lambert",def:"+proj=lcc +lat_1=60 +lat_2=46 +lat_0=44 +lon_0=-68.5 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs",extent:[-886251.0296,180252.9126,897177.3418,2106143.8139]}],auth:{intern:{enabled:!0},allowAnonymous:!0},interactiveTour:{tourInMobile:!0},importExport:{url:"https://geoegl.msp.gouv.qc.ca/apis/ogre"},language:{prefix:"./locale/"},catalog:{sources:[{id:"Gououvert",title:"Gouvouvert",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi"},{id:"DefiningInfoFormat",title:"Defining info_format",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",queryFormat:{html:"*","application/json":["stations_meteoroutieres","histo_stations_meteoroutieres"]},queryHtmlTarget:"iframe",count:30},{id:"catalogwithregex",title:"Filtered catalog by regex",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",regFilters:["zpegt"]},{id:"catalogwithtooltipcontrol",title:"Controling tooltip format",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",tooltipType:"abstract"}]},searchSources:{nominatim:{enabled:!1},icherche:{searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/icherche",order:2,enabled:!0,params:{limit:"8"}},coordinatesreverse:{showInPointerSummary:!0},icherchereverse:{showInPointerSummary:!0,searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/terrapi",order:3,enabled:!0},ilayer:{searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/layers/search",order:4,enabled:!0,params:{limit:"5"}}}}},Br=d.Bz.forChild([{path:"config",component:(()=>{class e{constructor(e){this.configService=e,this.configLanguage=this.configService.getConfig("language")}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(z))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-config"]],decls:26,vars:3,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/config"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/environments"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Core"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"config"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"p"),r._uU(7,"Load config in your angular application"),r.qZA(),r.TgZ(8,"li"),r._uU(9,"Import "),r.TgZ(10,"code"),r._uU(11,"IgoConfigModule"),r.qZA(),r._uU(12," only once"),r.qZA(),r._UZ(13,"br"),r._uU(14," See the "),r.TgZ(15,"a",0),r._uU(16," code of this example"),r.qZA(),r._UZ(17,"br"),r._uU(18," See the "),r.TgZ(19,"a",1),r._uU(20," environment config"),r.qZA(),r._UZ(21,"hr"),r.qZA(),r.TgZ(22,"p"),r._uU(23),r.ALo(24,"json"),r.qZA(),r._UZ(25,"p"),r.qZA()),2&e&&(r.xp6(23),r.hij("Config language: ",r.lcZ(24,1,t.configLanguage),""))},directives:[g.a8,g.$j,g.n5,g.dn],pipes:[h.Ts],styles:[""]}),e})()}]);let jr=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[H({default:Jr.igo})],imports:[[Br,h.ez,g.QW,n.ot,W.forRoot()]]}),e})();const Gr=d.Bz.forChild([{path:"language",component:(()=>{class e{constructor(e){this.languageService=e,this.app={title:"IGO"}}changeLanguage(e){this.languageService.setLanguage(e),console.log(this.languageService)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ne))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-language"]],decls:35,vars:4,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/language"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/environments"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/locale"],["mat-raised-button","",3,"click"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Core"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"language"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"p"),r._uU(7,"Translate your angular application"),r.qZA(),r.TgZ(8,"li"),r._uU(9,"Import "),r.TgZ(10,"code"),r._uU(11,"IgoLanguageModule"),r.qZA(),r._uU(12," only once"),r.qZA(),r._UZ(13,"br"),r._uU(14," See the "),r.TgZ(15,"a",0),r._uU(16,"code of this example"),r.qZA(),r._UZ(17,"br"),r._uU(18," See language section of the "),r.TgZ(19,"a",1),r._uU(20," environment config"),r.qZA(),r._UZ(21,"br"),r._uU(22," See "),r.TgZ(23,"a",2),r._uU(24,"locale files"),r.qZA(),r._UZ(25,"hr"),r.qZA(),r.TgZ(26,"mat-card-actions"),r.TgZ(27,"button",3),r.NdJ("click",function(){return t.changeLanguage("en")}),r._uU(28,"English"),r.qZA(),r.TgZ(29,"button",3),r.NdJ("click",function(){return t.changeLanguage("fr")}),r._uU(30,"Fran\xe7ais"),r.qZA(),r.qZA(),r.TgZ(31,"p"),r._uU(32),r.ALo(33,"translate"),r.qZA(),r._UZ(34,"p"),r.qZA()),2&e&&(r.xp6(32),r.Oqu(r.xi3(33,1,"welcome",t.app)))},directives:[g.a8,g.$j,g.n5,g.dn,g.hq,n.lW],pipes:[U.X$],styles:[""]}),e})()}]);let Qr=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[Gr,g.QW,n.ot,oe.forRoot()]]}),e})();const zr=d.Bz.forChild([{path:"media",component:(()=>{class e{constructor(e){this.mediaService=e}get media(){return this.mediaService.getMedia()}get orientation(){return this.mediaService.getOrientation()}get isTouchScreen(){return this.mediaService.isTouchScreen()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(me))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-media"]],decls:19,vars:3,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/media"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Core"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Media"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"p"),r._uU(7,"Detect type of media (mobile, tablet, desktop)"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"hr"),r.qZA(),r.TgZ(13,"p"),r._uU(14),r.qZA(),r.TgZ(15,"p"),r._uU(16),r.qZA(),r.TgZ(17,"p"),r._uU(18),r.qZA(),r.qZA()),2&e&&(r.xp6(14),r.hij("Current media: ",t.media,""),r.xp6(2),r.hij("Current orientation: ",t.orientation,""),r.xp6(2),r.hij("Device mode: ",t.isTouchScreen?"Touch device":"Not a touch device ",""))},directives:[g.a8,g.$j,g.n5,g.dn],styles:[""]}),e})()}]);let Yr=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[zr,g.QW]]}),e})();const Hr=d.Bz.forChild([{path:"message",component:(()=>{class e{constructor(e){this.messageService=e}success(){this.messageService.success("Congratulations","Success")}info(){this.messageService.info("Welcome to IGO","Info")}alert(){this.messageService.alert("Warning","Alert")}error(){this.messageService.error("There is a bug","Error")}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(le))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-message"]],decls:30,vars:0,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/message"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","accent",3,"click"],["mat-raised-button","","color","warn",3,"click"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Core"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Message"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"p"),r._uU(7,"Show message to user."),r.qZA(),r.TgZ(8,"li"),r._uU(9,"Import "),r.TgZ(10,"code"),r._uU(11,"IgoMessageModule"),r.qZA(),r._uU(12," only once"),r.qZA(),r.TgZ(13,"li"),r._uU(14,"Dependencies: BrowserAnimationsModule "),r.qZA(),r._UZ(15,"br"),r._uU(16," See the "),r.TgZ(17,"a",0),r._uU(18,"code of this example"),r.qZA(),r._UZ(19,"hr"),r.qZA(),r.TgZ(20,"mat-card-actions"),r.TgZ(21,"button",1),r.NdJ("click",function(){return t.success()}),r._uU(22,"Success message"),r.qZA(),r.TgZ(23,"button",2),r.NdJ("click",function(){return t.info()}),r._uU(24,"Info message"),r.qZA(),r.TgZ(25,"button",3),r.NdJ("click",function(){return t.alert()}),r._uU(26,"Alert message"),r.qZA(),r.TgZ(27,"button",4),r.NdJ("click",function(){return t.error()}),r._uU(28,"Error message"),r.qZA(),r.qZA(),r.qZA(),r._UZ(29,"igo-message-center"))},directives:[g.a8,g.$j,g.n5,g.dn,g.hq,n.lW,re],styles:[""]}),e})()}]);let Vr=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[Hr,g.QW,n.ot,se.forRoot()]]}),e})();const Wr=d.Bz.forChild([{path:"request",component:(()=>{class e{constructor(e,t){this.http=e,this.languageService=t}callHttp(){this.http.get("https://geoegl.msp.gouv.qc.ca/apis/icherche/info").subscribe(e=>{console.log(e)})}callHttpError(){this.http.get("404").subscribe(e=>{console.log(e)})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(y.eN),r.Y36(ne))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-request"]],decls:30,vars:0,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/request"],["mat-raised-button","",3,"click"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Core"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Request"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"p"),r._uU(7,"Register http calls in console"),r.qZA(),r.TgZ(8,"li"),r._uU(9,"Import "),r.TgZ(10,"code"),r._uU(11,"IgoLoggingModule"),r.qZA(),r._uU(12," only if you want register http calls in console"),r.qZA(),r.TgZ(13,"li"),r._uU(14,"Import "),r.TgZ(15,"code"),r._uU(16,"IgoErrorModule"),r.qZA(),r._uU(17," only if you want register errors from http call in console"),r.qZA(),r.TgZ(18,"li"),r._uU(19,"Import modules only once"),r.qZA(),r._UZ(20,"br"),r._uU(21," See the "),r.TgZ(22,"a",0),r._uU(23,"code of this example"),r.qZA(),r._UZ(24,"hr"),r.qZA(),r.TgZ(25,"mat-card-actions"),r.TgZ(26,"button",1),r.NdJ("click",function(){return t.callHttp()}),r._uU(27,"Log"),r.qZA(),r.TgZ(28,"button",1),r.NdJ("click",function(){return t.callHttpError()}),r._uU(29,"Error"),r.qZA(),r.qZA(),r.qZA())},directives:[g.a8,g.$j,g.n5,g.dn,g.hq,n.lW],styles:[""]}),e})()}]);let Xr=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[Wr,g.QW,n.ot,y.JF,oe.forRoot(),ue.forRoot()]]}),e})();function Kr(e,t){if(1&e&&r._UZ(0,"igo-actionbar",4),2&e){const e=r.oxw();r.Q6J("store",e.store)("withIcon",!0)("horizontal",!0)("mode","context")}}const es=d.Bz.forChild([{path:"action",component:(()=>{class e{constructor(e,t,o){this.overlay=e,this.mediaService=t,this.languageService=o,this.store=new gr([]),this.added$=new C.X(!1)}get actionbarMode(){return this.mediaService.media$.value===he.Desktop&&this.mediaService.orientation$.value===ge.Landscape?ao.Dock:ao.Overlay}ngOnInit(){this.store.load([{id:"add",title:"Add",icon:"plus",tooltip:"Add Tooltip",handler:()=>{alert("Add!"),this.added$.next(!0)}},{id:"edit",title:"Edit",icon:"pencil",tooltip:"Edit Tooltip",args:["1"],handler:e=>{alert(`Edit item ${e}!`)},availability:()=>this.added$},{id:"delete",title:"Delete",tooltip:"Delete Tooltip",icon:"delete",handler:()=>{alert("Delete!"),this.added$.next(!1)},availability:()=>this.added$}])}ngOnDestroy(){this.store.destroy()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Je.aV),r.Y36(me),r.Y36(ne))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-action"]],decls:19,vars:6,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/action"],[3,"store","withIcon","withTitle","horizontal","mode"],[3,"igoContextMenu"],["actionbarMenu",""],[3,"store","withIcon","horizontal","mode"]],template:function(e,t){if(1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Common"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Action"),r.qZA(),r.TgZ(5,"mat-card-content"),r._uU(6," See the "),r.TgZ(7,"a",0),r._uU(8,"code of this example"),r.qZA(),r.qZA(),r._UZ(9,"igo-actionbar",1),r.qZA(),r._UZ(10,"p"),r.TgZ(11,"mat-card",2),r.TgZ(12,"mat-card-subtitle"),r._uU(13,"Common"),r.qZA(),r.TgZ(14,"mat-card-title"),r._uU(15,"Action context-menu"),r.qZA(),r._UZ(16,"div"),r.qZA(),r.YNc(17,Kr,1,4,"ng-template",null,3,r.W1O)),2&e){const e=r.MAs(18);r.xp6(9),r.Q6J("store",t.store)("withIcon",!0)("withTitle","overlay"===t.actionbarMode)("horizontal",!0)("mode",t.actionbarMode),r.xp6(2),r.Q6J("igoContextMenu",e)}},directives:[g.a8,g.$j,g.n5,g.dn,Zo,Uo],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e})()}]);let ts=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[es,n.ot,g.QW,Fo,No]]}),e})(),os=(()=>{class e{constructor(e){this.cdRef=e}onUpdateInputs(){this.cdRef.detectChanges()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.sBO))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-salutation-component"]],inputs:{name:"name"},decls:2,vars:1,template:function(e,t){1&e&&(r.TgZ(0,"p"),r._uU(1),r.qZA()),2&e&&(r.xp6(1),r.hij("Hello, my name is ",t.name,"."))},encapsulation:2,changeDetection:0}),e})(),is=(()=>{class e{constructor(e){this.cdRef=e}onUpdateInputs(){this.cdRef.detectChanges()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.sBO))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-explanation-component"]],decls:2,vars:0,template:function(e,t){1&e&&(r.TgZ(0,"p"),r._uU(1,"I am a dynamic component, rendered into an IgoDynamicOutlet."),r.qZA())},encapsulation:2,changeDetection:0}),e})();const rs=d.Bz.forChild([{path:"dynamic-component",component:(()=>{class e{constructor(){this.component=os,this.inputs={name:"Bob"}}toggleComponent(){this.component=this.component===os?is:os}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-dynamic-component"]],decls:12,vars:2,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/dynamic-component"],[3,"component","inputs"],["mat-flat-button","","color","primary",3,"click"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Common"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Dynamic Component"),r.qZA(),r.TgZ(5,"mat-card-content"),r._uU(6," See the "),r.TgZ(7,"a",0),r._uU(8,"code of this example"),r.qZA(),r.qZA(),r._UZ(9,"igo-dynamic-outlet",1),r.TgZ(10,"button",2),r.NdJ("click",function(){return t.toggleComponent()}),r._uU(11,"Toggle Component"),r.qZA(),r.qZA()),2&e&&(r.xp6(9),r.Q6J("component",t.component)("inputs",t.inputs))},directives:[g.a8,g.$j,g.n5,g.dn,Yo,n.lW],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e})()}]);let ss=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[rs,n.ot,g.QW,Vo]]}),e})();const ns=d.Bz.forChild([{path:"entity-table",component:(()=>{class e{constructor(e){this.languageService=e,this.store=new lt([]),this.entitySortChange$=new C.X(!1),this.paginatorOptions={pageSize:10},this.template={selection:!0,selectionCheckbox:!0,selectMany:!0,sort:!0,valueAccessor:(e,t)=>ot(e,t),columns:[{name:"selected",title:"Selected",valueAccessor:e=>this.store.state.get(e).selected?"radiobox-marked":"radiobox-blank",renderer:Ke.Icon},{name:"id",title:"ID"},{name:"name",title:"Name"},{name:"description",title:"Description",renderer:Ke.HTML},{name:"url",title:"Hyperlink"},{name:"image",title:"Image"},{name:"action",title:"",valueAccessor:e=>[{icon:"home",color:"warn",click:e=>{console.log(e)}}],renderer:Ke.ButtonGroup}]}}ngOnInit(){const e=[2,1,3,4,5,6,7,8,9,10,11,12,13].map(e=>({id:e,name:`Name ${e}`,description:`<b>Description ${e}</b>`,url:"https://igouverte.org",image:"https://www.igouverte.org/assets/img/Igo_logoavec.png"}));this.store.load(e)}entitySortChange(){this.entitySortChange$.next(!0)}paginatorChange(e){this.paginator=e}ngOnDestroy(){this.store.destroy()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ne))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-entity-table"]],decls:10,vars:4,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/entity-table"],[3,"store","withPaginator","paginatorOptions","template","entitySortChange"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Common"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Entity Table"),r.qZA(),r.TgZ(5,"mat-card-content"),r._uU(6," See the "),r.TgZ(7,"a",0),r._uU(8,"code of this example"),r.qZA(),r.qZA(),r.TgZ(9,"igo-entity-table",1),r.NdJ("entitySortChange",function(){return t.entitySortChange()}),r.qZA(),r.qZA()),2&e&&(r.xp6(9),r.Q6J("store",t.store)("withPaginator",!0)("paginatorOptions",t.paginatorOptions)("template",t.template))},directives:[g.a8,g.$j,g.n5,g.dn,no],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e})()}]);let as=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[ns,g.QW,xi,vi]]}),e})();function ls(e,t){if(1&e&&(r.TgZ(0,"div"),r.TgZ(1,"p"),r._uU(2),r.qZA(),r.TgZ(3,"p"),r._uU(4),r.qZA(),r.TgZ(5,"p"),r._uU(6,"Description: "),r._UZ(7,"span",3),r.qZA(),r.qZA()),2&e){const e=t.ngIf;r.xp6(2),r.hij("ID: ",e.id,""),r.xp6(2),r.hij("Name: ",e.name,""),r.xp6(3),r.Q6J("innerHtml",e.description,r.oJD)}}const cs=d.Bz.forChild([{path:"entity-selector",component:(()=>{class e{constructor(e){this.languageService=e,this.store=new lt([]),this.selected$=new C.X(void 0)}ngOnInit(){this.store.load([{id:"2",name:"Name 2",description:"<b>Description 2</b>"},{id:"1",name:"Name 1",description:"<b>Description 1</b>"},{id:"3",name:"Name 3",description:"<b>Description 3</b>"}])}ngOnDestroy(){this.store.destroy()}getTitle(e){return e.name}onSelectedChange(e){this.selected$.next(e.entity)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ne))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-entity-selector"]],decls:12,vars:7,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/entity-selector"],[3,"store","titleAccessor","emptyText","placeholder","selectedChange"],[4,"ngIf"],[3,"innerHtml"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Common"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Entity Selector"),r.qZA(),r.TgZ(5,"mat-card-content"),r._uU(6," See the "),r.TgZ(7,"a",0),r._uU(8,"code of this example"),r.qZA(),r.qZA(),r.TgZ(9,"igo-entity-selector",1),r.NdJ("selectedChange",function(e){return t.onSelectedChange(e)}),r.qZA(),r.YNc(10,ls,8,3,"div",2),r.ALo(11,"async"),r.qZA()),2&e&&(r.xp6(9),r.Q6J("store",t.store)("titleAccessor",t.getTitle)("emptyText","")("placeholder","Select an entity"),r.xp6(1),r.Q6J("ngIf",r.lcZ(11,5,t.selected$)))},directives:[g.a8,g.$j,g.n5,g.dn,ft,h.O5],pipes:[h.Ov],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e})()}]);let us=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,cs,g.QW,fi]]}),e})();function ps(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-form",2),r.NdJ("submitForm",function(t){return r.CHM(e),r.oxw().onSubmit(t)}),r.ALo(1,"async"),r._UZ(2,"igo-form-group",3),r.TgZ(3,"div",4),r.TgZ(4,"button",5),r.NdJ("click",function(){return r.CHM(e),r.oxw().fillForm()}),r._uU(5," Fill Form "),r.qZA(),r.TgZ(6,"button",5),r.NdJ("click",function(){return r.CHM(e),r.oxw().clearForm()}),r._uU(7," Clear Form "),r.qZA(),r.TgZ(8,"button",6),r._uU(9," Submit "),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=t.ngIf,o=r.oxw();r.Q6J("form",e)("formData",r.lcZ(1,4,o.data$)),r.xp6(2),r.Q6J("group",e.groups[0]),r.xp6(6),r.Q6J("disabled",o.submitDisabled)}}const ds=d.Bz.forChild([{path:"form",component:(()=>{class e{constructor(e,t){this.formService=e,this.languageService=t,this.form$=new C.X(void 0),this.data$=new C.X(void 0),this.submitDisabled=!0}ngOnInit(){const e=[{name:"id",title:"ID",options:{cols:1,validator:ze.kI.required}},{name:"name",title:"Name",options:{cols:1,validator:ze.kI.required}},{name:"status",title:"Status",type:"select",options:{cols:2},inputs:{choices:[{value:1,title:"Single"},{value:2,title:"Married"}]}}].map(e=>this.formService.field(e)),t=this.formService.form([],[this.formService.group({name:"info"},e)]);this.valueChanges$$=t.control.valueChanges.subscribe(()=>{this.submitDisabled=!t.control.valid}),this.form$.next(t)}ngOnDestroy(){this.valueChanges$$.unsubscribe()}fillForm(){this.data$.next({id:1,name:"Bob",status:2})}clearForm(){this.form$.value.control.reset()}onSubmit(e){alert(JSON.stringify(e))}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ri),r.Y36(ne))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-form"]],decls:11,vars:3,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/form"],[3,"form","formData","submitForm",4,"ngIf"],[3,"form","formData","submitForm"],[3,"group"],["formButtons",""],["mat-stroked-button","","type","button","color","primary",3,"click"],["mat-flat-button","","type","submit","color","primary",3,"disabled"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Common"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Form"),r.qZA(),r.TgZ(5,"mat-card-content"),r._uU(6," See the "),r.TgZ(7,"a",0),r._uU(8,"code of this example"),r.qZA(),r.qZA(),r.YNc(9,ps,10,6,"igo-form",1),r.ALo(10,"async"),r.qZA()),2&e&&(r.xp6(9),r.Q6J("ngIf",r.lcZ(10,1,t.form$)))},directives:[g.a8,g.$j,g.n5,g.dn,h.O5,oi,hi,n.lW],pipes:[h.Ov],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e})()}]);let hs=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,ds,n.ot,g.QW,mi]]}),e})();const gs=d.Bz.forChild([{path:"table",component:(()=>{class e{constructor(e){this.languageService=e,this.model={columns:[{name:"id",title:"ID",sortable:!1,filterable:!0},{name:"name",title:"Name",sortable:!0,filterable:!0},{name:"description",title:"Description",sortable:!0,filterable:!0}],actions:[{icon:"file-document",color:Qi.primary,click:e=>this.showName(e.name)}],selectionCheckbox:!0}}ngOnInit(){this.database=new _r([{id:"2",name:"Name 2",description:"Hello 2"},{id:"1",name:"Name 1",description:"Bonjour 1"},{id:"3",name:"Name 3",description:"Hola 3"}])}showName(e){alert(e)}handleSelect(e){console.log(e)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ne))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-table"]],decls:10,vars:3,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/table"],[3,"database","model","hasFilterInput","select"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Common"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Table"),r.qZA(),r.TgZ(5,"mat-card-content"),r._uU(6," See the "),r.TgZ(7,"a",0),r._uU(8,"code of this example"),r.qZA(),r.qZA(),r.TgZ(9,"igo-table",1),r.NdJ("select",function(e){return t.handleSelect(e)}),r.qZA(),r.qZA()),2&e&&(r.xp6(9),r.Q6J("database",t.database)("model",t.model)("hasFilterInput",!0))},directives:[g.a8,g.$j,g.n5,g.dn,dr],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e})()}]);let ms=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[gs,g.QW,hr]]}),e})();function fs(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",6),r.NdJ("click",function(){return r.CHM(e),r.oxw().toolbox.activatePreviousTool()}),r._UZ(1,"mat-icon",7),r.qZA()}}function ys(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",8),r.NdJ("click",function(){return r.CHM(e),r.oxw().toolbox.deactivateTool()}),r._UZ(1,"mat-icon",9),r.qZA()}}let vs=class{constructor(e){this.cdRef=e}onUpdateInputs(){this.cdRef.detectChanges()}};vs.\u0275fac=function(e){return new(e||vs)(r.Y36(r.sBO))},vs.\u0275cmp=r.Xpm({type:vs,selectors:[["app-salutation-tool"]],inputs:{name:"name"},decls:2,vars:1,template:function(e,t){1&e&&(r.TgZ(0,"p"),r._uU(1),r.qZA()),2&e&&(r.xp6(1),r.hij("Hello, my name is ",t.name,"."))},encapsulation:2,changeDetection:0}),vs=(0,Ue.gn)([$r({name:"demo-salutation",title:"Salutation",icon:"account",options:{name:"Jack"}}),(0,Ue.w6)("design:paramtypes",[r.sBO])],vs);let bs=class{};bs.\u0275fac=function(e){return new(e||bs)},bs.\u0275cmp=r.Xpm({type:bs,selectors:[["app-about-tool"]],decls:2,vars:0,template:function(e,t){1&e&&(r.TgZ(0,"p"),r._uU(1,"I'm a tool inside a toolbox."),r.qZA())},encapsulation:2,changeDetection:0}),bs=(0,Ue.gn)([$r({name:"demo-about",title:"About",icon:"information"})],bs);const xs=d.Bz.forChild([{path:"tool",component:(()=>{class e{constructor(e,t){this.toolService=e,this.languageService=t,this.toolbox=new Ti}get activeTool$(){return this.toolbox.activeTool$}get panelTitle(){return this.activeTool$.value?this.activeTool$.value.title:"Toolbox"}ngOnInit(){this.toolbox.setToolbar(["demo-salutation","demo-about"]),this.toolbox.setTools(this.toolService.getTools())}ngOnDestroy(){this.toolbox.destroy()}activateSalutationTool(){this.toolbox.activateTool("demo-salutation",{name:"Bob"})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Ai),r.Y36(ne))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-tool"]],decls:17,vars:9,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/tool"],[3,"title"],["mat-icon-button","","panelLeftButton","",3,"click",4,"ngIf"],["mat-icon-button","","panelRightButton","",3,"click",4,"ngIf"],[3,"toolbox","animate"],["mat-flat-button","","type","button","color","primary",3,"click"],["mat-icon-button","","panelLeftButton","",3,"click"],["svgIcon","arrow-back"],["mat-icon-button","","panelRightButton","",3,"click"],["svgIcon","menu"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Common"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Tool"),r.qZA(),r.TgZ(5,"mat-card-content"),r._uU(6," See the "),r.TgZ(7,"a",0),r._uU(8,"code of this example"),r.qZA(),r.qZA(),r.TgZ(9,"igo-panel",1),r.YNc(10,fs,2,0,"button",2),r.ALo(11,"async"),r.YNc(12,ys,2,0,"button",3),r.ALo(13,"async"),r._UZ(14,"igo-toolbox",4),r.qZA(),r.TgZ(15,"button",5),r.NdJ("click",function(){return t.activateSalutationTool()}),r._uU(16," Activate Salutation Tool "),r.qZA(),r.qZA()),2&e&&(r.xp6(9),r.Q6J("title",t.panelTitle),r.xp6(1),r.Q6J("ngIf",r.lcZ(11,5,t.activeTool$)),r.xp6(2),r.Q6J("ngIf",r.lcZ(13,7,t.activeTool$)),r.xp6(2),r.Q6J("toolbox",t.toolbox)("animate",!0))},directives:[g.a8,g.$j,g.n5,g.dn,Ri,h.O5,xr,n.lW,a.Hw],pipes:[h.Ov],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e})()}]);let ws=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,xs,n.ot,a.Ps,g.QW,oe,Ui,Sr.forRoot()]]}),e})(),Ss=(()=>{class e{constructor(e){this.cdRef=e,this.complete=new r.vpe,this.cancel=new r.vpe}onUpdateInputs(){this.cdRef.detectChanges()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.sBO))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-salutation-widget"]],inputs:{name:"name"},outputs:{complete:"complete",cancel:"cancel"},decls:6,vars:1,consts:[["mat-flat-button","",3,"click"]],template:function(e,t){1&e&&(r.TgZ(0,"p"),r._uU(1),r.qZA(),r.TgZ(2,"button",0),r.NdJ("click",function(){return t.complete.emit(t.name)}),r._uU(3,"Nice to meet you"),r.qZA(),r.TgZ(4,"button",0),r.NdJ("click",function(){return t.cancel.emit(t.name)}),r._uU(5,"Dismiss"),r.qZA()),2&e&&(r.xp6(1),r.hij("Hello, my name is ",t.name,"."))},directives:[n.lW],encapsulation:2,changeDetection:0}),e})();const Cs=d.Bz.forChild([{path:"widget",component:(()=>{class e{constructor(e){this.widgetService=e,this.widget=this.widgetService.create(Ss),this.inputs={name:"Bob"}}onWidgetComplete(e){alert(`${e} emitted event 'complete' then got automatically destroyed.`)}onWidgetCancel(){alert("Widget emitted event 'cancel' then got automatically destroyed.")}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Zr))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-widget"]],decls:10,vars:2,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/widget"],[3,"widget","inputs","complete","cancel"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Common"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Widget"),r.qZA(),r.TgZ(5,"mat-card-content"),r._uU(6," See the "),r.TgZ(7,"a",0),r._uU(8,"code of this example"),r.qZA(),r.qZA(),r.TgZ(9,"igo-widget-outlet",1),r.NdJ("complete",function(e){return t.onWidgetComplete(e)})("cancel",function(){return t.onWidgetCancel()}),r.qZA(),r.qZA()),2&e&&(r.xp6(9),r.Q6J("widget",t.widget)("inputs",t.inputs))},directives:[g.a8,g.$j,g.n5,g.dn,Tr],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e})()}]);let Ts=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[Cs,n.ot,g.QW,Lr]]}),e})();var As=o(30400),Zs=o(74192),Ls=o.n(Zs),Fs=o(50836),Os=o(41389),Ms=o(55347),Is=o(1754),ks=o(37822),Ps=o(30999);let _s=(()=>{class e{constructor(e){this.injector=e}set(e){localStorage.setItem(this.tokenKey,e)}remove(){localStorage.removeItem(this.tokenKey)}get(){return localStorage.getItem(this.tokenKey)}decode(){const e=this.get();if(e)return Ls()(e)}isExpired(){const e=this.decode(),t=(new Date).getTime()/1e3;return!(e&&t<e.exp)}get tokenKey(){const e=this.injector.get(z);return this.options=e.getConfig("auth")||{},this.options.tokenKey}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(r.zs3))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),$s=(()=>{class e{constructor(e,t,o,i,r,s){this.http=e,this.tokenService=t,this.config=o,this.languageService=i,this.messageService=r,this.router=s,this.authenticate$=new C.X(void 0),this.logged$=new C.X(void 0),this.anonymous=!1,this.authenticate$.next(this.authenticated),this.authenticate$.subscribe(e=>{this.logged$.next(e),Ne.h.next()})}get hasAuthService(){return void 0!==this.config.getConfig("auth.url")}login(e,t){const o=new y.WM({"Content-Type":"application/json"}),i={username:e,password:this.encodePassword(t)};return this.loginCall(i,o)}loginWithToken(e,t,o){const i=new y.WM({"Content-Type":"application/json"});return this.loginCall({token:e,typeConnection:t,infosUser:o},i)}loginAnonymous(){return this.anonymous=!0,this.logged$.next(!0),(0,A.of)(!0)}refresh(){const e=this.config.getConfig("auth.url");return this.http.post(`${e}/refresh`,{}).pipe((0,Le.b)(e=>{this.tokenService.set(e.token)}),(0,b.K)(e=>{throw e.error.caught=!0,e}))}logout(){return this.anonymous=!1,this.tokenService.remove(),this.authenticate$.next(!1),(0,A.of)(!0)}isAuthenticated(){return!this.tokenService.isExpired()}getToken(){return this.tokenService.get()}decodeToken(){return!!this.isAuthenticated()&&this.tokenService.decode()}goToRedirectUrl(){if(!this.router)return;const e=this.redirectUrl||this.router.url,t=this.config.getConfig("auth")||{};e===t.loginRoute?this.router.navigateByUrl(t.homeRoute||"/"):e&&this.router.navigateByUrl(e)}getUserInfo(){const e=this.config.getConfig("auth.url")+"/info";return this.http.get(e)}getProfils(){const e=this.config.getConfig("auth.url");return this.http.get(`${e}/profils`)}updateUser(e){const t=this.config.getConfig("auth.url");return this.http.patch(t,e)}encodePassword(e){return I.encode(e)}get logged(){return this.authenticated||this.isAnonymous}get isAnonymous(){return this.anonymous}get authenticated(){return this.isAuthenticated()}get isAdmin(){const e=this.decodeToken();return!!(e&&e.user&&e.user.isAdmin)}loginCall(e,t){const o=this.config.getConfig("auth.url");return this.http.post(`${o}/login`,e,{headers:t}).pipe((0,Le.b)(e=>{this.tokenService.set(e.token);const t=this.decodeToken();t&&t.user&&(t.user.locale&&this.languageService.setLanguage(t.user.locale),t.user.isExpired&&this.languageService.translate.get("igo.auth.error.Password expired").subscribe(e=>this.messageService.alert(e))),this.authenticate$.next(!0)}),(0,b.K)(e=>{throw e.error.caught=!0,e}))}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(_s),r.LFG(z),r.LFG(ne),r.LFG(le),r.LFG(d.F0,8))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),qs=(()=>{class e{constructor(e,t,o,i){this.authService=e,this.config=t,this.languageService=o,this.appRef=i,this.login=new r.vpe,this.options=this.config.getConfig("auth.google")||{},this.options.apiKey&&this.options.clientId?(this.loadSDKGoogle(),this.loadPlatform()):console.warn('Google authentification needs "apiKey" and "clientId" options')}handleSignInClick(){window.gapi.auth2.getAuthInstance().signIn()}handleSignOutClick(){window.gapi.auth2.getAuthInstance().signOut()}handleClientLoad(){window.gapi.load("client:auth2",()=>this.initClient())}initClient(){window.gapi.client.init({apiKey:this.options.apiKey,clientId:this.options.clientId,discoveryDocs:["https://people.googleapis.com/$discovery/rest?version=v1"],scope:"profile"}).then(()=>{this.handleSignOutClick(),this.updateTextButton(),window.gapi.auth2.getAuthInstance().isSignedIn.listen(e=>{this.updateSigninStatus(e)})})}updateSigninStatus(e){this.updateTextButton(),e&&this.loginGoogle(window.gapi.client.getToken().access_token)}updateTextButton(){const e=document.querySelector('span[id^="not_signed_"]');e&&"en"!==this.languageService.getLanguage()&&("Sign in with Google"===e.innerHTML?e.innerHTML=this.languageService.translate.instant("igo.auth.google.login"):"Signed in with Google"===e.innerHTML&&(e.innerHTML=this.languageService.translate.instant("igo.auth.google.logged")))}loginGoogle(e){this.authService.loginWithToken(e,"google").subscribe(()=>{this.appRef.tick(),this.login.emit(!0)})}loadSDKGoogle(){const e=document.getElementsByTagName("script")[0],t=document.createElement("script");t.id="google-jssdk",t.src="https://apis.google.com/js/api.js",t.onload=()=>{this.handleClientLoad()},e.parentNode.insertBefore(t,e)}loadPlatform(){const e=document.getElementsByTagName("script")[0],t=document.createElement("script");t.id="google-platform",t.src="https://apis.google.com/js/platform.js",e.parentNode.insertBefore(t,e)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36($s),r.Y36(z),r.Y36(ne),r.Y36(r.z2F))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-auth-google"]],outputs:{login:"login"},decls:1,vars:0,consts:[["data-height","40","data-width","265","data-longtitle","true",1,"g-signin2","google-login-button"]],template:function(e,t){1&e&&r._UZ(0,"div",0)},styles:["[_nghost-%COMP%]{padding:10px 10px 10px 0;display:inline-block}.google-login-button[_ngcontent-%COMP%]     .abcRioButton{color:#000000de}"],changeDetection:0}),e})(),Ds=(()=>{class e{constructor(e,t,o,i,s){this.authService=e,this.config=t,this.appRef=o,this.msalService=i,this.msalGuardConfig=s,this._destroying$=new O.xQ,this.login=new r.vpe,this.options=this.config.getConfig("auth.microsoft")||{},this.msalService.instance=new Os.L({auth:this.options,cache:{cacheLocation:"sessionStorage"}}),this.broadcastService=new Fs.J$(this.msalService.instance,this.msalService),this.options.clientId?this.broadcastService.inProgress$.pipe((0,Ie.h)(e=>e===Ms.$H.None),(0,Me.R)(this._destroying$)).subscribe(()=>{this.checkAccount()}):console.warn('Microsoft authentification needs "clientId" option')}loginMicrosoft(){this.msalService.loginPopup(Object.assign({},this.getConf().authRequest)).subscribe(e=>{this.msalService.instance.setActiveAccount(e.account),this.checkAccount()})}checkAccount(){this.msalService.instance.acquireTokenSilent(this.getConf().authRequest).then(e=>{this.authService.loginWithToken(e.accessToken,"microsoft",{tokenId:e.idToken}).subscribe(()=>{this.appRef.tick(),this.login.emit(!0)})}).catch(e=>(0,Ue.mG)(this,void 0,void 0,function*(){if(e instanceof Is.Yo)return this.msalService.acquireTokenPopup(this.getConf().authRequest);console.log(e)})).catch(e=>{console.log("Silent token fails")})}getConf(){return this.msalGuardConfig.filter(e=>"add"===e.type)[0]}}return e.\u0275fac=function(t){return new(t||e)(r.Y36($s),r.Y36(z),r.Y36(r.z2F),r.Y36(Fs.W2),r.Y36(Fs.S9))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-auth-microsoft"]],outputs:{login:"login"},decls:4,vars:3,consts:[["mat-raised-button","",1,"microsoft-login-button",3,"click"],["svgIcon","microsoft"]],template:function(e,t){1&e&&(r.TgZ(0,"button",0),r.NdJ("click",function(){return t.loginMicrosoft()}),r._UZ(1,"mat-icon",1),r._uU(2),r.ALo(3,"translate"),r.qZA()),2&e&&(r.xp6(2),r.hij(" ",r.lcZ(3,1,"igo.auth.microsoft.login"),"\n"))},directives:[n.lW,a.Hw],pipes:[U.X$],styles:["[_nghost-%COMP%]{padding:10px 10px 10px 0;display:inline-block;position:relative;top:-15px}[_nghost-%COMP%] > button[_ngcontent-%COMP%]{font-size:15px;height:40px;width:265px}mat-icon[_ngcontent-%COMP%]{margin-right:10px}"],changeDetection:0}),e})(),Es=(()=>{class e{constructor(e,t){this.instance=e,this.location=t,this.name="@azure/msal-angular",this.version="2.0.0-beta.2";const o=this.location.path(!0).split("#").pop();o&&(this.redirectHash=`#${o}`),this.instance.initializeWrapperLibrary(Ms.lA.Angular,this.version)}acquireTokenPopup(e){return(0,As.D)(this.instance.acquireTokenPopup(e))}acquireTokenRedirect(e){return(0,As.D)(this.instance.acquireTokenRedirect(e))}acquireTokenSilent(e){return(0,As.D)(this.instance.acquireTokenSilent(e))}handleRedirectObservable(e){return(0,As.D)(this.instance.handleRedirectPromise(e||this.redirectHash))}loginPopup(e){return(0,As.D)(this.instance.loginPopup(e))}loginRedirect(e){return(0,As.D)(this.instance.loginRedirect(e))}logout(e){return(0,As.D)(this.instance.logout(e))}logoutRedirect(e){return(0,As.D)(this.instance.logoutRedirect(e))}logoutPopup(e){return(0,As.D)(this.instance.logoutPopup(e))}ssoSilent(e){return(0,As.D)(this.instance.ssoSilent(e))}getLogger(){return this.logger||(this.logger=this.instance.getLogger().clone(this.name,this.version)),this.logger}setLogger(e){this.logger=e.clone(this.name,this.version),this.instance.setLogger(e)}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(Fs.sK),r.LFG(h.Ye))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})(),Rs=(()=>{class e{constructor(e,t){this.msalInstance=e,this.authService=t,this._msalSubject=new O.xQ,this.msalSubject$=this._msalSubject.asObservable(),this._inProgress=new C.X(Ms.$H.Startup),this.inProgress$=this._inProgress.asObservable(),this.msalInstance.addEventCallback(e=>{this._msalSubject.next(e);const t=ks.w.getInteractionStatusFromEvent(e);null!==t&&(this.authService.getLogger().verbose(`BroadcastService - ${e.eventType} results in setting inProgress to ${t}`),this._inProgress.next(t))})}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(Fs.sK),r.LFG(Es))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})(),Us=(()=>{class e{constructor(e,t,o,i,s){this.authService=e,this.config=t,this.appRef=o,this.msalService=i,this.msalGuardConfig=s,this._destroying$=new O.xQ,this.login=new r.vpe,this.options=this.config.getConfig("auth.microsoftb2c")||{},this.msalService.instance=new Os.L({auth:this.options.browserAuthOptions,cache:{cacheLocation:"sessionStorage"}}),this.broadcastService=new Rs(this.msalService.instance,this.msalService),this.options.browserAuthOptions.clientId?this.broadcastService.inProgress$.pipe((0,Ie.h)(e=>e===Ms.$H.None),(0,Me.R)(this._destroying$)).subscribe(()=>{this.checkAccount()}):console.warn('Microsoft authentification needs "clientId" option')}loginMicrosoftb2c(){this.msalService.loginPopup(Object.assign({},this.getConf().authRequest)).subscribe(e=>{this.msalService.instance.setActiveAccount(e.account),this.checkAccount()})}checkAccount(){this.msalService.instance.acquireTokenSilent(this.getConf().authRequest).then(e=>{this.authService.loginWithToken(e.idToken,"microsoftb2c").subscribe(()=>{this.appRef.tick(),this.login.emit(!0)})}).catch(e=>(0,Ue.mG)(this,void 0,void 0,function*(){if(e instanceof Is.Yo)return this.msalService.acquireTokenPopup(this.getConf().authRequest)})).catch(e=>{console.log("Silent token fails")})}getConf(){return this.msalGuardConfig.filter(e=>"b2c"===e.type)[0]}}return e.\u0275fac=function(t){return new(t||e)(r.Y36($s),r.Y36(z),r.Y36(r.z2F),r.Y36(Es),r.Y36(Fs.S9))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-auth-microsoftb2c"]],outputs:{login:"login"},decls:4,vars:3,consts:[["mat-raised-button","",1,"microsoft-login-button",3,"click"],["svgIcon","microsoft"]],template:function(e,t){1&e&&(r.TgZ(0,"button",0),r.NdJ("click",function(){return t.loginMicrosoftb2c()}),r._UZ(1,"mat-icon",1),r._uU(2),r.ALo(3,"translate"),r.qZA()),2&e&&(r.xp6(2),r.hij(" ",r.lcZ(3,1,"igo.auth.microsoftb2c.login"),"\n"))},directives:[n.lW,a.Hw],pipes:[U.X$],styles:["[_nghost-%COMP%]{padding:10px 10px 10px 0;display:inline-block;position:relative;top:-15px}[_nghost-%COMP%] > button[_ngcontent-%COMP%]{font-size:15px;height:40px;width:265px}mat-icon[_ngcontent-%COMP%]{margin-right:10px}"],changeDetection:0}),e})(),Ns=(()=>{class e{constructor(e,t,o){this.authService=e,this.config=t,this.appRef=o,this.login=new r.vpe,this.options=this.config.getConfig("auth.facebook")||{},this.options.appId?this.loadSDKFacebook():console.warn('Facebook authentification needs "appId" option')}subscribeEvents(){window.FB.Event.subscribe("auth.statusChange",e=>{this.statusChangeCallback(e)})}statusChangeCallback(e){"connected"===e.status&&this.loginFacebook(e.authResponse.accessToken)}loginFacebook(e){this.authService.loginWithToken(e,"facebook").subscribe(()=>{this.appRef.tick(),this.login.emit(!0)})}loadSDKFacebook(){if(document.getElementById("facebook-jssdk"))return;const e=document.getElementsByTagName("script")[0],t=document.createElement("script");t.id="facebook-jssdk",t.src=`https://connect.facebook.net/fr_CA/sdk.js#xfbml=1&version=v2.9&appId=${this.options.appId}`,t.onload=()=>{this.subscribeEvents()},e.parentNode.insertBefore(t,e)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36($s),r.Y36(z),r.Y36(r.z2F))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-auth-facebook"]],outputs:{login:"login"},decls:1,vars:0,consts:[["scope","public_profile,email","data-max-rows","1","data-size","large","data-button-type","login_with","data-show-faces","false","data-auto-logout-link","false","data-use-continue-as","false",1,"fb-login-button"]],template:function(e,t){1&e&&r._UZ(0,"div",0)},styles:["[_nghost-%COMP%]{padding:10px 10px 10px 0;display:inline-block;position:relative;top:-3px}"],changeDetection:0}),e})();function Js(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",7),r.NdJ("click",function(){return r.CHM(e),r.oxw().loginAnonymous()}),r._uU(1),r.ALo(2,"translate"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("disabled",e.loading),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.auth.accessAnonymous")," ")}}function Bs(e,t){if(1&e&&(r.TgZ(0,"div"),r._UZ(1,"br"),r.TgZ(2,"font",8),r._uU(3),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(3),r.Oqu(e.error)}}let js=(()=>{class e{constructor(e,t,o){this.auth=e,this.languageService=t,this._allowAnonymous=!0,this.error="",this.loading=!1,this.login=new r.vpe,this.form=o.group({username:["",ze.kI.required],password:["",ze.kI.required]})}get allowAnonymous(){return this._allowAnonymous}set allowAnonymous(e){this._allowAnonymous=e}loginUser(e){return this.loading=!0,this.auth.login(e.username,e.password).subscribe(()=>{this.login.emit(!0),this.loading=!1},e=>{try{this.languageService.translate.get("igo.auth.error."+e.error.message).subscribe(e=>this.error=e)}catch(t){this.error=e.error.message}this.loading=!1}),!1}loginAnonymous(){this.auth.loginAnonymous().subscribe(()=>{this.login.emit(!0)})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36($s),r.Y36(ne),r.Y36(ze.qu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-auth-intern"]],inputs:{allowAnonymous:"allowAnonymous"},outputs:{login:"login"},decls:14,vars:13,consts:[["role","form",3,"formGroup","ngSubmit"],[1,"full-width"],["matInput","","required","","formControlName","username",3,"placeholder"],["matInput","","required","","type","password","formControlName","password",3,"placeholder"],["mat-raised-button","","type","submit",3,"disabled"],["mat-raised-button","","class","anonymous","type","button",3,"disabled","click",4,"ngIf"],[4,"ngIf"],["mat-raised-button","","type","button",1,"anonymous",3,"disabled","click"],["size","3","color","red"]],template:function(e,t){1&e&&(r.TgZ(0,"form",0),r.NdJ("ngSubmit",function(){return t.loginUser(t.form.value)}),r.TgZ(1,"div"),r.TgZ(2,"mat-form-field",1),r._UZ(3,"input",2),r.ALo(4,"translate"),r.qZA(),r.qZA(),r.TgZ(5,"div"),r.TgZ(6,"mat-form-field",1),r._UZ(7,"input",3),r.ALo(8,"translate"),r.qZA(),r.qZA(),r.TgZ(9,"button",4),r._uU(10),r.ALo(11,"translate"),r.qZA(),r.YNc(12,Js,3,4,"button",5),r.YNc(13,Bs,4,1,"div",6),r.qZA()),2&e&&(r.Q6J("formGroup",t.form),r.xp6(3),r.s9C("placeholder",r.lcZ(4,7,"igo.auth.user")),r.xp6(4),r.s9C("placeholder",r.lcZ(8,9,"igo.auth.password")),r.xp6(2),r.Q6J("disabled",!t.form.valid||t.loading),r.xp6(1),r.Oqu(r.lcZ(11,11,"igo.auth.login")),r.xp6(2),r.Q6J("ngIf",t.allowAnonymous),r.xp6(1),r.Q6J("ngIf",t.error))},directives:[ze._Y,ze.JL,ze.sg,Pe.KE,Qe.Nt,ze.Fj,ze.Q7,ze.JJ,ze.u,n.lW,h.O5],pipes:[U.X$],styles:[".full-width[_ngcontent-%COMP%]{width:100%}.anonymous[_ngcontent-%COMP%]{margin-left:10px}"]}),e})();function Gs(e,t){1&e&&r._UZ(0,"div",3)}function Qs(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-auth-google",7),r.NdJ("login",function(){return r.CHM(e),r.oxw(3).onLogin()}),r.qZA()}}function zs(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-auth-microsoft",7),r.NdJ("login",function(){return r.CHM(e),r.oxw(3).onLogin()}),r.qZA()}}function Ys(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-auth-microsoftb2c",7),r.NdJ("login",function(){return r.CHM(e),r.oxw(3).onLogin()}),r.qZA()}}function Hs(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-auth-facebook",7),r.NdJ("login",function(){return r.CHM(e),r.oxw(3).onLogin()}),r.qZA()}}function Vs(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-auth-intern",8),r.NdJ("login",function(){return r.CHM(e),r.oxw(3).onLogin()}),r.qZA()}if(2&e){const e=r.oxw(3);r.Q6J("allowAnonymous",e.options.allowAnonymous)}}function Ws(e,t){if(1&e&&(r.TgZ(0,"div",4),r.TgZ(1,"h1"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.YNc(4,Qs,1,0,"igo-auth-google",5),r.YNc(5,zs,1,0,"igo-auth-microsoft",5),r.YNc(6,Ys,1,0,"igo-auth-microsoftb2c",5),r.YNc(7,Hs,1,0,"igo-auth-facebook",5),r.YNc(8,Vs,1,1,"igo-auth-intern",6),r.qZA()),2&e){const e=r.oxw(2);r.xp6(2),r.Oqu(r.lcZ(3,6,"igo.auth.connection")),r.xp6(2),r.Q6J("ngIf",e.options.google&&!1!==e.options.google.enabled),r.xp6(1),r.Q6J("ngIf",e.options.microsoft&&!1!==e.options.microsoft.enabled),r.xp6(1),r.Q6J("ngIf",e.options.microsoftb2c&&!1!==e.options.microsoftb2c.enabled),r.xp6(1),r.Q6J("ngIf",e.options.facebook&&!1!==e.options.facebook.enabled),r.xp6(1),r.Q6J("ngIf",!e.options.intern||!1!==e.options.intern.enabled)}}function Xs(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",4),r.TgZ(1,"p"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"button",9),r.NdJ("click",function(){return r.CHM(e),r.oxw(2).logout()}),r._uU(5),r.ALo(6,"translate"),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(2);r.xp6(2),r.Oqu(r.xi3(3,2,"igo.auth.welcome",e.user)),r.xp6(3),r.Oqu(r.lcZ(6,5,"igo.auth.signOut"))}}function Ks(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",9),r.NdJ("click",function(){return r.CHM(e),r.oxw(3).home()}),r._uU(1),r.ALo(2,"translate"),r.qZA()}2&e&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"igo.auth.home")))}function en(e,t){if(1&e&&(r.TgZ(0,"div",4),r.TgZ(1,"p"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.YNc(4,Ks,3,3,"button",10),r.qZA()),2&e){const e=r.oxw(2);r.xp6(2),r.Oqu(r.lcZ(3,2,"igo.auth.deconnection")),r.xp6(2),r.Q6J("ngIf",e.options.homeRoute)}}function tn(e,t){if(1&e&&(r.TgZ(0,"div"),r.YNc(1,Gs,1,0,"div",1),r.YNc(2,Ws,9,8,"div",2),r.YNc(3,Xs,7,7,"div",2),r.YNc(4,en,5,4,"div",2),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf",!e.auth.logged&&e.backgroundDisable),r.xp6(1),r.Q6J("ngIf",!e.auth.logged&&e.showLoginDiv),r.xp6(1),r.Q6J("ngIf",e.auth.logged&&e.showAlreadyConnectedDiv),r.xp6(1),r.Q6J("ngIf",e.showLogoutDiv)}}let on=(()=>{class e{constructor(e,t,o){this.auth=e,this.config=t,this.router=o,this._backgroundDisable=!0,this._hasAlreadyConnectedDiv=!0,this._hasLogoutDiv=!0,this._showAlreadyConnectedDiv=!1,this._showLogoutDiv=!1,this.login=new r.vpe,this.visible=!0,this.options=this.config.getConfig("auth")||{},this.visible=0!==Object.getOwnPropertyNames(this.options).length}get backgroundDisable(){return!this.isLogoutRoute&&!this.isLogoutRoute&&this._backgroundDisable}set backgroundDisable(e){this._backgroundDisable="true"===e.toString()}get hasAlreadyConnectedDiv(){return this._hasAlreadyConnectedDiv}set hasAlreadyConnectedDiv(e){this._hasAlreadyConnectedDiv="true"===e.toString()}get hasLogoutDiv(){return this._hasLogoutDiv}set hasLogoutDiv(e){this._hasLogoutDiv="true"===e.toString()}get showAlreadyConnectedDiv(){return this.isLogoutRoute?this.hasAlreadyConnectedDiv:this._showAlreadyConnectedDiv}set showAlreadyConnectedDiv(e){this._showAlreadyConnectedDiv="true"===e.toString()}get showLogoutDiv(){return this.isLogoutRoute?this.hasLogoutDiv:this._showLogoutDiv}set showLogoutDiv(e){this._showLogoutDiv="true"===e.toString()}get showLoginDiv(){if(!this.isLogoutRoute)return!0}ngOnInit(){this.analyzeRoute(),this.getName()}onLogin(){this.auth.goToRedirectUrl(),this.getName(),this.login.emit(!0)}logout(){this.auth.logout().subscribe(()=>{this.user=void 0,this.router&&(this.options.logoutRoute?this.router.navigate([this.options.logoutRoute]):this.options.homeRoute&&this.router.navigate([this.options.homeRoute]))})}home(){this.router&&this.options.homeRoute&&this.router.navigate([this.options.homeRoute])}getName(){const e=this.auth.decodeToken();e&&(this.user={name:e.user.firstName||e.user.sourceId})}analyzeRoute(){!this.router||this.router.events.pipe((0,Ie.h)(e=>e instanceof d.OD)).subscribe(e=>{if(e.url){const t=e.url,o=this.options.loginRoute;this.isLogoutRoute=t===this.options.logoutRoute,this.isLoginRoute=t===o,this.isLogoutRoute&&this.auth.logout()}})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36($s),r.Y36(z),r.Y36(d.F0,8))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-auth-form"]],inputs:{backgroundDisable:"backgroundDisable",hasAlreadyConnectedDiv:"hasAlreadyConnectedDiv",hasLogoutDiv:"hasLogoutDiv",showAlreadyConnectedDiv:"showAlreadyConnectedDiv",showLogoutDiv:"showLogoutDiv"},outputs:{login:"login"},decls:1,vars:1,consts:[[4,"ngIf"],["class","backgroundDisable",4,"ngIf"],["class","login center-block",4,"ngIf"],[1,"backgroundDisable"],[1,"login","center-block"],[3,"login",4,"ngIf"],[3,"allowAnonymous","login",4,"ngIf"],[3,"login"],[3,"allowAnonymous","login"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","button",3,"click",4,"ngIf"]],template:function(e,t){1&e&&r.YNc(0,tn,5,4,"div",0),2&e&&r.Q6J("ngIf",t.visible)},directives:[h.O5,qs,Ds,Us,Ns,js,n.lW],pipes:[U.X$],styles:["[_nghost-%COMP%]{z-index:999}div.login[_ngcontent-%COMP%]{z-index:200;width:90%;min-width:360px;max-width:600px;padding:25px 50px;border:1px solid;background-color:#fff;border-color:#888}.center-block[_ngcontent-%COMP%]{position:fixed;top:20%;left:50%;transform:translate(-50%)}.backgroundDisable[_ngcontent-%COMP%]{position:fixed;top:0;left:0;background:#000;opacity:.8;z-index:100;height:100%;width:100%}"]}),e})(),rn=(()=>{class e{constructor(e,t,o){this.config=e,this.tokenService=t,this.http=o,this.refreshInProgress=!1}get trustHosts(){const e=this.config.getConfig("auth.trustHosts")||[];return e.push(window.location.hostname),e}get hostsWithCredentials(){return this.config.getConfig("auth.hostsWithCredentials")||[]}intercept(e,t){const o=this.handleHostsWithCredentials(e.url);let i=e.clone();o&&(i=e.clone({withCredentials:o})),this.refreshToken();const r=this.tokenService.get(),s=document.createElement("a");if(s.href=i.url,""===s.host&&(s.href=s.href),!r||-1===this.trustHosts.indexOf(s.hostname))return t.handle(i);let n=i.clone({headers:i.headers.set("Authorization",`Bearer ${r}`)});const a=this.tokenService.decode();if("true"===n.params.get("_i")&&a&&a.user&&a.user.sourceId){const e=Ps.V.hashStr(a.user.sourceId);n=n.clone({params:n.params.set("_i",e)})}else"true"===n.params.get("_i")&&(n=n.clone({params:n.params.delete("_i")}));return t.handle(n)}interceptXhr(e,t){const o=this.handleHostsWithCredentials(t);if(o)return e.withCredentials=o,!0;this.refreshToken();const i=document.createElement("a");i.href=t;const r=this.tokenService.get();return!(!r||-1===this.trustHosts.indexOf(i.hostname)||(e.setRequestHeader("Authorization","Bearer "+r),0))}handleHostsWithCredentials(e){let t=!1;for(const o of this.hostsWithCredentials)if(new RegExp(o.domainRegFilters).test(e)){t=void 0!==o.withCredentials?o.withCredentials:void 0;break}return t}refreshToken(){const e=this.tokenService.decode(),t=(new Date).getTime()/1e3;if(!this.refreshInProgress&&e&&t<e.exp&&t>e.exp-1800){this.refreshInProgress=!0;const e=this.config.getConfig("auth.url");return this.http.post(`${e}/refresh`,{}).subscribe(e=>{this.tokenService.set(e.token),this.refreshInProgress=!1},e=>(e.error.caught=!0,e))}}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(z),r.LFG(_s),r.LFG(y.eN))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function sn(e){const t=e.getConfig("auth.microsoft")||{};return t.redirectUri=t.redirectUri||window.location.href,t.authority=t.authority||"https://login.microsoftonline.com/organizations",new Os.L({auth:t,cache:{cacheLocation:"sessionStorage"}})}function nn(e){const t=e.getConfig("auth.microsoftb2c.browserAuthOptions")||{};return t.redirectUri=t.redirectUri||window.location.href,t.authority=t.authority||"https://login.microsoftonline.com/organizations",new Os.L({auth:t,cache:{cacheLocation:"sessionStorage"}})}function an(e){return e.getConfig("auth.microsoft"),{interactionType:Ms.s_.Popup,authRequest:{scopes:["user.read"],loginHint:"todo"},type:"add"}}function ln(e){const t=e.getConfig("auth.microsoftb2c.browserAuthOptions")||{};return{interactionType:Ms.s_.Popup,authRequest:{scopes:[t.clientId]},type:"b2c"}}function cn(e){return"b2c"===e?[{provide:Fs.sK,useFactory:nn,deps:[z]},{provide:Fs.S9,useFactory:ln,deps:[z],multi:!0},Es]:[{provide:Fs.sK,useFactory:sn,deps:[z]},{provide:Fs.S9,useFactory:an,deps:[z],multi:!0},Fs.W2]}let un=(()=>{class e extends ve{constructor(e,t,o,i){super(e),this.http=t,this.authService=o,this.tokenService=i,this.authService.authenticate$.subscribe(e=>{e&&this.options.url&&this.http.get(this.options.url).subscribe(e=>{if(e&&e.preference)for(const t of Object.keys(e.preference))super.set(t,e.preference[t])})})}set(e,t,o=fe.LOCAL){if(o===fe.LOCAL&&this.authService.authenticated&&this.options.url){const o={};o[e]=t,this.http.patch(this.options.url,{preference:o}).subscribe()}super.set(e,t,o)}remove(e,t=fe.LOCAL){if(t===fe.LOCAL&&this.authService.authenticated&&this.options.url){const t={};t[e]=void 0,this.http.patch(this.options.url,{preference:t}).subscribe()}super.remove(e,t)}clear(e=fe.LOCAL){let t;e===fe.LOCAL&&this.authService.authenticated&&this.options.url&&this.http.patch(this.options.url,{preference:{}},{params:{mergePreference:"false"}}).subscribe(),e===fe.LOCAL&&(t=this.tokenService.get()),super.clear(e),t&&this.tokenService.set(t),e===fe.LOCAL&&this.authService.authenticated&&this.options.url&&this.http.get(this.options.url).subscribe(e=>{if(e&&e.preference)for(const t of Object.keys(e.preference))super.set(t,e.preference[t])})}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(z),r.LFG(y.eN),r.LFG($s),r.LFG(_s))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),pn=(()=>{class e{static forRoot(){return{ngModule:e,providers:[{provide:y.TP,useClass:rn,multi:!0},{provide:ve,useClass:un},...cn("add"),...cn("b2c")]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,ze.UX,Pe.lN,Qe.c,a.Ps,n.ot,oe,Fs.up]]}),e})();const dn=d.Bz.forChild([{path:"auth-form",component:(()=>{class e{constructor(e){this.languageService=e,this.idsActivity=[]}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ne))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-auth-form"]],decls:17,vars:0,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/auth/auth-form"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/environments"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Auth"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Authentification"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: ConfigService, LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"br"),r._uU(13," See auth section of the "),r.TgZ(14,"a",1),r._uU(15," environment config"),r.qZA(),r.qZA(),r.qZA(),r._UZ(16,"igo-auth-form"))},directives:[g.a8,g.$j,g.n5,g.dn,on],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e})()}]);let hn=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[dn,g.QW,pn.forRoot()]]}),e})();var gn=o(42720),mn=o(90490),fn=o(8117),yn=o(58059),vn=o(20088),bn=o(56816),xn=o(78767),wn=o(85105),Sn=o(65506),Cn=o(99709),Tn=o(33697),An=o(57969),Zn=o(13966),Ln=o(83136),Fn=o(72052),On=o(38549),Mn=o(44654),In=o(53809),kn=o(31391),Pn=o(56274),_n=o(51819),$n=o(88257),qn=o(20737),Dn=o(16274),En=o(6888),Rn=o(49040),Un=o(16212),Nn=o(21049),Jn=o(94770),Bn=o(64330),jn=o(88176),Gn=o(22798),Qn=o(32475),zn=o(18570),Yn=o(5883),Hn=o(97572),Vn=o(82146),Wn=o(70032),Xn=o(95403),Kn=o(6037),ea=o(82424),ta=o(39968),oa=o(21118),ia=o(92897),ra=o(74154),sa=o(40113),na=o(2281),aa=o(60890),la=o(95567),ca=o(73951),ua=o(75529),pa=o(33809),da=o(44280),ha=o(68190),ga=o(40866),ma=o(47976),fa=o(62346),ya=o(70690),va=o(6203),ba=o(56384),xa=o(61273),wa=o(49010),Sa=o(21119),Ca=o(72966),Ta=o(95361),Aa=o(83437),Za=o(14439),La=o(3421),Fa=o(14426),Oa=o(26101),Ma=o(12891),Ia=o(43219),ka=o(92804),Pa=o(43407),_a=o(52162),$a=o(75381),qa=o(22850),Da=o(37202),Ea=o(3096),Ra=o(70612),Ua=o(29167),Na=o(47601),Ja=o(53557),Ba=o(62294),ja=o(98431),Ga=o(16176),Qa=o(19031),za=o(60186),Ya=o(99034),Ha=o(70764),Va=o(62738),Wa=o(45552),Xa=o(87730),Ka=o(73277),el=(o(5480),o(24492),o(28519)),tl=o(1184),ol=o(30331),il=o(65877),rl=o(99673),sl=o(10757),nl=o(42127),al=o(3023),ll=o(70509),cl=o(74749),ul=o(97797),pl=o(51318),dl=o(52195),hl=o.n(dl),gl=o(17284);let ml=(()=>{class e{constructor(){}open(e){e.extern&&window.open(e.url,"_blank")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function fl(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",1),r.NdJ("click",function(){r.CHM(e);const t=r.oxw();return t.openMetadata(t.options.metadata)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",2),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("matTooltip",r.lcZ(1,2,"igo.geo.metadata.show"))("color",e.color)}}function yl(e,t){if(1&e&&(r.TgZ(0,"mat-dialog-content",3),r.TgZ(1,"h3"),r._uU(2),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(2),r.Oqu(e.data.abstract)}}function vl(e,t){if(1&e&&(r.TgZ(0,"mat-dialog-content",3),r._UZ(1,"h3",4),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("innerHTML",e.data.abstract,r.oJD)}}let bl=(()=>{class e{constructor(e,t){this.metadataService=e,this.dialog=t,this._color="primary"}get layer(){return this._layer}set layer(e){this._layer=e}get color(){return this._color}set color(e){this._color=e}openMetadata(e){e.extern?this.metadataService.open(e):!e.extern&&e.abstract&&this.dialog.open(xl,{data:{layerTitle:this.layer.title,abstract:e.abstract,type:e.type}})}get options(){if(this.layer)return this.layer.options}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ml),r.Y36(je.uw))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-metadata-button"]],inputs:{layer:"layer",color:"color"},decls:1,vars:1,consts:[["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click"],["svgIcon","information-outline"]],template:function(e,t){1&e&&r.YNc(0,fl,3,4,"button",0),2&e&&r.Q6J("ngIf",t.options&&t.options.metadata&&t.options.metadata.url||t.options&&t.options.metadata&&t.options.metadata.abstract)},directives:[h.O5,n.lW,p.gM,a.Hw],pipes:[U.X$],styles:[""],changeDetection:0}),e})(),xl=(()=>{class e{constructor(e){this.data=e}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(je.WI))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-metadata-abstract"]],decls:6,vars:3,consts:[["mat-dialog-title",""],["mat-button","","mat-dialog-close","",1,"close-button"],["class","mat-typography",4,"ngIf"],[1,"mat-typography"],[3,"innerHTML"]],template:function(e,t){1&e&&(r.TgZ(0,"h2",0),r._uU(1),r.qZA(),r.TgZ(2,"button",1),r._uU(3,"X"),r.qZA(),r.YNc(4,yl,3,1,"mat-dialog-content",2),r.YNc(5,vl,2,1,"mat-dialog-content",2)),2&e&&(r.xp6(1),r.Oqu(t.data.layerTitle),r.xp6(3),r.Q6J("ngIf","arcgisrest"!==t.data.type),r.xp6(1),r.Q6J("ngIf","arcgisrest"===t.data.type))},directives:[je.uh,n.lW,je.ZT,h.O5,je.xY],styles:[".close-button{top:5px;right:5px;padding:7px;line-height:10px;position:absolute!important;min-width:auto}mat-dialog-container{position:relative}\n"],encapsulation:2}),e})(),wl=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,a.Ps,n.ot,p.AV,oe,je.Is]]}),e})();const Sl="Feature";var Cl=(()=>{return(e=Cl||(Cl={}))[e.None=0]="None",e[e.Move=1]="Move",e[e.Zoom=2]="Zoom",e[e.Default=3]="Default",Cl;var e})();class Tl extends R{constructor(e,t,o){super(),this.loaded=0,this.loading=0,this.source=e.options.source.ol,this.id=D(),this.messageService=t,this.languageService=o}watch(){this.source.on("imageloadstart",e=>this.handleLoadStart(e)),this.source.on("imageloadend",e=>this.handleLoadEnd(e)),this.source.on("imageloaderror",e=>this.handleLoadEnd(e)),this.source.on("imageloaderror",e=>this.handleLoadError(e))}unwatch(){this.source.un("imageloadstart",e=>this.handleLoadStart(e)),this.source.un("imageloadend",e=>this.handleLoadEnd(e)),this.source.un("imageloaderror",e=>this.handleLoadEnd(e)),this.source.un("imageloaderror",e=>this.handleLoadError(e))}handleLoadStart(e){e.image.__watchers__||(e.image.__watchers__=[]),e.image.__watchers__.push(this.id),this.loading+=1,this.status=E.Working}handleLoadEnd(e){if(!e.image.__watchers__)return;const t=e.image.__watchers__.indexOf(this.id);if(t<0)return;e.image.__watchers__.splice(t,1),this.loaded+=1;const o=this.loading;this.loaded>=o&&o===this.loading&&(this.status=E.Done,this.loaded=this.loading=0)}handleLoadError(e){if(!e.image.__watchers__)return;const t=this.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),o=this.languageService.translate.instant("igo.geo.dataSource.unavailable",{value:e.target.params_.LAYERS});this.messageService.error(o,t),this.loaded=-1,this.loading=0,this.status=E.Error}}var Al=(()=>{return(e=Al||(Al={})).OPACITY="opacity",e.VISIBLE="visible",e.OGCFILTERS="ogcFilters",e.MINRESOLUTION="minResolution",e.MAXRESOLUTION="maxResolution",e.ZINDEX="zIndex",e.TIMEFILTER="timeFilter",Al;var e})(),Zl=(()=>{return(e=Zl||(Zl={})).TITLE="title",e.ABSTRACT="abstract",e.CUSTOM="custom",Zl;var e})();function Ll(e){return({wms:Fl,wmts:Ol,xyz:Ml,feature:Il,wfs:kl,arcgisrest:Pl,imagearcgisrest:Pl,tilearcgisrest:Pl,osm:e=>"OSM",tiledebug:e=>"tiledebug"}[e.type]||_l)(e)}function Fl(e){const t=e.params.LAYERS,o=$l(e.url);return Ps.V.hashStr("wms"+o+t)}function Ol(e){const t=e.layer,o=$l(e.url);return Ps.V.hashStr("wmts"+o+t)}function Ml(e){const t=$l(e.url);return Ps.V.hashStr("xyz"+t)}function Il(e){if(!e.url)return _l();const t=$l(e.url);return Ps.V.hashStr("feature"+t)}function kl(e){if(!e.url||!e.params)return _l();const t=$l(e.url);return Ps.V.hashStr("wfs"+t+e.params.featureTypes)}function Pl(e){const t=e.layer,o=$l(e.url);return Ps.V.hashStr((e.type||"arcgis")+o+t)}function _l(e){return D()}function $l(e){const t=("/"===e.charAt(0)?window.location.origin+e:e).split(/[?&]/);let o=t.shift();const i=t.filter(e=>0!==e.length&&"_"!==e.charAt(0));return i.length&&(o+="?"+i.join("&")),o}class ql{constructor(e={},t){this.options=e,this.dataService=t,this.options=e,this.id=this.options.id||this.generateId(),this.ol=this.createOlSource()}generateId(){return Ll(this.options)}getLegend(e,t){return this.legend?this.legend:[]}setLegend(e){return this.legend=e.url?[{url:e.url}]:e.html?[{html:e.html}]:[],this.legend}}var Dl=(()=>{return(e=Dl||(Dl={})).BasicNumericOperator="basicnumericoperator",e.Basic="basic",e.BasicAndSpatial="basicandspatial",e.Spatial="spatial",e.All="all",e.Time="time",Dl;var e})(),El=(()=>{return(e=El||(El={})).BBOX="BBox",e.PropertyIsBetween="PropertyIsBetween",e.Contains="Contains",e.During="During",e.PropertyIsEqualTo="PropertyIsEqualTo",e.PropertyIsGreaterThan="PropertyIsGreaterThan",e.PropertyIsGreaterThanOrEqualTo="PropertyIsGreaterThanOrEqualTo",e.Intersects="Intersects",e.PropertyIsNull="PropertyIsNull",e.PropertyIsLessThan="PropertyIsLessThan",e.PropertyIsLessThanOrEqualTo="PropertyIsLessThanOrEqualTo",e.PropertyIsLike="PropertyIsLike",e.PropertyIsNotEqualTo="PropertyIsNotEqualTo",e.Within="Within",e.And="And",e.Or="Or",e.Not="Not",El;var e})();const Rl=na;class Ul{constructor(){this.filterSequence=[],this.operators={[El.PropertyIsEqualTo]:{spatial:!1,fieldRestrict:[]},[El.PropertyIsNotEqualTo]:{spatial:!1,fieldRestrict:[]},[El.PropertyIsLike]:{spatial:!1,fieldRestrict:["string"]},[El.PropertyIsGreaterThan]:{spatial:!1,fieldRestrict:["number"]},[El.PropertyIsGreaterThanOrEqualTo]:{spatial:!1,fieldRestrict:["number"]},[El.PropertyIsLessThan]:{spatial:!1,fieldRestrict:["number"]},[El.PropertyIsLessThanOrEqualTo]:{spatial:!1,fieldRestrict:["number"]},[El.PropertyIsBetween]:{spatial:!1,fieldRestrict:["number"]},[El.During]:{spatial:!1,fieldRestrict:[]},[El.PropertyIsNull]:{spatial:!1,fieldRestrict:[]},[El.Intersects]:{spatial:!0,fieldRestrict:[]},[El.Within]:{spatial:!0,fieldRestrict:[]},[El.Contains]:{spatial:!0,fieldRestrict:[]}}}defineOgcFiltersDefaultOptions(e,t,o){let i=!0;return o&&"wms"===o&&(i=!1),(e=e||{}).enabled=void 0===e.enabled?i:e.enabled,e.editable=void 0===e.editable?i:e.editable,e.geometryName=t,e.advancedOgcFilters=!0,e.enabled&&(e.pushButtons||e.checkboxes||e.radioButtons||e.select)&&(e.advancedOgcFilters=!1),e}buildFilter(e,t,o,i,r){let s,n,a;if(n=!/intersects|contains|within/gi.test(JSON.stringify(e)),e&&(i=void 0!==e.geometryName?e.geometryName:i),t&&e&&(s=ia.VW(i,t,o.getCode())),!e)return"bbox="+t.join(",")+","+o.getCode();e=this.checkIgoFiltersProperties(e,i,o),a=t&&n?ia.xD(s,this.bundleFilter(e,r)):this.bundleFilter(e,r);const l={srsName:"",featureNS:"",featurePrefix:"",featureTypes:["featureTypes"],filter:a,outputFormat:"",geometryName:i},c=(new sa.Z).writeGetFeature(l);return"filter="+(new XMLSerializer).serializeToString(c).split(/typenames *=|typename *=\"featureTypes\" *>/gi)[1].split(/<\/Query><\/GetFeature>/gi)[0]}bundleFilter(e,t){if(e instanceof Array){const o=[];return e.forEach(e=>{o.push(this.bundleFilter(e,t))}),o}return e.hasOwnProperty("logical")?this.createFilter({operator:e.logical,logicalArray:this.bundleFilter(e.filters,t)},t):e.hasOwnProperty("operator")?this.createFilter(e,t):void 0}createFilter(e,t){const o=e.operator,i=e.logicalArray,r=e.propertyName,s=e.pattern,n=!e.matchCase||e.matchCase,a=e.wildCard?e.wildCard:"*",l=e.singleChar?e.singleChar:".",c=e.escapeChar?e.escapeChar:"!",u=e.lowerBoundary,p=e.upperBoundary,d=e.geometryName,h=e.extent,g=e.wkt_geometry,m=e.srsName?e.srsName:"EPSG:3857",f=this.parseFilterOptionDate(e.begin,t?t.minDate:void 0),y=this.parseFilterOptionDate(e.end,t?t.maxDate:void 0),v=e.expression;let b;switch(g&&(b=(new ra.Z).readGeometry(g,{dataProjection:m,featureProjection:m||"EPSG:3857"})),o.toLowerCase()){case El.BBOX.toLowerCase():return ia.VW(d,h,m);case El.PropertyIsBetween.toLowerCase():return ia.vX(r,u,p);case El.Contains.toLowerCase():return ia.r3(d,b,m);case El.During.toLowerCase():return ia.Q9(r,f,y);case El.PropertyIsEqualTo.toLowerCase():return ia.EW(r,v,n);case El.PropertyIsGreaterThan.toLowerCase():return ia.tS(r,v);case El.PropertyIsGreaterThanOrEqualTo.toLowerCase():return ia.wZ(r,v);case El.Intersects.toLowerCase():return ia.kK(d,b,m);case El.PropertyIsNull.toLowerCase():return ia.Ft(r);case El.PropertyIsLessThan.toLowerCase():return ia.Qj(r,v);case El.PropertyIsLessThanOrEqualTo.toLowerCase():return ia.MK(r,v);case El.PropertyIsLike.toLowerCase():return ia.vL(r,s.replace(/[()_]/gi,l),a,l,c,n);case El.PropertyIsNotEqualTo.toLowerCase():return ia.eI(r,v,n);case El.Within.toLowerCase():return ia.uh(d,b,m);case El.And.toLowerCase():return ia.xD.apply(null,i);case El.Or.toLowerCase():return ia.or.apply(null,i);case El.Not.toLowerCase():return ia.ff.apply(null,i);default:return}}defineInterfaceFilterSequence(e,t,o="",i=-1){return e instanceof Array?e.forEach(e=>{this.filterSequence.concat(this.defineInterfaceFilterSequence(e,t,o,i))}):e.hasOwnProperty("logical")?this.filterSequence.concat(this.defineInterfaceFilterSequence(e.filters,t,e.logical,i+=1)):e.hasOwnProperty("operator")&&this.filterSequence.push(this.addInterfaceFilter(e,t,i,o)),this.filterSequence}computeAllowedOperators(e,t,o){let i,r,s,n={};if(e&&t){const r=e.find(e=>e.name===t);i=r&&r.allowedOperatorsType?r.allowedOperatorsType:o}switch(e&&e.map(e=>{if(!e.allowedOperatorsType)return;const t=e.allowedOperatorsType.toLowerCase();(t===Dl.All.toLowerCase()||t===Dl.Spatial.toLowerCase()||t===Dl.BasicAndSpatial.toLowerCase())&&(r=!0,t===Dl.All.toLowerCase()&&(s=!0))}),i=i||Dl.BasicAndSpatial,i.toLowerCase()){case Dl.All:n=this.operators;break;case Dl.Spatial:n={[El.Intersects]:{spatial:!0,fieldRestrict:[]},[El.Within]:{spatial:!0,fieldRestrict:[]}};break;case Dl.BasicAndSpatial:n={[El.PropertyIsEqualTo]:{spatial:!1,fieldRestrict:[]},[El.PropertyIsNotEqualTo]:{spatial:!1,fieldRestrict:[]},[El.Intersects]:{spatial:!0,fieldRestrict:[]},[El.Within]:{spatial:!0,fieldRestrict:[]}};break;case Dl.Basic:n={[El.PropertyIsEqualTo]:{spatial:!1,fieldRestrict:[]},[El.PropertyIsNotEqualTo]:{spatial:!1,fieldRestrict:[]}};break;case Dl.Time:n={[El.During]:{spatial:!1,fieldRestrict:[]}};break;case Dl.BasicNumericOperator:n={[El.PropertyIsEqualTo]:{spatial:!1,fieldRestrict:[]},[El.PropertyIsNotEqualTo]:{spatial:!1,fieldRestrict:[]},[El.PropertyIsGreaterThan]:{spatial:!1,fieldRestrict:["number"]},[El.PropertyIsGreaterThanOrEqualTo]:{spatial:!1,fieldRestrict:["number"]},[El.PropertyIsLessThan]:{spatial:!1,fieldRestrict:["number"]},[El.PropertyIsLessThanOrEqualTo]:{spatial:!1,fieldRestrict:["number"]}};break;default:n={[El.PropertyIsEqualTo]:{spatial:!1,fieldRestrict:[]},[El.PropertyIsNotEqualTo]:{spatial:!1,fieldRestrict:[]},[El.Intersects]:{spatial:!0,fieldRestrict:[]},[El.Within]:{spatial:!0,fieldRestrict:[]}}}return r&&(n.Intersects={spatial:!0,fieldRestrict:[]},n.Within={spatial:!0,fieldRestrict:[]},s&&(n.Contains={spatial:!0,fieldRestrict:[]})),n}addInterfaceFilter(e,t,o=0,i="Or"){e||(e={operator:"PropertyIsEqualTo"});const r={propertyName:"",operator:"",active:"",filterid:D(),step:"",begin:"",end:"",sliderOptions:{},lowerBoundary:"",upperBoundary:"",expression:"",pattern:"",wildCard:"*",singleChar:".",escapeChar:"!",matchCase:!0,igoSpatialSelector:"",igoSNRC:"",geometryName:"",geometry:"",wkt_geometry:"",extent:"",srsName:"",parentLogical:"",level:0};return Object.assign(r,{parentLogical:i,level:o,geometryName:t},e)}checkIgoFiltersProperties(e,t,o,i=!1){const r=[];return e instanceof Array?(e.forEach(e=>{r.push(this.checkIgoFiltersProperties(e,t,o,i))}),r):e.hasOwnProperty("logical")?Object.assign({},{logical:e.logical,filters:this.checkIgoFiltersProperties(e.filters,t,o,i)}):e.hasOwnProperty("operator")?this.addFilterProperties(e,t,o,i):void 0}addFilterProperties(e,t,o,i=!1){const r=e.hasOwnProperty("filterid")?e.filterid:D(),s=e.hasOwnProperty("active")?e.active:i,n=e.hasOwnProperty("srsName")?e.srsName:o?o.getCode():"EPSG:3857";return Object.assign({},{filterid:r,active:s,igoSpatialSelector:"fixedExtent",srsName:n},e,{geometryName:t})}rebuiltIgoOgcFilterObjectFromSequence(e){if(e instanceof Array&&e.length>=1){let t,o,i=e[0].parentLogical,r=[];return e.forEach(s=>{const n=Object.assign({},s),a=e.indexOf(s);t=a>=0&&a<e.length-1?e[a+1]:n,delete n.active,delete n.filterid,delete n.parentLogical,r.push(n),1===e.length?o=n:i!==t.parentLogical&&(1===r.length?console.log("You must set at least two operator in a logical ("+i+")"):(o=Object.assign({},{logical:i,filters:r}),r=[o],i=t.parentLogical))}),o}}computeIgoSelector(e){if(e.groups.every(e=>void 0!==e.computedSelectors))return e;let t;if(e.groups&&e.bundles){if(!e.bundles.every(e=>void 0!==e.id))throw new Error("You must set an id for each of your bundles");t=_.copyDeep(e),t.groups.forEach(e=>{e.title=e.title?e.title:e.name,e.enabled=!!e.enabled&&e.enabled,e.computedSelectors=_.copyDeep(t.bundles.filter(t=>e.ids.includes(t.id)))})}else!e.groups&&e.bundles?(t=_.copyDeep(e),t.groups=[{title:"group1",name:"group1",computedSelectors:_.copyDeep(t.bundles)}]):t={bundles:e,groups:[{title:"group1",name:"group1",computedSelectors:_.copyDeep(e)}],selectorType:t.selectorType};return t.groups.find(e=>e.enabled)||(t.groups[0].enabled=!0),t}handleOgcFiltersAppliedValue(e,t,o,i){const r=e.ogcFilters;if(!r)return;const s=[];let n="",a="";if(r.enabled&&(r.pushButtons||r.checkboxes||r.radioButtons||r.select)){let e;if(r.pushButtons){e=r.pushButtons;const t=this.formatGroupAndFilter(r,e);for(const e of t)s.push(e)}if(r.checkboxes){e=r.checkboxes;const t=this.formatGroupAndFilter(r,e);for(const e of t)s.push(e)}if(r.radioButtons){e=r.radioButtons;const t=this.verifyMultipleEnableds(e),o=this.formatGroupAndFilter(r,t);for(const e of o)s.push(e)}if(r.select){e=r.select;const t=this.verifyMultipleEnableds(e),o=this.formatGroupAndFilter(r,t);for(const e of o)s.push(e)}s.length>=1&&(n=this.buildFilter(1===s.length?s[0]:{logical:"And",filters:s},o,i,r.geometryName))}r.enabled&&r.filters&&(r.geometryName=r.geometryName||t,a=this.buildFilter(r.filters,o,i,r.geometryName,e));let l=r.advancedOgcFilters?a:n;return"wms"===e.type&&(l=this.formatProcessedOgcFilter(l,e.params.LAYERS)),"wfs"===e.type&&(l=this.formatProcessedOgcFilter(l,e.params.featureTypes)),l}verifyMultipleEnableds(e){return e.bundles.forEach(e=>{if(!e.multiple){const t=e.selectors.reduce((e,t,o)=>!0===t.enabled?e.concat(o):e,[]);t.length>1&&(t.splice(0,1),t.forEach(t=>{e.selectors[t].enabled=!1}))}}),e}formatGroupAndFilter(e,t){const o=(t=this.computeIgoSelector(t)).groups.find(e=>e.enabled).computedSelectors,i=[];return o.map(e=>{const t=[],o=e.selectors;!o||(o.filter(e=>!0===e.enabled).forEach(e=>t.push(e.filters)),1===t.length?i.push(t[0]):t.length>1&&i.push({logical:e.logical,filters:t}))}),"pushButton"===t.selectorType?e.pushButtons=t:"checkbox"===t.selectorType?e.checkboxes=t:"radioButton"===t.selectorType?e.radioButtons=t:"select"===t.selectorType&&(e.select=t),i}formatProcessedOgcFilter(e,t){let o="";return 0===e.length&&-1===t.indexOf(",")?o=e:t.split(",").forEach(t=>{o=`${o}(${e.replace("filter=","")})`}),o=o.replace(/\(\)/g,""),o.length>0?o.replace("filter=",""):void 0}parseFilterOptionDate(e,t){return e?Rl(e).isValid()?e:void 0:t}}var Nl=(()=>{return(e=Nl||(Nl={})).GML2="gml2",e.GML3="gml3",e.JSON="json",e.GEOJSON="geojson",e.GEOJSON2="geojson2",e.ESRIJSON="esrijson",e.TEXT="text",e.HTML="html",e.HTMLGML2="htmlgml2",Nl;var e})(),Jl=(()=>{return(e=Jl||(Jl={})).GML2="application/vnd.ogc.gml",e.GML3="application/vnd.ogc.gml/3.1.1",e.JSON="application/json",e.GEOJSON="application/geojson",e.GEOJSON2="geojson",e.ESRIJSON="application/json",e.TEXT="text/plain",e.HTML="text/html",e.HTMLGML2="text/html",Jl;var e})(),Bl=(()=>{return(e=Bl||(Bl={})).IFRAME="iframe",e.BLANK="_blank",Bl;var e})();const jl="EPSG:3857",Gl=5e3,Ql="geometry",zl=new RegExp(/(.*)?gml(.*)?/gi);function Yl(e,t,o,i){const r=e.paramsWFS,s=Hl(e,void 0,e.paramsWFS.srsName);let n;i&&i.enabled&&(n=i.filters);const a=new Ul,l=a.buildFilter(n,t,o,i.geometryName,e);let c=a.handleOgcFiltersAppliedValue(e,i.geometryName,t,o),u="filter";c||(u="bbox",c=t.join(",")+","+o.getCode()),r.xmlFilter=i.advancedOgcFilters?l:`${u}=${c}`;let p=s.find(e=>"getfeature"===e.name).value;return p=/(filter|bbox)=.*/gi.test(r.xmlFilter)?`${p}&${r.xmlFilter}`:p,e.download=Object.assign({},e.download,{dynamicUrl:p}),p.replace(/&&/g,"&")}function Hl(e,t,o,i,r=0,s=!1){const n="2.0.0",a=e.urlWfs,l=e.paramsWFS,c=t||Gl,u=l.version===n?`startIndex=${r}`:"",p=o||jl;let d=l.outputFormat?`outputFormat=${l.outputFormat}`:"",h=l.version?`version=${l.version}`:"version=2.0.0";const g=`${l.version===n?"typenames":"typename"}=${l.featureTypes}`,m=l.version===n?"count":"maxFeatures";let f=t?`${m}=${c}`:l.maxFeatures?`${m}=${l.maxFeatures}`:`${m}=${c}`;s&&(d="",h="version=1.1.0",f=f.replace("count","maxFeatures"));const y=o?`srsname=${p}`:l.srsName?"srsname="+l.srsName:`srsname=${p}`;let v="",b="";i&&(v=`propertyName=${i}`,b=`valueReference=${i}`);const x=e.sourceFields;if(!v&&x&&x.length>0){const t=[];e.sourceFields.forEach(e=>{t.push(e.name)}),v=`propertyName=${t.join(",")},${l.fieldNameGeometry}`}const w=-1===a.indexOf("?")?"?":"&";let S=`${a}${w}service=WFS&request=GetFeature&${h}&${g}&`;S+=`${d}&${y}&${f}&${v}&${u}`;let C=`${a}?service=WFS&request=GetPropertyValue&version=${n}&${g}&`;return C+=`&${f}&${b}`,[{name:"outputformat",value:d},{name:"version",value:h},{name:"typename",value:g},{name:"count",value:f},{name:"srsname",value:y},{name:"propertyname",value:v},{name:"valuereference",value:b},{name:"getcapabilities",value:`${a}${w}service=WFS&request=GetCapabilities&${h}`.replace(/&&/g,"&")},{name:"getfeature",value:S.replace(/&&/g,"&")},{name:"getpropertyvalue",value:C.replace(/&&/g,"&")}]}function Vl(e,t){t&&"wfs"===t&&(e.paramsWFS=e.params);const o=e.paramsWFS;let i;return e.urlWfs=e.urlWfs||e.url,o.version=o.version||"2.0.0",o.fieldNameGeometry=o.fieldNameGeometry||Ql,o.maxFeatures=o.maxFeatures||Gl,o.outputFormat&&(i=o.outputFormat),(zl.test(i)||!i)&&(o.version="1.1.0"),Object.assign({},e)}function Wl(e){const t=e;let o;const i=t.paramsWFS.outputFormat?t.paramsWFS.outputFormat:void 0;return i?aa[i]?(o=aa[i],new o(t.formatOptions)):i.toLowerCase().match("gml2")?(o=sa.Z,new o(Object.assign(Object.assign({},t.formatOptions),{gmlFormat:fa.Z}))):i.toLowerCase().match("gml32")?(o=sa.Z,new o(Object.assign(Object.assign({},t.formatOptions),{gmlFormat:va.Z}))):i.toLowerCase().match("gml3")?(o=sa.Z,new o(Object.assign(Object.assign({},t.formatOptions),{gmlFormat:ya.Z}))):i.toLowerCase().match("topojson")?(o=la.Z,new o(t.formatOptions)):i.toLowerCase().match("geojson")?(o=Yn.Z,new o(t.formatOptions)):i.toLowerCase().match("esrijson")?(o=ca.Z,new o(t.formatOptions)):i.toLowerCase().match("json")?(o=Yn.Z,new o(t.formatOptions)):i.toLowerCase().match("gpx")?(o=ua.Z,new o(t.formatOptions)):i.toLowerCase().match("WKT")?(o=ra.Z,new o(t.formatOptions)):i.toLowerCase().match("osmxml")?(o=ba.Z,new o(t.formatOptions)):i.toLowerCase().match("kml")?(o=pa.ZP,new o(t.formatOptions)):new o:(o=sa.Z,new o(t.formatOptions))}class Xl extends ql{constructor(e,t){super(e),this.options=e,this.wfsService=t,this.ogcFilters$=new C.X(void 0),this.timeFilter$=new C.X(void 0);const o=e.params,i=o.DPI||96;o.DPI=i,o.MAP_RESOLUTION=i,o.FORMAT_OPTIONS="dpi:"+i,e.refreshIntervalSec&&e.refreshIntervalSec>0&&setInterval(()=>{this.refresh()},1e3*e.refreshIntervalSec);let r=Ql;if(e.paramsWFS){const t=Vl(e,"wms");_.mergeDeep(e.paramsWFS,t.paramsWFS),r=e.paramsWFS.fieldNameGeometry||r,e.download=Object.assign({},e.download,{dynamicUrl:this.buildDynamicDownloadUrlFromParamsWFS(e)})}e.sourceFields&&0!==e.sourceFields.length?e.sourceFields.forEach(e=>{e.alias=e.alias?e.alias:e.name}):e.sourceFields=[];const s=e.ogcFilters,n=new Ul;s?(s.advancedOgcFilters=!(s.pushButtons||s.checkboxes||s.radioButtons||s.select),s.pushButtons&&(s.pushButtons.selectorType="pushButton"),s.checkboxes&&(s.checkboxes.selectorType="checkbox"),s.radioButtons&&(s.radioButtons.selectorType="radioButton"),s.select&&(s.select.selectorType="select")):e.ogcFilters=n.defineOgcFiltersDefaultOptions(s,r,"wms"),o.LAYERS.split(",").length>1&&s&&s.enabled&&(console.log("*******************************"),console.log("BE CAREFULL, YOUR WMS LAYERS ("+o.LAYERS+") MUST SHARE THE SAME FIELDS TO ALLOW ogcFilters TO WORK !! "),console.log("*******************************")),e.paramsWFS&&s&&s.enabled&&s.editable&&(e.sourceFields||[]).filter(e=>!e.values).length>0&&this.wfsService.getSourceFieldsFromWFS(e);const a=n.handleOgcFiltersAppliedValue(e,r);o.FILTER=a,this.setOgcFilters(s,!0),(null==e?void 0:e.timeFilterable)&&(null==e?void 0:e.timeFilter)&&this.setTimeFilter(e.timeFilter,!0)}get params(){return this.options.params}get queryTitle(){return this.options.queryTitle?this.options.queryTitle:"title"}get mapLabel(){return this.options.mapLabel}get queryHtmlTarget(){return this.options.queryHtmlTarget?this.options.queryHtmlTarget:Bl.BLANK}set ogcFilters(e){this.options.ogcFilters=e}get ogcFilters(){return this.options.ogcFilters}set timeFilter(e){this.options.timeFilter=e}get timeFilter(){return this.options.timeFilter}refresh(){this.ol.updateParams({igoRefresh:Math.random()})}buildDynamicDownloadUrlFromParamsWFS(e){return Hl(e).find(e=>"getfeature"===e.name).value}createOlSource(){return new oa.Z(Object.assign({ratio:1},this.options))}setOgcFilters(e,t=!1){this.ogcFilters=e,t&&this.ogcFilters$.next(this.ogcFilters)}setTimeFilter(e,t=!1){this.timeFilter=e,t&&this.timeFilter$.next(this.timeFilter)}getLegend(e,t){let o=super.getLegend();if(o.length>0&&void 0===e&&!(null==t?void 0:t.scale))return o;let i,r=!1;(null==t?void 0:t.size)&&(null==t?void 0:t.extent)&&(null==t?void 0:t.projection)&&this.options.contentDependentLegend&&(i="1.3.0"===this.params.VERSION||void 0===this.params.VERSION?"CRS":"SRS",r=!0);const s=this.params;let n=[];void 0!==s.LAYERS&&(n=s.LAYERS.split(","));const a=this.options.url.replace(/\?$/,""),l=["REQUEST=GetLegendGraphic","SERVICE=WMS","FORMAT=image/png","SLD_VERSION=1.1.0",`VERSION=${s.VERSION||"1.3.0"}`];return void 0!==e&&l.push(`STYLE=${e}`),void 0!==(null==t?void 0:t.scale)&&l.push(`SCALE=${t.scale}`),r&&(l.push(`WIDTH=${t.size[0]}`),l.push(`HEIGHT=${t.size[1]}`),l.push(`BBOX=${t.extent.join(",")}`),l.push(`${i}=${t.projection}`)),o=n.map(t=>{const o=a.match(/\?/)?"&":"?";return{url:`${a}${o}${l.join("&")}&LAYER=${t}`,title:n.length>1?t:void 0,currentStyle:void 0===e?void 0:e}}),o}onUnwatch(){}}class Kl extends R{constructor(e,t){super(),this.ol=e.ol,this.layer=e,this.dataSource=e.options.source,this.map=t,this.ogcFilterWriter=new Ul}watch(){this.ol.on("propertychange",e=>this.transferCommonProperties(e)),this.dataSource.ogcFilters$&&(this.ogcFilters$$=this.dataSource.ogcFilters$.subscribe(e=>this.transferOgcFiltersProperties(e))),this.dataSource.timeFilter$&&(this.timeFilter$$=this.dataSource.timeFilter$.subscribe(e=>this.transferTimeFilterProperties(e))),this.syncChildLayers()}unwatch(){this.ol.un("propertychange",e=>this.transferCommonProperties(e)),this.ogcFilters$$&&this.ogcFilters$$.unsubscribe(),this.timeFilter$$&&this.timeFilter$$.unsubscribe()}syncChildLayers(){!this.map||this.map.status$.pipe((0,vn.P)()).subscribe(()=>{this.map.layers.filter(e=>{var t;return null===(t=e.options.linkedLayers)||void 0===t?void 0:t.links}).map(e=>{e.options.linkedLayers.links.map(t=>{var o,i,r,s,n,a;if(-1!==(null===(o=t.properties)||void 0===o?void 0:o.indexOf(Al.VISIBLE))&&(e.ol.set("visible",!e.visible,!1),e.ol.set("visible",!e.visible,!1),e.visible=e.visible),-1!==(null===(i=t.properties)||void 0===i?void 0:i.indexOf(Al.OPACITY))){const t=e.ol.get("opacity");e.ol.set("opacity",0,!1),e.ol.set("opacity",t,!1),e.opacity=e.opacity}if(-1!==(null===(r=t.properties)||void 0===r?void 0:r.indexOf(Al.MINRESOLUTION))){const t=e.ol.get("minResolution");e.ol.set("minResolution",0,!1),e.ol.set("minResolution",t,!1),e.minResolution=e.minResolution}if(-1!==(null===(s=t.properties)||void 0===s?void 0:s.indexOf(Al.MAXRESOLUTION))){const t=e.ol.get("maxResolution");e.ol.set("maxResolution",0,!1),e.ol.set("maxResolution",t,!1),e.minResolution=e.minResolution}if(-1!==(null===(n=t.properties)||void 0===n?void 0:n.indexOf(Al.OGCFILTERS))){const t=e.dataSource.ogcFilters$;t.next(t.value)}if(-1!==(null===(a=t.properties)||void 0===a?void 0:a.indexOf(Al.TIMEFILTER))){const t=e.dataSource.timeFilter$;t.next(t.value)}})})})}transferCommonProperties(e){const t=e.key,o=e.target.getProperties(),i=o[t];if(-1===["visible","opacity","minResolution","maxResolution"].indexOf(t))return;const r=o.linkedLayers;if(!r)return;const s=r.linkId,n=r.links;if(n){const e=!0;n.map(o=>{!o.properties||-1===o.properties.indexOf(t)||o.linkedIds.map(o=>{const r=this.map.layers.find(e=>{var t;return(null===(t=e.options.linkedLayers)||void 0===t?void 0:t.linkId)===o});r&&(r.ol.set(t,i,e),"visible"===t&&r.visible$.next(i))})})}else{const e=!1;this.map.layers.map(o=>{var r;(null===(r=o.options.linkedLayers)||void 0===r?void 0:r.links)&&o.options.linkedLayers.links.map(r=>{r.properties&&-1!==r.properties.indexOf(t)&&!1!==r.bidirectionnal&&-1!==r.linkedIds.indexOf(s)&&(o.ol.set(t,i,e),"visible"===t&&o.visible$.next(i))})})}}transferOgcFiltersProperties(e){const t=this.ol.getProperties().linkedLayers;if(!t)return;const o=t.linkId,i=t.links;i?i.map(t=>{!t.properties||-1===t.properties.indexOf(Al.OGCFILTERS)||t.linkedIds.map(t=>{const o=this.map.layers.find(e=>{var o;return(null===(o=e.options.linkedLayers)||void 0===o?void 0:o.linkId)===t});if(o){const t=o.ol.getProperties().sourceOptions.type;if(o.dataSource.setOgcFilters(e,!1),"wfs"===t&&o.ol.getSource().refresh(),"wms"===t){let e;"wfs"===this.ol.getProperties().sourceOptions.type?e=this.ogcFilterWriter.handleOgcFiltersAppliedValue(this.layer.dataSource.options,this.dataSource.options.fieldNameGeometry,void 0,this.map.viewController.getOlProjection()):"wms"===this.ol.getProperties().sourceOptions.type&&(e=this.dataSource.ol.getParams().FILTER),o.dataSource.ol.updateParams({FILTER:e})}}})}):this.map.layers.map(t=>{var i;(null===(i=t.options.linkedLayers)||void 0===i?void 0:i.links)&&t.options.linkedLayers.links.map(i=>{if(i.properties&&-1!==i.properties.indexOf(Al.OGCFILTERS)&&!1!==i.bidirectionnal&&-1!==i.linkedIds.indexOf(o)){const o=t.ol.getProperties().sourceOptions.type;if("wfs"===o&&(t.dataSource.setOgcFilters(e,!0),t.ol.getSource().refresh()),"wms"===o){let o;"wfs"===this.ol.getProperties().sourceOptions.type?o=this.ogcFilterWriter.handleOgcFiltersAppliedValue(t.dataSource.options,this.dataSource.options.fieldNameGeometry,void 0,this.map.viewController.getOlProjection()):"wms"===this.ol.getProperties().sourceOptions.type&&(o=this.dataSource.ol.getParams().FILTER),t.dataSource.ol.updateParams({FILTER:o}),t.dataSource.setOgcFilters(e,!0)}}})})}transferTimeFilterProperties(e){const t=this.ol.getProperties().linkedLayers;if(!t)return;const o=t.linkId,i=t.links;i?i.map(t=>{!t.properties||-1===t.properties.indexOf(Al.TIMEFILTER)||t.linkedIds.map(t=>{const o=this.map.layers.find(e=>{var o;return e.dataSource instanceof Xl&&(null===(o=e.options.linkedLayers)||void 0===o?void 0:o.linkId)===t});if(o){o.dataSource.setTimeFilter(e,!1);const t=this.ol.get("values_").source.getParams().TIME;o.dataSource.ol.updateParams({TIME:t})}})}):this.map.layers.filter(e=>e.dataSource instanceof Xl).map(t=>{var i;(null===(i=t.options.linkedLayers)||void 0===i?void 0:i.links)&&t.options.linkedLayers.links.map(i=>{if(i.properties&&-1!==i.properties.indexOf(Al.TIMEFILTER)&&!1!==i.bidirectionnal&&-1!==i.linkedIds.indexOf(o)){const o=this.ol.get("values_").source.getParams().TIME;t.dataSource.ol.updateParams({TIME:o}),t.dataSource.setTimeFilter(e,!0)}})})}}class ec extends R{constructor(e){super(),this.loaded=0,this.loading=0,this.source=e.options.source.ol,this.id=D()}watch(){this.source.on("tileloadstart",e=>this.handleLoadStart(e)),this.source.on("tileloadend",e=>this.handleLoadEnd(e)),this.source.on("tileloaderror",e=>this.handleLoadEnd(e))}unwatch(){this.source.un("tileloadstart",e=>this.handleLoadStart(e)),this.source.un("tileloadend",e=>this.handleLoadEnd(e)),this.source.un("tileloaderror",e=>this.handleLoadEnd(e))}handleLoadStart(e){e.tile.__watchers__||(e.tile.__watchers__=[]),e.tile.__watchers__.push(this.id),this.loading+=1,this.status=E.Working}handleLoadEnd(e){if(!e.tile.__watchers__)return;const t=e.tile.__watchers__.indexOf(this.id);if(t<0)return;e.tile.__watchers__.splice(t,1),this.loaded+=1;const o=this.loading;this.loaded>=o&&o===this.loading&&(this.status=E.Done,this.loaded=this.loading=0)}}class tc extends ql{createOlSource(){const e={format:this.getSourceFormatFromOptions(this.options)};return new wa.Z(Object.assign(e,this.options))}getSourceFormatFromOptions(e){if(e.format)return e.format;let t;const o=e.formatType;if(o){if(t=aa[o],void 0===t)throw new Error("Invalid vector source format ${formatType}.")}else t=Yn.Z;const i=e.formatOptions;let r;return r=i?new t(i):new t,r}onUnwatch(){}get queryTitle(){return this.options.queryTitle?this.options.queryTitle:"title"}}class oc extends tc{createOlSource(){return this.options.format=this.getSourceFormatFromOptions(this.options),this.options.source=super.createOlSource(),new xa.Z(this.options)}generateId(){return D()}onUnwatch(){}}class ic extends R{constructor(e){super(),this.loaded=0,this.loading=0,this.layer=e,this.id=D()}watch(){let e=this.layer.options.source.ol;this.layer.dataSource instanceof oc&&(e=this.layer.options.source.options.source),e.getUrl()&&(e.on("featuresloadstart",e=>this.handleLoadStart(e)),e.on("featuresloadend",e=>this.handleLoadEnd(e)),e.on("featuresloaderror",e=>this.handleLoadEnd(e)))}unwatch(){let e=this.layer.options.source.ol;this.layer.dataSource instanceof oc&&(e=this.layer.options.source.options.source),e.getUrl()&&(e.un("featuresloadstart",e=>this.handleLoadStart(e)),e.un("featuresloadend",e=>this.handleLoadEnd(e)),e.un("featuresloaderror",e=>this.handleLoadEnd(e)))}handleLoadStart(e){this.loading+=1,this.status=E.Working}handleLoadEnd(e){this.loaded+=1;const t=this.loading;this.loaded>=t&&t===this.loading&&(this.status=E.Done,this.loaded=this.loading=0)}}function rc(e,t,o,i){t=t||0,o=o||0;const r=e<0;let s=Math.abs(e)+t/60+o/3600;return(r||"S"===i||"W"===i)&&(s=-s),s}function sc(e){return(e=Math.round(e))<1e4?e+"":(e=Math.round(e/1e3))<1e3?e+"K":(e=Math.round(e/1e3))+"M"}function nc(e,t=96){return e/(39.3701*t)}function ac(e){const t=e.originalEvent;return!t.altKey&&(Sa.tK?t.metaKey:t.ctrlKey)&&!t.shiftKey}function lc(e,t=3){return[e[0].toFixed(t),e[1].toFixed(t)]}class cc{constructor(e,t,o){this.options=e,this.messageService=t,this.authInterceptor=o,this.legendCollapsed=!0,this.firstLoadComponent=!0,this.olLoadingProblem=!1,this.hasBeenVisible$=new C.X(void 0),this.isInResolutionsRange$=new C.X(!1),this.visible$=new C.X(void 0),this.displayed$=(0,Z.aj)([this.isInResolutionsRange$,this.visible$]).pipe((0,x.U)(e=>e[0]&&e[1])),this.dataSource=e.source,this.ol=this.createOlLayer(),void 0!==e.zIndex&&(this.zIndex=e.zIndex),e.baseLayer&&void 0===e.visible&&(e.visible=!1),this.maxResolution=e.maxResolution||nc(Number(e.maxScaleDenom)),this.minResolution=e.minResolution||nc(Number(e.minScaleDenom)),this.visible=void 0===e.visible||e.visible,this.opacity=void 0===e.opacity?1:e.opacity,e.legendOptions&&(e.legendOptions.url||e.legendOptions.html)&&(this.legend=this.dataSource.setLegend(e.legendOptions)),this.legendCollapsed=!e.legendOptions||!e.legendOptions.collapsed||e.legendOptions.collapsed,this.ol.set("_layer",this,!0)}get id(){return this.options.id||this.dataSource.id}get alias(){return this.options.alias}get title(){return this.options.title}set title(e){this.options.title=e}get zIndex(){return this.ol.getZIndex()}set zIndex(e){this.ol.setZIndex(e)}get baseLayer(){return this.options.baseLayer}set baseLayer(e){this.options.baseLayer=e}get opacity(){return this.ol.get("opacity")}set opacity(e){this.ol.setOpacity(e)}set isInResolutionsRange(e){this.isInResolutionsRange$.next(e)}get isInResolutionsRange(){return this.isInResolutionsRange$.value}set maxResolution(e){this.ol.setMaxResolution(e||1/0),this.updateInResolutionsRange()}get maxResolution(){return this.ol.getMaxResolution()}set minResolution(e){this.ol.setMinResolution(e||0),this.updateInResolutionsRange()}get minResolution(){return this.ol.getMinResolution()}set visible(e){this.ol.setVisible(e),this.visible$.next(e),!this.hasBeenVisible$.value&&e&&this.messageService&&this.hasBeenVisible$.next(e)}get visible(){return this.visible$.value}get displayed(){return this.visible&&this.isInResolutionsRange}get showInLayerList(){return!1!==this.options.showInLayerList}setMap(e){this.map=e,this.unobserveResolution(),void 0!==e?(this.observeResolution(),this.layerSyncWatcher=new Kl(this,this.map),this.layerSyncWatcher.subscribe(()=>{}),this.hasBeenVisible$$=this.hasBeenVisible$.subscribe(()=>{this.options.messages&&this.visible&&this.options.messages.map(e=>{e.title=e.title,e.text=e.text,this.messageService.message(e)})})):this.layerSyncWatcher.unsubscribe()}observeResolution(){this.resolution$$=this.map.viewController.resolution$.subscribe(()=>this.updateInResolutionsRange())}unobserveResolution(){void 0!==this.resolution$$&&(this.resolution$$.unsubscribe(),this.resolution$$=void 0)}updateInResolutionsRange(){if(void 0!==this.map){const e=this.map.viewController.getResolution(),t=void 0===this.maxResolution?1/0:this.maxResolution;this.isInResolutionsRange=e>=this.minResolution&&e<=t}else this.isInResolutionsRange=!1}}class uc extends cc{constructor(e,t,o){super(e,t,o),this.messageService=t,this.authInterceptor=o,this.watcher=new ic(this),this.status$=this.watcher.status$}get browsable(){return!1!==this.options.browsable}get exportable(){return!1!==this.options.exportable}createOlLayer(){const e=Object.assign({},this.options,{source:this.options.source.ol});this.options.animation&&this.dataSource.ol.on("addfeature",(function(e){this.flash(e.feature)}).bind(this)),this.options.trackFeature&&this.enableTrackFeature(this.options.trackFeature);const t=new Hn.Z(e),o=t.getSource(),i=o.getUrl();if(i){let t;const r=e.sourceOptions;t="wfs"===(null==r?void 0:r.type)&&(r.params||r.paramsWFS)?(e,t,i,s,n)=>{this.customWFSLoader(o,r,this.authInterceptor,e,t,i,s,n)}:(e,t,r,s,n)=>{this.customLoader(o,i,this.authInterceptor,e,t,r,s,n)},t&&o.setLoader(t)}return t}flash(e){const t=(new Date).getTime(),o=this.ol.on("postrender",(function(i){const r=(0,Kn.u3)(i),s=i.frameState,n=e.getGeometry().clone(),a=s.time-t,l=a/this.options.animation.duration,c=(0,Wn.Vv)(1-l),u=(0,Xn._2)(this.options.animation.color||"red");u[3]=c;let p=this.ol.getStyleFunction().call(this,e).find(e=>e.getImage());p||(p=this.ol.getStyleFunction().call(this,e)[0]);const d=p.clone();switch(e.getGeometry().getType()){case"Point":const e=(0,Wn.Vv)(l)*(3*d.getImage().getRadius());d.getImage().setRadius(e),d.getImage().setOpacity(c);break;case"LineString":d.getImage()&&(d.getImage().getStroke().setColor(u),d.getImage().getStroke().setWidth((0,Wn.Vv)(l)*(3*d.getImage().getStroke().getWidth()))),d.getStroke()&&(d.getStroke().setColor(u),d.getStroke().setWidth((0,Wn.Vv)(l)*(3*d.getStroke().getWidth())));break;case"Polygon":d.getImage()&&d.getImage().getFill().setColor(u),d.getFill()&&d.getFill().setColor(u)}if(d.setText(""),r.setStyle(d),r.drawGeometry(n),a>this.options.animation.duration)return(0,Vn.B)(o),void this.map.ol.render();this.map.ol.render()}).bind(this))}setMap(e){void 0===e?this.watcher.unsubscribe():this.watcher.subscribe(()=>{}),super.setMap(e)}onUnwatch(){this.dataSource.onUnwatch(),this.stopAnimation()}stopAnimation(){this.dataSource.ol.un("addfeature",(function(e){this.visible&&this.flash(e.feature)}).bind(this))}enableTrackFeature(e){this.trackFeatureListenerId=this.dataSource.ol.on("addfeature",this.trackFeature.bind(this,e))}centerMapOnFeature(e){const t=this.dataSource.ol.getFeatureById(e);t&&this.map.ol.getView().setCenter(t.getGeometry().getCoordinates())}trackFeature(e,t){t.feature.getId()===e&&this.visible&&this.centerMapOnFeature(e)}disableTrackFeature(e){(0,Vn.B)(this.trackFeatureListenerId)}customWFSLoader(e,t,o,i,r,s,n,a){{const r=t.paramsWFS,l=r.srsName?new ta.Z({code:r.srsName}):s,c=Fn.$A(i,s,l);r.srsName=r.srsName||s.getCode();const u=Yl(t,c,l,t.ogcFilters);let p=0;if("2.0.0"===r.version&&r.maxFeatures>Gl){const t=1e3;for(;p<r.maxFeatures;){let i=u.replace("count="+r.maxFeatures,"count="+t);i=i.replace("startIndex=0","0"),i+="&startIndex="+p,i.replace(/&&/g,"&"),this.getFeatures(e,o,c,l,s,i,t,n,a),p+=t}}else this.getFeatures(e,o,c,l,s,u,r.maxFeatures,n,a)}}getFeatures(e,t,o,i,r,s,n,a,l){const c=new XMLHttpRequest;c.open("GET",s),t&&t.interceptXhr(c,s);const u=()=>{e.removeLoadedExtent(o),l()};c.onerror=u,c.onload=()=>{if(200===c.status&&c.responseText.length>0){const t=e.getFormat().readFeatures(c.responseText,{dataProjection:i,featureProjection:r});e.addFeatures(t),a(t)}else u()},c.send()}customLoader(e,t,o,i,r,s,n,a){const l=new XMLHttpRequest;l.open("GET","function"==typeof t?t=t(i,r,s):t);const c=e.getFormat();c.getType()===ea.Z.ARRAY_BUFFER&&(l.responseType="arraybuffer"),o&&o.interceptXhr(l,t);const u=()=>{e.removeLoadedExtent(i),a()};l.onerror=u,l.onload=()=>{if(!l.status||l.status>=200&&l.status<300){const t=c.getType();let o;if(t===ea.Z.JSON||t===ea.Z.TEXT?o=l.responseText:t===ea.Z.XML?(o=l.responseXML,o||(o=(new DOMParser).parseFromString(l.responseText,"application/xml"))):t===ea.Z.ARRAY_BUFFER&&(o=l.response),o){const t=c.readFeatures(o,{extent:i,featureProjection:s});e.addFeatures(t,c.readProjection(o)),n(t)}else u()}else u()},l.send()}}class pc extends ql{createOlSource(){return this.options.url||(this.options.url="https://tile.openstreetmap.org/{z}/{x}/{y}.png"),new Ca.Z(this.options)}onUnwatch(){}}class dc extends ql{createOlSource(){return new Ta.Z(this.options)}onUnwatch(){}}class hc extends ql{constructor(e,t,o){super(Vl(e,"wfs")),this.options=e,this.wfsService=t,this.authInterceptor=o,this.ogcFilters$=new C.X(void 0);const i=this.options.ogcFilters,r=this.options.paramsWFS.fieldNameGeometry||Ql,s=new Ul;this.options.ogcFilters=s.defineOgcFiltersDefaultOptions(i,r),this.options.ogcFilters.enabled&&this.options.ogcFilters.editable&&(e.sourceFields||[]).filter(e=>!e.values).length>0&&this.wfsService.getSourceFieldsFromWFS(this.options),(null==i?void 0:i.pushButtons)&&(i.pushButtons.selectorType="pushButton"),(null==i?void 0:i.checkboxes)&&(i.checkboxes.selectorType="checkbox"),(null==i?void 0:i.radioButtons)&&(i.radioButtons.selectorType="radioButton"),(null==i?void 0:i.select)&&(i.select.selectorType="select"),this.setOgcFilters(this.options.ogcFilters,!0)}set ogcFilters(e){this.options.ogcFilters=e}get ogcFilters(){return this.options.ogcFilters}createOlSource(){return new wa.Z({format:Wl(this.options),url:(e,t,o)=>{const i=this.options.paramsWFS,r=i.srsName?new ta.Z({code:i.srsName}):o,s=this.options.ogcFilters,n=Fn.$A(e,o,r);return i.srsName=i.srsName||o.getCode(),Yl(this.options,n,r,s)},strategy:Aa.VW})}setOgcFilters(e,t=!1){this.ogcFilters=e,t&&this.ogcFilters$.next(this.ogcFilters)}onUnwatch(){}}let gc=(()=>{class e extends class{}{constructor(e){super(),this.http=e}getData(){return console.log("This is defining a data service."),"This is defining a data service."}getSourceFieldsFromWFS(e){e.sourceFields&&0!==e.sourceFields.length?this.defineFieldAndValuefromWFS(e).subscribe(t=>{e.sourceFields.forEach(e=>{void 0===e.alias&&(e.alias=e.name),(void 0===e.values||0===e.values.length)&&(e.values=t.find(t=>t.name===e.name).values)})}):(e.sourceFields=[],this.defineFieldAndValuefromWFS(e).subscribe(t=>{e.sourceFields=t}))}wfsGetFeature(e,t=Gl,o=jl,i,r=0,s=!1){const n=Hl(e,t,o,i,r,s).find(e=>"getfeature"===e.name).value,a=e.paramsWFS.outputFormat;return s||zl.test(a)||!a?this.http.get(n,{responseType:"text"}):this.http.get(n)}defineFieldAndValuefromWFS(e){return new Se.y(t=>{var o;const i=[];let r,s,n,a,l;a=Wl(e);const c=JSON.parse(JSON.stringify(e));delete c.paramsWFS.outputFormat,delete c.formatOptions,l=Wl(c);let u=null===(o=e.sourceFields)||void 0===o?void 0:o.filter(e=>!e.values).map(e=>e.name);this.wfsGetFeature(e,1,void 0,void 0,0,!0).pipe((0,bn.b)(e=>String(e).toLowerCase().includes("exception")?(0,A.of)(!1):(0,A.of)(!0)),(0,bn.b)(t=>this.wfsGetFeature(e,1).pipe((0,bn.b)(o=>{const i=a.readFeatures(o);r=i[0].getKeys(),(e.sourceFields||0===e.sourceFields.length)&&(u=r),s=r.filter(e=>u.includes(e)&&e!==i[0].getGeometryName()&&!e.match(/boundedby/gi)),n=s.join(",");const c=[];let p=0;if(!t&&"2.0.0"===e.paramsWFS.version&&e.paramsWFS.maxFeatures>Gl){const t=1e3;for(;p<e.paramsWFS.maxFeatures;)c.push(this.wfsGetFeature(e,t,e.paramsWFS.srsName,n,p)),p+=t;l=a}else c.push(this.wfsGetFeature(e,e.paramsWFS.maxFeatures||Gl,e.paramsWFS.srsName,n,0,!0));return(0,Z.aj)(c)})))).subscribe(e=>{let o=[];e.map(e=>{const t=l.readFeatures(e);o=o.concat(t)}),this.built_properties_value(o).forEach(e=>{i.push(e)}),t.next(i),t.complete()})})}built_properties_value(e){if(0===e.length)return[];const t=Object.assign({},e[0].getProperties());delete t[e[0].getGeometryName()],delete t.boundedBy;const o=[];for(const i in t)if(t.hasOwnProperty(i)){const r="object"==typeof e[0].get(i)?void 0:typeof e[0].get(i);o.push({name:i,alias:i,type:r,values:[t[i]]})}return e.every(e=>{const i=e.getProperties();for(const r in i)i.hasOwnProperty(r)&&r in t&&o.filter(e=>e.name===r).forEach(e=>{-1===e.values.indexOf(i[r])&&e.values.push(i[r])});return!0}),o}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function mc(e){const t=Fn.U2(e||"EPSG:3857").getExtent(),o=(0,$n.dz)(t)/256,i=new Array(20),r=new Array(20);for(let s=0;s<20;++s)i[s]=o/Math.pow(2,s),r[s]=s;return new La.Z({origin:(0,$n.rL)(t),resolutions:i,matrixIds:r})}class fc extends ql{constructor(e){super(e)}createOlSource(){const e=Object.assign({tileGrid:mc(this.options.projection)},this.options);return new Za.Z(e)}onUnwatch(){}}class yc extends ql{get params(){return this.options.params}get queryTitle(){return this.options.queryTitle?this.options.queryTitle:"title"}get mapLabel(){return this.options.mapLabel}get queryHtmlTarget(){return this.options.queryHtmlTarget?this.options.queryHtmlTarget:Bl.BLANK}createOlSource(){const e=Object.assign({crossOrigin:this.options.crossOrigin?this.options.crossOrigin:"anonymous"},this.options);return new Fa.Z(e)}getLegend(){const e=super.getLegend();if(e.length>0)return e;let t="<table>";if(null!=this.options.config.layers[0].legend)return this.options.config.layers[0].legend.items.forEach(e=>{!0===e.visible&&(t+='<tr><td><p><font size="5" color="'+e.value+'"> &#9679</font></p></td><td>'+e.name+"</td></tr>")}),t+="</table>",[{html:t}];{const e=this.options.config.layers[0].options,o=["polygon-fill:","marker-fill:","shield-fill:","building-fill:","line-color:"];for(const i of o)if(e.cartocss.includes(i)){const o=e.cartocss.split(i).pop(),r=o.substr(0,o.indexOf(";"));if(r.includes("ramp")){const e=r.split(", (")[1].split(","),o=r.split(", (")[2].split(",");for(let i=0;i<e.length;i++)e[i]=e[i].replace(/("|\))/g,""),o[i]=o[i].replace(/("|\))/g,""),"="===o[i].replace(/\s+/g,"")&&(o[i]="Autres"),t+='<tr><td><p><font size="5" color="'+e[i]+'"> &#9679</font></p></td><td>'+o[i]+"</td></tr>";break}t+='<tr><td><p><font size="5" color="'+r+'"> &#9679</font></p></td><td>'+(e.layer_name?e.layer_name:"")+"</td></tr>";break}return t+="</table>",[{html:t}]}}onUnwatch(){}}class vc extends ql{createOlSource(){const e=new ca.Z;return new wa.Z({attributions:this.options.params.attributions,overlaps:!1,format:e,url:(function(e,t,o){const i=this.options.url+"/"+this.options.layer+"/query/",r=["f=json",`geometry=${encodeURIComponent('{"xmin":'+e[0]+',"ymin":'+e[1]+',"xmax":'+e[2]+',"ymax":'+e[3]+',"spatialReference":{"wkid":102100}}')}`,"geometryType=esriGeometryEnvelope","inSR=102100","spatialRel=esriSpatialRelIntersects","outFields=*","returnGeometry=true","outSR=102100"];return this.options.params.time&&r.push(`time=${this.options.params.time}`),this.options.params.customParams&&this.options.params.customParams.forEach(e=>{r.push(e)}),`${i}?${r.join("&")}`}).bind(this),strategy:Aa.VW})}getLegend(){const e=this.options.legendInfo,t=super.getLegend();if(void 0===e||t.length>0)return t;const o=parseInt(this.options.layer,10),i=e.layers.find(e=>e.layerId===o);if(!i)return;let r="<table>";for(const s of i.legend)r+=`<tr><td align='left'><img src="${this.options.url.replace("FeatureServer","MapServer")}/${i.layerId}/images/${s.url}" alt ='' /></td><td>`+s.label.replace("<Null>","Null")+"</td></tr>";return r+="</table>",[{html:r}]}onUnwatch(){}}class bc extends ql{get params(){return this.options.params}get queryTitle(){return this.options.queryTitle?this.options.queryTitle:"title"}get mapLabel(){return this.options.mapLabel}get queryHtmlTarget(){return this.options.queryHtmlTarget?this.options.queryHtmlTarget:Bl.BLANK}createOlSource(){const e=void 0===this.options.layer?this.options.params:Object.assign({LAYERS:`show:${this.options.layer}`},this.options.params);return"object"==typeof e.renderingRule&&(e.renderingRule=JSON.stringify(e.renderingRule)),new Oa.Z({ratio:1,params:e,url:this.options.url})}getLegend(){var e,t;const o=(null===(e=this.options.options)||void 0===e?void 0:e.legendInfo)||(null===(t=this.params)||void 0===t?void 0:t.legendInfo),i=super.getLegend();if(void 0===o||void 0===this.options.layer||i.length>0)return i;const r=parseInt(this.options.layer,10),s=o.layers.find(e=>e.layerId===r);if(!s)return;let n="<table>";for(const a of s.legend)n+=`<tr><td align='left'><img src="${this.options.url}/${s.layerId}/images/${a.url}" alt ='' /></td><td>`+a.label.replace("<Null>","Null")+"</td></tr>";return n+="</table>",[{html:n}]}onUnwatch(){}}class xc extends ql{get params(){return this.options.params}get queryTitle(){return this.options.queryTitle?this.options.queryTitle:"title"}get mapLabel(){return this.options.mapLabel}get queryHtmlTarget(){return this.options.queryHtmlTarget?this.options.queryHtmlTarget:Bl.BLANK}createOlSource(){return new Ma.Z(this.options)}getLegend(){const e=this.options.legendInfo,t=super.getLegend();if(void 0===e||t.length>0)return t;const o=parseInt(this.options.layer,10),i=e.layers.find(e=>e.layerId===o);if(!i)return;let r="<table>";for(const s of i.legend)r+=`<tr><td align='left'><img src="${this.options.url}/${i.layerId}/images/${s.url}" alt ='' /></td><td>`+s.label.replace("<Null>","Null")+"</td></tr>";return r+="</table>",[{html:r}]}onUnwatch(){}}class wc extends ql{createOlSource(){const e=JSON.parse(JSON.stringify(this.options));return this.options.tileGrid&&(delete e.tileGrid,e.tileGrid=new ka.Z(this.options.tileGrid)),new Ia.Z(e)}onUnwatch(){}}class Sc extends tc{createOlSource(){return this.createWebSocket(),this.options.format=this.getSourceFormatFromOptions(this.options),super.createOlSource()}createWebSocket(){this.ws=new WebSocket(this.options.url),this.ws.onmessage=this.onMessage.bind(this),this.options.onclose&&(this.ws.onclose=this.onClose.bind(this)),this.options.onerror&&(this.ws.onerror=this.onError.bind(this)),this.options.onopen&&(this.ws.onopen=this.onOpen.bind(this))}onMessage(e){const t=this.options.format.readFeature(e.data);switch(this.options.onmessage){case"update":const e=this.ol.getFeatureById(t.getId());e&&this.ol.removeFeature(e),this.ol.addFeature(t);break;case"delete":this.ol.clear(!0),this.ol.addFeature(t);break;case"add":default:this.ol.addFeature(t)}}onClose(e){}onError(e){}onOpen(e){}onUnwatch(){this.ws.close()}}class Cc extends ql{createOlSource(){let e;return"feature"===this.options.featureClass?e=new _a.Z({featureClass:Tn.Z}):void 0===this.options.featureClass&&(e=new _a.Z),this.options.format=e,new Pa.Z(this.options)}generateId(){return this.options.url?Ps.V.hashStr("mvt"+this.options.url):D()}onUnwatch(){}}class Tc{constructor(){this._converters={},this._converters.esriPMS=Tc._convertEsriPMS,this._converters.esriSFS=Tc._convertEsriSFS,this._converters.esriSLS=Tc._convertEsriSLS,this._converters.esriSMS=Tc._convertEsriSMS,this._converters.esriTS=Tc._convertEsriTS,this._renderers={},this._renderers.uniqueValue=this._renderUniqueValue,this._renderers.simple=this._renderSimple,this._renderers.classBreaks=this._renderClassBreaks}static _convertPointToPixel(e){return e/.75}static _transformColor(e){return[e[0],e[1],e[2],e[3]/255]}static _getResolutionForScale(e,t){const o=Fn.Wm[t];return parseFloat(e)/(39.3701*o*96)}static _convertEsriTS(e){const t=Tc._transformAngle(e.angle),o=void 0!==e.text?e.text:void 0;return new Dn.ZP({text:new En.Z({fill:new Rn.Z({color:Tc._transformColor(e.color)}),font:e.font.style+" "+e.font.weight+" "+e.font.size+" px "+e.font.family,textBaseline:e.verticalAlignment,textAlign:e.horizontalAlignment,offsetX:Tc._convertPointToPixel(e.xoffset),offsetY:Tc._convertPointToPixel(e.yoffset),rotation:t,text:o})})}static _convertEsriPMS(e){const t="data:"+e.contentType+";base64, "+e.imageData,o=Tc._transformAngle(e.angle);return new Dn.ZP({image:new Un.Z({src:t,rotation:o})})}static _convertEsriSFS(e){const t=new Rn.Z({color:Tc._transformColor(e.color)}),o=e.outline?Tc._convertOutline(e.outline):void 0;return new Dn.ZP({fill:t,stroke:o})}static _convertOutline(e){let t;const o=Tc._transformColor(e.color);return"esriSLSDash"===e.style?t=[5]:"esriSLSDashDot"===e.style?t=[5,5,1,2]:"esriSLSDashDotDot"===e.style?t=[5,5,1,2,1,2]:"esriSLSDot"===e.style?t=[1,2]:"esriSLSNull"===e.style&&(o[3]=0),new Nn.Z({color:o,lineDash:t,width:Tc._convertPointToPixel(e.width)})}static _convertEsriSLS(e){return new Dn.ZP({stroke:Tc._convertOutline(e)})}static _transformAngle(e){if(0===e||void 0===e)return;const t=-e*Math.PI/180+Math.PI/2;return t<0?2*Math.PI+t:t}static _convertEsriSMS(e){const t=new Rn.Z({color:Tc._transformColor(e.color)}),o=e.outline?Tc._convertOutline(e.outline):void 0,i=Tc._convertPointToPixel(e.size)/2,r=Tc._transformAngle(e.angle);return"esriSMSCircle"===e.style?new Dn.ZP({image:new Jn.Z({radius:i,fill:t,stroke:o})}):"esriSMSCross"===e.style?new Dn.ZP({image:new Bn.Z({fill:t,stroke:o,points:4,radius:i,radius2:0,angle:0,rotation:r})}):"esriSMSDiamond"===e.style?new Dn.ZP({image:new Bn.Z({fill:t,stroke:o,points:4,radius:i,rotation:r})}):"esriSMSSquare"===e.style?new Dn.ZP({image:new Bn.Z({fill:t,stroke:o,points:4,radius:i,angle:Math.PI/4,rotation:r})}):"esriSMSX"===e.style?new Dn.ZP({image:new Bn.Z({fill:t,stroke:o,points:4,radius:i,radius2:0,angle:Math.PI/4,rotation:r})}):"esriSMSTriangle"===e.style?new Dn.ZP({image:new Bn.Z({fill:t,stroke:o,points:3,radius:i,angle:0,rotation:r})}):void 0}_convertLabelingInfo(e,t){const o=[];for(let i=0,r=e.length;i<r;++i){const r=e[i].labelExpression,s=r.substr(r.indexOf("[")+1,r.indexOf("]")-1),n=e[i].symbol,a=e[i].maxScale,l=e[i].minScale;let c=null;0!==a&&(c=Tc._getResolutionForScale(a,t));let u=null;0!==l&&(u=Tc._getResolutionForScale(l,t));const p=this._converters[n.type].call(this,n);o.push((function(e,t){let o=!0;if(null!==this.minResolution&&null!==this.maxResolution?o=t<this.maxResolution&&t>=this.minResolution:null!==this.minResolution?o=t>=this.minResolution:null!==this.maxResolution&&(o=t<this.maxResolution),o){const t=e.get(this.field);return this.style.getText().setText(t),[this.style]}}).bind({minResolution:c,maxResolution:u,field:s,style:p}))}return o}_renderSimple(e){const t=this._converters[e.symbol.type].call(this,e.symbol);return()=>[t]}_renderClassBreaks(e){const t=e.defaultSymbol,o=this._converters[t.type].call(this,t),i=e.field,r=[];for(let s=0,n=e.classBreakInfos.length;s<n;++s){const t=e.classBreakInfos[s];let o;o=null==t.classMinValue?0===s?e.minValue:e.classBreakInfos[s-1].classMaxValue:t.classMinValue;const i=t.classMaxValue,n=t.symbol,a=this._converters[n.type].call(this,n);r.push({min:o,max:i,style:a})}return e=>{const t=e.get(i);for(let o=0,i=r.length;o<i;++o){let e;if(e=0===o?t>=r[o].min&&t<=r[o].max:t>r[o].min&&t<=r[o].max,e)return[r[o].style]}return[o]}}_renderUniqueValue(e){const t=e.defaultSymbol;let o=[];t&&(o=[this._converters[t.type].call(this,t)]);const i=e.field1,r=e.uniqueValueInfos,s=this;return(()=>{const e={};for(let t=0,o=r.length;t<o;++t){const o=r[t],i=o.symbol;e[o.value]=[s._converters[i.type].call(s,i)]}return t=>e[t.get(i)]||o})()}generateStyle(e,t){const o=e.drawingInfo;let i=[];const r=this._renderers[o.renderer.type].call(this,o.renderer);if(void 0!==r&&i.push(r),e.labelingInfo){const o=this._convertLabelingInfo(e.labelingInfo,t);i=i.concat(o)}return 1===i.length?i[0]:(e,t)=>{let o=[];for(let r=0,s=i.length;r<s;++r){const s=i[r].call(null,e,t);s&&(o=o.concat(s))}return o}}}var Ac=(()=>{return(e=Ac||(Ac={})).DATE="date",e.TIME="time",e.DATETIME="datetime",e.YEAR="year",Ac;var e})(),Zc=(()=>{return(e=Zc||(Zc={})).CALENDAR="calendar",e.SLIDER="slider",Zc;var e})();let Lc=(()=>{class e{constructor(){}getMap(){return this.map}setMap(e){this.map=e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Fc=(()=>{return(e=Fc||(Fc={})).wms="wms",e.wmts="wmts",e.arcgisrest="esriJSON",e.imagearcgisrest="esriJSON",e.tilearcgisrest="esriJSON",Fc;var e})();let Oc=(()=>{class e{constructor(e,t){this.http=e,this.mapService=t,this.parsers={wms:new ga.Z,wmts:new ma.Z,esriJSON:new ca.Z}}getWMSOptions(e){return this.getCapabilities("wms",e.url,e.params.VERSION).pipe((0,x.U)(t=>t?this.parseWMSOptions(e,t):void 0))}getWMTSOptions(e){return this.getCapabilities("wmts",e.url,e.version).pipe((0,x.U)(t=>t?this.parseWMTSOptions(e,t):void 0))}getCartoOptions(e){return this.http.jsonp("https://"+e.account+".carto.com/api/v2/viz/"+e.mapId+"/viz.json","callback").pipe((0,x.U)(t=>this.parseCartoOptions(e,t)))}getArcgisOptions(e){const t=e.url+"/"+e.layer+"?f=json",o=e.url.replace("FeatureServer","MapServer")+"/legend?f=json",i=this.getCapabilities("arcgisrest",e.url),r=this.http.get(t),s=this.http.get(o).pipe((0,x.U)(e=>e),(0,b.K)(e=>(console.log("No legend associated with this Feature Service"),(0,A.of)(e))));return(0,gn.D)([r,s,i]).pipe((0,x.U)(t=>this.parseArcgisOptions(e,t[0],t[1],t[2])))}getImageArcgisOptions(e){const t=e.url+"/"+e.layer+"?f=json",o=e.url.replace("FeatureServer","MapServer")+"/legend?f=json",i=this.getCapabilities("imagearcgisrest",e.url),r=this.http.get(t),s=this.http.get(o).pipe((0,x.U)(e=>e),(0,b.K)(e=>(console.log("No legend associated with this Image Service"),(0,A.of)(e))));return(0,gn.D)([r,s,i]).pipe((0,x.U)(t=>this.parseTileOrImageArcgisOptions(e,t[0],t[1],t[2])))}getTileArcgisOptions(e){const t=e.url+"/"+e.layer+"?f=json",o=e.url+"/legend?f=json",i=this.getCapabilities("tilearcgisrest",e.url),r=this.http.get(t),s=this.http.get(o).pipe((0,x.U)(e=>e),(0,b.K)(e=>(console.log("No legend associated with this Tile Service"),(0,A.of)(e))));return(0,gn.D)([r,s,i]).pipe((0,x.U)(t=>this.parseTileOrImageArcgisOptions(e,t[0],t[1],t[2])))}getCapabilities(e,t,o){const i=new y.LE({fromObject:{request:"GetCapabilities",service:e.toUpperCase(),version:o||"1.3.0",_i:"true"}});let r;return r="esriJSON"===Fc[e]?this.http.get(t+"?f=json"):this.http.get(t,{params:i,responseType:"text"}),r.pipe((0,x.U)(t=>{if("esriJSON"===Fc[e])return t;if(String(t).toLowerCase().includes("serviceexception")&&String(t).toLowerCase().includes("access denied"))throw{error:{message:"Service error getCapabilities: Access is denied"}};return this.parsers[e].read(t)}),(0,b.K)(e=>{throw void 0!==e.error&&(e.error.caught=!0),e}))}parseWMSOptions(e,t){const o=this.findDataSourceInCapabilities(t.Capability.Layer,e.params.LAYERS);if(!o)throw{error:{message:"Layer not found"}};const i=o.DataURL?o.DataURL[0]:void 0,r=o.Abstract?o.Abstract:void 0,s=o.KeywordList?o.KeywordList:void 0;let n=o.queryable;const a=this.getTimeFilter(o),l=a&&Object.keys(a).length>0,c=o.Style?this.getStyle(o.Style):void 0;let u=!0;o.EX_GeographicBoundingBox?o.EX_GeographicBoundingBox.forEach((e,t)=>{t<2&&(e>180||e<-180)&&(u=!1),t>=2&&(e>90||e<-90)&&(u=!1)}):u=!1;const p=u?Fn.$A(o.EX_GeographicBoundingBox,"EPSG:4326",this.mapService.getMap().projection):void 0;let d;const h=[Jl.GEOJSON,Jl.GEOJSON2,Jl.GML3,Jl.GML2,Jl.JSON,Jl.HTML];for(const m of h)if(-1!==t.Capability.Request.GetFeatureInfo.Format.indexOf(m)){const e=Object.keys(Jl).find(e=>Jl[e]===m);d=Nl[e];break}d||(n=!1);const g=_.removeUndefined({_layerOptionsFromSource:{title:o.Title,maxResolution:nc(o.MaxScaleDenominator),minResolution:nc(o.MinScaleDenominator),extent:p,metadata:{url:i?i.OnlineResource:void 0,extern:!!i||void 0,abstract:r,keywordList:s},legendOptions:c},queryable:n,queryFormat:d,timeFilter:l?a:void 0,timeFilterable:!!l||void 0,minDate:l?a.min:void 0,maxDate:l?a.max:void 0,stepDate:l?a.step:void 0});return _.mergeDeep(g,e)}parseWMTSOptions(e,t){const o=t.Contents.Layer.find(t=>t.Identifier===e.layer),i=(0,Za.B)(t,e),r=Object.assign(i,e),s=_.removeUndefined({_layerOptionsFromSource:{title:o.Title}});return _.mergeDeep(s,r)}parseCartoOptions(e,t){const o=[],i=t.layers[1].options.layer_definition;i.layers.forEach(e=>{o.push({type:e.type.toLowerCase(),options:e.options,legend:e.legend})});const r=_.removeUndefined({config:{version:i.version,layers:o}});return _.mergeDeep(r,e)}parseArcgisOptions(e,t,o,i){const r=t.name,s=i.layers?i:void 0,n=(new Tc).generateStyle(t,"esriMeters"===t.units?"m":"degrees"),a=new Zn.Z({target:t.copyrightText});let l,c;if(t.timeInfo){const e=t.timeInfo.timeExtent;l=e[0]+","+e[1];const o=new Date;o.setTime(e[0]);const i=new Date;i.setTime(e[1]),c={min:o.toUTCString(),max:i.toUTCString(),range:!0,type:Ac.DATETIME,style:Zc.CALENDAR}}const u=Object.assign({},{legendInfo:s,style:n,timeFilter:c,timeExtent:l,attributions:a}),p=_.removeUndefined({params:u,_layerOptionsFromSource:{title:r,minResolution:nc(t.maxScale),maxResolution:nc(t.minScale),metadata:{extern:!1,abstract:t.description||o.serviceDescription}},sourceFields:t.fields,queryTitle:t.displayField});return _.mergeDeep(p,e)}parseTileOrImageArcgisOptions(e,t,o,i){const r=t.name,s=o.layers?o:void 0,n=new Zn.Z({target:t.copyrightText});let a,l;if(t.timeInfo){const e=t.timeInfo.timeExtent;a=e[0]+","+e[1];const o=new Date;o.setTime(e[0]);const i=new Date;i.setTime(e[1]),l={min:o.toUTCString(),max:i.toUTCString(),range:!0,type:Ac.DATETIME,style:Zc.CALENDAR}}const c=Object.assign({},{LAYERS:e.layer?"show:"+e.layer:void 0,time:a}),u=_.removeUndefined({params:c,_layerOptionsFromSource:{title:r,minResolution:nc(t.maxScale),maxResolution:nc(t.minScale),metadata:{extern:!1,abstract:t.description||i.serviceDescription}},legendInfo:s,timeFilter:l,attributions:n,sourceFields:t.fields,queryTitle:t.displayField});return _.mergeDeep(u,e)}findDataSourceInCapabilities(e,t){if(Array.isArray(e)){let o;return e.find(e=>(o=this.findDataSourceInCapabilities(e,t),void 0!==o),this),o}return e.Layer?this.findDataSourceInCapabilities(e.Layer,t):e.Name&&e.Name===t?e:void 0}getTimeFilter(e){let t;if(e.Dimension){const o={};if(t=e.Dimension[0],t.values){const e=t.values.split("/");o.min=void 0!==e[0]?e[0]:void 0,o.max=void 0!==e[1]?e[1]:void 0,o.step=void 0!==e[2]?e[2]:void 0}return t.default&&(o.value=t.default),o}}getStyle(e){return{stylesAvailable:e.map(e=>({name:e.Name,title:e.Title})).filter((e,t,o)=>o.findIndex(t=>t.name===e.name)===t)}}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(Lc))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),(0,Ue.gn)([(0,Ne.q)({maxCacheCount:20})],e.prototype,"getCapabilities",null),e})();class Mc{}let Ic=(()=>{class e{constructor(e){this.config=e,(this.config.getConfig("projections")||[]).forEach(e=>{e.alias=e.alias?e.alias:e.code,this.registerProjection(e)});for(let t=1;t<61;t++)this.registerProjection({code:t<10?`EPSG:3260${t}`:`EPSG:326${t}`,def:`+proj=utm +zone=${t} +datum=WGS84 +units=m +no_defs`,extent:void 0});for(let t=1;t<11;t++){const e=t<10?`EPSG:3218${t}`:`EPSG:321${80+t}`;let o;o=Number(t)<=2?-50-3*Number(t):Number(t)>=12?-81-3*(Number(t)-12):-49.5-3*Number(t),this.registerProjection({code:e,def:`+proj=tmerc +lat_0=0 +lon_0=${o} +k=0.9999 +x_0=304800 +y_0=0 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"`,extent:void 0})}}registerProjection(e){_n.Z.defs(e.code,e.def),On.z(_n.Z),e.extent&&Fn.U2(e.code).setExtent(e.extent)}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(z))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),kc=(()=>{class e{constructor(e,t,o,i,r,s,n){this.capabilitiesService=e,this.optionsService=t,this.wfsDataSourceService=o,this.languageService=i,this.messageService=r,this.projectionService=s,this.authInterceptor=n,this.datasources$=new C.X([])}createAsyncDataSource(e,t){if(!e.type)throw console.error(e),new Error("Datasource needs a type");let o;switch(e.type.toLowerCase()){case"osm":o=this.createOSMDataSource(e);break;case"vector":o=this.createFeatureDataSource(e);break;case"wfs":o=this.createWFSDataSource(e);break;case"wms":const i=e;_.removeDuplicateCaseInsensitive(i.params),o=this.createWMSDataSource(i,t);break;case"wmts":o=this.createWMTSDataSource(e);break;case"xyz":o=this.createXYZDataSource(e);break;case"tiledebug":o=this.createTileDebugDataSource(e);break;case"carto":o=this.createCartoDataSource(e);break;case"arcgisrest":o=this.createArcGISRestDataSource(e,t);break;case"imagearcgisrest":o=this.createArcGISRestImageDataSource(e,t);break;case"websocket":o=this.createWebSocketDataSource(e);break;case"mvt":o=this.createMVTDataSource(e);break;case"tilearcgisrest":o=this.createTileArcGISRestDataSource(e,t);break;case"cluster":o=this.createClusterDataSource(e);break;default:throw console.error(e),new Error("Invalid datasource type")}return this.datasources$.next(this.datasources$.value.concat([o])),o}createOSMDataSource(e){return new Se.y(t=>t.next(new pc(e)))}createFeatureDataSource(e){return new Se.y(t=>t.next(new tc(e)))}createWebSocketDataSource(e){return new Se.y(t=>t.next(new Sc(e)))}createWFSDataSource(e){return new Se.y(t=>t.next(new hc(e,this.wfsDataSourceService,this.authInterceptor)))}createWMSDataSource(e,t){const o=[];return e.optionsFromCapabilities&&o.push(this.capabilitiesService.getWMSOptions(e).pipe((0,b.K)(t=>{const o=this.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),i=this.languageService.translate.instant("igo.geo.dataSource.unavailable",{value:e.params.LAYERS});throw this.messageService.error(i,o),t}))),this.optionsService&&!0===e.optionsFromApi&&o.push(this.optionsService.getWMSOptions(e,t).pipe((0,b.K)(e=>(e.error.toDisplay=!0,e.error.title=this.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),e.error.message=this.languageService.translate.instant("igo.geo.dataSource.optionsApiUnavailable"),(0,A.of)({}))))),o.push((0,A.of)(e)),(0,gn.D)(o).pipe((0,x.U)(e=>{const t=e.reduce((e,t)=>_.mergeDeep(e,t));return new Xl(t,this.wfsDataSourceService)}),(0,b.K)(()=>(0,A.of)(void 0)))}createWMTSDataSource(e){return e.optionsFromCapabilities?this.capabilitiesService.getWMTSOptions(e).pipe((0,x.U)(e=>e?new fc(e):void 0),(0,b.K)(()=>{const t=this.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),o=this.languageService.translate.instant("igo.geo.dataSource.unavailable",{value:e.layer});return this.messageService.error(o,t),(0,A.of)(void 0)})):new Se.y(t=>t.next(new fc(e)))}createXYZDataSource(e){return new Se.y(t=>t.next(new dc(e)))}createTileDebugDataSource(e){return new Se.y(t=>t.next(new wc(e)))}createCartoDataSource(e){return e.mapId?this.capabilitiesService.getCartoOptions(e).pipe((0,x.U)(e=>new yc(e))):new Se.y(t=>t.next(new yc(e)))}createArcGISRestDataSource(e,t){const o=[];return o.push(this.capabilitiesService.getArcgisOptions(e).pipe((0,b.K)(t=>{const o=this.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),i=this.languageService.translate.instant("igo.geo.dataSource.unavailable",{value:e.layer});throw this.messageService.error(i,o),t}))),this.optionsService&&!0===e.optionsFromApi&&o.push(this.optionsService.getArcgisRestOptions(e,t).pipe((0,b.K)(e=>(e.error.toDisplay=!0,e.error.title=this.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),e.error.message=this.languageService.translate.instant("igo.geo.dataSource.optionsApiUnavailable"),(0,A.of)({}))))),o.push((0,A.of)(e)),(0,gn.D)(o).pipe((0,x.U)(e=>{const t=e.reduce((e,t)=>_.mergeDeep(e,t));return new vc(t)}),(0,b.K)(()=>(0,A.of)(void 0)))}createArcGISRestImageDataSource(e,t){const o=[];return o.push(this.capabilitiesService.getImageArcgisOptions(e).pipe((0,b.K)(t=>{const o=this.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),i=this.languageService.translate.instant("igo.geo.dataSource.unavailable",{value:e.params.LAYERS});throw this.messageService.error(i,o),t}))),this.optionsService&&!0===e.optionsFromApi&&o.push(this.optionsService.getArcgisRestOptions(e,t).pipe((0,b.K)(e=>(e.error.toDisplay=!0,e.error.title=this.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),e.error.message=this.languageService.translate.instant("igo.geo.dataSource.optionsApiUnavailable"),(0,A.of)({}))))),o.push((0,A.of)(e)),(0,gn.D)(o).pipe((0,x.U)(e=>{const t=e.reduce((e,t)=>_.mergeDeep(e,t));return new bc(t)}),(0,b.K)(()=>(0,A.of)(void 0)))}createTileArcGISRestDataSource(e,t){const o=[];return o.push(this.capabilitiesService.getImageArcgisOptions(e).pipe((0,b.K)(t=>{const o=this.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),i=this.languageService.translate.instant("igo.geo.dataSource.unavailable",{value:e.params.LAYERS});throw this.messageService.error(i,o),t}))),this.optionsService&&!0===e.optionsFromApi&&o.push(this.optionsService.getArcgisRestOptions(e,t).pipe((0,b.K)(e=>(e.error.toDisplay=!0,e.error.title=this.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),e.error.message=this.languageService.translate.instant("igo.geo.dataSource.optionsApiUnavailable"),(0,A.of)({}))))),o.push((0,A.of)(e)),(0,gn.D)(o).pipe((0,x.U)(e=>{const t=e.reduce((e,t)=>_.mergeDeep(e,t));return new xc(t)}),(0,b.K)(()=>(0,A.of)(void 0)))}createMVTDataSource(e){return new Se.y(t=>t.next(new Cc(e)))}createClusterDataSource(e){return new Se.y(t=>t.next(new oc(e)))}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(Oc),r.LFG(Mc,8),r.LFG(gc),r.LFG(ne),r.LFG(le),r.LFG(Ic),r.LFG(rn))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Pc(e,t,o){o=o||it;const i=(new Yn.Z).readFeature(e,{dataProjection:e.projection,featureProjection:t});i.setId(o(e));const r=rt(e);void 0!==r&&i.set("_title",r,!0),void 0!==e.extent&&i.set("_extent",e.extent,!0),void 0!==e.projection&&i.set("_projection",e.projection,!0);const s=ot(e,"meta.mapTitle");void 0!==s&&i.set("_mapTitle",s,!0),i.set("_entityRevision",function(e){return(e.meta||{}).revision||0}(e),!0);const n=st(e);return void 0!==n&&i.set("_icon",n,!0),e.meta&&e.meta.style&&i.set("_style",e.meta.style,!0),e.sourceId&&i.set("_sourceId",e.sourceId,!0),i}function _c(e,t,o,i="EPSG:4326"){let r,s,n,a;const l=new Yn.Z,c=e.getKeys().filter(e=>!e.startsWith("_")&&"geometry"!==e).reduce((t,o)=>(t[o]=e.get(o),t),{}),u=l.writeGeometryObject(e.getGeometry(),{dataProjection:i,featureProjection:t});if(o){r=o.get("title");const e=o.get("sourceOptions");e&&(s=e.excludeAttribute,n=e.excludeAttributeOffline,a=e.idColumn||("arcgisrest"===e.type||"tilearcgisrest"===e.type?"OBJECTID":void 0))}else r=e.get("_title");const p=e.get("_mapTitle"),d=e.getId()?e.getId():e.get(a)?e.get(a):D();return{type:Sl,projection:i,extent:e.get("_extent"),meta:{id:d,title:r||p||d,mapTitle:p,revision:e.getRevision(),style:e.get("_style"),excludeAttribute:s,excludeAttributeOffline:n},properties:c,geometry:u,ol:e}}function $c(e,t){const[o,i]=$n.ap(e);return[t[3]?e[0]-o*t[3]:e[0],t[2]?e[1]-i*t[2]:e[1],t[1]?e[2]+o*t[1]:e[2],t[0]?e[3]+i*t[0]:e[3]]}function qc(e,t,o=Cl.Default,i,r){const s=function(e,t){const o=$n.lJ();return t.forEach(t=>{const i=function(e,t){let o=$n.lJ();const i=t.get("_extent"),r=t.get("_projection");if(void 0!==i&&void 0!==r)o=Fn.$A(i,r,e.projection);else{const e=t.getGeometry();null!==e&&(o=e.getExtent())}return o}(e,t);$n.l7(o,i)}),o}(e,t);let n=s;void 0!==i&&(n=$c(n,i)),o===Cl.Zoom?e.viewController.zoomToExtent(n):o===Cl.Move?e.viewController.moveToExtent(n):o===Cl.Default&&(function(e,t){const o=$c(e.viewController.getExtent(),[-1,-1,-1,-1].map(e=>.05*e));return!$n.r4(o,t)}(e,s)||function(e,t,o){o=o||.004;const i=e.viewController.getExtent(),r=$n.bg(i),s=$n.bg(t);return!(0===s&&e.viewController.getZoom()>13)&&s/r<o}(e,s,r))&&e.viewController.zoomToExtent(n)}function Dc(e,t){void 0===e.layer?(t=t||new uc({source:new tc}),e.bindLayer(t),void 0===e.layer.map&&e.map.addLayer(e.layer)):void 0===e.layer.map&&e.map.addLayer(e.layer)}class Ec extends lt{constructor(e,t){super(e,t),this.map=t.map}get source(){return this.layer?this.layer.dataSource:void 0}bindLayer(e){return this.layer=e,this}setLayerFeatures(e,t=Cl.Default,o,i,r){r=r||it,this.checkLayer();const s=e.map(e=>Pc(e,this.map.projection,r));this.setLayerOlFeatures(s,t,o,i)}setStoreOlFeatures(e){this.checkLayer();const t=e.map(e=>(e.set("_featureStore",this,!0),_c(e,this.layer.map.projection)));this.load(t)}clearLayer(){this.checkLayer(),this.source.ol.clear()}checkLayer(){if(void 0===this.layer)throw new Error("This FeatureStore is not bound to a layer.")}setLayerOlFeatures(e,t=Cl.Default,o,i){const r=function(e,t){const o=new Map;t.forEach(e=>{o.set(e.getId(),e)});const i=[];e.forEach(e=>{const t=o.get(e.getId());void 0===t||t.get("_entityRevision")!==e.get("_entityRevision")?i.push(e):o.delete(t.getId())});const r=Array.from(o.keys());return{add:t.filter(e=>r.indexOf(e.getId())>=0),remove:i}}(this.layer.ol.getSource().getFeatures(),e);r.remove.length>0&&this.removeOlFeaturesFromLayer(r.remove),r.add.length>0&&this.addOlFeaturesToLayer(r.add),r.add.length>0?qc(this.map,r.add,t,o,i):r.remove.length>0&&qc(this.map,e,t,o,i)}addOlFeaturesToLayer(e){e.forEach(e=>{e.set("_featureStore",this,!0)}),this.source.ol.addFeatures(e)}removeOlFeaturesFromLayer(e){e.forEach(e=>{this.source.ol.removeFeature(e)})}}class Rc extends ut{constructor(e){super(e),this.options=e,this.stores$$=new Map,this.states$$=[]}bindStore(e){super.bindStore(e),!0===this.active&&this.watchStore(e),this.empty$$=e.empty$.pipe((0,xn.n)(e=>!e)).subscribe(()=>this.updateEntitiesInExtent(e))}unbindStore(e){super.unbindStore(e),!0===this.active&&this.unwatchStore(e)}doActivate(){this.stores.forEach(e=>this.watchStore(e))}doDeactivate(){this.unwatchAll()}watchStore(e){this.stores$$.has(e)||(this.updateEntitiesInExtent(e),this.states$$.push(e.layer.map.viewController.state$.subscribe(()=>{this.updateEntitiesInExtent(e)})))}updateEntitiesInExtent(e){var t,o;if(null===(o=null===(t=null==e?void 0:e.layer)||void 0===t?void 0:t.map)||void 0===o?void 0:o.viewController){e.state.updateAll({inMapExtent:!1});const t=e.layer.map.viewController.getExtent(),o=e.entities$.value.filter(e=>$n.kK(e.ol.getGeometry().getExtent(),t));o.length>0&&e.state.updateMany(o,{inMapExtent:!0},!0)}}unwatchStore(e){void 0!==this.stores$$.get(e)&&this.stores$$.delete(e)}unwatchAll(){this.stores$$.clear(),this.states$$.map(e=>e.unsubscribe()),this.empty$$&&this.empty$$.unsubscribe()}}class Uc extends ut{constructor(e){super(e),this.options=e,this.stores$$=new Map,this.resolution$$=[]}bindStore(e){super.bindStore(e),!0===this.active&&this.watchStore(e),this.empty$$=e.empty$.subscribe(()=>this.updateEntitiesInResolution(e,e.layer.map.viewController.getResolution()))}unbindStore(e){super.unbindStore(e),!0===this.active&&this.unwatchStore(e)}doActivate(){this.stores.forEach(e=>this.watchStore(e))}doDeactivate(){this.unwatchAll()}watchStore(e){this.stores$$.has(e)||(this.updateEntitiesInResolution(e,e.layer.map.viewController.getResolution()),this.resolution$$.push(e.layer.map.viewController.resolution$.subscribe(t=>{this.updateEntitiesInResolution(e,t)})))}updateEntitiesInResolution(e,t){e.state.updateAll(t>e.layer.minResolution&&t<e.layer.maxResolution?{inMapResolution:!0}:{inMapResolution:!1})}unwatchStore(e){void 0!==this.stores$$.get(e)&&this.stores$$.delete(e)}unwatchAll(){this.stores$$.clear(),this.resolution$$.map(e=>e.unsubscribe()),this.empty$$&&this.empty$$.unsubscribe()}}class Nc extends ut{constructor(e){super(e),this.options=e,this.stores$$=new Map,this.setMotion(e.motion)}bindStore(e){super.bindStore(e),!0===this.active&&this.watchStore(e)}unbindStore(e){super.unbindStore(e),!0===this.active&&this.unwatchStore(e)}setMotion(e){this.motion=e}doActivate(){this.stores.forEach(e=>this.watchStore(e))}doDeactivate(){this.unwatchAll()}watchStore(e){if(this.stores$$.has(e))return;const t=e.view.all$().subscribe(t=>this.onFeaturesChange(t,e));this.stores$$.set(e,t)}unwatchStore(e){const t=this.stores$$.get(e);void 0!==t&&(t.unsubscribe(),this.stores$$.delete(e))}unwatchAll(){Array.from(this.stores$$.entries()).forEach(e=>{e[1].unsubscribe()}),this.stores$$.clear()}onFeaturesChange(e,t){0===e.length?t.clearLayer():t.setLayerFeatures(e,this.selectMotion(t),this.options.viewScale,this.options.areaRatio,this.options.getFeatureId)}selectMotion(e){return void 0!==this.motion?this.motion:!0===e.pristine||e.count>e.view.count?Cl.Default:Cl.None}}class Jc extends ut{constructor(e){super(e),this.options=e,this.stores$$=new Map}bindStore(e){super.bindStore(e),!0===this.active&&this.watchStore(e)}unbindStore(e){super.unbindStore(e),!0===this.active&&this.unwatchStore(e)}doActivate(){this.stores.forEach(e=>this.watchStore(e))}doDeactivate(){this.unwatchAll()}watchStore(e){this.stores$$.has(e)||(this.onSourceChanges(e),e.layer.ol.getSource().on("change",t=>{this.onSourceChanges(e)}))}unwatchStore(e){void 0!==this.stores$$.get(e)&&this.stores$$.delete(e)}unwatchAll(){Array.from(this.stores$$.entries()).forEach(e=>{}),this.stores$$.clear()}onSourceChanges(e){let t=e.layer.ol.getSource().getFeatures();e.layer.dataSource instanceof oc&&(t=t.flatMap(e=>e.get("features"))),0===t.length?e.clear():e.setStoreOlFeatures(t)}}class Bc extends $a.Z{constructor(e){super(e)}}class jc extends ut{constructor(e){super(e),this.options=e,this.setMotion(e.motion),this._overlayStore=this.createOverlayStore()}get map(){return this.options.map}get overlayStore(){return this._overlayStore}bindStore(e){super.bindStore(e),!0===this.active&&this.activate()}unbindStore(e){super.unbindStore(e),!0===this.active&&this.activate()}setMotion(e){this.motion=e}unselectAll(){this.stores.forEach(e=>{e.state.updateAll({selected:!1})})}clear(){this.overlayStore.source.ol.clear(),this.overlayStore.clear()}deactivateSelection(){this.removeDragBoxInteraction(),this.unwatchAll()}doActivate(){this.addOverlayLayer(),this.listenToMapClick(),!0===this.options.dragBox&&this.addDragBoxInteraction(),this.watchAll()}doDeactivate(){this.deactivateSelection(),this.removeOverlayLayer()}watchAll(){this.unwatchAll();const e=this.stores.map(e=>e.stateView.manyBy$(e=>!0===e.state.selected).pipe((0,x.U)(e=>e.map(e=>e.entity))));this.stores$$=(0,Z.aj)(e).pipe((0,w.b)(5),(0,Ae.T)(1),(0,x.U)(e=>e.reduce((e,t)=>e.concat(t)))).subscribe(e=>this.onSelectFromStore(e))}unwatchAll(){void 0!==this.stores$$&&this.stores$$.unsubscribe()}listenToMapClick(){this.mapClickListener=this.map.ol.on("singleclick",e=>{this.onMapClick(e)})}onMapClick(e){const t=!ac(e),o=!t,i=e.map.getFeaturesAtPixel(e.pixel,{hitTolerance:this.options.hitTolerance||0,layerFilter:e=>void 0!==this.stores.find(t=>t.layer.ol===e)});this.onSelectFromMap(i,t,o)}addDragBoxInteraction(){let e;const t=this.map.ol.getInteractions().getArray();for(const o of t)if(o instanceof Bc){e=o;break}void 0===e&&(e=new Bc({condition:ac}),this.map.ol.addInteraction(e),this.olDragSelectInteraction=e),this.olDragSelectInteractionEndKey=e.on("boxend",e=>this.onDragBoxEnd(e))}removeDragBoxInteraction(){void 0!==this.olDragSelectInteractionEndKey&&(0,Vn.B)(this.olDragSelectInteractionEndKey),void 0!==this.olDragSelectInteraction&&this.map.ol.removeInteraction(this.olDragSelectInteraction),this.olDragSelectInteraction=void 0}onDragBoxEnd(e){const t=!ac(e.mapBrowserEvent),o=e.target.getGeometry().getExtent(),i=this.stores.reduce((e,t)=>{const i=t.layer.ol.getSource();return e.push(...i.getFeaturesInExtent(o)),e},[]);this.onSelectFromMap(i,t,!1)}onSelectFromStore(e){const t=this.motion,o=this.overlayStore.layer.ol.getSource().getFeatures().map(e=>e.getId()),i=e.map(this.overlayStore.getKey);let r;r=0!==e.length&&(o.length!==i.length||!o.every(e=>i.indexOf(e)>=0)),this.overlayStore.setLayerFeatures(e,r?t:Cl.None,this.options.viewScale,this.options.areaRatio,this.options.getFeatureId)}onSelectFromMap(e,t,o){const i=this.groupFeaturesByStore(e);this.stores.forEach(e=>{const r=i.get(e);void 0===r&&!0===t?this.unselectAllFeaturesFromStore(e):void 0===r&&!1===t||this.selectFeaturesFromStore(e,r,t,o)})}selectFeaturesFromStore(e,t,o,i){!0===i?e.state.reverseMany(t,["selected"]):e.state.updateMany(t,{selected:!0},o)}unselectAllFeaturesFromStore(e){e.state.updateAll({selected:!1})}groupFeaturesByStore(e){const t=new Map;return null==e||e.forEach(e=>{const o=e.get("_featureStore");if(void 0===o)return;let i=t.get(o);void 0===i&&(i=[],t.set(o,i));const r=o.get(e.getId());void 0!==r&&i.push(r)}),t}createOverlayStore(){const e=this.options.layer?this.options.layer:this.createOverlayLayer();return new Ec([],{map:this.map}).bindLayer(e)}createOverlayLayer(){return new uc({zIndex:300,source:new tc,style:void 0,showInLayerList:!1,exportable:!1,browsable:!1})}addOverlayLayer(){void 0===this.overlayStore.layer.map&&this.map.addLayer(this.overlayStore.layer)}removeOverlayLayer(){this.overlayStore.source.ol.clear(),this.map.removeLayer(this.overlayStore.layer)}}function Gc(e,t){void 0===e.getStrategyOfType(Nc)?(t=t||new Nc({}),e.addStrategy(t),t.activate()):e.activateStrategyOfType(Nc)}function Qc(e,t){void 0===e.getStrategyOfType(jc)?(t=t||new jc({map:e.map}),e.addStrategy(t),t.activate()):e.activateStrategyOfType(jc)}function zc({text:e,opacity:t=1,markerColor:o=[0,161,222],markerOutlineColor:i=[255,255,255]}={}){let r,s,n,a;const l=/msie\s|trident\/|edge\//i.test(window.navigator.userAgent),c=(0,Xn._2)(o).slice(0),u=(0,Xn._2)(i).slice(0);let p;if(4===c.length&&("string"!=typeof o||/^#[0-9A-F]{8}$/i.test(o))&&(t=c[3]),s=`"rgba(${c[0]},${c[1]},${c[2]},${t})"`,r=o,n=`"rgb(${u[0]},${u[1]},${u[2]})"`,a='data:image/svg+xml;utf8,<svg version="1.1" xmlns="http://www.w3.org/2000/svg" height="36" width="36" viewBox="0 0 36 36"><path fill='+s+" stroke="+n+' stroke-width="2" d="M 17.692635,32.565644 C 15.71852,30.330584 13.290925,27.058065 11.6766,24.455732 9.3398623,20.688851 7.8905694,17.205334 7.6297492,14.728733 7.5616025,14.081649 7.5739557,12.528552 7.6513363,12.014724 8.1013861,9.0262716 9.8047068,6.3655569 12.310675,4.7364878 c 1.113691,-0.7239832 2.508083,-1.2834131 3.776687,-1.5152052 0.242945,-0.044389 0.451656,-0.09393 0.463804,-0.1100911 0.01215,-0.016161 0.638282,-0.025502 1.391411,-0.02076 1.088235,0.00685 1.450932,0.024316 1.766871,0.085071 2.650763,0.5097353 4.947142,1.8701891 6.498786,3.8501033 0.628018,0.8013587 1.297046,2.0200608 1.640967,2.9891872 0.191065,0.538399 0.427644,1.447408 0.477391,1.834287 0.0164,0.127546 0.0434,0.231902 0.06,0.231902 0.0166,0 0.03122,0.626135 0.03249,1.391411 0.0013,0.765276 -0.011,1.391411 -0.02726,1.391411 -0.01626,0 -0.05449,0.154049 -0.08495,0.342331 -0.08815,0.544879 -0.387235,1.721449 -0.604837,2.379406 -1.209421,3.656888 -4.014463,8.349762 -7.849521,13.132357 -0.790496,0.985807 -1.795217,2.167992 -1.842543,2.167992 -0.01896,0 -0.161766,-0.144111 -0.317336,-0.320246 z m 1.066937,-15.36525 c 0.133519,-0.02121 0.248766,-0.05657 0.256105,-0.07859 0.0073,-0.02202 0.04918,-0.03066 0.09298,-0.0192 0.0438,0.01145 0.107628,-0.0072 0.141834,-0.04137 0.03421,-0.03421 0.08456,-0.05474 0.111888,-0.04563 0.02733,0.0091 0.07703,-0.01077 0.110429,-0.04417 0.03341,-0.03341 0.08416,-0.05293 0.112796,-0.04338 0.02863,0.0095 0.08974,-0.01867 0.135802,-0.06271 0.04606,-0.04403 0.111902,-0.08625 0.146319,-0.09381 0.204084,-0.04483 0.762371,-0.519108 1.079463,-0.917027 0.26749,-0.335672 0.570987,-0.878795 0.529019,-0.946701 -0.01496,-0.0242 -0.0067,-0.044 0.01835,-0.044 0.05645,0 0.196809,-0.467982 0.158801,-0.529481 -0.01521,-0.02461 -0.0043,-0.04475 0.02427,-0.04475 0.03157,0 0.04365,-0.04329 0.03082,-0.11043 -0.01161,-0.06074 -0.0066,-0.110429 0.01124,-0.110429 0.01779,0 0.03235,-0.258405 0.03235,-0.574233 0,-0.315829 -0.01545,-0.574234 -0.03434,-0.574234 -0.01889,0 -0.02437,-0.03811 -0.01219,-0.08469 0.04412,-0.168712 -0.336329,-1.152668 -0.481536,-1.245401 -0.02327,-0.01486 -0.04022,-0.03992 -0.03765,-0.05568 0.01222,-0.07498 -0.156557,-0.318365 -0.406379,-0.586027 -0.295921,-0.317054 -0.773059,-0.690104 -0.83427,-0.652274 -0.0206,0.01273 -0.03745,0.0024 -0.03745,-0.02289 0,-0.06107 -0.433076,-0.2789369 -0.487546,-0.245273 -0.02338,0.01445 -0.04251,0.0068 -0.04251,-0.01695 0,-0.056281 -0.393995,-0.1865457 -0.613804,-0.2029397 -0.0943,-0.00703 -0.188579,-0.023183 -0.209503,-0.035888 -0.02092,-0.012705 -0.276571,-0.023337 -0.568105,-0.023627 -0.534044,-5.301e-4 -1.12638,0.091025 -1.12638,0.1741017 0,0.023781 -0.01713,0.032648 -0.03808,0.019705 -0.05054,-0.031232 -0.403641,0.1088602 -0.403641,0.1601422 0,0.02204 -0.01988,0.02779 -0.04417,0.01278 -0.0243,-0.01501 -0.04417,-0.0051 -0.04417,0.02209 0,0.02716 -0.01988,0.0371 -0.04417,0.02209 -0.0243,-0.01501 -0.04417,-0.0051 -0.04417,0.02209 0,0.02716 -0.01915,0.03755 -0.04256,0.02308 -0.02341,-0.01447 -0.08138,0.01252 -0.128834,0.05997 -0.04745,0.04745 -0.0974,0.07515 -0.111001,0.06155 -0.0136,-0.0136 -0.03722,0.0078 -0.05248,0.0476 -0.01526,0.03978 -0.0411,0.06408 -0.0574,0.054 -0.03277,-0.02025 -0.462299,0.323995 -0.491977,0.394291 -0.01026,0.02429 -0.07454,0.0912 -0.142856,0.148686 -0.248033,0.208705 -0.730279,0.974169 -0.672565,1.067553 0.0145,0.02346 0.0059,0.04266 -0.01914,0.04266 -0.05907,0 -0.241471,0.599428 -0.208527,0.685278 0.01385,0.0361 0.0044,0.06564 -0.02098,0.06564 -0.02539,0 -0.04169,0.0646 -0.03622,0.143558 0.0055,0.07896 -0.0042,0.213129 -0.02144,0.29816 -0.04741,0.233576 0.0511,1.055502 0.167516,1.397721 0.126048,0.370516 0.310099,0.740163 0.426484,0.856548 0.04776,0.04776 0.07554,0.08684 0.06174,0.08684 -0.0138,0 0.01516,0.05653 0.06436,0.125632 0.131301,0.184396 0.499365,0.587266 0.518785,0.567846 0.0092,-0.0092 0.09821,0.06081 0.197812,0.155562 0.09961,0.09475 0.190589,0.162786 0.202187,0.151188 0.0116,-0.0116 0.05991,0.01774 0.107361,0.06519 0.04745,0.04745 0.105426,0.07444 0.128834,0.05997 0.02341,-0.01447 0.04256,-0.0057 0.04256,0.01958 0,0.06106 0.344664,0.23496 0.399061,0.201341 0.02346,-0.0145 0.04266,-0.0059 0.04266,0.01914 0,0.05907 0.599429,0.241471 0.685279,0.208527 0.0361,-0.01385 0.06564,-0.0065 0.06564,0.01645 0,0.05196 1.079115,0.04833 1.413314,-0.0048 z"></path></svg>',l){switch(o){case"blue":r="blue";break;case"red":r="red";break;case"yellow":r="yellow";break;case"green":r="green";break;default:r="blue"}p="./assets/igo2/geo/icons/place_"+r+"_36px.svg"}else p=a;return new Dn.ZP({image:new Un.Z({src:a,opacity:t,imgSize:[36,36],anchor:[.5,.92]}),text:new En.Z({text:e,font:"12px Calibri,sans-serif",fill:new Rn.Z({color:"#000"}),stroke:new Nn.Z({color:"#fff",width:3}),overflow:!0})})}let Yc=(()=>{class e{createStyle(e){return e?"function"==typeof e||e instanceof Dn.ZP?e:this.parseStyle("style",e):zc()}parseStyle(e,t){const o={},i=this.getOlCls(e);return i&&t instanceof Object?(Object.keys(t).forEach(e=>{const i=this.getOlKey(e);o[i]=this.parseStyle(e,t[e])}),new i(o)):t}getOlKey(e){let t;switch(e.toLowerCase()){case"circle":case"regularshape":case"icon":t="image"}return t||e}getOlCls(e){let t=qn[e.charAt(0).toUpperCase()+e.slice(1)];return"regularshape"===e&&(t=Bn.Z),"backgroundFill"===e&&(t=Rn.Z),"backgroundStroke"===e&&(t=Nn.Z),t}createStyleByAttribute(e,t){let o;const i=t.type?t.type:this.guessTypeFeature(e),r=t.attribute,s=t.data,n=t.stroke,a=t.width,l=t.fill,c=t.radius,u=t.icon,p=t.scale,d=s?s.length:0,h=t.label,g=h instanceof Dn.ZP?this.parseStyle("text",t.label)||new En.Z:void 0,m=t.baseStyle;if(g){const t={text:this.getLabel(e,h)};g.setText(g instanceof Dn.ZP?new En.Z(t):this.getLabel(e,h))}if("circle"===i){for(let t=0;t<d;t++){const i=void 0!==e.get(r)?e.get(r):"";if(i===s[t]||i.toString().match(s[t]))return u?(o=[new Dn.ZP({image:new Un.Z({src:u[t],scale:p?p[t]:1})})],o):(o=[new Dn.ZP({image:new Jn.Z({radius:c?c[t]:4,stroke:new Nn.Z({color:n?n[t]:"black",width:a?a[t]:1}),fill:new Rn.Z({color:l?l[t]:"black"})}),text:g instanceof En.Z?g:void 0})],o)}if(!e.getStyle())return m?(o=this.createStyle(m),g&&o.setText(g),o):(o=[new Dn.ZP({image:new Jn.Z({radius:4,stroke:new Nn.Z({color:"black"}),fill:new Rn.Z({color:"#bbbbf2"})})})],o)}else if("regular"===i){for(let t=0;t<d;t++){const i=void 0!==e.get(r)?e.get(r):"";if(i===s[t]||i.toString().match(s[t]))return o=[new Dn.ZP({stroke:new Nn.Z({color:n?n[t]:"black",width:a?a[t]:1}),fill:new Rn.Z({color:l?l[t]:"rgba(255,255,255,0.4)"}),text:g instanceof En.Z?g:void 0})],o}if(e instanceof Tn.Z&&!e.getStyle())return m?(o=this.createStyle(m),g&&o.setText(g),o):(o=[new Dn.ZP({stroke:new Nn.Z({color:"black"}),fill:new Rn.Z({color:"#bbbbf2"})})],o)}}createClusterStyle(e,t={},o){let i;const r=e.get("features").length;if(1!==r){if(t.clusterRanges)for(const e of t.clusterRanges)if((!e.minRadius||e.minRadius<=r)&&(!e.maxRadius||e.maxRadius>=r)){if(i=this.createStyle(e.style),e.showRange){const e=new En.Z({text:r.toString(),fill:new Rn.Z({color:"#fff"})});i.setText(e)}if(e.dynamicRadius){let e;const t=i.getRadius();e=5*Math.log(r),e<t&&(e=t),i.image_.setRadius(e)}break}if(!i){let e;if(t.radiusCalc)e=t.radiusCalc(r);else{const t=6;e=5*Math.log(r),e<t&&(e=t)}i=[new Dn.ZP({image:new Jn.Z({radius:e,stroke:new Nn.Z({color:"black"}),fill:new Rn.Z({color:"rgba(24, 134, 45, 0.5)"})}),text:new En.Z({text:r.toString(),fill:new Rn.Z({color:"#fff"})})})]}}else i=this.createStyle(o);return i}getLabel(e,t){let o=t;const i=Array.from(t.matchAll(/\$\{([^\{\}]+)\}/g));return i.forEach(t=>{o=o.replace(t[0],e.get(t[1]))}),0===i.length&&o===t&&(o=e.get(t)||t),o}guessTypeFeature(e){switch(e.getGeometry().getType()){case"Point":case"MultiPoint":case"Circle":return"circle";default:return"regular"}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Hc(){const e=function({text:e,strokeWidth:t=2,fillColor:o=[0,161,222,.3],strokeColor:i=[0,161,222,.9]}={}){const r=(0,Xn._2)(o).slice(0),s=(0,Xn._2)(i).slice(0),n=new Nn.Z({width:t,color:s}),a=new Rn.Z({color:r});return new Dn.ZP({stroke:n,fill:a,image:new Jn.Z({radius:5,stroke:n,fill:a}),text:new En.Z({text:e,font:"12px Calibri,sans-serif",fill:new Rn.Z({color:"#000"}),stroke:new Nn.Z({color:"#fff",width:3}),overflow:!0})})}(),t=zc();let o;return i=>{if("bufferFeature"===i.getId())return o=function(e=[0,161,222,1],t=2,o=[0,161,222,.15],i){const r=new Nn.Z({width:t,color:e}),s=new Rn.Z({color:o});return new Dn.ZP({stroke:r,fill:s,image:new Jn.Z({radius:5,stroke:r,fill:s}),text:new En.Z({font:"12px Calibri,sans-serif",text:i,fill:new Rn.Z({color:"#000"}),stroke:new Nn.Z({color:"#fff",width:3}),overflow:!0})})}(i.get("bufferStroke"),2,i.get("bufferFill"),i.get("bufferText")),o;{const r=i.get("_style");return r?(new Yc).createStyle(r):(o="Point"===i.getGeometry().getType()?t:e,o.getText().setText(i.get("_mapTitle")),o)}}}class Vc{constructor(e){this.layer=function(){const e=new tc;return new uc({title:"Overlay",zIndex:300,source:e,style:Hc()})}(),this.setMap(e)}get dataSource(){return this.layer.dataSource}setMap(e){void 0===e?void 0!==this.map&&this.map.ol.removeLayer(this.layer.ol):e.ol.addLayer(this.layer.ol),this.map=e}setFeatures(e,t=Cl.Default,o){if(o)for(const i of this.dataSource.ol.getFeatures())i.get("_sourceId")===o&&this.removeOlFeature(i);else this.clear();this.addFeatures(e,t)}addFeature(e,t=Cl.Default){this.addFeatures([e],t)}addFeatures(e,t=Cl.Default){const o=[];e.forEach(e=>{const t=Pc(e,this.map.projection);null!==t.getGeometry()&&o.push(t)}),this.addOlFeatures(o,t)}addOlFeature(e,t=Cl.Default){this.addOlFeatures([e],t)}addOlFeatures(e,t=Cl.Default){this.dataSource.ol.addFeatures(e),qc(this.map,e,t)}removeFeature(e){this.removeFeatures([e])}removeFeatures(e){e.forEach(e=>{e.meta&&this.dataSource.ol.getFeatureById(e.meta.id)&&this.removeOlFeature(this.dataSource.ol.getFeatureById(e.meta.id))})}removeOlFeature(e){this.dataSource.ol.removeFeature(e)}clear(){this.dataSource.ol.clear()}}class Wc extends R{constructor(){super(),this.loaded=0,this.loading=0,this.layers=[],this.subscriptions=[]}watch(){}unwatch(){this.layers.forEach(e=>this.unwatchLayer(e),this)}watchLayer(e){if(void 0===e.status$)return;this.layers.push(e);const t=e.status$.pipe((0,M.x)()).subscribe(e=>{e===E.Error&&(this.loading=0,this.loaded=-1),e===E.Working?this.loading+=1:e===E.Done&&(this.loaded+=1),this.loaded>=this.loading?(this.loading=this.loaded=0,this.status=E.Done):this.loading>0&&(this.status=E.Working)});this.subscriptions.push(t)}unwatchLayer(e){e.status$.next(E.Done);const t=this.layers.indexOf(e);t>=0&&(-1!==[E.Working,E.Waiting].indexOf(e.watcher.status)&&(this.loaded+=1),this.subscriptions[t].unsubscribe(),this.subscriptions.splice(t,1),this.layers.splice(t,1),e.watcher.unwatch())}}var Xc=(()=>{return(e=Xc||(Xc={}))[e.Move=0]="Move",e[e.Zoom=1]="Zoom",Xc;var e})();class Kc extends class{constructor(){this.observerKeys=[]}getOlMap(){return this.olMap}setOlMap(e){if(void 0!==e&&void 0!==this.getOlMap())throw new Error("This controller is already bound to a map.");if(void 0===e)return this.teardownObservers(),void(this.olMap=e);this.olMap=e}teardownObservers(){this.observerKeys.forEach(e=>(0,Vn.B)(e)),this.observerKeys=[]}}{constructor(e){super(),this.options=e,this.resolution$=new C.X(void 0),this.state$=new C.X(void 0),this.padding=[0,0,0,0],this.maxZoomOnExtent=19,this.extent$=new O.xQ,this.states=[],this.stateIndex=0}get stateHistory(){return!!this.options&&!0===this.options.stateHistory}get olView(){return this.olMap.getView()}setOlMap(e){super.setOlMap(e),this.setupObservers()}setupObservers(){!0===this.stateHistory&&this.observerKeys.push(this.olMap.on("moveend",e=>this.onMoveEnd(e))),this.extent$$=this.extent$.pipe((0,w.b)(25)).subscribe(e=>{this.setExtent(e.extent,e.action)})}teardownObservers(){super.teardownObservers(),void 0!==this.extent$$&&(this.extent$$.unsubscribe(),this.extent$$=void 0)}getOlProjection(){return this.olView.getProjection()}getCenter(e){let t=this.olView.getCenter();return e&&t&&(t=Fn.vs(t,this.getOlProjection(),e)),t}getExtent(e){let t=this.olView.calculateExtent(this.olMap.getSize());return e&&t&&(t=Fn.$A(t,this.getOlProjection(),e)),t}getScale(e=96){return function(e,t="m",o=96){return e*Fn.Wm[t]*39.3701*o}(this.getResolution(),this.getOlProjection().getUnits(),e)}getResolution(){return this.olView.getResolution()}getZoom(){return Math.round(this.olView.getZoom())}zoomIn(){this.zoomTo(this.olView.getZoom()+1)}zoomOut(){this.zoomTo(this.olView.getZoom()-1)}zoomTo(e){this.olView.cancelAnimations(),this.olView.animate({zoom:e,duration:250,easing:Wn.Vv})}moveToExtent(e){this.extent$.next({extent:e,action:Xc.Move})}zoomToExtent(e){this.extent$.next({extent:e,action:Xc.Zoom})}getRotation(){return this.olView.getRotation()}resetRotation(){this.olView.animate({rotation:0})}hasPreviousState(){return this.states.length>1&&this.stateIndex>0}hasNextState(){return this.states.length>1&&this.stateIndex<this.states.length-1}previousState(){this.hasPreviousState()&&this.setStateIndex(this.stateIndex-1)}nextState(){this.hasNextState()&&this.setStateIndex(this.stateIndex+1)}clearStateHistory(){this.states=[],this.stateIndex=0}setInitialState(){this.states.length>0&&this.setStateIndex(0)}setExtent(e,t,o=!0){const i=this.olView;i.cancelAnimations();const r=o?500:0,s=i.getZoom(),n=i.getCenter(),a=[e[0]+(e[2]-e[0])/2,e[1]+(e[3]-e[1])/2],l=Math.sqrt(Math.pow(n[0]-a[0],2)+Math.pow(n[1]-a[1],2)),c=i.calculateExtent(),u=Math.sqrt(Math.pow(c[2]-c[0],2)+Math.pow(c[3]-c[1],2)),p=l/((Math.sqrt(Math.pow(e[2]-e[0],2)+Math.pow(e[3]-e[1],2))+u)/2),d=t===Xc.Move||s>this.maxZoomOnExtent?s:this.maxZoomOnExtent;i.fit(e,{size:this.olMap.getSize(),maxZoom:d,padding:this.padding,duration:p>4?0:r,callback:t=>{t||i.fit(e,{size:this.olMap.getSize(),maxZoom:d,padding:this.padding,duration:p>4?0:r})}})}setStateIndex(e){this.stateIndex=e,this.setState(this.states[e])}setState(e){this.olView.animate({resolution:e.resolution,center:e.center,duration:0})}onMoveEnd(e){const t=this.getResolution();this.resolution$.value!==t&&this.resolution$.next(t);const o={resolution:t,center:this.getCenter(),zoom:this.getZoom()};if(!0===this.stateHistory){const e=this.stateIndex;(function(e,t){if(void 0===e||void 0===t)return!1;const o=1e-4;return e.zoom===t.zoom&&Math.trunc(e.center[0]/o)===Math.trunc(t.center[0]/o)&&Math.trunc(e.center[1]/o)===Math.trunc(t.center[1]/o)})(o,0===this.states.length?void 0:this.states[e])||(this.states=this.states.slice(0,e+1).concat([o]),this.stateIndex=this.states.length-1)}this.state$.next(o)}}class eu{constructor(e){this.offlineButtonToggle$=new C.X(!1),this.layers$=new C.X([]),this.positionFollower=!0,this.geolocation$=new C.X(void 0),this.swipeEnabled$=new C.X(!1),this.mapCenter$=new C.X(!1),this.selectedFeatures$=new C.X(null),this.defaultOptions={controls:{attribution:!1}},this.options=Object.assign({},this.defaultOptions,e),this.layerWatcher=new Wc,this.status$=this.layerWatcher.status$,On.z(_n.Z),this.init()}get layers(){return this.layers$.value}get projection(){return this.viewController.getOlProjection().getCode()}init(){const e=[];this.options.controls&&(this.options.controls.attribution&&e.push(new Zn.Z(!0===this.options.controls.attribution?{}:this.options.controls.attribution)),this.options.controls.scaleLine&&e.push(new Ln.Z(!0===this.options.controls.scaleLine?{}:this.options.controls.scaleLine)));let t={};!1===this.options.interactions&&(t={altShiftDragRotate:!1,doubleClickZoom:!1,keyboard:!1,mouseWheelZoom:!1,shiftDragZoom:!1,dragPan:!1,pinchRotate:!1,pinchZoom:!1}),this.ol=new Sn.Z({interactions:Mn.ce(t),controls:e}),this.setView(this.options.view||{}),this.viewController=new Kc({stateHistory:!0}),this.viewController.setOlMap(this.ol),this.overlay=new Vc(this),this.queryResultsOverlay=new Vc(this),this.searchResultsOverlay=new Vc(this),this.buffer=new Vc(this)}setTarget(e){this.ol.setTarget(e),void 0!==e?this.layerWatcher.subscribe(()=>{},null):this.layerWatcher.unsubscribe()}updateView(e){const t=this.ol.getView(),o=Object.assign({zoom:t.getZoom()},t.getProperties());this.setView(Object.assign(o,e)),e.maxZoomOnExtent&&(this.viewController.maxZoomOnExtent=e.maxZoomOnExtent)}setView(e){void 0!==this.viewController&&this.viewController.clearStateHistory(),e=Object.assign({constrainResolution:!0},e);const t=new Cn.ZP(e);if(this.ol.setView(t),this.unsubscribeGeolocate(),e){if(e.maxLayerZoomExtent&&(this.viewController.maxLayerZoomExtent=e.maxLayerZoomExtent),e.center){const o=t.getProjection().getCode(),i=Fn.mi(e.center,o);t.setCenter(i)}e.geolocate&&this.geolocate(!0),e.alwaysTracking&&(this.alwaysTracking=!0)}}updateControls(e){if(void 0===e)return;const t=[];e.attribution&&t.push(new Zn.Z(!0===e.attribution?{}:e.attribution)),e.scaleLine&&t.push(new Ln.Z(!0===e.scaleLine?{}:e.scaleLine)),Object.assign([],this.ol.getControls().getArray()).forEach(e=>{this.ol.removeControl(e)}),t.forEach(e=>{this.ol.addControl(e)})}getCenter(e){return this.viewController.getCenter(e)}getExtent(e){return this.viewController.getExtent(e)}getZoom(){return this.viewController.getZoom()}changeBaseLayer(e){if(e){for(const e of this.getBaseLayers())e.visible=!1;e.visible=!0,this.viewController.olView.setMinZoom(e.dataSource.options.minZoom||(this.options.view||{}).minZoom),this.viewController.olView.setMaxZoom(e.dataSource.options.maxZoom||(this.options.view||{}).maxZoom)}}getBaseLayers(){return this.layers.filter(e=>!0===e.baseLayer)}getLayerById(e){return this.layers.find(t=>t.id&&t.id===e)}getLayerByAlias(e){return this.layers.find(t=>t.alias&&t.alias===e)}getLayerByOlUId(e){return this.layers.find(t=>t.ol.get("ol_uid")&&t.ol.get("ol_uid")===e)}addLayer(e,t=!0){this.addLayers([e])}addLayers(e,t=!0){let o=0,i=0;const r=e.map(e=>{if(!e)return;const t=e.zIndex?0:e.baseLayer?i++:o++;return this.doAddLayer(e,t)}).filter(e=>void 0!==e);this.setLayers([].concat(this.layers,r))}removeLayer(e){this.removeLayers([e])}removeLayers(e){const t=this.layers$.value.slice(0),o=[];e.forEach(e=>{const i=t.indexOf(e);i>=0&&(o.push(e),t.splice(i,1),this.handleLinkedLayersDeletion(e,o),o.map(e=>{o.push(e);const i=t.indexOf(e);i>=0&&t.splice(i,1)}))}),o.forEach(e=>this.doRemoveLayer(e)),this.setLayers(t)}handleLinkedLayersDeletion(e,t){const o=e.options.linkedLayers;if(!o)return;const i=o.linkId,r=o.links;r?r.map(e=>{!e.syncedDelete||e.linkedIds.map(e=>{const o=this.layers.find(t=>{var o;return(null===(o=t.options.linkedLayers)||void 0===o?void 0:o.linkId)===e});o&&t.push(o)})}):this.layers.map(e=>{var o;(null===(o=e.options.linkedLayers)||void 0===o?void 0:o.links)&&e.options.linkedLayers.links.map(o=>{o.syncedDelete&&!1!==o.bidirectionnal&&-1!==o.linkedIds.indexOf(i)&&(t.push(e),this.handleLinkedLayersDeletion(e,t))})})}removeAllLayers(){this.layers.forEach(e=>this.doRemoveLayer(e)),this.layers$.next([])}raiseLayer(e){const t=this.getLayerIndex(e);t>1&&this.moveLayer(e,t,t-1)}raiseLayers(e){for(const t of e)this.raiseLayer(t)}lowerLayer(e){const t=this.getLayerIndex(e);t<this.layers.length-1&&this.moveLayer(e,t,t+1)}lowerLayers(e){const t=e.reverse();for(const o of t)this.lowerLayer(o)}moveLayer(e,t,o){const i=this.layers[o],r=e.zIndex;i.baseLayer||e.baseLayer||(e.zIndex=i.zIndex,i.zIndex=r,this.layers[o]=e,this.layers[t]=i,this.layers$.next(this.layers.slice(0)))}doAddLayer(e,t){e.baseLayer&&e.visible&&this.changeBaseLayer(e);const o=this.getLayerById(e.id);if(void 0===o){if(!e.baseLayer&&e.zIndex&&(e.zIndex+=10),void 0===e.zIndex||0===e.zIndex){const o=Math.max(e.baseLayer?0:10,...this.layers.filter(t=>t.baseLayer===e.baseLayer&&t.zIndex<200).map(e=>e.zIndex));e.zIndex=o+1+t}return e.baseLayer&&e.zIndex>9&&(e.zIndex=10),e.setMap(this),this.layerWatcher.watchLayer(e),this.ol.addLayer(e.ol),e}o.visible=!0}doRemoveLayer(e){this.layerWatcher.unwatchLayer(e),this.ol.removeLayer(e.ol),e.setMap(void 0)}setLayers(e){this.layers$.next(this.sortLayersByZIndex(e).slice(0))}sortLayersByZIndex(e){return e.sort((e,t)=>t.zIndex-e.zIndex)}getLayerIndex(e){return this.layers.findIndex(t=>t===e)}geolocate(e=!1){let t=!0;this.geolocation$$&&(e=this.geolocation.getTracking(),this.unsubscribeGeolocate()),this.startGeolocation(),this.geolocation$$=this.geolocation$.subscribe(o=>{if(o){if(o.getAccuracy()<1e4){const e=o.getAccuracyGeometry(),i=e.getExtent();if(this.geolocationFeature&&this.overlay.dataSource.ol.getFeatureById(this.geolocationFeature.getId())&&this.overlay.dataSource.ol.removeFeature(this.geolocationFeature),this.bufferFeature&&this.buffer.dataSource.ol.removeFeature(this.bufferFeature),this.geolocationFeature=new Tn.Z({geometry:e}),this.geolocationFeature.setId("geolocationFeature"),this.alwaysTracking?this.overlay.addOlFeature(this.geolocationFeature,this.positionFollower?Cl.Move:Cl.None):this.overlay.addOlFeature(this.geolocationFeature),this.ol.getView().get("options_").buffer){const e=this.ol.getView().get("options_").buffer.bufferRadius,t=o.getPosition();this.bufferGeom=new Pn.Z(t,e);const i=this.ol.getView().get("options_").buffer.bufferStroke,r=this.ol.getView().get("options_").buffer.bufferFill;let s;s=this.ol.getView().get("options_").buffer.showBufferRadius?e.toString()+"m":"",this.bufferFeature=new Tn.Z(this.bufferGeom),this.bufferFeature.setId("bufferFeature"),this.bufferFeature.set("bufferStroke",i),this.bufferFeature.set("bufferFill",r),this.bufferFeature.set("bufferText",s),this.buffer.addOlFeature(this.bufferFeature,Cl.None)}t&&(this.viewController.zoomToExtent(i),this.positionFollower=!this.positionFollower)}else if(t){const e=this.ol.getView(),t=o.getPosition();e.setCenter(t),e.setZoom(14)}!0!==e&&!0!==this.alwaysTracking&&this.unsubscribeGeolocate(),t=!1}})}unsubscribeGeolocate(){this.stopGeolocation(),this.geolocation$$&&(this.geolocation$$.unsubscribe(),this.geolocation$$=void 0)}startGeolocation(){this.geolocation?this.geolocation.setTracking(!0):(this.geolocation=new An.Z({trackingOptions:{enableHighAccuracy:!0},projection:this.projection,tracking:!0}),this.geolocation.on("change",e=>{this.geolocation$.next(this.geolocation)}))}stopGeolocation(){this.geolocation&&this.geolocation.setTracking(!1)}onOfflineToggle(e){this.offlineButtonToggle$.next(e)}}const tu=["*"];let ou=(()=>{class e{constructor(e){this.activityService=e,this.id=`igo-map-target-${(new Date).getTime()}`}get view(){return this._view}set view(e){this._view=e,void 0!==this.map&&this.map.updateView(e)}get controls(){return this._controls}set controls(e){this._controls=e,void 0!==this.map&&this.map.updateControls(e)}ngOnInit(){this.status$$=this.map.status$.subscribe(e=>this.handleStatusChange(e))}ngAfterViewInit(){this.map.setTarget(this.id)}ngOnDestroy(){this.map.setTarget(void 0),this.activityService.unregister(this.activityId),this.status$$.unsubscribe()}handleStatusChange(e){e===E.Working&&void 0===this.activityId?this.activityId=this.activityService.register():e===E.Done&&void 0!==this.activityId&&(this.activityService.unregister(this.activityId),this.activityId=void 0)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(B))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-map-browser"]],inputs:{map:"map",view:"view"},ngContentSelectors:tu,decls:2,vars:1,consts:[[1,"igo-map-browser-target",3,"id"]],template:function(e,t){1&e&&(r.F$t(),r._UZ(0,"div",0),r.Hsn(1)),2&e&&r.Q6J("id",t.id)},styles:["[_nghost-%COMP%]{position:relative;display:block}[_nghost-%COMP%], .igo-map-browser-target[_ngcontent-%COMP%]{width:100%;height:100%}[_nghost-%COMP%]     igo-zoom-button{position:absolute;bottom:5px;right:5px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){[_nghost-%COMP%]     igo-zoom-button{display:none}}[_nghost-%COMP%]     igo-offline-button{position:absolute;bottom:15px;right:5px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){[_nghost-%COMP%]     igo-offline-button{bottom:5px}}[_nghost-%COMP%]     igo-geolocate-button{position:absolute;bottom:5px;right:5px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){[_nghost-%COMP%]     igo-geolocate-button{bottom:5px}}[_nghost-%COMP%]     igo-rotation-button{position:absolute;top:calc(40px + 5px + 5px);right:5px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){[_nghost-%COMP%]     igo-rotation-button{top:calc(40px + 5px + 5px)}}[_nghost-%COMP%]     igo-user-button{position:absolute;bottom:5px;right:calc(5px + 50px)}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){[_nghost-%COMP%]     igo-user-button{right:calc(5px + 90px)}}[_nghost-%COMP%]     igo-baselayers-switcher{position:absolute;bottom:5px;left:5px}[_nghost-%COMP%]     .ol-attribution{flex-flow:row;left:calc(40px + 5px + 5px);bottom:5px;text-align:left;padding:0;margin-right:90px;background-color:#fff0;width:calc(100% - 100px)}[_nghost-%COMP%]     .ol-attribution.ol-logo-only{height:inherit}[_nghost-%COMP%]     .ol-attribution.ol-collapsed{background:none}[_nghost-%COMP%]     .ol-attribution.ol-collapsed button{transform:none}[_nghost-%COMP%]     .ol-attribution button{transform:rotate(180deg);background-color:#fff;cursor:pointer;outline:none}[_nghost-%COMP%]     .ol-scale-line-inner{color:#000;border-color:#000;text-shadow:white -1px -1px 3px,white 1px -1px 3px,white -1px 1px 3px,white 1px 1px 4px;box-shadow:0 1px 0 1px #fff9}[_nghost-%COMP%]     .ol-scale-line{background-color:#fff0;bottom:4px;transform:translate(-50%);left:50%}[_nghost-%COMP%]     .ol-scale-bar{background-color:#fff0;bottom:4px;transform:translate(-50%);left:50%}[_nghost-%COMP%]     .ol-scale-text{text-shadow:white -1px -1px 3px,white 1px -1px 3px,white -1px 1px 3px,white 1px 1px 4px}[_nghost-%COMP%]     .ol-scale-step-text{text-shadow:white -1px -1px 3px,white 1px -1px 3px,white -1px 1px 3px,white 1px 1px 4px}[_nghost-%COMP%]     canvas{display:block}"]}),e})(),iu=(()=>{class e{constructor(e,t){this.component=e,this.mediaService=t,this.pointerPositionDelay=1e3,this.pointerPositionCoord=new r.vpe}get map(){return this.component.map}get mapProjection(){return this.component.map.projection}ngOnInit(){this.listenToMapPointerMove(),this.listenToMapClick()}ngOnDestroy(){this.unlistenToMapPointerMove(),this.unlistenToMapClick()}listenToMapPointerMove(){this.pointerMoveListener=this.map.ol.on("pointermove",e=>this.onPointerEvent(e,this.pointerPositionDelay))}listenToMapClick(){this.mapClickListener=this.map.ol.on("singleclick",e=>this.onPointerEvent(e,0))}unlistenToMapPointerMove(){this.pointerMoveListener=void 0}unlistenToMapClick(){this.mapClickListener=void 0}onPointerEvent(e,t){if(e.dragging||this.mediaService.isTouchScreen())return;void 0!==this.lastTimeoutRequest&&clearTimeout(this.lastTimeoutRequest);const o=(0,Fn.vs)(e.coordinate,this.mapProjection,"EPSG:4326");this.lastTimeoutRequest=setTimeout(()=>{this.pointerPositionCoord.emit(o)},t)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ou,2),r.Y36(me))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoPointerPosition",""]],inputs:{pointerPositionDelay:"pointerPositionDelay"},outputs:{pointerPositionCoord:"pointerPositionCoord"}}),e})();class ru extends cc{constructor(e,t,o,i){super(e,t,i),this.messageService=t,this.languageService=o,this.authInterceptor=i,this.watcher=new Tl(this,this.messageService,this.languageService),this.status$=this.watcher.status$,this.status$.subscribe(e=>{0===e&&(this.olLoadingProblem=!0)})}createOlLayer(){const e=Object.assign({},this.options,{source:this.options.source.ol}),t=new Ua.Z(e);return this.authInterceptor&&t.getSource().setImageLoadFunction((e,t)=>{this.customLoader(e,t,this.authInterceptor,this.messageService,this.languageService)}),t}setMap(e){void 0===e?this.watcher.unsubscribe():this.watcher.subscribe(()=>{}),super.setMap(e)}customLoader(e,t,o,i,r){const s=new XMLHttpRequest;if(s.open("GET",t),!o.interceptXhr(s,t))return s.abort(),void(e.getImage().src=t);s.responseType="arraybuffer",s.onload=function(){const t=new Uint8Array(this.response);(new TextDecoder).decode(t).includes("ServiceExceptionReport")&&i.error(r.translate.instant("igo.geo.dataSource.optionsApiUnavailable"),r.translate.instant("igo.geo.dataSource.unavailableTitle"));const o=new Blob([t],{type:"image/png"}),s=window.URL.createObjectURL(o);e.getImage().src=s},s.send()}}class su extends cc{constructor(e,t){super(e,t),this.messageService=t,this.watcher=new ec(this),this.status$=this.watcher.status$}createOlLayer(){const e=Object.assign({},this.options,{source:this.options.source.ol});return new Na.Z(e)}setMap(e){void 0===e?this.watcher.unsubscribe():this.watcher.subscribe(()=>{}),super.setMap(e)}}class nu extends cc{constructor(e,t,o){super(e,t,o),this.messageService=t,this.authInterceptor=o,this.watcher=new ec(this),this.status$=this.watcher.status$}createOlLayer(){const e=Object.assign({},this.options,{source:this.options.source.ol}),t=new Ra.Z(e);return t.getSource().setTileLoadFunction((e,t)=>{const o=this.customLoader(t,e.getFormat(),this.authInterceptor,e.onLoad.bind(e));o&&e.setLoader(o)}),t}customLoader(e,t,o,i,r){return(s,n,a)=>{const l=new XMLHttpRequest;l.open("GET","function"==typeof e?e=e(s,n,a):e),o&&o.interceptXhr(l,e),"arraybuffer"===t.getType()&&(l.responseType="arraybuffer"),l.onload=e=>{if(!l.status||l.status>=200&&l.status<300){const e=t.getType();let o;"json"===e||"text"===e?o=l.responseText:"xml"===e?(o=l.responseXML,o||(o=(new DOMParser).parseFromString(l.responseText,"application/xml"))):"arraybuffer"===e&&(o=l.response),o?i.call(this,t.readFeatures(o,{extent:s,featureProjection:a}),t.readProjection(o)):r.call(this)}else r.call(this)},l.onerror=()=>{r.call(this)},l.send()}}setMap(e){void 0===e?this.watcher.unsubscribe():this.watcher.subscribe(()=>{}),super.setMap(e)}}let au=(()=>{class e{constructor(e,t,o){this.component=e,this.mediaService=t,this.styleService=o,this.pointerHoverFeatureStore=new lt([]),this.hoverFeatureId="hoverFeatureId",this.igoHoverFeatureDelay=1e3,this.igoHoverFeatureEnabled=!1}mouseout(){clearTimeout(this.lastTimeoutRequest),this.clearLayer()}get map(){return this.component.map}get mapProjection(){return this.component.map.projection}ngOnInit(){this.listenToMapPointerMove(),this.subscribeToPointerStore(),this.listenToMapClick(),this.map.status$.pipe((0,ke.q)(1)).subscribe(()=>{this.store=new Ec([],{map:this.map}),this.initStore()}),this.layers$$=this.map.layers$.subscribe(e=>{this.store&&!e.find(e=>"hoverFeatureId"===e.id)&&this.initStore()})}initStore(e){Dc(this.store,new uc({id:"hoverFeatureId",title:"hoverFeature",zIndex:900,source:new tc,showInLayerList:!1,exportable:!1,browsable:!1,style:lu}))}ngOnDestroy(){this.unlistenToMapPointerMove(),this.unsubscribeToPointerStore(),this.unlistenToMapSingleClick(),this.layers$$.unsubscribe()}subscribeToPointerStore(){this.store$$=this.pointerHoverFeatureStore.entities$.subscribe(e=>{this.entitiesToPointerOverlay(e)})}entitiesToPointerOverlay(e){this.addFeatureOverlay(e)}listenToMapPointerMove(){this.pointerMoveListener=this.map.ol.on("pointermove",e=>this.onMapEvent(e))}listenToMapClick(){this.singleClickMapListener=this.map.ol.on("singleclick",e=>this.onMapSingleClickEvent(e))}unsubscribeToPointerStore(){this.store$$.unsubscribe()}unlistenToMapPointerMove(){this.pointerMoveListener=void 0}unlistenToMapSingleClick(){this.singleClickMapListener=void 0}onMapSingleClickEvent(e){this.clearLayer()}onMapEvent(e){if(e.dragging||!this.igoHoverFeatureEnabled||this.mediaService.isTouchScreen())return void this.clearLayer();void 0!==this.lastTimeoutRequest&&clearTimeout(this.lastTimeoutRequest);const t=this.map.ol.getPixelFromCoordinate(e.coordinate);this.lastTimeoutRequest=setTimeout(()=>{this.map.ol.forEachFeatureAtPixel(t,(function(e,t){if(void 0===e.get("hoverSummary")){const o=this.map.getLayerByOlUId(t.ol_uid);this.setLayerStyleFromOptions(o,e),this.pointerHoverFeatureStore.load([{layer:o,feature:e}])}return!0}).bind(this))},this.igoHoverFeatureDelay)}addFeatureOverlay(e){if(e.length>0){e=e[0],this.clearLayer();let t=this.getGeometry(e.feature);e.layer.ol instanceof Ra.Z&&(t=[t],this.getSameFeatureNeighbour(e.feature,e.layer).forEach(e=>{t.push(e.getGeometry())}));const o=new Tn.Z({geometry:t instanceof Array?new qa.Z(t):t,meta:{id:this.hoverFeatureId},hoverSummary:this.getHoverSummary(e.feature.getProperties())});this.store.setLayerOlFeatures([o],Cl.None)}}setLayerStyleFromOptions(e,t){var o,i;(null===(i=null===(o=e.options)||void 0===o?void 0:o.styleByAttribute)||void 0===i?void 0:i.hoverStyle)?this.store.layer.ol.setStyle(this.styleService.createStyleByAttribute(t,e.options.styleByAttribute.hoverStyle)):this.store.layer.ol.setStyle(lu)}getHoverSummary(e){let t="";for(const[o,i]of Object.entries(e))t+=`${o}: ${i}\n`;return t}getGeometry(e){let t;if(e.getOrientedFlatCoordinates){const o=e.getOrientedFlatCoordinates(),i=[];switch(o.forEach((e,t)=>{t%2==0&&i.push([parseFloat(o[t]),parseFloat(o[t+1])])}),e.getType()){case"Point":t=new Qn.Z(i);break;case"Polygon":t=new Gn.ZP([i]);break;case"LineString":t=new zn.Z([i])}}else t=e.getGeometry();return t}getSameFeatureNeighbour(e,t,o=[]){0===o.length&&o.push(new Tn.Z({geometry:this.getGeometry(e),meta:{id:this.hoverFeatureId}}));const i=[];return t.ol.getSource().getFeaturesInExtent(e.getGeometry().getExtent()).forEach(t=>{const r=o.find(e=>e===t);t.getId()===e.getId()&&!r&&(i.push(t),o.push(t))}),o.map(e=>new Tn.Z({geometry:this.getGeometry(e),meta:{id:this.hoverFeatureId}}))}clearLayer(){this.store&&this.store.clearLayer()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ou,2),r.Y36(me),r.Y36(Yc))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoHoverFeature",""]],hostBindings:function(e,t){1&e&&r.NdJ("mouseout",function(){return t.mouseout()})},inputs:{igoHoverFeatureDelay:"igoHoverFeatureDelay",igoHoverFeatureEnabled:"igoHoverFeatureEnabled"}}),e})();function lu(e,t){const o=[new Dn.ZP({text:new En.Z({text:e.get("hoverSummary"),textAlign:"left",textBaseline:"bottom",font:"12px Calibri,sans-serif",fill:new Rn.Z({color:"#000"}),backgroundFill:new Rn.Z({color:"rgba(255, 255, 255, 0.5)"}),backgroundStroke:new Nn.Z({color:"rgba(200, 200, 200, 0.75)",width:2}),stroke:new Nn.Z({color:"#fff",width:3}),overflow:!0,offsetX:10,offsetY:-10,padding:[2.5,2.5,2.5,2.5]})})];switch(e.getGeometry().getType()){case"Point":o.push(new Dn.ZP({image:new Jn.Z({radius:10,stroke:new Nn.Z({color:"blue",width:3})})}));break;default:o.push(new Dn.ZP({stroke:new Nn.Z({color:"white",width:5})})),o.push(new Dn.ZP({stroke:new Nn.Z({color:"blue",width:3})}))}return o}const cu=function(e){return{zoom:e}};let uu=(()=>{class e{constructor(){}get zoom(){return this.map.viewController.getZoom()}get minZoom(){return this.map.viewController.olView.getMinZoom()||1}get maxZoom(){return this.map.viewController.olView.getMaxZoom()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-zoom-button"]],inputs:{map:"map",color:"color"},decls:7,vars:16,consts:[[1,"igo-zoom-button-container"],["mat-icon-button","","matTooltipPosition","left",3,"matTooltip","color","disabled","click"],["svgIcon","plus"],["svgIcon","minus"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"button",1),r.NdJ("click",function(){return t.map.viewController.zoomIn()}),r.ALo(2,"translate"),r._UZ(3,"mat-icon",2),r.qZA(),r.TgZ(4,"button",1),r.NdJ("click",function(){return t.map.viewController.zoomOut()}),r.ALo(5,"translate"),r._UZ(6,"mat-icon",3),r.qZA(),r.qZA()),2&e&&(r.xp6(1),r.Q6J("matTooltip",r.xi3(2,6,"igo.geo.mapButtons.zoomIn",r.VKq(12,cu,t.zoom+1)))("color",t.color)("disabled",t.zoom>=t.maxZoom),r.xp6(3),r.Q6J("matTooltip",r.xi3(5,9,"igo.geo.mapButtons.zoomOut",r.VKq(14,cu,t.zoom-1)))("color",t.color)("disabled",t.zoom<=t.minZoom))},directives:[n.lW,p.gM,a.Hw],pipes:[U.X$],styles:[".igo-zoom-button-container[_ngcontent-%COMP%]{width:40px}.igo-zoom-button-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#fff}.igo-zoom-button-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#efefef}.igo-zoom-button-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child{margin-bottom:2px}button[_ngcontent-%COMP%], [_nghost-%COMP%]     button .mat-button-ripple-round{border-radius:0}"]}),e})(),pu=(()=>{class e{constructor(){}get map(){return this._map}set map(e){this._map=e}get color(){return this._color}set color(e){this._color=e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-geolocate-button"]],inputs:{map:"map",color:"color"},decls:4,vars:4,consts:[[1,"igo-geolocate-button-container"],["mat-icon-button","","matTooltipPosition","left",3,"matTooltip","color","click"],["svgIcon","crosshairs-gps"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"button",1),r.NdJ("click",function(){return t.map.geolocate()}),r.ALo(2,"translate"),r._UZ(3,"mat-icon",2),r.qZA(),r.qZA()),2&e&&(r.xp6(1),r.Q6J("matTooltip",r.lcZ(2,2,"igo.geo.mapButtons.geolocate"))("color",t.color))},directives:[n.lW,p.gM,a.Hw],pipes:[U.X$],styles:[".igo-geolocate-button-container[_ngcontent-%COMP%]{width:40px;background-color:#fff}.igo-geolocate-button-container[_ngcontent-%COMP%]:hover{background-color:#efefef}button[_ngcontent-%COMP%], [_nghost-%COMP%]     button .mat-button-ripple-round{border-radius:0}"]}),e})();function du(e,t){1&e&&(r.TgZ(0,"div",6),r.TgZ(1,"button",7),r.ALo(2,"translate"),r._UZ(3,"mat-icon",8),r.qZA(),r.qZA()),2&e&&(r.xp6(1),r.Q6J("matTooltip",r.lcZ(2,1,"igo.geo.mapButtons.baselayerSwitcher")))}function hu(e,t){if(1&e&&(r._UZ(0,"igo-mini-basemap",9),r.ALo(1,"translate")),2&e){const e=t.$implicit,o=t.index,i=r.oxw(2);r.Q6J("map",i.map)("baseLayer",e)("title",i.baseLayers.length>2&&!i.expand?r.lcZ(1,5,"igo.geo.baselayersSwitcher.title"):e.title)("display",i.expand||0===o&&!i.useStaticIcon)("disabled",!i.expand&&i.baseLayers.length>1)}}const gu=function(e){return{"container-expand":e}};function mu(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",1),r.NdJ("@baseLayerSwitcherState.start",function(){return r.CHM(e),r.oxw().showButton=!1})("@baseLayerSwitcherState.done",function(){return r.CHM(e),r.oxw().showButton=!0})("click",function(){return r.CHM(e),r.oxw().collapseOrExpand()}),r.YNc(1,du,4,3,"div",2),r.YNc(2,hu,2,7,"igo-mini-basemap",3),r.TgZ(3,"div",4),r._UZ(4,"mat-icon",5),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("ngClass",r.VKq(4,gu,e.expand))("@baseLayerSwitcherState",e.expand?"expand":e.useStaticIcon?"collapseIcon":"collapseMap"),r.xp6(1),r.Q6J("ngIf",e.useStaticIcon&&!e.expand&&e.showButton),r.xp6(1),r.Q6J("ngForOf",e.baseLayers)}}let fu=(()=>{class e{constructor(e){this.mediaService=e,this._baseLayers=[],this.expand=!1,this.showButton=!0,this.mediaService.media$.value===he.Mobile&&void 0===this.useStaticIcon&&(this.useStaticIcon=!0)}ngAfterViewInit(){this.layers$$=this.map.layers$.subscribe(e=>{this._baseLayers=e.filter(e=>e.baseLayer)})}ngOnDestroy(){this.layers$$.unsubscribe()}collapseOrExpand(){this.expand=!!(this.baseLayers.length>1||this.useStaticIcon)&&!this.expand}get baseLayers(){const e=this.map.viewController.getResolution(),t=this.map.viewController.getZoom(),o=this._baseLayers.filter(o=>(!o.options.maxResolution||e<=o.options.maxResolution)&&(!o.options.minResolution||e>=o.options.minResolution)&&(!o.options.source.options.maxZoom||t<=o.options.source.options.maxZoom)&&(!o.options.source.options.minZoom||t>=o.options.source.options.minZoom)),i=o.filter(e=>!e.visible);return i.length+1===o.length?i:o}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(me))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-baselayers-switcher"]],inputs:{map:"map",useStaticIcon:"useStaticIcon"},decls:1,vars:1,consts:[["class","igo-baselayers-switcher-container",3,"ngClass","click",4,"ngIf"],[1,"igo-baselayers-switcher-container",3,"ngClass","click"],["class","igo-baselayers-switcher-button-container",4,"ngIf"],["class","mat-typography",3,"map","baseLayer","title","display","disabled",4,"ngFor","ngForOf"],[1,"more-baselayers"],["color","primary","svgIcon","menu-down",1,"material-icons","mat-icon","mat-list-avatar"],[1,"igo-baselayers-switcher-button-container"],["mat-icon-button","","matTooltipPosition","right","color","primary",3,"matTooltip"],["svgIcon","image-multiple"],[1,"mat-typography",3,"map","baseLayer","title","display","disabled"]],template:function(e,t){1&e&&r.YNc(0,mu,5,6,"div",0),2&e&&r.Q6J("ngIf",t.baseLayers.length>0)},styles:[".igo-baselayers-switcher-container[_ngcontent-%COMP%]{height:auto;position:relative}.container-expand[_ngcontent-%COMP%]{overflow:hidden;border-width:0}.more-baselayers[_ngcontent-%COMP%]{width:80px;height:20px;background-color:#fff;text-align:center;cursor:pointer}.more-baselayers[_ngcontent-%COMP%]:hover{background-color:#efefef}.igo-baselayers-switcher-button-container[_ngcontent-%COMP%]{width:40px;background-color:#fff}.igo-baselayers-switcher-button-container[_ngcontent-%COMP%]:hover{background-color:#efefef}button[_ngcontent-%COMP%], [_nghost-%COMP%]     button .mat-button-ripple-round{border-radius:0}"],data:{animation:[(0,Xe.X$)("baseLayerSwitcherState",[(0,Xe.SB)("collapseIcon",(0,Xe.oB)({height:"40px",width:"40px",overflow:"hidden"})),(0,Xe.SB)("collapseMap",(0,Xe.oB)({height:"85px",overflow:"hidden"})),(0,Xe.SB)("expand",(0,Xe.oB)({overflow:"hidden"})),(0,Xe.eR)("collapse => expand",(0,Xe.jt)("200ms")),(0,Xe.eR)("expand => collapse",(0,Xe.jt)("200ms"))])]}}),e})(),yu=(()=>{class e{constructor(e,t,o,i,r,s){this.http=e,this.styleService=t,this.dataSourceService=o,this.messageService=i,this.languageService=r,this.authInterceptor=s}createLayer(e){if(!e.source)return;let t;switch(e.source.options&&e.source.options._layerOptionsFromSource&&(e=_.mergeDeep(e.source.options._layerOptionsFromSource,e||{})),e.source.constructor){case pc:case fc:case dc:case wc:case yc:case xc:t=this.createTileLayer(e);break;case tc:case hc:case vc:case Sc:case oc:t=this.createVectorLayer(e);break;case bc:case Xl:t=this.createImageLayer(e);break;case Cc:t=this.createVectorTileLayer(e)}return t}createAsyncLayer(e,t){return e.source?new Se.y(t=>t.next(this.createLayer(e))):this.dataSourceService.createAsyncDataSource(e.sourceOptions,t).pipe((0,x.U)(t=>{if(void 0!==t)return this.createLayer(Object.assign(e,{source:t}))}))}createImageLayer(e){return new ru(e,this.messageService,this.languageService,this.authInterceptor)}createTileLayer(e){return new su(e,this.messageService)}createVectorLayer(e){let t,o;if(void 0!==e.style&&(t=this.styleService.createStyle(e.style)),e.source instanceof vc)t=e.source.options.params.style;else if(e.styleByAttribute){const t=this.styleService;e.style=o=>t.createStyleByAttribute(o,e.styleByAttribute),o=new uc(e,this.messageService,this.authInterceptor)}if(e.source instanceof oc){const t=this.styleService,i=e.clusterBaseStyle;e.style=o=>t.createClusterStyle(o,e.clusterParam,i),o=new uc(e,this.messageService,this.authInterceptor)}const i=Object.assign({},e,{style:t});return o||(o=new uc(i,this.messageService,this.authInterceptor)),this.applyMapboxStyle(o,i),o}createVectorTileLayer(e){let t,o;if(void 0!==e.style&&(t=this.styleService.createStyle(e.style)),e.styleByAttribute){const t=this.styleService;e.style=o=>t.createStyleByAttribute(o,e.styleByAttribute),o=new nu(e,this.messageService,this.authInterceptor)}const i=Object.assign({},e,{style:t});return o||(o=new nu(i,this.messageService,this.authInterceptor)),this.applyMapboxStyle(o,i),o}applyMapboxStyle(e,t){t.mapboxStyle&&this.getMapboxGlStyle(t.mapboxStyle.url).subscribe(o=>{(0,Ja.ZP)(e.ol,o,t.mapboxStyle.source)})}getMapboxGlStyle(e){return this.http.get(e).pipe((0,x.U)(e=>e),(0,b.K)(e=>(console.log("No style was found"),(0,A.of)(e))))}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(Yc),r.LFG(kc),r.LFG(le),r.LFG(ne),r.LFG(rn,8))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function vu(e,t){if(1&e&&(r.TgZ(0,"div",5),r._uU(1),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.hij(" ",e.title," ")}}function bu(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",2),r.NdJ("click",function(){r.CHM(e);const t=r.oxw();return t.changeBaseLayer(t.baseLayer)}),r._UZ(1,"igo-map-browser",3),r.YNc(2,vu,2,1,"div",4),r.qZA()}if(2&e){const e=r.oxw();r.xp6(1),r.Q6J("map",e.basemap),r.xp6(1),r.Q6J("ngIf",e.title)}}let xu=(()=>{class e{constructor(e,t){this.layerService=e,this.appRef=t,this.basemap=new eu({controls:{},interactions:!1})}get baseLayer(){return this._baseLayer}set baseLayer(e){this._baseLayer=e,this.handleBaseLayerChanged(e)}ngAfterViewInit(){this.handleMainMapViewChange(this.map.ol.getView()),this.map.viewController.olView.on("change",e=>{this.handleMainMapViewChange(e.target)}),this.map.ol.on("pointerdrag",e=>{this.handleMainMapViewChange(e.target.getView())})}ngOnDestroy(){this.map.viewController.olView.un("change",e=>{this.handleMainMapViewChange(e.target)}),this.map.ol.un("pointerdrag",e=>{this.handleMainMapViewChange(e.target.getView())})}changeBaseLayer(e){this.disabled||(this.map.changeBaseLayer(e),this.appRef.tick())}handleMainMapViewChange(e){const t=e.getProperties();this.basemap.viewController.olView.setResolution(t.resolution),this.basemap.viewController.olView.setRotation(t.rotation),this.basemap.viewController.olView.setCenter(this.map.viewController.getCenter())}handleBaseLayerChanged(e){this.basemap.removeAllLayers();const t=Object.assign(Object.create(e.options),e.options,{visible:!0,baseLayer:!1}),o=this.layerService.createLayer(t);this.basemap.addLayer(o),this.handleLinkedBaseLayer(o)}handleLinkedBaseLayer(e){const t=e.options.linkedLayers;if(!t)return;const o=t.links;o&&t.linkId===e.options.linkedLayers.linkId&&o.map(e=>{e.linkedIds.map(e=>{const t=this.map.layers.find(t=>{var o;return(null===(o=t.options.linkedLayers)||void 0===o?void 0:o.linkId)===e});if(t){const e=Object.assign(Object.create(t.options),t.options,{zIndex:9e3,visible:!0,baseLayer:!1});this.basemap.addLayer(this.layerService.createLayer(e))}})})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(yu),r.Y36(r.z2F))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-mini-basemap"]],inputs:{map:"map",disabled:"disabled",display:"display",title:"title",baseLayer:"baseLayer"},decls:2,vars:1,consts:[[1,"igo-mini-basemap-container"],[3,"click",4,"ngIf"],[3,"click"],[3,"map"],["class","igo-mini-basemap-title",4,"ngIf"],[1,"igo-mini-basemap-title"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.YNc(1,bu,3,2,"div",1),r.qZA()),2&e&&(r.xp6(1),r.Q6J("ngIf",t.display))},styles:[".igo-mini-basemap-container[_ngcontent-%COMP%]{width:calc(40px * 2);height:calc(40px * 2);background-color:#ffffff03;border:2px solid white;box-shadow:0 1px 4px #0000004d;cursor:pointer;margin-top:5px}.igo-mini-basemap-container[_ngcontent-%COMP%]:hover   .igo-mini-basemap-title[_ngcontent-%COMP%]{color:#000;text-shadow:0 0 5px white}.igo-mini-basemap-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%;height:100%}.igo-mini-basemap-title[_ngcontent-%COMP%]{position:relative;top:-76px;height:76px;width:76px;text-align:center;vertical-align:bottom;color:#fff;text-shadow:0 0 5px black;white-space:normal;display:flex;align-items:flex-end;justify-content:center}"]}),e})();function wu(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",1),r.ALo(1,"translate"),r.ALo(2,"translate"),r.TgZ(3,"button",2),r.NdJ("click",function(){return r.CHM(e),r.oxw().map.viewController.resetRotation()}),r._UZ(4,"mat-icon",3),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("matTooltip",e.rotated?r.lcZ(1,4,"igo.geo.mapButtons.resetRotation"):r.lcZ(2,6,"igo.geo.mapButtons.tipRotation")),r.xp6(3),r.Q6J("color",e.color)("disabled",!e.rotated),r.xp6(1),r.Q6J("ngStyle",e.rotationStyle(e.map.viewController.getRotation()))}}function Su(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",1),r.ALo(1,"translate"),r.ALo(2,"translate"),r.TgZ(3,"button",2),r.NdJ("click",function(){return r.CHM(e),r.oxw().map.viewController.resetRotation()}),r._UZ(4,"mat-icon",3),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("matTooltip",e.rotated?r.lcZ(1,4,"igo.geo.mapButtons.resetRotation"):r.lcZ(2,6,"igo.geo.mapButtons.tipRotation")),r.xp6(3),r.Q6J("color",e.color)("disabled",!e.rotated),r.xp6(1),r.Q6J("ngStyle",e.rotationStyle(e.map.viewController.getRotation()))}}let Cu=(()=>{class e{constructor(){}get map(){return this._map}set map(e){this._map=e}get showIfNoRotation(){return this._showIfNoRotation}set showIfNoRotation(e){this._showIfNoRotation=e}get color(){return this._color}set color(e){this._color=e}get rotated(){return 0!==this.map.viewController.getRotation()}rotationStyle(e){return{transform:"rotate("+e+"rad)"}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-rotation-button"]],inputs:{map:"map",showIfNoRotation:"showIfNoRotation",color:"color"},decls:2,vars:2,consts:[["class","igo-rotation-button-container","matTooltipPosition","left",3,"matTooltip",4,"ngIf"],["matTooltipPosition","left",1,"igo-rotation-button-container",3,"matTooltip"],["mat-icon-button","","matTooltipPosition","left",3,"color","disabled","click"],["svgIcon","navigation",3,"ngStyle"]],template:function(e,t){1&e&&(r.YNc(0,wu,5,8,"div",0),r.YNc(1,Su,5,8,"div",0)),2&e&&(r.Q6J("ngIf",t.rotated&&!t.showIfNoRotation),r.xp6(1),r.Q6J("ngIf",t.showIfNoRotation))},directives:[h.O5,p.gM,n.lW,a.Hw,h.PC],pipes:[U.X$],styles:[".igo-rotation-button-container[_ngcontent-%COMP%]{width:40px;background-color:#fff}.igo-rotation-button-container[_ngcontent-%COMP%]:hover{background-color:#efefef}button[_ngcontent-%COMP%], [_nghost-%COMP%]     button .mat-button-ripple-round{border-radius:0}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){button[_ngcontent-%COMP%]:disabled, [_nghost-%COMP%]     button .mat-button-ripple-round:disabled{display:none}}"]}),e})();var Tu=(()=>{return(e=Tu||(Tu={})).Layer="layer",e.Group="group",Tu;var e})(),Au=(()=>{return(e=Au||(Au={}))[e.wms=0]="wms",e[e.wmts=1]="wmts",e[e.baselayers=2]="baselayers",e[e.arcgisrest=3]="arcgisrest",e[e.tilearcgisrest=4]="tilearcgisrest",e[e.imagearcgisrest=5]="imagearcgisrest",e[e.composite=6]="composite",Au;var e})();class Zu{constructor(e,t){Object.assign(this,e),this.catalogService=t}}class Lu extends Zu{constructor(e,t){super(e,t),this.type=Au[Au[Au.wms]]}collectCatalogItems(){return this.catalogService.loadCatalogWMSLayerItems(this)}}class Fu extends Zu{constructor(e,t){super(e,t),this.type=Au[Au[Au.wmts]]}collectCatalogItems(){return this.catalogService.loadCatalogWMTSLayerItems(this)}}class Ou extends Zu{constructor(e,t){super(e,t),this.type=Au[Au[Au.baselayers]]}collectCatalogItems(){return this.catalogService.loadCatalogBaseLayerItems(this)}}class Mu extends Zu{constructor(e,t){super(e,t),this.type=Au[Au[Au.arcgisrest]]}collectCatalogItems(){return this.catalogService.loadCatalogArcGISRestItems(this)}}class Iu extends Zu{constructor(e,t,o){super(e,t),this.type=Au[Au[o]]}collectCatalogItems(){return this.catalogService.loadCatalogArcGISRestItems(this)}}class ku extends Zu{constructor(e,t){super(e,t),this.type=Au[Au[Au.composite]],this.url=null}collectCatalogItems(){return this.catalogService.loadCatalogCompositeLayerItems(this)}}class Pu{static createInstanceCatalog(e,t){let o;return o=e.hasOwnProperty("composite")?new ku(e,t):e.type===Au[Au.baselayers]?new Ou(e,t):e.type===Au[Au.arcgisrest]?new Mu(e,t):e.type===Au[Au.tilearcgisrest]?new Iu(e,t,Au.tilearcgisrest):e.type===Au[Au.imagearcgisrest]?new Iu(e,t,Au.imagearcgisrest):e.type===Au[Au.wmts]?new Fu(e,t):new Lu(e,t),o}}let _u=(()=>{class e{constructor(e){this.http=e,this.queryEnabled=!0}query(e,t){return e.filter(e=>e.visible&&e.isInResolutionsRange).map(e=>this.queryLayer(e,t))}queryLayer(e,t){const o=this.getQueryUrl(e.dataSource,t,!1,e.map.viewController.getExtent());if(!o)return(0,A.of)([]);if(e.dataSource.options.queryFormat===Nl.HTMLGML2){const i=this.getQueryUrl(e.dataSource,t,!0);return this.http.get(i,{responseType:"text"}).pipe((0,Fe.zg)(i=>{const r=this.mergeGML(i,o);return this.http.get(o,{responseType:"text"}).pipe((0,x.U)(i=>this.extractData(i,e,t,o,r)))}))}return this.http.get(o,{responseType:"text"}).pipe((0,x.U)(i=>this.extractData(i,e,t,o)))}mergeGML(e,t){let o=(new fa.Z).readFeatures(e);0===o.length&&(o=(new da.Z).readFeatures(e));const i=new Da.Z([]);let r;const s=[];let n,a=new Ea.Z([]);const l=o.length,c=this.getQueryParams(t.toLowerCase()).bbox.split(","),u=$n.lJ();let p;switch($n.l7(u,c),o.map(e=>{const t=e.getGeometry().getCoordinates(),o=e.getGeometry().getType();switch(!n&&(n=o),o){case"Point":1===l?r=new Qn.Z(t,"XY"):s.push(t);break;case"LineString":i.appendLineString(new zn.Z(t,"XY"));break;case"Polygon":a.appendPolygon(new Gn.ZP(t,"XY"));break;case"MultiPolygon":a=new Ea.Z(t,"XY");break;default:return}}),p=0===s.length&&r?{type:r.getType(),coordinates:r.getCoordinates()}:{type:"Polygon",coordinates:[this.convexHull(s)]},n){case"LineString":return{type:i.getType(),coordinates:i.getCoordinates()};case"Point":return p;case"Polygon":case"MultiPolygon":return{type:a.getType(),coordinates:a.getCoordinates()};default:return}}cross(e,t,o){return(e[0]-o[0])*(t[1]-o[1])-(e[1]-o[1])*(t[0]-o[0])}convexHull(e){e.sort((e,t)=>e[0]===t[0]?e[1]-t[1]:e[0]-t[0]);const t=[];for(const i of e){for(;t.length>=2&&this.cross(t[t.length-2],t[t.length-1],i)<=0;)t.pop();t.push(i)}const o=[];for(let i=e.length-1;i>=0;i--){for(;o.length>=2&&this.cross(o[o.length-2],o[o.length-1],e[i])<=0;)o.pop();o.push(e[i])}return o.pop(),t.pop(),t.concat(o)}extractData(e,t,o,i,r){const s=t.dataSource,n=this.getAllowedFieldsAndAlias(t);let a=[];switch(s.options.queryFormat){case Nl.GML3:a=this.extractGML3Data(e,t.zIndex,n);break;case Nl.JSON:case Nl.GEOJSON:case Nl.GEOJSON2:a=this.extractGeoJSONData(e,t.zIndex,n);break;case Nl.ESRIJSON:a=this.extractEsriJSONData(e,t.zIndex,n);break;case Nl.TEXT:a=this.extractTextData(e);break;case Nl.HTML:a=this.extractHtmlData(e,s.queryHtmlTarget,i);break;case Nl.HTMLGML2:a=this.extractHtmlData(e,s.queryHtmlTarget,i,r);break;case Nl.GML2:default:a=this.extractGML2Data(e,t,n)}if(a.length>0&&null==a[0].geometry){const e=this.createGeometryFromUrlClick(i);for(const t of a)t.geometry=e}return a.map((e,i)=>{const r=e.properties[s.mapLabel];let n;if("wms"===t.options.sourceOptions.type){const e=t.options.sourceOptions;n=e?e.excludeAttribute:void 0}let l=this.getQueryTitle(e,t);!l&&a.length>1?l=`${t.title} (${i+1})`:l||(l=t.title);const c=Object.assign({},e.meta||{},{id:D(),title:l,mapTitle:r,sourceTitle:t.title,order:1e3-t.zIndex,excludeAttribute:n});return Object.assign(e,{meta:c,projection:"carto"===s.options.type?"EPSG:4326":o.projection})})}createGeometryFromUrlClick(e){const t=this.getQueryParams(e.toLowerCase()),o=t.bbox,i=parseInt(t.width,10),r=parseInt(t.height,10),s=parseInt(t.i||t.x,10),n=parseInt(t.j||t.y,10),a=o.split(",");let l=.05*(Math.abs(parseFloat(a[0]))-Math.abs(parseFloat(a[2])));Math.abs(parseFloat(a[0]))<180&&(l=.045);const c=parseFloat(a[0])+Math.abs(parseFloat(a[0])-parseFloat(a[2]))*s/i-l,u=parseFloat(a[1])+Math.abs(parseFloat(a[1])-parseFloat(a[3]))*n/r-l,p=c+2*l,d=u+2*l,h="POLYGON(("+c+" "+u+", "+c+" "+d+", "+p+" "+d+", "+p+" "+u+", "+c+" "+u+"))",g=(new ra.Z).readFeature(h).getGeometry();return{type:g.getType(),coordinates:g.getCoordinates()}}extractGML2Data(e,t,o){let i=(new fa.Z).readFeatures(e);if(0===i.length){const t=new da.Z;try{i=t.readFeatures(e)}catch(r){console.warn("query.service: Multipolygons are badly managed in mapserver in GML2. Use another format.")}}return i.map(e=>this.featureToResult(e,t,o))}extractGML3Data(e,t,o){const i=new ya.Z;let r=[];try{r=i.readFeatures(e)}catch(s){console.warn("query.service: GML3 is not well supported")}return r.map(e=>this.featureToResult(e,t,o))}extractGeoJSONData(e,t,o){let i=[];try{i=JSON.parse(e.replace(/(\r|\n)/g," ")).features}catch(r){console.warn("query.service: Unable to parse geojson","\n",e)}return i.map(e=>e.meta={id:D(),order:1e3-t,alias:o}),i}extractEsriJSONData(e,t,o){if(e)try{if(JSON.parse(e).error)return[]}catch(i){}return(new ca.Z).readFeatures(e).map(e=>this.featureToResult(e,t,o))}extractTextData(e){return[]}extractHtmlData(e,t,o,i){const r=this.getQueryParams(o.toLowerCase()),s=r.crs||r.srs||"EPSG:3857",n=this.createGeometryFromUrlClick(o);t!==Bl.BLANK&&t!==Bl.IFRAME&&(t=Bl.IFRAME);const a=e.toLowerCase().indexOf("<body>"),l=e.toLowerCase().lastIndexOf("</body>")+7;return""===Ba(e.slice(a,l).replace(/(\r|\n|\s)/g,""))||""===e?[]:[{type:Sl,projection:s,properties:{target:t,body:e,url:o},geometry:i||n}]}getQueryParams(e){const t=e.split("?");if(!t[1])return;const o=t[1].split("&"),i={};return o.forEach(e=>{e=e.split("="),i[e[0]]=decodeURIComponent(e[1]||"")}),i}featureToResult(e,t,o){const i=e.getGeometry(),r=Object.assign({},e.getProperties());let s;return delete r.geometry,delete r.GEOMETRIE,delete r.boundedBy,delete r.shape,delete r.SHAPE,delete r.the_geom,delete r.geom,i&&(s={type:i.getType(),coordinates:i.getCoordinates()}),{type:Sl,projection:void 0,properties:r,geometry:s,meta:{id:D(),order:1e3-t,alias:o}}}getQueryUrl(e,t,o=!1,i){let r;switch(e.constructor){case Xl:const s=e,n={INFO_FORMAT:s.params.INFO_FORMAT||this.getMimeInfoFormat(e.options.queryFormat),QUERY_LAYERS:s.params.LAYERS,FEATURE_COUNT:s.params.FEATURE_COUNT||"5"};o&&(n.INFO_FORMAT=this.getMimeInfoFormat(Nl.GML2)),r=s.ol.getFeatureInfoUrl(t.coordinates,t.resolution,t.projection,n);break;case yc:const a=e;r=`${"https://"+a.options.account+".carto.com/api/v2/sql?"}format=GeoJSON${"&q="+a.options.config.layers[0].options.sql} WHERE ST_Intersects(the_geom_webmercator,ST_BUFFER(ST_SetSRID(ST_POINT(${t.coordinates[0]+","+t.coordinates[1]+"),3857),"+(a.options.queryPrecision?a.options.queryPrecision:"1000")+"))"}`;break;case bc:case xc:const l=e,c=Math.abs(i[0]-i[2]),u=Math.abs(i[1]-i[3]),p=.005*(c>u?c:u),d=l.options.queryPrecision?l.options.queryPrecision:p,h=$n.f3($n.hI([t.coordinates]),d);r=`${l.options.url+"/"+l.options.layer+"/query/"}?${["f=json",`geometry=${encodeURIComponent('{"xmin":'+h[0]+',"ymin":'+h[1]+',"xmax":'+h[2]+',"ymax":'+h[3]+',"spatialReference":{"wkid":102100}}')}`,"geometryType=esriGeometryEnvelope","inSR=102100","spatialRel=esriSpatialRelIntersects","outFields=*","returnGeometry=true","outSR=102100"].join("&")}`}return r}getMimeInfoFormat(e){let t="application/vnd.ogc.gml";const o=Object.keys(Nl).find(t=>Nl[t]===e);return o&&(t=Jl[o]),t}getAllowedFieldsAndAlias(e){var t,o,i;let r;return(null===(i=null===(o=null===(t=e.options)||void 0===t?void 0:t.source)||void 0===o?void 0:o.options)||void 0===i?void 0:i.sourceFields)&&e.options.source.options.sourceFields.length>=1&&(r={},e.options.source.options.sourceFields.forEach(e=>{r[e.name]=e.alias?e.alias:e.name})),r}getQueryTitle(e,t){var o,i;let r;if(null===(i=null===(o=t.options)||void 0===o?void 0:o.source)||void 0===i?void 0:i.options){const o=t.options.source.options;o.queryTitle&&(r=this.getLabelMatch(e,o.queryTitle))}return r}getLabelMatch(e,t){let o=t;const i=Array.from(t.matchAll(/\$\{([^\{\}]+)\}/g));return i.forEach(t=>{o=o.replace(t[0],e.properties[t[1]])}),0===i.length&&o===t&&(o=e.properties[t]||t),o}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function $u(e){return!0===e.dataSource.options.queryable}function qu(e){const t=e.get("_layer");return void 0!==t&&$u(t)}let Du=(()=>{class e{constructor(e,t){this.component=e,this.queryService=t,this.queries$$=[],this.queryFeatures=!1,this.queryFeaturesHitTolerance=0,this.waitForAllQueries=!0,this.query=new r.vpe}get map(){return this.component.map}ngAfterViewInit(){this.listenToMapClick(),this.addDragBoxInteraction()}ngOnDestroy(){this.cancelOngoingQueries(),this.unlistenToMapClick(),this.removeDragBoxInteraction()}listenToMapClick(){this.mapClickListener=this.map.ol.on("singleclick",e=>this.onMapEvent(e))}unlistenToMapClick(){this.mapClickListener=void 0}onMapEvent(e){if(this.cancelOngoingQueries(),!this.queryService.queryEnabled)return;const t=[];this.queryFeatures&&t.push(this.doQueryFeatures(e));const o=this.map.ol.getView().getResolution(),i=this.map.layers.filter($u);t.push(...this.queryService.query(i,{coordinates:e.coordinate,projection:this.map.projection,resolution:o})),0!==t.length&&(this.waitForAllQueries?this.queries$$.push((0,mn.$R)(...t).subscribe(t=>{const o=[].concat(...t);this.query.emit({features:o,event:e})})):this.queries$$=t.map(t=>t.subscribe(t=>{this.query.emit({features:t,event:e})})))}doQueryFeatures(e){const t=[];if("singleclick"===e.type)this.map.ol.forEachFeatureAtPixel(e.pixel,(e,o)=>{const i=this.map.getLayerById(o.values_._layer.id);if(e)if(e.get("features"))for(const r of e.get("features")){const e=_c(r,this.map.projection);e.meta={title:r.values_.nom,id:o.values_._layer.id+"."+r.id_,icon:r.values_._icon,sourceTitle:o.values_.title,alias:this.queryService.getAllowedFieldsAndAlias(i)},t.push(e)}else if(e instanceof ja.Z){const r=function(e,t,o,i="EPSG:4326"){let r,s,n,a;o?(s=o.get("title"),o.get("sourceOptions")&&(n=o.get("sourceOptions").excludeAttribute,a=o.get("sourceOptions").excludeAttributeOffline)):s=e.get("_title");const l=new Yn.Z,c=e.getProperties(),u=e.getType();if("Polygon"===u){const t=e.getEnds();r=new Gn.ZP(e.getFlatCoordinates(),jn.Z.XY,t)}else"Point"===u?r=new Qn.Z(e.getFlatCoordinates(),jn.Z.XY):"LineString"===u&&(r=new zn.Z(e.getFlatCoordinates(),jn.Z.XY));const p=l.writeGeometryObject(r,{dataProjection:i,featureProjection:t}),d=e.getId()?e.getId():D(),h=e.get("_mapTitle"),g=Fn.$A(e.getExtent(),t,i);return{type:Sl,projection:i,extent:g,meta:{id:d,title:s||h||d,mapTitle:h,excludeAttribute:n,excludeAttributeOffline:a},properties:c,geometry:p,ol:e}}(e,this.map.projection,o);r.meta={id:o.values_._layer.id+"."+r.meta.id,sourceTitle:o.values_.title,alias:this.queryService.getAllowedFieldsAndAlias(i),title:this.queryService.getQueryTitle(r,i)||r.meta.title},t.push(r)}else{const r=_c(e,this.map.projection,o);r.meta={id:o.values_._layer.id+"."+r.meta.id,sourceTitle:o.values_.title,alias:this.queryService.getAllowedFieldsAndAlias(i),title:this.queryService.getQueryTitle(r,i)||r.meta.title},t.push(r)}},{hitTolerance:this.queryFeaturesHitTolerance||0,layerFilter:this.queryFeaturesCondition?this.queryFeaturesCondition:qu});else if("boxend"===e.type){const o=e.target.getGeometry().getExtent();this.map.layers.filter($u).filter(e=>e instanceof uc&&e.visible).map(e=>{e.dataSource.ol.forEachFeatureIntersectingExtent(o,o=>{const i=_c(o,this.map.projection,e.ol);i.meta={id:e.id+"."+o.getId(),icon:o.values_._icon,sourceTitle:e.title,alias:this.queryService.getAllowedFieldsAndAlias(e),title:this.queryService.getQueryTitle(i,e)||i.meta.title},t.push(i)})})}return(0,A.of)(t)}cancelOngoingQueries(){this.queries$$.forEach(e=>e.unsubscribe()),this.queries$$=[]}addDragBoxInteraction(){let e;const t=this.map.ol.getInteractions().getArray();for(const o of t)if(o instanceof Bc){e=o;break}void 0===e&&(e=new Bc({condition:ac}),this.map.ol.addInteraction(e),this.olDragSelectInteraction=e),this.olDragSelectInteractionEndKey=e.on("boxend",e=>this.onMapEvent(e))}removeDragBoxInteraction(){void 0!==this.olDragSelectInteractionEndKey&&(0,Vn.B)(this.olDragSelectInteractionEndKey),void 0!==this.olDragSelectInteraction&&this.map.ol.removeInteraction(this.olDragSelectInteraction),this.olDragSelectInteraction=void 0}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ou,2),r.Y36(_u))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoQuery",""]],inputs:{queryFeatures:"queryFeatures",queryFeaturesHitTolerance:"queryFeaturesHitTolerance",queryFeaturesCondition:"queryFeaturesCondition",waitForAllQueries:"waitForAllQueries"},outputs:{query:"query"}}),e})(),Eu=(()=>{class e{constructor(e,t){if(this.storageService=t,this.options=e,this.storageService){const e=this.storageService.get(this.getId()+".options");e&&(this.options=_.mergeDeep(this.options,e))}this.options=_.mergeDeep(this.getDefaultOptions(),this.options),this.settings.forEach(e=>{this.setParamFromSetting(e,!1)})}getId(){throw new Error('You have to implement the method "getId".')}getType(){throw new Error('You have to implement the method "getType".')}getDefaultOptions(){throw new Error('You have to implement the method "getDefaultOptions".')}get title(){return this.options.title}get available(){return!1!==this.options.available}set enabled(e){this.options.enabled=e}get enabled(){return this.available&&!1!==this.options.enabled}get showInPointerSummary(){return this.options.showInPointerSummary||!1}get showInSettings(){const e=this.options.showInSettings;return void 0===e||e}get searchUrl(){return this.options.searchUrl}get params(){return void 0===this.options.params?{}:this.options.params}get settings(){return void 0===this.options.settings?[]:this.options.settings}setParamFromSetting(e,t=!0){switch(e.type){case"radiobutton":e.values.forEach(t=>{t.enabled&&(this.options.params=Object.assign(this.options.params||{},{[e.name]:t.value}))});break;case"checkbox":let t="";e.values.filter(e=>!1!==e.available).forEach(e=>{e.enabled&&(t+=e.value+",")}),t=t.slice(0,-1),this.options.params=Object.assign(this.options.params||{},{[e.name]:t})}t&&this.storageService&&this.storageService.set(this.getId()+".options",{params:this.options.params})}get displayOrder(){return void 0===this.options.order?99:this.options.order}getHashtagsValid(e,t){const o=e.match(/(#[A-Za-z]+)/g);if(!o)return;const i=this.getSettingsValues(t),r=[];return o.forEach(e=>{i.values.forEach(t=>{const o=e.substring(1);if("string"==typeof t.value){const e=t.value.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").split(","),i=e.indexOf(o.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""));-1!==i&&r.push(e[i])}t.hashtags&&-1!==t.hashtags.indexOf(o)&&r.push(t.value)})}),r.filter((e,t)=>r.indexOf(e)===t)}getSettingsValues(e){return this.getDefaultOptions().settings.find(t=>t.name===e)}}return e.id="",e.type="",e})(),Ru=(()=>{class e extends Eu{constructor(e){super(e)}getId(){return e.id}getType(){return e.type}getDefaultOptions(){return{title:"Carte"}}}return e.id="map",e.type=Sl,e.\u0275fac=function(t){return new(t||e)(r.LFG("options"))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})();class Uu{static getGoogleMapsCoordLink(e,t){return"https://www.google.com/maps?q="+t+","+e}static getGoogleStreetViewLink(e,t){return"https://www.google.com/maps?q=&layer=c&cbll="+t+","+e}static getGoogleMapsNameLink(e){return"https://www.google.com/maps?q="+encodeURI(e)}}class Nu{static getOpenStreetMapLink(e,t,o=17){return`https://www.openstreetmap.org/?mlat=${t}&mlon=${e}#map=${o}/${t}/${e}`}static getOpenStreetCamLink(e,t,o=17){return`https://openstreetcam.org/map/@${t},${e},${o}z`}}let Ju=(()=>{class e{constructor(e,t,o,i,r){this.http=e,this.config=t,this.languageService=o,this.messageService=i,this.capabilitiesService=r}loadCatalogs(){const e=this.config.getConfig("context")||{},t=this.config.getConfig("catalog")||{},o=t.url||e.url,i=t.sources||[],r=[];if(o){if(t.baseLayers){const e=this.languageService.translate.instant("igo.geo.catalog.baseLayers");r.push((0,A.of)([{id:"catalog.baselayers",title:e,url:`${o}/baselayers`,type:"baselayers"}]))}const e=this.http.get(`${o}/catalogs`).pipe((0,x.U)(e=>e.map(e=>Object.assign(e,e.options))),(0,b.K)(e=>fn.E));r.push(e)}return i.length>0&&r.push((0,A.of)(i).pipe((0,x.U)(e=>e.map(e=>(e.id||(e.id=D()),e))))),(0,mn.$R)(...r).pipe((0,x.U)(e=>[].concat.apply([],e)))}loadCatalogItems(e){let t;return t=Pu.createInstanceCatalog(e,this),t.collectCatalogItems()}loadCatalogBaseLayerItems(e){return this.getCatalogBaseLayersOptions(e).pipe((0,x.U)(t=>{const o=t.map(t=>({id:Ll(t.sourceOptions),title:t.title,type:Tu.Layer,externalProvider:e.externalProvider,options:t}));return[{id:"catalog.group.baselayers",type:Tu.Group,externalProvider:e.externalProvider,title:e.title,items:o}]}))}getCatalogBaseLayersOptions(e){return this.http.get(e.url)}loadCatalogWMSLayerItems(e){return this.getCatalogCapabilities(e).pipe((0,x.U)(t=>{const o=[];t.Service&&t.Service.Abstract&&t.Service.Abstract.length&&(e.abstract=t.Service.Abstract);const i=[];this.flattenWmsCapabilities(t.Capability.Layer,0,i,e.groupSeparator);const r=Object.assign({},t.Capability.Layer);return r.Layer=i.filter(e=>0!==e.Layer.length),this.includeRecursiveItems(e,r,o),o}))}flattenWmsCapabilities(e,t=0,o,i=" / "){if(!o.includes(e.Title)){const t=Object.assign({},e);t.Layer=[],o.push(t)}for(const r of e.Layer){const s=Object.assign({},r);t>0&&(s.Title=e.Title+i+r.Title),r.Layer?this.flattenWmsCapabilities(s,t+1,o,i):o.find(t=>t.Title===e.Title).Layer.push(r)}}loadCatalogWMTSLayerItems(e){return this.getCatalogCapabilities(e).pipe((0,x.U)(t=>this.getWMTSItems(e,t)))}loadCatalogArcGISRestItems(e){return this.getCatalogCapabilities(e).pipe((0,x.U)(t=>this.getArcGISRESTItems(e,t)))}loadCatalogCompositeLayerItems(e){const t=e.composite,o=[];t.map(t=>{t.sortDirection=e.sortDirection,o.push(Pu.createInstanceCatalog(t,this))});const i=[];o.map(e=>i.push(e.collectCatalogItems()));let r=[];function s(e){return e.reduce((e,t)=>e.concat(t.type===Tu.Group?s(t.items):t),[])}if(Object.keys(t).find(e=>t[e].groupImpose)){const e=(e,t)=>{const i=o[t],r=Object.assign({},i.groupImpose);r.address=i.id,r.type=Tu.Group,r.externalProvider=i.externalProvider,void 0===r.sortDirection&&(r.sortDirection=i.sortDirection),r.items=[];const n=s(e);return n.map(e=>e.address=`${r.address}.${r.id}`),r.items=n,r};r=i.map((o,i)=>o.pipe((0,x.U)(o=>t[i].groupImpose?e(o,i):o)))}else r=i;const n=(0,mn.$R)(...r).pipe((0,x.U)(e=>[].concat(...e))),a=(e,t)=>e.reduce((e,o,i,r)=>{const s=t(o),n=Object.assign({},o);if(o.type===Tu.Layer){const t=[];if(r.filter((e,r)=>{let n=!1;return e.title===s&&e.type===Tu.Layer&&(r!==i&&e.address!==o.address&&(n=!0),t.push(r)),n}).length>0){const e=t.findIndex(e=>e===i)+1;n.title=`${o.title} (${e})`}e.find(e=>e.title===n.title&&e.type===Tu.Layer)||(e[e.length]=n)}else o.type===Tu.Group&&(n.items=a(o.items,e=>e.title),e[e.length]=n);return e},[]);return n.pipe((0,x.U)(e=>((e,t)=>e.reduce((e,t)=>{const o=(e=>e.id)(t),i=e.find(e=>e.id===o);if(i){const o=e.indexOf(i);-1===e[o].address.split("|").indexOf(t.address)&&(e[o].address=`${e[o].address}|${t.address}`),e[o].items.push(...t.items)}else e[e.length]=t;return e},[]))(e)),(0,x.U)(e=>[].concat(...e)),(0,x.U)(e=>a(e,e=>e.title)))}getCatalogCapabilities(e){return this.capabilitiesService.getCapabilities(Au[e.type],e.url,e.version).pipe((0,b.K)(t=>{const o=this.languageService.translate.instant("igo.geo.catalog.unavailableTitle"),i=this.languageService.translate.instant("igo.geo.catalog.unavailable",{value:e.title});throw this.messageService.error(i,o),t}))}prepareCatalogItemLayer(e,t,o,i){const r=this.retrieveLayerInfoFormat(e.Name,o),s=e.DataURL?e.DataURL[0]:void 0,n=i.showLegend&&e.Style?this.capabilitiesService.getStyle(e.Style):void 0,a=Object.assign({},i.queryParams,{LAYERS:e.Name,VERSION:i.version}),l={type:"wms",url:i.url,crossOrigin:i.setCrossOriginAnonymous?"anonymous":void 0,queryFormat:r,queryHtmlTarget:r===Nl.HTML||r===Nl.HTMLGML2?"iframe":void 0,optionsFromCapabilities:!0},c=Object.assign({},l,i.sourceOptions,{params:a});let u,p;if(i.forcedProperties)for(const h of i.forcedProperties)e.Name===h.layerName&&h.title&&(u=h.title);e.Abstract?p=e.Abstract:!e.Abstract&&i.abstract&&(p=i.abstract);const d={id:Ll(c),type:Tu.Layer,title:void 0!==u?u:e.Title,address:t,externalProvider:i.externalProvider||!1,options:{maxResolution:nc(e.MaxScaleDenominator),minResolution:nc(e.MinScaleDenominator),metadata:{url:s?s.OnlineResource:void 0,extern:!!s||void 0,abstract:p,type:l.type},legendOptions:n,tooltip:{type:i.tooltipType},sourceOptions:c}};return _.removeUndefined(d)}prepareCatalogItemGroup(e,t,o,i,r){return{id:o,type:Tu.Group,title:e.Title,address:r.id,externalProvider:r.externalProvider||!1,sortDirection:r.sortDirection,items:e.Layer.reduce((e,s)=>{if(void 0!==s.Layer){const n=this.prepareCatalogItemGroup(s,t,o+`.group.${s.Name||s.Layer[0].Name}`,i,r);e.push(n)}else{if(!1===this.testLayerRegexes(s.Name,t))return e;const n=this.prepareCatalogItemLayer(s,o,i,r);e.push(n)}return e},[])}}includeRecursiveItems(e,t,o,i=0){const r=(e.regFilters||[]).map(e=>new RegExp(e));if(t.Layer)for(const s of t.Layer){if(void 0!==s.Layer){this.includeRecursiveItems(e,s,o,i+1);continue}const n=this.findCatalogInfoFormat(e);if(0!==i){const i=this.prepareCatalogItemGroup(t,r,`catalog.group.${t.Name||s.Name}`,n,e);0!==i.items.length&&o.push(i);break}if(!1!==this.testLayerRegexes(s.Name,r)){const t=this.prepareCatalogItemLayer(s,e.id,n,e);o.push(t)}}}getWMTSItems(e,t){const o=t.Contents.Layer,i=(e.regFilters||[]).map(e=>new RegExp(e));return t.ServiceIdentification&&t.ServiceIdentification.Abstract&&t.ServiceIdentification.Abstract.length&&(e.abstract=t.ServiceIdentification.Abstract),o.map(t=>{let o;if(e.forcedProperties)for(const i of e.forcedProperties)t.Title===i.layerName&&i.title&&(o=i.title);if(!1===this.testLayerRegexes(t.Identifier,i))return;const r=Object.assign({},e.queryParams,{version:"1.0.0"}),s={type:"wmts",url:e.url,crossOrigin:e.setCrossOriginAnonymous?"anonymous":void 0,layer:t.Identifier,matrixSet:e.matrixSet,optionsFromCapabilities:!0,requestEncoding:e.requestEncoding||"KVP",style:"default"},n=Object.assign({},s,e.sourceOptions,{params:r});return _.removeUndefined({id:Ll(n),type:Tu.Layer,title:void 0!==o?o:t.Title,address:e.id,externalProvider:e.externalProvider,options:{sourceOptions:n,metadata:{url:void 0,extern:void 0,abstract:e.abstract,type:s.type}}})}).filter(e=>void 0!==e)}getArcGISRESTItems(e,t){const o=t.layers.filter(e=>!e.type||"Feature Layer"===e.type),i=(e.regFilters||[]).map(e=>new RegExp(e));let r;return t.serviceDescription&&t.serviceDescription.length&&(r=t.serviceDescription.replace(/(<([^>]+)>)/gi,"")),o.map(t=>{let o;if(e.forcedProperties)for(const i of e.forcedProperties)t.name===i.layerName&&i.title&&(o=i.title);if(!1===this.testLayerRegexes(t.id,i))return;const s={type:Au[e.type],url:e.url,crossOrigin:e.setCrossOriginAnonymous?"anonymous":void 0,layer:t.id,queryable:!0,queryFormat:"esrijson",matrixSet:e.matrixSet,optionsFromCapabilities:!0,style:"default"},n=Object.assign({},s,e.sourceOptions);return _.removeUndefined({id:Ll(n),type:Tu.Layer,title:void 0!==o?o:t.name,externalProvider:e.externalProvider,address:e.id,options:{sourceOptions:n,minResolution:nc(t.maxScale),maxResolution:nc(t.minScale),metadata:{url:void 0,extern:void 0,abstract:r,type:s.type},title:void 0!==o?o:t.name}})}).filter(e=>void 0!==e)}testLayerRegexes(e,t){return 0===t.length||void 0!==t.find(t=>t.test(e))}retrieveLayerInfoFormat(e,t){const o=t.find(t=>t.layer===e),i=t.find(e=>"*"===e.layer);let r;return o?r=o.queryFormat:i&&(r=i.queryFormat),r}findCatalogInfoFormat(e){const t=[];return e.queryFormat&&Object.keys(e.queryFormat).forEach(o=>{e.queryFormat[o]instanceof Array?e.queryFormat[o].forEach(e=>{t.find(t=>t.layer===e)||t.push({layer:e,queryFormat:o})}):t.find(t=>t.layer===e.queryFormat[o])||t.push({layer:e.queryFormat[o],queryFormat:o})}),t}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(z),r.LFG(ne),r.LFG(le),r.LFG(Oc))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Bu(e,t){if(1&e){const e=r.EpF();r.ynx(0),r.TgZ(1,"igo-catalog-browser-group",3),r.NdJ("addedChange",function(t){return r.CHM(e),r.oxw(2).onGroupAddedChange(t)})("layerAddedChange",function(t){return r.CHM(e),r.oxw(2).onLayerAddedChange(t)}),r.ALo(2,"async"),r.qZA(),r.BQk()}if(2&e){const e=r.oxw().$implicit,t=r.oxw();r.xp6(1),r.Q6J("catalog",t.catalog)("group",e)("state",t.store.state)("resolution",r.lcZ(2,7,t.resolution$))("catalogAllowLegend",t.catalogAllowLegend)("collapsed",1!==t.store.count)("toggleCollapsed",t.toggleCollapsedGroup)}}function ju(e,t){if(1&e){const e=r.EpF();r.ynx(0),r.TgZ(1,"igo-catalog-browser-layer",4),r.NdJ("addedChange",function(t){return r.CHM(e),r.oxw(2).onLayerAddedChange(t)}),r.ALo(2,"async"),r.qZA(),r.BQk()}if(2&e){const e=r.oxw().$implicit,t=r.oxw();r.xp6(1),r.Q6J("layer",e)("resolution",r.lcZ(2,4,t.resolution$))("catalogAllowLegend",t.catalogAllowLegend)("added",t.store.state.get(e).added)}}function Gu(e,t){if(1&e&&(r.YNc(0,Bu,3,9,"ng-container",2),r.YNc(1,ju,3,6,"ng-container",2)),2&e){const e=t.$implicit,o=r.oxw();r.Q6J("ngIf",o.isGroup(e)),r.xp6(1),r.Q6J("ngIf",o.isLayer(e))}}let Qu=(()=>{class e{constructor(e,t){this.layerService=e,this.cdRef=t,this.catalogAllowLegend=!1,this.toggleCollapsedGroup=!0}get resolution$(){return this.map.viewController.resolution$}ngOnInit(){const e=this.map.layers.map(e=>({id:e.options.source.id,title:e.title,type:Tu.Layer}));this.store.state.updateMany(e,{added:!0},!0),this.catalog&&void 0!==this.catalog.sortDirection&&this.store.view.sort({direction:this.catalog.sortDirection,valueAccessor:e=>e.title}),this.catalogAllowLegend=!!this.catalog&&this.catalog.showLegend||this.catalogAllowLegend,this.watcher=new ct(this.store,this.cdRef)}ngOnDestroy(){this.watcher.destroy()}isGroup(e){return e.type===Tu.Group}isLayer(e){return e.type===Tu.Layer}onLayerAddedChange(e){const t=e.layer;this.store.state.update(t,{added:e.added},!1),e.added?this.addLayerToMap(t):this.removeLayerFromMap(t)}onGroupAddedChange(e){const t=e.group;this.store.state.update(t,{added:e.added},!1),e.added?this.addGroupToMap(t):this.removeGroupFromMap(t)}addLayerToMap(e){this.addLayersToMap([e])}removeLayerFromMap(e){this.removeLayersFromMap([e])}addLayersToMap(e){const t=e.map(e=>(void 0===e.options.sourceOptions.optionsFromApi&&(e.options.sourceOptions.optionsFromApi=!0),this.layerService.createAsyncLayer(e.options)));(0,mn.$R)(...t).subscribe(t=>{this.store.state.updateMany(e,{added:!0}),this.map.addLayers(t)})}removeLayersFromMap(e){e.forEach(e=>{if(this.store.state.update(e,{added:!1}),!0===e.options.baseLayer){const t=this.map.getLayerById(e.options.id);void 0!==t&&this.map.removeLayer(t)}else{const t=this.map.getLayerById(e.id);void 0!==t&&this.map.removeLayer(t)}})}sortCatalogItemsByTitle(e,t){const o=e.sort((e,t)=>{const o=e.title.normalize("NFD").replace(/[\u0300-\u036f]/g,""),i=t.title.normalize("NFD").replace(/[\u0300-\u036f]/g,"");return o<i?-1:o>i?1:0});switch(t){case"asc":return o;case"desc":return o.reverse();default:return e}}addGroupToMap(e){let t=e.items.filter(e=>{const t=this.store.state.get(e).added||!1;return this.isLayer(e)&&!1===t});void 0!==e.sortDirection&&(t=this.sortCatalogItemsByTitle(t,e.sortDirection)),this.addLayersToMap(t.reverse())}removeGroupFromMap(e){const t=e.items.filter(e=>{const t=this.store.state.get(e).added||!1;return this.isLayer(e)&&!0===t});this.removeLayersFromMap(t)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(yu),r.Y36(r.sBO))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-catalog-browser"]],inputs:{catalogAllowLegend:"catalogAllowLegend",catalog:"catalog",store:"store",map:"map",toggleCollapsedGroup:"toggleCollapsedGroup"},decls:3,vars:5,consts:[[3,"navigation","selection"],["ngFor","",3,"ngForOf"],[4,"ngIf"],[3,"catalog","group","state","resolution","catalogAllowLegend","collapsed","toggleCollapsed","addedChange","layerAddedChange"],["igoListItem","",3,"layer","resolution","catalogAllowLegend","added","addedChange"]],template:function(e,t){1&e&&(r.TgZ(0,"igo-list",0),r.YNc(1,Gu,2,2,"ng-template",1),r.ALo(2,"async"),r.qZA()),2&e&&(r.Q6J("navigation",!1)("selection",!1),r.xp6(1),r.Q6J("ngForOf",r.lcZ(2,3,t.store.view.all$())))},encapsulation:2,changeDetection:0}),e})();const zu=["renderedLegend"];function Yu(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-list-item"),r.TgZ(1,"mat-icon",7),r.NdJ("toggle",function(t){r.CHM(e);const o=r.oxw(2).$implicit;return r.oxw(3).toggleLegendItem(t,o)}),r.qZA(),r.TgZ(2,"h4",8),r._uU(3),r.ALo(4,"async"),r.qZA(),r.qZA()}if(2&e){r.oxw();const e=r.MAs(3),t=r.oxw().$implicit,o=r.oxw(3);r.xp6(1),r.Q6J("target",e)("collapsed",t.collapsed),r.xp6(2),r.hij("",r.lcZ(4,3,o.computeItemTitle(t))," ")}}function Hu(e,t){if(1&e&&(r.TgZ(0,"mat-option",11),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.name),r.xp6(1),r.Oqu(e.title)}}function Vu(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div"),r.TgZ(1,"mat-form-field"),r.TgZ(2,"mat-select",9),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw(5).currentStyle=t})("selectionChange",function(){return r.CHM(e),r.oxw(5).onChangeStyle()}),r.ALo(3,"translate"),r.YNc(4,Hu,2,2,"mat-option",10),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(5);r.xp6(2),r.Q6J("matTooltip",r.lcZ(3,3,"igo.geo.layer.legend.selectStyle"))("ngModel",e.currentStyle),r.xp6(2),r.Q6J("ngForOf",e.styles)}}function Wu(e,t){1&e&&(r.TgZ(0,"small"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"igo.geo.layer.legend.noLegendScale")," "))}function Xu(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div"),r.TgZ(1,"img",13,14),r.NdJ("load",function(){r.CHM(e);const t=r.oxw(3).$implicit;return r.oxw(3).onLoadImage(t.title)}),r.ALo(3,"translate"),r.qZA(),r.YNc(4,Wu,3,3,"small",0),r.qZA()}if(2&e){const e=r.oxw(3).$implicit,t=r.oxw(3);r.xp6(1),r.s9C("id",e.title),r.s9C("src",t.legendGraphic,r.LSH),r.s9C("alt",r.lcZ(3,4,"igo.geo.layer.legend.loadingLegendText")),r.xp6(3),r.Q6J("ngIf",t.imagesHeight[e.title]<16)}}function Ku(e,t){if(1&e&&r._UZ(0,"div",15),2&e){const e=r.oxw(3).$implicit;r.Q6J("ngStyle",e.style)("innerHTML",e.html,r.oJD)}}function ep(e,t){if(1&e&&(r.TgZ(0,"div"),r.YNc(1,Xu,5,6,"div",0),r.YNc(2,Ku,1,2,"div",12),r.qZA()),2&e){const e=r.oxw(2).$implicit;r.xp6(1),r.Q6J("ngIf",e.url),r.xp6(1),r.Q6J("ngIf",e.html)}}const tp=function(e){return{"with-title":e}};function op(e,t){if(1&e&&(r.TgZ(0,"div"),r.YNc(1,Yu,5,5,"mat-list-item",0),r.TgZ(2,"div",5,6),r.YNc(4,Vu,5,5,"div",0),r.YNc(5,ep,3,2,"div",0),r.qZA(),r.qZA()),2&e){const e=r.oxw().$implicit,t=r.oxw(3);r.xp6(1),r.Q6J("ngIf",e.title),r.xp6(1),r.Q6J("ngClass",r.VKq(4,tp,e.title)),r.xp6(2),r.Q6J("ngIf",void 0!==t.currentStyle),r.xp6(1),r.Q6J("ngIf",!e.collapsed)}}function ip(e,t){if(1&e&&(r.ynx(0,null,4),r.YNc(2,op,6,6,"div",1),r.BQk()),2&e){r.oxw(2);const e=r.MAs(3),t=r.oxw();r.xp6(2),r.Q6J("ngIf",t.getLegend)("ngIfElse",e)}}function rp(e,t){if(1&e&&(r.ynx(0),r.YNc(1,ip,3,2,"ng-container",3),r.BQk()),2&e){const e=r.oxw().ngIf;r.xp6(1),r.Q6J("ngForOf",e.slice().reverse())}}function sp(e,t){1&e&&(r.TgZ(0,"small"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"igo.geo.layer.legend.noLegendText")," "))}function np(e,t){if(1&e&&(r.ynx(0),r.YNc(1,rp,2,1,"ng-container",1),r.YNc(2,sp,3,3,"ng-template",null,2,r.W1O),r.BQk()),2&e){const e=t.ngIf,o=r.MAs(3);r.xp6(1),r.Q6J("ngIf",e.length)("ngIfElse",o)}}let ap=(()=>{class e{constructor(e,t,o,i){this.capabilitiesService=e,this.languageService=t,this.http=o,this.cdRef=i,this.updateLegendOnResolutionChange=!1,this.legendItems$=new C.X([]),this.scale=void 0,this.view=void 0,this.imagesHeight={},this.getLegend=!0}ngOnInit(){let e=this.layer.legend;this.styles=this.listStyles();const t=this.layer.options.source.options;if(t&&t.params&&t.params.STYLES?this.currentStyle=this.styles.find(e=>e.name===t.params.STYLES).name:this.layer.legend?this.styles&&this.styles.length>1&&(this.currentStyle=e[0].currentStyle):this.styles&&this.styles.length>1&&(this.currentStyle=this.styles[0].name),e=void 0!==this.layer.options.legendOptions&&!1===this.layer.options.legendOptions.display?[]:this.layer.dataSource.getLegend(this.currentStyle,this.view),!0===this.updateLegendOnResolutionChange||t.contentDependentLegend)this.state$$=this.layer.map.viewController.state$.subscribe(()=>this.onViewControllerStateChange());else if(e&&0!==e.length){this.legendItems$.next(e);for(const t of e)this.getLegendGraphic(t)}}ngOnDestroy(){void 0!==this.state$$&&this.state$$.unsubscribe()}getLegendGraphic(e){new xt(this.http).transform(e.url).pipe((0,b.K)(e=>{if(e.error)return e.error.caught=!0,this.getLegend=!1,this.cdRef.detectChanges(),e})).subscribe(e=>{this.legendGraphic=e,this.cdRef.detectChanges()})}toggleLegendItem(e,t){t.collapsed=e}transfertToggleLegendItem(e){const t=e,o=this.layer.legend;for(let i=0;i<o.length;i++)t[i].collapsed=o[i].collapsed;return t}computeItemTitle(e){const t=this.layer.dataSource.options;if("wms"!==t.type)return(0,A.of)(e.title);const o=t.params.LAYERS.split(","),i=JSON.parse(JSON.stringify(t));return i.params.LAYERS=o.find(t=>t===e.title),this.capabilitiesService.getWMSOptions(i).pipe((0,x.U)(e=>e._layerOptionsFromSource.title))}onViewControllerStateChange(){this.view={resolution:this.layer.map.viewController.getResolution(),extent:this.layer.map.viewController.getExtent(),projection:this.layer.map.viewController.getOlProjection().getCode(),scale:this.layer.map.viewController.getScale(),size:this.layer.map.ol.getSize()},this.updateLegend()}updateLegend(){let e=this.layer.dataSource.getLegend(this.currentStyle,this.view);if(this.layer.legend&&this.layer.legend.length>1&&(e=this.transfertToggleLegendItem(e)),this.layer.legend=e,0!==e.length||0!==this.legendItems$.value.length){this.legendItems$.next(e);for(const e of this.legendItems$.value)this.getLegendGraphic(e)}}listStyles(){const e=this.layer.options;if(e&&e.legendOptions){let t=[{name:"",title:this.languageService.translate.instant("igo.geo.layer.legend.default")}];return e.legendOptions.stylesAvailable&&(t=t.concat(e.legendOptions.stylesAvailable.filter(e=>"default"!==e.name.normalize("NFD").replace(/[\u0300-\u036f]/gi,"")&&"defaut"!==e.name.normalize("NFD").replace(/[\u0300-\u036f]/gi,"")))),t.filter(e=>!e.title).map(e=>e.title=e.name),t.map(e=>e.title=e.title.charAt(0).toUpperCase()+e.title.slice(1).replace(/_/g," ")),t}}onChangeStyle(){this.updateLegend();let e="";console.log(this.layer.dataSource.ol),e=e.slice(0,-1)}onLoadImage(e){let t;t=1===this.renderedLegends.length?this.renderedLegends.first.nativeElement:this.renderedLegends.find(t=>t.nativeElement.id===e).nativeElement,this.imagesHeight[e]=t.height}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Oc),r.Y36(ne),r.Y36(y.eN),r.Y36(r.sBO))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-layer-legend"]],viewQuery:function(e,t){if(1&e&&r.Gf(zu,5),2&e){let e;r.iGM(e=r.CRH())&&(t.renderedLegends=e)}},inputs:{updateLegendOnResolutionChange:"updateLegendOnResolutionChange",layer:"layer"},decls:2,vars:3,consts:[[4,"ngIf"],[4,"ngIf","ngIfElse"],["noItems",""],[4,"ngFor","ngForOf"],["renderedLegends",""],[1,"igo-layer-legend",3,"ngClass"],["legend",""],["id","legend-toggle","mat-list-avatar","","igoCollapse","","svgIcon","chevron-up",1,"igo-chevron",3,"target","collapsed","toggle"],["matLine",""],["tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[3,"ngStyle","innerHTML",4,"ngIf"],[3,"id","src","alt","load"],["renderedLegend",""],[3,"ngStyle","innerHTML"]],template:function(e,t){1&e&&(r.YNc(0,np,4,2,"ng-container",0),r.ALo(1,"async")),2&e&&r.Q6J("ngIf",r.lcZ(1,1,t.legendItems$))},directives:[h.O5,h.sg,h.mk,l.Tg,a.Hw,l.eA,Po,$e.X2,Pe.KE,_e.gD,p.gM,ze.JJ,ze.On,$e.ey,h.PC],pipes:[h.Ov,U.X$],styles:['.igo-layer-legend.with-title[_ngcontent-%COMP%]{padding-left:18px}img[_ngcontent-%COMP%]:after{content:" ";position:relative;height:17px;float:left;width:17px;top:-3px;right:19px;background-color:#fff;border:3px solid #f3f3f3;border-radius:50%;-webkit-animation:2s linear infinite spin;animation:2s linear infinite spin}@-moz-document url-prefix(){img:after{margin-left:19px}}@-webkit-keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}'],changeDetection:0}),e})();function lp(e,t){1&e&&r._UZ(0,"mat-icon",9)}function cp(e,t){1&e&&(r.TgZ(0,"mat-icon",12),r.NdJ("click",function(e){return e.stopPropagation()}),r.ALo(1,"translate"),r.qZA()),2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.catalog.externalProvider.layer"))}function up(e,t){if(1&e&&(r.TgZ(0,"button",10),r.YNc(1,cp,2,3,"mat-icon",11),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf",e.layer.externalProvider)}}function pp(e,t){if(1&e&&(r._UZ(0,"igo-layer-legend",3),r.ALo(1,"async")),2&e){const e=r.oxw();r.Q6J("layer",r.lcZ(1,1,e.igoLayer$))}}let dp=(()=>{class e{constructor(e){this.layerService=e,this.inRange$=new C.X(!0),this.isPreview$=new C.X(!1),this.layerLegendShown$=new C.X(!1),this.igoLayer$=new C.X(void 0),this.mouseInsideAdd=!1,this.catalogAllowLegend=!1,this.added=!1,this.addedChange=new r.vpe,this.addedLayerIsPreview=new r.vpe}get title(){return rt(this.layer)}get icon(){return st(this.layer)||"layers"}ngOnInit(){this.isInResolutionsRange(),this.isPreview$$=this.isPreview$.subscribe(e=>this.addedLayerIsPreview.emit(e))}ngOnDestroy(){this.isPreview$$.unsubscribe()}computeTitleTooltip(){const e=this.layer.options;if(!e.tooltip)return rt(this.layer);const t=e.tooltip,o=e.metadata;switch(e.tooltip.type){case Zl.TITLE:return this.layer.title;case Zl.ABSTRACT:return o&&o.abstract?o.abstract:this.layer.title;case Zl.CUSTOM:return t&&t.text?t.text:this.layer.title;default:return this.layer.title}}onMouseEvent(e){this.onToggleClick(e)}askForLegend(e){this.layerLegendShown$.next(!this.layerLegendShown$.value),this.layerService.createAsyncLayer(this.layer.options).pipe((0,vn.P)()).subscribe(e=>this.igoLayer$.next(e))}onToggleClick(e){if(void 0!==this.lastTimeoutRequest&&clearTimeout(this.lastTimeoutRequest),"mouseenter"!==e.type||!this.mouseInsideAdd)switch(e.type){case"click":this.isPreview$.value||(this.added?this.remove():this.add()),this.isPreview$.next(!1);break;case"mouseenter":!this.isPreview$.value&&!this.added&&(this.lastTimeoutRequest=setTimeout(()=>{this.add(),this.isPreview$.next(!0)},500)),this.mouseInsideAdd=!0;break;case"mouseleave":this.isPreview$.value&&(this.remove(),this.isPreview$.next(!1)),this.mouseInsideAdd=!1}}add(){this.added||(this.added=!0,this.addedChange.emit({added:!0,layer:this.layer}))}remove(){this.added&&(this.added=!1,this.addedChange.emit({added:!1,layer:this.layer}))}haveGroup(){return!(!this.layer.address||1===this.layer.address.split(".").length)}isInResolutionsRange(){return this.inRange$.next(this.resolution>=(this.layer.options.minResolution||0)&&this.resolution<=(this.layer.options.maxResolution||1/0)),this.inRange$.value}computeTooltip(){return this.added?this.isPreview$.value?"igo.geo.catalog.layer.addToMap":this.inRange$.value?"igo.geo.catalog.layer.removeFromMap":"igo.geo.catalog.layer.removeFromMapOutRange":this.inRange$.value?"igo.geo.catalog.layer.addToMap":"igo.geo.catalog.layer.addToMapOutRange"}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(yu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-catalog-browser-layer"]],inputs:{resolution:"resolution",catalogAllowLegend:"catalogAllowLegend",layer:"layer",added:"added"},outputs:{addedChange:"addedChange",addedLayerIsPreview:"addedLayerIsPreview"},decls:16,vars:21,consts:[["mat-list-avatar","","svgIcon","blank",4,"ngIf"],["mat-line","","matTooltipShowDelay","500",3,"ngClass","matTooltip","click"],["disabled","true","mat-icon-button","",4,"ngIf"],[3,"layer"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","mouseenter","mouseleave","click"],["matBadge","","igoMatBadgeIcon","eye-off","igoMatBadgeInverseColor","true","matBadgeDisabled","true","matBadgeSize","small","matBadgePosition","after",3,"matBadgeHidden","svgIcon"],[1,"igo-cataloglayer-legend-container"],["legend",""],[3,"layer",4,"ngIf"],["mat-list-avatar","","svgIcon","blank"],["disabled","true","mat-icon-button",""],["class","igo-cataloglayer-external-icon","tooltip-position","below","matTooltipShowDelay","500","color","primary","svgIcon","earth-arrow-right",3,"matTooltip","click",4,"ngIf"],["tooltip-position","below","matTooltipShowDelay","500","color","primary","svgIcon","earth-arrow-right",1,"igo-cataloglayer-external-icon",3,"matTooltip","click"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-list-item"),r.YNc(1,lp,1,0,"mat-icon",0),r.TgZ(2,"h4",1),r.NdJ("click",function(e){return t.askForLegend(e)}),r._uU(3),r.qZA(),r.YNc(4,up,2,1,"button",2),r._UZ(5,"igo-metadata-button",3),r.TgZ(6,"button",4),r.NdJ("mouseenter",function(e){return t.onMouseEvent(e)})("mouseleave",function(e){return t.onMouseEvent(e)})("click",function(e){return t.onToggleClick(e)}),r.ALo(7,"translate"),r.ALo(8,"async"),r._UZ(9,"mat-icon",5),r.ALo(10,"async"),r.qZA(),r.qZA(),r.TgZ(11,"div",6,7),r.YNc(13,pp,2,3,"igo-layer-legend",8),r.ALo(14,"async"),r.ALo(15,"async"),r.qZA()),2&e&&(r.xp6(1),r.Q6J("ngIf",t.haveGroup()),r.xp6(1),r.Q6J("ngClass",t.catalogAllowLegend?"igo-cataloglayer-title":"")("matTooltip",t.computeTitleTooltip()),r.xp6(1),r.Oqu(t.title),r.xp6(1),r.Q6J("ngIf",t.layer.externalProvider),r.xp6(1),r.Q6J("layer",t.layer),r.xp6(1),r.Q6J("matTooltip",r.lcZ(7,11,t.computeTooltip()))("color",r.lcZ(8,13,t.isPreview$)?"":t.added?"warn":""),r.xp6(3),r.Q6J("matBadgeHidden",t.isInResolutionsRange())("svgIcon",r.lcZ(10,15,t.isPreview$)?"plus":t.added?"delete":"plus"),r.xp6(4),r.Q6J("ngIf",r.lcZ(14,17,t.layerLegendShown$)&&r.lcZ(15,19,t.igoLayer$)&&t.catalogAllowLegend))},directives:[l.Tg,h.O5,$e.X2,h.mk,p.gM,bl,n.lW,a.Hw,Be.k,Oo,l.eA,ap],pipes:[U.X$,h.Ov],styles:[".igo-cataloglayer-title[_ngcontent-%COMP%]{cursor:pointer}.igo-cataloglayer-legend-container[_ngcontent-%COMP%]{padding-left:18px;width:calc(100% - 18px);margin-left:40px}.igo-cataloglayer-external-icon[_ngcontent-%COMP%]{cursor:help}"],changeDetection:0}),e})();function hp(e,t){1&e&&(r.TgZ(0,"mat-icon",9),r.NdJ("click",function(e){return e.stopPropagation()}),r.ALo(1,"translate"),r.qZA()),2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.catalog.externalProvider.group"))}function gp(e,t){if(1&e&&(r.TgZ(0,"button",7),r.YNc(1,hp,2,3,"mat-icon",8),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf",e.group.externalProvider)}}function mp(e,t){if(1&e){const e=r.EpF();r.ynx(0),r.TgZ(1,"button",10),r.NdJ("click",function(){return r.CHM(e),r.oxw().onToggleClick()}),r.ALo(2,"translate"),r.ALo(3,"async"),r._UZ(4,"mat-icon",11),r.qZA(),r.BQk()}if(2&e){const e=r.oxw();r.xp6(1),r.Q6J("matTooltip",r.lcZ(2,2,"igo.geo.catalog.group.removeFromMap"))("disabled",r.lcZ(3,4,e.disabled$))}}function fp(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",12),r.NdJ("click",function(){return r.CHM(e),r.oxw().onToggleClick()}),r.ALo(1,"translate"),r.ALo(2,"async"),r._UZ(3,"mat-icon",13),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("matTooltip",r.lcZ(1,2,"igo.geo.catalog.group.addToMap"))("disabled",r.lcZ(2,4,e.disabled$))}}function yp(e,t){1&e&&r.GkF(0)}function vp(e,t){if(1&e){const e=r.EpF();r.ynx(0),r.TgZ(1,"igo-catalog-browser-layer",15),r.NdJ("addedLayerIsPreview",function(t){return r.CHM(e),r.oxw(2).onLayerPreview(t)})("addedChange",function(t){return r.CHM(e),r.oxw(2).onLayerAddedChange(t)}),r.qZA(),r.BQk()}if(2&e){const e=r.oxw().$implicit,t=r.oxw();r.xp6(1),r.Q6J("layer",e)("resolution",t.resolution)("catalogAllowLegend",t.catalogAllowLegend)("added",t.state.get(e).added)}}function bp(e,t){if(1&e&&(r.YNc(0,yp,1,0,"ng-container",14),r.YNc(1,vp,2,4,"ng-container",14)),2&e){const e=t.$implicit,o=r.oxw();r.Q6J("ngIf",o.isGroup(e)),r.xp6(1),r.Q6J("ngIf",o.isLayer(e))}}let xp=(()=>{class e{constructor(){this.store=new lt([]),this.added$=new C.X(!1),this.preview$=new C.X(!1),this.disabled$=new C.X(!1),this.collapsed=!0,this.catalogAllowLegend=!1,this.toggleCollapsed=!0,this.addedChange=new r.vpe,this.layerAddedChange=new r.vpe}get title(){return this.group.title}ngOnInit(){this.store.load(this.group.items),this.evaluateAdded(),this.evaluateDisabled(this.collapsed),void 0!==this.group.sortDirection&&this.store.view.sort({direction:this.group.sortDirection,valueAccessor:e=>e.title})}ngOnDestroy(){this.store.destroy()}isGroup(e){return e.type===Tu.Group}isLayer(e){return e.type===Tu.Layer}onToggleClick(){this.added$.value?this.remove():this.add()}onToggleCollapsed(e){this.evaluateDisabled(e)}onLayerAddedChange(e){this.layerAddedChange.emit(e),this.tryToggleGroup(e)}add(){this.added$.next(!0),this.addedChange.emit({added:!0,group:this.group})}remove(){this.added$.next(!1),this.addedChange.emit({added:!1,group:this.group})}onLayerPreview(e){this.preview$.next(e)}tryToggleGroup(e){const t=e.added,o=e.layer;this.store.view.all().filter(e=>e.id!==o.id).map(e=>this.state.get(e).added||!1).every(e=>e===t)?t?this.add():this.remove():!0===this.added$.value&&this.added$.next(!1)}evaluateAdded(){const e=this.store.all().every(e=>!0===(this.state.get(e).added||!1));this.added$.next(e)}evaluateDisabled(e){let t=!1;!1===this.toggleCollapsed&&(t=e),this.disabled$.next(t)}onTitleClick(){this.collapsed=!this.collapsed}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-catalog-browser-group"]],inputs:{catalog:"catalog",group:"group",collapsed:"collapsed",resolution:"resolution",catalogAllowLegend:"catalogAllowLegend",toggleCollapsed:"toggleCollapsed",state:"state"},outputs:{addedChange:"addedChange",layerAddedChange:"layerAddedChange"},decls:14,vars:14,consts:[["mat-list-avatar","","svgIcon","chevron-up","igoCollapse","",1,"igo-chevron",3,"target","collapsed","toggle"],["id","catalog-group-title","mat-line","","matTooltipShowDelay","500",1,"igo-catalog-group-title",3,"matTooltip","click"],["disabled","true","mat-icon-button","",4,"ngIf"],[4,"ngIf","ngIfElse"],["notadded",""],["items",""],["ngFor","",3,"ngForOf"],["disabled","true","mat-icon-button",""],["class","igo-cataloggroup-external-icon","tooltip-position","below","matTooltipShowDelay","500","color","primary","svgIcon","earth-arrow-right",3,"matTooltip","click",4,"ngIf"],["tooltip-position","below","matTooltipShowDelay","500","color","primary","svgIcon","earth-arrow-right",1,"igo-cataloggroup-external-icon",3,"matTooltip","click"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip","disabled","click"],["svgIcon","delete"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","disabled","click"],["svgIcon","plus"],[4,"ngIf"],["igoListItem","",3,"layer","resolution","catalogAllowLegend","added","addedLayerIsPreview","addedChange"]],template:function(e,t){if(1&e&&(r.TgZ(0,"mat-list-item"),r.TgZ(1,"mat-icon",0),r.NdJ("toggle",function(e){return t.onToggleCollapsed(e)}),r.qZA(),r.TgZ(2,"h4",1),r.NdJ("click",function(){return t.onTitleClick()}),r._uU(3),r.qZA(),r.YNc(4,gp,2,1,"button",2),r.YNc(5,mp,5,6,"ng-container",3),r.ALo(6,"async"),r.ALo(7,"async"),r.YNc(8,fp,4,6,"ng-template",null,4,r.W1O),r.qZA(),r.TgZ(10,"div",null,5),r.YNc(12,bp,2,2,"ng-template",6),r.ALo(13,"async"),r.qZA()),2&e){const e=r.MAs(9),o=r.MAs(11);r.xp6(1),r.Q6J("target",o)("collapsed",t.collapsed),r.xp6(1),r.Q6J("matTooltip",t.title),r.xp6(1),r.Oqu(t.title),r.xp6(1),r.Q6J("ngIf",t.group.externalProvider),r.xp6(1),r.Q6J("ngIf",r.lcZ(6,8,t.added$)&&!r.lcZ(7,10,t.preview$))("ngIfElse",e),r.xp6(7),r.Q6J("ngForOf",r.lcZ(13,12,t.store.view.all$()))}},directives:[l.Tg,a.Hw,l.eA,Po,$e.X2,p.gM,h.O5,h.sg,n.lW,dp,Ii],pipes:[h.Ov,U.X$],styles:[".igo-catalog-group-title[_ngcontent-%COMP%]{cursor:pointer;opacity:.9}#catalog-group-title[_ngcontent-%COMP%]{font-weight:bold}.igo-cataloggroup-external-icon[_ngcontent-%COMP%]{cursor:help}"],changeDetection:0}),e})(),wp=(()=>{class e{constructor(){this.sortAlpha=!1,this.onlyVisible=!1,this.onlyInRange=!1,this.keywordInitialized=!1,this.sortedAlphaInitialized=!1,this.onlyVisibleInitialized=!1,this.onlyInRangeInitialized=!1}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Sp(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-checkbox",9),r.NdJ("change",function(){return r.CHM(e),r.oxw().check()}),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("checked",e.layerCheck)}}const Cp=function(e){return{disabled:e}};function Tp(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",10),r.NdJ("click",function(){return r.CHM(e),r.oxw().toggleVisibility()}),r.ALo(1,"translate"),r.ALo(2,"translate"),r._UZ(3,"mat-icon",11),r.ALo(4,"async"),r.ALo(5,"async"),r.ALo(6,"async"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("color",e.layer.visible?"primary":"default")("matTooltip",e.layer.visible?r.lcZ(1,5,"igo.geo.layer.hideLayer"):r.lcZ(2,7,"igo.geo.layer.showLayer")),r.xp6(3),r.Q6J("matBadgeHidden",r.lcZ(4,9,e.queryBadgeHidden$))("ngClass",r.VKq(15,Cp,!r.lcZ(5,11,e.inResolutionRange$)))("svgIcon",r.lcZ(6,13,e.layer.visible$)?"eye":"eye-off")}}function Ap(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",12),r.NdJ("click",function(){return r.CHM(e),r.oxw().toggleVisibility()}),r.ALo(1,"translate"),r.ALo(2,"translate"),r._UZ(3,"mat-icon",11),r.ALo(4,"async"),r.ALo(5,"async"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("color",e.layer.visible?"primary":"default")("matTooltip",e.layer.visible?r.lcZ(1,5,"igo.geo.layer.hideLayer"):r.lcZ(2,7,"igo.geo.layer.showLayer")),r.xp6(3),r.Q6J("matBadgeHidden",r.lcZ(4,9,e.queryBadgeHidden$))("ngClass",r.VKq(13,Cp,!r.lcZ(5,11,e.inResolutionRange$)))("svgIcon",e.layer.visible?"eye":"eye-off")}}function Zp(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",13),r.NdJ("click",function(){return r.CHM(e),r.oxw().toggleLayerTool()}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",14),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.layer.moreOptions"))}function Lp(e,t){if(1&e&&r._UZ(0,"igo-layer-legend",15),2&e){const e=r.oxw();r.Q6J("layer",e.layer)("updateLegendOnResolutionChange",e.updateLegendOnResolutionChange)}}let Fp=(()=>{class e{constructor(e,t,o,i){this.networkService=e,this.renderer=t,this.elRef=o,this.cdRef=i,this.focusedCls="igo-layer-item-focused",this.layerTool$=new C.X(!1),this.showLegend$=new C.X(!0),this.inResolutionRange$=new C.X(!0),this.queryBadgeHidden$=new C.X(!0),this._selectAll=!1,this.layers$=new C.X(void 0),this.toggleLegendOnVisibilityChange=!1,this.expandLegendIfVisible=!1,this.updateLegendOnResolutionChange=!1,this.orderable=!0,this.lowerDisabled=!1,this.raiseDisabled=!1,this.queryBadge=!1,this.action=new r.vpe(void 0),this.checkbox=new r.vpe}get activeLayer(){return this._activeLayer}set activeLayer(e){e&&this.layer&&e.id===this.layer.id&&!this.selectionMode?(this.layerTool$.next(!0),this.renderer.addClass(this.elRef.nativeElement,this.focusedCls)):this.renderer.removeClass(this.elRef.nativeElement,this.focusedCls)}get selectAll(){return this._selectAll}set selectAll(e){this._selectAll=e,!0===e&&(this.layerCheck=!0)}get layer(){return this._layer}set layer(e){this._layer=e,this.layers$.next(e)}get opacity(){return 100*this.layer.opacity}set opacity(e){this.layer.opacity=e/100}ngOnInit(){this.layer.visible&&this.expandLegendIfVisible&&!0===this.layer.firstLoadComponent&&(this.layer.firstLoadComponent=!1,this.layer.legendCollapsed=!1),this.toggleLegend(this.layer.legendCollapsed),this.updateQueryBadge(),this.resolution$$=this.layer.map.viewController.resolution$.subscribe(()=>{this.onResolutionChange()}),this.tooltipText=this.computeTooltip(),this.network$$=this.networkService.currentState().subscribe(e=>{this.state=e,this.onResolutionChange()}),this.layers$$=this.layers$.subscribe(()=>{this.layer&&this.layer.options.active&&(this.layerTool$.next(!0),this.renderer.addClass(this.elRef.nativeElement,this.focusedCls))}),this.changeDetection&&this.changeDetection.subscribe(()=>this.cdRef.detectChanges())}ngOnDestroy(){this.resolution$$.unsubscribe(),this.network$$.unsubscribe(),this.layers$$.unsubscribe()}toggleLegend(e){this.layer.legendCollapsed=e,this.showLegend$.next(!e)}toggleLegendOnClick(){this.toggleLegend(this.showLegend$.value)}toggleVisibility(){this.layer.visible=!this.layer.visible,this.toggleLegendOnVisibilityChange&&this.toggleLegend(!this.layer.visible),this.updateQueryBadge()}computeTooltip(){const e=this.layer.options;if(!e.tooltip)return this.layer.title;const t=e.tooltip,o=e.metadata;switch(e.tooltip.type){case Zl.TITLE:return this.layer.title;case Zl.ABSTRACT:return o&&o.abstract?o.abstract:this.layer.title;case Zl.CUSTOM:return t&&t.text?t.text:this.layer.title;default:return this.layer.title}}onResolutionChange(){const e=this.layer.isInResolutionsRange;!1===e&&!0===this.updateLegendOnResolutionChange&&this.toggleLegend(!0),this.inResolutionRange$.next(e)}updateQueryBadge(){const e=!1===this.queryBadge||!1===this.layer.visible||!$u(this.layer);this.queryBadgeHidden$.next(e)}toggleLayerTool(){this.layerTool$.next(!this.layerTool$.getValue()),!0===this.layerTool$.getValue()?this.renderer.addClass(this.elRef.nativeElement,this.focusedCls):this.renderer.removeClass(this.elRef.nativeElement,this.focusedCls),this.action.emit(this.layer)}check(){this.layerCheck=!this.layerCheck,this.checkbox.emit({layer:this.layer,check:this.layerCheck})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(be),r.Y36(r.Qsj),r.Y36(r.SBq),r.Y36(r.sBO))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-layer-item"]],inputs:{activeLayer:"activeLayer",selectAll:"selectAll",layerCheck:"layerCheck",layer:"layer",toggleLegendOnVisibilityChange:"toggleLegendOnVisibilityChange",expandLegendIfVisible:"expandLegendIfVisible",updateLegendOnResolutionChange:"updateLegendOnResolutionChange",orderable:"orderable",lowerDisabled:"lowerDisabled",raiseDisabled:"raiseDisabled",queryBadge:"queryBadge",selectionMode:"selectionMode",changeDetection:"changeDetection"},outputs:{action:"action",checkbox:"checkbox"},decls:11,vars:9,consts:[[1,"igo-layer-list-item"],["class","layerCheck","mat-list-icon","",3,"checked","change",4,"ngIf"],["matLine","","matTooltipShowDelay","500",1,"igo-layer-title",3,"matTooltip","click"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"color","matTooltip","click",4,"ngIf"],["class","selection-eye","mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"color","matTooltip","click",4,"ngIf"],["class","actions-button","tooltip-position","below","matTooltipShowDelay","500","mat-icon-button","","color","primary",3,"matTooltip","click",4,"ngIf"],[1,"igo-layer-legend-container"],["legend",""],[3,"layer","updateLegendOnResolutionChange",4,"ngIf"],["mat-list-icon","",1,"layerCheck",3,"checked","change"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"color","matTooltip","click"],["matBadge","?","matBadgeColor","accent","matBadgeSize","small","matBadgePosition","after",3,"matBadgeHidden","ngClass","svgIcon"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",1,"selection-eye",3,"color","matTooltip","click"],["tooltip-position","below","matTooltipShowDelay","500","mat-icon-button","","color","primary",1,"actions-button",3,"matTooltip","click"],["svgIcon","dots-horizontal"],[3,"layer","updateLegendOnResolutionChange"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-list-item",0),r.YNc(1,Sp,1,1,"mat-checkbox",1),r.TgZ(2,"h4",2),r.NdJ("click",function(){return t.toggleLegendOnClick()}),r._uU(3),r.qZA(),r.YNc(4,Tp,7,17,"button",3),r.YNc(5,Ap,6,15,"button",4),r.YNc(6,Zp,3,3,"button",5),r.qZA(),r.TgZ(7,"div",6,7),r.YNc(9,Lp,1,2,"igo-layer-legend",8),r.ALo(10,"async"),r.qZA()),2&e&&(r.xp6(1),r.Q6J("ngIf",t.selectionMode),r.xp6(1),r.Q6J("matTooltip",t.tooltipText),r.xp6(1),r.Oqu(t.layer.title),r.xp6(1),r.Q6J("ngIf",!t.selectionMode),r.xp6(1),r.Q6J("ngIf",t.selectionMode),r.xp6(1),r.Q6J("ngIf",!t.selectionMode),r.xp6(3),r.Q6J("ngIf",r.lcZ(10,7,t.showLegend$)))},styles:["[_nghost-%COMP%]{overflow:hidden}mat-list-item[_ngcontent-%COMP%]     .mat-list-item-content .layerCheck{align-self:baseline;width:16px;padding-right:0}.igo-layer-list-item[_ngcontent-%COMP%]{height:46px;clear:both}.igo-layer-title[_ngcontent-%COMP%]{cursor:pointer}.igo-layer-legend-container[_ngcontent-%COMP%]{padding-left:18px;width:calc(100% - 18px)}mat-icon.disabled[_ngcontent-%COMP%]{color:#00000061}mat-icon[matBadge][_ngcontent-%COMP%]     .mat-badge-content{font-size:12px}.selection-eye[_ngcontent-%COMP%]{padding-right:45px}"],changeDetection:0}),e})();var Op=(()=>{return(e=Op||(Op={})).always="always",e.never="never",e.default="default",Op;var e})(),Mp=(()=>{return(e=Mp||(Mp={})).ALL_VISIBLE="ALL_VISIBLE",e.ALL_HIDDEN="ALL_HIDDEN",e.MIXED="MIXED",e.NULL="NULL",Mp;var e})(),Ip=(()=>{return(e=Ip||(Ip={})).Raise="raise",e.Lower="lower",Ip;var e})();const kp=["igoLayerItemToolbar"];function Pp(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-layer-list-tool",6),r.NdJ("appliedFilterAndSort",function(t){return r.CHM(e),r.oxw().onAppliedFilterAndSortChange(t)})("selection",function(t){return r.CHM(e),r.oxw().toggleSelectionMode(t)}),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("layersAreAllVisible",e.layersAreAllVisible)("term",e.layerFilterAndSortOptions.keyword)("onlyVisible",e.layerFilterAndSortOptions.onlyVisible)("sortAlpha",e.layerFilterAndSortOptions.sortAlpha)}}function _p(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-list-item"),r.TgZ(1,"mat-checkbox",7),r.NdJ("change",function(){return r.CHM(e),r.oxw().selectAll()}),r._uU(2),r.ALo(3,"translate"),r.ALo(4,"translate"),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(1),r.Q6J("color",!e.selectAllCheck&&e.layersChecked.length>0?"accent":"primary")("checked",e.selectAllCheck)("indeterminate",!e.selectAllCheck&&e.layersChecked.length>0),r.xp6(1),r.hij(" ",e.selectAllCheck?r.lcZ(3,4,"igo.geo.layer.deselectAll"):r.lcZ(4,6,"igo.geo.layer.selectAll")," ")}}function $p(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-layer-item",9),r.NdJ("action",function(t){return r.CHM(e),r.oxw(2).toggleLayerTool(t)})("checkbox",function(t){return r.CHM(e),r.oxw(2).layersCheck(t)}),r.qZA()}if(2&e){const e=r.oxw().$implicit,t=r.oxw();r.Q6J("layer",e)("activeLayer",t.activeLayer)("orderable",t.orderable&&!e.baseLayer)("lowerDisabled",t.getLowerLayer().id===e.id)("raiseDisabled",t.getUpperLayer().id===e.id)("queryBadge",t.queryBadge)("expandLegendIfVisible",t.expandLegendOfVisibleLayers)("updateLegendOnResolutionChange",t.updateLegendOnResolutionChange)("toggleLegendOnVisibilityChange",t.toggleLegendOnVisibilityChange)("selectionMode",t.selection)("selectAll",t.selectAllCheck)("layerCheck",e.options.check)("changeDetection",t.layerItemChangeDetection$)}}function qp(e,t){if(1&e&&r.YNc(0,$p,1,13,"igo-layer-item",8),2&e){const e=t.$implicit,o=r.oxw();r.Q6J("ngIf",!(o.excludeBaseLayers&&e.baseLayer))}}function Dp(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",25),r.NdJ("click",function(){return r.CHM(e),r.oxw(2).removeLayers()}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",26),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.layer.removeLayer"))}function Ep(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",27),r.NdJ("click",function(){r.CHM(e);const t=r.oxw(2);return t.zoomLayerExtents(t.activeLayer)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",28),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.layer.zoomLayer"))}const Rp=function(e){return{layer:e}};function Up(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-panel",10),r.TgZ(1,"div",11),r.YNc(2,Dp,3,3,"button",12),r.TgZ(3,"button",13),r.NdJ("click",function(){r.CHM(e);const t=r.oxw();return t.moveActiveLayer(t.activeLayer,t.layerListDisplacement.Lower)}),r.ALo(4,"translate"),r.ALo(5,"translate"),r._UZ(6,"mat-icon",14),r.qZA(),r.TgZ(7,"button",15),r.NdJ("click",function(){r.CHM(e);const t=r.oxw();return t.moveActiveLayer(t.activeLayer,t.layerListDisplacement.Raise)}),r.ALo(8,"translate"),r.ALo(9,"translate"),r._UZ(10,"mat-icon",16),r.qZA(),r.TgZ(11,"button",17),r.ALo(12,"translate"),r._UZ(13,"mat-icon",18),r.qZA(),r.TgZ(14,"mat-menu",19,20),r.TgZ(16,"div",21),r.TgZ(17,"mat-slider",22),r.NdJ("input",function(t){return r.CHM(e),r.oxw().changeOpacity(t)})("click",function(e){return e.stopPropagation()}),r.ALo(18,"translate"),r.qZA(),r.qZA(),r.qZA(),r.YNc(19,Ep,3,3,"button",23),r.GkF(20,24),r.Hsn(21),r.qZA(),r.qZA()}if(2&e){const e=r.MAs(15),t=r.oxw();r.Q6J("title",t.activeLayer.title),r.xp6(2),r.Q6J("ngIf",t.isLayerRemovable(t.activeLayer)),r.xp6(1),r.Q6J("matTooltip",t.sortAlpha||t.onlyVisible||t.keyword?r.lcZ(4,20,"igo.geo.layer.filterLowerLayer"):r.lcZ(5,22,"igo.geo.layer.lowerLayer"))("disabled",t.lowerDisabled),r.xp6(3),r.Q6J("matBadge",t.sortAlpha||t.onlyVisible||t.keyword?"!":"")("matBadgeHidden",t.lowerDisabled),r.xp6(1),r.Q6J("matTooltip",t.sortAlpha||t.onlyVisible||t.keyword?r.lcZ(8,24,"igo.geo.layer.filterRaiseLayer"):r.lcZ(9,26,"igo.geo.layer.raiseLayer"))("disabled",t.raiseDisabled),r.xp6(3),r.Q6J("matBadge",t.sortAlpha||t.onlyVisible||t.keyword?"!":"")("matBadgeHidden",t.raiseDisabled),r.xp6(1),r.Q6J("matMenuTriggerFor",e)("matTooltip",r.lcZ(12,28,"igo.geo.layer.opacity")),r.xp6(2),r.Q6J("matBadge",t.badgeOpacity),r.xp6(4),r.Q6J("min",0)("max",100)("value",t.opacity)("matTooltip",r.lcZ(18,30,"igo.geo.layer.opacity")),r.xp6(2),r.Q6J("ngIf",t.activeLayerIsValid(t.activeLayer)),r.xp6(1),r.Q6J("ngTemplateOutlet",t.templateLayerToolbar)("ngTemplateOutletContext",r.VKq(32,Rp,t.activeLayer))}}function Np(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-slider",37),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw(2).checkOpacity=t})("click",function(e){return e.stopPropagation()}),r.ALo(1,"translate"),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("min",0)("max",100)("ngModel",e.checkOpacity)("matTooltip",r.lcZ(1,4,"igo.geo.layer.opacity"))}}function Jp(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",27),r.NdJ("click",function(){r.CHM(e);const t=r.oxw(2);return t.zoomLayersExtents(t.layersChecked)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",38),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.layer.zoomLayers"))}function Bp(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-panel",10),r.ALo(1,"translate"),r.TgZ(2,"div",29),r.TgZ(3,"button",30),r.NdJ("click",function(){r.CHM(e);const t=r.oxw();return t.removeLayers(t.layersChecked)}),r.ALo(4,"translate"),r.ALo(5,"translate"),r._UZ(6,"mat-icon",31),r.qZA(),r.TgZ(7,"button",32),r.NdJ("click",function(){r.CHM(e);const t=r.oxw();return t.toggleVisibility(t.layersChecked)}),r.ALo(8,"translate"),r.ALo(9,"translate"),r._UZ(10,"mat-icon",33),r.qZA(),r.TgZ(11,"button",13),r.NdJ("click",function(){r.CHM(e);const t=r.oxw();return t.lowerLayers(t.layersChecked)}),r.ALo(12,"translate"),r.ALo(13,"translate"),r._UZ(14,"mat-icon",14),r.qZA(),r.TgZ(15,"button",15),r.NdJ("click",function(){r.CHM(e);const t=r.oxw();return t.raiseLayers(t.layersChecked)}),r.ALo(16,"translate"),r.ALo(17,"translate"),r._UZ(18,"mat-icon",16),r.qZA(),r.TgZ(19,"button",34),r.ALo(20,"translate"),r._UZ(21,"mat-icon",35),r.qZA(),r.TgZ(22,"mat-menu",19,20),r.TgZ(24,"div",21),r.YNc(25,Np,2,6,"mat-slider",36),r.qZA(),r.qZA(),r.YNc(26,Jp,3,3,"button",23),r.qZA(),r.qZA()}if(2&e){const e=r.MAs(23),t=r.oxw();r.Q6J("title",r.lcZ(1,21,"igo.geo.layer.tools")),r.xp6(3),r.Q6J("disabled",0===t.layersChecked.length)("matTooltip",t.isAllLayersRemovable(t.layersChecked)?r.lcZ(4,23,"igo.geo.layer.removeSelectedLayers"):r.lcZ(5,25,"igo.geo.layer.removeSelectedLayersRestriction")),r.xp6(3),r.Q6J("matBadge","!")("matBadgeHidden",t.isAllLayersRemovable(t.layersChecked)),r.xp6(1),r.Q6J("disabled",0===t.layersChecked.length)("matTooltip","ALL_HIDDEN"===t.statusSelectedLayersCheck?r.lcZ(8,27,"igo.geo.layer.showSelectedLayers"):r.lcZ(9,29,"igo.geo.layer.hideSelectedLayers")),r.xp6(3),r.Q6J("svgIcon","ALL_HIDDEN"===t.statusSelectedLayersCheck?"eye-off":"eye"),r.xp6(1),r.Q6J("matTooltip",t.sortAlpha||t.onlyVisible||t.keyword?r.lcZ(12,31,"igo.geo.layer.filterLowerLayer"):r.lcZ(13,33,"igo.geo.layer.lowerLayer"))("disabled",t.lowerDisabledSelection),r.xp6(3),r.Q6J("matBadge",t.sortAlpha||t.onlyVisible||t.keyword?"!":"")("matBadgeHidden",t.lowerDisabledSelection),r.xp6(1),r.Q6J("matTooltip",t.sortAlpha||t.onlyVisible||t.keyword?r.lcZ(16,35,"igo.geo.layer.filterRaiseLayer"):r.lcZ(17,37,"igo.geo.layer.raiseLayer"))("disabled",t.raiseDisabledSelection),r.xp6(3),r.Q6J("matBadge",t.sortAlpha||t.onlyVisible||t.keyword?"!":"")("matBadgeHidden",t.raiseDisabledSelection),r.xp6(1),r.Q6J("disabled",0===t.layersChecked.length)("matMenuTriggerFor",e)("matTooltip",r.lcZ(20,39,"igo.geo.layer.opacity")),r.xp6(6),r.Q6J("ngIf",t.layersChecked.length),r.xp6(1),r.Q6J("ngIf",0!==t.layersChecked.length&&t.activeLayersAreValid(t.layersChecked))}}const jp=[[["","igoLayerItemToolbar",""]]],Gp=function(e,t,o){return{"igo-list-tools-multi":e,"igo-list-tools-single":t,"igo-list-no-tools":o}},Qp=["[igoLayerItemToolbar]"];let zp=(()=>{class e{constructor(e){this.elRef=e,this.orderable=!0,this.thresholdToFilterAndSort=5,this.layers$=new C.X([]),this.change$=new we.t(1),this.showToolbar$=new C.X(!1),this.hideSelectedLayers=!0,this.activeLayer$=new C.X(void 0),this.layersChecked=[],this.layerItemChangeDetection$=new C.X(void 0),this.layersAreAllVisible=!0,this.ogcButton=!0,this.timeButton=!0,this.floatLabel="auto",this.layerFilterAndSortOptions={},this.excludeBaseLayers=!1,this.toggleLegendOnVisibilityChange=!1,this.expandLegendOfVisibleLayers=!1,this.updateLegendOnResolutionChange=!1,this.queryBadge=!1,this.appliedFilterAndSort=new r.vpe,this._keyword=void 0,this._onlyVisible=!1,this._sortedAlpha=!1,this.toggleOpacity=!1,this.selectAllCheck$=new C.X(void 0)}get map(){return this._map}set map(e){this._map=e}set layers(e){this._layers=this.removeProblemLayerInList(e),this.next()}get layers(){return this._layers}set activeLayer(e){this._activeLayer=e,this.activeLayer$.next(e)}get activeLayer(){return this._activeLayer}get keyword(){return this._keyword}set keyword(e){this._keyword=e,this.next()}get onlyVisible(){return this._onlyVisible}set onlyVisible(e){this._onlyVisible=e,this.next()}get sortAlpha(){return this._sortedAlpha}set sortAlpha(e){this._sortedAlpha=e,this.next()}get opacity(){return Math.round(100*this.activeLayer$.getValue().opacity)}set opacity(e){this.activeLayer$.getValue().opacity=e/100}get badgeOpacity(){if(100!==this.opacity)return this.opacity}get raiseDisabled(){return!(this.orderable&&!this.activeLayer.baseLayer&&this.getUpperLayer().id!==this.activeLayer.id&&!this.isUpperBaselayer(this.activeLayer))}get lowerDisabled(){return!(this.orderable&&!this.activeLayer.baseLayer&&this.getLowerLayer().id!==this.activeLayer.id&&!this.isLowerBaselayer(this.activeLayer))}get raiseDisabledSelection(){return 0===this.layersChecked.length||!this.orderable||!this.raisableLayers(this.layersChecked)||!0===this.selectAllCheck}get lowerDisabledSelection(){return 0===this.layersChecked.length||!this.orderable||!this.lowerableLayers(this.layersChecked)||!0===this.selectAllCheck}get checkOpacity(){return 100*this.layersCheckedOpacity()}set checkOpacity(e){for(const t of this.layersChecked)t.opacity=e/100}get layerListDisplacement(){return Ip}ngOnInit(){this.change$$=this.change$.pipe((0,wn.D)(()=>0===this.layers.length?fn.E:(0,yn.H)(50))).subscribe(()=>{this.showToolbar$.next(this.computeShowToolbar()),this.layers$.next(this.computeLayers(this.layers.slice(0))),this.appliedFilterAndSort.emit({keyword:this.keyword,sortAlpha:this.sortAlpha,onlyVisible:this.onlyVisible})}),this.selectAllCheck$$=this.selectAllCheck$.subscribe(e=>{this.selectAllCheck=e}),this.layers$$=this.layers$.subscribe(()=>{if(this.layers){let e=0;for(const t of this.layers)t.status$.subscribe(e=>{0===e&&this.map.removeLayer(t)}),t.options.active&&(this.activeLayer=t,this.layerTool=!0),t.options.check&&(e+=1);this.selectAllCheck=this.excludeBaseLayers?e===this.layers.filter(e=>!0!==e.baseLayer&&e.showInLayerList).length:e===this.layers.filter(e=>e.showInLayerList).length}})}ngOnDestroy(){this.change$$.unsubscribe(),this.selectAllCheck$$.unsubscribe(),this.layers$$.unsubscribe()}activeLayerIsValid(e){let t=!1;const o=e.options.extent,i=this.map.viewController.maxLayerZoomExtent;return o&&(t=!i||$n.r4(i,o)),t}activeLayersAreValid(e){let t=!1;const o=$n.lJ(),i=this.map.viewController.maxLayerZoomExtent;for(const r of e){const e=r.options.extent;e&&!e.includes(1/0)&&$n.l7(o,e)}return $n.xb(o)||(t=!i||$n.r4(i,o)),t}zoomLayerExtents(e){this.map.viewController.zoomToExtent(e.options.extent)}zoomLayersExtents(e){const t=$n.lJ();for(const o of e){const e=o.options.extent;e&&$n.l7(t,e)}this.map.viewController.zoomToExtent(t)}changeOpacity(e){this.opacity=e.value}clearKeyword(){this.keyword=void 0}getLowerLayer(){return this.layers.filter(e=>!e.baseLayer).reduce((e,t)=>e.zIndex<t.zIndex?e:t,{zIndex:void 0,id:void 0})}isLowerBaselayer(e){const t=this.layers.findIndex(t=>e.id===t.id);return!(!this.layers||!this.layers[t+1]||!0!==this.layers[t+1].baseLayer)}getUpperLayer(){return this.layers.filter(e=>!e.baseLayer).reduce((e,t)=>e.zIndex>t.zIndex?e:t,{zIndex:void 0,id:void 0})}isUpperBaselayer(e){const t=this.layers.findIndex(t=>e.id===t.id);return!(!this.layers||!this.layers[t-1]||!0!==this.layers[t-1].baseLayer)}moveActiveLayer(e,t){const o=[e],i=[];this.getLinkedLayers(e,o),this.layers.map(e=>{-1!==o.indexOf(e)&&i.push(e)}),t===Ip.Raise?this.raiseLayers(i,!1):t===Ip.Lower&&this.lowerLayers(i,!1)}getLinkedLayers(e,t){const o=e.options.linkedLayers;if(!o)return;const i=o.linkId,r=o.links;r?r.map(e=>{!e.properties||-1===e.properties.indexOf(Al.ZINDEX)||e.linkedIds.map(e=>{const o=this.layers.find(t=>{var o;return(null===(o=t.options.linkedLayers)||void 0===o?void 0:o.linkId)===e});o&&(t.includes(o)||t.push(o))})}):this.layers.map(e=>{var o;(null===(o=e.options.linkedLayers)||void 0===o?void 0:o.links)&&e.options.linkedLayers.links.map(o=>{var r;-1!==(null===(r=o.properties)||void 0===r?void 0:r.indexOf(Al.ZINDEX))&&!1!==o.bidirectionnal&&-1!==o.linkedIds.indexOf(i)&&(t.push(e),this.getLinkedLayers(e,t))})})}raisableLayers(e){let t=!1,o=0;for(const i of e){const r=this.layers.findIndex(e=>i.id===e.id),s=this.layers[r];s.baseLayer&&(o+=1);const n=this.layers[r-1];n&&!0!==n.baseLayer&&!e.find(e=>n.id===e.id)&&!0!==s.baseLayer&&(t=!0)}return(1===this.layersChecked.length&&this.layersChecked[0].baseLayer||o===this.layersChecked.length)&&(t=!1),t}raisableLayer(e){return!(e<1)&&(!this.layers[e-1].options.check||this.raisableLayer(e-1))}raiseLayers(e,t=!0){const o=[];for(const i of e){const e=this.layers.findIndex(e=>e.id===i.id);this.raisableLayer(e)&&o.push(i)}this.map.raiseLayers(o),t&&setTimeout(()=>{const e=this.computeElementRef();this.isScrolledIntoView(e[0],e[1].offsetParent)||(e[0].scrollTop=e[1].offsetParent.offsetTop)},100)}lowerableLayers(e){let t=!1,o=0;for(const i of e){const r=this.layers.findIndex(e=>i.id===e.id);this.layers[r].baseLayer&&(o+=1);const s=this.layers[r+1];s&&!0!==s.baseLayer&&!e.find(e=>s.id===e.id)&&(t=!0)}return(1===this.layersChecked.length&&this.layersChecked[0].baseLayer||o===this.layersChecked.length)&&(t=!1),t}lowerableLayer(e){return!(e>this.layers.filter(e=>!0!==e.baseLayer).length-2)&&(!this.layers[e+1].options.check||this.lowerableLayer(e+1))}lowerLayers(e,t=!0){const o=[];for(const i of e){const e=this.layers.findIndex(e=>e.id===i.id);this.lowerableLayer(e)&&o.push(i)}this.map.lowerLayers(o),t&&setTimeout(()=>{const e=this.computeElementRef("lower");this.isScrolledIntoView(e[0],e[1].offsetParent)||(e[0].scrollTop=e[1].offsetParent.offsetTop+e[1].offsetParent.offsetHeight-e[0].clientHeight)},100)}next(){this.change$.next()}computeLayers(e){let t=this.filterLayers(e);return t=this.sortAlpha?this.sortLayersByTitle(t):this.sortLayersByZindex(t),t}onKeywordChange(e){this.keyword=e}onAppliedFilterAndSortChange(e){this.keyword=e.keyword,this.onlyVisible=e.onlyVisible,this.sortAlpha=e.sortAlpha}filterLayers(e){if(this.layerFilterAndSortOptions.showToolbar===Op.never||!this.keyword&&!this.onlyVisible)return e;const t=e.map(e=>e.id);return e.forEach(e=>{const o=e.dataSource.options||{},i=(((e.options||{}).metadata||{}).keywordList||[]).map(e=>e.normalize("NFD").replace(/[\u0300-\u036f]/g,""));if(this.keyword&&e.title){const r=this.keyword.normalize("NFD").replace(/[\u0300-\u036f]/g,""),s=e.title.normalize("NFD").replace(/[\u0300-\u036f]/g,""),n=o.type||"",a=new RegExp(r,"gi"),l=void 0!==i.find(e=>a.test(e));if(!a.test(s)&&this.keyword.toLowerCase()!==n.toLowerCase()&&!l){const o=t.indexOf(e.id);o>-1&&t.splice(o,1)}}if(this.onlyVisible&&!1===e.visible){const o=t.indexOf(e.id);o>-1&&t.splice(o,1)}}),e.filter(e=>-1!==t.indexOf(e.id))}sortLayersByZindex(e){return e.sort((e,t)=>t.zIndex-e.zIndex)}sortLayersByTitle(e){return e.sort((e,t)=>this.normalize(e.title)<this.normalize(t.title)?-1:this.normalize(e.title)>this.normalize(t.title)?1:0)}normalize(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}computeShowToolbar(){switch(this.layerFilterAndSortOptions.showToolbar){case Op.always:return!0;case Op.never:return!1;default:return!!(this.layers.length>=this.thresholdToFilterAndSort||this.keyword||this.onlyVisible)}}toggleLayerTool(e){this.toggleOpacity=!1,this.layerTool=!this.layerTool||e!==this.activeLayer;for(const t of this.layers)t.options.active=!1;e.options.active=!0,this.activeLayer=e}removeLayers(e){if(e&&e.length>0){this.layersChecked=[];for(const t of e)!1!==t.options.removable?t.map.removeLayer(t):this.layersChecked.push(t)}else!e&&!1!==this.activeLayer.options.removable&&(this.activeLayer.map.removeLayer(this.activeLayer),this.layerTool=!1)}toggleVisibility(e){if(e&&e.length>0)for(const t of e)t.visible=this.hideSelectedLayers;this.layerItemChangeDetection$.next(!0)}isLayerRemovable(e){return!1!==e.options.removable}isAllLayersRemovable(e){return e.every(e=>this.isLayerRemovable(e))}get statusSelectedLayersCheck(){let e=Mp.NULL,t=!1,o=!1;if(0===this.layersChecked.length)e=Mp.NULL;else{e=Mp.MIXED,this.hideSelectedLayers=!1;for(const e of this.layersChecked)!0===e.visible&&(t=!0),!1===e.visible&&(o=!0);!0===t&&!1===o&&(e=Mp.ALL_VISIBLE),!1===t&&!0===o&&(e=Mp.ALL_HIDDEN,this.hideSelectedLayers=!0)}return e}layersCheck(e){if(e.layer.options.check=e.check,!0===e.check){const t=this.layers.findIndex(t=>e.layer.id===t.id);for(const o of this.layersChecked)if(t<this.layers.findIndex(e=>o.id===e.id))return this.layersChecked.splice(this.layersChecked.findIndex(e=>o.id===e.id),0,e.layer),void(this.excludeBaseLayers?this.selectAllCheck=this.layersChecked.length===this.layers.filter(e=>!0!==e.baseLayer&&e.showInLayerList).length:this.excludeBaseLayers||(this.selectAllCheck=this.layersChecked.length===this.layers.filter(e=>e.showInLayerList).length));this.layersChecked.push(e.layer)}else{const t=this.layersChecked.findIndex(t=>e.layer.id===t.id);this.layersChecked.splice(t,1)}this.excludeBaseLayers?this.selectAllCheck=this.layersChecked.length===this.layers.filter(e=>!0!==e.baseLayer&&e.showInLayerList).length:this.excludeBaseLayers||(this.selectAllCheck=this.layersChecked.length===this.layers.filter(e=>e.showInLayerList).length)}toggleSelectionMode(e){if(this.selection=e,this.activeLayer=void 0,!0===e){this.layerTool=!1;for(const e of this.layers)e.options.check&&this.layersChecked.push(e)}}layersCheckedOpacity(){if(this.layersChecked.length>1)return 1;{const e=[];for(const t of this.layersChecked)e.push(t.opacity);return e}}selectAll(){if(this.selectAllCheck){for(const e of this.layers)e.options.check=!1;this.layersChecked=[],this.selectAllCheck$.next(!1)}else{for(const e of this.layers)(this.excludeBaseLayers&&!0!==e.baseLayer&&e.showInLayerList||!this.excludeBaseLayers&&e.showInLayerList)&&(e.options.check=!0,this.layersChecked.push(e));this.selectAllCheck$.next(!0)}}isScrolledIntoView(e,t){const o=e.scrollTop,i=t.offsetTop;return i+t.clientHeight<=o+e.clientHeight&&i>=o}computeElementRef(e){const t=this.elRef.nativeElement.getElementsByClassName("mat-checkbox-checked"),o="lower"===e?this.elRef.nativeElement.getElementsByClassName("mat-checkbox-checked")[t.length-1]:this.elRef.nativeElement.getElementsByClassName("mat-checkbox-checked")[0];return[this.elRef.nativeElement.getElementsByTagName("igo-list")[0],o]}removeProblemLayerInList(e){for(const t of e)!0===t.olLoadingProblem&&this.map.removeLayer(t);return e}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.SBq))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-layer-list"]],contentQueries:function(e,t,o){if(1&e&&r.Suo(o,kp,5),2&e){let e;r.iGM(e=r.CRH())&&(t.templateLayerToolbar=e.first)}},inputs:{layersAreAllVisible:"layersAreAllVisible",ogcButton:"ogcButton",timeButton:"timeButton",map:"map",layers:"layers",floatLabel:"floatLabel",layerFilterAndSortOptions:"layerFilterAndSortOptions",excludeBaseLayers:"excludeBaseLayers",toggleLegendOnVisibilityChange:"toggleLegendOnVisibilityChange",expandLegendOfVisibleLayers:"expandLegendOfVisibleLayers",updateLegendOnResolutionChange:"updateLegendOnResolutionChange",queryBadge:"queryBadge"},outputs:{appliedFilterAndSort:"appliedFilterAndSort"},ngContentSelectors:Qp,decls:11,vars:16,consts:[["floatLabel","auto",3,"layersAreAllVisible","term","onlyVisible","sortAlpha","appliedFilterAndSort","selection",4,"ngIf"],[4,"ngIf"],[3,"ngClass","navigation","selection"],["igoList",""],["ngFor","",3,"ngForOf"],["class","igo-layer-actions-container",3,"title",4,"ngIf"],["floatLabel","auto",3,"layersAreAllVisible","term","onlyVisible","sortAlpha","appliedFilterAndSort","selection"],[1,"select-all-checkbox","mat-subheading-2",3,"color","checked","indeterminate","change"],["igoListItem","",3,"layer","activeLayer","orderable","lowerDisabled","raiseDisabled","queryBadge","expandLegendIfVisible","updateLegendOnResolutionChange","toggleLegendOnVisibilityChange","selectionMode","selectAll","layerCheck","changeDetection","action","checkbox",4,"ngIf"],["igoListItem","",3,"layer","activeLayer","orderable","lowerDisabled","raiseDisabled","queryBadge","expandLegendIfVisible","updateLegendOnResolutionChange","toggleLegendOnVisibilityChange","selectionMode","selectAll","layerCheck","changeDetection","action","checkbox"],[1,"igo-layer-actions-container",3,"title"],[1,"igo-layer-button-group"],["class","delete-button","mat-icon-button","","color","warn","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","color","primary","tooltip-position","below","matTooltipShowDelay","500",1,"down-button",3,"matTooltip","disabled","click"],["matBadgeColor","warn","matBadgeSize","medium","svgIcon","arrow-down",3,"matBadge","matBadgeHidden"],["color","primary","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",1,"up-button",3,"matTooltip","disabled","click"],["matBadgeColor","warn","matBadgeSize","medium","svgIcon","arrow-up",3,"matBadge","matBadgeHidden"],["color","primary","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",1,"opacity-button",3,"matMenuTriggerFor","matTooltip"],["matBadgeColor","primary","matBadgeSize","medium","svgIcon","opacity",3,"matBadge"],[1,"mat-menu-opacity-slider"],["opacityMenu","matMenu"],["id","opacity-menu"],["id","opacity-slider","color","primary","thumbLabel","","tickInterval","5","step","5","matTooltipShowDelay","500","tooltip-position","below",3,"min","max","value","matTooltip","input","click"],["class","zoomLayer-button","color","primary","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","click",4,"ngIf"],["igoLayerItemToolbar","",3,"ngTemplateOutlet","ngTemplateOutletContext"],["mat-icon-button","","color","warn","tooltip-position","below","matTooltipShowDelay","500",1,"delete-button",3,"matTooltip","click"],["svgIcon","delete"],["color","primary","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",1,"zoomLayer-button",3,"matTooltip","click"],["matBadgeColor","primary","matBadgeSize","medium","svgIcon","magnify-scan"],[1,"actions-buttons-multi"],["mat-icon-button","","color","warn","tooltip-position","below","matTooltipShowDelay","500",1,"delete-button",3,"disabled","matTooltip","click"],["matBadgeColor","warn","matBadgeSize","medium","svgIcon","delete",3,"matBadge","matBadgeHidden"],["mat-icon-button","","color","primary","tooltip-position","below","matTooltipShowDelay","500",1,"eye-button",3,"disabled","matTooltip","click"],[3,"svgIcon"],["color","primary","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",1,"opacity-button",3,"disabled","matMenuTriggerFor","matTooltip"],["svgIcon","opacity"],["id","opacity-slider","color","primary","thumbLabel","","tickInterval","5","step","5","matTooltipShowDelay","500","tooltip-position","below",3,"min","max","ngModel","matTooltip","ngModelChange","click",4,"ngIf"],["id","opacity-slider","color","primary","thumbLabel","","tickInterval","5","step","5","matTooltipShowDelay","500","tooltip-position","below",3,"min","max","ngModel","matTooltip","ngModelChange","click"],["svgIcon","magnify-scan"]],template:function(e,t){1&e&&(r.F$t(jp),r.TgZ(0,"mat-list"),r.YNc(1,Pp,1,4,"igo-layer-list-tool",0),r.ALo(2,"async"),r.qZA(),r.YNc(3,_p,5,8,"mat-list-item",1),r._UZ(4,"mat-divider"),r.TgZ(5,"igo-list",2,3),r.YNc(7,qp,1,1,"ng-template",4),r.ALo(8,"async"),r.qZA(),r.YNc(9,Up,22,34,"igo-panel",5),r.YNc(10,Bp,27,41,"igo-panel",5)),2&e&&(r.xp6(1),r.Q6J("ngIf",r.lcZ(2,8,t.showToolbar$)),r.xp6(2),r.Q6J("ngIf",t.selection),r.xp6(2),r.Q6J("ngClass",r.kEZ(12,Gp,t.selection,t.layerTool&&!t.selection,!t.layerTool&&!t.selection))("navigation",!1)("selection",!1),r.xp6(2),r.Q6J("ngForOf",r.lcZ(8,10,t.layers$)),r.xp6(2),r.Q6J("ngIf",!t.selection&&t.layerTool&&t.activeLayer),r.xp6(1),r.Q6J("ngIf",t.selection&&t.layers.length>0))},styles:["[_nghost-%COMP%]   .igo-list-no-tools[_ngcontent-%COMP%]{height:calc(100% - 57px);padding-top:8px}[_nghost-%COMP%]   .igo-list-tools-single[_ngcontent-%COMP%]{height:calc(100% - 153px);padding-top:8px}[_nghost-%COMP%]   .igo-list-tools-multi[_ngcontent-%COMP%]{height:calc(100% - 178px);padding-top:8px}mat-form-field.inputFilter[_ngcontent-%COMP%]{width:calc(100% - 100px);max-width:200px}.igo-layer-actions-container[_ngcontent-%COMP%]{width:calc(100% - 5px);padding-left:4px}.igo-layer-actions-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{text-align:center}mat-list-item[_ngcontent-%COMP%]     .mat-list-item-content{margin-bottom:10px}mat-checkbox[_ngcontent-%COMP%]     .mat-checkbox-inner-container{margin-left:8px;margin-right:16px}#opacity-slider[_ngcontent-%COMP%]{float:left;min-width:unset;width:110px;left:10px;top:10px}.igo-layer-button-group[_ngcontent-%COMP%], .actions-buttons-multi[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:row-reverse;overflow-x:auto}.igo-layer-button-group[_ngcontent-%COMP%]::-webkit-scrollbar, .actions-buttons-multi[_ngcontent-%COMP%]::-webkit-scrollbar{height:4px}.igo-layer-button-group[_ngcontent-%COMP%]::-webkit-scrollbar-track, .actions-buttons-multi[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1}.igo-layer-button-group[_ngcontent-%COMP%]::-webkit-scrollbar-thumb, .actions-buttons-multi[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#888}.igo-layer-button-group[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover, .actions-buttons-multi[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#555}.igo-layer-button-group[_ngcontent-%COMP%]{padding-top:5px}[_nghost-%COMP%]   igo-panel[_ngcontent-%COMP%]{height:unset}#opacity-menu[_ngcontent-%COMP%]{max-width:unset;width:132px;height:50px}#opacity-menu[_ngcontent-%COMP%]   .mat-menu-content[_ngcontent-%COMP%]:not(:empty){padding-top:20px}"],changeDetection:0}),e})();function Yp(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",9),r.NdJ("click",function(){return r.CHM(e),r.oxw().clearTerm()}),r._UZ(1,"mat-icon",10),r.qZA()}}let Hp=(()=>{class e{constructor(){this.onlyVisible$=new C.X(!1),this.sortAlpha$=new C.X(!1),this.term$=new C.X(void 0),this.layersAreAllVisible=!0,this.floatLabel="auto",this.selectionMode=!1,this.appliedFilterAndSort=new r.vpe,this.selection=new r.vpe}set onlyVisible(e){this.onlyVisible$.next(e)}get onlyVisible(){return this.onlyVisible$.value}set sortAlpha(e){this.sortAlpha$.next(e)}get sortAlpha(){return this.sortAlpha$.value}set term(e){this.term$.next(e)}get term(){return this.term$.value}ngOnInit(){this.term$$=this.term$.subscribe(e=>{this.appliedFilterAndSort.emit({keyword:e,onlyVisible:this.onlyVisible,sortAlpha:this.sortAlpha})}),this.onlyVisible$$=this.onlyVisible$.subscribe(e=>{this.appliedFilterAndSort.emit({keyword:this.term,onlyVisible:e,sortAlpha:this.sortAlpha})}),this.sortAlpha$$=this.sortAlpha$.subscribe(e=>{this.appliedFilterAndSort.emit({keyword:this.term,onlyVisible:this.onlyVisible,sortAlpha:e})})}ngOnDestroy(){this.onlyVisible$$.unsubscribe(),this.sortAlpha$$.unsubscribe(),this.term$$.unsubscribe()}clearTerm(){this.term=void 0}toggleSortAlpha(){this.sortAlpha=!this.sortAlpha}toggleOnlyVisible(){this.onlyVisible=!this.onlyVisible}toggleSelectionMode(){this.selectionMode=!this.selectionMode,this.selection.emit(this.selectionMode)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-layer-list-tool"]],inputs:{layersAreAllVisible:"layersAreAllVisible",floatLabel:"floatLabel",onlyVisible:"onlyVisible",sortAlpha:"sortAlpha",term:"term"},outputs:{appliedFilterAndSort:"appliedFilterAndSort",selection:"selection"},decls:21,vars:30,consts:[[1,"inputFilter",3,"floatLabel"],["matInput","","matTooltipShowDelay","500","type","text",3,"placeholder","matTooltip","ngModel","ngModelChange"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear","color","warn",3,"click",4,"ngIf"],["matTooltipShowDelay","500",3,"matTooltip"],["mat-icon-button","",1,"sort-alpha",3,"color","click"],[3,"svgIcon"],["mat-icon-button","",1,"only-visible",3,"disabled","color","click"],["matBadge","","igoMatBadgeIcon","eye","igoMatBadgeInverseColor","true","igoMatBadgeInheritColor","true",3,"svgIcon"],["mat-icon-button","","color","primary",1,"selection-mode",3,"click"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear","color","warn",3,"click"],["svgIcon","close"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-list-item"),r.TgZ(1,"mat-form-field",0),r.TgZ(2,"input",1),r.NdJ("ngModelChange",function(e){return t.term=e}),r.ALo(3,"translate"),r.ALo(4,"translate"),r.qZA(),r.YNc(5,Yp,2,0,"button",2),r.qZA(),r.TgZ(6,"div",3),r.ALo(7,"translate"),r.ALo(8,"translate"),r.TgZ(9,"button",4),r.NdJ("click",function(){return t.toggleSortAlpha()}),r._UZ(10,"mat-icon",5),r.qZA(),r.qZA(),r.TgZ(11,"div",3),r.ALo(12,"translate"),r.ALo(13,"translate"),r.TgZ(14,"button",6),r.NdJ("click",function(){return t.toggleOnlyVisible()}),r._UZ(15,"mat-icon",7),r.qZA(),r.qZA(),r.TgZ(16,"div",3),r.ALo(17,"translate"),r.ALo(18,"translate"),r.TgZ(19,"button",8),r.NdJ("click",function(){return t.toggleSelectionMode()}),r._UZ(20,"mat-icon",5),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.xp6(1),r.Q6J("floatLabel",t.floatLabel),r.xp6(1),r.Q6J("placeholder",r.lcZ(3,14,"igo.geo.layer.filterPlaceholder"))("matTooltip",r.lcZ(4,16,"igo.geo.layer.subsetLayersListKeyword"))("ngModel",t.term),r.xp6(3),r.Q6J("ngIf",t.term),r.xp6(1),r.Q6J("matTooltip",t.sortAlpha?r.lcZ(7,18,"igo.geo.layer.sortMapOrder"):r.lcZ(8,20,"igo.geo.layer.sortAlphabetically")),r.xp6(3),r.Q6J("color",t.sortAlpha?"warn":"primary"),r.xp6(1),r.Q6J("svgIcon",t.sortAlpha?"sort-ascending":"sort-alphabetical-ascending"),r.xp6(1),r.Q6J("matTooltip",t.onlyVisible?r.lcZ(12,22,"igo.geo.layer.resetLayersList"):r.lcZ(13,24,"igo.geo.layer.subsetLayersListOnlyVisible")),r.xp6(3),r.Q6J("disabled",t.layersAreAllVisible&&!t.onlyVisible)("color",t.onlyVisible?"warn":"primary"),r.xp6(1),r.Q6J("svgIcon",t.onlyVisible?"filter-remove":"filter"),r.xp6(1),r.Q6J("matTooltip",t.selectionMode?r.lcZ(17,26,"igo.geo.layer.deactivateSelectionMode"):r.lcZ(18,28,"igo.geo.layer.activateSelectionMode")),r.xp6(4),r.Q6J("svgIcon",t.selectionMode?"checkbox-multiple-marked-outline":"checkbox-multiple-blank-outline"))},directives:[l.Tg,Pe.KE,Qe.Nt,ze.Fj,p.gM,ze.JJ,ze.On,h.O5,n.lW,a.Hw,Be.k,Oo,Pe.R9],pipes:[U.X$],styles:["mat-form-field.inputFilter[_ngcontent-%COMP%]{width:calc(100% - 100px);max-width:200px}.selection-mode[_ngcontent-%COMP%]{margin-left:5px}"],changeDetection:0}),e})(),Vp=(()=>{class e{constructor(e,t,o){this.mapService=t,this.route=o,this.component=e}ngOnInit(){this.layersOrResolutionChange$$=(0,Z.aj)([this.mapService.getMap().layers$,this.mapService.getMap().viewController.resolution$]).pipe((0,w.b)(10)).subscribe(e=>{const t=e[0].filter(e=>!0===e.showInLayerList);this.component.layers=t,this.setLayersVisibilityStatus(t,this.component.excludeBaseLayers)})}setLayersVisibilityStatus(e,t){void 0!==this.layersVisibility$$&&(this.layersVisibility$$.unsubscribe(),this.layersVisibility$$=void 0),this.layersVisibility$$=(0,Z.aj)(e.filter(e=>e.baseLayer!==t).map(e=>e.visible$)).pipe((0,x.U)(e=>e.every(Boolean))).subscribe(e=>this.component.layersAreAllVisible=e)}ngOnDestroy(){this.layersOrResolutionChange$$.unsubscribe(),void 0!==this.layersVisibility$$&&(this.layersVisibility$$.unsubscribe(),this.layersVisibility$$=void 0)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(zp,2),r.Y36(Lc),r.Y36(de,8))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoLayerListBinding",""]]}),e})();function Wp(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-slide-toggle",6),r.NdJ("change",function(t){return r.CHM(e),r.oxw().toggleShowAllLegends(t.checked)}),r.ALo(1,"translate"),r._uU(2),r.ALo(3,"translate"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("matTooltip",r.lcZ(1,4,"igo.geo.layer.legend.showAll"))("checked",e.showAllLegendsValue)("labelPosition","before"),r.xp6(2),r.hij(" ",r.lcZ(3,6,"igo.geo.layer.legend.showAll")," ")}}function Xp(e,t){1&e&&r._UZ(0,"mat-divider")}function Kp(e,t){if(1&e&&r._UZ(0,"igo-layer-legend-item",8),2&e){const e=r.oxw().$implicit,t=r.oxw();r.Q6J("layer",e)("updateLegendOnResolutionChange",t.updateLegendOnResolutionChange)}}function ed(e,t){if(1&e&&r.YNc(0,Kp,1,2,"igo-layer-legend-item",7),2&e){const e=t.$implicit,o=r.oxw();r.Q6J("ngIf",!(o.excludeBaseLayers&&e.baseLayer))}}function td(e,t){1&e&&(r.TgZ(0,"p",9),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"igo.geo.layer.legend.noLayersVisibleWithShowAllButton")," "))}function od(e,t){1&e&&(r.TgZ(0,"p",9),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"igo.geo.layer.legend.noLayersVisibleWithShowAllButtonButZoom")," "))}function id(e,t){1&e&&(r.TgZ(0,"p",9),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"igo.geo.layer.legend.noLayersVisible")," "))}function rd(e,t){1&e&&(r.TgZ(0,"p",9),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"igo.geo.layer.legend.noLayersVisibleButZoom")," "))}let sd=(()=>{class e{constructor(){this.orderable=!0,this.hasVisibleOrInRangeLayers$=new C.X(!0),this.hasVisibleAndNotInRangeLayers$=new C.X(!0),this.layersInUi$=new C.X([]),this.layers$=new C.X([]),this.showAllLegend=!1,this.change$=new we.t(1),this.excludeBaseLayers=!1,this.updateLegendOnResolutionChange=!1,this.allowShowAllLegends=!1,this.showAllLegendsValue=!1,this.allLegendsShown=new r.vpe(!1)}set layers(e){this._layers=e,this.next()}get layers(){return this._layers}ngOnInit(){this.change$$=this.change$.pipe((0,wn.D)(()=>0===this.layers.length?fn.E:(0,yn.H)(50))).subscribe(()=>{const e=this.computeShownLayers(this.layers.slice(0));this.layers$.next(e),this.hasVisibleOrInRangeLayers$.next(this.layers.slice(0).filter(e=>!0!==e.baseLayer).filter(e=>e.visible$.value&&e.isInResolutionsRange$.value).length>0),this.hasVisibleAndNotInRangeLayers$.next(this.layers.slice(0).filter(e=>!0!==e.baseLayer).filter(e=>e.visible$.value&&!e.isInResolutionsRange$.value).length>0),this.layersInUi$.next(this.layers.slice(0).filter(e=>!(!1===e.showInLayerList||this.excludeBaseLayers&&e.baseLayer)))})}ngOnDestroy(){this.change$$.unsubscribe()}next(){this.change$.next()}computeShownLayers(e){let t=e.filter(e=>e.visible&&e.isInResolutionsRange);return this.showAllLegendsValue&&(t=e),this.sortLayersByZindex(t)}sortLayersByZindex(e){return e.sort((e,t)=>t.zIndex-e.zIndex)}toggleShowAllLegends(e){this.showAllLegendsValue=e,this.next(),this.allLegendsShown.emit(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-layer-legend-list"]],inputs:{layers:"layers",excludeBaseLayers:"excludeBaseLayers",updateLegendOnResolutionChange:"updateLegendOnResolutionChange",allowShowAllLegends:"allowShowAllLegends",showAllLegendsValue:"showAllLegendsValue"},outputs:{allLegendsShown:"allLegendsShown"},decls:24,vars:39,consts:[[1,"layer-legend-list-container"],["tooltip-position","above","matTooltipShowDelay","500","class","mat-typography",3,"matTooltip","checked","labelPosition","change",4,"ngIf"],[4,"ngIf"],[3,"navigation","selection"],["ngFor","",3,"ngForOf"],["class","layers-empty mat-typography",4,"ngIf"],["tooltip-position","above","matTooltipShowDelay","500",1,"mat-typography",3,"matTooltip","checked","labelPosition","change"],["igoListItem","",3,"layer","updateLegendOnResolutionChange",4,"ngIf"],["igoListItem","",3,"layer","updateLegendOnResolutionChange"],[1,"layers-empty","mat-typography"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.YNc(1,Wp,4,8,"mat-slide-toggle",1),r.ALo(2,"async"),r.YNc(3,Xp,1,0,"mat-divider",2),r.ALo(4,"async"),r.TgZ(5,"igo-list",3),r.YNc(6,ed,1,1,"ng-template",4),r.ALo(7,"async"),r.qZA(),r.YNc(8,td,3,3,"p",5),r.ALo(9,"async"),r.ALo(10,"async"),r.ALo(11,"async"),r.YNc(12,od,3,3,"p",5),r.ALo(13,"async"),r.ALo(14,"async"),r.ALo(15,"async"),r.YNc(16,id,3,3,"p",5),r.ALo(17,"async"),r.ALo(18,"async"),r.ALo(19,"async"),r.YNc(20,rd,3,3,"p",5),r.ALo(21,"async"),r.ALo(22,"async"),r.ALo(23,"async"),r.qZA()),2&e&&(r.xp6(1),r.Q6J("ngIf",r.lcZ(2,9,t.layersInUi$).length&&t.allowShowAllLegends),r.xp6(2),r.Q6J("ngIf",r.lcZ(4,11,t.layersInUi$).length&&t.allowShowAllLegends),r.xp6(2),r.Q6J("navigation",!1)("selection",!1),r.xp6(1),r.Q6J("ngForOf",r.lcZ(7,13,t.layers$)),r.xp6(2),r.Q6J("ngIf",!t.showAllLegendsValue&&r.lcZ(9,15,t.layersInUi$).length&&!r.lcZ(10,17,t.hasVisibleOrInRangeLayers$)&&!r.lcZ(11,19,t.hasVisibleAndNotInRangeLayers$)&&t.allowShowAllLegends),r.xp6(4),r.Q6J("ngIf",!t.showAllLegendsValue&&r.lcZ(13,21,t.layersInUi$).length&&!r.lcZ(14,23,t.hasVisibleOrInRangeLayers$)&&r.lcZ(15,25,t.hasVisibleAndNotInRangeLayers$)&&t.allowShowAllLegends),r.xp6(4),r.Q6J("ngIf",r.lcZ(17,27,t.layersInUi$).length&&!r.lcZ(18,29,t.hasVisibleOrInRangeLayers$)&&!r.lcZ(19,31,t.hasVisibleAndNotInRangeLayers$)&&!t.allowShowAllLegends),r.xp6(4),r.Q6J("ngIf",r.lcZ(21,33,t.layersInUi$).length&&!r.lcZ(22,35,t.hasVisibleOrInRangeLayers$)&&r.lcZ(23,37,t.hasVisibleAndNotInRangeLayers$)&&!t.allowShowAllLegends))},styles:["mat-slide-toggle[_ngcontent-%COMP%]{width:100%;margin:10px}mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content{width:calc(100% - 60px)}igo-list[_ngcontent-%COMP%]{display:contents}.layers-empty[_ngcontent-%COMP%]{text-align:justify;margin:10px}.layer-legend-list-container[_ngcontent-%COMP%]{max-height:100%;overflow:auto}"],changeDetection:0}),e})();function nd(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",1),r.NdJ("click",function(){return r.CHM(e),r.oxw().toggleTrackFeature()}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",2),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("matTooltip",r.lcZ(1,2,"igo.geo.layer.trackFeature"))("color",e.color)}}let ad=(()=>{class e{constructor(){this.trackFeature=!1,this.color="primary"}get options(){if(this.layer)return this.layer.options}ngOnInit(){this.color=this.trackFeature?"primary":"basic"}toggleTrackFeature(){this.trackFeature?(this.layer.disableTrackFeature(this.layer.options.trackFeature),this.color="basic"):(this.layer.enableTrackFeature(this.layer.options.trackFeature),this.color="primary"),this.trackFeature=!this.trackFeature}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-track-feature-button"]],inputs:{layer:"layer",trackFeature:"trackFeature"},decls:1,vars:1,consts:[["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click"],["svgIcon","crosshairs-gps"]],template:function(e,t){1&e&&r.YNc(0,nd,3,4,"button",0),2&e&&r.Q6J("ngIf",t.options.trackFeature)},directives:[h.O5,n.lW,p.gM,a.Hw],pipes:[U.X$],styles:[""],changeDetection:0}),e})(),ld=(()=>{class e{constructor(e){this.networkService=e,this.inResolutionRange$=new C.X(!0),this.updateLegendOnResolutionChange=!1}ngOnInit(){this.resolution$$=this.layer.map.viewController.resolution$.subscribe(()=>{this.onResolutionChange()}),this.tooltipText=this.computeTooltip(),this.network$$=this.networkService.currentState().subscribe(e=>{this.state=e,this.onResolutionChange()})}ngOnDestroy(){this.resolution$$.unsubscribe(),this.network$$.unsubscribe()}computeTooltip(){const e=this.layer.options;if(!e.tooltip)return this.layer.title;const t=e.tooltip,o=e.metadata;switch(e.tooltip.type){case Zl.TITLE:return this.layer.title;case Zl.ABSTRACT:return o&&o.abstract?o.abstract:this.layer.title;case Zl.CUSTOM:return t&&t.text?t.text:this.layer.title;default:return this.layer.title}}onResolutionChange(){this.inResolutionRange$.next(this.layer.isInResolutionsRange)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(be))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-layer-legend-item"]],inputs:{layer:"layer",updateLegendOnResolutionChange:"updateLegendOnResolutionChange"},decls:6,vars:4,consts:[[1,"igo-layer-list-item"],["matLine","","matTooltipShowDelay","500",1,"igo-layer-title",3,"matTooltip"],[1,"igo-layer-legend-container"],["legend",""],[3,"layer","updateLegendOnResolutionChange"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-list-item",0),r.TgZ(1,"h4",1),r._uU(2),r.qZA(),r.qZA(),r.TgZ(3,"div",2,3),r._UZ(5,"igo-layer-legend",4),r.qZA()),2&e&&(r.xp6(1),r.Q6J("matTooltip",t.tooltipText),r.xp6(1),r.Oqu(t.layer.title),r.xp6(3),r.Q6J("layer",t.layer)("updateLegendOnResolutionChange",t.updateLegendOnResolutionChange))},styles:["[_nghost-%COMP%]{overflow:hidden}.igo-layer-list-item[_ngcontent-%COMP%]{height:46px;clear:both}.igo-layer-legend-container[_ngcontent-%COMP%]{padding-left:18px;width:calc(100% - 18px)}"],changeDetection:0}),e})(),cd=(()=>{class e{static forRoot(){return{ngModule:e,providers:[yu,Yc,wp]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[Qe.c,Pe.lN,h.ez,ze.u5,Ga.t,f.Tx,a.Ps,n.ot,Qa.rP,_e.LD,p.AV,l.ie,za.KP,Be.g,m.p9,oe,$i,qo,bi,Ui,Mo]]}),e})();r.B6R(Fp,[l.Tg,h.O5,m.oG,l.Nh,$e.X2,p.gM,n.lW,a.Hw,Be.k,h.mk,ap],[U.X$,h.Ov]),r.B6R(ld,[l.Tg,$e.X2,p.gM,ap],[]),r.B6R(zp,[l.i$,h.O5,Hp,l.Tg,m.oG,Ga.d,_i,h.mk,h.sg,Fp,Ii,Ri,n.lW,p.gM,a.Hw,Be.k,f.p6,f.VK,za.pH,h.tP,ze.JJ,ze.On],[h.Ov,U.X$]),r.B6R(sd,[h.O5,Qa.Rr,p.gM,Ga.d,_i,h.sg,ld,Ii],[U.X$,h.Ov]);let ud=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,Be.g,n.ot,a.Ps,l.ie,p.AV,Mo,oe,$i,qo,wl,cd]]}),e})();function pd(e,t){if(1&e&&(r.TgZ(0,"mat-option",16),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("matTooltip",e.url)("value",e),r.xp6(1),r.hij(" ",e.url," ")}}function dd(e,t){if(1&e&&(r.TgZ(0,"mat-option",17),r.NdJ("click",function(e){return e.stopPropagation()}),r.TgZ(1,"p",18),r._uU(2),r.qZA(),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(2),r.Oqu(e)}}r.B6R(Qu,[_i,h.sg,h.O5,xp,dp,Ii],[h.Ov]);const hd=function(e,t){return{value:e,email:t}};function gd(e,t){if(1&e&&(r.TgZ(0,"span"),r.TgZ(1,"p",19),r._uU(2),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(2),r.Oqu(e.languageService.translate.instant("igo.geo.catalog.externalProvider.unavailableWithEmail",r.WLB(1,hd,e.addedCatalog.url,e.emailAddress)))}}const md=function(e){return{value:e}};function fd(e,t){if(1&e&&(r.TgZ(0,"span"),r.TgZ(1,"p",19),r._uU(2),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(2),r.Oqu(e.languageService.translate.instant("igo.geo.catalog.unavailable",r.VKq(1,md,e.addedCatalog.url)))}}let yd=(()=>{class e{constructor(e,t,o,i,r){this.formBuilder=e,this.languageService=t,this.configService=o,this.dialogRef=i,this.data=r,this.defaultAddedCatalogType="wms",this.predefinedCatalogsList$=new C.X([]),this.predefinedCatalogs=[],this.error=!1,this.store=r.store,this.predefinedCatalogs=r.predefinedCatalogs,this.error=r.error,this.addedCatalog=r.addedCatalog,this.form=this.formBuilder.group({id:["",[]],title:["",[]],url:["",[ze.kI.required]],type:[this.defaultAddedCatalogType,[ze.kI.required]]})}ngOnInit(){this.store.state.clear(),this.typeCapabilities=Object.keys(Fc),this.addedCatalogType$$=this.form.get("type").valueChanges.subscribe(e=>{"wmts"===e?this.form.get("title").setValidators(ze.kI.required):this.form.get("title").setValidators([]),this.form.get("title").updateValueAndValidity()}),this.computePredefinedCatalogList(),this.storeViewAll$$=this.store.view.all$().subscribe(()=>this.computePredefinedCatalogList()),this.emailAddress=this.configService.getConfig("emailAddress")}ngOnDestroy(){this.addedCatalogType$$.unsubscribe(),this.storeViewAll$$.unsubscribe()}changeUrl(e){this.form.patchValue(e),this.error=!1,this.computePredefinedCatalogList()}computePredefinedCatalogList(){this.predefinedCatalogsList$.next(this.predefinedCatalogs.filter(e=>!this.store.get(e.id)))}addCatalog(e){this.error=!1,this.dialogRef.close(e)}cancel(){this.error=!1,this.dialogRef.close()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ze.qu),r.Y36(ne),r.Y36(z),r.Y36(je.so),r.Y36(je.WI,8))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-add-catalog-dialog"]],decls:30,vars:21,consts:[["mat-dialog-title","",1,"mat-typography"],["mat-dialog-content","",1,"mat-typography"],[1,"igo-form",3,"formGroup"],[1,"igo-input-container"],["type","text","formControlName","url","placeholder","URL","matInput","",3,"matAutocomplete"],[3,"optionSelected"],["auto","matAutocomplete"],["matTooltipShowDelay","500",3,"matTooltip","value",4,"ngFor","ngForOf"],["matInput","","formControlName","title",3,"placeholder"],["formControlName","type","placeholder","Type"],[3,"value","click",4,"ngFor","ngForOf"],[4,"ngIf"],["mat-dialog-actions","",2,"justify-content","center"],[1,"igo-form-button-group","add-catalog-button-top-padding"],["mat-raised-button","","type","button",3,"click"],["id","addCatalogBtnDialog","mat-raised-button","","type","button","color","primary",3,"disabled","click"],["matTooltipShowDelay","500",3,"matTooltip","value"],[3,"value","click"],["mat-line",""],[1,"error"]],template:function(e,t){if(1&e&&(r.TgZ(0,"h1",0),r._uU(1),r.ALo(2,"translate"),r.qZA(),r.TgZ(3,"div",1),r.TgZ(4,"form",2),r.TgZ(5,"div",3),r.TgZ(6,"mat-form-field"),r._UZ(7,"input",4),r.TgZ(8,"mat-autocomplete",5,6),r.NdJ("optionSelected",function(e){return t.changeUrl(e.option.value)}),r.YNc(10,pd,2,3,"mat-option",7),r.ALo(11,"async"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(12,"div",3),r.TgZ(13,"mat-form-field"),r._UZ(14,"input",8),r.ALo(15,"translate"),r.qZA(),r.qZA(),r.TgZ(16,"div",3),r.TgZ(17,"mat-form-field"),r.TgZ(18,"mat-select",9),r.YNc(19,dd,3,2,"mat-option",10),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.YNc(20,gd,3,4,"span",11),r.YNc(21,fd,3,3,"span",11),r.qZA(),r.TgZ(22,"div",12),r.TgZ(23,"div",13),r.TgZ(24,"button",14),r.NdJ("click",function(){return t.cancel()}),r._uU(25),r.ALo(26,"translate"),r.qZA(),r.TgZ(27,"button",15),r.NdJ("click",function(){return t.addCatalog(t.form.value)}),r._uU(28),r.ALo(29,"translate"),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.MAs(9);r.xp6(1),r.Oqu(r.lcZ(2,11,"igo.geo.catalog.library.addTitle")),r.xp6(3),r.Q6J("formGroup",t.form),r.xp6(3),r.Q6J("matAutocomplete",e),r.xp6(3),r.Q6J("ngForOf",r.lcZ(11,13,t.predefinedCatalogsList$)),r.xp6(4),r.s9C("placeholder",r.lcZ(15,15,"igo.geo.printForm.title")),r.xp6(5),r.Q6J("ngForOf",t.typeCapabilities),r.xp6(1),r.Q6J("ngIf",t.error&&t.addedCatalog&&t.emailAddress),r.xp6(1),r.Q6J("ngIf",t.error&&t.addedCatalog&&!t.emailAddress),r.xp6(4),r.hij(" ",r.lcZ(26,17,"igo.geo.catalog.library.cancel")," "),r.xp6(2),r.Q6J("disabled",!t.form.valid),r.xp6(1),r.hij(" ",r.lcZ(29,19,"igo.geo.catalog.library.add")," ")}},directives:[je.uh,je.xY,ze._Y,ze.JL,ze.sg,Pe.KE,ze.Fj,Qe.Nt,Ya.ZL,ze.JJ,ze.u,Ya.XC,h.sg,_e.gD,h.O5,je.H8,n.lW,$e.ey,p.gM,$e.X2],pipes:[U.X$,h.Ov],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}.add-catalog-button-top-padding[_ngcontent-%COMP%]{padding-top:25px}.igo-form[_ngcontent-%COMP%]{padding:10px 5px 5px}.igo-form-button-group[_ngcontent-%COMP%]{text-align:center}button[_ngcontent-%COMP%]{cursor:pointer}button#addCatalogBtnDialog[disabled=true][_ngcontent-%COMP%]{cursor:default;background-color:#0000001f;color:#00000042}.error[_ngcontent-%COMP%]{color:red}"]}),e})();function vd(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-catalog-library-item",3),r.NdJ("catalogRemove",function(){const t=r.CHM(e).$implicit;return r.oxw().onCatalogRemove(t)})("select",function(){const t=r.CHM(e).$implicit;return r.oxw().onCatalogSelect(t)}),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw();r.Q6J("map",o.map)("catalog",e)}}function bd(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",4),r.TgZ(1,"button",5),r.NdJ("click",function(){return r.CHM(e),r.oxw().addCatalogDialog()}),r.ALo(2,"translate"),r._uU(3),r.ALo(4,"translate"),r._UZ(5,"mat-icon",6),r.qZA(),r.qZA()}2&e&&(r.xp6(1),r.Q6J("matTooltip",r.lcZ(2,2,"igo.geo.catalog.library.addBtn")),r.xp6(2),r.hij(" ",r.lcZ(4,4,"igo.geo.catalog.library.addBtn")," "))}let xd=(()=>{class e{constructor(e,t,o,i,s){this.capabilitiesService=e,this.messageService=t,this.languageService=o,this.storageService=i,this.dialog=s,this.addCatalogAllowed=!1,this.predefinedCatalogs=[],this.catalogSelectChange=new r.vpe,this.submitDisabled=!0}get addedCatalogs(){return this.storageService.get("addedCatalogs")||[]}set addedCatalogs(e){this.storageService.set("addedCatalogs",e)}ngOnInit(){this.store.state.clear(),this.predefinedCatalogs=this.predefinedCatalogs.map(e=>(e.id=Ps.V.hashStr((e.type||"wms")+$l(e.url)),e))}getCatalogs(){return this.store.view.all$()}onCatalogSelect(e){this.store.state.update(e,{selected:!0,focused:!0},!0),this.catalogSelectChange.emit({selected:!0,catalog:e})}unsubscribeAddingCatalog(){this.addingCatalog$$&&this.addingCatalog$$.unsubscribe()}addCatalog(e){if(!e)return;let t=Ps.V.hashStr(e.type+$l(e.url));const o=this.predefinedCatalogs.find(t=>t.id===e.id);if(o&&(e.version=o.version,e.externalProvider=o.externalProvider,t=o.id),this.store.get(t)){const e=this.languageService.translate.instant("igo.geo.catalog.library.inlist.title"),t=this.languageService.translate.instant("igo.geo.catalog.library.inlist.message");this.messageService.alert(t,e)}else this.unsubscribeAddingCatalog(),this.addingCatalog$$=this.capabilitiesService.getCapabilities(e.type,e.url,e.version).pipe((0,b.K)(t=>{const o=this.languageService.translate.instant("igo.geo.catalog.unavailableTitle");if(t.error)return this.addCatalogDialog(!0,e),t.error.caught=!0,t;const i=this.languageService.translate.instant("igo.geo.catalog.unavailable",{value:e.url});throw this.messageService.error(i,o),t})).subscribe(i=>{let r,s;switch(e.type){case"wms":r=e.title||i.Service.Title,s=e.version||i.version;break;case"arcgisrest":case"imagearcgisrest":case"tilearcgisrest":r=e.title||i.mapName;break;case"wmts":r=e.title||i.ServiceIdentification.ServiceType;break;default:r=e.title}const n=_.removeUndefined(Object.assign({},o,_.removeUndefined({id:t,title:r,url:e.url,type:e.type||"wms",externalProvider:e.externalProvider||!1,removable:!0,version:s})));this.store.insert(n);const a=this.addedCatalogs.slice(0);a.push(n),this.addedCatalogs=a,this.unsubscribeAddingCatalog()})}ngOnDestroy(){this.unsubscribeAddingCatalog()}onCatalogRemove(e){this.store.delete(e),this.addedCatalogs=this.addedCatalogs.slice(0).filter(t=>t.id!==e.id)}addCatalogDialog(e,t){this.dialog.open(yd,{width:"700px",data:{predefinedCatalogs:this.predefinedCatalogs,store:this.store,error:e,addedCatalog:t}}).afterClosed().subscribe(e=>{this.addCatalog(e)})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Oc),r.Y36(le),r.Y36(ne),r.Y36(ve),r.Y36(je.uw))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-catalog-library"]],inputs:{store:"store",map:"map",addCatalogAllowed:"addCatalogAllowed",predefinedCatalogs:"predefinedCatalogs"},outputs:{catalogSelectChange:"catalogSelectChange"},decls:4,vars:5,consts:[[3,"navigation"],["ngFor","",3,"ngForOf"],["class","btnAddCatalog",4,"ngIf"],["igoListItem","","color","accent",3,"map","catalog","catalogRemove","select"],[1,"btnAddCatalog"],["mat-raised-button","","matTooltipPosition","above","color","primary",3,"matTooltip","click"],["svgIcon","earth-plus"]],template:function(e,t){1&e&&(r.TgZ(0,"igo-list",0),r.YNc(1,vd,1,2,"ng-template",1),r.ALo(2,"async"),r.qZA(),r.YNc(3,bd,6,6,"div",2)),2&e&&(r.Q6J("navigation",!1),r.xp6(1),r.Q6J("ngForOf",r.lcZ(2,3,t.getCatalogs())),r.xp6(2),r.Q6J("ngIf",t.addCatalogAllowed))},styles:["igo-list[_ngcontent-%COMP%]{height:auto}.btnAddCatalog[_ngcontent-%COMP%]{justify-content:center;display:flex;margin:30px 0}"],changeDetection:0}),e})();function wd(e,t){1&e&&(r.TgZ(0,"mat-icon",4),r.NdJ("click",function(e){return e.stopPropagation()}),r.ALo(1,"translate"),r.qZA()),2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.catalog.externalProvider.catalog"))}function Sd(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",5),r.NdJ("click",function(t){return r.CHM(e),r.oxw().removeCatalogFromLibrary(t)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",6),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.catalog.library.remove"))}function Cd(e,t){1&e&&(r.TgZ(0,"button",7),r._UZ(1,"mat-icon",8),r.qZA())}let Td=(()=>{class e{constructor(){this.catalogRemove=new r.vpe}get title(){return rt(this.catalog)}removeCatalogFromLibrary(e){e.stopPropagation(),this.catalogRemove.emit()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-catalog-library-item"]],inputs:{catalog:"catalog",map:"map"},outputs:{catalogRemove:"catalogRemove"},decls:6,vars:4,consts:[["mat-line",""],["class","igo-external-provider","tooltip-position","below","matTooltipShowDelay","500","color","primary","svgIcon","earth-arrow-right",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip","click",4,"ngIf"],["class","igo-blank","disabled","true","mat-icon-button","",4,"ngIf"],["tooltip-position","below","matTooltipShowDelay","500","color","primary","svgIcon","earth-arrow-right",1,"igo-external-provider",3,"matTooltip","click"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip","click"],["svgIcon","delete"],["disabled","true","mat-icon-button","",1,"igo-blank"],["svgIcon","blank"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-list-item"),r.TgZ(1,"h4",0),r._uU(2),r.qZA(),r.YNc(3,wd,2,3,"mat-icon",1),r.YNc(4,Sd,3,3,"button",2),r.YNc(5,Cd,2,0,"button",3),r.qZA()),2&e&&(r.xp6(2),r.hij(" ",t.title," "),r.xp6(1),r.Q6J("ngIf",t.catalog.externalProvider),r.xp6(1),r.Q6J("ngIf",t.catalog.removable),r.xp6(1),r.Q6J("ngIf",!t.catalog.removable))},directives:[l.Tg,$e.X2,h.O5,a.Hw,p.gM,n.lW],pipes:[U.X$],styles:[".igo-blank[_ngcontent-%COMP%]{cursor:pointer}.igo-external-provider[_ngcontent-%COMP%]{cursor:help}"],changeDetection:0}),e})(),Ad=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,a.Ps,Be.g,l.ie,p.AV,$i,oe,n.ot,Pe.lN,ze.UX,Qe.c,_e.LD,Ya.Bb,je.Is]]}),e})();r.B6R(xd,[_i,h.sg,Td,Ii,h.O5,n.lW,p.gM,a.Hw],[h.Ov,U.X$]);let Zd=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,Be.g,a.Ps,l.ie,p.AV,Mo,$i,qo],ud,Ad]}),e})(),Ld=(()=>{class e{transform(e,t){let o;return"time"===t&&(o=e.filter(e=>{const t=e.dataSource;return this.isTimeFilterable(t)&&void 0!==t.options.timeFilter&&Object.keys(t.options.timeFilter).length})),"ogc"===t&&(o=e.filter(e=>this.isOgcFilterable(e.dataSource))),o}isTimeFilterable(e){return"wms"===e.options.type&&e.options.timeFilterable}isOgcFilterable(e){let t=!1;return e.options.ogcFilters&&e.options.ogcFilters.enabled&&e.options.ogcFilters.editable&&(t=!0),e.options.ogcFilters&&e.options.ogcFilters.enabled&&(e.options.ogcFilters.pushButtons||e.options.ogcFilters.checkboxes||e.options.ogcFilters.radioButtons||e.options.ogcFilters.select)&&(t=!0),t}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=r.Yjl({name:"filterableDataSource",type:e,pure:!0}),e})(),Fd=(()=>{class e{constructor(){}filterByDate(e,t){let o,i,r,s;if(Array.isArray(t)){const i=[];t[0]&&(r=this.reformatDateTime(t[0]),i.push(t[0])),t[1]&&(s=this.reformatDateTime(t[1]),i.push(t[1])),2===i.length&&r!==s&&(o=e instanceof xc?r+","+s:r+"/"+s),r===s&&(o=r)}else t&&(i=this.reformatDateTime(t),o=i);e.ol.updateParams({TIME:o}),e instanceof Xl&&e.setTimeFilter(e.timeFilter,!0)}filterByYear(e,t){let o,i,r;if(Array.isArray(t)){const s=[];t[0]&&(i=t[0],s.push(t[0])),t[1]&&(r=t[1],s.push(t[1])),2===s.length&&i!==r&&(o=e instanceof xc?i+","+r:i+"/"+r),i===r&&(o=i)}else o=t;e.ol.updateParams({TIME:o}),e instanceof Xl&&e.setTimeFilter(e.timeFilter,!0)}reformatDateTime(e){const t=e.getFullYear();let o=e.getMonth()+1,i=e.getUTCDate(),r=e.getUTCHours(),s=e.getUTCMinutes();return Number(o)<10&&(o="0"+o),Number(i)<10&&(i="0"+i),Number(r)<10&&(r="0"+r),Number(s)<10&&(s="0"+s),t+"-"+o+"-"+i+"T"+r+":"+s+":00Z"}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})(),Od=(()=>{class e{constructor(){}filterByOgc(e,t){const o=(new Ul).formatProcessedOgcFilter(t,e.options.params.LAYERS);e.ol.updateParams({FILTER:o})}setOgcWFSFiltersOptions(e){const t=e.options,o=new Ul;t.ogcFilters.enabled&&t.ogcFilters.filters&&(t.ogcFilters.filters=o.checkIgoFiltersProperties(t.ogcFilters.filters,t.paramsWFS.fieldNameGeometry,new ta.Z({code:t.paramsWFS.srsName}),!0),t.ogcFilters.interfaceOgcFilters||(t.ogcFilters.interfaceOgcFilters=o.defineInterfaceFilterSequence(t.ogcFilters.filters,t.paramsWFS.fieldNameGeometry)))}setOgcWMSFiltersOptions(e){const t=e.options,o=new Ul;t.ogcFilters.enabled&&t.ogcFilters.filters?(t.ogcFilters.filters=o.checkIgoFiltersProperties(t.ogcFilters.filters,t.fieldNameGeometry,void 0,!0),t.ogcFilters.interfaceOgcFilters||(t.ogcFilters.interfaceOgcFilters=o.defineInterfaceFilterSequence(t.ogcFilters.filters,t.fieldNameGeometry)),this.filterByOgc(e,o.buildFilter(t.ogcFilters.filters,void 0,void 0,void 0,e.options)),t.filtered=!0):(t.ogcFilters.filters=void 0,t.ogcFilters.interfaceOgcFilters=[],t.filtered=!1)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})();var Md=(()=>{return(e=Md||(Md={})).Predefined="Predefined",e.Polygon="Polygon",e.Point="Point",Md;var e})(),Id=(()=>{return(e=Id||(Id={})).Address="Address",e.Thematics="Thematics",Id;var e})();let kd=(()=>{class e{constructor(e,t,o){this.http=e,this.languageService=t,this.configService=o,this.baseUrl="https://geoegl.msp.gouv.qc.ca/apis/terrapi/",this.urlFilterList={AdmRegion:"regadmin",Arrond:"arrondissements",CircFed:"circ-fed",CircProv:"circ-prov",DirReg:"dir-reg",MRC:"mrc",Mun:"municipalites",RegTour:"tourisme",bornes:"bornes-sumi",hydro:"hydro",routes:"routes"},this.baseUrl=this.configService.getConfig("spatialFilter.url")||this.baseUrl}getKeyByValue(e,t){return Object.keys(e).find(o=>e[o]===t)}loadFilterList(e){if(e)return this.http.get(this.baseUrl+this.urlFilterList[e]).pipe((0,x.U)(e=>e.features.map(e=>(e.meta={id:e.properties.code},e))))}loadThematicsList(){const e=[];return this.http.get(this.baseUrl+"types").pipe((0,x.U)(t=>(t.forEach(t=>{if(t.startsWith("lieux")){const i={name:void 0,source:t};let r=t.substring(6,t.length),s=r;if(r.includes(".")){const e=r.indexOf(".");s=r.substring(e+1,r.length),r=r.substring(0,e)}try{i.name=this.languageService.translate.instant("igo.geo.terrapi."+s)}catch(o){i.name=s.substring(0,1).toUpperCase()+s.substring(1,s.length-1)}try{i.group=this.languageService.translate.instant("igo.geo.spatialFilter.group."+r)}catch(o){i.group=r.substring(0,1).toUpperCase()+r.substring(1,s.length-1)}e.push(i)}else if(this.getKeyByValue(this.urlFilterList,t)){const o={name:void 0,source:t},r=this.getKeyByValue(this.urlFilterList,t);try{o.name=this.languageService.translate.instant("igo.geo.terrapi."+r)}catch(i){o.name=r.substring(0,1).toUpperCase()+r.substring(1,r.length-1)}o.source=t,e.push(o)}}),e)))}loadFilterItem(e,t,o,i,r){if(o){const s=this.baseUrl+this.urlFilterList[o];let n="";return t===Id.Address?(n="adresses",this.http.get(s+"/"+e.properties.code+"/"+n,{params:{geometry:"true",icon:"true",bufferInput:r.toString(),simplified:"100"}}).pipe((0,x.U)(e=>e.features.map(e=>(e.meta={id:e.properties.code,title:this.languageService.translate.instant("igo.geo.spatialFilter.Address"),icon:e.icon},e))))):(n=i.source,this.http.get(s+"/"+e.properties.code+"/"+n,{params:{geometry:"true",icon:"true",bufferInput:r.toString(),simplified:"100"}}).pipe((0,x.U)(e=>e.features.map(e=>(e.meta={id:e.properties.code,title:i.name,icon:e.icon},e)))))}{const o=this.baseUrl+"locate";return t===Id.Address?this.http.post(o+"?type=adresses",{geometry:"true",icon:"true",loc:JSON.stringify(e),bufferInput:r.toString(),simplified:"100"}).pipe((0,x.U)(e=>e.features.map(e=>(e.meta={id:e.properties.code,title:this.languageService.translate.instant("igo.geo.spatialFilter.Address"),icon:e.icon},e)))):this.http.post(o+"?type="+i.source,{geometry:"true",icon:"true",loc:JSON.stringify(e),bufferInput:r.toString(),simplified:"100"}).pipe((0,x.U)(e=>e.features.map(e=>(e.meta={id:e.properties.code,title:i.name,icon:e.icon},e))))}}loadItemById(e,t){const o=this.urlFilterList[t],i="/"+e.properties.code;if(o&&i)return this.http.get(this.baseUrl+o+i,{params:{geometry:"true"}}).pipe((0,x.U)(e=>(e.meta={id:e.properties.code,alias:e.properties.nom,title:e.properties.nom},e)))}loadBufferGeometry(e,t,o,i){if(t!==Md.Predefined)return this.http.post(this.baseUrl+"geospatial/buffer?",{buffer:o,loc:JSON.stringify(e)}).pipe((0,x.U)(e=>e));{const t=this.urlFilterList[i],r="/"+e.properties.code;if(t&&r)return this.http.get(this.baseUrl+t+r,{params:{geometry:"100",bufferOutput:o.toString()}}).pipe((0,x.U)(e=>(e.meta={id:e.properties.code,alias:e.properties.nom,title:e.properties.nom},e)))}}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(ne),r.LFG(z))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Pd=(()=>{class e{constructor(e,t){this.messageService=e,this.languageService=t}open(e){const t=this.languageService.translate,o=t.instant("igo.geo.download.title");this.messageService.success(t.instant("igo.geo.download.start"),o);const i=e.dataSource.options;if(Object.keys(i.download).length>0)if(i.download.dynamicUrl&&void 0===i.download.url){let t,o=new ta.Z({code:e.map.projection});const r=e.dataSource.options.paramsWFS;r&&Object.keys(r).length>0?(o=r.srsName?new ta.Z({code:r.srsName}):o,t=e.dataSource.options.paramsWFS):t=e.dataSource.options.params;const s=Fn.$A(e.map.viewController.getExtent(),new ta.Z({code:e.map.projection}),o),n=void 0===t.outputFormatDownload?void 0===t.outputFormat?"":"outputformat="+t.outputFormat:"outputformat="+t.outputFormatDownload,a=i.download.dynamicUrl.replace(/&?outputformat=[^&]*/gi,"").replace(/&?filter=[^&]*/gi,"").replace(/&?bbox=[^&]*/gi,""),l=e.dataSource.options.ogcFilters;let c;c=(new Ul).handleOgcFiltersAppliedValue(e.dataSource.options,l.geometryName,s,o),c=c?"filter="+encodeURIComponent(c):(new Ul).buildFilter(void 0,s,o,l.geometryName),window.open(`${a}&${c}&${n}`,"_blank")}else i.download&&window.open(i.download.url,"_blank")}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(le),r.LFG(ne))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function _d(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",1),r.NdJ("click",function(){r.CHM(e);const t=r.oxw();return t.openDownload(t.layer)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",2),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("matTooltip",r.lcZ(1,2,"igo.geo.download.action"))("color",e.color)}}let $d=(()=>{class e{constructor(e){this.downloadService=e,this._color="primary"}get layer(){return this._layer}set layer(e){this._layer=e}get color(){return this._color}set color(e){this._color=e}openDownload(e){this.downloadService.open(e)}get options(){if(this.layer)return this.layer.dataSource.options}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Pd))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-download-button"]],inputs:{layer:"layer",color:"color"},decls:1,vars:1,consts:[["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click"],["svgIcon","download"]],template:function(e,t){1&e&&r.YNc(0,_d,3,4,"button",0),2&e&&r.Q6J("ngIf",t.options&&t.options.download&&(t.options.download.dynamicUrl||t.options.download.url))},directives:[h.O5,n.lW,p.gM,a.Hw],pipes:[U.X$],styles:[""],changeDetection:0}),e})(),qd=(()=>{class e{static forRoot(){return{ngModule:e}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,a.Ps,n.ot,p.AV,oe]]}),e})();function Dd(e,t){if(1&e&&(r.TgZ(0,"td"),r._UZ(1,"mat-icon",7),r.qZA()),2&e){const e=r.oxw(3);r.xp6(1),r.s9C("svgIcon",e.icon)}}function Ed(e,t){if(1&e&&(r.TgZ(0,"td"),r.TgZ(1,"a",8),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.qZA()),2&e){const e=r.oxw().$implicit,t=r.oxw(2);r.xp6(1),r.s9C("href",e.value,r.LSH),r.xp6(1),r.AsE(" ",r.lcZ(3,3,"igo.geo.targetHtmlUrl")," ",t.title,"")}}function Rd(e,t){if(1&e&&(r.TgZ(0,"td",9),r._uU(1),r.qZA()),2&e){const e=r.oxw().$implicit;r.xp6(1),r.hij(" ",e.key," ")}}function Ud(e,t){if(1&e&&r._UZ(0,"td",10),2&e){const e=r.oxw().$implicit;r.Q6J("innerHTML",e.value,r.oJD)}}function Nd(e,t){if(1&e&&(r._UZ(0,"img",13),r.ALo(1,"async"),r.ALo(2,"secureImage")),2&e){const e=r.oxw(2).$implicit;r.s9C("src",r.lcZ(1,1,r.lcZ(2,3,e.value)),r.LSH)}}function Jd(e,t){1&e&&(r.TgZ(0,"span"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij("",r.lcZ(2,1,"igo.geo.targetHtmlUrl")," "))}function Bd(e,t){if(1&e&&(r.TgZ(0,"td"),r.TgZ(1,"a",8),r.YNc(2,Nd,3,5,"img",11),r.YNc(3,Jd,3,3,"ng-template",null,12,r.W1O),r.qZA(),r.qZA()),2&e){const e=r.MAs(4),t=r.oxw().$implicit,o=r.oxw(2);r.xp6(1),r.s9C("href",t.value,r.LSH),r.xp6(1),r.Q6J("ngIf",o.isImg(t.value))("ngIfElse",e)}}function jd(e,t){if(1&e&&(r._UZ(0,"td",10),r.ALo(1,"json")),2&e){const e=r.oxw().$implicit;r.Q6J("innerHTML",r.lcZ(1,1,e.value),r.oJD)}}function Gd(e,t){if(1&e&&(r.TgZ(0,"tr"),r.YNc(1,Dd,2,1,"td",4),r.YNc(2,Ed,4,5,"td",4),r.YNc(3,Rd,2,1,"td",5),r.YNc(4,Ud,1,1,"td",6),r.YNc(5,Bd,5,3,"td",4),r.YNc(6,jd,2,3,"td",6),r.qZA()),2&e){const e=t.$implicit,o=r.oxw(2);r.xp6(1),r.Q6J("ngIf","_blank"===o.feature.properties.target&&"url"===e.key),r.xp6(1),r.Q6J("ngIf","_blank"===o.feature.properties.target&&"url"===e.key),r.xp6(1),r.Q6J("ngIf",void 0===o.feature.properties.target),r.xp6(1),r.Q6J("ngIf",void 0===o.feature.properties.target&&!o.isObject(e.value)&&!o.isUrl(e.value)),r.xp6(1),r.Q6J("ngIf",void 0===o.feature.properties.target&&!o.isObject(e.value)&&o.isUrl(e.value)),r.xp6(1),r.Q6J("ngIf",void 0===o.feature.properties.target&&o.isObject(e.value))}}function Qd(e,t){if(1&e&&(r.TgZ(0,"table",2),r.TgZ(1,"tbody"),r.YNc(2,Gd,7,6,"tr",3),r.ALo(3,"keyvalue"),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(2),r.Q6J("ngForOf",r.lcZ(3,1,e.filterFeatureProperties(e.feature)))}}function zd(e,t){if(1&e&&r._UZ(0,"iframe",14),2&e){const e=r.oxw();r.Q6J("srcdoc",e.htmlSanitizer(e.feature.properties),r.oJD)("src",e.urlSanitizer(e.feature.properties.url),r.uOi)}}let Yd=(()=>{class e{constructor(e,t,o){this.cdRef=e,this.sanitizer=t,this.networkService=o,this.unsubscribe$=new O.xQ,this.ready=!1,this.routeEvent=new r.vpe,this.selectFeature=new r.vpe,this.htmlDisplayEvent=new r.vpe,this.networkService.currentState().pipe((0,Me.R)(this.unsubscribe$)).subscribe(e=>{this.state=e})}get source(){return this._source}set source(e){this._source=e,this.cdRef.detectChanges()}get feature(){return this._feature}set feature(e){this._feature=e,this.cdRef.detectChanges(),this.selectFeature.emit()}get title(){return rt(this.feature)}get icon(){return st(this.feature)||"link"}ngOnInit(){this.ready=!0}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}urlSanitizer(e){return this.sanitizer.bypassSecurityTrustResourceUrl(e)}isHtmlDisplay(){return this.feature&&this.isObject(this.feature.properties)&&"iframe"===this.feature.properties.target?(this.htmlDisplayEvent.emit(!0),!0):(this.htmlDisplayEvent.emit(!1),!1)}htmlSanitizer(e){if(e.body&&"Internet Explorer"!==k.getBrowserName()){if(!/<base href="[\w:\/\.]+">/.test(e.body)){const t=new URL(e.url,window.location.origin);e.body=e.body.replace("<head>",`<head><base href="${t.origin}">`)}return this.sanitizer.bypassSecurityTrustHtml(e.body)}}isObject(e){return"object"==typeof e}isUrl(e){return"string"==typeof e&&("https://"===e.slice(0,8)||"http://"===e.slice(0,7))}isImg(e){return!!this.isUrl(e)&&["jpg","png","gif"].includes(e.split(".").pop().toLowerCase())}filterFeatureProperties(e){const t=e.meta?e.meta.alias:void 0,o={};let i;return this.map&&this.map.offlineButtonToggle$.pipe((0,Me.R)(this.unsubscribe$)).subscribe(e=>{i=e}),e.properties&&e.properties.Route&&this.toolbox&&!this.toolbox.getTool("directions")&&delete e.properties.Route,t?(Object.keys(t).forEach(i=>{o[t[i]]=e.properties[i]}),o):(void 0!==i&&i?e.meta&&e.meta.excludeAttributeOffline&&e.meta.excludeAttributeOffline.forEach(t=>{delete e.properties[t]}):this.state.connection&&e.meta&&e.meta.excludeAttribute?e.meta.excludeAttribute.forEach(t=>{delete e.properties[t]}):!this.state.connection&&e.meta&&e.meta.excludeAttributeOffline&&e.meta.excludeAttributeOffline.forEach(t=>{delete e.properties[t]}),e.properties)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.sBO),r.Y36(i.H7),r.Y36(be))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-feature-details"]],inputs:{source:"source",map:"map",toolbox:"toolbox",feature:"feature"},outputs:{routeEvent:"routeEvent",selectFeature:"selectFeature",htmlDisplayEvent:"htmlDisplayEvent"},decls:2,vars:2,consts:[["class","igo-striped mat-typography",4,"ngIf"],[3,"srcdoc","src",4,"ngIf"],[1,"igo-striped","mat-typography"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","keyValue",4,"ngIf"],[3,"innerHTML",4,"ngIf"],["mat-list-avatar","",3,"svgIcon"],["target","_blank","rel","noopener noreferrer",3,"href"],["id","keyValue"],[3,"innerHTML"],["width","225","heigth","auto",3,"src",4,"ngIf","ngIfElse"],["notImg",""],["width","225","heigth","auto",3,"src"],[3,"srcdoc","src"]],template:function(e,t){1&e&&(r.YNc(0,Qd,4,3,"table",0),r.YNc(1,zd,1,2,"iframe",1)),2&e&&(r.Q6J("ngIf",t.ready&&t.feature&&t.isObject(t.feature.properties)&&"iframe"!==t.feature.properties.target),r.xp6(1),r.Q6J("ngIf",t.isHtmlDisplay()))},directives:[h.O5,h.sg,a.Hw],pipes:[Oi,U.X$,h.Ov,xt,h.Ts],styles:["table[_ngcontent-%COMP%]{width:100%}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px}#keyValue[_ngcontent-%COMP%]{width:30%}table[_ngcontent-%COMP%]     .routing{cursor:pointer}iframe[_ngcontent-%COMP%]{height:calc(100% - 4px);width:100%;border:0}"],changeDetection:0}),e})();var Hd=(()=>{return(e=Hd||(Hd={})).Point="Point",e.LineString="LineString",e.Polygon="Polygon",e.Circle="Circle",Hd;var e})();function Vd(e){return new Jn.Z({stroke:new Nn.Z({color:(e=e||[0,153,255]).concat([1]),width:2}),fill:new Rn.Z({color:e.concat([.2])}),radius:8})}function Wd(){return new Dn.ZP({stroke:new Nn.Z({color:[0,153,255,1],width:2})})}function Xd(e){const t=e.target;return t instanceof Gn.ZP?t.getFlatCoordinates().slice(-4,-2):t.getFlatCoordinates().slice(-2)}Error;class Kd{constructor(e){this.options=e,this.start$=new O.xQ,this.end$=new O.xQ,this.changes$=new O.xQ,this.modify$=new O.xQ,this.select$=new O.xQ,this.freehand$=new C.X(!1),this.olDrawingLayer=e.drawingLayer?e.drawingLayer:this.createOlInnerOverlayLayer(),this.olGeometryType=this.options.geometryType}get active(){return void 0!==this.olMap}get olDrawingLayerSource(){return this.olDrawingLayer.getSource()}setOlMap(e,t){if(!e)return this.clearOlInnerOverlaySource(),this.removeOlInnerOverlayLayer(),this.removeOlInteractions(),void(this.olMap=e);this.olMap=e,this.addOlInnerOverlayLayer(),this.addOlInteractions(t)}getSource(){return this.olDrawingLayerSource}setGeometryType(e){this.olGeometryType=e}createOlInnerOverlayLayer(){return new Hn.Z({source:this.options.drawingLayerSource?this.options.drawingLayerSource:new wa.Z,style:this.options.drawingLayerStyle,zIndex:500})}removeOlInnerOverlayLayer(){!this.options.drawingLayer&&this.olMap&&this.olMap.removeLayer(this.olDrawingLayer)}addOlInnerOverlayLayer(){this.options.drawingLayer||this.olMap.addLayer(this.olDrawingLayer)}clearOlInnerOverlaySource(){!this.options.drawingLayer&&!this.options.drawingLayerSource&&this.olDrawingLayerSource.clear(!0)}addOlInteractions(e){let t;if(t=this.freehand$.getValue()?new Wa.ZP("Point"===this.olGeometryType?{type:"Circle",source:this.getSource(),maxPoints:this.options.maxPoints,freehand:!0}:{type:this.olGeometryType,source:this.getSource(),maxPoints:this.options.maxPoints,freehand:!0}):new Wa.ZP({type:this.olGeometryType,source:this.getSource(),stopClick:!0,style:this.options.interactionStyle,maxPoints:this.options.maxPoints,freehand:!1,freehandCondition:()=>!1}),this.olMap.addInteraction(t),this.olDrawInteraction=t,this.onDrawStartKey=t.on("drawstart",e=>this.onDrawStart(e)),this.onDrawEndKey=t.on("drawend",e=>this.onDrawEnd(e)),e){const e=new Xa.Z({source:this.getSource()});if(this.olMap.addInteraction(e),this.olModifyInteraction=e,!this.olSelectInteraction){const e=new In.Z({condition:Ka.OK,style:void 0});this.olMap.addInteraction(e),this.olSelectInteraction=e,this.olSelectInteraction.on("select",e=>this.onSelect(e))}}}removeOlInteractions(){this.unsubscribeKeyDown(),(0,Vn.B)([this.onDrawStartKey,this.onDrawEndKey,this.onDrawKey]),this.olMap&&(this.olMap.removeInteraction(this.olDrawInteraction),this.olMap.removeInteraction(this.olModifyInteraction)),this.olDrawInteraction=void 0,this.olModifyInteraction=void 0}onDrawStart(e){const t=e.feature.getGeometry();this.start$.next(t),this.clearOlInnerOverlaySource(),this.onDrawKey=t.on("change",e=>{this.mousePosition=Xd(e),this.changes$.next(e.target)}),this.subscribeKeyDown()}onDrawEnd(e){this.unsubscribeKeyDown(),(0,Vn.B)(this.onDrawKey);const t=e.feature.getGeometry();t.on("change",()=>{this.modify$.next(t)}),this.end$.next(t)}onSelect(e){1===e.selected.length&&this.select$.next(e.selected[0])}subscribeKeyDown(){this.unsubscribeKeyDown(),this.keyDown$$=(0,L.R)(document,"keydown").subscribe(e=>{"Escape"!==e.key?("Backspace"===e.key&&this.olDrawInteraction.removeLastPoint(),"Enter"===e.key&&this.olDrawInteraction.finishDrawing()," "!==e.key||this.olMap.getView().animate({center:this.mousePosition,duration:100})):this.olDrawInteraction.abortDrawing()})}unsubscribeKeyDown(){this.keyDown$$&&(this.keyDown$$.unsubscribe(),this.keyDown$$=void 0)}}let eh=(()=>{class e{constructor(e,t){this.dialogRef=e,this.data=t}noLabel(){this.dialogRef.close()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(je.so),r.Y36(je.WI))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-draw-popup-component"]],decls:14,vars:10,consts:[["mat-dialog-content",""],[1,"mat-typography"],[1,"example-full-width"],["matInput","",3,"placeholder"],["input",""],["mat-dialog-actions",""],["mat-raised-button","",3,"click"],["mat-raised-button","","color","primary",3,"mat-dialog-close"]],template:function(e,t){if(1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"p",1),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"mat-form-field",2),r._UZ(5,"input",3,4),r.ALo(7,"translate"),r.qZA(),r.qZA(),r.TgZ(8,"div",5),r.TgZ(9,"button",6),r.NdJ("click",function(){return t.noLabel()}),r._uU(10),r.ALo(11,"translate"),r.qZA(),r.TgZ(12,"button",7),r._uU(13,"OK "),r.qZA(),r.qZA()),2&e){const e=r.MAs(6);r.xp6(2),r.Oqu(r.lcZ(3,4,"igo.geo.draw.dialogInstruction")),r.xp6(3),r.s9C("placeholder",r.lcZ(7,6,"igo.geo.draw.dialogTitle")),r.xp6(5),r.hij("",r.lcZ(11,8,"igo.geo.draw.noLabel")," "),r.xp6(2),r.Q6J("mat-dialog-close",e.value)}},directives:[je.xY,Pe.KE,Qe.Nt,je.H8,n.lW,je.ZT],pipes:[U.X$],styles:[""]}),e})(),th=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-draw-shorcuts"]],decls:24,vars:12,consts:[[1,"shortcut","mat-typography"],["svgIcon","keyboard-return",1,"shortcut-icon"],["svgIcon","backspace-outline",1,"shortcut-icon"],["svgIcon","keyboard-esc",1,"shortcut-icon"],["svgIcon","keyboard-space",1,"shortcut-icon"],[1,"shortcuts-close"],["mat-raised-button","","mat-dialog-close","","color","primary"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-dialog-content"),r.TgZ(1,"div"),r.TgZ(2,"span",0),r._UZ(3,"mat-icon",1),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.qZA(),r.TgZ(6,"div"),r.TgZ(7,"span",0),r._UZ(8,"mat-icon",2),r._uU(9),r.ALo(10,"translate"),r.qZA(),r.qZA(),r.TgZ(11,"div"),r.TgZ(12,"span",0),r._UZ(13,"mat-icon",3),r._uU(14),r.ALo(15,"translate"),r.qZA(),r.qZA(),r.TgZ(16,"div"),r.TgZ(17,"span",0),r._UZ(18,"mat-icon",4),r._uU(19),r.ALo(20,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(21,"mat-dialog-actions",5),r.TgZ(22,"button",6),r._uU(23,"OK"),r.qZA(),r.qZA()),2&e&&(r.xp6(4),r.Oqu(r.lcZ(5,4,"igo.geo.draw.finish")),r.xp6(5),r.Oqu(r.lcZ(10,6,"igo.geo.draw.undo")),r.xp6(5),r.Oqu(r.lcZ(15,8,"igo.geo.draw.abort")),r.xp6(5),r.Oqu(r.lcZ(20,10,"igo.geo.draw.move")))},directives:[je.xY,a.Hw,je.H8,n.lW,je.ZT],pipes:[U.X$],styles:[".shortcut[_ngcontent-%COMP%]{display:flex;align-items:center}.shortcut-icon[_ngcontent-%COMP%]{margin-right:10px}.shortcuts-close[_ngcontent-%COMP%]{display:flex;justify-content:center}"]}),e})();var oh=(()=>{return(e=oh||(oh={})).Length="length",e.Area="area",oh;var e})(),ih=(()=>{return(e=ih||(ih={})).Meters="meters",e.Kilometers="kilometers",e.Miles="miles",e.Feet="feet",ih;var e})();const rh={[ih.Meters]:"m",[ih.Kilometers]:"km",[ih.Miles]:"mi",[ih.Feet]:"ft"};var sh=(()=>{return(e=sh||(sh={})).SquareMeters="squareMeters",e.SquareKilometers="squareKilometers",e.SquareMiles="squareMiles",e.SquareFeet="squareFeet",e.Hectares="hectares",e.Acres="acres",sh;var e})();const nh={[sh.SquareMeters]:"m\xb2",[sh.SquareKilometers]:"km\xb2",[sh.SquareMiles]:"mi\xb2",[sh.SquareFeet]:"ft\xb2",[sh.Hectares]:"ha",[sh.Acres]:"ac"};function ah(e){return.001*e}function lh(e){return 3.2808*e}function ch(e){return 621e-6*e}function uh(e){return 1e-6*e}function ph(e){return 3.861e-7*e}function dh(e){return 10.764*e}function hh(e){return 1e-4*e}function gh(e){return 24711e-8*e}function mh(e,t){const o=new Map([[ih.Meters,e=>e],[ih.Kilometers,ah],[ih.Miles,ch],[ih.Feet,lh]]).get(t);return o?o(e):void 0}function fh(e,t){const o=new Map([[sh.SquareMeters,e=>e],[sh.SquareKilometers,uh],[sh.SquareMiles,ph],[sh.SquareFeet,dh],[sh.Hectares,hh],[sh.Acres,gh]]).get(t);return o?o(e):void 0}function yh(e,t,o){let i=t.decimal;(void 0===i||i<0)&&(i=1);const r=[];return r.push(void 0!==t.locale?e.toLocaleString(t.locale,{minimumFractionDigits:i,maximumFractionDigits:i}):e.toFixed(i).toString()),void 0!==t.unit&&!0===t.unitAbbr&&r.push(o?o.translate.instant(rh[t.unit]?"igo.geo.measure."+rh[t.unit]:"igo.geo.measure."+nh[t.unit]):rh[t.unit]||nh[t.unit]),r.filter(e=>void 0!==e).join(" ")}function vh(){return new Dn.ZP({stroke:new Nn.Z({color:"#ffcc33",lineDash:[10,10],width:2}),fill:new Rn.Z({color:"rgba(255, 255, 255, 0.2)"}),image:new Jn.Z({radius:5,stroke:new Nn.Z({color:"#ffcc33"}),fill:new Rn.Z({color:"rgba(255, 255, 255, 0.2)"})})})}function bh(e,t){if(!(e instanceof Qn.Z)&&0!==e.getFlatCoordinates().length)return(0,el.xA)(e,{projection:t})}function xh(e,t){const o=bh(e,t),i=function(e,t){if(!(e instanceof Qn.Z||e instanceof zn.Z)&&0!==e.getFlatCoordinates().length)return(0,el.bg)(e,{projection:t})}(e,t),r=[],s=e.getFlatCoordinates(),n=s.length;for(let a=0;a<=n-4;a+=2){const e=new zn.Z([[s[a],s[a+1]],[s[a+2],s[a+3]]]);r.push(bh(e,t))}return{area:i,length:o,lengths:r}}function wh(e){let t;if(e instanceof Qn.Z){const o=new Qn.Z(e.getFlatCoordinates());t=new Array(1),t[0]=o}else{t=Sh(e);const o=e.getFlatCoordinates(),i=t.length;for(let e=0;e<i;e++){const i=2*e,r=new zn.Z([[o[i],o[i+1]],[o[i+2],o[i+3]]]).getCoordinateAt(.5),s=t[e];void 0!==s?s.setCoordinates(r):t[e]=new Qn.Z(r)}}return t}function Sh(e){let t;t=e instanceof Pn.Z?0:Math.max(e.getFlatCoordinates().length/2-1,0);let o=e.get("_midpoints");if(void 0===o)return o=new Array(e instanceof Qn.Z?1:t),e.set("_midpoints",o,!0),o;if(0===t||t===o.length)return o;if(t>o.length)return o.push(...new Array(t-o.length)),o;for(let i=t;i<o.length;i++){const e=o[t];void 0!==e&&Ch(e)}return o.splice(t),o}function Ch(e){const t=e.get("_tooltip");if(void 0!==t){const e=t.getMap();void 0!==e&&e.removeOverlay(t)}}function Th(e){const t=[].concat(function(e){return Sh(e).map(e=>e?e.get("_tooltip"):void 0)}(e)||[]),o=function(e){const t=e.get("_center");return t?t.get("_tooltip"):void 0}(e);return void 0!==o&&t.push(o),t}function Ah(e,t=!1,o=""){const i=new tl.Z({element:document.createElement("div"),offset:[-30,-10],className:(t?["igo-map-tooltip","igo-map-tooltip-measure","igo-map-tooltip-measure-area"]:["igo-map-tooltip","igo-map-tooltip-measure",`igo-map-tooltip-measure-${o}segments`]).join(" "),stopEvent:!1});return i.setPosition(e.getFlatCoordinates()),e.set("_tooltip",i),i}function Zh(e,t,o,i){return new Dn.ZP({stroke:new Nn.Z({color:t||"rgba(143,7,7,1)",width:o||1}),fill:new Rn.Z({color:e||"rgba(255,255,255,0.4)"}),image:new Jn.Z({radius:5,stroke:new Nn.Z({color:t||"rgba(143,7,7,1)",width:o||1}),fill:new Rn.Z({color:e||"rgba(255,255,255,0.4)"})})})}let Lh=(()=>{class e{constructor(e){this.mapService=e,this.fillColor="rgba(255,255,255,0.4)",this.strokeColor="rgba(143,7,7,1)",this.strokeWidth=1,this.labelsAreShown=!0}getFillColor(){return this.fillColor}setFillColor(e){this.fillColor=e}getStrokeColor(){return this.strokeColor}setStrokeColor(e){this.strokeColor=e}getStrokeWidth(){return this.strokeWidth}getLabelsAreShown(){return this.labelsAreShown}toggleLabelsAreShown(){this.labelsAreShown=!this.labelsAreShown}setIcon(e){this.icon=e}getIcon(){return this.icon}createDrawingLayerStyle(e,t,o,i){let r,s=!1;const n=this.mapService.getMap().projection;if(e.getGeometry()instanceof Qn.Z&&(s=!s),e.get("rad")){const i=(0,Fn.vs)(e.getGeometry().flatCoordinates,n,"EPSG:4326");return r=new Dn.ZP({text:new En.Z({text:o?e.get("draw"):"",stroke:new Nn.Z({color:"white",width:.75}),fill:new Rn.Z({color:"black"}),font:"20px sans-serif",overflow:!0}),image:new Jn.Z({radius:e.get("rad")/Math.cos(Math.PI/180*i[1])/t,stroke:new Nn.Z({color:this.strokeColor,width:this.strokeWidth}),fill:new Rn.Z({color:this.fillColor})})}),r}return i?(r=new Dn.ZP({text:new En.Z({text:o?e.get("draw"):"",offsetY:-26,stroke:new Nn.Z({color:"white",width:.75}),fill:new Rn.Z({color:"black"}),font:"20px sans-serif",overflow:!0}),stroke:new Nn.Z({color:this.strokeColor,width:this.strokeWidth}),fill:new Rn.Z({color:this.fillColor}),image:new Un.Z({src:i})}),r):(r=new Dn.ZP({text:new En.Z({text:o?e.get("draw"):"",stroke:new Nn.Z({color:"white",width:.75}),fill:new Rn.Z({color:"black"}),font:"20px sans-serif",overflow:!0,offsetY:s?-15:0}),stroke:new Nn.Z({color:this.strokeColor,width:this.strokeWidth}),fill:new Rn.Z({color:this.fillColor}),image:new Jn.Z({radius:5,stroke:new Nn.Z({color:this.strokeColor,width:this.strokeWidth}),fill:new Rn.Z({color:this.fillColor})})}),r)}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(Lc))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Fh=(()=>{class e{constructor(e){this.config=e,this.getIconsList()}getIcons(){return this.icons}getPath(){return this.config.getConfig("drawingTool.icons")||[]}getIconsList(){this.icons=this.getPath()}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(z))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Oh(e,t){if(1&e&&(r.TgZ(0,"div",24),r._UZ(1,"img",25),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.s9C("src",e.icon,r.LSH)}}function Mh(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-option",26),r.NdJ("click",function(){const t=r.CHM(e).$implicit;return r.oxw(2).onIconChange(t)}),r.TgZ(1,"div",24),r._UZ(2,"img",25),r.qZA(),r.qZA()}if(2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(2),r.s9C("src",e,r.LSH)}}function Ih(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-form-field"),r.TgZ(1,"mat-label"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"mat-select"),r.TgZ(5,"mat-select-trigger"),r.YNc(6,Oh,2,1,"div",21),r.qZA(),r.TgZ(7,"mat-option",22),r.NdJ("click",function(){return r.CHM(e),r.oxw().onIconChange()}),r._uU(8),r.ALo(9,"translate"),r.qZA(),r.YNc(10,Mh,3,2,"mat-option",23),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(2),r.Oqu(r.lcZ(3,4,"igo.geo.draw.icon")),r.xp6(4),r.Q6J("ngIf",e.icon),r.xp6(2),r.Oqu(r.lcZ(9,6,"igo.geo.draw.noIcon")),r.xp6(2),r.Q6J("ngForOf",e.icons)}}function kh(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",27),r.NdJ("click",function(){return r.CHM(e),r.oxw().deleteDrawings()}),r.ALo(1,"translate"),r.ALo(2,"async"),r._UZ(3,"mat-icon",28),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("matTooltip",r.lcZ(1,2,"igo.geo.draw.delete"))("disabled",0===r.lcZ(2,4,e.selectedFeatures$).length)}}let Ph=(()=>{class e{constructor(e,t,o,i,r){this.languageService=e,this.formBuilder=t,this.drawStyleService=o,this.dialog=i,this.drawIconService=r,this.tableTemplate={selection:!0,selectMany:!0,selectionCheckbox:!0,sort:!0,columns:[{name:"Drawing",title:this.languageService.translate.instant("igo.geo.draw.labels"),valueAccessor:e=>e.properties.draw}]},this.geometryType=Hd,this.draw$=new C.X({}),this.olDrawingLayerSource=new wa.Z,this.selectedFeatures$=new C.X([]),this.drawControlIsDisabled=!0,this.drawControlIsActive=!1,this.subscriptions$$=[],this.position="bottom",this.buildForm(),this.fillColor=this.drawStyleService.getFillColor(),this.strokeColor=this.drawStyleService.getStrokeColor(),this.strokeWidth=this.drawStyleService.getStrokeWidth(),this.labelsAreShown=this.drawStyleService.getLabelsAreShown(),this.icons=this.drawIconService.getIcons(),this.icon=this.drawStyleService.getIcon()}ngOnInit(){this.initStore(),this.drawControl=this.createDrawControl(this.fillColor,this.strokeColor,this.strokeWidth)}ngOnDestroy(){this.drawControl.setOlMap(void 0),this.subscriptions$$.map(e=>e.unsubscribe())}createDrawControl(e,t,o){return new Kd({geometryType:void 0,drawingLayerSource:this.olDrawingLayerSource,drawingLayerStyle:new Dn.ZP({}),interactionStyle:Zh(e,t,o)})}onGeometryTypeChange(e){this.drawControl.setGeometryType(e),this.toggleDrawControl()}initStore(){this.map.removeLayer(this.olDrawingLayer),this.olDrawingLayer=new uc({id:"igo-draw-layer",title:this.languageService.translate.instant("igo.geo.draw.drawing"),zIndex:200,source:new tc,style:(e,t)=>this.drawStyleService.createDrawingLayerStyle(e,t,this.labelsAreShown,this.icon),showInLayerList:!0,exportable:!0,browsable:!1,workspace:{enabled:!1}}),Dc(this.store,this.olDrawingLayer),Gc(this.store,new Nc({motion:Cl.None})),Qc(this.store,new jc({map:this.map,motion:Cl.None,many:!0})),this.store.layer.visible=!0,this.store.source.ol.on("removefeature",e=>{const t=e.feature.getGeometry();this.clearLabelsOfOlGeometry(t)}),this.subscriptions$$.push(this.store.stateView.manyBy$(e=>!0===e.state.selected).pipe((0,Ae.T)(1)).subscribe(e=>{this.selectedFeatures$.next(e.map(e=>e.entity))})),this.subscriptions$$.push(this.store.count$.subscribe(e=>{this.store.layer.options.showInLayerList=e>=1}))}onColorChange(e,t){this.fillForm=this.fillColor,this.strokeForm=this.strokeColor,this.drawStyleService.setFillColor(this.fillColor),this.drawStyleService.setStrokeColor(this.strokeColor),t?(this.store.layer.ol.setStyle((t,o)=>this.drawStyleService.createDrawingLayerStyle(t,o,e,this.icon)),this.icon=void 0):this.store.layer.ol.setStyle((t,o)=>this.drawStyleService.createDrawingLayerStyle(t,o,e)),this.createDrawControl()}onToggleDrawControl(e){e?this.toggleDrawControl():this.deactivateDrawControl()}toggleDrawControl(){this.deactivateDrawControl(),this.activateDrawControl()}openDialog(e,t){setTimeout(()=>{this.dialog.open(eh,{disableClose:!1}).afterClosed().subscribe(o=>{this.updateLabelOfOlGeometry(e,o),t?this.onDrawEnd(e):this.onSelectDraw(e,o)})},250)}activateDrawControl(){this.drawControlIsDisabled=!1,this.drawControlIsActive=!0,this.drawEnd$$=this.drawControl.end$.subscribe(e=>{this.openDialog(e,!0)}),this.drawControl.modify$.subscribe(e=>{this.onModifyDraw(e)}),this.drawSelect$$||(this.drawSelect$$=this.drawControl.select$.subscribe(e=>{this.openDialog(e,!1)})),this.drawControl.setOlMap(this.map.ol,!0)}deactivateDrawControl(){!this.drawControl||(this.drawEnd$$&&this.drawEnd$$.unsubscribe(),this.drawControl.setOlMap(void 0),this.drawControlIsActive=!1)}onDrawEnd(e,t){this.addFeatureToStore(e,t),this.clearLabelsOfOlGeometry(e),this.store.layer.ol.getSource().refresh()}onModifyDraw(e){this.store.all().forEach(t=>{t.properties.id===e.ol_uid&&(this.updateLabelOfOlGeometry(e,t.properties.draw),this.replaceFeatureInStore(t,e))})}onSelectDraw(e,t){const o=this.store.all(),i=e.getGeometry();i.ol_uid=e.get("id");const r=JSON.stringify(i.getCoordinates()[0]);o.forEach(e=>{const o=JSON.stringify(e.geometry.coordinates[0]);if(r===o){const o=e.properties.rad?e.properties.rad:void 0;this.updateLabelOfOlGeometry(i,t),this.replaceFeatureInStore(e,i,o)}})}addFeatureToStore(e,t,o){let i,r,s,n,a;const l=o?o.properties.id:e.ol_uid,c=this.map.ol.getView().getProjection(),u=(new Yn.Z).writeGeometryObject(e,{featureProjection:c,dataProjection:c});if(e instanceof Pn.Z||t)if(t)i=t;else{u.type="Point",u.coordinates=e.getCenter();const t=(0,Fn.vs)([e.getFlatCoordinates()[2],e.getFlatCoordinates()[3]],c,"EPSG:4326");r=(0,Fn.vs)([e.getFlatCoordinates()[0],e.getFlatCoordinates()[1]],c,"EPSG:4326"),n=r[0],a=r[1],i=(0,el.Sp)(r,t)}e instanceof Qn.Z&&(s=(0,Fn.vs)(e.getFlatCoordinates(),c,"EPSG:4326"),n=s[0],a=s[1]),this.store.update({type:Sl,geometry:u,projection:c.getCode(),properties:{id:l,draw:e.get("_label"),longitude:n||null,latitude:a||null,rad:i||null},meta:{id:l}})}replaceFeatureInStore(e,t,o){this.store.delete(e),this.onDrawEnd(t,o)}buildForm(){this.form=this.formBuilder.group({fill:[""],stroke:[""]})}deleteDrawings(){this.store.deleteMany(this.selectedFeatures$.value),this.selectedFeatures$.value.forEach(e=>{this.olDrawingLayerSource.getFeatures().forEach(t=>{const o=t.getGeometry();e.properties.id===o.ol_uid&&this.olDrawingLayerSource.removeFeature(t)})})}clearLabelsOfOlGeometry(e){Th(e).forEach(e=>{e&&e.getMap()&&this.map.ol.removeOverlay(e)})}onToggleLabels(){this.drawStyleService.toggleLabelsAreShown(),this.labelsAreShown=!this.labelsAreShown,this.onColorChange(this.labelsAreShown,!!this.icon)}updateLabelOfOlGeometry(e,t){e.setProperties({_label:t},!0)}onIconChange(e){this.icon=e,this.drawStyleService.setIcon(this.icon),this.store.layer.ol.setStyle((e,t)=>this.drawStyleService.createDrawingLayerStyle(e,t,!0,this.icon))}openShorcutsDialog(){this.dialog.open(th)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ne),r.Y36(ze.qu),r.Y36(Lh),r.Y36(je.uw),r.Y36(Fh))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-draw"]],inputs:{map:"map",store:"store"},outputs:{fillColor:"fillColor",strokeColor:"strokeColor",strokeWidth:"strokeWidth"},decls:55,vars:77,consts:[[1,"geometry-type-toggle","mat-typography"],[3,"change"],[3,"value"],[1,"draw-options","mat-typography"],[3,"disabled","checked","labelPosition","change"],[3,"checked","labelPosition","change"],[1,"igo-form",3,"formGroup"],[1,"fill-color-picker","mat-typography"],["svgIcon","square",1,"stroke-palette-icon"],["appearance","outline","floatLabel","always","tooltip-position","below","matTooltipShowDelay","500",1,"fill-field",3,"matTooltip"],["formControlName","fill","matInput","","type","text",3,"colorPicker","readonly","cpWidth","cpOutputFormat","cpPosition","cpPositionOffset","cpCancelButton","cpCancelButtonText","cpOKButton","colorPickerChange"],[1,"stroke-color-picker","mat-typography"],["svgIcon","square-outline",1,"stroke-palette-icon"],["appearance","outline","floatLabel","always","tooltip-position","below","matTooltipShowDelay","500",1,"stroke-field",3,"matTooltip"],["formControlName","stroke","matInput","","type","text",3,"colorPicker","readonly","cpWidth","cpPosition","cpPositionOffset","cpOutputFormat","cpCancelButton","cpCancelButtonText","cpOKButton","colorPickerChange"],[4,"ngIf"],["class","deleteBtn","mat-icon-button","","color","warn","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","disabled","click",4,"ngIf"],[1,"table-compact",3,"store","template"],["table",""],["mat-icon-button","","color","accent","disableRipple","true",3,"click"],["svgIcon","keyboard-outline","tooltip-position","below","matTooltipShowDelay","500",1,"shortcuts-icon",3,"matTooltip"],["class","box",4,"ngIf"],["value","",3,"click"],[3,"value","click",4,"ngFor","ngForOf"],[1,"box"],[3,"src"],[3,"value","click"],["mat-icon-button","","color","warn","tooltip-position","below","matTooltipShowDelay","500",1,"deleteBtn",3,"matTooltip","disabled","click"],["svgIcon","delete"]],template:function(e,t){1&e&&(r.TgZ(0,"div"),r.TgZ(1,"div",0),r.TgZ(2,"mat-button-toggle-group",1),r.NdJ("change",function(e){return t.onGeometryTypeChange(e.value)}),r.TgZ(3,"mat-button-toggle",2),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.TgZ(6,"mat-button-toggle",2),r._uU(7),r.ALo(8,"translate"),r.qZA(),r.TgZ(9,"mat-button-toggle",2),r._uU(10),r.ALo(11,"translate"),r.qZA(),r.TgZ(12,"mat-button-toggle",2),r._uU(13),r.ALo(14,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(15,"div",3),r.TgZ(16,"mat-slide-toggle",4),r.NdJ("change",function(e){return t.onToggleDrawControl(e.checked)}),r._uU(17),r.ALo(18,"translate"),r.qZA(),r.TgZ(19,"mat-slide-toggle",5),r.NdJ("change",function(){return t.onToggleLabels()}),r._uU(20),r.ALo(21,"translate"),r.qZA(),r.qZA(),r.TgZ(22,"form",6),r.TgZ(23,"div",7),r.TgZ(24,"span"),r._UZ(25,"mat-icon",8),r._uU(26),r.ALo(27,"translate"),r.qZA(),r.TgZ(28,"mat-form-field",9),r.ALo(29,"translate"),r.TgZ(30,"mat-label"),r._uU(31),r.qZA(),r.TgZ(32,"input",10),r.NdJ("colorPickerChange",function(e){return t.fillColor=e})("colorPickerChange",function(){return t.onColorChange(t.labelsAreShown,!1)}),r.ALo(33,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(34,"div",11),r.TgZ(35,"span"),r._UZ(36,"mat-icon",12),r._uU(37),r.ALo(38,"translate"),r.qZA(),r.TgZ(39,"mat-form-field",13),r.ALo(40,"translate"),r.TgZ(41,"mat-label"),r._uU(42),r.qZA(),r.TgZ(43,"input",14),r.NdJ("colorPickerChange",function(e){return t.strokeColor=e})("colorPickerChange",function(){return t.onColorChange(t.labelsAreShown,!1)}),r.ALo(44,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(45,"div"),r.YNc(46,Ih,11,8,"mat-form-field",15),r.qZA(),r.qZA(),r._UZ(47,"mat-divider"),r.TgZ(48,"div"),r.YNc(49,kh,4,6,"button",16),r._UZ(50,"igo-entity-table",17,18),r.qZA(),r.TgZ(52,"button",19),r.NdJ("click",function(){return t.openShorcutsDialog()}),r._UZ(53,"mat-icon",20),r.ALo(54,"translate"),r.qZA(),r.qZA()),2&e&&(r.xp6(3),r.Q6J("value",t.geometryType.Point),r.xp6(1),r.hij(" ",r.lcZ(5,51,"igo.geo.draw."+t.geometryType.Point)," "),r.xp6(2),r.Q6J("value",t.geometryType.LineString),r.xp6(1),r.hij(" ",r.lcZ(8,53,"igo.geo.draw."+t.geometryType.LineString)," "),r.xp6(2),r.Q6J("value",t.geometryType.Polygon),r.xp6(1),r.hij(" ",r.lcZ(11,55,"igo.geo.draw."+t.geometryType.Polygon)," "),r.xp6(2),r.Q6J("value",t.geometryType.Circle),r.xp6(1),r.hij(" ",r.lcZ(14,57,"igo.geo.draw."+t.geometryType.Circle)," "),r.xp6(3),r.Q6J("disabled",t.drawControlIsDisabled)("checked",t.drawControlIsActive)("labelPosition","before"),r.xp6(1),r.hij(" ",r.lcZ(18,59,"igo.geo.spatialFilter.drawControl")," "),r.xp6(2),r.Q6J("checked",t.labelsAreShown)("labelPosition","before"),r.xp6(1),r.hij(" ",r.lcZ(21,61,"igo.geo.draw.toggleMapTooltips")," "),r.xp6(2),r.Q6J("formGroup",t.form),r.xp6(4),r.hij(" ",r.lcZ(27,63,"igo.geo.draw.fill")," "),r.xp6(2),r.Q6J("matTooltip",r.lcZ(29,65,"igo.geo.draw.colorPicker")),r.xp6(3),r.Oqu(t.fillColor),r.xp6(1),r.Udp("background",t.fillColor),r.Q6J("colorPicker",t.fillColor)("readonly",!0)("colorPicker",t.fillColor)("cpWidth","200px")("cpOutputFormat","rgba")("cpPosition","bottom")("cpPositionOffset","-75%")("cpCancelButton",!0)("cpCancelButtonText",r.lcZ(33,67,"igo.geo.draw.cancelColorPicker"))("cpOKButton",!0),r.xp6(5),r.hij(" ",r.lcZ(38,69,"igo.geo.draw.stroke")," "),r.xp6(2),r.Q6J("matTooltip",r.lcZ(40,71,"igo.geo.draw.colorPicker")),r.xp6(3),r.Oqu(t.strokeColor),r.xp6(1),r.Udp("background",t.strokeColor),r.Q6J("colorPicker",t.strokeColor)("readonly",!0)("colorPicker",t.strokeColor)("cpWidth","200px")("cpPosition","bottom")("cpPositionOffset","-75%")("cpOutputFormat","rgba")("cpCancelButton",!0)("cpCancelButtonText",r.lcZ(44,73,"igo.geo.draw.cancelColorPicker"))("cpOKButton",!0),r.xp6(3),r.Q6J("ngIf",t.icons.length>=1),r.xp6(3),r.Q6J("ngIf",t.store.count$.getValue()>0),r.xp6(1),r.Q6J("store",t.store)("template",t.tableTemplate),r.xp6(3),r.Q6J("matTooltip",r.lcZ(54,75,"igo.geo.draw.shortcuts")))},directives:[Ha.A9,Ha.Yi,Qa.Rr,ze._Y,ze.JL,ze.sg,a.Hw,Pe.KE,p.gM,Pe.hX,ze.Fj,Qe.Nt,ze.JJ,ze.u,Va.Kk,h.O5,Ga.d,no,n.lW,_e.gD,_e.$L,$e.ey,h.sg],pipes:[U.X$,h.Ov],styles:[".geometry-type-toggle[_ngcontent-%COMP%]{padding:10px;text-align:center}.geometry-type-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]{width:100%}.geometry-type-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]{width:25%}.draw-options[_ngcontent-%COMP%]{overflow-x:hidden}.draw-options[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{width:100%;margin:10px}.draw-options[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content{width:calc(100% - 60px)}.igo-form[_ngcontent-%COMP%]{padding:10px}.fill-field[_ngcontent-%COMP%], .stroke-field[_ngcontent-%COMP%]{width:130px}.fill-color-picker[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{position:relative;top:7px}.fill-color-picker[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{left:8px}.stroke-color-picker[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{position:relative;top:7px}.stroke-color-picker[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{left:35px}.box[_ngcontent-%COMP%]{width:25px;height:25px}img[_ngcontent-%COMP%]{width:100%;height:100%}.deleteBtn[_ngcontent-%COMP%]{margin-left:12px}"],changeDetection:0}),e})(),_h=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[ze.u5,ze.UX,h.ez,n.ot,Ha.vV,Ga.t,Pe.lN,a.Ps,p.AV,Pe.lN,Qe.c,l.ie,_e.LD,Qa.rP,je.Is,oe,xi,Va.e4]]}),e})(),$h=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,a.Ps,oe,Mi,bi]]}),e})(),qh=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,mi],mi]}),e})(),Dh=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[],imports:[[h.ez],$h,qh]}),e})();class Eh{constructor(e){this.options=e,this.start$=new O.xQ,this.end$=new O.xQ,this.changes$=new O.xQ,this.olModifyInteractionIsActive=!1,this.olTranslateInteractionIsActive=!1,this.olDrawInteractionIsActive=!1,this.removedOlInteractions=[],this.modify=!0,this.translate=!0,void 0!==e.modify&&(this.modify=e.modify),void 0!==e.translate&&(this.translate=e.translate),this.olOverlayLayer=void 0!==e.layer?e.layer:this.createOlInnerOverlayLayer(),this.olLinearRingsLayer=this.createOlLinearRingsLayer()}get active(){return void 0!==this.olMap}get olOverlaySource(){return this.olOverlayLayer.getSource()}get olLinearRingsSource(){return this.olLinearRingsLayer.getSource()}setOlMap(e){if(void 0===e)return this.clearOlInnerOverlaySource(),this.removeOlInnerOverlayLayer(),this.removeOlModifyInteraction(),this.removeOlTranslateInteraction(),this.removeOlDrawInteraction(),void(this.olMap=e);this.olMap=e,this.addOlInnerOverlayLayer(),!0===this.modify&&this.addOlDrawInteraction(),!0===this.translate&&(this.addOlTranslateInteraction(),this.activateTranslateInteraction()),!0===this.modify&&(this.addOlModifyInteraction(),this.activateModifyInteraction())}getSource(){return this.olOverlaySource}setOlGeometry(e){const t=new Tn.Z({geometry:e});this.olOverlaySource.clear(),this.olOverlaySource.addFeature(t)}createOlInnerOverlayLayer(){return new Hn.Z({source:this.options.source?this.options.source:new wa.Z,style:this.options.layerStyle,zIndex:500})}addOlInnerOverlayLayer(){void 0===this.options.layer&&this.olMap.addLayer(this.olOverlayLayer)}removeOlInnerOverlayLayer(){void 0===this.options.layer&&void 0!==this.olMap&&this.olMap.removeLayer(this.olOverlayLayer)}clearOlInnerOverlaySource(){void 0===this.options.layer&&void 0===this.options.source&&this.olOverlaySource.clear(!0)}createOlLinearRingsLayer(){return new Hn.Z({source:new wa.Z,style:Wd(),zIndex:500})}addOlLinearRingsLayer(){this.olMap.addLayer(this.olLinearRingsLayer)}removeOlLinearRingsLayer(){this.olMap.removeLayer(this.olLinearRingsLayer)}clearOlLinearRingsSource(){this.olLinearRingsSource.clear(!0)}addOlModifyInteraction(){const e=new Xa.Z({source:this.olOverlaySource,style:this.options.drawStyle});this.olModifyInteraction=e}removeOlModifyInteraction(){void 0!==this.olModifyInteraction&&(this.deactivateModifyInteraction(),this.olModifyInteraction=void 0)}activateModifyInteraction(){!0!==this.olModifyInteractionIsActive&&(this.olModifyInteractionIsActive=!0,this.onModifyStartKey=this.olModifyInteraction.on("modifystart",e=>this.onModifyStart(e)),this.onModifyEndKey=this.olModifyInteraction.on("modifyend",e=>this.onModifyEnd(e)),this.olMap.addInteraction(this.olModifyInteraction))}deactivateModifyInteraction(){!1!==this.olModifyInteractionIsActive&&(this.olModifyInteractionIsActive=!1,(0,Vn.B)([this.onModifyStartKey,this.onModifyEndKey,this.onModifyKey]),void 0!==this.olMap&&this.olMap.removeInteraction(this.olModifyInteraction))}onModifyStart(e){const t=e.features.item(0).getGeometry();this.start$.next(t),this.onModifyKey=t.on("change",e=>{this.mousePosition=Xd(e),this.changes$.next(e.target)}),this.subscribeToKeyDown()}onModifyEnd(e){(0,Vn.B)(this.onModifyKey),this.end$.next(e.features.item(0).getGeometry()),this.unsubscribeToKeyDown()}subscribeToKeyDown(){this.keyDown$$=(0,L.R)(document,"keydown").subscribe(e=>{" "!==e.key||this.olMap.getView().animate({center:this.mousePosition,duration:0})})}unsubscribeToKeyDown(){void 0!==this.keyDown$$&&this.keyDown$$.unsubscribe()}addOlTranslateInteraction(){const e=new kn.Z({layers:[this.olOverlayLayer]});this.olTranslateInteraction=e}removeOlTranslateInteraction(){void 0!==this.olTranslateInteraction&&(this.deactivateTranslateInteraction(),this.olTranslateInteraction=void 0)}activateTranslateInteraction(){!0!==this.olTranslateInteractionIsActive&&(this.olTranslateInteractionIsActive=!0,this.onTranslateStartKey=this.olTranslateInteraction.on("translatestart",e=>this.onTranslateStart(e)),this.onTranslateEndKey=this.olTranslateInteraction.on("translateend",e=>this.onTranslateEnd(e)),this.olMap.addInteraction(this.olTranslateInteraction))}deactivateTranslateInteraction(){!1!==this.olTranslateInteractionIsActive&&(this.olTranslateInteractionIsActive=!1,(0,Vn.B)([this.onTranslateStartKey,this.onTranslateEndKey,this.onTranslateKey]),void 0!==this.olMap&&this.olMap.removeInteraction(this.olTranslateInteraction))}onTranslateStart(e){const t=e.features.item(0).getGeometry();this.start$.next(t),this.onTranslateKey=t.on("change",e=>{})}onTranslateEnd(e){(0,Vn.B)(this.onTranslateKey),this.end$.next(e.features.item(0).getGeometry())}addOlDrawInteraction(){const e=new Wa.ZP({type:"Polygon",source:this.olLinearRingsSource,stopClick:!0,style:Wd(),condition:e=>(this.olOuterGeometry||this.getOlGeometry()).intersectsCoordinate(e.coordinate)});this.olDrawInteraction=e,this.subscribeToDrawKeyDown()}subscribeToDrawKeyDown(){this.drawKeyDown$$=(0,L.R)(document,"keydown").subscribe(e=>{if("Control"!==e.key)return;this.unsubscribeToDrawKeyDown();const t=this.getOlGeometry();!t||!(t instanceof Gn.ZP)||(this.subscribeToDrawKeyUp(),this.deactivateModifyInteraction(),this.deactivateTranslateInteraction(),this.activateDrawInteraction())})}subscribeToDrawKeyUp(){this.drawKeyUp$$=(0,L.R)(document,"keyup").subscribe(e=>{"Control"===e.key&&(this.unsubscribeToDrawKeyUp(),this.unsubscribeToKeyDown(),this.deactivateDrawInteraction(),this.activateModifyInteraction(),!0===this.translate&&this.activateTranslateInteraction(),this.subscribeToDrawKeyDown(),this.olOuterGeometry=void 0,this.clearOlLinearRingsSource(),this.end$.next(this.getOlGeometry()))})}unsubscribeToDrawKeyDown(){void 0!==this.drawKeyDown$$&&this.drawKeyDown$$.unsubscribe()}unsubscribeToDrawKeyUp(){void 0!==this.drawKeyUp$$&&this.drawKeyUp$$.unsubscribe()}removeOlDrawInteraction(){void 0!==this.olDrawInteraction&&(this.unsubscribeToKeyDown(),this.unsubscribeToDrawKeyUp(),this.unsubscribeToDrawKeyDown(),this.deactivateDrawInteraction(),this.clearOlLinearRingsSource(),this.olDrawInteraction=void 0)}activateDrawInteraction(){!0!==this.olDrawInteractionIsActive&&(this.clearOlLinearRingsSource(),this.addOlLinearRingsLayer(),this.olMap.getInteractions().forEach(e=>{e instanceof $a.Z&&(this.olMap.removeInteraction(e),this.removedOlInteractions.push(e))}),this.olDrawInteractionIsActive=!0,this.onDrawStartKey=this.olDrawInteraction.on("drawstart",e=>this.onDrawStart(e)),this.onDrawEndKey=this.olDrawInteraction.on("drawend",e=>this.onDrawEnd(e)),this.olMap.addInteraction(this.olDrawInteraction))}deactivateDrawInteraction(){!1!==this.olDrawInteractionIsActive&&(this.removeOlLinearRingsLayer(),this.removedOlInteractions.forEach(e=>{this.olMap.addInteraction(e)}),this.removedOlInteractions=[],this.olDrawInteractionIsActive=!1,(0,Vn.B)([this.onDrawStartKey,this.onDrawEndKey,this.onDrawKey]),void 0!==this.olMap&&this.olMap.removeInteraction(this.olDrawInteraction))}onDrawStart(e){const t=e.feature.getGeometry();this.olOuterGeometry=this.getOlGeometry().clone();const o=t.getLinearRing().getCoordinates();this.addLinearRingToOlGeometry(o),this.start$.next(this.getOlGeometry()),this.onDrawKey=t.on("change",e=>{this.mousePosition=Xd(e);const t=e.target.getLinearRing(0).getCoordinates();this.updateLinearRingOfOlGeometry(t),this.changes$.next(this.getOlGeometry())}),this.subscribeToKeyDown()}onDrawEnd(e){(0,Vn.B)(this.onDrawKey),this.olOuterGeometry=void 0;const t=e.feature.getGeometry().getLinearRing().getCoordinates();this.updateLinearRingOfOlGeometry(t),this.clearOlLinearRingsSource(),this.end$.next(this.getOlGeometry()),this.unsubscribeToKeyDown()}addLinearRingToOlGeometry(e){!function(e,t){e.appendLinearRing(t)}(this.getOlGeometry(),new ll.Z(e))}updateLinearRingOfOlGeometry(e){const t=this.getOlGeometry(),o=t.getLinearRings().slice(0,-1).map(e=>e.getCoordinates());o.push(e),t.setCoordinates(o)}getOlGeometry(){const e=this.olOverlaySource.getFeatures();return e.length>0?e[0].getGeometry():void 0}}const Rh="Layer";let Uh=(()=>{class e{constructor(e,t){this.dialogRef=e,this.data=t,this.measureAreaUnit=sh,this.measureLengthUnit=ih}onNoClick(){this.dialogRef.close()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(je.so),r.Y36(je.WI))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-measurer-dialog"]],decls:88,vars:79,consts:[["mat-dialog-content",""],["colspan","2"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"h3"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"table"),r.TgZ(5,"thead"),r.TgZ(6,"tr"),r.TgZ(7,"th",1),r._uU(8),r.ALo(9,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(10,"tbody"),r.TgZ(11,"tr"),r.TgZ(12,"td"),r._uU(13),r.ALo(14,"translate"),r.qZA(),r.TgZ(15,"td"),r._uU(16),r.ALo(17,"measureFormat"),r.qZA(),r.qZA(),r.TgZ(18,"tr"),r.TgZ(19,"td"),r._uU(20),r.ALo(21,"translate"),r.qZA(),r.TgZ(22,"td"),r._uU(23),r.ALo(24,"measureFormat"),r.qZA(),r.qZA(),r.TgZ(25,"tr"),r.TgZ(26,"td"),r._uU(27),r.ALo(28,"translate"),r.qZA(),r.TgZ(29,"td"),r._uU(30),r.ALo(31,"measureFormat"),r.qZA(),r.qZA(),r.TgZ(32,"tr"),r.TgZ(33,"td"),r._uU(34),r.ALo(35,"translate"),r.qZA(),r.TgZ(36,"td"),r._uU(37),r.ALo(38,"measureFormat"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(39,"table"),r.TgZ(40,"thead"),r.TgZ(41,"tr"),r.TgZ(42,"th",1),r._uU(43),r.ALo(44,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(45,"tbody"),r.TgZ(46,"tr"),r.TgZ(47,"td"),r._uU(48),r.ALo(49,"translate"),r.qZA(),r.TgZ(50,"td"),r._uU(51),r.ALo(52,"measureFormat"),r.qZA(),r.qZA(),r.TgZ(53,"tr"),r.TgZ(54,"td"),r._uU(55),r.ALo(56,"translate"),r.qZA(),r.TgZ(57,"td"),r._uU(58),r.ALo(59,"measureFormat"),r.qZA(),r.qZA(),r.TgZ(60,"tr"),r.TgZ(61,"td"),r._uU(62),r.ALo(63,"translate"),r.qZA(),r.TgZ(64,"td"),r._uU(65),r.ALo(66,"measureFormat"),r.qZA(),r.qZA(),r.TgZ(67,"tr"),r.TgZ(68,"td"),r._uU(69),r.ALo(70,"translate"),r.qZA(),r.TgZ(71,"td"),r._uU(72),r.ALo(73,"measureFormat"),r.qZA(),r.qZA(),r.TgZ(74,"tr"),r.TgZ(75,"td"),r._uU(76),r.ALo(77,"translate"),r.qZA(),r.TgZ(78,"td"),r._uU(79),r.ALo(80,"measureFormat"),r.qZA(),r.qZA(),r.TgZ(81,"tr"),r.TgZ(82,"td"),r._uU(83),r.ALo(84,"translate"),r.qZA(),r.TgZ(85,"td"),r._uU(86),r.ALo(87,"measureFormat"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.xp6(2),r.Oqu(r.lcZ(3,23,"igo.geo.measure.dialog.title")),r.xp6(6),r.Oqu(r.lcZ(9,25,"igo.geo.measure.dialog.length.title")),r.xp6(5),r.Oqu(r.lcZ(14,27,"igo.geo.measure.dialog.lengthInMeters")),r.xp6(3),r.Oqu(r.xi3(17,29,t.data.length,t.measureLengthUnit.Meters)),r.xp6(4),r.Oqu(r.lcZ(21,32,"igo.geo.measure.dialog.lengthInKilometers")),r.xp6(3),r.Oqu(r.xi3(24,34,t.data.length,t.measureLengthUnit.Kilometers)),r.xp6(4),r.Oqu(r.lcZ(28,37,"igo.geo.measure.dialog.lengthInMiles")),r.xp6(3),r.Oqu(r.xi3(31,39,t.data.length,t.measureLengthUnit.Miles)),r.xp6(4),r.Oqu(r.lcZ(35,42,"igo.geo.measure.dialog.lengthInFeet")),r.xp6(3),r.Oqu(r.xi3(38,44,t.data.length,t.measureLengthUnit.Feet)),r.xp6(6),r.Oqu(r.lcZ(44,47,"igo.geo.measure.dialog.area.title")),r.xp6(5),r.Oqu(r.lcZ(49,49,"igo.geo.measure.dialog.areaInSquareMeters")),r.xp6(3),r.Oqu(r.xi3(52,51,t.data.area,t.measureAreaUnit.SquareMeters)),r.xp6(4),r.Oqu(r.lcZ(56,54,"igo.geo.measure.dialog.areaInSquareKilometers")),r.xp6(3),r.Oqu(r.xi3(59,56,t.data.area,t.measureAreaUnit.SquareKilometers)),r.xp6(4),r.Oqu(r.lcZ(63,59,"igo.geo.measure.dialog.areaInSquareMiles")),r.xp6(3),r.Oqu(r.xi3(66,61,t.data.area,t.measureAreaUnit.SquareMiles)),r.xp6(4),r.Oqu(r.lcZ(70,64,"igo.geo.measure.dialog.areaInAcres")),r.xp6(3),r.Oqu(r.xi3(73,66,t.data.area,t.measureAreaUnit.Acres)),r.xp6(4),r.Oqu(r.lcZ(77,69,"igo.geo.measure.dialog.areaInHectares")),r.xp6(3),r.Oqu(r.xi3(80,71,t.data.area,t.measureAreaUnit.Hectares)),r.xp6(4),r.Oqu(r.lcZ(84,74,"igo.geo.measure.dialog.perimeterInMeters")),r.xp6(3),r.Oqu(r.xi3(87,76,t.data.perimeter,t.measureLengthUnit.Meters)))},styles:['[_nghost-%COMP%]{font-family:Roboto,"Helvetica Neue",sans-serif}h3[_ngcontent-%COMP%]{text-align:center;margin:0}table[_ngcontent-%COMP%]{width:100%;padding:10px}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{padding-left:10px}']}),e})();const Nh=["table"];function Jh(e,t){if(1&e){const e=r.EpF();r.ynx(0),r.TgZ(1,"igo-measurer-item",13),r.NdJ("measureUnitChange",function(t){return r.CHM(e),r.oxw().onLengthUnitChange(t)}),r.ALo(2,"translate"),r.qZA(),r.TgZ(3,"igo-measurer-item",13),r.NdJ("measureUnitChange",function(t){return r.CHM(e),r.oxw().onAreaUnitChange(t)}),r.ALo(4,"translate"),r.qZA(),r.BQk()}if(2&e){const e=t.ngIf,o=r.oxw();r.xp6(1),r.Q6J("measureType",o.measureType.Length)("measureUnit",o.measureLengthUnit.Meters)("measure",e.length)("auto",o.measureUnitsAuto)("placeholder",r.lcZ(2,10,o.activeMeasureType===o.measureType.Area?"igo.geo.measure.perimeter":"igo.geo.measure.length")),r.xp6(2),r.Q6J("measureType",o.measureType.Area)("measureUnit",o.measureAreaUnit.SquareMeters)("measure",e.area)("auto",o.measureUnitsAuto)("placeholder",r.lcZ(4,12,"igo.geo.measure.area"))}}let Bh=(()=>{class e{constructor(e,t,o){this.languageService=e,this.dialog=t,this.storageService=o,this.tableTemplate={selection:!0,selectMany:!0,selectionCheckbox:!0,sort:!0,columns:[{name:"length",title:this.languageService.translate.instant("igo.geo.measure.lengthHeader"),valueAccessor:e=>{const t=this.activeLengthUnit;return yh(mh(e.properties.measure.length,t),{decimal:1,unit:t,unitAbbr:!1,locale:"fr"})}},{name:"area",title:this.languageService.translate.instant("igo.geo.measure.areaHeader"),valueAccessor:e=>{const t=this.activeAreaUnit,o=fh(e.properties.measure.area,t);return o?yh(o,{decimal:1,unit:t,unitAbbr:!1,locale:"fr"}):""}}]},this.subscriptions$$=[],this.measureType=oh,this.measureAreaUnit=sh,this.measureLengthUnit=ih,this.measureUnitsAuto=!1,this.displayDistance=!0,this.displayLines=!0,this.displayAreas=!0,this.hasArea$=new C.X(!1),this.measure$=new C.X({}),this.selectedFeatures$=new C.X([]),this.showTooltips=!0,this.activeLengthUnit=ih.Meters,this.activeAreaUnit=sh.SquareMeters,this.olDrawSource=new wa.Z,this._activeMeasureType=oh.Length,this.minSegmentLength=10}set activeMeasureType(e){this.setActiveMeasureType(e)}get activeMeasureType(){return this._activeMeasureType}get drawControlIsActive(){return void 0!==this.activeDrawControl}get projection(){return this.map.ol.getView().getProjection().getCode()}ngOnInit(){this.initStore(),this.createDrawLineControl(),this.createDrawPolygonControl(),this.createModifyControl(),this.toggleDrawControl(),this.updateTooltipsOfOlSource(this.store.source.ol),this.checkDistanceAreaToggle()}ngOnDestroy(){this.setActiveMeasureType(void 0),this.deactivateModifyControl(),this.freezeStore(),this.subscriptions$$.map(e=>e.unsubscribe())}onMeasureTypeChange(e){this.activeMeasureType=e}onToggleDrawControl(e){!0===e?this.toggleDrawControl():this.deactivateDrawControl()}onToggleMeasureUnitsAuto(e){this.measureUnitsAuto=e}onToggleDisplayDistance(e){this.displayDistance=e,this.onDisplayDistance(),this.storageService.set("distanceToggle",!!e,fe.SESSION)}onToggleDisplayLines(e){this.displayLines=e,this.onDisplayLines(),this.storageService.set("linesToggle",!!e,fe.SESSION)}onToggleDisplayAreas(e){this.displayAreas=e,this.onDisplayAreas(),this.storageService.set("areasToggle",!!e,fe.SESSION)}checkDistanceAreaToggle(){!1===this.storageService.get("distanceToggle")&&(this.displayDistance=!1),!1===this.storageService.get("linesToggle")&&(this.displayLines=!1),!1===this.storageService.get("areasToggle")&&(this.displayAreas=!1)}onDisplayDistance(){this.displayDistance?Array.from(document.getElementsByClassName("igo-map-tooltip-measure-polygone-segments")).map(e=>e.classList.remove("igo-map-tooltip-hidden")):Array.from(document.getElementsByClassName("igo-map-tooltip-measure-polygone-segments")).map(e=>e.classList.add("igo-map-tooltip-hidden"))}onDisplayLines(){this.displayLines?Array.from(document.getElementsByClassName("igo-map-tooltip-measure-line-segments")).map(e=>e.classList.remove("igo-map-tooltip-hidden")):Array.from(document.getElementsByClassName("igo-map-tooltip-measure-line-segments")).map(e=>e.classList.add("igo-map-tooltip-hidden"))}onDisplayAreas(){this.displayAreas?Array.from(document.getElementsByClassName("igo-map-tooltip-measure-area")).map(e=>e.classList.remove("igo-map-tooltip-hidden")):Array.from(document.getElementsByClassName("igo-map-tooltip-measure-area")).map(e=>e.classList.add("igo-map-tooltip-hidden"))}onLengthUnitChange(e){this.activeLengthUnit=e,this.table.refresh(),this.updateTooltipsOfOlSource(this.store.source.ol),void 0!==this.activeOlGeometry&&this.updateTooltipsOfOlGeometry(this.activeOlGeometry)}onAreaUnitChange(e){this.activeAreaUnit=e,this.table.refresh(),this.updateTooltipsOfOlSource(this.store.source.ol),void 0!==this.activeOlGeometry&&this.updateTooltipsOfOlGeometry(this.activeOlGeometry)}onCalculateClick(){const e=this.selectedFeatures$.value,t=e.reduce((e,t)=>e+t.properties.measure.area||0,0),o=e.reduce((e,t)=>"Polygon"===t.geometry.type?e:e+t.properties.measure.length||0,0),i=e.reduce((e,t)=>"LineString"===t.geometry.type?e:e+t.properties.measure.length||0,0);this.openDialog({area:t,length:o,perimeter:i})}onDeleteClick(){this.store.deleteMany(this.selectedFeatures$.value),this.selectedFeatures$.value.forEach(e=>{this.olDrawSource.getFeatures().forEach(t=>{const o=t.getGeometry();e.properties.id===o.ol_uid&&this.olDrawSource.removeFeature(t)})})}onModifyClick(){if(1===this.selectedFeatures$.value.length)if(!0===this.modifyControl.active)this.deactivateModifyControl(),this.toggleDrawControl();else{const e=this.selectedFeatures$.value[0],t=this.store.layer.ol.getSource().getFeatures().find(t=>t.get("id")===e.properties.id);if(void 0!==t){this.deactivateDrawControl(),this.activateModifyControl();const e=t.getGeometry();this.clearTooltipsOfOlGeometry(e),this.modifyControl.setOlGeometry(e)}}}openDialog(e){this.dialog.open(Uh,{data:e})}initStore(){const e=this.store,t=new uc({title:this.languageService.translate.instant("igo.geo.measure.layerTitle"),id:`igo-measures-${D()}`,zIndex:200,source:new tc,style:new Dn.ZP({stroke:new Nn.Z({color:"#ffcc33",width:2}),fill:new Rn.Z({color:"rgba(255, 255, 255, 0.2)"})}),showInLayerList:!0,exportable:!1,browsable:!1,workspace:{enabled:!1}});Dc(e,t),e.layer.visible=!0,t.visible$.subscribe(e=>{e?Array.from(document.getElementsByClassName("igo-map-tooltip-measure")).map(e=>e.classList.remove("igo-map-tooltip-measure-by-display")):Array.from(document.getElementsByClassName("igo-map-tooltip-measure")).map(e=>e.classList.add("igo-map-tooltip-measure-by-display"))}),Gc(e),Qc(e,new jc({map:this.map,many:!0})),this.onFeatureAddedKey=e.source.ol.on("addfeature",e=>{const t=e.feature,o=t.getGeometry();this.updateMeasureOfOlGeometry(o,t.get("measure")),this.onDisplayDistance()}),this.onFeatureRemovedKey=e.source.ol.on("removefeature",e=>{const t=e.feature.getGeometry();this.clearTooltipsOfOlGeometry(t)}),this.selectedFeatures$$=e.stateView.manyBy$(e=>!0===e.state.selected).pipe((0,Ae.T)(1)).subscribe(e=>{!0===this.modifyControl.active&&this.deactivateModifyControl(),this.selectedFeatures$.next(e.map(e=>e.entity))}),this.subscriptions$$.push(this.store.entities$.subscribe(e=>{e.find(e=>"Polygon"===e.geometry.type)?this.hasArea$.next(!0):this.hasArea$.next(!1)})),this.subscriptions$$.push(this.store.count$.subscribe(e=>{this.store.layer.options.showInLayerList=e>=1}))}freezeStore(){const e=this.store;this.selectedFeatures$$.unsubscribe(),(0,Vn.B)(this.onFeatureAddedKey),(0,Vn.B)(this.onFeatureRemovedKey),e.deactivateStrategyOfType(Nc),e.deactivateStrategyOfType(jc)}createDrawLineControl(){this.drawLineControl=new Kd({geometryType:"LineString",drawingLayerSource:this.olDrawSource,interactionStyle:vh(),drawingLayerStyle:new Dn.ZP({})})}createDrawPolygonControl(){this.drawPolygonControl=new Kd({geometryType:"Polygon",drawingLayerSource:this.olDrawSource,interactionStyle:vh(),drawingLayerStyle:new Dn.ZP({})})}createModifyControl(){this.modifyControl=new Eh({source:this.olDrawSource,drawStyle:vh(),layerStyle:new Dn.ZP({})})}toggleDrawControl(){this.deactivateDrawControl(),this.activeMeasureType===oh.Length?this.activateDrawControl(this.drawLineControl):this.activeMeasureType===oh.Area&&this.activateDrawControl(this.drawPolygonControl)}activateDrawControl(e){this.activeDrawControl=e,this.drawStart$$=e.start$.subscribe(e=>this.onDrawStart(e)),this.drawEnd$$=e.end$.subscribe(e=>this.onDrawEnd(e)),this.drawChanges$$=e.changes$.subscribe(e=>this.onDrawChanges(e)),e.setOlMap(this.map.ol,!1)}deactivateDrawControl(){void 0!==this.activeDrawControl&&(this.olDrawSource.clear(),void 0!==this.drawStart$$&&this.drawStart$$.unsubscribe(),void 0!==this.drawEnd$$&&this.drawEnd$$.unsubscribe(),void 0!==this.drawChanges$$&&this.drawChanges$$.unsubscribe(),this.clearTooltipsOfOlSource(this.olDrawSource),void 0!==this.activeOlGeometry&&this.clearTooltipsOfOlGeometry(this.activeOlGeometry),this.activeDrawControl.setOlMap(void 0),this.activeDrawControl=void 0,this.activeOlGeometry=void 0)}setActiveMeasureType(e){this._activeMeasureType=e,this.clearMeasures(),this.toggleDrawControl()}onDrawStart(e){this.activeOlGeometry=e}onDrawEnd(e){this.activeOlGeometry=void 0,this.finalizeMeasureOfOlGeometry(e),this.addFeatureToStore(e),this.clearTooltipsOfOlGeometry(e),this.olDrawSource.clear(!0)}onDrawChanges(e){const t=xh(e,this.projection);this.updateMeasureOfOlGeometry(e,Object.assign({},t,{area:void 0})),this.measure$.next(t)}activateModifyControl(){const e=this.store.getStrategyOfType(jc);e.deactivate(),e.clear(),this.modifyStart$$=this.modifyControl.start$.subscribe(e=>this.onModifyStart(e)),this.modifyEnd$$=this.modifyControl.end$.subscribe(e=>this.onModifyEnd(e)),this.modifyChanges$$=this.modifyControl.changes$.subscribe(e=>this.onModifyChanges(e)),this.modifyControl.setOlMap(this.map.ol)}deactivateModifyControl(){void 0!==this.modifyStart$$&&this.modifyStart$$.unsubscribe(),void 0!==this.modifyEnd$$&&this.modifyEnd$$.unsubscribe(),void 0!==this.modifyChanges$$&&this.modifyChanges$$.unsubscribe(),void 0!==this.activeOlGeometry&&(1===this.selectedFeatures$.value.length&&this.addFeatureToStore(this.activeOlGeometry,this.selectedFeatures$.value[0]),this.finalizeMeasureOfOlGeometry(this.activeOlGeometry)),this.olDrawSource.clear(),this.store.activateStrategyOfType(jc),this.activeOlGeometry=void 0,this.modifyControl.setOlMap(void 0)}onModifyStart(e){this.onDrawStart(e)}onModifyChanges(e){this.onDrawChanges(e)}onModifyEnd(e){this.finalizeMeasureOfOlGeometry(e)}finalizeMeasureOfOlGeometry(e){const t=xh(e,this.projection);this.updateMeasureOfOlGeometry(e,t)}updateMeasureOfOlGeometry(e,t){e.setProperties({_measure:t},!0),this.updateTooltipsOfOlGeometry(e)}clearMeasures(){this.measure$.next({})}addFeatureToStore(e,t){const o=t?t.properties.id:e.ol_uid,i=this.map.ol.getView().getProjection(),r=(new Yn.Z).writeGeometryObject(e,{featureProjection:i,dataProjection:i});this.store.update({type:Sl,geometry:r,projection:i.getCode(),properties:{id:o,measure:e.get("_measure")},meta:{id:o}})}updateTooltipsOfOlGeometry(e){const t=e.get("_measure"),o=t.lengths,i=t.area,r=function(e){const t=wh(e);let o="";return e instanceof zn.Z?o="line-":e instanceof Gn.ZP&&(o="polygone-"),t.map(e=>{let t=e.get("_tooltip");return void 0===t?t=Ah(e,!1,o):t.setPosition(e.getFlatCoordinates()),t})}(e);if(o.length===r.length)for(let s=0;s<r.length;s++){const e=o[s];void 0!==e&&this.updateOlTooltip(r[s],mh(e,this.activeLengthUnit),this.activeLengthUnit,oh.Length)}void 0!==i&&this.updateOlTooltip(function(e){const t=function(e){let t=e.get("_center");const o=(0,$n.qg)(e.getExtent());return void 0!==t?t.setCoordinates(o):(t=new Qn.Z(o),e.set("_center",t)),t}(e);let o=t.get("_tooltip");return void 0===o?o=Ah(t,!0):o.setPosition(t.getFlatCoordinates()),o}(e),fh(i,this.activeAreaUnit),this.activeAreaUnit,oh.Area)}showTooltipsOfOlGeometry(e){Th(e).forEach(e=>{this.shouldShowTooltip(e)&&this.map.ol.addOverlay(e)})}clearTooltipsOfOlGeometry(e){Th(e).forEach(e=>{void 0!==e&&void 0!==e.getMap()&&this.map.ol.removeOverlay(e)})}updateTooltipsOfOlSource(e){e.forEachFeature(e=>{this.updateTooltipsOfOlGeometry(e.getGeometry())})}showTooltipsOfOlSource(e){e.forEachFeature(e=>{this.showTooltipsOfOlGeometry(e.getGeometry())})}clearTooltipsOfOlSource(e){e.forEachFeature(e=>{void 0!==e.getGeometry()&&this.clearTooltipsOfOlGeometry(e.getGeometry())})}updateOlTooltip(e,t,o,i){e.setProperties({_measure:t,_unit:o,_type:i},!0),e.getElement().innerHTML=this.computeTooltipInnerHTML(e),this.shouldShowTooltip(e)&&this.map.ol.addOverlay(e)}computeTooltipInnerHTML(e){const t=e.getProperties();return yh(t._measure,{decimal:1,unit:t._unit,unitAbbr:!0,locale:"fr"},this.languageService)}shouldShowTooltip(e){if(!1===this.showTooltips)return!1;const t=e.getProperties(),o=t._measure;if(void 0===o)return!1;if(t._unit===oh.Length){const e=mh(this.minSegmentLength,t._unit)||0;return o>Math.max(e,0)}return!0}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ne),r.Y36(je.uw),r.Y36(ve))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-measurer"]],viewQuery:function(e,t){if(1&e&&r.Gf(Nh,7),2&e){let e;r.iGM(e=r.CRH())&&(t.table=e.first)}},inputs:{map:"map",store:"store",activeMeasureType:"activeMeasureType",minSegmentLength:"minSegmentLength"},decls:40,vars:57,consts:[[1,"measure-type-toggle","mat-typography"],[3,"value","change"],[3,"value"],[1,"measure-options","mat-typography"],[3,"checked","labelPosition","change"],[3,"disabled","checked","labelPosition","change"],[4,"ngIf"],[1,"measure-store-buttons"],["mat-icon-button","",3,"matTooltip","disabled","click"],["svgIcon","calculator"],["svgIcon","delete"],[1,"table-compact",3,"store","template"],["table",""],[3,"measureType","measureUnit","measure","auto","placeholder","measureUnitChange"]],template:function(e,t){1&e&&(r.TgZ(0,"div"),r.TgZ(1,"div",0),r.TgZ(2,"mat-button-toggle-group",1),r.NdJ("change",function(e){return t.onMeasureTypeChange(e.value)}),r.TgZ(3,"mat-button-toggle",2),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.TgZ(6,"mat-button-toggle",2),r._uU(7),r.ALo(8,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(9,"div",3),r.TgZ(10,"mat-slide-toggle",4),r.NdJ("change",function(e){return t.onToggleDrawControl(e.checked)}),r._uU(11),r.ALo(12,"translate"),r.qZA(),r.TgZ(13,"mat-slide-toggle",4),r.NdJ("change",function(e){return t.onToggleDisplayLines(e.checked)}),r._uU(14),r.ALo(15,"translate"),r.qZA(),r.TgZ(16,"mat-slide-toggle",5),r.NdJ("change",function(e){return t.onToggleDisplayDistance(e.checked)}),r.ALo(17,"async"),r._uU(18),r.ALo(19,"translate"),r.qZA(),r.TgZ(20,"mat-slide-toggle",5),r.NdJ("change",function(e){return t.onToggleDisplayAreas(e.checked)}),r.ALo(21,"async"),r._uU(22),r.ALo(23,"translate"),r.qZA(),r.TgZ(24,"mat-slide-toggle",4),r.NdJ("change",function(e){return t.onToggleMeasureUnitsAuto(e.checked)}),r._uU(25),r.ALo(26,"translate"),r.qZA(),r.qZA(),r.YNc(27,Jh,5,14,"ng-container",6),r.ALo(28,"async"),r.TgZ(29,"div",7),r.TgZ(30,"button",8),r.NdJ("click",function(){return t.onCalculateClick()}),r.ALo(31,"translate"),r.ALo(32,"async"),r._UZ(33,"mat-icon",9),r.qZA(),r.TgZ(34,"button",8),r.NdJ("click",function(){return t.onDeleteClick()}),r.ALo(35,"translate"),r.ALo(36,"async"),r._UZ(37,"mat-icon",10),r.qZA(),r.qZA(),r._UZ(38,"igo-entity-table",11,12),r.qZA()),2&e&&(r.xp6(2),r.Q6J("value",t.activeMeasureType),r.xp6(1),r.Q6J("value",t.measureType.Length),r.xp6(1),r.hij(" ",r.lcZ(5,29,"igo.geo.measure."+t.measureType.Length)," "),r.xp6(2),r.Q6J("value",t.measureType.Area),r.xp6(1),r.hij(" ",r.lcZ(8,31,"igo.geo.measure."+t.measureType.Area)," "),r.xp6(3),r.Q6J("checked",t.drawControlIsActive)("labelPosition","before"),r.xp6(1),r.hij(" ",r.lcZ(12,33,"igo.geo.measure.toggleActive")," "),r.xp6(2),r.Q6J("checked",t.displayLines)("labelPosition","before"),r.xp6(1),r.hij(" ",r.lcZ(15,35,"igo.geo.measure.toggleDisplayLines")," "),r.xp6(2),r.Q6J("disabled",!r.lcZ(17,37,t.hasArea$))("checked",t.displayDistance)("labelPosition","before"),r.xp6(2),r.hij(" ",r.lcZ(19,39,"igo.geo.measure.toggleDisplayDistance")," "),r.xp6(2),r.Q6J("disabled",!r.lcZ(21,41,t.hasArea$))("checked",t.displayAreas)("labelPosition","before"),r.xp6(2),r.hij(" ",r.lcZ(23,43,"igo.geo.measure.toggleDisplayAreas")," "),r.xp6(2),r.Q6J("checked",t.measureUnitsAuto)("labelPosition","before"),r.xp6(1),r.hij(" ",r.lcZ(26,45,"igo.geo.measure.toggleAutoUnits")," "),r.xp6(2),r.Q6J("ngIf",r.lcZ(28,47,t.measure$)),r.xp6(3),r.Q6J("matTooltip",r.lcZ(31,49,"igo.geo.measure.actionbar.calculate.tooltip"))("disabled",0===r.lcZ(32,51,t.selectedFeatures$).length),r.xp6(4),r.Q6J("matTooltip",r.lcZ(35,53,"igo.geo.measure.actionbar.delete.tooltip"))("disabled",0===r.lcZ(36,55,t.selectedFeatures$).length),r.xp6(4),r.Q6J("store",t.store)("template",t.tableTemplate))},styles:[".measure-type-toggle[_ngcontent-%COMP%]{padding:10px;text-align:center}.measure-type-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]{width:100%}.measure-type-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]{width:50%}.measure-options[_ngcontent-%COMP%]{overflow-x:hidden}.measure-options[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{width:100%;margin:10px}.measure-options[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content{width:calc(100% - 60px)}.measure-store-buttons[_ngcontent-%COMP%]{width:100%;border-top:1px solid #ddd;border-bottom:1px solid #ddd}.measure-store-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-of-type{margin-left:14px}.table-compact[_ngcontent-%COMP%]     .mat-header-cell.mat-column-selectionCheckbox{width:52px}"],changeDetection:0}),e})(),jh=(()=>{class e{transform(e,t,o=!1,i=1){let r;return Object.values(sh).indexOf(t)>=0?r=fh(e,t):Object.values(ih).indexOf(t)>=0&&(r=mh(e,t)),r&&yh(r,{decimal:1,unit:t,unitAbbr:o,locale:"fr"})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=r.Yjl({name:"measureFormat",type:e,pure:!0}),e})();function Gh(e,t){}let Qh=(()=>{class e{constructor(e,t){this.cdRef=e,this.ngControl=t,this.olGeoJSON=new Yn.Z,this.ready=!1,this.olTooltip=this.createMeasureTooltip(),this.drawGuide=null,this.measure=!1,this._drawControlIsActive=!0,this.controlOptions={},this.onChange=()=>{},this.onTouched=()=>{},void 0!==this.ngControl&&(this.ngControl.valueAccessor=this)}set geometryType(e){this._geometryType=e,!1!==this.ready&&(this.deactivateControl(),this.createDrawControl(),this.drawControl.freehand$.next(this.freehandDrawIsActive),this.toggleControl())}get geometryType(){return this._geometryType}get drawControlIsActive(){return this._drawControlIsActive}set drawControlIsActive(e){if(this._drawControlIsActive=e,!1!==this.ready){if(this.deactivateControl(),!this._drawControlIsActive)return;this.toggleControl()}}get freehandDrawIsActive(){return this._freehandDrawIsActive}set freehandDrawIsActive(e){this._freehandDrawIsActive=e,this.deactivateControl(),this.createDrawControl(),this.createModifyControl(),this.drawControl.freehand$.next(this.freehandDrawIsActive),!1!==this.ready&&(!this.drawControlIsActive||this.toggleControl())}set drawStyle(e){void 0===e&&(e=Vd()),this._drawStyle=e;const t=this.getGuideStyleFromDrawStyle(e);this.defaultDrawStyleRadius=void 0!==t?t.getRadius():null,!1!==this.ready&&(this.deactivateControl(),this.createDrawControl(),this.createModifyControl(),this.drawControl.freehand$.next(this.freehandDrawIsActive),this.toggleControl())}get drawStyle(){return this._drawStyle}set overlayStyle(e){this._overlayStyle=e}get overlayStyle(){return this._overlayStyle}set value(e){this._value=e,!1!==this.ready&&(e?this.addGeoJSONToOverlay(e):this.olOverlaySource.clear(!0),this.onChange(e),this.toggleControl(),this.cdRef.detectChanges())}get value(){return this._value}get olOverlaySource(){return this.olOverlayLayer.getSource()}set radius(e){if(!1!==this.ready&&(this.modifyControl.getSource()&&this.modifyControl.getSource().refresh(),this.freehandDrawIsActive)){let e;setTimeout(()=>{e=this.modifyControl.olModifyInteraction,e&&e.features_&&(e.features_.clear(),this.addGeoJSONToOverlay(this.value))},0)}}ngOnInit(){void 0===this.drawStyle&&(this.drawStyle=Vd()),void 0===this.overlayStyle&&(this.overlayStyle=this.drawStyle),this.addOlOverlayLayer(),this.createDrawControl(),this.createModifyControl(),this.value&&this.addGeoJSONToOverlay(this.value),this.toggleControl(),this.ready=!0}ngOnDestroy(){this.ready=!1,this.deactivateControl(),this.olOverlaySource.clear(),this.map.ol.removeLayer(this.olOverlayLayer)}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}writeValue(e){this.value=e}addOlOverlayLayer(){this.olOverlayLayer=new Hn.Z({source:new wa.Z,zIndex:500,style:null}),this.map.ol.addLayer(this.olOverlayLayer)}createDrawControl(){const e=Object.assign({},this.controlOptions,{geometryType:this.geometryType||"Point",drawingLayer:this.olOverlayLayer,interactionStyle:"function"==typeof this.drawStyle?this.drawStyle:(e,t)=>{const o=this.drawStyle;return this.updateDrawStyleWithDrawGuide(o,t),o}});this.drawControl=new Kd(e)}createModifyControl(){const e=Object.assign({},this.controlOptions,{layer:this.olOverlayLayer,drawStyle:"function"==typeof this.drawStyle?this.drawStyle:(e,t)=>{const o=this.drawStyle;return this.updateDrawStyleWithDrawGuide(o,t),o}});this.modifyControl=new Eh(e)}toggleControl(){let e;e=!this.value&&this.geometryType?this.drawControl:this.modifyControl,e!==this.activeControl&&(this.deactivateControl(),this.activateControl(e))}activateControl(e){this.activeControl=e,this.olGeometryEnds$$=e.end$.subscribe(e=>this.onOlGeometryEnds(e)),!0===this.measure&&e===this.drawControl&&(this.olGeometryChanges$$=e.changes$.subscribe(e=>this.onOlGeometryChanges(e))),e.setOlMap(this.map.ol,!1)}deactivateControl(){this.removeMeasureTooltip(),void 0!==this.activeControl&&this.activeControl.setOlMap(void 0),void 0!==this.olGeometryEnds$$&&this.olGeometryEnds$$.unsubscribe(),void 0!==this.olGeometryChanges$$&&this.olGeometryChanges$$.unsubscribe(),this.activeControl=void 0}onOlGeometryEnds(e){this.removeMeasureTooltip(),this.setOlGeometry(e)}onOlGeometryChanges(e){"Point"!==e.getType()&&this.updateMeasureTooltip(e)}setOlGeometry(e){let t;void 0!==e&&("Circle"===e.getType()&&(e=this.circleToPoint(e)),t=this.olGeoJSON.writeGeometryObject(e,{featureProjection:this.map.projection,dataProjection:"EPSG:4326"}),e.get("radius")&&(t.radius=e.get("radius"),e.set("radius",t.radius)),this.writeValue(t))}circleToPoint(e){const t=e.getCenter(),o=Fn.vs(t,this.map.projection,"EPSG:4326"),i=Math.round(e.getRadius()*Math.cos(Math.PI/180*o[1]));return(e=new Qn.Z(t)).set("radius",i,!0),e}addGeoJSONToOverlay(e){const t=this.olGeoJSON.readGeometry(e,{dataProjection:"EPSG:4326",featureProjection:this.map.projection}),o=new Tn.Z({geometry:t});o.setStyle(this.overlayStyle),this.olOverlaySource.clear(),this.olOverlaySource.addFeature(o)}createMeasureTooltip(){return new tl.Z({element:document.createElement("div"),offset:[-30,-10],className:["igo-map-tooltip","igo-map-tooltip-measure"].join(" "),stopEvent:!1})}updateMeasureTooltip(e){const t=xh(e,this.map.projection).lengths,o="Polygon"===e.getType()?t.length-2:t.length-1,i=t[o],r=wh(e),s=r[o];if(0===r.length||void 0===s)return void this.removeMeasureTooltip();this.olTooltip.setPosition(s.getFlatCoordinates());const n=yh(i,{decimal:1,unit:ih.Meters,unitAbbr:!0,locale:"fr"});this.olTooltip.getElement().innerHTML=n,void 0===this.olTooltip.getMap()&&this.map.ol.addOverlay(this.olTooltip)}removeMeasureTooltip(){this.olTooltip.getMap&&void 0!==this.olTooltip.getMap()&&(this.map.ol.removeOverlay(this.olTooltip),this.olTooltip.setMap(void 0))}updateDrawStyleWithDrawGuide(e,t){const o=this.getGuideStyleFromDrawStyle(e);if(void 0===o)return;const i=this.drawGuide;let r;r=!i||i<0?this.defaultDrawStyleRadius:i>0?i/t:i,o.setRadius(r)}isStyleWithRadius(e){return"function"!=typeof e&&e.setRadius}getGuideStyleFromDrawStyle(e){if(Array.isArray(e)&&(e=e[0]),this.isStyleWithRadius(e))return e}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.sBO),r.Y36(ze.a5,10))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-geometry-form-field-input"]],inputs:{map:"map",geometryType:"geometryType",drawGuide:"drawGuide",measure:"measure",drawControlIsActive:"drawControlIsActive",freehandDrawIsActive:"freehandDrawIsActive",controlOptions:"controlOptions",drawStyle:"drawStyle",overlayStyle:"overlayStyle",value:"value",radius:"radius"},decls:1,vars:0,template:function(e,t){1&e&&r.YNc(0,Gh,0,0,"ng-template")},encapsulation:2,changeDetection:0}),e})(),zh=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,ze.u5,ze.UX,a.Ps,Pe.lN,Qe.c,n.ot,Ha.vV,oe]]}),e})(),Yh=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[],imports:[[h.ez,zh],zh]}),e})();function Hh(e,t){if(1&e&&(r.TgZ(0,"button",2),r.ALo(1,"translate"),r._UZ(2,"mat-icon",3),r.qZA()),2&e){const e=r.oxw();r.Q6J("matTooltip",r.lcZ(1,3,"igo.geo.filter.filterBy"))("color",e.color),r.xp6(2),r.Q6J("matBadge",e.badge)}}function Vh(e,t){if(1&e&&r._UZ(0,"igo-time-filter-item",7),2&e){const e=r.oxw(2);r.Q6J("header",!1)("layer",e.layer)}}function Wh(e,t){if(1&e&&(r.TgZ(0,"div",4,5),r.YNc(2,Vh,1,2,"igo-time-filter-item",6),r.qZA()),2&e){const e=r.oxw();r.xp6(2),r.Q6J("ngIf",e.timeFilterCollapse&&e.options.timeFilter)}}let Xh=(()=>{class e{constructor(){this.color="primary",this.header=!0,this.timeFilterCollapse=!1}get badge(){const e=this.options.timeFilter;if(e&&e.enabled)return 1}get layer(){return this._layer}set layer(e){this._layer=e,e&&(this.options=this.layer.dataSource.options)}ngOnInit(){this.options=this.layer.dataSource.options}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-time-filter-button"]],inputs:{layer:"layer",map:"map",color:"color",header:"header"},decls:2,vars:2,consts:[["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color",4,"ngIf"],["class","igo-layer-actions-container",4,"ngIf"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color"],["matBadgeColor","warn","matBadgeSize","medium","svgIcon","history",3,"matBadge"],[1,"igo-layer-actions-container"],["ogcFilter",""],["igoListItem","",3,"header","layer",4,"ngIf"],["igoListItem","",3,"header","layer"]],template:function(e,t){1&e&&(r.YNc(0,Hh,3,5,"button",0),r.YNc(1,Wh,3,1,"div",1)),2&e&&(r.Q6J("ngIf",t.header&&t.options.timeFilterable&&t.options.timeFilter),r.xp6(1),r.Q6J("ngIf",t.header&&t.options.timeFilterable&&t.options.timeFilter))},styles:[""],changeDetection:0}),e})();function Kh(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",3),r.TgZ(1,"mat-form-field"),r._UZ(2,"mat-datetimepicker-toggle",4),r._UZ(3,"mat-datetimepicker",5,6),r.TgZ(5,"input",7),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw(2).date=t})("dateChange",function(t){return r.CHM(e),r.oxw(2).handleDateChange(t)}),r.ALo(6,"translate"),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.MAs(4),t=r.oxw(2);r.xp6(2),r.Q6J("for",e),r.xp6(1),r.s9C("type",t.type),r.xp6(2),r.s9C("placeholder",r.lcZ(6,7,"igo.geo.timeFilter.date")),r.Q6J("matDatetimepicker",e)("ngModel",t.date)("min",t.min)("max",t.max)}}function eg(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div"),r.TgZ(1,"div",8),r.TgZ(2,"mat-form-field"),r._UZ(3,"mat-datetimepicker-toggle",4),r._UZ(4,"mat-datetimepicker",5,9),r.TgZ(6,"input",10),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw(2).startDate=t})("input",function(){return r.CHM(e),r.oxw(2).startDate})("dateChange",function(t){return r.CHM(e),r.oxw(2).handleDateChange(t)}),r.ALo(7,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(8,"div",8),r.TgZ(9,"mat-form-field"),r._UZ(10,"mat-datetimepicker-toggle",4),r._UZ(11,"mat-datetimepicker",5,11),r.TgZ(13,"input",7),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw(2).endDate=t})("dateChange",function(t){return r.CHM(e),r.oxw(2).handleDateChange(t)}),r.ALo(14,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.MAs(5),t=r.MAs(12),o=r.oxw(2);r.xp6(3),r.Q6J("for",e),r.xp6(1),r.s9C("type",o.type),r.xp6(2),r.s9C("placeholder",r.lcZ(7,14,"igo.geo.timeFilter.startDate")),r.Q6J("matDatetimepicker",e)("ngModel",o.startDate)("min",o.min)("max",o.getRangeMaxDate()),r.xp6(4),r.Q6J("for",t),r.xp6(1),r.s9C("type",o.type),r.xp6(2),r.s9C("placeholder",r.lcZ(14,16,"igo.geo.timeFilter.endDate")),r.Q6J("matDatetimepicker",t)("ngModel",o.endDate)("min",o.getRangeMinDate())("max",o.max)}}function tg(e,t){if(1&e&&(r.TgZ(0,"div"),r.YNc(1,Kh,7,9,"div",2),r.YNc(2,eg,15,18,"div",0),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf",!e.isRange),r.xp6(1),r.Q6J("ngIf",e.isRange)}}function og(e,t){if(1&e&&(r.TgZ(0,"mat-option",14),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.Oqu(e)}}function ig(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",3),r.TgZ(1,"mat-form-field"),r.TgZ(2,"mat-select",12),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw(2).year=t})("selectionChange",function(t){return r.CHM(e),r.oxw(2).handleYearChange(t)}),r.ALo(3,"translate"),r.YNc(4,og,2,2,"mat-option",13),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(2);r.xp6(2),r.s9C("placeholder",r.lcZ(3,3,"igo.geo.timeFilter.date")),r.Q6J("ngModel",e.year),r.xp6(2),r.Q6J("ngForOf",e.listYears)}}function rg(e,t){if(1&e&&(r.TgZ(0,"mat-option",14),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.Oqu(e)}}function sg(e,t){if(1&e&&(r.TgZ(0,"mat-option",14),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.Oqu(e)}}function ng(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div"),r.TgZ(1,"div",8),r.TgZ(2,"mat-form-field"),r.TgZ(3,"mat-select",12),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw(2).startYear=t})("selectionChange",function(t){return r.CHM(e),r.oxw(2).handleYearChange(t)}),r.ALo(4,"translate"),r.YNc(5,rg,2,2,"mat-option",13),r.qZA(),r.qZA(),r.qZA(),r.TgZ(6,"div",8),r.TgZ(7,"mat-form-field"),r.TgZ(8,"mat-select",12),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw(2).endYear=t})("selectionChange",function(t){return r.CHM(e),r.oxw(2).handleYearChange(t)}),r.ALo(9,"translate"),r.YNc(10,sg,2,2,"mat-option",13),r.qZA(),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(2);r.xp6(3),r.s9C("placeholder",r.lcZ(4,6,"igo.geo.timeFilter.startDate")),r.Q6J("ngModel",e.startYear),r.xp6(2),r.Q6J("ngForOf",e.startListYears),r.xp6(3),r.s9C("placeholder",r.lcZ(9,8,"igo.geo.timeFilter.endDate")),r.Q6J("ngModel",e.endYear),r.xp6(2),r.Q6J("ngForOf",e.endListYears)}}function ag(e,t){if(1&e&&(r.TgZ(0,"div"),r.YNc(1,ig,5,5,"div",2),r.YNc(2,ng,11,10,"div",0),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf",!e.isRange),r.xp6(1),r.Q6J("ngIf",e.isRange)}}function lg(e,t){if(1&e&&(r.TgZ(0,"p",23),r._uU(1),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.Oqu(e.year)}}function cg(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",15),r.TgZ(1,"span"),r._uU(2),r.qZA(),r.TgZ(3,"mat-slider",16),r.NdJ("input",function(t){return r.CHM(e),r.oxw().handleSliderYearChange(t)})("change",function(t){return r.CHM(e),r.oxw().handleSliderYearChange(t)}),r.qZA(),r.TgZ(4,"span"),r._uU(5),r.qZA(),r.YNc(6,lg,2,1,"p",17),r.TgZ(7,"div",18,19),r.TgZ(9,"mat-slide-toggle",20),r.NdJ("change",function(){return r.CHM(e),r.oxw().toggleFilterState()}),r.ALo(10,"translate"),r.qZA(),r.TgZ(11,"button",21),r.NdJ("click",function(t){return r.CHM(e),r.oxw().playYear(t)}),r._UZ(12,"mat-icon",22),r.qZA(),r.TgZ(13,"button",21),r.NdJ("click",function(t){return r.CHM(e),r.oxw().resetFilter(t)}),r._UZ(14,"mat-icon",22),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(2),r.Oqu(e.startYear),r.xp6(1),r.s9C("step",e.step),r.Q6J("min",e.startYear)("max",e.endYear)("value",e.handleSliderValue())("color",e.color)("disabled",!e.options.enabled||!e.layer.visible),r.xp6(2),r.Oqu(e.endYear),r.xp6(1),r.Q6J("ngIf",e.options.enabled),r.xp6(3),r.Q6J("matTooltip",r.lcZ(10,17,"igo.geo.filter.toggleFilterState"))("color",e.color)("checked",e.options.enabled)("disabled",!e.layer.visible),r.xp6(2),r.Q6J("disabled",!e.options.enabled||!e.layer.visible),r.xp6(1),r.s9C("svgIcon",e.playIcon),r.xp6(1),r.Q6J("disabled",!e.options.enabled||!e.layer.visible),r.xp6(1),r.s9C("svgIcon",e.resetIcon)}}function ug(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",3),r.TgZ(1,"mat-slider",24),r.NdJ("input",function(t){return r.CHM(e),r.oxw().handleSliderDateChange(t)})("selectionChange",function(t){return r.CHM(e),r.oxw().handleSliderDateChange(t)}),r.qZA(),r.TgZ(2,"p",23),r._uU(3),r.qZA(),r.TgZ(4,"button",25),r.NdJ("click",function(t){return r.CHM(e),r.oxw().playFilter(t)}),r._UZ(5,"mat-icon",22),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(1),r.s9C("step",e.step),r.Q6J("min",e.dateToNumber(e.min))("max",e.dateToNumber(e.max))("value",e.handleSliderValue()),r.xp6(2),r.Oqu(e.handleSliderTooltip()),r.xp6(2),r.s9C("svgIcon",e.playIcon)}}let pg=(()=>{class e{constructor(e){this.dateAdapter=e,this.color="primary",this.listYears=[],this.startListYears=[],this.endListYears=[],this.playIcon="play-circle",this.resetIcon="replay",this.change=new r.vpe,this.yearChange=new r.vpe,this.dateAdapter.setLocale("fr")}set currentValue(e){if(e&&this.type!==Ac.YEAR){const t=e.split("/");if(t.length>0){const e=new Date(t[0]),o=new Date(t[1]);isNaN(e.valueOf())||(this.startDate=e),isNaN(o.valueOf())||(this.endDate=o)}}}get type(){return void 0===this.options.type?Ac.DATE:this.options.type}get isRange(){return void 0!==this.options.range&&this.options.style!==Zc.SLIDER&&this.options.range}get style(){return void 0===this.options.style?Zc.SLIDER:this.options.style}get step(){let e=108e5;if(void 0===this.options.step)switch(this.type){case Ac.DATE:case Ac.DATETIME:e=108e5;break;case Ac.TIME:e=36e5;break;case Ac.YEAR:e=31536e6;break;default:e=108e5}else e=this.getStepDefinition(this.options.step);return e}get timeInterval(){return void 0===this.options.timeInterval?2e3:this.options.timeInterval}get min(){if(this.options.min){const e=new Date(this.options.min);return new Date(e.getTime()+6e4*e.getTimezoneOffset())}}get max(){if(this.options.max){const e=new Date(this.options.max);return new Date(e.getTime()+6e4*e.getTimezoneOffset())}}get is(){return void 0!==this.options.range&&this.options.range}ngOnInit(){if(void 0===this.startDate&&(this.startDate=new Date(this.min)),void 0===this.endDate&&(this.endDate=new Date(this.max)),void 0===this.startYear&&(this.startYear=new Date(this.startDate).getFullYear(),this.initStartYear=this.startYear),void 0===this.endYear&&(this.endYear=new Date(this.endDate).getFullYear(),this.initEndYear=this.endYear),this.isRange){for(let e=this.startYear;e<this.endYear;e++)this.startListYears.push(e);for(let e=this.startYear+1;e<=this.endYear;e++)this.endListYears.push(e)}else for(let e=this.startYear;e<=this.endYear+1;e++)this.listYears.push(e);this.options.enabled=void 0===this.options.enabled||this.options.enabled,this.checkFilterValue(),this.options.enabled?!this.isRange&&"slider"===this.style&&"year"===this.type&&this.yearChange.emit(this.year):(this.storeCurrentFilterValue(),this.yearChange.emit(void 0))}storeCurrentFilterValue(){!this.isRange&&this.style===Zc.SLIDER&&this.type===Ac.YEAR&&(this.options.value=this.year.toString())}checkFilterValue(){const e=this.layer.dataSource.ol.getParams().TIME;if(this.isRange||this.style!==Zc.SLIDER||this.type!==Ac.YEAR){if(this.isRange&&this.style===Zc.CALENDAR&&this.type===Ac.YEAR&&e){this.startYear=parseInt(e.substr(0,4),10),this.endYear=parseInt(e.substr(5,4),10);const t=[],o=[];for(let e=this.initStartYear;e<this.endYear;e++)t.push(e);for(let e=this.startYear+1;e<=this.initEndYear;e++)o.push(e);this.startListYears=t,this.endListYears=o}}else this.year=e?new Date(e.toString()).getFullYear()+1:this.options.value?new Date(this.options.value.toString()).getFullYear()+1:new Date(this.min).getFullYear()+1}handleDateChange(e){this.setupDateOutput(),this.applyTypeChange(),this.change.emit(this.isRange?[this.startDate,this.endDate]:this.startDate)}handleYearChange(e){if(this.isRange){this.endListYears=[];for(let e=this.startYear+1;e<=this.initEndYear;e++)this.endListYears.push(e);this.startListYears=[];for(let e=this.initStartYear+1;e<this.endYear;e++)this.startListYears.push(e);this.yearChange.emit([this.startYear,this.endYear])}else this.yearChange.emit(this.year)}handleListYearChange(e){this.handleYearChange([this.startYear,this.endYear])}handleListYearStartChange(e){this.change.emit([this.startDate,this.endDate])}dateToNumber(e){let t;return t=e?new Date(e):new Date(this.min),t.getTime()}setSliderThumbLabel(e){const t=this.findThumbLabel(this.mySlider._elementRef.nativeElement.childNodes);t&&(t.textContent=e)}findThumbLabel(e){let t;return e.forEach(e=>{"mat-slider-thumb-label-text"===e.className&&(t=e),e.children.length>0&&!t&&(t=this.findThumbLabel(e.childNodes))},this),t}toggleFilterState(){this.options.enabled=!this.options.enabled,this.options.enabled?!this.isRange&&Zc.SLIDER&&this.type===Ac.YEAR&&this.yearChange.emit(this.year):(this.stopFilter(),this.storeCurrentFilterValue(),this.change.emit(void 0))}resetFilter(e){this.date=new Date(this.min),this.year=this.date.getFullYear(),!this.isRange&&Zc.SLIDER&&this.type===Ac.YEAR?this.yearChange.emit(this.year):(this.setupDateOutput(),this.change.emit(void 0))}playFilter(e){this.interval?this.stopFilter():(this.playIcon="pause-circle",this.interval=setInterval(e=>{let t;const o=new Date(e.max);t=void 0===e.date?e.min.getTime():e.date.getTime(),t+=e.mySlider.step,e.date=new Date(t),t>o.getTime()&&e.stopFilter(),e.handleDateChange({value:e.date,date:e.date})},this.timeInterval,this))}playYear(e){this.year+this.mySlider.step>this.max.getFullYear()+this.mySlider.step&&(this.stopFilter(),this.resetFilter(e)),this.interval?this.stopFilter():(this.playIcon="pause-circle",this.interval=setInterval(()=>{this.year+this.mySlider.step>this.max.getFullYear()?this.stopFilter():this.year=this.year+this.mySlider.step,this.yearChange.emit(this.year)},this.timeInterval,this))}stopFilter(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.playIcon="play-circle"}handleSliderDateChange(e){this.date=new Date(e.value),this.setSliderThumbLabel(this.handleSliderTooltip()),this.handleDateChange(e)}handleSliderYearChange(e){this.year=e.value,this.yearChange.emit(this.year)}handleSliderValue(){if(!0===this.options.current||!this.min){const e=new Date;this.date=this.getRoundedDate(e)}return this.type===Ac.YEAR?this.year:void 0===this.date?this.min.getTime():this.date.getTime()}handleSliderTooltip(){let e;switch(this.type){case Ac.DATE:e=void 0===this.date?this.min.toDateString():this.date.toDateString();break;case Ac.TIME:e=void 0===this.date?this.min.toTimeString():this.date.toTimeString();break;default:e=void 0===this.date?this.min.toUTCString():this.date.toUTCString()}return e}setupDateOutput(){this.style===Zc.SLIDER?(this.startDate=new Date(this.date),this.startDate.setSeconds(-this.step/1e3),this.endDate=new Date(this.startDate),this.endDate.setSeconds(this.step/1e3)):!this.isRange&&this.date?(this.endDate=new Date(this.date),this.startDate=new Date(this.date)):(!this.isRange||!this.date&&this.date)&&this.date||(this.startDate=void 0===this.startDate?new Date(this.min):this.startDate,this.endDate=void 0===this.endDate?new Date(this.max):this.endDate)}applyTypeChange(){switch(this.type){case Ac.DATE:(void 0!==this.startDate||void 0!==this.endDate)&&(this.startDate.setHours(0),this.startDate.setMinutes(0),this.startDate.setSeconds(0),this.endDate.setHours(23),this.endDate.setMinutes(59),this.endDate.setSeconds(59));break;case Ac.TIME:if(this.style===Zc.CALENDAR){if(this.startDate.getDay()!==this.min.getDay()){const e=this.startDate.getHours(),t=this.startDate.getMinutes();this.startDate=this.min,this.startDate.setHours(e),this.startDate.setMinutes(t)}if(this.endDate.getDay()!==this.min.getDay()){const e=this.endDate.getHours(),t=this.endDate.getMinutes();this.endDate=this.min,this.endDate.setHours(e),this.endDate.setMinutes(t)}}!this.isRange&&this.step>36e5&&(this.startDate.setMinutes(0),this.startDate.setSeconds(0),this.endDate.setMinutes(59),this.endDate.setSeconds(59))}}getRangeMinDate(){return void 0===this.startDate?this.min:this.startDate}getRangeMaxDate(){return void 0===this.endDate?this.max:this.endDate}getRoundedDate(e,t=10){const o=6e4*t;return new Date(Math.round(e.getTime()/o)*o)}getStepDefinition(e){return na.duration(e).asMilliseconds()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36($e._A))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-time-filter-form"]],viewQuery:function(e,t){if(1&e&&r.Gf(za.pH,5),2&e){let e;r.iGM(e=r.CRH())&&(t.mySlider=e.first)}},inputs:{layer:"layer",options:"options",currentValue:"currentValue"},outputs:{change:"change",yearChange:"yearChange"},decls:5,vars:4,consts:[[4,"ngIf"],["class","igo-col igo-col-100 igo-col-100-m mat-typography",4,"ngIf"],["class","igo-col igo-col-100 igo-col-100-m",4,"ngIf"],[1,"igo-col","igo-col-100","igo-col-100-m"],["matSuffix","",3,"for"],["openOnFocus","true","timeInterval","5",3,"type"],["datetimePicker",""],["matInput","","autocomplete","false","readonly","readonly",3,"placeholder","matDatetimepicker","ngModel","min","max","ngModelChange","dateChange"],[1,"igo-col","igo-col-100"],["minDatetimePicker",""],["matInput","","autocomplete","false","readonly","readonly",3,"placeholder","matDatetimepicker","ngModel","min","max","ngModelChange","input","dateChange"],["maxDatetimePicker",""],[3,"placeholder","ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"igo-col","igo-col-100","igo-col-100-m","mat-typography"],["id","time-slider","tickInterval","auto","thumbLabel","",3,"step","min","max","value","color","disabled","input","change"],["class","date-below",4,"ngIf"],[1,"igo-layer-actions-container"],["actions",""],["tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","checked","disabled","change"],["mat-icon-button","","color","primary",3,"disabled","click"],[3,"svgIcon"],[1,"date-below"],["id","time-slider","tickInterval","auto","thumbLabel","",3,"step","min","max","value","input","selectionChange"],["mat-icon-button","","color","primary",3,"click"]],template:function(e,t){1&e&&(r.YNc(0,tg,3,2,"div",0),r.YNc(1,ag,3,2,"div",0),r._UZ(2,"br"),r.YNc(3,cg,15,19,"div",1),r.YNc(4,ug,6,6,"div",2)),2&e&&(r.Q6J("ngIf","calendar"===t.style&&"year"!==t.type),r.xp6(1),r.Q6J("ngIf","calendar"===t.style&&"year"===t.type),r.xp6(2),r.Q6J("ngIf",!t.isRange&&"slider"===t.style&&"year"===t.type),r.xp6(1),r.Q6J("ngIf","slider"===t.style&&"year"!==t.type))},directives:[h.O5,Pe.KE,al.KA,Pe.R9,al.k1,Qe.Nt,al.Ry,ze.Fj,ze.JJ,ze.On,_e.gD,h.sg,$e.ey,za.pH,Qa.Rr,p.gM,n.lW,a.Hw],pipes:[U.X$],styles:[".igo-layer-filters-container[_ngcontent-%COMP%]{padding-left:5px}mat-slider[_ngcontent-%COMP%]     div.mat-slider-thumb-label{width:32px;height:32px;margin:0 auto}mat-slider[_ngcontent-%COMP%]     span.mat-slider-thumb-label-text{font-size:10px}#time-slider[_ngcontent-%COMP%]{width:70%;margin:0 auto}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){#time-slider[_ngcontent-%COMP%]{width:60%;margin:0 auto}}.date-below[_ngcontent-%COMP%]{margin:0}mat-form-field[_ngcontent-%COMP%]{text-align:center}mat-datetimepicker-toggle[_ngcontent-%COMP%]     .mat-icon{padding-bottom:30px}.igo-layer-actions-container[_ngcontent-%COMP%] > .mat-slide-toggle[_ngcontent-%COMP%]{vertical-align:middle}"]}),e})();const dg=function(e){return{disabled:e}};function hg(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",10),r.NdJ("click",function(){r.CHM(e);const t=r.oxw(2);return t.layer.visible=!t.layer.visible}),r.ALo(1,"translate"),r.ALo(2,"translate"),r._UZ(3,"mat-icon",11),r.ALo(4,"async"),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("color",e.layer.visible?"primary":"default")("matTooltip",e.layer.visible?r.lcZ(1,4,"igo.geo.layer.hideLayer"):r.lcZ(2,6,"igo.geo.layer.showLayer")),r.xp6(3),r.Q6J("ngClass",r.VKq(10,dg,!r.lcZ(4,8,e.inResolutionRange$)))("svgIcon",e.layer.visible?"eye":"eye-off")}}const gg=function(e){return{cursor:e}};function mg(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-list-item"),r.TgZ(1,"mat-icon",7),r.NdJ("click",function(){return r.CHM(e),r.oxw().toggleFiltersCollapsed()}),r.qZA(),r.TgZ(2,"h4",8),r.NdJ("click",function(){return r.CHM(e),r.oxw().toggleLegendOnClick()}),r._uU(3),r.qZA(),r.YNc(4,hg,5,12,"button",9),r.qZA()}if(2&e){const e=r.oxw(),t=r.MAs(2);r.xp6(1),r.Q6J("target",t)("collapsed",e.filtersCollapsed),r.xp6(1),r.Q6J("ngStyle",r.VKq(5,gg,e.filtersCollapsed?"default":"pointer")),r.xp6(1),r.Oqu(e.layer.title),r.xp6(1),r.Q6J("ngIf",e.header)}}function fg(e,t){if(1&e&&r._UZ(0,"igo-layer-legend",12),2&e){const e=r.oxw();r.Q6J("layer",e.layer)}}let yg=(()=>{class e{constructor(e){this.timeFilterService=e,this.color="primary",this.showLegend$=new C.X(!1),this.inResolutionRange$=new C.X(!0),this.filtersCollapsed=!1,this.header=!0}get datasource(){return this.layer.dataSource}ngOnInit(){this.resolution$$=this.layer.map.viewController.resolution$.subscribe(()=>{this.inResolutionRange$.next(this.layer.isInResolutionsRange)})}ngOnDestroy(){this.resolution$$.unsubscribe()}handleYearChange(e){this.timeFilterService.filterByYear(this.datasource,e)}handleDateChange(e){this.timeFilterService.filterByDate(this.datasource,e)}toggleLegend(e){this.layer.legendCollapsed=e,this.showLegend$.next(!e)}toggleLegendOnClick(){this.filtersCollapsed||this.toggleLegend(this.showLegend$.value)}setVisible(){this.layer.visible=!0}toggleFiltersCollapsed(){this.filtersCollapsed=!this.filtersCollapsed}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Fd))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-time-filter-item"]],inputs:{header:"header",layer:"layer"},decls:8,vars:7,consts:[[4,"ngIf"],[1,"igo-datasource-filters-container"],["filters",""],[1,"igo-layer-legend-container"],["legend",""],[3,"layer",4,"ngIf"],[3,"layer","options","currentValue","change","yearChange"],["mat-list-avatar","","igoCollapse","","svgIcon","chevron-up",1,"igo-chevron",3,"target","collapsed","click"],["matLine","",3,"ngStyle","click"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"color","matTooltip","click",4,"ngIf"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"color","matTooltip","click"],[3,"ngClass","svgIcon"],[3,"layer"]],template:function(e,t){1&e&&(r.YNc(0,mg,5,7,"mat-list-item",0),r.TgZ(1,"div",1,2),r.TgZ(3,"div",3,4),r.YNc(5,fg,1,1,"igo-layer-legend",5),r.ALo(6,"async"),r.qZA(),r.TgZ(7,"igo-time-filter-form",6),r.NdJ("change",function(e){return t.handleDateChange(e)})("yearChange",function(e){return t.handleYearChange(e)}),r.qZA(),r.qZA()),2&e&&(r.Q6J("ngIf",t.header),r.xp6(5),r.Q6J("ngIf",r.lcZ(6,5,t.showLegend$)),r.xp6(2),r.Q6J("layer",t.layer)("options",t.datasource.options.timeFilter)("currentValue",t.datasource.options.params.TIME))},styles:["[_nghost-%COMP%]{overflow:hidden}.igo-datasource-filters-container[_ngcontent-%COMP%]{text-align:center;width:100%;display:inline-block;padding-top:5px}.igo-layer-legend-container[_ngcontent-%COMP%]{padding-left:1.125em;width:calc(100% - 18px)}"]}),e})();function vg(e,t){if(1&e&&r._UZ(0,"igo-time-filter-item",2),2&e){const e=t.$implicit;r.Q6J("header",!0)("layer",e)}}let bg=(()=>{class e{constructor(e){this.cdRef=e,this._layers=[]}get layers(){return this._layers}set layers(e){this._layers=e,this.cdRef.detectChanges()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.sBO))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-time-filter-list"]],inputs:{layers:"layers"},decls:3,vars:6,consts:[[3,"navigation","selection"],["ngFor","",3,"ngForOf"],["igoListItem","",3,"header","layer"]],template:function(e,t){1&e&&(r.TgZ(0,"igo-list",0),r.YNc(1,vg,1,2,"ng-template",1),r.ALo(2,"filterableDataSource"),r.qZA()),2&e&&(r.Q6J("navigation",!1)("selection",!1),r.xp6(1),r.Q6J("ngForOf",r.xi3(2,3,t.layers,"time")))},encapsulation:2,changeDetection:0}),e})(),xg=(()=>{class e{constructor(){}wktToFeature(e,t,o){return(new ra.Z).readFeature(e,{dataProjection:t,featureProjection:o})}extentToWkt(e,t,o){let i=Fn.$A(t,o,e);return i=this.roundCoordinateArray(i,e,0),{wktPoly:`POLYGON((\n      ${t[0]} ${t[1]},\n      ${t[0]} ${t[3]},\n      ${t[2]} ${t[3]},\n      ${t[2]} ${t[1]},\n      ${t[0]} ${t[1]}))`,wktLine:`LINESTRING(\n      ${t[0]} ${t[1]},\n      ${t[0]} ${t[3]},\n      ${t[2]} ${t[3]},\n      ${t[2]} ${t[1]},\n      ${t[0]} ${t[1]})`,wktMultiPoints:`MULTIPOINT(\n        ${t[0]} ${t[1]},\n        ${t[0]} ${t[3]},\n        ${t[2]} ${t[3]},\n        ${t[2]} ${t[1]})`}}roundCoordinateArray(e,t,o=0){const i=Fn.U2(t).getUnits();return-1!==["ft","m","us-ft"].indexOf(i)&&(e=this.roundArray(e,o)),e}roundArray(e,t=0){let o=0;for(;o<e.length;)e[o]=e[o].toFixed(t),o++;return e}snrcToWkt(e,t){let o;e=e.toLowerCase();const i={1:{from:-56,to:-64},2:{from:-64,to:-72},3:{from:-72,to:-80},4:{from:-80,to:-88},5:{from:-88,to:-96},6:{from:-96,to:-104},7:{from:-104,to:-112},8:{from:-112,to:-120},9:{from:-120,to:-128},10:{from:-128,to:-136}},r={1:{from:44,to:48},2:{from:48,to:52},3:{from:52,to:56},4:{from:56,to:60},5:{from:60,to:64},6:{from:64,to:68},7:{from:68,to:72},8:{from:72,to:76},9:{from:76,to:-128}},s=[["m","n","o","p"],["l","k","j","i"],["e","f","g","h"],["d","c","b","a"]],n=[["13","14","15","16"],["12","11","10","09"],["05","06","07","08"],["04","03","02","01"]];let a=!1,l=!1,c=!1;if(/\d{2,3}[a-p][0,1][0-9]/gi.test(e)?c=!0:/\d{2,3}[a-p]/gi.test(e)?l=!0:/\d{2,3}/gi.test(e)&&(a=!0),a?e+="a01":l&&(e+="01"),/\d{2,3}[a-p][0,1][0-9]/gi.test(e)){const a=e.split(/(?=[a-p])/gi),u=a[0],p=a[1][0],d=a[1].split(p)[1];let h=1;3===u.length&&(h=2);const g=u.substring(0,h),m=u.substring(h),f=8,y=4,v=2,b=1,x=.5,w=.25;let S=0,C=0,T=0,A=0;s.forEach(e=>{-1!==e.indexOf(p)&&(C=s.indexOf(e),S=e.indexOf(p))}),n.forEach(e=>{-1!==e.indexOf(d)&&(A=n.indexOf(e),T=e.indexOf(d))});let Z=0,L=0,F=0,O=0,M=f,I=y;l?(Z=S*v,L=C*b,F=0,O=0,M=v,I=b):c&&(Z=S*v,L=C*b,F=T*x,O=A*w,M=x,I=w);const k={ul:[i[g].to+Z+F,r[m].to-L-O]};return k.lr=[k.ul[0]+M,k.ul[1]-I],k.ur=[k.ul[0],k.ul[1]-I],k.ll=[k.ul[0]+M,k.ul[1]],k.ul=Fn.vs([k.ul[0],k.ul[1]],"EPSG:4326",t),k.lr=Fn.vs([k.lr[0],k.lr[1]],"EPSG:4326",t),k.ur=Fn.vs([k.ur[0],k.ur[1]],"EPSG:4326",t),k.ll=Fn.vs([k.ll[0],k.ll[1]],"EPSG:4326",t),k.ul=this.roundCoordinateArray(k.ul,t,0),k.lr=this.roundCoordinateArray(k.lr,t,0),k.ur=this.roundCoordinateArray(k.ur,t,0),k.ll=this.roundCoordinateArray(k.ll,t,0),o="POLYGON(("+[k.ul.join(" "),k.ur.join(" "),k.lr.join(" "),k.ll.join(" "),k.ul.join(" ")].join(",")+"))",{wktPoly:o,wktLine:"LINESTRING("+[k.ul.join(" "),k.ur.join(" "),k.lr.join(" "),k.ll.join(" "),k.ul.join(" ")].join(",")+")",wktMultiPoints:"MULTIPOINT("+[k.ul.join(" "),k.ur.join(" "),k.lr.join(" "),k.ll.join(" ")].join(",")+")"}}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function wg(e,t){if(1&e&&(r.TgZ(0,"mat-option",23),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.alias)("id",e.name)("matTooltip",e.alias),r.xp6(1),r.hij(" ",e.alias," ")}}function Sg(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",24),r.NdJ("click",function(){return r.CHM(e),r.oxw(2).clearSelectedField()}),r._UZ(1,"mat-icon",25),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("disabled",!e.currentFilter.active)}}function Cg(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-form-field",17),r.NdJ("mouseenter",function(){return r.CHM(e),r.oxw().inputClearable="selectField"})("mouseleave",function(){return r.CHM(e),r.oxw().inputClearable=void 0}),r.TgZ(1,"input",18),r.NdJ("input",function(t){return r.CHM(e),r.oxw().updateFieldsList(t.target.value)}),r.ALo(2,"translate"),r.ALo(3,"async"),r.ALo(4,"async"),r.ALo(5,"async"),r.ALo(6,"async"),r.ALo(7,"translate"),r.qZA(),r.TgZ(8,"mat-autocomplete",19,20),r.NdJ("optionSelected",function(t){return r.CHM(e),r.oxw().changeField(t.option.id)}),r.YNc(10,wg,2,4,"mat-option",21),r.ALo(11,"async"),r.qZA(),r.YNc(12,Sg,2,1,"button",22),r.qZA()}if(2&e){const e=r.MAs(9),t=r.oxw();r.Q6J("floatLabel",t.floatLabel),r.xp6(1),r.Q6J("placeholder",r.lcZ(2,8,"igo.geo.sourceFields.selectField"))("disabled",!t.currentFilter.active)("matAutocomplete",e)("value",r.lcZ(3,10,t.selectedField$)?r.lcZ(4,12,t.selectedField$).alias:"")("matTooltip",r.lcZ(5,14,t.selectedField$)?r.lcZ(6,16,t.selectedField$).alias:r.lcZ(7,18,"igo.geo.sourceFields.selectField")),r.xp6(9),r.Q6J("ngForOf",r.lcZ(11,20,t.filteredFields$)),r.xp6(2),r.Q6J("ngIf",t.currentFilter.propertyName&&"selectField"===t.inputClearable&&t.currentFilter.active)}}function Tg(e,t){if(1&e&&(r.TgZ(0,"mat-option",3),r.ALo(1,"translate"),r._uU(2),r.ALo(3,"translate"),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.key)("matTooltip",r.lcZ(1,3,"igo.geo.operators.tooltip."+e.key)),r.xp6(2),r.hij(" ",r.lcZ(3,5,"igo.geo.operators."+e.key)," ")}}function Ag(e,t){if(1&e&&(r.TgZ(0,"mat-option",29),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.type),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.spatialSelector."+e.type)," ")}}function Zg(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-form-field",26),r.TgZ(1,"mat-select",27),r.NdJ("selectionChange",function(t){return r.CHM(e),r.oxw().changeSpatialSelector(t.value)}),r.YNc(2,Ag,3,4,"mat-option",28),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(1),r.Q6J("disabled",!e.currentFilter.active)("value",e.currentFilter.igoSpatialSelector),r.xp6(1),r.Q6J("ngForOf",e.igoSpatialSelectors)}}function Lg(e,t){if(1&e&&(r.TgZ(0,"mat-option",33),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e)("matTooltip",e),r.xp6(1),r.hij(" ",e," ")}}function Fg(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",24),r.NdJ("click",function(){return r.CHM(e),r.oxw(2).clearProperty()}),r._UZ(1,"mat-icon",25),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("disabled",!e.currentFilter.active)}}function Og(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-form-field",30),r.NdJ("mouseenter",function(){return r.CHM(e),r.oxw().inputClearable="selectProperty"})("mouseleave",function(){return r.CHM(e),r.oxw().inputClearable=void 0}),r.TgZ(1,"input",18),r.NdJ("input",function(t){return r.CHM(e),r.oxw().updateValuesList(t.target.value)}),r.ALo(2,"translate"),r.qZA(),r.TgZ(3,"mat-autocomplete",19,31),r.NdJ("optionSelected",function(t){return r.CHM(e),r.oxw().changeProperty(t.option.value)}),r.YNc(5,Lg,2,3,"mat-option",32),r.ALo(6,"async"),r.qZA(),r.YNc(7,Fg,2,1,"button",22),r.qZA()}if(2&e){const e=r.MAs(4),t=r.oxw();r.Q6J("floatLabel",t.floatLabel),r.xp6(1),r.Q6J("placeholder",r.lcZ(2,8,"igo.geo.filter.placeholder"))("disabled",!t.currentFilter.active)("matAutocomplete",e)("value","expression"===t.detectProperty()?t.currentFilter.expression:t.currentFilter.pattern)("matTooltip","expression"===t.detectProperty()?t.currentFilter.expression||"":t.currentFilter.pattern||""),r.xp6(4),r.Q6J("ngForOf",r.lcZ(6,10,t.filteredValues$)),r.xp6(2),r.Q6J("ngIf",t.isClearable()&&"selectProperty"===t.inputClearable&&t.currentFilter.active)}}function Mg(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",24),r.NdJ("click",function(){return r.CHM(e),r.oxw(2).currentFilter.igoSNRC=""}),r._UZ(1,"mat-icon",25),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("disabled",!e.currentFilter.active&&"selectSNRC"===e.inputClearable&&e.currentFilter.active)}}function Ig(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-form-field",34),r.NdJ("mouseenter",function(){return r.CHM(e),r.oxw().inputClearable="selectSNRC"})("mouseleave",function(){return r.CHM(e),r.oxw().inputClearable=void 0}),r.TgZ(1,"input",35),r.NdJ("input",function(t){return r.CHM(e),r.oxw().changeSNRC(t.target.value)}),r.ALo(2,"translate"),r.qZA(),r.YNc(3,Mg,2,1,"button",22),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("floatLabel",e.floatLabel),r.xp6(1),r.Q6J("placeholder",r.lcZ(2,5,"igo.geo.filter.placeholderSnrc"))("value",e.currentFilter.igoSNRC)("matTooltip",e.currentFilter.igoSNRC?e.currentFilter.igoSNRC:""),r.xp6(2),r.Q6J("ngIf",e.currentFilter.igoSNRC)}}function kg(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",37),r.NdJ("click",function(){return r.CHM(e),r.oxw(2).changeMapExtentGeometry()}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",38),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("disabled",!e.currentFilter.active)("disabled",!e.currentFilter.active)("matTooltip",r.lcZ(1,3,"igo.geo.spatialSelector.btnSetExtent"))}}function Pg(e,t){if(1&e&&(r.ynx(0),r.YNc(1,kg,3,5,"button",36),r.BQk()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf","fixedExtent"===e.currentFilter.igoSpatialSelector)}}function _g(e,t){if(1&e&&(r.TgZ(0,"mat-option",33),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e)("matTooltip",e),r.xp6(1),r.hij(" ",e," ")}}function $g(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",24),r.NdJ("click",function(){return r.CHM(e),r.oxw(2).clearProperty(1)}),r._UZ(1,"mat-icon",25),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("disabled",!e.currentFilter.active)}}function qg(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-form-field",39),r.NdJ("mouseenter",function(){return r.CHM(e),r.oxw().inputClearable="selectProperty1"})("mouseleave",function(){return r.CHM(e),r.oxw().inputClearable=void 0}),r.TgZ(1,"input",40),r.NdJ("input",function(t){return r.CHM(e),r.oxw().updateValuesList(t.target.value,1)}),r.ALo(2,"translate"),r.qZA(),r.TgZ(3,"mat-autocomplete",19,41),r.NdJ("optionSelected",function(t){return r.CHM(e),r.oxw().changeNumericProperty(t.option.value,1)}),r.YNc(5,_g,2,3,"mat-option",32),r.ALo(6,"async"),r.qZA(),r.YNc(7,$g,2,1,"button",22),r.qZA()}if(2&e){const e=r.MAs(4),t=r.oxw();r.Q6J("floatLabel",t.floatLabel),r.xp6(1),r.Q6J("placeholder",r.lcZ(2,7,"igo.geo.filter.placeholder"))("disabled",!t.currentFilter.active)("matAutocomplete",e)("value","lowerBoundary"===t.detectProperty(1)?t.currentFilter.lowerBoundary:t.currentFilter.begin),r.xp6(4),r.Q6J("ngForOf",r.lcZ(6,9,t.filteredValues$)),r.xp6(2),r.Q6J("ngIf",t.isClearable(1)&&"selectProperty1"===t.inputClearable&&t.currentFilter.active)}}function Dg(e,t){if(1&e&&(r.TgZ(0,"mat-option",33),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e)("matTooltip",e),r.xp6(1),r.hij(" ",e," ")}}function Eg(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",24),r.NdJ("click",function(){return r.CHM(e),r.oxw(2).clearProperty(2)}),r._UZ(1,"mat-icon",25),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("disabled",!e.currentFilter.active)}}function Rg(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-form-field",39),r.NdJ("mouseenter",function(){return r.CHM(e),r.oxw().inputClearable="selectProperty2"})("mouseleave",function(){return r.CHM(e),r.oxw().inputClearable=void 0}),r.TgZ(1,"input",40),r.NdJ("input",function(t){return r.CHM(e),r.oxw().updateValuesList(t.target.value,2)}),r.ALo(2,"translate"),r.qZA(),r.TgZ(3,"mat-autocomplete",19,42),r.NdJ("optionSelected",function(t){return r.CHM(e),r.oxw().changeNumericProperty(t.option.value,2)}),r.YNc(5,Dg,2,3,"mat-option",32),r.ALo(6,"async"),r.qZA(),r.YNc(7,Eg,2,1,"button",22),r.qZA()}if(2&e){const e=r.MAs(4),t=r.oxw();r.Q6J("floatLabel",t.floatLabel),r.xp6(1),r.Q6J("placeholder",r.lcZ(2,7,"igo.geo.filter.placeholder"))("disabled",!t.currentFilter.active)("matAutocomplete",e)("value","upperBoundary"===t.detectProperty(2)?t.currentFilter.upperBoundary:t.currentFilter.end),r.xp6(4),r.Q6J("ngForOf",r.lcZ(6,9,t.filteredValues$)),r.xp6(2),r.Q6J("ngIf",t.isClearable(2)&&"selectProperty2"===t.inputClearable&&t.currentFilter.active)}}function Ug(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-ogc-filter-time",43),r.NdJ("datasourceChange",function(t){return r.CHM(e),r.oxw().datasource=t})("currentFilterChange",function(t){return r.CHM(e),r.oxw().currentFilter=t})("changeProperty",function(t){return r.CHM(e),r.oxw().changeProperty(t.value,t.pos)}),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("datasource",e.datasource)("currentFilter",e.currentFilter)}}const Ng=function(e,t){return{logical:e,logicalHidden:t}},Jg=function(e,t){return{operator:e,dualInput:t}},Bg=function(){return["expression","pattern"]},jg=function(){return["lowerBoundary","begin"]},Gg=function(){return["upperBoundary","end"]};let Qg=(()=>{class e{constructor(e){this.wktService=e,this.ogcFilterOperator=El,this.ogcFilterOperators$=new C.X(void 0),this.value="",this.selectedField$=new C.X(void 0),this.fields$=new C.X([]),this.color="primary",this.currentFilterIsSpatial$=new C.X(!1),this.defaultStepMillisecond=6e3,this._snrc="",this.floatLabel="never",this.allOgcFilterOperators=(new Ul).operators,this.ogcFilterOperators$.next(this.allOgcFilterOperators),this.igoSpatialSelectors=[{type:"fixedExtent"},{type:"snrc"}]}set snrc(e){(/^\d{2}$/gi.test(e)||/^\d{2}[a-p]$/gi.test(e)||/^\d{2}[a-l][0,1][0-9]$/gi.test(e))&&(this._snrc=e,this.currentFilter.igoSNRC=e)}get snrc(){return this._snrc}get activeFilters(){return this.datasource.options.ogcFilters.interfaceOgcFilters.filter(e=>!0===e.active)}get allowedOperators(){return(new Ul).computeAllowedOperators(this.fields$.value,this.currentFilter.propertyName,this.datasource.options.ogcFilters.allowedOperatorsType)}ngOnInit(){if(this.datasource.options.sourceFields){const e=this.datasource.options.sourceFields.filter(e=>void 0===e.excludeFromOgcFilters||!e.excludeFromOgcFilters);e.map(e=>{e.values&&e.values.sort()}),this.fields$.next(e)}this.updateFieldsList(),this.selectedField$.next(this.fields$.value.find(e=>e.name===this.currentFilter.propertyName)),this.updateValuesList(),this.selectedField$.subscribe(e=>{this.ogcFilterOperators$.next(this.allowedOperators),-1===Object.keys(this.allowedOperators).indexOf(this.currentFilter.operator)&&(this.currentFilter.operator=Object.keys(this.allowedOperators)[0],this.currentFilter.operator=Object.keys(this.allowedOperators)[0]),this.updateValuesList()}),this.currentFilterIsSpatial()}updateFieldsList(e){this.filteredFields$=e&&e.length>0?(0,A.of)(this._filterFields(e)):this.fields$,this.fields$.value.find(t=>t.name===e)&&this.changeField(e)}updateValuesList(e,t){this.filteredValues$=(0,A.of)(e&&e.length>0?this._filterValues(e):this.selectedField$.value?this.selectedField$.value.values:[]),e&&e.length>=1&&this.changeProperty(e,t)}_filterFields(e){const t=new RegExp(e.normalize("NFD").replace(/[\u0300-\u036f]/g,""),"gi");return this.fields$.value.filter(e=>t.test(e.alias.normalize("NFD").replace(/[\u0300-\u036f]/g,"")))}_filterValues(e){const t=new RegExp(e.toString().normalize("NFD").replace(/[\u0300-\u036f]/g,""),"gi");return this.selectedField$.value.values.filter(e=>e&&t.test(e.toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"")))}clearSelectedField(){this.currentFilter.propertyName="",this.selectedField$.next(void 0),this.clearProperty()}isClearable(e){const t=this.detectProperty(e);if(t)return this.currentFilter[t]}clearProperty(e){const t=this.detectProperty(e);if(t)return this.currentFilter[t]=""}toggleFilterState(e){this.datasource.options.ogcFilters.interfaceOgcFilters.find(e=>e.filterid===this.currentFilter.filterid).active=e.checked,this.refreshFilters()}deleteFilter(){const e=this.datasource.options.ogcFilters;e.interfaceOgcFilters=e.interfaceOgcFilters.filter(e=>e.filterid!==this.currentFilter.filterid),this.refreshFilters()}changeLogical(e){this.currentFilter.parentLogical=e,this.refreshFilters()}changeOperator(e){this.currentFilter.operator=e,this.currentFilterIsSpatial(),this.currentFilterIsSpatial$.value&&0===this.currentFilter.wkt_geometry.length?this.changeSpatialSelector(this.currentFilter.igoSpatialSelector):this.refreshFilters()}changeField(e){this.currentFilter.propertyName=e,this.selectedField$.next(this.fields$.value.find(e=>e.name===this.currentFilter.propertyName)),this.refreshFilters()}changeCaseSensitive(e){this.currentFilter.matchCase=e.checked,this.refreshFilters()}changeProperty(e,t,o=!0){const i=this.detectProperty(t);i&&(this.datasource.options.ogcFilters.interfaceOgcFilters.find(e=>e.filterid===this.currentFilter.filterid)[i]=e,o&&this.refreshFilters())}changeNumericProperty(e,t){this.changeProperty(parseFloat(e),t)}changeSpatialSelector(e){this.currentFilter.igoSpatialSelector=e,"fixedExtent"===e&&this.changeMapExtentGeometry(!1),this.currentFilterIsSpatial(),this.refreshFilters()}changeSNRC(e){this.snrc=e,this.changeSNRCGeometry()}changeSNRCGeometry(){!this.datasource.options.ogcFilters.interfaceOgcFilters.find(e=>e.filterid===this.currentFilter.filterid)||(this.snrc&&"snrc"===this.currentFilter.igoSpatialSelector&&(this.currentFilter.wkt_geometry=this.wktService.snrcToWkt(this.snrc,this.map.projection).wktPoly),this.refreshFilters())}changeMapExtentGeometry(e=!0){!this.datasource.options.ogcFilters.interfaceOgcFilters.find(e=>e.filterid===this.currentFilter.filterid)||("fixedExtent"===this.currentFilter.igoSpatialSelector&&(this.currentFilter.wkt_geometry=this.wktService.extentToWkt(this.map.projection,this.map.viewController.getExtent(),this.map.projection).wktPoly),e&&this.refreshFilters())}detectProperty(e){switch(this.currentFilter.operator){case El.PropertyIsNotEqualTo:case El.PropertyIsEqualTo:case El.PropertyIsGreaterThan:case El.PropertyIsGreaterThanOrEqualTo:case El.PropertyIsLessThan:case El.PropertyIsLessThanOrEqualTo:return"expression";case El.PropertyIsLike:return"pattern";case El.PropertyIsBetween:return e&&1===e?"lowerBoundary":e&&2===e?"upperBoundary":void 0;case El.During:return e&&1===e?"begin":e&&2===e?"end":void 0;default:return}}currentFilterIsSpatial(){let e=!1;this.currentFilter&&(e=-1!==[El.Contains,El.Intersects,El.Within].indexOf(this.currentFilter.operator)),this.currentFilterIsSpatial$.next(e)}isTemporalOperator(){return this.currentFilter.operator.toLowerCase()===this.ogcFilterOperator.During.toLowerCase()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(xg))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-ogc-filter-form"]],inputs:{refreshFilters:"refreshFilters",datasource:"datasource",map:"map",currentFilter:"currentFilter",floatLabel:"floatLabel"},decls:42,vars:76,consts:[["tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","checked","click","change"],[3,"ngClass"],["tooltip-position","above","matTooltipShowDelay","500",3,"disabled","value","matTooltip","selectionChange"],["tooltip-position","above","matTooltipShowDelay","500",3,"value","matTooltip"],["class","field",3,"floatLabel","mouseenter","mouseleave",4,"ngIf"],[3,"ngClass","floatLabel"],["tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","disabled","value","selectionChange"],["tooltip-position","above","matTooltipShowDelay","500",3,"value","matTooltip",4,"ngFor","ngForOf"],["class","spatialSelector",4,"ngIf"],["class","singleInput",3,"floatLabel","mouseenter","mouseleave",4,"ngIf"],[1,"igo-layer-button-group"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip","click"],["svgIcon","delete"],["class","snrc",3,"floatLabel","mouseenter","mouseleave",4,"ngIf"],[4,"ngIf"],["class","dualInput",3,"floatLabel","mouseenter","mouseleave",4,"ngIf"],[3,"datasource","currentFilter","datasourceChange","currentFilterChange","changeProperty",4,"ngIf"],[1,"field",3,"floatLabel","mouseenter","mouseleave"],["matInput","","tooltip-position","above","matTooltipShowDelay","500",3,"placeholder","disabled","matAutocomplete","value","matTooltip","input"],[3,"optionSelected"],["autoCompleteField","matAutocomplete"],["matTooltipShowDelay","500",3,"value","id","matTooltip",4,"ngFor","ngForOf"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"disabled","click",4,"ngIf"],["matTooltipShowDelay","500",3,"value","id","matTooltip"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"disabled","click"],["svgIcon","close"],[1,"spatialSelector"],[3,"disabled","value","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"singleInput",3,"floatLabel","mouseenter","mouseleave"],["autoCompleteValues","matAutocomplete"],["matTooltipShowDelay","500",3,"value","matTooltip",4,"ngFor","ngForOf"],["matTooltipShowDelay","500",3,"value","matTooltip"],[1,"snrc",3,"floatLabel","mouseenter","mouseleave"],["matInput","","tooltip-position","above","matTooltipShowDelay","500",3,"placeholder","value","matTooltip","input"],["mat-button","","matSuffix","","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"disabled","matTooltip","click",4,"ngIf"],["mat-button","","matSuffix","","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"disabled","matTooltip","click"],["svgIcon","arrow-expand-all"],[1,"dualInput",3,"floatLabel","mouseenter","mouseleave"],["matInput","","type","number",3,"placeholder","disabled","matAutocomplete","value","input"],["autoDualValueOperator1","matAutocomplete"],["autoDualValueOperator2","matAutocomplete"],[3,"datasource","currentFilter","datasourceChange","currentFilterChange","changeProperty"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-checkbox",0),r.NdJ("click",function(e){return e.stopPropagation()})("change",function(e){return t.toggleFilterState(e)}),r.ALo(1,"translate"),r.qZA(),r.TgZ(2,"mat-form-field",1),r.TgZ(3,"mat-select",2),r.NdJ("selectionChange",function(e){return t.changeLogical(e.value)}),r.ALo(4,"translate"),r.TgZ(5,"mat-option",3),r.ALo(6,"translate"),r._uU(7),r.ALo(8,"translate"),r.qZA(),r.TgZ(9,"mat-option",3),r.ALo(10,"translate"),r._uU(11),r.ALo(12,"translate"),r.qZA(),r.qZA(),r.qZA(),r.YNc(13,Cg,13,22,"mat-form-field",4),r.ALo(14,"async"),r.ALo(15,"async"),r.ALo(16,"async"),r.ALo(17,"async"),r.TgZ(18,"mat-form-field",5),r.ALo(19,"async"),r.ALo(20,"async"),r.TgZ(21,"mat-select",6),r.NdJ("selectionChange",function(e){return t.changeOperator(e.value)}),r.ALo(22,"translate"),r.ALo(23,"translate"),r.YNc(24,Tg,4,7,"mat-option",7),r.ALo(25,"keyvalue"),r.ALo(26,"async"),r.qZA(),r.qZA(),r.YNc(27,Zg,3,3,"mat-form-field",8),r.ALo(28,"async"),r.YNc(29,Og,8,12,"mat-form-field",9),r.TgZ(30,"div",10),r.TgZ(31,"button",11),r.NdJ("click",function(){return t.deleteFilter()}),r.ALo(32,"translate"),r._UZ(33,"mat-icon",12),r.qZA(),r.qZA(),r.YNc(34,Ig,4,7,"mat-form-field",13),r.ALo(35,"async"),r.YNc(36,Pg,2,1,"ng-container",14),r.ALo(37,"async"),r._UZ(38,"br"),r.YNc(39,qg,8,11,"mat-form-field",15),r.YNc(40,Rg,8,11,"mat-form-field",15),r.YNc(41,Ug,1,2,"igo-ogc-filter-time",16)),2&e&&(r.Q6J("matTooltip",r.lcZ(1,27,"igo.geo.filter.toggleFilterState"))("checked",t.currentFilter.active),r.xp6(2),r.Q6J("ngClass",r.WLB(67,Ng,0!==t.activeFilters.indexOf(t.currentFilter)&&!0===t.currentFilter.active,0===t.activeFilters.indexOf(t.currentFilter)||!0!==t.currentFilter.active)),r.xp6(1),r.Q6J("disabled",!t.currentFilter.active)("value",t.currentFilter.parentLogical)("matTooltip",t.currentFilter.parentLogical?r.lcZ(4,29,"igo.geo.operators.tooltip."+t.currentFilter.parentLogical):""),r.xp6(2),r.Q6J("value",t.ogcFilterOperator.And)("matTooltip",r.lcZ(6,31,"igo.geo.operators.tooltip.And")),r.xp6(2),r.hij(" ",r.lcZ(8,33,"igo.geo.operators.And")," "),r.xp6(2),r.Q6J("value",t.ogcFilterOperator.Or)("matTooltip",r.lcZ(10,35,"igo.geo.operators.tooltip.Or")),r.xp6(2),r.hij(" ",r.lcZ(12,37,"igo.geo.operators.Or")," "),r.xp6(2),r.Q6J("ngIf",!r.lcZ(14,39,t.currentFilterIsSpatial$)&&r.lcZ(15,41,t.fields$)&&r.lcZ(16,43,t.fields$).length>0&&""!==r.lcZ(17,45,t.fields$)[0].name),r.xp6(5),r.Q6J("ngClass",r.WLB(70,Jg,!r.lcZ(19,47,t.currentFilterIsSpatial$),r.lcZ(20,49,t.currentFilterIsSpatial$)))("floatLabel",t.floatLabel),r.xp6(3),r.Q6J("matTooltip",t.currentFilter.operator?r.lcZ(22,51,"igo.geo.operators.tooltip."+t.currentFilter.operator):r.lcZ(23,53,"igo.geo.filter.selectOperator"))("disabled",!t.currentFilter.active)("value",t.currentFilter.operator),r.xp6(3),r.Q6J("ngForOf",r.lcZ(25,55,r.lcZ(26,57,t.ogcFilterOperators$))),r.xp6(3),r.Q6J("ngIf",r.lcZ(28,59,t.currentFilterIsSpatial$)),r.xp6(2),r.Q6J("ngIf",-1!==r.DdM(73,Bg).indexOf(t.detectProperty())),r.xp6(2),r.Q6J("matTooltip",r.lcZ(32,61,"igo.geo.filter.removeFilter")),r.xp6(3),r.Q6J("ngIf",r.lcZ(35,63,t.currentFilterIsSpatial$)&&"snrc"===t.currentFilter.igoSpatialSelector),r.xp6(2),r.Q6J("ngIf",r.lcZ(37,65,t.currentFilterIsSpatial$)&&"fixedExtent"===t.currentFilter.igoSpatialSelector),r.xp6(3),r.Q6J("ngIf",!t.isTemporalOperator()&&-1!==r.DdM(74,jg).indexOf(t.detectProperty(1))),r.xp6(1),r.Q6J("ngIf",!t.isTemporalOperator()&&-1!==r.DdM(75,Gg).indexOf(t.detectProperty(2))),r.xp6(1),r.Q6J("ngIf",t.isTemporalOperator()))},styles:["[_nghost-%COMP%]{width:100%;padding:5px 10px}  .mat-form-field .mat-icon svg{width:1em;height:1em;color:#d3d3d3}.mat-form-field[_ngcontent-%COMP%]{width:100%}.mat-select-arrow[_ngcontent-%COMP%]{visibility:hidden}.mat-slide-toggle[_ngcontent-%COMP%]{margin-top:10px}.logical[_ngcontent-%COMP%]{flex-flow:column nowrap;width:10%;max-width:45px;margin-left:5px}.logicalHidden[_ngcontent-%COMP%]{flex-flow:column nowrap;width:10%;visibility:hidden;max-width:45px;margin-left:5px}  .logical .mat-select-arrow{visibility:hidden}  .logicalHidden .mat-select-arrow{visibility:hidden}.field[_ngcontent-%COMP%]{width:20%;margin-left:5px}  .field .mat-select-arrow{visibility:hidden}.operator[_ngcontent-%COMP%]{width:12%;margin-left:10px;text-align:center}  .operator .mat-select-arrow{visibility:hidden}.spatialSelector[_ngcontent-%COMP%]{width:15%;margin-left:5px}  .spatialSelector .mat-select-arrow{visibility:hidden}.singleInput[_ngcontent-%COMP%]{width:30%;margin-left:5px}.snrc[_ngcontent-%COMP%]{width:20%;margin-left:5px}  .singleInput .mat-select-arrow{visibility:hidden}.dualInput[_ngcontent-%COMP%]{width:20%;margin-left:5px}  .dualInput .mat-select-arrow{visibility:hidden}.igo-layer-button-group[_ngcontent-%COMP%]{display:flex;float:right;padding-top:5px}.container[_ngcontent-%COMP%]{display:flex}"]}),e})();function zg(e,t){if(1&e&&r._UZ(0,"igo-ogc-filter-selection",2),2&e){const e=r.oxw();r.Q6J("refreshFilters",e.refreshFunc)("datasource",e.datasource)("map",e.map)("currentFilter",e.currentFilter)}}function Yg(e,t){if(1&e&&r._UZ(0,"igo-ogc-filter-form",4),2&e){const e=t.$implicit,o=r.oxw(2);r.Q6J("currentFilter",e)("refreshFilters",o.refreshFunc)("datasource",o.datasource)("map",o.map)}}function Hg(e,t){if(1&e&&r.YNc(0,Yg,1,4,"ng-template",3),2&e){const e=r.oxw();r.Q6J("ngForOf",e.datasource.options.ogcFilters.interfaceOgcFilters)}}let Vg=(()=>{class e{constructor(){this.color="primary"}get refreshFunc(){return this.refreshFilters}get advancedOgcFilters(){if(this.datasource.options.ogcFilters)return this.datasource.options.ogcFilters.advancedOgcFilters}get currentFilter(){return this.datasource.options.ogcFilters.interfaceOgcFilters?this.datasource.options.ogcFilters.interfaceOgcFilters[0]:void 0}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-ogc-filterable-form"]],inputs:{datasource:"datasource",map:"map",refreshFilters:"refreshFilters"},decls:2,vars:2,consts:[["igoListItem","",3,"refreshFilters","datasource","map","currentFilter",4,"ngIf"],[4,"ngIf"],["igoListItem","",3,"refreshFilters","datasource","map","currentFilter"],["ngFor","",3,"ngForOf"],[3,"currentFilter","refreshFilters","datasource","map"]],template:function(e,t){1&e&&(r.YNc(0,zg,1,4,"igo-ogc-filter-selection",0),r.YNc(1,Hg,1,1,void 0,1)),2&e&&(r.Q6J("ngIf",!t.advancedOgcFilters),r.xp6(1),r.Q6J("ngIf",t.advancedOgcFilters&&t.datasource.options.ogcFilters.editable))},encapsulation:2}),e})();function Wg(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-icon",8),r.NdJ("click",function(){return r.CHM(e),r.oxw().toggleFiltersCollapsed()}),r.qZA()}if(2&e){const e=r.oxw(),t=r.MAs(6);r.Q6J("target",t)("collapsed",e.filtersCollapsed)}}const Xg=function(e){return{cursor:e}};function Kg(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"h4",9),r.NdJ("click",function(){return r.CHM(e),r.oxw().toggleLegendOnClick()}),r._uU(1),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("ngStyle",r.VKq(3,Xg,e.filtersCollapsed?"default":"pointer"))("matTooltip",e.layer.title),r.xp6(1),r.Oqu(e.layer.title)}}function em(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",10),r.NdJ("click",function(){return r.CHM(e),r.oxw().addFilterToSequence()}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",11),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("disabled",e.addFilterDisabled())("matTooltip",r.lcZ(1,3,"igo.geo.filter.addFilter"))("color",e.color)}}const tm=function(e){return{disabled:e}};function om(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",12),r.NdJ("click",function(){r.CHM(e);const t=r.oxw();return t.layer.visible=!t.layer.visible}),r.ALo(1,"translate"),r.ALo(2,"translate"),r._UZ(3,"mat-icon",13),r.ALo(4,"async"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("color",e.layer.visible?"primary":"default")("matTooltip",e.layer.visible?r.lcZ(1,4,"igo.geo.layer.hideLayer"):r.lcZ(2,6,"igo.geo.layer.showLayer")),r.xp6(3),r.Q6J("ngClass",r.VKq(10,tm,!r.lcZ(4,8,e.inResolutionRange$)))("svgIcon",e.layer.visible?"eye":"eye-off")}}function im(e,t){if(1&e&&r._UZ(0,"igo-layer-legend",17),2&e){const e=r.oxw(2);r.Q6J("layer",e.layer)}}function rm(e,t){if(1&e&&(r.TgZ(0,"div",14,15),r.YNc(2,im,1,1,"igo-layer-legend",16),r.ALo(3,"async"),r.qZA()),2&e){const e=r.oxw();r.xp6(2),r.Q6J("ngIf",r.lcZ(3,1,e.showLegend$))}}function sm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"section",18),r._UZ(1,"mat-divider"),r.TgZ(2,"mat-checkbox",19),r.NdJ("change",function(t){return r.CHM(e),r.oxw().changeOgcFilterType(t)})("ngModelChange",function(t){return r.CHM(e),r.oxw().datasource.options.ogcFilters.advancedOgcFilters=t}),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(2),r.Q6J("ngModel",e.datasource.options.ogcFilters.advancedOgcFilters),r.xp6(1),r.hij(" ",r.lcZ(4,2,"igo.geo.filter.advancedOgcFilters")," ")}}let nm=(()=>{class e{constructor(e){this.ogcFilterService=e,this.color="primary",this.defaultLogicalParent=El.And,this.hasActiveSpatialFilter=!1,this.filtersAreEditable=!0,this.filtersCollapsed=!0,this.hasSelector=!1,this.showLegend$=new C.X(!1),this.inResolutionRange$=new C.X(!0),this.header=!0,this.ogcFilterWriter=new Ul}get refreshFunc(){return this.refreshFilters.bind(this)}get datasource(){return this.layer.dataSource}ngOnInit(){const e=this.datasource.options.ogcFilters;switch((e.pushButtons&&e.pushButtons.bundles.length>0||e.checkboxes&&e.checkboxes.bundles.length>0||e.radioButtons&&e.radioButtons.bundles.length>0||e.select&&e.select.bundles.length>0)&&(void 0===e.advancedOgcFilters&&(e.advancedOgcFilters=!1),this.hasSelector=!0),this.datasource.options.type){case"wms":this.ogcFilterService.setOgcWMSFiltersOptions(this.datasource);break;case"wfs":this.ogcFilterService.setOgcWFSFiltersOptions(this.datasource)}e&&(e.interfaceOgcFilters&&(this.lastRunOgcFilter=JSON.parse(JSON.stringify(e.interfaceOgcFilters)),e.interfaceOgcFilters.filter(e=>e.wkt_geometry).length>=1&&(this.hasActiveSpatialFilter=!0)),this.filtersAreEditable=!!e.editable&&e.editable),this.resolution$$=this.layer.map.viewController.resolution$.subscribe(()=>{this.inResolutionRange$.next(this.layer.isInResolutionsRange)})}ngOnDestroy(){this.resolution$$.unsubscribe()}addFilterToSequence(){this.filtersCollapsed=!1;const e=this.datasource.options.ogcFilters.interfaceOgcFilters||[],t=0===e.length?0:e[e.length-1].level;let o="";const i=this.datasource.options.sourceFields.filter(e=>!e.excludeFromOgcFilters);let r;i.length>0&&(o=void 0===i[0].name?"":i[0].name);const s=this.datasource.options;s.fieldNameGeometry?r=s.fieldNameGeometry:this.datasource.options.paramsWFS&&this.datasource.options.paramsWFS.fieldNameGeometry&&(r=this.datasource.options.paramsWFS.fieldNameGeometry);const n=this.ogcFilterWriter.computeAllowedOperators(this.datasource.options.sourceFields,o,this.datasource.options.ogcFilters.allowedOperatorsType),a=Object.keys(n)[0];e.push(this.ogcFilterWriter.addInterfaceFilter({propertyName:o,operator:a,active:!0,igoSpatialSelector:"fixedExtent",srsName:this.map.projection},r,t,this.defaultLogicalParent)),this.datasource.options.ogcFilters.interfaceOgcFilters=e}refreshFilters(e){!0===e&&(this.lastRunOgcFilter=void 0);const t=this.datasource.options.ogcFilters,o=t.interfaceOgcFilters?t.interfaceOgcFilters.filter(e=>!0===e.active):[];if(0===o.length&&(t.filters=void 0,t.filtered=!1),o.length>1&&(o[0].parentLogical=o[1].parentLogical),this.hasActiveSpatialFilter=0!==o.filter(e=>-1!==["Contains","Intersects","Within"].indexOf(e.operator)).length,JSON.stringify(this.lastRunOgcFilter)!==JSON.stringify(o)){if("wfs"===this.layer.dataSource.options.type)this.layer.dataSource.options.ogcFilters.filters=this.ogcFilterWriter.rebuiltIgoOgcFilterObjectFromSequence(o),this.layer.dataSource.ol.refresh();else if("wms"===this.layer.dataSource.options.type&&t.enabled){let e="";if(o.length>=1){const t=this.layer.dataSource,i=t.options.ogcFilters;i.filters=this.ogcFilterWriter.rebuiltIgoOgcFilterObjectFromSequence(o),e=this.ogcFilterWriter.buildFilter(i.filters,void 0,void 0,this.layer.dataSource.options.fieldNameGeometry,t.options)}this.ogcFilterService.filterByOgc(this.datasource,e),this.datasource.options.ogcFilters.filtered=0!==o.length}this.lastRunOgcFilter=JSON.parse(JSON.stringify(o))}this.layer.dataSource.setOgcFilters(t,!0)}setVisible(){this.layer.visible=!0}isAdvancedOgcFilters(){return this.datasource.options.ogcFilters.advancedOgcFilters}addFilterDisabled(){return!this.datasource.options.sourceFields||0===this.datasource.options.sourceFields.length}changeOgcFiltersAdvancedOgcFilters(e){this.datasource.options.ogcFilters.advancedOgcFilters=e}changeOgcFilterType(e){this.changeOgcFiltersAdvancedOgcFilters(e.checked),e.checked&&this.refreshFilters(!0)}toggleLegend(e){this.layer.legendCollapsed=e,this.showLegend$.next(!e)}toggleLegendOnClick(){this.filtersCollapsed||this.toggleLegend(this.showLegend$.value)}toggleFiltersCollapsed(){this.filtersCollapsed=!this.filtersCollapsed}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Od))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-ogc-filterable-item"]],inputs:{layer:"layer",map:"map",header:"header"},decls:10,vars:9,consts:[["class","igo-chevron","mat-list-avatar","","igoCollapse","","svgIcon","chevron-up",3,"target","collapsed","click",4,"ngIf"],["matLine","","matTooltipShowDelay","500",3,"ngStyle","matTooltip","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"disabled","matTooltip","color","click",4,"ngIf"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"color","matTooltip","click",4,"ngIf"],["ogcFilters",""],["class","igo-layer-legend-container",4,"ngIf"],[3,"datasource","map","refreshFilters"],["class","mat-typography advancedOgcFilters",4,"ngIf"],["mat-list-avatar","","igoCollapse","","svgIcon","chevron-up",1,"igo-chevron",3,"target","collapsed","click"],["matLine","","matTooltipShowDelay","500",3,"ngStyle","matTooltip","click"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"disabled","matTooltip","color","click"],["svgIcon","plus"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"color","matTooltip","click"],[3,"ngClass","svgIcon"],[1,"igo-layer-legend-container"],["legend",""],[3,"layer",4,"ngIf"],[3,"layer"],[1,"mat-typography","advancedOgcFilters"],["labelPosition","before",3,"ngModel","change","ngModelChange"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-list-item"),r.YNc(1,Wg,1,2,"mat-icon",0),r.YNc(2,Kg,2,5,"h4",1),r.YNc(3,em,3,5,"button",2),r.YNc(4,om,5,12,"button",3),r.qZA(),r.TgZ(5,"div",null,4),r.YNc(7,rm,4,3,"div",5),r._UZ(8,"igo-ogc-filterable-form",6),r.YNc(9,sm,5,4,"section",7),r.qZA()),2&e&&(r.xp6(1),r.Q6J("ngIf",t.header),r.xp6(1),r.Q6J("ngIf",t.header),r.xp6(1),r.Q6J("ngIf",t.isAdvancedOgcFilters()&&t.filtersAreEditable),r.xp6(1),r.Q6J("ngIf",t.header),r.xp6(3),r.Q6J("ngIf",t.header),r.xp6(1),r.Q6J("datasource",t.datasource)("map",t.map)("refreshFilters",t.refreshFunc),r.xp6(1),r.Q6J("ngIf",t.hasSelector&&t.filtersAreEditable))},styles:["[_nghost-%COMP%]{overflow:hidden}.advancedOgcFilters[_ngcontent-%COMP%]{text-align:center;width:100%;display:inline-block}.mat-list-item[_ngcontent-%COMP%]{height:auto}.igo-layer-legend-container[_ngcontent-%COMP%]{padding-left:1.125em;width:calc(100% - 18px)}mat-icon.disabled[_ngcontent-%COMP%]{color:#00000061}"]}),e})();function am(e,t){if(1&e&&r._UZ(0,"igo-ogc-filterable-item",2),2&e){const e=t.$implicit;r.Q6J("header",!0)("layer",e)("map",e.map)}}let lm=(()=>{class e{constructor(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-ogc-filterable-list"]],inputs:{layers:"layers",map:"map"},decls:3,vars:6,consts:[[3,"navigation","selection"],["ngFor","",3,"ngForOf"],["igoListItem","",3,"header","layer","map"]],template:function(e,t){1&e&&(r.TgZ(0,"igo-list",0),r.YNc(1,am,1,3,"ng-template",1),r.ALo(2,"filterableDataSource"),r.qZA()),2&e&&(r.Q6J("navigation",!1)("selection",!1),r.xp6(1),r.Q6J("ngForOf",r.xi3(2,3,t.layers,"ogc")))},encapsulation:2,changeDetection:0}),e})();function cm(e,t){if(1&e&&(r.TgZ(0,"button",2),r.ALo(1,"translate"),r._UZ(2,"mat-icon",3),r.qZA()),2&e){const e=r.oxw();r.Q6J("matTooltip",r.lcZ(1,3,"igo.geo.filter.filterBy"))("color",e.color),r.xp6(2),r.Q6J("matBadge",e.badge)}}function um(e,t){if(1&e&&r._UZ(0,"igo-ogc-filterable-item",7),2&e){const e=r.oxw(2);r.Q6J("header",!1)("map",e.layer.map)("layer",e.layer)}}function pm(e,t){if(1&e&&(r.TgZ(0,"div",4,5),r.YNc(2,um,1,3,"igo-ogc-filterable-item",6),r.qZA()),2&e){const e=r.oxw();r.xp6(2),r.Q6J("ngIf",e.ogcFilterCollapse&&e.options.ogcFilters.enabled)}}let dm=(()=>{class e{constructor(){this.color="primary",this.ogcFilterCollapse=!1}get badge(){const e=this.options.ogcFilters;let t=0;if(e&&!e.advancedOgcFilters){if(e.pushButtons){const o=e.pushButtons.groups.find(e=>e.enabled);let i=0;o&&o.computedSelectors.map(e=>i+=e.selectors.filter(e=>e.enabled).length),t+=i}if(e.checkboxes){const o=e.checkboxes.groups.find(e=>e.enabled);let i=0;o&&o.computedSelectors.map(e=>i+=e.selectors.filter(e=>e.enabled).length),t+=i}if(e.radioButtons){const o=e.radioButtons.groups.find(e=>e.enabled);let i=0;o&&o.computedSelectors.map(e=>i+=e.selectors.filter(e=>e.enabled).length),t+=i}if(e.select){const o=e.select.groups.find(e=>e.enabled);let i=0;o&&o.computedSelectors.map(e=>i+=e.selectors.filter(e=>e.enabled).length),t+=i}}else{if(e&&e.filters&&!e.filters.filters)return 1;if(e&&e.filters&&e.filters.filters)return e.filters.filters.length}return t>0?t:void 0}get layer(){return this._layer}set layer(e){this._layer=e,e&&(this.options=this.layer.dataSource.options)}ngOnInit(){this.options=this.layer.dataSource.options}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-ogc-filter-button"]],inputs:{layer:"layer",map:"map",color:"color",header:"header"},decls:2,vars:2,consts:[["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color",4,"ngIf"],["class","igo-layer-actions-container",4,"ngIf"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color"],["matBadgeColor","warn","matBadgeSize","medium","svgIcon","filter",3,"matBadge"],[1,"igo-layer-actions-container"],["ogcFilter",""],["igoListItem","",3,"header","map","layer",4,"ngIf"],["igoListItem","",3,"header","map","layer"]],template:function(e,t){1&e&&(r.YNc(0,cm,3,5,"button",0),r.YNc(1,pm,3,1,"div",1)),2&e&&(r.Q6J("ngIf",t.header&&t.options.ogcFilters&&t.options.ogcFilters.enabled&&(t.options.ogcFilters.pushButtons||t.options.ogcFilters.checkboxes||t.options.ogcFilters.radioButtons||t.options.ogcFilters.select||t.options.ogcFilters.editable)),r.xp6(1),r.Q6J("ngIf",t.options.ogcFilters&&t.options.ogcFilters.enabled&&(t.options.ogcFilters.pushButtons||t.options.ogcFilters.checkboxes||t.options.ogcFilters.radioButtons||t.options.ogcFilters.select||t.options.ogcFilters.editable)))},styles:[""],changeDetection:0}),e})();const hm=na;let gm=(()=>{class e{constructor(){this.defaultStepMillisecond=6e4}step(e,t){return e.options.stepDate?e.options.stepDate:t.step}stepMillisecond(e,t){const o=hm.duration(this.step(e,t)).asMilliseconds();return 0===o?this.defaultStepMillisecond:o}stepIsYearDuration(e){const t=hm.duration(e);return 0!==t.years()&&0===t.months()&&0===t.weeks()&&0===t.days()&&0===t.hours()&&0===t.minutes()}stepIsMonthDuration(e){const t=hm.duration(e);return 0!==t.months()&&0===t.weeks()&&0===t.days()&&0===t.hours()&&0===t.minutes()}stepIsWeekDuration(e){const t=hm.duration(e);return 0!==t.weeks()&&7===t.days()&&0===t.hours()&&0===t.minutes()}stepIsDayDuration(e){const t=hm.duration(e);return 0!==t.days()&&0===t.hours()&&0===t.minutes()}stepIsHourDuration(e){const t=hm.duration(e);return 0!==t.hours()&&0===t.minutes()}stepIsMinuteDuration(e){return 0!==hm.duration(e).minutes()}dateToNumber(e){let t=new Date;return e&&(t=new Date(e)),t.getTime()}addStep(e,t){return hm(e).add(t,"milliseconds").toDate()}subtractStep(e,t){return hm(e).subtract(t,"milliseconds").toDate()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})();const mm=["selection"];function fm(e,t){if(1&e&&(r.TgZ(0,"mat-option",12),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.hij("",e.title," ")}}function ym(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",9),r.TgZ(1,"mat-form-field"),r.TgZ(2,"mat-select",10),r.NdJ("valueChange",function(t){return r.CHM(e),r.oxw(3).currentPushButtonsGroup=t}),r.ALo(3,"translate"),r.YNc(4,fm,2,2,"mat-option",11),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(3);r.xp6(2),r.Q6J("matTooltip",r.lcZ(3,3,"igo.geo.layer.legend.selectStyle"))("value",e.currentPushButtonsGroup),r.xp6(2),r.Q6J("ngForOf",e.getPushButtonsGroups())}}function vm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-button-toggle",15),r.NdJ("change",function(){const t=r.CHM(e).$implicit,o=r.oxw(3).$implicit;return r.oxw().onSelectionChange(t,o.selectorType)}),r._uU(1),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(4);r.Q6J("matTooltip",o.getToolTip(e))("ngStyle",o.getButtonColor(e))("checked",e.enabled)("value",e),r.xp6(1),r.hij("",e.title," ")}}function bm(e,t){if(1&e&&(r.ynx(0),r.TgZ(1,"h4"),r._uU(2),r.qZA(),r.TgZ(3,"mat-button-toggle-group",13),r.YNc(4,vm,2,5,"mat-button-toggle",14),r.qZA(),r.BQk()),2&e){const e=t.$implicit,o=r.oxw(3);r.xp6(2),r.Oqu(e.title),r.xp6(1),r.s9C("vertical",o.bundleIsVertical(e)),r.xp6(1),r.Q6J("ngForOf",e.selectors)}}function xm(e,t){if(1&e&&(r.TgZ(0,"div",7),r._UZ(1,"mat-divider"),r.YNc(2,ym,5,5,"div",8),r.YNc(3,bm,5,3,"ng-container",1),r.qZA()),2&e){const e=r.oxw(2);r.xp6(2),r.Q6J("ngIf",e.getPushButtonsGroups().length>1),r.xp6(1),r.Q6J("ngForOf",e.currentPushButtonsGroup.computedSelectors)}}function wm(e,t){if(1&e&&(r.TgZ(0,"mat-option",12),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.hij("",e.title," ")}}function Sm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",9),r.TgZ(1,"mat-form-field"),r.TgZ(2,"mat-select",17),r.NdJ("valueChange",function(t){return r.CHM(e),r.oxw(3).currentCheckboxesGroup=t}),r.ALo(3,"translate"),r.YNc(4,wm,2,2,"mat-option",11),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(3);r.xp6(2),r.Q6J("matTooltip",r.lcZ(3,3,"igo.geo.layer.legend.selectStyle"))("value",e.currentCheckboxesGroup),r.xp6(2),r.Q6J("ngForOf",e.getCheckboxesGroups())}}function Cm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-checkbox",20),r.NdJ("change",function(){const t=r.CHM(e).$implicit,o=r.oxw(3).$implicit;return r.oxw().onSelectionChange(t,o.selectorType)}),r._uU(1),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(4);r.Q6J("matTooltip",o.getToolTip(e))("checked",e.enabled)("value",e),r.xp6(1),r.hij("",e.title," ")}}function Tm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"u",23),r.NdJ("click",function(){return r.CHM(e),r.oxw(5).displayLessResults("checkbox")}),r._uU(1),r.ALo(2,"translate"),r.qZA()}2&e&&(r.xp6(1),r.hij("",r.lcZ(2,1,"igo.geo.filter.displayLessResults")," "))}function Am(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"u",24),r.NdJ("click",function(){return r.CHM(e),r.oxw(5).displayMoreResults("checkbox")}),r._uU(1),r.ALo(2,"translate"),r.qZA()}2&e&&(r.xp6(1),r.hij("",r.lcZ(2,1,"igo.geo.filter.displayMoreResults")," "))}function Zm(e,t){if(1&e&&(r.TgZ(0,"p"),r.YNc(1,Tm,3,3,"u",21),r.YNc(2,Am,3,3,"u",22),r.qZA()),2&e){const e=r.oxw().$implicit,t=r.oxw(3);r.xp6(1),r.Q6J("ngIf",t.isLessResults(e,"checkbox")),r.xp6(1),r.Q6J("ngIf",t.isMoreResults(e,"checkbox"))}}function Lm(e,t){if(1&e&&(r.ynx(0),r.TgZ(1,"h4"),r._uU(2),r.qZA(),r.TgZ(3,"div",18),r.YNc(4,Cm,2,4,"mat-checkbox",19),r.qZA(),r.YNc(5,Zm,3,2,"p",2),r.BQk()),2&e){const e=t.$implicit,o=r.oxw(3);r.xp6(2),r.Oqu(e.title),r.xp6(2),r.Q6J("ngForOf",e.selectors),r.xp6(1),r.Q6J("ngIf",o.isLessResults(e,"checkbox")||o.isMoreResults(e,"checkbox"))}}function Fm(e,t){if(1&e&&(r.TgZ(0,"div",16),r._UZ(1,"mat-divider"),r.YNc(2,Sm,5,5,"div",8),r.YNc(3,Lm,6,3,"ng-container",1),r.qZA()),2&e){const e=r.oxw(2);r.xp6(2),r.Q6J("ngIf",e.getCheckboxesGroups().length>1),r.xp6(1),r.Q6J("ngForOf",e.currentCheckboxesGroup.computedSelectors)}}function Om(e,t){if(1&e&&(r.TgZ(0,"mat-option",12),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.hij("",e.title," ")}}function Mm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",9),r.TgZ(1,"mat-form-field"),r.TgZ(2,"mat-select",26),r.NdJ("valueChange",function(t){return r.CHM(e),r.oxw(3).currentRadioButtonsGroup=t}),r.ALo(3,"translate"),r.YNc(4,Om,2,2,"mat-option",11),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(3);r.xp6(2),r.Q6J("matTooltip",r.lcZ(3,3,"igo.geo.layer.legend.selectStyle"))("value",e.currentRadioButtonsGroup),r.xp6(2),r.Q6J("ngForOf",e.getRadioButtonsGroups())}}function Im(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-radio-button",29),r.NdJ("change",function(){return r.CHM(e),r.oxw(4).emptyRadioButtons()}),r.ALo(1,"translate"),r._uU(2),r.ALo(3,"translate"),r.qZA()}2&e&&(r.Q6J("matTooltip",r.lcZ(1,2,"igo.geo.filter.resetFilters")),r.xp6(2),r.hij("",r.lcZ(3,4,"igo.geo.filter.resetFilters")," "))}function km(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-radio-button",20),r.NdJ("change",function(){const t=r.CHM(e).$implicit,o=r.oxw(3).$implicit;return r.oxw().onSelectionChange(t,o.selectorType)}),r._uU(1),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(4);r.Q6J("matTooltip",o.getToolTip(e))("checked",e.enabled)("value",e),r.xp6(1),r.hij("",e.title," ")}}function Pm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"u",23),r.NdJ("click",function(){return r.CHM(e),r.oxw(5).displayLessResults("radio")}),r._uU(1),r.ALo(2,"translate"),r.qZA()}2&e&&(r.xp6(1),r.hij("",r.lcZ(2,1,"igo.geo.filter.displayLessResults")," "))}function _m(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"u",24),r.NdJ("click",function(){return r.CHM(e),r.oxw(5).displayMoreResults("radio")}),r._uU(1),r.ALo(2,"translate"),r.qZA()}2&e&&(r.xp6(1),r.hij("",r.lcZ(2,1,"igo.geo.filter.displayMoreResults")," "))}function $m(e,t){if(1&e&&(r.TgZ(0,"p"),r.YNc(1,Pm,3,3,"u",21),r.YNc(2,_m,3,3,"u",22),r.qZA()),2&e){const e=r.oxw().$implicit,t=r.oxw(3);r.xp6(1),r.Q6J("ngIf",t.isLessResults(e,"radio")),r.xp6(1),r.Q6J("ngIf",t.isMoreResults(e,"radio"))}}function qm(e,t){if(1&e&&(r.ynx(0),r.TgZ(1,"h4"),r._uU(2),r.qZA(),r.TgZ(3,"mat-radio-group",27),r.YNc(4,Im,4,6,"mat-radio-button",28),r.YNc(5,km,2,4,"mat-radio-button",19),r.YNc(6,$m,3,2,"p",2),r.qZA(),r.BQk()),2&e){const e=t.$implicit,o=r.oxw(3);r.xp6(2),r.Oqu(e.title),r.xp6(2),r.Q6J("ngIf",e.unfiltered),r.xp6(1),r.Q6J("ngForOf",e.selectors),r.xp6(1),r.Q6J("ngIf",o.isLessResults(e,"radio")||o.isMoreResults(e,"radio"))}}function Dm(e,t){if(1&e&&(r.TgZ(0,"div",25),r._UZ(1,"mat-divider"),r.YNc(2,Mm,5,5,"div",8),r.YNc(3,qm,7,4,"ng-container",1),r.qZA()),2&e){const e=r.oxw(2);r.xp6(2),r.Q6J("ngIf",e.getRadioButtonsGroups().length>1),r.xp6(1),r.Q6J("ngForOf",e.currentRadioButtonsGroup.computedSelectors)}}function Em(e,t){if(1&e&&(r.TgZ(0,"mat-option",12),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.hij("",e.title," ")}}function Rm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",9),r.TgZ(1,"mat-form-field"),r.TgZ(2,"mat-select",31),r.NdJ("valueChange",function(t){return r.CHM(e),r.oxw(3).currentSelectGroup=t}),r.ALo(3,"translate"),r.YNc(4,Em,2,2,"mat-option",11),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(3);r.xp6(2),r.Q6J("matTooltip",r.lcZ(3,3,"igo.geo.layer.legend.selectStyle"))("value",e.currentSelectGroup),r.xp6(2),r.Q6J("ngForOf",e.getSelectGroups())}}function Um(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-button",35),r.NdJ("click",function(){return r.CHM(e),r.oxw(4).emptySelect()}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",36),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.filter.resetFilters"))}const Nm=function(){return{standalone:!0}};function Jm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-checkbox",41),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw(5).allSelected=t})("change",function(){return r.CHM(e),r.oxw(5).toggleAllSelection()}),r._uU(1,"Tous "),r.qZA()}if(2&e){const e=r.oxw(5);r.Q6J("ngModel",e.allSelected)("ngModelOptions",r.DdM(2,Nm))}}function Bm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-option",42),r.NdJ("onSelectionChange",function(){return r.CHM(e),r.oxw(5).optionClick()}),r._uU(1),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(5);r.Q6J("matTooltip",o.getToolTip(e))("value",e),r.xp6(1),r.hij("",e.title," ")}}function jm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div"),r.TgZ(1,"mat-select",37,38),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw(4).enableds=t}),r.TgZ(3,"div",18),r.YNc(4,Jm,2,3,"mat-checkbox",39),r.qZA(),r.YNc(5,Bm,2,3,"mat-option",40),r.qZA(),r.qZA()}if(2&e){const e=r.oxw().$implicit,t=r.oxw(3);r.xp6(1),r.Q6J("multiple",e.multiple)("placeholder",e.title)("formControl",t.select)("ngModel",t.enableds),r.xp6(3),r.Q6J("ngIf",e.multiple),r.xp6(1),r.Q6J("ngForOf",e.selectors)}}function Gm(e,t){if(1&e&&(r.TgZ(0,"mat-option",45),r._uU(1),r.qZA()),2&e){const e=t.$implicit,o=r.oxw(5);r.Q6J("matTooltip",o.getToolTip(e))("value",e),r.xp6(1),r.hij("",e.title," ")}}function Qm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-select",43),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw(4).enabled=t}),r.YNc(1,Gm,2,3,"mat-option",44),r.qZA()}if(2&e){const e=r.oxw().$implicit,t=r.oxw(3);r.Q6J("placeholder",e.title)("formControl",t.select)("ngModel",t.enabled),r.xp6(1),r.Q6J("ngForOf",e.selectors)}}function zm(e,t){if(1&e&&(r.ynx(0),r.TgZ(1,"h4"),r._uU(2),r.qZA(),r.TgZ(3,"div",9),r.YNc(4,Um,3,3,"mat-button",32),r.TgZ(5,"mat-form-field"),r.YNc(6,jm,6,6,"div",33),r.YNc(7,Qm,2,4,"ng-template",null,34,r.W1O),r.qZA(),r.qZA(),r.BQk()),2&e){const e=t.$implicit,o=r.MAs(8);r.xp6(2),r.Oqu(e.title),r.xp6(2),r.Q6J("ngIf",e.unfiltered&&!e.multiple),r.xp6(2),r.Q6J("ngIf",e.multiple)("ngIfElse",o)}}function Ym(e,t){if(1&e&&(r.TgZ(0,"div",30),r._UZ(1,"mat-divider"),r.YNc(2,Rm,5,5,"div",8),r.YNc(3,zm,9,4,"ng-container",1),r.qZA()),2&e){const e=r.oxw(2);r.xp6(2),r.Q6J("ngIf",e.getSelectGroups().length>1),r.xp6(1),r.Q6J("ngForOf",e.currentSelectGroup.computedSelectors)}}function Hm(e,t){if(1&e&&(r.TgZ(0,"div"),r.YNc(1,xm,4,2,"div",3),r.YNc(2,Fm,4,2,"div",4),r.YNc(3,Dm,4,2,"div",5),r.YNc(4,Ym,4,2,"div",6),r.qZA()),2&e){const e=t.$implicit;r.xp6(1),r.Q6J("ngIf","pushButton"===e.selectorType),r.xp6(1),r.Q6J("ngIf","checkbox"===e.selectorType),r.xp6(1),r.Q6J("ngIf","radioButton"===e.selectorType),r.xp6(1),r.Q6J("ngIf","select"===e.selectorType)}}function Vm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div"),r._UZ(1,"mat-divider"),r.TgZ(2,"h4"),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.TgZ(5,"igo-ogc-filter-time",46),r.NdJ("datasourceChange",function(t){return r.CHM(e),r.oxw().datasource=t})("currentFilterChange",function(t){return r.CHM(e),r.oxw().currentFilter=t})("changeProperty",function(t){return r.CHM(e),r.oxw().changeProperty(t.value,t.pos)}),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(3),r.Oqu(r.lcZ(4,3,"igo.geo.filter.reportingDate")),r.xp6(2),r.Q6J("datasource",e.datasource)("currentFilter",e.currentFilter)}}let Wm=(()=>{class e{constructor(e,t){this.ogcFilterService=e,this.formBuilder=t,this.checkboxesIndex=5,this.radioButtonsIndex=5,this.baseIndex=5,this.ogcFilterOperator=El,this.color="primary",this.allSelected=!1,this.select=new ze.NI,this.enabled$=new C.X(void 0),this.enableds$=new C.X([]),this.ogcFilterWriter=new Ul,this.buildForm()}get currentFilter(){return this._currentFilter}set currentFilter(e){var t;this._currentFilter=e,(null===(t=this._currentFilter)||void 0===t?void 0:t.sliderOptions)&&(this._currentFilter.sliderOptions.enabled=!1)}get ogcFiltersSelectors(){var e,t,o,i,r,s,n,a,l,c,u,p,d,h,g,m,f,y,v,b,x,w,S,C;const T=[];return(null===(o=null===(t=null===(e=this.datasource)||void 0===e?void 0:e.options)||void 0===t?void 0:t.ogcFilters)||void 0===o?void 0:o.pushButtons)&&T.push(null===(s=null===(r=null===(i=this.datasource)||void 0===i?void 0:i.options)||void 0===r?void 0:r.ogcFilters)||void 0===s?void 0:s.pushButtons),(null===(l=null===(a=null===(n=this.datasource)||void 0===n?void 0:n.options)||void 0===a?void 0:a.ogcFilters)||void 0===l?void 0:l.checkboxes)&&T.push(null===(p=null===(u=null===(c=this.datasource)||void 0===c?void 0:c.options)||void 0===u?void 0:u.ogcFilters)||void 0===p?void 0:p.checkboxes),(null===(g=null===(h=null===(d=this.datasource)||void 0===d?void 0:d.options)||void 0===h?void 0:h.ogcFilters)||void 0===g?void 0:g.radioButtons)&&T.push(null===(y=null===(f=null===(m=this.datasource)||void 0===m?void 0:m.options)||void 0===f?void 0:f.ogcFilters)||void 0===y?void 0:y.radioButtons),(null===(x=null===(b=null===(v=this.datasource)||void 0===v?void 0:v.options)||void 0===b?void 0:b.ogcFilters)||void 0===x?void 0:x.select)&&T.push(null===(C=null===(S=null===(w=this.datasource)||void 0===w?void 0:w.options)||void 0===S?void 0:S.ogcFilters)||void 0===C?void 0:C.select),T.sort((e,t)=>e.order<t.order?-1:e.order>t.order?1:0),T}get currentPushButtonsGroup(){return this.form.get("pushButtonsGroup").value}set currentPushButtonsGroup(e){this.form.patchValue({pushButtonsGroup:e})}get currentCheckboxesGroup(){return this.form.get("checkboxesGroup").value}set currentCheckboxesGroup(e){this.form.patchValue({checkboxesGroup:e})}get currentRadioButtonsGroup(){return this.form.get("radioButtonsGroup").value}set currentRadioButtonsGroup(e){this.form.patchValue({radioButtonsGroup:e})}get currentSelectGroup(){return this.form.get("selectGroup").value}set currentSelectGroup(e){this.form.patchValue({selectGroup:e})}get enabled(){return this.enabled$.value}set enabled(e){this.enabled$.next(e),clearTimeout(this.applyFiltersTimeout),this.currentSelectGroup.computedSelectors.forEach(t=>{t.selectors.forEach(t=>{t.enabled=e===t})}),this.applyFiltersTimeout=setTimeout(()=>{this.applyFilters()},750)}get enableds(){return this.enableds$.value}set enableds(e){this.enableds$.next(e),clearTimeout(this.applyFiltersTimeout),this.currentSelectGroup.computedSelectors.forEach(t=>{t.selectors.forEach(t=>{t.enabled=!!e.includes(t)})}),this.applyFiltersTimeout=setTimeout(()=>{this.applyFilters()},750)}buildForm(){this.form=this.formBuilder.group({pushButtons:["",[ze.kI.required]],radioButtons:["",[ze.kI.required]],pushButtonsGroup:["",[ze.kI.required]],checkboxesGroup:["",[ze.kI.required]],radioButtonsGroup:["",[ze.kI.required]],selectGroup:["",[ze.kI.required]]})}getPushButtonsGroups(){var e,t,o;if(null===(o=null===(t=null===(e=this.datasource)||void 0===e?void 0:e.options)||void 0===t?void 0:t.ogcFilters)||void 0===o?void 0:o.pushButtons)return this.datasource.options.ogcFilters.pushButtons.groups}getCheckboxesGroups(){var e,t,o;if(null===(o=null===(t=null===(e=this.datasource)||void 0===e?void 0:e.options)||void 0===t?void 0:t.ogcFilters)||void 0===o?void 0:o.checkboxes)return this.datasource.options.ogcFilters.checkboxes.groups}getRadioButtonsGroups(){var e,t,o;if(null===(o=null===(t=null===(e=this.datasource)||void 0===e?void 0:e.options)||void 0===t?void 0:t.ogcFilters)||void 0===o?void 0:o.radioButtons)return this.datasource.options.ogcFilters.radioButtons.groups}getSelectGroups(){var e,t,o;if(null===(o=null===(t=null===(e=this.datasource)||void 0===e?void 0:e.options)||void 0===t?void 0:t.ogcFilters)||void 0===o?void 0:o.select)return this.datasource.options.ogcFilters.select.groups}ngOnInit(){this.datasource.options.ogcFilters&&(this.datasource.options.ogcFilters.pushButtons&&(this.currentPushButtonsGroup=this.datasource.options.ogcFilters.pushButtons.groups.find(e=>e.enabled)||this.datasource.options.ogcFilters.pushButtons.groups[0]),this.datasource.options.ogcFilters.checkboxes&&(this.currentCheckboxesGroup=this.datasource.options.ogcFilters.checkboxes.groups.find(e=>e.enabled)||this.datasource.options.ogcFilters.checkboxes.groups[0]),this.datasource.options.ogcFilters.radioButtons&&(this.currentRadioButtonsGroup=this.datasource.options.ogcFilters.radioButtons.groups.find(e=>e.enabled)||this.datasource.options.ogcFilters.radioButtons.groups[0]),this.datasource.options.ogcFilters.select&&(this.currentSelectGroup=this.datasource.options.ogcFilters.select.groups.find(e=>e.enabled)||this.datasource.options.ogcFilters.select.groups[0],this.getSelectEnabled()),this.applyFilters()),this.form.get("pushButtonsGroup").valueChanges.pipe((0,w.b)(750)).subscribe(()=>{this.onPushButtonsChangeGroup(),this.applyFilters()}),this.form.get("checkboxesGroup").valueChanges.pipe((0,w.b)(750)).subscribe(()=>{this.onCheckboxesChangeGroup(),this.applyFilters()}),this.form.get("radioButtonsGroup").valueChanges.pipe((0,w.b)(750)).subscribe(()=>{this.onRadioButtonsChangeGroup(),this.applyFilters()}),this.form.get("selectGroup").valueChanges.pipe((0,w.b)(750)).subscribe(()=>{this.onSelectChangeGroup(),this.applyFilters()}),this.form.get("pushButtons").valueChanges.pipe((0,w.b)(750)).subscribe(()=>{this.applyFilters()}),this.form.get("radioButtons").valueChanges.pipe((0,w.b)(750)).subscribe(()=>{this.applyFilters()})}getSelectEnabled(){const e=[];let t;this.currentSelectGroup.computedSelectors.forEach(o=>{o.multiple?(o.selectors.forEach(t=>{t.enabled&&e.push(t)}),this.enableds=e):(o.selectors.forEach(e=>{e.enabled&&(t=e)}),this.enabled=t)})}getToolTip(e){let t;return e.tooltip&&(t=Array.isArray(e.tooltip)?e.tooltip.join("\n"):e.tooltip),t||""}getButtonColor(e){let t;return e.color&&e.enabled&&(t={"background-color":`rgba(${e.color})`}),t}bundleIsVertical(e){return!!e.vertical&&e.vertical}onPushButtonsChangeGroup(){this.getPushButtonsGroups().map(e=>e.enabled=!1),this.getPushButtonsGroups().find(e=>e===this.currentPushButtonsGroup).enabled=!0}onCheckboxesChangeGroup(){this.getCheckboxesGroups().map(e=>e.enabled=!1),this.getCheckboxesGroups().find(e=>e===this.currentCheckboxesGroup).enabled=!0}onRadioButtonsChangeGroup(){this.getRadioButtonsGroups().map(e=>e.enabled=!1),this.getRadioButtonsGroups().find(e=>e===this.currentRadioButtonsGroup).enabled=!0}onSelectChangeGroup(){this.getSelectGroups().map(e=>e.enabled=!1),this.getSelectGroups().find(e=>e===this.currentSelectGroup).enabled=!0}onSelectionChange(e,t){clearTimeout(this.applyFiltersTimeout),"radioButton"===t&&this.emptyRadioButtons(),e&&(e.enabled=!e.enabled),this.applyFiltersTimeout=setTimeout(()=>{this.applyFilters()},750)}emptyRadioButtons(){this.currentRadioButtonsGroup.computedSelectors.forEach(e=>{e.selectors.map(e=>e.enabled=!1),this.applyFiltersTimeout=setTimeout(()=>{this.applyFilters()},750)})}emptySelect(){this.enabled=[]}toggleAllSelection(){this.sel.options.forEach(this.allSelected?e=>e.select():e=>e.deselect())}optionClick(){let e=!0;this.sel.options.forEach(t=>{t.selected||(e=!1)}),this.allSelected=e}applyFilters(){let e="";const t=[],o=[this.currentPushButtonsGroup,this.currentCheckboxesGroup,this.currentRadioButtonsGroup,this.currentSelectGroup];for(const i of o)i.computedSelectors&&i.computedSelectors.map(e=>{const o=[];e.selectors.filter(e=>!0===e.enabled).forEach(e=>o.push(e.filters)),o.length>=1&&t.push(1===o.length?o[0]:{logical:e.logical,filters:o})});this.isTemporalOperator()&&t.push(this.datasource.options.ogcFilters.interfaceOgcFilters[0]),t.length>=1&&(e=this.ogcFilterWriter.buildFilter(1===t.length?t[0]:{logical:"And",filters:t})),"wms"===this.datasource.options.type&&this.ogcFilterService.filterByOgc(this.datasource,e),"wfs"===this.datasource.options.type&&this.datasource.ol.refresh(),this.datasource.setOgcFilters(this.datasource.options.ogcFilters,!0)}isMoreResults(e,t){let o=0;for(const i of e.selectors)o++;return o>("radio"===t?this.radioButtonsIndex:this.checkboxesIndex)}displayMoreResults(e){"radio"===e?this.radioButtonsIndex+=5:this.checkboxesIndex+=5}isLessResults(e,t){let o=0;for(const i of e.selectors)o++;return this.baseIndex!==("radio"===t?this.radioButtonsIndex:this.checkboxesIndex)&&o>this.baseIndex}displayLessResults(e){"radio"===e?this.radioButtonsIndex=this.baseIndex:this.checkboxesIndex=this.baseIndex}isTemporalOperator(){var e,t;return(null===(t=null===(e=this.currentFilter)||void 0===e?void 0:e.operator)||void 0===t?void 0:t.toLowerCase())===this.ogcFilterOperator.During.toLowerCase()}changeProperty(e,t,o=!0){const i=this.detectProperty(t);i&&(this.datasource.options.ogcFilters.interfaceOgcFilters.find(e=>e.filterid===this.currentFilter.filterid)[i]=e,o&&this.applyFilters())}detectProperty(e){switch(this.currentFilter.operator){case El.PropertyIsNotEqualTo:case El.PropertyIsEqualTo:case El.PropertyIsGreaterThan:case El.PropertyIsGreaterThanOrEqualTo:case El.PropertyIsLessThan:case El.PropertyIsLessThanOrEqualTo:return"expression";case El.PropertyIsLike:return"pattern";case El.PropertyIsBetween:return e&&1===e?"lowerBoundary":e&&2===e?"upperBoundary":void 0;case El.During:return e&&1===e?"begin":e&&2===e?"end":void 0;default:return}}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Od),r.Y36(ze.qu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-ogc-filter-selection"]],viewQuery:function(e,t){if(1&e&&r.Gf(mm,5),2&e){let e;r.iGM(e=r.CRH())&&(t.sel=e.first)}},inputs:{refreshFilters:"refreshFilters",datasource:"datasource",map:"map",checkboxesIndex:"checkboxesIndex",radioButtonsIndex:"radioButtonsIndex",baseIndex:"baseIndex",currentFilter:"currentFilter"},decls:3,vars:3,consts:[[3,"formGroup"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","pushButtonGroups",4,"ngIf"],["class","checkboxGroups",4,"ngIf"],["class","radioButtonGroups",4,"ngIf"],["class","selectGroups",4,"ngIf"],[1,"pushButtonGroups"],["class","groupsSelector",4,"ngIf"],[1,"groupsSelector"],["formControlName","pushButtonsGroup","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","value","valueChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["formControlName","pushButtons","appearance","legacy","multiple","true",1,"mat-typography",3,"vertical"],["tooltip-position","below","matTooltipShowDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","ngStyle","checked","value","change",4,"ngFor","ngForOf"],["tooltip-position","below","matTooltipShowDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","ngStyle","checked","value","change"],[1,"checkboxGroups"],["formControlName","checkboxesGroup","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","value","valueChange"],[1,"checkboxes","mat-typography"],["tooltip-position","below","matTooltipShowDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","checked","value","change",4,"ngFor","ngForOf"],["tooltip-position","below","matTooltipShowDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","checked","value","change"],["class","lessResults mat-typography",3,"click",4,"ngIf"],["class","moreResults mat-typography",3,"click",4,"ngIf"],[1,"lessResults","mat-typography",3,"click"],[1,"moreResults","mat-typography",3,"click"],[1,"radioButtonGroups"],["formControlName","radioButtonsGroup","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","value","valueChange"],["formControlName","radioButtons",1,"mat-typography"],["tooltip-position","below","matTooltipShowDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","change",4,"ngIf"],["tooltip-position","below","matTooltipShowDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","change"],[1,"selectGroups"],["formControlName","selectGroup","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","value","valueChange"],["mat-icon-button","","color","warn","tooltip-position","below","matTooltipShowDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","click",4,"ngIf"],[4,"ngIf","ngIfElse"],["notMulti",""],["mat-icon-button","","color","warn","tooltip-position","below","matTooltipShowDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","click"],["svgIcon","filter-remove"],[3,"multiple","placeholder","formControl","ngModel","ngModelChange"],["selection",""],[3,"ngModel","ngModelOptions","ngModelChange","change",4,"ngIf"],["tooltip-position","below","matTooltipDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","value","onSelectionChange",4,"ngFor","ngForOf"],[3,"ngModel","ngModelOptions","ngModelChange","change"],["tooltip-position","below","matTooltipDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","value","onSelectionChange"],[3,"placeholder","formControl","ngModel","ngModelChange"],["tooltip-position","below","matTooltipDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","value",4,"ngFor","ngForOf"],["tooltip-position","below","matTooltipDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","value"],[3,"datasource","currentFilter","datasourceChange","currentFilterChange","changeProperty"]],template:function(e,t){1&e&&(r.TgZ(0,"form",0),r.YNc(1,Hm,5,4,"div",1),r.qZA(),r.YNc(2,Vm,6,5,"div",2)),2&e&&(r.Q6J("formGroup",t.form),r.xp6(1),r.Q6J("ngForOf",t.ogcFiltersSelectors),r.xp6(1),r.Q6J("ngIf",t.isTemporalOperator()))},styles:[".mat-button-toggle-group[_ngcontent-%COMP%]{margin:5px;flex-wrap:wrap;box-shadow:none}.checkboxes[_ngcontent-%COMP%]{flex-wrap:wrap;box-shadow:none}.groupsSelector[_ngcontent-%COMP%]{text-align:center}mat-button-toggle[_ngcontent-%COMP%]{display:inline-flex;border:1.5px solid black;border-radius:5px;margin:5px;white-space:normal;min-height:40px;height:auto;width:150px}mat-button-toggle[_ngcontent-%COMP%]     .mat-button-toggle-label-content{line-height:unset;font-size:small;display:block}  .material-tooltip{white-space:pre-wrap}mat-checkbox[_ngcontent-%COMP%], mat-radio-button[_ngcontent-%COMP%]{margin:7px;width:95%;display:inline-flex;font-size:larger}mat-checkbox[_ngcontent-%COMP%]     label, mat-radio-button[_ngcontent-%COMP%]     label{white-space:normal}mat-checkbox[_ngcontent-%COMP%]{vertical-align:middle}mat-button[_ngcontent-%COMP%]{padding-right:10px}h4[_ngcontent-%COMP%]{margin:7px;text-align:left}u[_ngcontent-%COMP%]{cursor:pointer;color:#00f;margin:5px}p[_ngcontent-%COMP%]{margin:unset}igo-ogc-filter-time[_ngcontent-%COMP%]     .datetime-input{width:140px;margin:10px 0 5px 10px}"]}),e})();function Xm(e,t){if(1&e&&(r.TgZ(0,"mat-option",10),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.terrapi."+e)," ")}}let Km=(()=>{class e{constructor(){this.queryType=["Arrond","CircFed","CircProv","DirReg","Mun","MRC","AdmRegion","RegTour"],this.selectedTypeIndex=new ze.NI(0),this.spatialType=Md,this.activeDrawType=this.spatialType.Polygon,this.layers=[],this.eventType=new r.vpe,this.eventQueryType=new r.vpe,this.zoneChange=new r.vpe,this.zoneWithBufferChange=new r.vpe,this.bufferChange=new r.vpe,this.measureUnitChange=new r.vpe}get store(){return this._store}set store(e){this._store=e}ngOnInit(){0===this.selectedTypeIndex.value&&(this.type=this.spatialType.Predefined),1===this.selectedTypeIndex.value&&(this.type=this.activeDrawType),this.eventType.emit(this.type)}onTypeChange(e){0===this.selectedTypeIndex.value&&(this.type=Md.Predefined),1===this.selectedTypeIndex.value&&(this.type=this.activeDrawType),this.eventType.emit(this.type)}onDrawTypeChange(e){this.activeDrawType=e,this.eventType.emit(this.activeDrawType)}onSelectionChange(){this.eventQueryType.emit(this.selectedQueryType),this.zoneChange.emit(void 0)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-spatial-filter-type"]],inputs:{store:"store",selectedQueryType:"selectedQueryType",zone:"zone",layers:"layers"},outputs:{eventType:"eventType",eventQueryType:"eventQueryType",zoneChange:"zoneChange",zoneWithBufferChange:"zoneWithBufferChange",bufferChange:"bufferChange",measureUnitChange:"measureUnitChange"},decls:20,vars:25,consts:[[3,"selectedIndex","selectedIndexChange","selectedTabChange"],[3,"label"],[3,"value","selectionChange","valueChange"],[3,"value",4,"ngFor","ngForOf"],[3,"store","queryType","zone","layers","zoneChange","zoneWithBufferChange","bufferChange","measureUnitChange"],[1,"spatial-type-toggle"],[3,"value","change"],[3,"value","matTooltip"],["svgIcon","pentagon-outline"],["svgIcon","record-circle-outline"],[3,"value"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-tab-group",0),r.NdJ("selectedIndexChange",function(e){return t.selectedTypeIndex.setValue(e)})("selectedTabChange",function(e){return t.onTypeChange(e)}),r.TgZ(1,"mat-tab",1),r.ALo(2,"translate"),r.TgZ(3,"mat-form-field"),r.TgZ(4,"mat-label"),r._uU(5),r.ALo(6,"translate"),r.qZA(),r.TgZ(7,"mat-select",2),r.NdJ("selectionChange",function(){return t.onSelectionChange()})("valueChange",function(e){return t.selectedQueryType=e}),r.YNc(8,Xm,3,4,"mat-option",3),r.qZA(),r.qZA(),r.TgZ(9,"igo-spatial-filter-list",4),r.NdJ("zoneChange",function(e){return t.zoneChange.emit(e)})("zoneWithBufferChange",function(e){return t.zoneWithBufferChange.emit(e)})("bufferChange",function(e){return t.bufferChange.emit(e)})("measureUnitChange",function(e){return t.measureUnitChange.emit(e)}),r.qZA(),r.qZA(),r.TgZ(10,"mat-tab",1),r.ALo(11,"translate"),r.TgZ(12,"div",5),r.TgZ(13,"mat-button-toggle-group",6),r.NdJ("change",function(e){return t.onDrawTypeChange(e.value)}),r.TgZ(14,"mat-button-toggle",7),r.ALo(15,"translate"),r._UZ(16,"mat-icon",8),r.qZA(),r.TgZ(17,"mat-button-toggle",7),r.ALo(18,"translate"),r._UZ(19,"mat-icon",9),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.Q6J("selectedIndex",t.selectedTypeIndex.value),r.xp6(1),r.Q6J("label",r.lcZ(2,15,"igo.geo.spatialFilter.predefined")),r.xp6(4),r.Oqu(r.lcZ(6,17,"igo.geo.spatialFilter.searchLabel")),r.xp6(2),r.Q6J("value",t.selectedQueryType),r.xp6(1),r.Q6J("ngForOf",t.queryType),r.xp6(1),r.Q6J("store",t.store)("queryType",t.selectedQueryType)("zone",t.zone)("layers",t.layers),r.xp6(1),r.Q6J("label",r.lcZ(11,19,"igo.geo.spatialFilter.draw")),r.xp6(3),r.Q6J("value",t.activeDrawType),r.xp6(1),r.Q6J("value",t.spatialType.Polygon)("matTooltip",r.lcZ(15,21,"igo.geo.spatialFilter.drawPolygon")),r.xp6(3),r.Q6J("value",t.spatialType.Point)("matTooltip",r.lcZ(18,23,"igo.geo.spatialFilter.drawCircle")))},styles:[".mat-form-field[_ngcontent-%COMP%]{padding:5px;width:95%;margin-left:2px}.mat-tab-group[_ngcontent-%COMP%]     .mat-tab-body-content{overflow:hidden}.mat-tab-group[_ngcontent-%COMP%]     .mat-tab-label{padding:10px}.mat-tab-group[_ngcontent-%COMP%]     .mat-tab-body-wrapper{margin-top:5px}.spatial-type-toggle[_ngcontent-%COMP%]{padding:10px;text-align:center}.spatial-type-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]{width:50%}.spatial-type-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]{width:50%}"],changeDetection:0}),e})();function ef(e,t){if(1&e&&(r.TgZ(0,"mat-option",13),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.hij(" ",e.properties.nom," ")}}function tf(e,t){if(1&e&&(r.TgZ(0,"mat-option",13),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.measure."+e)," ")}}let of=(()=>{class e{constructor(e,t,o){this.spatialFilterService=e,this.messageService=t,this.languageService=o,this.layers=[],this.measureUnit=ih.Meters,this.formControl=new ze.NI,this.bufferFormControl=new ze.NI,this.zoneChange=new r.vpe,this.zoneWithBufferChange=new r.vpe,this.bufferChange=new r.vpe,this.measureUnitChange=new r.vpe}get store(){return this._store}set store(e){this._store=e}get queryType(){return this._queryType}set queryType(e){this.formControl.setValue(""),this._queryType=e}get zone(){return this._zone}set zone(e){this._zone=e,e||(this.zoneWithBuffer=void 0,this.bufferFormControl.setValue(0))}get measureUnits(){return[ih.Meters,ih.Kilometers]}ngOnInit(){this.formValueChanges$$=this.formControl.valueChanges.subscribe(e=>{e.length&&this.store.view.filter(t=>{const o=e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return t.properties.nom.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(o)})}),this.bufferValueChanges$$=this.bufferFormControl.valueChanges.pipe((0,w.b)(500),(0,M.x)()).subscribe(e=>{this.measureUnit===ih.Meters&&e>0&&e<=1e5?(this.bufferChange.emit(e),this.spatialFilterService.loadBufferGeometry(this.selectedZone,Md.Predefined,e,this.queryType).subscribe(e=>{this.zoneWithBuffer=e,this.zoneWithBufferChange.emit(this.zoneWithBuffer)})):this.measureUnit===ih.Kilometers&&e>0&&e<=100?(this.bufferChange.emit(e),this.spatialFilterService.loadBufferGeometry(this.selectedZone,Md.Predefined,1e3*e,this.queryType).subscribe(e=>{this.zoneWithBuffer=e,this.zoneWithBufferChange.emit(this.zoneWithBuffer)})):0===e&&this.layers.length>0?(this.bufferChange.emit(e),this.zoneWithBufferChange.emit(this.selectedZone)):(e<0||this.measureUnit===ih.Meters&&e>1e5||this.measureUnit===ih.Kilometers&&e>100)&&(this.bufferFormControl.setValue(0),this.messageService.alert(this.languageService.translate.instant("igo.geo.spatialFilter.bufferAlert"),this.languageService.translate.instant("igo.geo.spatialFilter.warning")))})}ngOnDestroy(){this.formValueChanges$$.unsubscribe()}displayFn(e){return e?e.properties.nom:void 0}onZoneChange(e){e&&this.queryType&&this.spatialFilterService.loadItemById(e,this.queryType).subscribe(e=>{this.selectedZone=e,this.zoneChange.emit(e)})}onMeasureUnitChange(e){e!==this.measureUnit&&(this.measureUnit=e,this.measureUnitChange.emit(this.measureUnit),this.bufferFormControl.setValue(this.measureUnit===ih.Meters?1e3*this.bufferFormControl.value:this.bufferFormControl.value/1e3))}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(kd),r.Y36(le),r.Y36(ne))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-spatial-filter-list"]],inputs:{store:"store",queryType:"queryType",zone:"zone",layers:"layers"},outputs:{zoneChange:"zoneChange",zoneWithBufferChange:"zoneWithBufferChange",bufferChange:"bufferChange",measureUnitChange:"measureUnitChange"},decls:18,vars:17,consts:[[1,"form-list"],[1,"zone-list"],["type","text","matInput","",3,"placeholder","formControl","matAutocomplete"],["input",""],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[1,"buffer-div"],[1,"buffer-form"],[1,"buffer"],["type","number","matInput","",3,"placeholder","formControl","value","readonly"],[1,"unit-field"],[3,"value","selectionChange"],[3,"value"]],template:function(e,t){if(1&e&&(r.TgZ(0,"form",0),r.TgZ(1,"mat-form-field",1),r._UZ(2,"input",2,3),r.ALo(4,"translate"),r.TgZ(5,"mat-autocomplete",4,5),r.NdJ("optionSelected",function(e){return t.onZoneChange(e.option.value)}),r.YNc(7,ef,2,2,"mat-option",6),r.ALo(8,"async"),r.qZA(),r.qZA(),r.TgZ(9,"form"),r.TgZ(10,"div",7),r.TgZ(11,"form",8),r.TgZ(12,"mat-form-field",9),r._UZ(13,"input",10),r.ALo(14,"translate"),r.qZA(),r.qZA(),r.TgZ(15,"mat-form-field",11),r.TgZ(16,"mat-select",12),r.NdJ("selectionChange",function(e){return t.onMeasureUnitChange(e.value)}),r.YNc(17,tf,3,4,"mat-option",6),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.MAs(6);r.xp6(2),r.s9C("placeholder",r.lcZ(4,11,"igo.geo.spatialFilter.listLabel")),r.Q6J("formControl",t.formControl)("matAutocomplete",e),r.xp6(3),r.Q6J("displayWith",t.displayFn),r.xp6(2),r.Q6J("ngForOf",r.lcZ(8,13,t.store.view.all$())),r.xp6(6),r.s9C("placeholder",r.lcZ(14,15,"igo.geo.spatialFilter.buffer")),r.Q6J("formControl",t.bufferFormControl)("value",0)("readonly",!t.zone),r.xp6(3),r.Q6J("value",t.measureUnit),r.xp6(1),r.Q6J("ngForOf",t.measureUnits)}},directives:[ze._Y,ze.JL,ze.F,Pe.KE,Qe.Nt,ze.Fj,Ya.ZL,ze.JJ,ze.oH,Ya.XC,h.sg,ze.wV,_e.gD,$e.ey],pipes:[U.X$,h.Ov],styles:[".buffer-div[_ngcontent-%COMP%]{display:flex;width:100%;margin-left:2px;padding:5px}.zone-list[_ngcontent-%COMP%]{padding:5px;width:95%;margin-left:2px}.buffer[_ngcontent-%COMP%]{display:flex;flex-flow:column nowrap;width:110%}.unit-field[_ngcontent-%COMP%]{width:110px;margin-left:30px}"],changeDetection:0}),e})();function rf(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-slide-toggle",15),r.NdJ("change",function(){return r.CHM(e),r.oxw().onDrawControlChange()}),r._uU(1),r.ALo(2,"translate"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("checked",e.drawControlIsActive)("labelPosition","before"),r.xp6(1),r.hij(" ",r.lcZ(2,3,"igo.geo.spatialFilter.drawControl")," ")}}function sf(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-slide-toggle",15),r.NdJ("change",function(){return r.CHM(e),r.oxw().onfreehandControlChange()}),r._uU(1),r.ALo(2,"translate"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("checked",e.freehandDrawIsActive)("labelPosition","before"),r.xp6(1),r.hij(" ",r.lcZ(2,3,"igo.geo.spatialFilter.freehandControl")," ")}}function nf(e,t){if(1&e&&(r.TgZ(0,"mat-option",6),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.measure."+e)," ")}}function af(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",16),r.TgZ(1,"form",17),r.TgZ(2,"mat-form-field",18),r._UZ(3,"input",19),r.ALo(4,"translate"),r.qZA(),r.qZA(),r.TgZ(5,"mat-form-field",20),r.TgZ(6,"mat-select",21),r.NdJ("selectionChange",function(t){return r.CHM(e),r.oxw().onMeasureUnitChange(t.value)}),r.YNc(7,nf,3,4,"mat-option",22),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(3),r.s9C("placeholder",r.lcZ(4,6,"igo.geo.spatialFilter.buffer")),r.Q6J("formControl",e.bufferFormControl)("value",0)("readonly",null===e.formControl.value),r.xp6(3),r.Q6J("value",e.measureUnit),r.xp6(1),r.Q6J("ngForOf",e.measureUnits)}}function lf(e,t){if(1&e&&(r.TgZ(0,"mat-option",6),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.measure."+e)," ")}}function cf(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",23),r.TgZ(1,"form",24),r.TgZ(2,"mat-form-field",25),r.TgZ(3,"input",26),r.NdJ("input",function(){return r.CHM(e),r.oxw().getRadius()}),r.ALo(4,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(5,"mat-form-field",20),r.TgZ(6,"mat-select",21),r.NdJ("selectionChange",function(t){return r.CHM(e),r.oxw().onMeasureUnitChange(t.value)}),r.YNc(7,lf,3,4,"mat-option",22),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(3),r.s9C("placeholder",r.lcZ(4,6,"igo.geo.spatialFilter.radius")),r.Q6J("formControl",e.radiusFormControl)("value",1e3)("readonly",e.freehandDrawIsActive&&null===e.formControl.value),r.xp6(3),r.Q6J("value",e.measureUnit),r.xp6(1),r.Q6J("ngForOf",e.measureUnits)}}function uf(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-radio-button",27),r.NdJ("change",function(t){return r.CHM(e),r.oxw().onItemTypeChange(t)}),r._uU(1),r.ALo(2,"translate"),r.qZA()}if(2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.spatialFilter."+e)," ")}}function pf(e,t){1&e&&(r.TgZ(0,"mat-header-cell",38),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"igo.geo.spatialFilter.Thematics")))}function df(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-header-cell",39),r.TgZ(1,"mat-checkbox",40),r.NdJ("change",function(t){r.CHM(e);const o=r.oxw(2);return t?o.masterToggle():null}),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(2);r.xp6(1),r.Q6J("checked",e.isAllSelected())("indeterminate",e.selectedThematics.hasValue()&&!e.isAllSelected())}}function hf(e,t){1&e&&r._UZ(0,"mat-header-row")}function gf(e,t){1&e&&r._UZ(0,"mat-row")}function mf(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-tree-node",41),r.TgZ(1,"li",42),r._UZ(2,"button",43),r._uU(3),r.TgZ(4,"mat-checkbox",44),r.NdJ("click",function(e){return e.stopPropagation()})("change",function(t){const o=r.CHM(e).$implicit,i=r.oxw(2);return t?i.onToggleChange(o):null}),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(2);r.xp6(3),r.hij(" ",e.name," "),r.xp6(1),r.Q6J("checked",o.selectedThematics.isSelected(e))}}function ff(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-nested-tree-node"),r.TgZ(1,"div",42),r.TgZ(2,"button",45),r.NdJ("click",function(){const t=r.CHM(e).$implicit;return r.oxw(2).onToggleClick(t)}),r._UZ(3,"mat-icon",46),r.qZA(),r._uU(4),r.TgZ(5,"mat-checkbox",47),r.NdJ("change",function(t){const o=r.CHM(e).$implicit,i=r.oxw(2);return t?i.childrensToggle(o):null}),r.qZA(),r.qZA(),r.TgZ(6,"ul",48),r.GkF(7,49),r.qZA(),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(2);r.xp6(3),r.Q6J("svgIcon",o.treeControl.isExpanded(e)?"chevron-down":"chevron-right"),r.xp6(1),r.hij(" ",e.name," "),r.xp6(1),r.Q6J("checked",o.isAllSelected(e))("indeterminate",o.hasChildrenSelected(e)&&!o.isAllSelected(e)),r.xp6(1),r.ekj("example-tree-invisible",!o.treeControl.isExpanded(e))}}function yf(e,t){if(1&e&&(r.TgZ(0,"div",28),r.TgZ(1,"mat-table"),r.ynx(2,29),r.YNc(3,pf,3,3,"mat-header-cell",30),r.BQk(),r.ynx(4,31),r.YNc(5,df,2,2,"mat-header-cell",32),r.BQk(),r.YNc(6,hf,1,0,"mat-header-row",33),r.YNc(7,gf,1,0,"mat-row",34),r.qZA(),r.TgZ(8,"mat-tree",35),r.YNc(9,mf,5,2,"mat-tree-node",36),r.YNc(10,ff,8,6,"mat-nested-tree-node",37),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(6),r.Q6J("matHeaderRowDef",e.displayedColumns),r.xp6(1),r.Q6J("matRowDefColumns",e.displayedColumns),r.xp6(1),r.Q6J("dataSource",e.dataSource)("treeControl",e.treeControl),r.xp6(2),r.Q6J("matTreeNodeDefWhen",e.hasChild)}}function vf(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",50),r.NdJ("click",function(){return r.CHM(e),r.oxw().clearSearch()}),r._uU(1),r.ALo(2,"translate"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("disabled",e.disabledClearSearch()),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.spatialFilter.clearSearch")," ")}}function bf(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",51),r.NdJ("click",function(){return r.CHM(e),r.oxw().clearDrawZone()}),r._uU(1),r.ALo(2,"translate"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("disabled",null===e.formControl.value),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.spatialFilter.clearForm")," ")}}let xf=(()=>{class e{constructor(e,t,o,i){this.cdRef=e,this.spatialFilterService=t,this.messageService=o,this.languageService=i,this.layers=[],this.allLayers=[],this.toggleSearch=new r.vpe,this.itemTypeChange=new r.vpe,this.thematicChange=new r.vpe,this.drawZoneEvent=new r.vpe,this.bufferEvent=new r.vpe,this.zoneWithBufferChange=new r.vpe,this.measureUnitChange=new r.vpe,this.radiusEvent=new r.vpe,this.freehandControl=new r.vpe,this.clearButtonEvent=new r.vpe,this.clearSearchEvent=new r.vpe,this.export=new r.vpe,this.openWorkspace=new r.vpe,this.itemType=[Id.Address,Id.Thematics],this.selectedItemType=Id.Address,this.treeControl=new cl.VY(e=>e.children),this.displayedColumns=["name","select"],this.childrens=[],this.groups=[],this.thematics=[],this.dataSource=new nl.WX,this.selectedThematics=new We.Ov(!0,[]),this.value$=new C.X(void 0),this.drawGuide$=new C.X(null),this.overlayStyle$=new C.X(void 0),this.drawStyle$=new C.X(void 0),this.formControl=new ze.NI,this.geometryTypeField=!1,this.geometryTypes=["Point","Polygon"],this.drawGuideField=!1,this.drawGuide=null,this.drawGuidePlaceholder="",this.measure=!1,this.drawControlIsActive=!0,this.freehandDrawIsActive=!1,this.buffer=0,this.radiusFormControl=new ze.NI,this.bufferFormControl=new ze.NI,this.measureUnit=ih.Meters}get type(){return this._type}set type(e){this._type=e;const t=this.geometryTypes.findIndex(e=>e===this.type);if(this.geometryType=this.geometryTypes[t],this.formControl.reset(),this.radius=void 0,this.drawGuide$.next(null),this.drawStyle$.next(void 0),this.type===Md.Predefined&&this.formControl.setValue({type:"Point",coordinates:""}),this.type===Md.Point)this.radius=1e3,this.radiusFormControl.setValue(this.radius),this.PointStyle=(e,t)=>{const o=e.getGeometry(),i=Fn.vs(o.getCoordinates(),this.map.projection,"EPSG:4326");return new Dn.ZP({image:new Jn.Z({radius:this.radius/Math.cos(Math.PI/180*i[1])/t,stroke:new Nn.Z({width:2,color:"rgba(0, 153, 255)"}),fill:new Rn.Z({color:"rgba(0, 153, 255, 0.2)"})})})},this.overlayStyle=this.PointStyle,this.drawStyle$.next(this.overlayStyle);else{this.radius=void 0,this.PolyStyle=()=>new Dn.ZP({stroke:new Nn.Z({width:2,color:"rgba(0, 153, 255)"}),fill:new Rn.Z({color:"rgba(0, 153, 255, 0.2)"})});const e=[0,153,255],t=()=>new Dn.ZP({image:new Jn.Z({radius:8,stroke:new Nn.Z({width:2,color:"rgba(0, 153, 255)"}),fill:new Rn.Z({color:"rgba(0, 153, 255, 0.2)"})}),stroke:new Nn.Z({color:e.concat([1]),width:2}),fill:new Rn.Z({color:e.concat([.2])})});this.overlayStyle=this.PolyStyle,this.drawStyle$.next(t)}this.overlayStyle$.next(this.overlayStyle)}get store(){return this._store}set store(e){this._store=e,this._store.entities$.subscribe(()=>{this.cdRef.detectChanges()})}get measureUnits(){return[ih.Meters,ih.Kilometers]}get thematicLength(){return this._thematicLength}set thematicLength(e){this._thematicLength=e}ngOnInit(){this.spatialFilterService.loadThematicsList().subscribe(e=>{for(const o of e)this.childrens.push(o),this.childrens.sort((e,t)=>e.name.localeCompare(t.name));this.groups.push(this.languageService.translate.instant("igo.geo.terrapi.limites"));const t={name:this.groups[0],children:[]};this.thematics.push(t),this.childrens.forEach(e=>{e.group&&-1===this.groups.indexOf(e.group)&&(this.groups.push(e.group),this.thematics.push({name:e.group,children:[]})),e.group||(e.name===this.languageService.translate.instant("igo.geo.terrapi.AdmRegion")||e.name===this.languageService.translate.instant("igo.geo.terrapi.Mun")||e.name===this.languageService.translate.instant("igo.geo.terrapi.Arrond")||e.name===this.languageService.translate.instant("igo.geo.terrapi.CircFed")||e.name===this.languageService.translate.instant("igo.geo.terrapi.CircProv")||e.name===this.languageService.translate.instant("igo.geo.terrapi.DirReg")||e.name===this.languageService.translate.instant("igo.geo.terrapi.MRC")||e.name===this.languageService.translate.instant("igo.geo.terrapi.RegTour")?e.group=t.name:e.name===this.languageService.translate.instant("igo.geo.terrapi.routes")?e.group=this.languageService.translate.instant("igo.geo.spatialFilter.group.transport"):this.thematics.push({name:e.name,children:[],source:e.source})),this.thematics.sort((e,t)=>e.name.localeCompare(t.name))}),this.thematics.forEach(e=>{for(const t of this.childrens)t.group===e.name&&e.children.push(t)})}),this.dataSource.data=this.thematics,this.drawGuide$.next(null),this.value$.next(this.formControl.value?this.formControl.value:void 0),this.value$$=this.formControl.valueChanges.subscribe(e=>{e?(this.value$.next(e),this.drawZone=this.formControl.value,0!==this.buffer&&(this.drawZoneEvent.emit(this.drawZone),this.bufferFormControl.setValue(this.buffer))):(this.value$.next(void 0),this.drawZone=void 0)}),this.value$.subscribe(()=>{this.getRadius(),this.cdRef.detectChanges()}),this.radiusChanges$$=this.radiusFormControl.valueChanges.subscribe(()=>{this.getRadius(),this.cdRef.detectChanges()}),this.bufferChanges$$=this.bufferFormControl.valueChanges.pipe((0,w.b)(500)).subscribe(e=>{this.measureUnit===ih.Meters&&e>0&&e<=1e5?(this.buffer=e,this.bufferEvent.emit(e),this.spatialFilterService.loadBufferGeometry(this.drawZone,Md.Polygon,e).subscribe(e=>{this.zoneWithBuffer=e,this.zoneWithBufferChange.emit(this.zoneWithBuffer)})):this.measureUnit===ih.Kilometers&&e>0&&e<=100?(this.buffer=e,this.bufferEvent.emit(e),this.spatialFilterService.loadBufferGeometry(this.drawZone,Md.Polygon,1e3*e).subscribe(e=>{this.zoneWithBuffer=e,this.zoneWithBufferChange.emit(this.zoneWithBuffer)})):0===e?(this.buffer=e,this.bufferEvent.emit(e),this.drawZoneEvent.emit(this.drawZone)):(e<0||this.measureUnit===ih.Meters&&e>1e5||this.measureUnit===ih.Kilometers&&e>100)&&(this.bufferFormControl.setValue(0),this.buffer=0,this.messageService.alert(this.languageService.translate.instant("igo.geo.spatialFilter.bufferAlert"),this.languageService.translate.instant("igo.geo.spatialFilter.warning")))})}ngOnDestroy(){this.value$$.unsubscribe(),this.radiusChanges$$.unsubscribe(),this.bufferChanges$$.unsubscribe(),this.cdRef.detach(),this.radiusChanges$$&&this.radiusChanges$$.unsubscribe(),this.value$$&&this.value$$.unsubscribe()}onItemTypeChange(e){this.selectedItemType=e.value,this.itemTypeChange.emit(this.selectedItemType)}onMeasureUnitChange(e){e!==this.measureUnit&&(this.measureUnit=e,this.measureUnitChange.emit(this.measureUnit),this.isPolygon()?this.bufferFormControl.setValue(this.measureUnit===ih.Meters?1e3*this.bufferFormControl.value:this.bufferFormControl.value/1e3):this.isPoint()&&this.radiusFormControl.setValue(this.measureUnit===ih.Meters?1e3*this.radiusFormControl.value:this.radiusFormControl.value/1e3))}isPredefined(){return this.type===Md.Predefined}isPolygon(){return this.type===Md.Polygon}isPoint(){return this.type===Md.Point}hasChild(e,t){return!!t.children&&t.children.length}onToggleClick(e){this.treeControl.isExpanded(e)?this.treeControl.collapse(e):this.treeControl.expand(e)}isAllSelected(e){let t,o=0;return e?(t=e.children.length,e.children.forEach(e=>{this.selectedThematics.selected.find(t=>t===e)&&o++})):(t=this.selectedThematics.selected.length,this.thematics.forEach(e=>{-1===this.groups.indexOf(e.name)&&o++}),this.childrens.forEach(e=>{this.thematics.find(t=>t.source===e.source)||o++})),o>=1&&t===o}hasChildrenSelected(e){let t=!1;return e.children.forEach(e=>{this.selectedThematics.selected.find(t=>t.source===e.source)&&(t=!0)}),t}masterToggle(){this.isAllSelected()?this.selectedThematics.clear():this.selectAll();const e=[];for(const t of this.selectedThematics.selected)e.push(t);this.isAllSelected()?this.thematics.forEach(e=>{this.hasChild(0,e)&&this.treeControl.expand(e)}):this.thematics.forEach(e=>{this.hasChild(0,e)&&this.treeControl.collapse(e)}),this.thematicChange.emit(e)}selectAll(e){e?this.hasChild(0,e)&&e.children.forEach(e=>this.selectedThematics.select(e)):(this.thematics.forEach(e=>{-1===this.groups.indexOf(e.name)&&this.selectedThematics.select(e)}),this.childrens.forEach(e=>{this.selectedThematics.selected.find(t=>t.source===e.source)||this.selectedThematics.select(e)}))}childrensToggle(e){this.isAllSelected(e)?e.children.forEach(e=>this.selectedThematics.deselect(e)):this.selectAll(e);const t=[];for(const o of this.selectedThematics.selected)t.push(o);this.treeControl.expand(e),this.thematicChange.emit(t)}onToggleChange(e){let t=!1;void 0!==this.selectedThematics.selected.find(t=>t.source===e.source)&&(t=!0),this.childrens.forEach(o=>{o===e&&!1===t&&this.selectedThematics.select(o),o===e&&!0===t&&this.selectedThematics.deselect(o)}),this.thematics.forEach(o=>{o===e&&!1===t&&this.selectedThematics.select(o),o===e&&!0===t&&this.selectedThematics.deselect(o)});const o=[];for(const i of this.selectedThematics.selected)o.push(i);this.thematicChange.emit(o)}onDrawControlChange(){this.drawControlIsActive=!this.drawControlIsActive}onfreehandControlChange(){this.freehandDrawIsActive=!this.freehandDrawIsActive,this.freehandControl.emit(this.freehandDrawIsActive)}toggleSearchButton(){this.isPredefined()||(this.buffer>0?(this.zoneWithBuffer.meta={id:void 0,title:"Zone"},this.zoneWithBuffer.properties={nom:"Zone",type:this.type},this.drawZoneEvent.emit(this.zoneWithBuffer)):(this.drawZone.meta={id:void 0,title:"Zone"},this.drawZone.properties={nom:"Zone",type:this.type},this.drawZoneEvent.emit(this.drawZone))),this.isPoint()?this.radiusEvent.emit(this.radius):this.isPolygon()&&this.bufferEvent.emit(this.buffer),this.toggleSearch.emit(),this.store.entities$.subscribe(e=>{e.length&&this.layers.length===this.thematicLength+1&&this.openWorkspace.emit()})}clearButton(){this.loading=!0,this.store&&this.store.clear(),(this.isPoint()||this.isPolygon())&&(this.drawZone=void 0,this.formControl.reset()),this.bufferFormControl.setValue(0),this.buffer=0,this.bufferEvent.emit(0),this.clearButtonEvent.emit(),this.loading=!1}clearDrawZone(){this.formControl.reset(),this.bufferFormControl.setValue(0),this.buffer=0}clearSearch(){this.selectedThematics.clear(),this.bufferFormControl.setValue(0),this.buffer=0,this.bufferEvent.emit(0),this.thematicChange.emit([]),this.clearSearchEvent.emit()}disableSearchButton(){if(this.type===Md.Predefined){if(this.selectedItemType===Id.Address&&void 0!==this.queryType&&void 0!==this.zone)return this.loading;if(this.selectedItemType===Id.Thematics&&void 0!==this.queryType&&void 0!==this.zone&&this.selectedThematics.selected.length>0)return this.loading}if(this.type===Md.Polygon||this.type===Md.Point){if(this.selectedItemType===Id.Address&&null!==this.formControl.value)return this.loading;if(this.selectedItemType===Id.Thematics&&this.selectedThematics.selected.length>0&&null!==this.formControl.value)return this.loading}return!0}disabledClearSearch(){let e=!0;return e=this.selectedItemType===Id.Address?void 0===this.queryType:void 0===this.queryType&&0===this.selectedThematics.selected.length,e}getRadius(){let e;if(e=null!==this.formControl.value?this.measureUnit===ih.Meters?this.formControl.value.radius:this.formControl.value.radius/1e3:void 0,this.type===Md.Point){if(this.freehandDrawIsActive){if(e){if(e>=1e5)return this.messageService.alert(this.languageService.translate.instant("igo.geo.spatialFilter.radiusAlert"),this.languageService.translate.instant("igo.geo.spatialFilter.warning")),void this.formControl.reset();if(e!==this.radiusFormControl.value)return void this.radiusFormControl.setValue(e)}}else if(this.radiusFormControl.value<0||this.measureUnit===ih.Meters&&this.radiusFormControl.value>=1e5||this.measureUnit===ih.Kilometers&&this.radiusFormControl.value>=100)return this.messageService.alert(this.languageService.translate.instant("igo.geo.spatialFilter.radiusAlert"),this.languageService.translate.instant("igo.geo.spatialFilter.warning")),this.radius=1e3,this.radiusFormControl.setValue(this.measureUnit===ih.Meters?this.radius:this.radius/1e3),void this.drawGuide$.next(this.radius);this.measureUnit===ih.Meters?(this.radius=this.radiusFormControl.value,this.drawGuide$.next(this.radius)):(this.radius=1e3*this.radiusFormControl.value,this.drawGuide$.next(1e3*this.radius)),this.overlayStyle$.next(this.PointStyle),this.drawStyle$.next(this.PointStyle)}}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.sBO),r.Y36(kd),r.Y36(le),r.Y36(ne))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-spatial-filter-item"]],inputs:{map:"map",type:"type",queryType:"queryType",zone:"zone",loading:"loading",store:"store",layers:"layers",allLayers:"allLayers",thematicLength:"thematicLength"},outputs:{toggleSearch:"toggleSearch",itemTypeChange:"itemTypeChange",thematicChange:"thematicChange",drawZoneEvent:"drawZoneEvent",bufferEvent:"bufferEvent",zoneWithBufferChange:"zoneWithBufferChange",measureUnitChange:"measureUnitChange",radiusEvent:"radiusEvent",freehandControl:"freehandControl",clearButtonEvent:"clearButtonEvent",clearSearchEvent:"clearSearchEvent",export:"export",openWorkspace:"openWorkspace"},decls:27,vars:40,consts:[[3,"formControl","map","geometryType","drawGuide","measure","drawControlIsActive","freehandDrawIsActive","drawStyle","overlayStyle","radius"],[1,"header"],[3,"checked","labelPosition","change",4,"ngIf"],["class","buffer-unit",4,"ngIf"],["class","radius-unit",4,"ngIf"],[1,"title","mat-typography"],[3,"value"],[3,"value","change",4,"ngFor","ngForOf"],["class","thematics",4,"ngIf"],[1,"buttons"],["mat-raised-button","","class","clear-search-button",3,"disabled","click",4,"ngIf"],["mat-raised-button","","class","clear-form-button",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","primary",1,"search-button",3,"disabled","click"],["mat-raised-button","",1,"remove-button",3,"disabled","click"],["mat-raised-button","",1,"export-button",3,"disabled","click"],[3,"checked","labelPosition","change"],[1,"buffer-unit"],[1,"buffer-form"],[1,"buffer"],["type","number","matInput","",3,"placeholder","formControl","value","readonly"],[1,"unit-field"],[3,"value","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"radius-unit"],[1,"radius-form"],[1,"radius"],["type","number","matInput","",3,"placeholder","formControl","value","readonly","input"],[3,"value","change"],[1,"thematics"],["matColumnDef","name"],["class","thematics-header",4,"matHeaderCellDef"],["matColumnDef","select"],["class","checks-header",4,"matHeaderCellDef"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[3,"dataSource","treeControl"],["matTreeNodeToggle","",4,"matTreeNodeDef"],[4,"matTreeNodeDef","matTreeNodeDefWhen"],[1,"thematics-header"],[1,"checks-header"],[3,"checked","indeterminate","change"],["matTreeNodeToggle",""],[1,"mat-tree-node"],["mat-icon-button","","disabled",""],[1,"tree-check",3,"checked","click","change"],["mat-icon-button","",3,"click"],[3,"svgIcon"],[1,"tree-check-2",3,"checked","indeterminate","change"],[1,"tree-ul"],["matTreeNodeOutlet",""],["mat-raised-button","",1,"clear-search-button",3,"disabled","click"],["mat-raised-button","",1,"clear-form-button",3,"disabled","click"]],template:function(e,t){1&e&&(r._UZ(0,"igo-geometry-form-field-input",0),r.ALo(1,"async"),r.ALo(2,"async"),r.ALo(3,"async"),r.TgZ(4,"div",1),r.YNc(5,rf,3,5,"mat-slide-toggle",2),r.YNc(6,sf,3,5,"mat-slide-toggle",2),r.qZA(),r.YNc(7,af,8,8,"div",3),r.YNc(8,cf,8,8,"div",4),r.TgZ(9,"mat-label",5),r._uU(10),r.ALo(11,"translate"),r.qZA(),r.TgZ(12,"mat-radio-group",6),r.YNc(13,uf,3,4,"mat-radio-button",7),r.qZA(),r.YNc(14,yf,11,5,"div",8),r.TgZ(15,"div",9),r.YNc(16,vf,3,4,"button",10),r.YNc(17,bf,3,4,"button",11),r.TgZ(18,"button",12),r.NdJ("click",function(){return t.toggleSearchButton()}),r._uU(19),r.ALo(20,"translate"),r.qZA(),r.TgZ(21,"button",13),r.NdJ("click",function(){return t.clearButton()}),r._uU(22),r.ALo(23,"translate"),r.qZA(),r.TgZ(24,"button",14),r.NdJ("click",function(){return t.export.emit()}),r._uU(25),r.ALo(26,"translate"),r.qZA(),r.qZA()),2&e&&(r.Q6J("formControl",t.formControl)("map",t.map)("geometryType",t.geometryType)("drawGuide",r.lcZ(1,26,t.drawGuide$))("measure",t.measure)("drawControlIsActive",t.drawControlIsActive)("freehandDrawIsActive",t.freehandDrawIsActive)("drawStyle",r.lcZ(2,28,t.drawStyle$))("overlayStyle",r.lcZ(3,30,t.overlayStyle$))("radius",t.radius),r.xp6(5),r.Q6J("ngIf",!t.isPredefined()),r.xp6(1),r.Q6J("ngIf",!t.isPredefined()),r.xp6(1),r.Q6J("ngIf",t.isPolygon()),r.xp6(1),r.Q6J("ngIf",t.isPoint()),r.xp6(2),r.hij("",r.lcZ(11,32,"igo.geo.spatialFilter.search")," : "),r.xp6(2),r.Q6J("value",t.selectedItemType),r.xp6(1),r.Q6J("ngForOf",t.itemType),r.xp6(1),r.Q6J("ngIf","Thematics"===t.selectedItemType),r.xp6(2),r.Q6J("ngIf",t.isPredefined()),r.xp6(1),r.Q6J("ngIf",t.isPolygon()||t.isPoint()),r.xp6(1),r.Q6J("disabled",t.disableSearchButton()),r.xp6(1),r.hij(" ",r.lcZ(20,34,"igo.geo.spatialFilter.goSearch")," "),r.xp6(2),r.Q6J("disabled",0===t.allLayers.length),r.xp6(1),r.hij(" ",r.lcZ(23,36,"igo.geo.spatialFilter.removeLayer")," "),r.xp6(2),r.Q6J("disabled",!t.store.entities$.getValue().length),r.xp6(1),r.hij(" ",r.lcZ(26,38,"igo.geo.spatialFilter.exportLayer")," "))},styles:[".header[_ngcontent-%COMP%]{margin-top:5px;width:100%}.mat-slide-toggle[_ngcontent-%COMP%]{padding:5px;margin-bottom:15px;width:98%}.mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content{width:calc(100% - 20px)}.title[_ngcontent-%COMP%]{margin-left:5px;font-size:medium;font-size:initial}.mat-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-top:10px}.mat-radio-button[_ngcontent-%COMP%]{display:inline-flex;position:relative;margin-left:16px;margin-top:10px}.mat-form-field[_ngcontent-%COMP%]{margin-top:5px}.mat-column-select[_ngcontent-%COMP%]{overflow:auto}.buttons[_ngcontent-%COMP%]{margin-top:15px}.search-button[_ngcontent-%COMP%]{left:15px;width:165px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){.search-button[_ngcontent-%COMP%]{left:10px;width:45%;min-height:35px;white-space:normal;line-height:normal}}.export-button[_ngcontent-%COMP%]{left:15px;width:165px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){.export-button[_ngcontent-%COMP%]{left:10px;margin-top:10px;width:45%;min-height:35px;white-space:normal;line-height:normal}}.remove-button[_ngcontent-%COMP%]{margin-top:12px;left:5px;width:165px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){.remove-button[_ngcontent-%COMP%]{margin:0;width:45%;min-height:35px;white-space:normal;line-height:normal}}.clear-form-button[_ngcontent-%COMP%]{left:5px;width:165px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){.clear-form-button[_ngcontent-%COMP%]{width:45%;min-height:35px;white-space:normal;line-height:normal}}.clear-search-button[_ngcontent-%COMP%]{left:5px;width:165px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){.clear-search-button[_ngcontent-%COMP%]{width:45%;min-height:35px;white-space:normal;line-height:normal}}.thematics[_ngcontent-%COMP%]{max-height:35%;overflow:auto;margin-top:5px;width:98%}.results[_ngcontent-%COMP%]{overflow:auto;max-height:250px;width:98%}.mat-column-typeResults[_ngcontent-%COMP%]{max-width:100px;margin-right:5px}.buffer-unit[_ngcontent-%COMP%], .radius-unit[_ngcontent-%COMP%]{display:flex;width:100%;margin-left:2px;padding:5px}.radius[_ngcontent-%COMP%], .buffer[_ngcontent-%COMP%]{display:flex;flex-flow:column nowrap;width:110%}.unit-field[_ngcontent-%COMP%]{width:110px;margin-left:30px}.example-tree-invisible[_ngcontent-%COMP%]{display:none}.tree-ul[_ngcontent-%COMP%]{margin:0;padding:0 0 0 20px;list-style-type:none}.tree-check[_ngcontent-%COMP%], .tree-check-2[_ngcontent-%COMP%]{position:relative;margin-left:auto;margin-right:5px}.thematics-header[_ngcontent-%COMP%]{max-width:250px}.checks-header[_ngcontent-%COMP%]{padding:none;max-width:calc(100% - 316px);overflow:hidden}.mat-checkbox[_ngcontent-%COMP%]{padding:5px}.mat-tree-node[_ngcontent-%COMP%]{position:relative;min-height:42px;width:280px}.mat-header-cell[_ngcontent-%COMP%]{height:56px}"],changeDetection:0}),e})();const wf=["endDatepickerTime"],Sf=["beginDatepickerTime"],Cf=["beginTime"],Tf=["endTime"];function Af(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-slide-toggle",4),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw().sliderMode=t})("change",function(t){return r.CHM(e),r.oxw().modeChange(t)}),r._uU(1),r.ALo(2,"translate"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("ngModel",e.sliderMode),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.filter.sliderModeTitle")," ")}}function Zf(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",5),r.TgZ(1,"igo-ogc-filter-time-slider",6),r.NdJ("changeProperty",function(t){return r.CHM(e),r.oxw().changePropertyByPass(t)}),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(1),r.Q6J("begin",e.beginValue)("max",e.restrictedToStep()?e.maxDate:e.endValue)("currentFilter",e.currentFilter)("datasource",e.datasource)}}function Lf(e,t){if(1&e&&(r.TgZ(0,"mat-option",22),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.Oqu(e)}}function Ff(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-form-field",19),r.TgZ(1,"mat-label"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"mat-select",20),r.NdJ("selectionChange",function(){r.CHM(e),r.oxw();const t=r.MAs(5);return r.oxw().changeTemporalProperty(t.value,1)}),r.YNc(5,Lf,2,2,"mat-option",21),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(2);r.xp6(2),r.Oqu(r.lcZ(3,4,"igo.geo.timeFilter.hour")),r.xp6(2),r.Q6J("formControl",e.beginHourFormControl),r.uIk("disabled",!e.currentFilter.active),r.xp6(1),r.Q6J("ngForOf",e.beginHours)}}function Of(e,t){if(1&e&&(r.TgZ(0,"mat-option",22),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.Oqu(e)}}function Mf(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-form-field",23),r.TgZ(1,"mat-label"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"mat-select",20),r.NdJ("selectionChange",function(){r.CHM(e),r.oxw();const t=r.MAs(5);return r.oxw().changeTemporalProperty(t.value,1)}),r.YNc(5,Of,2,2,"mat-option",21),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(2);r.xp6(2),r.Oqu(r.lcZ(3,4,"igo.geo.timeFilter.minute")),r.xp6(2),r.Q6J("formControl",e.beginMinuteFormControl),r.uIk("disabled",!e.currentFilter.active),r.xp6(1),r.Q6J("ngForOf",e.beginMinutes)}}function If(e,t){if(1&e&&(r.TgZ(0,"mat-option",22),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.Oqu(e)}}function kf(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-form-field",19),r.TgZ(1,"mat-label"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"mat-select",20),r.NdJ("selectionChange",function(){r.CHM(e),r.oxw();const t=r.MAs(4);return r.oxw(2).changeTemporalProperty(t.value,2)}),r.YNc(5,If,2,2,"mat-option",21),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(3);r.xp6(2),r.Oqu(r.lcZ(3,4,"igo.geo.timeFilter.hour")),r.xp6(2),r.Q6J("formControl",e.endHourFormControl),r.uIk("disabled",!e.currentFilter.active),r.xp6(1),r.Q6J("ngForOf",e.endHours)}}function Pf(e,t){if(1&e&&(r.TgZ(0,"mat-option",22),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.Oqu(e)}}function _f(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-form-field",23),r.TgZ(1,"mat-label"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"mat-select",20),r.NdJ("selectionChange",function(){r.CHM(e),r.oxw();const t=r.MAs(4);return r.oxw(2).changeTemporalProperty(t.value,2)}),r.YNc(5,Pf,2,2,"mat-option",21),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(3);r.xp6(2),r.Oqu(r.lcZ(3,4,"igo.geo.timeFilter.minute")),r.xp6(2),r.Q6J("formControl",e.endMinuteFormControl),r.uIk("disabled",!e.currentFilter.active),r.xp6(1),r.Q6J("ngForOf",e.endMinutes)}}function $f(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",7),r.TgZ(1,"mat-form-field",8),r._UZ(2,"mat-datepicker-toggle",9),r.TgZ(3,"input",10,24),r.NdJ("dateChange",function(){r.CHM(e);const t=r.MAs(4);return r.oxw(2).changeTemporalProperty(t.value,2)}),r.ALo(5,"translate"),r.qZA(),r._UZ(6,"span",12),r.TgZ(7,"mat-datepicker",13,25),r.NdJ("yearSelected",function(t){r.CHM(e);const o=r.MAs(8);return r.oxw(2).yearSelected(t,o,"end")})("monthSelected",function(t){r.CHM(e);const o=r.MAs(8);return r.oxw(2).monthSelected(t,o,"end")}),r.qZA(),r.qZA(),r.TgZ(9,"div",15),r.YNc(10,kf,6,6,"mat-form-field",16),r.YNc(11,_f,6,6,"mat-form-field",17),r.qZA(),r.qZA()}if(2&e){const e=r.MAs(8),t=r.oxw(2);r.xp6(2),r.Q6J("for",e),r.xp6(1),r.Q6J("matDatepicker",e)("placeholder",r.lcZ(5,12,"igo.geo.timeFilter.endDate"))("matDatepickerFilter",t.dateFilter.bind(t,"end"))("value",t.endValue?t.endValue:t.handleDate(t.datasource.options.maxDate))("min",t.beginValue?t.beginValue:t.handleDate(t.datasource.options.minDate))("max",t.handleDate(t.datasource.options.maxDate)),r.uIk("disabled",!t.currentFilter.active),r.xp6(4),r.Q6J("startView",t.calendarView())("startAt",t.endValue),r.xp6(3),r.Q6J("ngIf","datetime"===t.calendarType()),r.xp6(1),r.Q6J("ngIf","datetime"===t.calendarType())}}function qf(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div"),r.TgZ(1,"div",7),r.TgZ(2,"mat-form-field",8),r._UZ(3,"mat-datepicker-toggle",9),r.TgZ(4,"input",10,11),r.NdJ("dateChange",function(){r.CHM(e);const t=r.MAs(5);return r.oxw().changeTemporalProperty(t.value,1)}),r.ALo(6,"translate"),r.qZA(),r._UZ(7,"span",12),r.TgZ(8,"mat-datepicker",13,14),r.NdJ("yearSelected",function(t){r.CHM(e);const o=r.MAs(9);return r.oxw().yearSelected(t,o,"begin")})("monthSelected",function(t){r.CHM(e);const o=r.MAs(9);return r.oxw().monthSelected(t,o,"begin")}),r.qZA(),r.qZA(),r.TgZ(10,"div",15),r.YNc(11,Ff,6,6,"mat-form-field",16),r.YNc(12,Mf,6,6,"mat-form-field",17),r.qZA(),r.qZA(),r.YNc(13,$f,12,14,"div",18),r.qZA()}if(2&e){const e=r.MAs(9),t=r.oxw();r.xp6(3),r.Q6J("for",e),r.xp6(1),r.Q6J("matDatepicker",e)("placeholder",r.lcZ(6,13,"igo.geo.timeFilter.startDate"))("matDatepickerFilter",t.dateFilter.bind(t,"begin"))("value",t.beginValue?t.beginValue:t.handleDate(t.datasource.options.minDate))("min",t.handleDate(t.datasource.options.minDate))("max",t.endValue&&!t.restrictedToStep()?t.endValue:t.handleDate(t.datasource.options.maxDate)),r.uIk("disabled",!t.currentFilter.active),r.xp6(4),r.Q6J("startView",t.calendarView())("startAt",t.beginValue),r.xp6(3),r.Q6J("ngIf","datetime"===t.calendarType()),r.xp6(1),r.Q6J("ngIf","datetime"===t.calendarType()),r.xp6(1),r.Q6J("ngIf",!t.restrictedToStep())}}const Df=na;let Ef=(()=>{class e{constructor(e){this.ogcFilterTimeService=e,this.changeProperty=new r.vpe,this.beginHourFormControl=new ze.NI,this.beginMinuteFormControl=new ze.NI,this.endHourFormControl=new ze.NI,this.endMinuteFormControl=new ze.NI,this._defaultMin="1900-01-01",this._defaultMax="2052-01-06",this._defaultDisplayFormat="DD/MM/YYYY HH:mm A",this._defaultSliderModeEnabled=!0,this.ogcFilterOperator=El,this.sliderMode=!1,this.defaultStepMillisecond=6e4}get step(){return this.datasource.options.stepDate?this.datasource.options.stepDate:this.currentFilter.step}get stepMilliseconds(){const e=Df.duration(this.step).asMilliseconds();return 0===e?this.defaultStepMillisecond:e}set beginValue(e){this._beginValue=e}get beginValue(){return this._beginValue}set endValue(e){this._endValue=e}get endValue(){return this._endValue}get sliderInterval(){return void 0===this.currentFilter.sliderInterval?2e3:this.currentFilter.sliderInterval}get maxDate(){return this.datasource.options.maxDate?this.datasource.options.maxDate:this._defaultMax}get displayFormat(){return this.currentFilter.displayFormat?this.currentFilter.displayFormat:this._defaultDisplayFormat}ngOnInit(){this.currentFilter.sliderOptions&&(this.currentFilter.sliderOptions.enabled=void 0!==this.currentFilter.sliderOptions.enabled?this.currentFilter.sliderOptions.enabled:this._defaultSliderModeEnabled),this.beginValue=this.parseFilter(this.handleMin()),this.endValue=this.parseFilter(this.handleMax()),this.updateHoursMinutesArray(),this.updateValues()}parseFilter(e){if(!e)return new Date;if(isNaN(new Date(e).getTime())){if(e.search("now")>=0){const t=e.match(/years|months|weeks|days|hours|seconds/);if(e.match(/\+/)){const o=parseInt(e.substring(e.search("+")+1,t.index),10);return Df().add(o,t[0]).toDate()}if(e.match(/\-/)){const o=parseInt(e.substring(e.search("-")+1,t.index),10);return Df().subtract(o,t[0]).toDate()}return new Date}if(e.search("today")>=0){const t=Df().endOf("day").toDate(),o=e.match(/years|months|weeks|days|hours|seconds/);if(e.match(/\+/)){const i=parseInt(e.substring(e.search("+")+1,o.index),10);return Df(t).add(i,o[0]).toDate()}if(e.match(/\-/)){const i=parseInt(e.substring(e.search("-")+1,o.index),10);return Df(t).subtract(i,o[0]).toDate()}return t}return new Date}return e?new Date(e):new Date}changeTemporalProperty(e,t,o=!0){let i=this.getDateTime(e,t);2===t&&"date"===this.calendarType()&&!this.sliderMode&&(i=Df(i).endOf("day").toDate()),1===t?(this.beginValue=i,this.restrictedToStep()&&this.changeTemporalProperty(this.ogcFilterTimeService.addStep(i,this.stepMilliseconds),2,o)):this.endValue=i,this.updateHoursMinutesArray(),this.changeProperty.next({value:i.toISOString(),pos:t,refreshFilter:o})}handleDate(e){if(e&&""!==e)return new Date(e)}calendarType(){return this.stepMilliseconds<864e5?"datetime":"date"}yearSelected(e,t,o,i=!0){this.ogcFilterTimeService.stepIsYearDuration(this.step)&&(t&&t.close(),"end"===o?e=Df(e).endOf("year").toDate():"begin"===o&&this.restrictedToStep()&&this.yearSelected(e,void 0,"end"),this.changeTemporalProperty(e,"begin"===o?1:2,i))}monthSelected(e,t,o,i=!0){this.ogcFilterTimeService.stepIsMonthDuration(this.step)&&(t&&t.close(),"end"===o?e=Df(e).endOf("month").toDate():"begin"===o&&this.restrictedToStep()&&this.monthSelected(e,void 0,"end"),this.changeTemporalProperty(e,"begin"===o?1:2,i))}calendarView(){const e=this.stepMilliseconds,t=Math.abs(this.parseFilter(this.currentFilter.end).getTime()-this.parseFilter(this.currentFilter.begin).getTime());return this.ogcFilterTimeService.stepIsYearDuration(this.step)?"multi-year":this.ogcFilterTimeService.stepIsMonthDuration(this.step)?"year":e<864e5&&t<864e5?"clock":"month"}dateFilter(e,t){const o=new Date(t),i=o.getTime()-new Date(this.handleMin()).getTime();if(this.ogcFilterTimeService.stepIsYearDuration(this.step)){const t=Df(o).diff(Df(this.handleMin()),"years",!0);if("end"===e){const e=Df(o).add(1,"d");return Df(e).diff(Df(this.handleMin()),"years",!0)%Df.duration(this.step).asYears()==0}if("begin"===e)return t%Df.duration(this.step).asYears()==0}else if(this.ogcFilterTimeService.stepIsMonthDuration(this.step)){const t=Df(o).diff(Df(this.handleMin()),"months",!0);if("end"===e){const e=Df(o).add(1,"d");return Df(e).diff(Df(this.handleMin()),"months",!0)%Df.duration(this.step).asMonths()==0}if("begin"===e)return t%Df.duration(this.step).asMonths()==0}else if(this.ogcFilterTimeService.stepIsWeekDuration(this.step)){const t=Df(o).diff(Df(this.handleMin()),"weeks",!0);if("end"===e){const e=Df(o).add(1,"d");return Df(e).diff(Df(this.handleMin()),"weeks",!0)%Df.duration(this.step).asWeeks()==0}if("begin"===e)return t%Df.duration(this.step).asWeeks()==0}else if(this.ogcFilterTimeService.stepIsDayDuration(this.step)){const t=Df(o).diff(Df(this.handleMin()),"days",!0);if("end"===e){const e=Df(o).add(1,"d"),t=Df(e).diff(Df(this.handleMin()),"days",!0)%Df.duration(this.step).asDays();return t<1e-7&&t>-1e-7||0===t}if("begin"===e){const e=t%Df.duration(this.step).asDays()+1;return e<1e-7&&e>-1e-7&&0!==e||1===e}}else{if(this.ogcFilterTimeService.stepIsHourDuration(this.step))return Df(o).diff(Df(this.handleMin()),"hours",!0)%Df.duration(this.step).asHours()==0;if(this.ogcFilterTimeService.stepIsMinuteDuration(this.step))return!0}return i%this.stepMilliseconds==0}getDateTime(e,t){const o=new Date(e);let i;if(!this.sliderMode)switch(t){case 1:i=o.setHours(this.beginHourFormControl.value,this.beginMinuteFormControl.value);break;case 2:i=o.setHours(this.endHourFormControl.value,this.endMinuteFormControl.value)}return new Date(i||o)}handleMinuteIncrement(){return this.ogcFilterTimeService.stepIsMinuteDuration(this.step)?this.stepMilliseconds<36e5?this.stepMilliseconds/1e3==60?1:this.stepMilliseconds/1e3:this.stepMilliseconds%36e5/60:this.ogcFilterTimeService.stepIsHourDuration(this.step)?60:1}handleHourIncrement(){return this.ogcFilterTimeService.stepIsHourDuration(this.step)?this.stepMilliseconds/1e3/60/60:1}fullBeginHoursArray(e){this.beginHours=Array.from(e?{length:(this.endHourFormControl.value-0)/this.handleHourIncrement()+1}:{length:23/this.handleHourIncrement()+1},(e,t)=>0+t*this.handleHourIncrement()),this.beginHourFormControl.setValue(this.beginValue.getHours())}fullEndHoursArray(e){this.endHours=e?Array.from({length:(23-this.beginHourFormControl.value)/this.handleHourIncrement()+1},(e,t)=>this.beginHourFormControl.value+t*this.handleHourIncrement()):Array.from({length:23/this.handleHourIncrement()+1},(e,t)=>0+t*this.handleHourIncrement()),this.endHourFormControl.setValue(this.endValue.getHours())}fullBeginMinutesArray(e){this.beginMinutes=Array.from(e?{length:(this.endMinuteFormControl.value-0)/this.handleMinuteIncrement()+1}:{length:59/this.handleMinuteIncrement()+1},(e,t)=>0+t*this.handleMinuteIncrement()),this.beginMinuteFormControl.setValue(this.beginValue.getMinutes())}fullEndMinutesArray(e){this.endMinutes=e?Array.from({length:(59-this.beginMinuteFormControl.value)/this.handleMinuteIncrement()+1},(e,t)=>this.beginMinuteFormControl.value+t*this.handleMinuteIncrement()):Array.from({length:59/this.handleMinuteIncrement()+1},(e,t)=>0+t*this.handleMinuteIncrement()),this.endMinuteFormControl.setValue(this.endValue.getMinutes())}updateHoursMinutesArray(){const e=new Date(this.beginValue),t=new Date(this.endValue);e.setHours(0,0)===t.setHours(0,0)?(this.fullBeginHoursArray(!0),this.fullEndHoursArray(!0),this.beginValue.getHours()===this.endValue.getHours()&&(this.fullBeginMinutesArray(!0),this.fullEndMinutesArray(!0))):(this.fullBeginHoursArray(),this.fullEndHoursArray(),this.fullBeginMinutesArray(),this.fullEndMinutesArray())}updateValues(){this.changeTemporalProperty(this.beginValue,1,!1),this.changeTemporalProperty(this.endValue,2,!0)}restrictedToStep(){return!!this.currentFilter.restrictToStep&&this.currentFilter.restrictToStep}handleMin(){return this.currentFilter.begin?this.currentFilter.begin:this.datasource.options.minDate?this.datasource.options.minDate:this._defaultMin}handleMax(){return this.currentFilter.end?this.currentFilter.end:this.datasource.options.maxDate?this.datasource.options.maxDate:this._defaultMax}changePropertyByPass(e){this.changeProperty.next(e)}modeChange(e){e.checked||this.updateValues()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(gm))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-ogc-filter-time"]],viewQuery:function(e,t){if(1&e&&(r.Gf(wf,5),r.Gf(Sf,5),r.Gf(Cf,5),r.Gf(Tf,5)),2&e){let e;r.iGM(e=r.CRH())&&(t.endDatepickerTime=e.first),r.iGM(e=r.CRH())&&(t.beginDatepickerTime=e.first),r.iGM(e=r.CRH())&&(t.beginTime=e.first),r.iGM(e=r.CRH())&&(t.endTime=e.first)}},inputs:{datasource:"datasource",currentFilter:"currentFilter"},outputs:{changeProperty:"changeProperty"},decls:4,vars:3,consts:[[1,"datetime-container"],[3,"ngModel","ngModelChange","change",4,"ngIf"],["class","slider-container",4,"ngIf"],[4,"ngIf"],[3,"ngModel","ngModelChange","change"],[1,"slider-container"],[3,"begin","max","currentFilter","datasource","changeProperty"],[1,"datetime-input"],[1,"date-input"],["matSuffix","",3,"for"],["matInput","",3,"matDatepicker","placeholder","matDatepickerFilter","value","min","max","dateChange"],["begin",""],[1,"filler"],[3,"startView","startAt","yearSelected","monthSelected"],["beginDatepicker",""],[1,"time-input"],["class","hour-input",4,"ngIf"],["class","minute-input",4,"ngIf"],["class","datetime-input",4,"ngIf"],[1,"hour-input"],[3,"formControl","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"minute-input"],["end",""],["endDatepicker",""]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.YNc(1,Af,3,4,"mat-slide-toggle",1),r.YNc(2,Zf,2,4,"div",2),r.YNc(3,qf,14,15,"div",3),r.qZA()),2&e&&(r.xp6(1),r.Q6J("ngIf",null==t.currentFilter.sliderOptions?null:t.currentFilter.sliderOptions.enabled),r.xp6(1),r.Q6J("ngIf",t.sliderMode),r.xp6(1),r.Q6J("ngIf",!t.sliderMode))},styles:["input{text-align:center!important;margin:auto 5px!important}.slider-container[_ngcontent-%COMP%]{text-align:center}.datetime-input[_ngcontent-%COMP%]{display:inline-block;margin:5px 25px}.date-input[_ngcontent-%COMP%]{width:120px;margin-right:25px}.time-input[_ngcontent-%COMP%]{display:inherit;margin-right:25px}.hour-input[_ngcontent-%COMP%], .minute-input[_ngcontent-%COMP%]{width:40px}.minute-input[_ngcontent-%COMP%]{margin-left:10px}"]}),e})();const Rf=na;let Uf=(()=>{class e{constructor(e){this.ogcFilterTimeService=e,this.changeProperty=new r.vpe,this.sliderValue=1,this.calculatedStep=0,this._defaultDisplayFormat="DD/MM/YYYY HH:mm A",this._defaultSliderInterval=2e3,this.playIcon="play-circle",this.resetIcon="replay",this.sliderDisplayWith=this.sliderDisplayWith.bind(this)}get sliderInterval(){return void 0===this.currentFilter.sliderInterval?this._defaultSliderInterval:this.currentFilter.sliderInterval}get displayFormat(){var e;return(null===(e=this.currentFilter.sliderOptions)||void 0===e?void 0:e.displayFormat)?this.currentFilter.sliderOptions.displayFormat:this.currentFilter.displayFormat?this.currentFilter.displayFormat:this._defaultDisplayFormat}get beginMillisecond(){return this.ogcFilterTimeService.dateToNumber(this.begin)}get maxMillisecond(){return this.ogcFilterTimeService.dateToNumber(this.max)}get stepMillisecond(){return this.ogcFilterTimeService.stepMillisecond(this.datasource,this.currentFilter)}ngOnInit(){this.calculateStep(),this.handleSliderInput({value:1})}sliderDisplayWith(e){let t=new Date(this.beginMillisecond+(e-1)*this.stepMillisecond);if(this.ogcFilterTimeService.stepIsYearDuration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter))){const o=Rf.duration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter)).years();t=Rf(this.beginMillisecond).add((e-1)*o,"year").toDate()}else if(this.ogcFilterTimeService.stepIsMonthDuration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter))){const o=Rf.duration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter)).months();t=Rf(this.beginMillisecond).add((e-1)*o,"month").toDate()}return Rf(t).format(this.displayFormat)}playFilter(e){this.interval?this.stopFilter():(this.playIcon="pause-circle",this.interval=setInterval(e=>{if(this.slider.value<this.calculatedStep){const e="_emitInputEvent";this.slider._increment(1),this.slider[e]()}else this.stopFilter()},this.sliderInterval,this))}stopFilter(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.playIcon="play-circle"}resetFilter(e){this.interval&&clearInterval(this.interval),this.interval=void 0,this.playIcon="play-circle",this.slider.value=1,this.slider._emitInputEvent()}handleSliderInput(e){if(e)if(this.ogcFilterTimeService.stepIsYearDuration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter))){const t=Rf.duration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter)).years(),o=Rf(this.beginMillisecond).add((e.value-1)*t,"year").toDate(),i=Rf(o).add(t,"year").toDate();this.changeProperty.next({value:Rf(o).toDate().toISOString(),pos:1,refreshFilter:!1}),this.changeProperty.next({value:Rf(i).toDate().toISOString(),pos:2,refreshFilter:!0})}else if(this.ogcFilterTimeService.stepIsMonthDuration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter))){const t=Rf.duration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter)).months(),o=Rf(this.beginMillisecond).add((e.value-1)*t,"month").toDate(),i=Rf(o).add(t,"month").toDate();this.changeProperty.next({value:Rf(o).startOf("month").toDate().toISOString(),pos:1,refreshFilter:!1}),this.changeProperty.next({value:Rf(i).toDate().toISOString(),pos:2,refreshFilter:!0})}else if(this.ogcFilterTimeService.stepIsDayDuration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter))||this.ogcFilterTimeService.stepIsHourDuration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter))||this.ogcFilterTimeService.stepIsMinuteDuration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter))){const t=new Date(this.beginMillisecond+this.stepMillisecond*(e.value-1));this.changeProperty.next({value:t.toISOString(),pos:1,refreshFilter:!1}),this.changeProperty.next({value:new Date(this.ogcFilterTimeService.addStep(t.toISOString(),this.stepMillisecond)).toISOString(),pos:2,refreshFilter:!0})}}calculateStep(){for(let e=1;this.maxMillisecond-(this.beginMillisecond+e*this.stepMillisecond)>=-1;e++)this.calculatedStep=e}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(gm))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-ogc-filter-time-slider"]],viewQuery:function(e,t){if(1&e&&r.Gf(za.pH,5),2&e){let e;r.iGM(e=r.CRH())&&(t.slider=e.first)}},inputs:{currentFilter:"currentFilter",begin:"begin",max:"max",datasource:"datasource"},outputs:{changeProperty:"changeProperty"},decls:6,vars:7,consts:[[1,"slider-container"],["id","time-slider","thumbLabel","",3,"step","min","max","ngModel","displayWith","ngModelChange","input"],["mat-icon-button","","color","primary",3,"click"],[3,"svgIcon"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"mat-slider",1),r.NdJ("ngModelChange",function(e){return t.sliderValue=e})("input",function(e){return t.handleSliderInput(e)}),r.qZA(),r.TgZ(2,"button",2),r.NdJ("click",function(e){return t.playFilter(e)}),r._UZ(3,"mat-icon",3),r.qZA(),r.TgZ(4,"button",2),r.NdJ("click",function(e){return t.resetFilter(e)}),r._UZ(5,"mat-icon",3),r.qZA(),r.qZA()),2&e&&(r.xp6(1),r.Q6J("step",1)("min",1)("max",t.calculatedStep)("ngModel",t.sliderValue)("displayWith",t.sliderDisplayWith),r.xp6(2),r.Q6J("svgIcon",t.playIcon),r.xp6(2),r.s9C("svgIcon",t.resetIcon))},directives:[za.pH,ze.JJ,ze.On,n.lW,a.Hw],styles:["input{text-align:center!important;margin:auto 5px!important}  .mat-slider-thumb{transform:scale(0)!important}  .mat-slider-thumb-label{transform:rotate(45deg)!important;border-radius:50% 50% 0!important;background-color:#ffd740!important}  .mat-slider-thumb-label-text{opacity:1!important;transform:rotate(135deg)!important}  .mat-slider-horizontal .mat-slider-thumb-label{top:10px!important;transform:rotate(225deg)!important}  .mat-slider-horizontal.cdk-focused .mat-slider-thumb-label{transform:rotate(225deg)!important}.datetime-container[_ngcontent-%COMP%]{text-align:center}.slider-container[_ngcontent-%COMP%]{text-align:center}.datetime-input[_ngcontent-%COMP%]{display:inline-block;margin:5px 25px}.date-input[_ngcontent-%COMP%]{width:120px;margin-right:25px}.time-input[_ngcontent-%COMP%]{display:inherit;margin-right:25px}.hour-input[_ngcontent-%COMP%], .minute-input[_ngcontent-%COMP%]{width:40px}.minute-input[_ngcontent-%COMP%]{margin-left:10px}"]}),e})(),Nf=(()=>{class e{static forRoot(){return{ngModule:e,providers:[{provide:$e.Ad,useValue:"fr-FR"}]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[Fd,Od,gm,kd],imports:[[h.ez,ze.u5,ze.UX,Ya.Bb,a.Ps,n.ot,sl.Nh,rl.Fk,f.Tx,qe.p0,nl.dp,Ha.vV,m.p9,za.KP,Qa.rP,Pe.lN,Qe.c,$e.Ng,_e.LD,l.ie,p.AV,il.FA,$e.XK,al.ni,al.IZ,oe,cd,qo,$i,Mi,Yh,Be.g]]}),e})();r.B6R(Xh,[h.O5,n.lW,p.gM,a.Hw,Be.k,yg,Ii],[U.X$]),r.B6R(yg,[h.O5,l.Tg,a.Hw,l.eA,Po,$e.X2,h.PC,n.lW,p.gM,h.mk,ap,pg],[U.X$,h.Ov]),r.B6R(bg,[_i,h.sg,yg,Ii],[Ld]),r.B6R(Qg,[m.oG,p.gM,Pe.KE,h.mk,_e.gD,$e.ey,h.O5,Qe.Nt,Ya.ZL,Ya.XC,h.sg,n.lW,Pe.R9,a.Hw,Ef],[U.X$,h.Ov,Oi]),r.B6R(dm,[h.O5,n.lW,p.gM,a.Hw,Be.k,nm,Ii],[U.X$]),r.B6R(Wm,[ze._Y,ze.JL,ze.sg,h.sg,h.O5,Ga.d,Pe.KE,_e.gD,ze.JJ,ze.u,p.gM,$e.ey,Ha.A9,Ha.Yi,h.PC,m.oG,rl.VQ,rl.U0,a.Hw,ze.oH,ze.On,Ef],[U.X$]),r.B6R(Vg,[h.O5,Wm,Ii,h.sg,Qg],[]),r.B6R(nm,[l.Tg,h.O5,a.Hw,l.eA,Po,$e.X2,h.PC,p.gM,n.lW,h.mk,ap,Vg,Ga.d,m.oG,ze.JJ,ze.On],[U.X$,h.Ov]),r.B6R(lm,[_i,h.sg,nm,Ii],[Ld]),r.B6R(Km,[sl.SP,sl.uX,Pe.KE,Pe.hX,_e.gD,h.sg,$e.ey,of,Ha.A9,Ha.Yi,p.gM,a.Hw],[U.X$]),r.B6R(xf,[Qh,ze.JJ,ze.oH,h.O5,Qa.Rr,ze._Y,ze.JL,ze.F,Pe.KE,ze.wV,Qe.Nt,ze.Fj,_e.gD,h.sg,$e.ey,Pe.hX,rl.VQ,rl.U0,qe.BZ,qe.w1,qe.fO,qe.ge,m.oG,qe.as,qe.XQ,qe.nj,qe.Gk,nl.gi,nl.fQ,nl.uo,nl.eu,n.lW,nl.GZ,a.Hw,nl.Ar],[h.Ov,U.X$]),r.B6R(Ef,[h.O5,Qa.Rr,ze.JJ,ze.On,Uf,Pe.KE,il.nW,Pe.R9,Qe.Nt,il.hl,il.Mq,Pe.hX,_e.gD,ze.oH,h.sg,$e.ey],[U.X$]);class Jf extends Error{}class Bf extends Jf{constructor(){super("Invalid file"),Object.setPrototypeOf(this,Bf.prototype)}}class jf extends Jf{constructor(){super("Nothing to export"),Object.setPrototypeOf(this,jf.prototype)}}const Gf=$(["URL","GeoJSON","GML","GPX","KML","Shapefile","CSVcomma","CSVsemicolon"]),Qf=$(["UTF8","LATIN1"]);let zf=(()=>{class e{constructor(e){this.config=e,this.aggregateInComment=!0,this.ogreUrl=this.config.getConfig("importExport.url");const t=this.config.getConfig("importExport.gpxAggregateInComment");void 0!==t&&(this.aggregateInComment=t)}export(e,t,o,i,r="EPSG:4326",s="EPSG:4326"){const n=this.generateFeature(e,t);return this.exportAsync(n,t,o,i,r,s)}generateFeature(e,t){return t===Gf.GPX&&this.aggregateInComment?this.generateAggregatedFeature(e):e.map(e=>{const t=e.getKeys().filter(e=>!e.startsWith("_")).reduce((t,o)=>(t[o]=e.get(o),t),{geometry:e.getGeometry()});return new Tn.Z(t)})}generateAggregatedFeature(e){return e.map(e=>{const t=e.getKeys().filter(e=>!e.startsWith("_"));let o="";const i=t.reduce((t,i)=>(i&&"geometry"!==i&&("id"===i&&e.get("draw")?o+=i+":"+e.get("draw")+"   \r\n":o+=i+":"+e.get(i)+"   \r\n"),t[i]=e.get(i),t),{geometry:e.getGeometry()}),r=new Tn.Z(i);return r.set("name",e.getId()),r.set("cmt",o),r})}exportAsync(t,o,i,r,s,n){return new Se.y(a=>{if(this.nothingToExport(t,o))a.error(new jf);else if(Object.keys(e.ogreFormats).indexOf(o)>=0){if(!this.ogreUrl)return void(e.noOgreFallbacks.indexOf(o)>=0?this.exportToFile(t,a,o,i,s,n):a.error(new Bf));this.exportWithOgre(t,a,o,i,r,s,n)}else this.exportToFile(t,a,o,i,s,n)})}exportToFile(e,t,o,i,r,s){(function(e,t,o){!function(e,t){const o=document.createElement("a");o.setAttribute("href",e),o.setAttribute("download",t),o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o)}(`data:${t},${encodeURIComponent(e)}`,o)})((new aa[o]).writeFeatures(e,{dataProjection:s,featureProjection:r,featureType:"feature",featureNS:"http://example.com/feature"}),"text/plain;charset=utf-8",`${i}.${o.toLowerCase()}`),t.complete()}exportWithOgre(t,o,i,r,s,n,a){const l=(new Yn.Z).writeFeatures(t,{dataProjection:a,featureProjection:n}),c=`${this.ogreUrl}/convertJson`,u=document.createElement("form");if(u.style.display="none",document.body.appendChild(u),u.setAttribute("method","post"),u.setAttribute("target","_blank"),u.setAttribute("action",c),s===Qf.UTF8)u.acceptCharset="UTF-8",u.enctype="application/x-www-form-urlencoded; charset=utf-8;";else if(s===Qf.LATIN1){const e="ISO-8859-1",t=document.createElement("input");t.setAttribute("type","hidden"),t.setAttribute("name","encoding"),t.setAttribute("value",e),u.appendChild(t)}if("CSVsemicolon"===i){const e=document.createElement("input");e.setAttribute("type","hidden"),e.setAttribute("name","lco"),e.setAttribute("value","SEPARATOR=SEMICOLON"),u.appendChild(e)}const p=document.createElement("input");p.setAttribute("type","hidden"),p.setAttribute("name","json"),p.setAttribute("value",l),u.appendChild(p);const d=document.createElement("input");let h="Shapefile"===i?`${r}.zip`:`${r}.${i.toLowerCase()}`;("CSVcomma"===i||"CSVsemicolon"===i)&&(h=`${r}.csv`),h=h.replace(" ","_"),h=h.normalize("NFD").replace(/[\u0300-\u036f]/g,""),d.setAttribute("type","hidden"),d.setAttribute("name","outputName"),d.setAttribute("value",h),u.appendChild(d);let g=e.ogreFormats[i];("CSVcomma"===i||"CSVsemicolon"===i)&&(g="CSV");const m=document.createElement("input");m.setAttribute("type","hidden"),m.setAttribute("name","format"),m.setAttribute("value",g),u.appendChild(m),u.submit(),document.body.removeChild(u),o.complete()}nothingToExport(e,t){return 0===e.length||"GPX"===t&&void 0===e.find(e=>["Point","LineString","MultiLineString"].indexOf(e.getGeometry().getType())>=0)}}return e.ogreFormats={GML:"gml",GPX:"gpx",KML:"kml",Shapefile:"ESRI Shapefile",CSVcomma:"CSVcomma",CSVsemicolon:"CSVsemicolon"},e.noOgreFallbacks=["GML","GPX","KML"],e.\u0275fac=function(t){return new(t||e)(r.LFG(z))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Yf(e,t,o,i,r,s,n){if(0===t.length)return void function(e,t,o){const i=o.translate,r=i.instant("igo.geo.dropGeoFile.empty.title"),s=i.instant("igo.geo.dropGeoFile.empty.text",{value:e.name,mimeType:e.type});t.error(s,r)}(e,i,r);const a=ty(e);s?function(e,t,o,i,r){const s=e.map(e=>Pc(e,t.projection));let n,a,l;if(i.getStyleList(o.toString()+".styleByAttribute")){const e=i.getStyleList(o.toString()+".styleByAttribute");n=t=>r.createStyleByAttribute(t,e)}else if(i.getStyleList(o.toString()+".clusterStyle")){const e=i.getStyleList(o.toString()+".clusterParam");a=i.getStyleList(o.toString()+".distance");const t=r.createStyle(i.getStyleList(o.toString()+".clusterStyle"));n=o=>r.createClusterStyle(o,e,t)}else if(i.getStyleList(o.toString()+".style"))n=r.createStyle(i.getStyleList(o.toString()+".style"));else if(i.getStyleList("default.clusterStyle")&&"Point"===e[0].geometry.type){const e=i.getStyleList("default.clusterParam");a=i.getStyleList("default.distance");const t=r.createStyle(i.getStyleList("default.clusterStyle"));n=o=>r.createClusterStyle(o,e,t)}else n=r.createStyle(i.getStyleList("default.style"));i.getStyleList(o.toString()+".clusterStyle")?(l=new oc({distance:a,type:"cluster",queryable:!0}),l.ol.source.addFeatures(s)):i.getStyleList(o.toString())?(l=new tc({type:"vector",queryable:!0}),l.ol.addFeatures(s)):i.getStyleList("default.clusterStyle")&&"Point"===e[0].geometry.type?(l=new oc({distance:a,type:"cluster",queryable:!0}),l.ol.source.addFeatures(s)):(l=new tc({type:"vector",queryable:!0}),l.ol.addFeatures(s));const c=new uc({title:o,source:l,style:n});t.addLayer(c),qc(t,s)}(t,o,a,s,n):function(e,t,o){const i=e.map(e=>Pc(e,t.projection)),r=Math.floor(255*Math.random()),s=Math.floor(255*Math.random()),n=Math.floor(255*Math.random()),a=new Nn.Z({color:[r,s,n,1],width:2}),l=new Rn.Z({color:[r,s,n,.4]}),c=new tc({type:"vector",queryable:!0});c.ol.addFeatures(i);const u=new uc({title:o,source:c,style:new Dn.ZP({stroke:a,fill:l,image:new Jn.Z({radius:5,stroke:a,fill:l})})});t.addLayer(u),qc(t,i)}(t,o,a);const l=r.translate,c=l.instant("igo.geo.dropGeoFile.success.title"),u=l.instant("igo.geo.dropGeoFile.success.text",{value:a});i.success(u,c)}function Hf(e,t,o,i){const r=i.translate,s=r.instant("igo.geo.dropGeoFile.invalid.title"),n=r.instant("igo.geo.dropGeoFile.invalid.text",{value:e.name,mimeType:e.type});o.error(n,s)}function Vf(e,t,o,i){const r=i.translate,s=r.instant("igo.geo.dropGeoFile.unreadable.title"),n=r.instant("igo.geo.dropGeoFile.unreadable.text",{value:e.name});o.error(n,s)}function Wf(e,t,o,i,r){const s=i.translate,n=s.instant("igo.geo.dropGeoFile.tooLarge.title"),a=s.instant("igo.geo.dropGeoFile.tooLarge.text",{value:e.name,size:r});o.error(a,n)}function Xf(e,t,o){const i=o.translate,r=i.instant("igo.geo.dropGeoFile.invalidSRS.title"),s=i.instant("igo.geo.dropGeoFile.invalidSRS.text",{value:e.name,mimeType:e.type});t.error(s,r)}function Kf(e,t,o,i){const r=i.translate.instant("igo.geo.dropGeoFile.ogreServer.title"),s=i.translate.instant("igo.geo.dropGeoFile.ogreServer.text");o.error(s,r)}function ey(e){return e.name.split(".").pop().toLowerCase()}function ty(e){return e.name.substr(0,e.name.lastIndexOf("."))}class oy extends Error{}class iy extends oy{constructor(){super("Invalid file"),Object.setPrototypeOf(this,iy.prototype)}}class ry extends oy{constructor(){super("Failed to read file"),Object.setPrototypeOf(this,ry.prototype)}}class sy extends oy{constructor(){super("Nothing to import"),Object.setPrototypeOf(this,sy.prototype)}}class ny extends oy{constructor(){super("File is too large"),Object.setPrototypeOf(this,sy.prototype)}}class ay extends oy{constructor(){super("Invalid SRS definition"),Object.setPrototypeOf(this,sy.prototype)}}class ly extends oy{constructor(){super("Error 500 with OGRE"),Object.setPrototypeOf(this,ly.prototype)}}let cy=(()=>{class e{constructor(e,t){this.http=e,this.config=t,this.ogreUrl=this.config.getConfig("importExport.url");const o=this.config.getConfig("importExport.clientSideFileSizeMaxMb");this.clientSideFileSizeMax=(o||30)*Math.pow(1024,2)}import(e,t="EPSG:4326",o="EPSG:4326"){return this.importAsync(e,t,o)}getFileImporter(t){const o=ey(t),i=t.type,r=[...e.allowedMimeTypes,...e.allowedZipMimeTypes],s=e.allowedExtensions;if(!(r.indexOf(i)<0&&s.indexOf(o)<0)){if("application/json"===i||["json","geojson","kml","gpx"].indexOf(o)>=0)return this.importFile;if(void 0!==this.ogreUrl)return this.importFileWithOgre}}importAsync(e,t,o){return new Se.y(i=>{if(e.size>=this.clientSideFileSizeMax)return void i.error(new ny);const r=this.getFileImporter(e);void 0!==r?r.call(this,e,i,t,o):i.error(new iy)})}importFile(e,t,o,i){const r=new FileReader;r.onload=r=>{try{const s=this.parseFeaturesFromFile(e,r.target.result,o,i);t.next(s)}catch(s){t.error(new ry)}t.complete()},r.onerror=e=>{t.error(new ry)},r.readAsText(e,"UTF-8")}importFileWithOgre(e,t,o,i){const r=`${this.ogreUrl}/convert`,s=new FormData;s.append("upload",e),s.append("sourceSrs",o),s.append("targetSrs",i),s.append("formatOutput","GEOJSON"),s.append("skipFailures",""),this.http.post(r,s,{headers:new y.WM}).subscribe(o=>{if(null!==o)if((o.errors||[]).length>0)t.error(new ry);else{const r=this.parseFeaturesFromGeoJSON(e,o,i);t.next(r),t.complete()}else t.error(new ry)},e=>{e.error.caught=!0;const o=e.error.msg||"";"No valid files found"===o?t.error(new iy):o&&o.startWith("ERROR 1: Failed to process SRS definition")?t.error(new ay):t.error(500===e.status?new ly:new ry)})}parseFeaturesFromFile(e,t,o,i){const r=ey(e),s=e.type,n=new Yn.Z;let a;if("application/vnd.google-earth.kml+xml"===s)a=new pa.ZP;else if("application/gml+xml"===s)a=new ha.Z;else if("application/gpx+xml"===s)a=new ua.Z;else switch(r){case"kml":a=new pa.ZP;break;case"gpx":a=new ua.Z;break;case"gml":a=new ha.Z;break;default:a=n}return a.readFeatures(t,{dataProjection:o,featureProjection:i}).map(t=>Object.assign(n.writeFeatureObject(t),{projection:i,meta:{id:D(),title:ty(e)}}))}parseFeaturesFromGeoJSON(e,t,o){const i=new Yn.Z;return i.readFeatures(t).map(t=>Object.assign(i.writeFeatureObject(t),{projection:o,meta:{id:D(),title:ty(e)}}))}}return e.allowedMimeTypes=["application/gml+xml","application/vnd.google-earth.kml+xml","application/gpx+xml","application/json"],e.allowedZipMimeTypes=["application/zip","application/x-zip-compressed","application/x-zip"],e.allowedExtensions=["geojson","kml","gpx","json","gml"],e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(z))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),uy=(()=>{class e{constructor(e){this.injector=e,this.styleList={}}getStyleList(e){return _.resolve(this.styleList,e)}load(e){const t=e.default||{};if(!e.path)return this.styleList=t,!0;const o=this.injector.get(y.eN);return new Promise((i,r)=>{o.get(e.path).pipe((0,b.K)(t=>(console.log(`StyleList file ${e.path} could not be read`),i(!0),(0,T._)(t.error||"Server error")))).subscribe(e=>{this.styleList=_.mergeDeep(t,e),i(!0)})})}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(r.zs3))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function py(e,t){if(1&e&&(r.TgZ(0,"p",16),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=r.oxw().$implicit;r.xp6(1),r.Oqu(r.xi3(2,1,"igo.geo.importExportForm.projections."+e.translateKey,e))}}function dy(e,t){if(1&e&&(r.TgZ(0,"p",16),r._uU(1),r.qZA()),2&e){const e=r.oxw().$implicit;r.xp6(1),r.Oqu(e.alias)}}function hy(e,t){if(1&e&&(r.TgZ(0,"mat-option",14),r.NdJ("click",function(e){return e.stopPropagation()}),r.YNc(1,py,3,4,"p",15),r.YNc(2,dy,2,1,"p",15),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.Q6J("ngIf",e.translateKey),r.xp6(1),r.Q6J("ngIf",!e.translateKey)}}function gy(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"form",5),r.TgZ(1,"div",6),r.TgZ(2,"mat-form-field"),r.TgZ(3,"mat-label"),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.TgZ(6,"mat-select",7),r.NdJ("valueChange",function(t){return r.CHM(e),r.oxw().inputProj=t}),r.YNc(7,hy,3,3,"mat-option",8),r.ALo(8,"async"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(9,"div",9),r.ALo(10,"translate"),r.ALo(11,"translate"),r.TgZ(12,"button",10),r.NdJ("click",function(){return r.CHM(e),r.MAs(19).click()}),r.ALo(13,"async"),r._uU(14),r.ALo(15,"translate"),r.qZA(),r._UZ(16,"igo-spinner",11),r.ALo(17,"async"),r.TgZ(18,"input",12,13),r.NdJ("click",function(){return r.CHM(e),r.MAs(19).value=null})("change",function(t){return r.CHM(e),r.oxw().importFiles(t.target.files)}),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("formGroup",e.importForm),r.xp6(4),r.Oqu(r.lcZ(5,10,"igo.geo.importExportForm.importProjPlaceholder")),r.xp6(2),r.Q6J("value",e.inputProj),r.xp6(1),r.Q6J("ngForOf",r.lcZ(8,12,e.projections$)),r.xp6(2),r.Q6J("matTooltip",e.importForm.invalid?r.lcZ(10,14,"igo.geo.importExportForm.projections.choose"):r.lcZ(11,16,"igo.geo.importExportForm.importButton")),r.xp6(3),r.Q6J("disabled",e.importForm.invalid||r.lcZ(13,18,e.loading$)),r.xp6(2),r.hij(" ",r.lcZ(15,20,"igo.geo.importExportForm.importButton")," "),r.xp6(2),r.Q6J("shown",r.lcZ(17,22,e.loading$)),r.xp6(2),r.Udp("display","none")}}const my=function(e){return{size:e}};function fy(e,t){if(1&e&&(r.TgZ(0,"section",17),r.TgZ(1,"h4"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"ul"),r.TgZ(5,"li"),r._uU(6),r.ALo(7,"translate"),r.qZA(),r.TgZ(8,"li"),r._uU(9),r.ALo(10,"translate"),r.qZA(),r.TgZ(11,"li"),r._uU(12),r.ALo(13,"translate"),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(2),r.Oqu(r.lcZ(3,4,"igo.geo.importExportForm.importClarifications")),r.xp6(4),r.Oqu(r.xi3(7,6,"igo.geo.importExportForm.importSizeMax",r.VKq(13,my,e.fileSizeMb))),r.xp6(3),r.Oqu(r.lcZ(10,9,"igo.geo.importExportForm.importFormatAuthorized")),r.xp6(3),r.Oqu(r.lcZ(13,11,"igo.geo.importExportForm.importShpZip"))}}function yy(e,t){1&e&&(r.TgZ(0,"section",17),r.TgZ(1,"h4"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.qZA()),2&e&&(r.xp6(2),r.Oqu(r.lcZ(3,1,"igo.geo.importExportForm.exportNoLayersExportable")))}function vy(e,t){if(1&e&&(r.TgZ(0,"span",27),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.AsE(" (+",e.layers.length-1," ",r.lcZ(2,2,2===(null==e.layers?null:e.layers.length)?"igo.geo.importExportForm.other":"igo.geo.importExportForm.others"),") ")}}function by(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-slide-toggle",30),r.NdJ("click",function(t){r.CHM(e);const o=r.oxw().$implicit;return r.oxw(2).onlySelectedClick(t,o.id)})("checked",function(){r.CHM(e);const t=r.oxw().$implicit;return r.oxw(2).inLayersIdToExportSelectionOnly(t)})("change",function(t){r.CHM(e);const o=r.oxw().$implicit;return r.oxw(2).onlySelected(t,o.id)}),r.TgZ(1,"small"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.qZA()}2&e&&(r.Q6J("labelPosition","after"),r.xp6(2),r.Oqu(r.lcZ(3,2,"igo.geo.importExportForm.exportSelectedFeature")))}const xy=function(e){return{"igo-export-layer-mat-option":e}};function wy(e,t){if(1&e&&(r.TgZ(0,"mat-option",28),r.NdJ("click",function(e){return e.stopPropagation()}),r.TgZ(1,"p",16),r._uU(2),r.qZA(),r.TgZ(3,"p",16),r.YNc(4,by,4,4,"mat-slide-toggle",29),r.qZA(),r.qZA()),2&e){const e=t.$implicit,o=r.oxw(2);r.Q6J("ngClass",r.VKq(4,xy,o.layerHasSelectedFeatures(e)))("value",e.id),r.xp6(2),r.Oqu(e.title),r.xp6(2),r.Q6J("ngIf",o.layerHasSelectedFeatures(e))}}function Sy(e,t){if(1&e&&(r.TgZ(0,"mat-option",2),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.key),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.export.format."+e.value)," ")}}function Cy(e,t){if(1&e&&(r.ynx(0),r.YNc(1,Sy,3,4,"mat-option",31),r.ALo(2,"keyvalue"),r.ALo(3,"async"),r.BQk()),2&e){const e=r.oxw(2);r.xp6(1),r.Q6J("ngForOf",r.lcZ(2,1,r.lcZ(3,3,e.formats$)))}}function Ty(e,t){1&e&&(r.TgZ(0,"mat-option",32),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"igo.geo.export.noFormat.title")," "))}function Ay(e,t){1&e&&(r.TgZ(0,"div",6),r.TgZ(1,"mat-form-field"),r._UZ(2,"input",33),r.ALo(3,"translate"),r.qZA(),r.qZA()),2&e&&(r.xp6(2),r.s9C("placeholder",r.lcZ(3,1,"igo.geo.importExportForm.exportFileNamePlaceholder")))}function Zy(e,t){if(1&e&&(r.TgZ(0,"mat-option",2),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.key),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.export.encoding."+e.value)," ")}}function Ly(e,t){if(1&e&&(r.ynx(0),r.YNc(1,Zy,3,4,"mat-option",31),r.ALo(2,"keyvalue"),r.ALo(3,"async"),r.BQk()),2&e){const e=r.oxw(3);r.xp6(1),r.Q6J("ngForOf",r.lcZ(2,1,r.lcZ(3,3,e.encodings$)))}}function Fy(e,t){if(1&e&&(r.TgZ(0,"div",6),r.TgZ(1,"mat-form-field"),r.TgZ(2,"mat-label"),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.TgZ(5,"mat-select",34),r.YNc(6,Ly,4,5,"ng-container",22),r.ALo(7,"async"),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.oxw(2);r.xp6(3),r.Oqu(r.lcZ(4,2,"igo.geo.importExportForm.encodingPlaceholder")),r.xp6(3),r.Q6J("ngIf",0!==r.lcZ(7,4,e.encodings$).length)}}function Oy(e,t){1&e&&(r.TgZ(0,"div",35),r.TgZ(1,"mat-slide-toggle",36),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.qZA()),2&e&&(r.xp6(1),r.Q6J("labelPosition","before"),r.xp6(1),r.hij(" ",r.lcZ(3,2,"igo.geo.importExportForm.exportFeatureInExtent")," "))}function My(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"form",5),r.TgZ(1,"div",6),r.TgZ(2,"mat-form-field"),r.TgZ(3,"mat-label"),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.TgZ(6,"mat-select",18),r.NdJ("valueChange",function(t){return r.CHM(e),r.oxw().layers=t}),r.TgZ(7,"mat-select-trigger"),r._uU(8),r.YNc(9,vy,3,4,"span",19),r.qZA(),r.YNc(10,wy,5,6,"mat-option",20),r.ALo(11,"async"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(12,"div",6),r.TgZ(13,"mat-form-field"),r.TgZ(14,"mat-label"),r._uU(15),r.ALo(16,"translate"),r.qZA(),r.TgZ(17,"mat-select",21),r.YNc(18,Cy,4,5,"ng-container",22),r.ALo(19,"async"),r.YNc(20,Ty,3,3,"mat-option",23),r.ALo(21,"async"),r.qZA(),r.qZA(),r.qZA(),r.YNc(22,Ay,4,3,"div",24),r.YNc(23,Fy,8,6,"div",24),r.YNc(24,Oy,4,4,"div",25),r.TgZ(25,"div",26),r.TgZ(26,"button",10),r.NdJ("click",function(){r.CHM(e);const t=r.oxw();return t.handleExportFormSubmit(t.form.value)}),r.ALo(27,"async"),r._uU(28),r.ALo(29,"translate"),r.ALo(30,"translate"),r.ALo(31,"translate"),r.qZA(),r._UZ(32,"igo-spinner",11),r.ALo(33,"async"),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("formGroup",e.form),r.xp6(4),r.Oqu(r.lcZ(5,15,"igo.geo.importExportForm.exportLayerPlaceholder")),r.xp6(2),r.Q6J("value",e.layers),r.xp6(2),r.hij(" ",e.layers.length?e.getLayerTitleById(e.layers[0]):""," "),r.xp6(1),r.Q6J("ngIf",e.layers.length>1),r.xp6(1),r.Q6J("ngForOf",r.lcZ(11,17,e.exportableLayers$)),r.xp6(5),r.Oqu(r.lcZ(16,19,"igo.geo.importExportForm.exportFormatPlaceholder")),r.xp6(3),r.Q6J("ngIf",0!==r.lcZ(19,21,e.formats$).length),r.xp6(2),r.Q6J("ngIf",0===r.lcZ(21,23,e.formats$).length),r.xp6(2),r.Q6J("ngIf",e.forceNaming&&"URL"!==e.form.value.format),r.xp6(1),r.Q6J("ngIf","CSVcomma"===e.form.value.format||"CSVsemicolon"===e.form.value.format),r.xp6(1),r.Q6J("ngIf","URL"!==e.form.value.format),r.xp6(2),r.Q6J("disabled",!e.form.valid||r.lcZ(27,25,e.loading$)),r.xp6(2),r.hij(" ","URL"!==e.form.value.format?r.lcZ(29,27,"igo.geo.importExportForm.exportButton"):e.form.value.layers.length>1?r.lcZ(30,29,"igo.geo.importExportForm.exportButtonLinks"):r.lcZ(31,31,"igo.geo.importExportForm.exportButtonLink")," "),r.xp6(4),r.Q6J("shown",r.lcZ(33,33,e.loading$))}}let Iy=(()=>{class e{constructor(e,t,o,i,s,n,a,l,c,u,p){this.importService=e,this.exportService=t,this.languageService=o,this.messageService=i,this.styleListService=s,this.styleService=n,this.formBuilder=a,this.config=l,this.cdRef=c,this.storageService=u,this.downloadService=p,this.formats$=new C.X(void 0),this.encodings$=new C.X(void 0),this.exportableLayers$=new C.X([]),this.loading$=new C.X(!1),this.forceNaming=!1,this.controlFormat="format",this.espgCodeRegex=new RegExp("^\\d{4,6}"),this.projections$=new C.X([]),this.popupChecked=!1,this.previousLayerSpecs$=new C.X(void 0),this.selectFirstProj=!1,this._projectionsLimitations={},this.selectedMode="import",this.selectMode=new r.vpe,this.exportOptions$=new C.X(void 0),this.exportOptionsChange=new r.vpe,this.loadConfig(),this.buildForm(),this.computeProjections()}set projectionsLimitations(e){this._projectionsLimitations=e,this.computeProjections()}get projectionsLimitations(){return this._projectionsLimitations||{}}get layers(){return this.form.get("layers").value}set layers(e){this.form.patchValue({layers:e})}get inputProj(){return this.importForm.get("inputProj").value}set inputProj(e){this.importForm.patchValue({inputProj:e})}get popupAllowed(){return this.storageService.get("importExportPopupAllowed")||!1}set popupAllowed(e){this.storageService.set("importExportPopupAllowed",e)}ngOnInit(){this.layers$$=this.map.layers$.subscribe(e=>{this.exportableLayers$.next(e.filter(e=>e instanceof uc&&!0===e.exportable||e.dataSource.options.download&&e.dataSource.options.download.url))});const e=this.config.getConfig("importExport.clientSideFileSizeMaxMb");this.clientSideFileSizeMax=(e||30)*Math.pow(1024,2),this.fileSizeMb=this.clientSideFileSizeMax/Math.pow(1024,2),this.exportOptions$$=this.exportOptions$.pipe((0,xn.n)(e=>!e)).subscribe(e=>{this.form.patchValue(e,{emitEvent:!0}),e.layers&&this.computeFormats(e.layers.map(e=>this.map.getLayerById(e)))}),this.formLayer$$=this.form.get("format").valueChanges.subscribe(e=>{var t;const o=Object.keys(zf.ogreFormats);!this.popupChecked&&(null===(t=this.form.get("layers").value)||void 0===t?void 0:t.length)>1&&(o.indexOf(e)>=0||e===Gf.URL)&&(this.handlePopup(!0)||this.form.patchValue({format:void 0},{emitEvent:!1}))}),this.formLayer$$=this.form.get("layers").valueChanges.subscribe(e=>{this.handlePreviousLayerSpecs();const t=e instanceof Array?e:[e];this.form.patchValue({layers:t},{emitEvent:!1});const o=t.map(e=>this.map.getLayerById(e));this.computeFormats(o),-1===Object.keys(this.formats$.value).indexOf(this.form.value.format)&&this.form.patchValue({format:void 0}),this.loading$.next(!0);const i=[];o.forEach(e=>{e instanceof uc&&0===e.dataSource.ol.getFeatures().length&&(i.push({id:e.id,visible:e.visible,opacity:e.opacity,queryable:e.queryable}),e.opacity=0,e.visible=!0)}),this.previousLayerSpecs$.next(i),setTimeout(()=>{this.loading$.next(!1)},500)}),this.formats$$=this.formats$.pipe((0,xn.n)(e=>!e)).subscribe(e=>{1===Object.keys(e).length&&this.form.patchValue({format:e[Object.keys(e)[0]]})}),this.encodings$$=this.encodings$.pipe((0,xn.n)(e=>!e)).subscribe(e=>{1===Object.keys(e).length&&this.form.patchValue({encoding:e[Object.keys(e)[0]]})}),this.exportableLayers$$=this.exportableLayers$.pipe((0,xn.n)(e=>!e)).subscribe(e=>{1===e.length&&this.form.patchValue({layers:e[0].id})}),this.form.controls[this.controlFormat].valueChanges.subscribe(e=>{this.form.patchValue(e===Gf.CSVcomma||e===Gf.CSVsemicolon?{encoding:Qf.LATIN1}:{encoding:Qf.UTF8}),this.cdRef.detectChanges()}),this.importForm.patchValue(this.selectFirstProj?0===this.projections$.value.length?{inputProj:{translateKey:"nad83",alias:"NAD83",code:"EPSG:4326",zone:""}}:{inputProj:this.projections$.value[0]}:{inputProj:void 0})}computeProjections(){this.projectionsConstraints=function(e){const t=e.mtmZone,o=e.utmZone;return{projFromConfig:!1!==e.projFromConfig,nad83:!1!==e.nad83,wgs84:!1!==e.wgs84,webMercator:!1!==e.webMercator,utm:!1!==e.utm,mtm:!1!==e.mtm,utmZone:{minZone:o&&o.minZone?o.minZone:17,maxZone:o&&o.maxZone?o.maxZone:21},mtmZone:{minZone:t&&t.minZone?t.minZone:2,maxZone:t&&t.maxZone?t.maxZone:10}}}(this.projectionsLimitations);const e=[];if(this.projectionsConstraints.nad83&&e.push({translateKey:"nad83",alias:"NAD83",code:"EPSG:4269",zone:""}),this.projectionsConstraints.wgs84&&e.push({translateKey:"wgs84",alias:"WGS84",code:"EPSG:4326",zone:""}),this.projectionsConstraints.webMercator&&e.push({translateKey:"webMercator",alias:"Web Mercator",code:"EPSG:3857",zone:""}),this.projectionsConstraints.mtm){const t=this.projectionsConstraints.mtmZone.maxZone;for(let o=this.projectionsConstraints.mtmZone.minZone;o<=t;o++)e.push({translateKey:"mtm",alias:`MTM ${o}`,code:o<10?`EPSG:3218${o}`:`EPSG:321${80+o}`,zone:`${o}`})}if(this.projectionsConstraints.utm){const t=this.projectionsConstraints.utmZone.maxZone;for(let o=this.projectionsConstraints.utmZone.minZone;o<=t;o++)e.push({translateKey:"utm",alias:`UTM ${o}`,code:o<10?`EPSG:3260${o}`:`EPSG:326${o}`,zone:`${o}`})}let t=[];this.projectionsConstraints.projFromConfig&&(t=this.config.getConfig("projections")||[]),this.projections$.next(t.concat(e))}getWorkspaceByLayerId(e){const t=this.store.all().find(t=>t.layer.id===e);if(t)return t}getLayerTitleById(e){return this.map.getLayerById(e).title}layerHasSelectedFeatures(e){const t=this.getWorkspaceByLayerId(e.id);if(t)return!!t.entityStore.stateView.firstBy(e=>!0===e.state.selected)}onlySelected(e,t){let o=this.form.value.layersWithSelection;e.checked?o.push(t):o=o.filter(e=>e!==t),this.form.patchValue({layersWithSelection:o})}onlySelectedClick(e,t){this.form.value.layers.find(e=>e===t)&&e.stopPropagation()}inLayersIdToExportSelectionOnly(e){return!!this.form.value.layersWithSelection.find(t=>t===e.id)}ngOnDestroy(){this.layers$$.unsubscribe(),this.exportableLayers$$.unsubscribe(),this.formats$$.unsubscribe(),this.encodings$$.unsubscribe(),this.formLayer$$.unsubscribe(),this.exportOptions$$&&this.exportOptions$$.unsubscribe(),this.exportOptionsChange.emit(this.form.value),this.handlePreviousLayerSpecs()}handlePreviousLayerSpecs(){const e=this.previousLayerSpecs$.value;e&&e.length&&e.forEach(e=>{const t=this.map.getLayerById(e.id);t.visible=e.visible,t.opacity=e.opacity,t.queryable=e.queryable}),this.previousLayerSpecs$.next(void 0)}importFiles(e){let t=this.inputProj.code;this.espgCodeRegex.test(t)&&(t=`EPSG:${t}`),this.loading$.next(!0);for(const o of e)this.importService.import(o,t).subscribe(e=>this.onFileImportSuccess(o,e),e=>this.onFileImportError(o,e),()=>{this.loading$.next(!1)})}handlePopup(e=!0){window.open("","popup","width=1, height=1").close();const t=window.open("","popup","width=1, height=1");return!t||t.closed||void 0===t.closed||null===t?(this.onPopupBlockedError(e),this.popupAllowed=!1):(t.close(),this.popupAllowed=!0,this.popupChecked=!0),this.popupAllowed}handleExportFormSubmit(e){this.loading$.next(!0);const t=Object.keys(zf.ogreFormats);!this.popupChecked&&e.layers.length>1&&(t.indexOf(e.format)>=0||e.format===Gf.URL)&&!this.popupAllowed&&this.handlePopup(),e.layers.forEach(t=>{const o=this.map.getLayerById(t);let i=o.title;void 0!==e.name&&(i=e.name);const r=o.dataSource.options;if(e.format===Gf.URL&&r.download&&(r.download.url||r.download.dynamicUrl))return void setTimeout(()=>{const e=r.download.url||r.download.dynamicUrl;e.match(/service=wfs/gi)?this.downloadService.open(o):window.open(e,"_blank"),this.loading$.next(!1)},500);const s=this.getWorkspaceByLayerId(t);let n;if(s&&s.entityStore&&s.entityStore.stateView.all().length)n=-1!==e.layersWithSelection.indexOf(t)&&e.featureInMapExtent?s.entityStore.stateView.all().filter(e=>e.state.inMapExtent&&e.state.selected).map(e=>e.entity.ol):-1===e.layersWithSelection.indexOf(t)||e.featureInMapExtent?e.featureInMapExtent?s.entityStore.stateView.all().filter(e=>e.state.inMapExtent).map(e=>e.entity.ol):s.entityStore.stateView.all().map(e=>e.entity.ol):s.entityStore.stateView.all().filter(e=>e.state.selected).map(e=>e.entity.ol);else{const t=o.dataSource.ol;n=e.featureInMapExtent?t.getFeaturesInExtent(o.map.viewController.getExtent()):t.getFeatures(),o.dataSource instanceof oc&&(n=n.flatMap(e=>e.get("features")))}const a=this.languageService.translate;let l=[];if(e.format===Gf.Shapefile||e.format===Gf.GPX?n.forEach(e=>{const t=e.getGeometry().getType(),o=l.find(e=>e.geometryType===t);o?o.features.push(e):l.push({geometryType:t,features:[e]})}):l=[{geometryType:"",features:n}],l.forEach(e=>{e.features.forEach(e=>{const t=e.get("rad");if(t){const o=[e.get("longitude"),e.get("latitude")],i=(0,Gn.iu)(o,t,500);i.transform("EPSG:4326",e.get("_projection")),e.setGeometry(i)}})}),e.format===Gf.GPX){const e=l.length;if(l=l.filter(e=>["LineString","Point"].includes(e.geometryType)),e>l.length){const e=a.instant("igo.geo.export.gpx.error.poly.title"),t=a.instant("igo.geo.export.gpx.error.poly.text");this.messageService.error(t,e,{timeOut:2e4})}}if(0===l.length){this.loading$.next(!1);const e=a.instant("igo.geo.export.nothing.title"),t=a.instant("igo.geo.export.nothing.text");this.messageService.error(t,e,{timeOut:2e4})}else l.map(t=>this.exportService.export(t.features,e.format,i+t.geometryType,e.encoding,this.map.projection).subscribe(()=>{},e=>this.onFileExportError(e),()=>{this.onFileExportSuccess(),t.features.forEach(e=>{if(e.get("rad")){const t=new Qn.Z([e.get("longitude"),e.get("latitude")]);t.transform("EPSG:4326",e.get("_projection")),e.setGeometry(t)}}),this.loading$.next(!1)}))})}buildForm(){this.importForm=this.formBuilder.group({inputProj:["",[ze.kI.required]]}),this.form=this.formBuilder.group(this.forceNaming?{format:["",[ze.kI.required]],layers:[[],[ze.kI.required]],layersWithSelection:[[]],encoding:[Qf.UTF8,[ze.kI.required]],featureInMapExtent:[!1,[ze.kI.required]],name:["",[ze.kI.required]]}:{format:["",[ze.kI.required]],layers:[[],[ze.kI.required]],layersWithSelection:[[]],encoding:[Qf.UTF8,[ze.kI.required]],featureInMapExtent:[!1,[ze.kI.required]]})}onFileImportSuccess(e,t){this.config.getConfig("importWithStyle")?Yf(e,t,this.map,this.messageService,this.languageService,this.styleListService,this.styleService):Yf(e,t,this.map,this.messageService,this.languageService)}onFileImportError(e,t){this.loading$.next(!1),function(e,t,o,i,r){({"Invalid file":Hf,"File is too large":Wf,"Failed to read file":Vf,"Invalid SRS definition":Xf,"Error 500 with OGRE":Kf})[t.message](e,t,o,i,r=r||30)}(e,t,this.messageService,this.languageService,this.fileSizeMb)}onPopupBlockedError(e=!0){this.loading$.next(!1);const t=this.languageService.translate,o=t.instant("igo.geo.export.popupBlocked.title"),i=t.instant(e?"igo.geo.export.popupBlocked.selectAgain":"igo.geo.export.popupBlocked.retry"),r=t.instant("igo.geo.export.popupBlocked.text",{extraMessage:i});this.messageService.error(r,o,{timeOut:2e4})}onFileExportError(e){this.loading$.next(!1),function(e,t,o){if(e instanceof jf)return void function(e,t){const o=t.translate,i=o.instant("igo.geo.export.nothing.title"),r=o.instant("igo.geo.export.nothing.text");e.error(r,i)}(t,o);const i=o.translate,r=i.instant("igo.geo.export.failed.title"),s=i.instant("igo.geo.export.failed.text");t.error(s,r)}(e,this.messageService,this.languageService)}loadConfig(){void 0!==this.config.getConfig("importExport.forceNaming")&&(this.forceNaming=this.config.getConfig("importExport.forceNaming")),this.computeFormats(),this.loadEncodings()}encodingDefaultValue(e){return e===Gf.CSVcomma||e===Gf.CSVsemicolon?(this.form.patchValue({encoding:Qf.LATIN1}),Qf.LATIN1):(this.form.patchValue({encoding:Qf.UTF8}),Qf.UTF8)}loadEncodings(){this.encodings$.next(Qf)}computeFormats(e){let t=Object.keys(Gf);const o={onlyUrl:!1,onlyVector:!1,vectorAndUrl:!1,customList:!1},i=[];if(e&&e.length)if(e.forEach(e=>{var t;!e||((null===(t=e.dataSource.options.download)||void 0===t?void 0:t.allowedFormats)?(o.customList=!0,i.push({layer:e.title,formats:this.validateListFormat(e.dataSource.options.download.allowedFormats)})):e instanceof uc||!e.dataSource.options.download||!e.dataSource.options.download.url?e.dataSource.options.download&&(e.dataSource.options.download.url||e.dataSource.options.download.dynamicUrl)?o.vectorAndUrl=!0:e instanceof uc&&(o.onlyVector=!0):o.onlyUrl=!0)}),!0===o.onlyUrl&&!1===o.onlyVector)t=["URL"];else if(!0===o.onlyVector&&!1===o.onlyUrl)this.computeFormats(),Gf.URL in this.formats$.value&&(t=Object.keys(this.formats$.value).filter(e=>"URL"!==e));else if(!0===o.vectorAndUrl&&!1===o.onlyUrl&&!1===o.onlyVector&&(this.computeFormats(),!(Gf.URL in this.formats$.value))){const e=Object.keys(this.formats$.value);e.push("URL"),t=e}if(void 0!==this.config.getConfig("importExport.formats")&&(t=this.validateListFormat(this.config.getConfig("importExport.formats"))),o.customList){let o;const r=[];let s=i[0].formats;i.map(e=>{r.push(e.layer),o=e.formats.filter(e=>s.includes(e)),s=e.formats});const n=o.filter(e=>t.includes(e));n.length>0?(this.formats$.next($(n)),e&&e.length&&e.length>1&&this.messageService.alert(this.languageService.translate.instant("igo.geo.export.customList.text",{value:r.join()}),this.languageService.translate.instant("igo.geo.export.customList.title"))):(this.formats$.next([]),this.messageService.alert(this.languageService.translate.instant("igo.geo.export.noFormat.text"),this.languageService.translate.instant("igo.geo.export.noFormat.title")))}else this.formats$.next($(t))}validateListFormat(e){return e.filter(e=>{if(e.toUpperCase()===Gf.CSVcomma.toUpperCase()||e.toUpperCase()===Gf.CSVsemicolon.toUpperCase()||e.toUpperCase()===Gf.GML.toUpperCase()||e.toUpperCase()===Gf.GPX.toUpperCase()||e.toUpperCase()===Gf.GeoJSON.toUpperCase()||e.toUpperCase()===Gf.KML.toUpperCase()||e.toUpperCase()===Gf.Shapefile.toUpperCase()||e.toUpperCase()===Gf.URL.toUpperCase())return e}).map(e=>e.toUpperCase()===Gf.CSVcomma.toUpperCase()?e=Gf.CSVcomma:e.toUpperCase()===Gf.CSVsemicolon.toUpperCase()?e=Gf.CSVsemicolon:e.toUpperCase()===Gf.GML.toUpperCase()?e=Gf.GML:e.toUpperCase()===Gf.GPX.toUpperCase()?e=Gf.GPX:e.toUpperCase()===Gf.GeoJSON.toUpperCase()?e=Gf.GeoJSON:e.toUpperCase()===Gf.KML.toUpperCase()?e=Gf.KML:e.toUpperCase()===Gf.Shapefile.toUpperCase()?e=Gf.Shapefile:e.toUpperCase()===Gf.URL.toUpperCase()?e=Gf.URL:void 0)}modeChanged(e){this.selectMode.emit(e)}onFileExportSuccess(){!function(e,t){const o=t.translate,i=o.instant("igo.geo.export.success.title"),r=o.instant("igo.geo.export.success.text");e.success(r,i)}(this.messageService,this.languageService)}onImportExportChange(e){this.selectedMode=e.value}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(cy),r.Y36(zf),r.Y36(ne),r.Y36(le),r.Y36(uy),r.Y36(Yc),r.Y36(ze.qu),r.Y36(z),r.Y36(r.sBO),r.Y36(ve),r.Y36(Pd))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-import-export"]],inputs:{selectFirstProj:"selectFirstProj",map:"map",projectionsLimitations:"projectionsLimitations",store:"store",selectedMode:"selectedMode",exportOptions$:"exportOptions$"},outputs:{selectMode:"selectMode",exportOptionsChange:"exportOptionsChange"},decls:14,vars:17,consts:[[1,"import-export-toggle","mat-typography"],[3,"value","change"],[3,"value"],["class","igo-form",3,"formGroup",4,"ngIf"],["class","mat-typography",4,"ngIf"],[1,"igo-form",3,"formGroup"],[1,"igo-input-container"],[3,"value","valueChange"],[3,"value","click",4,"ngFor","ngForOf"],["tooltip-position","below","matTooltipShowDelay","500",1,"igo-form-button-group",3,"matTooltip"],["mat-raised-button","","type","button",3,"disabled","click"],[3,"shown"],["hidden","","type","file",3,"click","change"],["fileInput",""],[3,"value","click"],["mat-line","",4,"ngIf"],["mat-line",""],[1,"mat-typography"],["multiple","",3,"value","valueChange"],["class","export-select-trigger",4,"ngIf"],[3,"ngClass","value","click",4,"ngFor","ngForOf"],["formControlName","format"],[4,"ngIf"],["disabled","true",4,"ngIf"],["class","igo-input-container",4,"ngIf"],["class","export-options mat-typography",4,"ngIf"],[1,"igo-form-button-group"],[1,"export-select-trigger"],[3,"ngClass","value","click"],[3,"labelPosition","click","checked","change",4,"ngIf"],[3,"labelPosition","click","checked","change"],[3,"value",4,"ngFor","ngForOf"],["disabled","true"],["matInput","","formControlName","name",3,"placeholder"],["formControlName","encoding"],[1,"export-options","mat-typography"],["formControlName","featureInMapExtent",3,"labelPosition"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"mat-button-toggle-group",1),r.NdJ("change",function(e){return t.onImportExportChange(e)}),r.TgZ(2,"mat-button-toggle",2),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.TgZ(5,"mat-button-toggle",2),r._uU(6),r.ALo(7,"translate"),r.qZA(),r.qZA(),r.qZA(),r.YNc(8,gy,20,24,"form",3),r.YNc(9,fy,14,15,"section",4),r.YNc(10,yy,4,3,"section",4),r.ALo(11,"async"),r.YNc(12,My,34,35,"form",3),r.ALo(13,"async")),2&e&&(r.xp6(1),r.Q6J("value",t.selectedMode),r.xp6(1),r.Q6J("value","import"),r.xp6(1),r.hij(" ",r.lcZ(4,9,"igo.geo.importExportForm.importTabTitle")," "),r.xp6(2),r.Q6J("value","export"),r.xp6(1),r.hij(" ",r.lcZ(7,11,"igo.geo.importExportForm.exportTabTitle")," "),r.xp6(2),r.Q6J("ngIf","import"===t.selectedMode),r.xp6(1),r.Q6J("ngIf","import"===t.selectedMode),r.xp6(1),r.Q6J("ngIf",0===r.lcZ(11,13,t.exportableLayers$).length&&"export"===t.selectedMode),r.xp6(2),r.Q6J("ngIf",r.lcZ(13,15,t.exportableLayers$).length>0&&"export"===t.selectedMode))},directives:[Ha.A9,Ha.Yi,h.O5,ze._Y,ze.JL,ze.sg,Pe.KE,Pe.hX,_e.gD,h.sg,p.gM,n.lW,Ji,$e.ey,_e.$L,ze.JJ,ze.u,h.mk,Qa.Rr,Qe.Nt,ze.Fj],pipes:[U.X$,h.Ov,Oi],styles:["mat-option.igo-export-layer-mat-option[_ngcontent-%COMP%]{height:5em;line-height:1em}.import-export-toggle[_ngcontent-%COMP%]{padding:10px;text-align:center}.import-export-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]{width:100%}.import-export-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]{width:50%}h4[_ngcontent-%COMP%]{padding:0 5px}.igo-form[_ngcontent-%COMP%]{padding:15px 5px}.igo-input-container[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.igo-form-button-group[_ngcontent-%COMP%]{text-align:center;padding-top:10px}igo-spinner[_ngcontent-%COMP%]{position:absolute;padding-left:10px}.export-options[_ngcontent-%COMP%]{overflow-x:hidden}.export-options[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{width:100%;margin:10px}.export-options[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content{width:calc(100% - 60px)}.export-select-trigger[_ngcontent-%COMP%]{opacity:.75;font-size:.75em}"]}),e})(),ky=new r.OlP("styleListOptions");function Py(e){return{provide:ky,useValue:e}}function _y(e,t){return()=>e.load(t)}let $y=(()=>{class e{static forRoot(){return{ngModule:e,providers:[Py({}),{provide:r.ip1,useFactory:_y,multi:!0,deps:[uy,ky]}]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[]]}),e})(),qy=(()=>{class e{static forRoot(){return{ngModule:e}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[a.Ps,p.AV,ze.u5,ze.UX,h.ez,n.ot,Ha.vV,sl.Nh,_e.LD,$e.Ng,Pe.lN,Qe.c,Qa.rP,oe,ji,Mi,Bo,$y.forRoot()],$y]}),e})(),Dy=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,oe,Ro,a.Ps,n.ot,p.AV]]}),e})();function Ey(e,t){if(1&e&&(r.TgZ(0,"mat-option",5),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.measure."+e)," ")}}r.B6R(fu,[h.O5,h.mk,n.lW,p.gM,a.Hw,h.sg,xu],[U.X$]),r.B6R(xu,[h.O5,ou],[]);let Ry=(()=>{class e{constructor(){this.measure$=new C.X(void 0),this._auto=!1,this.measureUnitChange=new r.vpe}set measure(e){this.measure$.next(e)}get measure(){return this.measure$.value}set auto(e){this.toggleAutoUnit(e)}get auto(){return this._auto}get measureUnits(){return Object.values(this.measureType===oh.Area?sh:ih)}ngOnDestroy(){this.toggleAutoUnit(!1)}onMeasureUnitChange(e){this.measureUnit=e,this.measureUnitChange.emit(e)}toggleAutoUnit(e){void 0!==this.measure$$&&this.measure$$.unsubscribe(),!0===e&&(this.measure$$=this.measure$.subscribe(e=>{this.computeBestMeasureUnit(e)})),this._auto=e}computeBestMeasureUnit(e){let t=this.measureUnit;this.measureType===oh.Area?t=function(e){let t=sh.SquareMeters,o=e;const i=[sh.SquareKilometers];for(;o>1e6&&i.length>0;)t=i.pop(),o=fh(e,t);return t}(e):this.measureType===oh.Length&&(t=function(e){let t=ih.Meters,o=e;const i=[ih.Kilometers];for(;o>1e3&&i.length>0;)t=i.pop(),o=mh(e,t);return t}(e)),t!==this.measureUnit&&this.onMeasureUnitChange(t)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-measurer-item"]],inputs:{measureType:"measureType",measureUnit:"measureUnit",measure:"measure",auto:"auto",placeholder:"placeholder"},outputs:{measureUnitChange:"measureUnitChange"},decls:7,vars:11,consts:[[1,"measure-field"],["matInput","",3,"readonly","placeholder","value"],[1,"unit-field"],[3,"value","disabled","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-form-field",0),r._UZ(1,"input",1),r.ALo(2,"measureFormat"),r.ALo(3,"async"),r.qZA(),r.TgZ(4,"mat-form-field",2),r.TgZ(5,"mat-select",3),r.NdJ("selectionChange",function(e){return t.onMeasureUnitChange(e.value)}),r.YNc(6,Ey,3,4,"mat-option",4),r.qZA(),r.qZA()),2&e&&(r.xp6(1),r.Q6J("readonly",!0)("placeholder",t.placeholder)("value",r.xi3(2,6,r.lcZ(3,9,t.measure$)||0,t.measureUnit)),r.xp6(4),r.Q6J("value",t.measureUnit)("disabled",t.auto),r.xp6(1),r.Q6J("ngForOf",t.measureUnits))},directives:[Pe.KE,Qe.Nt,_e.gD,h.sg,$e.ey],pipes:[jh,h.Ov,U.X$],styles:["[_nghost-%COMP%]{display:flex;width:100%;padding:5px 10px}.measure-field[_ngcontent-%COMP%]{display:flex;flex-flow:column nowrap;width:100%}.unit-field[_ngcontent-%COMP%]{width:110px;margin-left:10px}"],changeDetection:0}),e})(),Uy=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,n.ot,Ha.vV,a.Ps,p.AV,Pe.lN,Qe.c,_e.LD,Qa.rP,oe,xi]]}),e})();r.B6R(Bh,[Ha.A9,Ha.Yi,Qa.Rr,h.O5,Ry,n.lW,p.gM,a.Hw,no],[U.X$,h.Ov]),r.B6R(Uh,[],[U.X$,jh]);let Ny=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[],Uy]}),e})();var Jy=(()=>{return(e=Jy||(Jy={}))[e.None=0]="None",e[e.Move=1]="Move",e[e.Zoom=2]="Zoom",e[e.ZoomIfOutMapExtent=3]="ZoomIfOutMapExtent",Jy;var e})();let By=(()=>{class e{constructor(){this.features$=new C.X([[],void 0])}setFeatures(e,t=Jy.None){this.features$.next([e,t])}clear(){this.features$.next([[],Jy.None])}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),jy=(()=>{class e{constructor(e,t){this.component=e,this.overlayService=t,this.format=new Yn.Z}get map(){return this.component.map}ngOnInit(){this.features$$=this.overlayService.features$.subscribe(e=>this.handleFeatures(e[0],e[1]))}ngOnDestroy(){this.features$$.unsubscribe()}handleFeatures(e,t){}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ou,2),r.Y36(By))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoOverlay",""]]}),e})(),Gy=(()=>{class e{static forRoot(){return{ngModule:e}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[]]}),e})(),Qy=(()=>{class e{constructor(e,t,o,i){this.http=e,this.messageService=t,this.activityService=o,this.languageService=i}print(e,t){const o=new O.xQ,i=t.paperFormat,r=+t.resolution,s=t.orientation;this.activityId=this.activityService.register();const n=new pl.ZP({orientation:s,format:i.toLowerCase()}),a=[n.internal.pageSize.width,n.internal.pageSize.height],l=[10,10,10,10],c=a[0]-l[3]-l[1],u=a[1]-l[0]-l[2],p=[c,u];let d=[0,0];if(void 0!==t.title&&(d=this.getTitleSize(t.title,c,u,n),this.addTitle(n,t.title,d[0],l[3]+d[1],d[0]*(25.4/72))),void 0!==t.subtitle){let e=0;const o=d[0];e=this.getSubTitleSize(t.subtitle,c,u,n),this.addSubTitle(n,t.subtitle,.7*o,l[3]+e,1.7*o*(25.4/72)),l[0]=l[0]+.7*d[0]*(25.4/72)}return(!0===t.showProjection||!0===t.showScale)&&this.addProjScale(n,e,r,t.showProjection,t.showScale),""!==t.comment&&this.addComment(n,t.comment),this.addMap(n,e,r,p,l).subscribe(i=>(0,Ue.mG)(this,void 0,void 0,function*(){i===E.Done&&(yield this.addScale(n,e,l),yield this.handleMeasureLayer(n,e,l),"none"!==t.legendPosition?["topleft","topright","bottomleft","bottomright"].indexOf(t.legendPosition)>-1?yield this.addLegendSamePage(n,e,l,r,t.legendPosition):"newpage"===t.legendPosition&&(yield this.addLegend(n,e,l,r)):yield this.saveDoc(n)),(i===E.Done||i===E.Error)&&(this.activityService.unregister(this.activityId),o.next(E.Done))})),o}handleMeasureLayer(e,t,o){return(0,Ue.mG)(this,void 0,void 0,function*(){if(t.layers.find(e=>e.visible&&e.id.startsWith("igo-measures-"))){let i;const r=t.ol.getOverlayContainer();yield hl()(r,{scale:1,backgroundColor:null}).then(e=>{i=e}),this.addCanvas(e,i,o)}})}getLayersLegendHtml(e,t,o){return new Se.y(i=>{let r="";const s=function(e,t){const o=[];for(const i of e){if(!1===i.visible)continue;const e=i.dataSource.getLegend(void 0,t)||[];for(const t of e)void 0!==t.url&&o.push({title:i.title,url:t.url})}return o}(e.layers,{resolution:e.viewController.getResolution(),extent:e.viewController.getExtent(),projection:e.viewController.getOlProjection().getCode(),scale:e.viewController.getScale(o),size:e.ol.getSize()});if(0===s.length)return i.next(r),void i.complete();r+='<style media="screen" type="text/css">',r+=".html2canvas-container { width: "+t+"mm !important; height: 2000px !important; }",r+="table.tableLegend {table-layout: auto;}",r+="div.styleLegend {padding-top: 5px; padding-right:5px;padding-left:5px;padding-bottom:5px;}",r+="</style>",r+='<font size="3" face="Times" >',r+='<div class="styleLegend">',r+='<table class="tableLegend" >';const n=s.map(e=>this.getDataImage(e.url).pipe((0,x.U)(t=>{let o="<tr><td>"+e.title.toUpperCase()+"</td></tr>";return o+='<tr><td><img src="'+t+'"></td></tr>',o})));(0,gn.D)(n).subscribe(e=>{r=e.reduce((e,t)=>e+t,r),r+="</table>",r+="</div>",i.next(r),i.complete()})})}getDataImage(e){return new xt(this.http).transform(e)}getLayersLegendImage(e,t="png",o,i){return(0,Ue.mG)(this,void 0,void 0,function*(){const r=new O.xQ;let s=yield this.getLayersLegendHtml(e,200,i).toPromise();t=t.toLowerCase(),0===s.length&&(s='<font size="12" face="Courier New" >',s+='<div align="center"><b>NO LEGEND</b></div>');const n=window.document.createElement("div");n.style.position="absolute",n.style.top="0",window.document.body.appendChild(n),n.innerHTML=s,yield this.timeout(1);const a=yield hl()(n,{useCORS:!0}).catch(e=>{console.log(e)});if(a){let e=E.Done;try{o?this.generateCanvaFileToZip(a,"legendImage."+t):this.saveCanvasImageAsFile(a,"legendImage",t),n.parentNode.removeChild(n)}catch(l){e=E.Error}r.next(e)}return r})}getTitleSize(e,t,o,i){const r=Math.round(2*(o+145)*.05)/2;i.setFont("Times","bold"),i.getTextWidth(e);const s=i.getStringUnitWidth(e)*r/i.internal.scaleFactor,n=Math.round(2*(o+150)*.037)/2;let a,l=0;return s>=t?(a=0,l=Math.round(t/e.length*96/25.4),l<n&&(l=n)):(a=(t-s)/2,l=r),[l,a]}getSubTitleSize(e,t,o,i){const r=.7*Math.round(2*(o+145)*.05)/2;i.setFont("Times","bold");const s=i.getStringUnitWidth(e)*r/i.internal.scaleFactor;let n;return n=s>=t?0:(t-s)/2,n}addTitle(e,t,o,i,r){e.setFont("Times","bold"),e.setFontSize(o),e.text(t,i,r)}addSubTitle(e,t,o,i,r){e.setFont("Times","bold"),e.setFontSize(o),e.text(t,i,r)}addComment(e,t){const o=e.internal.pageSize.height-5;e.setFont("courier"),e.setFontSize(16),e.text(t,20,o)}addProjScale(e,t,o,i,r){const s=this.languageService.translate,n=e.internal.pageSize.height-15;let a="";!0===i&&(a+=s.instant("igo.geo.printForm.projection")+": "+t.projection),!0===r&&(!0===i&&(a+="   "),a+=s.instant("igo.geo.printForm.scale")+": ~ 1 / "+sc(t.viewController.getScale(o))),e.setFont("courier"),e.setFontSize(16),e.text(a,20,n)}addLegend(e,t,o,i){return(0,Ue.mG)(this,void 0,void 0,function*(){const o=e.internal.pageSize.width,r=yield this.getLayersLegendHtml(t,o,i).toPromise();if(""===r)return yield this.saveDoc(e),!0;const s=window.document.createElement("div");s.style.position="absolute",s.style.top="0",window.document.body.appendChild(s),s.innerHTML=r,yield this.timeout(1);const n=yield hl()(s,{useCORS:!0}).catch(e=>{console.log(e)});if(n){const t=.85,o=[t*(25.4*n.width)/i,t*(25.4*n.height)/i];let r;e.addPage(),r=n.toDataURL("image/png"),e.addImage(r,"PNG",10,10,o[0],o[1]),s.parentNode.removeChild(s)}yield this.saveDoc(e)})}addLegendSamePage(e,t,o,i,r){return(0,Ue.mG)(this,void 0,void 0,function*(){const s=e.internal.pageSize.width,n=yield this.getLayersLegendHtml(t,s,i).toPromise();if(""===n)return yield this.saveDoc(e),!0;const a=window.document.createElement("div");a.style.position="absolute",a.style.top="0",window.document.body.appendChild(a),a.innerHTML=n,yield this.timeout(1);const l=yield hl()(a,{useCORS:!0}).catch(e=>{console.log(e)});let c;if(l){const t=.85,s=[t*(25.4*l.width)/i,t*(25.4*l.height)/i];"bottomright"===r?c=[e.internal.pageSize.height-o[2]-s[1],o[1],o[2],e.internal.pageSize.width-o[1]-s[0]]:"topright"===r?c=[o[0],o[1],e.internal.pageSize.height-o[0]-s[1],e.internal.pageSize.width-o[1]-s[0]]:"bottomleft"===r?c=[e.internal.pageSize.height-o[2]-s[1]-15,e.internal.pageSize.width-o[3]-s[0],o[2]+15,o[3]]:"topleft"===r&&(c=[o[0],e.internal.pageSize.width-o[3]-s[0],e.internal.pageSize.height-o[0]-s[1],o[3]]),this.addCanvas(e,l,c),a.parentNode.removeChild(a),yield this.saveDoc(e)}})}addScale(e,t,o){return(0,Ue.mG)(this,void 0,void 0,function*(){const i=t.ol.getSize();let r;t.ol.getView().calculateExtent(i);const s=t.ol.getOverlayContainerStopEvent(),n=s.getElementsByTagName("button"),a=Array.from(n);for(const e of a)e.setAttribute("data-html2canvas-ignore","true");yield hl()(s,{scale:1,backgroundColor:null,allowTaint:!0,useCORS:!0}).then(e=>{r=e}),this.addCanvas(e,r,o)})}defineNbFileToProcess(e){this.nbFileToProcess=e}timeout(e){return new Promise(t=>setTimeout(t,e))}addCanvas(e,t,o){let i;if(t&&(i=t.toDataURL("image/png")),void 0!==i){const r=this.getImageSizeToFitPdf(e,t,o);e.addImage(i,"PNG",o[3],o[0],r[0],r[1]),e.rect(o[3],o[0],r[0],r[1])}}addMap(e,t,o,i,r){const s=new O.xQ,n=t.ol.getSize(),a=t.ol.getView().calculateExtent(n),l=Math.round(i[0]*o/25.4),c=Math.round(i[1]*o/25.4);let u;return t.ol.once("rendercomplete",o=>{const i=o.target.getViewport().getElementsByTagName("canvas"),l=t.status$.subscribe(o=>{if(clearTimeout(u),o!==E.Done)return;l.unsubscribe();let c=E.Done;try{for(const t of i)0!==t.width&&this.addCanvas(e,t,r)}catch(p){c=E.Error,this.messageService.error(this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageBody"),this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageHeader"))}this.renderMap(t,n,a),s.next(c)});u=window.setTimeout(()=>{l.unsubscribe();let o=E.Done;try{for(const t of i)0!==t.width&&this.addCanvas(e,t,r)}catch(c){o=E.Error,this.messageService.error(this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageBody"),this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageHeader"))}this.renderMap(t,n,a),s.next(o)},200)}),this.renderMap(t,[l,c],a),s}downloadMapImage(e,t,o="png",i=!1,r=!1,s=!1,n="",a="",l="",c=!0){const u=new O.xQ;this.activityId=this.activityService.register();const p=this.languageService.translate;return e.ol.once("rendercomplete",s=>{o=o.toLowerCase();const d=s.target.getViewport().getElementsByTagName("canvas")[0],h=document.createElement("canvas"),g=h.getContext("2d");let m=0,f=10;const y=d.width;let v=d.height;g.font="20px Calibri";const b=g.measureText(l).width;v=""!==n?v+30:v,v=""!==a?v+30:v,v=!1!==i||!1!==r?v+30:v;const x=v-10,w=Math.ceil(b/y);v=""!==l?v+30*w:v;let S=v-20*w+5;if(h.width=y,h.height=v,"jpeg"===o&&(g.fillStyle="#ffffff",g.fillRect(0,0,y,v),g.fillStyle="#000000"),""!==n&&(g.font="26px Calibri",m=30,g.textAlign="center",g.fillText(n,y/2,20,.9*y)),""!==a&&(g.font="26px Calibri",m=60,g.textAlign="center",g.fillText(a,y/2,50,.9*y)),g.font="20px Calibri",!1!==i){const t=p.instant("igo.geo.printForm.projection");g.textAlign="start",g.fillText(t+": "+e.projection,f,x),f+=200}if(!1!==r){const o=p.instant("igo.geo.printForm.scale"),i=e.viewController.getScale(t);g.textAlign="start",g.fillText(o+": ~ 1 / "+sc(i),f,x)}if(""!==l)if(g.textAlign="center",1===w)g.fillText(l,y/2,S);else{const e=Math.floor(l.length/w);let t,o="",i=0;for(let r=0;r<w;r++)w-1>r?(o=l.substr(i,e),t=o.lastIndexOf(" "),g.fillText(o.substr(0,t),y/2,S),i+=t,S+=20):g.fillText(l.substr(i),y/2,S)}g.drawImage(d,0,m);let C=E.Done;try{c?"tiff"===o.toLowerCase()?this.generateCanvaFileToZip(h,"map"+e.projection.replace(":","_")+"."+o):this.generateCanvaFileToZip(h,"map."+o):this.saveCanvasImageAsFile(h,"map",o)}catch(T){C=E.Error}if(u.next(C),"tiff"===o.toLowerCase()){const t=this.getWorldFileInformation(e),o=new Blob([t],{type:"text/plain;charset=utf-8"});c?this.addFileToZip("map"+e.projection.replace(":","_")+".tfw",o):((0,ul.saveAs)(o,"map"+e.projection+".tfw"),this.saveFileProcessing())}}),e.ol.renderSync(),u}renderMap(e,t,o){e.ol.updateSize(),e.ol.renderSync()}saveDoc(e){return(0,Ue.mG)(this,void 0,void 0,function*(){yield e.save("map.pdf",{returnPromise:!0})})}getImageSizeToFitPdf(e,t,o){const i=e.internal.pageSize.getHeight()-(o[0]+o[2]),r=e.internal.pageSize.getWidth()-(o[1]+o[3]),s=t.height,n=t.width,a=s/i,l=n/r,c=a>l?a:l;return[c>1?n/c:n,c>1?s/c:s]}getWorldFileInformation(e){const t=e.viewController.getResolution(),o=e.viewController.getExtent();return[t,0,0,-t,o[0]+t/.5,o[3]-t/.5].join("\n")}saveCanvasImageAsFile(e,t,o){const i="image/"+o,r=this;try{e.toDataURL(),navigator.msSaveBlob?(navigator.msSaveBlob(e.msToBlob(),t+"."+o),this.saveFileProcessing()):e.toBlob(e=>{(0,ul.saveAs)(e,t+"."+o),r.saveFileProcessing()},i)}catch(s){this.messageService.error(this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageBody"),this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageHeader"))}}generateCanvaFileToZip(e,t){const o=this;(!this.hasOwnProperty("zipFile")||void 0===this.zipFile)&&(this.zipFile=new gl);try{e.toDataURL(),navigator.msSaveBlob?this.addFileToZip(t,e.msToBlob()):e.toBlob(e=>{o.addFileToZip(t,e)},"image/jpeg")}catch(i){this.messageService.error(this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageBody"),this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageHeader"))}}addFileToZip(e,t){this.zipFile.file(e,t),this.nbFileToProcess--,0===this.nbFileToProcess&&(this.getZipFile(),this.activityService.unregister(this.activityId))}saveFileProcessing(){this.nbFileToProcess--,0===this.nbFileToProcess&&this.activityService.unregister(this.activityId)}getZipFile(){const e=this;this.zipFile.generateAsync({type:"blob"}).then(t=>{(0,ul.saveAs)(t,"map.zip"),delete e.zipFile})}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(le),r.LFG(B),r.LFG(ne))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const zy=$(["Pdf","Image"]),Yy=$(["A0","A1","A2","A3","A4","A5","Letter","Legal"]),Hy=$(["landscape","portrait"]),Vy=$(["72","96","150","300"]),Wy=$(["Bmp","Gif","Jpeg","Png","Tiff"]),Xy=$(["none","topright","topleft","bottomleft","bottomright","newpage"]);function Ky(e,t){if(1&e&&(r.TgZ(0,"mat-option",19),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.key),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.printForm.legendPositions."+e.value)," ")}}function ev(e,t){if(1&e&&(r.TgZ(0,"mat-option",19),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.key),r.xp6(1),r.hij(" ",e.value," ")}}function tv(e,t){if(1&e&&(r.TgZ(0,"mat-option",19),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.key),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.printForm.paperFormats."+e.value)," ")}}function ov(e,t){if(1&e&&(r.TgZ(0,"mat-option",19),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.key),r.xp6(1),r.hij(" ",e.value," ")}}function iv(e,t){if(1&e&&(r.TgZ(0,"mat-option",19),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.key),r.xp6(1),r.hij(" ",e.value+" PPI"," ")}}function rv(e,t){if(1&e&&(r.TgZ(0,"mat-option",19),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.key),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.printForm."+e.value)," ")}}let sv=(()=>{class e{constructor(e){this.formBuilder=e,this.outputFormats=zy,this.paperFormats=Yy,this.orientations=Hy,this.resolutions=Vy,this.imageFormats=Wy,this.legendPositions=Xy,this.isPrintService=!0,this.submit=new r.vpe,this.form=this.formBuilder.group({title:["",[]],subtitle:["",[]],comment:["",[]],outputFormat:["",[ze.kI.required]],paperFormat:["",[ze.kI.required]],imageFormat:["",[ze.kI.required]],resolution:["",[ze.kI.required]],orientation:["",[ze.kI.required]],legendPosition:["",[ze.kI.required]],showProjection:!1,showScale:!1,showLegend:!1,doZipFile:[{hidden:this.isPrintService}]})}get imageFormat(){return this.imageFormatField.value}set imageFormat(e){this.imageFormatField.setValue(e||Wy.Jpeg,{onlySelf:!0})}get outputFormat(){return this.outputFormatField.value}set outputFormat(e){this.outputFormatField.setValue(e||zy.Pdf,{onlySelf:!0})}get paperFormat(){return this.paperFormatField.value}set paperFormat(e){this.paperFormatField.setValue(e||Yy.Letter,{onlySelf:!0})}get orientation(){return this.orientationField.value}set orientation(e){this.orientationField.setValue(e||Hy.landscape,{onlySelf:!0})}get resolution(){return this.resolutionField.value}set resolution(e){this.resolutionField.setValue(e||Vy[96],{onlySelf:!0})}get legendPosition(){return this.legendPositionField.value}set legendPosition(e){this.legendPositionField.setValue(e||Xy.none,{onlySelf:!0})}get title(){return this.titleField.value}set title(e){this.titleField.setValue(e,{onlySelf:!0})}get subtitle(){return this.subtitleField.value}set subtitle(e){this.subtitleField.setValue(e,{onlySelf:!0})}get comment(){return this.commentField.value}set comment(e){this.commentField.setValue(e,{onlySelf:!0})}get showProjection(){return this.showProjectionField.value}set showProjection(e){this.showProjectionField.setValue(e,{onlySelf:!0})}get showScale(){return this.showScaleField.value}set showScale(e){this.showScaleField.setValue(e,{onlySelf:!0})}get showLegend(){return this.showLegendField.value}set showLegend(e){this.showLegendField.setValue(e,{onlySelf:!0})}get doZipFile(){return this.doZipFileField.value}set doZipFile(e){this.doZipFileField.setValue(e,{onlySelf:!0})}get outputFormatField(){return this.form.controls.outputFormat}get paperFormatField(){return this.form.controls.paperFormat}get imageFormatField(){return this.form.controls.imageFormat}get orientationField(){return this.form.controls.orientation}get resolutionField(){return this.form.controls.resolution}get commentField(){return this.form.controls.comment}get showProjectionField(){return this.form.controls.showProjection}get showScaleField(){return this.form.controls.showScale}get showLegendField(){return this.form.controls.showLegend}get doZipFileField(){return this.form.controls.doZipFile}get titleField(){return this.form.controls.title}get subtitleField(){return this.form.controls.subtitle}get legendPositionField(){return this.form.controls.legendPosition}ngOnInit(){this.doZipFileField.setValue(!1)}handleFormSubmit(e,t){e.isPrintService=this.isPrintService,t&&this.submit.emit(e)}toggleImageSaveProp(){this.isPrintService="Image"!==this.outputFormatField.value}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ze.qu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-print-form"]],inputs:{disabled$:"disabled$",imageFormat:"imageFormat",outputFormat:"outputFormat",paperFormat:"paperFormat",orientation:"orientation",resolution:"resolution",legendPosition:"legendPosition",title:"title",subtitle:"subtitle",comment:"comment",showProjection:"showProjection",showScale:"showScale",showLegend:"showLegend",doZipFile:"doZipFile"},outputs:{submit:"submit"},decls:65,vars:72,consts:[[1,"igo-form",3,"formGroup"],[1,"igo-input-container"],["matInput","","formControlName","title",3,"placeholder"],["matInput","","formControlName","subtitle",3,"placeholder"],["matInput","","formControlName","comment",3,"placeholder"],[1,"print-slide-toggle-container","mat-typography"],["formControlName","showProjection",1,"print-option",3,"labelPosition"],["formControlName","showScale",1,"print-option",3,"labelPosition"],["formControlName","doZipFile",1,"print-option",3,"labelPosition"],["formControlName","legendPosition",3,"placeholder"],[3,"value",4,"ngFor","ngForOf"],["formControlName","outputFormat",3,"placeholder","selectionChange"],["formControlName","paperFormat",3,"placeholder"],["formControlName","imageFormat",3,"placeholder"],[1,"igo-input-container",2,"display","none"],["formControlName","resolution",3,"placeholder"],["formControlName","orientation",3,"placeholder"],[1,"igo-form-button-group","print-button-top-padding"],["mat-raised-button","","type","button",3,"disabled","click"],[3,"value"]],template:function(e,t){1&e&&(r.TgZ(0,"form",0),r.TgZ(1,"div",1),r.TgZ(2,"mat-form-field"),r._UZ(3,"input",2),r.ALo(4,"translate"),r.qZA(),r.qZA(),r.TgZ(5,"div",1),r.TgZ(6,"mat-form-field"),r._UZ(7,"input",3),r.ALo(8,"translate"),r.qZA(),r.qZA(),r.TgZ(9,"div",1),r.TgZ(10,"mat-form-field"),r._UZ(11,"input",4),r.ALo(12,"translate"),r.qZA(),r.qZA(),r.TgZ(13,"div",1),r.TgZ(14,"div",5),r.TgZ(15,"mat-slide-toggle",6),r._uU(16),r.ALo(17,"translate"),r.qZA(),r.TgZ(18,"mat-slide-toggle",7),r._uU(19),r.ALo(20,"translate"),r.qZA(),r.TgZ(21,"mat-slide-toggle",8),r._uU(22),r.ALo(23,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(24,"div",1),r.TgZ(25,"mat-form-field"),r.TgZ(26,"mat-select",9),r.ALo(27,"translate"),r.YNc(28,Ky,3,4,"mat-option",10),r.ALo(29,"keyvalue"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(30,"div",1),r.TgZ(31,"mat-form-field"),r.TgZ(32,"mat-select",11),r.NdJ("selectionChange",function(){return t.toggleImageSaveProp()}),r.ALo(33,"translate"),r.YNc(34,ev,2,2,"mat-option",10),r.ALo(35,"keyvalue"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(36,"div",1),r.TgZ(37,"mat-form-field"),r.TgZ(38,"mat-select",12),r.ALo(39,"translate"),r.YNc(40,tv,3,4,"mat-option",10),r.ALo(41,"keyvalue"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(42,"div",1),r.TgZ(43,"mat-form-field"),r.TgZ(44,"mat-select",13),r.ALo(45,"translate"),r.YNc(46,ov,2,2,"mat-option",10),r.ALo(47,"keyvalue"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(48,"div",14),r.TgZ(49,"mat-form-field"),r.TgZ(50,"mat-select",15),r.ALo(51,"translate"),r.YNc(52,iv,2,2,"mat-option",10),r.ALo(53,"keyvalue"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(54,"div",1),r.TgZ(55,"mat-form-field"),r.TgZ(56,"mat-select",16),r.ALo(57,"translate"),r.YNc(58,rv,3,4,"mat-option",10),r.ALo(59,"keyvalue"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(60,"div",17),r.TgZ(61,"button",18),r.NdJ("click",function(){return t.handleFormSubmit(t.form.value,t.form.valid)}),r.ALo(62,"async"),r._uU(63),r.ALo(64,"translate"),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.Q6J("formGroup",t.form),r.xp6(3),r.s9C("placeholder",r.lcZ(4,32,"igo.geo.printForm.title")),r.xp6(4),r.s9C("placeholder",r.lcZ(8,34,"igo.geo.printForm.subtitle")),r.xp6(4),r.s9C("placeholder",r.lcZ(12,36,"igo.geo.printForm.comment")),r.xp6(4),r.Q6J("labelPosition","before"),r.xp6(1),r.hij(" ",r.lcZ(17,38,"igo.geo.printForm.showProjection")," "),r.xp6(2),r.Q6J("labelPosition","before"),r.xp6(1),r.hij(" ",r.lcZ(20,40,"igo.geo.printForm.showScale")," "),r.xp6(2),r.Udp("display",t.isPrintService?"none":""),r.Q6J("labelPosition","before"),r.xp6(1),r.hij(" ",r.lcZ(23,42,"igo.geo.printForm.doZipFile")," "),r.xp6(4),r.s9C("placeholder",r.lcZ(27,44,"igo.geo.printForm.legendPosition")),r.xp6(2),r.Q6J("ngForOf",r.lcZ(29,46,t.legendPositions)),r.xp6(4),r.s9C("placeholder",r.lcZ(33,48,"igo.geo.printForm.outputFormat")),r.xp6(2),r.Q6J("ngForOf",r.lcZ(35,50,t.outputFormats)),r.xp6(2),r.Udp("display",t.isPrintService?"block":"none"),r.xp6(2),r.s9C("placeholder",r.lcZ(39,52,"igo.geo.printForm.paperFormat")),r.xp6(2),r.Q6J("ngForOf",r.lcZ(41,54,t.paperFormats)),r.xp6(2),r.Udp("display",t.isPrintService?"none":"block"),r.xp6(2),r.s9C("placeholder",r.lcZ(45,56,"igo.geo.printForm.imageFormat")),r.xp6(2),r.Q6J("ngForOf",r.lcZ(47,58,t.imageFormats)),r.xp6(4),r.s9C("placeholder",r.lcZ(51,60,"igo.geo.printForm.resolution")),r.xp6(2),r.Q6J("ngForOf",r.lcZ(53,62,t.resolutions)),r.xp6(2),r.Udp("display",t.isPrintService?"block":"none"),r.xp6(2),r.s9C("placeholder",r.lcZ(57,64,"igo.geo.printForm.orientation")),r.xp6(2),r.Q6J("ngForOf",r.lcZ(59,66,t.orientations)),r.xp6(3),r.Q6J("disabled",!t.form.valid||r.lcZ(62,68,t.disabled$)),r.xp6(2),r.hij(" ",r.lcZ(64,70,"igo.geo.printForm.saveBtn")," "))},directives:[ze._Y,ze.JL,ze.sg,Pe.KE,Qe.Nt,ze.Fj,ze.JJ,ze.u,Qa.Rr,_e.gD,h.sg,n.lW,$e.ey],pipes:[U.X$,Oi,h.Ov],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}.print-slide-toggle-container[_ngcontent-%COMP%]{overflow-x:hidden}.print-slide-toggle-container[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{width:100%;margin:10px}.print-slide-toggle-container[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content{width:calc(100% - 60px)}.print-option[_ngcontent-%COMP%]{display:block;margin-right:10px;margin-bottom:15px}.print-button-top-padding[_ngcontent-%COMP%]{padding-top:25px}.igo-form[_ngcontent-%COMP%]{padding:10px 5px 5px}.igo-form-button-group[_ngcontent-%COMP%]{text-align:center}"]}),e})(),nv=(()=>{class e{constructor(e){this.printService=e,this.disabled$=new C.X(!1)}get map(){return this._map}set map(e){this._map=e}get outputFormat(){return this._outputFormat}set outputFormat(e){this._outputFormat=e}get paperFormat(){return this._paperFormat}set paperFormat(e){this._paperFormat=e}get orientation(){return this._orientation}set orientation(e){this._orientation=e}get imageFormat(){return this._imageFormat}set imageFormat(e){this._imageFormat=e}get legendPosition(){return this._legendPosition}set legendPosition(e){this._legendPosition=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}handleFormSubmit(e){if(this.disabled$.next(!0),!0===e.isPrintService)this.printService.print(this.map,e).pipe((0,ke.q)(1)).subscribe(()=>{this.disabled$.next(!1)});else{let t=1;e.showLegend&&t++,"tiff"===e.imageFormat.toLowerCase()&&t++,this.printService.defineNbFileToProcess(t);const o=+e.resolution;let i=e.showLegend?2:1;this.printService.downloadMapImage(this.map,o,e.imageFormat,e.showProjection,e.showScale,e.showLegend,e.title,e.subtitle,e.comment,e.doZipFile).pipe((0,ke.q)(1)).subscribe(()=>{i--,i||this.disabled$.next(!1)}),e.showLegend&&this.printService.getLayersLegendImage(this.map,e.imageFormat,e.doZipFile,+o).then(()=>{i--,i||this.disabled$.next(!1)})}}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Qy))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-print"]],inputs:{map:"map",outputFormat:"outputFormat",paperFormat:"paperFormat",orientation:"orientation",imageFormat:"imageFormat",legendPosition:"legendPosition",resolution:"resolution"},decls:1,vars:7,consts:[[3,"outputFormat","paperFormat","orientation","imageFormat","resolution","legendPosition","disabled$","submit"]],template:function(e,t){1&e&&(r.TgZ(0,"igo-print-form",0),r.NdJ("submit",function(e){return t.handleFormSubmit(e)}),r.qZA()),2&e&&r.Q6J("outputFormat",t.outputFormat)("paperFormat",t.paperFormat)("orientation",t.orientation)("imageFormat",t.imageFormat)("resolution",t.resolution)("legendPosition",t.legendPosition)("disabled$",t.disabled$)},directives:[sv],encapsulation:2}),e})(),av=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,ze.u5,ze.UX,a.Ps,n.ot,_e.LD,$e.Ng,Qe.c,Pe.lN,Qa.rP,oe,Mi]]}),e})();function lv(e){return new Ru(e.getConfig(`searchSources.${Ru.id}`)||{})}let cv=(()=>{class e{static forRoot(){return{ngModule:e,providers:[{provide:Eu,useFactory:lv,multi:!0,deps:[z]}]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[_u],imports:[[h.ez]]}),e})();class uv{}class pv{constructor(e){this.sources=e}}function dv(e){return new pv(e)}let hv=(()=>{class e{constructor(e){this.directionsSourceService=e}route(e,t={}){if(0!==e.length)return this.directionsSourceService.sources.filter(e=>e.enabled).map(o=>this.routeSource(o,e,t))}routeSource(e,t,o={}){return e.route(t,o)}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(pv))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function gv(e){return void 0!==e.search}function mv(e){return void 0!==e.reverseSearch}function fv(e){return void 0!==e.reverseSearch&&!0===e.showInPointerSummary}function yv(e,t){let o="";return t.split("").forEach((t,i)=>{t!==e.charAt(i)&&(o+=t)}),o}function vv(e,t,o=!1){if(!e||!t)return 0;const i=o?e:e.toLowerCase(),r=o?t:t.toLowerCase(),s=yv(i,r)+yv(r,i);let n=0;return s.length&&(n=s.length/i.length*100),100-Math.floor(n)}class bv{constructor(e){this.sources=e}getSources(){return this.sources}getEnabledSources(){return this.getSources().filter(e=>!0===e.enabled)}enableSourcesByType(e){this.getSources().forEach(t=>{t.enabled=t.constructor.type===e})}setParamFromSetting(e,t){e.setParamFromSetting(t)}}let xv=(()=>{class e{constructor(e,t){this.searchSourceService=e,this.mapService=t}search(e,t={}){var o,i;if(!this.termIsValid(e))return[];const r=function(e,t,o={}){let i,r,s,n,a,l,c,u,p,d,h,g,m,f,y,v,b,x,w,S;const C=new RegExp("(\\s*;\\s*[\\d]{4,6})","g"),T="([-+])?([\\d]{1,3})([,.](\\d+))?",A=`${T}[\\s,]+${T}`,Z=new RegExp(`^${A}$`,"g"),L="([0-9]{1,2})[:|\xb0]?\\s*([0-9]{1,2})?[:|'|\u2032|\u2019]?\\s*([0-9]{1,2}(?:.[0-9]+){0,1})?\\s*[\"|\u2033|\u201d]?\\s*",F=`${L}([N|S|E|W|O]),?\\s*${L}([N|S|E|W|O])`,O=new RegExp(`^${F}$`,"gi"),M="(UTM)-?(\\d{1,2})[\\s,]*(\\d+[.,]?\\d+)[\\s,]+(\\d+[.,]?\\d+)",I=new RegExp(`^${M}`,"gi"),k="(MTM)-?(\\d{1,2})[\\s,]*(\\d+[.,]?\\d+)[\\s,]+(\\d+[.,]?\\d+)",P=new RegExp(`^${k}`,"gi"),_="([-+])?(\\d{1,3})[,.](\\d+)",$=`${_}\\s*[,]?\\s*${_}`,q=new RegExp(`^${$}`,"g"),D="([-+])?(\\d{1,3})[\\s,.]{1}(\\d{1,2})[\\s,.]{1}(\\d{1,2})[.,]?(\\d{1,5})?",E=`${D}\\s*[,.]?\\s*${D}`,R=new RegExp(`^${E}`,"g"),U="LAT\\s*[\\s:]*\\s*([-+])?(\\d{1,2})[\\s.,]?(\\d+)?[\\s.,]?\\s*(\\d{1,2}([.,]\\d+)?)?\\s*(N|S|E|W)?\\s*LONG\\s*[\\s:]*\\s*([-+])?(\\d{1,3})[\\s.,]?(\\d+)?[\\s.,]?\\s*(\\d{1,2}([.,]\\d+)?)?\\s*(N|S|E|W)?\\s*UNC\\s*[\\s:]?\\s*(\\d+)\\s*CONF\\s*[\\s:]?\\s*(\\d{1,3})",N=new RegExp(`^${U}?`,"gi"),J="([-+]?\\d+)[,.]?(\\d+)?",B=`${J}[\\s,]+${J}`,j=new RegExp(`^${B}$`,"g");let G=!1;if(e=e.toLocaleUpperCase().trim(),C.test(e)?[r,S]=e.split(";").map(e=>e.trim()):r=e,Z.test(r))[,s,x,,u,p,w,,f]=r.match(A),x=parseFloat((s||"")+x+"."+u),w=parseFloat((p||"")+w+"."+f);else if(O.test(r))[,n,a,l,c,d,h,g,m]=r.match(F),("S"===c||"N"===c)&&(n=[d,d=n][0],a=[h,h=a][0],l=[g,g=l][0],c=[m,m=c][0]),x=rc(parseFloat(n),parseFloat(a),parseFloat(l),c),w=rc(parseFloat(d),parseFloat(h),parseFloat(g),m);else if(I.test(r)){G=!0,[,,y,x,w]=r.match(M);const e=Number(y)<10?`EPSG:3260${y}`:`EPSG:326${y}`;[x,w]=Fn.vs([parseFloat(x),parseFloat(w)],e,"EPSG:4326")}else if(P.test(r)){G=!0,[,,y,x,w]=r.match(k);const e=Number(y)<10?`EPSG:3218${y}`:`EPSG:321${80+Number(y)}`;[x,w]=Fn.vs([parseFloat(x),parseFloat(w)],e,"EPSG:4326")}else if(R.test(r))[,s,n,a,l,u,p,d,h,g,f]=r.match(E),x=rc(parseFloat((s||"")+n),parseFloat(a),parseFloat(l),c),w=rc(parseFloat((p||"")+d),parseFloat(h),parseFloat(g),m);else if(q.test(r))[,s,n,u,p,d,f]=r.match($),x=rc(parseFloat((s||"")+n),parseFloat(a),parseFloat(l),c),w=rc(parseFloat((p||"")+d),parseFloat(h),parseFloat(g),m);else if(N.test(r))[,p,d,h,g,,m,s,n,a,l,,c,v,b]=r.match(U),c||(c="W"),x=a&&a.length>2?parseFloat((s||"")+n+"."+a):rc(parseFloat(n),parseFloat(a),parseFloat(l),c),w=h&&h.length>2?parseFloat((p||"")+d+"."+h):rc(parseFloat(d),parseFloat(h),parseFloat(g),m);else{if(!j.test(r))return{lonLat:void 0,message:"",radius:void 0,conf:void 0};G=!0,[,x,u,w,f]=r.match(B),u&&(x=parseFloat(x+"."+u)),f&&(w=parseFloat(w+"."+f))}if(o.forceNA&&!G&&(x>0&&w>0&&(x>w?x=-x:w=-w),x>w&&(x=[w,w=x][0])),i=[Number(x),Number(w)],void 0!==S&&"4326"!==S||i[0]>180||i[0]<-180||i[1]>90||i[1]<-90){const e=S?"EPSG:"+S:t,o="EPSG:4326";try{i=Fn.vs(i,e,o)}catch(Q){return{lonLat:void 0,message:"Projection "+e+" not supported",radius:void 0,conf:void 0}}}return Math.abs(i[0])<=180&&Math.abs(i[1])<=90?{lonLat:i,message:"",radius:v?parseInt(v,10):void 0,conf:b?parseInt(b,10):void 0}:{lonLat:void 0,message:"Coordinate out of Longitude/Latitude bounds",radius:void 0,conf:void 0}}(e,(null===(o=this.mapService.getMap())||void 0===o?void 0:o.projection)||"EPSG:3857",{forceNA:t.forceNA});if(r.lonLat)return this.reverseSearch(r.lonLat,{distance:r.radius,conf:r.conf});let s;return r.message&&console.log(r.message),t.extent=null===(i=this.mapService.getMap())||void 0===i?void 0:i.viewController.getExtent("EPSG:4326"),s=t.getEnabledOnly||void 0===t.getEnabledOnly?this.searchSourceService.getEnabledSources():this.searchSourceService.getSources(),t.sourceId?s=s.filter(e=>e.getId()===t.sourceId):t.searchType&&(s=s.filter(e=>e.getType()===t.searchType)),s=s.filter(gv),this.searchSources(s,e,t)}reverseSearch(e,t,o=!1){const i=o?fv:mv,r=this.searchSourceService.getEnabledSources().filter(i);return this.reverseSearchSources(r,e,t||{})}searchSources(e,t,o){return e.map(e=>({request:e.search(t,o),reverse:!1,source:e}))}reverseSearchSources(e,t,o){return e.map(e=>({request:e.reverseSearch(t,o),reverse:!0,source:e}))}termIsValid(e){return"string"==typeof e&&""!==e}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(bv),r.LFG(Lc))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),wv=(()=>{class e{constructor(){}getStopsCoordinates(){const e=[];return this.stops&&this.stops.forEach(t=>{e.push(t.stopCoordinates)}),e}setStops(e){this.stops=e}getStops(){return this.stops}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})();function Sv(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",17),r.NdJ("click",function(){r.CHM(e);const t=r.oxw().index;return r.oxw().geolocateStop(t)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",18),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.directionsForm.geolocate"))}function Cv(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",19),r.NdJ("click",function(){r.CHM(e);const t=r.oxw().index;return r.oxw().clearStop(t)}),r._UZ(1,"mat-icon",20),r.qZA()}}function Tv(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-option",23),r.NdJ("onSelectionChange",function(){const t=r.CHM(e).$implicit,o=r.oxw(2).index;return r.oxw().chooseProposal(t,o)}),r._uU(1),r.qZA()}if(2&e){const e=t.$implicit;r.Q6J("value",e.meta?e.meta.title:"")("matTooltip",e.meta?e.meta.title:""),r.xp6(1),r.hij(" ",e.meta?e.meta.title:""," ")}}function Av(e,t){if(1&e&&(r.TgZ(0,"mat-optgroup",21),r.YNc(1,Tv,2,3,"mat-option",22),r.qZA()),2&e){const e=t.$implicit;r.Q6J("label",e.source.title)("disabled",!1===e.source.enabled),r.xp6(1),r.Q6J("ngForOf",e.results)}}function Zv(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",24),r.NdJ("click",function(){r.CHM(e);const t=r.oxw().index;return r.oxw().removeStop(t)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",25),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.directionsForm.removeStop"))}function Lv(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",8,9),r.TgZ(2,"mat-list-item",10),r.TgZ(3,"div",11),r.YNc(4,Sv,3,3,"button",12),r.TgZ(5,"mat-form-field"),r.TgZ(6,"input",13),r.NdJ("focus",function(){const t=r.CHM(e).index;return r.oxw().focus(t)})("keyup",function(t){const o=r.CHM(e).index;return r.oxw().keyup(o,t)})("keydown.enter",function(t){return r.CHM(e),r.oxw().prevent(t)}),r.ALo(7,"translate"),r.qZA(),r.YNc(8,Cv,2,0,"button",14),r.TgZ(9,"mat-autocomplete",null,15),r.YNc(11,Av,2,3,"mat-optgroup",16),r.qZA(),r.qZA(),r.YNc(12,Zv,3,3,"button",6),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=t.$implicit,o=t.index,i=r.MAs(10),s=r.oxw();r.xp6(2),r.Q6J("formGroupName",o),r.xp6(2),r.Q6J("ngIf",s.map.geolocationFeature),r.xp6(2),r.s9C("placeholder",r.lcZ(7,7,"igo.geo.directionsForm."+e.value.directionsText)),r.Q6J("matAutocomplete",i),r.xp6(2),r.Q6J("ngIf",e.value&&(e.value.stopPoint.length>0||e.value.stopProposals.length>0)),r.xp6(3),r.Q6J("ngForOf",e.value.stopProposals),r.xp6(1),r.Q6J("ngIf",0!==o&&o!==s.stops.length-1)}}function Fv(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",3),r.NdJ("click",function(){return r.CHM(e),r.oxw().zoomRoute()}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",26),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.directionsForm.zoomRoute"))}function Ov(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",24),r.NdJ("click",function(){return r.CHM(e),r.oxw().resetForm(!0)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",27),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.directionsForm.resetDirectionsBtn"))}function Mv(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",3),r.NdJ("click",function(){return r.CHM(e),r.oxw().copyDirectionsToClipboard()}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",28),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.directionsForm.copy"))}function Iv(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",3),r.NdJ("click",function(){return r.CHM(e),r.oxw().copyLinkToClipboard()}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",29),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.directionsForm.link"))}function kv(e,t){if(1&e&&(r.TgZ(0,"mat-option",36),r._uU(1),r.qZA()),2&e){const e=t.$implicit,o=t.index,i=r.oxw(3);r.Q6J("value",e),r.xp6(1),r.lnq(" Option ",o+1," : ",i.formatDistance(e.distance)," (",i.formatDuration(e.duration),") ")}}function Pv(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-form-field"),r.TgZ(1,"mat-select",34),r.NdJ("selectionChange",function(){return r.CHM(e),r.oxw(2).changeRoute()})("ngModelChange",function(t){return r.CHM(e),r.oxw(2).activeRoute=t}),r.ALo(2,"translate"),r.YNc(3,kv,2,4,"mat-option",35),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(2);r.xp6(1),r.s9C("placeholder",r.lcZ(2,3,"igo.geo.directionsForm.drivingOptions")),r.Q6J("ngModel",e.activeRoute),r.xp6(2),r.Q6J("ngForOf",e.routesResults)}}function _v(e,t){1&e&&r._UZ(0,"mat-divider")}function $v(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-list-item",37),r.NdJ("mouseenter",function(){const t=r.CHM(e).$implicit;return r.oxw(2).showSegment(t)})("click",function(){const t=r.CHM(e).$implicit;return r.oxw(2).showSegment(t,!0)}),r._UZ(1,"mat-icon",38),r.TgZ(2,"h4",39),r._uU(3),r.qZA(),r.TgZ(4,"h4",40),r._uU(5),r.qZA(),r.qZA()}if(2&e){const e=t.$implicit,o=t.index,i=r.oxw(2);r.xp6(1),r.s9C("svgIcon",i.formatStep(e,o).image),r.Q6J("ngClass",i.formatStep(e,o).cssClass),r.xp6(2),r.AsE("",o+1,". ",i.formatStep(e,o).instruction,""),r.xp6(2),r.Oqu(i.formatDistance(e.distance))}}function qv(e,t){if(1&e&&(r.TgZ(0,"div",11),r.YNc(1,Pv,4,5,"mat-form-field",30),r.YNc(2,_v,1,0,"mat-divider",30),r.TgZ(3,"mat-list"),r.TgZ(4,"h2",31),r._uU(5),r.qZA(),r.TgZ(6,"h2",32),r._uU(7),r.qZA(),r.YNc(8,$v,6,5,"mat-list-item",33),r._UZ(9,"mat-divider"),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf",e.routesResults&&e.routesResults.length>1),r.xp6(1),r.Q6J("ngIf",e.routesResults&&0===e.routesResults.length),r.xp6(3),r.Oqu(e.activeRoute.title),r.xp6(2),r.AsE("",e.formatDistance(e.activeRoute.distance),", ",e.formatDuration(e.activeRoute.duration),""),r.xp6(1),r.Q6J("ngForOf",e.activeRoute.steps)}}let Dv=(()=>{class e{constructor(e,t,o,i,s,n,a,l,c){this.formBuilder=e,this.directionsService=t,this.languageService=o,this.messageService=i,this.searchService=s,this.queryService=n,this.directionsFormService=a,this.changeDetectorRefs=l,this.route=c,this.invalidKeys=["Control","Shift","Alt"],this.subscriptions$$=[],this.projection="EPSG:4326",this.routesQueries$$=[],this.stream$=new O.xQ,this.activeRoute$=new C.X(void 0),this.focusOnStop=!1,this.focusKey=[],this.debounce=200,this.length=2,this.stopsStore$=new C.X(void 0),this.activeRouteDescription=new r.vpe}get activeRoute(){return this._activeRoute}set activeRoute(e){this._activeRoute=e,e&&this.activeRoute$.getValue()&&e.id!==this.activeRoute$.getValue().id&&this.activeRoute$.next(e),this.activeRouteDescription.emit(this.directionsToText())}get stopsStore(){return this._stopsStore}set stopsStore(e){this._stopsStore=e,this.stopsStore$.next(e)}get routeFromFeatureDetail(){return this._routeFromFeatureDetail}set routeFromFeatureDetail(e){this._routeFromFeatureDetail=e}changeRoute(){this.showRouteGeometry(!0)}prevent(e){e.preventDefault()}ngOnInit(){this.queryService.queryEnabled=!1,this.focusOnStop=!1,this.browserLanguage=this.languageService.getLanguage(),this.stopsForm=this.formBuilder.group({directionsType:"car",directionsMode:"driving",stopOrderPriority:!0,directionsFixedStartEnd:!1,stops:this.formBuilder.array([this.createStop("start"),this.createStop("end")])}),setTimeout(()=>{this.initStores(),this.initOlInteraction()},1),this.subscribeToFormChange(),this.routesQueries$$.push(this.stream$.pipe((0,w.b)(this.debounce),(0,M.x)()).subscribe(e=>this.handleTermChanged(e))),this.stopsStore$.subscribe(()=>{!0===this.routeFromFeatureDetail&&(this.directionsFormService.setStops([]),setTimeout(()=>{this.resetForm(!1);for(const e of this.stopsStore.all())e.properties.id&&e.properties.id.toString().startsWith("directionsStop")&&this.stopsStore.delete(e);if(2===this.stopsStore.all().length){let e=0;const t=[];for(const i of this.stopsStore.all())t.push(i.geometry.coordinates),this.handleLocationProposals(i.geometry.coordinates,e),this.chooseProposal(i,e),e++;this.writeStopsToFormService(t);const o=this.directionsService.route(t,{});o&&o.map(e=>this.routesQueries$$.push(e.subscribe(e=>{this.routesResults=e,this.activeRoute=this.routesResults[0],this.showRouteGeometry(!0),this.changeDetectorRefs.detectChanges()})))}else 1===this.stopsStore.all().length&&(this.handleLocationProposals(this.stopsStore.all()[0].geometry.coordinates,1),this.chooseProposal(this.stopsStore.all()[0],1),this.writeStopsToFormService(this.stopsStore.all()[0].geometry.coordinates))},1),this.routeFromFeatureDetail=!1)})}ngOnDestroy(){this.unsubscribeRoutesQueries(),this.unlistenSingleClick(),this.queryService.queryEnabled=!0,this.freezeStores(),this.writeStopsToFormService(),this.subscriptions$$.map(e=>e.unsubscribe())}initStores(){const e=new Nc({motion:Cl.None}),t=this.stopsStore;Dc(t,new uc({id:"igo-direction-stops-layer",title:this.languageService.translate.instant("igo.geo.directionsForm.stopLayer"),zIndex:911,source:new tc,showInLayerList:!0,workspace:{enabled:!1},linkedLayers:{linkId:"igo-direction-stops-layer",links:[{bidirectionnal:!1,syncedDelete:!0,linkedIds:["igo-direction-route-layer"],properties:[]}]},exportable:!0,browsable:!1,style:Ev})),t.layer.visible=!0,Gc(t,e);const o=this.routeStore;Dc(o,new uc({id:"igo-direction-route-layer",title:this.languageService.translate.instant("igo.geo.directionsForm.routeLayer"),zIndex:910,source:new tc,showInLayerList:!0,workspace:{enabled:!1},linkedLayers:{linkId:"igo-direction-route-layer"},exportable:!0,browsable:!1,style:Ev})),o.layer.visible=!0,Gc(o,e),this.subscriptions$$.push(this.stopsStore.count$.subscribe(e=>{this.stopsStore.layer.options.showInLayerList=e>=1})),this.subscriptions$$.push(this.routeStore.count$.subscribe(e=>{this.routeStore.layer.options.showInLayerList=e>=1}))}initOlInteraction(){let e;this.selectStop=new In.Z({layers:[this.stopsStore.layer.ol],condition:Ka.MJ,hitTolerance:7,filter:e=>"stop"===e.get("type")}),this.selectStop.on("select",t=>{e=t.target.getFeatures()[0]}),this.translateStop=new kn.Z({layers:[this.stopsStore.layer.ol],features:e}),this.translateStop.on("translating",e=>{const t=e.features;0!==t.getLength()&&this.executeTranslation(t,!1,50,!0)}),this.translateStop.on("translateend",e=>{const t=e.features;0!==t.getLength()&&this.executeTranslation(t,!0,0,!1)}),this.selectedRoute=new In.Z({layers:[this.routeStore.layer.ol],condition:Ka.V4,hitTolerance:7,filter:e=>"route"===e.getId()}),this.selectedRoute.on("select",e=>{if(!1===this.focusOnStop){const t=Fn.vs(e.mapBrowserEvent.coordinate,this.map.projection,this.projection);this.addStop();const o=this.stops.length-2;this.stops.at(o).patchValue({stopCoordinates:t}),this.handleLocationProposals(t,o),this.addStopOverlay(t,o),this.selectedRoute.getFeatures().clear()}this.selectedRoute.getFeatures().clear()}),this.map.ol.addInteraction(this.selectStop),this.map.ol.addInteraction(this.translateStop),this.map.ol.addInteraction(this.selectedRoute)}subscribeToFormChange(){this.routesQueries$$.push(this.stopsForm.valueChanges.pipe((0,w.b)(this.debounce)).subscribe(e=>{this.writeStopsToFormService()}))}freezeStores(){const e=this.stopsStore,t=this.routeStore;this.map.ol.removeInteraction(this.selectStop),this.map.ol.removeInteraction(this.translateStop),this.map.ol.removeInteraction(this.selectedRoute),e.deactivateStrategyOfType(Nc),t.deactivateStrategyOfType(Nc)}executeTranslation(e,t=!1,o=0,i=!1){this.routeStore.clear();const r=e.getArray()[0],s=r.getId().split("_");let n;switch(s[1]){case"start":n=0;break;case"end":n=this.stops.length-1;break;default:n=Number(s[1])}const a=Fn.vs(r.getGeometry().getCoordinates(),this.map.projection,this.projection);this.stops.at(n).patchValue({stopCoordinates:a,stopProposals:[]}),t&&this.handleLocationProposals(a,n);const l={steps:!0,overview:!1,alternatives:!0};i&&(l.overview=!0,l.steps=!1,l.alternatives=!1),o>0?(void 0!==this.lastTimeoutRequest&&clearTimeout(this.lastTimeoutRequest),this.lastTimeoutRequest=setTimeout(()=>{this.getRoutes(void 0,l)},o)):(clearTimeout(this.lastTimeoutRequest),this.getRoutes(void 0,l))}handleLocationProposals(e,t){const o=[],i=[e[0].toFixed(5),e[1].toFixed(5)];this.stops.at(t).patchValue({stopPoint:i.join(",")}),this.searchService.reverseSearch(e,{zoom:this.map.viewController.getZoom()}).map(e=>this.routesQueries$$.push(e.request.pipe((0,x.U)(e=>e)).subscribe(e=>{if(e.forEach(t=>{0===o.filter(e=>e.source===t.source).length&&o.push({source:t.source,results:e.map(e=>e.data)})}),this.stops.at(t).patchValue({stopProposals:o}),e[0])if("icherchereverse"===e[0].source.getId()){let o=0;for(let t=0;t<e.length;t++)if("adresses"===e[t].data.properties.type){o=t;break}this.stops.at(t).patchValue({stopPoint:rt(e[o])}),"Point"===e[o].data.geometry.type&&this.stops.at(t).patchValue({stopCoordinates:e[o].data.geometry.coordinates})}else"coordinatesreverse"===e[0].source.getId()&&(this.stops.at(t).patchValue({stopPoint:[e[0].data.geometry.coordinates[0].toFixed(5),e[0].data.geometry.coordinates[1].toFixed(5)].join(",")}),"Point"===e[0].data.geometry.type&&this.stops.at(t).patchValue({stopCoordinates:e[0].data.geometry.coordinates}));else this.stops.at(t).patchValue({stopPoint:i.join(","),stopProposals:[]});this.changeDetectorRefs.detectChanges()})))}directionsText(e,t=this.stops.length){return 0===e?"start":e===t-1||1===t?"end":"intermediate"}raiseStop(e){e>0&&this.moveStop(e,-1)}lowerStop(e){e<this.stops.length-1&&this.moveStop(e,1)}moveStop(e,t){const o=this.stops.at(e);this.removeStop(e),this.stops.insert(e+t,o),this.stops.at(e).patchValue({directionsText:this.directionsText(e)}),this.stops.at(e+t).patchValue({directionsText:this.directionsText(e+t)}),this.stops.at(e).value.stopCoordinates&&this.addStopOverlay(this.stops.at(e).value.stopCoordinates,e),this.stops.at(e+t).value.stopCoordinates&&this.addStopOverlay(this.stops.at(e+t).value.stopCoordinates,e+t)}get stops(){return this.stopsForm.get("stops")}writeStopsToFormService(e){if(e)this.directionsFormService.setStops(e);else{const e=[];this.stops.value.forEach(t=>{t.stopCoordinates instanceof Array&&e.push(t)}),this.directionsFormService.setStops(e)}}addStop(){this.stops.insert(this.stops.length-1,this.createStop())}createStop(e="intermediate"){return this.formBuilder.group({stopPoint:[""],stopProposals:[[]],directionsText:e,stopCoordinates:["",[ze.kI.required]]})}removeStop(e){const t=this.getStopOverlayID(e);this.deleteStoreFeatureByID(this.stopsStore,t),this.stops.removeAt(e);let o=0;this.stops.value.forEach(e=>{this.stops.at(o).patchValue({directionsText:this.directionsText(o)}),this.addStopOverlay(this.stops.at(o).value.stopCoordinates,o),o++})}resetForm(e){this.routesResults=void 0;const t=this.stops.length;for(let o=0;o<t;o++)this.stops.removeAt(0);this.stops.insert(0,this.createStop("start")),this.stops.insert(1,this.createStop("end")),!0===e&&this.stopsStore.clear(),this.routeStore.clear()}formatStep(e,t){return this.formatInstruction(e.maneuver.type,e.maneuver.modifier,e.name,e.maneuver.bearing_after,t,e.maneuver.exit,t===this.activeRoute.steps.length-1)}formatInstruction(e,t,o,i,r,s,n=!1){let a,l,c="forward",u="rotate-270";const p=this.translateBearing(i),d=this.translateModifier(t);let h,g=("straight"===t?"":"\xe0 ")+d,m=("straight"===t?"":"on the ")+d;if(t&&t.search("slight")>=0&&(m=d),"uturn"===t?(c="forward",u="rotate-90"):"sharp right"===t||"right"===t?(c="subdirectory-arrow-right",u="icon-flipped"):"slight right"===t?(c="forward",u="rotate-290"):"straight"===t?c="forward":"slight left"===t?(c="forward",u="rotate-250"):("left"===t||"sharp left"===t)&&(c="subdirectory-arrow-left",u="icon-flipped"),"turn"===e)"straight"===t?(a="Continuer sur "+o,l="Continue on "+o):"uturn"===t?(a="Faire demi-tour sur "+o,l="Make u-turn on "+o):(a="Tourner "+g+" sur "+o,l="Turn "+d+" onto "+o);else if("new name"===e)a="Continuer en direction "+p+" sur "+o,l="Head "+p+" on "+o,c="compass",u="";else if("depart"===e)a="Aller en direction "+p+" sur "+o,l="Head "+p+" on "+o,c="compass",u="";else if("arrive"===e)if(n){let e=", ";d||(g="",m="",e=""),a="Vous \xeates arriv\xe9"+e+g,l="You have reached your destination"+e+m}else a="Vous atteignez le point interm\xe9diare sur "+o,l="You have reached the intermediate stop onto "+o,c="map-marker",u="";else"merge"===e?(a="Continuer sur "+o,l="Continue on "+o,c="forward",u="rotate-270"):"on ramp"===e?(a="Prendre l'entr\xe9e d'autoroute "+g,l="Take the ramp "+m):"off ramp"===e?(a="Prendre la sortie d'autoroute "+g,l="Take exit "+m):"fork"===e?t.search("left")>=0?(a="Garder la gauche sur "+o,l="Merge left onto "+o):t.search("right")>=0?(a="Garder la droite sur "+o,l="Merge right onto "+o):(a="Continuer sur "+o,l="Continue on "+o):"end of road"===e?(a="\xc0 la fin de la route, tourner "+d+" sur "+o,l="At the end of the road, turn "+d+" onto "+o):"use lane"===e?(a="Prendre la voie de ... ",l="Take the lane ..."):"continue"===e&&"uturn"!==t?(a="Continuer sur "+o,l="Continue on "+o,c="forward",u="rotate-270"):"roundabout"===e?(a="Au rond-point, prendre la "+s,a+=1===s?"re":"e",a+=" sortie vers "+o,l="At the roundabout, take the "+s,l+=1===s?"st":"rd",l+=" exit towards "+o,c="chart-donut",u=""):"rotary"===e?(a="Rond-point rotary....",l="Roundabout rotary....",c="chart-donut",u=""):"roundabout turn"===e?(a="Rond-point, prendre la ...",l="Roundabout, take the ...",c="chart-donut",u=""):"exit roundabout"===e?(a="Poursuivre vers "+o,l="Continue to "+o,c="forward",u="rotate-270"):"notification"===e?(a="notification ....",l="notification ...."):"uturn"===t?(a="Faire demi-tour et continuer en direction "+p+" sur "+o,l="Make u-turn and head "+p+" on "+o):(a="???",l="???");return n&&(c="flag-variant",u=""),0===r&&(c="compass",u=""),"fr"===this.browserLanguage?h=a:"en"===this.browserLanguage&&(h=l),{instruction:h,image:c,cssClass:u}}translateModifier(e){return"uturn"===e?this.languageService.translate.instant("igo.geo.directions.uturn"):"sharp right"===e?this.languageService.translate.instant("igo.geo.directions.sharp right"):"right"===e?this.languageService.translate.instant("igo.geo.directions.right"):"slight right"===e?this.languageService.translate.instant("igo.geo.directions.slight right"):"sharp left"===e?this.languageService.translate.instant("igo.geo.directions.sharp left"):"left"===e?this.languageService.translate.instant("igo.geo.directions.left"):"slight left"===e?this.languageService.translate.instant("igo.geo.directions.slight left"):"straight"===e?this.languageService.translate.instant("igo.geo.directions.straight"):e}translateBearing(e){return e>=337||e<23?this.languageService.translate.instant("igo.geo.cardinalPoints.n"):e<67?this.languageService.translate.instant("igo.geo.cardinalPoints.ne"):e<113?this.languageService.translate.instant("igo.geo.cardinalPoints.e"):e<157?this.languageService.translate.instant("igo.geo.cardinalPoints.se"):e<203?this.languageService.translate.instant("igo.geo.cardinalPoints.s"):e<247?this.languageService.translate.instant("igo.geo.cardinalPoints.sw"):e<293?this.languageService.translate.instant("igo.geo.cardinalPoints.w"):e<337?this.languageService.translate.instant("igo.geo.cardinalPoints.nw"):void 0}formatDistance(e){if(0!==e)return e>=1e5?Math.round(e/1e3)+" km":e>=1e4||e>=100?Math.round(e/100)/10+" km":e+" m"}formatDuration(e,t=!1){if(e>=3600){const t=Math.floor(e/3600),o=Math.round(60*(e/3600-t));return 60===o?t+1+" h":t+" h "+o+" min"}return e>=60?Math.round(e/60)+" min":e+" s"}showSegment(e,t=!1){this.showRouteSegmentGeometry(e.geometry.coordinates,t)}showRouteSegmentGeometry(e,t=!1){const o="vertex",i=new zn.Z(e).transform("EPSG:4326",this.map.projection).getCoordinates()[0],r=new Qn.Z(i),s=new Tn.Z({geometry:r}),n=(new Yn.Z).writeGeometryObject(r,{featureProjection:this.map.projection,dataProjection:this.map.projection}),a=this.routeStore.get(o);this.routeStore.update({type:Sl,geometry:n,projection:this.map.projection,properties:{id:o,type:"vertex"},meta:{id:o,revision:(a?a.meta.revision:0)+1},ol:s}),t&&this.map.viewController.zoomToExtent(s.getGeometry().getExtent())}zoomRoute(e){if(e)this.map.viewController.zoomToExtent(e);else if(this.routeStore.layer){const e=this.routeStore.layer.ol.getSource().getFeatures().find(e=>"route"===e.getId());if(e){const t=e.getGeometry().getExtent();this.map.viewController.zoomToExtent(t)}}}showRouteGeometry(e=!1){const t=new zn.Z(this.activeRoute.geometry.coordinates).transform("EPSG:4326",this.map.projection);e&&this.zoomRoute(t.getExtent());const o=(new Yn.Z).writeGeometryObject(t,{featureProjection:this.map.projection,dataProjection:this.map.projection}),i=this.routeStore.get("route"),r={type:Sl,geometry:o,projection:this.map.projection,properties:{id:"route",type:"route"},meta:{id:"route",revision:(i?i.meta.revision:0)+1},ol:new Tn.Z({geometry:t})};this.routeStore.update(r)}getRoutes(e=!1,t={}){this.deleteStoreFeatureByID(this.routeStore,"vertex"),this.writeStopsToFormService();const o=this.directionsFormService.getStopsCoordinates();if(o.length<2)return;const i=this.directionsService.route(o,t);i&&i.map(t=>this.routesQueries$$.push(t.subscribe(t=>{this.routesResults=t,this.activeRoute=this.routesResults[0],this.showRouteGeometry(e),this.changeDetectorRefs.detectChanges()})))}unlistenSingleClick(){0!==this.focusKey.length&&this.focusKey.forEach(e=>{Vn.B(e)})}unsubscribeRoutesQueries(){this.routesQueries$$.forEach(e=>e.unsubscribe()),this.routesQueries$$=[]}copyLinkToClipboard(){if(P.copy(this.getUrl())){const e=this.languageService.translate,t=e.instant("igo.geo.directionsForm.dialog.copyTitle"),o=e.instant("igo.geo.directionsForm.dialog.copyMsgLink");this.messageService.success(o,t)}}copyDirectionsToClipboard(){const e=this.directionsToText();if(P.copy(e)){const e=this.languageService.translate,t=e.instant("igo.geo.directionsForm.dialog.copyTitle"),o=e.instant("igo.geo.directionsForm.dialog.copyMsg");this.messageService.success(o,t)}}directionsToText(){const e="\t";let t=this.languageService.translate.instant("igo.geo.directionsForm.instructions")+":\n",o="";const i=this.languageService.translate.instant("igo.geo.directionsForm.summary")+": \n"+e+this.activeRoute.title+"\n"+e+this.formatDistance(this.activeRoute.distance)+"\n"+e+this.formatDuration(this.activeRoute.duration)+"\n\n"+this.languageService.translate.instant("igo.geo.directionsForm.stopsList")+":\n",r=this.languageService.translate.instant("igo.geo.directionsForm.link")+":\n"+e+this.getUrl();let s=1;this.stops.value.forEach(t=>{let i="",r="";t.stopPoint!==t.stopCoordinates?(r=t.stopPoint,i=" ("+[t.stopCoordinates[1],t.stopCoordinates[0]].join(",")+")"):r=[t.stopCoordinates[1],t.stopCoordinates[0]].join(","),o=o+e+s.toLocaleString()+". "+r+i+"\n",s++});let n=0;return this.activeRoute.steps.forEach(o=>{const i=this.formatStep(o,n).instruction,r=void 0===this.formatDistance(o.distance)?"":" ("+this.formatDistance(o.distance)+")";t=t+e+(n+1).toLocaleString()+". "+i+r+"\n",n++}),i+o+"\n"+r+"\n\n"+t}handleTermChanged(e){if(void 0!==e||0!==e.length){const t=[];this.search$$&&this.search$$.unsubscribe(),this.searchService.search(e,{searchType:"Feature"}).map(e=>this.search$$=e.request.subscribe(e=>{e.filter(e=>e.data.geometry).forEach(o=>{0===t.filter(e=>e.source===o.source).length&&t.push({source:o.source,meta:o.meta,results:e.map(e=>e.data)})}),this.stops&&this.stops.at(this.currentStopIndex).patchValue({stopProposals:t}),this.changeDetectorRefs.detectChanges()}))}}setTerm(e){this.term=e,this.keyIsValid(e)&&(e.length>=this.length||0===e.length)&&this.stream$.next(e)}keyIsValid(e){return void 0===this.invalidKeys.find(t=>t===e)}keyup(e,t){this.setTerm(t.target.value),this.map.ol.un("singleclick",t=>{this.handleMapClick(t,e)})}clearStop(e){const t=this.getStopOverlayID(e);this.deleteStoreFeatureByID(this.stopsStore,t),this.routeStore.clear();const o=this.stops.length;this.stops.removeAt(e),this.stops.insert(e,this.createStop(this.directionsText(e,o))),this.routesResults=void 0,this.getRoutes(!1)}chooseProposal(e,t){if(void 0!==e){let o;const i=e.geometry;if("Point"===i.type)o=i.coordinates;else if(i.type.search("Line")>=0)o=(new Yn.Z).readFeatures(i)[0].getGeometry().getFirstCoordinate(),o=[o[0],o[1]];else if(i.type.search("Polygon")>=0){const e=(new Yn.Z).readFeatures(i);o=o="Polygon"===e[0].getGeometry().getType()?e[0].getGeometry().getInteriorPoint().getFirstCoordinate():e[0].getGeometry().getInteriorPoints().getFirstCoordinate(),o=[o[0],o[1]]}void 0!==o&&(this.stops.at(t).patchValue({stopCoordinates:o}),this.addStopOverlay(o,t))}}focus(e){this.unlistenSingleClick(),this.currentStopIndex=e,this.focusOnStop=!0,this.focusKey.push(this.map.ol.once("singleclick",t=>{this.handleMapClick(t,e)}))}handleMapClick(e,t){void 0===this.currentStopIndex?(this.addStop(),this.stops.at(t=this.stops.length-2).value.stopProposals=[]):t=this.currentStopIndex;const o=Fn.vs(e.coordinate,this.map.projection,this.projection);this.stops.at(t).patchValue({stopProposals:[],stopCoordinates:o}),this.handleLocationProposals(o,t),this.addStopOverlay(o,t),setTimeout(()=>{this.focusOnStop=!1},500)}geolocateStop(e){qc(this.map,[this.map.geolocationFeature],Cl.Move);const t=this.map.viewController.getCenter(this.projection);this.stops.at(e).patchValue({stopCoordinates:t}),this.addStopOverlay(t,e),this.handleLocationProposals(t,e)}addStopOverlay(e,t){const o=this.directionsText(t);let i,r;"start"===o?(i="#008000",r=this.languageService.translate.instant("igo.geo.directionsForm.start")):"end"===o?(i="#f64139",r=this.languageService.translate.instant("igo.geo.directionsForm.end")):(i="#ffd700",r=this.languageService.translate.instant("igo.geo.directionsForm.intermediate")+" #"+t);const s=new Qn.Z(Fn.vs(e,this.projection,this.map.projection)),n=this.getStopOverlayID(t),a=(new Yn.Z).writeGeometryObject(s,{featureProjection:this.map.projection,dataProjection:this.map.projection}),l=this.stopsStore.get(n),c={type:Sl,geometry:a,projection:this.map.projection,properties:{id:n,type:"stop",stopText:r,stopColor:i,stopOpacity:1},meta:{id:n,revision:(l?l.meta.revision:0)+1},ol:new Tn.Z({geometry:s})};this.stopsStore.update(c),this.getRoutes()}getStopOverlayID(e){let t;return t=0===e?"start":e===this.stops.length-1?"end":e,"directionsStop_"+t}deleteStoreFeatureByID(e,t){const o=e.get(t);o&&e.delete(o)}getUrl(){if(!this.route)return;const e=this.route.options.directionsCoordKey,t=[];this.directionsFormService&&this.directionsFormService.getStopsCoordinates()&&0!==this.directionsFormService.getStopsCoordinates().length&&this.directionsFormService.getStopsCoordinates().forEach(e=>{t.push(lc(e,6))});let o="";return t.length>=2&&(o=`${e}=${t.join(";")}`),`${location.origin}${location.pathname}?tool=directions&sidenav=1&${o}`}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ze.qu),r.Y36(hv),r.Y36(ne),r.Y36(le),r.Y36(xv),r.Y36(_u),r.Y36(wv),r.Y36(r.sBO),r.Y36(de,8))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-directions-form"]],inputs:{term:"term",debounce:"debounce",length:"length",map:"map",stopsStore:"stopsStore",routeFromFeatureDetail:"routeFromFeatureDetail",routeStore:"routeStore"},outputs:{activeRouteDescription:"activeRouteDescription"},decls:11,vars:10,consts:[[1,"igo-form",3,"formGroup"],["formArrayName","stops",4,"ngFor","ngForOf"],[1,"igo-form-button-group"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","primary",3,"matTooltip","click"],["svgIcon","map-marker-plus"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","primary",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip","click",4,"ngIf"],["class","igo-input-container",4,"ngIf"],["formArrayName","stops"],["inputs",""],[3,"formGroupName"],[1,"igo-input-container"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","click",4,"ngIf"],["matInput","","formControlName","stopPoint",3,"matAutocomplete","placeholder","focus","keyup","keydown.enter"],["mat-button","","matSuffix","","mat-icon-button","","color","warn","aria-label","Clear",3,"click",4,"ngIf"],["auto","matAutocomplete"],[3,"label","disabled",4,"ngFor","ngForOf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","click"],["svgIcon","crosshairs-gps"],["mat-button","","matSuffix","","mat-icon-button","","color","warn","aria-label","Clear",3,"click"],["svgIcon","close"],[3,"label","disabled"],["matTooltipShowDelay","500",3,"value","matTooltip","onSelectionChange",4,"ngFor","ngForOf"],["matTooltipShowDelay","500",3,"value","matTooltip","onSelectionChange"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip","click"],["svgIcon","delete"],["svgIcon","magnify-plus-outline"],["svgIcon","file-restore"],["svgIcon","content-copy"],["svgIcon","link"],[4,"ngIf"],["mat-header","",1,"igo-route-title","mat-typography"],["mat-subheader",""],["class","igo-steps","igoListItem","",3,"mouseenter","click",4,"ngFor","ngForOf"],[3,"placeholder","ngModel","selectionChange","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["igoListItem","",1,"igo-steps",3,"mouseenter","click"],["mat-list-icon","",3,"ngClass","svgIcon"],["mat-line",""],["mat-line","",1,"right"]],template:function(e,t){1&e&&(r.TgZ(0,"form",0),r.YNc(1,Lv,13,9,"div",1),r.TgZ(2,"div",2),r.TgZ(3,"button",3),r.NdJ("click",function(){return t.addStop()}),r.ALo(4,"translate"),r._UZ(5,"mat-icon",4),r.qZA(),r.YNc(6,Fv,3,3,"button",5),r.YNc(7,Ov,3,3,"button",6),r.YNc(8,Mv,3,3,"button",5),r.YNc(9,Iv,3,3,"button",5),r.qZA(),r.qZA(),r.YNc(10,qv,10,6,"div",7)),2&e&&(r.Q6J("formGroup",t.stopsForm),r.xp6(1),r.Q6J("ngForOf",t.stops.controls),r.xp6(2),r.Q6J("matTooltip",r.lcZ(4,8,"igo.geo.directionsForm.addStop")),r.xp6(3),r.Q6J("ngIf",t.routesResults),r.xp6(1),r.Q6J("ngIf",t.routesResults),r.xp6(1),r.Q6J("ngIf",t.routesResults),r.xp6(1),r.Q6J("ngIf",t.routesResults),r.xp6(1),r.Q6J("ngIf",t.routesResults))},directives:[ze._Y,ze.JL,ze.sg,h.sg,n.lW,p.gM,a.Hw,h.O5,ze.CE,l.Tg,ze.x0,Pe.KE,Qe.Nt,ze.Fj,Ya.ZL,ze.JJ,ze.u,Ya.XC,Pe.R9,$e.Nv,$e.ey,l.i$,l.gs,Ga.d,_e.gD,ze.On,l.Nh,h.mk,$e.X2],pipes:[U.X$],styles:["mat-form-field[_ngcontent-%COMP%]{width:85%}.igo-route-title[_ngcontent-%COMP%]{font-weight:bold}.igo-steps[_ngcontent-%COMP%]{cursor:pointer}form[_ngcontent-%COMP%]{padding:10px}h3[_ngcontent-%COMP%]{padding-left:5px;padding-right:5px}.mat-line[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:pre-wrap!important}.mat-line.right[_ngcontent-%COMP%]{text-align:right}.rotate-90[_ngcontent-%COMP%]{transform:rotate(90deg)}.rotate-45[_ngcontent-%COMP%]{transform:rotate(45deg)}.rotate-270[_ngcontent-%COMP%]{transform:rotate(270deg)}.rotate-250[_ngcontent-%COMP%]{transform:rotate(250deg)}.rotate-290[_ngcontent-%COMP%]{transform:rotate(290deg)}.icon-flipped[_ngcontent-%COMP%]{transform:scaleY(-1)}"]}),e})();function Ev(e,t){const o=[new Dn.ZP({geometry:e.getGeometry(),image:new Jn.Z({radius:7,stroke:new Nn.Z({color:"#FF0000",width:3})})})],i=zc({text:e.get("stopText"),opacity:e.get("stopOpacity"),markerColor:e.get("stopColor"),markerOutlineColor:[255,255,255]}),r=[new Dn.ZP({stroke:new Nn.Z({color:"rgba(106, 121, 130, 0.75)",width:10})}),new Dn.ZP({stroke:new Nn.Z({color:"rgba(79, 169, 221, 0.75)",width:6})})];return"stop"===e.get("type")?i:"vertex"===e.get("type")?o:"route"===e.get("type")?r:void 0}let Rv=(()=>{class e{static forRoot(){return{ngModule:e}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[wv,{provide:pv,useFactory:dv,deps:[uv]}],imports:[[h.ez,ze.u5,ze.UX,a.Ps,n.ot,l.ie,Ga.t,Pe.lN,Qe.c,$e.Ng,_e.LD,p.AV,Ya.Bb,oe]]}),e})();function Uv(e){return new bv(e)}let Nv=(()=>{class e{constructor(e){this.languageService=e}formatResult(e){return e}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(ne))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})();class Jv{encodeKey(e){return encodeURIComponent(e)}encodeValue(e){return encodeURIComponent(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}let Bv=(()=>{class e extends Eu{constructor(e,t,o,i,r,s){super(i,o),this.http=e,this.languageService=t,this.formatter=r,this.title$=new C.X(""),this.hashtagsLieuxToKeep=[],this.languageService.translate.get(this.options.title).subscribe(e=>this.title$.next(e));const n=s.get($s);this.settings.length&&(n?n.authenticate$.subscribe(()=>{this.getAllowedTypes()}):this.getAllowedTypes())}get title(){return this.title$.getValue()}getId(){return e.id}getType(){return e.type}getDefaultOptions(){var e;const t=this.options.params&&this.options.params.limit?Number(this.options.params.limit):void 0,o=this.options.params&&this.options.params.ecmax?Number(this.options.params.ecmax):void 0,i=(null===(e=this.options.params)||void 0===e?void 0:e.type)?this.options.params.type.replace(/\s/g,"").toLowerCase().split(","):["adresses","codes-postaux","routes","intersections","municipalites","mrc","regadmin","lieux"];return{title:"igo.geo.search.icherche.name",searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/icherche",settings:[{type:"checkbox",title:"results type",name:"type",values:[{title:"igo.geo.search.icherche.type.address",value:"adresses",enabled:-1!==i.indexOf("adresses"),hashtags:["adresse"]},{title:"igo.geo.search.icherche.type.oldAddress",value:"anciennes-adresses",enabled:-1!==i.indexOf("anciennes-adresses"),hashtags:["anciennes-adresses"]},{title:"igo.geo.search.icherche.type.postalCode",value:"codes-postaux",enabled:-1!==i.indexOf("codes-postaux"),hashtags:["code-postal"]},{title:"igo.geo.search.icherche.type.road",value:"routes",enabled:-1!==i.indexOf("routes"),hashtags:["route"]},{title:"igo.geo.search.icherche.type.intersection",value:"intersections",enabled:-1!==i.indexOf("intersections"),hashtags:["intersection","+"]},{title:"igo.geo.search.icherche.type.city",value:"municipalites",enabled:-1!==i.indexOf("municipalites"),hashtags:["municipalit\xe9","mun"]},{title:"igo.geo.search.icherche.type.oldCity",value:"anciennes-municipalites",enabled:-1!==i.indexOf("anciennes-municipalites"),hashtags:["anciennes-municipalites"]},{title:"igo.geo.search.icherche.type.mrc",value:"mrc",enabled:-1!==i.indexOf("mrc"),hashtags:["mrc"]},{title:"igo.geo.search.icherche.type.regadmin",value:"regadmin",enabled:-1!==i.indexOf("regadmin"),hashtags:["r\xe9gion-administrative","regadmin"]},{title:"igo.geo.search.icherche.type.entreprise",value:"entreprises",enabled:-1!==i.indexOf("entreprises"),available:!1,hashtags:["entreprise"]},{title:"igo.geo.search.icherche.type.place",value:"lieux",enabled:-1!==i.indexOf("lieux"),hashtags:["lieu"]},{title:"igo.geo.search.icherche.type.exit",value:"sorties-autoroute",enabled:-1!==i.indexOf("sorties-autoroute"),hashtags:["sortie","sorties","exit"]},{title:"igo.geo.search.icherche.type.km",value:"bornes-km",enabled:-1!==i.indexOf("bornes-km"),hashtags:["borne","bornes","rep\xe8re","km"]},{title:"igo.geo.search.icherche.type.gcc",value:"bornes-gcc",enabled:-1!==i.indexOf("bornes-gcc"),hashtags:["borne","bornes","rep\xe8re","gcc","ccg"]},{title:"igo.geo.search.icherche.type.cn",value:"bornes-cn",enabled:-1!==i.indexOf("bornes-cn"),hashtags:["borne","bornes","cn"]},{title:"igo.geo.search.icherche.type.sumi",value:"bornes-sumi",enabled:-1!==i.indexOf("bornes-sumi"),hashtags:["borne","bornes","sumi"]},{title:"igo.geo.search.icherche.type.hq",value:"hq",enabled:-1!==i.indexOf("hq"),hashtags:["hq"]},{title:"igo.geo.search.icherche.type.cadastre",value:"cadastre",enabled:-1!==i.indexOf("cadastre"),hashtags:["cadastre"]}]},{type:"radiobutton",title:"results limit",name:"limit",values:[{title:"1",value:1,enabled:1===t},{title:"5",value:5,enabled:5===t||!t},{title:"10",value:10,enabled:10===t},{title:"25",value:25,enabled:25===t},{title:"50",value:50,enabled:50===t}]},{type:"radiobutton",title:"ecmax",name:"ecmax",values:[{title:"10 %",value:10,enabled:10===o},{title:"30 %",value:30,enabled:30===o||!o},{title:"50 %",value:50,enabled:50===o},{title:"75 %",value:75,enabled:75===o},{title:"100 %",value:100,enabled:100===o}]},{type:"radiobutton",title:"restrictExtent",name:"loc",values:[{title:"igo.geo.search.icherche.restrictExtent.map",value:"true",enabled:!1},{title:"igo.geo.search.icherche.restrictExtent.quebec",value:"false",enabled:!0}]}]}}search(e,t){const o=this.computeRequestParams(e,t||{});return o.get("type").length?(this.options.params.page=o.get("page")||"1",this.http.get(`${this.searchUrl}/geocode`,{params:o}).pipe((0,x.U)(t=>this.extractResults(t,e)),(0,b.K)(e=>{throw e.error.toDisplay=!0,e.error.title=this.languageService.translate.instant(this.getDefaultOptions().title),e}))):(0,A.of)([])}getAllowedTypes(){return this.http.get(`${this.searchUrl}/types`).subscribe(e=>{const t=this.settings.find(e=>"type"===e.name);t.values.forEach(t=>{const o=new RegExp(`^${t.value}(\\.|$)`),i=e.filter(e=>o.test(e));t.available=i.length>0,"lieux"===t.value&&(this.hashtagsLieuxToKeep=[...new Set(i.map(e=>e.split(".")).reduce((e,t)=>e.concat(t)).filter(e=>"lieux"!==e))])}),this.setParamFromSetting(t,!1)})}computeRequestParams(e,t){const o=Object.assign({geometry:!0,bbox:!0,icon:!0,type:"adresses,codes-postaux,municipalites,mrc,regadmin,lieux,entreprises,bornes-sumi"},this.params,this.computeOptionsParam(e,t||{}).params,{q:this.computeTerm(e),page:t.page});if("true"===o.loc){const[e,i,r,s]=t.extent;o.loc=`${e},${i};${r},${i};${r},${s};${e},${s};${e},${i}`}else"false"===o.loc&&delete o.loc;return/#[A-Za-z]+/.test(o.q)&&(o.type="lieux"),new y.LE({fromObject:_.removeUndefined(o),encoder:new Jv})}extractResults(e,t){return e.features.map(o=>this.formatter.formatResult(this.dataToResult(o,t,e)))}dataToResult(e,t,o){const i=this.computeProperties(e),r=[this.getId(),i.type,i.code].join(".");return{source:this,data:{type:Sl,projection:"EPSG:4326",geometry:e.geometry,extent:e.bbox,properties:i,meta:{id:r,title:e.properties.nom}},meta:{dataType:Sl,id:r,title:e.properties.nom,titleHtml:(e.highlight.title||e.properties.nom)+(e.highlight.title2?" <small> "+e.highlight.title2+"</small>":"")+(e.highlight.title3?"<br><small> "+e.highlight.title3+"</small>":""),icon:e.icon||"map-marker",score:e.score||vv(t.trim(),e.properties.nom),nextPage:o.features.length%+this.options.params.limit==0&&+this.options.params.page<10}}}computeProperties(t){const o=_.removeKeys(t.properties,e.propertiesBlacklist);if(!t.geometry)return Object.assign({type:t.index},o);const i={GoogleMaps:""};let r,s;if("Point"===t.geometry.type)r=Uu.getGoogleMapsCoordLink(t.geometry.coordinates[0],t.geometry.coordinates[1]);else{const e=(0,ol.Z)(t.geometry);r=Uu.getGoogleMapsCoordLink(e.geometry.coordinates[0],e.geometry.coordinates[1])}s=Uu.getGoogleMapsNameLink("routes"===t.index?t.properties.nom+", "+t.properties.municipalite:"municipalites"===t.index?t.properties.nom+", ville":"mrc"===t.index?"mrc+"+t.properties.nom:"regadmin"===t.index?t.properties.nom+",+QC":t.properties.nom||t.highlight.title),i.GoogleMaps="<a href="+r+' target="_blank">'+this.languageService.translate.instant("igo.geo.searchByCoord")+"</a> <br /> <a href="+s+' target="_blank">'+this.languageService.translate.instant("igo.geo.searchByName")+"</a>","Point"===t.geometry.type&&(i.GoogleStreetView=Uu.getGoogleStreetViewLink(t.geometry.coordinates[0],t.geometry.coordinates[1]));const n={Route:'<span class="routing"> <u>'+this.languageService.translate.instant("igo.geo.seeRouting")+"</u> </span>"};return Object.assign({type:t.index},o,i,n)}computeTerm(e){let t=!1;return t=(e.match(/(#[A-Za-z]+)/g)||[]).some(e=>{const t=e.substring(1);return this.hashtagsLieuxToKeep.some(e=>e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")===t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""))}),t||(e=e.replace(/(#[A-Za-z]+)/g,"")),e.replace(/[^\w\xc0-\xff !\-\+\(\)\.\/\xbd\xbc\xbe,'#]+/g,"")}computeOptionsParam(e,t){const o=super.getHashtagsValid(e,"type");return o&&(t.params=Object.assign(t.params||{},{type:o.join(",")})),t}}return e.id="icherche",e.type=Sl,e.propertiesBlacklist=[],e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(ne),r.LFG(ve),r.LFG("options"),r.LFG(Nv),r.LFG(r.zs3))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})(),jv=(()=>{class e extends Eu{constructor(e,t,o,i,r){super(i,o),this.http=e,this.languageService=t,this.title$=new C.X(""),this.languageService.translate.get(this.options.title).subscribe(e=>this.title$.next(e));const s=r.get($s);this.settings.length&&(s?s.authenticate$.subscribe(()=>{this.getAllowedTypes()}):this.getAllowedTypes())}get title(){return this.title$.getValue()}getId(){return e.id}getType(){return e.type}getDefaultOptions(){const e=this.options.params&&this.options.params.type?this.options.params.type.replace(/\s/g,"").toLowerCase().split(","):["adresses","municipalites","mrc","regadmin"];return{title:"igo.geo.search.ichercheReverse.name",searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/terrapi",settings:[{type:"checkbox",title:"results type",name:"type",values:[{title:"igo.geo.search.icherche.type.address",value:"adresses",enabled:-1!==e.indexOf("adresses")},{title:"igo.geo.search.icherche.type.road",value:"routes",enabled:-1!==e.indexOf("routes"),available:!1},{title:"igo.geo.search.icherche.type.district",value:"arrondissements",enabled:-1!==e.indexOf("arrondissements")},{title:"igo.geo.search.icherche.type.city",value:"municipalites",enabled:-1!==e.indexOf("municipalites")},{title:"igo.geo.search.icherche.type.mrc",value:"mrc",enabled:-1!==e.indexOf("mrc")},{title:"igo.geo.search.icherche.type.regadmin",value:"regadmin",enabled:-1!==e.indexOf("regadmin")}]},{type:"radiobutton",title:"radius",name:"bufferInput",values:[{title:"100 m",value:100,enabled:!this.options.distance||100===this.options.distance},{title:"500 m",value:500,enabled:500===this.options.distance},{title:"1 km",value:1e3,enabled:1e3===this.options.distance},{title:"2 km",value:2e3,enabled:2e3===this.options.distance},{title:"5 km",value:5e3,enabled:5e3===this.options.distance}]}]}}reverseSearch(e,t){const o=this.computeRequestParams(e,t||{});return o.get("type").length?this.http.get(`${this.searchUrl}/locate`,{params:o}).pipe((0,x.U)(e=>this.extractResults(e))):(0,A.of)([])}getAllowedTypes(){return this.http.get(`${this.searchUrl}/types`).subscribe(e=>{const t=this.settings.find(e=>"type"===e.name);t.values.forEach(t=>{t.available=e.indexOf(t.value)>-1}),this.setParamFromSetting(t,!1)})}computeRequestParams(e,t){return(t.distance||this.options.distance)&&(t.params=Object.assign(t.params||{},{bufferInput:t.distance||this.options.distance})),new y.LE({fromObject:Object.assign({loc:e.join(","),sort:"distance",geometry:!0,icon:!0},t.params||{},this.params)})}extractResults(e){return e.features.map(e=>this.dataToResult(e))}getSubtitle(e){if(!this.settings.length)return"";let t="";switch(e.properties.type){case"arrondissements":t=e.properties.municipalite+" (Arrondissement)";break;default:const o=this.settings.find(e=>"type"===e.name).values.find(t=>t.value===e.properties.type);o&&(t=this.languageService.translate.instant(o.title))}return t}dataToResult(e){const t=this.computeProperties(e),o=this.computeExtent(e),i=[this.getId(),t.type,t.code].join("."),r=e.properties.nom,s=" <small> "+this.getSubtitle(e)+"</small>";return{source:this,data:{type:Sl,projection:"EPSG:4326",geometry:e.geometry,extent:o,properties:t,meta:{id:i,title:e.properties.nom}},meta:{dataType:Sl,id:i,title:e.properties.nom,titleHtml:r+s,icon:e.icon||"map-marker"}}}computeProperties(t){const o=_.removeKeys(t.properties,e.propertiesBlacklist),i={Route:'<span class="routing"> <u>'+this.languageService.translate.instant("igo.geo.seeRouting")+"</u> </span>"};return Object.assign(o,i)}computeExtent(e){return e.bbox?[e.bbox[0],e.bbox[2],e.bbox[1],e.bbox[3]]:void 0}}return e.id="icherchereverse",e.type=Sl,e.propertiesBlacklist=[],e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(ne),r.LFG(ve),r.LFG("options"),r.LFG(r.zs3))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})();function Gv(e){return new Nv(e)}function Qv(e,t,o,i,r,s){return new Bv(e,t,o,i.getConfig(`searchSources.${Bv.id}`),r,s)}function zv(e,t,o,i,r){return new jv(e,t,o,i.getConfig(`searchSources.${jv.id}`),r)}let Yv=(()=>{class e{constructor(e){this.languageService=e}formatResult(e){return e}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(ne))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})(),Hv=(()=>{class e extends Eu{constructor(e,t,o,i){super(e,o),this.languageService=t,this.title$=new C.X(""),this.projections=i,this.languageService.translate.get(this.options.title).subscribe(e=>this.title$.next(e))}get title(){return this.title$.getValue()}getId(){return e.id}getType(){return e.type}getDefaultOptions(){return{title:"igo.geo.search.coordinates.name",order:1,showInSettings:!1}}reverseSearch(e,t){return(0,A.of)([this.dataToResult(e,t)])}dataToResult(e,t){const o=function(e,t=3){const o=[];return e.forEach(e=>{const i=e<0?Math.ceil(e):Math.floor(e),r=e<0?60*(i-e):60*(e-i),s=Math.floor(r),n=(60*(r-s)).toFixed(t);o.push(`${i}\xb0 ${s}' ${n}"`)}),o}(e),i=function(e,t){const o=Fn.vs(e,"EPSG:4326","EPSG:3857"),i=[{code:"EPSG:3857",alias:"Web Mercator",coord:o,igo2CoordFormat:`${lc(o).join(", ")} ; 3857`}],r=function(e){return Math.ceil((e[0]+180)/6)}(e),s=r<10?`EPSG:3260${r}`:`EPSG:326${r}`,n=`UTM-${r}`,a=Fn.vs(e,"EPSG:4326",s);i.push({code:s,alias:"UTM",coord:a,igo2CoordFormat:`${n} ${lc(a).join(", ")}`});const l=function(e){const t=e[0];let o;return t<-51&&t>-54&&(o=1),t<-54&&t>-57&&(o=2),t<-57&&t>-60&&(o=3),t<-60&&t>-63&&(o=4),t<-63&&t>-66&&(o=5),t<-66&&t>-69&&(o=6),t<-69&&t>-72&&(o=7),t<-72&&t>-75&&(o=8),t<-75&&t>-78&&(o=9),t<-78&&t>-81&&(o=10),o}(e);if(l){const t=l<10?`EPSG:3218${l}`:`EPSG:321${80+l}`,o=`MTM-${l}`,r=Fn.vs(e,"EPSG:4326",t);i.push({code:t,alias:"MTM",coord:r,igo2CoordFormat:`${o} ${lc(r).join(", ")}`})}return t.forEach(t=>{const o=Fn.vs(e,"EPSG:4326",t.code),r=t.code.split(":")[1];i.push({code:t.code,alias:t.alias||t.code,coord:o,igo2CoordFormat:`${lc(o).join(", ")} ; ${r}`})}),i}(e,this.projections).reduce((e,t)=>(e[t.alias]=t.igo2CoordFormat,e),{}),r=lc(e,6).join(", "),s=o.join(", ");let n={type:"Point",coordinates:[e[0],e[1]]};const a={};let l="";if(t.distance){a[this.languageService.translate.instant("igo.geo.search.coordinates.radius")]=t.distance,l="<br><small>Rayon: "+t.distance+" m</small>";const o=Fn.vs([e[0],e[1]],"EPSG:4326","EPSG:3857"),i=new Pn.Z(o,t.distance),r=(0,Gn.Bb)(i),s=new Yn.Z;n=JSON.parse(s.writeGeometry(r.transform("EPSG:3857","EPSG:4326")))}return t.conf&&(a[this.languageService.translate.instant("igo.geo.search.coordinates.conf")]=t.conf,l+=""===l?"<br>":"<small> - </small>",l+="<small>Confiance: "+t.conf+"%</small>"),a[this.languageService.translate.instant("igo.geo.search.coordinates.coord")]=r,a[this.languageService.translate.instant("igo.geo.search.coordinates.coordDMS")]=s,{source:this,data:{type:Sl,projection:"EPSG:4326",geometry:n,extent:void 0,properties:Object.assign(a,i,{GoogleMaps:Uu.getGoogleMapsCoordLink(e[0],e[1]),GoogleStreetView:Uu.getGoogleStreetViewLink(e[0],e[1]),OpenStreetMap:Nu.getOpenStreetMapLink(e[0],e[1],14),Route:'<span class="routing"> <u>'+this.languageService.translate.instant("igo.geo.seeRouting")+"</u> </span>"}),meta:{id:e[0].toString()+","+e[1].toString(),title:r}},meta:{dataType:Sl,id:e[0].toString()+","+e[1].toString(),title:r,titleHtml:r+l,icon:"map-marker",score:100}}}}return e.id="coordinatesreverse",e.type=Sl,e.\u0275fac=function(t){return new(t||e)(r.LFG("options"),r.LFG(ne),r.LFG(ve),r.LFG("projections"))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})();function Vv(e){return new Yv(e)}function Wv(e,t,o,i){return new Hv(e.getConfig(`searchSources.${Hv.id}`),t,o,e.getConfig("projections")||[])}let Xv=(()=>{class e{constructor(e){this.languageService=e}formatResult(e){const t=["title","abstract","groupTitle","metadataUrl","downloadUrl","urlInfo","name"],o=Object.entries(e.properties).filter(([e])=>-1!==t.indexOf(e)).reduce((e,t)=>{const[o,i]=t;let r;try{r=this.languageService.translate.instant("igo.geo.search.ilayer.properties."+o)}catch(s){r=o}return e[r]=i||"",e},{}),i=Object.assign({},e);return i.properties=o,i}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(ne))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})(),Kv=(()=>{class e extends Eu{constructor(e,t,o,i,r){super(i,o),this.http=e,this.languageService=t,this.formatter=r,this.title$=new C.X(""),this.languageService.translate.get(this.options.title).subscribe(e=>this.title$.next(e))}get title(){return this.title$.getValue()}getId(){return e.id}getType(){return e.type}getDefaultOptions(){const e=this.options.params&&this.options.params.limit?Number(this.options.params.limit):void 0,t=this.options.params&&this.options.params.ecmax?Number(this.options.params.ecmax):void 0;return{title:"igo.geo.search.ilayer.name",searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/layers/search",settings:[{type:"checkbox",title:"results type",name:"type",values:[{title:"igo.geo.search.ilayer.type.layer",value:"layer",enabled:!0,hashtags:["layer","layers","couche","couches"]},{title:"igo.geo.search.ilayer.type.groupLayer",value:"group",enabled:!1,hashtags:["gr-layer","gr-layers","gr-couche","gr-couches"]}]},{type:"radiobutton",title:"results limit",name:"limit",values:[{title:"1",value:1,enabled:1===e},{title:"5",value:5,enabled:5===e||!e},{title:"10",value:10,enabled:10===e},{title:"25",value:25,enabled:25===e},{title:"50",value:50,enabled:50===e}]},{type:"radiobutton",title:"ecmax",name:"ecmax",values:[{title:"10 %",value:10,enabled:10===t},{title:"30 %",value:30,enabled:30===t},{title:"50 %",value:50,enabled:50===t||!t},{title:"75 %",value:75,enabled:75===t},{title:"100 %",value:100,enabled:100===t}]}]}}search(e,t){const o=this.computeSearchRequestParams(e,t||{});return o.get("q")&&o.get("type")?(this.options.params.page=o.get("page")||"1",this.http.get(this.searchUrl,{params:o}).pipe((0,x.U)(t=>this.extractResults(t,e)))):(0,A.of)([])}computeSearchRequestParams(e,t){return new y.LE({fromObject:_.removeUndefined(Object.assign({q:this.computeTerm(e)},this.params,this.computeOptionsParam(e,t||{}).params,{page:t.page}))})}computeTerm(e){return e.replace(/(#[^\s]*)/g,"").replace(/[^\w\xc0-\xff !\-\(\),'#]+/g,"")}computeOptionsParam(e,t){const o=super.getHashtagsValid(e,"type");return o&&(t.params=Object.assign(t.params||{},{type:o.join(",")})),t}extractResults(e,t){return e.items.map(o=>this.dataToResult(o,t,e))}dataToResult(e,t,o){const i=this.computeLayerOptions(e),r=e.highlight.title||e.properties.title,s=e.highlight.groupTitle||e.properties.groupTitle,n=s?' <small style="color: #6f6969"> '+s+"</small>":"";return{source:this,meta:{dataType:Rh,id:[this.getId(),e.properties.id].join("."),title:e.properties.title,titleHtml:r+n,icon:"Layer"===e.properties.type?"layers":"map",score:e.score||vv(t.trim(),e.properties.name),nextPage:o.items.length%+this.options.params.limit==0&&+this.options.params.page<10},data:i}}computeLayerOptions(e){const t=e.properties.url,o=this.extractQueryParamsFromSourceUrl(t);return _.removeUndefined({sourceOptions:{id:e.properties.id,type:e.properties.format,url:t,queryFormat:o.queryFormat,queryHtmlTarget:o.queryHtmlTarget,params:"wms"===e.properties.format?{LAYERS:e.properties.name}:void 0,layer:"wms"===e.properties.format?void 0:e.properties.name,optionsFromCapabilities:!0,crossOrigin:"anonymous"},title:e.properties.title,maxResolution:nc(Number(e.properties.maxScaleDenom)),minResolution:nc(Number(e.properties.minScaleDenom)),metadata:{url:e.properties.metadataUrl,extern:!!e.properties.metadataUrl||void 0,abstract:e.properties.abstract||void 0},properties:this.formatter.formatResult(e).properties})}extractQueryParamsFromSourceUrl(e){let t,o;const i=this.options.queryFormat;if(i){for(const o of Object.keys(i)){const r=i[o];if("*"===r){t=Nl[o.toUpperCase()];break}const s=r.urls;if(Array.isArray(s)){s.forEach(i=>{-1!==e.indexOf(i)&&(t=Nl[o.toUpperCase()])});break}}(t===Nl.HTML||t===Nl.HTMLGML2)&&(o="iframe")}return{queryFormat:t,queryHtmlTarget:o}}}return e.id="ilayer",e.type=Rh,e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(ne),r.LFG(ve),r.LFG("options"),r.LFG(Xv))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})();function eb(e){return new Xv(e)}function tb(e,t,o,i,r){return new Kv(e,t,o,i.getConfig(`searchSources.${Kv.id}`),r)}const ob=[Sl,Rh];function ib(e,t){if(1&e&&(r.TgZ(0,"mat-radio-button",7),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=t.$implicit,o=r.oxw();r.Q6J("value",e),r.xp6(1),r.hij(" ",r.lcZ(2,2,o.getSearchTypeTitle(e))," ")}}let rb=(()=>{class e{constructor(e){this.searchSourceService=e,this.searchType$=new C.X(void 0),this.searchTypes=ob,this.searchTypeChange=new r.vpe}set searchType(e){this.setSearchType(e)}get searchType(){return this.searchType$.value}ngOnInit(){this.searchType$$=this.searchType$.pipe((0,M.x)()).subscribe(e=>this.onSetSearchType(e))}ngOnDestroy(){this.searchType$$.unsubscribe()}onSearchTypeChange(e){this.setSearchType(e)}getSearchTypeTitle(e){return`igo.geo.search.${e.toLowerCase()}.title`}setSearchType(e){this.searchType$.next(e)}onSetSearchType(e){null!=e&&(this.searchSourceService.enableSourcesByType(e),this.searchTypeChange.emit(e))}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(bv))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-search-selector"]],inputs:{searchTypes:"searchTypes",searchType:"searchType"},outputs:{searchTypeChange:"searchTypeChange"},decls:9,vars:8,consts:[[1,"igo-search-selector"],["mat-icon-button","","color","primary","tooltip-position","below","matTooltipShowDelay","500",1,"igo-search-selector-button",3,"matTooltip","matMenuTriggerFor"],["svgIcon","menu-down"],["xPosition","before","yPosition","above",1,"no-border-radius"],["searchSelectorMenu","matMenu"],[1,"igo-search-selector-radio-group",3,"value","change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){if(1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"button",1),r.ALo(2,"translate"),r._UZ(3,"mat-icon",2),r.qZA(),r.TgZ(4,"mat-menu",3,4),r.TgZ(6,"mat-radio-group",5),r.NdJ("change",function(e){return t.onSearchTypeChange(e.value)}),r.ALo(7,"async"),r.YNc(8,ib,3,4,"mat-radio-button",6),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.MAs(5);r.xp6(1),r.Q6J("matTooltip",r.lcZ(2,4,"igo.geo.search.menu.tooltip"))("matMenuTriggerFor",e),r.xp6(5),r.Q6J("value",r.lcZ(7,6,t.searchType$)),r.xp6(2),r.Q6J("ngForOf",t.searchTypes)}},directives:[n.lW,p.gM,f.p6,a.Hw,f.VK,rl.VQ,h.sg,rl.U0],pipes:[U.X$,h.Ov],styles:[".igo-search-selector-button[_ngcontent-%COMP%]     div.mat-button-ripple-round{border-radius:0}.igo-search-selector-radio-group[_ngcontent-%COMP%]{display:inline-flex;flex-direction:column}.igo-search-selector-radio-group[_ngcontent-%COMP%]   mat-radio-button[_ngcontent-%COMP%]{margin:5px}"],changeDetection:0}),e})(),sb=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,p.AV,a.Ps,n.ot,f.Tx,rl.Fk,sl.Nh,m.p9,oe]]}),e})();function nb(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",8),r.TgZ(1,"button",9),r.NdJ("click",function(t){return r.CHM(e),r.oxw().checkUncheckAllSources(t)}),r._uU(2),r.ALo(3,"translate"),r.ALo(4,"translate"),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(2),r.Oqu(e.searchSourcesAllEnabled?r.lcZ(4,3,"igo.geo.search.searchSources.selectAll"):r.lcZ(3,1,"igo.geo.search.searchSources.unselectAll"))}}function ab(e,t){if(1&e&&(r.TgZ(0,"button",15),r._uU(1),r.qZA()),2&e){const e=r.oxw().$implicit,t=r.MAs(6);r.Q6J("matMenuTriggerFor",t),r.xp6(1),r.hij("",e.title," ")}}function lb(e,t){if(1&e&&(r.TgZ(0,"button",16),r._uU(1),r.qZA()),2&e){const e=r.oxw().$implicit;r.xp6(1),r.hij(" ",e.title," ")}}function cb(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-radio-button",22),r.NdJ("click",function(e){return e.stopPropagation()})("change",function(t){const o=r.CHM(e).$implicit,i=r.oxw(2).$implicit,s=r.oxw().$implicit;return r.oxw().settingsValueCheckedRadioButton(t,s,i,o)}),r._uU(1),r.ALo(2,"translate"),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(4);r.Q6J("value",e)("matTooltip",o.getAvailableHashtagsValues(e))("checked",e.enabled),r.xp6(1),r.hij(" ",r.lcZ(2,4,e.title)," ")}}function ub(e,t){if(1&e&&(r.TgZ(0,"span"),r.TgZ(1,"mat-radio-group",20),r.YNc(2,cb,3,6,"mat-radio-button",21),r.qZA(),r.qZA()),2&e){const e=r.oxw().$implicit;r.xp6(1),r.Q6J("value",e),r.xp6(1),r.Q6J("ngForOf",e.values)}}function pb(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",8),r.TgZ(1,"button",9),r.NdJ("click",function(t){r.CHM(e);const o=r.oxw(2).$implicit,i=r.oxw().$implicit;return r.oxw().checkUncheckAll(t,i,o)}),r._uU(2),r.ALo(3,"translate"),r.ALo(4,"translate"),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(2).$implicit;r.xp6(2),r.Oqu(e.allEnabled||void 0===e.allEnabled?r.lcZ(3,1,"igo.geo.search.searchSources.settings.unselectAll"):r.lcZ(4,3,"igo.geo.search.searchSources.settings.selectAll"))}}function db(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-checkbox",24),r.NdJ("click",function(e){return e.stopPropagation()})("change",function(t){const o=r.CHM(e).$implicit,i=r.oxw(2).$implicit,s=r.oxw().$implicit;return r.oxw().settingsValueCheckedCheckbox(t,s,i,o)}),r._uU(1),r.ALo(2,"translate"),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(2).$implicit,i=r.oxw(2);r.Udp("display",i.displayBlock),r.Q6J("checked",e.enabled)("value",o)("matTooltip",i.getAvailableHashtagsValues(e)),r.xp6(1),r.hij(" ",r.lcZ(2,6,e.title)," ")}}function hb(e,t){if(1&e&&(r.TgZ(0,"span"),r.YNc(1,pb,5,5,"div",5),r.YNc(2,db,3,8,"mat-checkbox",23),r.qZA()),2&e){const e=r.oxw().$implicit,t=r.oxw(2);r.xp6(1),r.Q6J("ngIf",e.values.length>3),r.xp6(1),r.Q6J("ngForOf",t.getAvailableValues(e))}}function gb(e,t){if(1&e&&(r.ynx(0),r.TgZ(1,"button",15),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"mat-menu",17,18),r.YNc(6,ub,3,2,"span",19),r.YNc(7,hb,3,2,"span",19),r.qZA(),r.BQk()),2&e){const e=t.$implicit,o=r.MAs(5);r.xp6(1),r.Q6J("matMenuTriggerFor",o),r.xp6(1),r.hij(" ",r.lcZ(3,5,"igo.geo.search.searchSources.settings."+e.title)," "),r.xp6(2),r.Q6J("ngSwitch",e.type),r.xp6(2),r.Q6J("ngSwitchCase","radiobutton"),r.xp6(1),r.Q6J("ngSwitchCase","checkbox")}}function mb(e,t){if(1&e){const e=r.EpF();r.ynx(0),r.TgZ(1,"span",10),r.TgZ(2,"mat-checkbox",11),r.NdJ("click",function(e){return e.stopPropagation()})("change",function(t){const o=r.CHM(e).$implicit;return r.oxw().onCheckSearchSource(t,o)}),r.qZA(),r.YNc(3,ab,2,2,"button",12),r.YNc(4,lb,2,1,"button",13),r.qZA(),r.TgZ(5,"mat-menu",null,14),r.YNc(7,gb,8,7,"ng-container",6),r.qZA(),r.BQk()}if(2&e){const e=t.$implicit;r.xp6(2),r.Q6J("checked",e.enabled)("value",e),r.xp6(1),r.Q6J("ngIf",e.settings.length>0),r.xp6(1),r.Q6J("ngIf",0===e.settings.length),r.xp6(3),r.Q6J("ngForOf",e.settings)}}function fb(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"span"),r._UZ(1,"mat-divider"),r.TgZ(2,"span",25),r.TgZ(3,"mat-slide-toggle",26),r.NdJ("change",function(t){return r.CHM(e),r.oxw().changePointerReverseSearch(t)})("click",function(e){return e.stopPropagation()}),r.ALo(4,"translate"),r._uU(5),r.ALo(6,"translate"),r.qZA(),r.TgZ(7,"mat-slide-toggle",26),r.NdJ("change",function(t){return r.CHM(e),r.oxw().changeSearchResultsGeometry(t)})("click",function(e){return e.stopPropagation()}),r.ALo(8,"translate"),r._uU(9),r.ALo(10,"translate"),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(3),r.Q6J("matTooltip",r.lcZ(4,8,"igo.geo.search.pointerSearchSummary.tooltip"))("checked",e.pointerSummaryEnabled)("labelPosition","after"),r.xp6(2),r.hij(" ",r.lcZ(6,10,"igo.geo.search.pointerSearchSummary.title")," "),r.xp6(2),r.Q6J("matTooltip",r.lcZ(8,12,"igo.geo.search.searchResultsGeometry.tooltip"))("checked",e.searchResultsGeometryEnabled)("labelPosition","after"),r.xp6(2),r.hij(" ",r.lcZ(10,14,"igo.geo.search.searchResultsGeometry.title")," ")}}let yb=(()=>{class e{constructor(e,t,o){this.searchSourceService=e,this.mediaService=t,this.storageService=o,this.hasPointerReverseSearchSource=!1,this.searchSourcesAllEnabled=!1,this.buffer=[],this.lastKeyTime=Date.now(),this.displayBlock="block",this.pointerSummaryEnabled=!1,this.searchResultsGeometryEnabled=!1,this.searchSourceChange=new r.vpe,this.pointerSummaryStatus=new r.vpe,this.searchResultsGeometryStatus=new r.vpe}get isTouchScreen(){return this.mediaService.isTouchScreen()}handleKeyboardEvent(e){"F2"===e.key&&(this.pointerSummaryEnabled=!this.pointerSummaryEnabled,this.pointerSummaryStatus.emit(this.pointerSummaryEnabled))}ngOnInit(){this.hasPointerReverseSearchSource=this.hasReverseSearchSourcesForPointerSummary()}getSearchSources(){const e=this.searchSourceService.getSources().filter(gv).filter(e=>e.available&&"map"!==e.getId()&&e.showInSettings),t=this.searchSourceService.getSources().filter(mv).filter(e=>e.available&&"map"!==e.getId()&&e.showInSettings),o=e.concat(t);return this.computeSourcesCheckAllBehavior(o),o}hasReverseSearchSourcesForPointerSummary(){return!!this.searchSourceService.getEnabledSources().filter(fv).length}settingsValueCheckedCheckbox(e,t,o,i){i.enabled=e.checked,t.setParamFromSetting(o),this.searchSourceChange.emit(t)}computeSettingCheckAllBehavior(e){e.allEnabled=void 0===e.allEnabled?!e.values.find(e=>e.enabled):!e.allEnabled}computeSourcesCheckAllBehavior(e){const t=e.filter(e=>e.enabled).length,o=e.filter(e=>!e.enabled).length;this.searchSourcesAllEnabled=!(t>=o)}checkUncheckAll(e,t,o){e.stopPropagation(),this.computeSettingCheckAllBehavior(o),o.values.forEach(e=>{e.enabled=o.allEnabled}),t.setParamFromSetting(o),this.searchSourceChange.emit(t)}checkUncheckAllSources(e){e.stopPropagation(),this.getSearchSources().map(e=>{e.enabled=this.searchSourcesAllEnabled,this.searchSourceChange.emit(e)})}settingsValueCheckedRadioButton(e,t,o,i){o.values.forEach(t=>{t.enabled=t.value!==i.value?!e.source.checked:e.source.checked}),t.setParamFromSetting(o),this.searchSourceChange.emit(t)}onCheckSearchSource(e,t){t.enabled=e.checked;const o=this.storageService.get(t.getId()+".options")||{};o.enabled=t.enabled,this.storageService.set(t.getId()+".options",o),this.searchSourceChange.emit(t)}getAvailableValues(e){return e.values.filter(e=>!1!==e.available)}getAvailableHashtagsValues(e){if(e.hashtags)return e.hashtags.map(e=>"#"+e).join(", ")}stopPropagation(e){e.stopPropagation()}changePointerReverseSearch(e){this.pointerSummaryEnabled=e.checked,this.pointerSummaryStatus.emit(this.pointerSummaryEnabled)}changeSearchResultsGeometry(e){this.searchResultsGeometryEnabled=e.checked,this.searchResultsGeometryStatus.emit(this.searchResultsGeometryEnabled)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(bv),r.Y36(me),r.Y36(ve))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-search-settings"]],hostBindings:function(e,t){1&e&&r.NdJ("keydown",function(e){return t.handleKeyboardEvent(e)},!1,r.evT)},inputs:{pointerSummaryEnabled:"pointerSummaryEnabled",searchResultsGeometryEnabled:"searchResultsGeometryEnabled"},outputs:{searchSourceChange:"searchSourceChange",pointerSummaryStatus:"pointerSummaryStatus",searchResultsGeometryStatus:"searchResultsGeometryStatus"},decls:9,vars:7,consts:[[1,"igo-search-settings"],["mat-icon-button","","color","primary","tooltip-position","below","matTooltipShowDelay","500",1,"igo-search-settings-button",3,"matTooltip","matMenuTriggerFor"],["svgIcon","chevron-down"],[1,"no-border-radius"],["searchSettingsMenu","matMenu"],["class","checkAllButton",4,"ngIf"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"checkAllButton"],["mat-raised-button","",3,"click"],[1,"igo-search-settings-search-source"],[1,"igo-search-settings-checkbox",3,"checked","value","click","change"],["mat-menu-item","",3,"matMenuTriggerFor",4,"ngIf"],["mat-menu-item","",4,"ngIf"],["sub_menu","matMenu"],["mat-menu-item","",3,"matMenuTriggerFor"],["mat-menu-item",""],["yPosition","above",3,"ngSwitch"],["test_sub_menu","matMenu"],[4,"ngSwitchCase"],[1,"igo-search-settings-radio-group",3,"value"],["class","mat-typography",3,"value","matTooltip","checked","click","change",4,"ngFor","ngForOf"],[1,"mat-typography",3,"value","matTooltip","checked","click","change"],["class","mat-menu-item",3,"display","checked","value","matTooltip","click","change",4,"ngFor","ngForOf"],[1,"mat-menu-item",3,"checked","value","matTooltip","click","change"],[1,"pointer-summary-slide-toggle-container","mat-typography"],["tooltip-position","below","matTooltipShowDelay","500",1,"pointer-summary-option",3,"matTooltip","checked","labelPosition","change","click"]],template:function(e,t){if(1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"button",1),r.ALo(2,"translate"),r._UZ(3,"mat-icon",2),r.qZA(),r.TgZ(4,"mat-menu",3,4),r.YNc(6,nb,5,5,"div",5),r.YNc(7,mb,8,5,"ng-container",6),r.YNc(8,fb,11,16,"span",7),r.qZA(),r.qZA()),2&e){const e=r.MAs(5);r.xp6(1),r.Q6J("matTooltip",r.lcZ(2,5,"igo.geo.search.menu.tooltip"))("matMenuTriggerFor",e),r.xp6(5),r.Q6J("ngIf",t.getSearchSources().length>4),r.xp6(1),r.Q6J("ngForOf",t.getSearchSources()),r.xp6(1),r.Q6J("ngIf",t.hasPointerReverseSearchSource&&!t.isTouchScreen)}},directives:[n.lW,p.gM,f.p6,a.Hw,f.VK,h.O5,h.sg,m.oG,f.OP,h.RF,h.n9,rl.VQ,rl.U0,Ga.d,Qa.Rr],pipes:[U.X$],styles:[".checkAllButton[_ngcontent-%COMP%]{text-align:center;padding:0 5px}.igo-search-settings-button[_ngcontent-%COMP%]     div.mat-button-ripple-round{border-radius:0}.igo-search-settings-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.igo-search-settings-radio-group[_ngcontent-%COMP%]   mat-radio-button[_ngcontent-%COMP%]{margin:5px}.igo-search-settings-checkbox[_ngcontent-%COMP%]   mat-radio-button[_ngcontent-%COMP%]{display:flex}.igo-search-settings-search-source[_ngcontent-%COMP%]{display:flex;width:100%}.igo-search-settings-search-source[_ngcontent-%COMP%]   mat-checkbox[_ngcontent-%COMP%]{display:flex;margin-left:5px;margin-right:5px}.pointer-summary-option[_ngcontent-%COMP%]{display:block;margin-right:10px;margin-bottom:15px}.pointer-summary-slide-toggle-container[_ngcontent-%COMP%]{overflow-x:hidden}.pointer-summary-slide-toggle-container[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{margin:10px}"],changeDetection:0}),e})(),vb=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,p.AV,a.Ps,n.ot,f.Tx,rl.Fk,m.p9,Ga.t,Qa.rP,oe]]}),e})();const bb=["input"];function xb(e,t){if(1&e&&(r.TgZ(0,"mat-label"),r._uU(1),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Oqu(e.label)}}function wb(e,t){if(1&e&&(r.TgZ(0,"button",10),r._UZ(1,"mat-icon",11),r.qZA()),2&e){const e=r.oxw();r.Q6J("color",e.color),r.xp6(1),r.s9C("svgIcon",e.searchIcon)}}function Sb(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",12),r.NdJ("click",function(){return r.CHM(e),r.oxw().onClearButtonClick()}),r._UZ(1,"mat-icon",13),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("color",e.color)}}function Cb(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-search-selector",14),r.NdJ("searchTypeChange",function(t){return r.CHM(e),r.oxw().onSearchTypeChange(t)}),r.ALo(1,"async"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("searchTypes",e.searchTypes)("searchType",r.lcZ(1,2,e.searchType$))}}function Tb(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-search-settings",15),r.NdJ("pointerSummaryStatus",function(t){return r.CHM(e),r.oxw().pointerSummaryStatus.emit(t)})("searchResultsGeometryStatus",function(t){return r.CHM(e),r.oxw().searchResultsGeometryStatus.emit(t)})("searchSourceChange",function(){return r.CHM(e),r.oxw().onSearchSettingsChange()}),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("pointerSummaryEnabled",e.pointerSummaryEnabled)("searchResultsGeometryEnabled",e.searchResultsGeometryEnabled)}}const Ab=function(e){return{empty:e}},Zb=function(e){return{hasSearchIcon:e}};let Lb=(()=>{class e{constructor(e,t,o){this.languageService=e,this.searchService=t,this.searchSourceService=o,this.placeholder$=new C.X("igo.geo.search.placeholder"),this.empty$=new C.X(!0),this.stream$=new C.X(""),this.searchTypes=ob,this.searchType$=new C.X(void 0),this.pointerSummaryStatus=new r.vpe,this.searchResultsGeometryStatus=new r.vpe,this.term$=new C.X(""),this.disabled$=new C.X(!1),this.pointerSummaryEnabled=!1,this.searchResultsGeometryEnabled=!1,this.floatLabel="never",this.appearance="legacy",this.color="primary",this.termSplitter="|",this.debounce=200,this.minLength=2,this.searchSelector=!1,this.searchSettings=!1,this.forceNA=!1,this.searchTermChange=new r.vpe,this.search=new r.vpe,this.searchTypeChange=new r.vpe,this.clearFeature=new r.vpe,this.searchSettingsChange=new r.vpe}set searchType(e){this.setSearchType(e)}get searchType(){return this.searchType$.value}set term(e){this.setTerm(e)}get term(){return this.term$.value}set disabled(e){this.disabled$.next(e)}get disabled(){return this.disabled$.value}get empty(){return 0===this.term.length}ngOnInit(){this.term$$=this.term$.subscribe(e=>{this.empty$.next(void 0===e||0===e.length)}),this.stream$$=this.stream$.pipe((0,wn.D)(e=>""===e?fn.E:(0,yn.H)(this.debounce))).subscribe(e=>this.onSetTerm(e)),this.handlePlaceholder(),this.searchType$$=this.searchType$.pipe((0,M.x)()).subscribe(e=>this.onSetSearchType(e))}ngOnDestroy(){this.term$$.unsubscribe(),this.stream$$.unsubscribe(),this.searchType$$.unsubscribe()}onKeyup(e){this.keyIsValid(e.key)&&this.setTerm(e.target.value)}onClearButtonClick(){this.clear(),this.clearFeature.emit()}onSearchTypeChange(e){this.setSearchType(e)}setSearchType(e){this.searchType$.next(e)}onSearchSettingsChange(){this.doSearch(this.term),this.searchSettingsChange.emit(),this.handlePlaceholder()}setTerm(e){if(this.disabled)return;(e=e||"")!==this.term&&this.term$.next(e);const t=e.replace(/(#[^\s]*)/g,"").trim();(t.length>=this.minLength||0===t.length)&&this.stream$.next(e)}clear(){this.term$.next(""),this.stream$.next(""),this.input.nativeElement.focus()}keyIsValid(t){return-1===e.invalidKeys.indexOf(t)}onSetTerm(e){this.searchTermChange.emit(e),this.doSearch(e)}handlePlaceholder(){const e=[...new Set(this.searchSourceService.getEnabledSources().filter(e=>!["map","coordinatesreverse"].includes(e.getId())).map(e=>e.getType()))];let t="igo.geo.search.placeholder";1===e.length?t=`igo.geo.search.${e[0].toLowerCase()}.placeholder`:0===e.length&&(t="igo.geo.search.emptyType.placeholder"),this.placeholder$.next(t)}onSetSearchType(e){if(null==e)return;this.searchTypeChange.emit(e);const t=`igo.geo.search.${e.toLowerCase()}.placeholder`;this.placeholder$.next(t),this.setTerm(this.term)}doSearch(e){let t;this.researches$$&&(this.researches$$.map(e=>e.unsubscribe()),this.researches$$=void 0),this.termSplitter&&e.match(new RegExp(this.termSplitter,"g"))?(t=e.split(this.termSplitter).filter(e=>e.length>=this.minLength),this.store.clear()):t=[e];let o=[];t.map(e=>{""!==(e?e.replace(/(#[^\s]*)/g,"").trim():"")?o=o.concat(this.searchService.search(e,{forceNA:this.forceNA})):void 0!==this.store&&this.store.clear()}),this.researches$$=o.map(e=>e.request.subscribe(t=>{this.onResearchCompleted(e,t)}))}onResearchCompleted(e,t){if(this.search.emit({research:e,results:t}),void 0!==this.store){const o=this.store.all().filter(t=>t.source!==e.source).concat(t);this.store.updateMany(o)}}}return e.invalidKeys=["Control","Shift","Alt","ArrowDown","ArrowUp","ArrowRight","ArrowLeft"],e.\u0275fac=function(t){return new(t||e)(r.Y36(ne),r.Y36(xv),r.Y36(bv))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-search-bar"]],viewQuery:function(e,t){if(1&e&&r.Gf(bb,7),2&e){let e;r.iGM(e=r.CRH())&&(t.input=e.first)}},inputs:{searchTypes:"searchTypes",searchType:"searchType",term:"term",disabled:"disabled",pointerSummaryEnabled:"pointerSummaryEnabled",searchResultsGeometryEnabled:"searchResultsGeometryEnabled",floatLabel:"floatLabel",appearance:"appearance",placeholder:"placeholder",label:"label",color:"color",termSplitter:"termSplitter",debounce:"debounce",minLength:"minLength",searchIcon:"searchIcon",searchSelector:"searchSelector",searchSettings:"searchSettings",forceNA:"forceNA",store:"store"},outputs:{pointerSummaryStatus:"pointerSummaryStatus",searchResultsGeometryStatus:"searchResultsGeometryStatus",searchTermChange:"searchTermChange",search:"search",searchTypeChange:"searchTypeChange",clearFeature:"clearFeature",searchSettingsChange:"searchSettingsChange"},decls:16,vars:28,consts:[[1,"igo-search-bar-container",3,"ngClass"],[3,"floatLabel","appearance"],[4,"ngIf"],["matInput","","autocomplete","off",3,"ngClass","disabled","placeholder","value","keyup","touchend"],["input",""],[1,"search-bar-buttons"],["mat-icon-button","",3,"color",4,"ngIf"],["mat-icon-button","",3,"color","click",4,"ngIf"],[3,"searchTypes","searchType","searchTypeChange",4,"ngIf"],[3,"pointerSummaryEnabled","searchResultsGeometryEnabled","pointerSummaryStatus","searchResultsGeometryStatus","searchSourceChange",4,"ngIf"],["mat-icon-button","",3,"color"],[3,"svgIcon"],["mat-icon-button","",3,"color","click"],["svgIcon","close"],[3,"searchTypes","searchType","searchTypeChange"],[3,"pointerSummaryEnabled","searchResultsGeometryEnabled","pointerSummaryStatus","searchResultsGeometryStatus","searchSourceChange"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.ALo(1,"async"),r.TgZ(2,"mat-form-field",1),r.YNc(3,xb,2,1,"mat-label",2),r.TgZ(4,"input",3,4),r.NdJ("keyup",function(e){return t.onKeyup(e)})("touchend",function(e){return t.onKeyup(e)}),r.ALo(6,"async"),r.ALo(7,"async"),r.ALo(8,"translate"),r.ALo(9,"async"),r.qZA(),r.qZA(),r.TgZ(10,"div",5),r.YNc(11,wb,2,2,"button",6),r.YNc(12,Sb,2,1,"button",7),r.ALo(13,"async"),r.YNc(14,Cb,2,4,"igo-search-selector",8),r.YNc(15,Tb,1,2,"igo-search-settings",9),r.qZA(),r.qZA()),2&e&&(r.Q6J("ngClass",r.VKq(24,Ab,r.lcZ(1,12,t.empty$))),r.xp6(2),r.Q6J("floatLabel",t.floatLabel)("appearance",t.appearance),r.xp6(1),r.Q6J("ngIf",t.label),r.xp6(1),r.Q6J("ngClass",r.VKq(26,Zb,t.searchIcon))("disabled",r.lcZ(6,14,t.disabled$))("placeholder",t.placeholder?t.placeholder:r.lcZ(7,16,t.placeholder$)?r.lcZ(8,18,t.placeholder$.value):void 0)("value",r.lcZ(9,20,t.term$)),r.xp6(7),r.Q6J("ngIf",void 0!==t.searchIcon),r.xp6(1),r.Q6J("ngIf",!r.lcZ(13,22,t.empty$)),r.xp6(2),r.Q6J("ngIf",t.searchSelector),r.xp6(1),r.Q6J("ngIf",t.searchSettings))},directives:[h.mk,Pe.KE,h.O5,Qe.Nt,Pe.hX,n.lW,a.Hw,rb,yb],pipes:[h.Ov,U.X$],styles:['[_nghost-%COMP%]     .mat-form-field{padding:0 5px}[_nghost-%COMP%]     .mat-form-field-wrapper{margin-bottom:-1.5em}[_nghost-%COMP%]     span.mat-form-field-label-wrapper{top:-20px}[_nghost-%COMP%]     div.mat-form-field-infix{left:5px;right:5px;padding:0 0 12px!important}[_nghost-%COMP%]     div.mat-form-field-underline{display:none}.igo-search-bar-container[_ngcontent-%COMP%]{position:relative;width:100%;display:inline-flex;overflow:hidden}.igo-search-bar-container[_ngcontent-%COMP%] > mat-form-field[_ngcontent-%COMP%]{width:calc(100% - (2 * 40px))}.igo-search-bar-container.empty[_ngcontent-%COMP%] > mat-form-field[_ngcontent-%COMP%]{width:calc(100% - 40px)}.search-bar-buttons[_ngcontent-%COMP%]{position:relative;right:0px;display:inline-flex;top:0}.search-bar-buttons[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]:nth-child(2):before{content:"";left:0px;top:5px;border-right:1px solid #ddd;height:28px}igo-search-selector[_ngcontent-%COMP%]{background-color:#fff;top:0;border-radius:0}igo-search-settings[_ngcontent-%COMP%]{background-color:#fff;top:0;border-radius:0}'],changeDetection:0}),e})(),Fb=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,ze.u5,p.AV,a.Ps,n.ot,f.Tx,rl.Fk,Pe.lN,Qe.c,oe,sb,vb]]}),e})();function Ob(e,t){if(1&e&&r._UZ(0,"mat-icon",4),2&e){const e=r.oxw();r.s9C("svgIcon",e.showIcons?e.icon:"blank")}}function Mb(e,t){if(1&e&&r._UZ(0,"h4",5),2&e){const e=r.oxw();r.Q6J("innerHtml",e.titleHtml,r.oJD)("matTooltip",e.tooltipHtml)}}function Ib(e,t){if(1&e&&(r.TgZ(0,"h4",6),r._uU(1),r.qZA()),2&e){const e=r.oxw();r.Q6J("matTooltip",e.title),r.xp6(1),r.Oqu(e.title)}}function kb(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",7),r.NdJ("click",function(){return r.CHM(e),r.oxw().onZoomHandler()}),r._UZ(1,"mat-icon",8),r.qZA()}}const Pb=[[["","igoSearchItemToolbar",""]]],_b=["[igoSearchItemToolbar]"];let $b=(()=>{class e{constructor(){this.withZoomButton=!1,this.zoomEvent=new r.vpe,this.format=new Yn.Z}get title(){return rt(this.result)}get titleHtml(){return function(e){const t=e.meta||{};return t.titleHtml?t.titleHtml:ot(e,t.titleHtmlProperty||"titleHtml")}(this.result)}get tooltipHtml(){return this.titleHtml.replace(/<small?[^>]+(>|$)/g,"\n").replace(/<\/?[^>]+(>|$)/g,"")}get icon(){return st(this.result)}onZoomHandler(){const e=this.format.readFeature(this.result.data,{dataProjection:this.result.data.projection,featureProjection:this.map.projection});qc(this.map,[e],Cl.Default)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-search-results-item"]],inputs:{result:"result",map:"map",showIcons:"showIcons",withZoomButton:"withZoomButton"},outputs:{zoomEvent:"zoomEvent"},ngContentSelectors:_b,decls:6,vars:4,consts:[["mat-list-avatar","",3,"svgIcon",4,"ngIf"],["matLine","","matTooltipShowDelay","500","matTooltipClass","search-result-tooltip",3,"innerHtml","matTooltip",4,"ngIf"],["matLine","","matTooltipShowDelay","500",3,"matTooltip",4,"ngIf"],["igoStopPropagation","","mat-icon-button","",3,"click",4,"ngIf"],["mat-list-avatar","",3,"svgIcon"],["matLine","","matTooltipShowDelay","500","matTooltipClass","search-result-tooltip",3,"innerHtml","matTooltip"],["matLine","","matTooltipShowDelay","500",3,"matTooltip"],["igoStopPropagation","","mat-icon-button","",3,"click"],["svgIcon","magnify"]],template:function(e,t){1&e&&(r.F$t(Pb),r.TgZ(0,"mat-list-item"),r.YNc(1,Ob,1,1,"mat-icon",0),r.YNc(2,Mb,1,2,"h4",1),r.YNc(3,Ib,2,2,"h4",2),r.YNc(4,kb,2,0,"button",3),r.Hsn(5),r.qZA()),2&e&&(r.xp6(1),r.Q6J("ngIf",t.icon),r.xp6(1),r.Q6J("ngIf",t.titleHtml),r.xp6(1),r.Q6J("ngIf",!t.titleHtml),r.xp6(1),r.Q6J("ngIf",t.withZoomButton))},directives:[l.Tg,h.O5,a.Hw,l.eA,$e.X2,p.gM,n.lW,yt],styles:["[_nghost-%COMP%]     small{color:#8c8c8c}  .search-result-tooltip{white-space:pre-line}"],changeDetection:0}),e})();const qb=["igoSearchItemToolbar"];function Db(e,t){1&e&&r.GkF(0)}const Eb=function(e){return{results:e}};function Rb(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-collapsible",6),r.NdJ("toggle",function(t){r.CHM(e);const o=r.oxw().$implicit;return r.oxw().collapsed[o.source.title]=t}),r.YNc(1,Db,1,0,"ng-container",7),r.qZA()}if(2&e){const e=r.oxw().$implicit,t=r.MAs(4),o=r.oxw();r.Tol(e.source.getId()),r.Q6J("title",o.computeGroupTitle(e))("collapsed",o.collapsed[e.source.title]),r.xp6(1),r.Q6J("ngTemplateOutlet",t)("ngTemplateOutletContext",r.VKq(6,Eb,e.results))}}function Ub(e,t){1&e&&r.GkF(0)}function Nb(e,t){if(1&e&&r.YNc(0,Ub,1,0,"ng-container",7),2&e){const e=r.oxw().$implicit,t=r.MAs(4);r.Q6J("ngTemplateOutlet",t)("ngTemplateOutletContext",r.VKq(2,Eb,e.results))}}const Jb=function(e){return{result:e}};function Bb(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-search-results-item",9),r.NdJ("focus",function(){const t=r.CHM(e).$implicit;return r.oxw(3).resultFocus.emit(t)})("unfocus",function(){const t=r.CHM(e).$implicit;return r.oxw(3).resultUnfocus.emit(t)})("select",function(){const t=r.CHM(e).$implicit;return r.oxw(3).onResultSelect(t)})("mouseenter",function(){const t=r.CHM(e).$implicit;return r.oxw(3).resultFocus.emit(t)})("mouseleave",function(){const t=r.CHM(e).$implicit;return r.oxw(3).resultUnfocus.emit(t)}),r.GkF(1,10),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(3);r.Q6J("map",o.map)("result",e)("showIcons",o.showIcons)("withZoomButton",o.withZoomButton)("focused",o.store.state.get(e).focused)("selected",o.store.state.get(e).selected),r.xp6(1),r.Q6J("ngTemplateOutlet",o.templateSearchToolbar)("ngTemplateOutletContext",r.VKq(8,Jb,e))}}function jb(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"span",11),r.NdJ("click",function(){r.CHM(e);const t=r.oxw(2).$implicit;return r.oxw().displayMoreResults(t)}),r.TgZ(1,"u"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.qZA()}2&e&&(r.xp6(2),r.Oqu(r.lcZ(3,1,"igo.geo.search.displayMoreResults")))}function Gb(e,t){if(1&e&&(r.YNc(0,Bb,2,10,"ng-template",1),r.YNc(1,jb,4,3,"span",8)),2&e){const e=t.results,o=r.oxw().$implicit,i=r.oxw();r.Q6J("ngForOf",e),r.xp6(1),r.Q6J("ngIf",i.isMoreResults(o))}}function Qb(e,t){if(1&e&&(r.YNc(0,Rb,2,8,"igo-collapsible",3),r.YNc(1,Nb,1,4,"ng-template",null,4,r.W1O),r.YNc(3,Gb,2,2,"ng-template",null,5,r.W1O)),2&e){const e=r.MAs(2),t=r.oxw();r.Q6J("ngIf",t.mode===t.searchResultMode.Grouped)("ngIfElse",e)}}var zb=(()=>{return(e=zb||(zb={})).Grouped="grouped",e.Flat="flat",zb;var e})();let Yb=(()=>{class e{constructor(e,t){this.cdRef=e,this.searchService=t,this.searchResultMode=zb,this.pageIterator=[],this.collapsed=[],this.mode=zb.Grouped,this.withZoomButton=!1,this.settingsChange$=new C.X(void 0),this.termSplitter="|",this.resultFocus=new r.vpe,this.resultUnfocus=new r.vpe,this.resultSelect=new r.vpe,this.moreResults=new r.vpe,this.resultMouseenter=new r.vpe,this.resultMouseleave=new r.vpe}get term(){return this._term}set term(e){this._term=e,this.pageIterator=[]}get results$(){return void 0===this._results$&&(this._results$=this.liftResults()),this._results$}ngOnInit(){this.watcher=new ct(this.store,this.cdRef),this.settingsChange$$=this.settingsChange$.subscribe(()=>{this.pageIterator=[]})}ngOnDestroy(){this.watcher.destroy(),this.settingsChange$$.unsubscribe()}computeGroupTitle(e){const t=[e.source.title],o=e.results.length;return o>1&&t.push(`(${o})`),t.join(" ")}onResultSelect(e){this.store.state.get(e)&&!0===this.store.state.get(e).selected||(this.store.state.update(e,{focused:!0,selected:!0},!0),this.resultSelect.emit(e))}liftResults(){return this.store.stateView.all$().pipe((0,wn.D)(e=>0===e.length?fn.E:(0,yn.H)(200)),(0,x.U)(e=>this.groupResults(e.map(e=>e.entity).sort(this.sortByOrder))))}sortByOrder(e,t){return e.source.displayOrder-t.source.displayOrder}groupResults(e){const t=new Map;return e.forEach(e=>{const o=e.source;let i=t.get(o);void 0===i&&(i=[],t.set(o,i)),i.push(e)}),Array.from(t.keys()).map(e=>(void 0===this.pageIterator[e.getId()]&&(this.pageIterator[e.getId()]=1),{source:e,results:t.get(e)}))}isMoreResults(e){const t=this.store.getStrategyOfType(pt);return!(null==t?void 0:t.active)&&e.results&&!0===e.results[e.results.length-1].meta.nextPage}displayMoreResults(e){const t={sourceId:e.source.getId(),page:++this.pageIterator[e.source.getId()]};let o;o=this.termSplitter&&this.term.match(new RegExp(this.termSplitter,"g"))?this.term.split(this.termSplitter):[this.term];let i=[];o.map(e=>{i=i.concat(this.searchService.search(e,t))}),i.map(t=>{t.request.subscribe(o=>{const i=e.results.concat(o);o.length||(i[i.length-1].meta.nextPage=!1),this.moreResults.emit({research:t,results:i})})})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.sBO),r.Y36(xv))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-search-results"]],contentQueries:function(e,t,o){if(1&e&&r.Suo(o,qb,5),2&e){let e;r.iGM(e=r.CRH())&&(t.templateSearchToolbar=e.first)}},inputs:{map:"map",store:"store",showIcons:"showIcons",mode:"mode",withZoomButton:"withZoomButton",term:"term",settingsChange$:"settingsChange$",termSplitter:"termSplitter"},outputs:{resultFocus:"resultFocus",resultUnfocus:"resultUnfocus",resultSelect:"resultSelect",moreResults:"moreResults",resultMouseenter:"resultMouseenter",resultMouseleave:"resultMouseleave"},decls:4,vars:4,consts:[[3,"navigation"],["ngFor","",3,"ngForOf"],["groupTemplate",""],[3,"class","title","collapsed","toggle",4,"ngIf","ngIfElse"],["flatTemplate",""],["storeItemTemplate",""],[3,"title","collapsed","toggle"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["class","moreResults mat-typography",3,"click",4,"ngIf"],["igoListItem","","color","accent",3,"map","result","showIcons","withZoomButton","focused","selected","focus","unfocus","select","mouseenter","mouseleave"],["igoSearchItemToolbar","",3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"moreResults","mat-typography",3,"click"]],template:function(e,t){1&e&&(r.TgZ(0,"igo-list",0),r.YNc(1,Qb,5,2,"ng-template",1,2,r.W1O),r.ALo(3,"async"),r.qZA()),2&e&&(r.Q6J("navigation",!0),r.xp6(1),r.Q6J("ngForOf",r.lcZ(3,2,t.results$)))},directives:[_i,h.sg,h.O5,$o,h.tP,$b,Ii],pipes:[h.Ov,U.X$],styles:[".moreResults[_ngcontent-%COMP%]{cursor:pointer;color:#00f;float:right;margin-right:10px;margin-top:5px}igo-list[_ngcontent-%COMP%]     mat-list{height:100%}"],changeDetection:0}),e})();function Hb(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",1),r.NdJ("mouseenter",function(t){return r.CHM(e),r.oxw().onMouseEvent(t)})("mouseleave",function(t){return r.CHM(e),r.oxw().onMouseEvent(t)})("click",function(t){return r.CHM(e),r.oxw().onToggleClick(t)}),r.ALo(1,"translate"),r.ALo(2,"async"),r.ALo(3,"async"),r._UZ(4,"mat-icon",2),r.ALo(5,"async"),r.ALo(6,"async"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("matTooltip",r.lcZ(1,4,r.lcZ(2,6,e.tooltip$)))("color",r.lcZ(3,8,e.isPreview$)?"":e.added?"warn":""),r.xp6(4),r.Q6J("matBadgeHidden",r.lcZ(5,10,e.inRange$))("svgIcon",r.lcZ(6,12,e.isPreview$)?"plus":e.added?"delete":"plus")}}let Vb=(()=>{class e{constructor(e){this.layerService=e,this.tooltip$=new C.X("igo.geo.catalog.layer.addToMap"),this.inRange$=new C.X(!0),this.isPreview$=new C.X(!1),this.layersSubcriptions=[],this.mouseInsideAdd=!1,this._color="primary"}get color(){return this._color}set color(e){this._color=e}ngOnInit(){"Layer"===this.layer.meta.dataType&&(this.added=-1!==this.map.layers.findIndex(e=>e.id===this.layer.data.sourceOptions.id)),this.resolution$$=this.map.viewController.resolution$.subscribe(e=>{this.isInResolutionsRange(e),this.tooltip$.next(this.computeTooltip())})}ngOnDestroy(){this.resolution$$.unsubscribe()}onMouseEvent(e){this.onToggleClick(e)}onToggleClick(e){if(void 0!==this.lastTimeoutRequest&&clearTimeout(this.lastTimeoutRequest),"mouseenter"!==e.type||!this.mouseInsideAdd)switch(e.type){case"click":this.isPreview$.value||(this.added?this.remove():this.add()),this.isPreview$.next(!1);break;case"mouseenter":!this.isPreview$.value&&!this.added&&(this.lastTimeoutRequest=setTimeout(()=>{this.add(),this.isPreview$.next(!0)},500)),this.mouseInsideAdd=!0;break;case"mouseleave":this.isPreview$.value&&(this.remove(),this.isPreview$.next(!1)),this.mouseInsideAdd=!1}}add(){this.added||(this.added=!0,this.addLayerToMap())}remove(){this.added&&(this.added=!1,this.removeLayerFromMap(),this.layersSubcriptions.map(e=>e.unsubscribe()),this.layersSubcriptions=[])}addLayerToMap(){if(void 0===this.map||this.layer.meta.dataType!==Rh)return;const e=this.layer.data;void 0===e.sourceOptions.optionsFromApi&&(e.sourceOptions.optionsFromApi=!0),this.layersSubcriptions.push(this.layerService.createAsyncLayer(e).subscribe(e=>this.map.addLayer(e)))}removeLayerFromMap(){if(void 0===this.map||this.layer.meta.dataType!==Rh)return;const e=this.map.getLayerById(this.layer.data.sourceOptions.id);this.map.removeLayer(e)}isInResolutionsRange(e){this.inRange$.next(e>=(this.layer.data.minResolution||0)&&e<=(this.layer.data.maxResolution||1/0))}computeTooltip(){return this.added?this.inRange$.value?"igo.geo.catalog.layer.removeFromMap":"igo.geo.catalog.layer.removeFromMapOutRange":this.inRange$.value?"igo.geo.catalog.layer.addToMap":"igo.geo.catalog.layer.addToMapOutRange"}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(yu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-search-add-button"]],inputs:{layer:"layer",added:"added",map:"map",color:"color"},decls:1,vars:1,consts:[["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","mouseenter","mouseleave","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","mouseenter","mouseleave","click"],["matBadge","","igoMatBadgeIcon","eye-off","igoMatBadgeInverseColor","true","matBadgeDisabled","true","matBadgeSize","small","matBadgePosition","after",3,"matBadgeHidden","svgIcon"]],template:function(e,t){1&e&&r.YNc(0,Hb,7,14,"button",0),2&e&&r.Q6J("ngIf","Layer"===t.layer.meta.dataType)},directives:[h.O5,n.lW,p.gM,a.Hw,Be.k,Oo],pipes:[U.X$,h.Ov],styles:[""],changeDetection:0}),e})(),Wb=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,Be.g,p.AV,a.Ps,l.ie,n.ot,qo,$i,yi,oe,Mo,wl]]}),e})(),Xb=(()=>{class e{constructor(e,t,o,i){this.component=e,this.searchService=t,this.searchSourceService=o,this.mediaService=i,this.pointerSearchStore=new lt([]),this.reverseSearch$$=[],this.hasPointerReverseSearchSource=!1,this.searchPointerSummaryFeatureId="searchPointerSummaryFeatureId",this.igoSearchPointerSummaryDelay=1e3,this.igoSearchPointerSummaryEnabled=!1}get map(){return this.component.map}get mapProjection(){return this.component.map.projection}ngOnInit(){this.listenToMapPointerMove(),this.subscribeToPointerStore(),this.map.status$.pipe((0,ke.q)(1)).subscribe(()=>{this.store=new Ec([],{map:this.map}),this.initStore()}),this.layers$$=this.map.layers$.subscribe(e=>{this.store&&!e.find(e=>"searchPointerSummaryId"===e.id)&&this.initStore()})}initStore(){Dc(this.store,new uc({id:"searchPointerSummaryId",title:"searchPointerSummary",zIndex:900,source:new tc,showInLayerList:!1,exportable:!1,browsable:!1,style:Kb}))}ngAfterContentChecked(){this.hasPointerReverseSearchSource=!!this.searchSourceService.getEnabledSources().filter(fv).length}ngOnDestroy(){this.unlistenToMapPointerMove(),this.unsubscribeToPointerStore(),this.unsubscribeReverseSearch(),this.layers$$.unsubscribe()}subscribeToPointerStore(){this.store$$=this.pointerSearchStore.entities$.subscribe(e=>{this.entitiesToPointerOverlay(e)})}computeSummaryClosestFeature(e){const t={};return e.map(e=>{e.data.properties.type&&e.data.properties.distance>=0&&(t.hasOwnProperty(e.data.properties.type)?e.data.properties.distance<t[e.data.properties.type].distance&&(t[e.data.properties.type]={distance:e.data.properties.distance,title:e.meta.title}):t[e.data.properties.type]={distance:e.data.properties.distance,title:e.meta.title})}),t}entitiesToPointerOverlay(e){const t=this.computeSummaryClosestFeature(e),o=Object.keys(t),i=[],r=[];e.map(e=>{const s=o.indexOf(e.data.properties.type);-1!==s?(r.push(t[e.data.properties.type].title),o.splice(s,1),i.push(e.data.properties.type)):-1===i.indexOf(e.data.properties.type)&&r.push(e.meta.title)}),r.length&&this.addPointerOverlay(r.join("\n"))}listenToMapPointerMove(){this.pointerMoveListener=this.map.ol.on("pointermove",e=>this.onMapEvent(e))}unsubscribeToPointerStore(){this.store$$.unsubscribe()}unsubscribeReverseSearch(){this.reverseSearch$$.map(e=>e.unsubscribe()),this.reverseSearch$$=[]}unlistenToMapPointerMove(){this.pointerMoveListener=void 0}onMapEvent(e){!e.dragging&&this.igoSearchPointerSummaryEnabled&&this.hasPointerReverseSearchSource&&!this.mediaService.isTouchScreen()?(void 0!==this.lastTimeoutRequest&&(clearTimeout(this.lastTimeoutRequest),this.clearLayer(),this.unsubscribeReverseSearch()),this.lonLat=(0,Fn.vs)(e.coordinate,this.mapProjection,"EPSG:4326"),this.lastTimeoutRequest=setTimeout(()=>{this.onSearchCoordinate()},this.igoSearchPointerSummaryDelay)):this.clearLayer()}onSearchCoordinate(){this.pointerSearchStore.clear();const e=this.searchService.reverseSearch(this.lonLat,{params:{geometry:"false",icon:"false"}},!0);for(const t in e)e.length>0&&this.reverseSearch$$.push(e[t].request.subscribe(o=>{this.onSearch({research:e[t],results:o})}))}onSearch(e){const t=e.results,o=this.pointerSearchStore.all().filter(t=>t.source!==e.research.source).concat(t);this.pointerSearchStore.load(o)}addPointerOverlay(e){this.clearLayer();const t=new Qn.Z((0,Fn.vs)(this.lonLat,"EPSG:4326",this.mapProjection)),o=new Tn.Z({geometry:t}),i=(new Yn.Z).writeGeometryObject(t,{featureProjection:this.mapProjection,dataProjection:this.mapProjection});this.store.setLayerFeatures([{type:Sl,geometry:i,projection:this.mapProjection,properties:{id:this.searchPointerSummaryFeatureId,pointerSummary:e},meta:{id:this.searchPointerSummaryFeatureId},ol:o}],Cl.None)}clearLayer(){this.store&&this.store.clearLayer()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ou,2),r.Y36(xv),r.Y36(bv),r.Y36(me))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoSearchPointerSummary",""]],inputs:{igoSearchPointerSummaryDelay:"igoSearchPointerSummaryDelay",igoSearchPointerSummaryEnabled:"igoSearchPointerSummaryEnabled"}}),e})();function Kb(e,t){return new Dn.ZP({image:new Un.Z({src:"./assets/igo2/geo/icons/cross_black_18px.svg",imgSize:[18,18]}),text:new En.Z({text:e.get("pointerSummary"),textAlign:"left",textBaseline:"bottom",font:"12px Calibri,sans-serif",fill:new Rn.Z({color:"#000"}),backgroundFill:new Rn.Z({color:"rgba(255, 255, 255, 0.5)"}),backgroundStroke:new Nn.Z({color:"rgba(200, 200, 200, 0.75)",width:2}),stroke:new Nn.Z({color:"#fff",width:3}),overflow:!0,offsetX:10,offsetY:-10,padding:[2.5,2.5,2.5,2.5]})})}let ex=(()=>{class e{static forRoot(){return{ngModule:e,providers:[xv,{provide:bv,useFactory:Uv,deps:[Eu]},{provide:Nv,useFactory:Gv,deps:[ne]},{provide:Yv,useFactory:Vv,deps:[ne]},{provide:Xv,useFactory:eb,deps:[ne]}]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,Fb,sb,Wb,vb],Fb,sb,Wb,vb]}),e})(),tx=(()=>{class e{constructor(e){this.cdRef=e,this.complete=new r.vpe,this.cancel=new r.vpe}onUpdateInputs(){this.cdRef.detectChanges()}onClose(){this.cancel.emit()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.sBO))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-ogc-filter"]],inputs:{layer:"layer",map:"map"},outputs:{complete:"complete",cancel:"cancel"},decls:1,vars:3,consts:[["igoListItem","",3,"layer","header","map"]],template:function(e,t){1&e&&r._UZ(0,"igo-ogc-filterable-item",0),2&e&&r.Q6J("layer",t.layer)("header",!1)("map",t.map)},directives:[nm],styles:[""],changeDetection:0}),e})();const ox=new r.OlP("OgcFilterWidget");function ix(e){return e.create(tx)}let rx=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,n.ot,oe,Nf]]}),e})();class sx extends Dr{constructor(e){super(e),this.options=e,this.inResolutionRange$=new C.X(!0),this.map.viewController.resolution$.subscribe(e=>{this.inResolutionRange$.next(e>this.layer.minResolution&&e<this.layer.maxResolution)})}get layer(){return this.options.layer}get map(){return this.options.map}}let nx=(()=>{class e{constructor(e){this.storageService=e}get zoomAuto(){return this.storageService.get("zoomAuto")}createWorkspace(e,t){var o;if(!1===(null===(o=e.options.workspace)||void 0===o?void 0:o.enabled))return;e.options.workspace=Object.assign({},e.options.workspace,{enabled:!0,srcId:e.id,workspaceId:e.id});const i=new sx({id:e.id,title:e.title,layer:e,map:t,entityStore:this.createFeatureStore(e,t),actionStore:new gr([]),meta:{tableTemplate:void 0}});return this.createTableTemplate(i,e),i}createFeatureStore(e,t){const o=new Ec([],{map:t});o.bindLayer(e);const i=new Jc({}),r=new Rc({}),s=new Uc({}),n=new dt({}),a=new jc({layer:new uc({zIndex:300,source:new tc,style:void 0,showInLayerList:!1,exportable:!1,browsable:!1}),map:t,hitTolerance:15,motion:this.zoomAuto?Cl.Default:Cl.None,many:!0,dragBox:!0});return o.addStrategy(i,!0),o.addStrategy(r,!0),o.addStrategy(s,!0),o.addStrategy(a,!0),o.addStrategy(n,!1),o.addStrategy(this.createFilterInMapExtentOrResolutionStrategy(),!0),o}createTableTemplate(e,t){const o=t.dataSource.options.sourceFields||[];if(0===o.length)return void e.entityStore.entities$.pipe((0,xn.n)(e=>0===e.length),(0,ke.q)(1)).subscribe(t=>{const o=t[0].ol,i=o.getKeys().filter(e=>!e.startsWith("_")&&"geometry"!==e&&e!==o.getGeometryName()&&!e.match(/boundedby/gi)).map(e=>({name:`properties.${e}`,title:e,renderer:Ke.UnsanitizedHTML}));e.meta.tableTemplate={selection:!0,sort:!0,columns:i}});const i=o.map(e=>({name:`properties.${e.name}`,title:e.alias?e.alias:e.name,renderer:Ke.UnsanitizedHTML}));e.meta.tableTemplate={selection:!0,sort:!0,columns:i}}createFilterInMapExtentOrResolutionStrategy(){return new pt({filterClauseFunc:e=>!0===e.state.inMapExtent&&!0===e.state.inMapResolution})}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(ve))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),ax=(()=>{class e{constructor(e,t){this.layerService=e,this.storageService=t}get zoomAuto(){return this.storageService.get("zoomAuto")}createWorkspace(e,t){var o,i,r,s,n,a;if(!0!==(null===(o=e.options.workspace)||void 0===o?void 0:o.enabled))return;const l=e.dataSource,c=e.id+".WmsWorkspaceTableSrc",u=e.id+".WfsWorkspaceTableDest";e.options.linkedLayers||(e.options.linkedLayers={linkId:c,links:[]});const p={bidirectionnal:!0,syncedDelete:!0,linkedIds:[u],properties:[Al.ZINDEX,Al.VISIBLE]};(null===(i=e.options.workspace)||void 0===i?void 0:i.minResolution)||p.properties.push(Al.MINRESOLUTION);let d=!1;(null===(r=l.options.ogcFilters)||void 0===r?void 0:r.enabled)&&(p.properties.push(Al.OGCFILTERS),d=!0),(null===(s=e.options.workspace)||void 0===s?void 0:s.maxResolution)||p.properties.push(Al.MAXRESOLUTION);let h,g=[];return e.options.linkedLayers.links&&(g=JSON.parse(JSON.stringify(e.options.linkedLayers.links))),g.push(p),e.options.linkedLayers.linkId=e.options.linkedLayers.linkId?e.options.linkedLayers.linkId:c,e.options.linkedLayers.links=g,this.layerService.createAsyncLayer({id:u,linkedLayers:{linkId:u},workspace:{srcId:e.id,workspaceId:void 0,enabled:!1},showInLayerList:!1,opacity:0,title:e.title,minResolution:(null===(n=e.options.workspace)||void 0===n?void 0:n.minResolution)||e.minResolution||0,maxResolution:(null===(a=e.options.workspace)||void 0===a?void 0:a.maxResolution)||e.maxResolution||1/0,sourceOptions:{download:l.options.download,type:"wfs",url:l.options.urlWfs||l.options.url,queryable:!0,queryTitle:l.options.queryTitle,params:l.options.paramsWFS,ogcFilters:Object.assign({},l.ogcFilters$.value,{enabled:d}),sourceFields:l.options.sourceFields||void 0}}).subscribe(o=>(t.addLayer(o),e.ol.setProperties({linkedLayers:{linkId:e.options.linkedLayers.linkId,links:g}},!1),o.dataSource.ol.refresh(),h=new sx({id:e.id,title:e.title,layer:o,map:t,entityStore:this.createFeatureStore(o,t),actionStore:new gr([]),meta:{tableTemplate:void 0}}),this.createTableTemplate(h,o),o.options.workspace.workspaceId=o.id,e.options.workspace=Object.assign({},e.options.workspace,{enabled:!0,srcId:e.id,workspaceId:o.id}),delete l.options.download,h)),h}createFeatureStore(e,t){const o=new Ec([],{map:t});o.bindLayer(e);const i=new Jc({}),r=new Rc({}),s=new Uc({}),n=new dt({}),a=new jc({layer:new uc({zIndex:300,source:new tc,style:void 0,showInLayerList:!1,exportable:!1,browsable:!1}),map:t,hitTolerance:15,motion:this.zoomAuto?Cl.Default:Cl.None,many:!0,dragBox:!0});return o.addStrategy(i,!0),o.addStrategy(r,!0),o.addStrategy(s,!0),o.addStrategy(a,!0),o.addStrategy(n,!1),o.addStrategy(this.createFilterInMapExtentOrResolutionStrategy(),!0),o}createTableTemplate(e,t){const o=t.dataSource.options.sourceFields||[];if(0===o.length)return void e.entityStore.entities$.pipe((0,xn.n)(e=>0===e.length),(0,ke.q)(1)).subscribe(t=>{const o=t[0].ol,i=o.getKeys().filter(e=>!e.startsWith("_")&&"geometry"!==e&&e!==o.getGeometryName()&&!e.match(/boundedby/gi)).map(e=>({name:`properties.${e}`,title:e,renderer:Ke.UnsanitizedHTML}));e.meta.tableTemplate={selection:!0,sort:!0,columns:i}});const i=o.map(e=>({name:`properties.${e.name}`,title:e.alias?e.alias:e.name,renderer:Ke.UnsanitizedHTML}));e.meta.tableTemplate={selection:!0,sort:!0,columns:i}}createFilterInMapExtentOrResolutionStrategy(){return new pt({filterClauseFunc:e=>!0===e.state.inMapExtent&&!0===e.state.inMapResolution})}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(yu),r.LFG(ve))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class lx extends Dr{constructor(e){super(e),this.options=e,this.inResolutionRange$=new C.X(!0),this.map.viewController.resolution$.subscribe(e=>{this.inResolutionRange$.next(e>this.layer.minResolution&&e<this.layer.maxResolution)})}get layer(){return this.options.layer}get map(){return this.options.map}}let cx=(()=>{class e{constructor(e){this.storageService=e}get zoomAuto(){return this.storageService.get("zoomAuto")}createWorkspace(e,t){var o;if(!1===(null===(o=e.options.workspace)||void 0===o?void 0:o.enabled))return;e.options.workspace=Object.assign({},e.options.workspace,{enabled:!0}),e.options.workspace=Object.assign({},e.options.workspace,{enabled:!0,srcId:e.id,workspaceId:e.id});const i=new lx({id:e.id,title:e.title,layer:e,map:t,entityStore:this.createFeatureStore(e,t),actionStore:new gr([]),meta:{tableTemplate:void 0}});return this.createTableTemplate(i,e),i}createFeatureStore(e,t){const o=new Ec([],{map:t});o.bindLayer(e);const i=new Jc({}),r=new Rc({}),s=new Uc({}),n=new dt({}),a=new jc({layer:new uc({zIndex:300,source:new tc,style:void 0,showInLayerList:!1,exportable:!1,browsable:!1}),map:t,hitTolerance:15,motion:this.zoomAuto?Cl.Default:Cl.None,many:!0,dragBox:!0});return o.addStrategy(i,!0),o.addStrategy(r,!0),o.addStrategy(s,!0),o.addStrategy(a,!0),o.addStrategy(n,!1),o.addStrategy(this.createFilterInMapExtentOrResolutionStrategy(),!0),o}createTableTemplate(e,t){const o=t.dataSource.options.sourceFields||[];if(0===o.length)return void e.entityStore.entities$.pipe((0,xn.n)(e=>0===e.length),(0,ke.q)(1)).subscribe(t=>{const o=t[0].ol,i=o.getKeys().filter(e=>!e.startsWith("_")&&"geometry"!==e&&e!==o.getGeometryName()&&!e.match(/boundedby/gi)).map(e=>({name:`properties.${e}`,title:e,renderer:Ke.UnsanitizedHTML}));e.meta.tableTemplate={selection:!0,sort:!0,columns:i}});const i=o.map(e=>({name:`properties.${e.name}`,title:e.alias?e.alias:e.name,renderer:Ke.UnsanitizedHTML}));e.meta.tableTemplate={selection:!0,sort:!0,columns:i}}createFilterInMapExtentOrResolutionStrategy(){return new pt({filterClauseFunc:e=>!0===e.state.inMapExtent&&!0===e.state.inMapResolution})}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(ve))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),ux=(()=>{class e{constructor(e,t,o,i){this.component=e,this.wfsWorkspaceService=t,this.wmsWorkspaceService=o,this.featureWorkspaceService=i,this.entities$$=[]}get workspaceStore(){return this.component.store}ngOnInit(){this.layers$$=this.map.layers$.pipe((0,w.b)(50)).subscribe(e=>this.onLayersChange(e))}ngOnDestroy(){this.layers$$.unsubscribe(),this.entities$$.map(e=>e.unsubscribe())}onLayersChange(e){const t=e.filter(e=>this.layerIsEditable(e)),o=t.map(e=>e.id),i=t.map(e=>this.getOrCreateWorkspace(e)).filter(e=>void 0!==e),r=this.workspaceStore.all().filter(e=>o.indexOf(e.id)<0);r.length>0&&(r.forEach(e=>{e.entityStore.deactivateStrategyOfType(Rc),e.deactivate()}),this.workspaceStore.state.updateMany(r,{active:!1,selected:!1}),this.workspaceStore.deleteMany(r)),i.length>0&&this.workspaceStore.insertMany(i)}getOrCreateWorkspace(e){if(void 0===this.workspaceStore.get(e.id)){if(e.dataSource instanceof hc)return this.wfsWorkspaceService.createWorkspace(e,this.map);if(e.dataSource instanceof Xl){if(!e.dataSource.options.paramsWFS)return;const t=this.wmsWorkspaceService.createWorkspace(e,this.map);return null==t||t.inResolutionRange$.subscribe(o=>{e.dataSource.options.queryable=!o,t.layer.dataSource.options.queryable=o}),t}if(e.dataSource instanceof tc&&!0===e.exportable)return this.featureWorkspaceService.createWorkspace(e,this.map)}}layerIsEditable(e){var t,o;const i=e.dataSource;return i instanceof hc||i instanceof tc||i instanceof Xl&&((null===(t=(i.options||{}).ogcFilters)||void 0===t?void 0:t.enabled)||void 0!==(null===(o=i.options.paramsWFS)||void 0===o?void 0:o.featureTypes))}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Fr),r.Y36(nx),r.Y36(ax),r.Y36(cx))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoWorkspaceSelector",""]],inputs:{map:"map"}}),e})(),px=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez]]}),e})(),dx=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez]]}),e})(),hx=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[{provide:ox,useFactory:ix,deps:[Zr]}],imports:[[h.ez,Lr,px,dx,rx],px,dx,rx]}),e})();var gx=(()=>{return(e=gx||(gx={}))[e.GeoJSON=0]="GeoJSON",e[e.JSON=1]="JSON",gx;var e})(),mx=(()=>{return(e=mx||(mx={})).Route="Route",e.Trip="Trip",mx;var e})();let fx=(()=>{class e extends uv{constructor(e,t){super(),this.http=e,this.config=t,this.directionsUrl="https://geoegl.msp.gouv.qc.ca/services/itineraire/route/v1/driving/",this.options=this.config.getConfig("directionsSources.osrm")||{},this.directionsUrl=this.options.url||this.directionsUrl}get enabled(){return!1!==this.options.enabled}set enabled(e){this.options.enabled=e}getName(){return e._name}route(e,t={}){const o=this.getRouteParams(t);return this.http.get(this.directionsUrl+e.join(";"),{params:o}).pipe((0,x.U)(e=>this.extractRoutesData(e)))}extractRoutesData(e){const t=[];return e.routes.forEach(o=>{t.push(this.formatRoute(o,e.waypoints))}),t}getRouteParams(e={}){return e.alternatives=void 0===e.alternatives||e.alternatives,e.steps=void 0===e.steps||e.steps,e.geometries=void 0!==e.geometries?e.geometries:"geojson",e.overview=void 0!==e.overview&&e.overview,new y.LE({fromObject:{alternatives:e.alternatives?"true":"false",overview:e.overview?"simplified":"full",steps:e.steps?"true":"false",geometries:e.geometries?e.geometries:"geojson"}})}formatRoute(t,o){const i=[];return t.legs.forEach(e=>{e.steps.forEach(e=>{i.push(e)})}),{id:D(),title:t.legs[0].summary,source:e._name,sourceType:mx.Route,order:1,format:gx.GeoJSON,icon:"directions",projection:"EPSG:4326",waypoints:o,distance:t.distance,duration:t.duration,geometry:t.geometry,legs:t.legs,steps:i,weight:t.weight,weight_name:t.weight_name}}}return e._name="OSRM Qu\xe9bec",e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(z))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})();function yx(e,t){return new fx(e,t)}let vx=(()=>{class e extends Eu{constructor(e,t,o,i){super(i,o),this.http=e,this.languageService=t}getId(){return e.id}getType(){return e.type}getDefaultOptions(){return{title:"Cadastre (Qu\xe9bec)",searchUrl:"https://carto.cptaq.gouv.qc.ca/php/find_lot_v1.php?"}}search(e,t){e=(e=(e=e.endsWith(",")?e.slice(0,-1):e).startsWith(",")?e.substr(1):e).replace(/ /g,"");const o=this.computeSearchRequestParams(e,t||{});return o.get("numero")&&o.get("numero").match(/^[0-9,]+$/g)?this.http.get(this.searchUrl,{params:o,responseType:"text"}).pipe((0,x.U)(t=>this.extractResults(t,e))):(0,A.of)([])}computeSearchRequestParams(e,t){return new y.LE({fromObject:Object.assign({numero:e,epsg:"4326"},this.params,t.params||{})})}extractResults(e,t){return e.split("<br />").filter(e=>e.length>0).map(e=>this.dataToResult(e,t))}dataToResult(e,t){const o=e.split(";"),i=o[0],r=this.computeGeometry(o[7]),s={NoLot:i,Route:'<span class="routing"> <u>'+this.languageService.translate.instant("igo.geo.seeRouting")+"</u> </span>"},n=[this.getId(),"cadastre",i].join(".");return{source:this,meta:{dataType:Sl,id:n,title:i,score:vv(t.trim(),i),icon:"map-marker"},data:{type:Sl,projection:"EPSG:4326",geometry:r,properties:s,meta:{id:n,title:i}}}}computeGeometry(e){const t=(new ra.Z).readFeature(e,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});return{type:t.getGeometry().getType(),coordinates:t.getGeometry().getCoordinates()}}}return e.id="cadastre",e.type=Sl,e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(ne),r.LFG(ve),r.LFG("options"))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})();function bx(e,t,o,i){return new vx(e,t,o,i.getConfig(`searchSources.${vx.id}`))}let xx=(()=>{class e extends Eu{constructor(e,t,o){super(t,o),this.http=e}getId(){return e.id}getType(){return e.type}getDefaultOptions(){return{title:"Nominatim (OSM)",searchUrl:"https://nominatim.openstreetmap.org/search",settings:[{type:"checkbox",title:"results type",name:"amenity",values:[{title:"igo.geo.search.nominatim.type.food",value:"bar,bbq,biergaten,cafe,drinking_water,fast_food,food_court,ice_cream,pub,restaurant",enabled:!1},{title:"igo.geo.search.nominatim.type.health",value:"baby_hatch,clinic,dentist,doctors,hospital,nursing_home,pharmacy,social_facility,veterinary",enabled:!1},{title:"igo.geo.search.nominatim.type.entertainment",value:"arts_centre,brothel,casino,cinema,community_center_fountain,gambling,nightclub,planetarium                           ,public_bookcase,social_centre,stripclub,studio,swingerclub,theatre,internet_cafe",enabled:!1},{title:"igo.geo.search.nominatim.type.finance",value:"atm,bank,bureau_de_change",enabled:!1}]},{type:"radiobutton",title:"results limit",name:"limit",values:[{title:"10",value:10,enabled:!0},{title:"20",value:20,enabled:!1},{title:"50",value:50,enabled:!1}]},{type:"radiobutton",title:"restrictExtent",name:"countrycodes",values:[{title:"igo.geo.search.nominatim.country.canada",value:"CA",enabled:!0},{title:"igo.geo.search.nominatim.country.all",value:null,enabled:!1}]},{type:"radiobutton",title:"multiple object",name:"dedupe",values:[{title:"igo.geo.search.searchSources.settings.true",value:0,enabled:!1},{title:"igo.geo.search.searchSources.settings.false",value:1,enabled:!0}]}]}}search(e,t){const o=this.computeSearchRequestParams(e,t||{});return o.get("q")?this.http.get(this.searchUrl,{params:o}).pipe((0,x.U)(t=>this.extractResults(t,e))):(0,A.of)([])}computeSearchRequestParams(e,t){return new y.LE({fromObject:Object.assign({q:this.computeTerm(e),format:"json"},this.params,t.params||{})})}extractResults(e,t){return e.map(e=>this.dataToResult(e,t))}dataToResult(e,t){const o=this.computeProperties(e),i=this.computeGeometry(e),r=this.computeExtent(e),s=[this.getId(),"place",e.place_id].join(".");return{source:this,meta:{dataType:Sl,id:s,title:e.display_name,icon:"map-marker",score:vv(t.trim(),e.display_name)},data:{type:Sl,projection:"EPSG:4326",geometry:i,extent:r,properties:o,meta:{id:s,title:e.display_name}}}}computeProperties(e){return{display_name:e.display_name,place_id:e.place_id,osm_type:e.osm_type,class:e.class,type:e.type}}computeGeometry(e){return{type:"Point",coordinates:[parseFloat(e.lon),parseFloat(e.lat)]}}computeExtent(e){return[parseFloat(e.boundingbox[2]),parseFloat(e.boundingbox[0]),parseFloat(e.boundingbox[3]),parseFloat(e.boundingbox[1])]}computeTerm(e){return this.computeTermTags(e)}computeTermTags(e){const t=super.getHashtagsValid(e,"amenity");return t?t.length?(e=e.replace(/(#[^\s]*)/g,""),t.forEach(t=>{e+="+["+t+"]"}),e):null:this.computeTermSettings(e)}computeTermSettings(e){return this.options.settings.forEach(t=>{"amenity"===t.name&&t.values.forEach(t=>{t.enabled&&"string"==typeof t.value&&t.value.split(",").forEach(t=>{e+="+["+t+"]"})})}),e}}return e.id="nominatim",e.type=Sl,e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG("options"),r.LFG(ve))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})();function wx(e,t,o){return new xx(e,t.getConfig(`searchSources.${xx.id}`),o)}let Sx=(()=>{class e extends Eu{constructor(e,t,o,i){if(super(i,o),this.http=e,this.languageService=t,this.storedQueriesOptions=i,this.storedQueriesOptions&&!this.storedQueriesOptions.available)return;const r="title";if(this.storedQueriesOptions||(console.log(" No configuration for this search source (storedqueries). You will use the default values"),this.storedQueriesOptions={storedquery_id:"rtss",fields:[{name:"rtss",defaultValue:"-99"},{name:"chainage",defaultValue:"0",splitPrefix:"\\+"}],outputformat:"text/xml; subtype=gml/3.1.1",srsname:"EPSG:4326",resultTitle:r},this.resultTitle=r,console.log("Default values",this.storedQueriesOptions)),!this.storedQueriesOptions.storedquery_id)throw new Error('Stored Queries :You have to set "storedquery_id" into StoredQueries options. ex: storedquery_id: "nameofstoredquerie"');if(!this.storedQueriesOptions.fields)throw new Error('Stored Queries :You have to set "fields" into options. ex: fields: {"name": "rtss", "defaultValue": "-99"}');if(this.storedQueriesOptions.outputformat=this.storedQueriesOptions.outputformat||"text/xml; subtype=gml/3.1.1",this.storedQueriesOptions.srsname=this.storedQueriesOptions.srsname||"EPSG:4326",this.storedQueriesOptions.storedquery_id.toLowerCase().includes("getfeaturebyid")&&this.storedQueriesOptions.outputformat.toLowerCase().includes("getfeaturebyid")){let e="You must set a geojson format for your stored query. This is due to an openlayers issue)";throw e+=" (wfs 1.1.0 & gml 3.1.1 limitation)",new Error(e)}this.storedQueriesOptions.fields instanceof Array||(this.storedQueriesOptions.fields=[this.storedQueriesOptions.fields]),this.multipleFieldsQuery=this.storedQueriesOptions.fields.length>1,this.storedQueriesOptions.fields.forEach((e,t)=>{if(this.multipleFieldsQuery&&!e.splitPrefix&&0!==t)throw new Error("Stored Queries :You must set a field spliter into your field definition (optional for the first one!)");if(!e.defaultValue)throw new Error("Stored Queries :You must set a field default value into your field definition")}),this.storedQueriesOptions.resultTitle=this.storedQueriesOptions.resultTitle||this.resultTitle}getId(){return e.id}getType(){return e.type}getDefaultOptions(){return{title:"Stored Queries",searchUrl:"https://ws.mapserver.transports.gouv.qc.ca/swtq"}}search(e,t){const o=this.termSplitter(e,this.storedQueriesOptions.fields),i=this.computeRequestParams(t||{},o);return null==this.options.params?this.options.params={page:"1"}:this.options.params.page=null!=t.page?String(t.page):"1",new RegExp(".*?gml.*?","i").test(this.storedQueriesOptions.outputformat)?this.http.get(this.searchUrl,{params:i,responseType:"text"}).pipe((0,x.U)(t=>{let o=this.extractResults(this.extractWFSData(t),e);if(o.sort((e,t)=>e.meta.score>t.meta.score||e.meta.score===t.meta.score&&e.meta.titleHtml<t.meta.titleHtml?1:-1),o.reverse(),o.length>Number(this.options.params.limit)){const e=Number(this.options.params.limit)*Number(this.options.params.page),t=o.length;o=o.slice(0,e),o[o.length-1].meta.nextPage=e<t}return o})):this.http.get(this.searchUrl,{params:i}).pipe((0,x.U)(t=>this.extractResults(this.extractWFSData(t),e)))}getFormatFromOptions(){let e;const t=this.storedQueriesOptions.outputformat,o=new RegExp(".*?gml.*?","i");return new RegExp(".*?json.*?","i").test(t)&&(e=Yn.Z),o.test(t)&&(e=sa.Z),new e}extractWFSData(e){const t=this.getFormatFromOptions(),o=Yn.Z,i=t.readFeatures(e);return JSON.parse((new o).writeFeatures(i))}termSplitter(e,t){const o={};let i=e,r=0;return t.forEach(e=>{o[e.name]=e.defaultValue;const t=new RegExp(e.splitPrefix+"(.+)","i");t.test(i)&&(r=e.splitPrefix?r+=1:r,i=i.split(t)[1])}),0===r?(o[t[0].name]=e,o):(i=e,[...t].reverse().forEach(e=>{const t=new RegExp(e.splitPrefix||"(.+)","i");if(i||""!==i){const r=i.split(t);i=r[0],r[1]&&(o[e.name]=r[1].trim())}}),o)}computeRequestParams(e,t){const o=this.storedQueriesOptions.storedquery_id.toLowerCase().includes("getfeaturebyid")?"2.0.0":"1.1.0";return new y.LE({fromObject:Object.assign({service:"wfs",version:o,request:"GetFeature",storedquery_id:this.storedQueriesOptions.storedquery_id,srsname:this.storedQueriesOptions.srsname,outputformat:this.storedQueriesOptions.outputformat},t,this.params,e.params||{})})}extractResults(e,t){return e.features.map(e=>this.dataToResult(e,t))}dataToResult(e,t){const o=this.computeProperties(e),i=[this.getId(),o.type,e.id].join("."),r=e.properties[this.storedQueriesOptions.resultTitle]?this.storedQueriesOptions.resultTitle:this.resultTitle;return{source:this,data:{type:Sl,projection:"EPSG:4326",geometry:e.geometry,properties:o,meta:{id:i,title:e.properties[r]}},meta:{dataType:Sl,id:i,title:e.properties.title,titleHtml:e.properties[r],icon:"map-marker",score:vv(t.trim(),e.properties.title?e.properties.title:e.properties[r])}}}computeProperties(t){return Object.assign({},_.removeKeys(t.properties,e.propertiesBlacklist),{Route:'<span class="routing"> <u>'+this.languageService.translate.instant("igo.geo.seeRouting")+"</u> </span>"})}}return e.id="storedqueries",e.type=Sl,e.propertiesBlacklist=["boundedBy","id","coord_x","coord_y"],e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(ne),r.LFG(ve),r.LFG("options"))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})(),Cx=(()=>{class e extends Eu{constructor(e,t,o,i){if(super(i,o),this.http=e,this.languageService=t,this.storedQueriesOptions=i,this.storedQueriesOptions&&(!this.storedQueriesOptions||this.storedQueriesOptions.available)){if(!this.storedQueriesOptions.storedquery_id)throw new Error('Stored Queries :You have to set "storedquery_id" into StoredQueries options. ex: storedquery_id: "nameofstoredquerie"');if(!this.storedQueriesOptions.longField)throw new Error('Stored Queries :You have to set "longField" to map the longitude coordinate to the query params.');if(!this.storedQueriesOptions.latField)throw new Error('Stored Queries :You have to set "latField" to map the latitude coordinate to the query params.');this.storedQueriesOptions.outputformat=this.storedQueriesOptions.outputformat||"text/xml; subtype=gml/3.1.1",this.storedQueriesOptions.srsname=this.storedQueriesOptions.srsname||"EPSG:4326",this.storedQueriesOptions.resultTitle=this.storedQueriesOptions.resultTitle||this.resultTitle}}getId(){return e.id}getType(){return e.type}getDefaultOptions(){return{title:"Stored Queries (reverse)",searchUrl:"https://ws.mapserver.transports.gouv.qc.ca/swtq"}}reverseSearch(e,t){const o=this.computeRequestParams(e,t||{});return new RegExp(".*?gml.*?","i").test(this.storedQueriesOptions.outputformat)?this.http.get(this.searchUrl,{params:o,responseType:"text"}).pipe((0,x.U)(e=>this.extractResults(this.extractWFSData(e)))):this.http.get(this.searchUrl,{params:o}).pipe((0,x.U)(e=>this.extractResults(this.extractWFSData(e))))}getFormatFromOptions(){let e;const t=this.storedQueriesOptions.outputformat,o=new RegExp(".*?gml.*?","i");return new RegExp(".*?json.*?","i").test(t)&&(e=Yn.Z),o.test(t)&&(e=sa.Z),new e}extractWFSData(e){const t=this.getFormatFromOptions(),o=Yn.Z,i=t.readFeatures(e);return JSON.parse((new o).writeFeatures(i))}computeRequestParams(e,t){const o={};return o[this.storedQueriesOptions.longField]=e[0],o[this.storedQueriesOptions.latField]=e[1],new y.LE({fromObject:Object.assign({service:"WFS",version:"1.1.0",request:"GetFeature",storedquery_id:this.storedQueriesOptions.storedquery_id,srsname:this.storedQueriesOptions.srsname,outputformat:this.storedQueriesOptions.outputformat},o,this.params,t.params||{})})}extractResults(e){return e.features.map(e=>this.dataToResult(e))}dataToResult(e){const t=this.computeProperties(e),o=[this.getId(),t.type,e.id].join("."),i=e.properties[this.storedQueriesOptions.resultTitle]?this.storedQueriesOptions.resultTitle:this.resultTitle;return{source:this,data:{type:Sl,projection:"EPSG:4326",geometry:e.geometry,properties:t,meta:{id:o,title:e.properties[i]}},meta:{dataType:Sl,id:o,title:e.properties[i],icon:"map-marker"}}}computeProperties(t){const o=_.removeKeys(t.properties,e.propertiesBlacklist),i={Route:'<span class="routing"> <u>'+this.languageService.translate.instant("igo.geo.seeRouting")+"</u> </span>"};return Object.assign(o,{type:t.properties.doc_type},i)}}return e.id="storedqueriesreverse",e.type=Sl,e.propertiesBlacklist=[],e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(ne),r.LFG(ve),r.LFG("options"))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})();function Tx(e,t,o,i){return new Sx(e,t,o,i.getConfig(`searchSources.${Sx.id}`))}function Ax(e,t,o,i){return new Cx(e,t,o,i.getConfig(`searchSources.${Cx.id}`))}function Zx(e){return e.entityStore.getStrategyOfType(pt).active$.pipe((0,x.U)(e=>e?"igo.geo.workspace.inMapExtent.active.tooltip":"igo.geo.workspace.inMapExtent.inactive.tooltip"))}function Lx(e){return e.entityStore.stateView.manyBy$(e=>!0===e.state.selected).pipe((0,x.U)(e=>e.length>=1))}function Fx(e,t){if(1&e&&(r.TgZ(0,"p"),r._uU(1),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Oqu(e.pointerCoord)}}const Ox=d.Bz.forChild([{path:"simple-map",component:(()=>{class e{constructor(e,t,o,i){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.mediaService=i,this.pointerCoordDelay=0,this.map=new eu({controls:{attribution:{collapsed:!0},scaleLine:!0}}),this.view={center:[-73,47.2],zoom:6,rotation:.75},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e}))})}get media(){return this.mediaService.getMedia()}get isTouchScreen(){return this.mediaService.isTouchScreen()}onPointerMove(e){this.pointerCoord=e}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ne),r.Y36(kc),r.Y36(yu),r.Y36(me))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-simple-map"]],decls:18,vars:8,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/simple-map"],["igoPointerPosition","",3,"map","view","pointerPositionDelay","pointerPositionCoord"],["color","primary",3,"map"],["color","primary",3,"map","showIfNoRotation"],[4,"ngIf"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Simple Map"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"hr"),r.qZA(),r.TgZ(13,"igo-map-browser",1),r.NdJ("pointerPositionCoord",function(e){return t.onPointerMove(e)}),r._UZ(14,"igo-zoom-button",2),r._UZ(15,"igo-geolocate-button",2),r._UZ(16,"igo-rotation-button",3),r.qZA(),r.qZA(),r.YNc(17,Fx,2,1,"p",4)),2&e&&(r.xp6(13),r.Q6J("map",t.map)("view",t.view)("pointerPositionDelay",t.pointerCoordDelay),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("map",t.map)("showIfNoRotation",!0),r.xp6(1),r.Q6J("ngIf",!t.isTouchScreen))},directives:[g.a8,g.$j,g.n5,g.dn,ou,iu,uu,pu,Cu,h.O5],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}"]}),e})()}]);let Mx=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,Ox,g.QW,n.ot,Dy]]}),e})();function Ix(e,t){if(1&e&&(r._UZ(0,"igo-metadata-button",6),r._UZ(1,"igo-download-button",6),r._UZ(2,"igo-ogc-filter-button",7),r._UZ(3,"igo-time-filter-button",7),r._UZ(4,"igo-track-feature-button",8)),2&e){const e=t.layer;r.Q6J("layer",e),r.xp6(1),r.Q6J("layer",e),r.xp6(1),r.Q6J("header",!0)("layer",e),r.xp6(1),r.Q6J("header",!0)("layer",e),r.xp6(1),r.Q6J("layer",e)("trackFeature",!0)}}const kx=d.Bz.forChild([{path:"layer",component:(()=>{class e{constructor(e,t,o){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.map=new eu({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],maxLayerZoomExtent:[-11e6,45e5,-45e5,1e7],zoom:7},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",visible:!0,baseLayer:!0,source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"shp"},ogcFilters:{enabled:!0,editable:!0,filters:{operator:"PropertyIsEqualTo",propertyName:"code_municipalite",expression:"10043"}}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"WFS ",visible:!0,source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:"geojson_utf8",srsName:"EPSG:32198",outputFormatDownload:"shp"},ogcFilters:{enabled:!0,editable:!0,filters:{operator:"PropertyIsEqualTo",propertyName:"code_municipalite",expression:"12072"}},formatOptions:{dataProjection:"EPSG:32198"}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"WFS (Custom EPSG)",visible:!0,source:e,removable:!1}))}),this.layerService.createAsyncLayer({sourceOptions:{type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",optionsFromCapabilities:!0,params:{LAYERS:"parc_routier",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"R\xe9seau routier",visible:!1,sourceOptions:{type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",params:{LAYERS:"bgr_v_sous_route_res_sup_act",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"lieu habit\xe9",visible:!1,sourceOptions:{type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",optionsFromCapabilities:!0,params:{LAYERS:"lieuhabite",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"sh_dis_eco",visible:!1,sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/mffpecofor.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"sh_dis_eco",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"nurc:Arc_Sample_Parent",visible:!1,legendOptions:{display:!0,stylesAvailable:[{name:"rain",title:"Pluie"},{name:"raster",title:"D\xe9faut"}]},sourceOptions:{type:"wms",url:"https://demo.geo-solutions.it/geoserver/ows",optionsFromCapabilities:!0,params:{LAYERS:"nurc:Arc_Sample",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"Avertissements routier",visible:!1,sourceOptions:{type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",params:{LAYERS:"evenements",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",refreshIntervalSec:15,params:{LAYERS:"vg_observation_v_inondation_embacle_wmst",VERSION:"1.3.0"}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle",source:e,metadata:{url:"https://www.donneesquebec.ca/recherche/fr/dataset/historique-publique-d-embacles-repertories-au-msp",extern:!0}}))})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ne),r.Y36(kc),r.Y36(yu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-layer"]],decls:19,vars:7,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/layer"],[3,"map","view"],["color","primary",3,"map"],["title","Layers"],["floatLabel","never",3,"map","layers","expandLegendOfVisibleLayers","queryBadge"],["igoLayerItemToolbar",""],[3,"layer"],[3,"header","layer"],[3,"layer","trackFeature"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Simple Map"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"hr"),r.qZA(),r.TgZ(13,"igo-map-browser",1),r._UZ(14,"igo-zoom-button",2),r.qZA(),r.TgZ(15,"igo-panel",3),r.TgZ(16,"igo-layer-list",4),r.YNc(17,Ix,5,8,"ng-template",null,5,r.W1O),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.xp6(13),r.Q6J("map",t.map)("view",t.view),r.xp6(1),r.Q6J("map",t.map),r.xp6(2),r.Q6J("map",t.map)("layers",t.map.layers)("expandLegendOfVisibleLayers",!1)("queryBadge",!0))},directives:[g.a8,g.$j,g.n5,g.dn,ou,uu,Ri,zp,bl,$d,dm,Xh,ad],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),e})()}]);let Px=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[kx,g.QW,n.ot,a.Ps,Ui,Dy,cd,Nf,wl,qd]]}),e})();const _x=d.Bz.forChild([{path:"legend",component:(()=>{class e{constructor(e,t,o){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.map=new eu({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:7},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",visible:!0,baseLayer:!0,source:e}))}),this.layerService.createAsyncLayer({title:"legend with display:false",visible:!0,legendOptions:{display:!1,html:"test html"},sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/mffpecofor.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"sh_dis_eco",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"legend in html",visible:!0,legendOptions:{display:!0,html:"<h2>HTML l\xe9gende</h2>"},sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/mffpecofor.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"sh_sreg_eco",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"legend with url param",visible:!0,legendOptions:{url:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxASEhUQEBISFRUVFRAQFRUQFRUVFRAPFRUWFhUVFRUYHSggGBolGxUVITEiJSkrLi4uFx8zODMsNygtLisBCgoKDg0OGhAQGy0dHyUtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tKy0tLS0tLS0tLf/AABEIAKgBLAMBIgACEQEDEQH/xAAbAAABBQEBAAAAAAAAAAAAAAACAQMEBQYAB//EADwQAAIBAwEGAwYFAgUEAwAAAAECAAMEESEFEjFBUWETInEGFDKBkaFCscHR8FJyFSNTYoIzQ5LxFqLh/8QAGQEAAwEBAQAAAAAAAAAAAAAAAAECAwQF/8QAJREBAQACAgEFAAEFAAAAAAAAAAECERIhAwQTMUFRYRQiI3Gh/9oADAMBAAIRAxEAPwB0QhAEMTFQhCEEQhACEIQRFEYEIQgiEIAU6IIsAWLEnQAp0KmBqSdFBY+g5D1OBGD4nxYBHQafQzLPzTDLVbYeHLObh2LARwwyD+4PQiFNJZZuMrLLqlnRJ0ZFiTp0A6KEOM4OITuF8q4L8ydVp9sc2+0atrlw/hVGLBw2MnO66gsMdBpjHeYZeoxmXGOjH0+Vx5UsSLEm7ndEM6IYAhgmEYJgCGCYRgmIBMEwjAJgAmAYRgkwAGjTxxjGniBipGo5UjcAthCEAGEIwMQhAEIGAHFEERcxgYiiBmEDADzFgAxcwA50HMXMANh5H/tA+rrJhXy8JDXJDAcSpx6jB/SE18u6uuhGnqeU4vPP8m7+PR9N34tT9V20FZD4ifMcmHSSra5V1DKdD9Qeh7yLd1d4HAOJm7W9q27NlWKE55cOozzleLLTPz4b7bPM7MrbXbC1AFRQGb4d84OemP17Rk7YYsUREJUn8XxhfjI7gzp5xyXGrjMj3l5uYVfjYeX/AGrzb15D5mRau0N0Bt3e3uAVhoO56ympms1Z6lTtgaaDHAdgBiZZ+Tc1G3i8fe60FsN0AZ1iLUzXpDTRifqpHGVh2ioGMP8AIQtm3G9WUdmbX+04nNw3Y7+Wsb/peRJ0Qz0HkOMQzokQcTBM4xCYBxgGKTBJgCEwTFJgEwBCYBMUmCTABaMvHGMacxGZeNw3jUCWwMIGNAwgYwdBhAxoGEDAHAYQMbBigwBzMIGNAwgYA4DFzGwYWYwPMXMbzCBgD1PjxxylRUuEpv4J0PDXPx9BLNDrI17bMtd2PmVgrNngHwNdZzeeTqur02dm4RquAWK4A111yOxme2tXZicaAcuZGf3/ADl7UrFtRwA68x69jM/eVGffZcBkyxA0bdAGZHjna/Jl0pKdJmuFUN8A3ufyA+UGz3jVABIOWBOez5z05fWSrxs0qV2g1DbrY/pJAx35H6yMoxWDjhq2Ou8Dp/5GdDmBYsy7yF87rnGpx/NZfWd4yrg65JGeJHM6SjpjcthUK+apUI7glifyMnUKhV9zPH4vpjT7yMpteF0tL6qwAK6j0zr6x72YY1HLlQNwNnHMnQfrIyVAujHThx0lt7MhQKqjj5W/46iRjO42zyvG6XGYhMSJmdLjdmITOJgkwBSYJMQmITAOJgkziYJMA4mATOJgEwDiYBM4mATAOYxpzCJjTGIG3MbzFcwMwCzBhAxpQekPdPSPVLcOAwgYzgxd6GjPAwsxkNFDQB7MUNGhnpDCGPVLcOAxQY3unpFzA9nQYoMaBhAxBO2bS3qijvk+g1kXbFVqlY0qWAB56jHn0EnbPfw1ZzngeExu3L2qRu0iVNVtWGclQPyyZz+T+7LTfx9Y7XdfaNvRQh2ydFAXBJY6AADhrjjMlW2jRSqCyVFLb2vlO8uobKjQj9oT2lMUmpHILbp8TGSHU6b2OIzIVwtVt1moFmUEK9IhlI7a9esMJB5Ll9L1dnqLUCk29TJJ05KSfuAT9BK/w/PpodBwGdOGny9NInsrfstSpQq+UMDuqdd0jj+hkg4Fbf5Zzj7Qm5bKq9yWHLq1QUEeqd1UffAxx5LpzPDSU9G/pl2dKTnd0YlgCfly4R72huHqV6dKjhgi4wdBvEfY6SOthUGfFZKYbG8KZLVHA5Y5SsZNdoz3vpate0agXdyuQG3X4gH85P8AZ2p4dfdfmCgP+08P0lNcW3jDK090IMIc6jHAd47sWuxanv8AEFR8wZOuul7beoMEiBmFVyTnrGjmdHbmKTBJiZnYgCExCYpWAYg4mAWiEwC0AItAJiFoBaAKTAJiFoJMA5jGnMJjG2gDTmDmKwMHBhomsFsI4trLJLaP07aepxjjtqmNn2jbWA6TRi1gNbCK4Y0TLJnvch0hrZdpc+COkcShJ4YnyyVVOzjwtO0tVoiOCkJWoXalNnANl2l74U4UIaxPtRe59oq2faXvgTnTAJ0+gkZSKm2M9pK2F8NSQeOnT9pQJbFqbVq9ZRpujGm4O2ect/amoynLZ3dfh00PUzMW9AK2uMH4S3mHbAPOeLbvderJrUO+IHXcRqjqOBekx9QGUg4+RjKW1VGyhK9cAjP/ABM0lihGFqPT64Ua/wD1kza9gXVGViMHOFpv59eBMmZ96O4xjaNBxVNTdw7ndXPEA8TIj3JBPE68wdZtKeyvGTB31ZSSrqGTB5EZOT85namyqu97rk+Lx8TAx4e98Weu7p1zNMcti46VtrSZnFRR5hkH04D6ayStlU1YAknJydSPU/WaB9jigoCbxYnLMys28Txzidsy2KKcsxzyKFQO2WzFzK4M8XXIR9/e0KsWA83TdXQQrOo6VlBXy7+8OfHiJZ7QsS2rboA1UhRnI4a6SHswO9dd4g6jkVOnYiPG7icpp6LTtwVB7RDajpBt78DRvvH/AH1ZvPPYxvilR/dlne7iSPGUwHdYf1U/C9j+TDWwgGzzHGrATkuR1mmPqML8xN8GU+Ki1LDtGv8ADzLujWUyQKAM6Zhhe3PblOmaNlBNjNT7oOkZqW4j9vEuVZr3CC1oJoDbxipZw4Q+VULUBGzb9polsIZsBF7cHJmPdD0ie5zTe4RPcu0qeKJudaJbacaMaW9ne9TH3m3tnRTMUWxMKjWllQIMfvUe3FctnFNsZdLTE40BF7lPhFL7tE92ls9CR3oGL3aOEREoR8W8NaZEdEPdo4REa2kPaFLdQky33pA2yM0mHaTl5bqqmE2yF8ErJgg4xxI4ntnjMc9N0yppgINTUYjyjkWc8PQYlvR2luVGSrndUgZ6k8FH3k7aNrTqqoqaLxWmuSSepxr+vpPPn8uxmLFwrb9Niyg6u5O4D0A+Jzrw9Jq7C/p1BuFjjucHeHHOD3GnLnrpMnteg4ICEBVyCyjSmnMKvXlnnnAwDqxb3wUhcYxhDg5wF1K/fB6lm7StS9lu/bf+5Mo8gU548vrxMpG2NW8fxd8cMbpXQjP1kKx2zcAZVsjjg8DrJr+0tXnTXPDOsXU+D+Vi1uxH+YFUDnnOR+kp9pbVpou4nDUZ46+n8/SQ7zaNWpjeY45gcBKa+vV1GBk/U6/nz/8AcJjunbqHql+w1NUlTwHEHtrofQiFb3qrh38nJQOHqU5fKV1FN3LvjH9J4N0P84QqVJqzg/g7jgOhmmmdu2pvr1t1cZ1Gc/hP04SGu2WQ7rR2nWVk3AVwowN7OCZn9s13yKemBqMYixm+itaVdtA8DJ9ttANznm4uWXnLSy2lgZzDLx/gmbZ3lbTIMrqN6d7GZWU9rqeJkb3vLgrFMP1VybaxdidJorJmHGUGwwzAEiX7XAAwY/H5ssPhOfjmS0R1Mbq0hK1nIGQY5bXe8NTOvH1Eyc98OkoUYnu8RLgR9amZtM2dxAtvOahJIEBjK5xPFEqUwJBeprJt3UAEzdzdeY6zPLzaOePbcps9e0L/AA4dJW09o1BxWSKe1+oM5OUdXE89liAodYX+KrOF6hj5wcTyXhHGODaYkZipgG3Uw5jinC/U84a3APOVhsl6wDa9GMXKjiuBVWGMGUPgVOTSXRFQcY5kNLTwRIm0LfyH0MEXbDiI1dbSBUiPotMNtawR8OOKZO7nAL/zny5a6jF3l/cU3L587ZHDRKY00HLJ4dh3mr2lvhjVpkFMtvr1A79ZE8ajcDBAD8xzHQZ+k5rdNpNswdsOiDxBlm1HLGuhx24/MSDUuVxvU9NBkdcgZ/naX+1dj7zDGCNEHYAfw/OUd7sKoDoDz4fQSsbiLMg0L9eRZTofLwJ5nEsVvSQMEHn007zPvs6qOXI4wOcdt7e4A3TqOGvDMu4xPKrK8r1GGE0zrK0lE1Ygtr9ZEqUq+8QoYZ5dPST9mbHz56p0HIx6khbtqRs62asByAz5Tkj+cZZ3VZKaGjTxvt9usgXF+f8Ap0RjGBnkO8C2UJlmbLccnv0zJ190966iws3VFwQGxqe31lZcMu8TjGekds7nVmYZz5cc4l5bEciM8MjEufKag3FvkZWQDvLLClX3TumSXtlaVtOlNTZidJodhW53gWjFCgqydZVSGzIzvS8Me29s75KaY5yBd7Wzw+0qQ5PGMuxBnJa6pjFqu1anDlJFLaeBrKRq2kAVsysUZRa0/aDdfBOk0uydso/AzynajkHIh7P2g9MhgSJ1Y7nbmuq9sN0McZWXe1FHEiZq22m1ZNG+kS22O1U5ZjD3h7azvdrKRoZlbi5JYnM1dD2YTmWPzjh2BRGm4PpJ7vdPUnw0NGgx+IYhtbCW7UpFqWy88iGhtULa68ZKS1XtHfcFJyHM6tZNyePUG3NZ9DGXsao+FozVsq/4XEVLW6/1F+kWv4Dmo3A6GMV2uRwUH5yZv3K8d0wm2qy/HSPy1ho0K2vao+ND8pY09rrzBHqIFLbFBtOB7x2rbpUGVIilB9b6mw4iQ7w02U4xwMYr7PbGglXWsXXJ1Eq5CRQ1qLGk3hnO4xGP9szW6lQgklH+IngSM66GW3+IFC6qMgtu4P4uWgme2xc+bygZGpI7Hh9dJGrs9xOb3mm3HfGOXEAc+8JNsgndIKnkCMcOEpBt5kwTjQa4568B9oR21Tc+dRoQo7aZOvpF7d+4rnPqr1LpSQB3PXGRgfpGGZs4ABGn01IP86SppIh1QkajTPLOknWTMjEE59f6c4+uknjpUy2kJqx0Hy5aZlZtO6GoB04a8AeklOzZYKJQ3jK2jNjtLwxRlkb97J8qDA4EnnOe4Pwrr8v3nF6IGCfl1hU95x/lKFX+o8Zqz2KgAmrnXiB0mh9/NWhlk0XTMzFeg40G8x68pK2O1Viafhs2RoADmFn2UokUE4IkqpSKiC9AqcEFSDqDxEnOuV1itVIrLepvHEuLeljUyBQoYOZNNWZZ1rhE4NOqtI9N51SpMuDbloDVI2z44Rlt5jhQT/aM/lJFLZF2w0oVPmMfnNJGWWSDdJvSFd6LiXjez17/AKLfMr+8hXexrofFRf5YP5TWVjew+z+0igmq2f7UAYXHGU+xvZhviqndHTnLC62Va6qr+YDkRmZZZY29LmOWu24ttpBlGCIFVWJ4mZT2c2dVQ5Z/T0mqLGLnvo+Om4DwWAPKMLCDTfbLTmtUPLEaOzRyJj2/6wg8Ogrq+yHPwuZCqbGuR8NQ/OX+8YYc9fyhqBl22Rd/6sae0vV/Eh9QZqKtZxwUn+3EHxcjJRvprFYcrJVEqf8AdoBu6a/Yxmnof8moyH+ipn9ZsPBzqAV9RKu+2dVbiiOv0Mjirki2ntCVIS4XHLe5H5y2uHpumQRqJm721qoMeE7pzUgkj+085SJfvRPlLGm3JshkPTBi3Z8nqX4RtpWtKmlR6jYPiNu4x5RMlV2Z4qnwgxUebI54zgA8M/vNPV2OtxVFWuc0qYyFzoWJzrJVrWp1AapA8FDu00XgzD8Rx3hy0VxYil7NVCm8FJAIAAGdSAePPlIdXZaqPMCOJJweWh/Oenrf1ar+HTUIAN9ieRI8oA689eEZuEWoDSuAjZ47vlA7b2fN8oTy/o4fjzZaCqcjTHCPVr8annqPUHj+8l7Z2HUouSgLodQVGcfIcJR1mA0PPryM11Kjek6zqkNkNnXnKe8phqrdznEstnWdWq2KSlsfTHrNLsj2URH8W4IJ4hAeJ7mFymI1az+yNg75B0A5F8y7q0UoEK64HBWOCra6AGLta7u97IUIg0AQ4wO3IwrfaAqLuVNQ2hBBAJ7f0kdpF3e1TU6NeDSqkKh3W6/hbtkcD2jaq1u281XXBwFVgQegbGD9Yxf7JqU8VKJ38fhPxYGvz/PSS6hS5okjRlBOD8SkcQecc/4VDWvKdUZyS3VskyOwPIymt3K1N09cazTWNMtooLHoNZVx0UyRKNJzyku12RVqHyAn0ms2T7Lu2GqkAdBrNTQtqNEYAGn84CRdLlrIbO9i3YDxHx2XUy+tfY61p6shc/7tf/yWr7RxooP/AIn8sSK+0UY+YVVPZTg/XSLo7s74NOmMU6aL6LGffQ3lzg+kYN1RByXYf8WB9eOPtHqN5bVPxjPDJGDJCsudpVkbcYadeokG6vqg83FTx04TV07ZOJdHXln9JL8OnjAVT2wBCSj4YY12chcZzoMSds72NtUqeNVyznXU6D5cJqVorn/poMcMYMSuBzXP7R446K3Y1taOBhRpwkKvbrn4BCNUE+Rs9uYjqk8xH0O04Oen3hmQaVxHQ8pKauOs7HeRd4wlJ6wCSSP/AFBL9MxsRcmAPo/Uzt8dzGgIYWMONbtAas3yhPpIdZzHsaSTV7/eMXNJXGHVWHRgD+cbWqOAEcCdY52FTfbCouhRVZAcE+G3T1z9pSXexqlNadOnh0Vt473kxrkZHMCbMiRquDpJuMPahegtOmFGMsxZyPxdsyjvL2lTfKrvMRrnXHp0mpvLEOMA4lDtL2WqMd5GGnUcfpMbhdtJlNKOl7TVN4gBR2lXdWdC8rA1PIx0O7oGMXbOzqlFt90I5EjUGVlglZ6quadUIuSCqnX7TTDH7ic7GztLBLVXRMKgAJJ1Zmmd2rdMy75JGuF5GOUPfXfd3SygkgucEjlkTrzYl61QOyAqOQPOTwvLsTKadTu2NMipwA4HnGNneEy7yjUHjnOnTEtP/itzVQhmCZ+ZxFs/YitSXcVxgnU45RzHorlNoV9cimA3MlcfvHqQtCQ7O9NyDnChlIP9XD85p7T2ctwAKi75HNjmHfez1vU0A3ca+XT6yuPSeW2HX2cUtvU7iiykg+clGHyOn3m02PbW9BQDUTqSGBLH5cpW3fskRqnm7DQ/aV52Qy6MHHqTC205I2F17UUlG7SBbvwEz9z7Q12/Hx5KMYjVts4D8DH6mFb7IqbxCocciREfR+32rWHmZyf1k239oXPHQyPU2DXOuAOgzGDs9wQCsCae020rDDYj1SiG1plfRgCJkLi2qLjcU9TLjZVZ9CYocy0sjQdf+zSz/tHGLb+Lzor8s/vJi3MJLnJ0jvRy7O0Cw/CAPU/vHDUx3iUzn4sQXccBHpBqqik7w0PUfr1jxRzqpGO/WNEQPFxwMVitomHzHkqHrEnQkI5TrmOi4nTpRDW5jouDOnRmIV2jq3ESdFQJ68YJJnToASkLqZFr7S1wonTobBErMRrG3M6dEAKxkynV0nTowi3Qpt8QBi0FpcAonToEbr2VPO9gQhTUjAnTpROWniGyTp0ZK+uwBgb/AEE6dIqofpEwy4X4hn1nToqccbxQMhRH7a7zyAnToYlXVq0ZVA3ETp0mnB1LVcaxilQXOAIk6HxSSjSAEra+8moiTppZuJnRy3vAeJklWXOQZ06R8KO+IesBlnTo7Q//2Q=="},sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/mffpecofor.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"sh_reg_eco",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"shp"},ogcFilters:{enabled:!0,editable:!0,filters:{operator:"PropertyIsEqualTo",propertyName:"code_municipalite",expression:"10043"}}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"WFS ",visible:!0,source:e}))}),this.layerService.createAsyncLayer({sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"MELS_CS_ANGLO_S",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"R\xe9seau routier",visible:!1,sourceOptions:{type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",params:{LAYERS:"bgr_v_sous_route_res_sup_act",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"lieu habit\xe9",visible:!1,sourceOptions:{type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",optionsFromCapabilities:!0,params:{LAYERS:"lieuhabite",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"2 styles nurc:Arc_Sample_Parent",visible:!0,legendOptions:{display:!0,stylesAvailable:[{name:"rain",title:"Pluie"},{name:"raster",title:"D\xe9faut"}]},sourceOptions:{type:"wms",url:"https://demo.geo-solutions.it/geoserver/ows",optionsFromCapabilities:!0,params:{LAYERS:"nurc:Arc_Sample",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"Avertissements routier",visible:!1,sourceOptions:{type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",params:{LAYERS:"evenements",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",refreshIntervalSec:15,params:{LAYERS:"vg_observation_v_inondation_embacle_wmst",VERSION:"1.3.0"}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle",visible:!0,source:e,metadata:{url:"https://www.donneesquebec.ca/recherche/fr/dataset/historique-publique-d-embacles-repertories-au-msp",extern:!0}}))})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ne),r.Y36(kc),r.Y36(yu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-legend"]],decls:17,vars:8,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/layer"],[3,"map","view"],["color","primary",3,"map"],["title","Legends"],[3,"layers","excludeBaseLayers","allowShowAllLegends","updateLegendOnResolutionChange","showAllLegendsValue"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Simple Map with a legend list"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"hr"),r.qZA(),r.TgZ(13,"igo-map-browser",1),r._UZ(14,"igo-zoom-button",2),r.qZA(),r.TgZ(15,"igo-panel",3),r._UZ(16,"igo-layer-legend-list",4),r.qZA(),r.qZA()),2&e&&(r.xp6(13),r.Q6J("map",t.map)("view",t.view),r.xp6(1),r.Q6J("map",t.map),r.xp6(2),r.Q6J("layers",t.map.layers)("excludeBaseLayers",!0)("allowShowAllLegends",!0)("updateLegendOnResolutionChange",!1)("showAllLegendsValue",!1))},directives:[g.a8,g.$j,g.n5,g.dn,ou,uu,Ri,sd],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),e})()}]);let $x=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[_x,g.QW,n.ot,a.Ps,Ui,Dy,cd,Nf,wl,qd]]}),e})();const qx=d.Bz.forChild([{path:"overlay",component:(()=>{class e{constructor(e,t,o){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.map=new eu({overlay:!0,controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:6}}ngOnInit(){this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e}))})}ngAfterViewInit(){this.map.overlay.setFeatures([{type:Sl,projection:"EPSG:4326",meta:{id:1},properties:{},geometry:{type:"Point",coordinates:[-73,46.6]}},{type:Sl,projection:"EPSG:4326",meta:{id:2},properties:{},geometry:{type:"LineString",coordinates:[[-72,47.8],[-73.5,47.4],[-72.4,48.6]]}},{type:Sl,projection:"EPSG:4326",meta:{id:3},properties:{},geometry:{type:"Polygon",coordinates:[[[-71,46.8],[-73,47],[-71.2,46.6]]]}}],Cl.None)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ne),r.Y36(kc),r.Y36(yu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-overlay"]],decls:15,vars:3,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/overlay"],[3,"map","view"],["color","primary",3,"map"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Overlay"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"hr"),r.qZA(),r.TgZ(13,"igo-map-browser",1),r._UZ(14,"igo-zoom-button",2),r.qZA(),r.qZA()),2&e&&(r.xp6(13),r.Q6J("map",t.map)("view",t.view),r.xp6(1),r.Q6J("map",t.map))},directives:[g.a8,g.$j,g.n5,g.dn,ou,uu],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}"]}),e})()}]);let Dx=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[qx,g.QW,n.ot,Dy,Gy]]}),e})();function Ex(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-form",4),r.NdJ("submitForm",function(t){return r.CHM(e),r.oxw().onSubmit(t)}),r.ALo(1,"async"),r._UZ(2,"igo-form-group",5),r.TgZ(3,"div",6),r.TgZ(4,"button",7),r.NdJ("click",function(){return r.CHM(e),r.oxw().fillForm()}),r._uU(5," Fill Form "),r.qZA(),r.TgZ(6,"button",7),r.NdJ("click",function(){return r.CHM(e),r.oxw().clearForm()}),r._uU(7," Clear Form "),r.qZA(),r.TgZ(8,"button",8),r._uU(9," Submit "),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=t.ngIf,o=r.oxw();r.Q6J("form",e)("formData",r.lcZ(1,4,o.data$)),r.xp6(2),r.Q6J("group",e.groups[0]),r.xp6(6),r.Q6J("disabled",o.submitDisabled)}}const Rx=d.Bz.forChild([{path:"geometry",component:(()=>{class e{constructor(e,t,o,i){this.languageService=e,this.formService=t,this.dataSourceService=o,this.layerService=i,this.map=new eu({controls:{attribution:{collapsed:!0},scaleLine:!0}}),this.view={center:[-73,47.2],zoom:15},this.form$=new C.X(void 0),this.data$=new C.X(void 0),this.submitDisabled=!0}ngOnInit(){this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e}))});const e=[{name:"geometry",title:"Geometry",options:{validator:ze.kI.required},type:"geometry",inputs:{map:this.map,geometryTypeField:!0,geometryType:"Polygon",drawGuideField:!0,drawGuide:50,drawGuidePlaceholder:"Draw Guide",drawStyle:new Dn.ZP({stroke:new Nn.Z({color:[255,0,0,1],width:2}),fill:new Rn.Z({color:[255,0,0,.2]}),image:new Jn.Z({radius:8,stroke:new Nn.Z({color:[255,0,0,1]}),fill:new Rn.Z({color:[255,0,0,.2]})})})}},{name:"name",title:"Name",options:{validator:ze.kI.required}}].map(e=>this.formService.field(e)),t=this.formService.form([],[this.formService.group({name:"info"},e)]);this.valueChanges$$=t.control.valueChanges.subscribe(()=>{this.submitDisabled=!t.control.valid}),this.form$.next(t)}ngOnDestroy(){this.valueChanges$$.unsubscribe()}fillForm(){this.data$.next({name:"Place",geometry:JSON.stringify({type:"Polygon",coordinates:[[[-106,42],[-107,31],[-81,32],[-82,42],[-106,42]]]})})}clearForm(){this.form$.value.control.reset()}onSubmit(e){alert(JSON.stringify(e))}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ne),r.Y36(ri),r.Y36(kc),r.Y36(yu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-geometry"]],decls:13,vars:6,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/form"],[3,"map","view"],["color","primary",3,"map"],[3,"form","formData","submitForm",4,"ngIf"],[3,"form","formData","submitForm"],[3,"group"],["formButtons",""],["mat-stroked-button","","type","button","color","primary",3,"click"],["mat-flat-button","","type","submit","color","primary",3,"disabled"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Geometry Form"),r.qZA(),r.TgZ(5,"mat-card-content"),r._uU(6," See the "),r.TgZ(7,"a",0),r._uU(8,"code of this example"),r.qZA(),r.qZA(),r.TgZ(9,"igo-map-browser",1),r._UZ(10,"igo-zoom-button",2),r.qZA(),r.YNc(11,Ex,10,6,"igo-form",3),r.ALo(12,"async"),r.qZA()),2&e&&(r.xp6(9),r.Q6J("map",t.map)("view",t.view),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("ngIf",r.lcZ(12,4,t.form$)))},directives:[g.a8,g.$j,g.n5,g.dn,ou,uu,h.O5,oi,hi,n.lW],pipes:[h.Ov],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}igo-map-browser[_ngcontent-%COMP%]{width:500px;height:500px}"]}),e})()}]);let Ux=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,Rx,n.ot,g.QW,mi,Yh,Dy]]}),e})();const Nx=d.Bz.forChild([{path:"feature",component:(()=>{class e{constructor(e,t,o){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.map=new eu({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:6},this.tableTemplate={selection:!0,selectMany:!0,sort:!0,columns:[{name:"properties.id",title:"ID"},{name:"properties.name",title:"Name"},{name:"properties.description",title:"Description"}]},this.store=new Ec([],{map:this.map})}ngOnInit(){const e=new Nc({});this.store.addStrategy(e);const t=new jc({map:this.map,motion:Cl.Default});this.store.addStrategy(t),this.store.load([{meta:{id:1},type:"Feature",geometry:{type:"Point",coordinates:[-72,47.8]},projection:"EPSG:4326",properties:{id:1,name:"Name 1",description:"Description 1"}},{meta:{id:2},type:"Feature",geometry:{type:"LineString",coordinates:[[-72,47.8],[-73.5,47.4],[-72.4,48.6]]},projection:"EPSG:4326",properties:{id:2,name:"Name 2",description:"Description 2"}},{meta:{id:3},type:"Feature",geometry:{type:"Polygon",coordinates:[[[-71,46.8],[-73,47],[-71.2,46.6]]]},projection:"EPSG:4326",properties:{id:3,name:"Name 3",description:"Description 3"}}]),this.layerService.createAsyncLayer({title:"MVT test",visible:!0,sourceOptions:{type:"mvt",url:"https://ahocevar.com/geoserver/gwc/service/tms/1.0.0/ne:ne_10m_admin_0_countries@EPSG:900913@pbf/{z}/{x}/{-y}.pbf",queryable:!0},mapboxStyle:{url:"assets/mapboxStyleExample-vectortile.json",source:"ahocevar"}}).subscribe(e=>this.map.addLayer(e)),this.dataSourceService.createAsyncDataSource({type:"vector"}).subscribe(o=>{const i=this.layerService.createLayer({title:"Vector Layer",source:o,animation:{duration:2e3},mapboxStyle:{url:"assets/mapboxStyleExample-feature.json",source:"source_nameX"}});this.map.addLayer(i),this.store.bindLayer(i),e.activate(),t.activate()})}ngOnDestroy(){this.store.destroy()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ne),r.Y36(kc),r.Y36(yu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-feature"]],decls:12,vars:5,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geom/feature"],[3,"map","view"],["color","primary",3,"map"],[3,"store","template"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Feature"),r.qZA(),r.TgZ(5,"mat-card-content"),r._uU(6," See the "),r.TgZ(7,"a",0),r._uU(8,"code of this example"),r.qZA(),r.qZA(),r.TgZ(9,"igo-map-browser",1),r._UZ(10,"igo-zoom-button",2),r.qZA(),r._UZ(11,"igo-entity-table",3),r.qZA()),2&e&&(r.xp6(9),r.Q6J("map",t.map)("view",t.view),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("store",t.store)("template",t.tableTemplate))},directives:[g.a8,g.$j,g.n5,g.dn,ou,uu,no],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),e})()}]);let Jx=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[Nx,h.ez,g.QW,n.ot,a.Ps,Ui,xi,Dy,Dh]]}),e})();const Bx=d.Bz.forChild([{path:"hover",component:(()=>{class e{constructor(e,t,o,i){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.mediaService=i,this.pointerCoordDelay=0,this.pointerHoverFeatureDelay=0,this.map=new eu({controls:{attribution:{collapsed:!0},scaleLine:!0}}),this.view={center:[-73,47.2],zoom:8,projection:"EPSG:3857"},this.dataSourceService.createAsyncDataSource({type:"wmts",url:"https://geoegl.msp.gouv.qc.ca/apis/carto/wmts/1.0.0/wmts",layer:"carte_gouv_qc_public",matrixSet:"EPSG_3857",version:"1.3.0"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Quebec",visible:!0,baseLayer:!0,source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"adn_bassin_n1_public_v",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"3.0.0",outputFormat:void 0,outputFormatDownload:"shp"}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"WFS (polygon)",visible:!0,source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"CASERNE",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"3.0.0",outputFormat:void 0,outputFormatDownload:"shp"}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"WFS (point)",visible:!0,source:e,styleByAttribute:{attribute:"en_caserne",data:["true","false"],stroke:["red","blue"],fill:["#ffffff","#ffffff"],radius:[7,7],width:[2,2],hoverStyle:{label:{attribute:"Caserne: ${nom_service_incendie}\xa0\n Mun: ${ville}",style:{textAlign:"left",textBaseline:"bottom",font:"12px Calibri,sans-serif",fill:{color:"#000"},backgroundFill:{color:"rgba(255, 255, 255, 0.5)"},backgroundStroke:{color:"rgba(200, 200, 200, 0.75)",width:2},stroke:{color:"#fff",width:3},overflow:!0,offsetX:10,offsetY:-10,padding:[2.5,2.5,2.5,2.5]}},baseStyle:{circle:{stroke:{color:"orange",width:5},width:[5],radius:15}}}}}))})}get media(){return this.mediaService.getMedia()}get isTouchScreen(){return this.mediaService.isTouchScreen()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ne),r.Y36(kc),r.Y36(yu),r.Y36(me))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-hover"]],decls:17,vars:8,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/hover"],["igoHoverFeature","",3,"map","view","igoHoverFeatureDelay","igoHoverFeatureEnabled"],["color","primary",3,"map"],["color","primary",3,"map","showIfNoRotation"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Hover"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"hr"),r.qZA(),r.TgZ(13,"igo-map-browser",1),r._UZ(14,"igo-zoom-button",2),r._UZ(15,"igo-geolocate-button",2),r._UZ(16,"igo-rotation-button",3),r.qZA(),r.qZA()),2&e&&(r.xp6(13),r.Q6J("map",t.map)("view",t.view)("igoHoverFeatureDelay",t.pointerHoverFeatureDelay)("igoHoverFeatureEnabled",!0),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("map",t.map)("showIfNoRotation",!0))},directives:[g.a8,g.$j,g.n5,g.dn,ou,au,uu,pu,Cu],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:500px}"]}),e})()}]);let jx=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,Bx,g.QW,n.ot,Dy]]}),e})();const Gx=d.Bz.forChild([{path:"measure",component:(()=>{class e{constructor(e,t,o){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.map=new eu({controls:{attribution:{collapsed:!0},scaleLine:!0}}),this.view={center:[-73,47.2],zoom:6,projection:"EPSG:3857"},this.store=new Ec([],{map:this.map}),this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e}))})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ne),r.Y36(kc),r.Y36(yu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-measure"]],decls:16,vars:5,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/measure"],[3,"map","view"],["color","primary",3,"map"],[3,"store","map"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Simple Map"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"hr"),r.qZA(),r.TgZ(13,"igo-map-browser",1),r._UZ(14,"igo-zoom-button",2),r.qZA(),r._UZ(15,"igo-measurer",3),r.qZA()),2&e&&(r.xp6(13),r.Q6J("map",t.map)("view",t.view),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("store",t.store)("map",t.map))},directives:[g.a8,g.$j,g.n5,g.dn,ou,uu,Bh],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-measurer[_ngcontent-%COMP%]     mat-divider{position:inherit!important;left:inherit!important;width:160px!important}"]}),e})()}]);let Qx=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[Gx,g.QW,Dy,Ny]]}),e})();const zx=d.Bz.forChild([{path:"draw",component:(()=>{class e{constructor(e,t,o){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.map=new eu({controls:{attribution:{collapsed:!0},scaleLine:!0}}),this.view={center:[-73,47.2],zoom:6,projection:"EPSG:3857"},this.store=new Ec([],{map:this.map}),this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e}))})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ne),r.Y36(kc),r.Y36(yu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-draw"]],decls:16,vars:5,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/draw"],[3,"map","view"],["color","primary",3,"map"],[3,"store","map"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Simple Map"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"hr"),r.qZA(),r.TgZ(13,"igo-map-browser",1),r._UZ(14,"igo-zoom-button",2),r.qZA(),r._UZ(15,"igo-draw",3),r.qZA()),2&e&&(r.xp6(13),r.Q6J("map",t.map)("view",t.view),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("store",t.store)("map",t.map))},directives:[g.a8,g.$j,g.n5,g.dn,ou,uu,Ph],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-draw[_ngcontent-%COMP%]     mat-divider{position:inherit!important;left:inherit!important;width:160px!important}"]}),e})()}]);let Yx=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[zx,g.QW,Dy,_h]]}),e})();function Hx(e,t){if(1&e&&(r.ynx(0),r.TgZ(1,"h1"),r._uU(2,"Query Title : "),r.TgZ(3,"span",5),r._uU(4),r.qZA(),r.qZA(),r._UZ(5,"igo-feature-details",6),r.BQk()),2&e){const e=t.ngIf,o=r.oxw();r.xp6(4),r.Oqu(o.getTitle(e)),r.xp6(1),r.Q6J("feature",e)}}const Vx=d.Bz.forChild([{path:"query",component:(()=>{class e{constructor(e,t,o,i){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.overlayService=i,this.feature$=new C.X(void 0),this.map=new eu({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:6},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",queryable:!0,queryTitle:"num_rts",params:{layers:"bgr_v_sous_route_res_sup_act",version:"1.3.0"}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"WMS",source:e,sourceOptions:e.options}))}),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",queryable:!0,queryFormat:Nl.HTMLGML2,queryHtmlTarget:Bl.IFRAME,params:{layers:"bgr_v_sous_route_res_sup_act",version:"1.3.0"}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"WMS html with a pre call in GML",source:e,sourceOptions:e.options}))}),this.dataSourceService.createAsyncDataSource({type:"vector",queryable:!0,queryTitle:"So beautiful ${name}",sourceFields:[{name:"name",alias:"Alias name"},{name:"description",alias:"Alias description"}]}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Vector Layer",source:e,sourceOptions:e.options})),this.addFeatures(e)})}addFeatures(e){const t=new Tn.Z({name:"feature1",geometry:new zn.Z([Fn.vs([-72,47.8],"EPSG:4326","EPSG:3857"),Fn.vs([-73.5,47.4],"EPSG:4326","EPSG:3857"),Fn.vs([-72.4,48.6],"EPSG:4326","EPSG:3857")])}),o=new Tn.Z({name:"feature2",geometry:new Qn.Z(Fn.vs([-73,46.6],"EPSG:4326","EPSG:3857"))}),i=new Tn.Z({name:"feature3",geometry:new Gn.ZP([[Fn.vs([-71,46.8],"EPSG:4326","EPSG:3857"),Fn.vs([-73,47],"EPSG:4326","EPSG:3857"),Fn.vs([-71.2,46.6],"EPSG:4326","EPSG:3857")]])});e.ol.addFeatures([t,o,i])}handleQueryResults(e){const t=e.features;let o;t.length&&(o=t[0]),this.feature$.next(o),this.map.queryResultsOverlay.setFeatures([o],Cl.None)}getTitle(e){return rt(e)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ne),r.Y36(kc),r.Y36(yu),r.Y36(By))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-query"]],decls:18,vars:7,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/query"],["igoOverlay","","igoQuery","",3,"map","view","queryFeatures","query"],["color","primary",3,"map"],["title","Details"],[4,"ngIf"],[2,"background-color","#e0e0e0"],[3,"feature"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Query"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"hr"),r.qZA(),r.TgZ(13,"igo-map-browser",1),r.NdJ("query",function(e){return t.handleQueryResults(e)}),r._UZ(14,"igo-zoom-button",2),r.qZA(),r.TgZ(15,"igo-panel",3),r.YNc(16,Hx,6,2,"ng-container",4),r.ALo(17,"async"),r.qZA(),r.qZA()),2&e&&(r.xp6(13),r.Q6J("map",t.map)("view",t.view)("queryFeatures",!0),r.xp6(1),r.Q6J("map",t.map),r.xp6(2),r.Q6J("ngIf",r.lcZ(17,5,t.feature$)))},directives:[g.a8,g.$j,g.n5,g.dn,ou,jy,Du,uu,Ri,h.O5,Yd],pipes:[h.Ov],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),e})()}]);let Wx=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[Vx,h.ez,g.QW,n.ot,a.Ps,Ui,Dy,Gy,cv,Dh]]}),e})();const Xx=d.Bz.forChild([{path:"catalog",component:(()=>{class e{constructor(e,t,o,i,r){this.configService=e,this.languageService=t,this.layerService=o,this.catalogService=i,this.storageService=r,this.map=new eu({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:7},this.catalogStore=new lt([]),this.catalogItemStore=new lt([])}ngOnInit(){this.layerService.createAsyncLayer({title:"OSM",sourceOptions:{type:"osm"}}).subscribe(e=>this.map.addLayer(e)),this.loadCatalogs()}onCatalogSelectChange(e){this.loadCatalogItems(e.catalog)}loadCatalogs(){this.catalogService.loadCatalogs().subscribe(e=>{this.catalogStore.clear(),this.catalogStore.load(e.concat(this.storageService.get("addedCatalogs")||[]))})}loadCatalogItems(e){this.catalogService.loadCatalogItems(e).subscribe(e=>{this.catalogItemStore.clear(),this.catalogItemStore.load(e)})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(z),r.Y36(ne),r.Y36(yu),r.Y36(Ju),r.Y36(ve))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-catalog"]],decls:23,vars:6,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/catalog"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/environments"],[3,"map","view"],["color","primary",3,"map"],["title","Catalog Library"],[3,"store","catalogSelectChange"],["title","Catalog Browser"],[3,"store","map"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Catalog"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: ConfigService, LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"br"),r._uU(13," See catalog section of the "),r.TgZ(14,"a",1),r._uU(15," environment config"),r.qZA(),r._UZ(16,"hr"),r.qZA(),r.TgZ(17,"igo-map-browser",2),r._UZ(18,"igo-zoom-button",3),r.qZA(),r.TgZ(19,"igo-panel",4),r.TgZ(20,"igo-catalog-library",5),r.NdJ("catalogSelectChange",function(e){return t.onCatalogSelectChange(e)}),r.qZA(),r.qZA(),r.TgZ(21,"igo-panel",6),r._UZ(22,"igo-catalog-browser",7),r.qZA(),r.qZA()),2&e&&(r.xp6(17),r.Q6J("map",t.map)("view",t.view),r.xp6(1),r.Q6J("map",t.map),r.xp6(2),r.Q6J("store",t.catalogStore),r.xp6(2),r.Q6J("store",t.catalogItemStore)("map",t.map))},directives:[g.a8,g.$j,g.n5,g.dn,ou,uu,Ri,xd,Qu],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}"]}),e})()}]);let Kx=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[H({default:Jr.igo})],imports:[[h.ez,Xx,g.QW,n.ot,a.Ps,p.AV,W,Ui,Dy,Zd]]}),e})();var ew=o(96330);Error,Error;var tw=(()=>{return(e=tw||(tw={}))[e.null=0]="null",e[e.read=1]="read",e[e.write=2]="write",tw;var e})();let ow=(()=>{class e{constructor(e,t,o,i,r,s){this.http=e,this.authService=t,this.languageService=o,this.config=i,this.messageService=r,this.route=s,this.context$=new C.X(void 0),this.contexts$=new C.X({ours:[]}),this.defaultContextId$=new C.X(void 0),this.editedContext$=new C.X(void 0),this.importedContext=[],this.toolsChanged$=new O.xQ,this.mapViewFromRoute={},this.options=Object.assign({basePath:"contexts",contextListFile:"_contexts.json",defaultContextUri:"_default"},this.config.getConfig("context")),this.baseUrl=this.options.url,this.readParamsFromRoute(),this.authService.hasAuthService?this.authService.logged$.subscribe(e=>{e&&(this.contexts$.pipe((0,Ae.T)(1),(0,vn.P)()).subscribe(e=>{this.handleContextsChange()}),this.loadContexts())}):(this.loadContexts(),this.handleContextsChange(!1))}get defaultContextUri(){return this._defaultContextUri||this.options.defaultContextUri}set defaultContextUri(e){this._defaultContextUri=e}get(e,t){let o=this.baseUrl+"/contexts";return e&&this.authService.authenticated&&(o+="?permission="+e.join(),t&&(o+="&hidden=true")),this.http.get(o)}getById(e){return this.http.get(this.baseUrl+"/contexts/"+e)}getDetails(e){return this.http.get(`${this.baseUrl}/contexts/${e}/details`).pipe((0,b.K)(t=>this.handleError(t,e)))}getDefault(){return this.http.get(this.baseUrl+"/contexts/default").pipe((0,Le.b)(e=>{this.defaultContextId$.next(e.id)}))}getProfilByUser(){return this.baseUrl?this.http.get(this.baseUrl+"/profils?"):(0,A.of)([])}setDefault(e){return this.http.post(this.baseUrl+"/contexts/default",{defaultContextId:e})}hideContext(e){return this.http.post(this.baseUrl+"/contexts/"+e+"/hide",{})}showContext(e){return this.http.post(this.baseUrl+"/contexts/"+e+"/show",{})}delete(e,t=!1){const o={ours:[]};return Object.keys(this.contexts$.value).forEach(t=>o[t]=this.contexts$.value[t].filter(t=>t.id!==e)),t?(this.importedContext=this.importedContext.filter(t=>t.id!==e),(0,A.of)(this.contexts$.next(o))):this.http.delete(this.baseUrl+"/contexts/"+e).pipe((0,Le.b)(e=>{this.contexts$.next(o)}))}create(e){return this.http.post(this.baseUrl+"/contexts",e).pipe((0,x.U)(e=>(e.permission=this.authService.authenticated?tw[tw.write]:tw[tw.read],this.contexts$.value.ours.unshift(e),this.contexts$.next(this.contexts$.value),e)))}clone(e,t={}){return this.http.post(this.baseUrl+"/contexts/"+e+"/clone",t).pipe((0,x.U)(e=>(e.permission=tw[tw.write],this.contexts$.value.ours.unshift(e),this.contexts$.next(this.contexts$.value),e)))}update(e,t){return this.http.patch(this.baseUrl+"/contexts/"+e,t)}addToolAssociation(e,t){return this.http.post(`${this.baseUrl}/contexts/${e}/tools`,{toolId:t})}deleteToolAssociation(e,t){return this.http.delete(`${this.baseUrl}/contexts/${e}/tools/${t}`)}getPermissions(e){return this.http.get(this.baseUrl+"/contexts/"+e+"/permissions")}addPermissionAssociation(e,t,o){return this.http.post(`${this.baseUrl}/contexts/${e}/permissions`,{profil:t,typePermission:o}).pipe((0,b.K)(e=>[this.handleError(e,void 0,!0)]))}deletePermissionAssociation(e,t){return this.http.delete(`${this.baseUrl}/contexts/${e}/permissions/${t}`)}getLocalContexts(){const e=this.getPath(this.options.contextListFile);return this.http.get(e).pipe((0,x.U)(e=>({ours:e})))}getLocalContext(e){const t=this.getPath(`${e}.json`);return this.http.get(t).pipe((0,Fe.zg)(t=>{if(!t.base)return(0,A.of)(t);const o=this.getPath(`${t.base}.json`);return this.http.get(o).pipe((0,x.U)(e=>{const o=t;return o.map=_.mergeDeep(e.map,t.map),o.layers=(e.layers||[]).concat(t.layers||[]).reverse().filter((e,t,o)=>!e.id||o.findIndex(t=>t.id===e.id)===t).reverse(),o.toolbar=t.toolbar||e.toolbar,o.message=t.message||e.message,o.messages=t.messages||e.messages,o.tools=(t.tools||[]).concat(e.tools||[]).filter((e,t,o)=>o.findIndex(t=>t.name===e.name)===t),o}),(0,b.K)(t=>this.handleError(t,e)))}),(0,b.K)(t=>this.handleError(t,e)))}loadContexts(e,t){let o;o=this.baseUrl?this.get(e,t):this.getLocalContexts(),o.subscribe(e=>{e.ours=this.importedContext.concat(e.ours),this.contexts$.next(e)})}loadDefaultContext(){const e=(e=!1)=>{!e&&this.baseUrl&&this.authService.authenticated?this.getDefault().subscribe(e=>{this.defaultContextUri=e.uri,this.addContextToList(e),this.setContext(e)},()=>{this.defaultContextId$.next(void 0),this.loadContext(this.defaultContextUri)}):this.loadContext(this.defaultContextUri)};this.route&&this.route.options.contextKey?this.route.queryParams.pipe((0,w.b)(100)).subscribe(t=>{const o=t[this.route.options.contextKey];let i=!1;o&&(this.defaultContextUri=o,i=!0),e(i)}):e()}loadContext(e){const t=this.context$.value;t&&t.uri===e||this.getContextByUri(e).pipe((0,vn.P)()).subscribe(e=>{this.addContextToList(e),this.setContext(e)},t=>{e!==this.options.defaultContextUri&&this.loadContext(this.options.defaultContextUri)})}setContext(e){this.handleContextMessage(e);const t=this.context$.value;if(t&&e&&e.id===t.id)return void 0===e.map.view.keepCurrentView&&(e.map.view.keepCurrentView=!0),void this.context$.next(e);e.map||(e.map={view:{}}),Object.assign(e.map.view,this.mapViewFromRoute),this.context$.next(e)}loadEditedContext(e){this.getContextByUri(e).subscribe(e=>{this.setEditedContext(e)})}setEditedContext(e){this.editedContext$.next(e)}getContextFromMap(e,t){const o=e.ol.getView(),i=o.getProjection().getCode(),r=new Qn.Z(o.getCenter()).transform(i,"EPSG:4326"),s={uri:D(),title:"",scope:"private",map:{view:{center:r.getCoordinates(),zoom:o.getZoom(),projection:i,maxZoomOnExtent:e.viewController.maxZoomOnExtent}},layers:[],tools:[]};let n=[];n=!0===t?e.layers$.getValue().filter(e=>!0===e.baseLayer||"searchPointerSummaryId"===e.options.id).sort((e,t)=>e.zIndex-t.zIndex):e.layers$.getValue().sort((e,t)=>e.zIndex-t.zIndex);let a=0;for(const l of n){const e=l,t={id:e.options.id?String(e.options.id):void 0,layerOptions:{title:e.options.title,zIndex:++a,visible:e.visible},sourceOptions:{type:e.dataSource.options.type,params:e.dataSource.options.params,url:e.dataSource.options.url,queryable:e.queryable}};t.sourceOptions.type&&s.layers.push(t)}return s.tools=this.tools.map(e=>({id:String(e.id),global:e.global})),s}getContextFromLayers(e,t,o){const i=this.context$.getValue(),r=e.ol.getView(),s=r.getProjection().getCode(),n={uri:o,title:o,map:{view:{center:new Qn.Z(r.getCenter()).transform(s,"EPSG:4326").getCoordinates(),zoom:r.getZoom(),projection:s}},layers:[],toolbar:[],tools:[],extraFeatures:[]},a=e.layers$.getValue();return n.layers=a.filter(e=>e.baseLayer).map(e=>({baseLayer:!0,sourceOptions:e.options.sourceOptions,title:e.options.title,visible:e.visible})),t.forEach(e=>{const t=i.layers.find(t=>e.id===t.source.id&&!t.baseLayer);if(t){let o=t.style;t.styleByAttribute?o=void 0:t.clusterBaseStyle&&(o=void 0,delete t.sourceOptions.source,delete t.sourceOptions.format),n.layers.push({baseLayer:t.baseLayer,title:e.options.title,zIndex:e.zIndex,styleByAttribute:t.styleByAttribute,clusterBaseStyle:t.clusterBaseStyle,style:o,clusterParam:t.clusterParam,visible:e.visible,opacity:e.opacity,sourceOptions:t.sourceOptions})}else if(e.ol.getSource()instanceof wa.Z){let t;const o=new Yn.Z;if(e.ol.getSource()instanceof xa.Z){const i=e.ol.getSource();t=o.writeFeatures(i.getFeatures(),{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"})}t=JSON.parse(t),t.name=e.options.title,n.extraFeatures.push(t)}else{const t=e.options;t.zIndex=e.zIndex,delete t.source,n.layers.push(t)}}),n.toolbar=this.toolbar,n.tools=this.tools,n}setTools(e){this.tools=e}setToolbar(e){this.toolbar=e}handleContextMessage(e){this.contextMessage&&this.messageService.remove(this.contextMessage.id),this.context$.value&&e.uri&&this.context$.value.uri!==e.uri&&this.messageService.removeAllAreNotError(),e.messages=e.messages?e.messages:[],e.messages.push(e.message),e.messages.map(e=>{e&&(e.title=e.title?this.languageService.translate.instant(e.title):void 0,e.text=e.text?this.languageService.translate.instant(e.text):void 0,this.messageService.message(e))})}getContextByUri(e){if(this.baseUrl){let t;for(const o of Object.keys(this.contexts$.value))if(t=this.contexts$.value[o].find(t=>t.uri===e),t)break;return t&&t.imported?(0,A.of)(t):this.getDetails(t?t.id:e)}const t=this.contexts$.value.ours.find(t=>t.uri===e&&!0===t.imported);return t?(0,A.of)(t):this.getLocalContext(e)}getContextLayers(e){const t=[];return e.layers$.getValue().forEach(e=>{!e.baseLayer&&"searchPointerSummaryId"!==e.options.id&&t.push(e)}),t}readParamsFromRoute(){!this.route||this.route.queryParams.subscribe(e=>{const t=this.route.options.centerKey;t&&e[t]&&(this.mapViewFromRoute.center=e[t].split(",").map(Number),this.mapViewFromRoute.geolocate=!1);const o=this.route.options.projectionKey;o&&e[o]&&(this.mapViewFromRoute.projection=e[o]);const i=this.route.options.zoomKey;i&&e[i]&&(this.mapViewFromRoute.zoom=Number(e[i]))})}getPath(e){return`${this.options.basePath.replace(/\/$/,"")}/${e}`}handleError(e,t,o){const i=this.contexts$.value.ours.find(e=>e.uri===t),r=i?i.title:t;throw e.error.title=this.languageService.translate.instant("igo.context.contextManager.invalid.title"),e.error.message=this.languageService.translate.instant("igo.context.contextManager.invalid.text",{value:r}),e.error.toDisplay=!0,o&&(e.error.title=this.languageService.translate.instant("igo.context.contextManager.errors.addPermissionTitle"),e.error.message=this.languageService.translate.instant("igo.context.contextManager.errors.addPermission")),e}handleContextsChange(e=!0){const t=this.context$.value,o=this.editedContext$.value;(!t||t.uri===this.options.defaultContextUri)&&(e=!1),e&&this.findContext(t)?(this.getContextByUri(t.uri).pipe((0,vn.P)()).subscribe(e=>{this.toolsChanged$.next(e)}),this.baseUrl&&this.authService.authenticated&&this.getDefault().subscribe()):(this.defaultContextUri=void 0,this.loadDefaultContext());const i=this.findContext(o);(!i||"write"!==i.permission)&&this.setEditedContext(void 0)}addContextToList(e){if(!this.findContext(e)){const t={id:e.id,uri:e.uri,title:e.title,scope:e.scope,permission:tw[tw.read]};this.contexts$.value&&this.contexts$.value.public&&(this.contexts$.value.public.push(t),this.contexts$.next(this.contexts$.value))}}findContext(e){if(!e)return!1;const t=this.contexts$.value;let o;for(const i of Object.keys(t))if(o=t[i].find(t=>e.id&&t.id===e.id||e.uri&&t.uri===e.uri),o)break;return o}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG($s),r.LFG(ne),r.LFG(z),r.LFG(le),r.LFG(de,8))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),iw=(()=>{class e{static forRoot(){return{ngModule:e}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[ze.u5,ze.UX,h.ez,n.ot,Ha.vV,Ga.t,sl.Nh,_e.LD,$e.Ng,Pe.lN,Qe.c,m.p9,oe,ji,p.AV]]}),e})(),rw=(()=>{class e{constructor(e,t,o){this.contextService=t,this.mediaService=o,this.component=e}get map(){return this.component.map}ngOnInit(){this.context$$=this.contextService.context$.pipe((0,Ie.h)(e=>void 0!==e)).subscribe(e=>this.handleContextChange(e))}ngOnDestroy(){this.context$$.unsubscribe()}handleContextChange(e){if(void 0===e.map)return;const t=e.map.view;(!this.component.view||!0!==t.keepCurrentView)&&(this.component.view=t);const o=e.map.controls;if(!this.component.controls&&o){if(this.mediaService.isMobile()&&"boolean"!=typeof o.scaleLine){const e=o.scaleLine;e.minWidth||(e.minWidth=Math.min(64,e.minWidth),o.scaleLine=e)}this.component.controls=o}}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ou),r.Y36(ow),r.Y36(me))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoMapContext",""]]}),e})(),sw=(()=>{class e{constructor(e,t,o,i,r,s,n){this.component=e,this.contextService=t,this.layerService=o,this.configService=i,this.styleListService=r,this.styleService=s,this.route=n,this.contextLayers=[],this.removeLayersOnContextChange=!0}get map(){return this.component.map}ngOnInit(){if(this.context$$=this.contextService.context$.pipe((0,Ie.h)(e=>void 0!==e)).subscribe(e=>this.handleContextChange(e)),this.route&&this.route.options.visibleOnLayersKey&&this.route.options.visibleOffLayersKey&&this.route.options.contextKey){const e=this.route.queryParams.subscribe(t=>{Object.keys(t).length>0&&(this.queryParams=t,e.unsubscribe())})}}ngOnDestroy(){this.context$$.unsubscribe()}handleContextChange(e){if(void 0===e.layers)return;!0===this.removeLayersOnContextChange?this.map.removeAllLayers():this.map.removeLayers(this.contextLayers),this.contextLayers=[];const t=(0,Te.T)(...e.layers.map((t,o)=>this.layerService.createAsyncLayer(t,e.uri)));t.pipe((0,ew.f)(t.pipe((0,w.b)(500)))).subscribe(t=>{t=t.filter(e=>void 0!==e).map(e=>(e.visible=this.computeLayerVisibilityFromUrl(e),e.zIndex=e.zIndex,e)),this.contextLayers.concat(t),this.map.addLayers(t),e.extraFeatures&&e.extraFeatures.forEach(e=>{const t=new Yn.Z,o=e.name;e=JSON.stringify(e),e=t.readFeatures(e,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"}),this.configService.getConfig("importWithStyle")?function(e,t,o,i,r){let s,n,a;if(i.getStyleList(o.toString()+".styleByAttribute")){const e=i.getStyleList(o.toString()+".styleByAttribute");s=t=>r.createStyleByAttribute(t,e)}else if(i.getStyleList(o.toString()+".clusterStyle")){const e=i.getStyleList(o.toString()+".clusterParam");n=i.getStyleList(o.toString()+".distance");const t=r.createStyle(i.getStyleList(o.toString()+".clusterStyle"));s=o=>r.createClusterStyle(o,e,t)}else s=i.getStyleList(o.toString()+".style")?r.createStyle(i.getStyleList(o.toString()+".style")):r.createStyle(i.getStyleList("default.style"));i.getStyleList(o.toString()+".clusterStyle")?(a=new oc({distance:n,type:"cluster",queryable:!0}),a.ol.source.addFeatures(e)):(a=new tc({type:"vector",queryable:!0}),a.ol.addFeatures(e));const l=new uc({title:o,source:a,style:s});t.addLayer(l)}(e,this.map,o,this.styleListService,this.styleService):function(e,t,o){const i=Math.floor(255*Math.random()),r=Math.floor(255*Math.random()),s=Math.floor(255*Math.random()),n=new Nn.Z({color:[i,r,s,1],width:2}),a=new Rn.Z({color:[i,r,s,.4]}),l=new tc({type:"vector",queryable:!0});l.ol.addFeatures(e);const c=new uc({title:o,source:l,style:new Dn.ZP({stroke:n,fill:a,image:new Jn.Z({radius:5,stroke:n,fill:a})})});t.addLayer(c)}(e,this.map,o)})})}computeLayerVisibilityFromUrl(e){const t=this.queryParams,o=e.id;let i=e.visible;if(!t||!o)return i;const r=t[this.route.options.contextKey];if(r===this.contextService.context$.value.uri||!r){let e="",r="",s=[],n=[];this.route.options.visibleOnLayersKey&&t[this.route.options.visibleOnLayersKey]&&(e=t[this.route.options.visibleOnLayersKey]),this.route.options.visibleOffLayersKey&&t[this.route.options.visibleOffLayersKey]&&(r=t[this.route.options.visibleOffLayersKey]),"*"===e&&(i=!0),"*"===r&&(i=!1),s=e.split(","),n=r.split(","),(s.indexOf(o)>-1||s.indexOf(o.toString())>-1)&&(i=!0),(n.indexOf(o)>-1||n.indexOf(o.toString())>-1)&&(i=!1)}return i}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ou),r.Y36(ow),r.Y36(yu),r.Y36(z),r.Y36(uy),r.Y36(Yc),r.Y36(de,8))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoLayerContext",""]],inputs:{removeLayersOnContextChange:"removeLayersOnContextChange"}}),e})();var nw=(()=>{return(e=nw||(nw={})).always="always",e.never="never",e.default="default",nw;var e})();let aw=(()=>{class e{constructor(e){this.dialogRef=e}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(je.so))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-bookmark-dialog"]],decls:14,vars:14,consts:[["mat-dialog-title","",1,"mat-typography"],["mat-dialog-content","",1,"mat-typography"],["matInput","","required","","autocomplete","off","maxlength","128",3,"placeholder","ngModel","ngModelChange"],["mat-dialog-actions",""],["mat-button","","color","primary",3,"disabled","click"],["mat-button","",3,"click"]],template:function(e,t){1&e&&(r.TgZ(0,"h1",0),r._uU(1),r.ALo(2,"translate"),r.qZA(),r.TgZ(3,"div",1),r.TgZ(4,"mat-form-field"),r.TgZ(5,"input",2),r.NdJ("ngModelChange",function(e){return t.title=e}),r.ALo(6,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(7,"div",3),r.TgZ(8,"button",4),r.NdJ("click",function(){return t.dialogRef.close(t.title)}),r._uU(9),r.ALo(10,"translate"),r.qZA(),r.TgZ(11,"button",5),r.NdJ("click",function(){return t.dialogRef.close(!1)}),r._uU(12),r.ALo(13,"translate"),r.qZA(),r.qZA()),2&e&&(r.xp6(1),r.Oqu(r.lcZ(2,6,"igo.context.bookmarkButton.dialog.title")),r.xp6(4),r.Q6J("placeholder",r.lcZ(6,8,"igo.context.bookmarkButton.dialog.placeholder"))("ngModel",t.title),r.xp6(3),r.Q6J("disabled",!t.title),r.xp6(1),r.hij(" ",r.lcZ(10,10,"igo.common.confirmDialog.confirmBtn")," "),r.xp6(3),r.hij(" ",r.lcZ(13,12,"igo.common.confirmDialog.cancelBtn")," "))},directives:[je.uh,je.xY,Pe.KE,Qe.Nt,ze.Fj,ze.Q7,ze.nD,ze.JJ,ze.On,je.H8,n.lW],pipes:[U.X$],encapsulation:2}),e})();function lw(e,t){if(1&e&&r._UZ(0,"mat-icon",7),2&e){const e=r.oxw(2);r.s9C("svgIcon",e.context.icon?e.context.icon:"public"===e.context.scope?"earth":"star")}}function cw(e,t){if(1&e&&r._UZ(0,"img",8),2&e){const e=r.oxw(2);r.Q6J("src",e.context.iconImage,r.LSH)}}function uw(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",4),r.NdJ("click",function(){r.CHM(e);const t=r.oxw();return t.favoriteClick(t.context)}),r.ALo(1,"translate"),r.YNc(2,lw,1,1,"mat-icon",5),r.YNc(3,cw,1,1,"img",6),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("matTooltip",e.auth.authenticated?r.lcZ(1,4,"igo.context.contextManager.favorite"):"")("color",e.default?"primary":"default"),r.xp6(2),r.Q6J("ngIf",!e.context.iconImage),r.xp6(1),r.Q6J("ngIf",e.context.iconImage)}}function pw(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",20),r.NdJ("click",function(){r.CHM(e);const t=r.oxw(2);return t.save.emit(t.context)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",21),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("matTooltip",r.lcZ(1,2,"igo.context.contextManager.save"))("color",e.color)}}function dw(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",22),r.NdJ("click",function(){r.CHM(e);const t=r.oxw(2);return t.managePermissions.emit(t.context)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",23),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("matTooltip",r.lcZ(1,2,"igo.context.contextManager.managePermissions"))("color",e.color)}}function hw(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",24),r.NdJ("click",function(){r.CHM(e);const t=r.oxw(2);return t.clone.emit(t.context)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",25),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("matTooltip",r.lcZ(1,2,"igo.context.contextManager.clone"))("color",e.color)}}function gw(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",26),r.NdJ("click",function(){r.CHM(e);const t=r.oxw(2);return t.edit.emit(t.context)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",27),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("color",e.color)("matTooltip",r.lcZ(1,2,"igo.context.contextManager.edit"))}}function mw(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",28),r.NdJ("click",function(){r.CHM(e);const t=r.oxw(2);return t.hide.emit(t.context)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",29),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("color",e.color)("matTooltip",r.lcZ(1,2,"igo.context.contextManager.hide"))}}function fw(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",28),r.NdJ("click",function(){r.CHM(e);const t=r.oxw(2);return t.show.emit(t.context)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",30),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("color",e.color)("matTooltip",r.lcZ(1,2,"igo.context.contextManager.show"))}}function yw(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",31),r.NdJ("click",function(){r.CHM(e);const t=r.oxw(2);return t.delete.emit(t.context)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",32),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.context.contextManager.delete"))}function vw(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",9),r.YNc(1,pw,3,4,"button",10),r.TgZ(2,"div",11,12),r.YNc(4,dw,3,4,"button",13),r.YNc(5,hw,3,4,"button",14),r.YNc(6,gw,3,4,"button",15),r.YNc(7,mw,3,4,"button",16),r.YNc(8,fw,3,4,"button",16),r.YNc(9,yw,3,3,"button",17),r.qZA(),r.TgZ(10,"button",18),r.NdJ("click",function(){r.CHM(e);const t=r.oxw();return t.collapsed=!t.collapsed}),r._UZ(11,"mat-icon",19),r.qZA(),r.qZA()}if(2&e){const e=r.MAs(3),t=r.oxw();r.xp6(1),r.Q6J("ngIf",t.collapsed&&t.selected&&(t.context.permission===t.typePermission[t.typePermission.write]||t.context.imported)),r.xp6(3),r.Q6J("ngIf",t.canShare&&!t.context.imported),r.xp6(1),r.Q6J("ngIf",!t.context.imported),r.xp6(1),r.Q6J("ngIf",t.context.permission===t.typePermission[t.typePermission.write]&&!t.context.imported),r.xp6(1),r.Q6J("ngIf",!t.context.hidden&&!t.context.imported),r.xp6(1),r.Q6J("ngIf",t.context.hidden&&!t.context.imported),r.xp6(1),r.Q6J("ngIf",t.context.permission===t.typePermission[t.typePermission.write]||t.context.imported),r.xp6(1),r.Q6J("color",t.color)("target",e)("collapsed",t.collapsed)}}const bw=function(e){return{"mat-list-item-light":e}};let xw=(()=>{class e{constructor(e,t){this.auth=e,this.storageService=t,this.typePermission=tw,this.color="primary",this.collapsed=!0,this._default=!1,this.edit=new r.vpe,this.delete=new r.vpe,this.save=new r.vpe,this.clone=new r.vpe,this.hide=new r.vpe,this.show=new r.vpe,this.favorite=new r.vpe,this.managePermissions=new r.vpe,this.manageTools=new r.vpe}get context(){return this._context}set context(e){this._context=e}get default(){return this._default}set default(e){this._default=e}get hidden(){return this.context.hidden}get canShare(){return!0===this.storageService.get("canShare")}favoriteClick(e){this.auth.authenticated&&this.favorite.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36($s),r.Y36(ve))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-context-item"]],inputs:{context:"context",default:"default",selected:"selected"},outputs:{edit:"edit",delete:"delete",save:"save",clone:"clone",hide:"hide",show:"show",favorite:"favorite",managePermissions:"managePermissions",manageTools:"manageTools"},decls:5,vars:6,consts:[[1,"mat-list-item",3,"ngClass"],["mat-list-avatar","","mat-icon-button","","igoStopPropagation","","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],["matLine",""],["igoStopPropagation","","class","igo-actions-container",4,"ngIf"],["mat-list-avatar","","mat-icon-button","","igoStopPropagation","","matTooltipShowDelay","500",3,"matTooltip","color","click"],[3,"svgIcon",4,"ngIf"],[3,"src",4,"ngIf"],[3,"svgIcon"],[3,"src"],["igoStopPropagation","",1,"igo-actions-container"],["class","save-button","mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],[1,"igo-actions-expand-container"],["actions",""],["mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],["class","clone-button","mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],["class","edit-button","mat-icon-button","","matTooltipShowDelay","500",3,"color","matTooltip","click",4,"ngIf"],["class","hide-button","mat-icon-button","","matTooltipShowDelay","500",3,"color","matTooltip","click",4,"ngIf"],["class","delete-button","mat-icon-button","","color","warn","matTooltipShowDelay","500",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","igoCollapse","",1,"actions-button",3,"color","target","collapsed","click"],["svgIcon","dots-horizontal"],["mat-icon-button","","matTooltipShowDelay","500",1,"save-button",3,"matTooltip","color","click"],["svgIcon","content-save"],["mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","color","click"],["svgIcon","account-arrow-right"],["mat-icon-button","","matTooltipShowDelay","500",1,"clone-button",3,"matTooltip","color","click"],["svgIcon","content-copy"],["mat-icon-button","","matTooltipShowDelay","500",1,"edit-button",3,"color","matTooltip","click"],["svgIcon","pencil"],["mat-icon-button","","matTooltipShowDelay","500",1,"hide-button",3,"color","matTooltip","click"],["svgIcon","eye"],["svgIcon","eye-off"],["mat-icon-button","","color","warn","matTooltipShowDelay","500",1,"delete-button",3,"matTooltip","click"],["svgIcon","delete"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-list-item",0),r.YNc(1,uw,4,6,"button",1),r.TgZ(2,"h4",2),r._uU(3),r.qZA(),r.YNc(4,vw,12,10,"div",3),r.qZA()),2&e&&(r.Q6J("ngClass",r.VKq(4,bw,t.hidden)),r.xp6(1),r.Q6J("ngIf",t.auth.authenticated),r.xp6(2),r.Oqu(t.context.title),r.xp6(1),r.Q6J("ngIf",t.auth.authenticated))},directives:[l.Tg,h.mk,h.O5,$e.X2,n.lW,l.eA,yt,p.gM,a.Hw,Po],pipes:[U.X$],styles:["[_nghost-%COMP%]{overflow:hidden}.igo-actions-container[_ngcontent-%COMP%]{flex-shrink:0}.igo-actions-expand-container[_ngcontent-%COMP%]{display:inline-flex}mat-list-item[_ngcontent-%COMP%]     .mat-list-item-content .mat-list-text{padding:0}mat-icon.disabled[_ngcontent-%COMP%]{color:#00000061}mat-list-item.mat-list-item-light[_ngcontent-%COMP%]     .mat-list-item-content{color:#969696}"],changeDetection:0}),e})();function ww(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",14),r.NdJ("click",function(){return r.CHM(e),r.oxw(2).clearFilter()}),r._UZ(1,"mat-icon",15),r.qZA()}}function Sw(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-form-field",11),r.TgZ(1,"input",12),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw().term=t}),r.ALo(2,"translate"),r.qZA(),r.YNc(3,ww,2,0,"button",13),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("ngClass",e.auth.authenticated&&e.configService.getConfig("context")?"context-filter-min-width":"context-filter-max-width"),r.xp6(1),r.Q6J("placeholder",r.lcZ(2,4,"igo.context.contextManager.filterPlaceHolder"))("ngModel",e.term),r.xp6(2),r.Q6J("ngIf",e.term.length)}}function Cw(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",16),r.NdJ("click",function(){return r.CHM(e),r.oxw().toggleSort(!0)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",17),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.context.contextManager.sortAlphabetically"))}function Tw(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",16),r.NdJ("click",function(){return r.CHM(e),r.oxw().toggleSort(!1)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",18),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.context.contextManager.sortContextOrder"))}function Aw(e,t){if(1&e&&r._UZ(0,"igo-actionbar",19),2&e){const e=r.oxw();r.Q6J("iconColor",e.color)("store",e.actionStore)("withIcon",!0)("withTitle","overlay"===e.actionbarMode)("horizontal",!1)("mode",e.actionbarMode)}}function Zw(e,t){if(1&e&&(r.TgZ(0,"button",20),r.ALo(1,"translate"),r._UZ(2,"mat-icon",21),r.qZA()),2&e){r.oxw();const e=r.MAs(7);r.Q6J("matTooltip",r.lcZ(1,2,"igo.context.contextManager.filterUser"))("matMenuTriggerFor",e)}}function Lw(e,t){if(1&e&&(r.TgZ(0,"button",27),r._uU(1),r.qZA()),2&e){const e=r.oxw().$implicit,t=r.MAs(6);r.Q6J("matMenuTriggerFor",t),r.xp6(1),r.hij(" ",e.title," ")}}function Fw(e,t){if(1&e&&(r.TgZ(0,"button",9),r._uU(1),r.qZA()),2&e){const e=r.oxw().$implicit;r.xp6(1),r.hij(" ",e.title," ")}}function Ow(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-checkbox",8),r.NdJ("click",function(e){return e.stopPropagation()})("change",function(){const t=r.CHM(e).$implicit,o=r.oxw().$implicit;return r.oxw().userSelection(t,o)}),r._uU(1),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(2);r.Q6J("checked",o.getPermission(e).checked),r.xp6(1),r.hij(" ",e.title," ")}}function Mw(e,t){if(1&e){const e=r.EpF();r.ynx(0),r.TgZ(1,"span",7),r.TgZ(2,"mat-checkbox",22),r.NdJ("click",function(e){return e.stopPropagation()})("change",function(){const t=r.CHM(e).$implicit;return r.oxw().userSelection(t)}),r.qZA(),r.YNc(3,Lw,2,2,"button",23),r.YNc(4,Fw,2,1,"button",24),r.qZA(),r.TgZ(5,"mat-menu",null,25),r.YNc(7,Ow,2,2,"mat-checkbox",26),r.qZA(),r.BQk()}if(2&e){const e=t.$implicit,o=r.oxw();r.xp6(2),r.Q6J("checked",o.getPermission(e).checked)("indeterminate",o.getPermission(e).indeterminate),r.xp6(1),r.Q6J("ngIf",e.childs),r.xp6(1),r.Q6J("ngIf",!e.childs),r.xp6(3),r.Q6J("ngForOf",e.childs)}}function Iw(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-context-item",31),r.NdJ("edit",function(){const t=r.CHM(e).$implicit;return r.oxw(3).edit.emit(t)})("delete",function(){const t=r.CHM(e).$implicit;return r.oxw(3).delete.emit(t)})("clone",function(){const t=r.CHM(e).$implicit;return r.oxw(3).clone.emit(t)})("save",function(){const t=r.CHM(e).$implicit;return r.oxw(3).save.emit(t)})("hide",function(){const t=r.CHM(e).$implicit;return r.oxw(3).hideContext(t)})("show",function(){const t=r.CHM(e).$implicit;return r.oxw(3).showContext(t)})("favorite",function(){const t=r.CHM(e).$implicit;return r.oxw(3).favorite.emit(t)})("manageTools",function(){const t=r.CHM(e).$implicit;return r.oxw(3).manageTools.emit(t)})("managePermissions",function(){const t=r.CHM(e).$implicit;return r.oxw(3).managePermissions.emit(t)})("select",function(){const t=r.CHM(e).$implicit;return r.oxw(3).select.emit(t)})("unselect",function(){const t=r.CHM(e).$implicit;return r.oxw(3).unselect.emit(t)}),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(3);r.Q6J("selected",o.selectedContext&&o.selectedContext.uri===e.uri)("context",e)("default",e.id&&o.defaultContextId&&o.defaultContextId===e.id)}}function kw(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-collapsible",30),r.NdJ("toggle",function(t){r.CHM(e);const o=r.oxw().$implicit,i=r.oxw();return i.collapsed[i.titleMapping[o.key]]=t}),r.ALo(1,"translate"),r.YNc(2,Iw,1,3,"ng-template",10),r.qZA()}if(2&e){const e=r.oxw().$implicit,t=r.oxw();r.Q6J("title",r.lcZ(1,3,t.titleMapping[e.key]))("collapsed",t.collapsed[t.titleMapping[e.key]]),r.xp6(2),r.Q6J("ngForOf",e.value)}}function Pw(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-context-item",32),r.NdJ("select",function(){const t=r.CHM(e).$implicit;return r.oxw(3).select.emit(t)})("unselect",function(){const t=r.CHM(e).$implicit;return r.oxw(3).unselect.emit(t)}),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(3);r.Q6J("selected",o.selectedContext&&o.selectedContext.uri===e.uri)("context",e)("default",o.defaultContextId===e.id)}}function _w(e,t){if(1&e&&r.YNc(0,Pw,1,3,"ng-template",10),2&e){const e=r.oxw().$implicit;r.Q6J("ngForOf",e.value)}}function $w(e,t){if(1&e&&(r.YNc(0,kw,3,5,"igo-collapsible",28),r.YNc(1,_w,1,1,void 0,29)),2&e){const e=t.$implicit,o=r.oxw();r.Q6J("ngIf",e.value.length&&o.auth.authenticated),r.xp6(1),r.Q6J("ngIf",e.value.length&&!o.auth.authenticated)}}let qw=(()=>{class e{constructor(e,t,o,i,s,n,a){this.cdRef=e,this.contextService=t,this.configService=o,this.auth=i,this.dialog=s,this.languageService=n,this.storageService=a,this.contextsInitial={ours:[]},this.contexts$=new C.X(this.contextsInitial),this.change$=new we.t(1),this._contexts={ours:[]},this.collapsed=[],this.select=new r.vpe,this.unselect=new r.vpe,this.edit=new r.vpe,this.delete=new r.vpe,this.save=new r.vpe,this.clone=new r.vpe,this.create=new r.vpe,this.hide=new r.vpe,this.show=new r.vpe,this.showHiddenContexts=new r.vpe,this.favorite=new r.vpe,this.managePermissions=new r.vpe,this.manageTools=new r.vpe,this.filterPermissionsChanged=new r.vpe,this.titleMapping={ours:"igo.context.contextManager.ourContexts",shared:"igo.context.contextManager.sharedContexts",public:"igo.context.contextManager.publicContexts"},this.permissions=[],this.actionStore=new gr([]),this.actionbarMode=ao.Overlay,this.color="primary",this.showHidden=!1,this._term="",this._sortedAlpha=void 0,this.showContextFilter=nw.always,this.thresholdToFilter=5}get contexts(){return this._contexts}set contexts(e){this._contexts=e,this.cdRef.detectChanges(),this.next()}get selectedContext(){return this._selectedContext}set selectedContext(e){this._selectedContext=e,this.cdRef.detectChanges()}get map(){return this._map}set map(e){this._map=e}get defaultContextId(){return this._defaultContextId}set defaultContextId(e){this._defaultContextId=e}set term(e){this._term=e,this.next()}get term(){return this._term}get sortedAlpha(){return this._sortedAlpha}set sortedAlpha(e){this._sortedAlpha=e,this.next()}ngOnInit(){this.change$$=this.change$.pipe((0,wn.D)(()=>0===this.contexts.ours.length?fn.E:(0,yn.H)(50))).subscribe(()=>{this.contexts$.next(this.filterContextsList(this.contexts))}),this.actionStore.load([{id:"emptyContext",title:this.languageService.translate.instant("igo.context.contextManager.emptyContext"),icon:"map-outline",tooltip:this.languageService.translate.instant("igo.context.contextManager.emptyContextTooltip"),handler:()=>{this.createContext(!0)}},{id:"contextFromMap",title:this.languageService.translate.instant("igo.context.contextManager.contextMap"),icon:"map-check",tooltip:this.languageService.translate.instant("igo.context.contextManager.contextMapTooltip"),handler:()=>{this.createContext(!1)}}])}next(){this.change$.next()}filterContextsList(e){if(""===this.term)return this.sortedAlpha&&(e=this.sortContextsList(e)),e;{let t={ours:e.ours.filter(e=>{const t=this.term.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return e.title.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t)})};if(this.contexts.public){const o=e.public.filter(e=>{const t=this.term.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return e.title.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t)});t.public=o}if(this.contexts.shared){const o=e.shared.filter(e=>{const t=this.term.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return e.title.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t)});t.shared=o}return this.sortedAlpha&&(t=this.sortContextsList(t)),t}}ngOnDestroy(){this.change$$.unsubscribe()}showFilter(){switch(this.showContextFilter){case nw.always:return!0;case nw.never:return!1;default:let e=this.contexts.ours.length;return e+=this.contexts.public?this.contexts.public.length:0,e+=this.contexts.shared?this.contexts.shared.length:0,e>=this.thresholdToFilter}}sortContextsList(e){if(e){const t=JSON.parse(JSON.stringify(e));return t.ours.sort((e,t)=>this.normalize(e.title)<this.normalize(t.title)?-1:this.normalize(e.title)>this.normalize(t.title)?1:0),t.shared?t.shared.sort((e,t)=>this.normalize(e.title)<this.normalize(t.title)?-1:this.normalize(e.title)>this.normalize(t.title)?1:0):t.public&&t.public.sort((e,t)=>this.normalize(e.title)<this.normalize(t.title)?-1:this.normalize(e.title)>this.normalize(t.title)?1:0),t}}normalize(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}toggleSort(e){this.sortedAlpha=e}clearFilter(){this.term=""}createContext(e){this.dialog.open(aw,{disableClose:!1}).afterClosed().pipe((0,ke.q)(1)).subscribe(t=>{t&&this.create.emit({title:t,empty:e})})}getPermission(e){if(e)return this.permissions.find(t=>t.name===e.name)}userSelection(e,t){const o=this.getPermission(e);if(o&&(o.checked=!o.checked,this.storageService.set("contexts.permissions."+o.name,o.checked),o.indeterminate=!1),t){let e=!1;for(const r of t.childs)if(this.getPermission(r).checked!==o.checked){e=!0;break}const i=this.getPermission(t);i&&(i.checked=o.checked,this.storageService.set("contexts.permissions."+i.name,o.checked),i.indeterminate=e)}if(e.childs)for(const i of e.childs){const e=this.getPermission(i);e&&e.checked!==o.checked&&(e.checked=o.checked,this.storageService.set("contexts.permissions."+e.name,o.checked))}this.filterPermissionsChanged.emit(this.permissions)}hideContext(e){if(e.hidden=!0,!this.showHidden){const t={ours:[],shared:[],public:[]};t.ours=this.contexts.ours.filter(t=>t.id!==e.id),t.shared=this.contexts.shared.filter(t=>t.id!==e.id),t.public=this.contexts.public.filter(t=>t.id!==e.id),this.contexts=t}this.hide.emit(e)}showContext(e){e.hidden=!1,this.show.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.sBO),r.Y36(ow),r.Y36(z),r.Y36($s),r.Y36(je.uw),r.Y36(ne),r.Y36(ve))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-context-list"]],inputs:{contexts:"contexts",selectedContext:"selectedContext",map:"map",defaultContextId:"defaultContextId",term:"term"},outputs:{select:"select",unselect:"unselect",edit:"edit",delete:"delete",save:"save",clone:"clone",create:"create",hide:"hide",show:"show",showHiddenContexts:"showHiddenContexts",favorite:"favorite",managePermissions:"managePermissions",manageTools:"manageTools",filterPermissionsChanged:"filterPermissionsChanged"},decls:17,vars:16,consts:[[3,"navigation"],[3,"ngClass",4,"ngIf"],["class","sort-alpha","mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","click",4,"ngIf"],["class","add-context-button","icon","plus",3,"iconColor","store","withIcon","withTitle","horizontal","mode",4,"ngIf"],["class","users-filter","mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","matMenuTriggerFor",4,"ngIf"],["accountMenu","matMenu"],[4,"ngFor","ngForOf"],[1,"profilsMenu"],[1,"mat-menu-item",3,"checked","click","change"],["mat-menu-item",""],["ngFor","",3,"ngForOf"],[3,"ngClass"],["matInput","","type","text",3,"placeholder","ngModel","ngModelChange"],["mat-button","","mat-icon-button","","matSuffix","","class","clear-button","aria-label","Clear","color","warn",3,"click",4,"ngIf"],["mat-button","","mat-icon-button","","matSuffix","","aria-label","Clear","color","warn",1,"clear-button",3,"click"],["svgIcon","close"],["mat-icon-button","","matTooltipShowDelay","500",1,"sort-alpha",3,"matTooltip","click"],["color","primary","svgIcon","sort-alphabetical-variant"],["color","warn","svgIcon","sort-variant-remove"],["icon","plus",1,"add-context-button",3,"iconColor","store","withIcon","withTitle","horizontal","mode"],["mat-icon-button","","matTooltipShowDelay","500",1,"users-filter",3,"matTooltip","matMenuTriggerFor"],["color","primary","svgIcon","filter-menu"],[1,"mat-menu-item",3,"checked","indeterminate","click","change"],["mat-menu-item","",3,"matMenuTriggerFor",4,"ngIf"],["mat-menu-item","",4,"ngIf"],["subAccountMenu","matMenu"],["class","mat-menu-item",3,"checked","click","change",4,"ngFor","ngForOf"],["mat-menu-item","",3,"matMenuTriggerFor"],[3,"title","collapsed","toggle",4,"ngIf"],[4,"ngIf"],[3,"title","collapsed","toggle"],["igoListItem","","color","accent",3,"selected","context","default","edit","delete","clone","save","hide","show","favorite","manageTools","managePermissions","select","unselect"],["igoListItem","","color","accent",3,"selected","context","default","select","unselect"]],template:function(e,t){1&e&&(r.TgZ(0,"igo-list",0),r.YNc(1,Sw,4,6,"mat-form-field",1),r.YNc(2,Cw,3,3,"button",2),r.YNc(3,Tw,3,3,"button",2),r.YNc(4,Aw,1,6,"igo-actionbar",3),r.YNc(5,Zw,3,4,"button",4),r.TgZ(6,"mat-menu",null,5),r.YNc(8,Mw,8,5,"ng-container",6),r.TgZ(9,"span",7),r.TgZ(10,"mat-checkbox",8),r.NdJ("click",function(e){return e.stopPropagation()})("change",function(){return t.showHiddenContexts.emit()}),r.qZA(),r.TgZ(11,"button",9),r._uU(12),r.ALo(13,"translate"),r.qZA(),r.qZA(),r.qZA(),r.YNc(14,$w,2,2,"ng-template",10),r.ALo(15,"keyvalue"),r.ALo(16,"async"),r.qZA()),2&e&&(r.Q6J("navigation",!0),r.xp6(1),r.Q6J("ngIf",t.showFilter()),r.xp6(1),r.Q6J("ngIf",!t.sortedAlpha),r.xp6(1),r.Q6J("ngIf",t.sortedAlpha),r.xp6(1),r.Q6J("ngIf",t.auth.authenticated&&t.configService.getConfig("context")),r.xp6(1),r.Q6J("ngIf",t.auth.authenticated&&t.configService.getConfig("context")),r.xp6(3),r.Q6J("ngForOf",t.users),r.xp6(2),r.Q6J("checked",t.showHidden),r.xp6(2),r.hij(" ",r.lcZ(13,10,"igo.context.contextManager.showHidden")," "),r.xp6(2),r.Q6J("ngForOf",r.lcZ(15,12,r.lcZ(16,14,t.contexts$))))},directives:[_i,h.O5,f.VK,h.sg,m.oG,f.OP,Pe.KE,h.mk,Qe.Nt,ze.Fj,ze.JJ,ze.On,n.lW,Pe.R9,a.Hw,p.gM,Zo,f.p6,$o,xw,Ii],pipes:[U.X$,Oi,h.Ov],styles:[".context-filter-max-width[_ngcontent-%COMP%]{width:calc(100% - 100px);margin:5px;padding-left:6px}.context-filter-min-width[_ngcontent-%COMP%]{width:calc(100% - 135px);margin:5px;padding-left:6px}.clear-button[_ngcontent-%COMP%]{padding-right:5px}mat-form-field[_ngcontent-%COMP%]{height:40px}.profilsMenu[_ngcontent-%COMP%]{display:flex}.profilsMenu[_ngcontent-%COMP%] > mat-checkbox[_ngcontent-%COMP%]{width:8px}.add-context-button[_ngcontent-%COMP%]{margin:0;width:40px;display:inline-flex}"],changeDetection:0}),e})(),Dw=(()=>{class e{constructor(e,t,o,i,r,s,n,a){this.contextService=t,this.mapService=o,this.languageService=i,this.confirmDialogService=r,this.messageService=s,this.auth=n,this.storageService=a,this.component=e}onSelect(e){this.contextService.loadContext(e.uri)}onEdit(e){this.contextService.loadEditedContext(e.uri)}onSave(e){const t=this.mapService.getMap(),o=this.contextService.getContextFromMap(t),i=()=>{const t=this.languageService.translate,o=t.instant("igo.context.contextManager.dialog.saveMsg",{value:e.title}),i=t.instant("igo.context.contextManager.dialog.saveTitle");this.messageService.success(o,i)};if(e.imported)return o.title=e.title,this.contextService.delete(e.id,!0),void this.contextService.create(o).subscribe(e=>{this.contextService.loadContext(e.uri),i()});this.contextService.update(e.id,{layers:o.layers,map:{view:o.map.view}}).subscribe(()=>{i()})}onFavorite(e){this.contextService.setDefault(e.id).subscribe(()=>{this.contextService.defaultContextId$.next(e.id);const t=this.languageService.translate,o=t.instant("igo.context.contextManager.dialog.favoriteMsg",{value:e.title}),i=t.instant("igo.context.contextManager.dialog.favoriteTitle");this.messageService.success(o,i)})}onManageTools(e){this.contextService.loadEditedContext(e.uri)}onManagePermissions(e){this.contextService.loadEditedContext(e.uri)}onDelete(e){const t=this.languageService.translate;this.confirmDialogService.open(t.instant("igo.context.contextManager.dialog.confirmDelete")).subscribe(o=>{o&&this.contextService.delete(e.id,e.imported).subscribe(()=>{const o=t.instant("igo.context.contextManager.dialog.deleteMsg",{value:e.title}),i=t.instant("igo.context.contextManager.dialog.deleteTitle");this.messageService.info(o,i)})})}onClone(e){this.contextService.clone(e.id,{title:e.title+"-copy",uri:e.uri+"-copy"}).subscribe(()=>{const t=this.languageService.translate,o=t.instant("igo.context.contextManager.dialog.cloneMsg",{value:e.title}),i=t.instant("igo.context.contextManager.dialog.cloneTitle");this.messageService.success(o,i)})}onCreate(e){const{title:t,empty:o}=e,i=this.contextService.getContextFromMap(this.component.map,o);i.title=t,this.contextService.create(i).subscribe(()=>{const e=this.languageService.translate,t=e.instant("igo.context.bookmarkButton.dialog.createTitle"),o=e.instant("igo.context.bookmarkButton.dialog.createMsg",{value:i.title});this.messageService.success(o,t),this.contextService.loadContext(i.uri)})}loadContexts(){const e=["none"];for(const t of this.component.permissions)(!0===t.checked||!0===t.indeterminate)&&e.push(t.name);this.contextService.loadContexts(e,!!this.component.showHidden)}showHiddenContexts(){this.component.showHidden=!this.component.showHidden,this.storageService.set("contexts.showHidden",this.component.showHidden),this.loadContexts()}onShowContext(e){this.contextService.showContext(e.id).subscribe()}onHideContext(e){this.contextService.hideContext(e.id).subscribe()}ngOnInit(){this.component.contexts={ours:[]},this.component.showHidden=this.storageService.get("contexts.showHidden"),this.contexts$$=this.contextService.contexts$.subscribe(e=>this.handleContextsChange(e)),this.defaultContextId$$=this.contextService.defaultContextId$.subscribe(e=>{this.component.defaultContextId=e}),this.selectedContext$$=this.contextService.context$.pipe((0,w.b)(100)).subscribe(e=>this.component.selectedContext=e),this.auth.authenticate$.subscribe(e=>{e&&this.contextService.getProfilByUser().subscribe(e=>{this.component.users=e,this.component.permissions=[];const t=this.component.users.reduce((e,t)=>(e=e.concat(t),t.childs?e.concat(t.childs):e),[]);for(const i of t){const e={name:i.name,checked:this.storageService.get("contexts.permissions."+i.name)};null===e.checked&&(e.checked=!0),this.component.permissions.push(e)}const o=["none"];for(const i of this.component.permissions)(!0===i.checked||!0===i.indeterminate)&&o.push(i.name);this.contextService.loadContexts(o,!!this.component.showHidden)})})}ngOnDestroy(){this.contexts$$.unsubscribe(),this.selectedContext$$.unsubscribe(),this.defaultContextId$$.unsubscribe()}handleContextsChange(e){this.component.contexts=e}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(qw,2),r.Y36(ow),r.Y36(Lc),r.Y36(ne),r.Y36(Eo),r.Y36(le),r.Y36($s),r.Y36(ve))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoContextListBinding",""]],hostBindings:function(e,t){1&e&&r.NdJ("select",function(e){return t.onSelect(e)})("edit",function(e){return t.onEdit(e)})("save",function(e){return t.onSave(e)})("favorite",function(e){return t.onFavorite(e)})("manageTools",function(e){return t.onManageTools(e)})("managePermissions",function(e){return t.onManagePermissions(e)})("delete",function(e){return t.onDelete(e)})("clone",function(e){return t.onClone(e)})("create",function(e){return t.onCreate(e)})("filterPermissionsChanged",function(){return t.loadContexts()})("showHiddenContexts",function(){return t.showHiddenContexts()})("show",function(e){return t.onShowContext(e)})("hide",function(e){return t.onHideContext(e)})}}),e})(),Ew=(()=>{class e{constructor(e,t){this.http=e,this.config=t,this.baseUrl=this.config.getConfig("context.url")}get(){return this.baseUrl?this.http.get(this.baseUrl+"/pois"):fn.E}delete(e){return this.http.delete(this.baseUrl+"/pois/"+e)}create(e){return this.http.post(this.baseUrl+"/pois",e)}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(z))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})(),Rw=(()=>{class e{static forRoot(){return{ngModule:e}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[Ew],imports:[[h.ez,oe,Ro,yi,pn,ze.u5,a.Ps,n.ot,_e.LD,$e.Ng,p.AV,Pe.lN,je.Is,Qe.c]]}),e})(),Uw=(()=>{class e{static forRoot(){return{ngModule:e}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,ze.u5,ze.UX,Pe.lN,Qe.c,a.Ps,n.ot,p.AV,l.ie,m.p9,rl.Fk,je.Is,f.Tx,$e.Ng,Ya.Bb,pn,$i,Mi,qo,yi,oe,iw,Rw,Lo]]}),e})();var Nw=(()=>{return(e=Nw||(Nw={})).layer="layer",e.context="context",Nw;var e})(),Jw=(()=>{return(e=Jw||(Jw={})).import="import",e.export="export",Jw;var e})();let Bw=(()=>{class e{constructor(){this.importExportType$=new C.X(Nw.layer),this.selectedMode$=new C.X(Jw.import),this.exportOptions$=new C.X(void 0)}setImportExportType(e){this.importExportType$.next(e)}setMode(e){this.selectedMode$.next(e)}setsExportOptions(e){this.exportOptions$.next(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),jw=(()=>{class e{constructor(e,t){this.toolService=e,this.importExportState=t,this.openSidenav$=new C.X(void 0)}get toolbox(){return this.toolService.toolbox}toolToActivateFromOptions(e){if(e){if("importExport"===e.tool){let t=this.importExportState.exportOptions$.value;t?(t.layers=e.options.layers,t.featureInMapExtent=e.options.featureInMapExtent):t={layers:e.options.layers,featureInMapExtent:e.options.featureInMapExtent},this.importExportState.setsExportOptions(t),this.importExportState.setMode(Jw.export)}this.toolbox.getTool(e.tool)&&(this.toolbox.activateTool(e.tool),this.openSidenav$.next(!0))}}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(Ai),r.LFG(Bw))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Gw(e,t){e.entityStore.getStrategyOfType(jc).setMotion(t.get("zoomAuto")?Cl.Default:Cl.None)}let Qw=(()=>{class e{constructor(e){this.igoStorageService=e}get storageService(){return this.igoStorageService}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(ve))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),zw=(()=>{class e{constructor(e,t,o,i){this.storageState=e,this.languageService=t,this.toolState=o,this.mediaService=i,this.maximize$=new C.X(this.storageService.get("workspaceMaximize")),this.zoomAuto$=new C.X(!1)}get storageService(){return this.storageState.storageService}get zoomAuto(){return this.storageService.get("zoomAuto")}ngOnDestroy(){this.storageChange$$&&this.storageChange$$.unsubscribe()}loadActions(e,t,o){const i=this.buildActions(e,t,o);e.actionStore.load(i)}buildActions(e,t,o){return this.zoomAuto$.next(this.zoomAuto),this.storageChange$$=this.storageService.storageChange$.pipe((0,xn.n)(e=>"zoomAuto"!==e.key||e.event===ye.CLEARED)).subscribe(()=>{this.zoomAuto$.next(this.zoomAuto),Gw(e,this.storageService)}),[{id:"zoomAuto",checkbox:!0,title:"igo.integration.workspace.zoomAuto.title",tooltip:"igo.integration.workspace.zoomAuto.tooltip",checkCondition:this.zoomAuto$,handler:()=>{Gw(e,this.storageService),this.storageService.set("zoomAuto",!this.storageService.get("zoomAuto"))}},{id:"filterInMapExtent",checkbox:!0,title:"igo.integration.workspace.inMapExtent.title",tooltip:Zx(e),checkCondition:t,handler:()=>t.next(!t.value)},{id:"selectedOnly",checkbox:!0,title:"igo.integration.workspace.selected.title",tooltip:"igo.integration.workspace.selected.tooltip",checkCondition:o,handler:()=>o.next(!o.value)},{id:"clearselection",icon:"select-off",title:"igo.integration.workspace.clearSelection.title",tooltip:"igo.integration.workspace.clearSelection.tooltip",handler:e=>{e.entityStore.state.updateMany(e.entityStore.view.all(),{selected:!1})},args:[e],availability:e=>Lx(e)},{id:"featureDownload",icon:"file-export",title:"igo.integration.workspace.download.title",tooltip:"igo.integration.workspace.download.tooltip",handler:e=>{const t=e.entityStore.getStrategyOfType(pt),o=e.entityStore.getStrategyOfType(dt).active?[e.layer.id]:[];this.toolState.toolToActivateFromOptions({tool:"importExport",options:{layers:[e.layer.id],featureInMapExtent:t.active,layersWithSelection:o}})},args:[e]},{id:"maximize",title:this.languageService.translate.instant("igo.integration.workspace.maximize"),tooltip:this.languageService.translate.instant("igo.integration.workspace.maximizeTooltip"),icon:"resize",display:()=>this.maximize$.pipe((0,x.U)(e=>!e&&!this.mediaService.isMobile())),handler:()=>{this.mediaService.isMobile()||this.maximize$.next(!0)}},{id:"standardExtent",title:this.languageService.translate.instant("igo.integration.workspace.standardExtent"),tooltip:this.languageService.translate.instant("igo.integration.workspace.standardExtentTooltip"),icon:"resize",display:()=>this.maximize$.pipe((0,x.U)(e=>e&&!this.mediaService.isMobile())),handler:()=>{this.maximize$.next(!1)}}]}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(Qw),r.LFG(ne),r.LFG(jw),r.LFG(me))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Yw=(()=>{class e{constructor(e,t,o,i,r){this.ogcFilterWidget=e,this.storageState=t,this.languageService=o,this.mediaService=i,this.toolState=r,this.maximize$=new C.X(this.storageService.get("workspaceMaximize")),this.selectOnlyCheckCondition$=new C.X(!1),this.zoomAuto$=new C.X(!1)}get storageService(){return this.storageState.storageService}get zoomAuto(){return this.storageService.get("zoomAuto")}ngOnDestroy(){this.storageChange$$&&this.storageChange$$.unsubscribe()}loadActions(e,t,o){const i=this.buildActions(e,t,o);e.actionStore.load(i)}buildActions(e,t,o){var i,r;this.zoomAuto$.next(this.zoomAuto),this.storageChange$$=this.storageService.storageChange$.pipe((0,xn.n)(e=>"zoomAuto"!==e.key||e.event===ye.CLEARED)).subscribe(()=>{this.zoomAuto$.next(this.zoomAuto),Gw(e,this.storageService)});const s=[{id:"zoomAuto",checkbox:!0,title:"igo.integration.workspace.zoomAuto.title",tooltip:"igo.integration.workspace.zoomAuto.tooltip",checkCondition:this.zoomAuto$,handler:()=>{Gw(e,this.storageService),this.storageService.set("zoomAuto",!this.storageService.get("zoomAuto"))}},{id:"filterInMapExtent",checkbox:!0,title:"igo.integration.workspace.inMapExtent.title",tooltip:Zx(e),checkCondition:t,handler:()=>t.next(!t.value)},{id:"selectedOnly",checkbox:!0,title:"igo.integration.workspace.selected.title",tooltip:"igo.integration.workspace.selected.title",checkCondition:o,handler:()=>o.next(!o.value)},{id:"clearselection",icon:"select-off",title:"igo.integration.workspace.clearSelection.title",tooltip:"igo.integration.workspace.clearSelection.tooltip",handler:e=>{e.entityStore.state.updateMany(e.entityStore.view.all(),{selected:!1})},args:[e],availability:e=>Lx(e)},{id:"wfsDownload",icon:"file-export",title:"igo.integration.workspace.download.title",tooltip:"igo.integration.workspace.download.tooltip",handler:e=>{const t=e.entityStore.getStrategyOfType(pt),o=e.entityStore.getStrategyOfType(dt).active?[e.layer.id]:[];this.toolState.toolToActivateFromOptions({tool:"importExport",options:{layers:[e.layer.id],featureInMapExtent:t.active,layersWithSelection:o}})},args:[e]},{id:"ogcFilter",icon:"filter",title:"igo.integration.workspace.ogcFilter.title",tooltip:"igo.integration.workspace.ogcFilter.tooltip",handler:(e,t)=>{t.activateWidget(e,{map:t.map,layer:t.layer})},args:[this.ogcFilterWidget,e]},{id:"maximize",title:this.languageService.translate.instant("igo.integration.workspace.maximize"),tooltip:this.languageService.translate.instant("igo.integration.workspace.maximizeTooltip"),icon:"resize",display:()=>this.maximize$.pipe((0,x.U)(e=>!e&&!this.mediaService.isMobile())),handler:()=>{this.mediaService.isMobile()||this.maximize$.next(!0)}},{id:"standardExtent",title:this.languageService.translate.instant("igo.integration.workspace.standardExtent"),tooltip:this.languageService.translate.instant("igo.integration.workspace.standardExtentTooltip"),icon:"resize",display:()=>this.maximize$.pipe((0,x.U)(e=>e&&!this.mediaService.isMobile())),handler:()=>{this.maximize$.next(!1)}}];return(null===(r=null===(i=e.layer.dataSource.ogcFilters$)||void 0===i?void 0:i.value)||void 0===r?void 0:r.enabled)?s:s.filter(e=>"ogcFilter"!==e.id)}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(ox),r.LFG(Qw),r.LFG(ne),r.LFG(me),r.LFG(jw))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Hw=(()=>{class e{constructor(e,t,o){this.featureActionsService=e,this.wfsActionsService=t,this.storageService=o,this.workspacePanelExpanded=!1,this.workspaceEnabled$=new C.X(!1),this.rowsInMapExtentCheckCondition$=new C.X(!0),this.selectOnlyCheckCondition$=new C.X(!1),this.workspaceMaximize$=new C.X(this.storageService.get("workspaceMaximize")),this.actionMaximize$$=[],this.activeWorkspaceWidget$=new C.X(void 0),this.workspace$=new C.X(void 0),this.initWorkspaces()}get store(){return this._store}initWorkspaces(){this._store=new qr([]),this._store.stateView.firstBy$(e=>!0===e.state.active).subscribe(e=>{this.workspace$.next(e?e.entity:void 0)}),this._store.stateView.all$().subscribe(e=>{e.map(e=>{e.entity.actionStore.empty&&(e.entity instanceof sx?this.wfsActionsService.loadActions(e.entity,this.rowsInMapExtentCheckCondition$,this.selectOnlyCheckCondition$):e.entity instanceof lx&&this.featureActionsService.loadActions(e.entity,this.rowsInMapExtentCheckCondition$,this.selectOnlyCheckCondition$))})}),this.actionMaximize$$.push(this.featureActionsService.maximize$.subscribe(e=>{this.setWorkspaceIsMaximized(e)})),this.actionMaximize$$.push(this.wfsActionsService.maximize$.subscribe(e=>{this.setWorkspaceIsMaximized(e)})),this.activeWorkspace$$=this.workspace$.subscribe(e=>{void 0!==this.activeWorkspaceWidget$$&&(this.activeWorkspaceWidget$$.unsubscribe(),this.activeWorkspaceWidget$$=void 0),void 0!==e&&(this.activeWorkspaceWidget$$=e.widget$.subscribe(e=>this.activeWorkspaceWidget$.next(e)))}),this.rowsInMapExtentCheckCondition$$=this.rowsInMapExtentCheckCondition$.subscribe(e=>{this._store.stateView.all().map(t=>{if(!t.entity.actionStore.empty){const o=t.entity.entityStore.getStrategyOfType(pt);o&&(e?o.activate():o.deactivate())}})}),this.selectOnlyCheckCondition$$=this.selectOnlyCheckCondition$.subscribe(e=>{this._store.stateView.all().map(t=>{if(!t.entity.actionStore.empty){const o=t.entity.entityStore.getStrategyOfType(dt);o&&(e?o.activate():o.deactivate())}})})}setWorkspaceIsMaximized(e){this.storageService.set("workspaceMaximize",e),this.workspaceMaximize$.next(e)}setActiveWorkspaceById(e){const t=this.store.all().find(t=>t.id===e);t&&this.store.activateWorkspace(t)}ngOnDestroy(){this.teardownWorkspaces(),this.actionMaximize$$.map(e=>e.unsubscribe()),this.rowsInMapExtentCheckCondition$$&&this.selectOnlyCheckCondition$$.unsubscribe(),this.selectOnlyCheckCondition$$&&this.selectOnlyCheckCondition$$.unsubscribe()}teardownWorkspaces(){this.store.clear(),void 0!==this.activeWorkspaceWidget$$&&this.activeWorkspaceWidget$$.unsubscribe(),void 0!==this.activeWorkspace$$&&this.activeWorkspace$$.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(zw),r.LFG(Yw),r.LFG(ve))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Vw=(()=>{class e{constructor(e,t,o){this.searchSourceService=e,this.storageService=t,this.configService=o,this.searchOverlayStyle={},this.searchOverlayStyleSelection={},this.searchOverlayStyleFocus={},this.searchTermSplitter$=new C.X("|"),this.searchTerm$=new C.X(void 0),this.searchType$=new C.X(void 0),this.searchDisabled$=new C.X(!1),this.searchResultsGeometryEnabled$=new C.X(!1),this.searchSettingsChange$=new C.X(void 0),this.selectedResult$=new C.X(void 0),this.store=new lt([]);const i=this.configService.getConfig("searchOverlayStyle");i&&(this.searchOverlayStyle=i.base,this.searchOverlayStyleSelection=i.selection,this.searchOverlayStyleFocus=i.focus);const r=this.storageService.get("searchResultsGeometryEnabled");r&&this.searchResultsGeometryEnabled$.next(r),this.store.addStrategy(this.createCustomFilterTermStrategy(),!1)}get searchTypes(){return this.searchSourceService.getEnabledSources().map(e=>e.constructor.type)}createCustomFilterTermStrategy(){return new pt({filterClauseFunc:e=>100===e.entity.meta.score})}activateCustomFilterTermStrategy(){const e=this.store.getStrategyOfType(pt);void 0!==e&&e.activate()}deactivateCustomFilterTermStrategy(){const e=this.store.getStrategyOfType(pt);void 0!==e&&e.deactivate()}enableSearch(){this.searchDisabled$.next(!1)}disableSearch(){this.searchDisabled$.next(!0)}setSearchTerm(e){this.searchTerm$.next(e)}setSearchType(e){this.searchSourceService.enableSourcesByType(e),this.searchType$.next(e)}setSearchSettingsChange(){this.searchSettingsChange$.next(!0)}setSelectedResult(e){this.selectedResult$.next(e)}setSearchResultsGeometryStatus(e){this.storageService.set("searchResultsGeometryEnabled",e),this.searchResultsGeometryEnabled$.next(e)}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(bv),r.LFG(ve),r.LFG(z))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Ww=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[ex]]}),e})(),Xw=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,a.Ps,Be.g,p.AV,n.ot,oe,Dh,ex,Wo,Ui,$h,Jo]]}),e})(),Kw=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[],Ww,Xw]}),e})();const eS=["mapBrowser"];function tS(e,t){1&e&&(r.TgZ(0,"span",11),r._uU(1," F2 activate/deactivate the pointer location. "),r.qZA())}function oS(e,t){if(1&e&&r._UZ(0,"igo-search-add-button",12),2&e){const e=t.result,o=r.oxw();r.Q6J("map",o.map)("layer",e)}}function iS(e,t){if(1&e&&(r.TgZ(0,"igo-panel",11),r._UZ(1,"igo-feature-details",13),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("feature",e.selectedFeature)}}function rS(e,t){if(1&e&&r._UZ(0,"igo-actionbar",14),2&e){const e=r.oxw();r.Q6J("store",e.store)("withIcon",!1)("horizontal",!0)("mode","context")}}const sS=d.Bz.forChild([{path:"search",component:(()=>{class e{constructor(e,t,o,i,r,s,n){this.languageService=e,this.projectionService=t,this.mapService=o,this.layerService=i,this.searchState=r,this.searchService=s,this.mediaService=n,this.store=new gr([]),this.igoSearchPointerSummaryEnabled=!1,this.termSplitter="|",this.map=new eu({overlay:!0,controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:7},this.settingsChange$=new C.X(void 0),this.mapService.setMap(this.map),this.layerService.createAsyncLayer({title:"OSM",sourceOptions:{type:"osm"}}).subscribe(e=>{this.osmLayer=e,this.map.addLayer(e)})}get searchStore(){return this.searchState.store}get isTouchScreen(){return this.mediaService.isTouchScreen()}onPointerSummaryStatusChange(e){this.igoSearchPointerSummaryEnabled=e}onSearchTermChange(e=""){this.term=e,e.replace(/(#[^\s]*)/g,"").trim().length<2&&(this.searchStore.clear(),this.selectedFeature=void 0)}onSearch(e){const t=e.results;this.searchStore.state.updateAll({focused:!1,selected:!1});const o=this.searchStore.entities$.value.filter(t=>t.source!==e.research.source).concat(t);this.searchStore.updateMany(o)}onSearchSettingsChange(){this.settingsChange$.next(!0)}onResultFocus(e){this.tryAddFeatureToMap(e),this.selectedFeature=e.data}tryAddFeatureToMap(e){e.meta.dataType===Sl&&void 0!==e.data.geometry&&this.map.searchResultsOverlay.setFeatures([e.data],Cl.Default)}ngOnInit(){this.store.load([{id:"coordinates",title:"coordinates",handler:this.onSearchCoordinate.bind(this)},{id:"googleMaps",title:"googleMap",handler:this.onOpenGoogleMaps.bind(this),args:["1"]},{id:"googleStreetView",title:"googleStreetView",handler:this.onOpenGoogleStreetView.bind(this)}])}ngOnDestroy(){this.store.destroy()}removeFeatureFromMap(){this.map.searchResultsOverlay.clear()}onContextMenuOpen(e){const t=this.mapPosition(e),o=this.mapService.getMap().ol.getCoordinateFromPixel(t);this.mapProjection=this.mapService.getMap().projection,this.lonlat=Fn.vs(o,this.mapProjection,"EPSG:4326")}mapPosition(e){const t=e;return t.y=t.y-this.mapBrowser.nativeElement.getBoundingClientRect().top+window.scrollY,t.x=t.x-this.mapBrowser.nativeElement.getBoundingClientRect().left+window.scrollX,[t.x,t.y]}onPointerSearch(e){this.lonlat=e,this.onSearchCoordinate()}onSearchCoordinate(){this.searchStore.clear();const e=this.searchService.reverseSearch(this.lonlat);for(const t in e)e.length>0&&e[t].request.subscribe(o=>{this.onSearch({research:e[t],results:o})})}onOpenGoogleMaps(){window.open(Uu.getGoogleMapsCoordLink(this.lonlat[0],this.lonlat[1]))}onOpenGoogleStreetView(){window.open(Uu.getGoogleStreetViewLink(this.lonlat[0],this.lonlat[1]))}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ne),r.Y36(Ic),r.Y36(Lc),r.Y36(yu),r.Y36(Vw),r.Y36(xv),r.Y36(me))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-search"]],viewQuery:function(e,t){if(1&e&&r.Gf(eS,7,r.SBq),2&e){let e;r.iGM(e=r.CRH())&&(t.mapBrowser=e.first)}},decls:31,vars:15,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/search"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/environments"],["title","Details",4,"ngIf"],["igoOverlay","","igoSearchPointerSummary","",3,"map","view","igoContextMenu","igoSearchPointerSummaryDelay","igoSearchPointerSummaryEnabled","menuPosition"],["mapBrowser",""],["color","primary",3,"map"],["title","Search"],[3,"searchSettings","store","termSplitter","pointerSummaryStatus","searchTermChange","search","clearFeature","searchSettingsChange"],["placeholder","false",3,"store","term","termSplitter","settingsChange$","resultFocus","resultSelect","moreResults"],["igoSearchItemToolbar",""],["actionbarMenu",""],["title","Details"],[3,"map","layer"],[3,"feature"],[3,"store","withIcon","horizontal","mode"]],template:function(e,t){if(1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Search"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: ConfigService, LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"br"),r._uU(13," See search section of the "),r.TgZ(14,"a",1),r._uU(15," environment config"),r.qZA(),r._UZ(16,"hr"),r._UZ(17,"br"),r.YNc(18,tS,2,0,"span",2),r.qZA(),r.TgZ(19,"igo-map-browser",3,4),r.NdJ("menuPosition",function(e){return t.onContextMenuOpen(e)}),r._UZ(21,"igo-zoom-button",5),r.qZA(),r.TgZ(22,"igo-panel",6),r.TgZ(23,"igo-search-bar",7),r.NdJ("pointerSummaryStatus",function(e){return t.onPointerSummaryStatusChange(e)})("searchTermChange",function(e){return t.onSearchTermChange(e)})("search",function(e){return t.onSearch(e)})("clearFeature",function(){return t.removeFeatureFromMap()})("searchSettingsChange",function(){return t.onSearchSettingsChange()}),r.qZA(),r.TgZ(24,"igo-search-results",8),r.NdJ("resultFocus",function(e){return t.onResultFocus(e)})("resultSelect",function(e){return t.onResultFocus(e)})("moreResults",function(e){return t.onSearch(e)}),r.YNc(25,oS,1,2,"ng-template",null,9,r.W1O),r.qZA(),r.qZA(),r.YNc(27,iS,2,1,"igo-panel",2),r.qZA(),r.YNc(28,rS,1,4,"ng-template",null,10,r.W1O),r._UZ(30,"igo-message-center")),2&e){const e=r.MAs(29);r.xp6(18),r.Q6J("ngIf",!t.isTouchScreen),r.xp6(1),r.Q6J("map",t.map)("view",t.view)("igoContextMenu",e)("igoSearchPointerSummaryDelay",500)("igoSearchPointerSummaryEnabled",t.igoSearchPointerSummaryEnabled),r.xp6(2),r.Q6J("map",t.map),r.xp6(2),r.Q6J("searchSettings",!0)("store",t.searchStore)("termSplitter",t.termSplitter),r.xp6(1),r.Q6J("store",t.searchStore)("term",t.term)("termSplitter",t.termSplitter)("settingsChange$",t.settingsChange$),r.xp6(3),r.Q6J("ngIf",t.selectedFeature)}},directives:[g.a8,g.$j,g.n5,g.dn,h.O5,ou,Xb,Uo,uu,Ri,Lb,Yb,re,Vb,Yd,Zo],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{height:100%;width:100%;padding-top:10px}"]}),e})()}]);let nS=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[{provide:Eu,useFactory:Wv,multi:!0,deps:[z,ne,ve,Ic]},{provide:Eu,useFactory:bx,multi:!0,deps:[y.eN,ne,ve,z]},{provide:Eu,useFactory:Qv,multi:!0,deps:[y.eN,ne,ve,z,Nv,r.zs3]},{provide:Eu,useFactory:tb,multi:!0,deps:[y.eN,ne,ve,z,Xv]},{provide:Eu,useFactory:wx,multi:!0,deps:[y.eN,z,ve]},{provide:Eu,useFactory:zv,multi:!0,deps:[y.eN,ne,ve,z,r.zs3]},{provide:Eu,useFactory:Tx,multi:!0,deps:[y.eN,ne,ve,z]},{provide:Eu,useFactory:Ax,multi:!0,deps:[y.eN,ne,ve,z]}],imports:[[h.ez,sS,g.QW,n.ot,a.Ps,p.AV,se.forRoot(),Ui,Dy,ex.forRoot(),Kw,Lo,No,Dh]]}),e})();const aS=d.Bz.forChild([{path:"print",component:(()=>{class e{constructor(e,t){this.languageService=e,this.layerService=t,this.map=new eu({controls:{attribution:{collapsed:!1}}}),this.view={center:[-73,47.2],zoom:9},this.layerService.createAsyncLayer({title:"Quebec Base Map",sourceOptions:{type:"wmts",url:"https://geoegl.msp.gouv.qc.ca/apis/carto/wmts/1.0.0/wmts",layer:"carte_gouv_qc_ro",matrixSet:"EPSG_3857",version:"1.3.0",crossOrigin:"anonymous",attributions:"\xa9 <a href='http://www.droitauteur.gouv.qc.ca/copyright.php' target='_blank'><img src='https://geoegl.msp.gouv.qc.ca/gouvouvert/public/images/quebec/gouv_qc_logo.png' width='64' height='14'>Gouvernement du Qu\xe9bec</a> / <a href='https://www.igouverte.org/' target='_blank'>IGO2</a>"}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"School board",sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{LAYERS:"MELS_CS_ANGLO_S",VERSION:"1.3.0"},crossOrigin:"anonymous"}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"Embacle",sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{LAYERS:"vg_observation_v_inondation_embacle_wmst",VERSION:"1.3.0"},crossOrigin:"anonymous"}}).subscribe(e=>this.map.addLayer(e))}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ne),r.Y36(yu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-print"]],decls:19,vars:7,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/print"],[3,"map","view"],["color","primary",3,"map"],["color","primary",3,"map","showIfNoRotation"],[3,"map"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Print"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"hr"),r.qZA(),r.TgZ(13,"igo-map-browser",1),r._UZ(14,"igo-zoom-button",2),r._UZ(15,"igo-geolocate-button",2),r._UZ(16,"igo-rotation-button",3),r.qZA(),r._UZ(17,"igo-print",4),r.qZA(),r._UZ(18,"igo-message-center")),2&e&&(r.xp6(13),r.Q6J("map",t.map)("view",t.view),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("map",t.map)("showIfNoRotation",!1),r.xp6(1),r.Q6J("map",t.map))},directives:[g.a8,g.$j,g.n5,g.dn,ou,uu,pu,Cu,nv,re],styles:["igo-map-browser[_ngcontent-%COMP%]{width:900px;height:1000px}"]}),e})()}]);let lS=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[aS,g.QW,n.ot,se,Dy,av]]}),e})();const cS=d.Bz.forChild([{path:"import-export",component:(()=>{class e{constructor(e,t){this.languageService=e,this.layerService=t,this.map=new eu({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:9},this.layerService.createAsyncLayer({title:"OSM",sourceOptions:{type:"osm"}}).subscribe(e=>this.map.addLayer(e))}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ne),r.Y36(yu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-import-export"]],decls:17,vars:4,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/import-export"],[3,"map","view"],["color","primary",3,"map"],[3,"map"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Import / Export"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"hr"),r.qZA(),r.TgZ(13,"igo-map-browser",1),r._UZ(14,"igo-zoom-button",2),r.qZA(),r._UZ(15,"igo-import-export",3),r.qZA(),r._UZ(16,"igo-message-center")),2&e&&(r.xp6(13),r.Q6J("map",t.map)("view",t.view),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("map",t.map))},directives:[g.a8,g.$j,g.n5,g.dn,ou,uu,Iy,re],styles:["igo-map-browser[_ngcontent-%COMP%]{width:900px;height:1000px}"]}),e})()}]);let uS=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[Py({path:"./assets/import-style.json"})],imports:[[cS,g.QW,n.ot,se,Dy,qy]]}),e})();const pS=d.Bz.forChild([{path:"directions",component:(()=>{class e{constructor(e,t,o,i){this.projectionService=e,this.languageService=t,this.layerService=o,this.mapService=i,this.map=new eu({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:9,geolocate:!0},this.stopsStore=new Ec([],{map:this.map}),this.routeStore=new Ec([],{map:this.map}),this.mapService.setMap(this.map),this.layerService.createAsyncLayer({title:"OSM",sourceOptions:{type:"osm"}}).subscribe(e=>this.map.addLayer(e))}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Ic),r.Y36(ne),r.Y36(yu),r.Y36(Lc))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-directions"]],decls:18,vars:9,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/directions"],[3,"map","view"],["color","primary",3,"map"],["color","primary",3,"map","showIfNoRotation"],[3,"stopsStore","routeStore","map"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Directions"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"hr"),r.qZA(),r.TgZ(13,"igo-map-browser",1),r._UZ(14,"igo-zoom-button",2),r._UZ(15,"igo-geolocate-button",2),r._UZ(16,"igo-rotation-button",3),r.qZA(),r._UZ(17,"igo-directions-form",4),r.qZA()),2&e&&(r.xp6(13),r.Q6J("map",t.map)("view",t.view),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("map",t.map)("showIfNoRotation",!1),r.xp6(1),r.Q6J("stopsStore",t.stopsStore)("routeStore",t.routeStore)("map",t.map))},directives:[g.a8,g.$j,g.n5,g.dn,ou,uu,pu,Cu,Dv],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}"]}),e})()}]);let dS=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[{provide:uv,useFactory:yx,multi:!0,deps:[y.eN,z]}],imports:[[pS,g.QW,n.ot,se,Dy,Rv]]}),e})();const hS=d.Bz.forChild([{path:"time-filter",component:(()=>{class e{constructor(e,t,o){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.map=new eu({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:7},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://geoegl.msp.gouv.qc.ca/ws/igo_gouvouvert.fcgi",params:{LAYERS:"vg_observation_v_inondation_embacle_wmst",VERSION:"1.3.0"},timeFilterable:!0,timeFilter:{min:"2013",max:"2019",range:!1,type:Ac.YEAR,style:Zc.SLIDER,step:1,timeInterval:2e3}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle YEAR",visible:!0,source:e}))})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ne),r.Y36(kc),r.Y36(yu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-time-filter"]],decls:21,vars:4,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/time-filter"],[3,"map","view"],["color","primary",3,"map"],["title","Layers"],[3,"layers"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Time filter"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"npm install --save moment@2.22.2"),r.qZA(),r.TgZ(8,"li"),r._uU(9,"npm install --save @mat-datetimepicker/core@3.0.0-beta.0"),r.qZA(),r.TgZ(10,"li"),r._uU(11,"Dependencies: LanguageService"),r.qZA(),r._UZ(12,"br"),r._uU(13," See the "),r.TgZ(14,"a",0),r._uU(15,"code of this example"),r.qZA(),r._UZ(16,"hr"),r.qZA(),r.TgZ(17,"igo-map-browser",1),r._UZ(18,"igo-zoom-button",2),r.qZA(),r.TgZ(19,"igo-panel",3),r._UZ(20,"igo-time-filter-list",4),r.qZA(),r.qZA()),2&e&&(r.xp6(17),r.Q6J("map",t.map)("view",t.view),r.xp6(1),r.Q6J("map",t.map),r.xp6(2),r.Q6J("layers",t.map.layers))},directives:[g.a8,g.$j,g.n5,g.dn,ou,uu,Ri,bg],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),e})()}]);let gS=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[hS,g.QW,n.ot,a.Ps,Ui,Dy,Nf]]}),e})();const mS=d.Bz.forChild([{path:"ogc-filter",component:(()=>{class e{constructor(e,t,o){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.map=new eu({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:7},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"code_municipalite",alias:"# de la municipalit\xe9e"},{name:"date_observation",excludeFromOgcFilters:!0},{name:"urgence",values:["imm\xe9diate","inconnue"]}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:Dl.All,filters:{logical:"Or",filters:[{operator:"PropertyIsEqualTo",propertyName:"code_municipalite",expression:"10043"},{operator:"Intersects",geometryName:"the_geom",wkt_geometry:"MULTIPOLYGON(((\n              -8379441.158019895 5844447.897707146,\n              -8379441.158019895 5936172.331649357,\n              -8134842.66750733 5936172.331649357,\n              -8134842.66750733 5844447.897707146,\n              -8379441.158019895 5844447.897707146\n            ), (\n              -8015003 5942074,\n              -8015003 5780349,\n              -7792364 5780349,\n              -7792364 5942074,\n              -8015003 5942074\n            )))"}]}}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle (PropertyIsEqualTo OR Intersects)",source:e,style:new Dn.ZP({image:new Jn.Z({radius:5,fill:new Rn.Z({color:"white"}),stroke:new Nn.Z({color:"orange",width:1})})})}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:Dl.All,filters:{operator:"During",propertyName:"date_observation",begin:"2016-01-21T00:00:00-05:00",end:"2016-01-26T00:00:00-05:00"}},minDate:"2016-01-01T00:00:00-05:00",maxDate:"2016-02-10T00:00:00-05:00",stepDate:"P2D"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle (During, Step: P2D)",id:"1",source:e,style:new Dn.ZP({image:new Jn.Z({radius:5,fill:new Rn.Z({color:"white"}),stroke:new Nn.Z({color:"red",width:1})})})}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:Dl.All,filters:{operator:"During",propertyName:"date_observation",begin:"2016-01-01T04:00:00-05:00",end:"2016-01-12T16:00:00-05:00"}},minDate:"2016-01-01T00:00:00-05:00",maxDate:"2016-02-14T20:00:00-05:00",stepDate:"PT4H"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle (During, Step: PT4H)",id:"2",source:e,style:new Dn.ZP({image:new Jn.Z({radius:5,fill:new Rn.Z({color:"white"}),stroke:new Nn.Z({color:"blue",width:1})})})}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:Dl.All,filters:{operator:"During",propertyName:"date_observation",begin:"2016-01-01T00:00:00-05:00",end:"2016-03-31T00:00:00-05:00",displayFormat:"MMMM"}},minDate:"2016-01-01T00:00:00-05:00",maxDate:"2018-12-31T00:00:00-05:00",stepDate:"P1M"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle (During, Step: P1M)",id:"3",source:e,style:new Dn.ZP({image:new Jn.Z({radius:5,fill:new Rn.Z({color:"white"}),stroke:new Nn.Z({color:"yellow",width:1})})})}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:Dl.All,filters:{operator:"During",propertyName:"date_observation",begin:"2014-01-01T00:00:00-05:00",end:"2019-12-31T00:00:00-05:00",sliderOptions:{interval:2e3,displayFormat:"YY"},displayFormat:"YYYY"}},minDate:"2014-01-01T00:00:00-05:00",maxDate:"2019-12-31T00:00:00-05:00",stepDate:"P1Y"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle (During, Step: P1Y)",id:"4",source:e,style:new Dn.ZP({image:new Jn.Z({radius:5,fill:new Rn.Z({color:"white"}),stroke:new Nn.Z({color:"green",width:1})})})}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:Dl.All,filters:{operator:"During",propertyName:"date_observation",begin:"today - 2 days",end:"today"}},minDate:"2016-01-01T00:00:00-05:00",maxDate:"2025-12-31T00:00:00-05:00",stepDate:"P1D"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle (During, Interval from Now, Step: P1D)",id:"5",source:e,style:new Dn.ZP({image:new Jn.Z({radius:5,fill:new Rn.Z({color:"white"}),stroke:new Nn.Z({color:"black",width:1})})})}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:Dl.All,filters:{operator:"During",propertyName:"date_observation",begin:"2019-01-01 00:00:00",restrictToStep:!0}},minDate:"2016-01-01T00:00:00-05:00",maxDate:"2025-12-31T00:00:00-05:00",stepDate:"P1M"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle (During, RestrictToStep, Step: P1M)",id:"6",source:e,style:new Dn.ZP({image:new Jn.Z({radius:5,fill:new Rn.Z({color:"black"}),stroke:new Nn.Z({color:"red",width:1})})})}))}),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"vg_observation_v_inondation23avril2017_wmst",VERSION:"1.3.0"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,filters:{operator:"During",propertyName:"date_observation"},allowedOperatorsType:Dl.Time}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Inondation (During, optionsFromCapabilities)",source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",urlWfs:"https://ws.mapserver.transports.gouv.qc.ca/swtq",params:{LAYERS:"radars_photos",VERSION:"1.3.0"},ogcFilters:{enabled:!0,editable:!0,pushButtons:{selectorType:"pushButton",order:2,groups:[{title:"Nom du group1 - push",name:"1 - push",ids:["id1"]}],bundles:[{id:"id1",title:"R\xe9gions",logical:"Or",vertical:!0,selectors:[{title:"Montr\xe9al & Laval",enabled:!1,tooltip:"Here a tooltip explaning ...",filters:{logical:"Or",filters:[{operator:"PropertyIsEqualTo",propertyName:"region",expression:"Montr\xe9al"},{operator:"PropertyIsEqualTo",propertyName:"region",expression:"Laval"}]}},{title:"Outside Montr\xe9al & Laval",enabled:!1,tooltip:"Here a tooltip explaning ...",filters:{logical:"And",filters:[{operator:"PropertyIsNotEqualTo",propertyName:"region",expression:"Montr\xe9al"},{operator:"PropertyIsNotEqualTo",propertyName:"region",expression:"Laval"}]}}]}]},checkboxes:{selectorType:"checkbox",order:1,groups:[{title:"Nom du group1 - checkbox",name:"1 - checkbox",ids:["id1"]}],bundles:[{id:"id1",title:"Type de radar photo",logical:"Or",selectors:[{title:"Radar photo fixe",enabled:!0,tooltip:"Here a tooltip explaning ...",filters:{operator:"PropertyIsEqualTo",propertyName:"typeAppareil",expression:"Radar photo fixe"}},{title:"Radar photo mobile",enabled:!1,tooltip:"Here a tooltip explaning ...",filters:{operator:"PropertyIsEqualTo",propertyName:"typeAppareil",expression:"Radar photo mobile"}},{title:"Radar photo fixe + feu rouge",enabled:!1,color:"0,200,0",tooltip:"Here a tooltip explaning ...",filters:{operator:"PropertyIsEqualTo",propertyName:"typeAppareil",expression:"Radar photo fixe et surveillance au feu rouge"}},{title:"Radar feu rouge",enabled:!1,color:"255,0,0",tooltip:"Here a tooltip explaning ...",filters:{operator:"PropertyIsEqualTo",propertyName:"typeAppareil",expression:"Appareil de surveillance au feu rouge"}}]}]},allowedOperatorsType:Dl.Basic},paramsWFS:{featureTypes:"radars_photos",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"1.1.0",outputFormat:"geojson",outputFormatDownload:"shp"}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Filterable WMS layers with predefined filters (push buttons)",source:e}))})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ne),r.Y36(kc),r.Y36(yu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-ogc-filter"]],decls:17,vars:5,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/ogc-filter"],[3,"map","view"],["color","primary",3,"map"],["title","Layers"],[3,"map","layers"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Ogc filter"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"hr"),r.qZA(),r.TgZ(13,"igo-map-browser",1),r._UZ(14,"igo-zoom-button",2),r.qZA(),r.TgZ(15,"igo-panel",3),r._UZ(16,"igo-ogc-filterable-list",4),r.qZA(),r.qZA()),2&e&&(r.xp6(13),r.Q6J("map",t.map)("view",t.view),r.xp6(1),r.Q6J("map",t.map),r.xp6(2),r.Q6J("map",t.map)("layers",t.map.layers))},directives:[g.a8,g.$j,g.n5,g.dn,ou,uu,Ri,lm],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),e})()}]);let fS=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[mS,g.QW,n.ot,a.Ps,Ui,Dy,Nf]]}),e})();function yS(e,t){if(1&e&&(r.ynx(0),r._UZ(1,"igo-feature-details",8),r.BQk()),2&e){const e=t.ngIf;r.xp6(1),r.Q6J("feature",e)}}const vS=d.Bz.forChild([{path:"spatial-filter",component:(()=>{class e{constructor(e,t,o,i,r){this.spatialFilterService=e,this.dataSourceService=t,this.layerService=o,this.messageService=i,this.languageService=r,this.map=new eu({controls:{attribution:{collapsed:!0}}}),this.view={center:[-71.9,46.9],zoom:10},this.itemType=Id.Address,this.layers=[],this.selectedFeature$=new C.X(void 0),this.format=new Yn.Z,this.store=new lt([]),this.spatialListStore=new lt([]),this.loading=!1,this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e,baseLayer:!0,visible:!0}))})}getOutputType(e){this.type=e,this.queryType=void 0,this.radius=void 0}getOutputQueryType(e){this.queryType=e,this.queryType&&this.loadFilterList()}loadFilterList(){this.spatialFilterService.loadFilterList(this.queryType).subscribe(e=>{e.sort((e,t)=>e.properties.nom<t.properties.nom?-1:e.properties.nom>t.properties.nom?1:0),this.spatialListStore.clear(),this.spatialListStore.load(e)})}getOutputToggleSearch(){this.loadThematics()}getOutputClearSearch(){this.zone=void 0,this.queryType=void 0}loadThematics(){this.loading=!0,this.tryAddFeaturesToMap([this.zone]),this.thematics||(this.thematics=[{name:""}]),this.type===Md.Polygon&&(this.radius=void 0),this.thematics.forEach(e=>{this.spatialFilterService.loadFilterItem(this.zone,this.itemType,this.queryType,e,this.radius).subscribe(e=>{this.store.insertMany(e);const t=[],o=[];let i,r;e.forEach(e=>{"Point"===e.geometry.type?(t.push(e),i=e.meta.id):(o.push(e),r=e.meta.id)}),this.tryAddPointToMap(t,i),this.tryAddLayerToMap(o,r),this.loading=!1,e.length>=1e4&&this.messageService.alert(this.languageService.translate.instant("igo.geo.spatialFilter.maxSizeAlert"),this.languageService.translate.instant("igo.geo.spatialFilter.warning"),{timeOut:1e4}),e.length||this.messageService.alert(this.languageService.translate.instant("igo.geo.spatialFilter.zeroResults"),this.languageService.translate.instant("igo.geo.spatialFilter.warning"),{timeOut:1e4})})})}onZoneChange(e){this.zone=e,e&&(this.tryAddFeaturesToMap([e]),this.zoomToFeatureExtent(e))}tryAddFeaturesToMap(e){let t=1;for(const o of e){if(this.type===Md.Predefined)for(const e of this.map.layers){if(e.options._internal&&e.options._internal.code===o.properties.code)return;e.title.startsWith("Zone")&&this.map.removeLayer(e)}for(const e of this.map.layers)e.title.startsWith("Zone")&&t++;this.dataSourceService.createAsyncDataSource({type:"vector",queryable:!0}).subscribe(i=>{const r=this.layerService.createLayer({title:"Zone "+t,_internal:{code:this.type===Md.Predefined?o.properties.code:void 0},source:i,visible:!0,style:(t,o)=>{const i=e[0].coordinates;return new Dn.ZP({image:new Jn.Z({radius:i?this.radius/Math.cos(Math.PI/180*i[1])/o:void 0,fill:new Rn.Z({color:"rgba(200, 200, 20, 0.2)"}),stroke:new Nn.Z({width:1,color:"orange"})}),stroke:new Nn.Z({width:1,color:"orange"}),fill:new Rn.Z({color:"rgba(200, 200, 20, 0.2)"})})}}),s=e.map(e=>Pc(e,this.map.projection));i.ol.addFeatures(s),this.map.addLayer(r),this.layers.push(r)})}}tryAddPointToMap(e,t){let o=1;if(e.length>=1){if(void 0===this.map)return;for(const t of this.map.layers)t.title.startsWith(e[0].meta.title)&&o++;this.dataSourceService.createAsyncDataSource({type:"cluster",id:t,queryable:!0,distance:120,meta:{title:"Cluster"}}).subscribe(t=>{const i=this.layerService.createLayer({title:e[0].meta.title+" "+o,source:t,visible:!0,clusterParam:{clusterRanges:[{minRadius:1,maxRadius:5,style:{}}]}}),r=e.map(e=>Pc(e,this.map.projection));t.ol.getSource().addFeatures(r),this.map.layers.find(e=>e.id===i.id)&&(this.map.removeLayer(this.map.layers.find(e=>e.id===i.id)),o-=1,i.title=e[0].meta.title+" "+o,i.options.title=i.title),this.map.addLayer(i),this.layers.push(i)})}}tryAddLayerToMap(e,t){let o=1;if(e.length>1){if(void 0===this.map)return;for(const t of this.map.layers)t.title.startsWith(e[0].meta.title)&&o++;this.dataSourceService.createAsyncDataSource({type:"vector",id:t,queryable:!0}).subscribe(t=>{const i=this.layerService.createLayer({title:e[0].meta.title+" "+o,source:t,visible:!0}),r=e.map(e=>Pc(e,this.map.projection));t.ol.addFeatures(r),this.map.layers.find(e=>e.id===i.id)&&(this.map.removeLayer(this.map.layers.find(e=>e.id===i.id)),o-=1,i.title=e[0].meta.title+" "+o,i.options.title=i.title),this.map.addLayer(i),this.layers.push(i)})}}zoomToFeatureExtent(e){if(e){const t=this.format.readFeature(e,{dataProjection:e.projection,featureProjection:this.map.projection});qc(this.map,[t],Cl.Zoom)}}handleQueryResults(e){const t=e.features;let o;t.length&&(o=t[0]),this.selectedFeature$.next(o)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(kd),r.Y36(kc),r.Y36(yu),r.Y36(le),r.Y36(ne))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-spatial-filter"]],inputs:{type:"type",itemType:"itemType",freehandDrawIsActive:"freehandDrawIsActive"},decls:26,vars:17,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/spatial-filter"],["igoOverlay","","igoQuery","",3,"map","view","queryFeatures","query"],["color","primary",3,"map"],["title","Spatial Filter"],[3,"store","selectedQueryType","zone","eventType","eventQueryType","zoneChange"],[3,"type","queryType","map","zone","loading","store","layers","radiusEvent","freehandControl","drawZoneEvent","itemTypeChange","thematicChange","toggleSearch","clearButtonEvent","clearSearchEvent"],["title","Details"],[4,"ngIf"],[3,"feature"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Spatial filter"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"npm install --save moment@2.22.2"),r.qZA(),r.TgZ(8,"li"),r._uU(9,"npm install --save @mat-datetimepicker/core@3.0.0-beta.0"),r.qZA(),r.TgZ(10,"li"),r._uU(11,"Dependencies: LanguageService"),r.qZA(),r._UZ(12,"br"),r._uU(13," See the "),r.TgZ(14,"a",0),r._uU(15,"code of this example"),r.qZA(),r._UZ(16,"hr"),r.qZA(),r.TgZ(17,"igo-map-browser",1),r.NdJ("query",function(e){return t.handleQueryResults(e)}),r._UZ(18,"igo-zoom-button",2),r.qZA(),r.TgZ(19,"igo-panel",3),r.TgZ(20,"igo-spatial-filter-type",4),r.NdJ("eventType",function(e){return t.getOutputType(e)})("eventQueryType",function(e){return t.getOutputQueryType(e)})("zoneChange",function(e){return t.onZoneChange(e)}),r.qZA(),r.TgZ(21,"igo-spatial-filter-item",5),r.NdJ("radiusEvent",function(e){return t.radius=e})("freehandControl",function(e){return t.freehandDrawIsActive=e})("drawZoneEvent",function(e){return t.zone=e})("itemTypeChange",function(e){return t.itemType=e})("thematicChange",function(e){return t.thematics=e})("toggleSearch",function(){return t.getOutputToggleSearch()})("clearButtonEvent",function(e){return t.layers=e})("clearSearchEvent",function(){return t.getOutputClearSearch()}),r.qZA(),r.qZA(),r.TgZ(22,"igo-panel",6),r.YNc(23,yS,2,1,"ng-container",7),r.ALo(24,"async"),r.qZA(),r._UZ(25,"igo-message-center"),r.qZA()),2&e&&(r.xp6(17),r.Q6J("map",t.map)("view",t.view)("queryFeatures",!0),r.xp6(1),r.Q6J("map",t.map),r.xp6(2),r.Q6J("store",t.spatialListStore)("selectedQueryType",t.queryType)("zone",t.zone),r.xp6(1),r.Q6J("type",t.type)("queryType",t.queryType)("map",t.map)("zone",t.zone)("loading",t.loading)("store",t.store)("layers",t.layers),r.xp6(2),r.Q6J("ngIf",r.lcZ(24,15,t.selectedFeature$)))},directives:[g.a8,g.$j,g.n5,g.dn,ou,Du,uu,Ri,Km,xf,h.O5,re,Yd],pipes:[h.Ov],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}igo-form[_ngcontent-%COMP%]{display:none}igo-spatial-filter-item[_ngcontent-%COMP%]     .thematics-header{max-width:225px}"]}),e})()}]);let bS=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[vS,g.QW,n.ot,a.Ps,Ui,Dy,se,cv,Dh,$h,Nf,mi,h.ez]]}),e})();function xS(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-entity-table-paginator",6),r.NdJ("paginatorChange",function(t){return r.CHM(e),r.oxw(2).paginatorChange(t)}),r.qZA()}if(2&e){const e=r.oxw().ngIf,t=r.oxw();r.Q6J("store",e.entityStore)("paginatorOptions",t.paginatorOptions)("entitySortChange$",t.entitySortChange$)}}function wS(e,t){if(1&e&&(r.ynx(0),r.YNc(1,xS,1,3,"igo-entity-table-paginator",5),r.ALo(2,"async"),r.BQk()),2&e){const e=t.ngIf;r.xp6(1),r.Q6J("ngIf",r.lcZ(2,1,e.inResolutionRange$))}}function SS(e,t){if(1&e&&r._UZ(0,"igo-actionbar",10),2&e){const e=r.oxw().ngIf,t=r.oxw();r.Q6J("store",e.actionStore)("horizontal",!0)("withToggleButton",!0)("withTitle",!0)("mode",t.actionbarMode)}}function CS(e,t){if(1&e&&r._UZ(0,"igo-entity-table",11),2&e){const e=r.oxw().ngIf,t=r.oxw();r.Q6J("paginator",t.workspacePaginator)("scrollBehavior",t.scrollBehavior)("store",e.entityStore)("template",e.meta.tableTemplate)}}function TS(e,t){1&e&&(r.TgZ(0,"mat-card-content"),r._uU(1," No data available at this scale. Please zoom in. "),r.qZA())}function AS(e,t){if(1&e&&(r.ynx(0),r.YNc(1,SS,1,5,"igo-actionbar",7),r.YNc(2,CS,1,4,"igo-entity-table",8),r.ALo(3,"async"),r.YNc(4,TS,2,0,"mat-card-content",4),r.ALo(5,"async"),r._UZ(6,"igo-workspace-widget-outlet",9),r.BQk()),2&e){const e=t.ngIf;r.xp6(1),r.Q6J("ngIf",e.actionStore),r.xp6(1),r.Q6J("ngIf",e.entityStore&&e.meta&&e.meta.tableTemplate&&r.lcZ(3,4,e.inResolutionRange$)),r.xp6(2),r.Q6J("ngIf",!r.lcZ(5,6,e.inResolutionRange$)),r.xp6(2),r.Q6J("workspace",e)}}const ZS=d.Bz.forChild([{path:"workspace",component:(()=>{class e{constructor(e,t,o,i){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.workspaceState=i,this.entitySortChange$=new C.X(!1),this.paginatorOptions={pageSize:5,pageSizeOptions:[1,5,10,15,30,50,100],showFirstLastButtons:!0},this.map=new eu({controls:{attribution:{collapsed:!0}}}),this.view={center:[-72,47.2],zoom:5},this.actionbarMode=ao.Overlay,this.scrollBehavior=et.Instant}get workspaceStore(){return this.workspaceState.store}ngOnInit(){this.selectedWorkspace$=this.workspaceStore.stateView.firstBy$(e=>!0===e.state.selected).pipe((0,x.U)(e=>{const t=void 0===e?void 0:e.entity;return t&&t.actionStore.view.filter(e=>"wfsDownload"!==e.id),t})),this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",params:{featureTypes:"etablissement_mtq",fieldNameGeometry:"geometry",version:"2.0.0",outputFormat:"geojson"},sourceFields:[{name:"idetablis",alias:"ID"},{name:"nometablis",alias:"Name"},{name:"typetablis",alias:"Type"}]}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Simple WFS ",maxResolution:3e3,visible:!0,source:e}))})}paginatorChange(e){this.workspacePaginator=e}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ne),r.Y36(kc),r.Y36(yu),r.Y36(Hw))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-workspace"]],decls:16,vars:11,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/workspace"],[3,"map","view"],["color","primary",3,"map"],["igoWorkspaceSelector","",3,"store","map"],[4,"ngIf"],[3,"store","paginatorOptions","entitySortChange$","paginatorChange",4,"ngIf"],[3,"store","paginatorOptions","entitySortChange$","paginatorChange"],[3,"store","horizontal","withToggleButton","withTitle","mode",4,"ngIf"],["class","table-compact table-centered",3,"paginator","scrollBehavior","store","template",4,"ngIf"],[3,"workspace"],[3,"store","horizontal","withToggleButton","withTitle","mode"],[1,"table-compact","table-centered",3,"paginator","scrollBehavior","store","template"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Workspace"),r.qZA(),r.TgZ(5,"mat-card-content"),r._uU(6," See the "),r.TgZ(7,"a",0),r._uU(8,"code of this example"),r.qZA(),r.qZA(),r.TgZ(9,"igo-map-browser",1),r._UZ(10,"igo-zoom-button",2),r.qZA(),r._UZ(11,"igo-workspace-selector",3),r.YNc(12,wS,3,3,"ng-container",4),r.ALo(13,"async"),r.YNc(14,AS,7,8,"ng-container",4),r.ALo(15,"async"),r.qZA()),2&e&&(r.xp6(9),r.Q6J("map",t.map)("view",t.view),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("store",t.workspaceStore)("map",t.map),r.xp6(1),r.Q6J("ngIf",r.lcZ(13,7,t.selectedWorkspace$)),r.xp6(2),r.Q6J("ngIf",r.lcZ(15,9,t.selectedWorkspace$)))},directives:[g.a8,g.$j,g.n5,g.dn,ou,uu,Fr,ux,h.O5,bt,Ir,Zo,no],pipes:[h.Ov],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}igo-entity-table[_ngcontent-%COMP%]{height:400px}igo-actionbar[_ngcontent-%COMP%]{height:48px}"]}),e})()}]);let LS=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,ZS,g.QW,n.ot,a.Ps,Fo,wi,Pr,Ui,Dy,hx]]}),e})();function FS(e,t){1&e&&r._UZ(0,"igo-metadata-button",10),2&e&&r.Q6J("layer",t.layer)}const OS=d.Bz.forChild([{path:"context",component:(()=>{class e{constructor(e,t,o){this.languageService=e,this.mapService=t,this.overlayService=o,this.map=new eu({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:6},this.mapService.setMap(this.map)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ne),r.Y36(Lc),r.Y36(By))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-context"]],decls:27,vars:7,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/context/context"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/contexts"],["igoMapContext","","igoLayerContext","",3,"map"],["color","primary",3,"map"],["color","primary",3,"map","showIfNoRotation"],["title","Contexts list"],["igoContextListBinding","",3,"map"],["title","Layers"],["igoLayerListBinding","",3,"map"],["igoLayerItemToolbar",""],[3,"layer"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Context"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"p"),r._uU(7,"* Dependencies: LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"br"),r._uU(13," See "),r.TgZ(14,"a",1),r._uU(15," contexts"),r.qZA(),r._UZ(16,"hr"),r.qZA(),r.TgZ(17,"igo-map-browser",2),r._UZ(18,"igo-zoom-button",3),r._UZ(19,"igo-geolocate-button",3),r._UZ(20,"igo-rotation-button",4),r.qZA(),r.TgZ(21,"igo-panel",5),r._UZ(22,"igo-context-list",6),r.qZA(),r.TgZ(23,"igo-panel",7),r.TgZ(24,"igo-layer-list",8),r.YNc(25,FS,1,1,"ng-template",null,9,r.W1O),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.xp6(17),r.Q6J("map",t.map),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("map",t.map)("showIfNoRotation",!0),r.xp6(2),r.Q6J("map",t.map),r.xp6(2),r.Q6J("map",t.map))},directives:[g.a8,g.$j,g.n5,g.dn,ou,rw,sw,uu,pu,Cu,Ri,qw,Dw,zp,Vp,bl],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{margin-bottom:5px}"]}),e})()}]);let MS=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[y.Ed,OS,g.QW,n.ot,a.Ps,Ui,Dy,cd,wl,Gy,cv,Dh,Uw]]}),e})();const IS=[{path:"",redirectTo:"/home",pathMatch:"full"},{path:"**",redirectTo:"/home"}];let kS=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[d.Bz.forRoot(IS,{useHash:!0})],d.Bz]}),e})(),PS=(()=>{class e{constructor(e,t,o){this.changeDetectorRef=e,this.media=t,this.renderer=o,this.title="IGO",this.version=Q,this.themeClass="deeppurple-theme",this.mobileQuery=t.matchMedia("(max-width: 600px)"),this._mobileQueryListener=()=>e.detectChanges(),this.mobileQuery.addEventListener("change",this._mobileQueryListener),this.renderer.addClass(document.body,this.themeClass),this.detectOldBrowser()}ngOnDestroy(){this.mobileQuery.removeEventListener("change",this._mobileQueryListener)}detectOldBrowser(){k.satisfies({ie:"<11",chrome:"<64",firefox:"<60"})&&console.log("Very old browser ! ",k.getBrowser())}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.sBO),r.Y36(J.vx),r.Y36(r.Qsj))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-root"]],decls:91,vars:8,consts:[[1,"example-container"],["color","primary",1,"example-toolbar"],["mat-icon-button","",3,"click"],["svgIcon","menu"],[1,"example-sidenav-container"],["opened","true","fixedTopGap","56",3,"mode","fixedInViewport"],["snav",""],["mat-list-item","","routerLink","."],["mat-list-item","","routerLink","activity"],["mat-list-item","","routerLink","config"],["mat-list-item","","routerLink","language"],["mat-list-item","","routerLink","media"],["mat-list-item","","routerLink","message"],["mat-list-item","","routerLink","request"],["mat-list-item","","routerLink","auth-form"],["mat-list-item","","routerLink","action"],["mat-list-item","","routerLink","dynamic-component"],["mat-list-item","","routerLink","entity-table"],["mat-list-item","","routerLink","entity-selector"],["mat-list-item","","routerLink","form"],["mat-list-item","","routerLink","table"],["mat-list-item","","routerLink","tool"],["mat-list-item","","routerLink","widget"],["mat-list-item","","routerLink","simple-map"],["mat-list-item","","routerLink","layer"],["mat-list-item","","routerLink","legend"],["mat-list-item","","routerLink","overlay"],["mat-list-item","","routerLink","geometry"],["mat-list-item","","routerLink","feature"],["mat-list-item","","routerLink","hover"],["mat-list-item","","routerLink","measure"],["mat-list-item","","routerLink","draw"],["mat-list-item","","routerLink","query"],["mat-list-item","","routerLink","catalog"],["mat-list-item","","routerLink","search"],["mat-list-item","","routerLink","print"],["mat-list-item","","routerLink","import-export"],["mat-list-item","","routerLink","directions"],["mat-list-item","","routerLink","time-filter"],["mat-list-item","","routerLink","ogc-filter"],["mat-list-item","","routerLink","spatial-filter"],["mat-list-item","","routerLink","workspace"],["mat-list-item","","routerLink","context"]],template:function(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",0),r.TgZ(1,"mat-toolbar",1),r.TgZ(2,"button",2),r.NdJ("click",function(){return r.CHM(e),r.MAs(10).toggle()}),r._UZ(3,"mat-icon",3),r.qZA(),r.TgZ(4,"h1"),r._uU(5),r.qZA(),r.TgZ(6,"h5"),r._uU(7),r.qZA(),r.qZA(),r.TgZ(8,"mat-sidenav-container",4),r.TgZ(9,"mat-sidenav",5,6),r.TgZ(11,"mat-nav-list"),r.TgZ(12,"a",7),r._uU(13,"Home"),r.qZA(),r._UZ(14,"hr"),r.TgZ(15,"a",8),r._uU(16,"Activity"),r.qZA(),r.TgZ(17,"a",9),r._uU(18,"Config"),r.qZA(),r.TgZ(19,"a",10),r._uU(20,"Language"),r.qZA(),r.TgZ(21,"a",11),r._uU(22,"Media"),r.qZA(),r.TgZ(23,"a",12),r._uU(24,"Message"),r.qZA(),r.TgZ(25,"a",13),r._uU(26,"Request"),r.qZA(),r._UZ(27,"hr"),r.TgZ(28,"a",14),r._uU(29,"Authentification"),r.qZA(),r._UZ(30,"hr"),r.TgZ(31,"a",15),r._uU(32,"Action"),r.qZA(),r.TgZ(33,"a",16),r._uU(34,"Dynamic Component"),r.qZA(),r.TgZ(35,"a",17),r._uU(36,"Entity Table"),r.qZA(),r.TgZ(37,"a",18),r._uU(38,"Entity Selector"),r.qZA(),r.TgZ(39,"a",19),r._uU(40,"Form"),r.qZA(),r.TgZ(41,"a",20),r._uU(42,"Table"),r.qZA(),r.TgZ(43,"a",21),r._uU(44,"Tool"),r.qZA(),r.TgZ(45,"a",22),r._uU(46,"Widget"),r.qZA(),r._UZ(47,"hr"),r.TgZ(48,"a",23),r._uU(49,"Simple map"),r.qZA(),r.TgZ(50,"a",24),r._uU(51,"Layer"),r.qZA(),r.TgZ(52,"a",25),r._uU(53,"Legend"),r.qZA(),r.TgZ(54,"a",26),r._uU(55,"Overlay"),r.qZA(),r.TgZ(56,"a",27),r._uU(57,"Geometry"),r.qZA(),r.TgZ(58,"a",28),r._uU(59,"Feature"),r.qZA(),r.TgZ(60,"a",29),r._uU(61,"Hover"),r.qZA(),r.TgZ(62,"a",30),r._uU(63,"Measure"),r.qZA(),r.TgZ(64,"a",31),r._uU(65,"Draw"),r.qZA(),r.TgZ(66,"a",32),r._uU(67,"Query"),r.qZA(),r.TgZ(68,"a",33),r._uU(69,"Catalog"),r.qZA(),r.TgZ(70,"a",34),r._uU(71,"Search"),r.qZA(),r.TgZ(72,"a",35),r._uU(73,"Print"),r.qZA(),r.TgZ(74,"a",36),r._uU(75,"Import/Export"),r.qZA(),r.TgZ(76,"a",37),r._uU(77,"Directions"),r.qZA(),r.TgZ(78,"a",38),r._uU(79,"Time filter"),r.qZA(),r.TgZ(80,"a",39),r._uU(81,"OGC filter"),r.qZA(),r.TgZ(82,"a",40),r._uU(83,"Spatial filter"),r.qZA(),r.TgZ(84,"a",41),r._uU(85,"Workspace"),r.qZA(),r._UZ(86,"hr"),r.TgZ(87,"a",42),r._uU(88,"Context"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(89,"mat-sidenav-content"),r._UZ(90,"router-outlet"),r.qZA(),r.qZA(),r.qZA()}2&e&&(r.ekj("example-is-mobile",t.mobileQuery.matches),r.xp6(5),r.Oqu(t.title),r.xp6(2),r.Oqu(t.version.lib),r.xp6(1),r.Udp("margin-top",t.mobileQuery.matches?56:0,"px"),r.xp6(1),r.Q6J("mode",t.mobileQuery.matches?"over":"side")("fixedInViewport",t.mobileQuery.matches))},directives:[u.Ye,n.lW,a.Hw,c.TM,c.JX,l.Hk,l.Tg,d.yS,c.Rh,d.lC],styles:["h1[_ngcontent-%COMP%]{width:100%;text-align:center;font-size:26px}.example-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:absolute;top:0;bottom:0;left:0;right:0}.example-is-mobile[_ngcontent-%COMP%]   .example-toolbar[_ngcontent-%COMP%]{position:fixed;z-index:2}.example-sidenav-container[_ngcontent-%COMP%]{flex:1}.example-is-mobile[_ngcontent-%COMP%]   .example-sidenav-container[_ngcontent-%COMP%]{flex:1 0 auto}mat-sidenav[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.031)}.example-is-mobile[_ngcontent-%COMP%]   mat-sidenav[_ngcontent-%COMP%]{background-color:#fff}mat-sidenav-content[_ngcontent-%COMP%]{padding:10px}"]}),e})(),_S=(()=>{class e{constructor(e,t){e.addSvgIconSet(t.bypassSecurityTrustResourceUrl("./assets/igo2/core/icons/mdi.svg"))}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(a.jv),r.LFG(i.H7))},e.\u0275mod=r.oAB({type:e,bootstrap:[PS]}),e.\u0275inj=r.cJS({imports:[[i.b2,s.PW,c.SJ,u.g0,n.ot,a.Ps,l.ie,Rr,Nr,jr,Qr,Yr,Vr,Xr,ts,ss,as,us,hs,ms,ws,Ts,hn,Mx,Px,$x,Dx,Ux,Jx,jx,Qx,Yx,Wx,Kx,nS,lS,uS,dS,gS,fS,bS,LS,MS,kS,i.t6]]}),e})();o(58256),Jr.production&&(0,r.G48)(),i.q6().bootstrapModule(_S).catch(e=>console.log(e))},46700:function(e,t,o){var i={"./af":62275,"./af.js":62275,"./ar":90857,"./ar-dz":11218,"./ar-dz.js":11218,"./ar-kw":14754,"./ar-kw.js":14754,"./ar-ly":66680,"./ar-ly.js":66680,"./ar-ma":92178,"./ar-ma.js":92178,"./ar-sa":56522,"./ar-sa.js":56522,"./ar-tn":95682,"./ar-tn.js":95682,"./ar.js":90857,"./az":70164,"./az.js":70164,"./be":79774,"./be.js":79774,"./bg":60947,"./bg.js":60947,"./bm":21832,"./bm.js":21832,"./bn":89650,"./bn-bd":74477,"./bn-bd.js":74477,"./bn.js":89650,"./bo":66005,"./bo.js":66005,"./br":98492,"./br.js":98492,"./bs":70534,"./bs.js":70534,"./ca":52061,"./ca.js":52061,"./cs":84737,"./cs.js":84737,"./cv":61167,"./cv.js":61167,"./cy":77996,"./cy.js":77996,"./da":9528,"./da.js":9528,"./de":14540,"./de-at":49430,"./de-at.js":49430,"./de-ch":67978,"./de-ch.js":67978,"./de.js":14540,"./dv":83426,"./dv.js":83426,"./el":6616,"./el.js":6616,"./en-au":63816,"./en-au.js":63816,"./en-ca":32162,"./en-ca.js":32162,"./en-gb":83305,"./en-gb.js":83305,"./en-ie":61954,"./en-ie.js":61954,"./en-il":43060,"./en-il.js":43060,"./en-in":59923,"./en-in.js":59923,"./en-nz":13540,"./en-nz.js":13540,"./en-sg":16505,"./en-sg.js":16505,"./eo":41907,"./eo.js":41907,"./es":86640,"./es-do":41246,"./es-do.js":41246,"./es-mx":56131,"./es-mx.js":56131,"./es-us":36430,"./es-us.js":36430,"./es.js":86640,"./et":62551,"./et.js":62551,"./eu":32711,"./eu.js":32711,"./fa":54572,"./fa.js":54572,"./fi":33390,"./fi.js":33390,"./fil":87860,"./fil.js":87860,"./fo":48216,"./fo.js":48216,"./fr":99291,"./fr-ca":98527,"./fr-ca.js":98527,"./fr-ch":58407,"./fr-ch.js":58407,"./fr.js":99291,"./fy":47054,"./fy.js":47054,"./ga":49540,"./ga.js":49540,"./gd":73917,"./gd.js":73917,"./gl":51486,"./gl.js":51486,"./gom-deva":56245,"./gom-deva.js":56245,"./gom-latn":48868,"./gom-latn.js":48868,"./gu":59652,"./gu.js":59652,"./he":89019,"./he.js":89019,"./hi":42040,"./hi.js":42040,"./hr":63402,"./hr.js":63402,"./hu":79322,"./hu.js":79322,"./hy-am":27609,"./hy-am.js":27609,"./id":57942,"./id.js":57942,"./is":98275,"./is.js":98275,"./it":73053,"./it-ch":4378,"./it-ch.js":4378,"./it.js":73053,"./ja":46176,"./ja.js":46176,"./jv":679,"./jv.js":679,"./ka":92726,"./ka.js":92726,"./kk":72953,"./kk.js":72953,"./km":86957,"./km.js":86957,"./kn":59181,"./kn.js":59181,"./ko":47148,"./ko.js":47148,"./ku":27752,"./ku.js":27752,"./ky":65675,"./ky.js":65675,"./lb":41263,"./lb.js":41263,"./lo":65746,"./lo.js":65746,"./lt":11143,"./lt.js":11143,"./lv":38753,"./lv.js":38753,"./me":44054,"./me.js":44054,"./mi":31573,"./mi.js":31573,"./mk":30202,"./mk.js":30202,"./ml":68523,"./ml.js":68523,"./mn":79794,"./mn.js":79794,"./mr":56681,"./mr.js":56681,"./ms":56975,"./ms-my":39859,"./ms-my.js":39859,"./ms.js":56975,"./mt":3691,"./mt.js":3691,"./my":5152,"./my.js":5152,"./nb":7607,"./nb.js":7607,"./ne":21526,"./ne.js":21526,"./nl":86368,"./nl-be":40076,"./nl-be.js":40076,"./nl.js":86368,"./nn":68420,"./nn.js":68420,"./oc-lnc":51906,"./oc-lnc.js":51906,"./pa-in":94504,"./pa-in.js":94504,"./pl":54721,"./pl.js":54721,"./pt":74645,"./pt-br":54548,"./pt-br.js":54548,"./pt.js":74645,"./ro":71977,"./ro.js":71977,"./ru":26042,"./ru.js":26042,"./sd":78849,"./sd.js":78849,"./se":27739,"./se.js":27739,"./si":50084,"./si.js":50084,"./sk":92449,"./sk.js":92449,"./sl":23086,"./sl.js":23086,"./sq":33139,"./sq.js":33139,"./sr":30607,"./sr-cyrl":30063,"./sr-cyrl.js":30063,"./sr.js":30607,"./ss":40131,"./ss.js":40131,"./sv":21665,"./sv.js":21665,"./sw":5642,"./sw.js":5642,"./ta":33622,"./ta.js":33622,"./te":74825,"./te.js":74825,"./tet":48336,"./tet.js":48336,"./tg":39238,"./tg.js":39238,"./th":99463,"./th.js":99463,"./tk":39986,"./tk.js":39986,"./tl-ph":29672,"./tl-ph.js":29672,"./tlh":40043,"./tlh.js":40043,"./tr":51212,"./tr.js":51212,"./tzl":50110,"./tzl.js":50110,"./tzm":80482,"./tzm-latn":38309,"./tzm-latn.js":38309,"./tzm.js":80482,"./ug-cn":42495,"./ug-cn.js":42495,"./uk":54157,"./uk.js":54157,"./ur":80984,"./ur.js":80984,"./uz":64141,"./uz-latn":43662,"./uz-latn.js":43662,"./uz.js":64141,"./vi":12607,"./vi.js":12607,"./x-pseudo":66460,"./x-pseudo.js":66460,"./yo":92948,"./yo.js":92948,"./zh-cn":62658,"./zh-cn.js":62658,"./zh-hk":39352,"./zh-hk.js":39352,"./zh-mo":38274,"./zh-mo.js":38274,"./zh-tw":98451,"./zh-tw.js":98451};function r(e){var t=s(e);return o(t)}function s(e){if(!o.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}r.keys=function(){return Object.keys(i)},r.resolve=s,e.exports=r,r.id=46700},50257:function(e){"use strict";e.exports=JSON.parse('{"igo":{"auth":{"accessAnonymous":"Access as anonymous","connection":"Connection","login":"Login","password":"Password","signOut":"Sign out","user":"User","welcome":"Welcome {{name}}!","deconnection":"You are logged out.","home":"Return to the home page","error":{"Password expired":"Password expired","Maximun logins exceeded":"Maximum logins exceeded","Login lockout":"Maximum number of attempts exceeded. Your account is locked.","Wrong password":"Wrong password","Invalid username":"Invalid username"},"microsoft":{"login":"Sign in with Azure account"},"microsoftb2c":{"login":"Sign in"}}}}')},35488:function(e){"use strict";e.exports=JSON.parse('{"igo":{"common":{"confirmDialog":{"cancelBtn":"Cancel","confirmBtn":"Confirm","title":"Confirm"},"table":{"filter":"Filter"},"entity-table":{"targetHtmlUrl":"Open the external link"},"form":{"errors":{"required":"This field is required"}},"actionbar":{"scrollUp":"Scroll up","scrollDown":"Scroll down","icon":"Action list"},"interactiveTour":{"tooltipTourToolButton":"Interactive tour of the application","disaledTooltipTourToolButton":"To have access to this tool\'s tour, add contexts or layers","buttonTitle":"Discover","exitButton":"Exit","backButton":"Back","nextButton":"Next"},"paginator":{"firstPageLabel":"First page","itemsPerPageLabel":"Items per page:","lastPageLabel":"Last page","nextPageLabel":"Next page","previousPageLabel":"Previous page","of":"of"}}}}')},88952:function(e){"use strict";e.exports=JSON.parse('{"igo":{"context":{"bookmarkButton":{"create":"Create a new context","dialog":{"createMsg":"The context \'{{value}}\' was created","createTitle":"Context created","placeholder":"Title","title":"New context"}},"contextManager":{"clone":"Clone this context","delete":"Delete this context","dialog":{"cloneMsg":"The context \'{{value}}\' was cloned","cloneTitle":"Context cloned","copyMsg":"Text copied","copyTitle":"Context ID","confirmDelete":"Are you sure you want to delete this context?","deleteMsg":"The context \'{{value}}\' was deleted","deleteTitle":"Context deleted","favoriteMsg":"The context \'{{value}}\' was set as favorite","favoriteTitle":"Favorite saved","saveMsg":"The context \'{{value}}\' was saved","saveTitle":"Context saved"},"edit":"Edit this context","errors":{"uncaught":{"message":"Sorry, service is currently not available. Please try again later","title":"Error server"},"addPermission":"The permission you are trying to add is already in the context.","addPermissionEmpty":"The permission you are trying to add is not valid","addPermissionTitle":"Add permission error"},"favorite":"Set as favorite context","form":{"copy":"Copy the context ID","edit":"Save","title":"Title","titleRequired":"Title required","uri":"ID","uriRequired":"ID required"},"invalid":{"text":"Context \'{{value}}\' is invalid. The default context was loaded.","title":"Invalid context"},"managePermissions":"Manage permissions context","manageTools":"Manage tools context","ourContexts":"Our contexts","publicContexts":"Public contexts","save":"Save this context","sharedContexts":"Shared contexts","filterPlaceHolder":"Filter by name","sortAlphabetically":"Sort alphabetically","sortContextOrder":"Replace according to the creation date","userAccount":"User account","filterUser":"Filter by user group","emptyContext":"Empty context","emptyContextTooltip":"Create a new empty context","contextMap":"Context from map","contextMapTooltip":"Create a new context from map layers","hide":"Hide this context","show":"Show up this context","showHidden":"Show hidden contexts"},"contextImportExport":{"export":{"exportPlaceHolder":"Layers","exportContextName":"Context name","exportSelectAll":"Select all","success":{"text":"Context has been exported.","title":"Context export success"},"nothing":{"text":"No context could be exported.","title":"Nothing to export"},"failed":{"text":"Failed to export","title":"Failed to export context"}},"import":{"success":{"title":"Imported context","text":"The context \'{{value}}\' was added to the map"},"empty":{"text":"The context \'{{value}}\' contained nothing that could be imported.","title":"Nothing to import"},"invalid":{"text":"The context \'{{value}}\' is invalid.","title":"Invalid context"},"unreadable":{"title":"Unreadable context","text":"The context \'{{value}}\' is unreadable"},"tooLarge":{"text":"The context \'{{value}}\' is too large (Max: {{size}} MB)","title":"Context too large"}}},"permission":{"addBtn":"Add","delete":"Remove permission","dialog":{"addMsg":"The permission \'{{value}}\' was added","addTitle":"Permission added","deleteMsg":"The permission \'{{value}}\' was removed","deleteTitle":"Permission removed","scopeChangedMsg":"The scope was changed to {{value}}","scopeChangedTitle":"Scope changed"},"profil":"Profil","user":"User or group","profilRequired":"Profil required","read":"Read only","readOnlyTitle":"Read-only context","readOnlyMsg":"You can only revoke permission if the context is shared directly to your username.","scope":{"private":"Private","protected":"Protected","shared":"Shared","public":"Public"},"write":"Read and Write"},"poiButton":{"create":"Create a new zone of interest","dialog":{"confirmDelete":"Are you sure you want to delete this zone of interest?","createMsg":"The zone of interest \'{{value}}\' was created","createTitle":"Zone of interest created","deleteMsg":"The zone of interest \'{{value}}\' was deleted","deleteTitle":"Zone of interest deleted","placeholder":"Title","title":"New zone of interest"},"placeholder":"Zones of interest"},"sidenav":{"goBack":"Go Back","mainMenu":"Main Menu"},"shareMap":{"button":"Share map","refreshBtn":"Refresh sharing","copy":"Copy to clipboard","shareWithApi":"Share by context","shareWithUrl":"Share by url","dialog":{"copyMsg":"Link copied to clipboard","copyTitle":"Link"},"errorTitle":"Share Map error","placeholderLink":"Link","included":"Included in shared URL :","context":"The context when creating the sharing link.","center":"The coordinates of the center of the map (longitude, latitude).","zoom":"The zoom level of the map.","addedLayers":"The layers added by the catalog or by the search bar.","visibleInvisible":"Visibility status of layers.","excluded":"Excluded in the shared URL :","order":"The order of the layers.","opacity":"Modifications made to the opacity of the layers.","filterOgc":"Additions / modifications made to filters by attribute.","filterTime":"The current value for time filters."},"tool":{"dialog":{"addMsg":"The tool \'{{value}}\' was added","addTitle":"Tool added","deleteMsg":"The tool \'{{value}}\' was removed","deleteTitle":"Tool removed"}},"userButton":{"dialog":{"email":"Email","expiration":"Expiration","user":"User","clearPreferences":"Clear my preferences"},"infoTitle":"User info","logout":"Logout"}}}}')},63154:function(e){"use strict";e.exports=JSON.parse('{"igo":{"core":{"errors":{"uncaught":{"message":"Sorry, service is currently not available. Please try again later","title":"Error server"}},"network":{"online":{"message":"Online","title":"Status:"},"offline":{"message":"Offline","title":"Status:"}}}}}')},10711:function(e){"use strict";e.exports=JSON.parse('{"igo":{"geo":{"catalog":{"layer.addToMap":"Add to map","layer.addToMapOutRange":"Add to map. The layer is not visible at the current scale. Please zoom in/out","layer.removeFromMap":"Remove from map","layer.removeFromMapOutRange":"Remove from map. The layer is not visible at the current scale. Please zoom in/out","group.addToMap":"Add all layers from this group to map","group.removeFromMap":"Remove all layers from this group to map","baseLayers":"Baselayers","unavailableTitle":"Catalog unavailable","unavailable":"The catalog \'{{value}}\' is unavailable at the moment or you don\'t have the required permissions.","externalProvider":{"catalog":"This catalog comes from an external organization.","group":"This layers comes from an external organization.","layer":"This layer comes from an external organization.","unavailableWithEmail":"The catalog \'{{value}}\' is unavailable at the moment. To add an external service to the predefined list, please contact us at {{emailAddress}}. Delays can apply if problems occurs with the provider."},"library.add":"Add this catalog to the list","library.cancel":"Cancel","library.remove":"Remove this catalog from the list","library.inlist":{"title":"Catalog already contained","message":"The catalog is already contained in the list."},"library.addTitle":"Adding a catalog","library.addBtn":"Add a catalog"},"clickOnMap":{"clickedFeature":"Clicked Feature"},"baselayersSwitcher":{"title":"Basemaps"},"dataSource":{"unavailableTitle":"Layer unavailable","optionsApiUnavailable":"Layer information could not be retrieved. Some layers may not present the correct information.","unavailable":"The layer \'{{value}}\' is unavailable at the moment or you don\'t have the required permissions."},"dropGeoFile":{"invalid":{"text":"The file \'{{value}}\' is invalid ({{mimeType}})","title":"Invalid file"},"empty":{"text":"The file \'{{value}}\' contained nothing that could be imported.","title":"Nothing to import"},"success":{"text":"Imported file","title":"The layer \'{{value}}\' was added to the map"},"unreadable":{"text":"Unreadable file","title":"The file \'{{value}}\' is unreadable"},"tooLarge":{"text":"The file \'{{value}}\' is too large (Max: {{size}} MB)","title":"File too large"},"invalidSRS":{"text":"The projection is valid. It must start with EPSG:","title":"Invalid projection"},"ogreServer":{"title":"Ogre server error 500","text":"Error in convert to geojson. Maybe file is too big, try to import that file in geojson format"}},"export":{"customList":{"text":"Some of the selected layers ( {{value}} ) limit the format\'s list","title":"Restricted list of formats"},"nothing":{"text":"No feature could be exported.","title":"Nothing to export"},"noFormat":{"text":"No export format valid for all selected layers. Please export the layers one at a time.","title":"No valid format"},"failed":{"text":"Failed to export","title":"Failed to export features"},"popupBlocked":{"text":"</br>Enable the popup in your browser. </br>For Chrome and Edge, on the right into the Address Bar.</br>{{extraMessage}}","selectAgain":"Fix it and re-select an output format.","retry":"Please retry to export","title":"Popup blocked by your browser"},"success":{"text":"Features have been exported.","title":"Features export success"},"format":{"GeoJSON":"GeoJSON","GML":"GML","GPX":"GPX","KML":"KML","Shapefile":"Shapefile","CSVcomma":"CSV (comma delimited)","CSVsemicolon":"CSV (Excel compatible)","URL":"External link"},"gpx.error.poly":{"title":"GPX error","text":"GPX format do now allow polygon features"},"encoding":{"LATIN1":"LATIN-1","UTF8":"UTF-8"}},"importExportForm":{"exportButton":"Export","exportButtonLink":"Open the link","exportButtonLinks":"Open the links","exportCircleToPolygon":"Transform Circle entities in polygons","exportFormatPlaceholder":"Format","exportLayerPlaceholder":"Layer","exportFileNamePlaceholder":"Filename","encodingPlaceholder":"Encoding","exportTabTitle":"Export","exportFeatureInExtent":"Export only features in map extent","exportNoLayersExportable":"There is no exportable layer in your map","exportSelectedFeature":"Export only selected features","importButton":"Import","importProjPlaceholder":"Coordinate system of the file to import","importTabTitle":"Import","importClarifications":"Clarifications","importSizeMax":"The file size limit is {{size}} Mb","importFormatAuthorized":"Formats authorized: geojson, kml, gpx, gml, shapefile","importShpZip":"Shapefiles must be zipped AND geometries stored in Latitude Longitude coordinate (EPSG:4326/WGS:84)","other":"other","others":"others","projections":{"mtm":"MTM zone {{zone}} ({{code}})","utm":"UTM zone {{zone}} ({{code}})","webMercator":"Web Mercator ({{code}})","nad83":"Lat-Long NAD83 ({{code}})","wgs84":"Lat-Long WGS84 ({{code}})","choose":"You must choose a projection for your input file."}},"operators":{"caseSensitive":"Case sensitive","And":"And","Or":"Or","PropertyIsEqualTo":"=","PropertyIsNotEqualTo":"!=","PropertyIsLike":"\u2248","PropertyIsGreaterThan":">","PropertyIsGreaterThanOrEqualTo":">=","PropertyIsLessThan":"<","PropertyIsLessThanOrEqualTo":"<=","PropertyIsBetween":"between","During":"during (temporal)","PropertyIsNull":"is null","Intersects":"intersects (spatial)","Within":"within (spatial)","Contains":"contains (spatial)","tooltip":{"And":"Logical operator between filters where both conditions must be true","Or":"Logical operator between filters where at least one (1) condition must be true","PropertyIsEqualTo":"Identical (case sensitive)","PropertyIsNotEqualTo":"Different(case sensitive)","PropertyIsLike":"Like Example: *road* Finds any values that have \'road\' in any position. road* Finds any values that begin by \'road\'. wildCard =\'*\', singleChar = \'.\' escapeChar = \'!\' (case sensitive)","PropertyIsGreaterThan":"Greater than","PropertyIsGreaterThanOrEqualTo":"Greater than or equal to ","PropertyIsLessThan":"Lesser than","PropertyIsLessThanOrEqualTo":"Lesser than or equal to","PropertyIsBetween":"Apply a range check between the lower and upper boundary (values are included)","During":"Apply a range check for time attributes","PropertyIsNull":"Return features where the attribute is null","Intersects":"Return features in geometric intersection with the provided geometry","Within":"Return feature which are completely contained by the provided geometry","Contains":"Return feature completely containing by the provided geometry"}},"sourceFields":{"selectField":"Choose a field"},"filter":{"resetFilters":"(Apply no filters)","addFilter":"Add an empty filter to the current list","removeFilter":"Remove the current filter from the filters\'s list","toggleFilterState":"Enable/disable the current filter","refreshFilters":"Update this datasource with the active filter(s). To enable this button, the layer must be visible (or in the defined scale ranges) or you must modify the current filter.","layerFiltered":"This layer is currently filtered","layerFilterable":"This layer is filterable","filterBy":"Filter by","advancedOgcFilters":"Advanced filters","displayMoreResults":"Display more (+)","displayLessResults":"Display less (-)","placeholder":"Enter a value","placeholderSnrc":"Ex: 21L14","selectOperator":"Select an operator","sliderModeTitle":"Time slider","reportingDate":"Reporting date"},"spatialSelector":{"fixedExtent":"Fixed extent","btnSetExtent":"Define the extent of the spatial filter to the current view","snrc":"SNRC","selectFeature":"","drawFeature":""},"layer":{"hideLayer":"Hide Layer","lowerLayer":"Bring layer backward","hideSelectedLayers":"Hide selected layers","filterLowerLayer":"The backward movement is always done according to the order of the map!","filterPlaceholder":"Filter the layers list","activateSelectionMode":"Activate multiple selection mode","deactivateSelectionMode":"Deactivate multiple selection mode","tools":"Tools","selectAll":"Select all layers","deselectAll":"Deselect all layers","zoomLayer":"Zoom To Layer Extents","zoomLayers":"Zoom To Selected Layers Extents","opacity":"Opacity","raiseLayer":"Bring layer forward","filterRaiseLayer":"The forward movement is always done according to the order of the map!","moreOptions":"Layer\'s tools","removeLayer":"Remove this layer from the map","removeSelectedLayers":"Remove selected layers from the map","removeSelectedLayersRestriction":"Some selected layers cannot be removed","showFeaturesList":"Show features list","showLayer":"Show Layer","showSelectedLayers":"Show selected layers","subsetLayersListKeyword":"Subset the layers\'s list by title or type (wms, wfs,...)","deleteKeyword":"Delete the keyword","subsetLayersListOnlyVisible":"Subset the layers\'s list by visibility","subsetLayersListOnlyInRange":"Subset the layers\'s list by resolution range","sortAlphabetically":"Sort the layers\'s list alphabetically","sortMapOrder":"Sort the layers\'s list based on layer\'s order on the map","resetLayersList":"Remove the current applied filter to layers\'s list","trackFeature":"Track the feature","legend":{"default":"Default","loadingLegendText":"Loading legend","noLegendText":"No legend available for this layer","noLegendScale":"No legend available for this scale","selectStyle":"Select the style of the legend","showAll":"Show all legends (non visible and out of range)","noLayersVisibleWithShowAllButton":"No layer currently visible. Activate the button above to see all the legends.","noLayersVisibleWithShowAllButtonButZoom":"No layer currently visible. If you zoom in the map, some layers will appear OR activate the button above to see all the legends.","noLayersVisible":"No layers currently visible.","noLayersVisibleButZoom":"No layers currently visible. However, if you zoom in the map, some layers will appear."}},"download":{"action":"Download data","title":"Downloading file","start":"Started. Check the download progression in your browser","end":"Completed"},"mapButtons":{"baselayerSwitcher":"Change base layer","geolocate":"Geolocate","offline":"Offline mode","online":"Online mode","zoomIn":"Zoom in ({{zoom}})","zoomOut":"Zoom out ({{zoom}})","resetRotation":"Set map to north","tipRotation":"Hold Alt and SHIFT while dragging on map to rotate the map."},"metadata":{"show":"Show metadata"},"printForm":{"corsErrorMessageBody":"Unable to print due to non-owned access rights","corsErrorMessageHeader":"Print","comment":"Comment","doZipFile":"Zip file","outputFormat":"Output format","paperFormat":"Paper format","paperFormats":{"A0":"33.1 X 46.8\\" (A0)","A1":"23.4 X 33.1\\" (A1)","A2":"16.5 X 23.5\\" (A2)","A3":"11.7 X 16.5\\" (A3)","A4":"8.3 X 11.7\\" (A4)","A5":"5.8 X 8.3\\" (A5)","Letter":"Letter","Legal":"Legal"},"imageFormat":"Image format","orientation":"Orientation","landscape":"Landscape","portrait":"Portrait","projection":"Projection","resolution":"Resolution","saveBtn":"Save","scale":"Scale","showProjection":"Show projection","showScale":"Show scale","title":"Title","subtitle":"Subtitle","legendPosition":"Legend Position","legendPositions":{"none":"No legend","topleft":"Top left corner of the map","topright":"Top right corner of the map","bottomleft":"Bottom left corner of the map","bottomright":"Bottom right corner of the map","newpage":"On a new page"}},"directionsForm":{"stopLayer":"Directions - stops","routeLayer":"Directions - route","start":"Start","intermediate":"Intermediate","end":"End","directionsBtn":"Get route","resetDirectionsBtn":"Reset","zoomRoute":"Zoom on route","null":"","directions":"Directions","raiseStop":"Raise stop\'s priority","lowerStop":"Lower stop\'s priority","addStop":"Add a stop","removeStop":"Remove this stop","drivingOptions":"Options","summary":"Direction\'s summary","stopsList":"Stops\'s list","instructions":"Instructions","copy":"Copy directions","geolocate":"Use current localisation as stop","link":"Link","dialog":{"copyMsg":"Directions copied to clipboard","copyMsgLink":"Link for directions copied to clipboard","copyTitle":"Directions"}},"directions":{"uturn":"u-turn","sharp right":"sharp right","right":"right","slight right":"slightly on right","sharp left":"sharp left","left":"left","slight left":"slightly on left","straight":"forward"},"cardinalPoints":{"n":"north","ne":"northeast","e":"east","se":"southeast","s":"south","sw":"southwest","w":"west","nw":"northwest"},"search":{"placeholder":"Search for a localisation or a layer","emptyType.placeholder":"Please choose a search type","feature.title":"Localisation","feature.placeholder":"Search for a place localisation","layer.title":"Layer","layer.placeholder":"Search for a layer","ichercheReverse.name":"Search by coordinates","ilayer":{"name":"Layers","properties":{"abstract":"Abstract","groupTitle":"Group","title":"Title","type":"Type","url":"URL","metadataUrl":"Metadata","name":"Layer name","urlInfo":"URL - WMS/WFS","downloadUrl":"Data download"},"type":{"layer":"Layer","groupLayer":"Group of layers"}},"nominatim":{"type":{"food":"Food","health":"Health","entertainment":"Entertainment","finance":"Finance"},"country":{"all":"The world","canada":"Canada"}},"icherche":{"name":"iCherche","type":{"address":"Address","oldAddress":"Old address","district":"District","postalCode":"Postal Code","city":"City","oldCity":"Old city","mrc":"MRC","regadmin":"Administrative Region","road":"Road","intersection":"Intersection","place":"Place","exit":"Highway exit","cn":"CN mark","gcc":"Coast Guard mark (CCG)","sumi":"SUMI mark","km":"Mileage mark","hq":"Hydro-Quebec","entreprise":"Entreprise","cadastre":"Cadastre"},"restrictExtent":{"map":"\xc0 l\'\xe9tendue de la carte","quebec":"Au Qu\xe9bec"}},"coordinates":{"name":"Coordinates","coord":"Geographic (longitude, latitude)","coordDMS":"Geographic (longitude, latitude) (DMS)","radius":"Radius","conf":"Confidence"},"menu.tooltip":"Search Options","settings":{"title":"Settings"},"pointerSearchSummary":{"title":"Pointer position","tooltip":"Based on every search source, show the summary of the pointer location. Use F2 to activate/deactivate."},"searchResultsGeometry":{"title":"Show results geometries","tooltip":"Hide/ show the results geometries "},"searchSources":{"selectAll":"Select All","unselectAll":"Unselect All","settings":{"results type":"Results type","ecmax":"Maximum deviation","radius":"Search radius","results limit":"Number of results","multiple object":"Multiple object","restrictExtent":"Restrict the extent","selectAll":"Select All","unselectAll":"Unselect All","true":"Yes","false":"No"}},"displayMoreResults":"Display more results"},"geometry":{"geometry":"Geometry","point":"Point","line":"Line","polygon":"Polygon"},"targetHtmlUrl":"Open the external link","searchByCoord":"Search by coordinates","searchByName":"Search by name","seeRouting":"See routing","timeFilter":{"date":"Date","endDate":"End Date","startDate":"Start Date","hour":"Hour","minute":"Minute"},"spatialFilter":{"spatialFilter":"Spatial filter","predefined":"Predefined Zone","draw":"Draw","polygon":"Polygon","point":"Circle","drawPolygon":"Draw a polygon","drawCircle":"Draw a circle","searchLabel":"Search by","buffer":"Buffer","search":"Search","drawControl":"Activate draw control","listLabel":"Zone","layer":"Layer","goSearch":"Launch research","removeLayer":"Remove results","exportLayer":"Export results","clearForm":"Remove draw","clearSearch":"Reset field","Address":"Addresses","Thematics":"Thematics","searchResults":"Search Results","type":"Type","radius":"Radius","radiusAlert":"Radius must be between 0 and 100 kilometers (or 100 000 meters)","bufferAlert":"Buffer must be between 0 and 100 kilometers (or 100 000 meters)","maxSizeAlert":"Search results number exceeds 10000. Some may be missing.","zeroResults":"There are no results for this search.","warning":"Warning","freehandControl":"Freehand","group":{"toponyme":"Toponym","culturel":"Cultural","education":"Education","sante":"Health","securite":"Security","sepaq":"SEPAQ","transport":"Transportation"}},"terrapi":{"AdmRegion":"Administratives region","Mun":"Municipalities","Arrond":"Boroughs","CircFed":"Federals districts","CircProv":"Provincials districts","DirReg":"Regionals directorates","MRC":"RCM","RegTour":"Touristics regions","limites":"Administrative boundaries","bornes":"Landmarks","hydro":"Hydrography","routes":"Roads","bati":"Buildings","batiment":"Buildings","camping":"Camping","equipement":"Equipment","commun":"Public","geographie":"Natural sites","parc":"Parks","secteur":"Sector","immeubles":"Tenement","sites":"Cultural sites","cpe":"Children\'s education center","public":"Public schools","prive":"Private school","gouvernemental":"Government schools","colleges":"Colleges","universites":"University","aine":"Residences for seniors","ambulance":"Ambulance zones","clinique":"Clinics","etabl":"Health institutions","gmf":"Family doctors group","naissance":"Birth house","pharmacie":"Pharmacy","casernes":"Fire stations","correctionnel":"Correctional centres","organisme":"Security organization","palais-justice":"Courthouses","penitencier-fed":"Federal penitentiaries","penitencier-prov":"Provincial penitentiaries","polices":"Police station"},"measure":{"dialog":{"title":"Sum of the selection","length.title":"Length","area.title":"Area","lengthInMeters":"Meters","lengthInKilometers":"Kilometers","lengthInMiles":"Miles","lengthInFeet":"Feet","areaInSquareMeters":"Meters\xb2","areaInSquareKilometers":"Kilometers\xb2","areaInSquareMiles":"Miles\xb2","areaInHectares":"Hectares","areaInAcres":"Acres","perimeterInMeters":"Perimeter in meters"},"layerTitle":"Measure on map","area":"Area","areaHeader":"Area","length":"Length","lengthHeader":"Length / Perimeter","perimeter":"Perimeter","meters":"Meters","m":"m","kilometers":"Kilometers","km":"km","miles":"Miles","mi":"mi","feet":"Feet","ft":"ft","squareMeters":"Meters\xb2","m\xb2":"m\xb2","squareKilometers":"Kilometers\xb2","km\xb2":"km\xb2","squareMiles":"Miles\xb2","mi\xb2":"mi\xb2","squareFeet":"Feet\xb2","ft\xb2":"ft\xb2","hectares":"Hectares","ha":"ha","acres":"Acres","ac":"ac","toggleActive":"Activate measures","toggleDisplayLines":"Display distances for the lines","toggleDisplayDistance":"Display distances for the areas","toggleDisplayAreas":"Display areas","toggleAutoUnits":"Auto Units","actionbar":{"calculate.tooltip":"Calculate","delete.tooltip":"Delete","modify.tooltip":"Modify"}},"draw":{"abort":"Abort current drawing","cancelColorPicker":"Cancel","Circle":"Circle","colorPicker":"Click to open the color picker","dialogInstruction":"Enter your draw\'s label","dialogTitle":"Label","delete":"Remove Drawings from map","drawing":"Draws","fill":"Fill","finish":"Finish current drawing","icon":"Icons","labels":"Labels","LineString":"Line","move":"Center view on cursor","noIcon":"No icon","noLabel":"No label","Point":"Point","Polygon":"Polygon","radius":"Radius","shortcuts":"Keyboard shortcuts","stroke":"Stroke","styleSelect":"Select style","toggleMapTooltips":"Show map tooltips","undo":"Remove last vertex"},"network":{"online":{"message":"Online","title":"Status:"},"offline":{"message":"Offline","title":"Status:"}},"workspace":{"inMapExtent.active.tooltip":"Ne montrer que les entit\xe9s contenues dans la carte","inMapExtent.inactive.tooltip":"Montrer tous les entit\xe9s"}}}}')},32766:function(e){"use strict";e.exports=JSON.parse('{"igo":{"integration":{"tools":{"catalog":"Catalog","contexts":"Contexts","directions":"Directions","draw":"Draw","importExport":"Import & Export","ogcFilter":"Filter by","map":"Map","layers":"Layers","legend":"Legend","measurer":"Measure","print":"Print","searchResults":"Search Results","shareMap":"Share","timeFilter":"Time Filter","about":"About","spatialFilter":"Spatial Filter","advancedMap":"Advanced map tools"},"searchResultsTool":{"noResults":"No results","doSearch":"Do a search in the search bar.","examples":"<b>Allow to search addresses, location, coordinates and layers</b>.<br><br><u>Adresses</u> research can be done with a combination of : <ul><li>building number</li><li>street name</li><li>city name</li><li>postal code</li></ul> Examples for <u>locations</u>: <ul><li>Lac Poulin</li><li>Mcdo L\xe9vis</li><li>Saint-Isidore</li></ul> You can also use keywords to refine your search. Examples: <ul><li>#mun qu\xe9bec (to search municipalities)</li><li>#sante L\xe9vis (to search health establishments)</li><li>#cpe joyeux (to search nurseries)</li><li>#intersection li\xe9gois + \xe9glise (to search an intersection, the #+ can also be used)</li></ul>*Keywords appear when hovering results type in search settings tab -> iCherche -> Results type.<br><br><u>Coordinates</u> examples :<ul><li>Decimal degree (-68.165547, 48.644546)</li><li>Degrees, minutes, seconds (-68 9 56, 48 38 40)</li><li>Degree, minutes, decimal (-68 9.56, 48 38.40)</li><li>Projected (UTM-19 561466.861, 5388278.862)</li><li>BELL (Lat: 48 38 40N Long: 68 9 56W UNC:100 CONF:90)</li><li>Meter Meter (111594.63, 445854.74;32198)</li></ul>For more informations on coordinate\'s research : <a href=\'https://igo2.readthedocs.io/fr/next/properties.html#coordonnees\' target=\'_blank\'>Consult IGO2\'s documentation</a>","zoomOnFeatureTooltip":"Zoom on selected feature.","zoomOnFeatureTooltipOutOfView":"The feature is out of view. Zoom on selected feature."},"aboutTool":{"headerHtml":"","html":"<style>#about .bold_class{font-weight: bold;}#about .red{color: red;}#about .tool_name{border-top: 1px solid; padding-top: 10px;}#about .titre_outil{font-weight: bold; font-size: 18px; padding-bottom: 8px;}#about .subtitle{font-size: 20px; padding-bottom: 10px;}#about .align_right{text-align: right;}#about .describe{text-align: justify;}#about a img{color: black; text-decoration: none;}</style><body> <div id=\'about\'> <div class=\'bold_class subtitle\'>Features overview</div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z\'> </path> </svg></mat-icon> Search Results </div><div class=\'describe\'>Located in the upper left portion of the interface, the search bar allows you to locate yourself using an address, location or GPS coordinates. The tool can also be used to search for a layer. </div></div><br><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z\'></path> </svg></mat-icon> Contexts </div><div class=\'describe\'> Visualize groupings of layers made by theme or by work context. When you select a <span class=\'bold_class\'>Context</span>, you will find in <span class=\'bold_class\'>Map</span> each of the layers it contains. You can add other layers to it from the <span class=\'bold_class\'>Catalog</span> or the <span class=\'bold_class\'>Search</span> tool. <br><div class=\'red\'> <span class=\'bold_class\'>WARNING :</span> If you select another <span class=\'bold_class\'>Context</span>, all the layers displayed in the <span class=\'bold_class\'>Map</span> will be replaced. </div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M15,19L9,16.89V5L15,7.11M20.5,3C20.44,3 20.39,3 20.34,3L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21C3.55,21 3.61,21 3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3Z\'> </path> </svg></mat-icon> Map </div><div class=\'describe\'>Personalize your map using the <span class=\'bold_class\'>Catalog</span> or the <span class=\'bold_class\'>Search</span> tool. This space allows you to add, delete and interrogate layers.</div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M1.39,18.36L3.16,16.6L4.58,18L5.64,16.95L4.22,15.54L5.64,14.12L8.11,16.6L9.17,15.54L6.7,13.06L8.11,11.65L9.53,13.06L10.59,12L9.17,10.59L10.59,9.17L13.06,11.65L14.12,10.59L11.65,8.11L13.06,6.7L14.47,8.11L15.54,7.05L14.12,5.64L15.54,4.22L18,6.7L19.07,5.64L16.6,3.16L18.36,1.39L22.61,5.64L5.64,22.61L1.39,18.36Z\'> </path> </svg></mat-icon> Measure </div><div class=\'describe\'>Measure distances or areas on the map.</div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M14,14.5V12H10V15H8V11A1,1 0 0,1 9,10H14V7.5L17.5,11M21.71,11.29L12.71,2.29H12.7C12.31,1.9 11.68,1.9 11.29,2.29L2.29,11.29C1.9,11.68 1.9,12.32 2.29,12.71L11.29,21.71C11.68,22.09 12.31,22.1 12.71,21.71L21.71,12.71C22.1,12.32 22.1,11.68 21.71,11.29Z\'> </path> </svg></mat-icon> Directions </div><div class=\'describe\'> Build a route between two points (by placing the two points on the map or by looking for addresses). You can then add intermediate points, copy the description of the route to the clipboard or share the link.</div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M17,14H19V17H22V19H19V22H17V19H14V17H17V14M11,16L2,9L11,2L20,9L11,16M11,18.54L12,17.75V18C12,18.71 12.12,19.39 12.35,20L11,21.07L2,14.07L3.62,12.81L11,18.54Z\'></path> </svg></mat-icon> Catalog </div><div class=\'describe\'> Find all the layers that can be added to the <span class=\'bold_class\'>Map</span>. Click on the desired layer to add it. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M14,17H18V14L23,18.5L18,23V20H14V17M13,9H18.5L13,3.5V9M6,2H14L20,8V12.34C19.37,12.12 18.7,12 18,12A6,6 0 0,0 12,18C12,19.54 12.58,20.94 13.53,22H6C4.89,22 4,21.1 4,20V4A2,2 0 0,1 6,2Z\'></path> </svg></mat-icon> Import & export </div><div class=\'describe\'> Import or export a layer with a specific projection. You can also save or reload a context. It allows you to save contexts as anonymous. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z\'></path> </svg></mat-icon> Print </div><div class=\'describe\'>Print the map displayed on the screen. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M18,16.08C17.24,16.08 16.56,16.38 16.04,16.85L8.91,12.7C8.96,12.47 9,12.24 9,12C9,11.76 8.96,11.53 8.91,11.3L15.96,7.19C16.5,7.69 17.21,8 18,8A3,3 0 0,0 21,5A3,3 0 0,0 18,2A3,3 0 0,0 15,5C15,5.24 15.04,5.47 15.09,5.7L8.04,9.81C7.5,9.31 6.79,9 6,9A3,3 0 0,0 3,12A3,3 0 0,0 6,15C6.79,15 7.5,14.69 8.04,14.19L15.16,18.34C15.11,18.55 15.08,18.77 15.08,19C15.08,20.61 16.39,21.91 18,21.91C19.61,21.91 20.92,20.61 20.92,19A2.92,2.92 0 0,0 18,16.08Z\'> </path> </svg></mat-icon> Share </div><div class=\'describe\'> Create a URL that redirects to an exact representation of your map on the screen. This link can be shared or distributed in a document and allows you to \\"save\\" your map for later use. </div><br></div><div class=\'tool_name\'> <p> <a href=\'http://igouverte.org/\' target=\'_blank\'><img src=\'./assets/igo2/core/logo.png\' alt=\'IGO\' height=32>IGO2</a> is a free web solution in geomatics, developed in collaborative mode by specialists from several departments and agencies of the government of Quebec. <p> Version :{{version.lib}}</p></div>","trainingGuide":"Training guide","trainingGuideTooltip":"Click here to access IGO2\'s self-training guide"},"mapTool":{"empty":"No layer is currently active on this map. ","customize":"Customize it by adding layer from the : ","search-tool":"Search tool","catalog-tool":"Data catalog","context-tool":"Context manager","noLayersVisible":"There is no visible layers.","noLayersInRange":"There is no visible layers at the current scale. Please zoom in or out to discover theses layers."},"importExportTool":{"importExportData":"Layer","importExportContext":"Context"},"workspace":{"toggleWorkspace":"Open/Close the table view","ogcFilter.close":"Close","ogcFilter.title":"Filters","ogcFilter.tooltip":"Apply filters","download.title":"Download","download.tooltip":"Download","inMapExtent.title":"Show records contained in map","inMapExtent.active.tooltip":"Show records contained in map","inMapExtent.inactive.tooltip":"Show all records","zoomAuto.title":"Zoom auto","zoomAuto.tooltip":"Zoom auto","selected.title":"Show selected records only","selected.tooltip":"Show selected records only","clearSelection.title":"Deselect all","clearSelection.tooltip":"Deselect all records","maximize":"Extend","maximizeTooltip":"Extend panel","standardExtent":"Reduce","standardExtentTooltip":"Reduce panel"},"advanced-map-tool":{"advanced-swipe":{"swipe-select":"select the layers for swiping","selectAll":"Select all","empty":"No layer is currently active on this map. ","customize":"Customize it by adding layer from the : ","search-tool":"Search tool","catalog-tool":"Data catalog","context-tool":"Context manager","swipe":"Swipe","swipe-tool":"Swipe-Tool"},"advanced-coordinates":{"copy":"Copy coordinates","lon":"Longitude","lat":"Latitude","est":"Est","nord":"North","coordinates":"Coordinates","copyMsg":"Coordinates copied to clipboard","copyTitle":"Coordinates of cetre","center":"Center","coordSystem":"Systeme of coordinates","zoom":"Current zoom-level: "}}}}}')},10503:function(e){"use strict";e.exports=JSON.parse('{"igo":{"auth":{"accessAnonymous":"Access as anonymous","connection":"Connection","login":"Login","password":"Password","signOut":"Sign out","user":"User","welcome":"Welcome {{name}}!","deconnection":"You are logged out.","home":"Return to the home page","error":{"Password expired":"Password expired","Maximun logins exceeded":"Maximum logins exceeded","Login lockout":"Maximum number of attempts exceeded. Your account is locked.","Wrong password":"Wrong password","Invalid username":"Invalid username"},"microsoft":{"login":"Sign in with Azure account"},"microsoftb2c":{"login":"Sign in"}},"common":{"confirmDialog":{"cancelBtn":"Cancel","confirmBtn":"Confirm","title":"Confirm"},"table":{"filter":"Filter"},"entity-table":{"targetHtmlUrl":"Open the external link"},"form":{"errors":{"required":"This field is required"}},"actionbar":{"scrollUp":"Scroll up","scrollDown":"Scroll down","icon":"Action list"},"interactiveTour":{"tooltipTourToolButton":"Interactive tour of the application","disaledTooltipTourToolButton":"To have access to this tool\'s tour, add contexts or layers","buttonTitle":"Discover","exitButton":"Exit","backButton":"Back","nextButton":"Next"},"paginator":{"firstPageLabel":"First page","itemsPerPageLabel":"Items per page:","lastPageLabel":"Last page","nextPageLabel":"Next page","previousPageLabel":"Previous page","of":"of"}},"context":{"bookmarkButton":{"create":"Create a new context","dialog":{"createMsg":"The context \'{{value}}\' was created","createTitle":"Context created","placeholder":"Title","title":"New context"}},"contextManager":{"clone":"Clone this context","delete":"Delete this context","dialog":{"cloneMsg":"The context \'{{value}}\' was cloned","cloneTitle":"Context cloned","copyMsg":"Text copied","copyTitle":"Context ID","confirmDelete":"Are you sure you want to delete this context?","deleteMsg":"The context \'{{value}}\' was deleted","deleteTitle":"Context deleted","favoriteMsg":"The context \'{{value}}\' was set as favorite","favoriteTitle":"Favorite saved","saveMsg":"The context \'{{value}}\' was saved","saveTitle":"Context saved"},"edit":"Edit this context","errors":{"uncaught":{"message":"Sorry, service is currently not available. Please try again later","title":"Error server"},"addPermission":"The permission you are trying to add is already in the context.","addPermissionEmpty":"The permission you are trying to add is not valid","addPermissionTitle":"Add permission error"},"favorite":"Set as favorite context","form":{"copy":"Copy the context ID","edit":"Save","title":"Title","titleRequired":"Title required","uri":"ID","uriRequired":"ID required"},"invalid":{"text":"Context \'{{value}}\' is invalid. The default context was loaded.","title":"Invalid context"},"managePermissions":"Manage permissions context","manageTools":"Manage tools context","ourContexts":"Our contexts","publicContexts":"Public contexts","save":"Save this context","sharedContexts":"Shared contexts","filterPlaceHolder":"Filter by name","sortAlphabetically":"Sort alphabetically","sortContextOrder":"Replace according to the creation date","userAccount":"User account","filterUser":"Filter by user group","emptyContext":"Empty context","emptyContextTooltip":"Create a new empty context","contextMap":"Context from map","contextMapTooltip":"Create a new context from map layers","hide":"Hide this context","show":"Show up this context","showHidden":"Show hidden contexts"},"contextImportExport":{"export":{"exportPlaceHolder":"Layers","exportContextName":"Context name","exportSelectAll":"Select all","success":{"text":"Context has been exported.","title":"Context export success"},"nothing":{"text":"No context could be exported.","title":"Nothing to export"},"failed":{"text":"Failed to export","title":"Failed to export context"}},"import":{"success":{"title":"Imported context","text":"The context \'{{value}}\' was added to the map"},"empty":{"text":"The context \'{{value}}\' contained nothing that could be imported.","title":"Nothing to import"},"invalid":{"text":"The context \'{{value}}\' is invalid.","title":"Invalid context"},"unreadable":{"title":"Unreadable context","text":"The context \'{{value}}\' is unreadable"},"tooLarge":{"text":"The context \'{{value}}\' is too large (Max: {{size}} MB)","title":"Context too large"}}},"permission":{"addBtn":"Add","delete":"Remove permission","dialog":{"addMsg":"The permission \'{{value}}\' was added","addTitle":"Permission added","deleteMsg":"The permission \'{{value}}\' was removed","deleteTitle":"Permission removed","scopeChangedMsg":"The scope was changed to {{value}}","scopeChangedTitle":"Scope changed"},"profil":"Profil","user":"User or group","profilRequired":"Profil required","read":"Read only","readOnlyTitle":"Read-only context","readOnlyMsg":"You can only revoke permission if the context is shared directly to your username.","scope":{"private":"Private","protected":"Protected","shared":"Shared","public":"Public"},"write":"Read and Write"},"poiButton":{"create":"Create a new zone of interest","dialog":{"confirmDelete":"Are you sure you want to delete this zone of interest?","createMsg":"The zone of interest \'{{value}}\' was created","createTitle":"Zone of interest created","deleteMsg":"The zone of interest \'{{value}}\' was deleted","deleteTitle":"Zone of interest deleted","placeholder":"Title","title":"New zone of interest"},"placeholder":"Zones of interest"},"sidenav":{"goBack":"Go Back","mainMenu":"Main Menu"},"shareMap":{"button":"Share map","refreshBtn":"Refresh sharing","copy":"Copy to clipboard","shareWithApi":"Share by context","shareWithUrl":"Share by url","dialog":{"copyMsg":"Link copied to clipboard","copyTitle":"Link"},"errorTitle":"Share Map error","placeholderLink":"Link","included":"Included in shared URL :","context":"The context when creating the sharing link.","center":"The coordinates of the center of the map (longitude, latitude).","zoom":"The zoom level of the map.","addedLayers":"The layers added by the catalog or by the search bar.","visibleInvisible":"Visibility status of layers.","excluded":"Excluded in the shared URL :","order":"The order of the layers.","opacity":"Modifications made to the opacity of the layers.","filterOgc":"Additions / modifications made to filters by attribute.","filterTime":"The current value for time filters."},"tool":{"dialog":{"addMsg":"The tool \'{{value}}\' was added","addTitle":"Tool added","deleteMsg":"The tool \'{{value}}\' was removed","deleteTitle":"Tool removed"}},"userButton":{"dialog":{"email":"Email","expiration":"Expiration","user":"User","clearPreferences":"Clear my preferences"},"infoTitle":"User info","logout":"Logout"}},"core":{"errors":{"uncaught":{"message":"Sorry, service is currently not available. Please try again later","title":"Error server"}},"network":{"online":{"message":"Online","title":"Status:"},"offline":{"message":"Offline","title":"Status:"}}},"geo":{"catalog":{"layer.addToMap":"Add to map","layer.addToMapOutRange":"Add to map. The layer is not visible at the current scale. Please zoom in/out","layer.removeFromMap":"Remove from map","layer.removeFromMapOutRange":"Remove from map. The layer is not visible at the current scale. Please zoom in/out","group.addToMap":"Add all layers from this group to map","group.removeFromMap":"Remove all layers from this group to map","baseLayers":"Baselayers","unavailableTitle":"Catalog unavailable","unavailable":"The catalog \'{{value}}\' is unavailable at the moment or you don\'t have the required permissions.","externalProvider":{"catalog":"This catalog comes from an external organization.","group":"This layers comes from an external organization.","layer":"This layer comes from an external organization.","unavailableWithEmail":"The catalog \'{{value}}\' is unavailable at the moment. To add an external service to the predefined list, please contact us at {{emailAddress}}. Delays can apply if problems occurs with the provider."},"library.add":"Add this catalog to the list","library.cancel":"Cancel","library.remove":"Remove this catalog from the list","library.inlist":{"title":"Catalog already contained","message":"The catalog is already contained in the list."},"library.addTitle":"Adding a catalog","library.addBtn":"Add a catalog"},"clickOnMap":{"clickedFeature":"Clicked Feature"},"baselayersSwitcher":{"title":"Basemaps"},"dataSource":{"unavailableTitle":"Layer unavailable","optionsApiUnavailable":"Layer information could not be retrieved. Some layers may not present the correct information.","unavailable":"The layer \'{{value}}\' is unavailable at the moment or you don\'t have the required permissions."},"dropGeoFile":{"invalid":{"text":"The file \'{{value}}\' is invalid ({{mimeType}})","title":"Invalid file"},"empty":{"text":"The file \'{{value}}\' contained nothing that could be imported.","title":"Nothing to import"},"success":{"text":"Imported file","title":"The layer \'{{value}}\' was added to the map"},"unreadable":{"text":"Unreadable file","title":"The file \'{{value}}\' is unreadable"},"tooLarge":{"text":"The file \'{{value}}\' is too large (Max: {{size}} MB)","title":"File too large"},"invalidSRS":{"text":"The projection is valid. It must start with EPSG:","title":"Invalid projection"},"ogreServer":{"title":"Ogre server error 500","text":"Error in convert to geojson. Maybe file is too big, try to import that file in geojson format"}},"export":{"customList":{"text":"Some of the selected layers ( {{value}} ) limit the format\'s list","title":"Restricted list of formats"},"nothing":{"text":"No feature could be exported.","title":"Nothing to export"},"noFormat":{"text":"No export format valid for all selected layers. Please export the layers one at a time.","title":"No valid format"},"failed":{"text":"Failed to export","title":"Failed to export features"},"popupBlocked":{"text":"</br>Enable the popup in your browser. </br>For Chrome and Edge, on the right into the Address Bar.</br>{{extraMessage}}","selectAgain":"Fix it and re-select an output format.","retry":"Please retry to export","title":"Popup blocked by your browser"},"success":{"text":"Features have been exported.","title":"Features export success"},"format":{"GeoJSON":"GeoJSON","GML":"GML","GPX":"GPX","KML":"KML","Shapefile":"Shapefile","CSVcomma":"CSV (comma delimited)","CSVsemicolon":"CSV (Excel compatible)","URL":"External link"},"gpx.error.poly":{"title":"GPX error","text":"GPX format do now allow polygon features"},"encoding":{"LATIN1":"LATIN-1","UTF8":"UTF-8"}},"importExportForm":{"exportButton":"Export","exportButtonLink":"Open the link","exportButtonLinks":"Open the links","exportCircleToPolygon":"Transform Circle entities in polygons","exportFormatPlaceholder":"Format","exportLayerPlaceholder":"Layer","exportFileNamePlaceholder":"Filename","encodingPlaceholder":"Encoding","exportTabTitle":"Export","exportFeatureInExtent":"Export only features in map extent","exportNoLayersExportable":"There is no exportable layer in your map","exportSelectedFeature":"Export only selected features","importButton":"Import","importProjPlaceholder":"Coordinate system of the file to import","importTabTitle":"Import","importClarifications":"Clarifications","importSizeMax":"The file size limit is {{size}} Mb","importFormatAuthorized":"Formats authorized: geojson, kml, gpx, gml, shapefile","importShpZip":"Shapefiles must be zipped AND geometries stored in Latitude Longitude coordinate (EPSG:4326/WGS:84)","other":"other","others":"others","projections":{"mtm":"MTM zone {{zone}} ({{code}})","utm":"UTM zone {{zone}} ({{code}})","webMercator":"Web Mercator ({{code}})","nad83":"Lat-Long NAD83 ({{code}})","wgs84":"Lat-Long WGS84 ({{code}})","choose":"You must choose a projection for your input file."}},"operators":{"caseSensitive":"Case sensitive","And":"And","Or":"Or","PropertyIsEqualTo":"=","PropertyIsNotEqualTo":"!=","PropertyIsLike":"\u2248","PropertyIsGreaterThan":">","PropertyIsGreaterThanOrEqualTo":">=","PropertyIsLessThan":"<","PropertyIsLessThanOrEqualTo":"<=","PropertyIsBetween":"between","During":"during (temporal)","PropertyIsNull":"is null","Intersects":"intersects (spatial)","Within":"within (spatial)","Contains":"contains (spatial)","tooltip":{"And":"Logical operator between filters where both conditions must be true","Or":"Logical operator between filters where at least one (1) condition must be true","PropertyIsEqualTo":"Identical (case sensitive)","PropertyIsNotEqualTo":"Different(case sensitive)","PropertyIsLike":"Like Example: *road* Finds any values that have \'road\' in any position. road* Finds any values that begin by \'road\'. wildCard =\'*\', singleChar = \'.\' escapeChar = \'!\' (case sensitive)","PropertyIsGreaterThan":"Greater than","PropertyIsGreaterThanOrEqualTo":"Greater than or equal to ","PropertyIsLessThan":"Lesser than","PropertyIsLessThanOrEqualTo":"Lesser than or equal to","PropertyIsBetween":"Apply a range check between the lower and upper boundary (values are included)","During":"Apply a range check for time attributes","PropertyIsNull":"Return features where the attribute is null","Intersects":"Return features in geometric intersection with the provided geometry","Within":"Return feature which are completely contained by the provided geometry","Contains":"Return feature completely containing by the provided geometry"}},"sourceFields":{"selectField":"Choose a field"},"filter":{"resetFilters":"(Apply no filters)","addFilter":"Add an empty filter to the current list","removeFilter":"Remove the current filter from the filters\'s list","toggleFilterState":"Enable/disable the current filter","refreshFilters":"Update this datasource with the active filter(s). To enable this button, the layer must be visible (or in the defined scale ranges) or you must modify the current filter.","layerFiltered":"This layer is currently filtered","layerFilterable":"This layer is filterable","filterBy":"Filter by","advancedOgcFilters":"Advanced filters","displayMoreResults":"Display more (+)","displayLessResults":"Display less (-)","placeholder":"Enter a value","placeholderSnrc":"Ex: 21L14","selectOperator":"Select an operator","sliderModeTitle":"Time slider","reportingDate":"Reporting date"},"spatialSelector":{"fixedExtent":"Fixed extent","btnSetExtent":"Define the extent of the spatial filter to the current view","snrc":"SNRC","selectFeature":"","drawFeature":""},"layer":{"hideLayer":"Hide Layer","lowerLayer":"Bring layer backward","hideSelectedLayers":"Hide selected layers","filterLowerLayer":"The backward movement is always done according to the order of the map!","filterPlaceholder":"Filter the layers list","activateSelectionMode":"Activate multiple selection mode","deactivateSelectionMode":"Deactivate multiple selection mode","tools":"Tools","selectAll":"Select all layers","deselectAll":"Deselect all layers","zoomLayer":"Zoom To Layer Extents","zoomLayers":"Zoom To Selected Layers Extents","opacity":"Opacity","raiseLayer":"Bring layer forward","filterRaiseLayer":"The forward movement is always done according to the order of the map!","moreOptions":"Layer\'s tools","removeLayer":"Remove this layer from the map","removeSelectedLayers":"Remove selected layers from the map","removeSelectedLayersRestriction":"Some selected layers cannot be removed","showFeaturesList":"Show features list","showLayer":"Show Layer","showSelectedLayers":"Show selected layers","subsetLayersListKeyword":"Subset the layers\'s list by title or type (wms, wfs,...)","deleteKeyword":"Delete the keyword","subsetLayersListOnlyVisible":"Subset the layers\'s list by visibility","subsetLayersListOnlyInRange":"Subset the layers\'s list by resolution range","sortAlphabetically":"Sort the layers\'s list alphabetically","sortMapOrder":"Sort the layers\'s list based on layer\'s order on the map","resetLayersList":"Remove the current applied filter to layers\'s list","trackFeature":"Track the feature","legend":{"default":"Default","loadingLegendText":"Loading legend","noLegendText":"No legend available for this layer","noLegendScale":"No legend available for this scale","selectStyle":"Select the style of the legend","showAll":"Show all legends (non visible and out of range)","noLayersVisibleWithShowAllButton":"No layer currently visible. Activate the button above to see all the legends.","noLayersVisibleWithShowAllButtonButZoom":"No layer currently visible. If you zoom in the map, some layers will appear OR activate the button above to see all the legends.","noLayersVisible":"No layers currently visible.","noLayersVisibleButZoom":"No layers currently visible. However, if you zoom in the map, some layers will appear."}},"download":{"action":"Download data","title":"Downloading file","start":"Started. Check the download progression in your browser","end":"Completed"},"mapButtons":{"baselayerSwitcher":"Change base layer","geolocate":"Geolocate","offline":"Offline mode","online":"Online mode","zoomIn":"Zoom in ({{zoom}})","zoomOut":"Zoom out ({{zoom}})","resetRotation":"Set map to north","tipRotation":"Hold Alt and SHIFT while dragging on map to rotate the map."},"metadata":{"show":"Show metadata"},"printForm":{"corsErrorMessageBody":"Unable to print due to non-owned access rights","corsErrorMessageHeader":"Print","comment":"Comment","doZipFile":"Zip file","outputFormat":"Output format","paperFormat":"Paper format","paperFormats":{"A0":"33.1 X 46.8\\" (A0)","A1":"23.4 X 33.1\\" (A1)","A2":"16.5 X 23.5\\" (A2)","A3":"11.7 X 16.5\\" (A3)","A4":"8.3 X 11.7\\" (A4)","A5":"5.8 X 8.3\\" (A5)","Letter":"Letter","Legal":"Legal"},"imageFormat":"Image format","orientation":"Orientation","landscape":"Landscape","portrait":"Portrait","projection":"Projection","resolution":"Resolution","saveBtn":"Save","scale":"Scale","showProjection":"Show projection","showScale":"Show scale","title":"Title","subtitle":"Subtitle","legendPosition":"Legend Position","legendPositions":{"none":"No legend","topleft":"Top left corner of the map","topright":"Top right corner of the map","bottomleft":"Bottom left corner of the map","bottomright":"Bottom right corner of the map","newpage":"On a new page"}},"directionsForm":{"stopLayer":"Directions - stops","routeLayer":"Directions - route","start":"Start","intermediate":"Intermediate","end":"End","directionsBtn":"Get route","resetDirectionsBtn":"Reset","zoomRoute":"Zoom on route","null":"","directions":"Directions","raiseStop":"Raise stop\'s priority","lowerStop":"Lower stop\'s priority","addStop":"Add a stop","removeStop":"Remove this stop","drivingOptions":"Options","summary":"Direction\'s summary","stopsList":"Stops\'s list","instructions":"Instructions","copy":"Copy directions","geolocate":"Use current localisation as stop","link":"Link","dialog":{"copyMsg":"Directions copied to clipboard","copyMsgLink":"Link for directions copied to clipboard","copyTitle":"Directions"}},"directions":{"uturn":"u-turn","sharp right":"sharp right","right":"right","slight right":"slightly on right","sharp left":"sharp left","left":"left","slight left":"slightly on left","straight":"forward"},"cardinalPoints":{"n":"north","ne":"northeast","e":"east","se":"southeast","s":"south","sw":"southwest","w":"west","nw":"northwest"},"search":{"placeholder":"Search for a localisation or a layer","emptyType.placeholder":"Please choose a search type","feature.title":"Localisation","feature.placeholder":"Search for a place localisation","layer.title":"Layer","layer.placeholder":"Search for a layer","ichercheReverse.name":"Search by coordinates","ilayer":{"name":"Layers","properties":{"abstract":"Abstract","groupTitle":"Group","title":"Title","type":"Type","url":"URL","metadataUrl":"Metadata","name":"Layer name","urlInfo":"URL - WMS/WFS","downloadUrl":"Data download"},"type":{"layer":"Layer","groupLayer":"Group of layers"}},"nominatim":{"type":{"food":"Food","health":"Health","entertainment":"Entertainment","finance":"Finance"},"country":{"all":"The world","canada":"Canada"}},"icherche":{"name":"iCherche","type":{"address":"Address","oldAddress":"Old address","district":"District","postalCode":"Postal Code","city":"City","oldCity":"Old city","mrc":"MRC","regadmin":"Administrative Region","road":"Road","intersection":"Intersection","place":"Place","exit":"Highway exit","cn":"CN mark","gcc":"Coast Guard mark (CCG)","sumi":"SUMI mark","km":"Mileage mark","hq":"Hydro-Quebec","entreprise":"Entreprise","cadastre":"Cadastre"},"restrictExtent":{"map":"\xc0 l\'\xe9tendue de la carte","quebec":"Au Qu\xe9bec"}},"coordinates":{"name":"Coordinates","coord":"Geographic (longitude, latitude)","coordDMS":"Geographic (longitude, latitude) (DMS)","radius":"Radius","conf":"Confidence"},"menu.tooltip":"Search Options","settings":{"title":"Settings"},"pointerSearchSummary":{"title":"Pointer position","tooltip":"Based on every search source, show the summary of the pointer location. Use F2 to activate/deactivate."},"searchResultsGeometry":{"title":"Show results geometries","tooltip":"Hide/ show the results geometries "},"searchSources":{"selectAll":"Select All","unselectAll":"Unselect All","settings":{"results type":"Results type","ecmax":"Maximum deviation","radius":"Search radius","results limit":"Number of results","multiple object":"Multiple object","restrictExtent":"Restrict the extent","selectAll":"Select All","unselectAll":"Unselect All","true":"Yes","false":"No"}},"displayMoreResults":"Display more results"},"geometry":{"geometry":"Geometry","point":"Point","line":"Line","polygon":"Polygon"},"targetHtmlUrl":"Open the external link","searchByCoord":"Search by coordinates","searchByName":"Search by name","seeRouting":"See routing","timeFilter":{"date":"Date","endDate":"End Date","startDate":"Start Date","hour":"Hour","minute":"Minute"},"spatialFilter":{"spatialFilter":"Spatial filter","predefined":"Predefined Zone","draw":"Draw","polygon":"Polygon","point":"Circle","drawPolygon":"Draw a polygon","drawCircle":"Draw a circle","searchLabel":"Search by","buffer":"Buffer","search":"Search","drawControl":"Activate draw control","listLabel":"Zone","layer":"Layer","goSearch":"Launch research","removeLayer":"Remove results","exportLayer":"Export results","clearForm":"Remove draw","clearSearch":"Reset field","Address":"Addresses","Thematics":"Thematics","searchResults":"Search Results","type":"Type","radius":"Radius","radiusAlert":"Radius must be between 0 and 100 kilometers (or 100 000 meters)","bufferAlert":"Buffer must be between 0 and 100 kilometers (or 100 000 meters)","maxSizeAlert":"Search results number exceeds 10000. Some may be missing.","zeroResults":"There are no results for this search.","warning":"Warning","freehandControl":"Freehand","group":{"toponyme":"Toponym","culturel":"Cultural","education":"Education","sante":"Health","securite":"Security","sepaq":"SEPAQ","transport":"Transportation"}},"terrapi":{"AdmRegion":"Administratives region","Mun":"Municipalities","Arrond":"Boroughs","CircFed":"Federals districts","CircProv":"Provincials districts","DirReg":"Regionals directorates","MRC":"RCM","RegTour":"Touristics regions","limites":"Administrative boundaries","bornes":"Landmarks","hydro":"Hydrography","routes":"Roads","bati":"Buildings","batiment":"Buildings","camping":"Camping","equipement":"Equipment","commun":"Public","geographie":"Natural sites","parc":"Parks","secteur":"Sector","immeubles":"Tenement","sites":"Cultural sites","cpe":"Children\'s education center","public":"Public schools","prive":"Private school","gouvernemental":"Government schools","colleges":"Colleges","universites":"University","aine":"Residences for seniors","ambulance":"Ambulance zones","clinique":"Clinics","etabl":"Health institutions","gmf":"Family doctors group","naissance":"Birth house","pharmacie":"Pharmacy","casernes":"Fire stations","correctionnel":"Correctional centres","organisme":"Security organization","palais-justice":"Courthouses","penitencier-fed":"Federal penitentiaries","penitencier-prov":"Provincial penitentiaries","polices":"Police station"},"measure":{"dialog":{"title":"Sum of the selection","length.title":"Length","area.title":"Area","lengthInMeters":"Meters","lengthInKilometers":"Kilometers","lengthInMiles":"Miles","lengthInFeet":"Feet","areaInSquareMeters":"Meters\xb2","areaInSquareKilometers":"Kilometers\xb2","areaInSquareMiles":"Miles\xb2","areaInHectares":"Hectares","areaInAcres":"Acres","perimeterInMeters":"Perimeter in meters"},"layerTitle":"Measure on map","area":"Area","areaHeader":"Area","length":"Length","lengthHeader":"Length / Perimeter","perimeter":"Perimeter","meters":"Meters","m":"m","kilometers":"Kilometers","km":"km","miles":"Miles","mi":"mi","feet":"Feet","ft":"ft","squareMeters":"Meters\xb2","m\xb2":"m\xb2","squareKilometers":"Kilometers\xb2","km\xb2":"km\xb2","squareMiles":"Miles\xb2","mi\xb2":"mi\xb2","squareFeet":"Feet\xb2","ft\xb2":"ft\xb2","hectares":"Hectares","ha":"ha","acres":"Acres","ac":"ac","toggleActive":"Activate measures","toggleDisplayLines":"Display distances for the lines","toggleDisplayDistance":"Display distances for the areas","toggleDisplayAreas":"Display areas","toggleAutoUnits":"Auto Units","actionbar":{"calculate.tooltip":"Calculate","delete.tooltip":"Delete","modify.tooltip":"Modify"}},"draw":{"abort":"Abort current drawing","cancelColorPicker":"Cancel","Circle":"Circle","colorPicker":"Click to open the color picker","dialogInstruction":"Enter your draw\'s label","dialogTitle":"Label","delete":"Remove Drawings from map","drawing":"Draws","fill":"Fill","finish":"Finish current drawing","icon":"Icons","labels":"Labels","LineString":"Line","move":"Center view on cursor","noIcon":"No icon","noLabel":"No label","Point":"Point","Polygon":"Polygon","radius":"Radius","shortcuts":"Keyboard shortcuts","stroke":"Stroke","styleSelect":"Select style","toggleMapTooltips":"Show map tooltips","undo":"Remove last vertex"},"network":{"online":{"message":"Online","title":"Status:"},"offline":{"message":"Offline","title":"Status:"}},"workspace":{"inMapExtent.active.tooltip":"Ne montrer que les entit\xe9s contenues dans la carte","inMapExtent.inactive.tooltip":"Montrer tous les entit\xe9s"}},"integration":{"tools":{"catalog":"Catalog","contexts":"Contexts","directions":"Directions","draw":"Draw","importExport":"Import & Export","ogcFilter":"Filter by","map":"Map","layers":"Layers","legend":"Legend","measurer":"Measure","print":"Print","searchResults":"Search Results","shareMap":"Share","timeFilter":"Time Filter","about":"About","spatialFilter":"Spatial Filter","advancedMap":"Advanced map tools"},"searchResultsTool":{"noResults":"No results","doSearch":"Do a search in the search bar.","examples":"<b>Allow to search addresses, location, coordinates and layers</b>.<br><br><u>Adresses</u> research can be done with a combination of : <ul><li>building number</li><li>street name</li><li>city name</li><li>postal code</li></ul> Examples for <u>locations</u>: <ul><li>Lac Poulin</li><li>Mcdo L\xe9vis</li><li>Saint-Isidore</li></ul> You can also use keywords to refine your search. Examples: <ul><li>#mun qu\xe9bec (to search municipalities)</li><li>#sante L\xe9vis (to search health establishments)</li><li>#cpe joyeux (to search nurseries)</li><li>#intersection li\xe9gois + \xe9glise (to search an intersection, the #+ can also be used)</li></ul>*Keywords appear when hovering results type in search settings tab -> iCherche -> Results type.<br><br><u>Coordinates</u> examples :<ul><li>Decimal degree (-68.165547, 48.644546)</li><li>Degrees, minutes, seconds (-68 9 56, 48 38 40)</li><li>Degree, minutes, decimal (-68 9.56, 48 38.40)</li><li>Projected (UTM-19 561466.861, 5388278.862)</li><li>BELL (Lat: 48 38 40N Long: 68 9 56W UNC:100 CONF:90)</li><li>Meter Meter (111594.63, 445854.74;32198)</li></ul>For more informations on coordinate\'s research : <a href=\'https://igo2.readthedocs.io/fr/next/properties.html#coordonnees\' target=\'_blank\'>Consult IGO2\'s documentation</a>","zoomOnFeatureTooltip":"Zoom on selected feature.","zoomOnFeatureTooltipOutOfView":"The feature is out of view. Zoom on selected feature."},"aboutTool":{"headerHtml":"","html":"<style>#about .bold_class{font-weight: bold;}#about .red{color: red;}#about .tool_name{border-top: 1px solid; padding-top: 10px;}#about .titre_outil{font-weight: bold; font-size: 18px; padding-bottom: 8px;}#about .subtitle{font-size: 20px; padding-bottom: 10px;}#about .align_right{text-align: right;}#about .describe{text-align: justify;}#about a img{color: black; text-decoration: none;}</style><body> <div id=\'about\'> <div class=\'bold_class subtitle\'>Features overview</div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z\'> </path> </svg></mat-icon> Search Results </div><div class=\'describe\'>Located in the upper left portion of the interface, the search bar allows you to locate yourself using an address, location or GPS coordinates. The tool can also be used to search for a layer. </div></div><br><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z\'></path> </svg></mat-icon> Contexts </div><div class=\'describe\'> Visualize groupings of layers made by theme or by work context. When you select a <span class=\'bold_class\'>Context</span>, you will find in <span class=\'bold_class\'>Map</span> each of the layers it contains. You can add other layers to it from the <span class=\'bold_class\'>Catalog</span> or the <span class=\'bold_class\'>Search</span> tool. <br><div class=\'red\'> <span class=\'bold_class\'>WARNING :</span> If you select another <span class=\'bold_class\'>Context</span>, all the layers displayed in the <span class=\'bold_class\'>Map</span> will be replaced. </div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M15,19L9,16.89V5L15,7.11M20.5,3C20.44,3 20.39,3 20.34,3L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21C3.55,21 3.61,21 3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3Z\'> </path> </svg></mat-icon> Map </div><div class=\'describe\'>Personalize your map using the <span class=\'bold_class\'>Catalog</span> or the <span class=\'bold_class\'>Search</span> tool. This space allows you to add, delete and interrogate layers.</div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M1.39,18.36L3.16,16.6L4.58,18L5.64,16.95L4.22,15.54L5.64,14.12L8.11,16.6L9.17,15.54L6.7,13.06L8.11,11.65L9.53,13.06L10.59,12L9.17,10.59L10.59,9.17L13.06,11.65L14.12,10.59L11.65,8.11L13.06,6.7L14.47,8.11L15.54,7.05L14.12,5.64L15.54,4.22L18,6.7L19.07,5.64L16.6,3.16L18.36,1.39L22.61,5.64L5.64,22.61L1.39,18.36Z\'> </path> </svg></mat-icon> Measure </div><div class=\'describe\'>Measure distances or areas on the map.</div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M14,14.5V12H10V15H8V11A1,1 0 0,1 9,10H14V7.5L17.5,11M21.71,11.29L12.71,2.29H12.7C12.31,1.9 11.68,1.9 11.29,2.29L2.29,11.29C1.9,11.68 1.9,12.32 2.29,12.71L11.29,21.71C11.68,22.09 12.31,22.1 12.71,21.71L21.71,12.71C22.1,12.32 22.1,11.68 21.71,11.29Z\'> </path> </svg></mat-icon> Directions </div><div class=\'describe\'> Build a route between two points (by placing the two points on the map or by looking for addresses). You can then add intermediate points, copy the description of the route to the clipboard or share the link.</div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M17,14H19V17H22V19H19V22H17V19H14V17H17V14M11,16L2,9L11,2L20,9L11,16M11,18.54L12,17.75V18C12,18.71 12.12,19.39 12.35,20L11,21.07L2,14.07L3.62,12.81L11,18.54Z\'></path> </svg></mat-icon> Catalog </div><div class=\'describe\'> Find all the layers that can be added to the <span class=\'bold_class\'>Map</span>. Click on the desired layer to add it. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M14,17H18V14L23,18.5L18,23V20H14V17M13,9H18.5L13,3.5V9M6,2H14L20,8V12.34C19.37,12.12 18.7,12 18,12A6,6 0 0,0 12,18C12,19.54 12.58,20.94 13.53,22H6C4.89,22 4,21.1 4,20V4A2,2 0 0,1 6,2Z\'></path> </svg></mat-icon> Import & export </div><div class=\'describe\'> Import or export a layer with a specific projection. You can also save or reload a context. It allows you to save contexts as anonymous. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z\'></path> </svg></mat-icon> Print </div><div class=\'describe\'>Print the map displayed on the screen. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M18,16.08C17.24,16.08 16.56,16.38 16.04,16.85L8.91,12.7C8.96,12.47 9,12.24 9,12C9,11.76 8.96,11.53 8.91,11.3L15.96,7.19C16.5,7.69 17.21,8 18,8A3,3 0 0,0 21,5A3,3 0 0,0 18,2A3,3 0 0,0 15,5C15,5.24 15.04,5.47 15.09,5.7L8.04,9.81C7.5,9.31 6.79,9 6,9A3,3 0 0,0 3,12A3,3 0 0,0 6,15C6.79,15 7.5,14.69 8.04,14.19L15.16,18.34C15.11,18.55 15.08,18.77 15.08,19C15.08,20.61 16.39,21.91 18,21.91C19.61,21.91 20.92,20.61 20.92,19A2.92,2.92 0 0,0 18,16.08Z\'> </path> </svg></mat-icon> Share </div><div class=\'describe\'> Create a URL that redirects to an exact representation of your map on the screen. This link can be shared or distributed in a document and allows you to \\"save\\" your map for later use. </div><br></div><div class=\'tool_name\'> <p> <a href=\'http://igouverte.org/\' target=\'_blank\'><img src=\'./assets/igo2/core/logo.png\' alt=\'IGO\' height=32>IGO2</a> is a free web solution in geomatics, developed in collaborative mode by specialists from several departments and agencies of the government of Quebec. <p> Version :{{version.lib}}</p></div>","trainingGuide":"Training guide","trainingGuideTooltip":"Click here to access IGO2\'s self-training guide"},"mapTool":{"empty":"No layer is currently active on this map. ","customize":"Customize it by adding layer from the : ","search-tool":"Search tool","catalog-tool":"Data catalog","context-tool":"Context manager","noLayersVisible":"There is no visible layers.","noLayersInRange":"There is no visible layers at the current scale. Please zoom in or out to discover theses layers."},"importExportTool":{"importExportData":"Layer","importExportContext":"Context"},"workspace":{"toggleWorkspace":"Open/Close the table view","ogcFilter.close":"Close","ogcFilter.title":"Filters","ogcFilter.tooltip":"Apply filters","download.title":"Download","download.tooltip":"Download","inMapExtent.title":"Show records contained in map","inMapExtent.active.tooltip":"Show records contained in map","inMapExtent.inactive.tooltip":"Show all records","zoomAuto.title":"Zoom auto","zoomAuto.tooltip":"Zoom auto","selected.title":"Show selected records only","selected.tooltip":"Show selected records only","clearSelection.title":"Deselect all","clearSelection.tooltip":"Deselect all records","maximize":"Extend","maximizeTooltip":"Extend panel","standardExtent":"Reduce","standardExtentTooltip":"Reduce panel"},"advanced-map-tool":{"advanced-swipe":{"swipe-select":"select the layers for swiping","selectAll":"Select all","empty":"No layer is currently active on this map. ","customize":"Customize it by adding layer from the : ","search-tool":"Search tool","catalog-tool":"Data catalog","context-tool":"Context manager","swipe":"Swipe","swipe-tool":"Swipe-Tool"},"advanced-coordinates":{"copy":"Copy coordinates","lon":"Longitude","lat":"Latitude","est":"Est","nord":"North","coordinates":"Coordinates","copyMsg":"Coordinates copied to clipboard","copyTitle":"Coordinates of cetre","center":"Center","coordSystem":"Systeme of coordinates","zoom":"Current zoom-level: "}}}}}')},8555:function(e){"use strict";e.exports=JSON.parse('{"igo":{"auth":{"accessAnonymous":"Rester anonyme","connection":"Connexion","login":"Connecter","password":"Mot de passe","signOut":"Se d\xe9connecter","user":"Utilisateur","welcome":"Bienvenue {{name}}!","deconnection":"Vous \xeates d\xe9connect\xe9","home":"Retourner \xe0 la page d\'accueil","error":{"Password expired":"Votre mot de passe est expir\xe9","Maximun logins exceeded":"Nombre maximal de connexions d\xe9pass\xe9","Login lockout":"Nombre maximal d\'essai d\xe9pass\xe9. Votre compte est verrouill\xe9.","Wrong password":"Mot de passe incorrect","Invalid username":"Utilisateur invalide"},"google":{"login":"Se connecter avec Google","logged":"Connect\xe9 avec Google"},"microsoft":{"login":"Se connecter avec compte Azure"},"microsoftb2c":{"login":"Se connecter"}}}}')},20551:function(e){"use strict";e.exports=JSON.parse('{"igo":{"common":{"confirmDialog":{"cancelBtn":"Annuler","confirmBtn":"Confirmer","title":"Confirmation"},"table":{"filter":"Filtre"},"entity-table":{"targetHtmlUrl":"Ouvrir le lien externe"},"form":{"errors":{"required":"Ce champ est requis"}},"actionbar":{"scrollUp":"D\xe9filer vers le haut","scrollDown":"D\xe9filer vers le bas","icon":"Actions suppl\xe9mentaires"},"interactiveTour":{"tooltipTourToolButton":"Aide interactive sur l\'outil","disaledTooltipTourToolButton":"Pour avoir acc\xe8s au tour interactif de cet outil, ajouter des contextes ou des couches","buttonTitle":"D\xe9couvrir","exitButton":"Quitter","backButton":"Pr\xe9c\xe9dent","nextButton":"Suivant"},"paginator":{"firstPageLabel":"Premi\xe8re page","itemsPerPageLabel":"Entit\xe9s par page:","lastPageLabel":"Derni\xe8re page","nextPageLabel":"Page suivante","previousPageLabel":"Page pr\xe9c\xe9dente","of":"de"}}}}')},68079:function(e){"use strict";e.exports=JSON.parse('{"igo":{"context":{"bookmarkButton":{"create":"Cr\xe9er un contexte","dialog":{"createMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 cr\xe9\xe9","createTitle":"Contexte cr\xe9\xe9","placeholder":"Titre","title":"Nouveau contexte"}},"contextManager":{"clone":"Cloner ce contexte","delete":"Supprimer ce contexte","dialog":{"cloneMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 clon\xe9","cloneTitle":"Contexte clon\xe9","copyMsg":"Texte copi\xe9","copyTitle":"Identifiant du contexte","confirmDelete":"\xcates-vous s\xfbr de vouloir supprimer ce contexte ?","deleteMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 supprim\xe9","deleteTitle":"Contexte supprim\xe9","favoriteMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 d\xe9fini comme favori","favoriteTitle":"Favori enregistr\xe9","saveMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 enregistr\xe9","saveTitle":"Contexte enregistr\xe9"},"edit":"\xc9diter ce contexte","errors":{"uncaught":{"message":"D\xe9sol\xe9! Le service que vous voulez utiliser n\u2019est malheureusement pas disponible pour le moment. Essayez plus tard!","title":"Erreur de serveur"},"addPermission":"La permission que vous tentez d\'ajouter est d\xe9j\xe0 pr\xe9sente dans le contexte.","addPermissionEmpty":"La permission que vous tentez d\'ajouter n\'est pas valide","addPermissionTitle":"Erreur d\'ajout de permission"},"favorite":"D\xe9finir comme contexte favori","form":{"copy":"Copier l\'identifiant du contexte","edit":"Enregistrer","title":"Titre","titleRequired":"Le titre est obligatoire","uri":"Identifiant","uriRequired":"L\'identifiant est obligatoire"},"invalid":{"text":"Le contexte \\"{{value}}\\" est invalide. Le contexte par d\xe9faut a \xe9t\xe9 charg\xe9.","title":"Contexte invalide"},"managePermissions":"G\xe9rer les permissions du contexte","manageTools":"G\xe9rer les outils du contexte","ourContexts":"Mes contextes","publicContexts":"Contextes publics","save":"Sauvegarder ce contexte","sharedContexts":"Contextes partag\xe9s","filterPlaceHolder":"Filtrer par nom","sortAlphabetically":"Trier en ordre alphab\xe9tique","sortContextOrder":"Replacer selon la date de cr\xe9ation","userAccount":"Profils utilisateurs","filterUser":"Filtrer par groupe d\'utilisateur","emptyContext":"Contexte vide","emptyContextTooltip":"Cr\xe9er un nouveau contexte vide","contextMap":"Contexte \xe0 partir de la carte","contextMapTooltip":"Cr\xe9er un nouveau contexte \xe0 partir des couches la carte","hide":"Masquer ce contexte","show":"Montrer ce contexte","showHidden":"Montrer les contextes masqu\xe9s"},"contextImportExport":{"export":{"exportPlaceHolder":"Couches","exportContextName":"Nom du contexte","exportSelectAll":"Tout s\xe9lectionner","success":{"text":"Contexte export\xe9 avec succ\xe8s.","title":"Exportation r\xe9ussie"},"nothing":{"text":"Impossible d\u2019exporter, contexte non valide ou aucun contexte s\xe9lectionn\xe9.","title":"Donn\xe9e non valide ou non pr\xe9sente"},"failed":{"text":"Impossible d\u2019exporter, probl\xe8me de contexte rencontr\xe9.","title":"Probl\xe8me d\u2019exportation"}},"import":{"success":{"title":"Contexte import\xe9","text":"Le contexte \'{{value}}\' a \xe9t\xe9 ajout\xe9 \xe0 la carte"},"empty":{"text":"Le contexte \'{{value}}\' est vide, impossible d\'importer","title":"Contexte vide"},"invalid":{"text":"Le contexte \'{{value}}\' est invalide.","title":"Context invalide"},"unreadable":{"text":"Le contexte \'{{value}}\' est impossible \xe0 lire","title":"Context illisible"},"tooLarge":{"text":"Le contexte \'{{value}}\' est trop volumineux (Maximum: {{size}} Mo)","title":"Context trop volumineux"}}},"permission":{"addBtn":"Ajouter","delete":"Retirer la permission","dialog":{"addMsg":"La permission \'{{value}}\' a \xe9t\xe9 ajout\xe9e","addTitle":"Permission ajout\xe9e","deleteMsg":"La permission \'{{value}}\' a \xe9t\xe9 supprim\xe9e","deleteTitle":"Permission retir\xe9e","scopeChangedMsg":"La port\xe9e du contexte a \xe9t\xe9 chang\xe9e pour {{value}}","scopeChangedTitle":"Changement de la port\xe9e"},"profil":"Profil","user":"Utilisateur ou groupe","profilRequired":"Le profil est obligatoire","read":"Lecture seule","readOnlyTitle":"Contexte en lecture seule","readOnlyMsg":"Vous pouvez seulement retirer la permission si le contexte est directement partag\xe9 \xe0 votre nom d\'utilisateur.","scope":{"private":"Priv\xe9","protected":"Prot\xe9g\xe9","shared":"Partag\xe9","public":"Public"},"write":"Lecture et \xe9criture"},"poiButton":{"create":"Cr\xe9er une zone d\'int\xe9r\xeat","dialog":{"confirmDelete":"\xcates-vous s\xfbr de vouloir supprimer cette zone d\'int\xe9r\xeat ?","createMsg":"La zone d\'int\xe9r\xeat \'{{value}}\' a \xe9t\xe9 cr\xe9\xe9e","createTitle":"Zone d\'int\xe9r\xeat cr\xe9\xe9e","deleteMsg":"La zone d\'int\xe9r\xeat \'{{value}}\' a \xe9t\xe9 supprim\xe9e","deleteTitle":"Zone d\'int\xe9r\xeat supprim\xe9e","placeholder":"Titre","title":"Nouvelle zone d\'int\xe9r\xeat"},"placeholder":"Zones d\'int\xe9r\xeat"},"sidenav":{"goBack":"Revenir","mainMenu":"Revenir au menu principal"},"shareMap":{"button":"Partager la carte","refreshBtn":"Actualiser le partage","copy":"Copier le lien","shareWithApi":"Partage par contexte","shareWithUrl":"Partage par url","dialog":{"copyMsg":"Lien copi\xe9","copyTitle":"Lien"},"errorTitle":"Erreur lors du partage","placeholderLink":"Lien","included":"Inclus dans le lien de partage :","context":"Le contexte ouvert lors de la cr\xe9ation du lien de partage.","center":"Les coordonn\xe9es du centre de la carte (longitude, latitude).","zoom":"Le niveau de zoom de la carte.","addedLayers":"Les couches ajout\xe9es via le catalogue ou via la barre de recherche.","visibleInvisible":"Le statut de visibilit\xe9 des couches.","excluded":"Exclus dans le lien de partage :","order":"L\'ordre des couches.","opacity":"Les modifications effectu\xe9es \xe0 l\'opacit\xe9 des couches.","filterOgc":"Les ajouts/modifications faits aux filtres par attribut.","filterTime":"La valeur en cours pour les filtres temporels."},"tool":{"dialog":{"addMsg":"L\'outil a \xe9t\xe9 ajout\xe9","addTitle":"Outil ajout\xe9","deleteMsg":"L\'outil a \xe9t\xe9 supprim\xe9","deleteTitle":"Outil retir\xe9"}},"userButton":{"dialog":{"email":"Courriel","expiration":"Expiration","user":"Utilisateur","clearPreferences":"Supprimer mes pr\xe9f\xe9rences"},"infoTitle":"Info sur l\'utilisateur","logout":"Se d\xe9connecter"}}}}')},5415:function(e){"use strict";e.exports=JSON.parse('{"igo":{"core":{"errors":{"uncaught":{"message":"D\xe9sol\xe9! Le service que vous voulez utiliser n\u2019est malheureusement pas disponible pour le moment. Essayez plus tard!","title":"Erreur serveur"}},"network":{"online":{"message":"En ligne","title":"Statut:"},"offline":{"message":"Hors-Ligne","title":"Statut:"}}}}}')},27268:function(e){"use strict";e.exports=JSON.parse('{"igo":{"geo":{"catalog":{"layer.addToMap":"Ajouter \xe0 la carte","layer.addToMapOutRange":"Ajouter \xe0 la carte. La donn\xe9e est non visible \xe0 l\'\xe9chelle active. Veuillez zoomer +/- si vous voulez l\'apercevoir \xe0 la carte.","layer.removeFromMap":"Retirer de la carte","layer.removeFromMapOutRange":"Retirer de la carte. La donn\xe9e est non visible \xe0 l\'\xe9chelle active. Veuillez zoomer +/- si vous voulez l\'apercevoir \xe0 la carte.","group.addToMap":"Ajouter toutes les couches de ce groupe \xe0 la carte","group.removeFromMap":"Retirer toutes les couches de ce groupe de la carte","baseLayers":"Fonds de carte","unavailableTitle":"Catalogue indisponible","unavailable":"Le catalogue \'{{value}}\' est indisponible pour le moment ou vous n\'avez pas les permissions requises.","externalProvider":{"catalog":"Ce catalogue provient d\'une organisation externe.","group":"Ces couches proviennent d\'une organisation externe.","layer":"Cette couche provient d\'une organisation externe.","unavailableWithEmail":"Le catalogue \'{{value}}\' est indisponible pour le moment. Pour ajouter un service externe \xe0 la liste pr\xe9d\xe9finie, veuillez contacter {{email}}. Des d\xe9lais peuvent s\'appliquer si probl\xe8me il y a avec le fournisseur externe."},"library.add":"Ajouter ce catalogue","library.cancel":"Annuler","library.remove":"Retirer ce catalogue de la liste","library.inlist":{"title":"Catalogue d\xe9j\xe0 contenu","message":"Le catalogue \xe0 ajouter est d\xe9j\xe0 dans la liste"},"library.addTitle":"Ajout d\'un catalogue","library.addBtn":"Ajouter un catalogue"},"clickOnMap":{"clickedFeature":"Entit\xe9s cliqu\xe9es"},"baselayersSwitcher":{"title":"Fonds de carte"},"dataSource":{"unavailableTitle":"Couche indisponible","optionsApiUnavailable":"L\'information sur les couches n\'a pas pu \xeatre r\xe9cup\xe9r\xe9e. Certaines couches pourraient ne pas pr\xe9senter la bonne information.","unavailable":"La couche \'{{value}}\' est indisponible pour le moment ou vous n\'avez pas les permissions requises."},"dropGeoFile":{"invalid":{"text":"Le fichier \'{{value}}\' est invalide. ({{mimeType}})","title":"Fichier invalide"},"empty":{"text":"Le fichier \'{{value}}\' est vide, impossible d\'importer","title":"Fichier vide"},"success":{"text":"La couche \'{{value}}\' a \xe9t\xe9 ajout\xe9e \xe0 la carte","title":"Fichier import\xe9"},"unreadable":{"text":"Le fichier \'{{value}}\' est impossible \xe0 lire","title":"Fichier illisible"},"tooLarge":{"text":"Le fichier \'{{value}}\' est trop volumineux (Maximum: {{size}} Mo)","title":"Fichier trop volumineux"},"invalidSRS":{"text":"La projection est valide. Elle doit commencer par EPSG:","title":"Projection invalid"},"ogreServer":{"title":"Erreur 500 du service Ogre","text":"Erreur de la conversion du fichier en geojson. Il est possible que le fichier soit trop volumineux, essayer de l\'importer en format geojson"}},"export":{"customList":{"text":"Certaines couches s\xe9lectionn\xe9es ( {{value}} ) r\xe9duisent la liste des formats possible","title":"Liste restreinte de formats"},"nothing":{"text":"Impossible d\u2019exporter, donn\xe9e non valide ou aucune donn\xe9e s\xe9lectionn\xe9e.","title":"Donn\xe9e non valide ou non pr\xe9sente"},"noFormat":{"text":"Aucun format d\'exportation valide pour toutes les couches s\xe9lectionn\xe9es. Veuillez exporter les couches une \xe0 la fois.","title":"Aucun format disponible"},"failed":{"text":"Impossible d\u2019exporter, probl\xe8me de donn\xe9e rencontr\xe9.","title":"Probl\xe8me d\u2019exportation"},"popupBlocked":{"text":"</br>Veuillez autoriser l\'ouverture des fen\xeatres (popup) dans votre fureteur. </br>Pour Chrome and Edge, \xe0 droite dans la barre d\'adresse).</br>{{extraMessage}}","selectAgain":"Faites le correctif et s\xe9lectionner \xe0 nouveau un format.","retry":"Veuillez recommencer l\'exportation.","title":"Ouverture de fen\xeatre bloqu\xe9e par votre fureteur"},"success":{"text":"Donn\xe9es export\xe9es avec succ\xe8s.","title":"Exportation r\xe9ussie"},"format":{"GeoJSON":"GeoJSON","GML":"GML","GPX":"GPX","KML":"KML","Shapefile":"Shapefile","CSVcomma":"CSV (s\xe9parateur virgule)","CSVsemicolon":"CSV (compatible Excel)","URL":"Lien externe"},"gpx.error.poly":{"title":"GPX en erreur","text":"Le format GPX ne permet pas de stocker les polygones"},"encoding":{"LATIN1":"LATIN-1","UTF8":"UTF-8"}},"importExportForm":{"exportButton":"Exporter","exportButtonLink":"Ouvrir le lien","exportButtonLinks":"Ouvrir les liens","exportCircleToPolygon":"Transformer les entit\xe9s de type Cercle en polygones","exportFormatPlaceholder":"Format","exportLayerPlaceholder":"Couche(s)","exportFileNamePlaceholder":"Nom du fichier","encodingPlaceholder":"Encodage","exportTabTitle":"Exporter","exportFeatureInExtent":"Seulement les entit\xe9s contenues dans la carte","exportNoLayersExportable":"Aucune couche exportable dans la carte courante","exportSelectedFeature":"Seulement les entit\xe9s s\xe9lectionn\xe9es","importButton":"Importer","importProjPlaceholder":"Syst\xe8me de coordonn\xe9es du fichier \xe0 importer","importTabTitle":"Importer","importClarifications":"Pr\xe9cisions","importSizeMax":"La taille limite du fichier est de {{size}} Mo","importFormatAuthorized":"Formats autoris\xe9s: geojson, kml, gpx, gml, shapefile","importShpZip":"Les shapefiles doivent \xeatre compress\xe9s (zipp\xe9s) ET leurs g\xe9om\xe9tries doivent \xeatre en coordonn\xe9es Latitude Longitude (EPSG:4326/WGS84)","other":"autre","others":"autres","projections":{"mtm":"MTM {{zone}} ({{code}})","utm":"UTM {{zone}} ({{code}})","webMercator":"Web Mercator ({{code}})","nad83":"Lat-Long NAD83 ({{code}})","wgs84":"Lat-Long WGS84 ({{code}})","choose":"Vous devez choisir une projection avant d\'importer le fichier."}},"operators":{"caseSensitive":"Sensible \xe0 la case","And":"Et","Or":"Ou","PropertyIsEqualTo":"=","PropertyIsNotEqualTo":"!=","PropertyIsLike":"\u2248","PropertyIsGreaterThan":">","PropertyIsGreaterThanOrEqualTo":">=","PropertyIsLessThan":"<","PropertyIsLessThanOrEqualTo":"<=","PropertyIsBetween":"entre","During":"durant (temporel)","PropertyIsNull":"est nul","Intersects":"intersecte (g\xe9om\xe9trique)","Within":"contenu dans (g\xe9om\xe9trique)","Contains":"contient (g\xe9om\xe9trique)","tooltip":{"And":"Op\xe9rateur logique entre les filtres o\xf9 les deux conditions doivent \xeatre remplies","Or":"Op\xe9rateur logique entre les filtres o\xf9 au moins une (1) condition doit \xeatre vraie","PropertyIsEqualTo":"Identique (sensible \xe0 la case)","PropertyIsNotEqualTo":"Diff\xe9rent (sensible \xe0 la case)","PropertyIsLike":"Comme. Exemple: *route* trouve toutes les valeurs contenent \'route\', peu importe sa position dans l\'attribut. route* trouve toutes les valeurs commencant par \'route\'. Options avanc\xe9es : wildCard =\'*\', singleChar = \'.\' escapeChar = \'!\' (sensible \xe0 la case)","PropertyIsGreaterThan":"Plus grand","PropertyIsGreaterThanOrEqualTo":"Plus grand ou \xe9gal","PropertyIsLessThan":"Plus petit","PropertyIsLessThanOrEqualTo":"Plus petit ou \xe9gal","PropertyIsBetween":"Doit \xeatre contenu entre les limites inf\xe9rieure et sup\xe9rieure (les valeurs sont incluses)","During":"Doit \xeatre contenu entre les p\xe9riodes de temps sp\xe9cifi\xe9es","PropertyIsNull":"Dont l\'attribut est nul","Intersects":"Retourne les entit\xe9s \xe9tant en intersection g\xe9om\xe9trique avec la g\xe9om\xe9trie fournie","Within":"Retourne les entit\xe9s \xe9tant enti\xe8rement contenue par la g\xe9om\xe9trie fournie (Within)","Contains":"Retourne les entit\xe9s compl\xe8tement contenues par la g\xe9om\xe9trie fournie (Contains)"}},"sourceFields":{"selectField":"Choisir un champ"},"filter":{"resetFilters":"(Appliquer aucun filtre)","addFilter":"Ajouter un filtre vide \xe0 la liste courante","removeFilter":"Supprimer le pr\xe9sent filtre \xe0 la liste des filtres","toggleFilterState":"Activer/d\xe9sactiver le pr\xe9sent filtre","refreshFilters":"Mettre \xe0 jour la source de donn\xe9e avec les filtres actifs de la liste. Pour activer ce boutton, la couche doit etre visible (et dans les \xe9chelles permises) ou veillez modifier le pr\xe9sent filtre.","layerFiltered":"Cette couche d\'information est pr\xe9sentement filtr\xe9e.","layerFilterable":"Cette couche d\'information est filtrable","filterBy":"Filtrer par","advancedOgcFilters":"Filtres avanc\xe9s","displayMoreResults":"Afficher plus (+)","displayLessResults":"Afficher moins (-)","placeholder":"Saisir une valeur","placeholderSnrc":"Ex: 21L14","selectOperator":"Choisir un op\xe9rateur","sliderModeTitle":"Curseur temporel","reportingDate":"Date de signalement"},"spatialSelector":{"fixedExtent":"\xc9tendue fixe","btnSetExtent":"D\xe9finir l\'\xe9tendue du filtre selon l\'\xe9tendue courante de la carte","snrc":"SNRC","selectFeature":"","drawFeature":""},"layer":{"hideLayer":"Masquer la couche","hideSelectedLayers":"Masquer les couches s\xe9lectionn\xe9es","lowerLayer":"Mettre en arri\xe8re","filterLowerLayer":"Le d\xe9placement arri\xe8re se fait toujours selon l\'ordre de la carte!","filterPlaceholder":"Filtrer la liste de couches","activateSelectionMode":"Activer le mode de s\xe9lection multiple","deactivateSelectionMode":"D\xe9sactiver le mode de s\xe9lection multiple","tools":"Outils","selectAll":"S\xe9lectionner toutes les couches","deselectAll":"D\xe9s\xe9lectionner toutes les couches","zoomLayer":"Cadrer sur l\'\xe9tendue de la couche","zoomLayers":"Cadrer sur l\'\xe9tendue des couches s\xe9lectionn\xe9es","opacity":"Opacit\xe9","raiseLayer":"Mettre en avant","filterRaiseLayer":"Le d\xe9placement avant se fait toujours selon l\'ordre de la carte!","moreOptions":"Outils de la couche","removeLayer":"Retirer la couche de la carte","removeSelectedLayers":"Retirer les couches s\xe9lectionn\xe9es de la carte","removeSelectedLayersRestriction":"Certaines couches s\xe9lectionn\xe9es ne peuvent \xeatre supprim\xe9es","showFeaturesList":"Afficher la liste des entit\xe9s","showLayer":"Afficher la couche","showSelectedLayers":"Afficher les couches s\xe9lectionn\xe9es","subsetLayersListKeyword":"Limiter l\'affichage de la liste selon le titre ou  par type (wms, wfs,...)","deleteKeyword":"Supprimer le mot-cl\xe9","subsetLayersListOnlyVisible":"Conserver seulement les couches visibles","subsetLayersListOnlyInRange":"Conserver seulement les couches de la plage d\'\xe9chelle active","sortAlphabetically":"Trier la liste des couches en ordre alphab\xe9tique","sortMapOrder":"Replacer les couches selon l\'ordre cartographique","resetLayersList":"R\xe9tablir l\'affichage de l\'ensemble des couches","trackFeature":"Suivre l\'entit\xe9","legend":{"default":"D\xe9faut","loadingLegendText":"Chargement de la l\xe9gende","noLegendText":"Aucune symbologie disponible pour cette couche","noLegendScale":"Aucune symbologie disponible pour cette \xe9chelle","selectStyle":"S\xe9lectionner le style de la l\xe9gende","showAll":"Montrer toutes les couches (non visible et hors \xe9chelle)","noLayersVisibleWithShowAllButton":"Aucune couche actuellement visible. Activez le bouton ci haut pour voir toutes les l\xe9gendes.","noLayersVisibleWithShowAllButtonButZoom":"Aucune couche actuellement visible. Si vous zoomez dans la carte, certaines couches appara\xeetront OU activez le bouton ci haut pour voir toutes les l\xe9gendes.","noLayersVisible":"Aucune couche actuellement visible.","noLayersVisibleButZoom":"Aucune couche actuellement visible. Par contre, si vous zoomez dans la carte, certaines couches appara\xeetront."}},"download":{"action":"T\xe9l\xe9charger les donn\xe9es associ\xe9es","title":"T\xe9l\xe9chargement des donn\xe9es","start":"V\xe9rifiez la progression du t\xe9l\xe9chargement dans votre navigateur","end":"Termin\xe9"},"mapButtons":{"baselayerSwitcher":"Changer le fond de carte","geolocate":"Afficher votre position","offline":"Passer en mode hors-ligne","online":"Passer en mode en ligne","zoomIn":"Zoomer ({{zoom}})","zoomOut":"D\xe9zoomer ({{zoom}})","resetRotation":"R\xe9initialiser la carte vers le nord","tipRotation":"Maintenez les touches Alt et Majuscule (shift) tout en cliquant sur la carte pour faire pivoter la carte"},"metadata":{"show":"Montrer les m\xe9tadonn\xe9es"},"printForm":{"corsErrorMessageBody":"Impossible d\'imprimer d\xfb \xe0 des droits d\'acc\xe8s non d\xe9tenus","corsErrorMessageHeader":"Impression","comment":"Commentaire","doZipFile":"Compresser le fichier","outputFormat":"Format de sortie","paperFormat":"Format du papier","paperFormats":{"A0":"33.1 X 46.8\\" (A0)","A1":"23.4 X 33.1\\" (A1)","A2":"16.5 X 23.5\\" (A2)","A3":"11.7 X 16.5\\" (A3)","A4":"8.3 X 11.7\\" (A4)","A5":"5.8 X 8.3\\" (A5)","Letter":"Lettre","Legal":"L\xe9gal"},"imageFormat":"Format de l\'image","orientation":"Orientation","landscape":"Paysage","portrait":"Portrait","projection":"Projection","resolution":"R\xe9solution","saveBtn":"Sauvegarder","scale":"\xc9chelle","showProjection":"Afficher la projection","showScale":"Afficher l\'\xe9chelle","title":"Titre","subtitle":"Sous-titre","legendPosition":"Position de la l\xe9gende","legendPositions":{"none":"Aucune l\xe9gende","topleft":"Coin haut gauche de la carte","topright":"Coin haut droit de la carte","bottomleft":"Coin bas gauche de la carte","bottomright":"Coin bas droit de la carte","newpage":"Sur une nouvelle page"}},"directionsForm":{"stopLayer":"Itin\xe9raire - arr\xeats","routeLayer":"Itin\xe9raire - Trac\xe9","start":"D\xe9but","intermediate":"Interm\xe9diaire","end":"Fin","directionsBtn":"Obtenir l\'itin\xe9raire","resetDirectionsBtn":"Supprimer l\'itin\xe9raire","zoomRoute":"Zoomer sur l\'itin\xe9raire","null":"","directions":"Itin\xe9raire","raiseStop":"Prioriser l\'arr\xeat","lowerStop":"Reporter l\'arr\xeat plus loin dans le parcours","addStop":"Ajouter un arr\xeat","removeStop":"Supprimer l\'arr\xeat","drivingOptions":"Choix d\'itin\xe9raires","summary":"R\xe9sum\xe9 de l\'itin\xe9raire","stopsList":"Liste des lieux d\'arr\xeats","instructions":"Indications","copy":"Copier l\'itin\xe9raire","geolocate":"Utiliser sa localisation comme point d\'arr\xeat","link":"Lien","dialog":{"copyMsg":"Itin\xe9raire copi\xe9 dans le presse-papier","copyMsgLink":"Le lien de l\'itin\xe9raire est copi\xe9 dans le presse-papier","copyTitle":"Itin\xe9raire"}},"directions":{"uturn":"demi-tour","sharp right":"fortement \xe0 droite","right":"droite","slight right":"l\xe9g\xe8rement \xe0 droite","sharp left":"fortement \xe0 gauche","left":"gauche","slight left":"l\xe9g\xe8rement \xe0 gauche","straight":"tout droit"},"cardinalPoints":{"n":"nord","ne":"nord-est","e":"est","se":"sud-est","s":"sud","sw":"sud-ouest","w":"ouest","nw":"nord-ouest"},"search":{"placeholder":"Rechercher une localisation ou une couche de donn\xe9es","emptyType.placeholder":"Veuillez choisir un type de recherche","feature.title":"Localisation","feature.placeholder":"Rechercher une localisation","layer.title":"Couche de donn\xe9es","layer.placeholder":"Rechercher une couche de donn\xe9es.","ichercheReverse.name":"Recherche par coordonn\xe9es","ilayer":{"name":"Couches","properties":{"abstract":"Description","groupTitle":"Groupe","title":"Titre","type":"Type","url":"URL","metadataUrl":"M\xe9tadonn\xe9es","name":"Nom de la couche","urlInfo":"Lien du service web WMS/WFS","downloadUrl":"Lien de t\xe9l\xe9chargement de la donn\xe9es"},"type":{"layer":"Couche","groupLayer":"Groupe de couches"}},"nominatim":{"type":{"food":"Restauration","health":"Sant\xe9","entertainment":"Divertissement","finance":"Finance"},"country":{"all":"Le monde","canada":"Canada"}},"icherche":{"name":"iCherche","type":{"address":"Adresse","oldAddress":"Ancienne adresse","district":"Arrondissement","postalCode":"Code Postal","city":"Municipalit\xe9","oldCity":"Ancienne municipalit\xe9","mrc":"MRC","regadmin":"R\xe9gion administrative","road":"Route","intersection":"Intersection","place":"Lieu","exit":"Sortie d\'autoroute","cn":"Borne du CN","gcc":"Rep\xe8re de la garde coti\xe8re (GCC)","sumi":"Borne SUMI","km":"Rep\xe8re kilom\xe9trique","hq":"Hydro-Qu\xe9bec","entreprise":"Entreprise","cadastre":"Cadastre"},"restrictExtent":{"map":"\xc0 l\'\xe9tendue de la carte","quebec":"Au Qu\xe9bec"}},"coordinates":{"name":"Coordonn\xe9es","coord":"Coordonn\xe9e (longitude, latitude)","coordDMS":"Coordonn\xe9e (longitude, latitude) (DMS)","radius":"Rayon","conf":"Confiance"},"menu.tooltip":"Options de recherche","settings":{"title":"Param\xe8tres"},"pointerSearchSummary":{"title":"Position du curseur","tooltip":"Afficher les coordonn\xe9es du curseur ainsi que d\'autres informations sur sa position en fonction des types de r\xe9sultats activ\xe9es. Utiliser F2 pour activer / d\xe9sactiver."},"searchResultsGeometry":{"title":"Montrer tous les r\xe9sultats","tooltip":"Afficher/cacher la g\xe9om\xe9trie des r\xe9sultats"},"searchSources":{"selectAll":"Tout s\xe9lectionner","unselectAll":"Tout d\xe9s\xe9lectionner","settings":{"results type":"Type de r\xe9sultat","ecmax":"\xc9cart maximal","radius":"Rayon de recherche","results limit":"Nombre de r\xe9sultats","multiple object":"Objet multiple","restrictExtent":"Restreint l\'\xe9tendue","selectAll":"Tout s\xe9lectionner","unselectAll":"Tout d\xe9s\xe9lectionner","true":"Oui","false":"Non"}},"displayMoreResults":"Afficher plus de r\xe9sultats"},"geometry":{"geometry":"Geometrie","point":"Point","line":"Ligne","polygon":"Surface"},"targetHtmlUrl":"Ouvrir le lien externe","searchByCoord":"Rechercher par coordonn\xe9es","searchByName":"Rechercher par nom","seeRouting":"Voir l\'itin\xe9raire","timeFilter":{"date":"Date","endDate":"Date de fin","startDate":"Date de d\xe9but","hour":"Heure","minute":"Minute"},"spatialFilter":{"spatialFilter":"Filtre spatial","predefined":"Zone Pr\xe9d\xe9finie","draw":"Dessin","polygon":"Polygone","point":"Cercle","drawPolygon":"Dessiner un polygone","drawCircle":"Dessiner un cercle","searchLabel":"Rechercher par","buffer":"Zone tampon","search":"Recherche","drawControl":"Activer le contr\xf4le de dessin","listLabel":"Zone","entity":"Entit\xe9","layer":"Couche","goSearch":"Lancer la recherche","removeLayer":"Retirer les r\xe9sultats","exportLayer":"Exporter les r\xe9sultats","clearForm":"Retirer le dessin","clearSearch":"R\xe9initialiser les champs","Address":"Adresses","Thematics":"Th\xe9matiques","searchResults":"R\xe9sultats de la recherche","type":"Type","radius":"Rayon","radiusAlert":"Le rayon doit \xeatre compris entre 0 et 100 kilom\xe8tres (ou 100 000 m\xe8tres)","bufferAlert":"La zone tampon doit \xeatre comprise entre 0 et 100 kilom\xe8tres (ou 100 000 m\xe8tres)","maxSizeAlert":"Le nombre de r\xe9sultats exc\xe8de 10000. Certains pourraient \xeatre manquants.","zeroResults":"Aucun r\xe9sultat ne correspond \xe0 cette recherche.","warning":"Avertissement","freehandControl":"\xc0 main lev\xe9e","group":{"toponyme":"Toponyme","culturel":"Culturel","education":"\xc9ducation","sante":"Sant\xe9","securite":"S\xe9curit\xe9","sepaq":"S\xc9PAQ","transport":"Transport"}},"terrapi":{"AdmRegion":"R\xe9gions administratives","Mun":"Municipalit\xe9s","Arrond":"Arrondissements","CircFed":"Circonscriptions f\xe9d\xe9rales","CircProv":"Circonscriptions provinciales","DirReg":"Directions r\xe9gionales","MRC":"MRC","RegTour":"R\xe9gions touristiques","limites":"Limites administratives","bornes":"Bornes sumi","hydro":"Hydrographie","routes":"Routes","bati":"B\xe2timents","batiment":"B\xe2timents","camping":"Camping","equipement":"\xc9quipements","commun":"Commun","geographie":"Lieux naturels","parc":"Parcs","secteur":"Secteurs","immeubles":"Immeubles patrimoniaux","sites":"Sites patrimoniaux","cpe":"Centre de la petite enfance","public":"\xc9coles publiques","prive":"\xc9coles priv\xe9s","gouvernemental":"\xc9coles gouvernementales","colleges":"Coll\xe8ges","universites":"Universit\xe9s","aine":"R\xe9sidences pour a\xeen\xe9s","ambulance":"Zones d\'ambulance","clinique":"Cliniques","etabl":"\xc9tablissements de sant\xe9","gmf":"Groupes de m\xe9decins de famille","naissance":"Maisons de naissances","pharmacie":"Pharmacies","casernes":"Casernes de pompiers","correctionnel":"Centres correctionnels","organisme":"Organismes de s\xe9curit\xe9","palais-justice":"Palais de justice","penitencier-fed":"P\xe9nitenciers f\xe9d\xe9raux","penitencier-prov":"P\xe9nitenciers provinciaux","polices":"Poste de police"},"measure":{"dialog":{"title":"Sommes de la s\xe9lection","length.title":"Distance","area.title":"Superficie","lengthInMeters":"M\xe8tres","lengthInKilometers":"Kilom\xe8tres","lengthInMiles":"Miles","lengthInFeet":"Pieds","areaInSquareMeters":"M\xe8tres\xb2","areaInSquareKilometers":"Kilom\xe8tres\xb2","areaInSquareMiles":"Miles\xb2","areaInHectares":"Hectares","areaInAcres":"Acres","perimeterInMeters":"P\xe9rim\xe8tre en m\xe8tres"},"layerTitle":"Mesure \xe0 la carte","area":"Superficie","areaHeader":"Superficie","length":"Distance","lengthHeader":"Distance / P\xe9rim\xe8tre","perimeter":"P\xe9rim\xe8tre","meters":"M\xe8tres","m":"m","kilometers":"Kilom\xe8tres","km":"km","miles":"Miles","mi":"mi","feet":"Pieds","ft":"pi","squareMeters":"M\xe8tres\xb2","m\xb2":"m\xb2","squareKilometers":"Kilom\xe8tres\xb2","km\xb2":"km\xb2","squareMiles":"Miles\xb2","mi\xb2":"mi\xb2","squareFeet":"Pieds\xb2","ft\xb2":"pi\xb2","hectares":"Hectares","ha":"ha","acres":"Acres","ac":"ac","toggleActive":"Activer le contr\xf4le de mesure","toggleDisplayLines":"Afficher les distances sur les lignes","toggleDisplayDistance":"Afficher les distances pour les superficies","toggleDisplayAreas":"Afficher les superficies","toggleAutoUnits":"Unit\xe9s automatiques","actionbar":{"calculate.tooltip":"Calculer","delete.tooltip":"Supprimer","modify.tooltip":"Modifier"}},"draw":{"abort":"Annuler le dessin en cours","cancelColorPicker":"Annuler","Circle":"Cercle","colorPicker":"Cliquer pour ouvrir le s\xe9lecteur de couleurs","dialogInstruction":"Veuillez entrer l\'\xe9tiquette de votre dessin","dialogTitle":"\xc9tiquette","delete":"Retirer les dessins de la carte","drawing":"Dessins","fill":"Remplissage","finish":"Terminer le dessin en cours","icon":"Ic\xf4nes","labels":"\xc9tiquettes","LineString":"Ligne","move":"Centrer la vue sur le curseur","noIcon":"Aucune ic\xf4ne","noLabel":"Aucune \xe9tiquette","Point":"Point","Polygon":"Polygone","radius":"Rayon","shortcuts":"Raccourcis clavier","stroke":"Contour","styleSelect":"S\xe9lectionner le style","toggleMapTooltips":"Afficher les \xe9tiquettes","undo":"Retirer le dernier sommet"},"network":{"online":{"message":"En ligne","title":"Statut:"},"offline":{"message":"Hors-Ligne","title":"Statut:"}},"workspace":{"inMapExtent.active.tooltip":"Ne montrer que les enregistrements contenus dans la carte","inMapExtent.inactive.tooltip":"Montrer tous les enregistrements"}}}}')},63031:function(e){"use strict";e.exports=JSON.parse('{"igo":{"integration":{"tools":{"catalog":"Catalogue","contexts":"Contextes","directions":"Itin\xe9raire","draw":"Dessin","importExport":"Importer et exporter","ogcFilter":"Filtrer par","map":"Carte","layers":"Couches","legend":"L\xe9gende","measurer":"Mesurer","print":"Imprimer","searchResults":"R\xe9sultats de recherche","shareMap":"Partager","timeFilter":"Filtre temporel","about":"\xc0 propos","spatialFilter":"Filtre spatial","advancedMap":"Outils avanc\xe9s"},"searchResultsTool":{"noResults":"Aucun r\xe9sultat","doSearch":"Veuillez effectuer une recherche dans la barre de recherche ci-dessus.","examples":"<b>Permet de rechercher des adresses, des lieux, des coordonn\xe9es ou des couches</b>.<br><br>Les recherches d\'<u>adresses</u> peuvent \xeatre effectu\xe9es selon une combinaison: <ul><li>du no. immeuble</li><li>du nom de la rue</li><li>de la ville</li><li>du code postal</li></ul> Exemples pour les <u>lieux</u>: <ul><li>Lac Poulin</li><li>Mcdo L\xe9vis</li><li>Saint-Isidore</li></ul> Vous pouvez aussi utiliser des mots cl\xe9s pour pr\xe9ciser votre recherche. Exemples: <ul><li>#mun qu\xe9bec (pour rechercher une municipalit\xe9)</li><li>#sante L\xe9vis (pour rechercher un \xe9tablissement de sant\xe9)</li><li>#cpe joyeux (pour rechercher un centre de la petite enfance)</li><li>#intersection li\xe9gois + \xe9glise (pour rechercher une intersection, le #+ peut aussi \xeatre utilis\xe9)</li></ul>*Les mots cl\xe9s apparaissent au survol d\'un type dans l\'onglet des param\xe8tres de recherche -> iCherche -> Type de r\xe9sultat.<br><br>Exemple pour les <u>coordonn\xe9es</u> :<ul><li>Degr\xe9 d\xe9cimal (-68.165547, 48.644546)</li><li>Degr\xe9 minute seconde (-68 9 56, 48 38 40)</li><li>Degr\xe9 minute d\xe9cimal (-68 9.56, 48 38.40)</li><li>Projet\xe9 (UTM-19 561466.861, 5388278.862)</li><li>BELL (Lat: 48 38 40N Long: 68 9 56W UNC:100 CONF:90)</li><li>Metre Metre (111594.63, 445854.74;32198)</li></ul>Pour plus d\'informations sur la recherche par coordonn\xe9es : <a href=\'https://igo2.readthedocs.io/fr/next/properties.html#coordonnees\' target=\'_blank\'>Consulter la documentation d\'IGO2</a>","zoomOnFeatureTooltip":"Zoomer sur l\'entit\xe9 s\xe9lectionn\xe9e.","zoomOnFeatureTooltipOutOfView":"L\'entit\xe9 est hors de la vue. Zoomer sur l\'entit\xe9 s\xe9lectionn\xe9e."},"aboutTool":{"headerHtml":"","html":"<style>#about .bold_class{font-weight: bold;}#about .red{color: red;}#about .tool_name{border-top: 1px solid; padding-top: 10px;}#about .titre_outil{font-weight: bold; font-size: 18px; padding-bottom: 8px;}#about .subtitle{font-size: 20px; padding-bottom: 10px;}#about .align_right{text-align: right;}#about .describe{text-align: justify;}#about a img{color: black; text-decoration: none;}</style><body> <div id=\'about\'> <div class=\'bold_class subtitle\'>Aper\xe7u des fonctionnalit\xe9s</div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z\'> </path> </svg></mat-icon> Recherche </div><div class=\'describe\'> Situ\xe9e dans la portion sup\xe9rieure gauche de l\u2019interface, la barre de recherche permet de vous positionner \xe0 l\u2019aide d\u2019une adresse, d\u2019un lieu ou de coordonn\xe9es GPS et peut \xe9galement servir \xe0 chercher une couche. Il est aussi possible de rechercher un \xe9l\xe9ment par type de r\xe9sultats en utilisant le hashtag \xab # \xbb (par exemple, #municipalites qu\xe9bec). Les accents et les lettres majuscules n\'importent pas lors de l\'utilisation du hashtag.</div></div><br><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z\'></path> </svg></mat-icon> Contextes </div><div class=\'describe\'> Visualisez des regroupements de couches faits par th\xe8me ou par contexte de travail. Lorsque vous s\xe9lectionnez un <span class=\'bold_class\'>Contexte</span>, vous trouverez dans <span class=\'bold_class\'>Carte</span> chacune des couches qu\u2019il contient. Vous pouvez y ajouter d\u2019autres couches \xe0 partir du <span class=\'bold_class\'>Catalogue</span> ou de l\u2019outil <span class=\'bold_class\'>Recherche.</span> </div><br><div class=\'red\'> <span class=\'bold_class\'>ATTENTION :</span> Si vous s\xe9lectionnez un autre <span class=\'bold_class\'>Contexte</span>, toutes les couches affich\xe9es dans <span class=\'bold_class\'>Carte</span> seront remplac\xe9es. </div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M15,19L9,16.89V5L15,7.11M20.5,3C20.44,3 20.39,3 20.34,3L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21C3.55,21 3.61,21 3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3Z\'> </path> </svg></mat-icon> Carte </div><div class=\'describe\'> Personnalisez votre carte \xe0 partir du <span class=\'bold_class\'>Catalogue</span> ou de l\u2019outil <span class=\'bold_class\'>Recherche.</span> Cet espace permet d\u2019ajouter, de supprimer et d\u2019interroger des couches. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M1.39,18.36L3.16,16.6L4.58,18L5.64,16.95L4.22,15.54L5.64,14.12L8.11,16.6L9.17,15.54L6.7,13.06L8.11,11.65L9.53,13.06L10.59,12L9.17,10.59L10.59,9.17L13.06,11.65L14.12,10.59L11.65,8.11L13.06,6.7L14.47,8.11L15.54,7.05L14.12,5.64L15.54,4.22L18,6.7L19.07,5.64L16.6,3.16L18.36,1.39L22.61,5.64L5.64,22.61L1.39,18.36Z\'> </path> </svg></mat-icon> Outil de mesure </div><div class=\'describe\'> Mesurez des distances ou des superficies sur la carte. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M14,14.5V12H10V15H8V11A1,1 0 0,1 9,10H14V7.5L17.5,11M21.71,11.29L12.71,2.29H12.7C12.31,1.9 11.68,1.9 11.29,2.29L2.29,11.29C1.9,11.68 1.9,12.32 2.29,12.71L11.29,21.71C11.68,22.09 12.31,22.1 12.71,21.71L21.71,12.71C22.1,12.32 22.1,11.68 21.71,11.29Z\'> </path> </svg></mat-icon> Itin\xe9raire </div><div class=\'describe\'> Construisez un itin\xe9raire entre deux points (en placant les deux points dans la carte ou en cherchant des adresses). Vous pourrez ensuite ajouter des points interm\xe9diaires, copier la description de l\'itin\xe9raire dans le presse papier ou partager le lien. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M17,14H19V17H22V19H19V22H17V19H14V17H17V14M11,16L2,9L11,2L20,9L11,16M11,18.54L12,17.75V18C12,18.71 12.12,19.39 12.35,20L11,21.07L2,14.07L3.62,12.81L11,18.54Z\'></path> </svg></mat-icon> Catalogue </div><div class=\'describe\'> Trouvez toutes les couches qui peuvent \xeatre ajout\xe9es \xe0 la <span class=\'bold_class\'>Carte.</span> Cliquez sur la couche d\xe9sir\xe9e pour l\u2019ajouter. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M14,17H18V14L23,18.5L18,23V20H14V17M13,9H18.5L13,3.5V9M6,2H14L20,8V12.34C19.37,12.12 18.7,12 18,12A6,6 0 0,0 12,18C12,19.54 12.58,20.94 13.53,22H6C4.89,22 4,21.1 4,20V4A2,2 0 0,1 6,2Z\'></path> </svg></mat-icon> Importer/Exporter </div><div class=\'describe\'> Importez ou exportez un fichier vectoriel en sp\xe9cifiant la projection. Vous pouvez aussi sauvegarder ou recharger un contexte localement. Cela vous permet de sauvegarder des contextes en mode non-authentifi\xe9 ou anonyme. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z\'></path> </svg></mat-icon> Imprimer </div><div class=\'describe\'> Imprimez la carte affich\xe9e \xe0 l\u2019\xe9cran. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M18,16.08C17.24,16.08 16.56,16.38 16.04,16.85L8.91,12.7C8.96,12.47 9,12.24 9,12C9,11.76 8.96,11.53 8.91,11.3L15.96,7.19C16.5,7.69 17.21,8 18,8A3,3 0 0,0 21,5A3,3 0 0,0 18,2A3,3 0 0,0 15,5C15,5.24 15.04,5.47 15.09,5.7L8.04,9.81C7.5,9.31 6.79,9 6,9A3,3 0 0,0 3,12A3,3 0 0,0 6,15C6.79,15 7.5,14.69 8.04,14.19L15.16,18.34C15.11,18.55 15.08,18.77 15.08,19C15.08,20.61 16.39,21.91 18,21.91C19.61,21.91 20.92,20.61 20.92,19A2.92,2.92 0 0,0 18,16.08Z\'> </path> </svg></mat-icon> Partager </div><div class=\'describe\'> Cr\xe9ez une adresse URL qui redirige vers une repr\xe9sentation exacte de votre carte qui se trouve \xe0 l\u2019\xe9cran. Ce lien peut \xeatre partag\xe9 ou diffus\xe9 dans un document et permet de \xab&nbspsauvegarder \xbb votre carte pour une utilisation ult\xe9rieure. </div><br></div><div class=\'tool_name\'> <p> <a href=\'http://igouverte.org/\' target=\'_blank\'><img src=\'./assets/igo2/core/logo.png\' alt=\'IGO\' height=32>IGO2</a> est une solution Web libre en g\xe9omatique, d\xe9velopp\xe9e en mode collaboratif par des sp\xe9cialistes provenant de plusieurs minist\xe8res et organismes du gouvernement du Qu\xe9bec.</p><p>Version :{{version.lib}}</p></div>","trainingGuide":"Guide de formation","trainingGuideTooltip":"Cliquez ici pour acc\xe9der au guide d\'autoformation de IGO2"},"mapTool":{"empty":"La carte ne contient aucune couche de donn\xe9es.","customize":"Personnalisez-l\xe0 en ajoutant des couches \xe0 partir des outils suivants : ","search-tool":"Recherche","catalog-tool":"Catalogue de donn\xe9es","context-tool":"Gestionnaire de contextes","noLayersVisible":"Aucune couche visible.","noLayersInRange":"Aucune couche visible dans la plage d\'\xe9chelle active. Veuillez zoomer ou d\xe9zoomer pour d\xe9couvrir ces couches."},"importExportTool":{"importExportData":"Couche","importExportContext":"Contexte"},"workspace":{"toggleWorkspace":"Ouvrir/fermer la vue tabulaire","ogcFilter.close":"Fermer","ogcFilter.title":"Filtres","ogcFilter.tooltip":"Appliquer des filtres sur la couche","download.title":"T\xe9l\xe9charger les donn\xe9es associ\xe9es","download.tooltip":"T\xe9l\xe9charger les donn\xe9es associ\xe9es","inMapExtent.title":"Montrer les entit\xe9s contenues dans la carte","inMapExtent.active.tooltip":"Montrer les entit\xe9s contenues dans la carte","inMapExtent.inactive.tooltip":"Montrer toutes les entit\xe9s","zoomAuto.title":"Zoom auto","zoomAuto.tooltip":"Zoom auto","selected.title":"Montrer les entit\xe9s s\xe9lectionn\xe9es","selected.tooltip":"Montrer les entit\xe9s s\xe9lectionn\xe9es","clearSelection.title":"Tout d\xe9s\xe9lectionner","clearSelection.tooltip":"D\xe9s\xe9lectionner les enregistrements s\xe9lectionn\xe9s","maximize":"Agrandir","maximizeTooltip":"Agrandir la fen\xeatre","standardExtent":"R\xe9duire","standardExtentTooltip":"R\xe9duire la fen\xeatre"},"advanced-map-tool":{"advanced-swipe":{"swipe-select":"Choisir les couches \xe0 comparer","selectAll":"Tout s\xe9lectionner","empty":"La carte ne contient aucune couche de donn\xe9es.","customize":"Personnalisez-l\xe0 en ajoutant des couches \xe0 partir des outils suivants : ","search-tool":"Recherche","catalog-tool":"Catalogue de donn\xe9es","context-tool":"Gestionnaire de contextes","swipe":"Activer","swipe-tool":"Outil de comparaison"},"advanced-coordinates":{"copy":"Copier","lon":"Longitude","lat":"Latitude","nord":"Nord","est":"Est","coordinates":"Coordonn\xe9es du centre de la carte","copyMsg":"Coordonn\xe9es copi\xe9s","copyTitle":"Coordonn\xe9es du centre","center":"Centre","coordSystem":"Syst\xe8me de coordonn\xe9es","zoom":"Niveau de zoom courant: "}}}}}')},65962:function(e){"use strict";e.exports=JSON.parse('{"igo":{"auth":{"accessAnonymous":"Rester anonyme","connection":"Connexion","login":"Connecter","password":"Mot de passe","signOut":"Se d\xe9connecter","user":"Utilisateur","welcome":"Bienvenue {{name}}!","deconnection":"Vous \xeates d\xe9connect\xe9","home":"Retourner \xe0 la page d\'accueil","error":{"Password expired":"Votre mot de passe est expir\xe9","Maximun logins exceeded":"Nombre maximal de connexions d\xe9pass\xe9","Login lockout":"Nombre maximal d\'essai d\xe9pass\xe9. Votre compte est verrouill\xe9.","Wrong password":"Mot de passe incorrect","Invalid username":"Utilisateur invalide"},"google":{"login":"Se connecter avec Google","logged":"Connect\xe9 avec Google"},"microsoft":{"login":"Se connecter avec compte Azure"},"microsoftb2c":{"login":"Se connecter"}},"common":{"confirmDialog":{"cancelBtn":"Annuler","confirmBtn":"Confirmer","title":"Confirmation"},"table":{"filter":"Filtre"},"entity-table":{"targetHtmlUrl":"Ouvrir le lien externe"},"form":{"errors":{"required":"Ce champ est requis"}},"actionbar":{"scrollUp":"D\xe9filer vers le haut","scrollDown":"D\xe9filer vers le bas","icon":"Actions suppl\xe9mentaires"},"interactiveTour":{"tooltipTourToolButton":"Aide interactive sur l\'outil","disaledTooltipTourToolButton":"Pour avoir acc\xe8s au tour interactif de cet outil, ajouter des contextes ou des couches","buttonTitle":"D\xe9couvrir","exitButton":"Quitter","backButton":"Pr\xe9c\xe9dent","nextButton":"Suivant"},"paginator":{"firstPageLabel":"Premi\xe8re page","itemsPerPageLabel":"Entit\xe9s par page:","lastPageLabel":"Derni\xe8re page","nextPageLabel":"Page suivante","previousPageLabel":"Page pr\xe9c\xe9dente","of":"de"}},"context":{"bookmarkButton":{"create":"Cr\xe9er un contexte","dialog":{"createMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 cr\xe9\xe9","createTitle":"Contexte cr\xe9\xe9","placeholder":"Titre","title":"Nouveau contexte"}},"contextManager":{"clone":"Cloner ce contexte","delete":"Supprimer ce contexte","dialog":{"cloneMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 clon\xe9","cloneTitle":"Contexte clon\xe9","copyMsg":"Texte copi\xe9","copyTitle":"Identifiant du contexte","confirmDelete":"\xcates-vous s\xfbr de vouloir supprimer ce contexte ?","deleteMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 supprim\xe9","deleteTitle":"Contexte supprim\xe9","favoriteMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 d\xe9fini comme favori","favoriteTitle":"Favori enregistr\xe9","saveMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 enregistr\xe9","saveTitle":"Contexte enregistr\xe9"},"edit":"\xc9diter ce contexte","errors":{"uncaught":{"message":"D\xe9sol\xe9! Le service que vous voulez utiliser n\u2019est malheureusement pas disponible pour le moment. Essayez plus tard!","title":"Erreur de serveur"},"addPermission":"La permission que vous tentez d\'ajouter est d\xe9j\xe0 pr\xe9sente dans le contexte.","addPermissionEmpty":"La permission que vous tentez d\'ajouter n\'est pas valide","addPermissionTitle":"Erreur d\'ajout de permission"},"favorite":"D\xe9finir comme contexte favori","form":{"copy":"Copier l\'identifiant du contexte","edit":"Enregistrer","title":"Titre","titleRequired":"Le titre est obligatoire","uri":"Identifiant","uriRequired":"L\'identifiant est obligatoire"},"invalid":{"text":"Le contexte \\"{{value}}\\" est invalide. Le contexte par d\xe9faut a \xe9t\xe9 charg\xe9.","title":"Contexte invalide"},"managePermissions":"G\xe9rer les permissions du contexte","manageTools":"G\xe9rer les outils du contexte","ourContexts":"Mes contextes","publicContexts":"Contextes publics","save":"Sauvegarder ce contexte","sharedContexts":"Contextes partag\xe9s","filterPlaceHolder":"Filtrer par nom","sortAlphabetically":"Trier en ordre alphab\xe9tique","sortContextOrder":"Replacer selon la date de cr\xe9ation","userAccount":"Profils utilisateurs","filterUser":"Filtrer par groupe d\'utilisateur","emptyContext":"Contexte vide","emptyContextTooltip":"Cr\xe9er un nouveau contexte vide","contextMap":"Contexte \xe0 partir de la carte","contextMapTooltip":"Cr\xe9er un nouveau contexte \xe0 partir des couches la carte","hide":"Masquer ce contexte","show":"Montrer ce contexte","showHidden":"Montrer les contextes masqu\xe9s"},"contextImportExport":{"export":{"exportPlaceHolder":"Couches","exportContextName":"Nom du contexte","exportSelectAll":"Tout s\xe9lectionner","success":{"text":"Contexte export\xe9 avec succ\xe8s.","title":"Exportation r\xe9ussie"},"nothing":{"text":"Impossible d\u2019exporter, contexte non valide ou aucun contexte s\xe9lectionn\xe9.","title":"Donn\xe9e non valide ou non pr\xe9sente"},"failed":{"text":"Impossible d\u2019exporter, probl\xe8me de contexte rencontr\xe9.","title":"Probl\xe8me d\u2019exportation"}},"import":{"success":{"title":"Contexte import\xe9","text":"Le contexte \'{{value}}\' a \xe9t\xe9 ajout\xe9 \xe0 la carte"},"empty":{"text":"Le contexte \'{{value}}\' est vide, impossible d\'importer","title":"Contexte vide"},"invalid":{"text":"Le contexte \'{{value}}\' est invalide.","title":"Context invalide"},"unreadable":{"text":"Le contexte \'{{value}}\' est impossible \xe0 lire","title":"Context illisible"},"tooLarge":{"text":"Le contexte \'{{value}}\' est trop volumineux (Maximum: {{size}} Mo)","title":"Context trop volumineux"}}},"permission":{"addBtn":"Ajouter","delete":"Retirer la permission","dialog":{"addMsg":"La permission \'{{value}}\' a \xe9t\xe9 ajout\xe9e","addTitle":"Permission ajout\xe9e","deleteMsg":"La permission \'{{value}}\' a \xe9t\xe9 supprim\xe9e","deleteTitle":"Permission retir\xe9e","scopeChangedMsg":"La port\xe9e du contexte a \xe9t\xe9 chang\xe9e pour {{value}}","scopeChangedTitle":"Changement de la port\xe9e"},"profil":"Profil","user":"Utilisateur ou groupe","profilRequired":"Le profil est obligatoire","read":"Lecture seule","readOnlyTitle":"Contexte en lecture seule","readOnlyMsg":"Vous pouvez seulement retirer la permission si le contexte est directement partag\xe9 \xe0 votre nom d\'utilisateur.","scope":{"private":"Priv\xe9","protected":"Prot\xe9g\xe9","shared":"Partag\xe9","public":"Public"},"write":"Lecture et \xe9criture"},"poiButton":{"create":"Cr\xe9er une zone d\'int\xe9r\xeat","dialog":{"confirmDelete":"\xcates-vous s\xfbr de vouloir supprimer cette zone d\'int\xe9r\xeat ?","createMsg":"La zone d\'int\xe9r\xeat \'{{value}}\' a \xe9t\xe9 cr\xe9\xe9e","createTitle":"Zone d\'int\xe9r\xeat cr\xe9\xe9e","deleteMsg":"La zone d\'int\xe9r\xeat \'{{value}}\' a \xe9t\xe9 supprim\xe9e","deleteTitle":"Zone d\'int\xe9r\xeat supprim\xe9e","placeholder":"Titre","title":"Nouvelle zone d\'int\xe9r\xeat"},"placeholder":"Zones d\'int\xe9r\xeat"},"sidenav":{"goBack":"Revenir","mainMenu":"Revenir au menu principal"},"shareMap":{"button":"Partager la carte","refreshBtn":"Actualiser le partage","copy":"Copier le lien","shareWithApi":"Partage par contexte","shareWithUrl":"Partage par url","dialog":{"copyMsg":"Lien copi\xe9","copyTitle":"Lien"},"errorTitle":"Erreur lors du partage","placeholderLink":"Lien","included":"Inclus dans le lien de partage :","context":"Le contexte ouvert lors de la cr\xe9ation du lien de partage.","center":"Les coordonn\xe9es du centre de la carte (longitude, latitude).","zoom":"Le niveau de zoom de la carte.","addedLayers":"Les couches ajout\xe9es via le catalogue ou via la barre de recherche.","visibleInvisible":"Le statut de visibilit\xe9 des couches.","excluded":"Exclus dans le lien de partage :","order":"L\'ordre des couches.","opacity":"Les modifications effectu\xe9es \xe0 l\'opacit\xe9 des couches.","filterOgc":"Les ajouts/modifications faits aux filtres par attribut.","filterTime":"La valeur en cours pour les filtres temporels."},"tool":{"dialog":{"addMsg":"L\'outil a \xe9t\xe9 ajout\xe9","addTitle":"Outil ajout\xe9","deleteMsg":"L\'outil a \xe9t\xe9 supprim\xe9","deleteTitle":"Outil retir\xe9"}},"userButton":{"dialog":{"email":"Courriel","expiration":"Expiration","user":"Utilisateur","clearPreferences":"Supprimer mes pr\xe9f\xe9rences"},"infoTitle":"Info sur l\'utilisateur","logout":"Se d\xe9connecter"}},"core":{"errors":{"uncaught":{"message":"D\xe9sol\xe9! Le service que vous voulez utiliser n\u2019est malheureusement pas disponible pour le moment. Essayez plus tard!","title":"Erreur serveur"}},"network":{"online":{"message":"En ligne","title":"Statut:"},"offline":{"message":"Hors-Ligne","title":"Statut:"}}},"geo":{"catalog":{"layer.addToMap":"Ajouter \xe0 la carte","layer.addToMapOutRange":"Ajouter \xe0 la carte. La donn\xe9e est non visible \xe0 l\'\xe9chelle active. Veuillez zoomer +/- si vous voulez l\'apercevoir \xe0 la carte.","layer.removeFromMap":"Retirer de la carte","layer.removeFromMapOutRange":"Retirer de la carte. La donn\xe9e est non visible \xe0 l\'\xe9chelle active. Veuillez zoomer +/- si vous voulez l\'apercevoir \xe0 la carte.","group.addToMap":"Ajouter toutes les couches de ce groupe \xe0 la carte","group.removeFromMap":"Retirer toutes les couches de ce groupe de la carte","baseLayers":"Fonds de carte","unavailableTitle":"Catalogue indisponible","unavailable":"Le catalogue \'{{value}}\' est indisponible pour le moment ou vous n\'avez pas les permissions requises.","externalProvider":{"catalog":"Ce catalogue provient d\'une organisation externe.","group":"Ces couches proviennent d\'une organisation externe.","layer":"Cette couche provient d\'une organisation externe.","unavailableWithEmail":"Le catalogue \'{{value}}\' est indisponible pour le moment. Pour ajouter un service externe \xe0 la liste pr\xe9d\xe9finie, veuillez contacter {{email}}. Des d\xe9lais peuvent s\'appliquer si probl\xe8me il y a avec le fournisseur externe."},"library.add":"Ajouter ce catalogue","library.cancel":"Annuler","library.remove":"Retirer ce catalogue de la liste","library.inlist":{"title":"Catalogue d\xe9j\xe0 contenu","message":"Le catalogue \xe0 ajouter est d\xe9j\xe0 dans la liste"},"library.addTitle":"Ajout d\'un catalogue","library.addBtn":"Ajouter un catalogue"},"clickOnMap":{"clickedFeature":"Entit\xe9s cliqu\xe9es"},"baselayersSwitcher":{"title":"Fonds de carte"},"dataSource":{"unavailableTitle":"Couche indisponible","optionsApiUnavailable":"L\'information sur les couches n\'a pas pu \xeatre r\xe9cup\xe9r\xe9e. Certaines couches pourraient ne pas pr\xe9senter la bonne information.","unavailable":"La couche \'{{value}}\' est indisponible pour le moment ou vous n\'avez pas les permissions requises."},"dropGeoFile":{"invalid":{"text":"Le fichier \'{{value}}\' est invalide. ({{mimeType}})","title":"Fichier invalide"},"empty":{"text":"Le fichier \'{{value}}\' est vide, impossible d\'importer","title":"Fichier vide"},"success":{"text":"La couche \'{{value}}\' a \xe9t\xe9 ajout\xe9e \xe0 la carte","title":"Fichier import\xe9"},"unreadable":{"text":"Le fichier \'{{value}}\' est impossible \xe0 lire","title":"Fichier illisible"},"tooLarge":{"text":"Le fichier \'{{value}}\' est trop volumineux (Maximum: {{size}} Mo)","title":"Fichier trop volumineux"},"invalidSRS":{"text":"La projection est valide. Elle doit commencer par EPSG:","title":"Projection invalid"},"ogreServer":{"title":"Erreur 500 du service Ogre","text":"Erreur de la conversion du fichier en geojson. Il est possible que le fichier soit trop volumineux, essayer de l\'importer en format geojson"}},"export":{"customList":{"text":"Certaines couches s\xe9lectionn\xe9es ( {{value}} ) r\xe9duisent la liste des formats possible","title":"Liste restreinte de formats"},"nothing":{"text":"Impossible d\u2019exporter, donn\xe9e non valide ou aucune donn\xe9e s\xe9lectionn\xe9e.","title":"Donn\xe9e non valide ou non pr\xe9sente"},"noFormat":{"text":"Aucun format d\'exportation valide pour toutes les couches s\xe9lectionn\xe9es. Veuillez exporter les couches une \xe0 la fois.","title":"Aucun format disponible"},"failed":{"text":"Impossible d\u2019exporter, probl\xe8me de donn\xe9e rencontr\xe9.","title":"Probl\xe8me d\u2019exportation"},"popupBlocked":{"text":"</br>Veuillez autoriser l\'ouverture des fen\xeatres (popup) dans votre fureteur. </br>Pour Chrome and Edge, \xe0 droite dans la barre d\'adresse).</br>{{extraMessage}}","selectAgain":"Faites le correctif et s\xe9lectionner \xe0 nouveau un format.","retry":"Veuillez recommencer l\'exportation.","title":"Ouverture de fen\xeatre bloqu\xe9e par votre fureteur"},"success":{"text":"Donn\xe9es export\xe9es avec succ\xe8s.","title":"Exportation r\xe9ussie"},"format":{"GeoJSON":"GeoJSON","GML":"GML","GPX":"GPX","KML":"KML","Shapefile":"Shapefile","CSVcomma":"CSV (s\xe9parateur virgule)","CSVsemicolon":"CSV (compatible Excel)","URL":"Lien externe"},"gpx.error.poly":{"title":"GPX en erreur","text":"Le format GPX ne permet pas de stocker les polygones"},"encoding":{"LATIN1":"LATIN-1","UTF8":"UTF-8"}},"importExportForm":{"exportButton":"Exporter","exportButtonLink":"Ouvrir le lien","exportButtonLinks":"Ouvrir les liens","exportCircleToPolygon":"Transformer les entit\xe9s de type Cercle en polygones","exportFormatPlaceholder":"Format","exportLayerPlaceholder":"Couche(s)","exportFileNamePlaceholder":"Nom du fichier","encodingPlaceholder":"Encodage","exportTabTitle":"Exporter","exportFeatureInExtent":"Seulement les entit\xe9s contenues dans la carte","exportNoLayersExportable":"Aucune couche exportable dans la carte courante","exportSelectedFeature":"Seulement les entit\xe9s s\xe9lectionn\xe9es","importButton":"Importer","importProjPlaceholder":"Syst\xe8me de coordonn\xe9es du fichier \xe0 importer","importTabTitle":"Importer","importClarifications":"Pr\xe9cisions","importSizeMax":"La taille limite du fichier est de {{size}} Mo","importFormatAuthorized":"Formats autoris\xe9s: geojson, kml, gpx, gml, shapefile","importShpZip":"Les shapefiles doivent \xeatre compress\xe9s (zipp\xe9s) ET leurs g\xe9om\xe9tries doivent \xeatre en coordonn\xe9es Latitude Longitude (EPSG:4326/WGS84)","other":"autre","others":"autres","projections":{"mtm":"MTM {{zone}} ({{code}})","utm":"UTM {{zone}} ({{code}})","webMercator":"Web Mercator ({{code}})","nad83":"Lat-Long NAD83 ({{code}})","wgs84":"Lat-Long WGS84 ({{code}})","choose":"Vous devez choisir une projection avant d\'importer le fichier."}},"operators":{"caseSensitive":"Sensible \xe0 la case","And":"Et","Or":"Ou","PropertyIsEqualTo":"=","PropertyIsNotEqualTo":"!=","PropertyIsLike":"\u2248","PropertyIsGreaterThan":">","PropertyIsGreaterThanOrEqualTo":">=","PropertyIsLessThan":"<","PropertyIsLessThanOrEqualTo":"<=","PropertyIsBetween":"entre","During":"durant (temporel)","PropertyIsNull":"est nul","Intersects":"intersecte (g\xe9om\xe9trique)","Within":"contenu dans (g\xe9om\xe9trique)","Contains":"contient (g\xe9om\xe9trique)","tooltip":{"And":"Op\xe9rateur logique entre les filtres o\xf9 les deux conditions doivent \xeatre remplies","Or":"Op\xe9rateur logique entre les filtres o\xf9 au moins une (1) condition doit \xeatre vraie","PropertyIsEqualTo":"Identique (sensible \xe0 la case)","PropertyIsNotEqualTo":"Diff\xe9rent (sensible \xe0 la case)","PropertyIsLike":"Comme. Exemple: *route* trouve toutes les valeurs contenent \'route\', peu importe sa position dans l\'attribut. route* trouve toutes les valeurs commencant par \'route\'. Options avanc\xe9es : wildCard =\'*\', singleChar = \'.\' escapeChar = \'!\' (sensible \xe0 la case)","PropertyIsGreaterThan":"Plus grand","PropertyIsGreaterThanOrEqualTo":"Plus grand ou \xe9gal","PropertyIsLessThan":"Plus petit","PropertyIsLessThanOrEqualTo":"Plus petit ou \xe9gal","PropertyIsBetween":"Doit \xeatre contenu entre les limites inf\xe9rieure et sup\xe9rieure (les valeurs sont incluses)","During":"Doit \xeatre contenu entre les p\xe9riodes de temps sp\xe9cifi\xe9es","PropertyIsNull":"Dont l\'attribut est nul","Intersects":"Retourne les entit\xe9s \xe9tant en intersection g\xe9om\xe9trique avec la g\xe9om\xe9trie fournie","Within":"Retourne les entit\xe9s \xe9tant enti\xe8rement contenue par la g\xe9om\xe9trie fournie (Within)","Contains":"Retourne les entit\xe9s compl\xe8tement contenues par la g\xe9om\xe9trie fournie (Contains)"}},"sourceFields":{"selectField":"Choisir un champ"},"filter":{"resetFilters":"(Appliquer aucun filtre)","addFilter":"Ajouter un filtre vide \xe0 la liste courante","removeFilter":"Supprimer le pr\xe9sent filtre \xe0 la liste des filtres","toggleFilterState":"Activer/d\xe9sactiver le pr\xe9sent filtre","refreshFilters":"Mettre \xe0 jour la source de donn\xe9e avec les filtres actifs de la liste. Pour activer ce boutton, la couche doit etre visible (et dans les \xe9chelles permises) ou veillez modifier le pr\xe9sent filtre.","layerFiltered":"Cette couche d\'information est pr\xe9sentement filtr\xe9e.","layerFilterable":"Cette couche d\'information est filtrable","filterBy":"Filtrer par","advancedOgcFilters":"Filtres avanc\xe9s","displayMoreResults":"Afficher plus (+)","displayLessResults":"Afficher moins (-)","placeholder":"Saisir une valeur","placeholderSnrc":"Ex: 21L14","selectOperator":"Choisir un op\xe9rateur","sliderModeTitle":"Curseur temporel","reportingDate":"Date de signalement"},"spatialSelector":{"fixedExtent":"\xc9tendue fixe","btnSetExtent":"D\xe9finir l\'\xe9tendue du filtre selon l\'\xe9tendue courante de la carte","snrc":"SNRC","selectFeature":"","drawFeature":""},"layer":{"hideLayer":"Masquer la couche","hideSelectedLayers":"Masquer les couches s\xe9lectionn\xe9es","lowerLayer":"Mettre en arri\xe8re","filterLowerLayer":"Le d\xe9placement arri\xe8re se fait toujours selon l\'ordre de la carte!","filterPlaceholder":"Filtrer la liste de couches","activateSelectionMode":"Activer le mode de s\xe9lection multiple","deactivateSelectionMode":"D\xe9sactiver le mode de s\xe9lection multiple","tools":"Outils","selectAll":"S\xe9lectionner toutes les couches","deselectAll":"D\xe9s\xe9lectionner toutes les couches","zoomLayer":"Cadrer sur l\'\xe9tendue de la couche","zoomLayers":"Cadrer sur l\'\xe9tendue des couches s\xe9lectionn\xe9es","opacity":"Opacit\xe9","raiseLayer":"Mettre en avant","filterRaiseLayer":"Le d\xe9placement avant se fait toujours selon l\'ordre de la carte!","moreOptions":"Outils de la couche","removeLayer":"Retirer la couche de la carte","removeSelectedLayers":"Retirer les couches s\xe9lectionn\xe9es de la carte","removeSelectedLayersRestriction":"Certaines couches s\xe9lectionn\xe9es ne peuvent \xeatre supprim\xe9es","showFeaturesList":"Afficher la liste des entit\xe9s","showLayer":"Afficher la couche","showSelectedLayers":"Afficher les couches s\xe9lectionn\xe9es","subsetLayersListKeyword":"Limiter l\'affichage de la liste selon le titre ou  par type (wms, wfs,...)","deleteKeyword":"Supprimer le mot-cl\xe9","subsetLayersListOnlyVisible":"Conserver seulement les couches visibles","subsetLayersListOnlyInRange":"Conserver seulement les couches de la plage d\'\xe9chelle active","sortAlphabetically":"Trier la liste des couches en ordre alphab\xe9tique","sortMapOrder":"Replacer les couches selon l\'ordre cartographique","resetLayersList":"R\xe9tablir l\'affichage de l\'ensemble des couches","trackFeature":"Suivre l\'entit\xe9","legend":{"default":"D\xe9faut","loadingLegendText":"Chargement de la l\xe9gende","noLegendText":"Aucune symbologie disponible pour cette couche","noLegendScale":"Aucune symbologie disponible pour cette \xe9chelle","selectStyle":"S\xe9lectionner le style de la l\xe9gende","showAll":"Montrer toutes les couches (non visible et hors \xe9chelle)","noLayersVisibleWithShowAllButton":"Aucune couche actuellement visible. Activez le bouton ci haut pour voir toutes les l\xe9gendes.","noLayersVisibleWithShowAllButtonButZoom":"Aucune couche actuellement visible. Si vous zoomez dans la carte, certaines couches appara\xeetront OU activez le bouton ci haut pour voir toutes les l\xe9gendes.","noLayersVisible":"Aucune couche actuellement visible.","noLayersVisibleButZoom":"Aucune couche actuellement visible. Par contre, si vous zoomez dans la carte, certaines couches appara\xeetront."}},"download":{"action":"T\xe9l\xe9charger les donn\xe9es associ\xe9es","title":"T\xe9l\xe9chargement des donn\xe9es","start":"V\xe9rifiez la progression du t\xe9l\xe9chargement dans votre navigateur","end":"Termin\xe9"},"mapButtons":{"baselayerSwitcher":"Changer le fond de carte","geolocate":"Afficher votre position","offline":"Passer en mode hors-ligne","online":"Passer en mode en ligne","zoomIn":"Zoomer ({{zoom}})","zoomOut":"D\xe9zoomer ({{zoom}})","resetRotation":"R\xe9initialiser la carte vers le nord","tipRotation":"Maintenez les touches Alt et Majuscule (shift) tout en cliquant sur la carte pour faire pivoter la carte"},"metadata":{"show":"Montrer les m\xe9tadonn\xe9es"},"printForm":{"corsErrorMessageBody":"Impossible d\'imprimer d\xfb \xe0 des droits d\'acc\xe8s non d\xe9tenus","corsErrorMessageHeader":"Impression","comment":"Commentaire","doZipFile":"Compresser le fichier","outputFormat":"Format de sortie","paperFormat":"Format du papier","paperFormats":{"A0":"33.1 X 46.8\\" (A0)","A1":"23.4 X 33.1\\" (A1)","A2":"16.5 X 23.5\\" (A2)","A3":"11.7 X 16.5\\" (A3)","A4":"8.3 X 11.7\\" (A4)","A5":"5.8 X 8.3\\" (A5)","Letter":"Lettre","Legal":"L\xe9gal"},"imageFormat":"Format de l\'image","orientation":"Orientation","landscape":"Paysage","portrait":"Portrait","projection":"Projection","resolution":"R\xe9solution","saveBtn":"Sauvegarder","scale":"\xc9chelle","showProjection":"Afficher la projection","showScale":"Afficher l\'\xe9chelle","title":"Titre","subtitle":"Sous-titre","legendPosition":"Position de la l\xe9gende","legendPositions":{"none":"Aucune l\xe9gende","topleft":"Coin haut gauche de la carte","topright":"Coin haut droit de la carte","bottomleft":"Coin bas gauche de la carte","bottomright":"Coin bas droit de la carte","newpage":"Sur une nouvelle page"}},"directionsForm":{"stopLayer":"Itin\xe9raire - arr\xeats","routeLayer":"Itin\xe9raire - Trac\xe9","start":"D\xe9but","intermediate":"Interm\xe9diaire","end":"Fin","directionsBtn":"Obtenir l\'itin\xe9raire","resetDirectionsBtn":"Supprimer l\'itin\xe9raire","zoomRoute":"Zoomer sur l\'itin\xe9raire","null":"","directions":"Itin\xe9raire","raiseStop":"Prioriser l\'arr\xeat","lowerStop":"Reporter l\'arr\xeat plus loin dans le parcours","addStop":"Ajouter un arr\xeat","removeStop":"Supprimer l\'arr\xeat","drivingOptions":"Choix d\'itin\xe9raires","summary":"R\xe9sum\xe9 de l\'itin\xe9raire","stopsList":"Liste des lieux d\'arr\xeats","instructions":"Indications","copy":"Copier l\'itin\xe9raire","geolocate":"Utiliser sa localisation comme point d\'arr\xeat","link":"Lien","dialog":{"copyMsg":"Itin\xe9raire copi\xe9 dans le presse-papier","copyMsgLink":"Le lien de l\'itin\xe9raire est copi\xe9 dans le presse-papier","copyTitle":"Itin\xe9raire"}},"directions":{"uturn":"demi-tour","sharp right":"fortement \xe0 droite","right":"droite","slight right":"l\xe9g\xe8rement \xe0 droite","sharp left":"fortement \xe0 gauche","left":"gauche","slight left":"l\xe9g\xe8rement \xe0 gauche","straight":"tout droit"},"cardinalPoints":{"n":"nord","ne":"nord-est","e":"est","se":"sud-est","s":"sud","sw":"sud-ouest","w":"ouest","nw":"nord-ouest"},"search":{"placeholder":"Rechercher une localisation ou une couche de donn\xe9es","emptyType.placeholder":"Veuillez choisir un type de recherche","feature.title":"Localisation","feature.placeholder":"Rechercher une localisation","layer.title":"Couche de donn\xe9es","layer.placeholder":"Rechercher une couche de donn\xe9es.","ichercheReverse.name":"Recherche par coordonn\xe9es","ilayer":{"name":"Couches","properties":{"abstract":"Description","groupTitle":"Groupe","title":"Titre","type":"Type","url":"URL","metadataUrl":"M\xe9tadonn\xe9es","name":"Nom de la couche","urlInfo":"Lien du service web WMS/WFS","downloadUrl":"Lien de t\xe9l\xe9chargement de la donn\xe9es"},"type":{"layer":"Couche","groupLayer":"Groupe de couches"}},"nominatim":{"type":{"food":"Restauration","health":"Sant\xe9","entertainment":"Divertissement","finance":"Finance"},"country":{"all":"Le monde","canada":"Canada"}},"icherche":{"name":"iCherche","type":{"address":"Adresse","oldAddress":"Ancienne adresse","district":"Arrondissement","postalCode":"Code Postal","city":"Municipalit\xe9","oldCity":"Ancienne municipalit\xe9","mrc":"MRC","regadmin":"R\xe9gion administrative","road":"Route","intersection":"Intersection","place":"Lieu","exit":"Sortie d\'autoroute","cn":"Borne du CN","gcc":"Rep\xe8re de la garde coti\xe8re (GCC)","sumi":"Borne SUMI","km":"Rep\xe8re kilom\xe9trique","hq":"Hydro-Qu\xe9bec","entreprise":"Entreprise","cadastre":"Cadastre"},"restrictExtent":{"map":"\xc0 l\'\xe9tendue de la carte","quebec":"Au Qu\xe9bec"}},"coordinates":{"name":"Coordonn\xe9es","coord":"Coordonn\xe9e (longitude, latitude)","coordDMS":"Coordonn\xe9e (longitude, latitude) (DMS)","radius":"Rayon","conf":"Confiance"},"menu.tooltip":"Options de recherche","settings":{"title":"Param\xe8tres"},"pointerSearchSummary":{"title":"Position du curseur","tooltip":"Afficher les coordonn\xe9es du curseur ainsi que d\'autres informations sur sa position en fonction des types de r\xe9sultats activ\xe9es. Utiliser F2 pour activer / d\xe9sactiver."},"searchResultsGeometry":{"title":"Montrer tous les r\xe9sultats","tooltip":"Afficher/cacher la g\xe9om\xe9trie des r\xe9sultats"},"searchSources":{"selectAll":"Tout s\xe9lectionner","unselectAll":"Tout d\xe9s\xe9lectionner","settings":{"results type":"Type de r\xe9sultat","ecmax":"\xc9cart maximal","radius":"Rayon de recherche","results limit":"Nombre de r\xe9sultats","multiple object":"Objet multiple","restrictExtent":"Restreint l\'\xe9tendue","selectAll":"Tout s\xe9lectionner","unselectAll":"Tout d\xe9s\xe9lectionner","true":"Oui","false":"Non"}},"displayMoreResults":"Afficher plus de r\xe9sultats"},"geometry":{"geometry":"Geometrie","point":"Point","line":"Ligne","polygon":"Surface"},"targetHtmlUrl":"Ouvrir le lien externe","searchByCoord":"Rechercher par coordonn\xe9es","searchByName":"Rechercher par nom","seeRouting":"Voir l\'itin\xe9raire","timeFilter":{"date":"Date","endDate":"Date de fin","startDate":"Date de d\xe9but","hour":"Heure","minute":"Minute"},"spatialFilter":{"spatialFilter":"Filtre spatial","predefined":"Zone Pr\xe9d\xe9finie","draw":"Dessin","polygon":"Polygone","point":"Cercle","drawPolygon":"Dessiner un polygone","drawCircle":"Dessiner un cercle","searchLabel":"Rechercher par","buffer":"Zone tampon","search":"Recherche","drawControl":"Activer le contr\xf4le de dessin","listLabel":"Zone","entity":"Entit\xe9","layer":"Couche","goSearch":"Lancer la recherche","removeLayer":"Retirer les r\xe9sultats","exportLayer":"Exporter les r\xe9sultats","clearForm":"Retirer le dessin","clearSearch":"R\xe9initialiser les champs","Address":"Adresses","Thematics":"Th\xe9matiques","searchResults":"R\xe9sultats de la recherche","type":"Type","radius":"Rayon","radiusAlert":"Le rayon doit \xeatre compris entre 0 et 100 kilom\xe8tres (ou 100 000 m\xe8tres)","bufferAlert":"La zone tampon doit \xeatre comprise entre 0 et 100 kilom\xe8tres (ou 100 000 m\xe8tres)","maxSizeAlert":"Le nombre de r\xe9sultats exc\xe8de 10000. Certains pourraient \xeatre manquants.","zeroResults":"Aucun r\xe9sultat ne correspond \xe0 cette recherche.","warning":"Avertissement","freehandControl":"\xc0 main lev\xe9e","group":{"toponyme":"Toponyme","culturel":"Culturel","education":"\xc9ducation","sante":"Sant\xe9","securite":"S\xe9curit\xe9","sepaq":"S\xc9PAQ","transport":"Transport"}},"terrapi":{"AdmRegion":"R\xe9gions administratives","Mun":"Municipalit\xe9s","Arrond":"Arrondissements","CircFed":"Circonscriptions f\xe9d\xe9rales","CircProv":"Circonscriptions provinciales","DirReg":"Directions r\xe9gionales","MRC":"MRC","RegTour":"R\xe9gions touristiques","limites":"Limites administratives","bornes":"Bornes sumi","hydro":"Hydrographie","routes":"Routes","bati":"B\xe2timents","batiment":"B\xe2timents","camping":"Camping","equipement":"\xc9quipements","commun":"Commun","geographie":"Lieux naturels","parc":"Parcs","secteur":"Secteurs","immeubles":"Immeubles patrimoniaux","sites":"Sites patrimoniaux","cpe":"Centre de la petite enfance","public":"\xc9coles publiques","prive":"\xc9coles priv\xe9s","gouvernemental":"\xc9coles gouvernementales","colleges":"Coll\xe8ges","universites":"Universit\xe9s","aine":"R\xe9sidences pour a\xeen\xe9s","ambulance":"Zones d\'ambulance","clinique":"Cliniques","etabl":"\xc9tablissements de sant\xe9","gmf":"Groupes de m\xe9decins de famille","naissance":"Maisons de naissances","pharmacie":"Pharmacies","casernes":"Casernes de pompiers","correctionnel":"Centres correctionnels","organisme":"Organismes de s\xe9curit\xe9","palais-justice":"Palais de justice","penitencier-fed":"P\xe9nitenciers f\xe9d\xe9raux","penitencier-prov":"P\xe9nitenciers provinciaux","polices":"Poste de police"},"measure":{"dialog":{"title":"Sommes de la s\xe9lection","length.title":"Distance","area.title":"Superficie","lengthInMeters":"M\xe8tres","lengthInKilometers":"Kilom\xe8tres","lengthInMiles":"Miles","lengthInFeet":"Pieds","areaInSquareMeters":"M\xe8tres\xb2","areaInSquareKilometers":"Kilom\xe8tres\xb2","areaInSquareMiles":"Miles\xb2","areaInHectares":"Hectares","areaInAcres":"Acres","perimeterInMeters":"P\xe9rim\xe8tre en m\xe8tres"},"layerTitle":"Mesure \xe0 la carte","area":"Superficie","areaHeader":"Superficie","length":"Distance","lengthHeader":"Distance / P\xe9rim\xe8tre","perimeter":"P\xe9rim\xe8tre","meters":"M\xe8tres","m":"m","kilometers":"Kilom\xe8tres","km":"km","miles":"Miles","mi":"mi","feet":"Pieds","ft":"pi","squareMeters":"M\xe8tres\xb2","m\xb2":"m\xb2","squareKilometers":"Kilom\xe8tres\xb2","km\xb2":"km\xb2","squareMiles":"Miles\xb2","mi\xb2":"mi\xb2","squareFeet":"Pieds\xb2","ft\xb2":"pi\xb2","hectares":"Hectares","ha":"ha","acres":"Acres","ac":"ac","toggleActive":"Activer le contr\xf4le de mesure","toggleDisplayLines":"Afficher les distances sur les lignes","toggleDisplayDistance":"Afficher les distances pour les superficies","toggleDisplayAreas":"Afficher les superficies","toggleAutoUnits":"Unit\xe9s automatiques","actionbar":{"calculate.tooltip":"Calculer","delete.tooltip":"Supprimer","modify.tooltip":"Modifier"}},"draw":{"abort":"Annuler le dessin en cours","cancelColorPicker":"Annuler","Circle":"Cercle","colorPicker":"Cliquer pour ouvrir le s\xe9lecteur de couleurs","dialogInstruction":"Veuillez entrer l\'\xe9tiquette de votre dessin","dialogTitle":"\xc9tiquette","delete":"Retirer les dessins de la carte","drawing":"Dessins","fill":"Remplissage","finish":"Terminer le dessin en cours","icon":"Ic\xf4nes","labels":"\xc9tiquettes","LineString":"Ligne","move":"Centrer la vue sur le curseur","noIcon":"Aucune ic\xf4ne","noLabel":"Aucune \xe9tiquette","Point":"Point","Polygon":"Polygone","radius":"Rayon","shortcuts":"Raccourcis clavier","stroke":"Contour","styleSelect":"S\xe9lectionner le style","toggleMapTooltips":"Afficher les \xe9tiquettes","undo":"Retirer le dernier sommet"},"network":{"online":{"message":"En ligne","title":"Statut:"},"offline":{"message":"Hors-Ligne","title":"Statut:"}},"workspace":{"inMapExtent.active.tooltip":"Ne montrer que les enregistrements contenus dans la carte","inMapExtent.inactive.tooltip":"Montrer tous les enregistrements"}},"integration":{"tools":{"catalog":"Catalogue","contexts":"Contextes","directions":"Itin\xe9raire","draw":"Dessin","importExport":"Importer et exporter","ogcFilter":"Filtrer par","map":"Carte","layers":"Couches","legend":"L\xe9gende","measurer":"Mesurer","print":"Imprimer","searchResults":"R\xe9sultats de recherche","shareMap":"Partager","timeFilter":"Filtre temporel","about":"\xc0 propos","spatialFilter":"Filtre spatial","advancedMap":"Outils avanc\xe9s"},"searchResultsTool":{"noResults":"Aucun r\xe9sultat","doSearch":"Veuillez effectuer une recherche dans la barre de recherche ci-dessus.","examples":"<b>Permet de rechercher des adresses, des lieux, des coordonn\xe9es ou des couches</b>.<br><br>Les recherches d\'<u>adresses</u> peuvent \xeatre effectu\xe9es selon une combinaison: <ul><li>du no. immeuble</li><li>du nom de la rue</li><li>de la ville</li><li>du code postal</li></ul> Exemples pour les <u>lieux</u>: <ul><li>Lac Poulin</li><li>Mcdo L\xe9vis</li><li>Saint-Isidore</li></ul> Vous pouvez aussi utiliser des mots cl\xe9s pour pr\xe9ciser votre recherche. Exemples: <ul><li>#mun qu\xe9bec (pour rechercher une municipalit\xe9)</li><li>#sante L\xe9vis (pour rechercher un \xe9tablissement de sant\xe9)</li><li>#cpe joyeux (pour rechercher un centre de la petite enfance)</li><li>#intersection li\xe9gois + \xe9glise (pour rechercher une intersection, le #+ peut aussi \xeatre utilis\xe9)</li></ul>*Les mots cl\xe9s apparaissent au survol d\'un type dans l\'onglet des param\xe8tres de recherche -> iCherche -> Type de r\xe9sultat.<br><br>Exemple pour les <u>coordonn\xe9es</u> :<ul><li>Degr\xe9 d\xe9cimal (-68.165547, 48.644546)</li><li>Degr\xe9 minute seconde (-68 9 56, 48 38 40)</li><li>Degr\xe9 minute d\xe9cimal (-68 9.56, 48 38.40)</li><li>Projet\xe9 (UTM-19 561466.861, 5388278.862)</li><li>BELL (Lat: 48 38 40N Long: 68 9 56W UNC:100 CONF:90)</li><li>Metre Metre (111594.63, 445854.74;32198)</li></ul>Pour plus d\'informations sur la recherche par coordonn\xe9es : <a href=\'https://igo2.readthedocs.io/fr/next/properties.html#coordonnees\' target=\'_blank\'>Consulter la documentation d\'IGO2</a>","zoomOnFeatureTooltip":"Zoomer sur l\'entit\xe9 s\xe9lectionn\xe9e.","zoomOnFeatureTooltipOutOfView":"L\'entit\xe9 est hors de la vue. Zoomer sur l\'entit\xe9 s\xe9lectionn\xe9e."},"aboutTool":{"headerHtml":"","html":"<style>#about .bold_class{font-weight: bold;}#about .red{color: red;}#about .tool_name{border-top: 1px solid; padding-top: 10px;}#about .titre_outil{font-weight: bold; font-size: 18px; padding-bottom: 8px;}#about .subtitle{font-size: 20px; padding-bottom: 10px;}#about .align_right{text-align: right;}#about .describe{text-align: justify;}#about a img{color: black; text-decoration: none;}</style><body> <div id=\'about\'> <div class=\'bold_class subtitle\'>Aper\xe7u des fonctionnalit\xe9s</div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z\'> </path> </svg></mat-icon> Recherche </div><div class=\'describe\'> Situ\xe9e dans la portion sup\xe9rieure gauche de l\u2019interface, la barre de recherche permet de vous positionner \xe0 l\u2019aide d\u2019une adresse, d\u2019un lieu ou de coordonn\xe9es GPS et peut \xe9galement servir \xe0 chercher une couche. Il est aussi possible de rechercher un \xe9l\xe9ment par type de r\xe9sultats en utilisant le hashtag \xab # \xbb (par exemple, #municipalites qu\xe9bec). Les accents et les lettres majuscules n\'importent pas lors de l\'utilisation du hashtag.</div></div><br><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z\'></path> </svg></mat-icon> Contextes </div><div class=\'describe\'> Visualisez des regroupements de couches faits par th\xe8me ou par contexte de travail. Lorsque vous s\xe9lectionnez un <span class=\'bold_class\'>Contexte</span>, vous trouverez dans <span class=\'bold_class\'>Carte</span> chacune des couches qu\u2019il contient. Vous pouvez y ajouter d\u2019autres couches \xe0 partir du <span class=\'bold_class\'>Catalogue</span> ou de l\u2019outil <span class=\'bold_class\'>Recherche.</span> </div><br><div class=\'red\'> <span class=\'bold_class\'>ATTENTION :</span> Si vous s\xe9lectionnez un autre <span class=\'bold_class\'>Contexte</span>, toutes les couches affich\xe9es dans <span class=\'bold_class\'>Carte</span> seront remplac\xe9es. </div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M15,19L9,16.89V5L15,7.11M20.5,3C20.44,3 20.39,3 20.34,3L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21C3.55,21 3.61,21 3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3Z\'> </path> </svg></mat-icon> Carte </div><div class=\'describe\'> Personnalisez votre carte \xe0 partir du <span class=\'bold_class\'>Catalogue</span> ou de l\u2019outil <span class=\'bold_class\'>Recherche.</span> Cet espace permet d\u2019ajouter, de supprimer et d\u2019interroger des couches. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M1.39,18.36L3.16,16.6L4.58,18L5.64,16.95L4.22,15.54L5.64,14.12L8.11,16.6L9.17,15.54L6.7,13.06L8.11,11.65L9.53,13.06L10.59,12L9.17,10.59L10.59,9.17L13.06,11.65L14.12,10.59L11.65,8.11L13.06,6.7L14.47,8.11L15.54,7.05L14.12,5.64L15.54,4.22L18,6.7L19.07,5.64L16.6,3.16L18.36,1.39L22.61,5.64L5.64,22.61L1.39,18.36Z\'> </path> </svg></mat-icon> Outil de mesure </div><div class=\'describe\'> Mesurez des distances ou des superficies sur la carte. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M14,14.5V12H10V15H8V11A1,1 0 0,1 9,10H14V7.5L17.5,11M21.71,11.29L12.71,2.29H12.7C12.31,1.9 11.68,1.9 11.29,2.29L2.29,11.29C1.9,11.68 1.9,12.32 2.29,12.71L11.29,21.71C11.68,22.09 12.31,22.1 12.71,21.71L21.71,12.71C22.1,12.32 22.1,11.68 21.71,11.29Z\'> </path> </svg></mat-icon> Itin\xe9raire </div><div class=\'describe\'> Construisez un itin\xe9raire entre deux points (en placant les deux points dans la carte ou en cherchant des adresses). Vous pourrez ensuite ajouter des points interm\xe9diaires, copier la description de l\'itin\xe9raire dans le presse papier ou partager le lien. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M17,14H19V17H22V19H19V22H17V19H14V17H17V14M11,16L2,9L11,2L20,9L11,16M11,18.54L12,17.75V18C12,18.71 12.12,19.39 12.35,20L11,21.07L2,14.07L3.62,12.81L11,18.54Z\'></path> </svg></mat-icon> Catalogue </div><div class=\'describe\'> Trouvez toutes les couches qui peuvent \xeatre ajout\xe9es \xe0 la <span class=\'bold_class\'>Carte.</span> Cliquez sur la couche d\xe9sir\xe9e pour l\u2019ajouter. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M14,17H18V14L23,18.5L18,23V20H14V17M13,9H18.5L13,3.5V9M6,2H14L20,8V12.34C19.37,12.12 18.7,12 18,12A6,6 0 0,0 12,18C12,19.54 12.58,20.94 13.53,22H6C4.89,22 4,21.1 4,20V4A2,2 0 0,1 6,2Z\'></path> </svg></mat-icon> Importer/Exporter </div><div class=\'describe\'> Importez ou exportez un fichier vectoriel en sp\xe9cifiant la projection. Vous pouvez aussi sauvegarder ou recharger un contexte localement. Cela vous permet de sauvegarder des contextes en mode non-authentifi\xe9 ou anonyme. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z\'></path> </svg></mat-icon> Imprimer </div><div class=\'describe\'> Imprimez la carte affich\xe9e \xe0 l\u2019\xe9cran. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M18,16.08C17.24,16.08 16.56,16.38 16.04,16.85L8.91,12.7C8.96,12.47 9,12.24 9,12C9,11.76 8.96,11.53 8.91,11.3L15.96,7.19C16.5,7.69 17.21,8 18,8A3,3 0 0,0 21,5A3,3 0 0,0 18,2A3,3 0 0,0 15,5C15,5.24 15.04,5.47 15.09,5.7L8.04,9.81C7.5,9.31 6.79,9 6,9A3,3 0 0,0 3,12A3,3 0 0,0 6,15C6.79,15 7.5,14.69 8.04,14.19L15.16,18.34C15.11,18.55 15.08,18.77 15.08,19C15.08,20.61 16.39,21.91 18,21.91C19.61,21.91 20.92,20.61 20.92,19A2.92,2.92 0 0,0 18,16.08Z\'> </path> </svg></mat-icon> Partager </div><div class=\'describe\'> Cr\xe9ez une adresse URL qui redirige vers une repr\xe9sentation exacte de votre carte qui se trouve \xe0 l\u2019\xe9cran. Ce lien peut \xeatre partag\xe9 ou diffus\xe9 dans un document et permet de \xab&nbspsauvegarder \xbb votre carte pour une utilisation ult\xe9rieure. </div><br></div><div class=\'tool_name\'> <p> <a href=\'http://igouverte.org/\' target=\'_blank\'><img src=\'./assets/igo2/core/logo.png\' alt=\'IGO\' height=32>IGO2</a> est une solution Web libre en g\xe9omatique, d\xe9velopp\xe9e en mode collaboratif par des sp\xe9cialistes provenant de plusieurs minist\xe8res et organismes du gouvernement du Qu\xe9bec.</p><p>Version :{{version.lib}}</p></div>","trainingGuide":"Guide de formation","trainingGuideTooltip":"Cliquez ici pour acc\xe9der au guide d\'autoformation de IGO2"},"mapTool":{"empty":"La carte ne contient aucune couche de donn\xe9es.","customize":"Personnalisez-l\xe0 en ajoutant des couches \xe0 partir des outils suivants : ","search-tool":"Recherche","catalog-tool":"Catalogue de donn\xe9es","context-tool":"Gestionnaire de contextes","noLayersVisible":"Aucune couche visible.","noLayersInRange":"Aucune couche visible dans la plage d\'\xe9chelle active. Veuillez zoomer ou d\xe9zoomer pour d\xe9couvrir ces couches."},"importExportTool":{"importExportData":"Couche","importExportContext":"Contexte"},"workspace":{"toggleWorkspace":"Ouvrir/fermer la vue tabulaire","ogcFilter.close":"Fermer","ogcFilter.title":"Filtres","ogcFilter.tooltip":"Appliquer des filtres sur la couche","download.title":"T\xe9l\xe9charger les donn\xe9es associ\xe9es","download.tooltip":"T\xe9l\xe9charger les donn\xe9es associ\xe9es","inMapExtent.title":"Montrer les entit\xe9s contenues dans la carte","inMapExtent.active.tooltip":"Montrer les entit\xe9s contenues dans la carte","inMapExtent.inactive.tooltip":"Montrer toutes les entit\xe9s","zoomAuto.title":"Zoom auto","zoomAuto.tooltip":"Zoom auto","selected.title":"Montrer les entit\xe9s s\xe9lectionn\xe9es","selected.tooltip":"Montrer les entit\xe9s s\xe9lectionn\xe9es","clearSelection.title":"Tout d\xe9s\xe9lectionner","clearSelection.tooltip":"D\xe9s\xe9lectionner les enregistrements s\xe9lectionn\xe9s","maximize":"Agrandir","maximizeTooltip":"Agrandir la fen\xeatre","standardExtent":"R\xe9duire","standardExtentTooltip":"R\xe9duire la fen\xeatre"},"advanced-map-tool":{"advanced-swipe":{"swipe-select":"Choisir les couches \xe0 comparer","selectAll":"Tout s\xe9lectionner","empty":"La carte ne contient aucune couche de donn\xe9es.","customize":"Personnalisez-l\xe0 en ajoutant des couches \xe0 partir des outils suivants : ","search-tool":"Recherche","catalog-tool":"Catalogue de donn\xe9es","context-tool":"Gestionnaire de contextes","swipe":"Activer","swipe-tool":"Outil de comparaison"},"advanced-coordinates":{"copy":"Copier","lon":"Longitude","lat":"Latitude","nord":"Nord","est":"Est","coordinates":"Coordonn\xe9es du centre de la carte","copyMsg":"Coordonn\xe9es copi\xe9s","copyTitle":"Coordonn\xe9es du centre","center":"Centre","coordSystem":"Syst\xe8me de coordonn\xe9es","zoom":"Niveau de zoom courant: "}}}}}')}},function(e){e.O(0,[736],function(){return e(e.s=88214)}),e.O()}]);
//# sourceMappingURL=main-es2015.bfb8514355eca43a3b40.js.map