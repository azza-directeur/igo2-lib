(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(e,t,o){e.exports=o("QPI1")},"1pZX":function(e,t,o){var i={"./en.auth.json":"SylJ","./en.common.json":"MDgV","./en.context.json":"yhJE","./en.core.json":"3sPO","./en.geo.json":"DVs1","./en.integration.json":"tshS","./en.json":"fNJn","./fr.auth.json":"S9Br","./fr.common.json":"LoTT","./fr.context.json":"5SdO","./fr.core.json":"VPSe","./fr.geo.json":"gy/B","./fr.integration.json":"ACVS","./fr.json":"tqkM"};function r(e){var t=s(e);return o(t)}function s(e){if(!o.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}r.keys=function(){return Object.keys(i)},r.resolve=s,e.exports=r,r.id="1pZX"},"3sPO":function(e){e.exports=JSON.parse('{"igo":{"core":{"errors":{"uncaught":{"message":"Sorry, service is currently not available. Please try again later","title":"Error server"}},"network":{"online":{"message":"Online","title":"Status:"},"offline":{"message":"Offline","title":"Status:"}}}}}')},"5SdO":function(e){e.exports=JSON.parse('{"igo":{"context":{"bookmarkButton":{"create":"Cr\xe9er un contexte","dialog":{"createMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 cr\xe9\xe9","createTitle":"Contexte cr\xe9\xe9","placeholder":"Titre","title":"Nouveau contexte"}},"contextManager":{"clone":"Cloner ce contexte","delete":"Supprimer ce contexte","dialog":{"cloneMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 clon\xe9","cloneTitle":"Contexte clon\xe9","copyMsg":"Texte copi\xe9","copyTitle":"Identifiant du contexte","confirmDelete":"\xcates-vous s\xfbr de vouloir supprimer ce contexte ?","deleteMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 supprim\xe9","deleteTitle":"Contexte supprim\xe9","favoriteMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 d\xe9fini comme favori","favoriteTitle":"Favori enregistr\xe9","saveMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 enregistr\xe9","saveTitle":"Contexte enregistr\xe9"},"edit":"\xc9diter ce contexte","errors":{"uncaught":{"message":"D\xe9sol\xe9! Le service que vous voulez utiliser n\u2019est malheureusement pas disponible pour le moment. Essayez plus tard!","title":"Erreur de serveur"},"addPermission":"La permission que vous tentez d\'ajouter est d\xe9j\xe0 pr\xe9sente dans le contexte.","addPermissionEmpty":"La permission que vous tentez d\'ajouter n\'est pas valide","addPermissionTitle":"Erreur d\'ajout de permission"},"favorite":"D\xe9finir comme contexte favori","form":{"copy":"Copier l\'identifiant du contexte","edit":"Enregistrer","title":"Titre","titleRequired":"Le titre est obligatoire","uri":"Identifiant","uriRequired":"L\'identifiant est obligatoire"},"invalid":{"text":"Le contexte \\"{{value}}\\" est invalide. Le contexte par d\xe9faut a \xe9t\xe9 charg\xe9.","title":"Contexte invalide"},"managePermissions":"G\xe9rer les permissions du contexte","manageTools":"G\xe9rer les outils du contexte","ourContexts":"Mes contextes","publicContexts":"Contextes publics","save":"Sauvegarder ce contexte","sharedContexts":"Contextes partag\xe9s","filterPlaceHolder":"Filtrer par nom","sortAlphabetically":"Trier en ordre alphab\xe9tique","sortContextOrder":"Replacer selon la date de cr\xe9ation","userAccount":"Profils utilisateurs","filterUser":"Filtrer par groupe d\'utilisateur","emptyContext":"Contexte vide","emptyContextTooltip":"Cr\xe9er un nouveau contexte vide","contextMap":"Contexte \xe0 partir de la carte","contextMapTooltip":"Cr\xe9er un nouveau contexte \xe0 partir des couches la carte","hide":"Masquer ce contexte","show":"Montrer ce contexte","showHidden":"Montrer les contextes masqu\xe9s"},"contextImportExport":{"export":{"exportPlaceHolder":"Couches","exportContextName":"Nom du contexte","exportSelectAll":"Tout s\xe9lectionner","success":{"text":"Contexte export\xe9 avec succ\xe8s.","title":"Exportation r\xe9ussie"},"nothing":{"text":"Impossible d\u2019exporter, contexte non valide ou aucun contexte s\xe9lectionn\xe9.","title":"Donn\xe9e non valide ou non pr\xe9sente"},"failed":{"text":"Impossible d\u2019exporter, probl\xe8me de contexte rencontr\xe9.","title":"Probl\xe8me d\u2019exportation"}},"import":{"success":{"title":"Contexte import\xe9","text":"Le contexte \'{{value}}\' a \xe9t\xe9 ajout\xe9 \xe0 la carte"},"empty":{"text":"Le contexte \'{{value}}\' est vide, impossible d\'importer","title":"Contexte vide"},"invalid":{"text":"Le contexte \'{{value}}\' est invalide.","title":"Context invalide"},"unreadable":{"text":"Le contexte \'{{value}}\' est impossible \xe0 lire","title":"Context illisible"},"tooLarge":{"text":"Le contexte \'{{value}}\' est trop volumineux (Maximum: {{size}} Mo)","title":"Context trop volumineux"}}},"permission":{"addBtn":"Ajouter","delete":"Retirer la permission","dialog":{"addMsg":"La permission \'{{value}}\' a \xe9t\xe9 ajout\xe9e","addTitle":"Permission ajout\xe9e","deleteMsg":"La permission \'{{value}}\' a \xe9t\xe9 supprim\xe9e","deleteTitle":"Permission retir\xe9e","scopeChangedMsg":"La port\xe9e du contexte a \xe9t\xe9 chang\xe9e pour {{value}}","scopeChangedTitle":"Changement de la port\xe9e"},"profil":"Profil","user":"Utilisateur ou groupe","profilRequired":"Le profil est obligatoire","read":"Lecture seule","readOnlyTitle":"Contexte en lecture seule","readOnlyMsg":"Vous pouvez seulement retirer la permission si le contexte est directement partag\xe9 \xe0 votre nom d\'utilisateur.","scope":{"private":"Priv\xe9","protected":"Prot\xe9g\xe9","shared":"Partag\xe9","public":"Public"},"write":"Lecture et \xe9criture"},"poiButton":{"create":"Cr\xe9er une zone d\'int\xe9r\xeat","dialog":{"confirmDelete":"\xcates-vous s\xfbr de vouloir supprimer cette zone d\'int\xe9r\xeat ?","createMsg":"La zone d\'int\xe9r\xeat \'{{value}}\' a \xe9t\xe9 cr\xe9\xe9e","createTitle":"Zone d\'int\xe9r\xeat cr\xe9\xe9e","deleteMsg":"La zone d\'int\xe9r\xeat \'{{value}}\' a \xe9t\xe9 supprim\xe9e","deleteTitle":"Zone d\'int\xe9r\xeat supprim\xe9e","placeholder":"Titre","title":"Nouvelle zone d\'int\xe9r\xeat"},"placeholder":"Zones d\'int\xe9r\xeat"},"sidenav":{"goBack":"Revenir","mainMenu":"Revenir au menu principal"},"shareMap":{"button":"Partager la carte","refreshBtn":"Actualiser le partage","copy":"Copier le lien","shareWithApi":"Partage par contexte","shareWithUrl":"Partage par url","dialog":{"copyMsg":"Lien copi\xe9","copyTitle":"Lien"},"errorTitle":"Erreur lors du partage","placeholderLink":"Lien","included":"Inclus dans le lien de partage :","context":"Le contexte ouvert lors de la cr\xe9ation du lien de partage.","center":"Les coordonn\xe9es du centre de la carte (longitude, latitude).","zoom":"Le niveau de zoom de la carte.","addedLayers":"Les couches ajout\xe9es via le catalogue ou via la barre de recherche.","visibleInvisible":"Le statut de visibilit\xe9 des couches.","excluded":"Exclus dans le lien de partage :","order":"L\'ordre des couches.","opacity":"Les modifications effectu\xe9es \xe0 l\'opacit\xe9 des couches.","filterOgc":"Les ajouts/modifications faits aux filtres par attribut.","filterTime":"La valeur en cours pour les filtres temporels."},"tool":{"dialog":{"addMsg":"L\'outil a \xe9t\xe9 ajout\xe9","addTitle":"Outil ajout\xe9","deleteMsg":"L\'outil a \xe9t\xe9 supprim\xe9","deleteTitle":"Outil retir\xe9"}},"userButton":{"dialog":{"email":"Courriel","expiration":"Expiration","user":"Utilisateur","clearPreferences":"Supprimer mes pr\xe9f\xe9rences"},"infoTitle":"Info sur l\'utilisateur","logout":"Se d\xe9connecter"}}}}')},ACVS:function(e){e.exports=JSON.parse("{\"igo\":{\"integration\":{\"tools\":{\"catalog\":\"Catalogue\",\"contexts\":\"Contextes\",\"directions\":\"Itin\xe9raire\",\"draw\":\"Dessin\",\"importExport\":\"Importer et exporter\",\"ogcFilter\":\"Filtrer par\",\"map\":\"Carte\",\"layers\":\"Couches\",\"legend\":\"L\xe9gende\",\"measurer\":\"Mesure\",\"print\":\"Imprimer\",\"searchResults\":\"R\xe9sultats de recherche\",\"shareMap\":\"Partager\",\"timeFilter\":\"Filtre temporel\",\"about\":\"\xc0 propos\",\"spatialFilter\":\"Filtre spatial\"},\"searchResultsTool\":{\"noResults\":\"Aucun r\xe9sultat\",\"doSearch\":\"Veuillez effectuer une recherche dans la barre de recherche ci-dessus.\",\"examples\":\"<b>Permet de rechercher des adresses, des lieux, des coordonn\xe9es ou des couches</b>.<br><br>Les recherches d'<u>adresses</u> peuvent \xeatre effectu\xe9es selon une combinaison: <ul><li>du no. immeuble</li><li>du nom de la rue</li><li>de la ville</li><li>du code postal</li></ul> Exemples pour les <u>lieux</u>: <ul><li>Lac Poulin</li><li>Mcdo L\xe9vis</li><li>Saint-Isidore</li></ul> Vous pouvez aussi utiliser des mots cl\xe9s pour pr\xe9ciser votre recherche. Exemples: <ul><li>#mun qu\xe9bec (pour rechercher une municipalit\xe9)</li><li>#sante L\xe9vis (pour rechercher un \xe9tablissement de sant\xe9)</li><li>#cpe joyeux (pour rechercher un centre de la petite enfance)</li><li>#intersection li\xe9gois + \xe9glise (pour rechercher une intersection, le #+ peut aussi \xeatre utilis\xe9)</li></ul>*Les mots cl\xe9s apparaissent au survol d'un type dans l'onglet des param\xe8tres de recherche -> iCherche -> Type de r\xe9sultat.<br><br>Exemple pour les <u>coordonn\xe9es</u> :<ul><li>Degr\xe9 d\xe9cimal (-68.165547, 48.644546)</li><li>Degr\xe9 minute seconde (-68 9 56, 48 38 40)</li><li>Degr\xe9 minute d\xe9cimal (-68 9.56, 48 38.40)</li><li>Projet\xe9 (UTM-19 561466.861, 5388278.862)</li><li>BELL (Lat: 48 38 40N Long: 68 9 56W UNC:100 CONF:90)</li><li>Metre Metre (111594.63, 445854.74;32198)</li></ul>Pour plus d'informations sur la recherche par coordonn\xe9es : <a href='https://igo2.readthedocs.io/fr/next/properties.html#coordonnees' target='_blank'>Consulter la documentation d'IGO2</a>\",\"zoomOnFeatureTooltip\":\"Zoomer sur l'entit\xe9 s\xe9lectionn\xe9e.\",\"zoomOnFeatureTooltipOutOfView\":\"L'entit\xe9 est hors de la vue. Zoomer sur l'entit\xe9 s\xe9lectionn\xe9e.\"},\"aboutTool\":{\"html\":\"<style>#about .bold_class{font-weight: bold;}#about .red{color: red;}#about .tool_name{border-top: 1px solid; padding-top: 10px;}#about .titre_outil{font-weight: bold; font-size: 18px; padding-bottom: 8px;}#about .subtitle{font-size: 20px; padding-bottom: 10px;}#about .align_right{text-align: right;}#about .describe{text-align: justify;}#about a img{color: black; text-decoration: none;}</style><body> <div id='about'> <div class='bold_class subtitle'>Aper\xe7u des fonctionnalit\xe9s</div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z'> </path> </svg></mat-icon> Recherche </div><div class='describe'> Situ\xe9e dans la portion sup\xe9rieure gauche de l\u2019interface, la barre de recherche permet de vous positionner \xe0 l\u2019aide d\u2019une adresse, d\u2019un lieu ou de coordonn\xe9es GPS et peut \xe9galement servir \xe0 chercher une couche. Il est aussi possible de rechercher un \xe9l\xe9ment par type de r\xe9sultats en utilisant le hashtag \xab # \xbb (par exemple, #municipalites qu\xe9bec). Les accents et les lettres majuscules n'importent pas lors de l'utilisation du hashtag.</div></div><br><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z'></path> </svg></mat-icon> Contextes </div><div class='describe'> Visualisez des regroupements de couches faits par th\xe8me ou par contexte de travail. Lorsque vous s\xe9lectionnez un <span class='bold_class'>Contexte</span>, vous trouverez dans <span class='bold_class'>Carte</span> chacune des couches qu\u2019il contient. Vous pouvez y ajouter d\u2019autres couches \xe0 partir du <span class='bold_class'>Catalogue</span> ou de l\u2019outil <span class='bold_class'>Recherche.</span> </div><br><div class='red'> <span class='bold_class'>ATTENTION :</span> Si vous s\xe9lectionnez un autre <span class='bold_class'>Contexte</span>, toutes les couches affich\xe9es dans <span class='bold_class'>Carte</span> seront remplac\xe9es. </div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M15,19L9,16.89V5L15,7.11M20.5,3C20.44,3 20.39,3 20.34,3L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21C3.55,21 3.61,21 3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3Z'> </path> </svg></mat-icon> Carte </div><div class='describe'> Personnalisez votre carte \xe0 partir du <span class='bold_class'>Catalogue</span> ou de l\u2019outil <span class='bold_class'>Recherche.</span> Cet espace permet d\u2019ajouter, de supprimer et d\u2019interroger des couches. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M1.39,18.36L3.16,16.6L4.58,18L5.64,16.95L4.22,15.54L5.64,14.12L8.11,16.6L9.17,15.54L6.7,13.06L8.11,11.65L9.53,13.06L10.59,12L9.17,10.59L10.59,9.17L13.06,11.65L14.12,10.59L11.65,8.11L13.06,6.7L14.47,8.11L15.54,7.05L14.12,5.64L15.54,4.22L18,6.7L19.07,5.64L16.6,3.16L18.36,1.39L22.61,5.64L5.64,22.61L1.39,18.36Z'> </path> </svg></mat-icon> Outil de mesure </div><div class='describe'> Mesurez des distances ou des superficies sur la carte. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M14,14.5V12H10V15H8V11A1,1 0 0,1 9,10H14V7.5L17.5,11M21.71,11.29L12.71,2.29H12.7C12.31,1.9 11.68,1.9 11.29,2.29L2.29,11.29C1.9,11.68 1.9,12.32 2.29,12.71L11.29,21.71C11.68,22.09 12.31,22.1 12.71,21.71L21.71,12.71C22.1,12.32 22.1,11.68 21.71,11.29Z'> </path> </svg></mat-icon> Itin\xe9raire </div><div class='describe'> Construisez un itin\xe9raire entre deux points (en placant les deux points dans la carte ou en cherchant des adresses). Vous pourrez ensuite ajouter des points interm\xe9diaires, copier la description de l'itin\xe9raire dans le presse papier ou partager le lien. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M17,14H19V17H22V19H19V22H17V19H14V17H17V14M11,16L2,9L11,2L20,9L11,16M11,18.54L12,17.75V18C12,18.71 12.12,19.39 12.35,20L11,21.07L2,14.07L3.62,12.81L11,18.54Z'></path> </svg></mat-icon> Catalogue </div><div class='describe'> Trouvez toutes les couches qui peuvent \xeatre ajout\xe9es \xe0 la <span class='bold_class'>Carte.</span> Cliquez sur la couche d\xe9sir\xe9e pour l\u2019ajouter. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M14,17H18V14L23,18.5L18,23V20H14V17M13,9H18.5L13,3.5V9M6,2H14L20,8V12.34C19.37,12.12 18.7,12 18,12A6,6 0 0,0 12,18C12,19.54 12.58,20.94 13.53,22H6C4.89,22 4,21.1 4,20V4A2,2 0 0,1 6,2Z'></path> </svg></mat-icon> Importer/Exporter </div><div class='describe'> Importez ou exportez un fichier vectoriel en sp\xe9cifiant la projection. Vous pouvez aussi sauvegarder ou recharger un contexte localement. Cela vous permet de sauvegarder des contextes en mode non-authentifi\xe9 ou anonyme. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z'></path> </svg></mat-icon> Imprimer </div><div class='describe'> Imprimez la carte affich\xe9e \xe0 l\u2019\xe9cran. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M18,16.08C17.24,16.08 16.56,16.38 16.04,16.85L8.91,12.7C8.96,12.47 9,12.24 9,12C9,11.76 8.96,11.53 8.91,11.3L15.96,7.19C16.5,7.69 17.21,8 18,8A3,3 0 0,0 21,5A3,3 0 0,0 18,2A3,3 0 0,0 15,5C15,5.24 15.04,5.47 15.09,5.7L8.04,9.81C7.5,9.31 6.79,9 6,9A3,3 0 0,0 3,12A3,3 0 0,0 6,15C6.79,15 7.5,14.69 8.04,14.19L15.16,18.34C15.11,18.55 15.08,18.77 15.08,19C15.08,20.61 16.39,21.91 18,21.91C19.61,21.91 20.92,20.61 20.92,19A2.92,2.92 0 0,0 18,16.08Z'> </path> </svg></mat-icon> Partager </div><div class='describe'> Cr\xe9ez une adresse URL qui redirige vers une repr\xe9sentation exacte de votre carte qui se trouve \xe0 l\u2019\xe9cran. Ce lien peut \xeatre partag\xe9 ou diffus\xe9 dans un document et permet de \xab&nbspsauvegarder \xbb votre carte pour une utilisation ult\xe9rieure. </div><br></div><div class='tool_name'> <p> <a href='http://igouverte.org/' target='_blank'><img src='./assets/igo2/core/logo.png' alt='IGO' height=32>IGO2</a> est une solution Web libre en g\xe9omatique, d\xe9velopp\xe9e en mode collaboratif par des sp\xe9cialistes provenant de plusieurs minist\xe8res et organismes du gouvernement du Qu\xe9bec.</p><p>Version :{{version.lib}}</p></div>\",\"trainingGuide\":\"Guide de formation\",\"trainingGuideTooltip\":\"Cliquez ici pour acc\xe9der au guide d'autoformation de IGO2\"},\"mapTool\":{\"empty\":\"La carte ne contient aucune couche de donn\xe9es.\",\"customize\":\"Personnalisez-l\xe0 en ajoutant des couches \xe0 partir des outils suivants : \",\"search-tool\":\"Recherche\",\"catalog-tool\":\"Catalogue de donn\xe9es\",\"context-tool\":\"Gestionnaire de contextes\",\"noLayersVisible\":\"Aucune couche visible.\",\"noLayersInRange\":\"Aucune couche visible dans la plage d'\xe9chelle active. Veuillez zoomer ou d\xe9zoomer pour d\xe9couvrir ces couches.\"},\"importExportTool\":{\"importExportData\":\"Couche\",\"importExportContext\":\"Contexte\"},\"workspace\":{\"toggleWorkspace\":\"Ouvrir/fermer la vue tabulaire\",\"ogcFilter.close\":\"Fermer\",\"ogcFilter.title\":\"Filtres\",\"ogcFilter.tooltip\":\"Appliquer des filtres sur la couche\",\"download.title\":\"T\xe9l\xe9charger les donn\xe9es associ\xe9es\",\"download.tooltip\":\"T\xe9l\xe9charger les donn\xe9es associ\xe9es\",\"inMapExtent.title\":\"Montrer les entit\xe9s contenues dans la carte\",\"inMapExtent.active.tooltip\":\"Montrer les entit\xe9s contenues dans la carte\",\"inMapExtent.inactive.tooltip\":\"Montrer toutes les entit\xe9s\",\"zoomAuto.title\":\"Zoom auto\",\"zoomAuto.tooltip\":\"Zoom auto\",\"selected.title\":\"Montrer les entit\xe9s s\xe9lectionn\xe9es\",\"selected.tooltip\":\"Montrer les entit\xe9s s\xe9lectionn\xe9es\",\"clearSelection.title\":\"Tout d\xe9s\xe9lectionner\",\"clearSelection.tooltip\":\"D\xe9s\xe9lectionner les enregistrements s\xe9lectionn\xe9s\",\"maximize\":\"Agrandir\",\"maximizeTooltip\":\"Agrandir la fen\xeatre\",\"standardExtent\":\"R\xe9duire\",\"standardExtentTooltip\":\"R\xe9duire la fen\xeatre\"}}}}")},DVs1:function(e){e.exports=JSON.parse('{"igo":{"geo":{"catalog":{"layer.addToMap":"Add to map","layer.addToMapOutRange":"Add to map. The layer is not visible at the current scale. Please zoom in/out","layer.removeFromMap":"Remove from map","layer.removeFromMapOutRange":"Remove from map. The layer is not visible at the current scale. Please zoom in/out","group.addToMap":"Add all layers from this group to map","group.removeFromMap":"Remove all layers from this group to map","baseLayers":"Baselayers","unavailableTitle":"Catalog unavailable","unavailable":"The catalog \'{{value}}\' is unavailable at the moment or you don\'t have the required permissions.","externalProvider":{"catalog":"This catalog comes from an external organization.","layer":"This layer comes from an external organization.","unavailableWithEmail":"The catalog \'{{value}}\' is unavailable at the moment. To add an external service to the predefined list, please contact us at {{emailAddress}}. Delays can apply if problems occurs with the provider."},"library.add":"Add this catalog to the list","library.cancel":"Cancel","library.remove":"Remove this catalog from the list","library.inlist":{"title":"Catalog already contained","message":"The catalog is already contained in the list."},"library.addTitle":"Adding a catalog","library.addBtn":"Add a catalog"},"clickOnMap":{"clickedFeature":"Clicked Feature"},"baselayersSwitcher":{"title":"Basemaps"},"dataSource":{"unavailableTitle":"Layer unavailable","optionsApiUnavailable":"Layer information could not be retrieved. Some layers may not present the correct information.","unavailable":"The layer \'{{value}}\' is unavailable at the moment or you don\'t have the required permissions."},"dropGeoFile":{"invalid":{"text":"The file \'{{value}}\' is invalid ({{mimeType}})","title":"Invalid file"},"empty":{"text":"The file \'{{value}}\' contained nothing that could be imported.","title":"Nothing to import"},"success":{"text":"Imported file","title":"The layer \'{{value}}\' was added to the map"},"unreadable":{"text":"Unreadable file","title":"The file \'{{value}}\' is unreadable"},"tooLarge":{"text":"The file \'{{value}}\' is too large (Max: {{size}} MB)","title":"File too large"},"invalidSRS":{"text":"The projection is valid. It must start with EPSG:","title":"Invalid projection"}},"export":{"customList":{"text":"Some of the selected layers ( {{value}} ) limit the format\'s list","title":"Restricted list of formats"},"nothing":{"text":"No feature could be exported.","title":"Nothing to export"},"noFormat":{"text":"No export format valid for all selected layers. Please export the layers one at a time.","title":"No valid format"},"failed":{"text":"Failed to export","title":"Failed to export features"},"popupBlocked":{"text":"</br>Enable the popup in your browser. </br>For Chrome and Edge, on the right into the Address Bar.</br>{{extraMessage}}","selectAgain":"Fix it and re-select an output format.","retry":"Please retry to export","title":"Popup blocked by your browser"},"success":{"text":"Features have been exported.","title":"Features export success"},"format":{"GeoJSON":"GeoJSON","GML":"GML","GPX":"GPX","KML":"KML","Shapefile":"Shapefile","CSVcomma":"CSV (comma delimited)","CSVsemicolon":"CSV (semicolon delimited)","URL":"External link"},"gpx.error.poly":{"title":"GPX error","text":"GPX format do now allow polygon features"},"encoding":{"LATIN1":"LATIN-1","UTF8":"UTF-8"}},"importExportForm":{"exportButton":"Export","exportButtonLink":"Open the link","exportButtonLinks":"Open the links","exportFormatPlaceholder":"Format","exportLayerPlaceholder":"Layer","exportFileNamePlaceholder":"Filename","encodingPlaceholder":"Encoding","exportTabTitle":"Export","exportFeatureInExtent":"Export only features in map extent","exportNoLayersExportable":"There is no exportable layer in your map","exportSelectedFeature":"Export only selected features","importButton":"Import","importProjPlaceholder":"Coordinate system of the file to import","importTabTitle":"Import","importClarifications":"Clarifications","importSizeMax":"The file size limit is {{size}} Mb","importFormatAuthorized":"Formats authorized: geojson, kml, gpx, gml, shapefile","importShpZip":"Shapefiles must be zipped AND geometries stored in Latitude Longitude coordinate (EPSG:4326/WGS:84)","other":"other","others":"others","projections":{"mtm":"MTM zone {{zone}} ({{code}})","utm":"UTM zone {{zone}} ({{code}})","webMercator":"Web Mercator ({{code}})","nad83":"Lat-Long NAD83 ({{code}})","wgs84":"Lat-Long WGS84 ({{code}})","choose":"You must choose a projection for your input file."}},"operators":{"caseSensitive":"Case sensitive","And":"And","Or":"Or","PropertyIsEqualTo":"=","PropertyIsNotEqualTo":"!=","PropertyIsLike":"\u2248","PropertyIsGreaterThan":">","PropertyIsGreaterThanOrEqualTo":">=","PropertyIsLessThan":"<","PropertyIsLessThanOrEqualTo":"<=","PropertyIsBetween":"between","During":"during (temporal)","PropertyIsNull":"is null","Intersects":"intersects (spatial)","Within":"within (spatial)","Contains":"contains (spatial)","tooltip":{"And":"Logical operator between filters where both conditions must be true","Or":"Logical operator between filters where at least one (1) condition must be true","PropertyIsEqualTo":"Identical (case sensitive)","PropertyIsNotEqualTo":"Different(case sensitive)","PropertyIsLike":"Like Example: *road* Finds any values that have \'road\' in any position. road* Finds any values that begin by \'road\'. wildCard =\'*\', singleChar = \'.\' escapeChar = \'!\' (case sensitive)","PropertyIsGreaterThan":"Greater than","PropertyIsGreaterThanOrEqualTo":"Greater than or equal to ","PropertyIsLessThan":"Lesser than","PropertyIsLessThanOrEqualTo":"Lesser than or equal to","PropertyIsBetween":"Apply a range check between the lower and upper boundary (values are included)","During":"Apply a range check for time attributes","PropertyIsNull":"Return features where the attribute is null","Intersects":"Return features in geometric intersection with the provided geometry","Within":"Return feature which are completely contained by the provided geometry","Contains":"Return feature completely containing by the provided geometry"}},"sourceFields":{"selectField":"Choose a field"},"filter":{"addFilter":"Add an empty filter to the current list","removeFilter":"Remove the current filter from the filters\'s list","toggleFilterState":"Enable/disable the current filter","refreshFilters":"Update this datasource with the active filter(s). To enable this button, the layer must be visible (or in the defined scale ranges) or you must modify the current filter.","layerFiltered":"This layer is currently filtered","layerFilterable":"This layer is filterable","filterBy":"Filter by","advancedOgcFilters":"Advanced filters","displayMoreResults":"Display more (+)","displayLessResults":"Display less (-)","placeholder":"Enter a value","placeholderSnrc":"Ex: 21L14","selectOperator":"Select an operator","sliderModeTitle":"Time slider","reportingDate":"Reporting date"},"spatialSelector":{"fixedExtent":"Fixed extent","btnSetExtent":"Define the extent of the spatial filter to the current view","snrc":"SNRC","selectFeature":"","drawFeature":""},"layer":{"hideLayer":"Hide Layer","lowerLayer":"Bring layer backward","hideSelectedLayers":"Hide selected layers","filterLowerLayer":"The backward movement is always done according to the order of the map!","filterPlaceholder":"Filter the layers list","activateSelectionMode":"Activate multiple selection mode","deactivateSelectionMode":"Deactivate multiple selection mode","tools":"Tools","selectAll":"Select all","deselectAll":"Deselect all","opacity":"Opacity","raiseLayer":"Bring layer forward","filterRaiseLayer":"The forward movement is always done according to the order of the map!","moreOptions":"Layer\'s tools","removeLayer":"Remove this layer from the map","removeSelectedLayers":"Remove selected layers from the map","removeSelectedLayersRestriction":"Some selected layers cannot be removed","showFeaturesList":"Show features list","showLayer":"Show Layer","showSelectedLayers":"Show selected layers","subsetLayersListKeyword":"Subset the layers\'s list by title or type (wms, wfs,...)","deleteKeyword":"Delete the keyword","subsetLayersListOnlyVisible":"Subset the layers\'s list by visibility","subsetLayersListOnlyInRange":"Subset the layers\'s list by resolution range","sortAlphabetically":"Sort the layers\'s list alphabetically","sortMapOrder":"Sort the layers\'s list based on layer\'s order on the map","resetLayersList":"Remove the current applied filter to layers\'s list","trackFeature":"Track the feature","legend":{"default":"Default","loadingLegendText":"Loading legend","noLegendText":"No legend available for this layer","noLegendScale":"No legend available for this scale","selectStyle":"Select the style of the legend","showAll":"Show all legends (non visible and out of range)","noLayersVisibleWithShowAllButton":"No layer currently visible. Activate the button above to see all the legends.","noLayersVisibleWithShowAllButtonButZoom":"No layer currently visible. If you zoom in the map, some layers will appear OR activate the button above to see all the legends.","noLayersVisible":"No layers currently visible.","noLayersVisibleButZoom":"No layers currently visible. However, if you zoom in the map, some layers will appear."}},"download":{"action":"Download data","title":"Downloading file","start":"Started. Check the download progression in your browser","end":"Completed"},"mapButtons":{"baselayerSwitcher":"Change base layer","geolocate":"Geolocate","offline":"Offline mode","online":"Online mode","zoomIn":"Zoom in ({{zoom}})","zoomOut":"Zoom out ({{zoom}})","resetRotation":"Set map to north","tipRotation":"Hold Alt and SHIFT while dragging on map to rotate the map."},"metadata":{"show":"Show metadata"},"printForm":{"corsErrorMessageBody":"Unable to print due to non-owned access rights","corsErrorMessageHeader":"Print","comment":"Comment","doZipFile":"Zip file","outputFormat":"Output format","paperFormat":"Paper format","paperFormats":{"A0":"33.1 X 46.8\\" (A0)","A1":"23.4 X 33.1\\" (A1)","A2":"16.5 X 23.5\\" (A2)","A3":"11.7 X 16.5\\" (A3)","A4":"8.3 X 11.7\\" (A4)","A5":"5.8 X 8.3\\" (A5)","Letter":"Letter","Legal":"Legal"},"imageFormat":"Image format","orientation":"Orientation","landscape":"Landscape","portrait":"Portrait","projection":"Projection","resolution":"Resolution","saveBtn":"Save","scale":"Scale","showLegend":"Show legend","showProjection":"Show projection","showScale":"Show scale","title":"Title","subtitle":"Subtitle"},"directionsForm":{"stopLayer":"Directions - stops","routeLayer":"Directions - route","start":"Start","intermediate":"Intermediate","end":"End","directionsBtn":"Get route","resetDirectionsBtn":"Reset","zoomRoute":"Zoom on route","null":"","directions":"Directions","raiseStop":"Raise stop\'s priority","lowerStop":"Lower stop\'s priority","addStop":"Add a stop","removeStop":"Remove this stop","drivingOptions":"Options","summary":"Direction\'s summary","stopsList":"Stops\'s list","instructions":"Instructions","copy":"Copy directions","geolocate":"Use current localisation as stop","link":"Link","dialog":{"copyMsg":"Directions copied to clipboard","copyMsgLink":"Link for directions copied to clipboard","copyTitle":"Directions"}},"directions":{"uturn":"u-turn","sharp right":"sharp right","right":"right","slight right":"slightly on right","sharp left":"sharp left","left":"left","slight left":"slightly on left","straight":"forward"},"cardinalPoints":{"n":"north","ne":"northeast","e":"east","se":"southeast","s":"south","sw":"southwest","w":"west","nw":"northwest"},"search":{"placeholder":"Search for a localisation or a layer","emptyType.placeholder":"Please choose a search type","feature.title":"Localisation","feature.placeholder":"Search for a place localisation","layer.title":"Layer","layer.placeholder":"Search for a layer","ichercheReverse.name":"Search by coordinates","ilayer":{"name":"Layers","properties":{"abstract":"Abstract","groupTitle":"Group","title":"Title","type":"Type","url":"URL","metadataUrl":"Metadata","name":"Layer name","urlInfo":"URL - WMS/WFS","downloadUrl":"Data download"},"type":{"layer":"Layer","groupLayer":"Group of layers"}},"nominatim":{"type":{"food":"Food","health":"Health","entertainment":"Entertainment","finance":"Finance"},"country":{"all":"The world","canada":"Canada"}},"icherche":{"name":"iCherche","type":{"address":"Address","oldAddress":"Old address","district":"District","postalCode":"Postal Code","city":"City","oldCity":"Old city","mrc":"MRC","regadmin":"Administrative Region","road":"Road","intersection":"Intersection","place":"Place","exit":"Highway exit","cn":"CN mark","gcc":"Coast Guard mark (CCG)","sumi":"SUMI mark","km":"Mileage mark","entreprise":"Entreprise","cadastre":"Cadastre"},"restrictExtent":{"map":"\xc0 l\'\xe9tendue de la carte","quebec":"Au Qu\xe9bec"}},"coordinates":{"name":"Coordinates","coord":"Geographic (longitude, latitude)","radius":"Radius","conf":"Confidence"},"menu.tooltip":"Search Options","settings":{"title":"Settings"},"pointerSearchSummary":{"title":"Pointer position","tooltip":"Based on every search source, show the summary of the pointer location. Use F2 to activate/deactivate."},"searchResultsGeometry":{"title":"Show results geometries","tooltip":"Hide/ show the results geometries "},"searchSources":{"selectAll":"Select All","unselectAll":"Unselect All","settings":{"results type":"Results type","ecmax":"Maximum deviation","radius":"Search radius","results limit":"Number of results","multiple object":"Multiple object","restrictExtent":"Restrict the extent","selectAll":"Select All","unselectAll":"Unselect All","true":"Yes","false":"No"}},"displayMoreResults":"Display more results"},"geometry":{"geometry":"Geometry","point":"Point","line":"Line","polygon":"Polygon"},"targetHtmlUrl":"Open the external link","searchByCoord":"Search by coordinates","searchByName":"Search by name","seeRouting":"See routing","timeFilter":{"date":"Date","endDate":"End Date","startDate":"Start Date","hour":"Hour","minute":"Minute"},"spatialFilter":{"spatialFilter":"Spatial filter","predefined":"Predefined Zone","draw":"Draw","polygon":"Polygon","point":"Circle","drawPolygon":"Draw a polygon","drawCircle":"Draw a circle","searchLabel":"Search by","buffer":"Buffer","search":"Search","drawControl":"Activate draw control","listLabel":"Zone","layer":"Layer","goSearch":"Launch research","removeLayer":"Remove results","exportLayer":"Export results","clearForm":"Remove draw","clearSearch":"Reset field","Address":"Addresses","Thematics":"Thematics","searchResults":"Search Results","type":"Type","radius":"Radius","radiusAlert":"Radius must be between 0 and 100 kilometers (or 100 000 meters)","bufferAlert":"Buffer must be between 0 and 100 kilometers (or 100 000 meters)","maxSizeAlert":"Search results number exceeds 10000. Some may be missing.","zeroResults":"There are no results for this search.","warning":"Warning","freehandControl":"Freehand","group":{"toponyme":"Toponym","culturel":"Cultural","education":"Education","sante":"Health","securite":"Security","sepaq":"SEPAQ","transport":"Transportation"}},"terrapi":{"AdmRegion":"Administratives region","Mun":"Municipalities","Arrond":"Boroughs","CircFed":"Federals districts","CircProv":"Provincials districts","DirReg":"Regionals directorates","MRC":"RCM","RegTour":"Touristics regions","limites":"Administrative boundaries","bornes":"Landmarks","hydro":"Hydrography","routes":"Roads","bati":"Buildings","batiment":"Buildings","camping":"Camping","equipement":"Equipment","commun":"Public","geographie":"Natural sites","parc":"Parks","secteur":"Sector","immeubles":"Tenement","sites":"Cultural sites","cpe":"Children\'s education center","public":"Public schools","prive":"Private school","gouvernemental":"Government schools","colleges":"Colleges","universites":"University","aine":"Residences for seniors","ambulance":"Ambulance zones","clinique":"Clinics","etabl":"Health institutions","gmf":"Family doctors group","naissance":"Birth house","pharmacie":"Pharmacy","casernes":"Fire stations","correctionnel":"Correctional centres","organisme":"Security organization","palais-justice":"Courthouses","penitencier-fed":"Federal penitentiaries","penitencier-prov":"Provincial penitentiaries","polices":"Police station"},"measure":{"dialog":{"title":"Sum of the selection","length.title":"Length","area.title":"Area","lengthInMeters":"Meters","lengthInKilometers":"Kilometers","lengthInMiles":"Miles","lengthInFeet":"Feet","areaInSquareMeters":"Meters\xb2","areaInSquareKilometers":"Kilometers\xb2","areaInSquareMiles":"Miles\xb2","areaInHectares":"Hectares","areaInAcres":"Acres","perimeterInMeters":"Perimeter in meters"},"area":"Area","areaHeader":"Area","length":"Length","lengthHeader":"Length / Perimeter","perimeter":"Perimeter","meters":"Meters","m":"m","kilometers":"Kilometers","km":"km","miles":"Miles","mi":"mi","feet":"Feet","ft":"ft","squareMeters":"Meters\xb2","m\xb2":"m\xb2","squareKilometers":"Kilometers\xb2","km\xb2":"km\xb2","squareMiles":"Miles\xb2","mi\xb2":"mi\xb2","squareFeet":"Feet\xb2","ft\xb2":"ft\xb2","hectares":"Hectares","ha":"ha","acres":"Acres","ac":"ac","toggleActive":"Activate measures","toggleMapTooltips":"Show map tooltips","toggleAutoUnits":"Auto Units","actionbar":{"calculate.tooltip":"Calculate","delete.tooltip":"Delete","modify.tooltip":"Modify"}},"draw":{"cancelColorPicker":"Cancel","Circle":"Circle","dialogInstruction":"Enter your draw\'s label","dialogTitle":"Label","delete":"Remove Drawings from map","drawing":"Draws","fill":"Fill","icon":"Icons","labels":"Labels","LineString":"Line","okColorPicker":"OK","Point":"Point","Polygon":"Polygon","radius":"Radius","stroke":"Stroke","styleSelect":"Select style","toggleMapTooltips":"Show map tooltips","noIcon":"No icon"},"network":{"online":{"message":"Online","title":"Status:"},"offline":{"message":"Offline","title":"Status:"}},"workspace":{"inMapExtent.active.tooltip":"Ne montrer que les entit\xe9s contenues dans la carte","inMapExtent.inactive.tooltip":"Montrer tous les entit\xe9s"}}}}')},LoTT:function(e){e.exports=JSON.parse('{"igo":{"common":{"confirmDialog":{"cancelBtn":"Annuler","confirmBtn":"Confirmer","title":"Confirmation"},"table":{"filter":"Filtre"},"entity-table":{"targetHtmlUrl":"Ouvrir le lien externe"},"form":{"errors":{"required":"Ce champ est requis"}},"actionbar":{"scrollUp":"D\xe9filer vers le haut","scrollDown":"D\xe9filer vers le bas","icon":"Actions suppl\xe9mentaires"},"interactiveTour":{"tooltipTourToolButton":"Aide interactive sur l\'outil","disaledTooltipTourToolButton":"Pour avoir acc\xe8s au tour interactif de cet outil, ajouter des contextes ou des couches","buttonTitle":"D\xe9couvrir","exitButton":"Quitter","backButton":"Pr\xe9c\xe9dent","nextButton":"Suivant"},"paginator":{"firstPageLabel":"Premi\xe8re page","itemsPerPageLabel":"Entit\xe9s par page:","lastPageLabel":"Derni\xe8re page","nextPageLabel":"Page suivante","previousPageLabel":"Page pr\xe9c\xe9dente","of":"de"}}}}')},MDgV:function(e){e.exports=JSON.parse('{"igo":{"common":{"confirmDialog":{"cancelBtn":"Cancel","confirmBtn":"Confirm","title":"Confirm"},"table":{"filter":"Filter"},"entity-table":{"targetHtmlUrl":"Open the external link"},"form":{"errors":{"required":"This field is required"}},"actionbar":{"scrollUp":"Scroll up","scrollDown":"Scroll down","icon":"Action list"},"interactiveTour":{"tooltipTourToolButton":"Interactive tour of the application","disaledTooltipTourToolButton":"To have access to this tool\'s tour, add contexts or layers","buttonTitle":"Discover","exitButton":"Exit","backButton":"Back","nextButton":"Next"},"paginator":{"firstPageLabel":"First page","itemsPerPageLabel":"Items per page:","lastPageLabel":"Last page","nextPageLabel":"Next page","previousPageLabel":"Previous page","of":"of"}}}}')},QPI1:function(e,t,o){"use strict";o.r(t);var i=o("8Y7J");const r={production:!0,igo:{projections:[{code:"EPSG:32198",alias:"Quebec Lambert",def:"+proj=lcc +lat_1=60 +lat_2=46 +lat_0=44 +lon_0=-68.5 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs",extent:[-886251.0296,180252.9126,897177.3418,2106143.8139]}],auth:{intern:{enabled:!0},allowAnonymous:!0},interactiveTour:{tourInMobile:!0},importExport:{url:"https://geoegl.msp.gouv.qc.ca/apis/ogre"},language:{prefix:"./locale/"},catalog:{sources:[{id:"Gououvert",title:"Gouvouvert",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi"},{id:"DefiningInfoFormat",title:"Defining info_format",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/swtq",queryFormat:{html:"*","application/json":["stations_meteoroutieres","histo_stations_meteoroutieres"]},queryHtmlTarget:"iframe",count:30},{id:"catalogwithregex",title:"Filtered catalog by regex",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/swtq",regFilters:["zpegt"]},{id:"catalogwithtooltipcontrol",title:"Controling tooltip format",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",tooltipType:"abstract"}]},searchSources:{nominatim:{enabled:!1},icherche:{searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/icherche",order:2,enabled:!0,params:{limit:"8"}},coordinatesreverse:{showInPointerSummary:!0},icherchereverse:{showInPointerSummary:!0,searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/terrapi",order:3,enabled:!0},ilayer:{searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/layers/search",order:4,enabled:!0,params:{limit:"5"}}}}};o("yLV6");var s=o("cUpR"),a=o("omvX"),n=o("Dxy4"),c=o("Tj54"),l=o("SqCe"),u=o("q7Ft"),d=o("l0rg"),h=o("ZFy/"),p=o("iInd"),m=o("SVse"),g=o("PDjf"),b=o("pMoy"),f=o("rJgo"),y=o("IheW"),O=o("nYR2"),v=o("JIr8"),j=o("lJxs"),w=o("vkgz"),S=o("Kj3r"),x=o("JX91"),C=o("2Vo4"),T=o("z6cu"),L=o("LRne"),I=o("itXk"),F=o("xgIS"),M=o("M39V"),k=o("XNiG"),D=o("/uUt");let P=(()=>{class e{static getByte(e,t){return e.charCodeAt(t)}static getByte64(e,t){return this.ALPHA.indexOf(e.charAt(t))}static decode(e){let t,o,i=0,r=e.length,s=[];if(e=String(e),0===r)return e;for(e.charAt(r-1)===this.PADCHAR&&(i=1,e.charAt(r-2)===this.PADCHAR&&(i=2),r-=4),t=0;t<r;t+=4)o=this.getByte64(e,t)<<18|this.getByte64(e,t+1)<<12|this.getByte64(e,t+2)<<6|this.getByte64(e,t+3),s.push(String.fromCharCode(o>>16,o>>8&255,255&o));switch(i){case 1:o=this.getByte64(e,t)<<18|this.getByte64(e,t+1)<<12|this.getByte64(e,t+2)<<6,s.push(String.fromCharCode(o>>16,o>>8&255));break;case 2:o=this.getByte64(e,t)<<18|this.getByte64(e,t+1)<<12,s.push(String.fromCharCode(o>>16))}return s.join("")}static encode(e){let t,o,i=[],r=(e=String(e)).length-e.length%3;if(0===e.length)return e;for(t=0;t<r;t+=3)o=this.getByte(e,t)<<16|this.getByte(e,t+1)<<8|this.getByte(e,t+2),i.push(this.ALPHA.charAt(o>>18)),i.push(this.ALPHA.charAt(o>>12&63)),i.push(this.ALPHA.charAt(o>>6&63)),i.push(this.ALPHA.charAt(63&o));switch(e.length-r){case 1:o=this.getByte(e,t)<<16,i.push(this.ALPHA.charAt(o>>18)+this.ALPHA.charAt(o>>12&63)+this.PADCHAR+this.PADCHAR);break;case 2:o=this.getByte(e,t)<<16|this.getByte(e,t+1)<<8,i.push(this.ALPHA.charAt(o>>18)+this.ALPHA.charAt(o>>12&63)+this.ALPHA.charAt(o>>6&63)+this.PADCHAR)}return i.join("")}}return e.PADCHAR="=",e.ALPHA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e})();const A=Object(M.getParser)(window.navigator.userAgent);class ${static copy(e){let t=!1;if("string"==typeof e){const o=$.createTextArea(e);$.selectText(o),t=$.copyTextToClipboard(),$.destroyTextArea(o)}else $.selectText(e),t=$.copyTextToClipboard();return t}static createTextArea(e){const t=document.createElement("textArea");return t.value=e,document.body.appendChild(t),t}static destroyTextArea(e){document.body.removeChild(e)}static selectText(e){if("iOS"===A.getOSName()){const t=e.contentEditable,o=e.readOnly,i=document.createRange(),r=window.getSelection();e.contenteditable=!0,e.readonly=!1,i.selectNodeContents(e),r.removeAllRanges(),r.addRange(i),e.setSelectionRange(0,999999),e.contentEditable=t,e.readOnly=o}else e.select()}static copyTextToClipboard(){return("iOS"!==A.getOSName()||!A.compareVersion("<10"))&&document.execCommand("copy")}}class E{static resolve(e,t){const o=t.replace(/\[/g,".").replace(/\]/g,"").split(".");let i=e;for(;o.length;){if("object"!=typeof i)return;i=i[o.shift()]}return i}static isObject(e){return e&&"object"==typeof e&&!Array.isArray(e)&&null!==e&&!(e instanceof Date)}static mergeDeep(e,t,o=!1){const i=Object.assign({},e);return E.isObject(e)&&E.isObject(t)&&Object.keys(t).filter(e=>!o||void 0!==t[e]).forEach(r=>{E.isObject(t[r])?r in e?i[r]=E.mergeDeep(e[r],t[r],o):Object.assign(i,{[r]:t[r]}):Object.assign(i,{[r]:t[r]})}),i}static copyDeep(e){const t=Array.isArray(e)?[]:{};for(const o in e)if(e.hasOwnProperty(o)){const i=e[o];t[o]=i&&"object"==typeof i?this.copyDeep(i):i}return t}static removeDuplicateCaseInsensitive(e){const t={},o={},i=[];for(const r in e)if(e.hasOwnProperty(r)){const o=r.toUpperCase();t.hasOwnProperty(o)?t[o].push({[r]:e[r]}):t[o]=[{[r]:e[r]}],i.push({key:r,count:r.replace(/[^A-Z]/g,"").length})}for(const r in t)if(t.hasOwnProperty(r)&&t.hasOwnProperty(r)){const s=t[r];if(1===s.length){const e=s[0];o[r]=e[Object.keys(e)[0]]}else if(s.length>1){const t=i.filter(e=>e.key.toLowerCase()===r.toLowerCase()).reduce((e,t)=>e.y<t.y?e:t);o[t.key.toUpperCase()]=e[t.key]}}for(const r in e)e.hasOwnProperty(r)&&delete e[r];for(const r in o)o.hasOwnProperty(r)&&(e[r]=o[r])}static removeUndefined(e){const t={};return E.isObject(e)?(Object.keys(e).filter(t=>void 0!==e[t]).forEach(o=>{t[o]=E.isObject(e[o])||Array.isArray(e[o])?E.removeUndefined(e[o]):e[o]}),t):Array.isArray(e)?e.map(e=>E.removeUndefined(e)):e}static removeNull(e){const t={};return E.isObject(e)?(Object.keys(e).filter(t=>null!==e[t]).forEach(o=>{t[o]=E.isObject(e[o])||Array.isArray(e[o])?E.removeNull(e[o]):e[o]}),t):Array.isArray(e)?e.map(e=>E.removeNull(e)):e}static naturalCompare(e,t,o="asc",i){if("desc"===o&&(t=[e,e=t][0]),null===e||""===e||void 0===e||null===t||""===t||void 0===t){const r=e===t?0:void 0===e?3:void 0===t?-3:null===e?2:null===t?-2:""===e?1:-1;return"desc"===o?!1!==i?r:-1*r:!0===i?-1*r:r}const r=[],s=[];for(t=""+t,(e=""+e).replace(/(\d+)|(\D+)/g,(e,t,o)=>{r.push([t||1/0,o||""])}),t.replace(/(\d+)|(\D+)/g,(e,t,o)=>{s.push([t||1/0,o||""])});r.length&&s.length;){const e=r.shift(),t=s.shift(),o=e[0]-t[0]||e[1].localeCompare(t[1]);if(o)return o}return r.length-s.length}static objectsAreEquivalent(e,t){if(e===t)return!0;const o=Object.getOwnPropertyNames(e),i=Object.getOwnPropertyNames(t);if(o.length!==i.length)return!1;for(const r of o)if(e[r]!==t[r])return!1;return!0}static removeKeys(e,t){return Object.keys(e).filter(e=>t.indexOf(e)<0).reduce((t,o)=>(t[o]=e[o],t),{})}}function R(e){return e.reduce((e,t)=>(e[t]=t,e),Object.create(null))}function _(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function z(){return`${_()}${_()}-${_()}-${_()}-${_()}-${_()}${_()}${_()}`.toLowerCase()}var N=function(e){return e[e.Error=0]="Error",e[e.Done=1]="Done",e[e.Working=2]="Working",e[e.Waiting=3]="Waiting",e}({});class B{constructor(){this.status$=new k.a}get status(){return this._status}set status(e){this._status=e,this.status$.next(e)}subscribe(e,t){this.watch(),this.status$$=this.status$.pipe(Object(D.a)()).subscribe(o=>{this.handleStatusChange(o),e.call(t,this)})}unsubscribe(){this.unwatch(),void 0!==this.status$$&&(this.status$$.unsubscribe(),this.status$$=void 0),this.status=N.Waiting}handleStatusChange(e){}}var q=o("TSSN"),G=o("La0n"),V=o("HeVh");let U=(()=>{class e{constructor(){this.counter$=new C.a(0),this.ids=[]}register(){const e=z();return this.ids.push(e),this.counter$.next(this.ids.length),e}unregister(e){const t=this.ids.indexOf(e);-1!==t&&(this.ids.splice(t,1),this.counter$.next(this.ids.length))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),H=(()=>{class e{constructor(e){this.activityService=e}intercept(e,t){const o=e.headers.get("activityInterceptor");if(o){const i=e.clone({headers:e.headers.delete("activityInterceptor")});if("false"===o)return t.handle(i)}const i=this.activityService.register();return t.handle(e).pipe(Object(O.a)(()=>{this.activityService.unregister(i)}))}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(U))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac}),e})(),Y=(()=>{class e{static forRoot(){return{ngModule:e,providers:[{provide:y.a,useClass:H,multi:!0}]}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[]]}),e})();const W={lib:"1.7.2",releaseDate:1621276718436};let K=(()=>{class e{constructor(e){this.injector=e,this.config={}}getConfig(e){return E.resolve(this.config,e)}load(e){const t=e.default||{};if(!e.path)return this.config=t,!0;const o=this.injector.get(y.b);return new Promise((i,r)=>{o.get(e.path).pipe(Object(v.a)(t=>(console.log(`Configuration file ${e.path} could not be read`),i(!0),Object(T.a)(t.error||"Server error")))).subscribe(e=>{this.config=E.mergeDeep(E.mergeDeep({version:W},t),e),i(!0)})})}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(i.C))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Z=new i.B("configOptions");function Q(e){return{provide:Z,useValue:e}}function J(e,t){return()=>e.load(t)}let X=(()=>{class e{static forRoot(){return{ngModule:e,providers:[Q({}),{provide:i.d,useFactory:J,multi:!0,deps:[K,Z]}]}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[]]}),e})();class ee{constructor(e,t,o=".json",i){this.http=e,this.prefix=t,this.suffix=o,this.config=i}getTranslation(e){const t=o("1pZX")(`./${e}.json`),i=Object(L.a)(t);if(this.config&&!this.prefix){const e=this.config.getConfig("language.prefix");this.prefix=!e||Array.isArray(e)?e:[e]}if(!this.prefix||0===this.prefix.length)return i;const r=this.prefix.map(t=>this.http.get(`${t}${e}${this.suffix}`));return Object(I.a)([i,...r]).pipe(Object(j.a)(e=>e.reduce((e,t)=>E.mergeDeep(e,t),{})))}}function te(e,t){return new ee(e,void 0,void 0,t)}class oe{handle(e){if(!e.translateService.langs.length)throw new Error("Translations are not yet loaded.          Check that the LanguageService is injected.");if("igo."===e.key.substr(0,4))throw new Error(`The Key "${e.key}" is missing in locale file.`);return e.key}}let ie=(()=>{class e{static forRoot(){return{ngModule:e,providers:[{provide:q.c,useFactory:te,deps:[y.b,K]}]}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[q.d.forRoot({missingTranslationHandler:{provide:q.a,useClass:oe}})],q.d]}),e})();const re=function(e){return{closeIcon:e}};let se=(()=>{class e{constructor(){this._options={}}get options(){return Object.assign({},e.defaultOptions,this._options)}set options(e){this._options=e}}return e.defaultOptions={timeOut:5e3,hasCloseIcon:!1,showProgressBar:!0,pauseOnHover:!0,clickToClose:!0,maxLength:100,maxStack:3,preventDuplicates:!0},e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-message-center"]],inputs:{options:"options"},decls:1,vars:4,consts:[[1,"mat-typography",3,"ngClass","options"]],template:function(e,t){1&e&&Object(i.hc)(0,"simple-notifications",0),2&e&&Object(i.Dc)("ngClass",Object(i.Gc)(2,re,t.options.hasCloseIcon))("options",t.options)},directives:[G.b,m.q],styles:['@charset "UTF-8";[_nghost-%COMP%]     div.simple-notification-wrapper{bottom:0;right:calc(50% - 150px)}@media only screen and (orientation:landscape) and (max-width:959px),only screen and (orientation:portrait) and (max-width:599px){[_nghost-%COMP%]     div.simple-notification-wrapper{left:0;right:0;width:100%}}[_nghost-%COMP%]     div.simple-notification{margin-bottom:5px;min-height:50px;padding-left:45px;padding-right:25px}[_nghost-%COMP%]     div.simple-notification.noIcon{padding-left:25px}@media only screen and (orientation:landscape) and (max-width:959px),only screen and (orientation:portrait) and (max-width:599px){[_nghost-%COMP%]     div.simple-notification{margin-bottom:0}}[_nghost-%COMP%]     div.simple-notification .sn-title{font-size:15px;font-weight:700;line-height:23px}[_nghost-%COMP%]     div.simple-notification .sn-content{font-size:15px;line-height:18px}[_nghost-%COMP%]     div.simple-notification .icon{height:100%;left:0;padding:7px;top:0;width:45px}[_nghost-%COMP%]     div.simple-notification .icon\xa0 mat-icon{align-items:center;display:flex;font-size:32px;height:100%}[_nghost-%COMP%]     .closeIcon   .sn-title:after{content:"close";font-family:Material Icons;font-feature-settings:"liga" 1;font-size:24px;font-weight:400;position:absolute;right:5px;top:5px}']}),e})(),ae=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,G.c.forRoot()]]}),e})();var ne=function(e){return e.ERROR="error",e.ALERT="alert",e.INFO="info",e.SUCCESS="success",e}({});let ce=(()=>{class e{constructor(e,t){this.notificationService=e,this.configService=t,this.messages$=new C.a([]),this.options=this.configService.getConfig("message")||{}}showError(e){return e.error.caught=!0,this.error(e.error.message,e.error.title)}message(e){this.messages$.next(this.messages$.value.concat([e])),e.options=e.options||{};const t=new Date;if(e.options.from=e.options.from?e.options.from:new Date("1 jan 1900"),e.options.to=e.options.to?e.options.to:new Date("1 jan 3000"),"string"==typeof e.options.from&&(e.options.from=new Date(Date.parse(e.options.from.replace(/-/g," ")))),"string"==typeof e.options.to&&(e.options.to=new Date(Date.parse(e.options.to.replace(/-/g," ")))),t>e.options.from&&t<e.options.to){let t;if((e=this.handleTemplate(e)).text)t=this.notificationService.create(e.title,e.text,e.type,e.options);else{if(!e.html)return;e.icon||(e.options.theClass=e.options.theClass?e.options.theClass+" noIcon":"noIcon"),t=this.notificationService.html(e.html,e.type,e.options)}return void 0!==e.icon&&this.addIcon(t,e.icon),t}}success(e,t,o={}){return this.message({text:e,title:t,icon:o.icon||"check",options:o,type:ne.SUCCESS})}error(e,t,o={}){return this.message({text:e,title:t,icon:o.icon||"error_outline",options:o,type:ne.ERROR})}info(e,t,o={}){return this.message({text:e,title:t,icon:o.icon||"info_outline",options:o,type:ne.INFO})}alert(e,t,o={}){return this.message({text:e,title:t,icon:o.icon||"access_alarm",options:o,type:ne.ALERT})}remove(e){this.notificationService.remove(e)}addIcon(e,t){e.icon=`\n      <mat-icon class="material-icons mat-icon mat-list-avatar" svgIcon="${t}">\n      </mat-icon>`}handleTemplate(e){if(!this.options.template||e.html)return e;let t=this.options.template;return t=t.replace("${text}",e.text),t=t.replace("${title}",e.title),t=t.replace("${icon}",e.icon),e.html=t,e.text=void 0,e.title=void 0,e.icon=void 0,e}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(G.a),Object(i.qc)(K))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),le=(()=>{class e{constructor(e){this.translate=e,this.language=this.translate.getBrowserLang();const t=this.getLanguage();this.translate.setDefaultLang(t)}getLanguage(){return this.language.match(/en|fr/)?this.language:"en"}setLanguage(e){this.language=e.match(/en|fr/)?e:"en",this.translate.use(this.language),this.translate.reloadLang(this.language)}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(q.f))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),ue=(()=>{class e{constructor(e,t){this.messageService=e,this.injector=t}intercept(e,t){const o={httpError:void 0};return t.handle(e).pipe(Object(v.a)(e=>this.handleError(e,o)),Object(O.a)(()=>{this.handleCaughtError(o),this.handleUncaughtError(o)}))}handleError(e,t){if(e instanceof y.e){const t="object"===e.error?e.error:{};t.message=e.error.message||e.statusText,t.caught=!1,e=new y.e({error:t,headers:e.headers,status:e.status,statusText:e.statusText,url:e.url})}return t.httpError=e,Object(T.a)(e)}handleCaughtError(e){const t=e.httpError;t&&t.error.toDisplay&&(t.error.caught=!0,this.messageService.error(t.error.message,t.error.title))}handleUncaughtError(e){const t=e.httpError;if(t&&!t.error.caught){const e=this.injector.get(le).translate,o=e.instant("igo.core.errors.uncaught.message"),i=e.instant("igo.core.errors.uncaught.title");t.error.caught=!0,this.messageService.error(o,i)}}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(ce),Object(i.qc)(i.C))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),de=(()=>{class e{constructor(e){if(e)throw new Error("IgoErrorModule is already loaded. Import it in the AppModule only")}static forRoot(){return{ngModule:e,providers:[{provide:y.a,useClass:ue,multi:!0}]}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)(Object(i.qc)(e,12))},imports:[[]]}),e})(),he=new i.B("routeServiceOptions"),pe=(()=>{class e{constructor(e,t){this.route=e,this.options=Object.assign({},{centerKey:"center",zoomKey:"zoom",projectionKey:"projection",contextKey:"context",searchKey:"search",visibleOnLayersKey:"visiblelayers",visibleOffLayersKey:"invisiblelayers",directionsCoordKey:"routing",toolKey:"tool",wmsUrlKey:"wmsUrl",wmsLayersKey:"wmsLayers",wmtsUrlKey:"wmtsUrl",wmtsLayersKey:"wmtsLayers",arcgisUrlKey:"arcgisUrl",arcgisLayersKey:"arcgisLayers",iarcgisUrlKey:"iarcgisUrl",iarcgisLayersKey:"iarcgisLayers",tarcgisUrlKey:"tarcgisUrl",tarcgisLayersKey:"tarcgisLayers",vectorKey:"vector"},t)}get queryParams(){return this.route.queryParams}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(p.a),Object(i.qc)(he,8))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var me=function(e){return e.Mobile="mobile",e.Tablet="tablet",e.Desktop="desktop",e}({}),ge=function(e){return e.Portrait="portrait",e.Landscape="landscape",e}({});let be=(()=>{class e{constructor(e){this.media$=new C.a(void 0),this.orientation$=new C.a(void 0),e.observe([V.b.HandsetLandscape]).subscribe(e=>{e.matches&&(this.media$.next(me.Mobile),this.orientation$.next(ge.Landscape))}),e.observe([V.b.HandsetPortrait]).subscribe(e=>{e.matches&&(this.media$.next(me.Mobile),this.orientation$.next(ge.Portrait))}),e.observe([V.b.TabletLandscape]).subscribe(e=>{e.matches&&(this.media$.next(me.Tablet),this.orientation$.next(ge.Landscape))}),e.observe([V.b.TabletPortrait]).subscribe(e=>{e.matches&&(this.media$.next(me.Tablet),this.orientation$.next(ge.Portrait))}),e.observe([V.b.WebLandscape]).subscribe(e=>{e.matches&&(this.media$.next(me.Desktop),this.orientation$.next(ge.Landscape))}),e.observe([V.b.WebPortrait]).subscribe(e=>{e.matches&&(this.media$.next(me.Desktop),this.orientation$.next(ge.Portrait))})}getMedia(){return this.media$.value}getOrientation(){return this.orientation$.value}isTouchScreen(){return"ontouchstart"in document.documentElement}isMobile(){return"mobile"===this.getMedia()}isDesktop(){return"desktop"===this.getMedia()}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(V.a))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var fe=function(e){return e.SESSION="Session",e.LOCAL="Local",e}({}),ye=function(e){return e.ADDED="Added",e.MODIFIED="Modified",e.REMOVED="Removed",e.CLEARED="Cleared",e}({});let Oe=(()=>{class e{constructor(e){this.config=e,this.storageChange$=new C.a(void 0),this.options=this.config.getConfig("storage")||{key:"igo"}}get(e,t){let o;if(t&&t!==fe.SESSION||(o=sessionStorage.getItem(`${this.options.key}.${e}`)),t!==fe.LOCAL&&(o||t)||(o=localStorage.getItem(`${this.options.key}.${e}`)),o)try{o=JSON.parse(o)}catch(i){o=o}return o}set(e,t,o=fe.LOCAL){const i=this.get(e,o);o===fe.SESSION?sessionStorage.setItem(`${this.options.key}.${e}`,JSON.stringify(t)):localStorage.setItem(`${this.options.key}.${e}`,JSON.stringify(t));const r=this.get(e,o);r!==i&&this.storageChange$.next({key:e,scope:o,event:void 0!==i?ye.MODIFIED:ye.ADDED,previousValue:i,currentValue:r})}remove(e,t=fe.LOCAL){const o=this.get(e,t);t===fe.SESSION?sessionStorage.removeItem(`${this.options.key}.${e}`):localStorage.removeItem(`${this.options.key}.${e}`),this.storageChange$.next({key:e,scope:t,event:ye.REMOVED,previousValue:o})}clear(e=fe.LOCAL){e===fe.SESSION?sessionStorage.clear():localStorage.clear(),this.storageChange$.next({scope:e,event:ye.CLEARED})}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(K))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),ve=(()=>{class e{constructor(e,t){this.messageService=e,this.injector=t,this.stateChangeEventEmitter=new i.u,this.state={connection:window.navigator.onLine},this.checkNetworkState()}checkNetworkState(){this.onlineSubscription=Object(F.a)(window,"online").subscribe(()=>{const e=this.injector.get(le).translate,t=e.instant("igo.core.network.online.message"),o=e.instant("igo.core.network.online.title");this.messageService.info(t,o),this.state.connection=!0,this.emitEvent()}),this.offlineSubscription=Object(F.a)(window,"offline").subscribe(()=>{const e=this.injector.get(le).translate,t=e.instant("igo.core.network.offline.message"),o=e.instant("igo.core.network.offline.title");this.messageService.info(t,o),this.state.connection=!1,this.emitEvent()})}emitEvent(){this.stateChangeEventEmitter.emit(this.state)}ngOnDestroy(){try{this.offlineSubscription.unsubscribe(),this.onlineSubscription.unsubscribe()}catch(e){}}currentState(e=!0){return e?this.stateChangeEventEmitter.pipe(Object(S.a)(300),Object(x.a)(this.state)):this.stateChangeEventEmitter.pipe(Object(S.a)(300))}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(ce),Object(i.qc)(i.C))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var je=o("Njdo"),we=o.n(je),Se=o("jtHE"),xe=o("HDdC"),Ce=o("7+OI"),Te=o("VRyK"),Le=o("zP0r"),Ie=o("eIep"),Fe=o("pLZG"),Me=o("IzEk"),ke=o("Q2Ze"),De=o("ZTz/"),Pe=o("UhP/"),Ae=o("5QHs"),$e=o("OaSA"),Ee=o("LUZP"),Re=o("ZpRC"),_e=o("mrSG"),ze=o("fERl"),Ne=o("1O3W"),Be=o("8Qe2"),qe=o("iELJ"),Ge=o("1z/I"),Ve=o("e6WT"),Ue=o("s7LF"),He=o("jYiU"),Ye=o("pu8Q"),We=o("CtHx"),Ke=o("GXRp"),Ze=o("GS7A"),Qe=function(e){return e.Default="Default",e.HTML="HTML",e.UnsanitizedHTML="UnsanitizedHTML",e.Icon="Icon",e.ButtonGroup="ButtonGroup",e}({}),Je=function(e){return e.Auto="auto",e.Instant="instant",e.Smooth="smooth",e}({}),Xe=function(e){return e.None="None",e.All="All",e.Some="Some",e}({});function et(e,t){return we()(e,t).safeObject}function tt(e){const t=e.meta||{};return t.id?t.id:et(e,t.idProperty||"id")}function ot(e){const t=e.meta||{};return t.title?t.title:et(e,t.titleProperty||"title")}function it(e){const t=e.meta||{};return t.icon?t.icon:et(e,t.iconProperty||"icon")}class rt{constructor(e={}){this.index=new Map,this.change$=new Se.a(1),this.store=e.store?e.store:void 0,this.getKey=e.getKey?e.getKey:this.store?this.store.getKey:tt,this.next()}clear(){this.index.size>0&&(this.index.clear(),this.next())}get(e){return this.index.get(this.getKey(e))||{}}set(e,t){this.setMany([e],t)}setMany(e,t){e.forEach(e=>{this.index.set(this.getKey(e),Object.assign({},t))}),this.next()}setAll(e){Array.from(this.index.keys()).forEach(t=>{this.index.set(t,Object.assign({},e))}),this.next()}update(e,t,o=!1){this.updateMany([e],t,o)}updateMany(e,t,o=!1){if(!0===o)return this.updateManyExclusive(e,t);e.forEach(e=>{const o=Object.assign({},this.get(e),t);this.index.set(this.getKey(e),o)}),this.next()}reverse(e,t){this.reverseMany([e],t)}reverseMany(e,t){e.forEach(e=>{const o=this.get(e),i=t.reduce((e,t)=>(e[t]=o[t]||!1,e),{}),r=this.reverseChanges(i),s=Object.assign({},o,r);this.index.set(this.getKey(e),s)}),this.next()}updateAll(e){const t=this.getAllKeys();Array.from(t).forEach(t=>{const o=Object.assign({},this.index.get(t),e);this.index.set(t,o)}),this.next()}updateManyExclusive(e,t){const o=this.reverseChanges(t),i=e.map(e=>this.getKey(e));new Set(i.concat(Array.from(this.getAllKeys()))).forEach(e=>{const r=this.index.get(e)||{};i.indexOf(e)>=0?this.index.set(e,Object.assign({},r,t)):!0===Object.keys(o).some(e=>void 0!==r[e]&&r[e]!==o[e])&&this.index.set(e,Object.assign({},r,o))}),this.next()}reverseChanges(e){return Object.entries(e).reduce((e,t)=>{const[o,i]=t;return"boolean"==typeof i&&(e[o]=!i),e},{})}getAllKeys(){const e=this.store?Array.from(this.store.index.keys()):[];return new Set(Array.from(this.index.keys()).concat(e))}next(){this.change$.next()}}class st{constructor(e){this.source$=e,this.values$=new C.a([]),this.lifted=!1,this.joins=[],this.filter$=new C.a(void 0),this.filters$=new C.a([]),this.filterIndex=new Map,this.sort$=new C.a(void 0),this.getKey$=new C.a(void 0),this.count$=new C.a(0),this.empty$=new C.a(!0)}get getKey(){return this.getKey$.value}get count(){return this.count$.value}get empty(){return this.empty$.value}get index(){return this._index}get(e){if(void 0===this._index)throw new Error("This view has no index, therefore, this method is unavailable.");return this.index.get(e)}all(){return this.values$.value}all$(){return this.values$}firstBy(e){return this.values$.value.find(e)}firstBy$(e){return this.values$.pipe(Object(j.a)(t=>t.find(e)))}manyBy(e){return this.values$.value.filter(e)}manyBy$(e){return this.values$.pipe(Object(j.a)(t=>t.filter(e)))}clear(){this.filter(void 0),this.sort(void 0)}destroy(){void 0!==this.values$$&&this.values$$.unsubscribe(),this.clear()}createIndex(e){return this._index=new Map,this.getKey$.next(e),this}join(e){if(!0===this.lifted)throw new Error("This view has already been lifted, therefore, no join is allowed.");return this.joins.push(e),this}filter(e){return this.filter$.next(e),this}addFilter(e){const t=z();return this.filterIndex.set(t,e),this.filters$.next(Array.from(this.filterIndex.values())),t}removeFilter(e){this.filterIndex.delete(e),this.filters$.next(Array.from(this.filterIndex.values()))}sort(e){return this.sort$.next(e),this}lift(){this.lifted=!0;const e=[this.joins.length>0?this.liftJoinedSource():this.liftSource(),this.filters$,this.filter$,this.sort$,this.getKey$];this.values$$=Object(I.a)(e).pipe(Object(Le.a)(1),Object(S.a)(5)).subscribe(e=>{const[t,o,i,r,s]=e,a=this.processValues(t,o,i,r);this.setValues(a,void 0!==s)})}liftSource(){return this.source$}liftJoinedSource(){const e=[this.source$,Object(I.a)(this.joins.map(e=>e.source))];return Object(I.a)(e).pipe(Object(j.a)(e=>{const[t,o]=e;return t.reduce((e,t)=>{const i=this.computeJoinedValue(t,o);return void 0!==i&&e.push(i),e},[])}))}computeJoinedValue(e,t){let o=e,i=0;for(;void 0!==o&&i<this.joins.length;)o=this.joins[i].reduce(o,t[i]),i+=1;return o}processValues(e,t,o,i){return e=e.slice(0),e=this.filterValues(e,t.concat([o])),this.sortValues(e,i)}filterValues(e,t){return 0===t.length?e:e.filter(e=>t.filter(e=>void 0!==e).every(t=>t(e)))}sortValues(e,t){return void 0===t?e:e.sort((e,o)=>E.naturalCompare(t.valueAccessor(e),t.valueAccessor(o),t.direction,t.nullsFirst))}setValues(e,t){!0===t&&(this._index=this.generateIndex(e)),this.values$.next(e);const o=e.length,i=0===o;this.count$.next(o),this.empty$.next(i)}generateIndex(e){const t=e.map(e=>[this.getKey(e),e]);return new Map(t)}}class at{constructor(e,t={}){this.entities$=new C.a([]),this.count$=new C.a(0),this.empty$=new C.a(!0),this._pristine=!0,this.strategies=[],this.getKey=t.getKey?t.getKey:tt,this.getProperty=t.getProperty?t.getProperty:et,this.state=this.createStateManager(),this.view=this.createDataView(),this.stateView=this.createStateView(),this.view.lift(),this.stateView.lift(),e.length>0?this.load(e):this._index=this.generateIndex(e)}get count(){return this.count$.value}get empty(){return this.empty$.value}get index(){return this._index}get pristine(){return this._pristine}get(e){return this.index.get(e)}all(){return this.entities$.value}load(e,t=!0){this._index=this.generateIndex(e),this._pristine=t,this.next()}softClear(){this.index&&this.index.size>0?(this.index.clear(),this._pristine=!0,this.next()):this.index&&this.updateCount()}clear(){this.stateView.clear(),this.view.clear(),this.state.clear(),this.softClear()}destroy(){this.stateView.destroy(),this.view.destroy(),this.clear()}insert(e){this.insertMany([e])}insertMany(e){e.forEach(e=>this.index.set(this.getKey(e),e)),this._pristine=!1,this.next()}update(e){this.updateMany([e])}updateMany(e){e.forEach(e=>this.index.set(this.getKey(e),e)),this._pristine=!1,this.next()}delete(e){this.deleteMany([e])}deleteMany(e){e.forEach(e=>this.index.delete(this.getKey(e))),this._pristine=!1,this.next()}addStrategy(e,t=!1){if(void 0!==this.strategies.find(t=>e.constructor===t.constructor))throw new Error("A strategy of this type already exists on that EntityStore.");return this.strategies.push(e),e.bindStore(this),!0===t&&e.activate(),this}removeStrategy(e){const t=this.strategies.indexOf(e);return t>=0&&(this.strategies.splice(t,1),e.unbindStore(this)),this}getStrategyOfType(e){return this.strategies.find(t=>t instanceof e)}activateStrategyOfType(e){const t=this.getStrategyOfType(e);void 0!==t&&t.activate()}deactivateStrategyOfType(e){const t=this.getStrategyOfType(e);void 0!==t&&t.deactivate()}generateIndex(e){const t=e.map(e=>[this.getKey(e),e]);return new Map(t)}next(){this.entities$.next(Array.from(this.index.values())),this.updateCount()}updateCount(){const e=this.index.size,t=0===e;this.count$.next(e),this.empty$.next(t)}createStateManager(){return new rt({store:this})}createDataView(){return new st(this.entities$)}createStateView(){return new st(this.view.all$()).join({source:this.state.change$,reduce:e=>{const t=this.getKey(e),o=this.state.get(e),i=this.stateView.get(t);if(void 0!==i&&i.entity===e&&this.statesAreTheSame(i.state,o))return i;const r=i?i.revision+1:1;return{entity:e,state:o,revision:r,ref:`${t}-${r}`}}}).createIndex(e=>this.getKey(e.entity))}statesAreTheSame(e,t){if(e===t)return!0;const o=0===Object.keys(e).length,i=0===Object.keys(t).length;return o&&i}}class nt{constructor(e,t){this.innerStateIndex=new Map,this.setChangeDetector(t),this.setStore(e)}destroy(){this.setChangeDetector(void 0),this.setStore(void 0)}setStore(e){if(void 0===e)return this.teardownObservers(),this.innerStateIndex.clear(),void(this.store=void 0);this.setStore(void 0),this.store=e,this.setupObservers(),this.detectChanges()}setChangeDetector(e){this.cdRef=e}setupObservers(){this.teardownObservers(),this.entities$$=this.store.entities$.subscribe(e=>this.onEntitiesChange(e)),this.state$$=this.store.state.change$.pipe(Object(Le.a)(1)).subscribe(()=>this.onStateChange())}teardownObservers(){void 0!==this.entities$$&&this.entities$$.unsubscribe(),void 0!==this.state$$&&this.state$$.unsubscribe(),this.entities$$=void 0,this.state$$=void 0}onEntitiesChange(e){this.detectChanges()}onStateChange(){let e=!1;const t=this.store.state.index,o=this.innerStateIndex;t.size!==o.size&&(e=this.detectChanges());const i=Array.from(t.keys());for(const r of i){const i=t.get(r),s=o.get(r);!1===e&&(void 0===s?e=this.detectChanges():E.objectsAreEquivalent(i,s)||(e=this.detectChanges())),this.innerStateIndex.set(r,Object.assign({},i))}}detectChanges(){return void 0!==this.cdRef&&this.cdRef.detectChanges(),!0}}class ct{constructor(e={}){this.options=e,this.stores=[],this.active$=new C.a(!1),this.options=e}get active(){return this.active$.value}activate(){!0===this.active&&this.doDeactivate(),this.active$.next(!0),this.doActivate()}deactivate(){this.active$.next(!1),this.doDeactivate()}bindStore(e){this.stores.indexOf(e)<0&&this.stores.push(e)}unbindStore(e){const t=this.stores.indexOf(e);t>=0&&this.stores.splice(t,1)}doActivate(){}doDeactivate(){}}class lt extends ct{constructor(e){super(e),this.options=e,this.filters=new Map}bindStore(e){super.bindStore(e),!0===this.active&&this.filterStore(e)}unbindStore(e){super.unbindStore(e),!0===this.active&&this.unfilterStore(e)}doActivate(){this.filterAll()}doDeactivate(){this.unfilterAll()}filterAll(){this.stores.forEach(e=>this.filterStore(e))}unfilterAll(){this.stores.forEach(e=>this.unfilterStore(e))}filterStore(e){this.filters.set(e,e.stateView.addFilter(this.options.filterClauseFunc))}unfilterStore(e){const t=this.filters.get(e);void 0!==t&&(e.stateView.removeFilter(t),this.filters.delete(e))}}class ut extends ct{constructor(){super(...arguments),this.filters=new Map}bindStore(e){super.bindStore(e),!0===this.active&&this.filterStore(e)}unbindStore(e){super.unbindStore(e),!0===this.active&&this.unfilterStore(e)}doActivate(){this.filterAll()}doDeactivate(){this.unfilterAll()}filterAll(){this.stores.forEach(e=>this.filterStore(e))}unfilterAll(){this.stores.forEach(e=>this.unfilterStore(e))}filterStore(e){this.filters.has(e)||this.filters.set(e,e.stateView.addFilter(e=>!0===e.state.selected))}unfilterStore(e){const t=this.filters.get(e);void 0!==t&&(e.stateView.removeFilter(t),this.filters.delete(e))}}function dt(e,t){if(1&e&&(Object(i.mc)(0,"mat-option",4),Object(i.ad)(1),Object(i.lc)()),2&e){const e=Object(i.xc)();Object(i.Dc)("value",e.emptyValue),Object(i.Tb)(1),Object(i.bd)(e.emptyText)}}function ht(e,t){if(1&e&&(Object(i.mc)(0,"mat-option",4),Object(i.ad)(1),Object(i.yc)(2,"async"),Object(i.lc)()),2&e){const e=Object(i.xc)();Object(i.Dc)("value",e.multiSelectValue),Object(i.Tb)(1),Object(i.bd)(Object(i.zc)(2,2,e.multiText$))}}function pt(e,t){if(1&e&&(Object(i.mc)(0,"mat-option",4),Object(i.ad)(1),Object(i.lc)()),2&e){const e=t.$implicit,o=Object(i.xc)();Object(i.Dc)("value",e.entity),Object(i.Tb)(1),Object(i.cd)(" ",o.titleAccessor(e.entity)," ")}}let mt=(()=>{class e{constructor(e){this.cdRef=e,this.selected$=new C.a(void 0),this.multiText$=new C.a(void 0),this.multiSelectValue={id:"IGO_MULTI_SELECT"},this.emptyValue={id:"IGO_EMPTY_SELECT"},this.titleAccessor=ot,this.emptyText=void 0,this.multi=!1,this.multiAllText="All",this.multiNoneText="None",this.disabled=!1,this.selectedChange=new i.u}ngOnInit(){this.watcher=new nt(this.store,this.cdRef),this.selected$$=this.store.stateView.manyBy$(e=>!0===e.state.selected).subscribe(e=>{const t=e.map(e=>e.entity);this.onSelectFromStore(t)})}ngOnDestroy(){this.watcher.destroy(),this.selected$$.unsubscribe()}onSelectionChange(e){const t=e.value instanceof Array?e.value:[e.value],o=t.find(e=>e===this.multiSelectValue);let i=t.filter(e=>e!==this.multiSelectValue);void 0!==o&&(i.length===this.store.count?i=[]:i.length<this.store.count&&(i=this.store.all())),i=i.filter(e=>e!==this.emptyValue),0===i.length?this.store.state.updateAll({selected:!1}):this.store.state.updateMany(i,{selected:!0},!0),this.selectedChange.emit({selected:!0,value:this.multi?i:e.value})}onSelectFromStore(e){this.selected$.next(!0===this.multi?e:e.length>0?e[0]:void 0),this.updateMultiToggleWithEntities(e)}updateMultiToggleWithEntities(e){e.length===this.store.count&&this.multiText$.value!==this.multiNoneText?this.multiText$.next(this.multiNoneText):e.length<this.store.count&&this.multiText$.value!==this.multiAllText&&this.multiText$.next(this.multiAllText)}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(i.j))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-entity-selector"]],inputs:{store:"store",titleAccessor:"titleAccessor",emptyText:"emptyText",multi:"multi",multiAllText:"multiAllText",multiNoneText:"multiNoneText",placeholder:"placeholder",disabled:"disabled"},outputs:{selectedChange:"selectedChange"},decls:7,vars:11,consts:[[1,"igo-entity-selector"],[3,"disabled","value","multiple","placeholder","selectionChange"],[3,"value",4,"ngIf"],["ngFor","",3,"ngForOf"],[3,"value"]],template:function(e,t){1&e&&(Object(i.mc)(0,"mat-form-field",0),Object(i.mc)(1,"mat-select",1),Object(i.tc)("selectionChange",(function(e){return t.onSelectionChange(e)})),Object(i.yc)(2,"async"),Object(i.Yc)(3,dt,2,2,"mat-option",2),Object(i.Yc)(4,ht,3,4,"mat-option",2),Object(i.Yc)(5,pt,2,2,"ng-template",3),Object(i.yc)(6,"async"),Object(i.lc)(),Object(i.lc)()),2&e&&(Object(i.Tb)(1),Object(i.Dc)("disabled",t.disabled)("value",Object(i.zc)(2,7,t.selected$))("multiple",t.multi)("placeholder",t.placeholder),Object(i.Tb)(2),Object(i.Dc)("ngIf",void 0!==t.emptyText&&!1===t.multi),Object(i.Tb)(1),Object(i.Dc)("ngIf",!0===t.multi),Object(i.Tb)(1),Object(i.Dc)("ngForOf",Object(i.zc)(6,9,t.store.stateView.all$())))},directives:[ke.c,De.a,m.t,m.s,Pe.p],pipes:[m.b],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}"],changeDetection:0}),e})(),gt=(()=>{class e{onClick(e){e.stopPropagation()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Object(i.bc)({type:e,selectors:[["","igoStopPropagation",""]],hostBindings:function(e,t){1&e&&Object(i.tc)("click",(function(e){return t.onClick(e)}))}}),e})(),bt=(()=>{class e{constructor(e,t){this.renderer=e,this.el=t,this.selection=!1,this.selectOnClick=!0,this.highlightSelection=!0,this._selected=!1,this.scrollBehavior=Je.Auto,this.select=new i.u}set selected(e){!1!==this.selection&&e!==this._selected&&(this.toggleSelected(e),this.scroll())}get selected(){return this._selected}onClick(){!1!==this.selection&&!1!==this.selectOnClick&&(this.toggleSelected(!0),this.select.emit(this))}toggleSelected(t){this._selected=t,!0===t?(this.addCls(e.selectedCls),!0===this.highlightSelection&&this.addCls(e.highlightedCls)):(this.removeCls(e.selectedCls),this.removeCls(e.highlightedCls))}scroll(){!0===this._selected&&Object(Re.a)(this.el.nativeElement,{scrollMode:"if-needed",behavior:"smooth",block:"end",inline:"nearest"})}addCls(e){this.renderer.addClass(this.el.nativeElement,e)}removeCls(e){this.renderer.removeClass(this.el.nativeElement,e)}}return e.selectedCls="igo-entity-table-row-selected",e.highlightedCls="igo-entity-table-row-highlighted",e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(i.U),Object(i.gc)(i.r))},e.\u0275dir=Object(i.bc)({type:e,selectors:[["","igoEntityTableRow",""]],hostBindings:function(e,t){1&e&&Object(i.tc)("click",(function(){return t.onClick()}))},inputs:{selection:"selection",selectOnClick:"selectOnClick",highlightSelection:"highlightSelection",selected:"selected",scrollBehavior:"scrollBehavior"},outputs:{select:"select"}}),e})(),ft=(()=>{class e{constructor(e,t){this.languageService=e,this.mediaService=t,this.disabled=!1,this.hidePageSize=!1,this.pageIndex=0,this.pageSize=50,this.pageSizeOptions=[5,10,20,50,100,200],this.showFirstLastButtons=!0,this.paginationLabelTranslation$$=[],this.entitySortChange$=new C.a(!1),this.length=0,this.paginatorChange=new i.u,this.rangeLabel=(e,t,o)=>{const i=new C.a("");if(this.paginationLabelTranslation$$.push(this.languageService.translate.get("igo.common.paginator.of").subscribe(e=>{i.next(e)})),0===o||0===t)return`0 ${i.value} ${o}`;const r=e*t;return`${r+1} - ${r<(o=Math.max(o,0))?Math.min(r+t,o):r+t} ${i.value} ${o}`}}ngOnChanges(){this.unsubscribeAll(),this.count$$=this.store.stateView.count$.subscribe(e=>{this.length=e,this.emitPaginator()}),this.entitySortChange$$=this.entitySortChange$.subscribe(()=>{this.paginator&&this.paginator.firstPage()}),this.initPaginatorOptions(),this.translateLabels()}initPaginatorOptions(){var e,t,o,i,r,s;this.disabled=(null===(e=this.paginatorOptions)||void 0===e?void 0:e.disabled)||this.disabled,this.pageIndex=(null===(t=this.paginatorOptions)||void 0===t?void 0:t.pageIndex)||this.pageIndex,this.pageSize=(null===(o=this.paginatorOptions)||void 0===o?void 0:o.pageSize)||this.pageSize,this.pageSizeOptions=(null===(i=this.paginatorOptions)||void 0===i?void 0:i.pageSizeOptions)||this.pageSizeOptions,this.mediaService.isMobile()?(this.showFirstLastButtons=!1,this.hidePageSize=!0):(this.showFirstLastButtons=(null===(r=this.paginatorOptions)||void 0===r?void 0:r.showFirstLastButtons)||this.showFirstLastButtons,this.hidePageSize=(null===(s=this.paginatorOptions)||void 0===s?void 0:s.hidePageSize)||this.hidePageSize)}translateLabels(){this.paginationLabelTranslation$$.push(this.languageService.translate.get("igo.common.paginator.firstPageLabel").subscribe(e=>{this.paginator._intl.firstPageLabel=e})),this.paginator._intl.getRangeLabel=this.rangeLabel,this.paginationLabelTranslation$$.push(this.languageService.translate.get("igo.common.paginator.itemsPerPageLabel").subscribe(e=>{this.paginator._intl.itemsPerPageLabel=e})),this.paginationLabelTranslation$$.push(this.languageService.translate.get("igo.common.paginator.lastPageLabel").subscribe(e=>{this.paginator._intl.lastPageLabel=e})),this.paginationLabelTranslation$$.push(this.languageService.translate.get("igo.common.paginator.nextPageLabel").subscribe(e=>{this.paginator._intl.nextPageLabel=e})),this.paginationLabelTranslation$$.push(this.languageService.translate.get("igo.common.paginator.previousPageLabel").subscribe(e=>{this.paginator._intl.previousPageLabel=e}))}unsubscribeAll(){this.paginationLabelTranslation$$.map(e=>e.unsubscribe()),this.count$$&&this.count$$.unsubscribe(),this.entitySortChange$$&&this.entitySortChange$$.unsubscribe()}ngOnDestroy(){this.unsubscribeAll()}emitPaginator(){this.paginatorChange.emit(this.paginator)}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(le),Object(i.gc)(be))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-entity-table-paginator"]],viewQuery:function(e,t){var o;1&e&&Object(i.Uc)(Ae.a,!0),2&e&&Object(i.Jc)(o=Object(i.uc)())&&(t.paginator=o.first)},inputs:{entitySortChange$:"entitySortChange$",store:"store",paginatorOptions:"paginatorOptions"},outputs:{page:"page",paginatorChange:"paginatorChange"},features:[i.Rb],decls:1,vars:7,consts:[[3,"disabled","hidePageSize","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons","page"]],template:function(e,t){1&e&&(Object(i.mc)(0,"mat-paginator",0),Object(i.tc)("page",(function(){return t.emitPaginator()})),Object(i.lc)()),2&e&&Object(i.Dc)("disabled",t.disabled)("hidePageSize",t.hidePageSize)("length",t.length)("pageIndex",t.pageIndex)("pageSize",t.pageSize)("pageSizeOptions",t.pageSizeOptions)("showFirstLastButtons",t.showFirstLastButtons)},directives:[Ae.a],styles:["[_nghost-%COMP%]{margin-top:-10px;padding-right:15px}@media only screen and (orientation:landscape) and (max-width:959px),only screen and (orientation:portrait) and (max-width:599px){[_nghost-%COMP%]{margin-top:0;padding-right:5px}}"],changeDetection:0}),e})(),yt=(()=>{class e{constructor(e){this.http=e}transform(e){const t=new y.f({"Content-Type":"text/plain",activityInterceptor:"false"});return this.http.get(e,{headers:t,responseType:"blob"}).pipe(Object(Ie.a)(e=>new xe.a(t=>{const o=new FileReader;o.readAsDataURL(e),o.onloadend=()=>{t.next(o.result),t.complete()}})))}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(y.b))},e.\u0275pipe=Object(i.fc)({name:"secureImage",type:e,pure:!0}),Object(_e.b)([Object(ze.a)({maxCacheCount:20}),Object(_e.c)("design:type",Function),Object(_e.c)("design:paramtypes",[String]),Object(_e.c)("design:returntype",xe.a)],e.prototype,"transform",null),e})(),Ot=(()=>{class e{constructor(e){this._sanitizer=e}transform(e){return this._sanitizer.bypassSecurityTrustHtml(e)}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(s.b))},e.\u0275pipe=Object(i.fc)({name:"sanitizeHtml",type:e,pure:!0}),e})();function vt(e,t){if(1&e){const e=Object(i.nc)();Object(i.kc)(0),Object(i.mc)(1,"mat-checkbox",11),Object(i.tc)("change",(function(t){return Object(i.Nc)(e),Object(i.xc)(3).onToggleRows(t.checked)})),Object(i.lc)(),Object(i.jc)()}if(2&e){const e=t.ngIf,o=Object(i.xc)(3);Object(i.Tb)(1),Object(i.Dc)("checked",e===o.entityTableSelectionState.All)("indeterminate",e===o.entityTableSelectionState.Some)}}function jt(e,t){if(1&e&&(Object(i.kc)(0),Object(i.Yc)(1,vt,2,2,"ng-container",10),Object(i.yc)(2,"async"),Object(i.jc)()),2&e){const e=Object(i.xc)(2);Object(i.Tb)(1),Object(i.Dc)("ngIf",Object(i.zc)(2,1,e.selectionState$))}}function wt(e,t){if(1&e&&(Object(i.mc)(0,"th",9),Object(i.Yc)(1,jt,3,3,"ng-container",10),Object(i.lc)()),2&e){const e=Object(i.xc)();Object(i.Tb)(1),Object(i.Dc)("ngIf",e.selectMany)}}function St(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"td",12),Object(i.mc)(1,"mat-checkbox",13),Object(i.tc)("mousedown",(function(t){return Object(i.Nc)(e),t.shiftKey?t.preventDefault():null}))("click",(function(o){Object(i.Nc)(e);const r=t.$implicit,s=Object(i.xc)();return o.shiftKey?s.onShiftToggleRow(!s.rowIsSelected(r),r,o):o.stopPropagation()}))("change",(function(o){Object(i.Nc)(e);const r=t.$implicit;return Object(i.xc)().onToggleRow(o.checked,r)})),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=t.$implicit,o=Object(i.xc)();Object(i.Tb)(1),Object(i.Dc)("checked",o.rowIsSelected(e))}}function xt(e,t){if(1&e&&(Object(i.mc)(0,"th",16),Object(i.ad)(1),Object(i.lc)()),2&e){const e=Object(i.xc)(2).$implicit;Object(i.Tb)(1),Object(i.cd)(" ",e.title," ")}}function Ct(e,t){1&e&&(Object(i.kc)(0),Object(i.Yc)(1,xt,2,1,"th",15),Object(i.jc)())}function Tt(e,t){if(1&e&&(Object(i.mc)(0,"th",9),Object(i.ad)(1),Object(i.lc)()),2&e){const e=Object(i.xc)(2).$implicit;Object(i.Tb)(1),Object(i.cd)(" ",e.title," ")}}function Lt(e,t){1&e&&(Object(i.kc)(0),Object(i.Yc)(1,Tt,2,1,"th",3),Object(i.jc)())}function It(e,t){if(1&e&&(Object(i.mc)(0,"td",20),Object(i.ad)(1),Object(i.lc)()),2&e){const e=Object(i.xc)().$implicit,t=Object(i.xc)(3).$implicit,o=Object(i.xc)();Object(i.Dc)("ngClass",o.getCellClass(e,t)),Object(i.Tb)(1),Object(i.cd)(" ",o.getValue(e,t)," ")}}function Ft(e,t){if(1&e&&(Object(i.hc)(0,"img",24),Object(i.yc)(1,"async"),Object(i.yc)(2,"secureImage")),2&e){const e=Object(i.xc)(2).$implicit,t=Object(i.xc)(3).$implicit,o=Object(i.xc)();Object(i.Ec)("src",Object(i.zc)(1,1,Object(i.zc)(2,3,o.getValue(e,t))),i.Qc)}}function Mt(e,t){1&e&&(Object(i.mc)(0,"span"),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()),2&e&&(Object(i.Tb)(1),Object(i.cd)("",Object(i.zc)(2,1,"igo.common.entity-table.targetHtmlUrl")," "))}function kt(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"td",20),Object(i.mc)(1,"a",21),Object(i.tc)("click",(function(t){return Object(i.Nc)(e),t.stopPropagation()})),Object(i.Yc)(2,Ft,3,5,"img",22),Object(i.Yc)(3,Mt,3,3,"ng-template",null,23,i.Zc),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=Object(i.Kc)(4),t=Object(i.xc)().$implicit,o=Object(i.xc)(3).$implicit,r=Object(i.xc)();Object(i.Dc)("ngClass",r.getCellClass(t,o)),Object(i.Tb)(1),Object(i.Ec)("href",r.getValue(t,o),i.Qc),Object(i.Tb)(1),Object(i.Dc)("ngIf",r.isImg(r.getValue(t,o)))("ngIfElse",e)}}function Dt(e,t){if(1&e&&(Object(i.kc)(0),Object(i.Yc)(1,It,2,2,"td",18),Object(i.Yc)(2,kt,5,4,"ng-template",null,19,i.Zc),Object(i.jc)()),2&e){const e=t.$implicit,o=Object(i.Kc)(3),r=Object(i.xc)(3).$implicit,s=Object(i.xc)();Object(i.Tb)(1),Object(i.Dc)("ngIf",!s.isUrl(s.getValue(e,r)))("ngIfElse",o)}}function Pt(e,t){1&e&&(Object(i.kc)(0),Object(i.Yc)(1,Dt,4,2,"ng-container",17),Object(i.jc)())}function At(e,t){if(1&e&&Object(i.hc)(0,"td",27),2&e){const e=Object(i.xc)().$implicit,t=Object(i.xc)(3).$implicit,o=Object(i.xc)();Object(i.Dc)("ngClass",o.getCellClass(e,t))("innerHTML",o.getValue(e,t),i.Oc)}}function $t(e,t){if(1&e&&(Object(i.hc)(0,"img",24),Object(i.yc)(1,"async"),Object(i.yc)(2,"secureImage")),2&e){const e=Object(i.xc)(2).$implicit,t=Object(i.xc)(3).$implicit,o=Object(i.xc)();Object(i.Ec)("src",Object(i.zc)(1,1,Object(i.zc)(2,3,o.getValue(e,t))),i.Qc)}}function Et(e,t){1&e&&(Object(i.mc)(0,"span"),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()),2&e&&(Object(i.Tb)(1),Object(i.cd)("",Object(i.zc)(2,1,"igo.geo.targetHtmlUrl")," "))}function Rt(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"td",20),Object(i.mc)(1,"a",21),Object(i.tc)("click",(function(t){return Object(i.Nc)(e),t.stopPropagation()})),Object(i.Yc)(2,$t,3,5,"img",22),Object(i.Yc)(3,Et,3,3,"ng-template",null,23,i.Zc),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=Object(i.Kc)(4),t=Object(i.xc)().$implicit,o=Object(i.xc)(3).$implicit,r=Object(i.xc)();Object(i.Dc)("ngClass",r.getCellClass(t,o)),Object(i.Tb)(1),Object(i.Ec)("href",r.getValue(t,o),i.Qc),Object(i.Tb)(1),Object(i.Dc)("ngIf",r.isImg(r.getValue(t,o)))("ngIfElse",e)}}function _t(e,t){if(1&e&&(Object(i.kc)(0),Object(i.Yc)(1,At,1,2,"td",25),Object(i.Yc)(2,Rt,5,4,"ng-template",null,26,i.Zc),Object(i.jc)()),2&e){const e=t.$implicit,o=Object(i.Kc)(3),r=Object(i.xc)(3).$implicit,s=Object(i.xc)();Object(i.Tb)(1),Object(i.Dc)("ngIf",!s.isUrl(s.getValue(e,r)))("ngIfElse",o)}}function zt(e,t){1&e&&(Object(i.kc)(0),Object(i.Yc)(1,_t,4,2,"ng-container",17),Object(i.jc)())}function Nt(e,t){if(1&e&&(Object(i.hc)(0,"td",27),Object(i.yc)(1,"sanitizeHtml")),2&e){const e=Object(i.xc)().$implicit,t=Object(i.xc)(3).$implicit,o=Object(i.xc)();Object(i.Dc)("ngClass",o.getCellClass(e,t))("innerHTML",Object(i.zc)(1,2,o.getValue(e,t)),i.Oc)}}function Bt(e,t){if(1&e&&(Object(i.hc)(0,"img",24),Object(i.yc)(1,"async"),Object(i.yc)(2,"secureImage")),2&e){const e=Object(i.xc)(2).$implicit,t=Object(i.xc)(3).$implicit,o=Object(i.xc)();Object(i.Ec)("src",Object(i.zc)(1,1,Object(i.zc)(2,3,o.getValue(e,t))),i.Qc)}}function qt(e,t){1&e&&(Object(i.mc)(0,"span"),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()),2&e&&(Object(i.Tb)(1),Object(i.cd)("",Object(i.zc)(2,1,"igo.geo.targetHtmlUrl")," "))}function Gt(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"td",20),Object(i.mc)(1,"a",21),Object(i.tc)("click",(function(t){return Object(i.Nc)(e),t.stopPropagation()})),Object(i.Yc)(2,Bt,3,5,"img",22),Object(i.Yc)(3,qt,3,3,"ng-template",null,23,i.Zc),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=Object(i.Kc)(4),t=Object(i.xc)().$implicit,o=Object(i.xc)(3).$implicit,r=Object(i.xc)();Object(i.Dc)("ngClass",r.getCellClass(t,o)),Object(i.Tb)(1),Object(i.Ec)("href",r.getValue(t,o),i.Qc),Object(i.Tb)(1),Object(i.Dc)("ngIf",r.isImg(r.getValue(t,o)))("ngIfElse",e)}}function Vt(e,t){if(1&e&&(Object(i.kc)(0),Object(i.Yc)(1,Nt,2,4,"td",25),Object(i.Yc)(2,Gt,5,4,"ng-template",null,28,i.Zc),Object(i.jc)()),2&e){const e=t.$implicit,o=Object(i.Kc)(3),r=Object(i.xc)(3).$implicit,s=Object(i.xc)();Object(i.Tb)(1),Object(i.Dc)("ngIf",!s.isUrl(s.getValue(e,r)))("ngIfElse",o)}}function Ut(e,t){1&e&&(Object(i.kc)(0),Object(i.Yc)(1,Vt,4,2,"ng-container",17),Object(i.jc)())}function Ht(e,t){if(1&e&&(Object(i.mc)(0,"td",20),Object(i.hc)(1,"mat-icon",30),Object(i.lc)()),2&e){const e=t.$implicit,o=Object(i.xc)(3).$implicit,r=Object(i.xc)();Object(i.Dc)("ngClass",r.getCellClass(e,o)),Object(i.Tb)(1),Object(i.Ec)("svgIcon",r.getValue(e,o))}}function Yt(e,t){1&e&&(Object(i.kc)(0),Object(i.Yc)(1,Ht,2,2,"td",29),Object(i.jc)())}function Wt(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",34),Object(i.tc)("click",(function(){Object(i.Nc)(e);const t=Object(i.xc)().$implicit,o=Object(i.xc)().$implicit;return Object(i.xc)(4).onButtonClick(t.click,o)})),Object(i.hc)(1,"mat-icon",30),Object(i.lc)()}if(2&e){const e=Object(i.xc)().$implicit;Object(i.Dc)("color",e.color),Object(i.Tb)(1),Object(i.Ec)("svgIcon",e.icon)}}function Kt(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",35),Object(i.tc)("click",(function(){Object(i.Nc)(e);const t=Object(i.xc)().$implicit,o=Object(i.xc)().$implicit;return Object(i.xc)(4).onButtonClick(t.click,o)})),Object(i.hc)(1,"mat-icon",30),Object(i.lc)()}if(2&e){const e=Object(i.xc)().$implicit;Object(i.Dc)("color",e.color),Object(i.Tb)(1),Object(i.Ec)("svgIcon",e.icon)}}function Zt(e,t){if(1&e&&(Object(i.mc)(0,"span"),Object(i.Yc)(1,Wt,2,2,"button",32),Object(i.Yc)(2,Kt,2,2,"button",33),Object(i.lc)()),2&e){const e=t.$implicit;Object(i.Tb)(1),Object(i.Dc)("ngIf","mat-icon-button"===e.style),Object(i.Tb)(1),Object(i.Dc)("ngIf","mat-icon-button"!==e.style)}}function Qt(e,t){if(1&e&&(Object(i.mc)(0,"td",20),Object(i.Yc)(1,Zt,3,2,"span",31),Object(i.lc)()),2&e){const e=t.$implicit,o=Object(i.xc)(3).$implicit,r=Object(i.xc)();Object(i.Dc)("ngClass",r.getCellClass(e,o)),Object(i.Tb)(1),Object(i.Dc)("ngForOf",r.getValue(e,o))}}function Jt(e,t){1&e&&(Object(i.kc)(0),Object(i.Yc)(1,Qt,2,2,"td",29),Object(i.jc)())}function Xt(e,t){if(1&e&&(Object(i.kc)(0),Object(i.Yc)(1,Pt,2,0,"ng-container",10),Object(i.Yc)(2,zt,2,0,"ng-container",10),Object(i.Yc)(3,Ut,2,0,"ng-container",10),Object(i.Yc)(4,Yt,2,0,"ng-container",10),Object(i.Yc)(5,Jt,2,0,"ng-container",10),Object(i.jc)()),2&e){const e=t.ngIf,o=Object(i.xc)(2);Object(i.Tb)(1),Object(i.Dc)("ngIf",e===o.entityTableColumnRenderer.Default),Object(i.Tb)(1),Object(i.Dc)("ngIf",e===o.entityTableColumnRenderer.HTML),Object(i.Tb)(1),Object(i.Dc)("ngIf",e===o.entityTableColumnRenderer.UnsanitizedHTML),Object(i.Tb)(1),Object(i.Dc)("ngIf",e===o.entityTableColumnRenderer.Icon),Object(i.Tb)(1),Object(i.Dc)("ngIf",e===o.entityTableColumnRenderer.ButtonGroup)}}function eo(e,t){if(1&e&&(Object(i.kc)(0,14),Object(i.Yc)(1,Ct,2,0,"ng-container",10),Object(i.Yc)(2,Lt,2,0,"ng-container",10),Object(i.Yc)(3,Xt,6,5,"ng-container",10),Object(i.jc)()),2&e){const e=t.$implicit,o=Object(i.xc)();Object(i.Dc)("matColumnDef",e.name),Object(i.Tb)(1),Object(i.Dc)("ngIf",o.columnIsSortable(e)),Object(i.Tb)(1),Object(i.Dc)("ngIf",!o.columnIsSortable(e)),Object(i.Tb)(1),Object(i.Dc)("ngIf",o.getColumnRenderer(e))}}function to(e,t){if(1&e&&Object(i.hc)(0,"tr",36),2&e){const e=Object(i.xc)();Object(i.Dc)("ngClass",e.getHeaderClass())}}function oo(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"tr",37),Object(i.tc)("select",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)().onRowSelect(o)}))("click",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)().onRowClick(o)})),Object(i.lc)()}if(2&e){const e=t.$implicit,o=Object(i.xc)();Object(i.Dc)("scrollBehavior",o.scrollBehavior)("ngClass",o.getRowClass(e))("selection",o.selection)("selected",o.rowIsSelected(e))}}function io(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"igo-entity-table-paginator",38),Object(i.tc)("paginatorChange",(function(t){return Object(i.Nc)(e),Object(i.xc)().paginatorChange(t)})),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Dc)("store",e.store)("paginatorOptions",e.paginatorOptions)("entitySortChange$",e.entitySortChange$)}}let ro=(()=>{class e{constructor(e){this.cdRef=e,this.entitySortChange$=new C.a(!1),this.entityTableColumnRenderer=Qe,this.entityTableSelectionState=Xe,this.selectionState$=new C.a(void 0),this.scrollBehavior=Je.Auto,this.sortNullsFirst=!1,this.withPaginator=!1,this.entityClick=new i.u,this.entitySelectChange=new i.u,this.entitySortChange=new i.u(void 0),this.dataSource=new $e.p}set paginator(e){this._paginator=e,this.dataSource.paginator=e}get paginator(){return this._paginator}get headers(){let e=this.template.columns.filter(e=>!1!==e.visible).map(e=>e.name);return!0===this.selectionCheckbox&&(e=["selectionCheckbox"].concat(e)),e}get selection(){return this.template.selection||!1}get selectionCheckbox(){return this.template.selectionCheckbox||!1}get selectMany(){return this.template.selectMany||!1}get fixedHeader(){return void 0===this.template.fixedHeader||this.template.fixedHeader}ngOnInit(){this.handleDatasource(),this.dataSource.paginator=this.paginator}ngOnChanges(e){const t=e.store;t&&t.currentValue!==t.previousValue&&this.handleDatasource()}handleDatasource(){this.unsubscribeStore(),this.selection$$=this.store.stateView.manyBy$(e=>!0===e.state.selected).subscribe(e=>{const t=e[0],o=this.store.stateView.all().indexOf(t),i=this.paginator?this.paginator.pageSize*(this.paginator.pageIndex+1):0;if(this.paginator&&(o<(this.paginator?i-this.paginator.pageSize:0)||o>=i)){const e=Math.floor(o/this.paginator.pageSize);this.dataSource.paginator.pageIndex=e}this.selectionState$.next(this.computeSelectionState(e))}),this.dataSource$$=this.store.stateView.all$().subscribe(e=>{this.dataSource.data=e})}ngOnDestroy(){this.unsubscribeStore()}unsubscribeStore(){this.selection$$&&this.selection$$.unsubscribe(),this.dataSource$$&&this.dataSource$$.unsubscribe()}getTrackByFunction(){return(e,t)=>t.ref}refresh(){this.cdRef.detectChanges()}paginatorChange(e){this.paginator=e}onSort(e){const t=e.direction,o=this.template.columns.find(t=>t.name===e.active);"asc"===t||"desc"===t?(this.store.stateView.sort({valueAccessor:e=>this.getValue(e,o),direction:t,nullsFirst:this.sortNullsFirst}),this.entitySortChange.emit({column:o,direction:t}),this.entitySortChange$.next(!0)):this.store.stateView.sort(void 0)}onRowClick(e){this.lastRecordCheckedKey=this.store.stateView.getKey(e),this.entityClick.emit(e.entity)}onRowSelect(e){if(!1===this.selection)return;const t=e.entity;this.store.state.update(t,{selected:!0},!0),this.entitySelectChange.emit({added:[t]})}onToggleRows(e){if(!1!==this.selection&&(this.store.state.updateAll({selected:e}),!0===e)){const e=this.store.stateView.all().map(e=>e.entity);this.entitySelectChange.emit({added:[e]})}}onToggleRow(e,t){if(!1===this.selection)return;const o=t.entity;this.store.state.update(o,{selected:e},!0===e&&!this.selectMany),!0===e&&this.entitySelectChange.emit({added:[o]}),this.lastRecordCheckedKey=this.store.stateView.getKey(t)}onShiftToggleRow(e,t,o){if(!1===this.selection)return;if(!1===this.selectMany||void 0===this.lastRecordCheckedKey)return void this.onToggleRow(e,t);const i=window.document.createRange();i.selectNode(o.target),window.getSelection().removeAllRanges(),window.getSelection().addRange(i),o.stopImmediatePropagation();const r=this.store.stateView.all(),s=r.indexOf(t),a=this.store.stateView.get(this.lastRecordCheckedKey),n=[s,r.indexOf(a)],c=r.slice(Math.min(...n),Math.max(...n)+1).map(e=>e.entity);this.store.state.updateMany(c,{selected:e}),!0===e&&this.entitySelectChange.emit({added:c}),this.lastRecordCheckedKey=this.store.stateView.getKey(t)}computeSelectionState(e){const t=e.length;return 0===t?Xe.None:t===this.store.stateView.count?Xe.All:Xe.Some}columnIsSortable(e){let t=e.sort;return void 0===t&&(t=void 0!==this.template.sort&&this.template.sort),t}rowIsSelected(e){const t=e.state;return!!t.selected&&t.selected}isImg(e){return!!this.isUrl(e)&&-1!==["jpg","png","gif"].indexOf(e.split(".").pop().toLowerCase())}isUrl(e){return"string"==typeof e&&("https://"===e.slice(0,8)||"http://"===e.slice(0,7))}getValue(e,t){const o=e.entity;return void 0!==t.valueAccessor?t.valueAccessor(o,e):void 0!==this.template.valueAccessor?this.template.valueAccessor(o,t.name,e):this.store.getProperty(o,t.name)}getColumnRenderer(e){return void 0!==e.renderer?e.renderer:Qe.Default}getTableClass(){return{"igo-entity-table-with-selection":this.selection}}getHeaderClass(){const e=this.template.headerClassFunc;return e instanceof Function?e():{}}getRowClass(e){const t=this.template.rowClassFunc;return t instanceof Function?t(e.entity,e):{}}getCellClass(e,t){const o=e.entity,i={},r=this.template.cellClassFunc;r instanceof Function&&Object.assign(i,r(o,t,e));const s=t.cellClassFunc;return s instanceof Function&&Object.assign(i,s(o,e)),i}onButtonClick(e,t){"function"==typeof e&&e(t.entity,t)}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(i.j))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-entity-table"]],inputs:{store:"store",paginator:"paginator",template:"template",scrollBehavior:"scrollBehavior",sortNullsFirst:"sortNullsFirst",withPaginator:"withPaginator",paginatorOptions:"paginatorOptions"},outputs:{entityClick:"entityClick",entitySelectChange:"entitySelectChange",entitySortChange:"entitySortChange"},features:[i.Rb],decls:9,vars:8,consts:[[1,"table-container"],["mat-table","","matSort","",3,"ngClass","dataSource","trackBy","matSortChange"],["matColumnDef","selectionCheckbox",1,"mat-cell-checkbox"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],[3,"matColumnDef",4,"ngFor","ngForOf"],["mat-header-row","",3,"ngClass",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","igoEntityTableRow","",3,"scrollBehavior","ngClass","selection","selected","select","click",4,"matRowDef","matRowDefColumns"],[3,"store","paginatorOptions","entitySortChange$","paginatorChange",4,"ngIf"],["mat-header-cell",""],[4,"ngIf"],[3,"checked","indeterminate","change"],["mat-cell",""],[3,"checked","mousedown","click","change"],[3,"matColumnDef"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-header-cell","","mat-sort-header",""],[4,"matCellDef"],["mat-cell","","class","mat-cell-text",3,"ngClass",4,"ngIf","ngIfElse"],["isAnUrlDefault",""],["mat-cell","",1,"mat-cell-text",3,"ngClass"],["target","_blank","rel","noopener noreferrer",3,"href","click"],["width","50","heigth","auto",3,"src",4,"ngIf","ngIfElse"],["notImg",""],["width","50","heigth","auto",3,"src"],["mat-cell","","class","mat-cell-text",3,"ngClass","innerHTML",4,"ngIf","ngIfElse"],["isAnUrlHTML",""],["mat-cell","",1,"mat-cell-text",3,"ngClass","innerHTML"],["isAnUrlUnsanitizedHTML",""],["mat-cell","","class","mat-cell-text",3,"ngClass",4,"matCellDef"],[3,"svgIcon"],[4,"ngFor","ngForOf"],["igoStopPropagation","","mat-icon-button","",3,"color","click",4,"ngIf"],["igoStopPropagation","","mat-mini-fab","",3,"color","click",4,"ngIf"],["igoStopPropagation","","mat-icon-button","",3,"color","click"],["igoStopPropagation","","mat-mini-fab","",3,"color","click"],["mat-header-row","",3,"ngClass"],["mat-row","","igoEntityTableRow","",3,"scrollBehavior","ngClass","selection","selected","select","click"],[3,"store","paginatorOptions","entitySortChange$","paginatorChange"]],template:function(e,t){1&e&&(Object(i.mc)(0,"div",0),Object(i.mc)(1,"table",1),Object(i.tc)("matSortChange",(function(e){return t.onSort(e)})),Object(i.kc)(2,2),Object(i.Yc)(3,wt,2,1,"th",3),Object(i.Yc)(4,St,2,1,"td",4),Object(i.jc)(),Object(i.Yc)(5,eo,4,4,"ng-container",5),Object(i.Yc)(6,to,1,1,"tr",6),Object(i.Yc)(7,oo,1,4,"tr",7),Object(i.lc)(),Object(i.Yc)(8,io,1,3,"igo-entity-table-paginator",8),Object(i.lc)()),2&e&&(Object(i.Tb)(1),Object(i.Dc)("ngClass",t.getTableClass())("dataSource",t.dataSource)("trackBy",t.getTrackByFunction()),Object(i.Tb)(4),Object(i.Dc)("ngForOf",t.template.columns),Object(i.Tb)(1),Object(i.Dc)("matHeaderRowDef",t.headers)("matHeaderRowDefSticky",t.fixedHeader),Object(i.Tb)(1),Object(i.Dc)("matRowDefColumns",t.headers),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.withPaginator))},directives:[$e.o,Ee.a,m.q,$e.c,$e.i,$e.b,m.s,$e.k,$e.n,m.t,$e.h,b.a,$e.a,Ee.b,c.a,n.b,gt,$e.j,$e.m,bt,ft],pipes:[m.b,yt,q.e,Ot],styles:["[_nghost-%COMP%]{display:block;height:100%;width:100%}.table-compact[_nghost-%COMP%]     .mat-checkbox .mat-checkbox-ripple, .table-compact[_nghost-%COMP%]   tr.mat-header-row[_ngcontent-%COMP%]{height:36px}.table-compact[_nghost-%COMP%]     .mat-checkbox .mat-checkbox-ripple, .table-compact[_nghost-%COMP%]   tr.mat-row[_ngcontent-%COMP%]{height:28px}.table-container[_ngcontent-%COMP%]{display:flex;flex:1 1 auto;flex-direction:column;height:100%;overflow:auto}.mat-cell-text[_ngcontent-%COMP%]{overflow:hidden;word-wrap:break-word}td.mat-cell[_ngcontent-%COMP%], td.mat-footer-cell[_ngcontent-%COMP%], th.mat-header-cell[_ngcontent-%COMP%]{padding:0 3px}entity-table[_ngcontent-%COMP%]   table.igo-entity-table-with-selection[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{-o-box-shadow:2px 0 2px 0 #ddd;box-shadow:2px 0 2px 0 #ddd;cursor:pointer}table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:7px}"],changeDetection:0}),e})();var so=function(e){return e.Dock="dock",e.Overlay="overlay",e.Context="context",e}({});class ao extends at{}function no(e,t){if(1&e&&(Object(i.hc)(0,"mat-icon",7),Object(i.yc)(1,"async")),2&e){const e=Object(i.xc)(3);Object(i.Ec)("svgIcon",Object(i.zc)(1,1,e.icon$))}}function co(e,t){if(1&e&&(Object(i.mc)(0,"button",5),Object(i.yc)(1,"async"),Object(i.Yc)(2,no,2,3,"mat-icon",6),Object(i.lc)()),2&e){const e=Object(i.xc)(2);Object(i.Dc)("color",e.color)("disabled",Object(i.zc)(1,3,e.disabled$)),Object(i.Tb)(2),Object(i.Dc)("ngIf",e.withIcon)}}function lo(e,t){if(1&e&&(Object(i.mc)(0,"h4",8),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()),2&e){const e=Object(i.xc)(2);Object(i.Tb)(1),Object(i.bd)(Object(i.zc)(2,1,e.title))}}function uo(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"mat-list-item",2),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.xc)().onClick()})),Object(i.yc)(1,"translate"),Object(i.yc)(2,"async"),Object(i.yc)(3,"async"),Object(i.Yc)(4,co,3,5,"button",3),Object(i.Yc)(5,lo,3,3,"h4",4),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Dc)("matTooltip",e.withTooltip?Object(i.zc)(1,4,Object(i.zc)(2,6,e.tooltip$)||e.title):"")("ngClass",Object(i.zc)(3,8,e.ngClass$)),Object(i.Tb)(4),Object(i.Dc)("ngIf",e.withIcon),Object(i.Tb)(1),Object(i.Dc)("ngIf",e.withTitle)}}function ho(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"mat-checkbox",11),Object(i.tc)("change",(function(){return Object(i.Nc)(e),Object(i.xc)(2).action.handler()})),Object(i.yc)(1,"async"),Object(i.ad)(2),Object(i.yc)(3,"translate"),Object(i.lc)()}if(2&e){const e=Object(i.xc)(2);Object(i.Dc)("checked",Object(i.zc)(1,2,e.checkCondition$)),Object(i.Tb)(2),Object(i.cd)(" ",Object(i.zc)(3,4,e.title)," ")}}function po(e,t){if(1&e&&(Object(i.mc)(0,"mat-list-item",9),Object(i.yc)(1,"translate"),Object(i.yc)(2,"async"),Object(i.yc)(3,"async"),Object(i.Yc)(4,ho,4,6,"mat-checkbox",10),Object(i.lc)()),2&e){const e=Object(i.xc)();Object(i.Dc)("matTooltip",e.withTooltip?Object(i.zc)(1,3,Object(i.zc)(2,5,e.tooltip$)||e.title):"")("ngClass",Object(i.zc)(3,7,e.ngClass$)),Object(i.Tb)(4),Object(i.Dc)("ngIf",e.withTitle)}}let mo=(()=>{class e{constructor(){this.disabled$=new C.a(!1),this.checkCondition$=new C.a(void 0),this.icon$=new C.a(void 0),this.tooltip$=new C.a(void 0),this.noDisplay$=new C.a(!1),this.ngClass$=new C.a({}),this.color="default",this.withTitle=!0,this.withIcon=!0,this.withTooltip=!0,this.trigger=new i.u}set disabled(e){this.disabled$.next(e)}get disabled(){return this.disabled$.value}set noDisplay(e){this.noDisplay$.next(e)}get noDisplay(){return this.noDisplay$.value}get title(){return this.action.title}ngOnInit(){const e=this.action.args||[];void 0!==this.action.ngClass&&(this.ngClass$$=this.action.ngClass(...e).subscribe(e=>this.updateNgClass(e))),Object(Ce.a)(this.action.icon)?this.icon$$=this.action.icon.subscribe(e=>this.updateIcon(e)):this.updateIcon(this.action.icon),Object(Ce.a)(this.action.checkCondition)?this.checkCondition$$=this.action.checkCondition.subscribe(e=>this.updateCheckCondition(e)):this.updateCheckCondition(this.action.checkCondition),Object(Ce.a)(this.action.tooltip)?this.tooltip$$=this.action.tooltip.subscribe(e=>this.updateTooltip(e)):this.updateTooltip(this.action.tooltip),void 0!==this.action.availability&&(this.availability$$=this.action.availability(...e).subscribe(e=>this.disabled=!e)),this.disabled$$=this.disabled$.subscribe(e=>this.updateNgClass({"igo-actionbar-item-disabled":e})),void 0!==this.action.display&&(this.display$$=this.action.display(...e).subscribe(e=>this.noDisplay=!e)),this.noDisplay$$=this.noDisplay$.subscribe(e=>this.updateNgClass({"igo-actionbar-item-no-display":e}))}ngOnDestroy(){void 0!==this.ngClass$$&&(this.ngClass$$.unsubscribe(),this.ngClass$$=void 0),void 0!==this.availability$$&&(this.availability$$.unsubscribe(),this.availability$$=void 0),void 0!==this.display$$&&(this.display$$.unsubscribe(),this.display$$=void 0),void 0!==this.checkCondition$$&&(this.checkCondition$$.unsubscribe(),this.checkCondition$$=void 0),void 0!==this.icon$$&&(this.icon$$.unsubscribe(),this.icon$$=void 0),void 0!==this.tooltip$$&&(this.tooltip$$.unsubscribe(),this.tooltip$$=void 0),this.disabled$$.unsubscribe(),this.noDisplay$$.unsubscribe()}onClick(){!0!==this.disabled&&this.trigger.emit(this.action)}updateNgClass(e){this.ngClass$.next(Object.assign({},this.ngClass$.value,e))}updateTooltip(e){this.tooltip$.next(e)}updateCheckCondition(e){this.checkCondition$.next(e)}updateIcon(e){this.icon$.next(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-actionbar-item"]],inputs:{action:"action",color:"color",withTitle:"withTitle",withIcon:"withIcon",withTooltip:"withTooltip",disabled:"disabled",noDisplay:"noDisplay"},outputs:{trigger:"trigger"},decls:2,vars:2,consts:[["matTooltipClass","actionbarItemTooltip","matTooltipShowDelay","500",3,"matTooltip","ngClass","click",4,"ngIf"],["class","item-checkbox","matTooltipClass","actionbarItemTooltip","matTooltipShowDelay","500",3,"matTooltip","ngClass",4,"ngIf"],["matTooltipClass","actionbarItemTooltip","matTooltipShowDelay","500",3,"matTooltip","ngClass","click"],["mat-list-avatar","","mat-icon-button","",3,"color","disabled",4,"ngIf"],["matLine","",4,"ngIf"],["mat-list-avatar","","mat-icon-button","",3,"color","disabled"],[3,"svgIcon",4,"ngIf"],[3,"svgIcon"],["matLine",""],["matTooltipClass","actionbarItemTooltip","matTooltipShowDelay","500",1,"item-checkbox",3,"matTooltip","ngClass"],[3,"checked","change",4,"ngIf"],[3,"checked","change"]],template:function(e,t){1&e&&(Object(i.Yc)(0,uo,6,10,"mat-list-item",0),Object(i.Yc)(1,po,5,9,"mat-list-item",1)),2&e&&(Object(i.Dc)("ngIf",!t.action.checkbox),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.action.checkbox))},directives:[m.t,l.d,h.a,m.q,n.b,l.b,c.a,Pe.l,b.a],pipes:[q.e,m.b],styles:["mat-list-item.igo-actionbar-item-disabled[_ngcontent-%COMP%]{color:rgba(0,0,0,.26);cursor:default!important}mat-list-item.igo-actionbar-item-no-display[_ngcontent-%COMP%]{display:none}mat-checkbox[_ngcontent-%COMP%]{padding:12px}.item-checkbox[_ngcontent-%COMP%]{height:56px}.item-checkbox[_ngcontent-%COMP%]     .mat-checkbox-label{margin-left:20px}"],changeDetection:0}),e})();function go(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"div",5),Object(i.mc)(1,"button",6),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.xc)(2).scrollUp()})),Object(i.yc)(2,"translate"),Object(i.hc)(3,"mat-icon",7),Object(i.lc)(),Object(i.lc)()}2&e&&(Object(i.Tb)(1),Object(i.Dc)("matTooltip",Object(i.zc)(2,1,"igo.common.actionbar.scrollUp")))}function bo(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"igo-actionbar-item",8),Object(i.tc)("trigger",(function(){Object(i.Nc)(e);const t=Object(i.xc)(2);return t.onTriggerAction(t.toggleCollapseAction)})),Object(i.lc)()}if(2&e){const e=Object(i.xc)(2);Object(i.Dc)("withTitle",!1)("withIcon",!0)("color",e.color)("disabled",e.store.view.empty)("action",e.toggleCollapseAction)}}function fo(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"igo-actionbar-item",11),Object(i.tc)("trigger",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)(3).onTriggerAction(o)})),Object(i.lc)()}if(2&e){const e=t.$implicit,o=Object(i.xc)(3);Object(i.Dc)("withTitle",o.withTitle)("withIcon",o.withIcon)("withTooltip",o.withTooltip)("color",o.color)("disabled",o.store.state.get(e).disabled)("action",e)}}function yo(e,t){if(1&e&&(Object(i.Yc)(0,fo,1,6,"ng-template",9,10,i.Zc),Object(i.yc)(2,"async")),2&e){const e=Object(i.xc)(2);Object(i.Dc)("ngForOf",Object(i.zc)(2,1,e.store.view.all$()))}}function Oo(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"div",12),Object(i.mc)(1,"button",6),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.xc)(2).scrollDown()})),Object(i.yc)(2,"translate"),Object(i.hc)(3,"mat-icon",13),Object(i.lc)(),Object(i.lc)()}2&e&&(Object(i.Tb)(1),Object(i.Dc)("matTooltip",Object(i.zc)(2,1,"igo.common.actionbar.scrollDown")))}function vo(e,t){if(1&e&&(Object(i.mc)(0,"mat-list"),Object(i.Yc)(1,go,4,3,"div",2),Object(i.Yc)(2,bo,1,5,"igo-actionbar-item",3),Object(i.Yc)(3,yo,3,3,void 0,0),Object(i.Yc)(4,Oo,4,3,"div",4),Object(i.lc)()),2&e){const e=Object(i.xc)();Object(i.Tb)(1),Object(i.Dc)("ngIf",e.heightCondition&&e.positionConditionTop&&e.isDesktop),Object(i.Tb)(1),Object(i.Dc)("ngIf",e.withToggleButton),Object(i.Tb)(1),Object(i.Dc)("ngIf",!e.collapsed),Object(i.Tb)(1),Object(i.Dc)("ngIf",e.heightCondition&&e.positionConditionLow&&e.isDesktop)}}function jo(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"igo-actionbar-item",18),Object(i.tc)("trigger",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)(2).onTriggerAction(o)})),Object(i.lc)()}if(2&e){const e=t.$implicit,o=Object(i.xc)(2);Object(i.Dc)("withTitle",o.withTitle)("withIcon",o.withIcon)("color",o.color)("action",e)}}function wo(e,t){if(1&e&&(Object(i.mc)(0,"div"),Object(i.mc)(1,"button",14),Object(i.yc)(2,"translate"),Object(i.hc)(3,"mat-icon",15),Object(i.lc)(),Object(i.mc)(4,"mat-menu",16,17),Object(i.mc)(6,"mat-list"),Object(i.Yc)(7,jo,1,4,"ng-template",9),Object(i.yc)(8,"async"),Object(i.lc)(),Object(i.lc)(),Object(i.lc)()),2&e){const e=Object(i.Kc)(5),t=Object(i.xc)();Object(i.Tb)(1),Object(i.Dc)("matTooltip",Object(i.zc)(2,10,"igo.common.actionbar.icon"))("matMenuTriggerFor",e)("disabled",t.store.view.empty)("color",t.iconColor),Object(i.Tb)(2),Object(i.Dc)("svgIcon",t.icon),Object(i.Tb)(1),Object(i.Vb)(t.overlayClass),Object(i.Dc)("xPosition",t.xPosition)("yPosition",t.yPosition),Object(i.Tb)(3),Object(i.Dc)("ngForOf",Object(i.zc)(8,12,t.store.view.all$()))}}function So(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"igo-actionbar-item",18),Object(i.tc)("trigger",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)(2).onTriggerAction(o)})),Object(i.lc)(),Object(i.hc)(1,"br")}if(2&e){const e=t.$implicit,o=Object(i.xc)(2);Object(i.Dc)("withTitle",o.withTitle)("withIcon",o.withIcon)("color",o.color)("action",e)}}function xo(e,t){if(1&e&&(Object(i.mc)(0,"mat-card",19),Object(i.mc)(1,"mat-list"),Object(i.Yc)(2,So,2,4,"ng-template",9),Object(i.yc)(3,"async"),Object(i.lc)(),Object(i.lc)()),2&e){const e=Object(i.xc)();Object(i.Tb)(2),Object(i.Dc)("ngForOf",Object(i.zc)(3,1,e.store.view.all$()))}}let Co=(()=>{class e{constructor(e,t,o,i){this.overlay=e,this.elRef=t,this.cdRef=o,this.mediaService=i,this.actionbarMode=so,this.collapsed=!1,this.toggleCollapseAction={id:"actionbar_toggle",icon:"dots-vertical",handler:()=>{this.collapsed=!this.collapsed}},this.heightCondition$=new C.a(!1),this.positionConditionTop$=new C.a(!0),this.positionConditionLow$=new C.a(!0),this.mode=so.Dock,this.withToggleButton=!1,this.horizontal=!1,this.color="default",this.iconColor="default",this.withTitle=!0,this.withTooltip=!0,this.scrollActive=!0,this.withIcon=!0,this.icon="dots-horizontal",this.xPosition="before",this.yPosition="above",this._overlayClass=""}set overlayClass(e){this._overlayClass=e}get overlayClass(){return[this._overlayClass,"igo-actionbar-overlay"].join(" ")}get withTitleClass(){return this.withTitle}get withIconClass(){return this.withIcon}get horizontalClass(){return this.horizontal}get heightCondition(){const e=this.elRef.nativeElement;return!1===this.scrollActive&&e.clientHeight<e.scrollHeight}get positionConditionTop(){return 0!==this.elRef.nativeElement.scrollTop}get positionConditionLow(){const e=this.elRef.nativeElement;return!(e.scrollTop>=e.scrollHeight-e.clientHeight)}get isDesktop(){return this.mediaService.getMedia()===me.Desktop}ngOnChanges(e){const t=e.store;t&&t.currentValue!==t.previousValue&&(void 0!==this.watcher&&this.watcher.destroy(),this.watcher=new nt(this.store,this.cdRef))}ngOnDestroy(){this.watcher.destroy()}onTriggerAction(e){e.handler(...e.args||[])}scrollDown(){this.elRef.nativeElement.scrollBy(0,52)}scrollUp(){this.elRef.nativeElement.scrollBy(0,-52)}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(Ne.c),Object(i.gc)(i.r),Object(i.gc)(i.j),Object(i.gc)(be))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-actionbar"]],hostVars:6,hostBindings:function(e,t){2&e&&Object(i.Yb)("with-title",t.withTitleClass)("with-icon",t.withIconClass)("horizontal",t.horizontalClass)},inputs:{store:"store",mode:"mode",withToggleButton:"withToggleButton",horizontal:"horizontal",color:"color",iconColor:"iconColor",withTitle:"withTitle",withTooltip:"withTooltip",scrollActive:"scrollActive",withIcon:"withIcon",icon:"icon",xPosition:"xPosition",yPosition:"yPosition",overlayClass:"overlayClass"},features:[i.Rb],decls:3,vars:3,consts:[[4,"ngIf"],["class","context-menu-card mat-elevation-z4",4,"ngIf"],["id","topChevron",4,"ngIf"],["color","accent",3,"withTitle","withIcon","color","disabled","action","trigger",4,"ngIf"],["id","lowChevron",4,"ngIf"],["id","topChevron"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","click"],["svgIcon","chevron-up"],["color","accent",3,"withTitle","withIcon","color","disabled","action","trigger"],["ngFor","",3,"ngForOf"],["buttonContent",""],["color","accent",3,"withTitle","withIcon","withTooltip","color","disabled","action","trigger"],["id","lowChevron"],["svgIcon","chevron-down"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",1,"buttonOverlay",3,"matTooltip","matMenuTriggerFor","disabled","color"],[3,"svgIcon"],["overlapTrigger","true",1,"igo-compact-menu","igo-no-min-width-menu",3,"xPosition","yPosition"],["actionbarMenu","matMenu"],["color","accent",3,"withTitle","withIcon","color","action","trigger"],[1,"context-menu-card","mat-elevation-z4"]],template:function(e,t){1&e&&(Object(i.Yc)(0,vo,5,4,"mat-list",0),Object(i.Yc)(1,wo,9,14,"div",0),Object(i.Yc)(2,xo,4,3,"mat-card",1)),2&e&&(Object(i.Dc)("ngIf",t.mode===t.actionbarMode.Dock),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.mode===t.actionbarMode.Overlay),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.mode===t.actionbarMode.Context))},directives:[m.t,l.a,n.b,h.a,c.a,mo,m.s,f.d,f.e,g.a],pipes:[q.e,m.b],styles:["[_nghost-%COMP%]{display:block;height:100%;overflow:auto;position:relative}button[_ngcontent-%COMP%]{margin:4px}.buttonOverlay[_ngcontent-%COMP%]{margin:0}mat-list[_ngcontent-%COMP%]{padding-top:0}.horizontal[_nghost-%COMP%]{max-width:100%;overflow:unset}.horizontal[_nghost-%COMP%]   mat-list[_ngcontent-%COMP%]{white-space:nowrap;width:auto}.horizontal[_nghost-%COMP%]   igo-actionbar-item[_ngcontent-%COMP%]{display:inline-block}[_nghost-%COMP%]     .mat-list .mat-list-item .mat-list-text>*{-webkit-box-orient:vertical;-webkit-line-clamp:2;display:-webkit-box;line-height:18px;max-height:36px;overflow:hidden;text-overflow:ellipsis;white-space:normal}[_nghost-%COMP%]     .mat-list-base .mat-list-item.mat-list-item-with-avatar{height:46px}[_nghost-%COMP%]     .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content{display:-webkit-flex;height:46px;padding:3px}[_nghost-%COMP%]     .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content>mat-icon{padding:8px}igo-actionbar-item[_ngcontent-%COMP%]     mat-list-item [mat-list-avatar]{height:auto;width:40px}igo-actionbar-item[_ngcontent-%COMP%]     mat-list-item:hover{cursor:pointer}.context-menu-card[_ngcontent-%COMP%]{margin:10px;padding:8px 3px}#topChevron[_ngcontent-%COMP%]{background-color:#fff;position:-webkit-sticky;position:sticky;top:0;z-index:3}@media (-ms-high-contrast:active),(-ms-high-contrast:none){#topChevron[_ngcontent-%COMP%]{position:fixed;top:unset}}@supports (-ms-accelerator:true){#topChevron[_ngcontent-%COMP%]{position:fixed;top:unset}}#lowChevron[_ngcontent-%COMP%]{background-color:#fff;bottom:0;position:fixed;position:-webkit-sticky;position:sticky;z-index:3}"],changeDetection:0}),e})(),To=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,ie,n.c,c.b,h.b,f.c,l.e,g.d,b.b]]}),e})(),Lo=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},providers:[],imports:[[m.c,To],To]}),e})(),Io=(()=>{class e{constructor(e,t){this.el=e,this.matIconRegistry=t,this.hidden=!1,this.disabled=!1,this.inverseColor=!1,this.inheritColor=!1}set igoMatBadgeIcon(e){this.matIconRegistry.getNamedSvgIcon(e).subscribe(e=>{this.svg=e,this.updateSvg()})}set matBadgeHidden(e){this.hidden=e,this.updateHidden()}set matBadgeDisabled(e){this.disabled=e,this.updateDisabled()}set igoMatBadgeInverseColor(e){this.inverseColor=e,this.updateColor()}set igoMatBadgeInheritColor(e){this.inheritColor=e,this.updateColor()}get badge(){return this.el.nativeElement.querySelector(".mat-badge-content")}ngOnInit(){this.badge.style.alignItems="center",this.badge.style.justifyContent="center",this.updateHidden(),this.updateColor(),this.updateSvg()}updateSvg(){this.badge&&(this.badge.innerHTML="",this.svg&&this.badge.appendChild(this.svg))}updateColor(){this.badge&&(this.inheritColor?this.inverseColor?(this.badge.style.color="currentColor",this.badge.style.background="none"):(this.badge.style.color="",this.badge.style.background="currentColor"):this.inverseColor?(this.badge.style.color=window.getComputedStyle(this.badge,null).getPropertyValue("background-color"),this.badge.style.background="none"):(this.badge.style.color="",this.badge.style.background=""),this.originalColor=this.badge.style.color,this.updateDisabled())}updateHidden(){this.badge&&(this.badge.style.display=this.hidden?"none":"flex")}updateDisabled(){this.badge&&this.inverseColor&&(this.disabled?(this.originalColor=this.badge.style.color,this.badge.style.color="#b9b9b9"):this.badge.style.color=this.originalColor)}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(i.r),Object(i.gc)(c.c))},e.\u0275dir=Object(i.bc)({type:e,selectors:[["","igoMatBadgeIcon",""]],inputs:{igoMatBadgeIcon:"igoMatBadgeIcon",matBadgeHidden:"matBadgeHidden",matBadgeDisabled:"matBadgeDisabled",igoMatBadgeInverseColor:"igoMatBadgeInverseColor",igoMatBadgeInheritColor:"igoMatBadgeInheritColor"}}),e})(),Fo=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[Be.b,c.b],Be.b]}),e})(),Mo=(()=>{class e{constructor(e){this.el=e,this.clickout=new i.u}handleMouseClick(e,t){t&&(this.el.nativeElement.contains(t)||this.clickout.emit(e))}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(i.r))},e.\u0275dir=Object(i.bc)({type:e,selectors:[["","igoClickout",""]],hostBindings:function(e,t){1&e&&Object(i.tc)("click",(function(e){return t.handleMouseClick(e,e.target)}),!1,i.Mc)},outputs:{clickout:"clickout"}}),e})(),ko=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[]]}),e})(),Do=(()=>{class e{constructor(e,t){this.renderer=e,this.el=t,this._collapsed=!1,this.toggle=new i.u}get target(){return this._target}set target(e){this._target=e}get collapsed(){return this._collapsed}set collapsed(e){e?this.collapseTarget():this.expandTarget(),this._collapsed=e,this.toggle.emit(e)}click(){this.collapsed=!this.collapsed}collapseTarget(){this.renderer.addClass(this.target,"igo-collapsed"),this.renderer.addClass(this.el.nativeElement,"collapsed")}expandTarget(){this.renderer.removeClass(this.target,"igo-collapsed"),this.renderer.removeClass(this.el.nativeElement,"collapsed")}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(i.U),Object(i.gc)(i.r))},e.\u0275dir=Object(i.bc)({type:e,selectors:[["","igoCollapse",""]],hostBindings:function(e,t){1&e&&Object(i.tc)("click",(function(){return t.click()}))},inputs:{target:"target",collapsed:"collapsed"},outputs:{toggle:"toggle"}}),e})();const Po=["*"];let Ao=(()=>{class e{constructor(){this._title="",this._collapsed=!1,this.toggle=new i.u}get title(){return this._title}set title(e){this._title=e}get collapsed(){return this._collapsed}set collapsed(e){this._collapsed=e,this.toggle.emit(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-collapsible"]],inputs:{title:"title",collapsed:"collapsed"},outputs:{toggle:"toggle"},ngContentSelectors:Po,decls:7,vars:3,consts:[["svgIcon","chevron-up","mat-list-avatar","","igoCollapse","",1,"igo-chevron",3,"target","collapsed","toggle"],["matLine",""],["content",""]],template:function(e,t){if(1&e&&(Object(i.Cc)(),Object(i.mc)(0,"mat-list-item"),Object(i.mc)(1,"mat-icon",0),Object(i.tc)("toggle",(function(e){return t.collapsed=e})),Object(i.lc)(),Object(i.mc)(2,"h4",1),Object(i.ad)(3),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(4,"div",null,2),Object(i.Bc)(6),Object(i.lc)()),2&e){const e=Object(i.Kc)(5);Object(i.Tb)(1),Object(i.Dc)("target",e)("collapsed",t.collapsed),Object(i.Tb)(2),Object(i.bd)(t.title)}},directives:[l.d,c.a,l.b,Do,Pe.l],styles:["[_nghost-%COMP%]     .mat-list .mat-list-item.mat-list-avatar{height:auto;padding:0;width:auto}mat-list-item[_ngcontent-%COMP%]{overflow:hidden}"]}),e})(),$o=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[c.b,l.e]]}),e})(),Eo=(()=>{class e{constructor(e){this.dialogRef=e}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(qe.h))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-confirm-dialog"]],decls:12,vars:10,consts:[["mat-dialog-title","",1,"mat-typography"],["mat-dialog-content","",1,"mat-typography"],["mat-dialog-actions",""],["mat-button","","color","primary",3,"click"],["mat-button","",3,"click"]],template:function(e,t){1&e&&(Object(i.mc)(0,"h2",0),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)(),Object(i.mc)(3,"div",1),Object(i.ad)(4),Object(i.lc)(),Object(i.mc)(5,"div",2),Object(i.mc)(6,"button",3),Object(i.tc)("click",(function(){return t.dialogRef.close(!0)})),Object(i.ad)(7),Object(i.yc)(8,"translate"),Object(i.lc)(),Object(i.mc)(9,"button",4),Object(i.tc)("click",(function(){return t.dialogRef.close(!1)})),Object(i.ad)(10),Object(i.yc)(11,"translate"),Object(i.lc)(),Object(i.lc)()),2&e&&(Object(i.Tb)(1),Object(i.bd)(Object(i.zc)(2,4,"igo.common.confirmDialog.title")),Object(i.Tb)(3),Object(i.bd)(t.confirmMessage),Object(i.Tb)(3),Object(i.bd)(Object(i.zc)(8,6,"igo.common.confirmDialog.confirmBtn")),Object(i.Tb)(3),Object(i.bd)(Object(i.zc)(11,8,"igo.common.confirmDialog.cancelBtn")))},directives:[qe.i,qe.f,qe.c,n.b],pipes:[q.e],styles:["h2[_ngcontent-%COMP%]{margin:5px 0 10px}div[mat-dialog-content][_ngcontent-%COMP%]{max-width:200px}div[mat-dialog-actions][_ngcontent-%COMP%]{margin:10px 0 0}"]}),e})(),Ro=(()=>{class e{constructor(e){this.dialog=e}open(e){const t=this.dialog.open(Eo,{disableClose:!1});return t.componentInstance.confirmMessage=e,t.afterClosed()}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(qe.b))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac}),e})(),_o=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},providers:[Ro],imports:[[n.c,qe.g,ie]]}),e})(),zo=(()=>{class e{constructor(e,t,o){this.overlay=e,this.viewContainerRef=t,this.elementRef=o,this.menuPosition=new i.u}onContextMenu(e){const{x:t,y:o}=e;this.close(),e.preventDefault(),this.menuPosition.emit({x:t,y:o}),this.overlayRef=null;const i=this.overlay.position().flexibleConnectedTo({x:t,y:o}).withPositions([{originX:"end",originY:"bottom",overlayX:"start",overlayY:"top"}]);this.overlayRef=this.overlay.create({positionStrategy:i,scrollStrategy:this.overlay.scrollStrategies.close()}),this.overlayRef.attach(new Ge.h(this.menuContext,this.viewContainerRef,{$implicit:void 0})),this.sub=Object(F.a)(document,"click").pipe(Object(Fe.a)(e=>{const t=e.target;return this.close(),!!this.overlayRef&&!this.overlayRef.overlayElement.contains(t)}),Object(Me.a)(1)).subscribe(()=>this.close()),this.sub=Object(F.a)(document,"contextmenu").pipe(Object(Fe.a)(e=>{const t=e.target;if(t&&!this.elementRef.nativeElement.contains(t)&&!this.overlayRef.overlayElement.contains(t))return!0;e.preventDefault()}),Object(Me.a)(1)).subscribe(()=>this.close())}close(){this.overlayRef&&(this.overlayRef.dispose(),this.overlayRef=null),this.sub&&this.sub.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(Ne.c),Object(i.gc)(i.ib),Object(i.gc)(i.r))},e.\u0275dir=Object(i.bc)({type:e,selectors:[["","igoContextMenu",""]],hostBindings:function(e,t){1&e&&Object(i.tc)("contextmenu",(function(e){return t.onContextMenu(e)}))},inputs:{menuContext:["igoContextMenu","menuContext"]},outputs:{menuPosition:"menuPosition"}}),e})(),No=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[]]}),e})(),Bo=(()=>{class e{static forRoot(){return{ngModule:e}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,c.b,h.b,Ve.c,n.c,ie]]}),e})(),qo=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[]]}),e})();class Go{constructor(e){this.componentFactory=e,this.subscriptions=[],this.inputs={},this.inputs$$={},this.subscribers={}}setTarget(e){this.target=e,this.componentRef=e.createComponent(this.componentFactory),this.updateInputs(this.inputs),this.updateSubscribers(this.subscribers)}destroy(){void 0!==this.target&&this.target.clear(),void 0!==this.componentRef&&(this.componentRef.destroy(),this.componentRef=void 0),this.unobserveAllInputs(),this.unsubscribeAll()}updateInputs(e){if(this.inputs=e,void 0===this.componentRef)return;const t=this.componentRef.instance;this.componentFactory.inputs.forEach(o=>{const i=o.propName;this.unobserveInput(i);const r=e[i];e.hasOwnProperty(i)&&(r instanceof xe.a?this.observeInput(i,r):this.setInputValue(t,i,r))}),"function"==typeof t.onUpdateInputs&&t.onUpdateInputs()}setInputValue(e,t,o){if(o===e[t])return;const i=Object.getPrototypeOf(e),r=Object.getOwnPropertyDescriptor(i,t);void 0!==r&&void 0!==r.set?r.set.call(e,o):e[t]=o}updateSubscribers(e){if(this.subscribers=e,void 0===this.componentRef)return;const t=this.componentRef.instance;this.componentFactory.outputs.forEach(o=>{const i=o.propName;if(e.hasOwnProperty(i)){const o=t[i],r=e[i];Array.isArray(r)?r.forEach(e=>{this.subscriptions.push(o.subscribe(e))}):this.subscriptions.push(o.subscribe(r))}})}observeInput(e,t){this.inputs$$[e]=t.subscribe(t=>{const o=this.componentRef.instance;this.setInputValue(o,e,t),"function"==typeof o.onUpdateInputs&&o.onUpdateInputs()})}unobserveInput(e){void 0!==this.inputs$$[e]&&(this.inputs$$[e].unsubscribe(),this.inputs$$[e]=void 0)}unobserveAllInputs(){Object.values(this.inputs$$).forEach(e=>{void 0!==e&&e.unsubscribe()}),this.inputs$$={}}unsubscribeAll(){this.subscriptions.forEach(e=>e.unsubscribe()),this.subscriptions=[]}}let Vo=(()=>{class e{constructor(e){this.resolver=e}create(e){const t=this.resolver.resolveComponentFactory(e);return new Go(t)}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(i.m))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const Uo=["target"];function Ho(e,t){}let Yo=(()=>{class e{constructor(e,t){this.dynamicComponentService=e,this.cdRef=t,this.inputs={},this.subscribers={}}ngOnChanges(e){const t=e.component,o=e.inputs,i=e.subscribers,r=E.objectsAreEquivalent;if(t&&t.currentValue!==t.previousValue)this.createComponent(t.currentValue);else{const e=o&&r(o.currentValue||{},o.previousValue||{}),t=i&&r(i.currentValue||{},i.previousValue||{});!1===e&&this.updateInputs(),!1===t&&this.updateSubscribers()}this.cdRef.detectChanges()}ngOnDestroy(){this.dynamicComponent&&this.dynamicComponent.destroy()}createComponent(e){void 0!==this.dynamicComponent&&this.dynamicComponent.destroy(),this.dynamicComponent=e instanceof Go?e:this.dynamicComponentService.create(e),this.renderComponent()}renderComponent(){this.updateInputs(),this.updateSubscribers(),this.dynamicComponent.setTarget(this.target)}updateInputs(){this.dynamicComponent.updateInputs(this.inputs)}updateSubscribers(){this.dynamicComponent.updateSubscribers(this.subscribers)}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(Vo),Object(i.gc)(i.j))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-dynamic-outlet"]],viewQuery:function(e,t){var o;1&e&&Object(i.Uc)(Uo,!0,i.ib),2&e&&Object(i.Jc)(o=Object(i.uc)())&&(t.target=o.first)},inputs:{component:"component",inputs:"inputs",subscribers:"subscribers"},features:[i.Rb],decls:2,vars:0,consts:[["target",""]],template:function(e,t){1&e&&Object(i.Yc)(0,Ho,0,0,"ng-template",null,0,i.Zc)},styles:["[_nghost-%COMP%]{display:block;height:100%;width:100%}"],changeDetection:0}),e})(),Wo=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c]]}),e})(),Ko=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},providers:[Vo],imports:[[m.c,Wo],Wo]}),e})(),Zo=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[]]}),e})();const Qo=["buttons"],Jo=["*",[["","formButtons",""]]],Xo=function(e){return{"igo-form-body-with-buttons":e}},ei=["*","[formButtons]"];let ti=(()=>{class e{constructor(){this.autocomplete="off",this.submitForm=new i.u}get hasButtons(){return 0!==this.buttons.nativeElement.children.length}ngOnChanges(e){const t=e.formData;t&&t.currentValue!==t.previousValue&&(void 0===t.currentValue?this.clear():this.setData(t.currentValue))}onSubmit(){this.submitForm.emit(this.getData())}getData(){const e={};return(t=this.form,t.groups.reduce((e,t)=>e.concat(t.fields),[].concat(t.fields))).forEach(t=>{this.updateDataWithFormField(e,t)}),e;var t}setData(e){this.form.fields.forEach(t=>{t.control.setValue(we()(e,t.name).safeObject)}),this.form.groups.forEach(t=>{t.fields.forEach(t=>{t.control.setValue(we()(e,t.name).safeObject)})})}updateDataWithFormField(e,t){const o=t.control;o.disabled||(e[t.name]=o.value)}clear(){this.form.control.reset()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-form"]],viewQuery:function(e,t){var o;1&e&&Object(i.Uc)(Qo,!0),2&e&&Object(i.Jc)(o=Object(i.uc)())&&(t.buttons=o.first)},inputs:{form:"form",formData:"formData",autocomplete:"autocomplete"},outputs:{submitForm:"submitForm"},features:[i.Rb],ngContentSelectors:ei,decls:7,vars:5,consts:[[3,"autocomplete","formGroup","ngSubmit"],[1,"igo-form-body",3,"ngClass"],[1,"igo-form-content"],[1,"igo-form-buttons"],["buttons",""]],template:function(e,t){1&e&&(Object(i.Cc)(Jo),Object(i.mc)(0,"form",0),Object(i.tc)("ngSubmit",(function(){return t.onSubmit()})),Object(i.mc)(1,"div",1),Object(i.mc)(2,"div",2),Object(i.Bc)(3),Object(i.lc)(),Object(i.mc)(4,"div",3,4),Object(i.Bc)(6,1),Object(i.lc)(),Object(i.lc)(),Object(i.lc)()),2&e&&(Object(i.Dc)("autocomplete",t.autocomplete)("formGroup",t.form.control),Object(i.Tb)(1),Object(i.Dc)("ngClass",Object(i.Gc)(3,Xo,t.hasButtons)))},directives:[Ue.I,Ue.t,Ue.k,m.q],styles:["[_nghost-%COMP%]{display:block}form[_ngcontent-%COMP%]{width:100%}.igo-form-body[_ngcontent-%COMP%], .igo-form-content[_ngcontent-%COMP%], form[_ngcontent-%COMP%]{height:100%}.igo-form-body-with-buttons[_ngcontent-%COMP%]   .igo-form-content[_ngcontent-%COMP%]{height:calc(100% - 56px)}.igo-form-content[_ngcontent-%COMP%]{display:flex}"],changeDetection:0}),e})(),oi=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,Ue.m,Ue.C],Ue.m,Ue.C]}),e})(),ii=(()=>{class e{constructor(){}static register(t,o){e.fields[t]=o}getFieldByType(t){return e.fields[t]}}return e.fields={},e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),ri=(()=>{class e{constructor(e){this.formBuilder=e}form(e,t){const o=this.formBuilder.group({});return e.forEach(e=>{o.addControl(e.name,e.control)}),t.forEach(e=>{o.addControl(e.name,e.control)}),{fields:e,groups:t,control:o}}group(e,t){const o=e.options||{},i=this.formBuilder.group({});t.forEach(e=>{i.addControl(e.name,e.control)});const r=this.getValidators(o.validator);return i.setValidators(r),Object.assign({},e,{fields:t,control:i})}field(e){const t=e.options||{},o=this.formBuilder.control({value:"",disabled:t.disabled}),i=this.getValidators(t.validator);return o.setValidators(i),Object.assign({type:"text"},e,{control:o})}extendFieldConfig(e,t){const o=Object.assign({},e.options||{},t.options||{}),i=Object.assign({},e.inputs||{},t.inputs||{}),r=Object.assign({},e.subscribers||{},t.subscribers||{});return Object.assign({},e,{options:o,inputs:i,subscribers:r})}getValidators(e){return Array.isArray(e)?e.map(e=>this.getValidator(e)):this.getValidator(e)}getValidator(e){if("string"!=typeof e)return e;const t=e.match(/^([a-zA-Z]{3,15})\((.{0,20})\)$/);return t?Ue.G[t[1]](t[2]):Ue.G[e]}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(Ue.g))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function si(e,t){if(1&e&&(Object(i.kc)(0),Object(i.hc)(1,"igo-dynamic-outlet",1),Object(i.jc)()),2&e){const e=Object(i.xc)();Object(i.Tb)(1),Object(i.Dc)("component",e.getFieldComponent())("inputs",e.getFieldInputs())("subscribers",e.getFieldSubscribers())}}let ai=(()=>{class e{constructor(e){this.formFieldService=e,this.fieldInputs=void 0,this.fieldSubscribers=void 0}get fieldOptions(){return this.field.options||{}}getFieldComponent(){return this.formFieldService.getFieldByType(this.field.type||"text")}getFieldInputs(){if(void 0!==this.fieldInputs)return this.fieldInputs;const e=this.fieldOptions.errors||{};return this.fieldInputs=Object.assign({placeholder:this.field.title,disableSwitch:this.fieldOptions.disableSwitch||!1},Object.assign({},this.field.inputs||{}),{formControl:this.field.control,errors:Object.assign({},{required:"igo.common.form.errors.required"},e)}),this.fieldInputs}getFieldSubscribers(){return void 0!==this.fieldSubscribers||(this.fieldSubscribers=Object.assign({},this.field.subscribers||{})),this.fieldSubscribers}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(ii))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-form-field"]],inputs:{field:"field"},decls:1,vars:1,consts:[[4,"ngIf"],[3,"component","inputs","subscribers"]],template:function(e,t){1&e&&Object(i.Yc)(0,si,2,3,"ng-container",0),2&e&&Object(i.Dc)("ngIf",void 0!==t.field)},directives:[m.t,Yo],styles:["mat-form-field{width:100%}  .igo-form-disable-switch{margin-right:8px}"],changeDetection:0}),e})(),ni=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,Ue.m,Ue.C,c.b,ke.e,Ve.c,De.b,ie,Wo]]}),e})();function ci(e,t){if(1&e&&(Object(i.mc)(0,"div",5),Object(i.hc)(1,"igo-form-field",6),Object(i.lc)()),2&e){const e=t.$implicit,o=Object(i.xc)(2);Object(i.Dc)("ngClass",o.getFieldNgClass(e)),Object(i.Tb)(1),Object(i.Dc)("field",e)}}function li(e,t){if(1&e&&(Object(i.mc)(0,"div",3),Object(i.Yc)(1,ci,2,2,"div",4),Object(i.lc)()),2&e){const e=Object(i.xc)();Object(i.Tb)(1),Object(i.Dc)("ngForOf",e.group.fields)}}function ui(e,t){if(1&e&&(Object(i.mc)(0,"mat-error"),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()),2&e){const e=Object(i.xc)();Object(i.Tb)(1),Object(i.bd)(Object(i.zc)(2,1,e.getErrorMessage()))}}const di=["*"];let hi=(()=>{class e{constructor(){}get formControl(){return this.group.control}getFieldColSpan(e){let t=2;const o=e.options||{};return o.cols&&o.cols>0&&(t=Math.min(o.cols,2)),t}getFieldNgClass(e){return{["igo-form-field-colspan-"+this.getFieldColSpan(e)]:!0}}getErrorMessage(){return function(e,t){const o=Object.keys(e.errors||{}).map(e=>t[e]).filter(e=>void 0!==e);return o.length>0?o[0]:""}(this.formControl,(this.group.options||{}).errors||{})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-form-group"]],inputs:{group:"group",errors:"errors"},ngContentSelectors:di,decls:4,vars:2,consts:[["class","igo-form-group-fields",4,"ngIf"],[1,"igo-form-group-extra-content"],[4,"ngIf"],[1,"igo-form-group-fields"],["class","igo-form-field-wrapper",3,"ngClass",4,"ngFor","ngForOf"],[1,"igo-form-field-wrapper",3,"ngClass"],[3,"field"]],template:function(e,t){1&e&&(Object(i.Cc)(),Object(i.Yc)(0,li,2,1,"div",0),Object(i.mc)(1,"div",1),Object(i.Bc)(2),Object(i.lc)(),Object(i.Yc)(3,ui,3,3,"mat-error",2)),2&e&&(Object(i.Dc)("ngIf",t.group&&t.group.fields.length>0),Object(i.Tb)(3),Object(i.Dc)("ngIf",t.formControl.errors))},directives:[m.t,m.s,m.q,ai,ke.b],pipes:[q.e],styles:["[_nghost-%COMP%]{display:block;height:100%;overflow:auto;padding:10px 5px;width:100%}.igo-form-field-wrapper[_ngcontent-%COMP%]{display:inline-block;padding:0 5px}.igo-form-field-colspan-2[_ngcontent-%COMP%]{width:100%}.igo-form-field-colspan-1[_ngcontent-%COMP%]{width:50%}"],changeDetection:0}),e})(),pi=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,ke.e,ie,ni]]}),e})(),mi=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},providers:[ri,ii],imports:[[m.c,pi,ni],oi,pi,ni]}),e})(),gi=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,Ue.m,De.b]]}),e})(),bi=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[]]}),e})(),fi=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[Ae.b]]}),e})(),yi=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[]]}),e})(),Oi=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,$e.q,Ee.c,c.b,n.c,b.b,Ae.b,bi,Bo,fi,yi,ie]]}),e})(),vi=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c],gi,Oi,fi]}),e})(),ji=(()=>{class e{constructor(e,t){this.http=e,this.configService=t,this.jsonURL=this.getPathToConfigFile()}loadConfigTour(){this.getJSON().subscribe(e=>{this.allToursOptions=e},e=>{throw new Error("Problem with Interactive tour configuration file: interactiveTour.json not find. Check if the file and is path is set correctly.")})}getPathToConfigFile(){return this.configService.getConfig("interactiveTour.pathToConfigFile")||"./config/interactiveTour.json"}getJSON(){return this.http.get(this.jsonURL).pipe(Object(v.a)(e=>{throw e.error.caught=!0,e}))}getTourOptionData(e){if(void 0===this.allToursOptions)return;let t=e;return t=t.replace(/\s/g,""),this.allToursOptions[t]}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(y.b),Object(i.qc)(K))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac}),e})(),wi=(()=>{class e{constructor(e,t,o,i,r){this.configService=e,this.mediaService=t,this.languageService=o,this.interactiveTourLoader=i,this.shepherdService=r,this.nextIndex=1,this.isAppHaveTour()&&this.interactiveTourLoader.loadConfigTour()}isAppHaveTour(){const e=this.configService.getConfig("interactiveTour.activateInteractiveTour");return void 0===e||e}isToolHaveTourConfig(e){return void 0!==this.interactiveTourLoader.getTourOptionData(e)}disabledTourButton(e){const t=this.interactiveTourLoader.getTourOptionData(e);if(null==t?void 0:t.conditions)for(const o of null==t?void 0:t.conditions)if(null===document.querySelector(o))return!0;return!1}isMobile(){return this.mediaService.isMobile()}isTourDisplayInMobile(){return void 0===this.configService.getConfig("interactiveTour.tourInMobile")||this.configService.getConfig("interactiveTour.tourInMobile")}getButtons(e){return"noBackButton"===e?[{classes:"shepherd-button-primary",text:this.languageService.translate.instant("igo.common.interactiveTour.nextButton"),type:"next"}]:"first"===e?[{classes:"shepherd-button-secondary",text:this.languageService.translate.instant("igo.common.interactiveTour.exitButton"),type:"cancel"},{classes:"shepherd-button-primary",text:this.languageService.translate.instant("igo.common.interactiveTour.nextButton"),type:"next"}]:"last"===e?[{classes:"shepherd-button-secondary",text:this.languageService.translate.instant("igo.common.interactiveTour.backButton"),type:"back"},{classes:"shepherd-button-primary",text:this.languageService.translate.instant("igo.common.interactiveTour.exitButton"),type:"cancel"}]:[{classes:"shepherd-button-secondary",text:this.languageService.translate.instant("igo.common.interactiveTour.backButton"),type:"back"},{classes:"shepherd-button-primary",text:this.languageService.translate.instant("igo.common.interactiveTour.nextButton"),type:"next"}]}getAction(e){return{click:"click"}[e.toLowerCase()]}addProgress(){const e=this;let t=0;const o=setInterval(()=>{if(e.getCurrentStep()){if(e.getCurrentStep().options.attachTo.element&&!document.querySelector(e.getCurrentStep().options.attachTo.element))return e.cancel(),void clearInterval(o);{const i=e.getCurrentStep().getElement();i&&i.querySelectorAll(".shepherd-content, .shepherd-text").forEach(e=>{e.classList.add("mat-typography")});const r=i?i.querySelector(".shepherd-header"):void 0;if(t++,(r||t>21)&&clearInterval(o),r){const t=e.steps,o=document.createElement("span");o.className="shepherd-progress",o.innerText=`${t.indexOf(e.getCurrentStep())+1}/${t.length}`,r.insertBefore(o,i.querySelector(".shepherd-cancel-icon"))}}}},100)}checkNext(e,t,o){if(t.getCurrentStep()){if(t.getCurrentStep().options.attachTo.element&&document.querySelector(t.getCurrentStep().options.attachTo.element))return void t.complete();if(e.index===t.steps.length-1)return void t.complete();t.steps.splice(e.index,1);const i=t.steps[e.index];i.options.attachTo.element&&!document.querySelector(i.options.attachTo.element)?o.checkNext(e,t,o):(t._setupModal(),t.show(i.id))}}executeAction(e,t){if(!t)return;if(t.condition&&("!"===t.condition.charAt(0)&&document.querySelector(t.condition.slice(1))||"!"!==t.condition.charAt(0)&&!document.querySelector(t.condition)))return;const o=document.querySelector(t.element||e.element),i=this.getAction(t.action);o&&i&&o[i]()}executeActionPromise(e,t){return new Promise(o=>{if(this.executeAction(e,t),!t||!t.waitFor)return void o();let i=0;const r=t.maxWait?t.maxWait/100:20,s=setInterval(()=>{i++,(i>r||document.querySelector(t.waitFor))&&(clearInterval(s),o())},100)})}getShepherdSteps(e){const t=[];let o=0;for(const i of e.steps)t.push({attachTo:{element:i.element,on:i.position||e.position},popperOptions:{modifiers:[{name:"offset",options:{offset:[0,15]}}]},beforeShowPromise:()=>Promise.all([this.executeActionPromise(this.previousStep,this.previousStep?this.previousStep.beforeChange:void 0),this.executeActionPromise(i,i.beforeShow)]),buttons:this.getButtons(0===o?"first":o+1===e.steps.length?"last":e.steps[o].noBackButton?"noBackButton":void 0),classes:i.class,highlightClass:i.highlightClass,scrollTo:i.scrollToElement||e.scrollToElement||!0,canClickTarget:i.disableInteraction?!i.disableInteraction:void 0,title:this.languageService.translate.instant(i.title||e.title),text:[this.languageService.translate.instant(i.text)],when:{show:()=>{this.executeAction(i,i.onShow)},hide:()=>{this.previousStep=i,this.executeAction(i,i.onHide)}}}),o++;return t}startTour(e){const t=this.interactiveTourLoader.getTourOptionData(e);this.shepherdService.defaultStepOptions={classes:t.class,highlightClass:t.highlightClass,canClickTarget:!t.disableInteraction||!t.disableInteraction,cancelIcon:{enabled:!0}};const o=this.getShepherdSteps(t);this.shepherdService.modal=!0,this.shepherdService.confirmCancel=!1,this.shepherdService.addSteps(o),this.shepherdService.tourObject.on("show",this.addProgress),this.shepherdService.tourObject.on("cancel",e=>{this.checkNext(e,this.shepherdService.tourObject,this)}),this.shepherdService.start()}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(K),Object(i.qc)(be),Object(i.qc)(le),Object(i.qc)(ji),Object(i.qc)(He.a))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class Si{constructor(e={}){this.options=e,this.activeTool$=new C.a(void 0),this.toolbar$=new C.a([]),this.activeToolHistory=[],this.store=new at([],{getKey:e=>e.name}),this.setToolbar(e.toolbar),this.initStore()}get tools$(){return this.store.entities$}destroy(){this.activeTool$$.unsubscribe(),this.store.destroy()}getTool(e){return this.store.get(e)}getTools(){return this.store.all()}setTools(e){this.store.load(e)}getToolbar(){return this.toolbar$.getValue()}setToolbar(e){this.toolbar$.next(e||[])}activateTool(e,t={}){const o=this.getTool(e);void 0!==o&&this.store.state.update(o,{active:!0,options:t},!0)}activatePreviousTool(){if(this.activeToolHistory.length<=1)return void this.deactivateTool();const[e,t]=this.activeToolHistory.splice(-2,2);this.activateTool(e)}deactivateTool(){this.clearActiveToolHistory(),this.store.state.updateAll({active:!1})}initStore(){this.store=new at([],{getKey:e=>e.name}),this.activeTool$$=this.store.stateView.firstBy$(e=>!0===e.state.active).subscribe(e=>{if(void 0===e)return void this.setActiveTool(void 0);const t=e.entity,o=Object.assign({},t.options||{},e.state.options||{});this.setActiveTool(Object.assign({},t,{options:o}))})}setActiveTool(e){this.activeTool$.next(e),void 0===e?this.clearActiveToolHistory():this.activeToolHistory=this.activeToolHistory.filter(t=>t!==e.name).concat([e.name])}clearActiveToolHistory(){this.activeToolHistory=[]}}let xi=(()=>{class e{constructor(){this.toolbox=new Si,this.toolbox.setTools(this.getTools())}static register(t){e.tools[t.name]=t}getTool(t){return e.tools[t]}getTools(){return Object.values(e.tools)}}return e.tools={},e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Ci(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",1),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.xc)().startInteractiveTour()})),Object(i.mc)(1,"span",2),Object(i.ad)(2),Object(i.yc)(3,"translate"),Object(i.yc)(4,"translate"),Object(i.yc)(5,"async"),Object(i.lc)(),Object(i.hc)(6,"mat-icon",3),Object(i.yc)(7,"translate"),Object(i.yc)(8,"translate"),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Dc)("ngClass",e.getClass())("disabled",e.disabledTourButton),Object(i.Tb)(2),Object(i.dd)("",Object(i.zc)(3,5,"igo.common.interactiveTour.buttonTitle")," ",Object(i.zc)(4,7,Object(i.zc)(5,9,e.discoverTitleInLocale$)),""),Object(i.Tb)(4),Object(i.Dc)("matTooltip",e.disabledTourButton?Object(i.zc)(7,11,"igo.common.interactiveTour.disaledTooltipTourToolButton"):Object(i.zc)(8,13,"igo.common.interactiveTour.tooltipTourToolButton"))}}let Ti=(()=>{class e{constructor(e,t){this.interactiveTourService=e,this.toolService=t,this.tourToStart="",this.discoverTitleInLocale$=Object(L.a)("IGO")}getClass(){return{"tour-button-tool-icon":"icon"===this.styleButton,"tour-button-tool":"raised"===this.styleButton}}get toolbox(){return this.toolService.toolbox}getTourToStart(){return this.tourToStart?this.tourToStart:this.activeToolName}get activeToolName(){return this.toolbox?this.isActiveTool?this.toolbox.activeTool$.getValue().name:"global":void 0}get isActiveTool(){return this.toolbox?void 0!==this.toolbox.activeTool$.getValue():void 0}get isToolHaveTour(){return!("about"===this.activeToolName&&!this.tourToStart)&&this.interactiveTourService.isToolHaveTourConfig(this.getTourToStart())}get showTourButton(){let e,t;return e=this.isToolHaveTour,!1!==e&&(!this.interactiveTourService.isMobile()||(t=this.isTourDisplayInMobile,!1!==t))}get isTourDisplayInMobile(){return this.interactiveTourService.isTourDisplayInMobile()}get disabledTourButton(){return this.interactiveTourService.disabledTourButton(this.activeToolName)}startInteractiveTour(){const e=this.getTourToStart();e&&this.interactiveTourService.startTour(e)}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(wi),Object(i.gc)(xi))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-interactive-tour"]],inputs:{tourToStart:"tourToStart",styleButton:"styleButton",discoverTitleInLocale$:"discoverTitleInLocale$"},decls:1,vars:1,consts:[["mat-raised-button","","tooltip-position","below","matTooltipShowDelay","500",3,"ngClass","disabled","click",4,"ngIf"],["mat-raised-button","","tooltip-position","below","matTooltipShowDelay","500",3,"ngClass","disabled","click"],[1,"interactive-tour-button-title"],["svgIcon","presentation-play",3,"matTooltip"]],template:function(e,t){1&e&&Object(i.Yc)(0,Ci,9,15,"button",0),2&e&&Object(i.Dc)("ngIf",t.showTourButton)},directives:[m.t,n.b,m.q,c.a,h.a],pipes:[q.e,m.b],styles:[".shepherd-has-title .shepherd-content .shepherd-header{padding:.5em .75em}.shepherd-title{font-weight:revert!important;margin:0!important}.shepherd-progress{color:#737373;margin-right:15px}.shepherd-text{font-size:14px!important}.shepherd-element{border:1px solid #474747;box-shadow:4px 5px hsla(0,0%,39.6%,.6)}"],encapsulation:2}),e})(),Li=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},providers:[wi,ji],imports:[[m.c,c.b,n.c,h.b,ie]]}),e})(),Ii=(()=>{class e{transform(e,t){const o=[];return Object.getOwnPropertyNames(e).forEach(t=>o.push({key:t,value:e[t]})),o}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=Object(i.fc)({name:"keyvalue",type:e,pure:!0}),e})(),Fi=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[]]}),e})(),Mi=(()=>{class e{constructor(e,t){this.renderer=e,this.el=t,this._color="primary",this._focused=!1,this._selected=!1,this._disabled=!1,this.beforeSelect=new i.u,this.beforeFocus=new i.u,this.beforeUnselect=new i.u,this.beforeUnfocus=new i.u,this.beforeDisable=new i.u,this.beforeEnable=new i.u,this.focus=new i.u,this.unfocus=new i.u,this.select=new i.u,this.unselect=new i.u,this.disable=new i.u,this.enable=new i.u}get color(){return this._color}set color(e){this._color=e}get focused(){return this._focused}set focused(e){e!==this._focused&&(this.disabled||(e?this.beforeFocus.emit(this):this.beforeUnfocus.emit(this),this._focused=e,!0!==this.selected&&this.toggleFocusedClass(),e?this.focus.emit(this):this.unfocus.emit(this)))}get selected(){return this._selected}set selected(e){e!==this._selected&&(this.disabled||(e?this.beforeSelect.emit(this):this.beforeUnselect.emit(this),this._selected=e,this._focused=e,this.toggleSelectedClass(),e?this.select.emit(this):this.unselect.emit(this)))}get disabled(){return this._disabled}set disabled(e){e!==this._disabled&&(!0===e&&(this.selected=!1),e?this.beforeDisable.emit(this):this.beforeEnable.emit(this),this._disabled=e,this.toggleDisabledClass(),e?this.disable.emit(this):this.enable.emit(this))}onClick(){this.selected=!0}getOffsetTop(){return this.el.nativeElement.offsetTop-5}toggleFocusedClass(){this.focused?this.addCls(e.focusedCls):this.removeCls(e.focusedCls)}toggleSelectedClass(){this.selected?(this.addCls(e.selectedCls),this.removeCls(e.focusedCls)):this.removeCls(e.selectedCls)}toggleDisabledClass(){this.disabled?this.addCls(e.disabledCls):this.removeCls(e.disabledCls)}addCls(e){this.renderer.addClass(this.el.nativeElement,e)}removeCls(e){this.renderer.removeClass(this.el.nativeElement,e)}}return e.focusedCls="igo-list-item-focused",e.selectedCls="igo-list-item-selected",e.disabledCls="igo-list-item-disabled",e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(i.U),Object(i.gc)(i.r))},e.\u0275dir=Object(i.bc)({type:e,selectors:[["","igoListItem",""]],hostBindings:function(e,t){1&e&&Object(i.tc)("click",(function(){return t.onClick()}))},inputs:{color:"color",focused:"focused",selected:"selected",disabled:"disabled"},outputs:{beforeSelect:"beforeSelect",beforeFocus:"beforeFocus",beforeUnselect:"beforeUnselect",beforeUnfocus:"beforeUnfocus",beforeDisable:"beforeDisable",beforeEnable:"beforeEnable",focus:"focus",unfocus:"unfocus",select:"select",unselect:"unselect",disable:"disable",enable:"enable"}}),e})();const ki=function(e){return{selectable:e}},Di=["*"];let Pi=(()=>{class e{constructor(e){this.el=e,this._navigation=!0,this._selection=!0,this.subscriptions=[]}get navigation(){return this._navigation}set navigation(e){this._navigation=e}get selection(){return this._selection}set selection(e){this._selection=e}get selectedItem(){return this._selectedItem}set selectedItem(e){this.focusedItem=e,this._selectedItem=e}get focusedItem(){return this._focusedItem}set focusedItem(e){this._focusedItem=e}handleKeyboardEvent(e){this.navigationEnabled&&("ArrowUp"===e.key||"ArrowDown"===e.key?(e.preventDefault(),this.navigate(e.key)):"Enter"===e.key&&this.select(this.focusedItem))}ngOnInit(){this.enableNavigation()}ngAfterViewInit(){this.listItems.length&&this.init(),this.listItems$$=this.listItems.changes.subscribe(e=>this.init())}ngOnDestroy(){this.listItems$$.unsubscribe()}focus(e){this.selection&&(this.unfocus(),void 0!==e&&(e.focused=!0))}unfocus(){void 0!==this.focusedItem&&(this.focusedItem.focused=!1),this.focusedItem=void 0}focusNext(){const e=this.listItems.toArray();let t;const o=this.el.nativeElement;let i=!0,r=this.getFocusedIndex();for(void 0===r&&(r=-1);i&&r<e.length-1;)r+=1,t=e[r],i=t.disabled;void 0!==t&&this.focus(t),e[r+1]?void 0===t||this.isScrolledIntoView(t.el.nativeElement)||(o.scrollTop=t.el.nativeElement.offsetTop+t.el.nativeElement.children[0].offsetHeight-o.clientHeight):o.scrollTop=o.scrollHeight-o.clientHeight}focusPrevious(){const e=this.listItems.toArray();let t;const o=this.el.nativeElement;let i=!0,r=this.getFocusedIndex();for(;i&&r>0;)r-=1,t=e[r],i=t.disabled;void 0!==t&&this.focus(t),e[r-1]?void 0===t||this.isScrolledIntoView(t.el.nativeElement)||(o.scrollTop=t.el.nativeElement.offsetTop-3):o.scrollTop=0}select(e){this.selection&&(this.unselect(),void 0!==e&&(e.selected=!0))}unselect(){this.unfocus(),void 0!==this.selectedItem&&(this.selectedItem.selected=!1),this.selectedItem=void 0}enableNavigation(){this.navigation&&(this.navigationEnabled=!0)}disableNavigation(){this.navigationEnabled=!1}scrollToItem(e){this.el.nativeElement.scrollTop=e.getOffsetTop()}isScrolledIntoView(e){const t=this.el.nativeElement.scrollTop+this.el.nativeElement.offsetTop,o=e.offsetTop;return o+e.children[0].offsetHeight<=t+this.el.nativeElement.clientHeight&&o>=t}init(){this.subscribe(),this.selectedItem=this.findSelectedItem(),this.focusedItem=this.findFocusedItem(),this.enableNavigation()}subscribe(){this.unsubscribe(),this.listItems.toArray().forEach(e=>{this.subscriptions.push(e.beforeSelect.subscribe(e=>this.handleItemBeforeSelect(e))),this.subscriptions.push(e.select.subscribe(e=>this.handleItemSelect(e))),this.subscriptions.push(e.beforeFocus.subscribe(e=>this.handleItemBeforeFocus(e))),this.subscriptions.push(e.focus.subscribe(e=>this.handleItemFocus(e)))},this)}unsubscribe(){this.subscriptions.forEach(e=>e.unsubscribe()),this.subscriptions=[]}handleItemBeforeFocus(e){e!==this.focusedItem&&this.unfocus()}handleItemFocus(e){this.focusedItem=e}handleItemBeforeSelect(e){e!==this.focusedItem&&this.unselect()}handleItemSelect(e){this.selectedItem=e}findSelectedItem(){return this.listItems.toArray().find(e=>e.selected)}findFocusedItem(){return this.listItems.toArray().find(e=>e.focused)}getFocusedIndex(){return this.listItems.toArray().findIndex(e=>e===this.focusedItem)}navigate(e){switch(e){case"ArrowUp":this.focusPrevious();break;case"ArrowDown":this.focusNext()}}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(i.r))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-list"]],contentQueries:function(e,t,o){var r;1&e&&Object(i.Zb)(o,Mi,!0),2&e&&Object(i.Jc)(r=Object(i.uc)())&&(t.listItems=r)},hostBindings:function(e,t){1&e&&Object(i.tc)("keydown",(function(e){return t.handleKeyboardEvent(e)}),!1,i.Mc)("enter",(function(e){return t.handleKeyboardEvent(e)}),!1,i.Mc)},inputs:{navigation:"navigation",selection:"selection"},ngContentSelectors:Di,decls:2,vars:3,consts:[["igoClickout","",3,"ngClass","clickout","click"]],template:function(e,t){1&e&&(Object(i.Cc)(),Object(i.mc)(0,"mat-list",0),Object(i.tc)("clickout",(function(){return t.disableNavigation()}))("click",(function(){return t.enableNavigation()})),Object(i.Bc)(1),Object(i.lc)()),2&e&&Object(i.Dc)("ngClass",Object(i.Gc)(1,ki,t.selection))},directives:[l.a,Mo,m.q],styles:["[_nghost-%COMP%]{display:block;height:100%;overflow:auto;position:relative}mat-list[_ngcontent-%COMP%]{padding-top:0}[_nghost-%COMP%]{position:static}[_nghost-%COMP%]     .mat-list .mat-list-item .mat-list-text>*{-webkit-box-orient:vertical;-webkit-line-clamp:2;display:-webkit-box;line-height:18px;max-height:36px;overflow:hidden;text-overflow:ellipsis;white-space:normal}[_nghost-%COMP%]     .mat-list .mat-list-item.mat-list-item-avatar .mat-list-item-content{display:-webkit-flex;height:46px;padding:3px}[_nghost-%COMP%]     .mat-list .mat-list-item.mat-list-item-avatar{height:46px}[_nghost-%COMP%]     .mat-list   igo-collapsible>.mat-list-item>.mat-list-item-content>.mat-list-text>.mat-line{font-weight:700;opacity:.9}[_nghost-%COMP%]     .mat-list .mat-list-item.mat-list-item-avatar .mat-list-item-content>mat-icon{padding:8px}[_nghost-%COMP%]     [igolistitem] mat-list-item [mat-list-avatar]{height:auto;width:40px}[_nghost-%COMP%]   mat-list.selectable[_ngcontent-%COMP%]     [igolistitem]:not(.igo-list-item-disabled) mat-list-item:hover{cursor:pointer}[_nghost-%COMP%]     [igolistitem]:focus{outline:none}"]}),e})(),Ai=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,c.b,l.e,ko]]}),e})();function $i(e,t){if(1&e&&(Object(i.mc)(0,"div",2),Object(i.mc)(1,"h3"),Object(i.Bc)(2,1),Object(i.mc)(3,"div",3),Object(i.ad)(4),Object(i.Bc)(5,2),Object(i.lc)(),Object(i.Bc)(6,3),Object(i.lc)(),Object(i.lc)()),2&e){const e=Object(i.xc)();Object(i.Tb)(4),Object(i.cd)(" ",e.title," ")}}const Ei=["*",[["","panelLeftButton",""]],[["","panelHeader",""]],[["","panelRightButton",""]]],Ri=["*","[panelLeftButton]","[panelHeader]","[panelRightButton]"];let _i=(()=>{class e{constructor(){this._withHeader=!0}get title(){return this._title}set title(e){this._title=e}get withHeader(){return this._withHeader}set withHeader(e){this._withHeader=e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-panel"]],hostVars:2,hostBindings:function(e,t){2&e&&Object(i.Yb)("igo-panel-with-header",t.withHeader)},inputs:{title:"title",withHeader:"withHeader"},ngContentSelectors:Ri,decls:3,vars:1,consts:[["class","igo-panel-header mat-typography","title","",4,"ngIf"],["title","",1,"igo-panel-content"],["title","",1,"igo-panel-header","mat-typography"],[1,"igo-panel-title"]],template:function(e,t){1&e&&(Object(i.Cc)(Ei),Object(i.Yc)(0,$i,7,1,"div",0),Object(i.mc)(1,"div",1),Object(i.Bc)(2),Object(i.lc)()),2&e&&Object(i.Dc)("ngIf",t.withHeader)},directives:[m.t],styles:["[_nghost-%COMP%]{display:block}.igo-panel-header[_ngcontent-%COMP%]{height:46px;padding:3px;text-align:center}.igo-panel-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{height:40px;margin:0}.igo-panel-header[_ngcontent-%COMP%]     [panelleftbutton]{float:left;margin-right:-40px}.igo-panel-header[_ngcontent-%COMP%]     [panelrightbutton]{float:right}.igo-panel-content[_ngcontent-%COMP%]{overflow:auto}.igo-panel-with-header[_nghost-%COMP%]   .igo-panel-content[_ngcontent-%COMP%]{height:calc(100% - 46px)}[_nghost-%COMP%]:not(.igo-panel-with-header)   .igo-panel-content[_ngcontent-%COMP%]{height:100%}.igo-panel-title[_ngcontent-%COMP%]{display:block;float:left;font-size:1.17em;font-weight:700;height:100%;line-height:40px;margin-left:40px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:calc(100% - 80px)}"],changeDetection:0}),e})(),zi=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c]]}),e})();const Ni=function(e){return{"igo-spinner-container":!0,"igo-spinner-shown":e}};let Bi=(()=>{class e{constructor(){this.shown$=new C.a(!1)}set shown(e){this.shown$.next(e)}get shown(){return this.shown$.value}show(){this.shown=!0}hide(){this.shown=!1}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-spinner"]],inputs:{shown:"shown"},decls:4,vars:5,consts:[[3,"ngClass"],[1,"igo-spinner-background"],["diameter","40","mode","indeterminate"]],template:function(e,t){1&e&&(Object(i.mc)(0,"div",0),Object(i.yc)(1,"async"),Object(i.hc)(2,"div",1),Object(i.hc)(3,"mat-progress-spinner",2),Object(i.lc)()),2&e&&Object(i.Dc)("ngClass",Object(i.Gc)(3,Ni,Object(i.zc)(1,1,t.shown$)))},directives:[m.q,Ye.a],pipes:[m.b],styles:[".igo-spinner-container[_ngcontent-%COMP%]{display:none;pointer-events:none}.igo-spinner-container.igo-spinner-shown[_ngcontent-%COMP%]{display:block}mat-progress-spinner[_ngcontent-%COMP%]{border-radius:50%;height:40px;width:40px}.igo-spinner-background[_ngcontent-%COMP%]{border:4px solid #fff;border-radius:50%;height:36px;left:2px;position:absolute;top:2px;width:36px}"]}),e})(),qi=(()=>{class e{constructor(e,t){this.spinner=e,this.activityService=t}ngOnInit(){this.counter$$=this.activityService.counter$.pipe(Object(S.a)(50)).subscribe(e=>{e>0?this.spinner.show():this.spinner.hide()})}ngOnDestroy(){this.counter$$.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(Bi,2),Object(i.gc)(U))},e.\u0275dir=Object(i.bc)({type:e,selectors:[["","igoSpinnerActivity",""]]}),e})(),Gi=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,Ye.b]]}),e})();class Vi{constructor(e){this.dataChange=new C.a([]),e&&this.dataChange.next(e)}get data(){return this.dataChange.value}set(e){this.dataChange.next(e)}add(e){const t=this.data.slice();t.push(e),this.set(t)}remove(e){const t=this.data.slice(),o=t.indexOf(e);t.splice(o,1),this.set(t)}}class Ui extends We.b{constructor(e,t,o){super(),this._database=e,this._model=t,this._sort=o,this._filterChange=new C.a("")}get filter(){return this._filterChange.value}set filter(e){this._filterChange.next(e)}connect(){if(!this._database)return Object(Te.a)([]);const e=[this._database.dataChange,this._filterChange,this._sort.sortChange];return Object(Te.a)(...e).pipe(Object(j.a)(()=>this.getFilteredData(this._database.data)),Object(j.a)(e=>this.getSortedData(e)))}disconnect(){}getFilteredData(e){return this.filter?e.slice().filter(e=>-1!==this._model.columns.filter(e=>e.filterable).map(t=>E.resolve(e,t.name)).join(" ").toLowerCase().indexOf(this.filter.toLowerCase())):e}getSortedData(e){return this._sort.active&&""!==this._sort.direction?e.sort((e,t)=>{const o=E.resolve(e,this._sort.active),i=E.resolve(t,this._sort.active);return E.naturalCompare(i,o,this._sort.direction)}):e}}var Hi=function(e){return e[e.primary=0]="primary",e[e.accent=1]="accent",e[e.warn=2]="warn",e}({});const Yi=["filter"];function Wi(e,t){1&e&&(Object(i.mc)(0,"div",12),Object(i.mc)(1,"mat-form-field",13),Object(i.hc)(2,"input",14,15),Object(i.yc)(4,"translate"),Object(i.lc)(),Object(i.lc)()),2&e&&(Object(i.Tb)(2),Object(i.Dc)("placeholder",Object(i.zc)(4,1,"igo.common.table.filter")))}function Ki(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"th",16),Object(i.mc)(1,"mat-checkbox",17),Object(i.tc)("change",(function(t){Object(i.Nc)(e);const o=Object(i.xc)();return t?o.masterToggle():null})),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Tb)(1),Object(i.Dc)("checked",e.selection.hasValue()&&e.isAllSelected())("indeterminate",e.selection.hasValue()&&!e.isAllSelected())}}function Zi(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"td",18),Object(i.mc)(1,"mat-checkbox",19),Object(i.tc)("click",(function(t){return Object(i.Nc)(e),t.stopPropagation()}))("change",(function(o){Object(i.Nc)(e);const r=t.$implicit,s=Object(i.xc)();return o?s.selection.toggle(r):null})),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=t.$implicit,o=Object(i.xc)();Object(i.Tb)(1),Object(i.Dc)("checked",o.selection.isSelected(e))}}function Qi(e,t){if(1&e&&(Object(i.mc)(0,"th",25),Object(i.ad)(1),Object(i.lc)()),2&e){const e=Object(i.xc)(2).$implicit;Object(i.Tb)(1),Object(i.cd)(" ",e.title," ")}}function Ji(e,t){1&e&&(Object(i.kc)(0),Object(i.Yc)(1,Qi,2,1,"th",24),Object(i.jc)())}function Xi(e,t){if(1&e&&(Object(i.mc)(0,"th",16),Object(i.ad)(1),Object(i.lc)()),2&e){const e=Object(i.xc)(2).$implicit;Object(i.Tb)(1),Object(i.cd)(" ",e.title," ")}}function er(e,t){1&e&&(Object(i.kc)(0),Object(i.Yc)(1,Xi,2,1,"th",6),Object(i.jc)())}const tr=function(){return{}};function or(e,t){if(1&e&&(Object(i.mc)(0,"td",27),Object(i.ad)(1),Object(i.lc)()),2&e){const e=t.$implicit,o=Object(i.xc)(2).$implicit,r=Object(i.xc)();Object(i.Dc)("ngClass",r.model.cellClassFunc?r.model.cellClassFunc(e,o):Object(i.Fc)(2,tr)),Object(i.Tb)(1),Object(i.cd)(" ",r.getValue(e,o.name)," ")}}function ir(e,t){1&e&&(Object(i.kc)(0),Object(i.Yc)(1,or,2,3,"td",26),Object(i.jc)())}function rr(e,t){if(1&e&&Object(i.hc)(0,"td",29),2&e){const e=t.$implicit,o=Object(i.xc)(2).$implicit,r=Object(i.xc)();Object(i.Dc)("ngClass",r.model.cellClassFunc?r.model.cellClassFunc(e,o):Object(i.Fc)(2,tr))("innerHTML",r.getValue(e,o.name),i.Oc)}}function sr(e,t){1&e&&Object(i.Yc)(0,rr,1,3,"td",28)}function ar(e,t){if(1&e&&(Object(i.kc)(0,20),Object(i.Yc)(1,Ji,2,0,"ng-container",21),Object(i.Yc)(2,er,2,0,"ng-container",21),Object(i.Yc)(3,ir,2,0,"ng-container",22),Object(i.Yc)(4,sr,1,0,"ng-template",null,23,i.Zc),Object(i.jc)()),2&e){const e=t.$implicit,o=Object(i.Kc)(5);Object(i.Dc)("matColumnDef",e.name),Object(i.Tb)(1),Object(i.Dc)("ngIf",e.sortable),Object(i.Tb)(1),Object(i.Dc)("ngIf",!e.sortable),Object(i.Tb)(1),Object(i.Dc)("ngIf",!e.html)("ngIfElse",o)}}function nr(e,t){1&e&&Object(i.hc)(0,"th",16)}function cr(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",31),Object(i.tc)("click",(function(o){Object(i.Nc)(e);const r=t.$implicit,s=Object(i.xc)().$implicit;return Object(i.xc)().handleClickAction(o,r,s)})),Object(i.hc)(1,"mat-icon",32),Object(i.lc)()}if(2&e){const e=t.$implicit,o=Object(i.xc)(2);Object(i.Dc)("color",o.getActionColor(e.color)),Object(i.Tb)(1),Object(i.Ec)("svgIcon",e.icon)}}function lr(e,t){if(1&e&&(Object(i.mc)(0,"td",18),Object(i.Yc)(1,cr,2,2,"button",30),Object(i.lc)()),2&e){const e=Object(i.xc)();Object(i.Tb)(1),Object(i.Dc)("ngForOf",e.model.actions)}}function ur(e,t){1&e&&Object(i.hc)(0,"tr",33)}function dr(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"tr",34),Object(i.tc)("click",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)().selection.toggle(o)})),Object(i.lc)()}if(2&e){const e=t.$implicit,o=Object(i.xc)();Object(i.Dc)("ngClass",o.model.rowClassFunc?o.model.rowClassFunc(e):Object(i.Fc)(1,tr))}}let hr=(()=>{class e{constructor(){this._hasFIlterInput=!0,this.selection=new We.c(!0,[]),this.select=new i.u}get database(){return this._database}set database(e){this._database=e}get model(){return this._model}set model(e){this._model=e}get hasFilterInput(){return this._hasFIlterInput}set hasFilterInput(e){this._hasFIlterInput=e}ngOnInit(){this.dataSource=new Ui(this.database,this.model,this.sort),this.model&&(this.displayedColumns=this.model.columns.filter(e=>!1!==e.displayed).map(e=>e.name),this.model.selectionCheckbox&&this.displayedColumns.unshift("selectionCheckbox"),this.model.actions&&this.model.actions.length&&this.displayedColumns.push("action")),this.selection.changed.subscribe(e=>this.select.emit(e))}ngAfterViewInit(){this.filter&&Object(F.a)(this.filter.nativeElement,"keyup").pipe(Object(S.a)(150),Object(D.a)()).subscribe(()=>{this.dataSource&&(this.dataSource.filter=this.filter.nativeElement.value)})}ngOnChanges(e){e.database&&(this.dataSource=new Ui(this.database,this.model,this.sort),this.selection.clear())}getActionColor(e){return Hi[e]}getValue(e,t){return E.resolve(e,t)}isAllSelected(){return this.selection.selected.length===this.database.data.length}masterToggle(){this.isAllSelected()?this.selection.clear():this.database.data.forEach(e=>this.selection.select(e))}handleClickAction(e,t,o){e.stopPropagation(),t.click(o)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-table"]],viewQuery:function(e,t){var o;1&e&&(Object(i.fd)(Yi,!0),Object(i.Uc)(Ee.a,!0)),2&e&&(Object(i.Jc)(o=Object(i.uc)())&&(t.filter=o.first),Object(i.Jc)(o=Object(i.uc)())&&(t.sort=o.first))},inputs:{database:"database",model:"model",hasFilterInput:"hasFilterInput"},outputs:{select:"select"},features:[i.Rb],decls:14,vars:5,consts:[[1,"table-box"],["class","table-header",4,"ngIf"],[1,"table-container"],["mat-table","","matSort","",3,"dataSource"],["table",""],["matColumnDef","selectionCheckbox"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"ngClass","click",4,"matRowDef","matRowDefColumns"],[1,"table-header"],["floatPlaceholder","never"],["matInput","",3,"placeholder"],["filter",""],["mat-header-cell",""],[3,"checked","indeterminate","change"],["mat-cell",""],[3,"checked","click","change"],[3,"matColumnDef"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["cellHTML",""],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell","","class","mat-cell-text",3,"ngClass",4,"matCellDef"],["mat-cell","",1,"mat-cell-text",3,"ngClass"],["mat-cell","","class","mat-cell-text",3,"ngClass","innerHTML",4,"matCellDef"],["mat-cell","",1,"mat-cell-text",3,"ngClass","innerHTML"],["mat-mini-fab","",3,"color","click",4,"ngFor","ngForOf"],["mat-mini-fab","",3,"color","click"],[3,"svgIcon"],["mat-header-row",""],["mat-row","",3,"ngClass","click"]],template:function(e,t){1&e&&(Object(i.mc)(0,"div",0),Object(i.Yc)(1,Wi,5,3,"div",1),Object(i.mc)(2,"div",2),Object(i.mc)(3,"table",3,4),Object(i.kc)(5,5),Object(i.Yc)(6,Ki,2,2,"th",6),Object(i.Yc)(7,Zi,2,1,"td",7),Object(i.jc)(),Object(i.Yc)(8,ar,6,5,"ng-container",8),Object(i.kc)(9,9),Object(i.Yc)(10,nr,1,0,"th",6),Object(i.Yc)(11,lr,2,1,"td",7),Object(i.jc)(),Object(i.Yc)(12,ur,1,0,"tr",10),Object(i.Yc)(13,dr,1,2,"tr",11),Object(i.lc)(),Object(i.lc)(),Object(i.lc)()),2&e&&(Object(i.Tb)(1),Object(i.Dc)("ngIf",t.hasFilterInput),Object(i.Tb)(2),Object(i.Dc)("dataSource",t.dataSource),Object(i.Tb)(5),Object(i.Dc)("ngForOf",t.model.columns),Object(i.Tb)(4),Object(i.Dc)("matHeaderRowDef",t.displayedColumns),Object(i.Tb)(1),Object(i.Dc)("matRowDefColumns",t.displayedColumns))},directives:[m.t,$e.o,Ee.a,$e.c,$e.i,$e.b,m.s,$e.k,$e.n,ke.c,Ve.b,$e.h,b.a,$e.a,Ee.b,m.q,n.b,c.a,$e.j,$e.m],pipes:[q.e],styles:["[_nghost-%COMP%]{display:block;height:100%;width:100%}.table-container[_ngcontent-%COMP%]{display:flex;flex:1 1 auto;flex-direction:column;height:100%;overflow:auto}.table-box[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.table-header[_ngcontent-%COMP%]{align-items:baseline;display:flex;flex:0 1 auto;font-size:20px;justify-content:space-between;max-width:500px;min-height:64px;padding:8px 24px 0}tr[mat-header-row][_ngcontent-%COMP%], tr[mat-row][_ngcontent-%COMP%]{height:60px}.mat-cell-text[_ngcontent-%COMP%]{overflow:hidden;word-wrap:break-word}td[mat-cell][_ngcontent-%COMP%]{padding-right:15px}th.mat-header-cell[_ngcontent-%COMP%]{padding-right:5px}button[_ngcontent-%COMP%]{margin-right:10px}"]}),e})(),pr=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,Ue.m,Ke.r,c.b,n.c,$e.q,ke.e,Ve.c,Ee.c,b.b,ie]]}),e})();var mr=function(e){return e.White="white",e.Grey="grey",e.Primary="primary",e}({});function gr(e="300ms",t="ease-in-out"){return Object(Ze.n)("toolSlideInOut",[Object(Ze.k)("enter",Object(Ze.l)({transform:"translate3d(0, 0, 0)"})),Object(Ze.m)("void => enter",Object(Ze.e)(e+" "+t))])}function br(e,t){if(1&e&&(Object(i.hc)(0,"igo-actionbar",2),Object(i.yc)(1,"async"),Object(i.yc)(2,"async"),Object(i.yc)(3,"async")),2&e){const e=Object(i.xc)();Object(i.Dc)("store",e.actionStore)("withIcon",!0)("withTitle",Object(i.zc)(1,6,e.toolbarWithTitle$))("withTooltip",!Object(i.zc)(2,8,e.toolbarWithTitle$))("scrollActive",Object(i.zc)(3,10,e.toolbarWithTitle$))("horizontal",!1)}}const fr=function(e,t){return{"igo-tool-container-with-toolbar":e,"igo-tool-container-with-animation":t}};function yr(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"div",3),Object(i.tc)("@toolSlideInOut.start",(function(){return Object(i.Nc)(e),Object(i.xc)().onAnimationStart()}))("@toolSlideInOut.done",(function(){return Object(i.Nc)(e),Object(i.xc)().onAnimationComplete()})),Object(i.yc)(1,"async"),Object(i.hc)(2,"igo-dynamic-outlet",4),Object(i.lc)()}if(2&e){const e=t.ngIf,o=Object(i.xc)();Object(i.Dc)("ngClass",Object(i.Hc)(6,fr,!o.actionStore.empty,o.animate))("@toolSlideInOut",Object(i.zc)(1,4,o.animation$)),Object(i.Tb)(2),Object(i.Dc)("component",e.component)("inputs",o.getToolInputs(e))}}let Or=(()=>{class e{constructor(){this.activeTool$=new C.a(void 0),this.actionStore=new ao([]),this.animation$=new C.a("none"),this.toolbar$=new C.a([]),this.toolbarWithTitle$=this.activeTool$.pipe(Object(j.a)(e=>void 0===e)),this.animating$=new C.a(!1),this.animate=!1,this.color=mr.White}get classColorGrey(){return this.color===mr.Grey}get classColorPrimary(){return this.color===mr.Primary}ngOnInit(){this.toolbar$$=this.toolbox.toolbar$.subscribe(e=>this.onToolbarChange(e)),this.activeTool$$=this.toolbox.activeTool$.subscribe(e=>this.onActiveToolChange(e))}ngOnDestroy(){this.toolbar$$.unsubscribe(),this.activeTool$$.unsubscribe(),this.actionStore.destroy()}onAnimationStart(){this.animating$.next(!0)}onAnimationComplete(){this.animating$.next(!1)}getToolInputs(e){return e.options||{}}onToolbarChange(e){this.setToolbar(e)}onActiveToolChange(e){this.animate?this.onAnimate(()=>this.setActiveTool(e)):this.setActiveTool(e)}setActiveTool(e){if(void 0===e)this.actionStore.state.updateAll({active:!1});else{const t=this.actionStore.get(e.name);void 0!==t&&this.actionStore.state.update(t,{active:!0},!0)}this.activeTool$.next(e),this.animate&&this.animation$.next("enter")}setToolbar(e){const t=e.reduce((e,t)=>{const o=this.toolbox.getTool(t);return void 0===o||e.push({id:o.name,title:o.title,icon:o.icon,tooltip:o.tooltip,args:[o,this.toolbox],handler:(e,t)=>{t.activateTool(e.name)},ngClass:(e,t)=>this.toolbox.activeTool$.pipe(Object(j.a)(t=>{let o=!1;void 0!==t&&e.name===t.name&&(o=!0);let i=!1;return void 0!==t&&e.name===t.parent&&(i=!0),{"tool-activated":o,"children-tool-activated":i}}))}),e},[]);this.actionStore.load(t),this.toolbar$.next(e)}onAnimate(e){this.unAnimate(),this.animating$$=this.animating$.subscribe(t=>{t||(e.call(this),this.unAnimate())})}unAnimate(){this.animating$$&&this.animating$$.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-toolbox"]],hostVars:4,hostBindings:function(e,t){2&e&&Object(i.Yb)("color-grey",t.classColorGrey)("color-primary",t.classColorPrimary)},inputs:{toolbox:"toolbox",animate:"animate",color:"color"},decls:4,vars:6,consts:[[3,"store","withIcon","withTitle","withTooltip","scrollActive","horizontal",4,"ngIf"],["class","igo-tool-container",3,"ngClass",4,"ngIf"],[3,"store","withIcon","withTitle","withTooltip","scrollActive","horizontal"],[1,"igo-tool-container",3,"ngClass"],[3,"component","inputs"]],template:function(e,t){1&e&&(Object(i.Yc)(0,br,4,12,"igo-actionbar",0),Object(i.yc)(1,"async"),Object(i.Yc)(2,yr,3,9,"div",1),Object(i.yc)(3,"async")),2&e&&(Object(i.Dc)("ngIf",Object(i.zc)(1,2,t.toolbar$).length>0),Object(i.Tb)(2),Object(i.Dc)("ngIf",Object(i.zc)(3,4,t.activeTool$)))},directives:[m.t,Co,m.q,Yo],pipes:[m.b],styles:["[_nghost-%COMP%]{display:block;height:100%;overflow:hidden;position:relative;width:100%}.igo-tool-container[_ngcontent-%COMP%]{bottom:0;left:0;position:absolute;right:0;top:0}.igo-tool-container-with-animation[_ngcontent-%COMP%]{transform:translate3d(100%,0,0)}.igo-tool-container-with-toolbar[_ngcontent-%COMP%]{left:50px}igo-actionbar[_ngcontent-%COMP%]{height:100%}igo-actionbar.with-title[_ngcontent-%COMP%]{overflow:auto;width:100%}igo-actionbar[_ngcontent-%COMP%]:not(.with-title){-o-box-shadow:2px 0 2px 0 #ddd;box-shadow:2px 0 2px 0 #ddd;overflow:hidden;width:48px}@media only screen and (orientation:landscape) and (max-width:959px),only screen and (orientation:portrait) and (max-width:599px){igo-actionbar[_ngcontent-%COMP%]:not(.with-title){overflow:auto}}igo-dynamic-outlet[_ngcontent-%COMP%]{overflow:auto}"],data:{animation:[gr()]},changeDetection:0}),e})(),vr=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,Lo,Ko]]}),e})(),jr=(()=>{class e{static forRoot(){return{ngModule:e,providers:[xi]}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c],vr]}),e})();function wr(e,t){if(1&e&&Object(i.hc)(0,"igo-dynamic-outlet",1),2&e){const e=Object(i.xc)();Object(i.Dc)("component",e.widget)("inputs",e.inputs)("subscribers",e.getEffectiveSubscribers())}}let Sr=(()=>{class e{constructor(){this.baseSubscribers={cancel:e=>this.onCancel(e),complete:e=>this.onComplete(e)},this.subscribers={},this.complete=new i.u,this.cancel=new i.u}ngOnDestroy(){this.destroyWidget()}getEffectiveSubscribers(){const e=Object.assign({},this.subscribers);return Object.keys(this.baseSubscribers).forEach(t=>{const o=e[t],i=this.baseSubscribers[t];e[t]=void 0!==o?e=>{o(e),i(e)}:i}),e}onCancel(e){this.cancel.emit(e),this.destroyWidget()}onComplete(e){this.complete.emit(e),this.destroyWidget()}destroyWidget(){void 0!==this.widget&&this.widget.destroy(),this.widget=void 0}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-widget-outlet"]],inputs:{widget:"widget",inputs:"inputs",subscribers:"subscribers"},outputs:{complete:"complete",cancel:"cancel"},decls:1,vars:1,consts:[[3,"component","inputs","subscribers",4,"ngIf"],[3,"component","inputs","subscribers"]],template:function(e,t){1&e&&Object(i.Yc)(0,wr,1,3,"igo-dynamic-outlet",0),2&e&&Object(i.Dc)("ngIf",t.widget)},directives:[m.t,Yo],styles:["igo-dynamic-outlet[_ngcontent-%COMP%]{height:100%}"],changeDetection:0}),e})(),xr=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,Ko]]}),e})(),Cr=(()=>{class e{constructor(e){this.dynamicComponentService=e}create(e){return this.dynamicComponentService.create(e)}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(Vo))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Tr=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},providers:[Cr],imports:[[m.c,xr],xr]}),e})();class Lr extends at{constructor(){super(...arguments),this.activeWorkspace$=new C.a(void 0)}activateWorkspace(e){const t=this.activeWorkspace$.value;void 0!==t&&t.deactivate(),this.deactivateWorkspace(),void 0!==e&&(this.state.update(e,{active:!0,selected:!0},!0),this.activeWorkspace$.next(e),e.activate())}deactivateWorkspace(){const e=this.activeWorkspace$.value;void 0!==e&&(e.deactivate(),this.activeWorkspace$.next(void 0))}}let Ir=(()=>{class e{constructor(){this.selectedChange=new i.u}getWorkspaceTitle(e){return ot(e)}onSelectedChange(e){const t=e.value;this.store.activateWorkspace(t),this.selectedChange.emit({selected:!0,value:t})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-workspace-selector"]],inputs:{store:"store"},outputs:{selectedChange:"selectedChange"},decls:1,vars:3,consts:[[3,"store","multi","titleAccessor","selectedChange"]],template:function(e,t){1&e&&(Object(i.mc)(0,"igo-entity-selector",0),Object(i.tc)("selectedChange",(function(e){return t.onSelectedChange(e)})),Object(i.lc)()),2&e&&Object(i.Dc)("store",t.store)("multi",!1)("titleAccessor",t.getWorkspaceTitle)},directives:[mt],styles:["igo-entity-selector[_ngcontent-%COMP%]     mat-form-field .mat-form-field-infix{padding:0}igo-entity-selector[_ngcontent-%COMP%]     mat-form-field .mat-form-field-wrapper{padding-bottom:1.75em}"],changeDetection:0}),e})(),Fr=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,gi]]}),e})();class Mr{constructor(e){this.options=e,this.widget$=new C.a(void 0),this.widgetInputs$=new C.a({}),this.widgetSubscribers$=new C.a({}),this.change=new k.a,this.active$=new C.a(!1)}get id(){return this.options.id}get title(){return this.options.title}get meta(){return this.options.meta||{}}get entityStore(){return this.options.entityStore}get actionStore(){return this.options.actionStore}get widget(){return this.widget$.value}get hasWidget(){return void 0!==this.widget}get active(){return this.active$.value}activate(){!0===this.active&&this.deactivate(),this.active$.next(!0),void 0!==this.entityStore&&(this.entities$$=this.entityStore.stateView.all$().subscribe(()=>this.onStateChange())),this.change.next()}deactivate(){this.active$.next(!1),this.deactivateWidget(),void 0!==this.entities$$&&this.entities$$.unsubscribe(),void 0!==this.change$&&this.change$.unsubscribe()}activateWidget(e,t={},o={}){this.widget$.next(e),this.widgetInputs$.next(t),this.widgetSubscribers$.next(o),this.change.next()}deactivateWidget(){this.widget$.next(void 0),this.change.next()}onStateChange(){this.change.next()}}function kr(e,t){if(1&e){const e=Object(i.nc)();Object(i.kc)(0),Object(i.mc)(1,"igo-widget-outlet",1),Object(i.tc)("cancel",(function(){Object(i.Nc)(e);const o=t.ngIf;return Object(i.xc)().onWidgetCancel(o)}))("complete",(function(){Object(i.Nc)(e);const o=t.ngIf;return Object(i.xc)().onWidgetComplete(o)})),Object(i.yc)(2,"async"),Object(i.yc)(3,"async"),Object(i.lc)(),Object(i.jc)()}if(2&e){const e=t.ngIf,o=Object(i.xc)();Object(i.Tb)(1),Object(i.Dc)("widget",e)("inputs",Object(i.zc)(2,3,o.widgetInputs$))("subscribers",Object(i.zc)(3,5,o.widgetSubscribers$))}}let Dr=(()=>{class e{constructor(){this.deactivateWidget=new i.u}get widget$(){return this.workspace.widget$}get widgetInputs$(){return this.workspace.widgetInputs$}get widgetSubscribers$(){return this.workspace.widgetSubscribers$}onWidgetCancel(e){this.workspace.deactivateWidget(),this.deactivateWidget.emit(e)}onWidgetComplete(e){this.workspace.deactivateWidget(),this.deactivateWidget.emit(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-workspace-widget-outlet"]],inputs:{workspace:"workspace"},outputs:{deactivateWidget:"deactivateWidget"},decls:2,vars:3,consts:[[4,"ngIf"],[3,"widget","inputs","subscribers","cancel","complete"]],template:function(e,t){1&e&&(Object(i.Yc)(0,kr,4,7,"ng-container",0),Object(i.yc)(1,"async")),2&e&&Object(i.Dc)("ngIf",Object(i.zc)(1,1,t.widget$))},directives:[m.t,Sr],pipes:[m.b],styles:["igo-widget-outlet[_ngcontent-%COMP%]{height:100%}"],changeDetection:0}),e})(),Pr=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,xr]]}),e})(),Ar=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c],Fr,Pr]}),e})();const $r=p.e.forChild([{path:"home",component:(()=>{class e{constructor(e){this.interactiveTourService=e}startTour(){this.interactiveTourService.startTour("global")}}return e.\u0275fac=function(t){return new(t||e)(i.gc(wi))},e.\u0275cmp=i.ac({type:e,selectors:[["app-home"]],decls:56,vars:0,consts:[[2,"text-align","center"],["id","igo-title"],["width","180","src","assets/igo2/core/logo.png",1,"igo-logo"],["tourToStart","global","menuIsOpen","true","styleButton","raised"],["target","_blank","rel","noopener","href","https://github.com/infra-geo-ouverte/igo2-lib/blob/master/README.md#user-installation"],["target","_blank","rel","noopener","href","https://angular.io/docs"]],template:function(e,t){1&e&&(i.mc(0,"div",0),i.mc(1,"h1",1),i.ad(2," Welcome to IGO "),i.lc(),i.hc(3,"img",2),i.lc(),i.mc(4,"p"),i.hc(5,"igo-interactive-tour",3),i.lc(),i.mc(6,"p"),i.ad(7," IGO2 library contains many components and services that may benefit any web application. "),i.hc(8,"br"),i.ad(9," IGO2 library is open source project using Angular, Angular Material and OpenLayers.\n"),i.lc(),i.mc(10,"h3"),i.ad(11,"IGO2 library is divided into several elements: "),i.lc(),i.mc(12,"ul"),i.mc(13,"li"),i.mc(14,"b"),i.ad(15,"@igo2/utils"),i.lc(),i.ad(16," : Basic utilies without dependency (ex: base64, clipboard, uuid)"),i.lc(),i.mc(17,"li"),i.mc(18,"b"),i.ad(19,"@igo2/core"),i.lc(),i.ad(20," : Element affecting the core of the application (ex: config, language, message, media, request)"),i.lc(),i.mc(21,"li"),i.mc(22,"b"),i.ad(23,"@igo2/common"),i.lc(),i.ad(24," : Library containing reusable components (ex: clickout, drag-drop, list, panel, spinner, table)"),i.lc(),i.mc(25,"li"),i.mc(26,"b"),i.ad(27,"@igo2/auth"),i.lc(),i.ad(28," : Library grouping the authentication and security module"),i.lc(),i.mc(29,"li"),i.mc(30,"b"),i.ad(31,"@igo2/geo"),i.lc(),i.ad(32," : Library containing the geomatic components. Depends on Openlayers."),i.lc(),i.mc(33,"li"),i.mc(34,"b"),i.ad(35,"@igo2/context"),i.lc(),i.ad(36," : Library of components uniting @igo2/geo and @igo2/auth"),i.lc(),i.mc(37,"li"),i.mc(38,"b"),i.ad(39,"@igo2/integration"),i.lc(),i.ad(40," : Library integrate basic components"),i.lc(),i.lc(),i.mc(41,"h2"),i.ad(42,"Here are some links to help you start: "),i.lc(),i.mc(43,"ul"),i.mc(44,"li"),i.mc(45,"h2"),i.mc(46,"a",4),i.ad(47,"Installation"),i.lc(),i.lc(),i.lc(),i.mc(48,"li"),i.mc(49,"h2"),i.mc(50,"a",5),i.ad(51,"Angular Documentation"),i.lc(),i.lc(),i.lc(),i.lc(),i.ad(52," *** Modules in "),i.mc(53,"code"),i.ad(54,"@igo2/core"),i.lc(),i.ad(55," must be imported only once\n"))},directives:[Ti],styles:[""]}),e})()}]);let Er=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[$r,Li,h.b,c.b,n.c]]}),e})();const Rr=p.e.forChild([{path:"activity",component:(()=>{class e{constructor(e){this.activityService=e,this.idsActivity=[]}register(){this.idsActivity.push(this.activityService.register())}unregister(){this.activityService.unregister(this.idsActivity.pop())}get counter(){return this.activityService.counter$.value}}return e.\u0275fac=function(t){return new(t||e)(i.gc(U))},e.\u0275cmp=i.ac({type:e,selectors:[["app-activity"]],decls:31,vars:1,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/activity"],["mat-raised-button","",3,"click"],["igoSpinnerActivity",""]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Core"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Activity"),i.lc(),i.mc(5,"mat-card-content"),i.mc(6,"p"),i.ad(7,"Register activities in service. Use to display a loading icon"),i.lc(),i.mc(8,"li"),i.ad(9,"Import "),i.mc(10,"code"),i.ad(11,"IgoActivityModule"),i.lc(),i.ad(12," only if you want register http calls"),i.lc(),i.mc(13,"li"),i.ad(14,"Import "),i.mc(15,"code"),i.ad(16,"IgoActivityModule"),i.lc(),i.ad(17," only once"),i.lc(),i.hc(18,"br"),i.ad(19," See the "),i.mc(20,"a",0),i.ad(21," code of this example"),i.lc(),i.hc(22,"hr"),i.lc(),i.mc(23,"mat-card-actions"),i.mc(24,"button",1),i.tc("click",(function(){return t.register()})),i.ad(25,"Register"),i.lc(),i.mc(26,"button",1),i.tc("click",(function(){return t.unregister()})),i.ad(27,"Unregister"),i.lc(),i.lc(),i.mc(28,"p"),i.ad(29),i.lc(),i.hc(30,"igo-spinner",2),i.lc()),2&e&&(i.Tb(29),i.cd("Counter: ",t.counter,""))},directives:[g.a,g.e,g.f,g.c,g.b,n.b,Bi,qi],styles:[""]}),e})()}]);let _r=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[Rr,g.d,n.c,Y.forRoot(),Gi]]}),e})();const zr=p.e.forChild([{path:"config",component:(()=>{class e{constructor(e){this.configService=e,this.configLanguage=this.configService.getConfig("language")}}return e.\u0275fac=function(t){return new(t||e)(i.gc(K))},e.\u0275cmp=i.ac({type:e,selectors:[["app-config"]],decls:26,vars:3,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/config"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/environments"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Core"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"config"),i.lc(),i.mc(5,"mat-card-content"),i.mc(6,"p"),i.ad(7,"Load config in your angular application"),i.lc(),i.mc(8,"li"),i.ad(9,"Import "),i.mc(10,"code"),i.ad(11,"IgoConfigModule"),i.lc(),i.ad(12," only once"),i.lc(),i.hc(13,"br"),i.ad(14," See the "),i.mc(15,"a",0),i.ad(16," code of this example"),i.lc(),i.hc(17,"br"),i.ad(18," See the "),i.mc(19,"a",1),i.ad(20," environment config"),i.lc(),i.hc(21,"hr"),i.lc(),i.mc(22,"p"),i.ad(23),i.yc(24,"json"),i.lc(),i.hc(25,"p"),i.lc()),2&e&&(i.Tb(23),i.cd("Config language: ",i.zc(24,1,t.configLanguage),""))},directives:[g.a,g.e,g.f,g.c],pipes:[m.k],styles:[""]}),e})()}]);let Nr=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},providers:[Q({default:r.igo})],imports:[[zr,m.c,g.d,n.c,X.forRoot()]]}),e})();const Br=p.e.forChild([{path:"language",component:(()=>{class e{constructor(e){this.languageService=e,this.app={title:"IGO"}}changeLanguage(e){this.languageService.setLanguage(e),console.log(this.languageService)}}return e.\u0275fac=function(t){return new(t||e)(i.gc(le))},e.\u0275cmp=i.ac({type:e,selectors:[["app-language"]],decls:35,vars:4,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/language"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/environments"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/locale"],["mat-raised-button","",3,"click"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Core"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"language"),i.lc(),i.mc(5,"mat-card-content"),i.mc(6,"p"),i.ad(7,"Translate your angular application"),i.lc(),i.mc(8,"li"),i.ad(9,"Import "),i.mc(10,"code"),i.ad(11,"IgoLanguageModule"),i.lc(),i.ad(12," only once"),i.lc(),i.hc(13,"br"),i.ad(14," See the "),i.mc(15,"a",0),i.ad(16,"code of this example"),i.lc(),i.hc(17,"br"),i.ad(18," See language section of the "),i.mc(19,"a",1),i.ad(20," environment config"),i.lc(),i.hc(21,"br"),i.ad(22," See "),i.mc(23,"a",2),i.ad(24,"locale files"),i.lc(),i.hc(25,"hr"),i.lc(),i.mc(26,"mat-card-actions"),i.mc(27,"button",3),i.tc("click",(function(){return t.changeLanguage("en")})),i.ad(28,"English"),i.lc(),i.mc(29,"button",3),i.tc("click",(function(){return t.changeLanguage("fr")})),i.ad(30,"Fran\xe7ais"),i.lc(),i.lc(),i.mc(31,"p"),i.ad(32),i.yc(33,"translate"),i.lc(),i.hc(34,"p"),i.lc()),2&e&&(i.Tb(32),i.bd(i.Ac(33,1,"welcome",t.app)))},directives:[g.a,g.e,g.f,g.c,g.b,n.b],pipes:[q.e],styles:[""]}),e})()}]);let qr=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[Br,g.d,n.c,ie.forRoot()]]}),e})();const Gr=p.e.forChild([{path:"media",component:(()=>{class e{constructor(e){this.mediaService=e}get media(){return this.mediaService.getMedia()}get orientation(){return this.mediaService.getOrientation()}get isTouchScreen(){return this.mediaService.isTouchScreen()}}return e.\u0275fac=function(t){return new(t||e)(i.gc(be))},e.\u0275cmp=i.ac({type:e,selectors:[["app-media"]],decls:19,vars:3,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/media"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Core"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Media"),i.lc(),i.mc(5,"mat-card-content"),i.mc(6,"p"),i.ad(7,"Detect type of media (mobile, tablet, desktop)"),i.lc(),i.hc(8,"br"),i.ad(9," See the "),i.mc(10,"a",0),i.ad(11,"code of this example"),i.lc(),i.hc(12,"hr"),i.lc(),i.mc(13,"p"),i.ad(14),i.lc(),i.mc(15,"p"),i.ad(16),i.lc(),i.mc(17,"p"),i.ad(18),i.lc(),i.lc()),2&e&&(i.Tb(14),i.cd("Current media: ",t.media,""),i.Tb(2),i.cd("Current orientation: ",t.orientation,""),i.Tb(2),i.cd("Device mode: ",t.isTouchScreen?"Touch device":"Not a touch device ",""))},directives:[g.a,g.e,g.f,g.c],styles:[""]}),e})()}]);let Vr=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[Gr,g.d]]}),e})();const Ur=p.e.forChild([{path:"message",component:(()=>{class e{constructor(e){this.messageService=e}success(){this.messageService.success("Congratulations","Success")}info(){this.messageService.info("Welcome to IGO","Info")}alert(){this.messageService.alert("Warning","Alert")}error(){this.messageService.error("There is a bug","Error")}}return e.\u0275fac=function(t){return new(t||e)(i.gc(ce))},e.\u0275cmp=i.ac({type:e,selectors:[["app-message"]],decls:30,vars:0,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/message"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","accent",3,"click"],["mat-raised-button","","color","warn",3,"click"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Core"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Message"),i.lc(),i.mc(5,"mat-card-content"),i.mc(6,"p"),i.ad(7,"Show message to user."),i.lc(),i.mc(8,"li"),i.ad(9,"Import "),i.mc(10,"code"),i.ad(11,"IgoMessageModule"),i.lc(),i.ad(12," only once"),i.lc(),i.mc(13,"li"),i.ad(14,"Dependencies: BrowserAnimationsModule "),i.lc(),i.hc(15,"br"),i.ad(16," See the "),i.mc(17,"a",0),i.ad(18,"code of this example"),i.lc(),i.hc(19,"hr"),i.lc(),i.mc(20,"mat-card-actions"),i.mc(21,"button",1),i.tc("click",(function(){return t.success()})),i.ad(22,"Success message"),i.lc(),i.mc(23,"button",2),i.tc("click",(function(){return t.info()})),i.ad(24,"Info message"),i.lc(),i.mc(25,"button",3),i.tc("click",(function(){return t.alert()})),i.ad(26,"Alert message"),i.lc(),i.mc(27,"button",4),i.tc("click",(function(){return t.error()})),i.ad(28,"Error message"),i.lc(),i.lc(),i.lc(),i.hc(29,"igo-message-center"))},directives:[g.a,g.e,g.f,g.c,g.b,n.b,se],styles:[""]}),e})()}]);let Hr=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[Ur,g.d,n.c,ae.forRoot()]]}),e})();const Yr=p.e.forChild([{path:"request",component:(()=>{class e{constructor(e,t){this.http=e,this.languageService=t}callHttp(){this.http.get("https://geoegl.msp.gouv.qc.ca/apis/icherche/info").subscribe(e=>{console.log(e)})}callHttpError(){this.http.get("404").subscribe(e=>{console.log(e)})}}return e.\u0275fac=function(t){return new(t||e)(i.gc(y.b),i.gc(le))},e.\u0275cmp=i.ac({type:e,selectors:[["app-request"]],decls:30,vars:0,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/request"],["mat-raised-button","",3,"click"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Core"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Request"),i.lc(),i.mc(5,"mat-card-content"),i.mc(6,"p"),i.ad(7,"Register http calls in console"),i.lc(),i.mc(8,"li"),i.ad(9,"Import "),i.mc(10,"code"),i.ad(11,"IgoLoggingModule"),i.lc(),i.ad(12," only if you want register http calls in console"),i.lc(),i.mc(13,"li"),i.ad(14,"Import "),i.mc(15,"code"),i.ad(16,"IgoErrorModule"),i.lc(),i.ad(17," only if you want register errors from http call in console"),i.lc(),i.mc(18,"li"),i.ad(19,"Import modules only once"),i.lc(),i.hc(20,"br"),i.ad(21," See the "),i.mc(22,"a",0),i.ad(23,"code of this example"),i.lc(),i.hc(24,"hr"),i.lc(),i.mc(25,"mat-card-actions"),i.mc(26,"button",1),i.tc("click",(function(){return t.callHttp()})),i.ad(27,"Log"),i.lc(),i.mc(28,"button",1),i.tc("click",(function(){return t.callHttpError()})),i.ad(29,"Error"),i.lc(),i.lc(),i.lc())},directives:[g.a,g.e,g.f,g.c,g.b,n.b],styles:[""]}),e})()}]);let Wr=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[Yr,g.d,n.c,y.d,ie.forRoot(),de.forRoot()]]}),e})();function Kr(e,t){if(1&e&&i.hc(0,"igo-actionbar",4),2&e){const e=i.xc();i.Dc("store",e.store)("withIcon",!0)("horizontal",!0)("mode","context")}}const Zr=p.e.forChild([{path:"action",component:(()=>{class e{constructor(e,t,o){this.overlay=e,this.mediaService=t,this.languageService=o,this.store=new ao([]),this.added$=new C.a(!1)}get actionbarMode(){return this.mediaService.media$.value===me.Desktop&&this.mediaService.orientation$.value===ge.Landscape?so.Dock:so.Overlay}ngOnInit(){this.store.load([{id:"add",title:"Add",icon:"plus",tooltip:"Add Tooltip",handler:()=>{alert("Add!"),this.added$.next(!0)}},{id:"edit",title:"Edit",icon:"pencil",tooltip:"Edit Tooltip",args:["1"],handler:e=>{alert(`Edit item ${e}!`)},availability:()=>this.added$},{id:"delete",title:"Delete",tooltip:"Delete Tooltip",icon:"delete",handler:()=>{alert("Delete!"),this.added$.next(!1)},availability:()=>this.added$}])}ngOnDestroy(){this.store.destroy()}}return e.\u0275fac=function(t){return new(t||e)(i.gc(Ne.c),i.gc(be),i.gc(le))},e.\u0275cmp=i.ac({type:e,selectors:[["app-action"]],decls:19,vars:6,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/action"],[3,"store","withIcon","withTitle","horizontal","mode"],[3,"igoContextMenu"],["actionbarMenu",""],[3,"store","withIcon","horizontal","mode"]],template:function(e,t){if(1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Common"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Action"),i.lc(),i.mc(5,"mat-card-content"),i.ad(6," See the "),i.mc(7,"a",0),i.ad(8,"code of this example"),i.lc(),i.lc(),i.hc(9,"igo-actionbar",1),i.lc(),i.hc(10,"p"),i.mc(11,"mat-card",2),i.mc(12,"mat-card-subtitle"),i.ad(13,"Common"),i.lc(),i.mc(14,"mat-card-title"),i.ad(15,"Action context-menu"),i.lc(),i.hc(16,"div"),i.lc(),i.Yc(17,Kr,1,4,"ng-template",null,3,i.Zc)),2&e){const e=i.Kc(18);i.Tb(9),i.Dc("store",t.store)("withIcon",!0)("withTitle","overlay"===t.actionbarMode)("horizontal",!0)("mode",t.actionbarMode),i.Tb(2),i.Dc("igoContextMenu",e)}},directives:[g.a,g.e,g.f,g.c,Co,zo],styles:["code[_ngcontent-%COMP%], pre[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e})()}]);let Qr=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[Zr,n.c,g.d,Lo,No]]}),e})(),Jr=(()=>{class e{constructor(e){this.cdRef=e}onUpdateInputs(){this.cdRef.detectChanges()}}return e.\u0275fac=function(t){return new(t||e)(i.gc(i.j))},e.\u0275cmp=i.ac({type:e,selectors:[["app-salutation-component"]],inputs:{name:"name"},decls:2,vars:1,template:function(e,t){1&e&&(i.mc(0,"p"),i.ad(1),i.lc()),2&e&&(i.Tb(1),i.cd("Hello, my name is ",t.name,"."))},encapsulation:2,changeDetection:0}),e})(),Xr=(()=>{class e{constructor(e){this.cdRef=e}onUpdateInputs(){this.cdRef.detectChanges()}}return e.\u0275fac=function(t){return new(t||e)(i.gc(i.j))},e.\u0275cmp=i.ac({type:e,selectors:[["app-explanation-component"]],decls:2,vars:0,template:function(e,t){1&e&&(i.mc(0,"p"),i.ad(1,"I am a dynamic component, rendered into an IgoDynamicOutlet."),i.lc())},encapsulation:2,changeDetection:0}),e})();const es=p.e.forChild([{path:"dynamic-component",component:(()=>{class e{constructor(){this.component=Jr,this.inputs={name:"Bob"}}toggleComponent(){this.component=this.component===Jr?Xr:Jr}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.ac({type:e,selectors:[["app-dynamic-component"]],decls:12,vars:2,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/dynamic-component"],[3,"component","inputs"],["mat-flat-button","","color","primary",3,"click"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Common"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Dynamic Component"),i.lc(),i.mc(5,"mat-card-content"),i.ad(6," See the "),i.mc(7,"a",0),i.ad(8,"code of this example"),i.lc(),i.lc(),i.hc(9,"igo-dynamic-outlet",1),i.mc(10,"button",2),i.tc("click",(function(){return t.toggleComponent()})),i.ad(11,"Toggle Component"),i.lc(),i.lc()),2&e&&(i.Tb(9),i.Dc("component",t.component)("inputs",t.inputs))},directives:[g.a,g.e,g.f,g.c,Yo,n.b],styles:["code[_ngcontent-%COMP%], pre[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e})()}]);let ts=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[es,n.c,g.d,Ko]]}),e})();const os=p.e.forChild([{path:"entity-table",component:(()=>{class e{constructor(e){this.languageService=e,this.store=new at([]),this.entitySortChange$=new C.a(!1),this.paginatorOptions={pageSize:10},this.template={selection:!0,selectionCheckbox:!0,selectMany:!0,sort:!0,valueAccessor:(e,t)=>et(e,t),columns:[{name:"selected",title:"Selected",valueAccessor:e=>this.store.state.get(e).selected?"radiobox-marked":"radiobox-blank",renderer:Qe.Icon},{name:"id",title:"ID"},{name:"name",title:"Name"},{name:"description",title:"Description",renderer:Qe.HTML},{name:"url",title:"Hyperlink"},{name:"image",title:"Image"},{name:"action",title:"",valueAccessor:e=>[{icon:"home",color:"warn",click:e=>{console.log(e)}}],renderer:Qe.ButtonGroup}]}}ngOnInit(){const e=[2,1,3,4,5,6,7,8,9,10,11,12,13].map(e=>({id:e,name:"Name "+e,description:`<b>Description ${e}</b>`,url:"https://igouverte.org",image:"http://www.igouverte.org/assets/img/Igo_logoavec.png"}));this.store.load(e)}entitySortChange(){this.entitySortChange$.next(!0)}paginatorChange(e){this.paginator=e}ngOnDestroy(){this.store.destroy()}}return e.\u0275fac=function(t){return new(t||e)(i.gc(le))},e.\u0275cmp=i.ac({type:e,selectors:[["app-entity-table"]],decls:10,vars:4,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/entity-table"],[3,"store","withPaginator","paginatorOptions","template","entitySortChange"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Common"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Entity Table"),i.lc(),i.mc(5,"mat-card-content"),i.ad(6," See the "),i.mc(7,"a",0),i.ad(8,"code of this example"),i.lc(),i.lc(),i.mc(9,"igo-entity-table",1),i.tc("entitySortChange",(function(){return t.entitySortChange()})),i.lc(),i.lc()),2&e&&(i.Tb(9),i.Dc("store",t.store)("withPaginator",!0)("paginatorOptions",t.paginatorOptions)("template",t.template))},directives:[g.a,g.e,g.f,g.c,ro],styles:["code[_ngcontent-%COMP%], pre[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e})()}]);let is=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[os,g.d,Oi,fi]]}),e})();function rs(e,t){if(1&e&&(i.mc(0,"div"),i.mc(1,"p"),i.ad(2),i.lc(),i.mc(3,"p"),i.ad(4),i.lc(),i.mc(5,"p"),i.ad(6,"Description: "),i.hc(7,"span",3),i.lc(),i.lc()),2&e){const e=t.ngIf;i.Tb(2),i.cd("ID: ",e.id,""),i.Tb(2),i.cd("Name: ",e.name,""),i.Tb(3),i.Dc("innerHtml",e.description,i.Oc)}}const ss=p.e.forChild([{path:"entity-selector",component:(()=>{class e{constructor(e){this.languageService=e,this.store=new at([]),this.selected$=new C.a(void 0)}ngOnInit(){this.store.load([{id:"2",name:"Name 2",description:"<b>Description 2</b>"},{id:"1",name:"Name 1",description:"<b>Description 1</b>"},{id:"3",name:"Name 3",description:"<b>Description 3</b>"}])}ngOnDestroy(){this.store.destroy()}getTitle(e){return e.name}onSelectedChange(e){this.selected$.next(e.entity)}}return e.\u0275fac=function(t){return new(t||e)(i.gc(le))},e.\u0275cmp=i.ac({type:e,selectors:[["app-entity-selector"]],decls:12,vars:7,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/entity-selector"],[3,"store","titleAccessor","emptyText","placeholder","selectedChange"],[4,"ngIf"],[3,"innerHtml"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Common"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Entity Selector"),i.lc(),i.mc(5,"mat-card-content"),i.ad(6," See the "),i.mc(7,"a",0),i.ad(8,"code of this example"),i.lc(),i.lc(),i.mc(9,"igo-entity-selector",1),i.tc("selectedChange",(function(e){return t.onSelectedChange(e)})),i.lc(),i.Yc(10,rs,8,3,"div",2),i.yc(11,"async"),i.lc()),2&e&&(i.Tb(9),i.Dc("store",t.store)("titleAccessor",t.getTitle)("emptyText","")("placeholder","Select an entity"),i.Tb(1),i.Dc("ngIf",i.zc(11,5,t.selected$)))},directives:[g.a,g.e,g.f,g.c,mt,m.t],pipes:[m.b],styles:["code[_ngcontent-%COMP%], pre[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e})()}]);let as=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[m.c,ss,g.d,gi]]}),e})();function ns(e,t){if(1&e){const e=i.nc();i.mc(0,"igo-form",2),i.tc("submitForm",(function(t){return i.Nc(e),i.xc().onSubmit(t)})),i.yc(1,"async"),i.hc(2,"igo-form-group",3),i.mc(3,"div",4),i.mc(4,"button",5),i.tc("click",(function(){return i.Nc(e),i.xc().fillForm()})),i.ad(5," Fill Form "),i.lc(),i.mc(6,"button",5),i.tc("click",(function(){return i.Nc(e),i.xc().clearForm()})),i.ad(7," Clear Form "),i.lc(),i.mc(8,"button",6),i.ad(9," Submit "),i.lc(),i.lc(),i.lc()}if(2&e){const e=t.ngIf,o=i.xc();i.Dc("form",e)("formData",i.zc(1,4,o.data$)),i.Tb(2),i.Dc("group",e.groups[0]),i.Tb(6),i.Dc("disabled",o.submitDisabled)}}const cs=p.e.forChild([{path:"form",component:(()=>{class e{constructor(e,t){this.formService=e,this.languageService=t,this.form$=new C.a(void 0),this.data$=new C.a(void 0),this.submitDisabled=!0}ngOnInit(){const e=[{name:"id",title:"ID",options:{cols:1,validator:Ue.G.required}},{name:"name",title:"Name",options:{cols:1,validator:Ue.G.required}},{name:"status",title:"Status",type:"select",options:{cols:2},inputs:{choices:[{value:1,title:"Single"},{value:2,title:"Married"}]}}].map(e=>this.formService.field(e)),t=this.formService.form([],[this.formService.group({name:"info"},e)]);this.valueChanges$$=t.control.valueChanges.subscribe(()=>{this.submitDisabled=!t.control.valid}),this.form$.next(t)}ngOnDestroy(){this.valueChanges$$.unsubscribe()}fillForm(){this.data$.next({id:1,name:"Bob",status:2})}clearForm(){this.form$.value.control.reset()}onSubmit(e){alert(JSON.stringify(e))}}return e.\u0275fac=function(t){return new(t||e)(i.gc(ri),i.gc(le))},e.\u0275cmp=i.ac({type:e,selectors:[["app-form"]],decls:11,vars:3,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/form"],[3,"form","formData","submitForm",4,"ngIf"],[3,"form","formData","submitForm"],[3,"group"],["formButtons",""],["mat-stroked-button","","type","button","color","primary",3,"click"],["mat-flat-button","","type","submit","color","primary",3,"disabled"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Common"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Form"),i.lc(),i.mc(5,"mat-card-content"),i.ad(6," See the "),i.mc(7,"a",0),i.ad(8,"code of this example"),i.lc(),i.lc(),i.Yc(9,ns,10,6,"igo-form",1),i.yc(10,"async"),i.lc()),2&e&&(i.Tb(9),i.Dc("ngIf",i.zc(10,1,t.form$)))},directives:[g.a,g.e,g.f,g.c,m.t,ti,hi,n.b],pipes:[m.b],styles:["code[_ngcontent-%COMP%], pre[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e})()}]);let ls=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[m.c,cs,n.c,g.d,mi]]}),e})();const us=p.e.forChild([{path:"table",component:(()=>{class e{constructor(e){this.languageService=e,this.model={columns:[{name:"id",title:"ID",sortable:!1,filterable:!0},{name:"name",title:"Name",sortable:!0,filterable:!0},{name:"description",title:"Description",sortable:!0,filterable:!0}],actions:[{icon:"file-document",color:Hi.primary,click:e=>this.showName(e.name)}],selectionCheckbox:!0}}ngOnInit(){this.database=new Vi([{id:"2",name:"Name 2",description:"Hello 2"},{id:"1",name:"Name 1",description:"Bonjour 1"},{id:"3",name:"Name 3",description:"Hola 3"}])}showName(e){alert(e)}handleSelect(e){console.log(e)}}return e.\u0275fac=function(t){return new(t||e)(i.gc(le))},e.\u0275cmp=i.ac({type:e,selectors:[["app-table"]],decls:10,vars:3,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/table"],[3,"database","model","hasFilterInput","select"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Common"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Table"),i.lc(),i.mc(5,"mat-card-content"),i.ad(6," See the "),i.mc(7,"a",0),i.ad(8,"code of this example"),i.lc(),i.lc(),i.mc(9,"igo-table",1),i.tc("select",(function(e){return t.handleSelect(e)})),i.lc(),i.lc()),2&e&&(i.Tb(9),i.Dc("database",t.database)("model",t.model)("hasFilterInput",!0))},directives:[g.a,g.e,g.f,g.c,hr],styles:["code[_ngcontent-%COMP%], pre[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e})()}]);let ds=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[us,g.d,pr]]}),e})();function hs(e,t){if(1&e){const e=i.nc();i.mc(0,"button",6),i.tc("click",(function(){return i.Nc(e),i.xc().toolbox.activatePreviousTool()})),i.hc(1,"mat-icon",7),i.lc()}}function ps(e,t){if(1&e){const e=i.nc();i.mc(0,"button",8),i.tc("click",(function(){return i.Nc(e),i.xc().toolbox.deactivateTool()})),i.hc(1,"mat-icon",9),i.lc()}}const ms=p.e.forChild([{path:"tool",component:(()=>{class e{constructor(e,t){this.toolService=e,this.languageService=t,this.toolbox=new Si}get activeTool$(){return this.toolbox.activeTool$}get panelTitle(){return this.activeTool$.value?this.activeTool$.value.title:"Toolbox"}ngOnInit(){this.toolbox.setToolbar(["demo-salutation","demo-about"]),this.toolbox.setTools(this.toolService.getTools())}ngOnDestroy(){this.toolbox.destroy()}activateSalutationTool(){this.toolbox.activateTool("demo-salutation",{name:"Bob"})}}return e.\u0275fac=function(t){return new(t||e)(i.gc(xi),i.gc(le))},e.\u0275cmp=i.ac({type:e,selectors:[["app-tool"]],decls:17,vars:9,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/tool"],[3,"title"],["mat-icon-button","","panelLeftButton","",3,"click",4,"ngIf"],["mat-icon-button","","panelRightButton","",3,"click",4,"ngIf"],[3,"toolbox","animate"],["mat-flat-button","","type","button","color","primary",3,"click"],["mat-icon-button","","panelLeftButton","",3,"click"],["svgIcon","arrow-back"],["mat-icon-button","","panelRightButton","",3,"click"],["svgIcon","menu"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Common"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Tool"),i.lc(),i.mc(5,"mat-card-content"),i.ad(6," See the "),i.mc(7,"a",0),i.ad(8,"code of this example"),i.lc(),i.lc(),i.mc(9,"igo-panel",1),i.Yc(10,hs,2,0,"button",2),i.yc(11,"async"),i.Yc(12,ps,2,0,"button",3),i.yc(13,"async"),i.hc(14,"igo-toolbox",4),i.lc(),i.mc(15,"button",5),i.tc("click",(function(){return t.activateSalutationTool()})),i.ad(16," Activate Salutation Tool "),i.lc(),i.lc()),2&e&&(i.Tb(9),i.Dc("title",t.panelTitle),i.Tb(1),i.Dc("ngIf",i.zc(11,5,t.activeTool$)),i.Tb(2),i.Dc("ngIf",i.zc(13,7,t.activeTool$)),i.Tb(2),i.Dc("toolbox",t.toolbox)("animate",!0))},directives:[g.a,g.e,g.f,g.c,_i,m.t,Or,n.b,c.a],pipes:[m.b],styles:["code[_ngcontent-%COMP%], pre[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e})()}]);let gs=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[m.c,ms,n.c,c.b,g.d,ie,zi,jr.forRoot()]]}),e})(),bs=(()=>{class e{constructor(e){this.cdRef=e,this.complete=new i.u,this.cancel=new i.u}onUpdateInputs(){this.cdRef.detectChanges()}}return e.\u0275fac=function(t){return new(t||e)(i.gc(i.j))},e.\u0275cmp=i.ac({type:e,selectors:[["app-salutation-widget"]],inputs:{name:"name"},outputs:{complete:"complete",cancel:"cancel"},decls:6,vars:1,consts:[["mat-flat-button","",3,"click"]],template:function(e,t){1&e&&(i.mc(0,"p"),i.ad(1),i.lc(),i.mc(2,"button",0),i.tc("click",(function(){return t.complete.emit(t.name)})),i.ad(3,"Nice to meet you"),i.lc(),i.mc(4,"button",0),i.tc("click",(function(){return t.cancel.emit(t.name)})),i.ad(5,"Dismiss"),i.lc()),2&e&&(i.Tb(1),i.cd("Hello, my name is ",t.name,"."))},directives:[n.b],encapsulation:2,changeDetection:0}),e})();const fs=p.e.forChild([{path:"widget",component:(()=>{class e{constructor(e){this.widgetService=e,this.widget=this.widgetService.create(bs),this.inputs={name:"Bob"}}onWidgetComplete(e){alert(e+" emitted event 'complete' then got automatically destroyed.")}onWidgetCancel(){alert("Widget emitted event 'cancel' then got automatically destroyed.")}}return e.\u0275fac=function(t){return new(t||e)(i.gc(Cr))},e.\u0275cmp=i.ac({type:e,selectors:[["app-widget"]],decls:10,vars:2,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/widget"],[3,"widget","inputs","complete","cancel"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Common"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Widget"),i.lc(),i.mc(5,"mat-card-content"),i.ad(6," See the "),i.mc(7,"a",0),i.ad(8,"code of this example"),i.lc(),i.lc(),i.mc(9,"igo-widget-outlet",1),i.tc("complete",(function(e){return t.onWidgetComplete(e)}))("cancel",(function(){return t.onWidgetCancel()})),i.lc(),i.lc()),2&e&&(i.Tb(9),i.Dc("widget",t.widget)("inputs",t.inputs))},directives:[g.a,g.e,g.f,g.c,Sr],styles:["code[_ngcontent-%COMP%], pre[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e})()}]);let ys=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[fs,n.c,g.d,Tr]]}),e})();var Os=o("BOF4"),vs=o.n(Os),js=o("l+12"),ws=o("kScs");let Ss=(()=>{class e{constructor(e){this.injector=e}set(e){localStorage.setItem(this.tokenKey,e)}remove(){localStorage.removeItem(this.tokenKey)}get(){return localStorage.getItem(this.tokenKey)}decode(){const e=this.get();if(e)return vs()(e)}isExpired(){const e=this.decode(),t=(new Date).getTime()/1e3;return!(e&&t<e.exp)}get tokenKey(){const e=this.injector.get(K);return this.options=e.getConfig("auth")||{},this.options.tokenKey}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(i.C))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),xs=(()=>{class e{constructor(e,t,o,i,r,s){this.http=e,this.tokenService=t,this.config=o,this.languageService=i,this.messageService=r,this.router=s,this.authenticate$=new C.a(void 0),this.logged$=new C.a(void 0),this.anonymous=!1,this.authenticate$.next(this.authenticated),this.authenticate$.subscribe(e=>{this.logged$.next(e),ze.b.next()})}get hasAuthService(){return void 0!==this.config.getConfig("auth.url")}login(e,t){const o=new y.f({"Content-Type":"application/json"}),i={username:e,password:this.encodePassword(t)};return this.loginCall(i,o)}loginWithToken(e,t){const o=new y.f({"Content-Type":"application/json"});return this.loginCall({token:e,typeConnection:t},o)}loginAnonymous(){return this.anonymous=!0,this.logged$.next(!0),Object(L.a)(!0)}refresh(){const e=this.config.getConfig("auth.url");return this.http.post(e+"/refresh",{}).pipe(Object(w.a)(e=>{this.tokenService.set(e.token)}),Object(v.a)(e=>{throw e.error.caught=!0,e}))}logout(){return this.anonymous=!1,this.tokenService.remove(),this.authenticate$.next(!1),Object(L.a)(!0)}isAuthenticated(){return!this.tokenService.isExpired()}getToken(){return this.tokenService.get()}decodeToken(){return!!this.isAuthenticated()&&this.tokenService.decode()}goToRedirectUrl(){if(!this.router)return;const e=this.redirectUrl||this.router.url,t=this.config.getConfig("auth")||{};e===t.loginRoute?this.router.navigateByUrl(t.homeRoute||"/"):e&&this.router.navigateByUrl(e)}getUserInfo(){const e=this.config.getConfig("auth.url")+"/info";return this.http.get(e)}getProfils(){const e=this.config.getConfig("auth.url");return this.http.get(e+"/profils")}updateUser(e){const t=this.config.getConfig("auth.url");return this.http.patch(t,e)}encodePassword(e){return P.encode(e)}get logged(){return this.authenticated||this.isAnonymous}get isAnonymous(){return this.anonymous}get authenticated(){return this.isAuthenticated()}get isAdmin(){const e=this.decodeToken();return!!(e&&e.user&&e.user.isAdmin)}loginCall(e,t){const o=this.config.getConfig("auth.url");return this.http.post(o+"/login",e,{headers:t}).pipe(Object(w.a)(e=>{this.tokenService.set(e.token);const t=this.decodeToken();t&&t.user&&(t.user.locale&&this.languageService.setLanguage(t.user.locale),t.user.isExpired&&this.languageService.translate.get("igo.auth.error.Password expired").subscribe(e=>this.messageService.alert(e))),this.authenticate$.next(!0)}),Object(v.a)(e=>{throw e.error.caught=!0,e}))}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(y.b),Object(i.qc)(Ss),Object(i.qc)(K),Object(i.qc)(le),Object(i.qc)(ce),Object(i.qc)(p.c,8))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Cs=(()=>{class e{constructor(e,t,o,r){this.authService=e,this.config=t,this.languageService=o,this.appRef=r,this.login=new i.u,this.options=this.config.getConfig("auth.google")||{},this.options.apiKey&&this.options.clientId?(this.loadSDKGoogle(),this.loadPlatform()):console.warn('Google authentification needs "apiKey" and "clientId" options')}handleSignInClick(){window.gapi.auth2.getAuthInstance().signIn()}handleSignOutClick(){window.gapi.auth2.getAuthInstance().signOut()}handleClientLoad(){window.gapi.load("client:auth2",()=>this.initClient())}initClient(){window.gapi.client.init({apiKey:this.options.apiKey,clientId:this.options.clientId,discoveryDocs:["https://people.googleapis.com/$discovery/rest?version=v1"],scope:"profile"}).then(()=>{this.handleSignOutClick(),this.updateTextButton(),window.gapi.auth2.getAuthInstance().isSignedIn.listen(e=>{this.updateSigninStatus(e)})})}updateSigninStatus(e){this.updateTextButton(),e&&this.loginGoogle(window.gapi.client.getToken().access_token)}updateTextButton(){const e=document.querySelector('span[id^="not_signed_"]');e&&"en"!==this.languageService.getLanguage()&&("Sign in with Google"===e.innerHTML?e.innerHTML=this.languageService.translate.instant("igo.auth.google.login"):"Signed in with Google"===e.innerHTML&&(e.innerHTML=this.languageService.translate.instant("igo.auth.google.logged")))}loginGoogle(e){this.authService.loginWithToken(e,"google").subscribe(()=>{this.appRef.tick(),this.login.emit(!0)})}loadSDKGoogle(){const e=document.getElementsByTagName("script")[0],t=document.createElement("script");t.id="google-jssdk",t.src="https://apis.google.com/js/api.js",t.onload=()=>{this.handleClientLoad()},e.parentNode.insertBefore(t,e)}loadPlatform(){const e=document.getElementsByTagName("script")[0],t=document.createElement("script");t.id="google-platform",t.src="https://apis.google.com/js/platform.js",e.parentNode.insertBefore(t,e)}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(xs),Object(i.gc)(K),Object(i.gc)(le),Object(i.gc)(i.g))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-auth-google"]],outputs:{login:"login"},decls:1,vars:0,consts:[["data-height","40","data-width","265","data-longtitle","true",1,"g-signin2","google-login-button"]],template:function(e,t){1&e&&Object(i.hc)(0,"div",0)},styles:["[_nghost-%COMP%]{display:inline-block;padding:10px 10px 10px 0}.google-login-button[_ngcontent-%COMP%]     .abcRioButton{color:rgba(0,0,0,.87)}"],changeDetection:0}),e})(),Ts=(()=>{class e{constructor(e,t,o,r,s){this.authService=e,this.config=t,this.appRef=o,this.broadcastService=r,this.msalService=s,this.login=new i.u,this.options=this.config.getConfig("auth.microsoft")||{},this.options.clientId?this.broadcastService.subscribe("msal:loginSuccess",()=>{this.checkAccount()}):console.warn('Microsoft authentification needs "clientId" option')}loginMicrosoft(){this.msalService.loginPopup()}checkAccount(){this.msalService.acquireTokenSilent({scopes:["user.read"]}).then(e=>{this.authService.loginWithToken(e.accessToken,"microsoft").subscribe(()=>{this.appRef.tick(),this.login.emit(!0)})})}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(xs),Object(i.gc)(K),Object(i.gc)(i.g),Object(i.gc)(js.a),Object(i.gc)(js.e))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-auth-microsoft"]],outputs:{login:"login"},decls:4,vars:3,consts:[["mat-raised-button","",1,"microsoft-login-button",3,"click"],["svgIcon","microsoft"]],template:function(e,t){1&e&&(Object(i.mc)(0,"button",0),Object(i.tc)("click",(function(){return t.loginMicrosoft()})),Object(i.hc)(1,"mat-icon",1),Object(i.ad)(2),Object(i.yc)(3,"translate"),Object(i.lc)()),2&e&&(Object(i.Tb)(2),Object(i.cd)(" ",Object(i.zc)(3,1,"igo.auth.microsoft.login"),"\n"))},directives:[n.b,c.a],pipes:[q.e],styles:["[_nghost-%COMP%]{display:inline-block;padding:10px 10px 10px 0;position:relative;top:-15px}[_nghost-%COMP%] > button[_ngcontent-%COMP%]{font-size:15px;height:40px;width:265px}mat-icon[_ngcontent-%COMP%]{margin-right:10px}"],changeDetection:0}),e})(),Ls=(()=>{class e{constructor(e,t,o){this.authService=e,this.config=t,this.appRef=o,this.login=new i.u,this.options=this.config.getConfig("auth.facebook")||{},this.options.appId?this.loadSDKFacebook():console.warn('Facebook authentification needs "appId" option')}subscribeEvents(){window.FB.Event.subscribe("auth.statusChange",e=>{this.statusChangeCallback(e)})}statusChangeCallback(e){"connected"===e.status&&this.loginFacebook(e.authResponse.accessToken)}loginFacebook(e){this.authService.loginWithToken(e,"facebook").subscribe(()=>{this.appRef.tick(),this.login.emit(!0)})}loadSDKFacebook(){if(document.getElementById("facebook-jssdk"))return;const e=document.getElementsByTagName("script")[0],t=document.createElement("script");t.id="facebook-jssdk",t.src="https://connect.facebook.net/fr_CA/sdk.js#xfbml=1&version=v2.9&appId="+this.options.appId,t.onload=()=>{this.subscribeEvents()},e.parentNode.insertBefore(t,e)}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(xs),Object(i.gc)(K),Object(i.gc)(i.g))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-auth-facebook"]],outputs:{login:"login"},decls:1,vars:0,consts:[["scope","public_profile,email","data-max-rows","1","data-size","large","data-button-type","login_with","data-show-faces","false","data-auto-logout-link","false","data-use-continue-as","false",1,"fb-login-button"]],template:function(e,t){1&e&&Object(i.hc)(0,"div",0)},styles:["[_nghost-%COMP%]{display:inline-block;padding:10px 10px 10px 0;position:relative;top:-3px}"],changeDetection:0}),e})();function Is(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",7),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.xc)().loginAnonymous()})),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Dc)("disabled",e.loading),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(2,2,"igo.auth.accessAnonymous")," ")}}function Fs(e,t){if(1&e&&(Object(i.mc)(0,"div"),Object(i.hc)(1,"br"),Object(i.mc)(2,"font",8),Object(i.ad)(3),Object(i.lc)(),Object(i.lc)()),2&e){const e=Object(i.xc)();Object(i.Tb)(3),Object(i.bd)(e.error)}}let Ms=(()=>{class e{constructor(e,t,o){this.auth=e,this.languageService=t,this._allowAnonymous=!0,this.error="",this.loading=!1,this.login=new i.u,this.form=o.group({username:["",Ue.G.required],password:["",Ue.G.required]})}get allowAnonymous(){return this._allowAnonymous}set allowAnonymous(e){this._allowAnonymous=e}loginUser(e){return this.loading=!0,this.auth.login(e.username,e.password).subscribe(()=>{this.login.emit(!0),this.loading=!1},e=>{try{this.languageService.translate.get("igo.auth.error."+e.error.message).subscribe(e=>this.error=e)}catch(t){this.error=e.error.message}this.loading=!1}),!1}loginAnonymous(){this.auth.loginAnonymous().subscribe(()=>{this.login.emit(!0)})}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(xs),Object(i.gc)(le),Object(i.gc)(Ue.g))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-auth-intern"]],inputs:{allowAnonymous:"allowAnonymous"},outputs:{login:"login"},decls:14,vars:13,consts:[["role","form",3,"formGroup","ngSubmit"],[1,"full-width"],["matInput","","required","","formControlName","username",3,"placeholder"],["matInput","","required","","type","password","formControlName","password",3,"placeholder"],["mat-raised-button","","type","submit",3,"disabled"],["mat-raised-button","","class","anonymous","type","button",3,"disabled","click",4,"ngIf"],[4,"ngIf"],["mat-raised-button","","type","button",1,"anonymous",3,"disabled","click"],["size","3","color","red"]],template:function(e,t){1&e&&(Object(i.mc)(0,"form",0),Object(i.tc)("ngSubmit",(function(){return t.loginUser(t.form.value)})),Object(i.mc)(1,"div"),Object(i.mc)(2,"mat-form-field",1),Object(i.hc)(3,"input",2),Object(i.yc)(4,"translate"),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(5,"div"),Object(i.mc)(6,"mat-form-field",1),Object(i.hc)(7,"input",3),Object(i.yc)(8,"translate"),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(9,"button",4),Object(i.ad)(10),Object(i.yc)(11,"translate"),Object(i.lc)(),Object(i.Yc)(12,Is,3,4,"button",5),Object(i.Yc)(13,Fs,4,1,"div",6),Object(i.lc)()),2&e&&(Object(i.Dc)("formGroup",t.form),Object(i.Tb)(3),Object(i.Ec)("placeholder",Object(i.zc)(4,7,"igo.auth.user")),Object(i.Tb)(4),Object(i.Ec)("placeholder",Object(i.zc)(8,9,"igo.auth.password")),Object(i.Tb)(2),Object(i.Dc)("disabled",!t.form.valid||t.loading),Object(i.Tb)(1),Object(i.bd)(Object(i.zc)(11,11,"igo.auth.login")),Object(i.Tb)(2),Object(i.Dc)("ngIf",t.allowAnonymous),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.error))},directives:[Ue.I,Ue.t,Ue.k,ke.c,Ve.b,Ue.d,Ue.D,Ue.s,Ue.j,n.b,m.t],pipes:[q.e],styles:[".full-width[_ngcontent-%COMP%]{width:100%}.anonymous[_ngcontent-%COMP%]{margin-left:10px}"]}),e})();function ks(e,t){1&e&&Object(i.hc)(0,"div",3)}function Ds(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"igo-auth-google",7),Object(i.tc)("login",(function(){return Object(i.Nc)(e),Object(i.xc)(3).onLogin()})),Object(i.lc)()}}function Ps(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"igo-auth-microsoft",7),Object(i.tc)("login",(function(){return Object(i.Nc)(e),Object(i.xc)(3).onLogin()})),Object(i.lc)()}}function As(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"igo-auth-facebook",7),Object(i.tc)("login",(function(){return Object(i.Nc)(e),Object(i.xc)(3).onLogin()})),Object(i.lc)()}}function $s(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"igo-auth-intern",8),Object(i.tc)("login",(function(){return Object(i.Nc)(e),Object(i.xc)(3).onLogin()})),Object(i.lc)()}if(2&e){const e=Object(i.xc)(3);Object(i.Dc)("allowAnonymous",e.options.allowAnonymous)}}function Es(e,t){if(1&e&&(Object(i.mc)(0,"div",4),Object(i.mc)(1,"h1"),Object(i.ad)(2),Object(i.yc)(3,"translate"),Object(i.lc)(),Object(i.Yc)(4,Ds,1,0,"igo-auth-google",5),Object(i.Yc)(5,Ps,1,0,"igo-auth-microsoft",5),Object(i.Yc)(6,As,1,0,"igo-auth-facebook",5),Object(i.Yc)(7,$s,1,1,"igo-auth-intern",6),Object(i.lc)()),2&e){const e=Object(i.xc)(2);Object(i.Tb)(2),Object(i.bd)(Object(i.zc)(3,5,"igo.auth.connection")),Object(i.Tb)(2),Object(i.Dc)("ngIf",e.options.google&&!1!==e.options.google.enabled),Object(i.Tb)(1),Object(i.Dc)("ngIf",e.options.microsoft&&!1!==e.options.microsoft.enabled),Object(i.Tb)(1),Object(i.Dc)("ngIf",e.options.facebook&&!1!==e.options.facebook.enabled),Object(i.Tb)(1),Object(i.Dc)("ngIf",!e.options.intern||!1!==e.options.intern.enabled)}}function Rs(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"div",4),Object(i.mc)(1,"p"),Object(i.ad)(2),Object(i.yc)(3,"translate"),Object(i.lc)(),Object(i.mc)(4,"button",9),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.xc)(2).logout()})),Object(i.ad)(5),Object(i.yc)(6,"translate"),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=Object(i.xc)(2);Object(i.Tb)(2),Object(i.bd)(Object(i.Ac)(3,2,"igo.auth.welcome",e.user)),Object(i.Tb)(3),Object(i.bd)(Object(i.zc)(6,5,"igo.auth.signOut"))}}function _s(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",9),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.xc)(3).home()})),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()}2&e&&(Object(i.Tb)(1),Object(i.bd)(Object(i.zc)(2,1,"igo.auth.home")))}function zs(e,t){if(1&e&&(Object(i.mc)(0,"div",4),Object(i.mc)(1,"p"),Object(i.ad)(2),Object(i.yc)(3,"translate"),Object(i.lc)(),Object(i.Yc)(4,_s,3,3,"button",10),Object(i.lc)()),2&e){const e=Object(i.xc)(2);Object(i.Tb)(2),Object(i.bd)(Object(i.zc)(3,2,"igo.auth.deconnection")),Object(i.Tb)(2),Object(i.Dc)("ngIf",e.options.homeRoute)}}function Ns(e,t){if(1&e&&(Object(i.mc)(0,"div"),Object(i.Yc)(1,ks,1,0,"div",1),Object(i.Yc)(2,Es,8,7,"div",2),Object(i.Yc)(3,Rs,7,7,"div",2),Object(i.Yc)(4,zs,5,4,"div",2),Object(i.lc)()),2&e){const e=Object(i.xc)();Object(i.Tb)(1),Object(i.Dc)("ngIf",!e.auth.logged&&e.backgroundDisable),Object(i.Tb)(1),Object(i.Dc)("ngIf",!e.auth.logged&&e.showLoginDiv),Object(i.Tb)(1),Object(i.Dc)("ngIf",e.auth.logged&&e.showAlreadyConnectedDiv),Object(i.Tb)(1),Object(i.Dc)("ngIf",e.showLogoutDiv)}}let Bs=(()=>{class e{constructor(e,t,o){this.auth=e,this.config=t,this.router=o,this._backgroundDisable=!0,this._hasAlreadyConnectedDiv=!0,this._hasLogoutDiv=!0,this._showAlreadyConnectedDiv=!1,this._showLogoutDiv=!1,this.login=new i.u,this.visible=!0,this.options=this.config.getConfig("auth")||{},this.visible=0!==Object.getOwnPropertyNames(this.options).length}get backgroundDisable(){return!this.isLogoutRoute&&!this.isLogoutRoute&&this._backgroundDisable}set backgroundDisable(e){this._backgroundDisable="true"===e.toString()}get hasAlreadyConnectedDiv(){return this._hasAlreadyConnectedDiv}set hasAlreadyConnectedDiv(e){this._hasAlreadyConnectedDiv="true"===e.toString()}get hasLogoutDiv(){return this._hasLogoutDiv}set hasLogoutDiv(e){this._hasLogoutDiv="true"===e.toString()}get showAlreadyConnectedDiv(){return this.isLogoutRoute?this.hasAlreadyConnectedDiv:this._showAlreadyConnectedDiv}set showAlreadyConnectedDiv(e){this._showAlreadyConnectedDiv="true"===e.toString()}get showLogoutDiv(){return this.isLogoutRoute?this.hasLogoutDiv:this._showLogoutDiv}set showLogoutDiv(e){this._showLogoutDiv="true"===e.toString()}get showLoginDiv(){if(!this.isLogoutRoute)return!0}ngOnInit(){this.analyzeRoute(),this.getName()}onLogin(){this.auth.goToRedirectUrl(),this.getName(),this.login.emit(!0)}logout(){this.auth.logout().subscribe(()=>{this.user=void 0,this.router&&(this.options.logoutRoute?this.router.navigate([this.options.logoutRoute]):this.options.homeRoute&&this.router.navigate([this.options.homeRoute]))})}home(){this.router&&this.options.homeRoute&&this.router.navigate([this.options.homeRoute])}getName(){const e=this.auth.decodeToken();e&&(this.user={name:e.user.firstName||e.user.sourceId})}analyzeRoute(){this.router&&this.router.events.pipe(Object(Fe.a)(e=>e instanceof p.b)).subscribe(e=>{if(e.url){const t=e.url,o=this.options.loginRoute;this.isLogoutRoute=t===this.options.logoutRoute,this.isLoginRoute=t===o,this.isLogoutRoute&&this.auth.logout()}})}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(xs),Object(i.gc)(K),Object(i.gc)(p.c,8))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-auth-form"]],inputs:{backgroundDisable:"backgroundDisable",hasAlreadyConnectedDiv:"hasAlreadyConnectedDiv",hasLogoutDiv:"hasLogoutDiv",showAlreadyConnectedDiv:"showAlreadyConnectedDiv",showLogoutDiv:"showLogoutDiv"},outputs:{login:"login"},decls:1,vars:1,consts:[[4,"ngIf"],["class","backgroundDisable",4,"ngIf"],["class","login center-block",4,"ngIf"],[1,"backgroundDisable"],[1,"login","center-block"],[3,"login",4,"ngIf"],[3,"allowAnonymous","login",4,"ngIf"],[3,"login"],[3,"allowAnonymous","login"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","button",3,"click",4,"ngIf"]],template:function(e,t){1&e&&Object(i.Yc)(0,Ns,5,4,"div",0),2&e&&Object(i.Dc)("ngIf",t.visible)},directives:[m.t,Cs,Ts,Ls,Ms,n.b],pipes:[q.e],styles:["[_nghost-%COMP%]{z-index:999}div.login[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #888;max-width:600px;min-width:360px;padding:25px 50px;width:90%;z-index:200}.center-block[_ngcontent-%COMP%]{left:50%;position:fixed;top:20%;transform:translate(-50%)}.backgroundDisable[_ngcontent-%COMP%]{background:#000;height:100%;left:0;opacity:.8;position:fixed;top:0;width:100%;z-index:100}"]}),e})(),qs=(()=>{class e{constructor(e,t,o){this.config=e,this.tokenService=t,this.http=o,this.refreshInProgress=!1}get trustHosts(){const e=this.config.getConfig("auth.trustHosts")||[];return e.push(window.location.hostname),e}get hostsWithCredentials(){return this.config.getConfig("auth.hostsWithCredentials")||[]}intercept(e,t){const o=this.handleHostsWithCredentials(e.url);let i=e.clone();o&&(i=e.clone({withCredentials:o})),this.refreshToken();const r=this.tokenService.get(),s=document.createElement("a");if(s.href=i.url,""===s.host&&(s.href=s.href),!r||-1===this.trustHosts.indexOf(s.hostname))return t.handle(i);let a=i.clone({headers:i.headers.set("Authorization","Bearer "+r)});const n=this.tokenService.decode();if("true"===a.params.get("_i")&&n&&n.user&&n.user.sourceId){const e=ws.Md5.hashStr(n.user.sourceId);a=a.clone({params:a.params.set("_i",e)})}else"true"===a.params.get("_i")&&(a=a.clone({params:a.params.delete("_i")}));return t.handle(a)}interceptXhr(e,t){const o=this.handleHostsWithCredentials(t);if(o)return e.withCredentials=o,!0;this.refreshToken();const i=document.createElement("a");i.href=t;const r=this.tokenService.get();return!(!r||-1===this.trustHosts.indexOf(i.hostname)||(e.setRequestHeader("Authorization","Bearer "+r),0))}handleHostsWithCredentials(e){let t=!1;for(const o of this.hostsWithCredentials)if(new RegExp(o.domainRegFilters).test(e)){t=void 0!==o.withCredentials?o.withCredentials:void 0;break}return t}refreshToken(){const e=this.tokenService.decode(),t=(new Date).getTime()/1e3;if(!this.refreshInProgress&&e&&t<e.exp&&t>e.exp-1800){this.refreshInProgress=!0;const e=this.config.getConfig("auth.url");return this.http.post(e+"/refresh",{}).subscribe(e=>{this.tokenService.set(e.token),this.refreshInProgress=!1},e=>(e.error.caught=!0,e))}}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(K),Object(i.qc)(Ss),Object(i.qc)(y.b))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Gs(e){return{auth:{clientId:(e.getConfig("auth.microsoft")||{}).clientId,authority:"https://login.microsoftonline.com/organizations",redirectUri:window.location.href},cache:{cacheLocation:"sessionStorage"}}}function Vs(){return{popUp:!0,consentScopes:["user.read"]}}let Us=(()=>{class e extends Oe{constructor(e,t,o,i){super(e),this.http=t,this.authService=o,this.tokenService=i,this.authService.authenticate$.subscribe(e=>{e&&this.options.url&&this.http.get(this.options.url).subscribe(e=>{if(e&&e.preference)for(const t of Object.keys(e.preference))super.set(t,e.preference[t])})})}set(e,t,o=fe.LOCAL){if(o===fe.LOCAL&&this.authService.authenticated&&this.options.url){const o={};o[e]=t,this.http.patch(this.options.url,{preference:o}).subscribe()}super.set(e,t,o)}remove(e,t=fe.LOCAL){if(t===fe.LOCAL&&this.authService.authenticated&&this.options.url){const t={};t[e]=void 0,this.http.patch(this.options.url,{preference:t}).subscribe()}super.remove(e,t)}clear(e=fe.LOCAL){let t;e===fe.LOCAL&&this.authService.authenticated&&this.options.url&&this.http.patch(this.options.url,{preference:{}},{params:{mergePreference:"false"}}).subscribe(),e===fe.LOCAL&&(t=this.tokenService.get()),super.clear(e),t&&this.tokenService.set(t),e===fe.LOCAL&&this.authService.authenticated&&this.options.url&&this.http.get(this.options.url).subscribe(e=>{if(e&&e.preference)for(const t of Object.keys(e.preference))super.set(t,e.preference[t])})}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(K),Object(i.qc)(y.b),Object(i.qc)(xs),Object(i.qc)(Ss))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Hs=(()=>{class e{static forRoot(){return{ngModule:e,providers:[{provide:y.a,useClass:qs,multi:!0},{provide:Oe,useClass:Us},{provide:js.b,useFactory:Gs,deps:[K]},{provide:js.c,useFactory:Vs},js.e]}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,Ue.C,ke.e,Ve.c,c.b,n.c,ie,js.d]]}),e})();const Ys=p.e.forChild([{path:"auth-form",component:(()=>{class e{constructor(e){this.languageService=e,this.idsActivity=[]}}return e.\u0275fac=function(t){return new(t||e)(i.gc(le))},e.\u0275cmp=i.ac({type:e,selectors:[["app-auth-form"]],decls:17,vars:0,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/auth/auth-form"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/environments"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Auth"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Authentification"),i.lc(),i.mc(5,"mat-card-content"),i.mc(6,"li"),i.ad(7,"Dependencies: ConfigService, LanguageService"),i.lc(),i.hc(8,"br"),i.ad(9," See the "),i.mc(10,"a",0),i.ad(11,"code of this example"),i.lc(),i.hc(12,"br"),i.ad(13," See auth section of the "),i.mc(14,"a",1),i.ad(15," environment config"),i.lc(),i.lc(),i.lc(),i.hc(16,"igo-auth-form"))},directives:[g.a,g.e,g.f,g.c,Bs],styles:["code[_ngcontent-%COMP%], pre[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e})()}]);let Ws=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[Ys,g.d,Hs.forRoot()]]}),e})();var Ks=o("cp0P"),Zs=o("1uah"),Qs=o("EY2u"),Js=o("PqYM"),Xs=o("SxV6"),ea=o("bOdf"),ta=o("32Ea"),oa=o("5+tZ"),ia=o("6eBy"),ra=o("1G5W"),sa=o("JW8z"),aa=o("YX0d"),na=o("Z5JD"),ca=o("WwCA"),la=o("ZNkr"),ua=o("PFxp"),da=o("wd/R"),ha=o("J8cP"),pa=o("zZjW"),ma=o("u+Ei"),ga=o("BZGc"),ba=o("5NB/"),fa=o("fzGS"),ya=o("WDFe"),Oa=o("0OmE"),va=o("LvFn"),ja=o("cV7i"),wa=o("9d2U"),Sa=o("1RAW"),xa=o("btgn"),Ca=o("CvXi"),Ta=o("gETL"),La=o("BdKp"),Ia=o("sJCy"),Fa=o("UEPW"),Ma=o("dmCH"),ka=o("eNvb"),Da=o("TN97"),Pa=o("eNsl"),Aa=o("/bf1"),$a=o("Vb2V"),Ea=o("B2q1"),Ra=o("FeBf"),_a=o("p5/s"),za=o("vIFP"),Na=o("yBBP"),Ba=o("SAzV"),qa=o("Pmt0"),Ga=o("Nafy"),Va=o("ykKD"),Ua=o("XDhV"),Ha=o("g03e"),Ya=o("l+a/"),Wa=o("Xu5n"),Ka=o("oscj"),Za=o("9T9f"),Qa=o("nUcq"),Ja=o("Ojm/"),Xa=o("+CJY"),en=o("Uhtb"),tn=o("W8M7"),on=o("9ANI"),rn=o("egkh"),sn=o("ouHB"),an=o("JfxD"),nn=o("zixo"),cn=o("1h4k"),ln=o("+isa"),un=o("DfXE"),dn=o("BSbQ"),hn=o("jMqV"),pn=o("mPVK"),mn=(o("8sFK"),o("9gLZ"),o("7KAL"),o("vrAh")),gn=o("Ynp+"),bn=o("E4Uz"),fn=o("rCk2"),yn=(o("EDhj"),o("0wsv"),o("bHcU")),On=o("eQqr"),vn=o("BxA5"),jn=o("oxbM"),wn=o("TN/R"),Sn=o("zQhy"),xn=o("M9ds"),Cn=o("OLiY"),Tn=o("Y9kJ"),Ln=o("yAeK"),In=o("0FFk"),Fn=o("BJ1j"),Mn=o("y7ui"),kn=o("Iab2"),Dn=o("5RHE"),Pn=o("wOnQ"),An=o.n(Pn),$n=o("xOOu"),En=o("Bviv");function Rn(e,t,o,i){t=t||0,o=o||0;const r=e<0;let s=Math.abs(e)+t/60+o/3600;return(r||"S"===i||"W"===i)&&(s=-s),s}function _n(e){return(e=Math.round(e))<1e4?e+"":(e=Math.round(e/1e3))<1e3?e+"K":(e=Math.round(e/1e3))+"M"}function zn(e,t=96){return e/(39.3701*t)}function Nn(e){const t=e.originalEvent;return!t.altKey&&(aa.d?t.metaKey:t.ctrlKey)&&!t.shiftKey}function Bn(e,t=3){return[e[0].toFixed(t),e[1].toFixed(t)]}var qn=function(e){return e.OPACITY="opacity",e.VISIBLE="visible",e.OGCFILTERS="ogcFilters",e.MINRESOLUTION="minResolution",e.MAXRESOLUTION="maxResolution",e.ZINDEX="zIndex",e.TIMEFILTER="timeFilter",e}({});function Gn(e){return({wms:Vn,wmts:Un,xyz:Hn,feature:Yn,wfs:Wn,arcgisrest:Kn,imagearcgisrest:Kn,tilearcgisrest:Kn,osm:e=>"OSM",tiledebug:e=>"tiledebug"}[e.type]||Zn)(e)}function Vn(e){const t=e.params.LAYERS,o=Qn(e.url);return ws.Md5.hashStr("wms"+o+t)}function Un(e){const t=e.layer,o=Qn(e.url);return ws.Md5.hashStr("wmts"+o+t)}function Hn(e){const t=Qn(e.url);return ws.Md5.hashStr("xyz"+t)}function Yn(e){if(!e.url)return Zn();const t=Qn(e.url);return ws.Md5.hashStr("feature"+t)}function Wn(e){if(!e.url||!e.params)return Zn();const t=Qn(e.url);return ws.Md5.hashStr("wfs"+t+e.params.featureTypes)}function Kn(e){const t=e.layer,o=Qn(e.url);return ws.Md5.hashStr((e.type||"arcgis")+o+t)}function Zn(e){return z()}function Qn(e){const t=("/"===e.charAt(0)?window.location.origin+e:e).split(/[?&]/);let o=t.shift();const i=t.filter(e=>0!==e.length&&"_"!==e.charAt(0));return i.length&&(o+="?"+i.join("&")),o}class Jn{constructor(e={},t){this.options=e,this.dataService=t,this.options=e,this.id=this.options.id||this.generateId(),this.ol=this.createOlSource()}generateId(){return Gn(this.options)}getLegend(e,t){return this.legend?this.legend:[]}setLegend(e){return this.legend=e.url?[{url:e.url}]:e.html?[{html:e.html}]:[],this.legend}}var Xn=function(e){return e.BasicNumericOperator="basicnumericoperator",e.Basic="basic",e.BasicAndSpatial="basicandspatial",e.Spatial="spatial",e.All="all",e.Time="time",e}({}),ec=function(e){return e.BBOX="BBox",e.PropertyIsBetween="PropertyIsBetween",e.Contains="Contains",e.During="During",e.PropertyIsEqualTo="PropertyIsEqualTo",e.PropertyIsGreaterThan="PropertyIsGreaterThan",e.PropertyIsGreaterThanOrEqualTo="PropertyIsGreaterThanOrEqualTo",e.Intersects="Intersects",e.PropertyIsNull="PropertyIsNull",e.PropertyIsLessThan="PropertyIsLessThan",e.PropertyIsLessThanOrEqualTo="PropertyIsLessThanOrEqualTo",e.PropertyIsLike="PropertyIsLike",e.PropertyIsNotEqualTo="PropertyIsNotEqualTo",e.Within="Within",e.And="And",e.Or="Or",e.Not="Not",e}({});const tc=da;class oc{constructor(){this.filterSequence=[],this.operators={[ec.PropertyIsEqualTo]:{spatial:!1,fieldRestrict:[]},[ec.PropertyIsNotEqualTo]:{spatial:!1,fieldRestrict:[]},[ec.PropertyIsLike]:{spatial:!1,fieldRestrict:["string"]},[ec.PropertyIsGreaterThan]:{spatial:!1,fieldRestrict:["number"]},[ec.PropertyIsGreaterThanOrEqualTo]:{spatial:!1,fieldRestrict:["number"]},[ec.PropertyIsLessThan]:{spatial:!1,fieldRestrict:["number"]},[ec.PropertyIsLessThanOrEqualTo]:{spatial:!1,fieldRestrict:["number"]},[ec.PropertyIsBetween]:{spatial:!1,fieldRestrict:["number"]},[ec.During]:{spatial:!1,fieldRestrict:[]},[ec.PropertyIsNull]:{spatial:!1,fieldRestrict:[]},[ec.Intersects]:{spatial:!0,fieldRestrict:[]},[ec.Within]:{spatial:!0,fieldRestrict:[]},[ec.Contains]:{spatial:!0,fieldRestrict:[]}}}defineOgcFiltersDefaultOptions(e,t,o){let i=!0;return o&&"wms"===o&&(i=!1),(e=e||{}).enabled=void 0===e.enabled?i:e.enabled,e.editable=void 0===e.editable?i:e.editable,e.geometryName=t,e.advancedOgcFilters=!0,e.enabled&&(e.pushButtons||e.checkboxes||e.radioButtons)&&(e.advancedOgcFilters=!1),e}buildFilter(e,t,o,i,r){let s,a,n;if(a=!/intersects|contains|within/gi.test(JSON.stringify(e)),e&&(i=void 0!==e.geometryName?e.geometryName:i),t&&e&&(s=Object(ca.b)(i,t,o.getCode())),!e)return"bbox="+t.join(",")+","+o.getCode();e=this.checkIgoFiltersProperties(e,i,o),n=t&&a?Object(ca.a)(s,this.bundleFilter(e,r)):this.bundleFilter(e,r);const c={srsName:"",featureNS:"",featurePrefix:"",featureTypes:["featureTypes"],filter:n,outputFormat:"",geometryName:i},l=(new ua.a).writeGetFeature(c);return"filter="+(new XMLSerializer).serializeToString(l).split(/typenames *=|typename *=\"featureTypes\" *>/gi)[1].split(/<\/Query><\/GetFeature>/gi)[0]}bundleFilter(e,t){if(e instanceof Array){const o=[];return e.forEach(e=>{o.push(this.bundleFilter(e,t))}),o}return e.hasOwnProperty("logical")?this.createFilter({operator:e.logical,logicalArray:this.bundleFilter(e.filters,t)},t):e.hasOwnProperty("operator")?this.createFilter(e,t):void 0}createFilter(e,t){const o=e.operator,i=e.logicalArray,r=e.propertyName,s=e.pattern,a=!e.matchCase||e.matchCase,n=e.wildCard?e.wildCard:"*",c=e.singleChar?e.singleChar:".",l=e.escapeChar?e.escapeChar:"!",u=e.lowerBoundary,d=e.upperBoundary,h=e.geometryName,p=e.extent,m=e.wkt_geometry,g=e.srsName?e.srsName:"EPSG:3857",b=this.parseFilterOptionDate(e.begin,t?t.minDate:void 0),f=this.parseFilterOptionDate(e.end,t?t.maxDate:void 0),y=e.expression;let O;switch(m&&(O=(new la.a).readGeometry(m,{dataProjection:g,featureProjection:g||"EPSG:3857"})),o.toLowerCase()){case ec.BBOX.toLowerCase():return Object(ca.b)(h,p,g);case ec.PropertyIsBetween.toLowerCase():return Object(ca.c)(r,u,d);case ec.Contains.toLowerCase():return Object(ca.d)(h,O,g);case ec.During.toLowerCase():return Object(ca.e)(r,b,f);case ec.PropertyIsEqualTo.toLowerCase():return Object(ca.f)(r,y,a);case ec.PropertyIsGreaterThan.toLowerCase():return Object(ca.g)(r,y);case ec.PropertyIsGreaterThanOrEqualTo.toLowerCase():return Object(ca.h)(r,y);case ec.Intersects.toLowerCase():return Object(ca.i)(h,O,g);case ec.PropertyIsNull.toLowerCase():return Object(ca.j)(r);case ec.PropertyIsLessThan.toLowerCase():return Object(ca.k)(r,y);case ec.PropertyIsLessThanOrEqualTo.toLowerCase():return Object(ca.l)(r,y);case ec.PropertyIsLike.toLowerCase():return Object(ca.m)(r,s.replace(/[()_]/gi,c),n,c,l,a);case ec.PropertyIsNotEqualTo.toLowerCase():return Object(ca.o)(r,y,a);case ec.Within.toLowerCase():return Object(ca.q)(h,O,g);case ec.And.toLowerCase():return ca.a.apply(null,i);case ec.Or.toLowerCase():return ca.p.apply(null,i);case ec.Not.toLowerCase():return ca.n.apply(null,i);default:return}}defineInterfaceFilterSequence(e,t,o="",i=-1){return e instanceof Array?e.forEach(e=>{this.filterSequence.concat(this.defineInterfaceFilterSequence(e,t,o,i))}):e.hasOwnProperty("logical")?this.filterSequence.concat(this.defineInterfaceFilterSequence(e.filters,t,e.logical,i+=1)):e.hasOwnProperty("operator")&&this.filterSequence.push(this.addInterfaceFilter(e,t,i,o)),this.filterSequence}computeAllowedOperators(e,t,o){let i,r,s,a={};if(e&&t){const r=e.find(e=>e.name===t);i=r&&r.allowedOperatorsType?r.allowedOperatorsType:o}switch(e&&e.map(e=>{if(!e.allowedOperatorsType)return;const t=e.allowedOperatorsType.toLowerCase();t!==Xn.All.toLowerCase()&&t!==Xn.Spatial.toLowerCase()&&t!==Xn.BasicAndSpatial.toLowerCase()||(r=!0,t===Xn.All.toLowerCase()&&(s=!0))}),i=i||Xn.BasicAndSpatial,i.toLowerCase()){case Xn.All:a=this.operators;break;case Xn.Spatial:a={[ec.Intersects]:{spatial:!0,fieldRestrict:[]},[ec.Within]:{spatial:!0,fieldRestrict:[]}};break;case Xn.BasicAndSpatial:a={[ec.PropertyIsEqualTo]:{spatial:!1,fieldRestrict:[]},[ec.PropertyIsNotEqualTo]:{spatial:!1,fieldRestrict:[]},[ec.Intersects]:{spatial:!0,fieldRestrict:[]},[ec.Within]:{spatial:!0,fieldRestrict:[]}};break;case Xn.Basic:a={[ec.PropertyIsEqualTo]:{spatial:!1,fieldRestrict:[]},[ec.PropertyIsNotEqualTo]:{spatial:!1,fieldRestrict:[]}};break;case Xn.Time:a={[ec.During]:{spatial:!1,fieldRestrict:[]}};break;case Xn.BasicNumericOperator:a={[ec.PropertyIsEqualTo]:{spatial:!1,fieldRestrict:[]},[ec.PropertyIsNotEqualTo]:{spatial:!1,fieldRestrict:[]},[ec.PropertyIsGreaterThan]:{spatial:!1,fieldRestrict:["number"]},[ec.PropertyIsGreaterThanOrEqualTo]:{spatial:!1,fieldRestrict:["number"]},[ec.PropertyIsLessThan]:{spatial:!1,fieldRestrict:["number"]},[ec.PropertyIsLessThanOrEqualTo]:{spatial:!1,fieldRestrict:["number"]}};break;default:a={[ec.PropertyIsEqualTo]:{spatial:!1,fieldRestrict:[]},[ec.PropertyIsNotEqualTo]:{spatial:!1,fieldRestrict:[]},[ec.Intersects]:{spatial:!0,fieldRestrict:[]},[ec.Within]:{spatial:!0,fieldRestrict:[]}}}return r&&(a.Intersects={spatial:!0,fieldRestrict:[]},a.Within={spatial:!0,fieldRestrict:[]},s&&(a.Contains={spatial:!0,fieldRestrict:[]})),a}addInterfaceFilter(e,t,o=0,i="Or"){e||(e={operator:"PropertyIsEqualTo"});const r={propertyName:"",operator:"",active:"",filterid:z(),step:"",begin:"",end:"",sliderOptions:{},lowerBoundary:"",upperBoundary:"",expression:"",pattern:"",wildCard:"*",singleChar:".",escapeChar:"!",matchCase:!0,igoSpatialSelector:"",igoSNRC:"",geometryName:"",geometry:"",wkt_geometry:"",extent:"",srsName:"",parentLogical:"",level:0};return Object.assign(r,{parentLogical:i,level:o,geometryName:t},e)}checkIgoFiltersProperties(e,t,o,i=!1){const r=[];return e instanceof Array?(e.forEach(e=>{r.push(this.checkIgoFiltersProperties(e,t,o,i))}),r):e.hasOwnProperty("logical")?Object.assign({},{logical:e.logical,filters:this.checkIgoFiltersProperties(e.filters,t,o,i)}):e.hasOwnProperty("operator")?this.addFilterProperties(e,t,o,i):void 0}addFilterProperties(e,t,o,i=!1){const r=e.hasOwnProperty("filterid")?e.filterid:z(),s=e.hasOwnProperty("active")?e.active:i,a=e.hasOwnProperty("srsName")?e.srsName:o?o.getCode():"EPSG:3857";return Object.assign({},{filterid:r,active:s,igoSpatialSelector:"fixedExtent",srsName:a},e,{geometryName:t})}rebuiltIgoOgcFilterObjectFromSequence(e){if(e instanceof Array&&e.length>=1){let t,o,i=e[0].parentLogical,r=[];return e.forEach(s=>{const a=Object.assign({},s),n=e.indexOf(s);t=n>=0&&n<e.length-1?e[n+1]:a,delete a.active,delete a.filterid,delete a.parentLogical,r.push(a),1===e.length?o=a:i!==t.parentLogical&&(1===r.length?console.log("You must set at least two operator in a logical ("+i+")"):(o=Object.assign({},{logical:i,filters:r}),r=[o],i=t.parentLogical))}),o}}computeIgoSelector(e){if(e.groups.every(e=>void 0!==e.computedSelectors))return e;let t;if(e.groups&&e.bundles){if(!e.bundles.every(e=>void 0!==e.id))throw new Error("You must set an id for each of your bundles");t=E.copyDeep(e),t.groups.forEach(e=>{e.title=e.title?e.title:e.name,e.enabled=!!e.enabled&&e.enabled,e.computedSelectors=E.copyDeep(t.bundles.filter(t=>e.ids.includes(t.id)))})}else!e.groups&&e.bundles?(t=E.copyDeep(e),t.groups=[{title:"group1",name:"group1",computedSelectors:E.copyDeep(t.bundles)}]):t={bundles:e,groups:[{title:"group1",name:"group1",computedSelectors:E.copyDeep(e)}],selectorType:t.selectorType};return t.groups.find(e=>e.enabled)||(t.groups[0].enabled=!0),t}handleOgcFiltersAppliedValue(e,t,o,i){const r=e.ogcFilters;if(!r)return;const s=[];let a="",n="";if(r.enabled&&(r.pushButtons||r.checkboxes||r.radioButtons)){let e;if(r.pushButtons){e=r.pushButtons;const t=this.formatGroupAndFilter(r,e);for(const e of t)s.push(e)}if(r.checkboxes){e=r.checkboxes;const t=this.formatGroupAndFilter(r,e);for(const e of t)s.push(e)}if(r.radioButtons){e=r.radioButtons;const t=this.formatGroupAndFilter(r,e);for(const e of t)s.push(e)}s.length>=1&&(a=this.buildFilter(1===s.length?s[0]:{logical:"And",filters:s},o,i,r.geometryName))}r.enabled&&r.filters&&(r.geometryName=r.geometryName||t,n=this.buildFilter(r.filters,o,i,r.geometryName,e));let c=r.advancedOgcFilters?n:a;return"wms"===e.type&&(c=this.formatProcessedOgcFilter(c,e.params.LAYERS)),"wfs"===e.type&&(c=this.formatProcessedOgcFilter(c,e.params.featureTypes)),c}formatGroupAndFilter(e,t){const o=(t=this.computeIgoSelector(t)).groups.find(e=>e.enabled).computedSelectors,i=[];return o.map(e=>{const t=[],o=e.selectors;o&&(o.filter(e=>!0===e.enabled).forEach(e=>t.push(e.filters)),1===t.length?i.push(t[0]):t.length>1&&i.push({logical:e.logical,filters:t}))}),"pushButton"===t.selectorType?e.pushButtons=t:"checkbox"===t.selectorType?e.checkboxes=t:"radioButton"===t.selectorType&&(e.radioButtons=t),i}formatProcessedOgcFilter(e,t){let o="";return 0===e.length&&-1===t.indexOf(",")?o=e:t.split(",").forEach(t=>{o=`${o}(${e.replace("filter=","")})`}),o=o.replace(/\(\)/g,""),o.length>0?o.replace("filter=",""):void 0}parseFilterOptionDate(e,t){return e?tc(e).isValid()?e:void 0:t}}var ic=function(e){return e.GML2="gml2",e.GML3="gml3",e.JSON="json",e.GEOJSON="geojson",e.GEOJSON2="geojson2",e.ESRIJSON="esrijson",e.TEXT="text",e.HTML="html",e.HTMLGML2="htmlgml2",e}({}),rc=function(e){return e.GML2="application/vnd.ogc.gml",e.GML3="application/vnd.ogc.gml/3.1.1",e.JSON="application/json",e.GEOJSON="application/geojson",e.GEOJSON2="geojson",e.ESRIJSON="application/json",e.TEXT="text/plain",e.HTML="text/html",e.HTMLGML2="text/html",e}({}),sc=function(e){return e.IFRAME="iframe",e.BLANK="_blank",e}({});const ac=new RegExp(/(.*)?gml(.*)?/gi);function nc(e,t,o,i,r=0,s=!1){const a=e.urlWfs,n=e.paramsWFS,c=t||5e3,l="2.0.0"===n.version?"startIndex="+r:"",u=o||"EPSG:3857";let d=n.outputFormat?"outputFormat="+n.outputFormat:"",h=n.version?"version="+n.version:"version=2.0.0";const p=`${"2.0.0"===n.version?"typenames":"typename"}=${n.featureTypes}`,m="2.0.0"===n.version?"count":"maxFeatures";let g=t?`${m}=${c}`:n.maxFeatures?`${m}=${n.maxFeatures}`:`${m}=${c}`;s&&(d="",h="version=1.1.0",g=g.replace("count","maxFeatures"));const b=o?"srsname="+u:n.srsName?"srsname="+n.srsName:"srsname="+u;let f="",y="";i&&(f="propertyName="+i,y="valueReference="+i);const O=e.sourceFields;if(!f&&O&&O.length>0){const t=[];e.sourceFields.forEach(e=>{t.push(e.name)}),f=`propertyName=${t.join(",")},${n.fieldNameGeometry}`}const v=-1===a.indexOf("?")?"?":"&";let j=`${a}${v}service=WFS&request=GetFeature&${h}&${p}&`;j+=`${d}&${b}&${g}&${f}&${l}`;let w=`${a}?service=WFS&request=GetPropertyValue&version=2.0.0&${p}&`;return w+=`&${g}&${y}`,[{name:"outputformat",value:d},{name:"version",value:h},{name:"typename",value:p},{name:"count",value:g},{name:"srsname",value:b},{name:"propertyname",value:f},{name:"valuereference",value:y},{name:"getcapabilities",value:`${a}${v}service=WFS&request=GetCapabilities&${h}`.replace(/&&/g,"&")},{name:"getfeature",value:j.replace(/&&/g,"&")},{name:"getpropertyvalue",value:w.replace(/&&/g,"&")}]}function cc(e,t){t&&"wfs"===t&&(e.paramsWFS=e.params);const o=e.paramsWFS;let i;return e.urlWfs=e.urlWfs||e.url,o.version=o.version||"2.0.0",o.fieldNameGeometry=o.fieldNameGeometry||"geometry",o.maxFeatures=o.maxFeatures||5e3,o.outputFormat&&(i=o.outputFormat),!ac.test(i)&&i||(o.version="1.1.0"),Object.assign({},e)}function lc(e){const t=e;let o=ha.WFS;const i=t.paramsWFS.outputFormat?t.paramsWFS.outputFormat:void 0;return i?ha[i]?(o=ha[i],new o(t.formatOptions)):i.toLowerCase().match("gml2")?(o=ha.WFS,new o(Object.assign(Object.assign({},t.formatOptions),{gmlFormat:pa.a}))):i.toLowerCase().match("gml32")?(o=ha.WFS,new o(Object.assign(Object.assign({},t.formatOptions),{gmlFormat:ga.a}))):i.toLowerCase().match("gml3")?(o=ha.WFS,new o(Object.assign(Object.assign({},t.formatOptions),{gmlFormat:ma.a}))):i.toLowerCase().match("topojson")?(o=ha.TopoJSON,new o(t.formatOptions)):i.toLowerCase().match("geojson")?(o=ha.GeoJSON,new o(t.formatOptions)):i.toLowerCase().match("esrijson")?(o=ha.EsriJSON,new o(t.formatOptions)):i.toLowerCase().match("json")?(o=ha.GeoJSON,new o(t.formatOptions)):i.toLowerCase().match("gpx")?(o=ha.GPX,new o(t.formatOptions)):i.toLowerCase().match("WKT")?(o=ha.WKT,new o(t.formatOptions)):i.toLowerCase().match("osmxml")?(o=ba.a,new o(t.formatOptions)):i.toLowerCase().match("kml")?(o=ha.KML,new o(t.formatOptions)):new o:new o(t.formatOptions)}class uc extends Jn{constructor(e,t){super(e),this.options=e,this.wfsService=t,this.ogcFilters$=new C.a(void 0),this.timeFilter$=new C.a(void 0);const o=e.params,i=o.DPI||96;o.DPI=i,o.MAP_RESOLUTION=i,o.FORMAT_OPTIONS="dpi:"+i,e.refreshIntervalSec&&e.refreshIntervalSec>0&&setInterval(()=>{this.refresh()},1e3*e.refreshIntervalSec);let r="geometry";if(e.paramsWFS){const t=cc(e,"wms");E.mergeDeep(e.paramsWFS,t.paramsWFS),r=e.paramsWFS.fieldNameGeometry||r,e.download=Object.assign({},e.download,{dynamicUrl:this.buildDynamicDownloadUrlFromParamsWFS(e)})}e.sourceFields&&0!==e.sourceFields.length?e.sourceFields.forEach(e=>{e.alias=e.alias?e.alias:e.name}):e.sourceFields=[];const s=e.ogcFilters,a=new oc;s?(s.advancedOgcFilters=!(s.pushButtons||s.checkboxes||s.radioButtons),s.pushButtons&&(s.pushButtons.selectorType="pushButton"),s.checkboxes&&(s.checkboxes.selectorType="checkbox"),s.radioButtons&&(s.radioButtons.selectorType="radioButton")):e.ogcFilters=a.defineOgcFiltersDefaultOptions(s,r,"wms"),o.LAYERS.split(",").length>1&&s&&s.enabled&&(console.log("*******************************"),console.log("BE CAREFULL, YOUR WMS LAYERS ("+o.LAYERS+") MUST SHARE THE SAME FIELDS TO ALLOW ogcFilters TO WORK !! "),console.log("*******************************")),e.paramsWFS&&s&&s.enabled&&s.editable&&(e.sourceFields||[]).filter(e=>!e.values).length>0&&this.wfsService.getSourceFieldsFromWFS(e);const n=a.handleOgcFiltersAppliedValue(e,r);o.FILTER=n,this.setOgcFilters(s,!0),(null==e?void 0:e.timeFilterable)&&(null==e?void 0:e.timeFilter)&&this.setTimeFilter(e.timeFilter,!0)}get params(){return this.options.params}get queryTitle(){return this.options.queryTitle?this.options.queryTitle:"title"}get mapLabel(){return this.options.mapLabel}get queryHtmlTarget(){return this.options.queryHtmlTarget?this.options.queryHtmlTarget:sc.BLANK}set ogcFilters(e){this.options.ogcFilters=e}get ogcFilters(){return this.options.ogcFilters}set timeFilter(e){this.options.timeFilter=e}get timeFilter(){return this.options.timeFilter}refresh(){this.ol.updateParams({igoRefresh:Math.random()})}buildDynamicDownloadUrlFromParamsWFS(e){return nc(e).find(e=>"getfeature"===e.name).value}createOlSource(){return new na.a(this.options)}setOgcFilters(e,t=!1){this.ogcFilters=e,t&&this.ogcFilters$.next(this.ogcFilters)}setTimeFilter(e,t=!1){this.timeFilter=e,t&&this.timeFilter$.next(this.timeFilter)}getLegend(e,t){let o=super.getLegend();if(o.length>0&&void 0===e&&!(null==t?void 0:t.scale))return o;let i,r=!1;(null==t?void 0:t.size)&&(null==t?void 0:t.extent)&&(null==t?void 0:t.projection)&&this.options.contentDependentLegend&&(i="1.3.0"===this.params.VERSION||void 0===this.params.VERSION?"CRS":"SRS",r=!0);const s=this.params;let a=[];void 0!==s.LAYERS&&(a=s.LAYERS.split(","));const n=this.options.url.replace(/\?$/,""),c=["REQUEST=GetLegendGraphic","SERVICE=WMS","FORMAT=image/png","SLD_VERSION=1.1.0","VERSION="+(s.VERSION||"1.3.0")];return void 0!==e&&c.push("STYLE="+e),void 0!==(null==t?void 0:t.scale)&&c.push("SCALE="+t.scale),r&&(c.push("WIDTH="+t.size[0]),c.push("HEIGHT="+t.size[1]),c.push("BBOX="+t.extent.join(",")),c.push(`${i}=${t.projection}`)),o=a.map(t=>{const o=n.match(/\?/)?"&":"?";return{url:`${n}${o}${c.join("&")}&LAYER=${t}`,title:a.length>1?t:void 0,currentStyle:void 0===e?void 0:e}}),o}onUnwatch(){}}class dc extends B{constructor(e,t){super(),this.ol=e.ol,this.layer=e,this.dataSource=e.options.source,this.map=t,this.ogcFilterWriter=new oc}watch(){this.ol.on("propertychange",e=>this.transferCommonProperties(e)),this.dataSource.ogcFilters$&&(this.ogcFilters$$=this.dataSource.ogcFilters$.subscribe(e=>this.transferOgcFiltersProperties(e))),this.dataSource.timeFilter$&&(this.timeFilter$$=this.dataSource.timeFilter$.subscribe(e=>this.transferTimeFilterProperties(e))),this.syncChildLayers()}unwatch(){this.ol.un("propertychange",e=>this.transferCommonProperties(e)),this.ogcFilters$$&&this.ogcFilters$$.unsubscribe(),this.timeFilter$$&&this.timeFilter$$.unsubscribe()}syncChildLayers(){this.map&&this.map.status$.pipe(Object(Xs.a)()).subscribe(()=>{this.map.layers.filter(e=>{var t;return null===(t=e.options.linkedLayers)||void 0===t?void 0:t.links}).map(e=>{e.options.linkedLayers.links.map(t=>{var o,i,r,s,a,n;if(-1!==(null===(o=t.properties)||void 0===o?void 0:o.indexOf(qn.VISIBLE))&&(e.ol.set("visible",!e.visible,!1),e.ol.set("visible",!e.visible,!1),e.visible=e.visible),-1!==(null===(i=t.properties)||void 0===i?void 0:i.indexOf(qn.OPACITY))){const t=e.ol.get("opacity");e.ol.set("opacity",0,!1),e.ol.set("opacity",t,!1),e.opacity=e.opacity}if(-1!==(null===(r=t.properties)||void 0===r?void 0:r.indexOf(qn.MINRESOLUTION))){const t=e.ol.get("minResolution");e.ol.set("minResolution",0,!1),e.ol.set("minResolution",t,!1),e.minResolution=e.minResolution}if(-1!==(null===(s=t.properties)||void 0===s?void 0:s.indexOf(qn.MAXRESOLUTION))){const t=e.ol.get("maxResolution");e.ol.set("maxResolution",0,!1),e.ol.set("maxResolution",t,!1),e.minResolution=e.minResolution}if(-1!==(null===(a=t.properties)||void 0===a?void 0:a.indexOf(qn.OGCFILTERS))){const t=e.dataSource.ogcFilters$;t.next(t.value)}if(-1!==(null===(n=t.properties)||void 0===n?void 0:n.indexOf(qn.TIMEFILTER))){const t=e.dataSource.timeFilter$;t.next(t.value)}})})})}transferCommonProperties(e){const t=e.key,o=e.target.getProperties(),i=o[t];if(-1===["visible","opacity","minResolution","maxResolution"].indexOf(t))return;const r=o.linkedLayers;if(!r)return;const s=r.linkId,a=r.links;if(a){const e=!0;a.map(o=>{o.properties&&-1!==o.properties.indexOf(t)&&o.linkedIds.map(o=>{const r=this.map.layers.find(e=>{var t;return(null===(t=e.options.linkedLayers)||void 0===t?void 0:t.linkId)===o});r&&(r.ol.set(t,i,e),"visible"===t&&r.visible$.next(i))})})}else{const e=!1;this.map.layers.map(o=>{var r;(null===(r=o.options.linkedLayers)||void 0===r?void 0:r.links)&&o.options.linkedLayers.links.map(r=>{r.properties&&-1!==r.properties.indexOf(t)&&!1!==r.bidirectionnal&&-1!==r.linkedIds.indexOf(s)&&(o.ol.set(t,i,e),"visible"===t&&o.visible$.next(i))})})}}transferOgcFiltersProperties(e){const t=this.ol.getProperties().linkedLayers;if(!t)return;const o=t.linkId,i=t.links;i?i.map(t=>{t.properties&&-1!==t.properties.indexOf(qn.OGCFILTERS)&&t.linkedIds.map(t=>{const o=this.map.layers.find(e=>{var o;return(null===(o=e.options.linkedLayers)||void 0===o?void 0:o.linkId)===t});if(o){const t=o.ol.getProperties().sourceOptions.type;if(o.dataSource.setOgcFilters(e,!1),"wfs"===t&&(o.ol.getSource().clear(),o.ol.getSource().refresh()),"wms"===t){let e=this.ol.values_.sourceOptions.params.FILTER;"wfs"===this.ol.getProperties().sourceOptions.type&&(e=this.ogcFilterWriter.handleOgcFiltersAppliedValue(this.layer.dataSource.options,this.dataSource.options.fieldNameGeometry,void 0,this.map.viewController.getOlProjection())),o.dataSource.ol.updateParams({FILTER:e})}}})}):this.map.layers.map(t=>{var i;(null===(i=t.options.linkedLayers)||void 0===i?void 0:i.links)&&t.options.linkedLayers.links.map(i=>{if(i.properties&&-1!==i.properties.indexOf(qn.OGCFILTERS)&&!1!==i.bidirectionnal&&-1!==i.linkedIds.indexOf(o)){const o=t.ol.getProperties().sourceOptions.type;if("wfs"===o&&(t.dataSource.setOgcFilters(e,!0),t.ol.getSource().clear(),t.ol.getSource().refresh()),"wms"===o){let o=this.ol.values_.sourceOptions.params.FILTER;"wfs"===this.ol.getProperties().sourceOptions.type&&(o=this.ogcFilterWriter.handleOgcFiltersAppliedValue(t.dataSource.options,this.dataSource.options.fieldNameGeometry,void 0,this.map.viewController.getOlProjection())),t.dataSource.ol.updateParams({FILTER:o}),t.dataSource.setOgcFilters(e,!0)}}})})}transferTimeFilterProperties(e){const t=this.ol.getProperties().linkedLayers;if(!t)return;const o=t.linkId,i=t.links;i?i.map(t=>{t.properties&&-1!==t.properties.indexOf(qn.TIMEFILTER)&&t.linkedIds.map(t=>{const o=this.map.layers.find(e=>{var o;return e.dataSource instanceof uc&&(null===(o=e.options.linkedLayers)||void 0===o?void 0:o.linkId)===t});if(o){o.dataSource.setTimeFilter(e,!1);const t=this.ol.values_.source.getParams().TIME;o.dataSource.ol.updateParams({TIME:t})}})}):this.map.layers.filter(e=>e.dataSource instanceof uc).map(t=>{var i;(null===(i=t.options.linkedLayers)||void 0===i?void 0:i.links)&&t.options.linkedLayers.links.map(i=>{if(i.properties&&-1!==i.properties.indexOf(qn.TIMEFILTER)&&!1!==i.bidirectionnal&&-1!==i.linkedIds.indexOf(o)){const o=this.ol.values_.source.getParams().TIME;t.dataSource.ol.updateParams({TIME:o}),t.dataSource.setTimeFilter(e,!0)}})})}}class hc{constructor(e,t){this.options=e,this.authInterceptor=t,this.legendCollapsed=!0,this.firstLoadComponent=!0,this.isInResolutionsRange$=new C.a(!1),this.visible$=new C.a(void 0),this.displayed$=Object(I.a)([this.isInResolutionsRange$,this.visible$]).pipe(Object(j.a)(e=>e[0]&&e[1])),this.dataSource=e.source,this.ol=this.createOlLayer(),void 0!==e.zIndex&&(this.zIndex=e.zIndex),e.baseLayer&&void 0===e.visible&&(e.visible=!1),this.maxResolution=e.maxResolution||zn(Number(e.maxScaleDenom)),this.minResolution=e.minResolution||zn(Number(e.minScaleDenom)),this.visible=void 0===e.visible||e.visible,this.opacity=void 0===e.opacity?1:e.opacity,e.legendOptions&&(e.legendOptions.url||e.legendOptions.html)&&(this.legend=this.dataSource.setLegend(e.legendOptions)),this.legendCollapsed=!e.legendOptions||!e.legendOptions.collapsed||e.legendOptions.collapsed,this.ol.set("_layer",this,!0)}get id(){return this.options.id||this.dataSource.id}get alias(){return this.options.alias}get title(){return this.options.title}set title(e){this.options.title=e}get zIndex(){return this.ol.getZIndex()}set zIndex(e){this.ol.setZIndex(e)}get baseLayer(){return this.options.baseLayer}set baseLayer(e){this.options.baseLayer=e}get opacity(){return this.ol.get("opacity")}set opacity(e){this.ol.setOpacity(e)}set isInResolutionsRange(e){this.isInResolutionsRange$.next(e)}get isInResolutionsRange(){return this.isInResolutionsRange$.value}set maxResolution(e){this.ol.setMaxResolution(e||1/0),this.updateInResolutionsRange()}get maxResolution(){return this.ol.getMaxResolution()}set minResolution(e){this.ol.setMinResolution(e||0),this.updateInResolutionsRange()}get minResolution(){return this.ol.getMinResolution()}set visible(e){this.ol.setVisible(e),this.visible$.next(e)}get visible(){return this.visible$.value}get displayed(){return this.visible&&this.isInResolutionsRange}get showInLayerList(){return!1!==this.options.showInLayerList}setMap(e){this.map=e,this.unobserveResolution(),void 0!==e?(this.observeResolution(),this.layerSyncWatcher=new dc(this,this.map),this.layerSyncWatcher.subscribe(()=>{})):this.layerSyncWatcher.unsubscribe()}observeResolution(){this.resolution$$=this.map.viewController.resolution$.subscribe(()=>this.updateInResolutionsRange())}unobserveResolution(){void 0!==this.resolution$$&&(this.resolution$$.unsubscribe(),this.resolution$$=void 0)}updateInResolutionsRange(){if(void 0!==this.map){const e=this.map.viewController.getResolution(),t=void 0===this.maxResolution?1/0:this.maxResolution;this.isInResolutionsRange=e>=this.minResolution&&e<=t}else this.isInResolutionsRange=!1}}let pc=(()=>{class e{constructor(){}open(e){e.extern&&window.open(e.url,"_blank")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function mc(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",1),Object(i.tc)("click",(function(){Object(i.Nc)(e);const t=Object(i.xc)();return t.openMetadata(t.options.metadata)})),Object(i.yc)(1,"translate"),Object(i.hc)(2,"mat-icon",2),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Dc)("matTooltip",Object(i.zc)(1,2,"igo.geo.metadata.show"))("color",e.color)}}function gc(e,t){if(1&e&&(Object(i.mc)(0,"mat-dialog-content",3),Object(i.mc)(1,"h3"),Object(i.ad)(2),Object(i.lc)(),Object(i.lc)()),2&e){const e=Object(i.xc)();Object(i.Tb)(2),Object(i.bd)(e.data.abstract)}}function bc(e,t){if(1&e&&(Object(i.mc)(0,"mat-dialog-content",3),Object(i.hc)(1,"h3",4),Object(i.lc)()),2&e){const e=Object(i.xc)();Object(i.Tb)(1),Object(i.Dc)("innerHTML",e.data.abstract,i.Oc)}}let fc=(()=>{class e{constructor(e,t){this.metadataService=e,this.dialog=t,this._color="primary"}get layer(){return this._layer}set layer(e){this._layer=e}get color(){return this._color}set color(e){this._color=e}openMetadata(e){e.extern?this.metadataService.open(e):!e.extern&&e.abstract&&this.dialog.open(yc,{data:{layerTitle:this.layer.title,abstract:e.abstract,type:e.type}})}get options(){if(this.layer)return this.layer.options}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(pc),Object(i.gc)(qe.b))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-metadata-button"]],inputs:{layer:"layer",color:"color"},decls:1,vars:1,consts:[["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click"],["svgIcon","information-outline"]],template:function(e,t){1&e&&Object(i.Yc)(0,mc,3,4,"button",0),2&e&&Object(i.Dc)("ngIf",t.options&&t.options.metadata&&t.options.metadata.url||t.options&&t.options.metadata&&t.options.metadata.abstract)},directives:[m.t,n.b,h.a,c.a],pipes:[q.e],styles:[""],changeDetection:0}),e})(),yc=(()=>{class e{constructor(e){this.data=e}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(qe.a))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-metadata-abstract"]],decls:6,vars:3,consts:[["mat-dialog-title",""],["mat-button","","mat-dialog-close","",1,"close-button"],["class","mat-typography",4,"ngIf"],[1,"mat-typography"],[3,"innerHTML"]],template:function(e,t){1&e&&(Object(i.mc)(0,"h2",0),Object(i.ad)(1),Object(i.lc)(),Object(i.mc)(2,"button",1),Object(i.ad)(3,"X"),Object(i.lc)(),Object(i.Yc)(4,gc,3,1,"mat-dialog-content",2),Object(i.Yc)(5,bc,2,1,"mat-dialog-content",2)),2&e&&(Object(i.Tb)(1),Object(i.bd)(t.data.layerTitle),Object(i.Tb)(3),Object(i.Dc)("ngIf","arcgisrest"!==t.data.type),Object(i.Tb)(1),Object(i.Dc)("ngIf","arcgisrest"===t.data.type))},directives:[qe.i,n.b,qe.d,m.t,qe.f],styles:[".close-button{line-height:10px;min-width:auto;padding:7px;position:absolute!important;right:5px;top:5px}mat-dialog-container{position:relative}"],encapsulation:2}),e})(),Oc=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,c.b,n.c,h.b,ie,qe.g]]}),e})();class vc extends Jn{createOlSource(){const e={format:this.getSourceFormatFromOptions(this.options)};return new ya.a(Object.assign(e,this.options))}getSourceFormatFromOptions(e){if(e.format)return e.format;let t;const o=e.formatType;if(o){if(t=ha[o],void 0===t)throw new Error("Invalid vector source format ${formatType}.")}else t=ha.GeoJSON;const i=e.formatOptions;let r;return r=i?new t(i):new t,r}onUnwatch(){}get queryTitle(){return this.options.queryTitle?this.options.queryTitle:"title"}}class jc extends Jn{createOlSource(){return this.options.url="https://tile.openstreetmap.org/{z}/{x}/{y}.png",new Oa.b(this.options)}onUnwatch(){}}class wc extends Jn{createOlSource(){return new va.a(this.options)}onUnwatch(){}}class Sc extends Jn{constructor(e,t,o){super(cc(e,"wfs")),this.options=e,this.wfsService=t,this.authInterceptor=o,this.ogcFilters$=new C.a(void 0);const i=this.options.ogcFilters,r=this.options.paramsWFS.fieldNameGeometry||"geometry",s=new oc;this.options.ogcFilters=s.defineOgcFiltersDefaultOptions(i,r),this.options.ogcFilters.enabled&&this.options.ogcFilters.editable&&(e.sourceFields||[]).filter(e=>!e.values).length>0&&this.wfsService.getSourceFieldsFromWFS(this.options),(null==i?void 0:i.pushButtons)&&(i.pushButtons.selectorType="pushButton"),(null==i?void 0:i.checkboxes)&&(i.checkboxes.selectorType="checkbox"),(null==i?void 0:i.radioButtons)&&(i.radioButtons.selectorType="radioButton"),this.setOgcFilters(this.options.ogcFilters,!0)}set ogcFilters(e){this.options.ogcFilters=e}get ogcFilters(){return this.options.ogcFilters}createOlSource(){const e=new ya.a({format:lc(this.options),loader:(t,o,i)=>{e.dispatchEvent({type:"vectorloading"});const r=this.options.paramsWFS,s=r.srsName?new wa.a({code:r.srsName}):i,a=Object(sa.t)(t,i,s);r.srsName=r.srsName||i.getCode();const n=this.buildUrl(a,s,this.options.ogcFilters);let c=0;if("2.0.0"===r.version&&r.maxFeatures>5e3){const t=1e3;for(;c<r.maxFeatures;){let o=n.replace("count="+r.maxFeatures,"count="+t);o=o.replace("startIndex=0","0"),o+="&startIndex="+c,o.replace(/&&/g,"&"),this.getFeatures(e,a,s,i,o,t),c+=t}}else this.getFeatures(e,a,s,i,n,r.maxFeatures)},strategy:ja.b});return e.addEventListener("vectorloading"),e.addEventListener("vectorloaded"),e.addEventListener("vectorloaderror"),e}getFeatures(e,t,o,i,r,s){const a=new XMLHttpRequest;a.open("GET",r),this.authInterceptor&&this.authInterceptor.interceptXhr(a,r);const n=()=>{e.dispatchEvent({type:"vectorloaderror"}),e.removeLoadedExtent(t)};a.onerror=n,a.onload=()=>{if(200===a.status&&a.responseText.length>0){const t=e.getFormat().readFeatures(a.responseText,{dataProjection:o,featureProjection:i});e.addFeatures(t),e.dispatchEvent({type:"vectorloaded"})}else n()},a.send()}setOgcFilters(e,t=!1){this.ogcFilters=e,t&&this.ogcFilters$.next(this.ogcFilters)}buildUrl(e,t,o){const i=this.options.paramsWFS,r=nc(this.options,void 0,this.options.paramsWFS.srsName);let s;o&&o.enabled&&(s=o.filters);const a=new oc,n=a.buildFilter(s,e,t,o.geometryName,this.options);let c=a.handleOgcFiltersAppliedValue(this.options,o.geometryName,e,t),l="filter";c||(l="bbox",c=e.join(",")+","+t.getCode()),i.xmlFilter=o.advancedOgcFilters?n:`${l}=${c}`;let u=r.find(e=>"getfeature"===e.name).value;return u=/(filter|bbox)=.*/gi.test(i.xmlFilter)?`${u}&${i.xmlFilter}`:u,this.options.download=Object.assign({},this.options.download,{dynamicUrl:u}),u.replace(/&&/g,"&")}onUnwatch(){}}let xc=(()=>{class e extends class{}{constructor(e){super(),this.http=e}getData(){return console.log("This is defining a data service."),"This is defining a data service."}getSourceFieldsFromWFS(e){e.sourceFields&&0!==e.sourceFields.length?this.defineFieldAndValuefromWFS(e).subscribe(t=>{e.sourceFields.forEach(e=>{void 0===e.alias&&(e.alias=e.name),void 0!==e.values&&0!==e.values.length||(e.values=t.find(t=>t.name===e.name).values)})}):(e.sourceFields=[],this.defineFieldAndValuefromWFS(e).subscribe(t=>{e.sourceFields=t}))}wfsGetFeature(e,t=5e3,o="EPSG:3857",i,r=0,s=!1){const a=nc(e,t,o,i,r,s).find(e=>"getfeature"===e.name).value,n=e.paramsWFS.outputFormat;return s||ac.test(n)||!n?this.http.get(a,{responseType:"text"}):this.http.get(a)}defineFieldAndValuefromWFS(e){return new xe.a(t=>{var o;const i=[];let r,s,a,n,c;n=lc(e);const l=JSON.parse(JSON.stringify(e));delete l.paramsWFS.outputFormat,delete l.formatOptions,c=lc(l);let u=null===(o=e.sourceFields)||void 0===o?void 0:o.filter(e=>!e.values).map(e=>e.name);this.wfsGetFeature(e,1,void 0,void 0,0,!0).pipe(Object(ea.a)(e=>String(e).toLowerCase().includes("exception")?Object(L.a)(!1):Object(L.a)(!0)),Object(ea.a)(t=>this.wfsGetFeature(e,1).pipe(Object(ea.a)(o=>{const i=n.readFeatures(o);r=i[0].getKeys(),(e.sourceFields||0===e.sourceFields.length)&&(u=r),s=r.filter(e=>u.includes(e)&&e!==i[0].getGeometryName()&&!e.match(/boundedby/gi)),a=s.join(",");const l=[];let d=0;if(!t&&"2.0.0"===e.paramsWFS.version&&e.paramsWFS.maxFeatures>5e3){const t=1e3;for(;d<e.paramsWFS.maxFeatures;)l.push(this.wfsGetFeature(e,t,e.paramsWFS.srsName,a,d)),d+=t;c=n}else l.push(this.wfsGetFeature(e,e.paramsWFS.maxFeatures||5e3,e.paramsWFS.srsName,a,0,!0));return Object(I.a)(l)})))).subscribe(e=>{let o=[];e.map(e=>{const t=c.readFeatures(e);o=o.concat(t)}),this.built_properties_value(o).forEach(e=>{i.push(e)}),t.next(i),t.complete()})})}built_properties_value(e){if(0===e.length)return[];const t=Object.assign({},e[0].getProperties());delete t[e[0].getGeometryName()],delete t.boundedBy;const o=[];for(const i in t)if(t.hasOwnProperty(i)){const r="object"==typeof e[0].get(i)?void 0:typeof e[0].get(i);o.push({name:i,alias:i,type:r,values:[t[i]]})}return e.every(e=>{const i=e.getProperties();for(const r in i)i.hasOwnProperty(r)&&r in t&&o.filter(e=>e.name===r).forEach(e=>{-1===e.values.indexOf(i[r])&&e.values.push(i[r])});return!0}),o}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(y.b))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Cc(e){const t=(e?Object(sa.k)(e):Object(sa.k)("EPSG:3857")).getExtent(),o=Object(Ca.G)(t)/256,i=new Array(20),r=new Array(20);for(let s=0;s<20;++s)i[s]=o/Math.pow(2,s),r[s]=s;return new xa.b({origin:Object(Ca.E)(t),resolutions:i,matrixIds:r})}class Tc extends Jn{constructor(e){super(e)}createOlSource(){const e=Object.assign({tileGrid:Cc(this.options.projection)},this.options);return new Sa.a(e)}onUnwatch(){}}class Lc extends Jn{get params(){return this.options.params}get queryTitle(){return this.options.queryTitle?this.options.queryTitle:"title"}get mapLabel(){return this.options.mapLabel}get queryHtmlTarget(){return this.options.queryHtmlTarget?this.options.queryHtmlTarget:sc.BLANK}createOlSource(){const e=Object.assign({crossOrigin:this.options.crossOrigin?this.options.crossOrigin:"anonymous"},this.options);return new Ta.a(e)}getLegend(){const e=super.getLegend();if(e.length>0)return e;let t="<table>";if(null!=this.options.config.layers[0].legend)return this.options.config.layers[0].legend.items.forEach(e=>{!0===e.visible&&(t+='<tr><td><p><font size="5" color="'+e.value+'"> &#9679</font></p></td><td>'+e.name+"</td></tr>")}),t+="</table>",[{html:t}];{const e=this.options.config.layers[0].options,o=["polygon-fill:","marker-fill:","shield-fill:","building-fill:","line-color:"];for(const i of o)if(e.cartocss.includes(i)){const o=e.cartocss.split(i).pop(),r=o.substr(0,o.indexOf(";"));if(r.includes("ramp")){const e=r.split(", (")[1].split(","),o=r.split(", (")[2].split(",");for(let i=0;i<e.length;i++)e[i]=e[i].replace(/("|\))/g,""),o[i]=o[i].replace(/("|\))/g,""),"="===o[i].replace(/\s+/g,"")&&(o[i]="Autres"),t+='<tr><td><p><font size="5" color="'+e[i]+'"> &#9679</font></p></td><td>'+o[i]+"</td></tr>";break}t+='<tr><td><p><font size="5" color="'+r+'"> &#9679</font></p></td><td>'+(e.layer_name?e.layer_name:"")+"</td></tr>";break}return t+="</table>",[{html:t}]}}onUnwatch(){}}class Ic extends Jn{createOlSource(){const e=new La.a;return new ya.a({attributions:this.options.params.attributions,overlaps:!1,format:e,url:(function(e,t,o){const i=this.options.url+"/"+this.options.layer+"/query/",r=["f=json","geometry="+encodeURIComponent('{"xmin":'+e[0]+',"ymin":'+e[1]+',"xmax":'+e[2]+',"ymax":'+e[3]+',"spatialReference":{"wkid":102100}}'),"geometryType=esriGeometryEnvelope","inSR=102100","spatialRel=esriSpatialRelIntersects","outFields=*","returnGeometry=true","outSR=102100"];return this.options.params.time&&r.push("time="+this.options.params.time),this.options.params.customParams&&this.options.params.customParams.forEach(e=>{r.push(e)}),`${i}?${r.join("&")}`}).bind(this),strategy:ja.b})}getLegend(){const e=this.options.legendInfo,t=super.getLegend();if(void 0===e||t.length>0)return t;const o=parseInt(this.options.layer,10),i=e.layers.find(e=>e.layerId===o);if(!i)return;let r="<table>";for(const s of i.legend)r+=`<tr><td align='left'><img src="${this.options.url.replace("FeatureServer","MapServer")}/${i.layerId}/images/${s.url}" alt ='' /></td><td>`+s.label.replace("<Null>","Null")+"</td></tr>";return r+="</table>",[{html:r}]}onUnwatch(){}}class Fc extends Jn{get params(){return this.options.params}get queryTitle(){return this.options.queryTitle?this.options.queryTitle:"title"}get mapLabel(){return this.options.mapLabel}get queryHtmlTarget(){return this.options.queryHtmlTarget?this.options.queryHtmlTarget:sc.BLANK}createOlSource(){const e=void 0===this.options.layer?this.options.params:Object.assign({LAYERS:"show:"+this.options.layer},this.options.params);return"object"==typeof e.renderingRule&&(e.renderingRule=JSON.stringify(e.renderingRule)),new Ia.a({ratio:1,params:e,url:this.options.url})}getLegend(){var e,t;const o=(null===(e=this.options.options)||void 0===e?void 0:e.legendInfo)||(null===(t=this.params)||void 0===t?void 0:t.legendInfo),i=super.getLegend();if(void 0===o||void 0===this.options.layer||i.length>0)return i;const r=parseInt(this.options.layer,10),s=o.layers.find(e=>e.layerId===r);if(!s)return;let a="<table>";for(const n of s.legend)a+=`<tr><td align='left'><img src="${this.options.url}/${s.layerId}/images/${n.url}" alt ='' /></td><td>`+n.label.replace("<Null>","Null")+"</td></tr>";return a+="</table>",[{html:a}]}onUnwatch(){}}class Mc extends Jn{get params(){return this.options.params}get queryTitle(){return this.options.queryTitle?this.options.queryTitle:"title"}get mapLabel(){return this.options.mapLabel}get queryHtmlTarget(){return this.options.queryHtmlTarget?this.options.queryHtmlTarget:sc.BLANK}createOlSource(){return new Fa.a(this.options)}getLegend(){const e=this.options.legendInfo,t=super.getLegend();if(void 0===e||t.length>0)return t;const o=parseInt(this.options.layer,10),i=e.layers.find(e=>e.layerId===o);if(!i)return;let r="<table>";for(const s of i.legend)r+=`<tr><td align='left'><img src="${this.options.url}/${i.layerId}/images/${s.url}" alt ='' /></td><td>`+s.label.replace("<Null>","Null")+"</td></tr>";return r+="</table>",[{html:r}]}onUnwatch(){}}class kc extends Jn{createOlSource(){const e=JSON.parse(JSON.stringify(this.options));return this.options.tileGrid&&(delete e.tileGrid,e.tileGrid=new ka.a(this.options.tileGrid)),new Ma.a(e)}onUnwatch(){}}class Dc extends vc{createOlSource(){return this.createWebSocket(),this.options.format=this.getSourceFormatFromOptions(this.options),super.createOlSource()}createWebSocket(){this.ws=new WebSocket(this.options.url),this.ws.onmessage=this.onMessage.bind(this),this.options.onclose&&(this.ws.onclose=this.onClose.bind(this)),this.options.onerror&&(this.ws.onerror=this.onError.bind(this)),this.options.onopen&&(this.ws.onopen=this.onOpen.bind(this))}onMessage(e){const t=this.options.format.readFeature(e.data);switch(this.options.onmessage){case"update":const e=this.ol.getFeatureById(t.getId());e&&this.ol.removeFeature(e),this.ol.addFeature(t);break;case"delete":this.ol.clear(!0),this.ol.addFeature(t);break;case"add":default:this.ol.addFeature(t)}}onClose(e){}onError(e){}onOpen(e){}onUnwatch(){this.ws.close()}}class Pc extends Jn{createOlSource(){let e;return"feature"===this.options.featureClass?e=new Aa.a({featureClass:Da.a}):void 0===this.options.featureClass&&(e=new Aa.a),this.options.format=e,new Pa.a(this.options)}generateId(){return this.options.url?ws.Md5.hashStr("mvt"+this.options.url):z()}onUnwatch(){}}class Ac extends vc{createOlSource(){return this.options.format=this.getSourceFormatFromOptions(this.options),this.options.source=super.createOlSource(),new $a.a(this.options)}generateId(){return z()}onUnwatch(){}}class $c{constructor(){this._converters={},this._converters.esriPMS=$c._convertEsriPMS,this._converters.esriSFS=$c._convertEsriSFS,this._converters.esriSLS=$c._convertEsriSLS,this._converters.esriSMS=$c._convertEsriSMS,this._converters.esriTS=$c._convertEsriTS,this._renderers={},this._renderers.uniqueValue=this._renderUniqueValue,this._renderers.simple=this._renderSimple,this._renderers.classBreaks=this._renderClassBreaks}static _convertPointToPixel(e){return e/.75}static _transformColor(e){return[e[0],e[1],e[2],e[3]/255]}static _getResolutionForScale(e,t){const o=sa.a[t];return parseFloat(e)/(39.3701*o*96)}static _convertEsriTS(e){const t=$c._transformAngle(e.angle),o=void 0!==e.text?e.text:void 0;return new Ra.Style({text:new Ra.Text({fill:new Ra.Fill({color:$c._transformColor(e.color)}),font:e.font.style+" "+e.font.weight+" "+e.font.size+" px "+e.font.family,textBaseline:e.verticalAlignment,textAlign:e.horizontalAlignment,offsetX:$c._convertPointToPixel(e.xoffset),offsetY:$c._convertPointToPixel(e.yoffset),rotation:t,text:o})})}static _convertEsriPMS(e){const t="data:"+e.contentType+";base64, "+e.imageData,o=$c._transformAngle(e.angle);return new Ra.Style({image:new Ra.Icon({src:t,rotation:o})})}static _convertEsriSFS(e){const t=new Ra.Fill({color:$c._transformColor(e.color)}),o=e.outline?$c._convertOutline(e.outline):void 0;return new Ra.Style({fill:t,stroke:o})}static _convertOutline(e){let t;const o=$c._transformColor(e.color);return"esriSLSDash"===e.style?t=[5]:"esriSLSDashDot"===e.style?t=[5,5,1,2]:"esriSLSDashDotDot"===e.style?t=[5,5,1,2,1,2]:"esriSLSDot"===e.style?t=[1,2]:"esriSLSNull"===e.style&&(o[3]=0),new Ra.Stroke({color:o,lineDash:t,width:$c._convertPointToPixel(e.width)})}static _convertEsriSLS(e){return new Ra.Style({stroke:$c._convertOutline(e)})}static _transformAngle(e){if(0===e||void 0===e)return;const t=-e*Math.PI/180+Math.PI/2;return t<0?2*Math.PI+t:t}static _convertEsriSMS(e){const t=new Ra.Fill({color:$c._transformColor(e.color)}),o=e.outline?$c._convertOutline(e.outline):void 0,i=$c._convertPointToPixel(e.size)/2,r=$c._transformAngle(e.angle);return"esriSMSCircle"===e.style?new Ra.Style({image:new Ra.Circle({radius:i,fill:t,stroke:o})}):"esriSMSCross"===e.style?new Ra.Style({image:new Ra.RegularShape({fill:t,stroke:o,points:4,radius:i,radius2:0,angle:0,rotation:r})}):"esriSMSDiamond"===e.style?new Ra.Style({image:new Ra.RegularShape({fill:t,stroke:o,points:4,radius:i,rotation:r})}):"esriSMSSquare"===e.style?new Ra.Style({image:new Ra.RegularShape({fill:t,stroke:o,points:4,radius:i,angle:Math.PI/4,rotation:r})}):"esriSMSX"===e.style?new Ra.Style({image:new Ra.RegularShape({fill:t,stroke:o,points:4,radius:i,radius2:0,angle:Math.PI/4,rotation:r})}):"esriSMSTriangle"===e.style?new Ra.Style({image:new Ra.RegularShape({fill:t,stroke:o,points:3,radius:i,angle:0,rotation:r})}):void 0}_convertLabelingInfo(e,t){const o=[];for(let i=0,r=e.length;i<r;++i){const r=e[i].labelExpression,s=r.substr(r.indexOf("[")+1,r.indexOf("]")-1),a=e[i].symbol,n=e[i].maxScale,c=e[i].minScale;let l=null;0!==n&&(l=$c._getResolutionForScale(n,t));let u=null;0!==c&&(u=$c._getResolutionForScale(c,t));const d=this._converters[a.type].call(this,a);o.push((function(e,t){let o=!0;if(null!==this.minResolution&&null!==this.maxResolution?o=t<this.maxResolution&&t>=this.minResolution:null!==this.minResolution?o=t>=this.minResolution:null!==this.maxResolution&&(o=t<this.maxResolution),o){const t=e.get(this.field);return this.style.getText().setText(t),[this.style]}}).bind({minResolution:l,maxResolution:u,field:s,style:d}))}return o}_renderSimple(e){const t=this._converters[e.symbol.type].call(this,e.symbol);return()=>[t]}_renderClassBreaks(e){const t=e.defaultSymbol,o=this._converters[t.type].call(this,t),i=e.field,r=[];for(let s=0,a=e.classBreakInfos.length;s<a;++s){const t=e.classBreakInfos[s];let o;o=null==t.classMinValue?0===s?e.minValue:e.classBreakInfos[s-1].classMaxValue:t.classMinValue;const i=t.classMaxValue,a=t.symbol,n=this._converters[a.type].call(this,a);r.push({min:o,max:i,style:n})}return e=>{const t=e.get(i);for(let o=0,i=r.length;o<i;++o){let e;if(e=0===o?t>=r[o].min&&t<=r[o].max:t>r[o].min&&t<=r[o].max,e)return[r[o].style]}return[o]}}_renderUniqueValue(e){const t=e.defaultSymbol;let o=[];t&&(o=[this._converters[t.type].call(this,t)]);const i=e.field1,r=e.uniqueValueInfos,s=this;return(()=>{const e={};for(let t=0,o=r.length;t<o;++t){const o=r[t],i=o.symbol;e[o.value]=[s._converters[i.type].call(s,i)]}return t=>e[t.get(i)]||o})()}generateStyle(e,t){const o=e.drawingInfo;let i=[];const r=this._renderers[o.renderer.type].call(this,o.renderer);if(void 0!==r&&i.push(r),e.labelingInfo){const o=this._convertLabelingInfo(e.labelingInfo,t);i=i.concat(o)}return 1===i.length?i[0]:(e,t)=>{let o=[];for(let r=0,s=i.length;r<s;++r){const s=i[r].call(null,e,t);s&&(o=o.concat(s))}return o}}}var Ec=function(e){return e.DATE="date",e.TIME="time",e.DATETIME="datetime",e.YEAR="year",e}({}),Rc=function(e){return e.CALENDAR="calendar",e.SLIDER="slider",e}({}),_c=function(e){return e.wms="wms",e.wmts="wmts",e.arcgisrest="esriJSON",e.imagearcgisrest="esriJSON",e.tilearcgisrest="esriJSON",e}({});let zc=(()=>{class e{constructor(e){this.http=e,this.parsers={wms:new ha.WMSCapabilities,wmts:new ha.WMTSCapabilities,esriJSON:new ha.EsriJSON}}getWMSOptions(e){return this.getCapabilities("wms",e.url,e.params.VERSION).pipe(Object(j.a)(t=>t?this.parseWMSOptions(e,t):void 0))}getWMTSOptions(e){return this.getCapabilities("wmts",e.url,e.version).pipe(Object(j.a)(t=>t?this.parseWMTSOptions(e,t):void 0))}getCartoOptions(e){return this.http.jsonp("https://"+e.account+".carto.com/api/v2/viz/"+e.mapId+"/viz.json","callback").pipe(Object(j.a)(t=>this.parseCartoOptions(e,t)))}getArcgisOptions(e){const t=e.url+"/"+e.layer+"?f=json",o=e.url.replace("FeatureServer","MapServer")+"/legend?f=json",i=this.http.get(t),r=this.http.get(o).pipe(Object(j.a)(e=>e),Object(v.a)(e=>(console.log("No legend associated with this Feature Service"),Object(L.a)(e))));return Object(Ks.a)([i,r]).pipe(Object(j.a)(t=>this.parseArcgisOptions(e,t[0],t[1])))}getImageArcgisOptions(e){const t=e.url+"/"+e.layer+"?f=json",o=e.url.replace("FeatureServer","MapServer")+"/legend?f=json",i=this.http.get(t),r=this.http.get(o).pipe(Object(j.a)(e=>e),Object(v.a)(e=>(console.log("No legend associated with this Image Service"),Object(L.a)(e))));return Object(Ks.a)([i,r]).pipe(Object(j.a)(t=>this.parseTileOrImageArcgisOptions(e,t[0],t[1])))}getTileArcgisOptions(e){const t=e.url+"/legend?f=json",o=this.http.get(e.url+"/"+e.layer+"?f=json"),i=this.http.get(t).pipe(Object(j.a)(e=>e),Object(v.a)(e=>(console.log("No legend associated with this Tile Service"),Object(L.a)(e))));return Object(Ks.a)([o,i]).pipe(Object(j.a)(t=>this.parseTileOrImageArcgisOptions(e,t[0],t[1])))}getCapabilities(e,t,o){const i=new y.g({fromObject:{request:"GetCapabilities",service:e.toUpperCase(),version:o||"1.3.0",_i:"true"}});let r;return r="esriJSON"===e?this.http.get(t+"?f=json"):this.http.get(t,{params:i,responseType:"text"}),r.pipe(Object(j.a)(t=>{if("esriJSON"===e)return t;if(String(t).toLowerCase().includes("serviceexception")&&String(t).toLowerCase().includes("access denied"))throw{error:{message:"Service error getCapabilities: Access is denied"}};return this.parsers[e].read(t)}),Object(v.a)(e=>{throw void 0!==e.error&&(e.error.caught=!0),e}))}parseWMSOptions(e,t){const o=this.findDataSourceInCapabilities(t.Capability.Layer,e.params.LAYERS);if(!o)throw{error:{message:"Layer not found"}};const i=o.DataURL?o.DataURL[0]:void 0,r=o.Abstract?o.Abstract:void 0,s=o.KeywordList?o.KeywordList:void 0;let a=o.queryable;const n=this.getTimeFilter(o),c=n&&Object.keys(n).length>0,l=o.Style?this.getStyle(o.Style):void 0;let u;const d=[rc.GEOJSON,rc.GEOJSON2,rc.GML3,rc.GML2,rc.JSON,rc.HTML];for(const p of d)if(-1!==t.Capability.Request.GetFeatureInfo.Format.indexOf(p)){const e=Object.keys(rc).find(e=>rc[e]===p);u=ic[e];break}u||(a=!1);const h=E.removeUndefined({_layerOptionsFromSource:{title:o.Title,maxResolution:zn(o.MaxScaleDenominator),minResolution:zn(o.MinScaleDenominator),metadata:{url:i?i.OnlineResource:void 0,extern:!!i||void 0,abstract:r,keywordList:s},legendOptions:l},queryable:a,queryFormat:u,timeFilter:c?n:void 0,timeFilterable:!!c||void 0,minDate:c?n.min:void 0,maxDate:c?n.max:void 0,stepDate:c?n.step:void 0});return E.mergeDeep(h,e)}parseWMTSOptions(e,t){const o=t.Contents.Layer.find(t=>t.Identifier===e.layer),i=Object(Sa.b)(t,e),r=Object.assign(i,e),s=E.removeUndefined({_layerOptionsFromSource:{title:o.Title}});return E.mergeDeep(s,r)}parseCartoOptions(e,t){const o=[],i=t.layers[1].options.layer_definition;i.layers.forEach(e=>{o.push({type:e.type.toLowerCase(),options:e.options,legend:e.legend})});const r=E.removeUndefined({config:{version:i.version,layers:o}});return E.mergeDeep(r,e)}parseArcgisOptions(e,t,o){const i=t.name,r=o.layers?o:void 0,s=(new $c).generateStyle(t,"esriMeters"===t.units?"m":"degrees"),a=new Ea.a({html:t.copyrightText});let n,c;if(t.timeInfo){const e=t.timeInfo.timeExtent;n=e[0]+","+e[1];const o=new Date;o.setTime(e[0]);const i=new Date;i.setTime(e[1]),c={min:o.toUTCString(),max:i.toUTCString(),range:!0,type:Ec.DATETIME,style:Rc.CALENDAR}}const l=Object.assign({},{legendInfo:r,style:s,timeFilter:c,timeExtent:n,attributions:a}),u=E.removeUndefined({params:l,_layerOptionsFromSource:{title:i,minResolution:zn(t.maxScale),maxResolution:zn(t.minScale)},sourceFields:t.fields,queryTitle:t.displayField});return E.mergeDeep(u,e)}parseTileOrImageArcgisOptions(e,t,o){const i=t.name,r=o.layers?o:void 0,s=new Ea.a({html:t.copyrightText});let a,n;if(t.timeInfo){const e=t.timeInfo.timeExtent;a=e[0]+","+e[1];const o=new Date;o.setTime(e[0]);const i=new Date;i.setTime(e[1]),n={min:o.toUTCString(),max:i.toUTCString(),range:!0,type:Ec.DATETIME,style:Rc.CALENDAR}}const c=Object.assign({},{LAYERS:e.layer?"show:"+e.layer:void 0,time:a}),l=E.removeUndefined({params:c,_layerOptionsFromSource:{title:i,minResolution:zn(t.maxScale),maxResolution:zn(t.minScale)},legendInfo:r,timeFilter:n,attributions:s,sourceFields:t.fields,queryTitle:t.displayField});return E.mergeDeep(l,e)}findDataSourceInCapabilities(e,t){if(Array.isArray(e)){let o;return e.find(e=>(o=this.findDataSourceInCapabilities(e,t),void 0!==o),this),o}return e.Layer?this.findDataSourceInCapabilities(e.Layer,t):e.Name&&e.Name===t?e:void 0}getTimeFilter(e){let t;if(e.Dimension){const o={};if(t=e.Dimension[0],t.values){const e=t.values.split("/");o.min=void 0!==e[0]?e[0]:void 0,o.max=void 0!==e[1]?e[1]:void 0,o.step=void 0!==e[2]?e[2]:void 0}return t.default&&(o.value=t.default),o}}getStyle(e){return{stylesAvailable:e.map(e=>({name:e.Name,title:e.Title})).filter((e,t,o)=>o.findIndex(t=>t.name===e.name)===t)}}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(y.b))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),Object(_e.b)([Object(ze.a)({maxCacheCount:20}),Object(_e.c)("design:type",Function),Object(_e.c)("design:paramtypes",[String,String,String]),Object(_e.c)("design:returntype",xe.a)],e.prototype,"getCapabilities",null),e})();class Nc{}let Bc=(()=>{class e{constructor(e){this.config=e,(this.config.getConfig("projections")||[]).forEach(e=>{e.alias=e.alias?e.alias:e.code,this.registerProjection(e)});for(let t=1;t<61;t++)this.registerProjection({code:t<10?"EPSG:3260"+t:"EPSG:326"+t,def:`+proj=utm +zone=${t} +datum=WGS84 +units=m +no_defs`,extent:void 0});for(let t=1;t<11;t++){const e=t<10?"EPSG:3218"+t:"EPSG:321"+(80+t);let o;o=Number(t)<=2?-50-3*Number(t):Number(t)>=12?-81-3*(Number(t)-12):-49.5-3*Number(t),this.registerProjection({code:e,def:`+proj=tmerc +lat_0=0 +lon_0=${o} +k=0.9999 +x_0=304800 +y_0=0 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"`,extent:void 0})}}registerProjection(e){_a.a.defs(e.code,e.def),Object(za.a)(_a.a),e.extent&&Object(sa.k)(e.code).setExtent(e.extent)}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(K))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),qc=(()=>{class e{constructor(e,t,o,i,r,s,a){this.capabilitiesService=e,this.optionsService=t,this.wfsDataSourceService=o,this.languageService=i,this.messageService=r,this.projectionService=s,this.authInterceptor=a,this.datasources$=new C.a([])}createAsyncDataSource(e,t){if(!e.type)throw console.error(e),new Error("Datasource needs a type");let o;switch(e.type.toLowerCase()){case"osm":o=this.createOSMDataSource(e);break;case"vector":o=this.createFeatureDataSource(e);break;case"wfs":o=this.createWFSDataSource(e);break;case"wms":const i=e;E.removeDuplicateCaseInsensitive(i.params),o=this.createWMSDataSource(i,t);break;case"wmts":o=this.createWMTSDataSource(e);break;case"xyz":o=this.createXYZDataSource(e);break;case"tiledebug":o=this.createTileDebugDataSource(e);break;case"carto":o=this.createCartoDataSource(e);break;case"arcgisrest":o=this.createArcGISRestDataSource(e,t);break;case"imagearcgisrest":o=this.createArcGISRestImageDataSource(e,t);break;case"websocket":o=this.createWebSocketDataSource(e);break;case"mvt":o=this.createMVTDataSource(e);break;case"tilearcgisrest":o=this.createTileArcGISRestDataSource(e,t);break;case"cluster":o=this.createClusterDataSource(e);break;default:throw console.error(e),new Error("Invalid datasource type")}return this.datasources$.next(this.datasources$.value.concat([o])),o}createOSMDataSource(e){return new xe.a(t=>t.next(new jc(e)))}createFeatureDataSource(e){return new xe.a(t=>t.next(new vc(e)))}createWebSocketDataSource(e){return new xe.a(t=>t.next(new Dc(e)))}createWFSDataSource(e){return new xe.a(t=>t.next(new Sc(e,this.wfsDataSourceService,this.authInterceptor)))}createWMSDataSource(e,t){const o=[];return e.optionsFromCapabilities&&o.push(this.capabilitiesService.getWMSOptions(e).pipe(Object(v.a)(t=>{const o=this.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),i=this.languageService.translate.instant("igo.geo.dataSource.unavailable",{value:e.params.LAYERS});throw this.messageService.error(i,o),t}))),this.optionsService&&!0===e.optionsFromApi&&o.push(this.optionsService.getWMSOptions(e,t).pipe(Object(v.a)(e=>(e.error.toDisplay=!0,e.error.title=this.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),e.error.message=this.languageService.translate.instant("igo.geo.dataSource.optionsApiUnavailable"),Object(L.a)({}))))),o.push(Object(L.a)(e)),Object(Ks.a)(o).pipe(Object(j.a)(e=>{const t=e.reduce((e,t)=>E.mergeDeep(e,t));return new uc(t,this.wfsDataSourceService)}),Object(v.a)(()=>Object(L.a)(void 0)))}createWMTSDataSource(e){return e.optionsFromCapabilities?this.capabilitiesService.getWMTSOptions(e).pipe(Object(j.a)(e=>e?new Tc(e):void 0),Object(v.a)(()=>{const t=this.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),o=this.languageService.translate.instant("igo.geo.dataSource.unavailable",{value:e.layer});return this.messageService.error(o,t),Object(L.a)(void 0)})):new xe.a(t=>t.next(new Tc(e)))}createXYZDataSource(e){return new xe.a(t=>t.next(new wc(e)))}createTileDebugDataSource(e){return new xe.a(t=>t.next(new kc(e)))}createCartoDataSource(e){return e.mapId?this.capabilitiesService.getCartoOptions(e).pipe(Object(j.a)(e=>new Lc(e))):new xe.a(t=>t.next(new Lc(e)))}createArcGISRestDataSource(e,t){const o=[];return o.push(this.capabilitiesService.getArcgisOptions(e).pipe(Object(j.a)(e=>new Ic(e)))),this.optionsService&&!0===e.optionsFromApi&&o.push(this.optionsService.getArcgisRestOptions(e,t).pipe(Object(v.a)(e=>(e.error.toDisplay=!0,e.error.title=this.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),e.error.message=this.languageService.translate.instant("igo.geo.dataSource.optionsApiUnavailable"),Object(L.a)({}))))),o.push(Object(L.a)(e)),Object(Ks.a)(o).pipe(Object(j.a)(e=>{const t=e.reduce((e,t)=>E.mergeDeep(e,t));return new Ic(t)}),Object(v.a)(()=>Object(L.a)(void 0)))}createArcGISRestImageDataSource(e,t){const o=[];return o.push(this.capabilitiesService.getImageArcgisOptions(e).pipe(Object(j.a)(e=>new Fc(e)))),this.optionsService&&!0===e.optionsFromApi&&o.push(this.optionsService.getArcgisRestOptions(e,t).pipe(Object(v.a)(e=>(e.error.toDisplay=!0,e.error.title=this.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),e.error.message=this.languageService.translate.instant("igo.geo.dataSource.optionsApiUnavailable"),Object(L.a)({}))))),o.push(Object(L.a)(e)),Object(Ks.a)(o).pipe(Object(j.a)(e=>{const t=e.reduce((e,t)=>E.mergeDeep(e,t));return new Fc(t)}),Object(v.a)(()=>Object(L.a)(void 0)))}createTileArcGISRestDataSource(e,t){const o=[];return o.push(this.capabilitiesService.getTileArcgisOptions(e).pipe(Object(j.a)(e=>new Mc(e)))),this.optionsService&&!0===e.optionsFromApi&&o.push(this.optionsService.getArcgisRestOptions(e,t).pipe(Object(v.a)(e=>(e.error.toDisplay=!0,e.error.title=this.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),e.error.message=this.languageService.translate.instant("igo.geo.dataSource.optionsApiUnavailable"),Object(L.a)({}))))),o.push(Object(L.a)(e)),Object(Ks.a)(o).pipe(Object(j.a)(e=>{const t=e.reduce((e,t)=>E.mergeDeep(e,t));return new Mc(t)}),Object(v.a)(()=>Object(L.a)(void 0)))}createMVTDataSource(e){return new xe.a(t=>t.next(new Pc(e)))}createClusterDataSource(e){return new xe.a(t=>t.next(new Ac(e)))}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(zc),Object(i.qc)(Nc,8),Object(i.qc)(xc),Object(i.qc)(le),Object(i.qc)(ce),Object(i.qc)(Bc),Object(i.qc)(qs))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class Gc extends B{constructor(e){super(),this.loaded=0,this.loading=0,this.source=e.options.source.ol,this.id=z()}watch(){this.source.on("imageloadstart",e=>this.handleLoadStart(e)),this.source.on("imageloadend",e=>this.handleLoadEnd(e)),this.source.on("imageloaderror",e=>this.handleLoadEnd(e))}unwatch(){this.source.un("imageloadstart",e=>this.handleLoadStart(e)),this.source.un("imageloadend",e=>this.handleLoadEnd(e)),this.source.un("imageloaderror",e=>this.handleLoadEnd(e))}handleLoadStart(e){e.image.__watchers__||(e.image.__watchers__=[]),e.image.__watchers__.push(this.id),this.loading+=1,this.status=N.Working}handleLoadEnd(e){if(!e.image.__watchers__)return;const t=e.image.__watchers__.indexOf(this.id);if(t<0)return;e.image.__watchers__.splice(t,1),this.loaded+=1;const o=this.loading;this.loaded>=o&&o===this.loading&&(this.status=N.Done,this.loaded=this.loading=0)}}class Vc extends B{constructor(e){super(),this.loaded=0,this.loading=0,this.source=e.options.source.ol,this.id=z()}watch(){this.source.on("tileloadstart",e=>this.handleLoadStart(e)),this.source.on("tileloadend",e=>this.handleLoadEnd(e)),this.source.on("tileloaderror",e=>this.handleLoadEnd(e))}unwatch(){this.source.un("tileloadstart",e=>this.handleLoadStart(e)),this.source.un("tileloadend",e=>this.handleLoadEnd(e)),this.source.un("tileloaderror",e=>this.handleLoadEnd(e))}handleLoadStart(e){e.tile.__watchers__||(e.tile.__watchers__=[]),e.tile.__watchers__.push(this.id),this.loading+=1,this.status=N.Working}handleLoadEnd(e){if(!e.tile.__watchers__)return;const t=e.tile.__watchers__.indexOf(this.id);if(t<0)return;e.tile.__watchers__.splice(t,1),this.loaded+=1;const o=this.loading;this.loaded>=o&&o===this.loading&&(this.status=N.Done,this.loaded=this.loading=0)}}class Uc extends B{constructor(e){super(),this.loaded=0,this.loading=0,this.layer=e,this.id=z()}watch(){let e=this.layer.options.source.ol;this.layer.dataSource instanceof Ac&&(e=this.layer.options.source.options.source),e.on("vectorloading",e=>this.handleLoadStart(e)),e.on("vectorloaded",e=>this.handleLoadEnd(e)),e.on("vectorloaderror",e=>this.handleLoadEnd(e))}unwatch(){let e=this.layer.options.source.ol;this.layer.dataSource instanceof Ac&&(e=this.layer.options.source.options.source),e.un("vectorloading",e=>this.handleLoadStart(e)),e.un("vectorloaded",e=>this.handleLoadEnd(e)),e.un("vectorloaderror",e=>this.handleLoadEnd(e))}handleLoadStart(e){this.loading+=1,this.status=N.Working}handleLoadEnd(e){this.loaded+=1;const t=this.loading;this.loaded>=t&&t===this.loading&&(this.status=N.Done,this.loaded=this.loading=0)}}class Hc extends hc{constructor(e,t){super(e,t),this.authInterceptor=t,this.watcher=new Gc(this),this.status$=this.watcher.status$}createOlLayer(){const e=Object.assign({},this.options,{source:this.options.source.ol}),t=new Na.a(e);return this.authInterceptor&&t.getSource().setImageLoadFunction((e,t)=>{this.customLoader(e,t,this.authInterceptor)}),t}setMap(e){void 0===e?this.watcher.unsubscribe():this.watcher.subscribe(()=>{}),super.setMap(e)}customLoader(e,t,o){const i=new XMLHttpRequest;if(i.open("GET",t),!o.interceptXhr(i,t))return i.abort(),void(e.getImage().src=t);i.responseType="arraybuffer",i.onload=function(){const t=new Uint8Array(this.response),o=new Blob([t],{type:"image/png"}),i=window.URL.createObjectURL(o);e.getImage().src=i},i.send()}}class Yc extends hc{constructor(e){super(e),this.watcher=new Vc(this),this.status$=this.watcher.status$}createOlLayer(){const e=Object.assign({},this.options,{source:this.options.source.ol});return new Ba.a(e)}setMap(e){void 0===e?this.watcher.unsubscribe():this.watcher.subscribe(()=>{}),super.setMap(e)}}class Wc extends hc{constructor(e,t){super(e,t),this.authInterceptor=t,this.watcher=new Uc(this),this.status$=this.watcher.status$}get browsable(){return!1!==this.options.browsable}get exportable(){return!1!==this.options.exportable}createOlLayer(){const e=Object.assign({},this.options,{source:this.options.source.ol});this.options.animation&&this.dataSource.ol.on("addfeature",(function(e){this.flash(e.feature)}).bind(this)),this.options.trackFeature&&this.enableTrackFeature(this.options.trackFeature);const t=new qa.a(e),o=this.dataSource instanceof Ac?t.getSource().getSource():t.getSource(),i=o.getUrl();if(o.addEventListener("vectorloading"),o.addEventListener("vectorloaded"),o.addEventListener("vectorloaderror"),i){const e=(e,t,r)=>{this.customLoader(o,i,this.authInterceptor,e,t,r)};e&&o.setLoader(e)}return t}flash(e){const t=(new Date).getTime(),o=this.ol.on("postrender",(function(i){const r=Object(Ha.a)(i),s=i.frameState,a=e.getGeometry().clone(),n=s.time-t,c=n/this.options.animation.duration,l=Object(Va.b)(1-c),u=Object(Ua.a)(this.options.animation.color||"red");u[3]=l;let d=this.ol.getStyleFunction().call(this,e).find(e=>e.getImage());d||(d=this.ol.getStyleFunction().call(this,e)[0]);const h=d.clone();switch(e.getGeometry().getType()){case"Point":const e=Object(Va.b)(c)*(3*h.getImage().getRadius());h.getImage().setRadius(e),h.getImage().setOpacity(l);break;case"LineString":h.getImage()&&(h.getImage().getStroke().setColor(u),h.getImage().getStroke().setWidth(Object(Va.b)(c)*(3*h.getImage().getStroke().getWidth()))),h.getStroke()&&(h.getStroke().setColor(u),h.getStroke().setWidth(Object(Va.b)(c)*(3*h.getStroke().getWidth())));break;case"Polygon":h.getImage()&&h.getImage().getFill().setColor(u),h.getFill()&&h.getFill().setColor(u)}if(h.setText(""),r.setStyle(h),r.drawGeometry(a),n>this.options.animation.duration)return Object(Ga.b)(o),void this.map.ol.render();this.map.ol.render()}).bind(this))}setMap(e){void 0===e?this.watcher.unsubscribe():this.watcher.subscribe(()=>{}),super.setMap(e)}onUnwatch(){this.dataSource.onUnwatch(),this.stopAnimation()}stopAnimation(){this.dataSource.ol.un("addfeature",(function(e){this.visible&&this.flash(e.feature)}).bind(this))}enableTrackFeature(e){this.trackFeatureListenerId=this.dataSource.ol.on("addfeature",this.trackFeature.bind(this,e))}centerMapOnFeature(e){const t=this.dataSource.ol.getFeatureById(e);t&&this.map.ol.getView().setCenter(t.getGeometry().getCoordinates())}trackFeature(e,t){t.feature.getId()===e&&this.visible&&this.centerMapOnFeature(e)}disableTrackFeature(e){Object(Ga.b)(this.trackFeatureListenerId)}customLoader(e,t,o,i,r,s){e.dispatchEvent({type:"vectorloading"});const a=new XMLHttpRequest;a.open("GET","function"==typeof t?t=t(i,r,s):t),o&&o.interceptXhr(a,t);const n=()=>{e.dispatchEvent({type:"vectorloaderror"}),e.removeLoadedExtent(i)};a.onerror=n,a.onload=()=>{200===a.status?(e.addFeatures(e.getFormat().readFeatures(a.responseText)),e.dispatchEvent({type:"vectorloaded"})):n()},a.send()}}class Kc extends hc{constructor(e,t){super(e,t),this.authInterceptor=t,this.watcher=new Vc(this),this.status$=this.watcher.status$}createOlLayer(){const e=Object.assign({},this.options,{source:this.options.source.ol}),t=new Ya.a(e);return t.getSource().setTileLoadFunction((e,t)=>{const o=this.customLoader(t,e.getFormat(),this.authInterceptor,e.onLoad.bind(e));o&&e.setLoader(o)}),t}customLoader(e,t,o,i,r){return(s,a,n)=>{const c=new XMLHttpRequest;c.open("GET","function"==typeof e?e=e(s,a,n):e),o&&o.interceptXhr(c,e),"arraybuffer"===t.getType()&&(c.responseType="arraybuffer"),c.onload=e=>{if(!c.status||c.status>=200&&c.status<300){const e=t.getType();let o;"json"===e||"text"===e?o=c.responseText:"xml"===e?(o=c.responseXML,o||(o=(new DOMParser).parseFromString(c.responseText,"application/xml"))):"arraybuffer"===e&&(o=c.response),o?i.call(this,t.readFeatures(o,{extent:s,featureProjection:n}),t.readProjection(o)):r.call(this)}else r.call(this)},c.onerror=()=>{r.call(this)},c.send()}}setMap(e){void 0===e?this.watcher.unsubscribe():this.watcher.subscribe(()=>{}),super.setMap(e)}}function Zc({text:e,opacity:t=1,markerColor:o=[0,161,222],markerOutlineColor:i=[255,255,255]}={}){let r,s,a,n;const c=/msie\s|trident\/|edge\//i.test(window.navigator.userAgent),l=Object(Ua.a)(o).slice(0),u=Object(Ua.a)(i).slice(0);let d;if(4!==l.length||"string"==typeof o&&!/^#[0-9A-F]{8}$/i.test(o)||(t=l[3]),s=`"rgba(${l[0]},${l[1]},${l[2]},${t})"`,r=o,a=`"rgb(${u[0]},${u[1]},${u[2]})"`,n='data:image/svg+xml;utf8,<svg version="1.1" xmlns="http://www.w3.org/2000/svg" height="36" width="36" viewBox="0 0 36 36"><path fill='+s+" stroke="+a+' stroke-width="2" d="M 17.692635,32.565644 C 15.71852,30.330584 13.290925,27.058065 11.6766,24.455732 9.3398623,20.688851 7.8905694,17.205334 7.6297492,14.728733 7.5616025,14.081649 7.5739557,12.528552 7.6513363,12.014724 8.1013861,9.0262716 9.8047068,6.3655569 12.310675,4.7364878 c 1.113691,-0.7239832 2.508083,-1.2834131 3.776687,-1.5152052 0.242945,-0.044389 0.451656,-0.09393 0.463804,-0.1100911 0.01215,-0.016161 0.638282,-0.025502 1.391411,-0.02076 1.088235,0.00685 1.450932,0.024316 1.766871,0.085071 2.650763,0.5097353 4.947142,1.8701891 6.498786,3.8501033 0.628018,0.8013587 1.297046,2.0200608 1.640967,2.9891872 0.191065,0.538399 0.427644,1.447408 0.477391,1.834287 0.0164,0.127546 0.0434,0.231902 0.06,0.231902 0.0166,0 0.03122,0.626135 0.03249,1.391411 0.0013,0.765276 -0.011,1.391411 -0.02726,1.391411 -0.01626,0 -0.05449,0.154049 -0.08495,0.342331 -0.08815,0.544879 -0.387235,1.721449 -0.604837,2.379406 -1.209421,3.656888 -4.014463,8.349762 -7.849521,13.132357 -0.790496,0.985807 -1.795217,2.167992 -1.842543,2.167992 -0.01896,0 -0.161766,-0.144111 -0.317336,-0.320246 z m 1.066937,-15.36525 c 0.133519,-0.02121 0.248766,-0.05657 0.256105,-0.07859 0.0073,-0.02202 0.04918,-0.03066 0.09298,-0.0192 0.0438,0.01145 0.107628,-0.0072 0.141834,-0.04137 0.03421,-0.03421 0.08456,-0.05474 0.111888,-0.04563 0.02733,0.0091 0.07703,-0.01077 0.110429,-0.04417 0.03341,-0.03341 0.08416,-0.05293 0.112796,-0.04338 0.02863,0.0095 0.08974,-0.01867 0.135802,-0.06271 0.04606,-0.04403 0.111902,-0.08625 0.146319,-0.09381 0.204084,-0.04483 0.762371,-0.519108 1.079463,-0.917027 0.26749,-0.335672 0.570987,-0.878795 0.529019,-0.946701 -0.01496,-0.0242 -0.0067,-0.044 0.01835,-0.044 0.05645,0 0.196809,-0.467982 0.158801,-0.529481 -0.01521,-0.02461 -0.0043,-0.04475 0.02427,-0.04475 0.03157,0 0.04365,-0.04329 0.03082,-0.11043 -0.01161,-0.06074 -0.0066,-0.110429 0.01124,-0.110429 0.01779,0 0.03235,-0.258405 0.03235,-0.574233 0,-0.315829 -0.01545,-0.574234 -0.03434,-0.574234 -0.01889,0 -0.02437,-0.03811 -0.01219,-0.08469 0.04412,-0.168712 -0.336329,-1.152668 -0.481536,-1.245401 -0.02327,-0.01486 -0.04022,-0.03992 -0.03765,-0.05568 0.01222,-0.07498 -0.156557,-0.318365 -0.406379,-0.586027 -0.295921,-0.317054 -0.773059,-0.690104 -0.83427,-0.652274 -0.0206,0.01273 -0.03745,0.0024 -0.03745,-0.02289 0,-0.06107 -0.433076,-0.2789369 -0.487546,-0.245273 -0.02338,0.01445 -0.04251,0.0068 -0.04251,-0.01695 0,-0.056281 -0.393995,-0.1865457 -0.613804,-0.2029397 -0.0943,-0.00703 -0.188579,-0.023183 -0.209503,-0.035888 -0.02092,-0.012705 -0.276571,-0.023337 -0.568105,-0.023627 -0.534044,-5.301e-4 -1.12638,0.091025 -1.12638,0.1741017 0,0.023781 -0.01713,0.032648 -0.03808,0.019705 -0.05054,-0.031232 -0.403641,0.1088602 -0.403641,0.1601422 0,0.02204 -0.01988,0.02779 -0.04417,0.01278 -0.0243,-0.01501 -0.04417,-0.0051 -0.04417,0.02209 0,0.02716 -0.01988,0.0371 -0.04417,0.02209 -0.0243,-0.01501 -0.04417,-0.0051 -0.04417,0.02209 0,0.02716 -0.01915,0.03755 -0.04256,0.02308 -0.02341,-0.01447 -0.08138,0.01252 -0.128834,0.05997 -0.04745,0.04745 -0.0974,0.07515 -0.111001,0.06155 -0.0136,-0.0136 -0.03722,0.0078 -0.05248,0.0476 -0.01526,0.03978 -0.0411,0.06408 -0.0574,0.054 -0.03277,-0.02025 -0.462299,0.323995 -0.491977,0.394291 -0.01026,0.02429 -0.07454,0.0912 -0.142856,0.148686 -0.248033,0.208705 -0.730279,0.974169 -0.672565,1.067553 0.0145,0.02346 0.0059,0.04266 -0.01914,0.04266 -0.05907,0 -0.241471,0.599428 -0.208527,0.685278 0.01385,0.0361 0.0044,0.06564 -0.02098,0.06564 -0.02539,0 -0.04169,0.0646 -0.03622,0.143558 0.0055,0.07896 -0.0042,0.213129 -0.02144,0.29816 -0.04741,0.233576 0.0511,1.055502 0.167516,1.397721 0.126048,0.370516 0.310099,0.740163 0.426484,0.856548 0.04776,0.04776 0.07554,0.08684 0.06174,0.08684 -0.0138,0 0.01516,0.05653 0.06436,0.125632 0.131301,0.184396 0.499365,0.587266 0.518785,0.567846 0.0092,-0.0092 0.09821,0.06081 0.197812,0.155562 0.09961,0.09475 0.190589,0.162786 0.202187,0.151188 0.0116,-0.0116 0.05991,0.01774 0.107361,0.06519 0.04745,0.04745 0.105426,0.07444 0.128834,0.05997 0.02341,-0.01447 0.04256,-0.0057 0.04256,0.01958 0,0.06106 0.344664,0.23496 0.399061,0.201341 0.02346,-0.0145 0.04266,-0.0059 0.04266,0.01914 0,0.05907 0.599429,0.241471 0.685279,0.208527 0.0361,-0.01385 0.06564,-0.0065 0.06564,0.01645 0,0.05196 1.079115,0.04833 1.413314,-0.0048 z"></path></svg>',c){switch(o){case"blue":r="blue";break;case"red":r="red";break;case"yellow":r="yellow";break;case"green":r="green";break;default:r="blue"}d="./assets/igo2/geo/icons/place_"+r+"_36px.svg"}else d=n;return new Ra.Style({image:new Ra.Icon({src:n,opacity:t,imgSize:[36,36],anchor:[.5,.92]}),text:new Ra.Text({text:e,font:"12px Calibri,sans-serif",fill:new Ra.Fill({color:"#000"}),stroke:new Ra.Stroke({color:"#fff",width:3}),overflow:!0})})}let Qc=(()=>{class e{createStyle(e){return e?"function"==typeof e||e instanceof Ra.Style?e:this.parseStyle("style",e):Zc()}parseStyle(e,t){const o={},i=this.getOlCls(e);return i&&t instanceof Object?(Object.keys(t).forEach(e=>{const i=this.getOlKey(e);o[i]=this.parseStyle(e,t[e])}),new i(o)):t}getOlKey(e){let t;switch(e.toLowerCase()){case"circle":case"regularshape":case"icon":t="image"}return t||e}getOlCls(e){let t=Ra[e.charAt(0).toUpperCase()+e.slice(1)];return"regularshape"===e&&(t=Ra.RegularShape),"backgroundFill"===e&&(t=Ra.Fill),"backgroundStroke"===e&&(t=Ra.Stroke),t}createStyleByAttribute(e,t){let o;const i=t.type?t.type:this.guessTypeFeature(e),r=t.attribute,s=t.data,a=t.stroke,n=t.width,c=t.fill,l=t.radius,u=t.icon,d=t.scale,h=s?s.length:0,p=t.label?t.label.attribute||t.label:void 0,m=t.label?this.parseStyle("text",t.label.style)||new Ra.Text:void 0,g=t.baseStyle;if(m&&m.setText(this.getLabel(e,p)),"circle"===i){for(let t=0;t<h;t++){const i=void 0!==e.get(r)?e.get(r):"";if(i===s[t]||i.toString().match(s[t]))return u?(o=[new Ra.Style({image:new Ra.Icon({src:u[t],scale:d?d[t]:1})})],o):(o=[new Ra.Style({image:new Ra.Circle({radius:l?l[t]:4,stroke:new Ra.Stroke({color:a?a[t]:"black",width:n?n[t]:1}),fill:new Ra.Fill({color:c?c[t]:"black"})}),text:m})],o)}if(!e.getStyle())return g?(o=this.createStyle(g),m&&o.setText(m),o):(o=[new Ra.Style({image:new Ra.Circle({radius:4,stroke:new Ra.Stroke({color:"black"}),fill:new Ra.Fill({color:"#bbbbf2"})})})],o)}else if("regular"===i){for(let t=0;t<h;t++){const i=void 0!==e.get(r)?e.get(r):"";if(i===s[t]||i.toString().match(s[t]))return o=[new Ra.Style({stroke:new Ra.Stroke({color:a?a[t]:"black",width:n?n[t]:1}),fill:new Ra.Fill({color:c?c[t]:"rgba(255,255,255,0.4)"}),text:m})],o}if(e instanceof Da.a&&!e.getStyle())return g?(o=this.createStyle(g),m&&o.setText(m),o):(o=[new Ra.Style({stroke:new Ra.Stroke({color:"black"}),fill:new Ra.Fill({color:"#bbbbf2"})})],o)}}createClusterStyle(e,t={},o){let i;const r=e.get("features").length;if(1!==r){if(t.clusterRanges)for(const e of t.clusterRanges)if((!e.minRadius||e.minRadius<=r)&&(!e.maxRadius||e.maxRadius>=r)){if(i=this.createStyle(e.style),e.showRange){const e=new Ra.Text({text:r.toString(),fill:new Ra.Fill({color:"#fff"})});i.setText(e)}if(e.dynamicRadius){let e;const t=i.image_.getRadius();e=5*Math.log(r),e<t&&(e=t),i.image_.setRadius(e)}break}if(!i){let e;if(t.radiusCalc)e=t.radiusCalc(r);else{const t=6;e=5*Math.log(r),e<t&&(e=t)}i=[new Ra.Style({image:new Ra.Circle({radius:e,opacity:.4,stroke:new Ra.Stroke({color:"black"}),fill:new Ra.Fill({color:"rgba(24, 134, 45, 0.5)"})}),text:new Ra.Text({text:r.toString(),fill:new Ra.Fill({color:"#fff"})})})]}}else i=this.createStyle(o);return i}getLabel(e,t){let o=t;const i=Array.from(t.matchAll(/\$\{([^\{\}]+)\}/g));return i.forEach(t=>{o=o.replace(t[0],e.get(t[1]))}),0===i.length&&o===t&&(o=e.get(t)||t),o}guessTypeFeature(e){switch(e.getGeometry().getType()){case"Point":case"MultiPoint":case"Circle":return"circle";default:return"regular"}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Jc=(()=>{class e{constructor(e,t,o,i){this.http=e,this.styleService=t,this.dataSourceService=o,this.authInterceptor=i}createLayer(e){if(!e.source)return;let t;switch(e.source.options&&e.source.options._layerOptionsFromSource&&(e=E.mergeDeep(e.source.options._layerOptionsFromSource,e||{})),e.source.constructor){case jc:case Tc:case wc:case kc:case Lc:case Mc:t=this.createTileLayer(e);break;case vc:case Sc:case Ic:case Dc:case Ac:t=this.createVectorLayer(e);break;case Fc:case uc:t=this.createImageLayer(e);break;case Pc:t=this.createVectorTileLayer(e)}return t}createAsyncLayer(e,t){return e.source?new xe.a(t=>t.next(this.createLayer(e))):this.dataSourceService.createAsyncDataSource(e.sourceOptions,t).pipe(Object(j.a)(t=>{if(void 0!==t)return this.createLayer(Object.assign(e,{source:t}))}))}createImageLayer(e){return new Hc(e,this.authInterceptor)}createTileLayer(e){return new Yc(e)}createVectorLayer(e){let t,o;if(void 0!==e.style&&(t=this.styleService.createStyle(e.style)),e.source instanceof Ic)t=e.source.options.params.style;else if(e.styleByAttribute){const t=this.styleService;e.style=o=>t.createStyleByAttribute(o,e.styleByAttribute),o=new Wc(e,this.authInterceptor)}if(e.source instanceof Ac){const t=this.styleService,i=e.clusterBaseStyle;e.style=o=>t.createClusterStyle(o,e.clusterParam,i),o=new Wc(e,this.authInterceptor)}const i=Object.assign({},e,{style:t});return o||(o=new Wc(i,this.authInterceptor)),this.applyMapboxStyle(o,i),o}createVectorTileLayer(e){let t,o;if(void 0!==e.style&&(t=this.styleService.createStyle(e.style)),e.styleByAttribute){const t=this.styleService;e.style=o=>t.createStyleByAttribute(o,e.styleByAttribute),o=new Kc(e,this.authInterceptor)}const i=Object.assign({},e,{style:t});return o||(o=new Kc(i,this.authInterceptor)),this.applyMapboxStyle(o,i),o}applyMapboxStyle(e,t){t.mapboxStyle&&this.getMapboxGlStyle(t.mapboxStyle.url).subscribe(o=>{Object(fa.a)(e.ol,o,t.mapboxStyle.source)})}getMapboxGlStyle(e){return this.http.get(e).pipe(Object(j.a)(e=>e),Object(v.a)(e=>(console.log("No style was found"),Object(L.a)(e))))}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(y.b),Object(i.qc)(Qc),Object(i.qc)(qc),Object(i.qc)(qs,8))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const Xc="Feature";var el=function(e){return e[e.None=0]="None",e[e.Move=1]="Move",e[e.Zoom=2]="Zoom",e[e.Default=3]="Default",e}({});function tl(e,t,o){o=o||tt;const i=(new sn.a).readFeature(e,{dataProjection:e.projection,featureProjection:t});i.setId(o(e));const r=ot(e);void 0!==r&&i.set("_title",r,!0),void 0!==e.extent&&i.set("_extent",e.extent,!0),void 0!==e.projection&&i.set("_projection",e.projection,!0);const s=et(e,"meta.mapTitle");void 0!==s&&i.set("_mapTitle",s,!0),i.set("_entityRevision",(e.meta||{}).revision||0,!0);const a=it(e);return void 0!==a&&i.set("_icon",a,!0),e.meta&&e.meta.style&&i.set("_style",e.meta.style,!0),e.sourceId&&i.set("_sourceId",e.sourceId,!0),i}function ol(e,t,o,i="EPSG:4326"){let r,s,a,n;const c=new sn.a,l=e.getKeys().filter(e=>!e.startsWith("_")&&"geometry"!==e).reduce((t,o)=>(t[o]=e.get(o),t),{}),u=c.writeGeometryObject(e.getGeometry(),{dataProjection:i,featureProjection:t});if(o){r=o.get("title");const e=o.get("sourceOptions");e&&(s=e.excludeAttribute,a=e.excludeAttributeOffline,n=e.idColumn||("arcgisrest"===e.type||"tilearcgisrest"===e.type?"OBJECTID":void 0))}else r=e.get("_title");const d=e.get("_mapTitle"),h=e.getId()?e.getId():e.get(n)?e.get(n):z();return{type:Xc,projection:i,extent:e.get("_extent"),meta:{id:h,title:r||d||h,mapTitle:d,revision:e.getRevision(),style:e.get("_style"),excludeAttribute:s,excludeAttributeOffline:a},properties:l,geometry:u,ol:e}}function il(e,t){const[o,i]=Object(Ca.D)(e);return[t[3]?e[0]-o*t[3]:e[0],t[2]?e[1]-i*t[2]:e[1],t[1]?e[2]+o*t[1]:e[2],t[0]?e[3]+i*t[0]:e[3]]}function rl(e,t,o=el.Default,i,r){const s=function(e,t){const o=Object(Ca.k)();return t.forEach(t=>{const i=function(e,t){let o=Object(Ca.k)();const i=t.get("_extent"),r=t.get("_projection");if(void 0!==i&&void 0!==r)o=Object(sa.t)(i,r,e.projection);else{const e=t.getGeometry();null!==e&&(o=e.getExtent())}return o}(e,t);Object(Ca.r)(o,i)}),o}(e,t);let a=s;void 0!==i&&(a=il(a,i)),o===el.Zoom?e.viewController.zoomToExtent(a):o===el.Move?e.viewController.moveToExtent(a):o===el.Default&&(function(e,t){const o=il(e.viewController.getExtent(),[-1,-1,-1,-1].map(e=>.05*e));return!Object(Ca.h)(o,t)}(e,s)||function(e,t,o){o=o||.004;const i=e.viewController.getExtent(),r=Object(Ca.v)(i),s=Object(Ca.v)(t);return!(0===s&&e.viewController.getZoom()>13)&&s/r<o}(e,s,r))&&e.viewController.zoomToExtent(a)}function sl(e,t){void 0===e.layer?(t=t||new Wc({source:new vc}),e.bindLayer(t),void 0===e.layer.map&&e.map.addLayer(e.layer)):void 0===e.layer.map&&e.map.addLayer(e.layer)}class al extends at{constructor(e,t){super(e,t),this.map=t.map}get source(){return this.layer?this.layer.dataSource:void 0}bindLayer(e){return this.layer=e,this}setLayerFeatures(e,t=el.Default,o,i,r){r=r||tt,this.checkLayer();const s=e.map(e=>tl(e,this.map.projection,r));this.setLayerOlFeatures(s,t,o,i)}setStoreOlFeatures(e){this.checkLayer();const t=e.map(e=>(e.set("_featureStore",this,!0),ol(e,this.layer.map.projection)));this.load(t)}clearLayer(){this.checkLayer(),this.source.ol.clear()}checkLayer(){if(void 0===this.layer)throw new Error("This FeatureStore is not bound to a layer.")}setLayerOlFeatures(e,t=el.Default,o,i){const r=function(e,t){const o=new Map;t.forEach(e=>{o.set(e.getId(),e)});const i=[];e.forEach(e=>{const t=o.get(e.getId());void 0===t||t.get("_entityRevision")!==e.get("_entityRevision")?i.push(e):o.delete(t.getId())});const r=Array.from(o.keys());return{add:t.filter(e=>r.indexOf(e.getId())>=0),remove:i}}(this.layer.ol.getSource().getFeatures(),e);r.remove.length>0&&this.removeOlFeaturesFromLayer(r.remove),r.add.length>0&&this.addOlFeaturesToLayer(r.add),r.add.length>0?rl(this.map,r.add,t,o,i):r.remove.length>0&&rl(this.map,e,t,o,i)}addOlFeaturesToLayer(e){e.forEach(e=>{e.set("_featureStore",this,!0)}),this.source.ol.addFeatures(e)}removeOlFeaturesFromLayer(e){e.forEach(e=>{this.source.ol.removeFeature(e)})}}class nl extends ct{constructor(e){super(e),this.options=e,this.stores$$=new Map,this.states$$=[]}bindStore(e){super.bindStore(e),!0===this.active&&this.watchStore(e),this.empty$$=e.empty$.pipe(Object(ta.a)(e=>!e)).subscribe(()=>this.updateEntitiesInExtent(e))}unbindStore(e){super.unbindStore(e),!0===this.active&&this.unwatchStore(e)}doActivate(){this.stores.forEach(e=>this.watchStore(e))}doDeactivate(){this.unwatchAll()}watchStore(e){this.stores$$.has(e)||(this.updateEntitiesInExtent(e),this.states$$.push(e.layer.map.viewController.state$.subscribe(()=>{this.updateEntitiesInExtent(e)})))}updateEntitiesInExtent(e){var t,o;if(null===(o=null===(t=null==e?void 0:e.layer)||void 0===t?void 0:t.map)||void 0===o?void 0:o.viewController){e.state.updateAll({inMapExtent:!1});const t=e.layer.map.viewController.getExtent(),o=e.entities$.value.filter(e=>Object(Ca.H)(e.ol.getGeometry().getExtent(),t));o.length>0&&e.state.updateMany(o,{inMapExtent:!0},!0)}}unwatchStore(e){const t=this.stores$$.get(e);void 0!==t&&(Object(Ga.b)(t),this.stores$$.delete(e))}unwatchAll(){Array.from(this.stores$$.entries()).forEach(e=>{Object(Ga.b)(e[1])}),this.stores$$.clear(),this.states$$.map(e=>e.unsubscribe()),this.empty$$&&this.empty$$.unsubscribe()}}class cl extends ct{constructor(e){super(e),this.options=e,this.stores$$=new Map,this.resolution$$=[]}bindStore(e){super.bindStore(e),!0===this.active&&this.watchStore(e),this.empty$$=e.empty$.subscribe(()=>this.updateEntitiesInResolution(e,e.layer.map.viewController.getResolution()))}unbindStore(e){super.unbindStore(e),!0===this.active&&this.unwatchStore(e)}doActivate(){this.stores.forEach(e=>this.watchStore(e))}doDeactivate(){this.unwatchAll()}watchStore(e){this.stores$$.has(e)||(this.updateEntitiesInResolution(e,e.layer.map.viewController.getResolution()),this.resolution$$.push(e.layer.map.viewController.resolution$.subscribe(t=>{this.updateEntitiesInResolution(e,t)})))}updateEntitiesInResolution(e,t){e.state.updateAll(t>e.layer.minResolution&&t<e.layer.maxResolution?{inMapResolution:!0}:{inMapResolution:!1})}unwatchStore(e){const t=this.stores$$.get(e);void 0!==t&&(Object(Ga.b)(t),this.stores$$.delete(e))}unwatchAll(){Array.from(this.stores$$.entries()).forEach(e=>{Object(Ga.b)(e[1])}),this.stores$$.clear(),this.resolution$$.map(e=>e.unsubscribe()),this.empty$$&&this.empty$$.unsubscribe()}}class ll extends ct{constructor(e){super(e),this.options=e,this.stores$$=new Map,this.setMotion(e.motion)}bindStore(e){super.bindStore(e),!0===this.active&&this.watchStore(e)}unbindStore(e){super.unbindStore(e),!0===this.active&&this.unwatchStore(e)}setMotion(e){this.motion=e}doActivate(){this.stores.forEach(e=>this.watchStore(e))}doDeactivate(){this.unwatchAll()}watchStore(e){if(this.stores$$.has(e))return;const t=e.view.all$().subscribe(t=>this.onFeaturesChange(t,e));this.stores$$.set(e,t)}unwatchStore(e){const t=this.stores$$.get(e);void 0!==t&&(t.unsubscribe(),this.stores$$.delete(e))}unwatchAll(){Array.from(this.stores$$.entries()).forEach(e=>{e[1].unsubscribe()}),this.stores$$.clear()}onFeaturesChange(e,t){0===e.length?t.clearLayer():t.setLayerFeatures(e,this.selectMotion(t),this.options.viewScale,this.options.areaRatio,this.options.getFeatureId)}selectMotion(e){return void 0!==this.motion?this.motion:!0===e.pristine||e.count>e.view.count?el.Default:el.None}}class ul extends ct{constructor(e){super(e),this.options=e,this.stores$$=new Map}bindStore(e){super.bindStore(e),!0===this.active&&this.watchStore(e)}unbindStore(e){super.unbindStore(e),!0===this.active&&this.unwatchStore(e)}doActivate(){this.stores.forEach(e=>this.watchStore(e))}doDeactivate(){this.unwatchAll()}watchStore(e){this.stores$$.has(e)||(this.onSourceChanges(e),e.layer.ol.getSource().on("change",t=>{this.onSourceChanges(e)}))}unwatchStore(e){const t=this.stores$$.get(e);void 0!==t&&(Object(Ga.b)(t),this.stores$$.delete(e))}unwatchAll(){Array.from(this.stores$$.entries()).forEach(e=>{Object(Ga.b)(e[1])}),this.stores$$.clear()}onSourceChanges(e){let t=e.layer.ol.getSource().getFeatures();e.layer.dataSource instanceof Ac&&(t=t.flatMap(e=>e.get("features"))),0===t.length?e.clear():e.setStoreOlFeatures(t)}}class dl extends an.a{constructor(e){super(e)}}class hl extends ct{constructor(e){super(e),this.options=e,this.setMotion(e.motion),this._overlayStore=this.createOverlayStore()}get map(){return this.options.map}get overlayStore(){return this._overlayStore}bindStore(e){super.bindStore(e),!0===this.active&&this.activate()}unbindStore(e){super.unbindStore(e),!0===this.active&&this.activate()}setMotion(e){this.motion=e}unselectAll(){this.stores.forEach(e=>{e.state.updateAll({selected:!1})})}clear(){this.overlayStore.source.ol.clear(),this.overlayStore.clear()}deactivateSelection(){this.unlistenToMapClick(),this.removeDragBoxInteraction(),this.unwatchAll()}doActivate(){this.addOverlayLayer(),this.listenToMapClick(),!0===this.options.dragBox&&this.addDragBoxInteraction(),this.watchAll()}doDeactivate(){this.deactivateSelection(),this.removeOverlayLayer()}watchAll(){this.unwatchAll();const e=this.stores.map(e=>e.stateView.manyBy$(e=>!0===e.state.selected).pipe(Object(j.a)(e=>e.map(e=>e.entity))));this.stores$$=Object(I.a)(e).pipe(Object(S.a)(5),Object(Le.a)(1),Object(j.a)(e=>e.reduce((e,t)=>e.concat(t)))).subscribe(e=>this.onSelectFromStore(e))}unwatchAll(){void 0!==this.stores$$&&this.stores$$.unsubscribe()}listenToMapClick(){this.mapClickListener=this.map.ol.on("singleclick",e=>{this.onMapClick(e)})}unlistenToMapClick(){void 0!==this.mapClickListener&&this.map.ol.un(this.mapClickListener.type,this.mapClickListener.listener)}onMapClick(e){const t=!Nn(e),o=!t,i=e.map.getFeaturesAtPixel(e.pixel,{hitTolerance:this.options.hitTolerance||0,layerFilter:e=>void 0!==this.stores.find(t=>t.layer.ol===e)});this.onSelectFromMap(i,t,o)}addDragBoxInteraction(){let e;const t=this.map.ol.getInteractions().getArray();for(const o of t)if(o instanceof dl){e=o;break}void 0===e&&(e=new dl({condition:Nn}),this.map.ol.addInteraction(e),this.olDragSelectInteraction=e),this.olDragSelectInteractionEndKey=e.on("boxend",e=>this.onDragBoxEnd(e))}removeDragBoxInteraction(){void 0!==this.olDragSelectInteractionEndKey&&Object(Ga.b)(this.olDragSelectInteractionEndKey),void 0!==this.olDragSelectInteraction&&this.map.ol.removeInteraction(this.olDragSelectInteraction),this.olDragSelectInteraction=void 0}onDragBoxEnd(e){const t=!Nn(e.mapBrowserEvent),o=e.target.getGeometry().getExtent(),i=this.stores.reduce((e,t)=>{const i=t.layer.ol.getSource();return e.push(...i.getFeaturesInExtent(o)),e},[]);this.onSelectFromMap(i,t,!1)}onSelectFromStore(e){const t=this.motion,o=this.overlayStore.layer.ol.getSource().getFeatures().map(e=>e.getId()),i=e.map(this.overlayStore.getKey);let r;r=0!==e.length&&(o.length!==i.length||!o.every(e=>i.indexOf(e)>=0)),this.overlayStore.setLayerFeatures(e,r?t:el.None,this.options.viewScale,this.options.areaRatio,this.options.getFeatureId)}onSelectFromMap(e,t,o){const i=this.groupFeaturesByStore(e);this.stores.forEach(e=>{const r=i.get(e);void 0===r&&!0===t?this.unselectAllFeaturesFromStore(e):void 0===r&&!1===t||this.selectFeaturesFromStore(e,r,t,o)})}selectFeaturesFromStore(e,t,o,i){!0===i?e.state.reverseMany(t,["selected"]):e.state.updateMany(t,{selected:!0},o)}unselectAllFeaturesFromStore(e){e.state.updateAll({selected:!1})}groupFeaturesByStore(e){const t=new Map;return null==e||e.forEach(e=>{const o=e.get("_featureStore");if(void 0===o)return;let i=t.get(o);void 0===i&&(i=[],t.set(o,i));const r=o.get(e.getId());void 0!==r&&i.push(r)}),t}createOverlayStore(){const e=this.options.layer?this.options.layer:this.createOverlayLayer();return new al([],{map:this.map}).bindLayer(e)}createOverlayLayer(){return new Wc({zIndex:300,source:new vc,style:void 0,showInLayerList:!1,exportable:!1,browsable:!1})}addOverlayLayer(){void 0===this.overlayStore.layer.map&&this.map.addLayer(this.overlayStore.layer)}removeOverlayLayer(){this.overlayStore.source.ol.clear(),this.map.removeLayer(this.overlayStore.layer)}}function pl(e,t){void 0===e.getStrategyOfType(ll)?(t=t||new ll({}),e.addStrategy(t),t.activate()):e.activateStrategyOfType(ll)}function ml(e,t){void 0===e.getStrategyOfType(hl)?(t=t||new hl({map:e.map}),e.addStrategy(t),t.activate()):e.activateStrategyOfType(hl)}function gl(){const e=function({text:e,strokeWidth:t=2,fillColor:o=[0,161,222,.3],strokeColor:i=[0,161,222,.9]}={}){const r=Object(Ua.a)(o).slice(0),s=Object(Ua.a)(i).slice(0),a=new Ra.Stroke({width:t,color:s}),n=new Ra.Fill({color:r});return new Ra.Style({stroke:a,fill:n,image:new Ra.Circle({radius:5,stroke:a,fill:n}),text:new Ra.Text({text:e,font:"12px Calibri,sans-serif",fill:new Ra.Fill({color:"#000"}),stroke:new Ra.Stroke({color:"#fff",width:3}),overflow:!0})})}(),t=Zc();let o;return i=>{if("bufferFeature"===i.getId())return o=function(e=[0,161,222,1],t=2,o=[0,161,222,.15],i){const r=new Ra.Stroke({width:t,color:e}),s=new Ra.Stroke({color:o});return new Ra.Style({stroke:r,fill:s,image:new Ra.Circle({radius:5,stroke:r,fill:s}),text:new Ra.Text({font:"12px Calibri,sans-serif",text:i,fill:new Ra.Fill({color:"#000"}),stroke:new Ra.Stroke({color:"#fff",width:3}),overflow:!0})})}(i.get("bufferStroke"),2,i.get("bufferFill"),i.get("bufferText")),o;{const r=i.get("_style");if(r)return(new Qc).createStyle(r);const s=i.getGeometry().getType();return o="Point"===s?t:e,o.getText().setText(i.get("_mapTitle")),o}}}class bl{constructor(e){this.layer=function(){const e=new vc;return new Wc({title:"Overlay",zIndex:300,source:e,style:gl()})}(),this.setMap(e)}get dataSource(){return this.layer.dataSource}setMap(e){void 0===e?void 0!==this.map&&this.map.ol.removeLayer(this.layer.ol):e.ol.addLayer(this.layer.ol),this.map=e}setFeatures(e,t=el.Default,o){if(o)for(const i of this.dataSource.ol.getFeatures())i.get("_sourceId")===o&&this.removeOlFeature(i);else this.clear();this.addFeatures(e,t)}addFeature(e,t=el.Default){this.addFeatures([e],t)}addFeatures(e,t=el.Default){const o=[];e.forEach(e=>{const t=tl(e,this.map.projection);null!==t.getGeometry()&&o.push(t)}),this.addOlFeatures(o,t)}addOlFeature(e,t=el.Default){this.addOlFeatures([e],t)}addOlFeatures(e,t=el.Default){this.dataSource.ol.addFeatures(e),rl(this.map,e,t)}removeFeature(e){this.removeFeatures([e])}removeFeatures(e){e.forEach(e=>{e.meta&&this.dataSource.ol.getFeatureById(e.meta.id)&&this.removeOlFeature(this.dataSource.ol.getFeatureById(e.meta.id))})}removeOlFeature(e){this.dataSource.ol.removeFeature(e)}clear(){this.dataSource.ol.clear()}}class fl extends B{constructor(){super(),this.loaded=0,this.loading=0,this.layers=[],this.subscriptions=[]}watch(){}unwatch(){this.layers.forEach(e=>this.unwatchLayer(e),this)}watchLayer(e){if(void 0===e.status$)return;this.layers.push(e);const t=e.status$.pipe(Object(D.a)()).subscribe(e=>{e===N.Working?this.loading+=1:e===N.Done&&(this.loaded+=1),this.loaded>=this.loading?(this.loading=this.loaded=0,this.status=N.Done):this.loading>0&&(this.status=N.Working)});this.subscriptions.push(t)}unwatchLayer(e){e.status$.next(N.Done);const t=this.layers.indexOf(e);t>=0&&(-1!==[N.Working,N.Waiting].indexOf(e.watcher.status)&&(this.loaded+=1),this.subscriptions[t].unsubscribe(),this.subscriptions.splice(t,1),this.layers.splice(t,1),e.watcher.unwatch())}}var yl=function(e){return e[e.Move=0]="Move",e[e.Zoom=1]="Zoom",e}({});class Ol extends class{constructor(){this.observerKeys=[]}getOlMap(){return this.olMap}setOlMap(e){if(void 0!==e&&void 0!==this.getOlMap())throw new Error("This controller is already bound to a map.");if(void 0===e)return this.teardownObservers(),void(this.olMap=e);this.olMap=e}teardownObservers(){this.observerKeys.forEach(e=>Object(Ga.b)(e)),this.observerKeys=[]}}{constructor(e){super(),this.options=e,this.resolution$=new C.a(void 0),this.state$=new C.a(void 0),this.padding=[0,0,0,0],this.maxZoomOnExtent=19,this.extent$=new k.a,this.states=[],this.stateIndex=0}get stateHistory(){return!!this.options&&!0===this.options.stateHistory}get olView(){return this.olMap.getView()}setOlMap(e){super.setOlMap(e),this.setupObservers()}setupObservers(){!0===this.stateHistory&&this.observerKeys.push(this.olMap.on("moveend",e=>this.onMoveEnd(e))),this.extent$$=this.extent$.pipe(Object(S.a)(25)).subscribe(e=>{this.setExtent(e.extent,e.action)})}teardownObservers(){super.teardownObservers(),void 0!==this.extent$$&&(this.extent$$.unsubscribe(),this.extent$$=void 0)}getOlProjection(){return this.olView.getProjection()}getCenter(e){let t=this.olView.getCenter();return e&&t&&(t=Object(sa.s)(t,this.getOlProjection(),e)),t}getExtent(e){let t=this.olView.calculateExtent(this.olMap.getSize());return e&&t&&(t=Object(sa.t)(t,this.getOlProjection(),e)),t}getScale(e=96){return function(e,t="m",o=96){return e*sa.a[t]*39.3701*o}(this.getResolution(),this.getOlProjection().getUnits(),e)}getResolution(){return this.olView.getResolution()}getZoom(){return Math.round(this.olView.getZoom())}zoomIn(){this.zoomTo(this.olView.getZoom()+1)}zoomOut(){this.zoomTo(this.olView.getZoom()-1)}zoomTo(e){this.olView.cancelAnimations(),this.olView.animate({zoom:e,duration:250,easing:Va.b})}moveToExtent(e){this.extent$.next({extent:e,action:yl.Move})}zoomToExtent(e){this.extent$.next({extent:e,action:yl.Zoom})}getRotation(){return this.olView.getRotation()}resetRotation(){this.olView.animate({rotation:0})}hasPreviousState(){return this.states.length>1&&this.stateIndex>0}hasNextState(){return this.states.length>1&&this.stateIndex<this.states.length-1}previousState(){this.hasPreviousState()&&this.setStateIndex(this.stateIndex-1)}nextState(){this.hasNextState()&&this.setStateIndex(this.stateIndex+1)}clearStateHistory(){this.states=[],this.stateIndex=0}setInitialState(){this.states.length>0&&this.setStateIndex(0)}setExtent(e,t,o=!0){const i=this.olView;i.cancelAnimations();const r=o?500:0,s=i.getZoom(),a=i.getCenter(),n=[e[0]+(e[2]-e[0])/2,e[1]+(e[3]-e[1])/2],c=Math.sqrt(Math.pow(a[0]-n[0],2)+Math.pow(a[1]-n[1],2)),l=i.calculateExtent(),u=Math.sqrt(Math.pow(l[2]-l[0],2)+Math.pow(l[3]-l[1],2)),d=c/((Math.sqrt(Math.pow(e[2]-e[0],2)+Math.pow(e[3]-e[1],2))+u)/2),h=t===yl.Move||s>this.maxZoomOnExtent?s:this.maxZoomOnExtent;i.fit(e,{size:this.olMap.getSize(),maxZoom:h,padding:this.padding,duration:d>4?0:r})}setStateIndex(e){this.stateIndex=e,this.setState(this.states[e])}setState(e){this.olView.animate({resolution:e.resolution,center:e.center,duration:0})}onMoveEnd(e){const t=this.getResolution();this.resolution$.value!==t&&this.resolution$.next(t);const o={resolution:t,center:this.getCenter(),zoom:this.getZoom()};if(!0===this.stateHistory){const e=this.stateIndex;r=0===this.states.length?void 0:this.states[e],(void 0===(i=o)||void 0===r||i.zoom!==r.zoom||Math.trunc(i.center[0]/1e-4)!==Math.trunc(r.center[0]/1e-4)||Math.trunc(i.center[1]/1e-4)!==Math.trunc(r.center[1]/1e-4))&&(this.states=this.states.slice(0,e+1).concat([o]),this.stateIndex=this.states.length-1)}var i,r;this.state$.next(o)}}class vl{constructor(e){this.offlineButtonToggle$=new C.a(!1),this.layers$=new C.a([]),this.positionFollower=!0,this.geolocation$=new C.a(void 0),this.defaultOptions={controls:{attribution:!1}},this.options=Object.assign({},this.defaultOptions,e),this.layerWatcher=new fl,this.status$=this.layerWatcher.status$,Object(za.a)(_a.a),this.init()}get layers(){return this.layers$.value}get projection(){return this.viewController.getOlProjection().getCode()}init(){const e=[];this.options.controls&&(this.options.controls.attribution&&e.push(new Ea.a(!0===this.options.controls.attribution?{}:this.options.controls.attribution)),this.options.controls.scaleLine&&e.push(new Qa.a(!0===this.options.controls.scaleLine?{}:this.options.controls.scaleLine)));let t={};!1===this.options.interactions&&(t={altShiftDragRotate:!1,doubleClickZoom:!1,keyboard:!1,mouseWheelZoom:!1,shiftDragZoom:!1,dragPan:!1,pinchRotate:!1,pinchZoom:!1}),this.ol=new Wa.a({interactions:Object(Ja.c)(t),controls:e}),this.setView(this.options.view||{}),this.viewController=new Ol({stateHistory:!0}),this.viewController.setOlMap(this.ol),this.overlay=new bl(this),this.queryResultsOverlay=new bl(this),this.searchResultsOverlay=new bl(this),this.buffer=new bl(this)}setTarget(e){this.ol.setTarget(e),void 0!==e?this.layerWatcher.subscribe(()=>{},null):this.layerWatcher.unsubscribe()}updateView(e){const t=this.ol.getView(),o=Object.assign({zoom:t.getZoom()},t.getProperties());this.setView(Object.assign(o,e)),e.maxZoomOnExtent&&(this.viewController.maxZoomOnExtent=e.maxZoomOnExtent)}setView(e){void 0!==this.viewController&&this.viewController.clearStateHistory(),e=Object.assign({constrainResolution:!0},e);const t=new Ka.a(e);if(this.ol.setView(t),this.unsubscribeGeolocate(),e){if(e.center){const o=t.getProjection().getCode(),i=Object(sa.h)(e.center,o);t.setCenter(i)}e.geolocate&&this.geolocate(!0),e.alwaysTracking&&(this.alwaysTracking=!0)}}getCenter(e){return this.viewController.getCenter(e)}getExtent(e){return this.viewController.getExtent(e)}getZoom(){return this.viewController.getZoom()}changeBaseLayer(e){if(e){for(const e of this.getBaseLayers())e.visible=!1;e.visible=!0,this.viewController.olView.setMinZoom(e.dataSource.options.minZoom||(this.options.view||{}).minZoom),this.viewController.olView.setMaxZoom(e.dataSource.options.maxZoom||(this.options.view||{}).maxZoom)}}getBaseLayers(){return this.layers.filter(e=>!0===e.baseLayer)}getLayerById(e){return this.layers.find(t=>t.id&&t.id===e)}getLayerByAlias(e){return this.layers.find(t=>t.alias&&t.alias===e)}getLayerByOlUId(e){return this.layers.find(t=>t.ol.ol_uid&&t.ol.ol_uid===e)}addLayer(e,t=!0){this.addLayers([e])}addLayers(e,t=!0){let o=0,i=0;const r=e.map(e=>{const t=e.zIndex?0:e.baseLayer?i++:o++;return this.doAddLayer(e,t)}).filter(e=>void 0!==e);this.setLayers([].concat(this.layers,r))}removeLayer(e){this.removeLayers([e])}removeLayers(e){const t=this.layers$.value.slice(0),o=[];e.forEach(e=>{const i=t.indexOf(e);i>=0&&(o.push(e),t.splice(i,1),this.handleLinkedLayersDeletion(e,o),o.map(e=>{o.push(e);const i=t.indexOf(e);i>=0&&t.splice(i,1)}))}),o.forEach(e=>this.doRemoveLayer(e)),this.setLayers(t)}handleLinkedLayersDeletion(e,t){const o=e.options.linkedLayers;if(!o)return;const i=o.linkId,r=o.links;r?r.map(e=>{e.syncedDelete&&e.linkedIds.map(e=>{const o=this.layers.find(t=>{var o;return(null===(o=t.options.linkedLayers)||void 0===o?void 0:o.linkId)===e});o&&t.push(o)})}):this.layers.map(e=>{var o;(null===(o=e.options.linkedLayers)||void 0===o?void 0:o.links)&&e.options.linkedLayers.links.map(o=>{o.syncedDelete&&!1!==o.bidirectionnal&&-1!==o.linkedIds.indexOf(i)&&(t.push(e),this.handleLinkedLayersDeletion(e,t))})})}removeAllLayers(){this.layers.forEach(e=>this.doRemoveLayer(e)),this.layers$.next([])}raiseLayer(e){const t=this.getLayerIndex(e);t>1&&this.moveLayer(e,t,t-1)}raiseLayers(e){for(const t of e)this.raiseLayer(t)}lowerLayer(e){const t=this.getLayerIndex(e);t<this.layers.length-1&&this.moveLayer(e,t,t+1)}lowerLayers(e){const t=e.reverse();for(const o of t)this.lowerLayer(o)}moveLayer(e,t,o){const i=this.layers[o],r=e.zIndex;i.baseLayer||e.baseLayer||(e.zIndex=i.zIndex,i.zIndex=r,this.layers[o]=e,this.layers[t]=i,this.layers$.next(this.layers.slice(0)))}doAddLayer(e,t){e.baseLayer&&e.visible&&this.changeBaseLayer(e);const o=this.getLayerById(e.id);if(void 0===o){if(!e.baseLayer&&e.zIndex&&(e.zIndex+=10),void 0===e.zIndex||0===e.zIndex){const o=Math.max(e.baseLayer?0:10,...this.layers.filter(t=>t.baseLayer===e.baseLayer&&t.zIndex<200).map(e=>e.zIndex));e.zIndex=o+1+t}return e.baseLayer&&e.zIndex>9&&(e.zIndex=10),e.setMap(this),this.layerWatcher.watchLayer(e),this.ol.addLayer(e.ol),e}o.visible=!0}doRemoveLayer(e){this.layerWatcher.unwatchLayer(e),this.ol.removeLayer(e.ol),e.setMap(void 0)}setLayers(e){this.layers$.next(this.sortLayersByZIndex(e).slice(0))}sortLayersByZIndex(e){return e.sort((e,t)=>t.zIndex-e.zIndex)}getLayerIndex(e){return this.layers.findIndex(t=>t===e)}geolocate(e=!1){let t=!0;this.geolocation$$&&(e=this.geolocation.getTracking(),this.unsubscribeGeolocate()),this.startGeolocation(),this.geolocation$$=this.geolocation$.subscribe(o=>{if(o){if(o.getAccuracy()<1e4){const e=o.getAccuracyGeometry(),i=e.getExtent();if(this.geolocationFeature&&this.overlay.dataSource.ol.getFeatureById(this.geolocationFeature.getId())&&this.overlay.dataSource.ol.removeFeature(this.geolocationFeature),this.bufferFeature&&this.buffer.dataSource.ol.removeFeature(this.bufferFeature),this.geolocationFeature=new Da.a({geometry:e}),this.geolocationFeature.setId("geolocationFeature"),this.alwaysTracking?this.overlay.addOlFeature(this.geolocationFeature,this.positionFollower?el.Move:el.None):this.overlay.addOlFeature(this.geolocationFeature),this.ol.getView().options_.buffer){const e=this.ol.getView().options_.buffer.bufferRadius,t=o.getPosition();this.bufferGeom=new Xa.a(t,e);const i=this.ol.getView().options_.buffer.bufferStroke,r=this.ol.getView().options_.buffer.bufferFill;let s;s=this.ol.getView().options_.buffer.showBufferRadius?e.toString()+"m":"",this.bufferFeature=new Da.a(this.bufferGeom),this.bufferFeature.setId("bufferFeature"),this.bufferFeature.set("bufferStroke",i),this.bufferFeature.set("bufferFill",r),this.bufferFeature.set("bufferText",s),this.buffer.addOlFeature(this.bufferFeature,el.None)}t&&(this.viewController.zoomToExtent(i),this.positionFollower=!this.positionFollower)}else if(t){const e=this.ol.getView(),t=o.getPosition();e.setCenter(t),e.setZoom(14)}!0!==e&&!0!==this.alwaysTracking&&this.unsubscribeGeolocate(),t=!1}})}unsubscribeGeolocate(){this.stopGeolocation(),this.geolocation$$&&(this.geolocation$$.unsubscribe(),this.geolocation$$=void 0)}startGeolocation(){this.geolocation?this.geolocation.setTracking(!0):(this.geolocation=new Za.a({trackingOptions:{enableHighAccuracy:!0},projection:this.projection,tracking:!0}),this.geolocation.on("change",e=>{this.geolocation$.next(this.geolocation)}))}stopGeolocation(){this.geolocation&&this.geolocation.setTracking(!1)}onOfflineToggle(e){this.offlineButtonToggle$.next(e)}}let jl=(()=>{class e{constructor(){}getMap(){return this.map}setMap(e){this.map=e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const wl=["*"];let Sl=(()=>{class e{constructor(e){this.activityService=e,this.id="igo-map-target-"+(new Date).getTime()}get view(){return this._view}set view(e){this._view=e,void 0!==this.map&&this.map.updateView(e)}ngOnInit(){this.status$$=this.map.status$.subscribe(e=>this.handleStatusChange(e))}ngAfterViewInit(){this.map.setTarget(this.id)}ngOnDestroy(){this.map.setTarget(void 0),this.activityService.unregister(this.activityId),this.status$$.unsubscribe()}handleStatusChange(e){e===N.Working&&void 0===this.activityId?this.activityId=this.activityService.register():e===N.Done&&void 0!==this.activityId&&(this.activityService.unregister(this.activityId),this.activityId=void 0)}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(U))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-map-browser"]],inputs:{map:"map",view:"view"},ngContentSelectors:wl,decls:2,vars:1,consts:[[1,"igo-map-browser-target",3,"id"]],template:function(e,t){1&e&&(Object(i.Cc)(),Object(i.hc)(0,"div",0),Object(i.Bc)(1)),2&e&&Object(i.Dc)("id",t.id)},styles:["[_nghost-%COMP%]{display:block;position:relative}.igo-map-browser-target[_ngcontent-%COMP%], [_nghost-%COMP%]{height:100%;width:100%}[_nghost-%COMP%]     igo-zoom-button{bottom:5px;position:absolute;right:5px}@media only screen and (orientation:landscape) and (max-width:959px),only screen and (orientation:portrait) and (max-width:599px){[_nghost-%COMP%]     igo-zoom-button{display:none}}[_nghost-%COMP%]     igo-offline-button{bottom:15px;position:absolute;right:5px}@media only screen and (orientation:landscape) and (max-width:959px),only screen and (orientation:portrait) and (max-width:599px){[_nghost-%COMP%]     igo-offline-button{bottom:5px}}[_nghost-%COMP%]     igo-geolocate-button{bottom:5px;position:absolute;right:5px}@media only screen and (orientation:landscape) and (max-width:959px),only screen and (orientation:portrait) and (max-width:599px){[_nghost-%COMP%]     igo-geolocate-button{bottom:5px}}[_nghost-%COMP%]     igo-rotation-button{position:absolute;right:5px;top:50px}@media only screen and (orientation:landscape) and (max-width:959px),only screen and (orientation:portrait) and (max-width:599px){[_nghost-%COMP%]     igo-rotation-button{top:50px}}[_nghost-%COMP%]     igo-user-button{bottom:5px;position:absolute;right:55px}@media only screen and (orientation:landscape) and (max-width:959px),only screen and (orientation:portrait) and (max-width:599px){[_nghost-%COMP%]     igo-user-button{right:95px}}[_nghost-%COMP%]     igo-baselayers-switcher{bottom:5px;left:5px;position:absolute}[_nghost-%COMP%]     .ol-attribution{background-color:hsla(0,0%,100%,0);bottom:5px;left:5px;margin-right:90px;padding:0;text-align:left;width:calc(100% - 100px)}[_nghost-%COMP%]     .ol-attribution.ol-logo-only{height:inherit}[_nghost-%COMP%]     .ol-attribution.ol-collapsed{background:none}[_nghost-%COMP%]     .ol-attribution.ol-collapsed button{transform:none}[_nghost-%COMP%]     .ol-attribution button{background-color:#fff;cursor:pointer;outline:none;transform:rotate(180deg)}[_nghost-%COMP%]     .ol-scale-line-inner{border-color:#000;box-shadow:0 1px 0 1px hsla(0,0%,100%,.6);color:#000;text-shadow:#fff -1px -1px 3px,#fff 1px -1px 3px,#fff -1px 1px 3px,#fff 1px 1px 4px}[_nghost-%COMP%]     .ol-scale-line{background-color:hsla(0,0%,100%,0);bottom:4px;left:50%;transform:translate(-50%)}[_nghost-%COMP%]     canvas{display:block}"]}),e})(),xl=(()=>{class e{constructor(e,t){this.component=e,this.mediaService=t,this.pointerPositionDelay=1e3,this.pointerPositionCoord=new i.u}get map(){return this.component.map}get mapProjection(){return this.component.map.projection}ngOnInit(){this.listenToMapPointerMove(),this.listenToMapClick()}ngOnDestroy(){this.unlistenToMapPointerMove(),this.unlistenToMapClick()}listenToMapPointerMove(){this.pointerMoveListener=this.map.ol.on("pointermove",e=>this.onPointerEvent(e,this.pointerPositionDelay))}listenToMapClick(){this.mapClickListener=this.map.ol.on("singleclick",e=>this.onPointerEvent(e,0))}unlistenToMapPointerMove(){this.map.ol.un(this.pointerMoveListener.type,this.pointerMoveListener.listener),this.pointerMoveListener=void 0}unlistenToMapClick(){this.map.ol.un(this.mapClickListener.type,this.mapClickListener.listener),this.mapClickListener=void 0}onPointerEvent(e,t){if(e.dragging||this.mediaService.isTouchScreen())return;void 0!==this.lastTimeoutRequest&&clearTimeout(this.lastTimeoutRequest);const o=Object(sa.s)(e.coordinate,this.mapProjection,"EPSG:4326");this.lastTimeoutRequest=setTimeout(()=>{this.pointerPositionCoord.emit(o)},t)}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(Sl,2),Object(i.gc)(be))},e.\u0275dir=Object(i.bc)({type:e,selectors:[["","igoPointerPosition",""]],inputs:{pointerPositionDelay:"pointerPositionDelay"},outputs:{pointerPositionCoord:"pointerPositionCoord"}}),e})(),Cl=(()=>{class e{constructor(e,t,o){this.component=e,this.mediaService=t,this.styleService=o,this.pointerHoverFeatureStore=new at([]),this.hoverFeatureId="hoverFeatureId",this.igoHoverFeatureDelay=1e3,this.igoHoverFeatureEnabled=!1}mouseout(){clearTimeout(this.lastTimeoutRequest),this.clearLayer()}get map(){return this.component.map}get mapProjection(){return this.component.map.projection}ngOnInit(){this.listenToMapPointerMove(),this.subscribeToPointerStore(),this.listenToMapClick(),this.map.status$.pipe(Object(Me.a)(1)).subscribe(()=>{this.store=new al([],{map:this.map}),this.initStore()}),this.layers$$=this.map.layers$.subscribe(e=>{this.store&&!e.find(e=>"hoverFeatureId"===e.id)&&this.initStore()})}initStore(e){sl(this.store,new Wc({id:"hoverFeatureId",title:"hoverFeature",zIndex:900,source:new vc,showInLayerList:!1,exportable:!1,browsable:!1,style:Tl}))}ngOnDestroy(){this.unlistenToMapPointerMove(),this.unsubscribeToPointerStore(),this.unlistenToMapSingleClick(),this.layers$$.unsubscribe()}subscribeToPointerStore(){this.store$$=this.pointerHoverFeatureStore.entities$.subscribe(e=>{this.entitiesToPointerOverlay(e)})}entitiesToPointerOverlay(e){this.addFeatureOverlay(e)}listenToMapPointerMove(){this.pointerMoveListener=this.map.ol.on("pointermove",e=>this.onMapEvent(e))}listenToMapClick(){this.singleClickMapListener=this.map.ol.on("singleclick",e=>this.onMapSingleClickEvent(e))}unsubscribeToPointerStore(){this.store$$.unsubscribe()}unlistenToMapPointerMove(){this.map.ol.un(this.pointerMoveListener.type,this.pointerMoveListener.listener),this.pointerMoveListener=void 0}unlistenToMapSingleClick(){this.map.ol.un(this.singleClickMapListener.type,this.singleClickMapListener.listener),this.singleClickMapListener=void 0}onMapSingleClickEvent(e){this.clearLayer()}onMapEvent(e){if(e.dragging||!this.igoHoverFeatureEnabled||this.mediaService.isTouchScreen())return void this.clearLayer();void 0!==this.lastTimeoutRequest&&clearTimeout(this.lastTimeoutRequest);const t=this.map.ol.getPixelFromCoordinate(e.coordinate);this.lastTimeoutRequest=setTimeout(()=>{this.map.ol.forEachFeatureAtPixel(t,(function(e,t){if(void 0===e.get("hoverSummary")){const o=this.map.getLayerByOlUId(t.ol_uid);this.setLayerStyleFromOptions(o,e),this.pointerHoverFeatureStore.load([{layer:o,feature:e}])}return!0}).bind(this))},this.igoHoverFeatureDelay)}addFeatureOverlay(e){if(e.length>0){e=e[0],this.clearLayer();let t=this.getGeometry(e.feature);e.layer.ol instanceof ln.a&&(t=[t],this.getSameFeatureNeighbour(e.feature,e.layer).forEach(e=>{t.push(e.getGeometry())}));const o=new Da.a({geometry:t instanceof Array?new cn.a(t):t,meta:{id:this.hoverFeatureId},hoverSummary:this.getHoverSummary(e.feature.getProperties())});this.store.setLayerOlFeatures([o],el.None)}}setLayerStyleFromOptions(e,t){var o,i;(null===(i=null===(o=e.options)||void 0===o?void 0:o.styleByAttribute)||void 0===i?void 0:i.hoverStyle)?this.store.layer.ol.setStyle(this.styleService.createStyleByAttribute(t,e.options.styleByAttribute.hoverStyle)):this.store.layer.ol.setStyle(Tl)}getHoverSummary(e){let t="";for(const[o,i]of Object.entries(e))t+=`${o}: ${i}\n`;return t}getGeometry(e){let t;if(e.getOrientedFlatCoordinates){const o=e.getOrientedFlatCoordinates(),i=[];switch(o.forEach((e,t)=>{t%2==0&&i.push([parseFloat(o[t]),parseFloat(o[t+1])])}),e.getType()){case"Point":t=new cn.e([i]);break;case"Polygon":t=new cn.f([i]);break;case"LineString":t=new cn.b([i])}}else t=e.getGeometry();return t}getSameFeatureNeighbour(e,t,o=[]){0===o.length&&o.push(new Da.a({geometry:this.getGeometry(e),meta:{id:this.hoverFeatureId}}));const i=[];return t.ol.getSource().getFeaturesInExtent(e.getGeometry().getExtent()).forEach(t=>{const r=o.find(e=>e===t);t.getId()!==e.getId()||r||(i.push(t),o.push(t))}),o.map(e=>new Da.a({geometry:this.getGeometry(e),meta:{id:this.hoverFeatureId}}))}clearLayer(){this.store&&this.store.clearLayer()}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(Sl,2),Object(i.gc)(be),Object(i.gc)(Qc))},e.\u0275dir=Object(i.bc)({type:e,selectors:[["","igoHoverFeature",""]],hostBindings:function(e,t){1&e&&Object(i.tc)("mouseout",(function(){return t.mouseout()}))},inputs:{igoHoverFeatureDelay:"igoHoverFeatureDelay",igoHoverFeatureEnabled:"igoHoverFeatureEnabled"}}),e})();function Tl(e,t){const o=[new Ra.Style({text:new Ra.Text({text:e.get("hoverSummary"),textAlign:"left",textBaseline:"bottom",font:"12px Calibri,sans-serif",fill:new Ra.Fill({color:"#000"}),backgroundFill:new Ra.Fill({color:"rgba(255, 255, 255, 0.5)"}),backgroundStroke:new Ra.Stroke({color:"rgba(200, 200, 200, 0.75)",width:2}),stroke:new Ra.Stroke({color:"#fff",width:3}),overflow:!0,offsetX:10,offsetY:-10,padding:[2.5,2.5,2.5,2.5]})})];switch(e.getGeometry().getType()){case"Point":o.push(new Ra.Style({image:new nn.a({radius:10,stroke:new Ra.Stroke({color:"blue",width:3})})}));break;default:o.push(new Ra.Style({stroke:new Ra.Stroke({color:"white",width:5})})),o.push(new Ra.Style({stroke:new Ra.Stroke({color:"blue",width:3})}))}return o}const Ll=function(e){return{zoom:e}};let Il=(()=>{class e{constructor(){}get zoom(){return this.map.viewController.getZoom()}get minZoom(){return this.map.viewController.olView.getMinZoom()||1}get maxZoom(){return this.map.viewController.olView.getMaxZoom()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-zoom-button"]],inputs:{map:"map",color:"color"},decls:7,vars:16,consts:[[1,"igo-zoom-button-container"],["mat-icon-button","","matTooltipPosition","left",3,"matTooltip","color","disabled","click"],["svgIcon","plus"],["svgIcon","minus"]],template:function(e,t){1&e&&(Object(i.mc)(0,"div",0),Object(i.mc)(1,"button",1),Object(i.tc)("click",(function(){return t.map.viewController.zoomIn()})),Object(i.yc)(2,"translate"),Object(i.hc)(3,"mat-icon",2),Object(i.lc)(),Object(i.mc)(4,"button",1),Object(i.tc)("click",(function(){return t.map.viewController.zoomOut()})),Object(i.yc)(5,"translate"),Object(i.hc)(6,"mat-icon",3),Object(i.lc)(),Object(i.lc)()),2&e&&(Object(i.Tb)(1),Object(i.Dc)("matTooltip",Object(i.Ac)(2,6,"igo.geo.mapButtons.zoomIn",Object(i.Gc)(12,Ll,t.zoom+1)))("color",t.color)("disabled",t.zoom>=t.maxZoom),Object(i.Tb)(3),Object(i.Dc)("matTooltip",Object(i.Ac)(5,9,"igo.geo.mapButtons.zoomOut",Object(i.Gc)(14,Ll,t.zoom-1)))("color",t.color)("disabled",t.zoom<=t.minZoom))},directives:[n.b,h.a,c.a],pipes:[q.e],styles:[".igo-zoom-button-container[_ngcontent-%COMP%]{width:40px}.igo-zoom-button-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#fff}.igo-zoom-button-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#efefef}.igo-zoom-button-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child{margin-bottom:2px}[_nghost-%COMP%]     button .mat-button-ripple-round, button[_ngcontent-%COMP%]{border-radius:0}"]}),e})(),Fl=(()=>{class e{constructor(){}get map(){return this._map}set map(e){this._map=e}get color(){return this._color}set color(e){this._color=e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-geolocate-button"]],inputs:{map:"map",color:"color"},decls:4,vars:4,consts:[[1,"igo-geolocate-button-container"],["mat-icon-button","","matTooltipPosition","left",3,"matTooltip","color","click"],["svgIcon","crosshairs-gps"]],template:function(e,t){1&e&&(Object(i.mc)(0,"div",0),Object(i.mc)(1,"button",1),Object(i.tc)("click",(function(){return t.map.geolocate()})),Object(i.yc)(2,"translate"),Object(i.hc)(3,"mat-icon",2),Object(i.lc)(),Object(i.lc)()),2&e&&(Object(i.Tb)(1),Object(i.Dc)("matTooltip",Object(i.zc)(2,2,"igo.geo.mapButtons.geolocate"))("color",t.color))},directives:[n.b,h.a,c.a],pipes:[q.e],styles:[".igo-geolocate-button-container[_ngcontent-%COMP%]{background-color:#fff;width:40px}.igo-geolocate-button-container[_ngcontent-%COMP%]:hover{background-color:#efefef}[_nghost-%COMP%]     button .mat-button-ripple-round, button[_ngcontent-%COMP%]{border-radius:0}"]}),e})();function Ml(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"div",1),Object(i.yc)(1,"translate"),Object(i.yc)(2,"translate"),Object(i.mc)(3,"button",2),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.xc)().map.viewController.resetRotation()})),Object(i.hc)(4,"mat-icon",3),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Dc)("matTooltip",e.rotated?Object(i.zc)(1,4,"igo.geo.mapButtons.resetRotation"):Object(i.zc)(2,6,"igo.geo.mapButtons.tipRotation")),Object(i.Tb)(3),Object(i.Dc)("color",e.color)("disabled",!e.rotated),Object(i.Tb)(1),Object(i.Dc)("ngStyle",e.rotationStyle(e.map.viewController.getRotation()))}}function kl(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"div",1),Object(i.yc)(1,"translate"),Object(i.yc)(2,"translate"),Object(i.mc)(3,"button",2),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.xc)().map.viewController.resetRotation()})),Object(i.hc)(4,"mat-icon",3),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Dc)("matTooltip",e.rotated?Object(i.zc)(1,4,"igo.geo.mapButtons.resetRotation"):Object(i.zc)(2,6,"igo.geo.mapButtons.tipRotation")),Object(i.Tb)(3),Object(i.Dc)("color",e.color)("disabled",!e.rotated),Object(i.Tb)(1),Object(i.Dc)("ngStyle",e.rotationStyle(e.map.viewController.getRotation()))}}let Dl=(()=>{class e{constructor(){}get map(){return this._map}set map(e){this._map=e}get showIfNoRotation(){return this._showIfNoRotation}set showIfNoRotation(e){this._showIfNoRotation=e}get color(){return this._color}set color(e){this._color=e}get rotated(){return 0!==this.map.viewController.getRotation()}rotationStyle(e){return{transform:"rotate("+e+"rad)"}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-rotation-button"]],inputs:{map:"map",showIfNoRotation:"showIfNoRotation",color:"color"},decls:2,vars:2,consts:[["class","igo-rotation-button-container","matTooltipPosition","left",3,"matTooltip",4,"ngIf"],["matTooltipPosition","left",1,"igo-rotation-button-container",3,"matTooltip"],["mat-icon-button","","matTooltipPosition","left",3,"color","disabled","click"],["svgIcon","navigation",3,"ngStyle"]],template:function(e,t){1&e&&(Object(i.Yc)(0,Ml,5,8,"div",0),Object(i.Yc)(1,kl,5,8,"div",0)),2&e&&(Object(i.Dc)("ngIf",t.rotated&&!t.showIfNoRotation),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.showIfNoRotation))},directives:[m.t,h.a,n.b,c.a,m.w],pipes:[q.e],styles:[".igo-rotation-button-container[_ngcontent-%COMP%]{background-color:#fff;width:40px}.igo-rotation-button-container[_ngcontent-%COMP%]:hover{background-color:#efefef}[_nghost-%COMP%]     button .mat-button-ripple-round, button[_ngcontent-%COMP%]{border-radius:0}@media only screen and (orientation:landscape) and (max-width:959px),only screen and (orientation:portrait) and (max-width:599px){[_nghost-%COMP%]     button .mat-button-ripple-round:disabled, button[_ngcontent-%COMP%]:disabled{display:none}}"]}),e})();var Pl=function(e){return e.Layer="layer",e.Group="group",e}({}),Al=function(e){return e[e.wms=0]="wms",e[e.wmts=1]="wmts",e[e.baselayers=2]="baselayers",e[e.arcgisrest=3]="arcgisrest",e[e.tilearcgisrest=4]="tilearcgisrest",e[e.imagearcgisrest=5]="imagearcgisrest",e[e.composite=6]="composite",e}({});class $l{constructor(e,t){Object.assign(this,e),this.catalogService=t}}class El extends $l{constructor(e,t){super(e,t),this.type=Al[Al[Al.wms]]}collectCatalogItems(){return this.catalogService.loadCatalogWMSLayerItems(this)}}class Rl extends $l{constructor(e,t){super(e,t),this.type=Al[Al[Al.wmts]]}collectCatalogItems(){return this.catalogService.loadCatalogWMTSLayerItems(this)}}class _l extends $l{constructor(e,t){super(e,t),this.type=Al[Al[Al.baselayers]]}collectCatalogItems(){return this.catalogService.loadCatalogBaseLayerItems(this)}}class zl extends $l{constructor(e,t){super(e,t),this.type=Al[Al[Al.arcgisrest]]}collectCatalogItems(){return this.catalogService.loadCatalogArcGISRestItems(this)}}class Nl extends $l{constructor(e,t,o){super(e,t),this.type=Al[Al[o]]}collectCatalogItems(){return this.catalogService.loadCatalogArcGISRestItems(this)}}class Bl extends $l{constructor(e,t){super(e,t),this.type=Al[Al[Al.composite]],this.url=null}collectCatalogItems(){return this.catalogService.loadCatalogCompositeLayerItems(this)}}class ql{static createInstanceCatalog(e,t){let o;return o=e.hasOwnProperty("composite")?new Bl(e,t):e.type===Al[Al.baselayers]?new _l(e,t):e.type===Al[Al.arcgisrest]?new zl(e,t):e.type===Al[Al.tilearcgisrest]?new Nl(e,t,Al.tilearcgisrest):e.type===Al[Al.imagearcgisrest]?new Nl(e,t,Al.imagearcgisrest):e.type===Al[Al.wmts]?new Rl(e,t):new El(e,t),o}}let Gl=(()=>{class e{constructor(e){this.http=e,this.queryEnabled=!0}query(e,t){return e.filter(e=>e.visible&&e.isInResolutionsRange).map(e=>this.queryLayer(e,t))}queryLayer(e,t){const o=this.getQueryUrl(e.dataSource,t,!1,e.map.viewController.getExtent());if(!o)return Object(L.a)([]);if(e.dataSource.options.queryFormat===ic.HTMLGML2){const i=this.getQueryUrl(e.dataSource,t,!0);return this.http.get(i,{responseType:"text"}).pipe(Object(oa.a)(i=>{const r=this.mergeGML(i,o);return this.http.get(o,{responseType:"text"}).pipe(Object(j.a)(i=>this.extractData(i,e,t,o,r)))}))}return this.http.get(o,{responseType:"text"}).pipe(Object(j.a)(i=>this.extractData(i,e,t,o)))}mergeGML(e,t){let o=new pa.a,i=o.readFeatures(e);0===i.length&&(o=new ha.WMSGetFeatureInfo,i=o.readFeatures(e));const r=new cn.c([]);let s;const a=[];let n,c=new cn.d([]);const l=i.length,u=this.getQueryParams(t.toLowerCase()).bbox.split(","),d=Object(Ca.k)();let h;switch(Object(Ca.r)(d,u),i.map(e=>{const t=e.getGeometry().getCoordinates(),o=e.getGeometry().getType();switch(n||(n=o),o){case"Point":1===l?s=new cn.e(t,"XY"):a.push(t);break;case"LineString":r.appendLineString(new cn.b(t,"XY"));break;case"Polygon":c.appendPolygon(new cn.f(t,"XY"));break;case"MultiPolygon":c=new cn.d(t,"XY");break;default:return}}),h=0===a.length&&s?{type:s.getType(),coordinates:s.getCoordinates()}:{type:"Polygon",coordinates:[this.convexHull(a)]},n){case"LineString":return{type:r.getType(),coordinates:r.getCoordinates()};case"Point":return h;case"Polygon":case"MultiPolygon":return{type:c.getType(),coordinates:c.getCoordinates()};default:return}}cross(e,t,o){return(e[0]-o[0])*(t[1]-o[1])-(e[1]-o[1])*(t[0]-o[0])}convexHull(e){e.sort((e,t)=>e[0]===t[0]?e[1]-t[1]:e[0]-t[0]);const t=[];for(const i of e){for(;t.length>=2&&this.cross(t[t.length-2],t[t.length-1],i)<=0;)t.pop();t.push(i)}const o=[];for(let i=e.length-1;i>=0;i--){for(;o.length>=2&&this.cross(o[o.length-2],o[o.length-1],e[i])<=0;)o.pop();o.push(e[i])}return o.pop(),t.pop(),t.concat(o)}extractData(e,t,o,i,r){const s=t.dataSource,a=this.getAllowedFieldsAndAlias(t);let n=[];switch(s.options.queryFormat){case ic.GML3:n=this.extractGML3Data(e,t.zIndex,a);break;case ic.JSON:case ic.GEOJSON:case ic.GEOJSON2:n=this.extractGeoJSONData(e);break;case ic.ESRIJSON:n=this.extractEsriJSONData(e,t.zIndex,a);break;case ic.TEXT:n=this.extractTextData(e);break;case ic.HTML:n=this.extractHtmlData(e,s.queryHtmlTarget,i);break;case ic.HTMLGML2:n=this.extractHtmlData(e,s.queryHtmlTarget,i,r);break;case ic.GML2:default:n=this.extractGML2Data(e,t,a)}if(n.length>0&&null==n[0].geometry){const e=this.createGeometryFromUrlClick(i);for(const t of n)t.geometry=e}return n.map((e,i)=>{const r=e.properties[s.mapLabel];let a;if("wms"===t.options.sourceOptions.type){const e=t.options.sourceOptions;a=e?e.excludeAttribute:void 0}let c=this.getQueryTitle(e,t);!c&&n.length>1?c=`${t.title} (${i+1})`:c||(c=t.title);const l=Object.assign({},e.meta||{},{id:z(),title:c,mapTitle:r,sourceTitle:t.title,order:1e3-t.zIndex,excludeAttribute:a});return Object.assign(e,{meta:l,projection:"carto"===s.options.type?"EPSG:4326":o.projection})})}createGeometryFromUrlClick(e){const t=this.getQueryParams(e.toLowerCase()),o=t.bbox,i=parseInt(t.width,10),r=parseInt(t.height,10),s=parseInt(t.i||t.x,10),a=parseInt(t.j||t.y,10),n=o.split(",");let c=.05*(Math.abs(parseFloat(n[0]))-Math.abs(parseFloat(n[2])));Math.abs(parseFloat(n[0]))<180&&(c=.045);const l=parseFloat(n[0])+Math.abs(parseFloat(n[0])-parseFloat(n[2]))*s/i-c,u=parseFloat(n[1])+Math.abs(parseFloat(n[1])-parseFloat(n[3]))*a/r-c,d=l+2*c,h=u+2*c,p="POLYGON(("+l+" "+u+", "+l+" "+h+", "+d+" "+h+", "+d+" "+u+", "+l+" "+u+"))",m=(new ha.WKT).readFeature(p).getGeometry();return{type:m.getType(),coordinates:m.getCoordinates()}}extractGML2Data(e,t,o){let i=new pa.a,r=i.readFeatures(e);if(0===r.length){i=new ha.WMSGetFeatureInfo;try{r=i.readFeatures(e)}catch(s){console.warn("query.service: Multipolygons are badly managed in mapserver in GML2. Use another format.")}}return r.map(e=>this.featureToResult(e,t,o))}extractGML3Data(e,t,o){const i=new ma.a;let r=[];try{r=i.readFeatures(e)}catch(s){console.warn("query.service: GML3 is not well supported")}return r.map(e=>this.featureToResult(e,t,o))}extractGeoJSONData(e){let t=[];try{t=JSON.parse(e).features}catch(o){console.warn("query.service: Unable to parse geojson","\n",e)}return t}extractEsriJSONData(e,t,o){if(e)try{if(JSON.parse(e).error)return[]}catch(i){}return(new La.a).readFeatures(e).map(e=>this.featureToResult(e,t,o))}extractTextData(e){return[]}extractHtmlData(e,t,o,i){const r=this.getQueryParams(o.toLowerCase()),s=r.crs||r.srs||"EPSG:3857",a=this.createGeometryFromUrlClick(o);t!==sc.BLANK&&t!==sc.IFRAME&&(t=sc.IFRAME);const n=e.toLowerCase().indexOf("<body>"),c=e.toLowerCase().lastIndexOf("</body>")+7;return"<body></body>"===e.slice(n,c).replace(/(\r|\n|\s)/g,"")||""===e?[]:[{type:Xc,projection:s,properties:{target:t,body:e,url:o},geometry:i||a}]}getQueryParams(e){const t=e.split("?");if(!t[1])return;const o=t[1].split("&"),i={};return o.forEach(e=>{e=e.split("="),i[e[0]]=decodeURIComponent(e[1]||"")}),i}featureToResult(e,t,o){const i=e.getGeometry(),r=Object.assign({},e.getProperties());let s;return delete r.geometry,delete r.boundedBy,delete r.shape,delete r.SHAPE,delete r.the_geom,delete r.geom,i&&(s={type:i.getType(),coordinates:i.getCoordinates()}),{type:Xc,projection:void 0,properties:r,geometry:s,meta:{id:z(),order:1e3-t,alias:o}}}getQueryUrl(e,t,o=!1,i){let r;switch(e.constructor){case uc:const s=e,a={INFO_FORMAT:s.params.INFO_FORMAT||this.getMimeInfoFormat(e.options.queryFormat),QUERY_LAYERS:s.params.LAYERS,FEATURE_COUNT:s.params.FEATURE_COUNT||"5"};o&&(a.INFO_FORMAT=this.getMimeInfoFormat(ic.GML2)),r=s.ol.getFeatureInfoUrl(t.coordinates,t.resolution,t.projection,a);break;case Lc:const n=e;r=`${"https://"+n.options.account+".carto.com/api/v2/sql?"}format=GeoJSON${"&q="+n.options.config.layers[0].options.sql} WHERE ST_Intersects(the_geom_webmercator,ST_BUFFER(ST_SetSRID(ST_POINT(${t.coordinates[0]+","+t.coordinates[1]+"),3857),"+(n.options.queryPrecision?n.options.queryPrecision:"1000")+"))"}`;break;case Fc:case Mc:const c=e,l=Math.abs(i[0]-i[2]),u=Math.abs(i[1]-i[3]),d=.005*(l>u?l:u),h=c.options.queryPrecision?c.options.queryPrecision:d,p=Object(Ca.d)(Object(Ca.c)([t.coordinates]),h);r=`${c.options.url+"/"+c.options.layer+"/query/"}?${["f=json","geometry="+encodeURIComponent('{"xmin":'+p[0]+',"ymin":'+p[1]+',"xmax":'+p[2]+',"ymax":'+p[3]+',"spatialReference":{"wkid":102100}}'),"geometryType=esriGeometryEnvelope","inSR=102100","spatialRel=esriSpatialRelIntersects","outFields=*","returnGeometry=true","outSR=102100"].join("&")}`}return r}getMimeInfoFormat(e){let t="application/vnd.ogc.gml";const o=Object.keys(ic).find(t=>ic[t]===e);return o&&(t=rc[o]),t}getAllowedFieldsAndAlias(e){var t,o,i;let r;return(null===(i=null===(o=null===(t=e.options)||void 0===t?void 0:t.source)||void 0===o?void 0:o.options)||void 0===i?void 0:i.sourceFields)&&e.options.source.options.sourceFields.length>=1&&(r={},e.options.source.options.sourceFields.forEach(e=>{r[e.name]=e.alias?e.alias:e.name})),r}getQueryTitle(e,t){var o,i;let r;if(null===(i=null===(o=t.options)||void 0===o?void 0:o.source)||void 0===i?void 0:i.options){const o=t.options.source.options;o.queryTitle&&(r=this.getLabelMatch(e,o.queryTitle))}return r}getLabelMatch(e,t){let o=t;const i=Array.from(t.matchAll(/\$\{([^\{\}]+)\}/g));return i.forEach(t=>{o=o.replace(t[0],e.properties[t[1]])}),0===i.length&&o===t&&(o=e.properties[t]||t),o}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(y.b))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Vl(e){return!0===e.dataSource.options.queryable}function Ul(e){const t=e.get("_layer");return void 0!==t&&Vl(t)}let Hl=(()=>{class e{constructor(e,t){this.component=e,this.queryService=t,this.queries$$=[],this.queryFeatures=!1,this.queryFeaturesHitTolerance=0,this.waitForAllQueries=!0,this.query=new i.u}get map(){return this.component.map}ngAfterViewInit(){this.listenToMapClick(),this.addDragBoxInteraction()}ngOnDestroy(){this.cancelOngoingQueries(),this.unlistenToMapClick(),this.removeDragBoxInteraction()}listenToMapClick(){this.mapClickListener=this.map.ol.on("singleclick",e=>this.onMapEvent(e))}unlistenToMapClick(){this.map.ol.un(this.mapClickListener.type,this.mapClickListener.listener),this.mapClickListener=void 0}onMapEvent(e){if(this.cancelOngoingQueries(),!this.queryService.queryEnabled)return;const t=[];this.queryFeatures&&t.push(this.doQueryFeatures(e));const o=this.map.ol.getView().getResolution(),i=this.map.layers.filter(Vl);t.push(...this.queryService.query(i,{coordinates:e.coordinate,projection:this.map.projection,resolution:o})),0!==t.length&&(this.waitForAllQueries?this.queries$$.push(Object(Zs.a)(...t).subscribe(t=>{const o=[].concat(...t);this.query.emit({features:o,event:e})})):this.queries$$=t.map(t=>t.subscribe(t=>{this.query.emit({features:t,event:e})})))}doQueryFeatures(e){const t=[];if("singleclick"===e.type)this.map.ol.forEachFeatureAtPixel(e.pixel,(e,o)=>{const i=this.map.getLayerById(o.values_._layer.id);if(e)if(e.get("features"))for(const r of e.get("features")){const e=ol(r,this.map.projection);e.meta={title:r.values_.nom,id:o.values_._layer.id+"."+r.id_,icon:r.values_._icon,sourceTitle:o.values_.title,alias:this.queryService.getAllowedFieldsAndAlias(i)},t.push(e)}else if(e instanceof un.a){const r=function(e,t,o,i="EPSG:4326"){let r,s,a,n;o?(s=o.get("title"),o.get("sourceOptions")&&(a=o.get("sourceOptions").excludeAttribute,n=o.get("sourceOptions").excludeAttributeOffline)):s=e.get("_title");const c=new sn.a,l=e.getProperties(),u=e.getType();"Polygon"===u?r=new tn.b(e.flatCoordinates_,en.a.XY,e.ends_):"Point"===u?r=new on.a(e.flatCoordinates_,en.a.XY):"LineString"===u&&(r=new rn.a(e.flatCoordinates_,en.a.XY));const d=c.writeGeometryObject(r,{dataProjection:i,featureProjection:t}),h=e.getId()?e.getId():z(),p=e.get("_mapTitle"),m=Object(sa.t)(e.getExtent(),t,i);return{type:Xc,projection:i,extent:m,meta:{id:h,title:s||p||h,mapTitle:p,excludeAttribute:a,excludeAttributeOffline:n},properties:l,geometry:d,ol:e}}(e,this.map.projection,o);r.meta={id:o.values_._layer.id+"."+r.meta.id,sourceTitle:o.values_.title,alias:this.queryService.getAllowedFieldsAndAlias(i),title:this.queryService.getQueryTitle(r,i)||r.meta.title},t.push(r)}else{const r=ol(e,this.map.projection,o);r.meta={id:o.values_._layer.id+"."+r.meta.id,sourceTitle:o.values_.title,alias:this.queryService.getAllowedFieldsAndAlias(i),title:this.queryService.getQueryTitle(r,i)||r.meta.title},t.push(r)}},{hitTolerance:this.queryFeaturesHitTolerance||0,layerFilter:this.queryFeaturesCondition?this.queryFeaturesCondition:Ul});else if("boxend"===e.type){const o=e.target.getGeometry().getExtent();this.map.layers.filter(Vl).filter(e=>e instanceof Wc&&e.visible).map(e=>{e.dataSource.ol.forEachFeatureIntersectingExtent(o,o=>{const i=ol(o,this.map.projection,e.ol);i.meta={id:e.id+"."+o.id_,icon:o.values_._icon,sourceTitle:e.title,alias:this.queryService.getAllowedFieldsAndAlias(e),title:this.queryService.getQueryTitle(i,e)||i.meta.title},t.push(i)})})}return Object(L.a)(t)}cancelOngoingQueries(){this.queries$$.forEach(e=>e.unsubscribe()),this.queries$$=[]}addDragBoxInteraction(){let e;const t=this.map.ol.getInteractions().getArray();for(const o of t)if(o instanceof dl){e=o;break}void 0===e&&(e=new dl({condition:Nn}),this.map.ol.addInteraction(e),this.olDragSelectInteraction=e),this.olDragSelectInteractionEndKey=e.on("boxend",e=>this.onMapEvent(e))}removeDragBoxInteraction(){void 0!==this.olDragSelectInteractionEndKey&&Object(Ga.b)(this.olDragSelectInteractionEndKey),void 0!==this.olDragSelectInteraction&&this.map.ol.removeInteraction(this.olDragSelectInteraction),this.olDragSelectInteraction=void 0}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(Sl,2),Object(i.gc)(Gl))},e.\u0275dir=Object(i.bc)({type:e,selectors:[["","igoQuery",""]],inputs:{queryFeatures:"queryFeatures",queryFeaturesHitTolerance:"queryFeaturesHitTolerance",queryFeaturesCondition:"queryFeaturesCondition",waitForAllQueries:"waitForAllQueries"},outputs:{query:"query"}}),e})(),Yl=(()=>{class e{constructor(e,t){if(this.storageService=t,this.options=e,this.storageService){const e=this.storageService.get(this.getId()+".options");e&&(this.options=E.mergeDeep(this.options,e))}this.options=E.mergeDeep(this.getDefaultOptions(),this.options),this.settings.forEach(e=>{this.setParamFromSetting(e,!1)})}getId(){throw new Error('You have to implement the method "getId".')}getType(){throw new Error('You have to implement the method "getType".')}getDefaultOptions(){throw new Error('You have to implement the method "getDefaultOptions".')}get title(){return this.options.title}get available(){return!1!==this.options.available}set enabled(e){this.options.enabled=e}get enabled(){return this.available&&!1!==this.options.enabled}get showInPointerSummary(){return this.options.showInPointerSummary||!1}get showInSettings(){const e=this.options.showInSettings;return void 0===e||e}get searchUrl(){return this.options.searchUrl}get params(){return void 0===this.options.params?{}:this.options.params}get settings(){return void 0===this.options.settings?[]:this.options.settings}setParamFromSetting(e,t=!0){switch(e.type){case"radiobutton":e.values.forEach(t=>{t.enabled&&(this.options.params=Object.assign(this.options.params||{},{[e.name]:t.value}))});break;case"checkbox":let t="";e.values.filter(e=>!1!==e.available).forEach(e=>{e.enabled&&(t+=e.value+",")}),t=t.slice(0,-1),this.options.params=Object.assign(this.options.params||{},{[e.name]:t})}t&&this.storageService&&this.storageService.set(this.getId()+".options",{params:this.options.params})}get displayOrder(){return void 0===this.options.order?99:this.options.order}getHashtagsValid(e,t){const o=e.match(/(#[^\s]+)/g);if(!o)return;const i=this.getSettingsValues(t),r=[];return o.forEach(e=>{i.values.forEach(t=>{const o=e.substring(1);if("string"==typeof t.value){const e=t.value.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").split(","),i=e.indexOf(o.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""));-1!==i&&r.push(e[i])}t.hashtags&&-1!==t.hashtags.indexOf(o)&&r.push(t.value)})}),r.filter((e,t)=>r.indexOf(e)===t)}getSettingsValues(e){return this.getDefaultOptions().settings.find(t=>t.name===e)}}return e.id="",e.type="",e})(),Wl=(()=>{class e extends Yl{constructor(e){super(e)}getId(){return e.id}getType(){return e.type}getDefaultOptions(){return{title:"Carte"}}}return e.id="map",e.type=Xc,e.\u0275fac=function(t){return new(t||e)(Object(i.qc)("options"))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac}),e})();class Kl{static getGoogleMapsCoordLink(e,t){return"https://www.google.com/maps?q="+t+","+e}static getGoogleStreetViewLink(e,t){return"https://www.google.com/maps?q=&layer=c&cbll="+t+","+e}static getGoogleMapsNameLink(e){return"https://www.google.com/maps?q="+encodeURI(e)}}class Zl{static getOpenStreetMapLink(e,t,o=17){return`https://www.openstreetmap.org/?mlat=${t}&mlon=${e}#map=${o}/${t}/${e}`}static getOpenStreetCamLink(e,t,o=17){return`https://openstreetcam.org/map/@${t},${e},${o}z`}}let Ql=(()=>{class e{constructor(e,t,o,i,r){this.http=e,this.config=t,this.languageService=o,this.messageService=i,this.capabilitiesService=r}loadCatalogs(){const e=this.config.getConfig("context")||{},t=this.config.getConfig("catalog")||{},o=t.url||e.url,i=t.sources||[],r=[];if(o){if(t.baseLayers){const e=[{id:"catalog.baselayers",title:this.languageService.translate.instant("igo.geo.catalog.baseLayers"),url:o+"/baselayers",type:"baselayers"}];r.push(Object(L.a)(e))}const e=this.http.get(o+"/catalogs").pipe(Object(j.a)(e=>e.map(e=>Object.assign(e,e.options))),Object(v.a)(e=>Qs.a));r.push(e)}return i.length>0&&r.push(Object(L.a)(i).pipe(Object(j.a)(e=>e.map(e=>(e.id||(e.id=z()),e))))),Object(Zs.a)(...r).pipe(Object(j.a)(e=>[].concat.apply([],e)))}loadCatalogItems(e){let t;return t=ql.createInstanceCatalog(e,this),t.collectCatalogItems()}loadCatalogBaseLayerItems(e){return this.getCatalogBaseLayersOptions(e).pipe(Object(j.a)(t=>{const o=t.map(t=>({id:Gn(t.sourceOptions),title:t.title,type:Pl.Layer,externalProvider:e.externalProvider,options:t}));return[{id:"catalog.group.baselayers",type:Pl.Group,title:e.title,items:o}]}))}getCatalogBaseLayersOptions(e){return this.http.get(e.url)}loadCatalogWMSLayerItems(e){return this.getCatalogCapabilities(e).pipe(Object(j.a)(t=>{const o=[];t.Service&&t.Service.Abstract&&t.Service.Abstract.length&&(e.abstract=t.Service.Abstract);const i=[];this.flattenWmsCapabilities(t.Capability.Layer,0,i,e.groupSeparator);const r=Object.assign({},t.Capability.Layer);return r.Layer=i.filter(e=>0!==e.Layer.length),this.includeRecursiveItems(e,r,o),o}))}flattenWmsCapabilities(e,t=0,o,i=" / "){if(!o.includes(e.Title)){const t=Object.assign({},e);t.Layer=[],o.push(t)}for(const r of e.Layer){const s=Object.assign({},r);t>0&&(s.Title=e.Title+i+r.Title),r.Layer?this.flattenWmsCapabilities(s,t+1,o,i):o.find(t=>t.Title===e.Title).Layer.push(r)}}loadCatalogWMTSLayerItems(e){return this.getCatalogCapabilities(e).pipe(Object(j.a)(t=>this.getWMTSItems(e,t)))}loadCatalogArcGISRestItems(e){return this.getCatalogCapabilities(e).pipe(Object(j.a)(t=>this.getArcGISRESTItems(e,t)))}loadCatalogCompositeLayerItems(e){const t=e.composite,o=[];t.map(e=>o.push(ql.createInstanceCatalog(e,this)));const i=[];o.map(e=>i.push(e.collectCatalogItems()));let r=[];if(Object.keys(t).find(e=>t[e].groupImpose)){const e=(e,t)=>{const i=o[t],r=Object.assign({},i.groupImpose);r.address=i.id,r.type=Pl.Group,r.items=[];const s=function e(t){return t.reduce((t,o)=>t.concat(o.type===Pl.Group?e(o.items):o),[])}(e);return s.map(e=>e.address=`${r.address}.${r.id}`),r.items=s,r};r=i.map((o,i)=>o.pipe(Object(j.a)(o=>t[i].groupImpose?e(o,i):o)))}else r=i;const s=Object(Zs.a)(...r).pipe(Object(j.a)(e=>[].concat(...e))),a=(e,t)=>e.reduce((e,o,i,r)=>{const s=t(o),n=Object.assign({},o);if(o.type===Pl.Layer){const t=[];if(r.filter((e,r)=>{let a=!1;return e.title===s&&e.type===Pl.Layer&&(r!==i&&e.address!==o.address&&(a=!0),t.push(r)),a}).length>0){const e=t.findIndex(e=>e===i)+1;n.title=`${o.title} (${e})`}e.find(e=>e.title===n.title&&e.type===Pl.Layer)||(e[e.length]=n)}else o.type===Pl.Group&&(n.items=a(o.items,e=>e.title),e[e.length]=n);return e},[]);return s.pipe(Object(j.a)(e=>{return t=e=>e.id,e.reduce((e,o)=>{const i=t(o),r=e.find(e=>e.id===i);if(r){const t=e.indexOf(r);-1===e[t].address.split("|").indexOf(o.address)&&(e[t].address=`${e[t].address}|${o.address}`),e[t].items.push(...o.items)}else e[e.length]=o;return e},[]);var t}),Object(j.a)(e=>[].concat(...e)),Object(j.a)(e=>a(e,e=>e.title)))}getCatalogCapabilities(e){return this.capabilitiesService.getCapabilities(_c[Al[e.type]],e.url,e.version).pipe(Object(v.a)(t=>{const o=this.languageService.translate.instant("igo.geo.catalog.unavailableTitle"),i=this.languageService.translate.instant("igo.geo.catalog.unavailable",{value:e.title});throw this.messageService.error(i,o),t}))}prepareCatalogItemLayer(e,t,o,i){const r=this.retriveLayerInfoFormat(e.Name,o),s=e.DataURL?e.DataURL[0]:void 0,a=i.showLegend&&e.Style?this.capabilitiesService.getStyle(e.Style):void 0,n=Object.assign({},i.queryParams,{LAYERS:e.Name,VERSION:i.version}),c={type:"wms",url:i.url,crossOrigin:i.setCrossOriginAnonymous?"anonymous":void 0,queryFormat:r,queryHtmlTarget:r===ic.HTML||r===ic.HTMLGML2?"iframe":void 0,optionsFromCapabilities:!0},l=Object.assign({},c,i.sourceOptions,{params:n});let u,d;if(i.forcedProperties)for(const p of i.forcedProperties)e.Name===p.layerName&&p.title&&(u=p.title);e.Abstract?d=e.Abstract:!e.Abstract&&i.abstract&&(d=i.abstract);const h={id:Gn(l),type:Pl.Layer,title:void 0!==u?u:e.Title,address:t,externalProvider:i.externalProvider||!1,options:{maxResolution:zn(e.MaxScaleDenominator),minResolution:zn(e.MinScaleDenominator),metadata:{url:s?s.OnlineResource:void 0,extern:!!s||void 0,abstract:d,type:c.type},legendOptions:a,tooltip:{type:i.tooltipType},sourceOptions:l}};return E.removeUndefined(h)}prepareCatalogItemGroup(e,t,o,i,r){return{id:o,type:Pl.Group,title:e.Title,address:r.id,items:e.Layer.reduce((e,s)=>{if(void 0!==s.Layer){const a=this.prepareCatalogItemGroup(s,t,o+".group."+(s.Name||s.Layer[0].Name),i,r);e.push(a)}else{if(!1===this.testLayerRegexes(s.Name,t))return e;const a=this.prepareCatalogItemLayer(s,o,i,r);e.push(a)}return e},[])}}includeRecursiveItems(e,t,o,i=0){const r=(e.regFilters||[]).map(e=>new RegExp(e));if(t.Layer)for(const s of t.Layer){if(void 0!==s.Layer){this.includeRecursiveItems(e,s,o,i+1);continue}const a=this.findCatalogInfoFormat(e);if(0!==i){const i=this.prepareCatalogItemGroup(t,r,"catalog.group."+(t.Name||s.Name),a,e);0!==i.items.length&&o.push(i);break}if(!1!==this.testLayerRegexes(s.Name,r)){const t=this.prepareCatalogItemLayer(s,e.id,a,e);o.push(t)}}}getWMTSItems(e,t){const o=t.Contents.Layer,i=(e.regFilters||[]).map(e=>new RegExp(e));return t.ServiceIdentification&&t.ServiceIdentification.Abstract&&t.ServiceIdentification.Abstract.length&&(e.abstract=t.ServiceIdentification.Abstract),o.map(t=>{let o;if(e.forcedProperties)for(const i of e.forcedProperties)t.Title===i.layerName&&i.title&&(o=i.title);if(!1===this.testLayerRegexes(t.Identifier,i))return;const r=Object.assign({},e.queryParams,{version:"1.0.0"}),s={type:"wmts",url:e.url,crossOrigin:e.setCrossOriginAnonymous?"anonymous":void 0,layer:t.Identifier,matrixSet:e.matrixSet,optionsFromCapabilities:!0,requestEncoding:e.requestEncoding||"KVP",style:"default"},a=Object.assign({},s,e.sourceOptions,{params:r});return E.removeUndefined({id:Gn(a),type:Pl.Layer,title:void 0!==o?o:t.Title,address:e.id,externalProvider:e.externalProvider,options:{sourceOptions:a,metadata:{url:void 0,extern:void 0,abstract:e.abstract,type:s.type}}})}).filter(e=>void 0!==e)}getArcGISRESTItems(e,t){const o=t.layers.filter(e=>!e.type||"Feature Layer"===e.type),i=(e.regFilters||[]).map(e=>new RegExp(e));let r;return t.serviceDescription&&t.serviceDescription.length&&(r=t.serviceDescription),o.map(t=>{let o;if(e.forcedProperties)for(const i of e.forcedProperties)t.name===i.layerName&&i.title&&(o=i.title);if(!1===this.testLayerRegexes(t.id,i))return;const s={type:Al[e.type],url:e.url,crossOrigin:e.setCrossOriginAnonymous?"anonymous":void 0,layer:t.id,queryable:!0,queryFormat:"esrijson",matrixSet:e.matrixSet,optionsFromCapabilities:!0,style:"default"},a=Object.assign({},s,e.sourceOptions);return E.removeUndefined({id:Gn(a),type:Pl.Layer,title:void 0!==o?o:t.name,externalProvider:e.externalProvider,address:e.id,options:{sourceOptions:a,minResolution:zn(t.maxScale),maxResolution:zn(t.minScale),metadata:{url:void 0,extern:void 0,abstract:r,type:s.type},title:void 0!==o?o:t.name}})}).filter(e=>void 0!==e)}testLayerRegexes(e,t){return 0===t.length||void 0!==t.find(t=>t.test(e))}retriveLayerInfoFormat(e,t){const o=t.find(t=>t.layer===e),i=t.find(e=>"*"===e.layer);let r;return o?r=o.queryFormat:i&&(r=i.queryFormat),r}findCatalogInfoFormat(e){const t=[];return e.queryFormat?(Object.keys(e.queryFormat).forEach(o=>{e.queryFormat[o]instanceof Array?e.queryFormat[o].forEach(e=>{t.find(t=>t.layer===e)||t.push({layer:e,queryFormat:o})}):t.find(t=>t.layer===e.queryFormat[o])||t.push({layer:e.queryFormat[o],queryFormat:o})}),t):t}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(y.b),Object(i.qc)(K),Object(i.qc)(le),Object(i.qc)(ce),Object(i.qc)(zc))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Jl(e,t){if(1&e){const e=Object(i.nc)();Object(i.kc)(0),Object(i.mc)(1,"igo-catalog-browser-group",3),Object(i.tc)("addedChange",(function(t){return Object(i.Nc)(e),Object(i.xc)(2).onGroupAddedChange(t)}))("layerAddedChange",(function(t){return Object(i.Nc)(e),Object(i.xc)(2).onLayerAddedChange(t)})),Object(i.yc)(2,"async"),Object(i.lc)(),Object(i.jc)()}if(2&e){const e=Object(i.xc)().$implicit,t=Object(i.xc)();Object(i.Tb)(1),Object(i.Dc)("catalog",t.catalog)("group",e)("state",t.store.state)("resolution",Object(i.zc)(2,6,t.resolution$))("catalogAllowLegend",t.catalogAllowLegend)("toggleCollapsed",t.toggleCollapsedGroup)}}function Xl(e,t){if(1&e){const e=Object(i.nc)();Object(i.kc)(0),Object(i.mc)(1,"igo-catalog-browser-layer",4),Object(i.tc)("addedChange",(function(t){return Object(i.Nc)(e),Object(i.xc)(2).onLayerAddedChange(t)})),Object(i.yc)(2,"async"),Object(i.lc)(),Object(i.jc)()}if(2&e){const e=Object(i.xc)().$implicit,t=Object(i.xc)();Object(i.Tb)(1),Object(i.Dc)("layer",e)("resolution",Object(i.zc)(2,4,t.resolution$))("catalogAllowLegend",t.catalogAllowLegend)("added",t.store.state.get(e).added)}}function eu(e,t){if(1&e&&(Object(i.Yc)(0,Jl,3,8,"ng-container",2),Object(i.Yc)(1,Xl,3,6,"ng-container",2)),2&e){const e=t.$implicit,o=Object(i.xc)();Object(i.Dc)("ngIf",o.isGroup(e)),Object(i.Tb)(1),Object(i.Dc)("ngIf",o.isLayer(e))}}let tu=(()=>{class e{constructor(e,t){this.layerService=e,this.cdRef=t,this.catalogAllowLegend=!1,this.toggleCollapsedGroup=!0}get resolution$(){return this.map.viewController.resolution$}ngOnInit(){const e=this.map.layers.map(e=>({id:e.options.source.id,title:e.title,type:Pl.Layer}));this.store.state.updateMany(e,{added:!0},!0),this.catalog&&void 0!==this.catalog.sortDirection&&this.store.view.sort({direction:this.catalog.sortDirection,valueAccessor:e=>e.title}),this.catalogAllowLegend=!!this.catalog&&this.catalog.showLegend||this.catalogAllowLegend,this.watcher=new nt(this.store,this.cdRef)}ngOnDestroy(){this.watcher.destroy()}isGroup(e){return e.type===Pl.Group}isLayer(e){return e.type===Pl.Layer}onLayerAddedChange(e){const t=e.layer;this.store.state.update(t,{added:e.added},!1),e.added?this.addLayerToMap(t):this.removeLayerFromMap(t)}onGroupAddedChange(e){const t=e.group;this.store.state.update(t,{added:e.added},!1),e.added?this.addGroupToMap(t):this.removeGroupFromMap(t)}addLayerToMap(e){this.addLayersToMap([e])}removeLayerFromMap(e){this.removeLayersFromMap([e])}addLayersToMap(e){const t=e.map(e=>(void 0===e.options.sourceOptions.optionsFromApi&&(e.options.sourceOptions.optionsFromApi=!0),this.layerService.createAsyncLayer(e.options)));Object(Zs.a)(...t).subscribe(t=>{this.store.state.updateMany(e,{added:!0}),this.map.addLayers(t)})}removeLayersFromMap(e){e.forEach(e=>{if(this.store.state.update(e,{added:!1}),!0===e.options.baseLayer){const t=this.map.getLayerById(e.options.id);void 0!==t&&this.map.removeLayer(t)}else{const t=this.map.getLayerById(e.id);void 0!==t&&this.map.removeLayer(t)}})}sortCatalogItemsByTitle(e,t){const o=e.sort((e,t)=>{const o=e.title.normalize("NFD").replace(/[\u0300-\u036f]/g,""),i=t.title.normalize("NFD").replace(/[\u0300-\u036f]/g,"");return o<i?-1:o>i?1:0});switch(t){case"asc":return o;case"desc":return o.reverse();default:return e}}addGroupToMap(e){let t=e.items.filter(e=>{const t=this.store.state.get(e).added||!1;return this.isLayer(e)&&!1===t});this.catalog&&void 0!==this.catalog.sortDirection&&(t=this.sortCatalogItemsByTitle(t,this.catalog.sortDirection)),this.addLayersToMap(t.reverse())}removeGroupFromMap(e){const t=e.items.filter(e=>{const t=this.store.state.get(e).added||!1;return this.isLayer(e)&&!0===t});this.removeLayersFromMap(t)}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(Jc),Object(i.gc)(i.j))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-catalog-browser"]],inputs:{catalogAllowLegend:"catalogAllowLegend",catalog:"catalog",store:"store",map:"map",toggleCollapsedGroup:"toggleCollapsedGroup"},decls:3,vars:5,consts:[[3,"navigation","selection"],["ngFor","",3,"ngForOf"],[4,"ngIf"],[3,"catalog","group","state","resolution","catalogAllowLegend","toggleCollapsed","addedChange","layerAddedChange"],["igoListItem","",3,"layer","resolution","catalogAllowLegend","added","addedChange"]],template:function(e,t){1&e&&(Object(i.mc)(0,"igo-list",0),Object(i.Yc)(1,eu,2,2,"ng-template",1),Object(i.yc)(2,"async"),Object(i.lc)()),2&e&&(Object(i.Dc)("navigation",!1)("selection",!1),Object(i.Tb)(1),Object(i.Dc)("ngForOf",Object(i.zc)(2,3,t.store.view.all$())))},encapsulation:2,changeDetection:0}),e})(),ou=(()=>{class e{constructor(){this.sortAlpha=!1,this.onlyVisible=!1,this.onlyInRange=!1,this.keywordInitialized=!1,this.sortedAlphaInitialized=!1,this.onlyVisibleInitialized=!1,this.onlyInRangeInitialized=!1}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var iu=function(e){return e.always="always",e.never="never",e.default="default",e}({}),ru=function(e){return e.ALL_VISIBLE="ALL_VISIBLE",e.ALL_HIDDEN="ALL_HIDDEN",e.MIXED="MIXED",e.NULL="NULL",e}({}),su=function(e){return e.Raise="raise",e.Lower="lower",e}({});const au=["igoLayerItemToolbar"];function nu(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"igo-layer-list-tool",5),Object(i.tc)("appliedFilterAndSort",(function(t){return Object(i.Nc)(e),Object(i.xc)().onAppliedFilterAndSortChange(t)}))("selection",(function(t){return Object(i.Nc)(e),Object(i.xc)().toggleSelectionMode(t)})),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Dc)("layersAreAllVisible",e.layersAreAllVisible)("term",e.layerFilterAndSortOptions.keyword)("onlyVisible",e.layerFilterAndSortOptions.onlyVisible)("sortAlpha",e.layerFilterAndSortOptions.sortAlpha)}}function cu(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"igo-layer-item",7),Object(i.tc)("action",(function(t){return Object(i.Nc)(e),Object(i.xc)(2).toggleLayerTool(t)}))("checkbox",(function(t){return Object(i.Nc)(e),Object(i.xc)(2).layersCheck(t)})),Object(i.lc)()}if(2&e){const e=Object(i.xc)().$implicit,t=Object(i.xc)();Object(i.Dc)("layer",e)("activeLayer",t.activeLayer)("orderable",t.orderable&&!e.baseLayer)("lowerDisabled",t.getLowerLayer().id===e.id)("raiseDisabled",t.getUpperLayer().id===e.id)("queryBadge",t.queryBadge)("expandLegendIfVisible",t.expandLegendOfVisibleLayers)("updateLegendOnResolutionChange",t.updateLegendOnResolutionChange)("toggleLegendOnVisibilityChange",t.toggleLegendOnVisibilityChange)("selectionMode",t.selection)("selectAll",t.selectAllCheck)("layerCheck",e.options.check)("changeDetection",t.layerItemChangeDetection$)}}function lu(e,t){if(1&e&&Object(i.Yc)(0,cu,1,13,"igo-layer-item",6),2&e){const e=t.$implicit,o=Object(i.xc)();Object(i.Dc)("ngIf",!(o.excludeBaseLayers&&e.baseLayer))}}function uu(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",22),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.xc)(2).removeLayers()})),Object(i.yc)(1,"translate"),Object(i.hc)(2,"mat-icon",23),Object(i.lc)()}2&e&&Object(i.Dc)("matTooltip",Object(i.zc)(1,1,"igo.geo.layer.removeLayer"))}const du=function(e){return{layer:e}};function hu(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"igo-panel",8),Object(i.mc)(1,"div",9),Object(i.ic)(2,10),Object(i.Bc)(3),Object(i.mc)(4,"button",11),Object(i.yc)(5,"translate"),Object(i.hc)(6,"mat-icon",12),Object(i.lc)(),Object(i.mc)(7,"mat-menu",13,14),Object(i.mc)(9,"div",15),Object(i.mc)(10,"mat-slider",16),Object(i.tc)("input",(function(t){return Object(i.Nc)(e),Object(i.xc)().changeOpacity(t)}))("click",(function(t){return Object(i.Nc)(e),t.stopPropagation()})),Object(i.yc)(11,"translate"),Object(i.lc)(),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(12,"button",17),Object(i.tc)("click",(function(){Object(i.Nc)(e);const t=Object(i.xc)();return t.moveActiveLayer(t.activeLayer,t.layerListDisplacement.Raise)})),Object(i.yc)(13,"translate"),Object(i.yc)(14,"translate"),Object(i.hc)(15,"mat-icon",18),Object(i.lc)(),Object(i.mc)(16,"button",19),Object(i.tc)("click",(function(){Object(i.Nc)(e);const t=Object(i.xc)();return t.moveActiveLayer(t.activeLayer,t.layerListDisplacement.Lower)})),Object(i.yc)(17,"translate"),Object(i.yc)(18,"translate"),Object(i.hc)(19,"mat-icon",20),Object(i.lc)(),Object(i.Yc)(20,uu,3,3,"button",21),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=Object(i.Kc)(8),t=Object(i.xc)();Object(i.Dc)("title",t.activeLayer.title),Object(i.Tb)(2),Object(i.Dc)("ngTemplateOutlet",t.templateLayerToolbar)("ngTemplateOutletContext",Object(i.Gc)(31,du,t.activeLayer)),Object(i.Tb)(2),Object(i.Dc)("matMenuTriggerFor",e)("matTooltip",Object(i.zc)(5,19,"igo.geo.layer.opacity")),Object(i.Tb)(2),Object(i.Dc)("matBadge",t.badgeOpacity),Object(i.Tb)(4),Object(i.Dc)("min",0)("max",100)("value",t.opacity)("matTooltip",Object(i.zc)(11,21,"igo.geo.layer.opacity")),Object(i.Tb)(2),Object(i.Dc)("matTooltip",t.sortAlpha||t.onlyVisible||t.keyword?Object(i.zc)(13,23,"igo.geo.layer.filterRaiseLayer"):Object(i.zc)(14,25,"igo.geo.layer.raiseLayer"))("disabled",t.raiseDisabled),Object(i.Tb)(3),Object(i.Dc)("matBadge",t.sortAlpha||t.onlyVisible||t.keyword?"!":"")("matBadgeHidden",t.raiseDisabled),Object(i.Tb)(1),Object(i.Dc)("matTooltip",t.sortAlpha||t.onlyVisible||t.keyword?Object(i.zc)(17,27,"igo.geo.layer.filterLowerLayer"):Object(i.zc)(18,29,"igo.geo.layer.lowerLayer"))("disabled",t.lowerDisabled),Object(i.Tb)(3),Object(i.Dc)("matBadge",t.sortAlpha||t.onlyVisible||t.keyword?"!":"")("matBadgeHidden",t.lowerDisabled),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.isLayerRemovable(t.activeLayer))}}function pu(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"mat-slider",32),Object(i.tc)("ngModelChange",(function(t){return Object(i.Nc)(e),Object(i.xc)(2).checkOpacity=t}))("click",(function(t){return Object(i.Nc)(e),t.stopPropagation()})),Object(i.yc)(1,"translate"),Object(i.lc)()}if(2&e){const e=Object(i.xc)(2);Object(i.Dc)("min",0)("max",100)("ngModel",e.checkOpacity)("matTooltip",Object(i.zc)(1,4,"igo.geo.layer.opacity"))}}function mu(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"igo-panel",8),Object(i.yc)(1,"translate"),Object(i.mc)(2,"div",9),Object(i.mc)(3,"button",24),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.xc)().selectAll()})),Object(i.yc)(4,"translate"),Object(i.yc)(5,"translate"),Object(i.ad)(6),Object(i.yc)(7,"translate"),Object(i.yc)(8,"translate"),Object(i.lc)(),Object(i.mc)(9,"button",25),Object(i.yc)(10,"translate"),Object(i.hc)(11,"mat-icon",26),Object(i.lc)(),Object(i.mc)(12,"mat-menu",13,14),Object(i.mc)(14,"div",15),Object(i.Yc)(15,pu,2,6,"mat-slider",27),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(16,"button",17),Object(i.tc)("click",(function(){Object(i.Nc)(e);const t=Object(i.xc)();return t.raiseLayers(t.layersChecked)})),Object(i.yc)(17,"translate"),Object(i.yc)(18,"translate"),Object(i.hc)(19,"mat-icon",18),Object(i.lc)(),Object(i.mc)(20,"button",19),Object(i.tc)("click",(function(){Object(i.Nc)(e);const t=Object(i.xc)();return t.lowerLayers(t.layersChecked)})),Object(i.yc)(21,"translate"),Object(i.yc)(22,"translate"),Object(i.hc)(23,"mat-icon",20),Object(i.lc)(),Object(i.mc)(24,"button",28),Object(i.tc)("click",(function(){Object(i.Nc)(e);const t=Object(i.xc)();return t.toggleVisibility(t.layersChecked)})),Object(i.yc)(25,"translate"),Object(i.yc)(26,"translate"),Object(i.hc)(27,"mat-icon",29),Object(i.lc)(),Object(i.mc)(28,"button",30),Object(i.tc)("click",(function(){Object(i.Nc)(e);const t=Object(i.xc)();return t.removeLayers(t.layersChecked)})),Object(i.yc)(29,"translate"),Object(i.yc)(30,"translate"),Object(i.hc)(31,"mat-icon",31),Object(i.lc)(),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=Object(i.Kc)(13),t=Object(i.xc)();Object(i.Dc)("title",Object(i.zc)(1,23,"igo.geo.layer.tools")),Object(i.Tb)(3),Object(i.Dc)("disabled",0===t.layers.length)("matTooltip",t.selectAllCheck?Object(i.zc)(4,25,"igo.geo.layer.deselectAll"):Object(i.zc)(5,27,"igo.geo.layer.selectAll")),Object(i.Tb)(3),Object(i.cd)(" ",t.selectAllCheck?Object(i.zc)(7,29,"igo.geo.layer.deselectAll"):Object(i.zc)(8,31,"igo.geo.layer.selectAll")," "),Object(i.Tb)(3),Object(i.Dc)("disabled",0===t.layersChecked.length)("matMenuTriggerFor",e)("matTooltip",Object(i.zc)(10,33,"igo.geo.layer.opacity")),Object(i.Tb)(6),Object(i.Dc)("ngIf",t.layersChecked.length),Object(i.Tb)(1),Object(i.Dc)("matTooltip",t.sortAlpha||t.onlyVisible||t.keyword?Object(i.zc)(17,35,"igo.geo.layer.filterRaiseLayer"):Object(i.zc)(18,37,"igo.geo.layer.raiseLayer"))("disabled",t.raiseDisabledSelection),Object(i.Tb)(3),Object(i.Dc)("matBadge",t.sortAlpha||t.onlyVisible||t.keyword?"!":"")("matBadgeHidden",t.raiseDisabledSelection),Object(i.Tb)(1),Object(i.Dc)("matTooltip",t.sortAlpha||t.onlyVisible||t.keyword?Object(i.zc)(21,39,"igo.geo.layer.filterLowerLayer"):Object(i.zc)(22,41,"igo.geo.layer.lowerLayer"))("disabled",t.lowerDisabledSelection),Object(i.Tb)(3),Object(i.Dc)("matBadge",t.sortAlpha||t.onlyVisible||t.keyword?"!":"")("matBadgeHidden",t.lowerDisabledSelection),Object(i.Tb)(1),Object(i.Dc)("disabled",0===t.layersChecked.length)("matTooltip","ALL_HIDDEN"===t.statusSelectedLayersCheck?Object(i.zc)(25,43,"igo.geo.layer.showSelectedLayers"):Object(i.zc)(26,45,"igo.geo.layer.hideSelectedLayers")),Object(i.Tb)(3),Object(i.Dc)("svgIcon","ALL_HIDDEN"===t.statusSelectedLayersCheck?"eye-off":"eye"),Object(i.Tb)(1),Object(i.Dc)("disabled",0===t.layersChecked.length)("matTooltip",t.isAllLayersRemovable(t.layersChecked)?Object(i.zc)(29,47,"igo.geo.layer.removeSelectedLayers"):Object(i.zc)(30,49,"igo.geo.layer.removeSelectedLayersRestriction")),Object(i.Tb)(3),Object(i.Dc)("matBadge","!")("matBadgeHidden",t.isAllLayersRemovable(t.layersChecked))}}const gu=[[["","igoLayerItemToolbar",""]]],bu=["[igoLayerItemToolbar]"];let fu=(()=>{class e{constructor(e){this.elRef=e,this.orderable=!0,this.thresholdToFilterAndSort=5,this.layers$=new C.a([]),this.change$=new Se.a(1),this.showToolbar$=new C.a(!1),this.hideSelectedLayers=!0,this.activeLayer$=new C.a(void 0),this.layersChecked=[],this.layerItemChangeDetection$=new C.a(void 0),this.layersAreAllVisible=!0,this.ogcButton=!0,this.timeButton=!0,this.floatLabel="auto",this.layerFilterAndSortOptions={},this.excludeBaseLayers=!1,this.toggleLegendOnVisibilityChange=!1,this.expandLegendOfVisibleLayers=!1,this.updateLegendOnResolutionChange=!1,this.queryBadge=!1,this.appliedFilterAndSort=new i.u,this._keyword=void 0,this._onlyVisible=!1,this._sortedAlpha=!1,this.toggleOpacity=!1,this.selectAllCheck$=new C.a(void 0)}get map(){return this._map}set map(e){this._map=e}set layers(e){this._layers=e,this.next()}get layers(){return this._layers}set activeLayer(e){this._activeLayer=e,this.activeLayer$.next(e)}get activeLayer(){return this._activeLayer}get keyword(){return this._keyword}set keyword(e){this._keyword=e,this.next()}get onlyVisible(){return this._onlyVisible}set onlyVisible(e){this._onlyVisible=e,this.next()}get sortAlpha(){return this._sortedAlpha}set sortAlpha(e){this._sortedAlpha=e,this.next()}get opacity(){return Math.round(100*this.activeLayer$.getValue().opacity)}set opacity(e){this.activeLayer$.getValue().opacity=e/100}get badgeOpacity(){if(100!==this.opacity)return this.opacity}get raiseDisabled(){return!(this.orderable&&!this.activeLayer.baseLayer&&this.getUpperLayer().id!==this.activeLayer.id&&!this.isUpperBaselayer(this.activeLayer))}get lowerDisabled(){return!(this.orderable&&!this.activeLayer.baseLayer&&this.getLowerLayer().id!==this.activeLayer.id&&!this.isLowerBaselayer(this.activeLayer))}get raiseDisabledSelection(){return 0===this.layersChecked.length||!this.orderable||!this.raisableLayers(this.layersChecked)||!0===this.selectAllCheck}get lowerDisabledSelection(){return 0===this.layersChecked.length||!this.orderable||!this.lowerableLayers(this.layersChecked)||!0===this.selectAllCheck}get checkOpacity(){return 100*this.layersCheckedOpacity()}set checkOpacity(e){for(const t of this.layersChecked)t.opacity=e/100}get layerListDisplacement(){return su}ngOnInit(){this.change$$=this.change$.pipe(Object(ia.a)(()=>0===this.layers.length?Qs.a:Object(Js.a)(50))).subscribe(()=>{this.showToolbar$.next(this.computeShowToolbar()),this.layers$.next(this.computeLayers(this.layers.slice(0))),this.appliedFilterAndSort.emit({keyword:this.keyword,sortAlpha:this.sortAlpha,onlyVisible:this.onlyVisible})}),this.selectAllCheck$$=this.selectAllCheck$.subscribe(e=>{this.selectAllCheck=e}),this.layers$$=this.layers$.subscribe(()=>{if(this.layers){let e=0;for(const t of this.layers)t.options.active&&(this.activeLayer=t,this.layerTool=!0),t.options.check&&(e+=1);this.selectAllCheck=this.excludeBaseLayers?e===this.layers.filter(e=>!0!==e.baseLayer&&e.showInLayerList).length:e===this.layers.filter(e=>e.showInLayerList).length}})}ngOnDestroy(){this.change$$.unsubscribe(),this.selectAllCheck$$.unsubscribe(),this.layers$$.unsubscribe()}changeOpacity(e){this.opacity=e.value}clearKeyword(){this.keyword=void 0}getLowerLayer(){return this.layers.filter(e=>!e.baseLayer).reduce((e,t)=>e.zIndex<t.zIndex?e:t,{zIndex:void 0,id:void 0})}isLowerBaselayer(e){const t=this.layers.findIndex(t=>e.id===t.id);return!(!this.layers||!this.layers[t+1]||!0!==this.layers[t+1].baseLayer)}getUpperLayer(){return this.layers.filter(e=>!e.baseLayer).reduce((e,t)=>e.zIndex>t.zIndex?e:t,{zIndex:void 0,id:void 0})}isUpperBaselayer(e){const t=this.layers.findIndex(t=>e.id===t.id);return!(!this.layers||!this.layers[t-1]||!0!==this.layers[t-1].baseLayer)}moveActiveLayer(e,t){const o=[e],i=[];this.getLinkedLayers(e,o),this.layers.map(e=>{-1!==o.indexOf(e)&&i.push(e)}),t===su.Raise?this.raiseLayers(i,!1):t===su.Lower&&this.lowerLayers(i,!1)}getLinkedLayers(e,t){const o=e.options.linkedLayers;if(!o)return;const i=o.linkId,r=o.links;r?r.map(e=>{e.properties&&-1!==e.properties.indexOf(qn.ZINDEX)&&e.linkedIds.map(e=>{const o=this.layers.find(t=>{var o;return(null===(o=t.options.linkedLayers)||void 0===o?void 0:o.linkId)===e});o&&(t.includes(o)||t.push(o))})}):this.layers.map(e=>{var o;(null===(o=e.options.linkedLayers)||void 0===o?void 0:o.links)&&e.options.linkedLayers.links.map(o=>{var r;-1!==(null===(r=o.properties)||void 0===r?void 0:r.indexOf(qn.ZINDEX))&&!1!==o.bidirectionnal&&-1!==o.linkedIds.indexOf(i)&&(t.push(e),this.getLinkedLayers(e,t))})})}raisableLayers(e){let t=!1,o=0;for(const i of e){const r=this.layers.findIndex(e=>i.id===e.id),s=this.layers[r];s.baseLayer&&(o+=1);const a=this.layers[r-1];a&&!0!==a.baseLayer&&!e.find(e=>a.id===e.id)&&!0!==s.baseLayer&&(t=!0)}return(1===this.layersChecked.length&&this.layersChecked[0].baseLayer||o===this.layersChecked.length)&&(t=!1),t}raisableLayer(e){return!(e<1)&&(!this.layers[e-1].options.check||this.raisableLayer(e-1))}raiseLayers(e,t=!0){const o=[];for(const i of e){const e=this.layers.findIndex(e=>e.id===i.id);this.raisableLayer(e)&&o.push(i)}this.map.raiseLayers(o),t&&setTimeout(()=>{const e=this.computeElementRef();this.isScrolledIntoView(e[0],e[1].offsetParent)||(e[0].scrollTop=e[1].offsetParent.offsetTop)},100)}lowerableLayers(e){let t=!1,o=0;for(const i of e){const r=this.layers.findIndex(e=>i.id===e.id);this.layers[r].baseLayer&&(o+=1);const s=this.layers[r+1];s&&!0!==s.baseLayer&&!e.find(e=>s.id===e.id)&&(t=!0)}return(1===this.layersChecked.length&&this.layersChecked[0].baseLayer||o===this.layersChecked.length)&&(t=!1),t}lowerableLayer(e){return!(e>this.layers.filter(e=>!0!==e.baseLayer).length-2)&&(!this.layers[e+1].options.check||this.lowerableLayer(e+1))}lowerLayers(e,t=!0){const o=[];for(const i of e){const e=this.layers.findIndex(e=>e.id===i.id);this.lowerableLayer(e)&&o.push(i)}this.map.lowerLayers(o),t&&setTimeout(()=>{const e=this.computeElementRef("lower");this.isScrolledIntoView(e[0],e[1].offsetParent)||(e[0].scrollTop=e[1].offsetParent.offsetTop+e[1].offsetParent.offsetHeight-e[0].clientHeight)},100)}next(){this.change$.next()}computeLayers(e){let t=this.filterLayers(e);return t=this.sortAlpha?this.sortLayersByTitle(t):this.sortLayersByZindex(t),t}onKeywordChange(e){this.keyword=e}onAppliedFilterAndSortChange(e){this.keyword=e.keyword,this.onlyVisible=e.onlyVisible,this.sortAlpha=e.sortAlpha}filterLayers(e){if(this.layerFilterAndSortOptions.showToolbar===iu.never)return e;if(!this.keyword&&!this.onlyVisible)return e;const t=e.map(e=>e.id);return e.forEach(e=>{const o=e.dataSource.options||{},i=(((e.options||{}).metadata||{}).keywordList||[]).map(e=>e.normalize("NFD").replace(/[\u0300-\u036f]/g,""));if(this.keyword&&e.title){const r=this.keyword.normalize("NFD").replace(/[\u0300-\u036f]/g,""),s=e.title.normalize("NFD").replace(/[\u0300-\u036f]/g,""),a=o.type||"",n=new RegExp(r,"gi"),c=void 0!==i.find(e=>n.test(e));if(!n.test(s)&&this.keyword.toLowerCase()!==a.toLowerCase()&&!c){const o=t.indexOf(e.id);o>-1&&t.splice(o,1)}}if(this.onlyVisible&&!1===e.visible){const o=t.indexOf(e.id);o>-1&&t.splice(o,1)}}),e.filter(e=>-1!==t.indexOf(e.id))}sortLayersByZindex(e){return e.sort((e,t)=>t.zIndex-e.zIndex)}sortLayersByTitle(e){return e.sort((e,t)=>this.normalize(e.title)<this.normalize(t.title)?-1:this.normalize(e.title)>this.normalize(t.title)?1:0)}normalize(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}computeShowToolbar(){switch(this.layerFilterAndSortOptions.showToolbar){case iu.always:return!0;case iu.never:return!1;default:return!!(this.layers.length>=this.thresholdToFilterAndSort||this.keyword||this.onlyVisible)}}toggleLayerTool(e){this.toggleOpacity=!1,this.layerTool=!this.layerTool||e!==this.activeLayer;for(const t of this.layers)t.options.active=!1;e.options.active=!0,this.activeLayer=e}removeLayers(e){if(e&&e.length>0){this.layersChecked=[];for(const t of e)!1!==t.options.removable?t.map.removeLayer(t):this.layersChecked.push(t)}else e||!1===this.activeLayer.options.removable||(this.activeLayer.map.removeLayer(this.activeLayer),this.layerTool=!1)}toggleVisibility(e){if(e&&e.length>0)for(const t of e)t.visible=this.hideSelectedLayers;this.layerItemChangeDetection$.next(!0)}isLayerRemovable(e){return!1!==e.options.removable}isAllLayersRemovable(e){return e.every(e=>this.isLayerRemovable(e))}get statusSelectedLayersCheck(){let e=ru.NULL,t=!1,o=!1;if(0===this.layersChecked.length)e=ru.NULL;else{e=ru.MIXED,this.hideSelectedLayers=!1;for(const e of this.layersChecked)!0===e.visible&&(t=!0),!1===e.visible&&(o=!0);!0===t&&!1===o&&(e=ru.ALL_VISIBLE),!1===t&&!0===o&&(e=ru.ALL_HIDDEN,this.hideSelectedLayers=!0)}return e}layersCheck(e){if(e.layer.options.check=e.check,!0===e.check){const t=this.layers.findIndex(t=>e.layer.id===t.id);for(const o of this.layersChecked)if(t<this.layers.findIndex(e=>o.id===e.id))return this.layersChecked.splice(this.layersChecked.findIndex(e=>o.id===e.id),0,e.layer),void(this.excludeBaseLayers?this.selectAllCheck=this.layersChecked.length===this.layers.filter(e=>!0!==e.baseLayer&&e.showInLayerList).length:this.excludeBaseLayers||(this.selectAllCheck=this.layersChecked.length===this.layers.filter(e=>e.showInLayerList).length));this.layersChecked.push(e.layer)}else{const t=this.layersChecked.findIndex(t=>e.layer.id===t.id);this.layersChecked.splice(t,1)}this.excludeBaseLayers?this.selectAllCheck=this.layersChecked.length===this.layers.filter(e=>!0!==e.baseLayer&&e.showInLayerList).length:this.excludeBaseLayers||(this.selectAllCheck=this.layersChecked.length===this.layers.filter(e=>e.showInLayerList).length)}toggleSelectionMode(e){if(this.selection=e,this.activeLayer=void 0,!0===e){this.layerTool=!1;for(const e of this.layers)e.options.check&&this.layersChecked.push(e)}}layersCheckedOpacity(){if(this.layersChecked.length>1)return 1;{const e=[];for(const t of this.layersChecked)e.push(t.opacity);return e}}selectAll(){if(this.selectAllCheck){for(const e of this.layers)e.options.check=!1;this.layersChecked=[],this.selectAllCheck$.next(!1)}else{for(const e of this.layers)(this.excludeBaseLayers&&!0!==e.baseLayer&&e.showInLayerList||!this.excludeBaseLayers&&e.showInLayerList)&&(e.options.check=!0,this.layersChecked.push(e));this.selectAllCheck$.next(!0)}}isScrolledIntoView(e,t){const o=e.scrollTop,i=t.offsetTop;return i+t.clientHeight<=o+e.clientHeight&&i>=o}computeElementRef(e){const t=this.elRef.nativeElement.getElementsByClassName("mat-checkbox-checked"),o="lower"===e?this.elRef.nativeElement.getElementsByClassName("mat-checkbox-checked")[t.length-1]:this.elRef.nativeElement.getElementsByClassName("mat-checkbox-checked")[0];return[this.elRef.nativeElement.getElementsByTagName("igo-list")[0],o]}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(i.r))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-layer-list"]],contentQueries:function(e,t,o){var r;1&e&&Object(i.Zb)(o,au,!0),2&e&&Object(i.Jc)(r=Object(i.uc)())&&(t.templateLayerToolbar=r.first)},inputs:{layersAreAllVisible:"layersAreAllVisible",ogcButton:"ogcButton",timeButton:"timeButton",map:"map",layers:"layers",floatLabel:"floatLabel",layerFilterAndSortOptions:"layerFilterAndSortOptions",excludeBaseLayers:"excludeBaseLayers",toggleLegendOnVisibilityChange:"toggleLegendOnVisibilityChange",expandLegendOfVisibleLayers:"expandLegendOfVisibleLayers",updateLegendOnResolutionChange:"updateLegendOnResolutionChange",queryBadge:"queryBadge"},outputs:{appliedFilterAndSort:"appliedFilterAndSort"},ngContentSelectors:bu,decls:8,vars:11,consts:[[3,"ngClass","navigation","selection"],["igoList",""],["floatLabel","auto",3,"layersAreAllVisible","term","onlyVisible","sortAlpha","appliedFilterAndSort","selection",4,"ngIf"],["ngFor","",3,"ngForOf"],["class","igo-layer-actions-container",3,"title",4,"ngIf"],["floatLabel","auto",3,"layersAreAllVisible","term","onlyVisible","sortAlpha","appliedFilterAndSort","selection"],["igoListItem","",3,"layer","activeLayer","orderable","lowerDisabled","raiseDisabled","queryBadge","expandLegendIfVisible","updateLegendOnResolutionChange","toggleLegendOnVisibilityChange","selectionMode","selectAll","layerCheck","changeDetection","action","checkbox",4,"ngIf"],["igoListItem","",3,"layer","activeLayer","orderable","lowerDisabled","raiseDisabled","queryBadge","expandLegendIfVisible","updateLegendOnResolutionChange","toggleLegendOnVisibilityChange","selectionMode","selectAll","layerCheck","changeDetection","action","checkbox"],[1,"igo-layer-actions-container",3,"title"],[1,"igo-layer-button-group"],["igoLayerItemToolbar","",3,"ngTemplateOutlet","ngTemplateOutletContext"],["color","primary","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",1,"opacity-button",3,"matMenuTriggerFor","matTooltip"],["matBadgeColor","primary","matBadgeSize","medium","svgIcon","opacity",3,"matBadge"],[1,"mat-menu-opacity-slider"],["opacityMenu","matMenu"],["id","opacity-menu"],["id","opacity-slider","color","primary","thumbLabel","","tickInterval","5","step","5","matTooltipShowDelay","500","tooltip-position","below",3,"min","max","value","matTooltip","input","click"],["color","primary","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",1,"up-button",3,"matTooltip","disabled","click"],["matBadgeColor","warn","matBadgeSize","medium","svgIcon","arrow-up",3,"matBadge","matBadgeHidden"],["mat-icon-button","","color","primary","tooltip-position","below","matTooltipShowDelay","500",1,"down-button",3,"matTooltip","disabled","click"],["matBadgeColor","warn","matBadgeSize","medium","svgIcon","arrow-down",3,"matBadge","matBadgeHidden"],["class","delete-button","mat-icon-button","","color","warn","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","color","warn","tooltip-position","below","matTooltipShowDelay","500",1,"delete-button",3,"matTooltip","click"],["svgIcon","delete"],["mat-stroked-button","","tooltip-position","below","matTooltipShowDelay","500",3,"disabled","matTooltip","click"],["color","primary","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",1,"opacity-button",3,"disabled","matMenuTriggerFor","matTooltip"],["svgIcon","opacity"],["id","opacity-slider","color","primary","thumbLabel","","tickInterval","5","step","5","matTooltipShowDelay","500","tooltip-position","below",3,"min","max","ngModel","matTooltip","ngModelChange","click",4,"ngIf"],["mat-icon-button","","color","primary","tooltip-position","below","matTooltipShowDelay","500",1,"eye-button",3,"disabled","matTooltip","click"],[3,"svgIcon"],["mat-icon-button","","color","warn","tooltip-position","below","matTooltipShowDelay","500",1,"delete-button",3,"disabled","matTooltip","click"],["matBadgeColor","warn","matBadgeSize","medium","svgIcon","delete",3,"matBadge","matBadgeHidden"],["id","opacity-slider","color","primary","thumbLabel","","tickInterval","5","step","5","matTooltipShowDelay","500","tooltip-position","below",3,"min","max","ngModel","matTooltip","ngModelChange","click"]],template:function(e,t){1&e&&(Object(i.Cc)(gu),Object(i.mc)(0,"igo-list",0,1),Object(i.Yc)(2,nu,1,4,"igo-layer-list-tool",2),Object(i.yc)(3,"async"),Object(i.Yc)(4,lu,1,1,"ng-template",3),Object(i.yc)(5,"async"),Object(i.lc)(),Object(i.Yc)(6,hu,21,33,"igo-panel",4),Object(i.Yc)(7,mu,32,51,"igo-panel",4)),2&e&&(Object(i.Dc)("ngClass",t.layerTool||t.selection?"igo-list-min-height":"igo-list-max-height")("navigation",!1)("selection",!1),Object(i.Tb)(2),Object(i.Dc)("ngIf",Object(i.zc)(3,7,t.showToolbar$)),Object(i.Tb)(2),Object(i.Dc)("ngForOf",Object(i.zc)(5,9,t.layers$)),Object(i.Tb)(2),Object(i.Dc)("ngIf",!t.selection&&t.layerTool&&t.activeLayer),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.selection&&t.layers.length>0))},styles:["[_nghost-%COMP%]   .igo-list-min-height[_ngcontent-%COMP%]{height:calc(100% - 91px);padding-top:8px}[_nghost-%COMP%]   .igo-list-max-height[_ngcontent-%COMP%]{padding-top:8px}mat-form-field.inputFilter[_ngcontent-%COMP%]{max-width:200px;width:calc(100% - 100px)}.igo-layer-actions-container[_ngcontent-%COMP%]{padding-left:5px;width:calc(100% - 5px)}.igo-layer-actions-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{text-align:center}#opacity-slider[_ngcontent-%COMP%]{float:left;left:10px;min-width:unset;top:10px;width:110px}.igo-layer-button-group[_ngcontent-%COMP%]{display:flex;float:right;padding-top:5px}[_nghost-%COMP%]   igo-panel[_ngcontent-%COMP%]{height:unset}#opacity-menu[_ngcontent-%COMP%]{height:50px;max-width:unset;width:132px}#opacity-menu[_ngcontent-%COMP%]   .mat-menu-content[_ngcontent-%COMP%]:not(:empty){padding-top:20px}"],changeDetection:0}),e})(),yu=(()=>{class e{constructor(e,t,o){this.mapService=t,this.route=o,this.component=e}ngOnInit(){this.layersOrResolutionChange$$=Object(I.a)([this.mapService.getMap().layers$,this.mapService.getMap().viewController.resolution$]).pipe(Object(S.a)(10)).subscribe(e=>{const t=e[0].filter(e=>!0===e.showInLayerList);this.component.layers=t,this.setLayersVisibilityStatus(t,this.component.excludeBaseLayers)})}setLayersVisibilityStatus(e,t){void 0!==this.layersVisibility$$&&(this.layersVisibility$$.unsubscribe(),this.layersVisibility$$=void 0),this.layersVisibility$$=Object(I.a)(e.filter(e=>e.baseLayer!==t).map(e=>e.visible$)).pipe(Object(j.a)(e=>e.every(Boolean))).subscribe(e=>this.component.layersAreAllVisible=e)}ngOnDestroy(){this.layersOrResolutionChange$$.unsubscribe(),void 0!==this.layersVisibility$$&&(this.layersVisibility$$.unsubscribe(),this.layersVisibility$$=void 0)}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(fu,2),Object(i.gc)(jl),Object(i.gc)(pe,8))},e.\u0275dir=Object(i.bc)({type:e,selectors:[["","igoLayerListBinding",""]]}),e})();function Ou(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"mat-slide-toggle",5),Object(i.tc)("change",(function(t){return Object(i.Nc)(e),Object(i.xc)().toggleShowAllLegends(t.checked)})),Object(i.yc)(1,"translate"),Object(i.ad)(2),Object(i.yc)(3,"translate"),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Dc)("matTooltip",Object(i.zc)(1,4,"igo.geo.layer.legend.showAll"))("checked",e.showAllLegendsValue)("labelPosition","before"),Object(i.Tb)(2),Object(i.cd)(" ",Object(i.zc)(3,6,"igo.geo.layer.legend.showAll"),"\n")}}function vu(e,t){1&e&&Object(i.hc)(0,"mat-divider")}function ju(e,t){if(1&e&&Object(i.hc)(0,"igo-layer-legend-item",7),2&e){const e=Object(i.xc)().$implicit,t=Object(i.xc)();Object(i.Dc)("layer",e)("updateLegendOnResolutionChange",t.updateLegendOnResolutionChange)}}function wu(e,t){if(1&e&&Object(i.Yc)(0,ju,1,2,"igo-layer-legend-item",6),2&e){const e=t.$implicit,o=Object(i.xc)();Object(i.Dc)("ngIf",!(o.excludeBaseLayers&&e.baseLayer))}}function Su(e,t){1&e&&(Object(i.mc)(0,"p",8),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()),2&e&&(Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(2,1,"igo.geo.layer.legend.noLayersVisibleWithShowAllButton")," "))}function xu(e,t){1&e&&(Object(i.mc)(0,"p",8),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()),2&e&&(Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(2,1,"igo.geo.layer.legend.noLayersVisibleWithShowAllButtonButZoom")," "))}function Cu(e,t){1&e&&(Object(i.mc)(0,"p",8),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()),2&e&&(Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(2,1,"igo.geo.layer.legend.noLayersVisible")," "))}function Tu(e,t){1&e&&(Object(i.mc)(0,"p",8),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()),2&e&&(Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(2,1,"igo.geo.layer.legend.noLayersVisibleButZoom")," "))}let Lu=(()=>{class e{constructor(){this.orderable=!0,this.hasVisibleOrInRangeLayers$=new C.a(!0),this.hasVisibleAndNotInRangeLayers$=new C.a(!0),this.layersInUi$=new C.a([]),this.layers$=new C.a([]),this.showAllLegend=!1,this.change$=new Se.a(1),this.excludeBaseLayers=!1,this.updateLegendOnResolutionChange=!1,this.allowShowAllLegends=!1,this.showAllLegendsValue=!1,this.allLegendsShown=new i.u(!1)}set layers(e){this._layers=e,this.next()}get layers(){return this._layers}ngOnInit(){this.change$$=this.change$.pipe(Object(ia.a)(()=>0===this.layers.length?Qs.a:Object(Js.a)(50))).subscribe(()=>{const e=this.computeShownLayers(this.layers.slice(0));this.layers$.next(e),this.hasVisibleOrInRangeLayers$.next(this.layers.slice(0).filter(e=>!0!==e.baseLayer).filter(e=>e.visible$.value&&e.isInResolutionsRange$.value).length>0),this.hasVisibleAndNotInRangeLayers$.next(this.layers.slice(0).filter(e=>!0!==e.baseLayer).filter(e=>e.visible$.value&&!e.isInResolutionsRange$.value).length>0),this.layersInUi$.next(this.layers.slice(0).filter(e=>!(!1===e.showInLayerList||this.excludeBaseLayers&&e.baseLayer)))})}ngOnDestroy(){this.change$$.unsubscribe()}next(){this.change$.next()}computeShownLayers(e){let t=e.filter(e=>e.visible&&e.isInResolutionsRange);return this.showAllLegendsValue&&(t=e),this.sortLayersByZindex(t)}sortLayersByZindex(e){return e.sort((e,t)=>t.zIndex-e.zIndex)}toggleShowAllLegends(e){this.showAllLegendsValue=e,this.next(),this.allLegendsShown.emit(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-layer-legend-list"]],inputs:{layers:"layers",excludeBaseLayers:"excludeBaseLayers",updateLegendOnResolutionChange:"updateLegendOnResolutionChange",allowShowAllLegends:"allowShowAllLegends",showAllLegendsValue:"showAllLegendsValue"},outputs:{allLegendsShown:"allLegendsShown"},decls:23,vars:39,consts:[["tooltip-position","above","matTooltipShowDelay","500","class","mat-typography",3,"matTooltip","checked","labelPosition","change",4,"ngIf"],[4,"ngIf"],[3,"navigation","selection"],["ngFor","",3,"ngForOf"],["class","layers-empty mat-typography",4,"ngIf"],["tooltip-position","above","matTooltipShowDelay","500",1,"mat-typography",3,"matTooltip","checked","labelPosition","change"],["igoListItem","",3,"layer","updateLegendOnResolutionChange",4,"ngIf"],["igoListItem","",3,"layer","updateLegendOnResolutionChange"],[1,"layers-empty","mat-typography"]],template:function(e,t){1&e&&(Object(i.Yc)(0,Ou,4,8,"mat-slide-toggle",0),Object(i.yc)(1,"async"),Object(i.Yc)(2,vu,1,0,"mat-divider",1),Object(i.yc)(3,"async"),Object(i.mc)(4,"igo-list",2),Object(i.Yc)(5,wu,1,1,"ng-template",3),Object(i.yc)(6,"async"),Object(i.lc)(),Object(i.Yc)(7,Su,3,3,"p",4),Object(i.yc)(8,"async"),Object(i.yc)(9,"async"),Object(i.yc)(10,"async"),Object(i.Yc)(11,xu,3,3,"p",4),Object(i.yc)(12,"async"),Object(i.yc)(13,"async"),Object(i.yc)(14,"async"),Object(i.Yc)(15,Cu,3,3,"p",4),Object(i.yc)(16,"async"),Object(i.yc)(17,"async"),Object(i.yc)(18,"async"),Object(i.Yc)(19,Tu,3,3,"p",4),Object(i.yc)(20,"async"),Object(i.yc)(21,"async"),Object(i.yc)(22,"async")),2&e&&(Object(i.Dc)("ngIf",Object(i.zc)(1,9,t.layersInUi$).length&&t.allowShowAllLegends),Object(i.Tb)(2),Object(i.Dc)("ngIf",Object(i.zc)(3,11,t.layersInUi$).length&&t.allowShowAllLegends),Object(i.Tb)(2),Object(i.Dc)("navigation",!1)("selection",!1),Object(i.Tb)(1),Object(i.Dc)("ngForOf",Object(i.zc)(6,13,t.layers$)),Object(i.Tb)(2),Object(i.Dc)("ngIf",!t.showAllLegendsValue&&Object(i.zc)(8,15,t.layersInUi$).length&&!Object(i.zc)(9,17,t.hasVisibleOrInRangeLayers$)&&!Object(i.zc)(10,19,t.hasVisibleAndNotInRangeLayers$)&&t.allowShowAllLegends),Object(i.Tb)(4),Object(i.Dc)("ngIf",!t.showAllLegendsValue&&Object(i.zc)(12,21,t.layersInUi$).length&&!Object(i.zc)(13,23,t.hasVisibleOrInRangeLayers$)&&Object(i.zc)(14,25,t.hasVisibleAndNotInRangeLayers$)&&t.allowShowAllLegends),Object(i.Tb)(4),Object(i.Dc)("ngIf",Object(i.zc)(16,27,t.layersInUi$).length&&!Object(i.zc)(17,29,t.hasVisibleOrInRangeLayers$)&&!Object(i.zc)(18,31,t.hasVisibleAndNotInRangeLayers$)&&!t.allowShowAllLegends),Object(i.Tb)(4),Object(i.Dc)("ngIf",Object(i.zc)(20,33,t.layersInUi$).length&&!Object(i.zc)(21,35,t.hasVisibleOrInRangeLayers$)&&Object(i.zc)(22,37,t.hasVisibleAndNotInRangeLayers$)&&!t.allowShowAllLegends))},styles:["mat-slide-toggle[_ngcontent-%COMP%]{margin:10px;width:100%}mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content{width:calc(100% - 60px)}igo-list[_ngcontent-%COMP%]{display:contents}.layers-empty[_ngcontent-%COMP%]{margin:10px;text-align:justify}"],changeDetection:0}),e})();function Iu(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",1),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.xc)().toggleTrackFeature()})),Object(i.yc)(1,"translate"),Object(i.hc)(2,"mat-icon",2),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Dc)("matTooltip",Object(i.zc)(1,2,"igo.geo.layer.trackFeature"))("color",e.color)}}let Fu=(()=>{class e{constructor(){this.trackFeature=!1,this.color="primary"}get options(){if(this.layer)return this.layer.options}ngOnInit(){this.color=this.trackFeature?"primary":"basic"}toggleTrackFeature(){this.trackFeature?(this.layer.disableTrackFeature(this.layer.options.trackFeature),this.color="basic"):(this.layer.enableTrackFeature(this.layer.options.trackFeature),this.color="primary"),this.trackFeature=!this.trackFeature}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-track-feature-button"]],inputs:{layer:"layer",trackFeature:"trackFeature"},decls:1,vars:1,consts:[["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click"],["svgIcon","crosshairs-gps"]],template:function(e,t){1&e&&Object(i.Yc)(0,Iu,3,4,"button",0),2&e&&Object(i.Dc)("ngIf",t.options.trackFeature)},directives:[m.t,n.b,h.a,c.a],pipes:[q.e],styles:[""],changeDetection:0}),e})(),Mu=(()=>{class e{static forRoot(){return{ngModule:e,providers:[Jc,Qc,ou]}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[Ve.c,ke.e,m.c,Ue.m,dn.b,f.c,c.b,n.c,hn.b,De.b,h.b,l.e,pn.b,Be.b,b.b,ie,Ai,$o,yi,zi,Fo]]}),e})(),ku=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,Be.b,n.c,c.b,l.e,h.b,Fo,ie,Ai,$o,Oc,Mu]]}),e})();function Du(e,t){if(1&e&&(Object(i.mc)(0,"mat-option",16),Object(i.ad)(1),Object(i.lc)()),2&e){const e=t.$implicit;Object(i.Dc)("matTooltip",e.url)("value",e),Object(i.Tb)(1),Object(i.cd)(" ",e.url," ")}}function Pu(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"mat-option",17),Object(i.tc)("click",(function(t){return Object(i.Nc)(e),t.stopPropagation()})),Object(i.mc)(1,"p",18),Object(i.ad)(2),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=t.$implicit;Object(i.Dc)("value",e),Object(i.Tb)(2),Object(i.bd)(e)}}const Au=function(e,t){return{value:e,email:t}};function $u(e,t){if(1&e&&(Object(i.mc)(0,"span"),Object(i.mc)(1,"p",19),Object(i.ad)(2),Object(i.lc)(),Object(i.lc)()),2&e){const e=Object(i.xc)();Object(i.Tb)(2),Object(i.bd)(e.languageService.translate.instant("igo.geo.catalog.externalProvider.unavailableWithEmail",Object(i.Hc)(1,Au,e.addedCatalog.url,e.emailAddress)))}}const Eu=function(e){return{value:e}};function Ru(e,t){if(1&e&&(Object(i.mc)(0,"span"),Object(i.mc)(1,"p",19),Object(i.ad)(2),Object(i.lc)(),Object(i.lc)()),2&e){const e=Object(i.xc)();Object(i.Tb)(2),Object(i.bd)(e.languageService.translate.instant("igo.geo.catalog.unavailable",Object(i.Gc)(1,Eu,e.addedCatalog.url)))}}let _u=(()=>{class e{constructor(e,t,o,i,r){this.formBuilder=e,this.languageService=t,this.configService=o,this.dialogRef=i,this.data=r,this.defaultAddedCatalogType="wms",this.predefinedCatalogsList$=new C.a([]),this.predefinedCatalogs=[],this.error=!1,this.store=r.store,this.predefinedCatalogs=r.predefinedCatalogs,this.error=r.error,this.addedCatalog=r.addedCatalog,this.form=this.formBuilder.group({id:["",[]],title:["",[]],url:["",[Ue.G.required]],type:[this.defaultAddedCatalogType,[Ue.G.required]]})}ngOnInit(){this.store.state.clear(),this.typeCapabilities=Object.keys(_c),this.addedCatalogType$$=this.form.get("type").valueChanges.subscribe(e=>{"wmts"===e?this.form.get("title").setValidators(Ue.G.required):this.form.get("title").setValidators([]),this.form.get("title").updateValueAndValidity()}),this.computePredefinedCatalogList(),this.storeViewAll$$=this.store.view.all$().subscribe(()=>this.computePredefinedCatalogList()),this.emailAddress=this.configService.getConfig("emailAddress")}ngOnDestroy(){this.addedCatalogType$$.unsubscribe(),this.storeViewAll$$.unsubscribe()}changeUrl(e){this.form.patchValue(e),this.error=!1,this.computePredefinedCatalogList()}computePredefinedCatalogList(){this.predefinedCatalogsList$.next(this.predefinedCatalogs.filter(e=>!this.store.get(e.id)))}addCatalog(e){this.error=!1,this.dialogRef.close(e)}cancel(){this.error=!1,this.dialogRef.close()}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(Ue.g),Object(i.gc)(le),Object(i.gc)(K),Object(i.gc)(qe.h),Object(i.gc)(qe.a,8))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-add-catalog-dialog"]],decls:30,vars:21,consts:[["mat-dialog-title","",1,"mat-typography"],["mat-dialog-content","",1,"mat-typography"],[1,"igo-form",3,"formGroup"],[1,"igo-input-container"],["type","text","formControlName","url","placeholder","URL","matInput","",3,"matAutocomplete"],[3,"optionSelected"],["auto","matAutocomplete"],["matTooltipShowDelay","500",3,"matTooltip","value",4,"ngFor","ngForOf"],["matInput","","formControlName","title",3,"placeholder"],["formControlName","type","placeholder","Type"],[3,"value","click",4,"ngFor","ngForOf"],[4,"ngIf"],["mat-dialog-actions","",2,"justify-content","center"],[1,"igo-form-button-group","add-catalog-button-top-padding"],["mat-raised-button","","type","button",3,"click"],["id","addCatalogBtnDialog","mat-raised-button","","type","button","color","primary",3,"disabled","click"],["matTooltipShowDelay","500",3,"matTooltip","value"],[3,"value","click"],["mat-line",""],[1,"error"]],template:function(e,t){if(1&e&&(Object(i.mc)(0,"h1",0),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)(),Object(i.mc)(3,"div",1),Object(i.mc)(4,"form",2),Object(i.mc)(5,"div",3),Object(i.mc)(6,"mat-form-field"),Object(i.hc)(7,"input",4),Object(i.mc)(8,"mat-autocomplete",5,6),Object(i.tc)("optionSelected",(function(e){return t.changeUrl(e.option.value)})),Object(i.Yc)(10,Du,2,3,"mat-option",7),Object(i.yc)(11,"async"),Object(i.lc)(),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(12,"div",3),Object(i.mc)(13,"mat-form-field"),Object(i.hc)(14,"input",8),Object(i.yc)(15,"translate"),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(16,"div",3),Object(i.mc)(17,"mat-form-field"),Object(i.mc)(18,"mat-select",9),Object(i.Yc)(19,Pu,3,2,"mat-option",10),Object(i.lc)(),Object(i.lc)(),Object(i.lc)(),Object(i.lc)(),Object(i.Yc)(20,$u,3,4,"span",11),Object(i.Yc)(21,Ru,3,3,"span",11),Object(i.lc)(),Object(i.mc)(22,"div",12),Object(i.mc)(23,"div",13),Object(i.mc)(24,"button",14),Object(i.tc)("click",(function(){return t.cancel()})),Object(i.ad)(25),Object(i.yc)(26,"translate"),Object(i.lc)(),Object(i.mc)(27,"button",15),Object(i.tc)("click",(function(){return t.addCatalog(t.form.value)})),Object(i.ad)(28),Object(i.yc)(29,"translate"),Object(i.lc)(),Object(i.lc)(),Object(i.lc)()),2&e){const e=Object(i.Kc)(9);Object(i.Tb)(1),Object(i.bd)(Object(i.zc)(2,11,"igo.geo.catalog.library.addTitle")),Object(i.Tb)(3),Object(i.Dc)("formGroup",t.form),Object(i.Tb)(3),Object(i.Dc)("matAutocomplete",e),Object(i.Tb)(3),Object(i.Dc)("ngForOf",Object(i.zc)(11,13,t.predefinedCatalogsList$)),Object(i.Tb)(4),Object(i.Ec)("placeholder",Object(i.zc)(15,15,"igo.geo.printForm.title")),Object(i.Tb)(5),Object(i.Dc)("ngForOf",t.typeCapabilities),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.error&&t.addedCatalog&&t.emailAddress),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.error&&t.addedCatalog&&!t.emailAddress),Object(i.Tb)(4),Object(i.cd)(" ",Object(i.zc)(26,17,"igo.geo.catalog.library.cancel")," "),Object(i.Tb)(2),Object(i.Dc)("disabled",!t.form.valid),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(29,19,"igo.geo.catalog.library.add")," ")}},directives:[qe.i,qe.f,Ue.I,Ue.t,Ue.k,ke.c,Ue.d,Ve.b,mn.d,Ue.s,Ue.j,mn.a,m.s,De.a,m.t,qe.c,n.b,Pe.p,h.a,Pe.l],pipes:[q.e,m.b],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}.add-catalog-button-top-padding[_ngcontent-%COMP%]{padding-top:25px}.igo-form[_ngcontent-%COMP%]{padding:10px 5px 5px}.igo-form-button-group[_ngcontent-%COMP%]{text-align:center}button[_ngcontent-%COMP%]{cursor:pointer}button#addCatalogBtnDialog[disabled=true][_ngcontent-%COMP%]{background-color:rgba(0,0,0,.12);color:rgba(0,0,0,.26);cursor:default}.error[_ngcontent-%COMP%]{color:red}"]}),e})();function zu(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"igo-catalog-library-item",3),Object(i.tc)("catalogRemove",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)().onCatalogRemove(o)}))("select",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)().onCatalogSelect(o)})),Object(i.lc)()}if(2&e){const e=t.$implicit,o=Object(i.xc)();Object(i.Dc)("map",o.map)("catalog",e)}}function Nu(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"div",4),Object(i.mc)(1,"button",5),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.xc)().addCatalogDialog()})),Object(i.yc)(2,"translate"),Object(i.ad)(3),Object(i.yc)(4,"translate"),Object(i.hc)(5,"mat-icon",6),Object(i.lc)(),Object(i.lc)()}2&e&&(Object(i.Tb)(1),Object(i.Dc)("matTooltip",Object(i.zc)(2,2,"igo.geo.catalog.library.addBtn")),Object(i.Tb)(2),Object(i.cd)(" ",Object(i.zc)(4,4,"igo.geo.catalog.library.addBtn")," "))}let Bu=(()=>{class e{constructor(e,t,o,r,s){this.capabilitiesService=e,this.messageService=t,this.languageService=o,this.storageService=r,this.dialog=s,this.addCatalogAllowed=!1,this.predefinedCatalogs=[],this.catalogSelectChange=new i.u,this.submitDisabled=!0}get addedCatalogs(){return this.storageService.get("addedCatalogs")||[]}set addedCatalogs(e){this.storageService.set("addedCatalogs",e)}ngOnInit(){this.store.state.clear(),this.predefinedCatalogs=this.predefinedCatalogs.map(e=>(e.id=ws.Md5.hashStr((e.type||"wms")+Qn(e.url)),e))}getCatalogs(){return this.store.view.all$()}onCatalogSelect(e){this.store.state.update(e,{selected:!0,focused:!0},!0),this.catalogSelectChange.emit({selected:!0,catalog:e})}unsubscribeAddingCatalog(){this.addingCatalog$$&&this.addingCatalog$$.unsubscribe()}addCatalog(e){if(!e)return;let t=ws.Md5.hashStr(e.type+Qn(e.url));const o=this.predefinedCatalogs.find(t=>t.id===e.id);if(o&&(e.externalProvider=o.externalProvider,t=o.id),this.store.get(t)){const e=this.languageService.translate.instant("igo.geo.catalog.library.inlist.title"),t=this.languageService.translate.instant("igo.geo.catalog.library.inlist.message");this.messageService.alert(t,e)}else this.unsubscribeAddingCatalog(),this.addingCatalog$$=this.capabilitiesService.getCapabilities(_c[e.type],e.url).pipe(Object(v.a)(t=>{const o=this.languageService.translate.instant("igo.geo.catalog.unavailableTitle");if(t.error)return this.addCatalogDialog(!0,e),t.error.caught=!0,t;const i=this.languageService.translate.instant("igo.geo.catalog.unavailable",{value:e.url});throw this.messageService.error(i,o),t})).subscribe(o=>{let i;switch(e.type){case"wms":i=e.title||o.Service.Title;break;case"arcgisrest":case"imagearcgisrest":case"tilearcgisrest":i=e.title||o.mapName;break;case"wmts":i=e.title||o.ServiceIdentification.ServiceType;break;default:i=e.title}const r={id:t,title:i,url:e.url,type:e.type||"wms",externalProvider:e.externalProvider||!1,removable:!0};this.store.insert(r);const s=this.addedCatalogs.slice(0);s.push(r),this.addedCatalogs=s,this.unsubscribeAddingCatalog()})}ngOnDestroy(){this.unsubscribeAddingCatalog()}onCatalogRemove(e){this.store.delete(e),this.addedCatalogs=this.addedCatalogs.slice(0).filter(t=>t.id!==e.id)}addCatalogDialog(e,t){this.dialog.open(_u,{width:"700px",data:{predefinedCatalogs:this.predefinedCatalogs,store:this.store,error:e,addedCatalog:t}}).afterClosed().subscribe(e=>{this.addCatalog(e)})}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(zc),Object(i.gc)(ce),Object(i.gc)(le),Object(i.gc)(Oe),Object(i.gc)(qe.b))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-catalog-library"]],inputs:{store:"store",map:"map",addCatalogAllowed:"addCatalogAllowed",predefinedCatalogs:"predefinedCatalogs"},outputs:{catalogSelectChange:"catalogSelectChange"},decls:4,vars:5,consts:[[3,"navigation"],["ngFor","",3,"ngForOf"],["class","btnAddCatalog",4,"ngIf"],["igoListItem","","color","accent",3,"map","catalog","catalogRemove","select"],[1,"btnAddCatalog"],["mat-raised-button","","matTooltipPosition","above","color","primary",3,"matTooltip","click"],["svgIcon","earth-plus"]],template:function(e,t){1&e&&(Object(i.mc)(0,"igo-list",0),Object(i.Yc)(1,zu,1,2,"ng-template",1),Object(i.yc)(2,"async"),Object(i.lc)(),Object(i.Yc)(3,Nu,6,6,"div",2)),2&e&&(Object(i.Dc)("navigation",!1),Object(i.Tb)(1),Object(i.Dc)("ngForOf",Object(i.zc)(2,3,t.getCatalogs())),Object(i.Tb)(2),Object(i.Dc)("ngIf",t.addCatalogAllowed))},styles:["igo-list[_ngcontent-%COMP%]{height:auto}.btnAddCatalog[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:30px 0}"],changeDetection:0}),e})(),qu=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,c.b,Be.b,l.e,h.b,Ai,ie,n.c,ke.e,Ue.C,Ve.c,De.b,mn.b,qe.g]]}),e})(),Gu=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,Be.b,c.b,l.e,h.b,Fo,Ai,$o],ku,qu]}),e})(),Vu=(()=>{class e{constructor(){}filterByDate(e,t){let o,i,r,s;if(Array.isArray(t)){const i=[];t[0]&&(r=this.reformatDateTime(t[0]),i.push(t[0])),t[1]&&(s=this.reformatDateTime(t[1]),i.push(t[1])),2===i.length&&r!==s&&(o=e instanceof Mc?r+","+s:r+"/"+s),r===s&&(o=r)}else t&&(i=this.reformatDateTime(t),o=i);e.ol.updateParams({TIME:o}),e instanceof uc&&e.setTimeFilter(e.timeFilter,!0)}filterByYear(e,t){let o,i,r;if(Array.isArray(t)){const s=[];t[0]&&(i=t[0],s.push(t[0])),t[1]&&(r=t[1],s.push(t[1])),2===s.length&&i!==r&&(o=e instanceof Mc?i+","+r:i+"/"+r),i===r&&(o=i)}else o=t;e.ol.updateParams({TIME:o}),e instanceof uc&&e.setTimeFilter(e.timeFilter,!0)}reformatDateTime(e){const t=e.getFullYear();let o=e.getMonth()+1,i=e.getUTCDate(),r=e.getUTCHours(),s=e.getUTCMinutes();return Number(o)<10&&(o="0"+o),Number(i)<10&&(i="0"+i),Number(r)<10&&(r="0"+r),Number(s)<10&&(s="0"+s),t+"-"+o+"-"+i+"T"+r+":"+s+":00Z"}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac}),e})(),Uu=(()=>{class e{constructor(){}filterByOgc(e,t){const o=(new oc).formatProcessedOgcFilter(t,e.options.params.LAYERS);e.ol.updateParams({FILTER:o})}setOgcWFSFiltersOptions(e){const t=e.options,o=new oc;t.ogcFilters.enabled&&t.ogcFilters.filters&&(t.ogcFilters.filters=o.checkIgoFiltersProperties(t.ogcFilters.filters,t.paramsWFS.fieldNameGeometry,new wa.a({code:t.paramsWFS.srsName}),!0),t.ogcFilters.interfaceOgcFilters||(t.ogcFilters.interfaceOgcFilters=o.defineInterfaceFilterSequence(t.ogcFilters.filters,t.paramsWFS.fieldNameGeometry)))}setOgcWMSFiltersOptions(e){const t=e.options,o=new oc;t.ogcFilters.enabled&&t.ogcFilters.filters?(t.ogcFilters.filters=o.checkIgoFiltersProperties(t.ogcFilters.filters,t.fieldNameGeometry,void 0,!0),t.ogcFilters.interfaceOgcFilters||(t.ogcFilters.interfaceOgcFilters=o.defineInterfaceFilterSequence(t.ogcFilters.filters,t.fieldNameGeometry)),this.filterByOgc(e,o.buildFilter(t.ogcFilters.filters,void 0,void 0,void 0,e.options)),t.filtered=!0):(t.ogcFilters.filters=void 0,t.ogcFilters.interfaceOgcFilters=[],t.filtered=!1)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac}),e})();var Hu=function(e){return e.Predefined="Predefined",e.Polygon="Polygon",e.Point="Point",e}({}),Yu=function(e){return e.Address="Address",e.Thematics="Thematics",e}({});let Wu=(()=>{class e{constructor(e,t,o){this.http=e,this.languageService=t,this.configService=o,this.baseUrl="https://geoegl.msp.gouv.qc.ca/apis/terrapi/",this.urlFilterList={AdmRegion:"regadmin",Arrond:"arrondissements",CircFed:"circ-fed",CircProv:"circ-prov",DirReg:"dir-reg",MRC:"mrc",Mun:"municipalites",RegTour:"tourisme",bornes:"bornes-sumi",hydro:"hydro",routes:"routes"},this.baseUrl=this.configService.getConfig("spatialFilter.url")||this.baseUrl}getKeyByValue(e,t){return Object.keys(e).find(o=>e[o]===t)}loadFilterList(e){if(e)return this.http.get(this.baseUrl+this.urlFilterList[e]).pipe(Object(j.a)(e=>e.features.map(e=>(e.meta={id:e.properties.code},e))))}loadThematicsList(){const e=[];return this.http.get(this.baseUrl+"types").pipe(Object(j.a)(t=>(t.forEach(t=>{if(t.startsWith("lieux")){const i={name:void 0,source:t};let r=t.substring(6,t.length),s=r;if(r.includes(".")){const e=r.indexOf(".");s=r.substring(e+1,r.length),r=r.substring(0,e)}try{i.name=this.languageService.translate.instant("igo.geo.terrapi."+s)}catch(o){i.name=s.substring(0,1).toUpperCase()+s.substring(1,s.length-1)}try{i.group=this.languageService.translate.instant("igo.geo.spatialFilter.group."+r)}catch(o){i.group=r.substring(0,1).toUpperCase()+r.substring(1,s.length-1)}e.push(i)}else if(this.getKeyByValue(this.urlFilterList,t)){const i={name:void 0,source:t},r=this.getKeyByValue(this.urlFilterList,t);try{i.name=this.languageService.translate.instant("igo.geo.terrapi."+r)}catch(o){i.name=r.substring(0,1).toUpperCase()+r.substring(1,r.length-1)}i.source=t,e.push(i)}}),e)))}loadFilterItem(e,t,o,i,r){if(o){const s=this.baseUrl+this.urlFilterList[o];let a="";return t===Yu.Address?(a="adresses",this.http.get(s+"/"+e.properties.code+"/"+a,{params:{geometry:"true",icon:"true",bufferInput:r.toString(),simplified:"100"}}).pipe(Object(j.a)(e=>e.features.map(e=>(e.meta={id:e.properties.code,title:this.languageService.translate.instant("igo.geo.spatialFilter.Address"),icon:e.icon},e))))):(a=i.source,this.http.get(s+"/"+e.properties.code+"/"+a,{params:{geometry:"true",icon:"true",bufferInput:r.toString(),simplified:"100"}}).pipe(Object(j.a)(e=>e.features.map(e=>(e.meta={id:e.properties.code,title:i.name,icon:e.icon},e)))))}{const o=this.baseUrl+"locate";return t===Yu.Address?this.http.post(o+"?type=adresses",{geometry:"true",icon:"true",loc:JSON.stringify(e),bufferInput:r.toString(),simplified:"100"}).pipe(Object(j.a)(e=>e.features.map(e=>(e.meta={id:e.properties.code,title:this.languageService.translate.instant("igo.geo.spatialFilter.Address"),icon:e.icon},e)))):this.http.post(o+"?type="+i.source,{geometry:"true",icon:"true",loc:JSON.stringify(e),bufferInput:r.toString(),simplified:"100"}).pipe(Object(j.a)(e=>e.features.map(e=>(e.meta={id:e.properties.code,title:i.name,icon:e.icon},e))))}}loadItemById(e,t){const o=this.urlFilterList[t],i="/"+e.properties.code;if(o&&i)return this.http.get(this.baseUrl+o+i,{params:{geometry:"true"}}).pipe(Object(j.a)(e=>(e.meta={id:e.properties.code,alias:e.properties.nom,title:e.properties.nom},e)))}loadBufferGeometry(e,t,o,i){if(t!==Hu.Predefined)return this.http.post(this.baseUrl+"geospatial/buffer?",{buffer:o,loc:JSON.stringify(e)}).pipe(Object(j.a)(e=>e));{const t=this.urlFilterList[i],r="/"+e.properties.code;if(t&&r)return this.http.get(this.baseUrl+t+r,{params:{geometry:"100",bufferOutput:o.toString()}}).pipe(Object(j.a)(e=>(e.meta={id:e.properties.code,alias:e.properties.nom,title:e.properties.nom},e)))}}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(y.b),Object(i.qc)(le),Object(i.qc)(K))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Ku=(()=>{class e{constructor(e,t){this.messageService=e,this.languageService=t}open(e){const t=this.languageService.translate,o=t.instant("igo.geo.download.title");this.messageService.success(t.instant("igo.geo.download.start"),o);const i=e.dataSource.options;if(Object.keys(i.download).length>0)if(i.download.dynamicUrl&&void 0===i.download.url){let t,o=new wa.a({code:e.map.projection});const r=e.dataSource.options.paramsWFS;r&&Object.keys(r).length>0?(o=r.srsName?new wa.a({code:r.srsName}):o,t=e.dataSource.options.paramsWFS):t=e.dataSource.options.params;const s=Object(sa.t)(e.map.viewController.getExtent(),new wa.a({code:e.map.projection}),o),a=void 0===t.outputFormatDownload?void 0===t.outputFormat?"":"outputformat="+t.outputFormat:"outputformat="+t.outputFormatDownload,n=i.download.dynamicUrl.replace(/&?outputformat=[^&]*/gi,"").replace(/&?filter=[^&]*/gi,"").replace(/&?bbox=[^&]*/gi,""),c=e.dataSource.options.ogcFilters;let l;l=(new oc).handleOgcFiltersAppliedValue(e.dataSource.options,c.geometryName,s,o),l=l?"filter="+encodeURIComponent(l):(new oc).buildFilter(void 0,s,o,c.geometryName),window.open(`${n}&${l}&${a}`,"_blank")}else i.download&&window.open(i.download.url,"_blank")}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(ce),Object(i.qc)(le))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Zu(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",1),Object(i.tc)("click",(function(){Object(i.Nc)(e);const t=Object(i.xc)();return t.openDownload(t.layer)})),Object(i.yc)(1,"translate"),Object(i.hc)(2,"mat-icon",2),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Dc)("matTooltip",Object(i.zc)(1,2,"igo.geo.download.action"))("color",e.color)}}let Qu=(()=>{class e{constructor(e){this.downloadService=e,this._color="primary"}get layer(){return this._layer}set layer(e){this._layer=e}get color(){return this._color}set color(e){this._color=e}openDownload(e){this.downloadService.open(e)}get options(){if(this.layer)return this.layer.dataSource.options}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(Ku))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-download-button"]],inputs:{layer:"layer",color:"color"},decls:1,vars:1,consts:[["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click"],["svgIcon","download"]],template:function(e,t){1&e&&Object(i.Yc)(0,Zu,3,4,"button",0),2&e&&Object(i.Dc)("ngIf",t.options&&t.options.download&&(t.options.download.dynamicUrl||t.options.download.url))},directives:[m.t,n.b,h.a,c.a],pipes:[q.e],styles:[""],changeDetection:0}),e})(),Ju=(()=>{class e{static forRoot(){return{ngModule:e}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,c.b,n.c,h.b,ie]]}),e})();function Xu(e,t){if(1&e&&(Object(i.mc)(0,"td"),Object(i.hc)(1,"mat-icon",7),Object(i.lc)()),2&e){const e=Object(i.xc)(3);Object(i.Tb)(1),Object(i.Ec)("svgIcon",e.icon)}}function ed(e,t){if(1&e&&(Object(i.mc)(0,"td"),Object(i.mc)(1,"a",8),Object(i.ad)(2),Object(i.yc)(3,"translate"),Object(i.lc)(),Object(i.lc)()),2&e){const e=Object(i.xc)().$implicit,t=Object(i.xc)(2);Object(i.Tb)(1),Object(i.Ec)("href",e.value,i.Qc),Object(i.Tb)(1),Object(i.dd)(" ",Object(i.zc)(3,3,"igo.geo.targetHtmlUrl")," ",t.title,"")}}function td(e,t){if(1&e&&(Object(i.mc)(0,"td",9),Object(i.ad)(1),Object(i.lc)()),2&e){const e=Object(i.xc)().$implicit;Object(i.Tb)(1),Object(i.cd)(" ",e.key," ")}}function od(e,t){if(1&e&&Object(i.hc)(0,"td",10),2&e){const e=Object(i.xc)().$implicit;Object(i.Dc)("innerHTML",e.value,i.Oc)}}function id(e,t){if(1&e&&(Object(i.hc)(0,"img",13),Object(i.yc)(1,"async"),Object(i.yc)(2,"secureImage")),2&e){const e=Object(i.xc)(2).$implicit;Object(i.Ec)("src",Object(i.zc)(1,1,Object(i.zc)(2,3,e.value)),i.Qc)}}function rd(e,t){1&e&&(Object(i.mc)(0,"span"),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()),2&e&&(Object(i.Tb)(1),Object(i.cd)("",Object(i.zc)(2,1,"igo.geo.targetHtmlUrl")," "))}function sd(e,t){if(1&e&&(Object(i.mc)(0,"td"),Object(i.mc)(1,"a",8),Object(i.Yc)(2,id,3,5,"img",11),Object(i.Yc)(3,rd,3,3,"ng-template",null,12,i.Zc),Object(i.lc)(),Object(i.lc)()),2&e){const e=Object(i.Kc)(4),t=Object(i.xc)().$implicit,o=Object(i.xc)(2);Object(i.Tb)(1),Object(i.Ec)("href",t.value,i.Qc),Object(i.Tb)(1),Object(i.Dc)("ngIf",o.isImg(t.value))("ngIfElse",e)}}function ad(e,t){if(1&e&&(Object(i.hc)(0,"td",10),Object(i.yc)(1,"json")),2&e){const e=Object(i.xc)().$implicit;Object(i.Dc)("innerHTML",Object(i.zc)(1,1,e.value),i.Oc)}}function nd(e,t){if(1&e&&(Object(i.mc)(0,"tr"),Object(i.Yc)(1,Xu,2,1,"td",4),Object(i.Yc)(2,ed,4,5,"td",4),Object(i.Yc)(3,td,2,1,"td",5),Object(i.Yc)(4,od,1,1,"td",6),Object(i.Yc)(5,sd,5,3,"td",4),Object(i.Yc)(6,ad,2,3,"td",6),Object(i.lc)()),2&e){const e=t.$implicit,o=Object(i.xc)(2);Object(i.Tb)(1),Object(i.Dc)("ngIf","_blank"===o.feature.properties.target&&"url"===e.key),Object(i.Tb)(1),Object(i.Dc)("ngIf","_blank"===o.feature.properties.target&&"url"===e.key),Object(i.Tb)(1),Object(i.Dc)("ngIf",void 0===o.feature.properties.target),Object(i.Tb)(1),Object(i.Dc)("ngIf",void 0===o.feature.properties.target&&!o.isObject(e.value)&&!o.isUrl(e.value)),Object(i.Tb)(1),Object(i.Dc)("ngIf",void 0===o.feature.properties.target&&!o.isObject(e.value)&&o.isUrl(e.value)),Object(i.Tb)(1),Object(i.Dc)("ngIf",void 0===o.feature.properties.target&&o.isObject(e.value))}}function cd(e,t){if(1&e&&(Object(i.mc)(0,"table",2),Object(i.mc)(1,"tbody"),Object(i.Yc)(2,nd,7,6,"tr",3),Object(i.yc)(3,"keyvalue"),Object(i.lc)(),Object(i.lc)()),2&e){const e=Object(i.xc)();Object(i.Tb)(2),Object(i.Dc)("ngForOf",Object(i.zc)(3,1,e.filterFeatureProperties(e.feature)))}}function ld(e,t){if(1&e&&Object(i.hc)(0,"iframe",14),2&e){const e=Object(i.xc)();Object(i.Dc)("srcdoc",e.htmlSanitizer(e.feature.properties),i.Oc)("src",e.urlSanitizer(e.feature.properties.url),i.Pc)}}let ud=(()=>{class e{constructor(e,t,o){this.cdRef=e,this.sanitizer=t,this.networkService=o,this.unsubscribe$=new k.a,this.ready=!1,this.routeEvent=new i.u,this.selectFeature=new i.u,this.htmlDisplayEvent=new i.u,this.networkService.currentState().pipe(Object(ra.a)(this.unsubscribe$)).subscribe(e=>{this.state=e})}get source(){return this._source}set source(e){this._source=e,this.cdRef.detectChanges()}get feature(){return this._feature}set feature(e){this._feature=e,this.cdRef.detectChanges(),this.selectFeature.emit()}get title(){return ot(this.feature)}get icon(){return it(this.feature)||"link"}ngOnInit(){this.ready=!0}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}urlSanitizer(e){return this.sanitizer.bypassSecurityTrustResourceUrl(e)}isHtmlDisplay(){return this.feature&&this.isObject(this.feature.properties)&&"iframe"===this.feature.properties.target?(this.htmlDisplayEvent.emit(!0),!0):(this.htmlDisplayEvent.emit(!1),!1)}htmlSanitizer(e){if(e.body&&"Internet Explorer"!==A.getBrowserName()){if(!/<base href="[\w:\/\.]+">/.test(e.body)){const t=new URL(e.url);e.body=e.body.replace("<head>",`<head><base href="${t.origin}">`)}return this.sanitizer.bypassSecurityTrustHtml(e.body)}}isObject(e){return"object"==typeof e}isUrl(e){return"string"==typeof e&&("https://"===e.slice(0,8)||"http://"===e.slice(0,7))}isImg(e){return!!this.isUrl(e)&&["jpg","png","gif"].includes(e.split(".").pop().toLowerCase())}filterFeatureProperties(e){const t=e.meta?e.meta.alias:void 0,o={};let i;return this.map&&this.map.offlineButtonToggle$.pipe(Object(ra.a)(this.unsubscribe$)).subscribe(e=>{i=e}),e.properties&&e.properties.Route&&this.toolbox&&!this.toolbox.getTool("directions")&&delete e.properties.Route,t?(Object.keys(t).forEach(i=>{o[t[i]]=e.properties[i]}),o):(void 0!==i&&i?e.meta&&e.meta.excludeAttributeOffline&&e.meta.excludeAttributeOffline.forEach(t=>{delete e.properties[t]}):this.state.connection&&e.meta&&e.meta.excludeAttribute?e.meta.excludeAttribute.forEach(t=>{delete e.properties[t]}):!this.state.connection&&e.meta&&e.meta.excludeAttributeOffline&&e.meta.excludeAttributeOffline.forEach(t=>{delete e.properties[t]}),e.properties)}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(i.j),Object(i.gc)(s.b),Object(i.gc)(ve))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-feature-details"]],inputs:{source:"source",map:"map",toolbox:"toolbox",feature:"feature"},outputs:{routeEvent:"routeEvent",selectFeature:"selectFeature",htmlDisplayEvent:"htmlDisplayEvent"},decls:2,vars:2,consts:[["class","igo-striped mat-typography",4,"ngIf"],[3,"srcdoc","src",4,"ngIf"],[1,"igo-striped","mat-typography"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","keyValue",4,"ngIf"],[3,"innerHTML",4,"ngIf"],["mat-list-avatar","",3,"svgIcon"],["target","_blank","rel","noopener noreferrer",3,"href"],["id","keyValue"],[3,"innerHTML"],["width","225","heigth","auto",3,"src",4,"ngIf","ngIfElse"],["notImg",""],["width","225","heigth","auto",3,"src"],[3,"srcdoc","src"]],template:function(e,t){1&e&&(Object(i.Yc)(0,cd,4,3,"table",0),Object(i.Yc)(1,ld,1,2,"iframe",1)),2&e&&(Object(i.Dc)("ngIf",t.ready&&t.feature&&t.isObject(t.feature.properties)&&"iframe"!==t.feature.properties.target),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.isHtmlDisplay()))},directives:[m.t,m.s,c.a],pipes:[Ii,q.e,m.b,yt,m.k],styles:["table[_ngcontent-%COMP%]{width:100%}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px}#keyValue[_ngcontent-%COMP%]{width:30%}table[_ngcontent-%COMP%]     .routing{cursor:pointer}iframe[_ngcontent-%COMP%]{border:0;height:calc(100% - 4px);width:100%}"],changeDetection:0}),e})();var dd=function(e){return e.Point="Point",e.LineString="LineString",e.Polygon="Polygon",e.Circle="Circle",e}({});function hd(){return new Ra.Style({stroke:new Ra.Stroke({color:[0,153,255,1],width:2})})}function pd(e){const t=e.target;return t instanceof tn.b?t.flatCoordinates.slice(-4,-2):t.flatCoordinates.slice(-2)}Error;class md{constructor(e){this.options=e,this.start$=new k.a,this.end$=new k.a,this.changes$=new k.a,this.freehand$=new C.a(!1),this.olOverlayLayer=void 0!==e.layer?e.layer:this.createOlInnerOverlayLayer()}get active(){return void 0!==this.olMap}get geometryType(){return this.options.geometryType}get olOverlaySource(){return this.olOverlayLayer.getSource()}setOlMap(e){if(void 0===e)return this.clearOlInnerOverlaySource(),this.removeOlInnerOverlayLayer(),this.removeOlDrawInteraction(),void(this.olMap=e);this.olMap=e,this.addOlInnerOverlayLayer(),this.addOlDrawInteraction()}getSource(){return this.olOverlaySource}createOlInnerOverlayLayer(){return new qa.a({source:this.options.source?this.options.source:new ya.a,style:this.options.layerStyle,zIndex:500})}removeOlInnerOverlayLayer(){void 0===this.options.layer&&void 0!==this.olMap&&this.olMap.removeLayer(this.olOverlayLayer)}addOlInnerOverlayLayer(){void 0===this.options.layer&&this.olMap.addLayer(this.olOverlayLayer)}clearOlInnerOverlaySource(){void 0===this.options.layer&&void 0===this.options.source&&this.olOverlaySource.clear(!0)}addOlDrawInteraction(){let e;e=!1===this.freehand$.getValue()?new fn.a({type:this.geometryType,source:this.getSource(),stopClick:!0,style:this.options.drawStyle,maxPoints:this.options.maxPoints,freehand:!1,freehandCondition:()=>!1}):new fn.a("Point"===this.geometryType?{type:"Circle",source:this.getSource(),maxPoints:this.options.maxPoints,freehand:!0}:{type:this.geometryType,source:this.getSource(),maxPoints:this.options.maxPoints,freehand:!0}),this.onDrawStartKey=e.on("drawstart",e=>this.onDrawStart(e)),this.onDrawEndKey=e.on("drawend",e=>this.onDrawEnd(e)),this.olMap.addInteraction(e),this.olDrawInteraction=e}removeOlDrawInteraction(){void 0!==this.olDrawInteraction&&(this.unsubscribeToKeyDown(),Object(Ga.b)([this.onDrawStartKey,this.onDrawEndKey,this.onDrawKey]),void 0!==this.olMap&&this.olMap.removeInteraction(this.olDrawInteraction),this.olDrawInteraction=void 0)}onDrawStart(e){const t=e.feature.getGeometry();this.start$.next(t),this.clearOlInnerOverlaySource(),this.onDrawKey=t.on("change",e=>{this.mousePosition=pd(e),this.changes$.next(e.target)}),this.subscribeToKeyDown()}onDrawEnd(e){this.unsubscribeToKeyDown(),Object(Ga.b)(this.onDrawKey),this.end$.next(e.feature.getGeometry())}subscribeToKeyDown(){this.unsubscribeToKeyDown(),this.keyDown$$=Object(F.a)(document,"keydown").subscribe(e=>{"Escape"!==e.key?" "!==e.key||this.olMap.getView().animate({center:this.mousePosition,duration:0}):this.olDrawInteraction.removeLastPoint()})}unsubscribeToKeyDown(){void 0!==this.keyDown$$&&(this.keyDown$$.unsubscribe(),this.keyDown$$=void 0)}}let gd=(()=>{class e{constructor(e){this.mapService=e,this.fillColor="rgba(255,255,255,0.4)",this.strokeColor="rgba(51,153,204,1)",this.drawCounter=1,this.toggleLabel=!0}getFill(){return this.fillColor}setFill(e){this.fillColor=e}getStroke(){return this.strokeColor}setStroke(e){this.strokeColor=e}getDrawCount(){return this.drawCounter}getToggleLabel(){return this.toggleLabel}switchLabel(){this.toggleLabel=!this.toggleLabel}raiseDrawCounter(){this.drawCounter=this.drawCounter+1}setIcon(e){this.icon=e}getIcon(){return this.icon}createDrawLayerStyle(e,t,o,i){let r,s=!1;const a=this.mapService.getMap().ol.getView().getProjection().getCode();if(e.getGeometry()instanceof on.a&&(s=!s),void 0!==e.get("radius")){const i=Object(sa.s)(e.getGeometry().flatCoordinates,a,"EPSG:4326");return r=[new Ra.Style({text:new Ra.Text({text:o?e.get("draw"):"",stroke:new Ra.Stroke({color:"white",width:.75}),fill:new Ra.Fill({color:"black"}),font:"20px sans-serif",overflow:!0}),image:new Ra.Circle({radius:e.get("radius")/Math.cos(Math.PI/180*i[1])/t,stroke:new Ra.Stroke({color:this.strokeColor}),fill:new Ra.Fill({color:this.fillColor})})})],r}return i?(r=[new Ra.Style({text:new Ra.Text({text:o?e.get("draw"):"",offsetY:-26,stroke:new Ra.Stroke({color:"white",width:.75}),fill:new Ra.Fill({color:"black"}),font:"20px sans-serif",overflow:!0}),stroke:new Ra.Stroke({color:this.strokeColor,width:2}),fill:new Ra.Fill({color:this.fillColor}),image:new Ra.Icon({src:i})})],r):(r=[new Ra.Style({text:new Ra.Text({text:o?e.get("draw"):"",stroke:new Ra.Stroke({color:"white",width:.75}),fill:new Ra.Fill({color:"black"}),font:"20px sans-serif",overflow:!0,offsetY:s?-15:0}),stroke:new Ra.Stroke({color:this.strokeColor,width:2}),fill:new Ra.Fill({color:this.fillColor}),image:new Ra.Circle({radius:5,stroke:new Ra.Stroke({color:this.strokeColor}),fill:new Ra.Fill({color:this.fillColor})})})],r)}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(jl))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),bd=(()=>{class e{constructor(e,t){this.languageService=e,this.dialog=t,this.onOk$=new C.a(""),this.title=this.languageService.translate.instant("igo.geo.draw.labels"),this.message=this.languageService.translate.instant("igo.geo.draw.dialogInstruction")}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(le),Object(i.gc)(qe.h))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-draw-popup-component"]],decls:12,vars:9,consts:[[1,"mat-typography"],[1,"example-full-width"],["matInput","",3,"placeholder","keydown.enter"],["input",""],["mat-button","",3,"click"]],template:function(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"h1"),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)(),Object(i.mc)(3,"p",0),Object(i.ad)(4),Object(i.yc)(5,"translate"),Object(i.lc)(),Object(i.mc)(6,"mat-form-field",1),Object(i.mc)(7,"input",2,3),Object(i.tc)("keydown.enter",(function(){Object(i.Nc)(e);const o=Object(i.Kc)(8);return t.onOk$.next(o.value),t.dialog.close()})),Object(i.yc)(9,"translate"),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(10,"button",4),Object(i.tc)("click",(function(){Object(i.Nc)(e);const o=Object(i.Kc)(8);return t.onOk$.next(o.value),t.dialog.close()})),Object(i.ad)(11,"OK"),Object(i.lc)()}2&e&&(Object(i.Tb)(1),Object(i.bd)(Object(i.zc)(2,3,"igo.geo.draw.dialogTitle")),Object(i.Tb)(3),Object(i.bd)(Object(i.zc)(5,5,"igo.geo.draw.dialogInstruction")),Object(i.Tb)(3),Object(i.Ec)("placeholder",Object(i.zc)(9,7,"igo.geo.draw.dialogTitle")))},directives:[ke.c,Ve.b,n.b],pipes:[q.e],styles:[""]}),e})();var fd=function(e){return e.Length="length",e.Area="area",e}({}),yd=function(e){return e.Meters="meters",e.Kilometers="kilometers",e.Miles="miles",e.Feet="feet",e}({});const Od={[yd.Meters]:"m",[yd.Kilometers]:"km",[yd.Miles]:"mi",[yd.Feet]:"ft"};var vd=function(e){return e.SquareMeters="squareMeters",e.SquareKilometers="squareKilometers",e.SquareMiles="squareMiles",e.SquareFeet="squareFeet",e.Hectares="hectares",e.Acres="acres",e}({});const jd={[vd.SquareMeters]:"m\xb2",[vd.SquareKilometers]:"km\xb2",[vd.SquareMiles]:"mi\xb2",[vd.SquareFeet]:"ft\xb2",[vd.Hectares]:"ha",[vd.Acres]:"ac"};function wd(e){return.001*e}function Sd(e){return 3.2808*e}function xd(e){return 621e-6*e}function Cd(e){return 1e-6*e}function Td(e){return 3.861e-7*e}function Ld(e){return 10.764*e}function Id(e){return 1e-4*e}function Fd(e){return 24711e-8*e}function Md(e,t){const o=new Map([[yd.Meters,e=>e],[yd.Kilometers,wd],[yd.Miles,xd],[yd.Feet,Sd]]).get(t);return o?o(e):void 0}function kd(e,t){const o=new Map([[vd.SquareMeters,e=>e],[vd.SquareKilometers,Cd],[vd.SquareMiles,Td],[vd.SquareFeet,Ld],[vd.Hectares,Id],[vd.Acres,Fd]]).get(t);return o?o(e):void 0}function Dd(e,t,o){let i=t.decimal;(void 0===i||i<0)&&(i=1);const r=[];return r.push(void 0!==t.locale?e.toLocaleString(t.locale,{minimumFractionDigits:i,maximumFractionDigits:i}):e.toFixed(i).toString()),void 0!==t.unit&&!0===t.unitAbbr&&r.push(o?o.translate.instant(Od[t.unit]?"igo.geo.measure."+Od[t.unit]:"igo.geo.measure."+jd[t.unit]):Od[t.unit]||jd[t.unit]),r.filter(e=>void 0!==e).join(" ")}function Pd(){return new Ra.Style({stroke:new Ra.Stroke({color:"#ffcc33",lineDash:[10,10],width:2}),fill:new Ra.Fill({color:"rgba(255, 255, 255, 0.2)"}),image:new Ra.Circle({radius:5,stroke:new Ra.Stroke({color:"#ffcc33"}),fill:new Ra.Fill({color:"rgba(255, 255, 255, 0.2)"})})})}function Ad(e,t){if(!(e instanceof on.a)&&0!==e.getFlatCoordinates().length)return Object(On.c)(e,{projection:t})}function $d(e,t){const o=Ad(e,t),i=function(e,t){if(!(e instanceof on.a||e instanceof rn.a)&&0!==e.getFlatCoordinates().length)return Object(On.a)(e,{projection:t})}(e,t),r=[],s=e.flatCoordinates,a=s.length;for(let n=0;n<=a-4;n+=2){const e=new rn.a([[s[n],s[n+1]],[s[n+2],s[n+3]]]);r.push(Ad(e,t))}return{area:i,length:o,lengths:r}}function Ed(e){let t;t=e instanceof Xa.a?0:Math.max(e.flatCoordinates.length/2-1,0);let o=e.get("_midpoints");if(void 0===o)return o=new Array(e instanceof on.a?1:t),e.set("_midpoints",o,!0),o;if(0===t)return o;if(t===o.length)return o;if(t>o.length)return o.push(...new Array(t-o.length)),o;for(let i=t;i<o.length;i++){const e=o[t];void 0!==e&&Rd(e)}return o.splice(t),o}function Rd(e){const t=e.get("_tooltip");if(void 0!==t){const e=t.getMap();void 0!==e&&e.removeOverlay(t)}}function _d(e){const t=[].concat(function(e){return Ed(e).map(e=>e?e.get("_tooltip"):void 0)}(e)||[]),o=function(e){const t=e.get("_center");return t?t.get("_tooltip"):void 0}(e);return void 0!==o&&t.push(o),t}function zd(e){const t=new vn.a({element:document.createElement("div"),offset:[-30,-10],className:["igo-map-tooltip","igo-map-tooltip-measure"].join(" "),stopEvent:!1});return t.setPosition(e.flatCoordinates),e.set("_tooltip",t),t}function Nd(e,t,o){return new Ra.Style({stroke:new Ra.Stroke({color:t||"#3399CC",width:2}),fill:new Ra.Fill({color:e||"rgba(255,255,255,0.4)"}),text:new Ra.Text({text:o||""}),image:new Ra.Circle({radius:5,stroke:new Ra.Stroke({color:t||"#3399CC"}),fill:new Ra.Fill({color:e||"rgba(255,255,255,0.4)"})})})}let Bd=(()=>{class e{constructor(e){this.config=e,this.getIconsList()}getIcons(){return this.icons}getPath(){return this.config.getConfig("drawingTool.icons")||[]}getIconsList(){this.icons=this.getPath()}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(K))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function qd(e,t){if(1&e&&(Object(i.mc)(0,"div",21),Object(i.hc)(1,"img",22),Object(i.lc)()),2&e){const e=Object(i.xc)(2);Object(i.Tb)(1),Object(i.Ec)("src",e.icon,i.Qc)}}function Gd(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"mat-option",23),Object(i.tc)("click",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)(2).onIconChange(o)})),Object(i.mc)(1,"div",21),Object(i.hc)(2,"img",22),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=t.$implicit;Object(i.Dc)("value",e),Object(i.Tb)(2),Object(i.Ec)("src",e,i.Qc)}}function Vd(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"mat-form-field"),Object(i.mc)(1,"mat-label"),Object(i.ad)(2),Object(i.yc)(3,"translate"),Object(i.lc)(),Object(i.mc)(4,"mat-select"),Object(i.mc)(5,"mat-select-trigger"),Object(i.Yc)(6,qd,2,1,"div",18),Object(i.lc)(),Object(i.mc)(7,"mat-option",19),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.xc)().onIconChange()})),Object(i.ad)(8),Object(i.yc)(9,"translate"),Object(i.lc)(),Object(i.Yc)(10,Gd,3,2,"mat-option",20),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Tb)(2),Object(i.bd)(Object(i.zc)(3,4,"igo.geo.draw.icon")),Object(i.Tb)(4),Object(i.Dc)("ngIf",e.icon),Object(i.Tb)(2),Object(i.bd)(Object(i.zc)(9,6,"igo.geo.draw.noIcon")),Object(i.Tb)(2),Object(i.Dc)("ngForOf",e.icons)}}function Ud(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",24),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.xc)().deleteDrawings()})),Object(i.yc)(1,"translate"),Object(i.yc)(2,"async"),Object(i.hc)(3,"mat-icon",25),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Dc)("matTooltip",Object(i.zc)(1,2,"igo.geo.draw.delete"))("disabled",0===Object(i.zc)(2,4,e.selectedFeatures$).length)}}let Hd=(()=>{class e{constructor(e,t,o,i,r){this.languageService=e,this.formBuilder=t,this.drawStyleService=o,this.dialog=i,this.drawIconService=r,this.tableTemplate={selection:!0,selectMany:!0,selectionCheckbox:!0,sort:!0,columns:[{name:"Drawing",title:this.languageService.translate.instant("igo.geo.draw.labels"),valueAccessor:e=>e.properties.draw}]},this.drawType=dd,this.draw$=new C.a({}),this._activeDrawType=dd.Point,this.olDrawSource=new ya.a,this.selectedFeatures$=new C.a([]),this.drawsPresence=!1,this.position="bottom",this.buildForm(),this.fillColor=this.drawStyleService.getFill(),this.strokeColor=this.drawStyleService.getStroke(),this.showTooltips=this.drawStyleService.getToggleLabel(),this.toggleLabel=this.drawStyleService.getToggleLabel(),this.icons=this.drawIconService.getIcons(),this.icon=this.drawStyleService.getIcon()}set activeDrawType(e){this.setActiveDrawType(e)}get activeDrawType(){return this._activeDrawType}get drawControlIsActive(){return void 0!==this.activeDrawControl}ngOnInit(){this.initStore(),this.createDrawPointControl(),this.createDrawLineControl(),this.createDrawPolygonControl(),this.createDrawCircleControl(),this.toggleDrawControl(),this.checkStoreCount()}ngOnDestroy(){this.setActiveDrawType(void 0)}createDrawPointControl(e,t){this.drawPointControl=new md({geometryType:dd.Point,source:this.olDrawSource,layerStyle:new yn.c({}),drawStyle:Nd(this.fillColor,this.strokeColor)})}createDrawLineControl(e,t){this.drawLineControl=new md({geometryType:dd.LineString,source:this.olDrawSource,layerStyle:new yn.c({}),drawStyle:Nd(this.fillColor,this.strokeColor)})}createDrawPolygonControl(e,t){this.drawPolygonControl=new md({geometryType:dd.Polygon,source:this.olDrawSource,layerStyle:new yn.c({}),drawStyle:Nd(this.fillColor,this.strokeColor)})}createDrawCircleControl(e,t){this.drawCircleControl=new md({geometryType:dd.Circle,source:this.olDrawSource,layerStyle:new yn.c({}),drawStyle:Nd(this.fillColor,this.strokeColor)})}onDrawTypeChange(e){this.activeDrawType=e}initStore(){const e=this.store;this.map.removeLayer(this.layer),this.layer=new Wc({title:this.languageService.translate.instant("igo.geo.draw.drawing"),zIndex:200,source:new vc,style:(e,t)=>this.drawStyleService.createDrawLayerStyle(e,t,!0,this.icon),showInLayerList:!0,exportable:!0,browsable:!1,workspace:{enabled:!1}}),sl(e,this.layer),pl(e,new ll({motion:el.None})),ml(e,new hl({map:this.map,motion:el.None,many:!0})),e.source.ol.on("removefeature",e=>{const t=e.feature.getGeometry();this.clearTooltipsOfOlGeometry(t)}),e.stateView.manyBy$(e=>!0===e.state.selected).pipe(Object(Le.a)(1)).subscribe(e=>{this.selectedFeatures$.next(e.map(e=>e.entity))})}changeStoreLayerStyle(e,t){this.fillForm=this.fillColor,this.strokeForm=this.strokeColor,this.drawStyleService.setFill(this.fillColor),this.drawStyleService.setStroke(this.strokeColor),e&&!t?(this.store.layer.ol.setStyle((e,t)=>this.drawStyleService.createDrawLayerStyle(e,t,!0)),this.icon=void 0):e||t?e&&t?this.store.layer.ol.setStyle((e,t)=>this.drawStyleService.createDrawLayerStyle(e,t,!0,this.icon)):!e&&t&&this.store.layer.ol.setStyle((e,t)=>this.drawStyleService.createDrawLayerStyle(e,t,!1,this.icon)):(this.store.layer.ol.setStyle((e,t)=>this.drawStyleService.createDrawLayerStyle(e,t,!1)),this.icon=void 0),this.createDrawPointControl(),this.createDrawLineControl(),this.createDrawPolygonControl(),this.createDrawCircleControl()}onToggleDrawControl(e){!0===e?this.toggleDrawControl():this.deactivateDrawControl()}toggleDrawControl(){this.deactivateDrawControl(),this.activeDrawType===dd.Point?this.activateDrawControl(this.drawPointControl):this.activeDrawType===dd.LineString?this.activateDrawControl(this.drawLineControl):this.activeDrawType===dd.Polygon?this.activateDrawControl(this.drawPolygonControl):this.activeDrawType===dd.Circle&&this.activateDrawControl(this.drawCircleControl)}openDialog(e){const t=this.dialog.open(bd,{disableClose:!1});t.afterClosed().subscribe(()=>{t.componentInstance.onOk$.subscribe(t=>{this.updateLabelOfOlGeometry(e,t),this.onDrawEnd(e),this.checkStoreCount()})})}activateDrawControl(e){this.activeDrawControl=e,this.drawEnd$$=e.end$.subscribe(e=>{this.openDialog(e)}),e.setOlMap(this.map.ol)}deactivateDrawControl(){void 0!==this.activeDrawControl&&(this.olDrawSource.clear(),void 0!==this.drawEnd$$&&this.drawEnd$$.unsubscribe(),this.activeDrawControl.setOlMap(void 0),this.activeDrawControl=void 0)}onDrawEnd(e){this.addFeatureToStore(e),this.clearTooltipsOfOlGeometry(e),this.olDrawSource.clear(!0)}setActiveDrawType(e){this._activeDrawType=e,this.toggleDrawControl()}addFeatureToStore(e,t){let o;const i=t?t.properties.id:z(),r=this.map.ol.getView().getProjection(),s=(new sn.a).writeGeometryObject(e,{featureProjection:r,dataProjection:r});if(e instanceof Xa.a){s.type="Point",s.coordinates=e.getCenter();const t=Object(sa.s)([e.flatCoordinates[2],e.flatCoordinates[3]],r,"EPSG:4326"),i=Object(sa.s)([e.flatCoordinates[0],e.flatCoordinates[1]],r,"EPSG:4326");o=Object(On.b)(i,t)}this.store.update({type:Xc,geometry:s,projection:r.getCode(),properties:{id:i,draw:e.get("_label"),radius:o||void 0},meta:{id:i}}),this.drawStyleService.raiseDrawCounter()}buildForm(){this.form=this.formBuilder.group({fill:[""],stroke:[""]})}deleteDrawings(){this.store.deleteMany(this.selectedFeatures$.value),this.checkStoreCount()}clearTooltipsOfOlGeometry(e){_d(e).forEach(e=>{void 0!==e&&void 0!==e.getMap()&&this.map.ol.removeOverlay(e)})}onToggleTooltips(e){this.drawStyleService.switchLabel(),this.toggleLabel=!this.toggleLabel,this.changeStoreLayerStyle(this.toggleLabel,!!this.icon)}updateLabelOfOlGeometry(e,t){e.setProperties({_label:t},!0)}onIconChange(e){this.icon=e,this.drawStyleService.setIcon(this.icon),this.store.layer.ol.setStyle((e,t)=>this.drawStyleService.createDrawLayerStyle(e,t,!0,this.icon))}checkStoreCount(){this.drawsPresence=0!==this.store.count$.getValue()}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(le),Object(i.gc)(Ue.g),Object(i.gc)(gd),Object(i.gc)(qe.b),Object(i.gc)(Bd))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-draw"]],inputs:{map:"map",store:"store",activeDrawType:"activeDrawType"},outputs:{fillColor:"fillColor",strokeColor:"strokeColor"},decls:53,vars:74,consts:[[1,"draw-type-toggle","mat-typography"],[3,"value","change"],[3,"value"],[1,"draw-options","mat-typography"],[3,"checked","labelPosition","change"],[1,"igo-form",3,"formGroup"],[1,"fill-color-picker","mat-typography"],[1,"color_element"],["svgIcon","palette",1,"stroke-palette-icon"],["appearance","outline"],["formControlName","fill","matInput","","type","text",3,"colorPicker","readonly","cpWidth","cpPosition","cpOutputFormat","cpCancelButton","cpCancelButtonText","cpOKButton","cpOKButtonText","value","colorPickerChange","colorPickerSelect"],[1,"stroke-color-picker","mat-typography"],["appearance","outline",1,"stroke-color-picker-box"],["formControlName","stroke","matInput","","type","text",3,"colorPicker","readonly","cpWidth","cpPosition","cpOutputFormat","cpCancelButton","cpCancelButtonText","cpOKButton","cpOKButtonText","value","colorPickerChange","colorPickerSelect"],[4,"ngIf"],["class","deleteBtn","mat-icon-button","","color","warn","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","disabled","click",4,"ngIf"],[1,"table-compact",3,"store","template"],["table",""],["class","box",4,"ngIf"],["value","",3,"click"],[3,"value","click",4,"ngFor","ngForOf"],[1,"box"],[3,"src"],[3,"value","click"],["mat-icon-button","","color","warn","tooltip-position","below","matTooltipShowDelay","500",1,"deleteBtn",3,"matTooltip","disabled","click"],["svgIcon","delete"]],template:function(e,t){1&e&&(Object(i.mc)(0,"div"),Object(i.mc)(1,"div",0),Object(i.mc)(2,"mat-button-toggle-group",1),Object(i.tc)("change",(function(e){return t.onDrawTypeChange(e.value)})),Object(i.mc)(3,"mat-button-toggle",2),Object(i.ad)(4),Object(i.yc)(5,"translate"),Object(i.lc)(),Object(i.mc)(6,"mat-button-toggle",2),Object(i.ad)(7),Object(i.yc)(8,"translate"),Object(i.lc)(),Object(i.mc)(9,"mat-button-toggle",2),Object(i.ad)(10),Object(i.yc)(11,"translate"),Object(i.lc)(),Object(i.mc)(12,"mat-button-toggle",2),Object(i.ad)(13),Object(i.yc)(14,"translate"),Object(i.lc)(),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(15,"div",3),Object(i.mc)(16,"mat-slide-toggle",4),Object(i.tc)("change",(function(e){return t.onToggleDrawControl(e.checked)})),Object(i.ad)(17),Object(i.yc)(18,"translate"),Object(i.lc)(),Object(i.mc)(19,"mat-slide-toggle",4),Object(i.tc)("change",(function(e){return t.onToggleTooltips(e.checked)})),Object(i.ad)(20),Object(i.yc)(21,"translate"),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(22,"form",5),Object(i.mc)(23,"div",6),Object(i.mc)(24,"span",7),Object(i.ad)(25),Object(i.yc)(26,"translate"),Object(i.hc)(27,"mat-icon",8),Object(i.lc)(),Object(i.mc)(28,"mat-form-field",9),Object(i.mc)(29,"mat-label"),Object(i.ad)(30),Object(i.lc)(),Object(i.mc)(31,"input",10),Object(i.tc)("colorPickerChange",(function(e){return t.fillColor=e}))("colorPickerSelect",(function(){return t.changeStoreLayerStyle(t.toggleLabel,!1)})),Object(i.yc)(32,"translate"),Object(i.yc)(33,"translate"),Object(i.lc)(),Object(i.lc)(),Object(i.lc)(),Object(i.hc)(34,"br"),Object(i.mc)(35,"div",11),Object(i.mc)(36,"span",7),Object(i.ad)(37),Object(i.yc)(38,"translate"),Object(i.hc)(39,"mat-icon",8),Object(i.lc)(),Object(i.mc)(40,"mat-form-field",12),Object(i.mc)(41,"mat-label"),Object(i.ad)(42),Object(i.lc)(),Object(i.mc)(43,"input",13),Object(i.tc)("colorPickerChange",(function(e){return t.strokeColor=e}))("colorPickerSelect",(function(){return t.changeStoreLayerStyle(t.toggleLabel,!1)})),Object(i.yc)(44,"translate"),Object(i.yc)(45,"translate"),Object(i.lc)(),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(46,"div"),Object(i.Yc)(47,Vd,11,8,"mat-form-field",14),Object(i.lc)(),Object(i.lc)(),Object(i.hc)(48,"mat-divider"),Object(i.mc)(49,"div"),Object(i.Yc)(50,Ud,4,6,"button",15),Object(i.hc)(51,"igo-entity-table",16,17),Object(i.lc)(),Object(i.lc)()),2&e&&(Object(i.Tb)(2),Object(i.Dc)("value",t.activeDrawType),Object(i.Tb)(1),Object(i.Dc)("value",t.drawType.Point),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(5,50,"igo.geo.draw."+t.drawType.Point)," "),Object(i.Tb)(2),Object(i.Dc)("value",t.drawType.LineString),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(8,52,"igo.geo.draw."+t.drawType.LineString)," "),Object(i.Tb)(2),Object(i.Dc)("value",t.drawType.Polygon),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(11,54,"igo.geo.draw."+t.drawType.Polygon)," "),Object(i.Tb)(2),Object(i.Dc)("value",t.drawType.Circle),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(14,56,"igo.geo.draw."+t.drawType.Circle)," "),Object(i.Tb)(3),Object(i.Dc)("checked",t.drawControlIsActive)("labelPosition","before"),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(18,58,"igo.geo.spatialFilter.drawControl")," "),Object(i.Tb)(2),Object(i.Dc)("checked",t.toggleLabel)("labelPosition","before"),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(21,60,"igo.geo.draw.toggleMapTooltips")," "),Object(i.Tb)(2),Object(i.Dc)("formGroup",t.form),Object(i.Tb)(3),Object(i.cd)(" ",Object(i.zc)(26,62,"igo.geo.draw.fill")," "),Object(i.Tb)(5),Object(i.bd)(t.fillColor),Object(i.Tb)(1),Object(i.Vc)("background",t.fillColor),Object(i.Dc)("colorPicker",t.fillColor)("readonly",!0)("colorPicker",t.fillColor)("cpWidth","220px")("cpPosition","bottom")("cpOutputFormat","rgba")("cpCancelButton",!0)("cpCancelButtonText",Object(i.zc)(32,64,"igo.geo.draw.cancelColorPicker"))("cpOKButton",!0)("cpOKButtonText",Object(i.zc)(33,66,"igo.geo.draw.okColorPicker"))("value",t.fillColor),Object(i.Tb)(6),Object(i.cd)(" ",Object(i.zc)(38,68,"igo.geo.draw.stroke")," "),Object(i.Tb)(5),Object(i.bd)(t.strokeColor),Object(i.Tb)(1),Object(i.Vc)("background",t.strokeColor),Object(i.Dc)("colorPicker",t.strokeColor)("readonly",!0)("colorPicker",t.strokeColor)("cpWidth","220px")("cpPosition","bottom")("cpOutputFormat","rgba")("cpCancelButton",!0)("cpCancelButtonText",Object(i.zc)(44,70,"igo.geo.draw.cancelColorPicker"))("cpOKButton",!0)("cpOKButtonText",Object(i.zc)(45,72,"igo.geo.draw.okColorPicker"))("value",t.strokeColor),Object(i.Tb)(4),Object(i.Dc)("ngIf",t.icons.length>=1),Object(i.Tb)(3),Object(i.Dc)("ngIf",t.drawsPresence),Object(i.Tb)(1),Object(i.Dc)("store",t.store)("template",t.tableTemplate))},directives:[gn.b,gn.a,hn.a,Ue.I,Ue.t,Ue.k,c.a,ke.c,ke.g,Ue.d,Ve.b,Ue.s,Ue.j,bn.a,m.t,dn.a,ro,De.a,De.c,Pe.p,m.s,n.b,h.a],pipes:[q.e,m.b],styles:[".draw-type-toggle[_ngcontent-%COMP%]{padding:10px;text-align:center}.draw-type-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]{width:100%}.draw-type-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]{width:25%}.draw-options[_ngcontent-%COMP%]{overflow-x:hidden}.draw-options[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{margin:10px;width:100%}.draw-options[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content{width:calc(100% - 60px)}.igo-form[_ngcontent-%COMP%]{padding:10px}.fill-color-picker[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{position:relative;top:7px}.fill-color-picker[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{left:8px}.stroke-color-picker[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{position:relative;top:7px}.stroke-color-picker[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{left:35px}.box[_ngcontent-%COMP%]{height:25px;width:25px}img[_ngcontent-%COMP%]{height:100%;width:100%}.deleteBtn[_ngcontent-%COMP%]{margin-left:12px}"],changeDetection:0}),e})(),Yd=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[Ue.m,Ue.C,m.c,n.c,gn.c,dn.b,ke.e,c.b,h.b,ke.e,Ve.c,l.e,De.b,hn.b,ie,Oi,bn.b]]}),e})(),Wd=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,c.b,ie,Fi,yi]]}),e})(),Kd=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,mi],mi]}),e})(),Zd=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},providers:[],imports:[[m.c],Wd,Kd]}),e})();class Qd{constructor(e){this.options=e,this.start$=new k.a,this.end$=new k.a,this.changes$=new k.a,this.olModifyInteractionIsActive=!1,this.olTranslateInteractionIsActive=!1,this.olDrawInteractionIsActive=!1,this.removedOlInteractions=[],this.modify=!0,this.translate=!0,void 0!==e.modify&&(this.modify=e.modify),void 0!==e.translate&&(this.translate=e.translate),this.olOverlayLayer=void 0!==e.layer?e.layer:this.createOlInnerOverlayLayer(),this.olLinearRingsLayer=this.createOlLinearRingsLayer()}get active(){return void 0!==this.olMap}get olOverlaySource(){return this.olOverlayLayer.getSource()}get olLinearRingsSource(){return this.olLinearRingsLayer.getSource()}setOlMap(e){if(void 0===e)return this.clearOlInnerOverlaySource(),this.removeOlInnerOverlayLayer(),this.removeOlModifyInteraction(),this.removeOlTranslateInteraction(),this.removeOlDrawInteraction(),void(this.olMap=e);this.olMap=e,this.addOlInnerOverlayLayer(),!0===this.modify&&this.addOlDrawInteraction(),!0===this.translate&&(this.addOlTranslateInteraction(),this.activateTranslateInteraction()),!0===this.modify&&(this.addOlModifyInteraction(),this.activateModifyInteraction())}getSource(){return this.olOverlaySource}setOlGeometry(e){const t=new Da.a({geometry:e});this.olOverlaySource.clear(),this.olOverlaySource.addFeature(t)}createOlInnerOverlayLayer(){return new qa.a({source:this.options.source?this.options.source:new ya.a,style:this.options.layerStyle,zIndex:500})}addOlInnerOverlayLayer(){void 0===this.options.layer&&this.olMap.addLayer(this.olOverlayLayer)}removeOlInnerOverlayLayer(){void 0===this.options.layer&&void 0!==this.olMap&&this.olMap.removeLayer(this.olOverlayLayer)}clearOlInnerOverlaySource(){void 0===this.options.layer&&void 0===this.options.source&&this.olOverlaySource.clear(!0)}createOlLinearRingsLayer(){return new qa.a({source:new ya.a,style:hd(),zIndex:500})}addOlLinearRingsLayer(){this.olMap.addLayer(this.olLinearRingsLayer)}removeOlLinearRingsLayer(){this.olMap.removeLayer(this.olLinearRingsLayer)}clearOlLinearRingsSource(){this.olLinearRingsSource.clear(!0)}addOlModifyInteraction(){const e=new Ln.a({source:this.olOverlaySource,style:this.options.drawStyle});this.olModifyInteraction=e}removeOlModifyInteraction(){void 0!==this.olModifyInteraction&&(this.deactivateModifyInteraction(),this.olModifyInteraction=void 0)}activateModifyInteraction(){!0!==this.olModifyInteractionIsActive&&(this.olModifyInteractionIsActive=!0,this.onModifyStartKey=this.olModifyInteraction.on("modifystart",e=>this.onModifyStart(e)),this.onModifyEndKey=this.olModifyInteraction.on("modifyend",e=>this.onModifyEnd(e)),this.olMap.addInteraction(this.olModifyInteraction))}deactivateModifyInteraction(){!1!==this.olModifyInteractionIsActive&&(this.olModifyInteractionIsActive=!1,Object(Ga.b)([this.onModifyStartKey,this.onModifyEndKey,this.onModifyKey]),void 0!==this.olMap&&this.olMap.removeInteraction(this.olModifyInteraction))}onModifyStart(e){const t=e.features.item(0).getGeometry();this.start$.next(t),this.onModifyKey=t.on("change",e=>{this.mousePosition=pd(e),this.changes$.next(e.target)}),this.subscribeToKeyDown()}onModifyEnd(e){Object(Ga.b)(this.onModifyKey),this.end$.next(e.features.item(0).getGeometry()),this.unsubscribeToKeyDown()}subscribeToKeyDown(){this.keyDown$$=Object(F.a)(document,"keydown").subscribe(e=>{" "!==e.key||this.olMap.getView().animate({center:this.mousePosition,duration:0})})}unsubscribeToKeyDown(){void 0!==this.keyDown$$&&this.keyDown$$.unsubscribe()}addOlTranslateInteraction(){const e=new In.a({layers:[this.olOverlayLayer]});this.olTranslateInteraction=e}removeOlTranslateInteraction(){void 0!==this.olTranslateInteraction&&(this.deactivateTranslateInteraction(),this.olTranslateInteraction=void 0)}activateTranslateInteraction(){!0!==this.olTranslateInteractionIsActive&&(this.olTranslateInteractionIsActive=!0,this.onTranslateStartKey=this.olTranslateInteraction.on("translatestart",e=>this.onTranslateStart(e)),this.onTranslateEndKey=this.olTranslateInteraction.on("translateend",e=>this.onTranslateEnd(e)),this.olMap.addInteraction(this.olTranslateInteraction))}deactivateTranslateInteraction(){!1!==this.olTranslateInteractionIsActive&&(this.olTranslateInteractionIsActive=!1,Object(Ga.b)([this.onTranslateStartKey,this.onTranslateEndKey,this.onTranslateKey]),void 0!==this.olMap&&this.olMap.removeInteraction(this.olTranslateInteraction))}onTranslateStart(e){const t=e.features.item(0).getGeometry();this.start$.next(t),this.onTranslateKey=t.on("change",e=>{this.changes$.next(e.target)})}onTranslateEnd(e){Object(Ga.b)(this.onTranslateKey),this.end$.next(e.features.item(0).getGeometry())}addOlDrawInteraction(){const e=new fn.a({type:"Polygon",source:this.olLinearRingsSource,stopClick:!0,style:hd(),condition:e=>(this.olOuterGeometry||this.getOlGeometry()).intersectsCoordinate(e.coordinate)});this.olDrawInteraction=e,this.subscribeToDrawKeyDown()}subscribeToDrawKeyDown(){this.drawKeyDown$$=Object(F.a)(document,"keydown").subscribe(e=>{if("Control"!==e.key)return;this.unsubscribeToDrawKeyDown();const t=this.getOlGeometry();t&&t instanceof tn.b&&(this.subscribeToDrawKeyUp(),this.deactivateModifyInteraction(),this.deactivateTranslateInteraction(),this.activateDrawInteraction())})}subscribeToDrawKeyUp(){this.drawKeyUp$$=Object(F.a)(document,"keyup").subscribe(e=>{"Control"===e.key&&(this.unsubscribeToDrawKeyUp(),this.unsubscribeToKeyDown(),this.deactivateDrawInteraction(),this.activateModifyInteraction(),!0===this.translate&&this.activateTranslateInteraction(),this.subscribeToDrawKeyDown(),this.olOuterGeometry=void 0,this.clearOlLinearRingsSource(),this.end$.next(this.getOlGeometry()))})}unsubscribeToDrawKeyDown(){void 0!==this.drawKeyDown$$&&this.drawKeyDown$$.unsubscribe()}unsubscribeToDrawKeyUp(){void 0!==this.drawKeyUp$$&&this.drawKeyUp$$.unsubscribe()}removeOlDrawInteraction(){void 0!==this.olDrawInteraction&&(this.unsubscribeToKeyDown(),this.unsubscribeToDrawKeyUp(),this.unsubscribeToDrawKeyDown(),this.deactivateDrawInteraction(),this.clearOlLinearRingsSource(),this.olDrawInteraction=void 0)}activateDrawInteraction(){!0!==this.olDrawInteractionIsActive&&(this.clearOlLinearRingsSource(),this.addOlLinearRingsLayer(),this.olMap.getInteractions().forEach(e=>{e instanceof an.a&&(this.olMap.removeInteraction(e),this.removedOlInteractions.push(e))}),this.olDrawInteractionIsActive=!0,this.onDrawStartKey=this.olDrawInteraction.on("drawstart",e=>this.onDrawStart(e)),this.onDrawEndKey=this.olDrawInteraction.on("drawend",e=>this.onDrawEnd(e)),this.olMap.addInteraction(this.olDrawInteraction))}deactivateDrawInteraction(){!1!==this.olDrawInteractionIsActive&&(this.removeOlLinearRingsLayer(),this.removedOlInteractions.forEach(e=>{this.olMap.addInteraction(e)}),this.removedOlInteractions=[],this.olDrawInteractionIsActive=!1,Object(Ga.b)([this.onDrawStartKey,this.onDrawEndKey,this.onDrawKey]),void 0!==this.olMap&&this.olMap.removeInteraction(this.olDrawInteraction))}onDrawStart(e){const t=e.feature.getGeometry();this.olOuterGeometry=this.getOlGeometry().clone();const o=t.getLinearRing().getCoordinates();this.addLinearRingToOlGeometry(o),this.start$.next(this.getOlGeometry()),this.onDrawKey=t.on("change",e=>{this.mousePosition=pd(e);const t=e.target.getLinearRing().getCoordinates();this.updateLinearRingOfOlGeometry(t),this.changes$.next(this.getOlGeometry())}),this.subscribeToKeyDown()}onDrawEnd(e){Object(Ga.b)(this.onDrawKey),this.olOuterGeometry=void 0;const t=e.feature.getGeometry().getLinearRing().getCoordinates();this.updateLinearRingOfOlGeometry(t),this.clearOlLinearRingsSource(),this.end$.next(this.getOlGeometry()),this.unsubscribeToKeyDown()}addLinearRingToOlGeometry(e){var t,o;t=this.getOlGeometry(),o=new Fn.a(e),t.appendLinearRing(o)}updateLinearRingOfOlGeometry(e){const t=this.getOlGeometry(),o=t.getLinearRings().slice(0,-1).map(e=>e.getCoordinates());o.push(e),t.setCoordinates(o)}getOlGeometry(){const e=this.olOverlaySource.getFeatures();return e.length>0?e[0].getGeometry():void 0}}let Jd=(()=>{class e{constructor(e,t){this.dialogRef=e,this.data=t,this.measureAreaUnit=vd,this.measureLengthUnit=yd}onNoClick(){this.dialogRef.close()}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(qe.h),Object(i.gc)(qe.a))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-measurer-dialog"]],decls:88,vars:79,consts:[["mat-dialog-content",""],["colspan","2"]],template:function(e,t){1&e&&(Object(i.mc)(0,"div",0),Object(i.mc)(1,"h3"),Object(i.ad)(2),Object(i.yc)(3,"translate"),Object(i.lc)(),Object(i.mc)(4,"table"),Object(i.mc)(5,"thead"),Object(i.mc)(6,"tr"),Object(i.mc)(7,"th",1),Object(i.ad)(8),Object(i.yc)(9,"translate"),Object(i.lc)(),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(10,"tbody"),Object(i.mc)(11,"tr"),Object(i.mc)(12,"td"),Object(i.ad)(13),Object(i.yc)(14,"translate"),Object(i.lc)(),Object(i.mc)(15,"td"),Object(i.ad)(16),Object(i.yc)(17,"measureFormat"),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(18,"tr"),Object(i.mc)(19,"td"),Object(i.ad)(20),Object(i.yc)(21,"translate"),Object(i.lc)(),Object(i.mc)(22,"td"),Object(i.ad)(23),Object(i.yc)(24,"measureFormat"),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(25,"tr"),Object(i.mc)(26,"td"),Object(i.ad)(27),Object(i.yc)(28,"translate"),Object(i.lc)(),Object(i.mc)(29,"td"),Object(i.ad)(30),Object(i.yc)(31,"measureFormat"),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(32,"tr"),Object(i.mc)(33,"td"),Object(i.ad)(34),Object(i.yc)(35,"translate"),Object(i.lc)(),Object(i.mc)(36,"td"),Object(i.ad)(37),Object(i.yc)(38,"measureFormat"),Object(i.lc)(),Object(i.lc)(),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(39,"table"),Object(i.mc)(40,"thead"),Object(i.mc)(41,"tr"),Object(i.mc)(42,"th",1),Object(i.ad)(43),Object(i.yc)(44,"translate"),Object(i.lc)(),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(45,"tbody"),Object(i.mc)(46,"tr"),Object(i.mc)(47,"td"),Object(i.ad)(48),Object(i.yc)(49,"translate"),Object(i.lc)(),Object(i.mc)(50,"td"),Object(i.ad)(51),Object(i.yc)(52,"measureFormat"),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(53,"tr"),Object(i.mc)(54,"td"),Object(i.ad)(55),Object(i.yc)(56,"translate"),Object(i.lc)(),Object(i.mc)(57,"td"),Object(i.ad)(58),Object(i.yc)(59,"measureFormat"),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(60,"tr"),Object(i.mc)(61,"td"),Object(i.ad)(62),Object(i.yc)(63,"translate"),Object(i.lc)(),Object(i.mc)(64,"td"),Object(i.ad)(65),Object(i.yc)(66,"measureFormat"),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(67,"tr"),Object(i.mc)(68,"td"),Object(i.ad)(69),Object(i.yc)(70,"translate"),Object(i.lc)(),Object(i.mc)(71,"td"),Object(i.ad)(72),Object(i.yc)(73,"measureFormat"),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(74,"tr"),Object(i.mc)(75,"td"),Object(i.ad)(76),Object(i.yc)(77,"translate"),Object(i.lc)(),Object(i.mc)(78,"td"),Object(i.ad)(79),Object(i.yc)(80,"measureFormat"),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(81,"tr"),Object(i.mc)(82,"td"),Object(i.ad)(83),Object(i.yc)(84,"translate"),Object(i.lc)(),Object(i.mc)(85,"td"),Object(i.ad)(86),Object(i.yc)(87,"measureFormat"),Object(i.lc)(),Object(i.lc)(),Object(i.lc)(),Object(i.lc)(),Object(i.lc)()),2&e&&(Object(i.Tb)(2),Object(i.bd)(Object(i.zc)(3,23,"igo.geo.measure.dialog.title")),Object(i.Tb)(6),Object(i.bd)(Object(i.zc)(9,25,"igo.geo.measure.dialog.length.title")),Object(i.Tb)(5),Object(i.bd)(Object(i.zc)(14,27,"igo.geo.measure.dialog.lengthInMeters")),Object(i.Tb)(3),Object(i.bd)(Object(i.Ac)(17,29,t.data.length,t.measureLengthUnit.Meters)),Object(i.Tb)(4),Object(i.bd)(Object(i.zc)(21,32,"igo.geo.measure.dialog.lengthInKilometers")),Object(i.Tb)(3),Object(i.bd)(Object(i.Ac)(24,34,t.data.length,t.measureLengthUnit.Kilometers)),Object(i.Tb)(4),Object(i.bd)(Object(i.zc)(28,37,"igo.geo.measure.dialog.lengthInMiles")),Object(i.Tb)(3),Object(i.bd)(Object(i.Ac)(31,39,t.data.length,t.measureLengthUnit.Miles)),Object(i.Tb)(4),Object(i.bd)(Object(i.zc)(35,42,"igo.geo.measure.dialog.lengthInFeet")),Object(i.Tb)(3),Object(i.bd)(Object(i.Ac)(38,44,t.data.length,t.measureLengthUnit.Feet)),Object(i.Tb)(6),Object(i.bd)(Object(i.zc)(44,47,"igo.geo.measure.dialog.area.title")),Object(i.Tb)(5),Object(i.bd)(Object(i.zc)(49,49,"igo.geo.measure.dialog.areaInSquareMeters")),Object(i.Tb)(3),Object(i.bd)(Object(i.Ac)(52,51,t.data.area,t.measureAreaUnit.SquareMeters)),Object(i.Tb)(4),Object(i.bd)(Object(i.zc)(56,54,"igo.geo.measure.dialog.areaInSquareKilometers")),Object(i.Tb)(3),Object(i.bd)(Object(i.Ac)(59,56,t.data.area,t.measureAreaUnit.SquareKilometers)),Object(i.Tb)(4),Object(i.bd)(Object(i.zc)(63,59,"igo.geo.measure.dialog.areaInSquareMiles")),Object(i.Tb)(3),Object(i.bd)(Object(i.Ac)(66,61,t.data.area,t.measureAreaUnit.SquareMiles)),Object(i.Tb)(4),Object(i.bd)(Object(i.zc)(70,64,"igo.geo.measure.dialog.areaInAcres")),Object(i.Tb)(3),Object(i.bd)(Object(i.Ac)(73,66,t.data.area,t.measureAreaUnit.Acres)),Object(i.Tb)(4),Object(i.bd)(Object(i.zc)(77,69,"igo.geo.measure.dialog.areaInHectares")),Object(i.Tb)(3),Object(i.bd)(Object(i.Ac)(80,71,t.data.area,t.measureAreaUnit.Hectares)),Object(i.Tb)(4),Object(i.bd)(Object(i.zc)(84,74,"igo.geo.measure.dialog.perimeterInMeters")),Object(i.Tb)(3),Object(i.bd)(Object(i.Ac)(87,76,t.data.perimeter,t.measureLengthUnit.Meters)))},styles:["[_nghost-%COMP%]{font-family:Roboto,Helvetica Neue,sans-serif}h3[_ngcontent-%COMP%]{margin:0;text-align:center}table[_ngcontent-%COMP%]{padding:10px;width:100%}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{padding-left:10px}"]}),e})();const Xd=["table"];function eh(e,t){if(1&e){const e=Object(i.nc)();Object(i.kc)(0),Object(i.mc)(1,"igo-measurer-item",12),Object(i.tc)("measureUnitChange",(function(t){return Object(i.Nc)(e),Object(i.xc)().onLengthUnitChange(t)})),Object(i.yc)(2,"translate"),Object(i.lc)(),Object(i.mc)(3,"igo-measurer-item",12),Object(i.tc)("measureUnitChange",(function(t){return Object(i.Nc)(e),Object(i.xc)().onAreaUnitChange(t)})),Object(i.yc)(4,"translate"),Object(i.lc)(),Object(i.jc)()}if(2&e){const e=t.ngIf,o=Object(i.xc)();Object(i.Tb)(1),Object(i.Dc)("measureType",o.measureType.Length)("measureUnit",o.measureLengthUnit.Meters)("measure",e.length)("auto",o.measureUnitsAuto)("placeholder",Object(i.zc)(2,10,o.activeMeasureType===o.measureType.Area?"igo.geo.measure.perimeter":"igo.geo.measure.length")),Object(i.Tb)(2),Object(i.Dc)("measureType",o.measureType.Area)("measureUnit",o.measureAreaUnit.SquareMeters)("measure",e.area)("auto",o.measureUnitsAuto)("placeholder",Object(i.zc)(4,12,"igo.geo.measure.area"))}}let th=(()=>{class e{constructor(e,t){this.languageService=e,this.dialog=t,this.tableTemplate={selection:!0,selectMany:!0,selectionCheckbox:!0,sort:!0,columns:[{name:"length",title:this.languageService.translate.instant("igo.geo.measure.lengthHeader"),valueAccessor:e=>{const t=this.activeLengthUnit;return Dd(Md(e.properties.measure.length,t),{decimal:1,unit:t,unitAbbr:!1,locale:"fr"})}},{name:"area",title:this.languageService.translate.instant("igo.geo.measure.areaHeader"),valueAccessor:e=>{const t=this.activeAreaUnit,o=kd(e.properties.measure.area,t);return o?Dd(o,{decimal:1,unit:t,unitAbbr:!1,locale:"fr"}):""}}]},this.measureType=fd,this.measureAreaUnit=vd,this.measureLengthUnit=yd,this.measureUnitsAuto=!1,this.measure$=new C.a({}),this.selectedFeatures$=new C.a([]),this.showTooltips=!0,this.activeLengthUnit=yd.Meters,this.activeAreaUnit=vd.SquareMeters,this.olDrawSource=new ya.a,this._activeMeasureType=fd.Length,this.minSegmentLength=10}set activeMeasureType(e){this.setActiveMeasureType(e)}get activeMeasureType(){return this._activeMeasureType}get drawControlIsActive(){return void 0!==this.activeDrawControl}get projection(){return this.map.ol.getView().getProjection()}ngOnInit(){this.initStore(),this.createDrawLineControl(),this.createDrawPolygonControl(),this.createModifyControl(),this.toggleDrawControl(),this.onToggleTooltips(this.showTooltips),this.updateTooltipsOfOlSource(this.store.source.ol)}ngOnDestroy(){this.setActiveMeasureType(void 0),this.deactivateModifyControl(),this.freezeStore()}onMeasureTypeChange(e){this.activeMeasureType=e}onToggleDrawControl(e){!0===e?this.toggleDrawControl():this.deactivateDrawControl()}onToggleTooltips(e){this.showTooltips=e,!0===e?this.showTooltipsOfOlSource(this.store.source.ol):this.clearTooltipsOfOlSource(this.store.source.ol)}onToggleMeasureUnitsAuto(e){this.measureUnitsAuto=e}onLengthUnitChange(e){this.activeLengthUnit=e,this.table.refresh(),this.updateTooltipsOfOlSource(this.store.source.ol),void 0!==this.activeOlGeometry&&this.updateTooltipsOfOlGeometry(this.activeOlGeometry)}onAreaUnitChange(e){this.activeAreaUnit=e,this.table.refresh(),this.updateTooltipsOfOlSource(this.store.source.ol),void 0!==this.activeOlGeometry&&this.updateTooltipsOfOlGeometry(this.activeOlGeometry)}onCalculateClick(){const e=this.selectedFeatures$.value,t=e.reduce((e,t)=>e+t.properties.measure.area||0,0),o=e.reduce((e,t)=>"Polygon"===t.geometry.type?e:e+t.properties.measure.length||0,0),i=e.reduce((e,t)=>"LineString"===t.geometry.type?e:e+t.properties.measure.length||0,0);this.openDialog({area:t,length:o,perimeter:i})}onDeleteClick(){this.store.deleteMany(this.selectedFeatures$.value)}onModifyClick(){if(1===this.selectedFeatures$.value.length)if(!0===this.modifyControl.active)this.deactivateModifyControl(),this.toggleDrawControl();else{const e=this.selectedFeatures$.value[0],t=this.store.layer.ol.getSource().getFeatures().find(t=>t.get("id")===e.properties.id);if(void 0!==t){this.deactivateDrawControl(),this.activateModifyControl();const e=t.getGeometry();this.clearTooltipsOfOlGeometry(e),this.modifyControl.setOlGeometry(e)}}}openDialog(e){this.dialog.open(Jd,{data:e})}initStore(){const e=this.store;sl(e,new Wc({title:"Measures",zIndex:200,source:new vc,style:new Ra.Style({stroke:new Ra.Stroke({color:"#ffcc33",width:2}),fill:new Ra.Fill({color:"rgba(255, 255, 255, 0.2)"})}),showInLayerList:!1,exportable:!1,browsable:!1})),pl(e),ml(e,new hl({map:this.map,many:!0})),this.onFeatureAddedKey=e.source.ol.on("addfeature",e=>{const t=e.feature,o=t.getGeometry();this.updateMeasureOfOlGeometry(o,t.get("measure"))}),this.onFeatureRemovedKey=e.source.ol.on("removefeature",e=>{const t=e.feature.getGeometry();this.clearTooltipsOfOlGeometry(t)}),this.selectedFeatures$$=e.stateView.manyBy$(e=>!0===e.state.selected).pipe(Object(Le.a)(1)).subscribe(e=>{!0===this.modifyControl.active&&this.deactivateModifyControl(),this.selectedFeatures$.next(e.map(e=>e.entity))})}freezeStore(){const e=this.store;this.selectedFeatures$$.unsubscribe(),Object(Ga.b)(this.onFeatureAddedKey),Object(Ga.b)(this.onFeatureRemovedKey),this.clearTooltipsOfOlSource(e.source.ol),this.map.removeLayer(e.layer),e.deactivateStrategyOfType(ll),e.deactivateStrategyOfType(hl)}createDrawLineControl(){this.drawLineControl=new md({geometryType:"LineString",source:this.olDrawSource,drawStyle:Pd(),layerStyle:new yn.c({})})}createDrawPolygonControl(){this.drawPolygonControl=new md({geometryType:"Polygon",source:this.olDrawSource,drawStyle:Pd(),layerStyle:new yn.c({})})}createModifyControl(){this.modifyControl=new Qd({source:this.olDrawSource,drawStyle:Pd(),layerStyle:new yn.c({})})}toggleDrawControl(){this.deactivateDrawControl(),this.activeMeasureType===fd.Length?this.activateDrawControl(this.drawLineControl):this.activeMeasureType===fd.Area&&this.activateDrawControl(this.drawPolygonControl)}activateDrawControl(e){this.activeDrawControl=e,this.drawStart$$=e.start$.subscribe(e=>this.onDrawStart(e)),this.drawEnd$$=e.end$.subscribe(e=>this.onDrawEnd(e)),this.drawChanges$$=e.changes$.subscribe(e=>this.onDrawChanges(e)),e.setOlMap(this.map.ol)}deactivateDrawControl(){void 0!==this.activeDrawControl&&(this.olDrawSource.clear(),void 0!==this.drawStart$$&&this.drawStart$$.unsubscribe(),void 0!==this.drawEnd$$&&this.drawEnd$$.unsubscribe(),void 0!==this.drawChanges$$&&this.drawChanges$$.unsubscribe(),this.clearTooltipsOfOlSource(this.olDrawSource),void 0!==this.activeOlGeometry&&this.clearTooltipsOfOlGeometry(this.activeOlGeometry),this.activeDrawControl.setOlMap(void 0),this.activeDrawControl=void 0,this.activeOlGeometry=void 0)}setActiveMeasureType(e){this._activeMeasureType=e,this.clearMeasures(),this.toggleDrawControl()}onDrawStart(e){this.activeOlGeometry=e}onDrawEnd(e){this.activeOlGeometry=void 0,this.finalizeMeasureOfOlGeometry(e),this.addFeatureToStore(e),this.clearTooltipsOfOlGeometry(e),this.olDrawSource.clear(!0)}onDrawChanges(e){const t=$d(e,this.projection);this.updateMeasureOfOlGeometry(e,Object.assign({},t,{area:void 0})),this.measure$.next(t)}activateModifyControl(){const e=this.store.getStrategyOfType(hl);e.deactivate(),e.clear(),this.modifyStart$$=this.modifyControl.start$.subscribe(e=>this.onModifyStart(e)),this.modifyEnd$$=this.modifyControl.end$.subscribe(e=>this.onModifyEnd(e)),this.modifyChanges$$=this.modifyControl.changes$.subscribe(e=>this.onModifyChanges(e)),this.modifyControl.setOlMap(this.map.ol)}deactivateModifyControl(){void 0!==this.modifyStart$$&&this.modifyStart$$.unsubscribe(),void 0!==this.modifyEnd$$&&this.modifyEnd$$.unsubscribe(),void 0!==this.modifyChanges$$&&this.modifyChanges$$.unsubscribe(),void 0!==this.activeOlGeometry&&(1===this.selectedFeatures$.value.length&&this.addFeatureToStore(this.activeOlGeometry,this.selectedFeatures$.value[0]),this.finalizeMeasureOfOlGeometry(this.activeOlGeometry)),this.olDrawSource.clear(),this.store.activateStrategyOfType(hl),this.activeOlGeometry=void 0,this.modifyControl.setOlMap(void 0)}onModifyStart(e){this.onDrawStart(e)}onModifyChanges(e){this.onDrawChanges(e)}onModifyEnd(e){this.finalizeMeasureOfOlGeometry(e)}finalizeMeasureOfOlGeometry(e){let t=$d(e,this.projection);e instanceof tn.b&&(t=Object.assign({},t,{lengths:[]})),this.updateMeasureOfOlGeometry(e,t)}updateMeasureOfOlGeometry(e,t){e.setProperties({_measure:t},!0),this.updateTooltipsOfOlGeometry(e)}clearMeasures(){this.measure$.next({})}addFeatureToStore(e,t){const o=t?t.properties.id:z(),i=this.map.ol.getView().getProjection(),r=(new sn.a).writeGeometryObject(e,{featureProjection:i,dataProjection:i});this.store.update({type:Xc,geometry:r,projection:i.getCode(),properties:{id:o,measure:e.get("_measure")},meta:{id:o}})}updateTooltipsOfOlGeometry(e){const t=e.get("_measure"),o=t.lengths,i=t.area,r=function(e){return function(e){let t;if(e instanceof on.a){const o=new on.a(e.flatCoordinates);t=new Array(1),t[0]=o}else{t=Ed(e);const o=e.flatCoordinates,i=t.length;for(let e=0;e<i;e++){const i=2*e,r=new rn.a([[o[i],o[i+1]],[o[i+2],o[i+3]]]).getCoordinateAt(.5),s=t[e];void 0!==s?s.setCoordinates(r):t[e]=new on.a(r)}}return t}(e).map(e=>{let t=e.get("_tooltip");return void 0===t?t=zd(e):t.setPosition(e.flatCoordinates),t})}(e);if(o.length===r.length)for(let s=0;s<r.length;s++){const e=o[s];void 0!==e&&this.updateOlTooltip(r[s],Md(e,this.activeLengthUnit),this.activeLengthUnit,fd.Length)}void 0!==i&&this.updateOlTooltip(function(e){const t=function(e){let t=e.get("_center");const o=Object(Ca.y)(e.getExtent());return void 0!==t?t.setCoordinates(o):(t=new on.a(o),e.set("_center",t)),t}(e);let o=t.get("_tooltip");return void 0===o?o=zd(t):o.setPosition(t.flatCoordinates),o}(e),kd(i,this.activeAreaUnit),this.activeAreaUnit,fd.Area)}showTooltipsOfOlGeometry(e){_d(e).forEach(e=>{this.shouldShowTooltip(e)&&this.map.ol.addOverlay(e)})}clearTooltipsOfOlGeometry(e){_d(e).forEach(e=>{void 0!==e&&void 0!==e.getMap()&&this.map.ol.removeOverlay(e)})}updateTooltipsOfOlSource(e){e.forEachFeature(e=>{this.updateTooltipsOfOlGeometry(e.getGeometry())})}showTooltipsOfOlSource(e){e.forEachFeature(e=>{this.showTooltipsOfOlGeometry(e.getGeometry())})}clearTooltipsOfOlSource(e){e.forEachFeature(e=>{void 0!==e.getGeometry()&&this.clearTooltipsOfOlGeometry(e.getGeometry())})}updateOlTooltip(e,t,o,i){e.setProperties({_measure:t,_unit:o,_type:i},!0),e.getElement().innerHTML=this.computeTooltipInnerHTML(e),this.shouldShowTooltip(e)&&this.map.ol.addOverlay(e)}computeTooltipInnerHTML(e){const t=e.getProperties();return Dd(t._measure,{decimal:1,unit:t._unit,unitAbbr:!0,locale:"fr"},this.languageService)}shouldShowTooltip(e){if(!1===this.showTooltips)return!1;const t=e.getProperties(),o=t._measure;if(void 0===o)return!1;if(t._unit===fd.Length){const e=Md(this.minSegmentLength,t._unit)||0;return o>Math.max(e,0)}return!0}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(le),Object(i.gc)(qe.b))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-measurer"]],viewQuery:function(e,t){var o;1&e&&Object(i.Uc)(Xd,!0),2&e&&Object(i.Jc)(o=Object(i.uc)())&&(t.table=o.first)},inputs:{map:"map",store:"store",activeMeasureType:"activeMeasureType",minSegmentLength:"minSegmentLength"},decls:32,vars:41,consts:[[1,"measure-type-toggle","mat-typography"],[3,"value","change"],[3,"value"],[1,"measure-options","mat-typography"],[3,"checked","labelPosition","change"],[4,"ngIf"],[1,"measure-store-buttons"],["mat-icon-button","",3,"matTooltip","disabled","click"],["svgIcon","calculator"],["svgIcon","delete"],[1,"table-compact",3,"store","template"],["table",""],[3,"measureType","measureUnit","measure","auto","placeholder","measureUnitChange"]],template:function(e,t){1&e&&(Object(i.mc)(0,"div"),Object(i.mc)(1,"div",0),Object(i.mc)(2,"mat-button-toggle-group",1),Object(i.tc)("change",(function(e){return t.onMeasureTypeChange(e.value)})),Object(i.mc)(3,"mat-button-toggle",2),Object(i.ad)(4),Object(i.yc)(5,"translate"),Object(i.lc)(),Object(i.mc)(6,"mat-button-toggle",2),Object(i.ad)(7),Object(i.yc)(8,"translate"),Object(i.lc)(),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(9,"div",3),Object(i.mc)(10,"mat-slide-toggle",4),Object(i.tc)("change",(function(e){return t.onToggleDrawControl(e.checked)})),Object(i.ad)(11),Object(i.yc)(12,"translate"),Object(i.lc)(),Object(i.mc)(13,"mat-slide-toggle",4),Object(i.tc)("change",(function(e){return t.onToggleTooltips(e.checked)})),Object(i.ad)(14),Object(i.yc)(15,"translate"),Object(i.lc)(),Object(i.mc)(16,"mat-slide-toggle",4),Object(i.tc)("change",(function(e){return t.onToggleMeasureUnitsAuto(e.checked)})),Object(i.ad)(17),Object(i.yc)(18,"translate"),Object(i.lc)(),Object(i.lc)(),Object(i.Yc)(19,eh,5,14,"ng-container",5),Object(i.yc)(20,"async"),Object(i.mc)(21,"div",6),Object(i.mc)(22,"button",7),Object(i.tc)("click",(function(){return t.onCalculateClick()})),Object(i.yc)(23,"translate"),Object(i.yc)(24,"async"),Object(i.hc)(25,"mat-icon",8),Object(i.lc)(),Object(i.mc)(26,"button",7),Object(i.tc)("click",(function(){return t.onDeleteClick()})),Object(i.yc)(27,"translate"),Object(i.yc)(28,"async"),Object(i.hc)(29,"mat-icon",9),Object(i.lc)(),Object(i.lc)(),Object(i.hc)(30,"igo-entity-table",10,11),Object(i.lc)()),2&e&&(Object(i.Tb)(2),Object(i.Dc)("value",t.activeMeasureType),Object(i.Tb)(1),Object(i.Dc)("value",t.measureType.Length),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(5,21,"igo.geo.measure."+t.measureType.Length)," "),Object(i.Tb)(2),Object(i.Dc)("value",t.measureType.Area),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(8,23,"igo.geo.measure."+t.measureType.Area)," "),Object(i.Tb)(3),Object(i.Dc)("checked",t.drawControlIsActive)("labelPosition","before"),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(12,25,"igo.geo.measure.toggleActive")," "),Object(i.Tb)(2),Object(i.Dc)("checked",t.showTooltips)("labelPosition","before"),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(15,27,"igo.geo.measure.toggleMapTooltips")," "),Object(i.Tb)(2),Object(i.Dc)("checked",t.measureUnitsAuto)("labelPosition","before"),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(18,29,"igo.geo.measure.toggleAutoUnits")," "),Object(i.Tb)(2),Object(i.Dc)("ngIf",Object(i.zc)(20,31,t.measure$)),Object(i.Tb)(3),Object(i.Dc)("matTooltip",Object(i.zc)(23,33,"igo.geo.measure.actionbar.calculate.tooltip"))("disabled",0===Object(i.zc)(24,35,t.selectedFeatures$).length),Object(i.Tb)(4),Object(i.Dc)("matTooltip",Object(i.zc)(27,37,"igo.geo.measure.actionbar.delete.tooltip"))("disabled",0===Object(i.zc)(28,39,t.selectedFeatures$).length),Object(i.Tb)(4),Object(i.Dc)("store",t.store)("template",t.tableTemplate))},styles:[".measure-type-toggle[_ngcontent-%COMP%]{padding:10px;text-align:center}.measure-type-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]{width:100%}.measure-type-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]{width:50%}.measure-options[_ngcontent-%COMP%]{overflow-x:hidden}.measure-options[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{margin:10px;width:100%}.measure-options[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content{width:calc(100% - 60px)}.measure-store-buttons[_ngcontent-%COMP%]{border-bottom:1px solid #ddd;border-top:1px solid #ddd;width:100%}.measure-store-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-of-type{margin-left:14px}.table-compact[_ngcontent-%COMP%]     .mat-header-cell.mat-column-selectionCheckbox{width:52px}"],changeDetection:0}),e})(),oh=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,Ue.m,Ue.C,c.b,ke.e,Ve.c,n.c,gn.c,ie]]}),e})(),ih=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},providers:[],imports:[[m.c,oh],oh]}),e})();function rh(e,t){if(1&e&&(Object(i.mc)(0,"button",2),Object(i.yc)(1,"translate"),Object(i.hc)(2,"mat-icon",3),Object(i.lc)()),2&e){const e=Object(i.xc)();Object(i.Dc)("matTooltip",Object(i.zc)(1,3,"igo.geo.filter.filterBy"))("color",e.color),Object(i.Tb)(2),Object(i.Dc)("matBadge",e.badge)}}function sh(e,t){if(1&e&&Object(i.hc)(0,"igo-time-filter-item",7),2&e){const e=Object(i.xc)(2);Object(i.Dc)("header",!1)("layer",e.layer)}}function ah(e,t){if(1&e&&(Object(i.mc)(0,"div",4,5),Object(i.Yc)(2,sh,1,2,"igo-time-filter-item",6),Object(i.lc)()),2&e){const e=Object(i.xc)();Object(i.Tb)(2),Object(i.Dc)("ngIf",e.timeFilterCollapse&&e.options.timeFilter)}}let nh=(()=>{class e{constructor(){this.color="primary",this.header=!0,this.timeFilterCollapse=!1}get badge(){const e=this.options.timeFilter;return e&&e.enabled?1:void 0}get layer(){return this._layer}set layer(e){this._layer=e,e&&(this.options=this.layer.dataSource.options)}ngOnInit(){this.options=this.layer.dataSource.options}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-time-filter-button"]],inputs:{layer:"layer",map:"map",color:"color",header:"header"},decls:2,vars:2,consts:[["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color",4,"ngIf"],["class","igo-layer-actions-container",4,"ngIf"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color"],["matBadgeColor","warn","matBadgeSize","medium","svgIcon","history",3,"matBadge"],[1,"igo-layer-actions-container"],["ogcFilter",""],["igoListItem","",3,"header","layer",4,"ngIf"],["igoListItem","",3,"header","layer"]],template:function(e,t){1&e&&(Object(i.Yc)(0,rh,3,5,"button",0),Object(i.Yc)(1,ah,3,1,"div",1)),2&e&&(Object(i.Dc)("ngIf",t.header&&t.options.timeFilterable&&t.options.timeFilter),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.header&&t.options.timeFilterable&&t.options.timeFilter))},styles:[""],changeDetection:0}),e})();function ch(e,t){if(1&e&&Object(i.hc)(0,"igo-time-filter-item",2),2&e){const e=t.$implicit;Object(i.Dc)("header",!0)("layer",e)}}let lh=(()=>{class e{constructor(e){this.cdRef=e,this._layers=[]}get layers(){return this._layers}set layers(e){this._layers=e,this.cdRef.detectChanges()}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(i.j))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-time-filter-list"]],inputs:{layers:"layers"},decls:3,vars:6,consts:[[3,"navigation","selection"],["ngFor","",3,"ngForOf"],["igoListItem","",3,"header","layer"]],template:function(e,t){1&e&&(Object(i.mc)(0,"igo-list",0),Object(i.Yc)(1,ch,1,2,"ng-template",1),Object(i.yc)(2,"filterableDataSource"),Object(i.lc)()),2&e&&(Object(i.Dc)("navigation",!1)("selection",!1),Object(i.Tb)(1),Object(i.Dc)("ngForOf",Object(i.Ac)(2,3,t.layers,"time")))},encapsulation:2,changeDetection:0}),e})();const uh=da;let dh=(()=>{class e{constructor(){this.defaultStepMillisecond=6e4}step(e,t){return e.options.stepDate?e.options.stepDate:t.step}stepMillisecond(e,t){const o=uh.duration(this.step(e,t)).asMilliseconds();return 0===o?this.defaultStepMillisecond:o}stepIsYearDuration(e){const t=uh.duration(e);return 0!==t.years()&&0===t.months()&&0===t.weeks()&&0===t.days()&&0===t.hours()&&0===t.minutes()}stepIsMonthDuration(e){const t=uh.duration(e);return 0!==t.months()&&0===t.weeks()&&0===t.days()&&0===t.hours()&&0===t.minutes()}stepIsWeekDuration(e){const t=uh.duration(e);return 0!==t.weeks()&&7===t.days()&&0===t.hours()&&0===t.minutes()}stepIsDayDuration(e){const t=uh.duration(e);return 0!==t.days()&&0===t.hours()&&0===t.minutes()}stepIsHourDuration(e){const t=uh.duration(e);return 0!==t.hours()&&0===t.minutes()}stepIsMinuteDuration(e){return 0!==uh.duration(e).minutes()}dateToNumber(e){let t=new Date;return e&&(t=new Date(e)),t.getTime()}addStep(e,t){return uh(e).add(t,"milliseconds").toDate()}subtractStep(e,t){return uh(e).subtract(t,"milliseconds").toDate()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac}),e})();function hh(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"mat-icon",8),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.xc)().toggleFiltersCollapsed()})),Object(i.lc)()}if(2&e){const e=Object(i.xc)(),t=Object(i.Kc)(6);Object(i.Dc)("target",t)("collapsed",e.filtersCollapsed)}}const ph=function(e){return{cursor:e}};function mh(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"h4",9),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.xc)().toggleLegendOnClick()})),Object(i.ad)(1),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Dc)("ngStyle",Object(i.Gc)(3,ph,e.filtersCollapsed?"default":"pointer"))("matTooltip",e.layer.title),Object(i.Tb)(1),Object(i.bd)(e.layer.title)}}function gh(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",10),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.xc)().addFilterToSequence()})),Object(i.yc)(1,"translate"),Object(i.hc)(2,"mat-icon",11),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Dc)("disabled",e.addFilterDisabled())("matTooltip",Object(i.zc)(1,3,"igo.geo.filter.addFilter"))("color",e.color)}}const bh=function(e){return{disabled:e}};function fh(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",12),Object(i.tc)("click",(function(){Object(i.Nc)(e);const t=Object(i.xc)();return t.layer.visible=!t.layer.visible})),Object(i.yc)(1,"translate"),Object(i.yc)(2,"translate"),Object(i.hc)(3,"mat-icon",13),Object(i.yc)(4,"async"),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Dc)("color",e.layer.visible?"primary":"default")("matTooltip",e.layer.visible?Object(i.zc)(1,4,"igo.geo.layer.hideLayer"):Object(i.zc)(2,6,"igo.geo.layer.showLayer")),Object(i.Tb)(3),Object(i.Dc)("ngClass",Object(i.Gc)(10,bh,!Object(i.zc)(4,8,e.inResolutionRange$)))("svgIcon",e.layer.visible?"eye":"eye-off")}}function yh(e,t){if(1&e&&Object(i.hc)(0,"igo-layer-legend",17),2&e){const e=Object(i.xc)(2);Object(i.Dc)("layer",e.layer)}}function Oh(e,t){if(1&e&&(Object(i.mc)(0,"div",14,15),Object(i.Yc)(2,yh,1,1,"igo-layer-legend",16),Object(i.yc)(3,"async"),Object(i.lc)()),2&e){const e=Object(i.xc)();Object(i.Tb)(2),Object(i.Dc)("ngIf",Object(i.zc)(3,1,e.showLegend$))}}function vh(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"section",18),Object(i.hc)(1,"mat-divider"),Object(i.mc)(2,"mat-checkbox",19),Object(i.tc)("change",(function(t){return Object(i.Nc)(e),Object(i.xc)().changeOgcFilterType(t)}))("ngModelChange",(function(t){return Object(i.Nc)(e),Object(i.xc)().datasource.options.ogcFilters.advancedOgcFilters=t})),Object(i.ad)(3),Object(i.yc)(4,"translate"),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Tb)(2),Object(i.Dc)("ngModel",e.datasource.options.ogcFilters.advancedOgcFilters),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(4,2,"igo.geo.filter.advancedOgcFilters")," ")}}let jh=(()=>{class e{constructor(e){this.ogcFilterService=e,this.color="primary",this.defaultLogicalParent=ec.And,this.hasActiveSpatialFilter=!1,this.filtersAreEditable=!0,this.filtersCollapsed=!0,this.hasSelector=!1,this.showLegend$=new C.a(!1),this.inResolutionRange$=new C.a(!0),this.header=!0,this.ogcFilterWriter=new oc}get refreshFunc(){return this.refreshFilters.bind(this)}get datasource(){return this.layer.dataSource}ngOnInit(){const e=this.datasource.options.ogcFilters;switch((e.pushButtons&&e.pushButtons.bundles.length>0||e.checkboxes&&e.checkboxes.bundles.length>0||e.radioButtons&&e.radioButtons.bundles.length>0)&&(void 0===e.advancedOgcFilters&&(e.advancedOgcFilters=!1),this.hasSelector=!0),this.datasource.options.type){case"wms":this.ogcFilterService.setOgcWMSFiltersOptions(this.datasource);break;case"wfs":this.ogcFilterService.setOgcWFSFiltersOptions(this.datasource)}e&&(e.interfaceOgcFilters&&(this.lastRunOgcFilter=JSON.parse(JSON.stringify(e.interfaceOgcFilters)),e.interfaceOgcFilters.filter(e=>e.wkt_geometry).length>=1&&(this.hasActiveSpatialFilter=!0)),this.filtersAreEditable=!!e.editable&&e.editable),this.resolution$$=this.layer.map.viewController.resolution$.subscribe(()=>{this.inResolutionRange$.next(this.layer.isInResolutionsRange)})}ngOnDestroy(){this.resolution$$.unsubscribe()}addFilterToSequence(){this.filtersCollapsed=!1;const e=this.datasource.options.ogcFilters.interfaceOgcFilters||[],t=0===e.length?0:e[e.length-1].level;let o="";const i=this.datasource.options.sourceFields.filter(e=>!e.excludeFromOgcFilters);let r;i.length>0&&(o=void 0===i[0].name?"":i[0].name);const s=this.datasource.options;s.fieldNameGeometry?r=s.fieldNameGeometry:this.datasource.options.paramsWFS&&this.datasource.options.paramsWFS.fieldNameGeometry&&(r=this.datasource.options.paramsWFS.fieldNameGeometry);const a=this.ogcFilterWriter.computeAllowedOperators(this.datasource.options.sourceFields,o,this.datasource.options.ogcFilters.allowedOperatorsType),n=Object.keys(a)[0];e.push(this.ogcFilterWriter.addInterfaceFilter({propertyName:o,operator:n,active:!0,igoSpatialSelector:"fixedExtent",srsName:this.map.projection},r,t,this.defaultLogicalParent)),this.datasource.options.ogcFilters.interfaceOgcFilters=e}refreshFilters(e){!0===e&&(this.lastRunOgcFilter=void 0);const t=this.datasource.options.ogcFilters,o=t.interfaceOgcFilters?t.interfaceOgcFilters.filter(e=>!0===e.active):[];if(0===o.length&&(t.filters=void 0,t.filtered=!1),o.length>1&&(o[0].parentLogical=o[1].parentLogical),this.hasActiveSpatialFilter=0!==o.filter(e=>-1!==["Contains","Intersects","Within"].indexOf(e.operator)).length,JSON.stringify(this.lastRunOgcFilter)!==JSON.stringify(o)){if("wfs"===this.layer.dataSource.options.type)this.layer.dataSource.options.ogcFilters.filters=this.ogcFilterWriter.rebuiltIgoOgcFilterObjectFromSequence(o),this.layer.dataSource.ol.refresh();else if("wms"===this.layer.dataSource.options.type&&t.enabled){let e="";if(o.length>=1){const t=this.layer.dataSource,i=t.options.ogcFilters;i.filters=this.ogcFilterWriter.rebuiltIgoOgcFilterObjectFromSequence(o),e=this.ogcFilterWriter.buildFilter(i.filters,void 0,void 0,this.layer.dataSource.options.fieldNameGeometry,t.options)}this.ogcFilterService.filterByOgc(this.datasource,e),this.datasource.options.ogcFilters.filtered=0!==o.length}this.lastRunOgcFilter=JSON.parse(JSON.stringify(o))}this.layer.dataSource.setOgcFilters(t,!0)}setVisible(){this.layer.visible=!0}isAdvancedOgcFilters(){return this.datasource.options.ogcFilters.advancedOgcFilters}addFilterDisabled(){return!this.datasource.options.sourceFields||0===this.datasource.options.sourceFields.length}changeOgcFiltersAdvancedOgcFilters(e){this.datasource.options.ogcFilters.advancedOgcFilters=e}changeOgcFilterType(e){this.changeOgcFiltersAdvancedOgcFilters(e.checked),e.checked&&this.refreshFilters(!0)}toggleLegend(e){this.layer.legendCollapsed=e,this.showLegend$.next(!e)}toggleLegendOnClick(){this.filtersCollapsed||this.toggleLegend(this.showLegend$.value)}toggleFiltersCollapsed(){this.filtersCollapsed=!this.filtersCollapsed}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(Uu))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-ogc-filterable-item"]],inputs:{layer:"layer",map:"map",header:"header"},decls:10,vars:9,consts:[["class","igo-chevron","mat-list-avatar","","igoCollapse","","svgIcon","chevron-up",3,"target","collapsed","click",4,"ngIf"],["matLine","","matTooltipShowDelay","500",3,"ngStyle","matTooltip","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"disabled","matTooltip","color","click",4,"ngIf"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"color","matTooltip","click",4,"ngIf"],["ogcFilters",""],["class","igo-layer-legend-container",4,"ngIf"],[3,"datasource","map","refreshFilters"],["class","mat-typography advancedOgcFilters",4,"ngIf"],["mat-list-avatar","","igoCollapse","","svgIcon","chevron-up",1,"igo-chevron",3,"target","collapsed","click"],["matLine","","matTooltipShowDelay","500",3,"ngStyle","matTooltip","click"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"disabled","matTooltip","color","click"],["svgIcon","plus"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"color","matTooltip","click"],[3,"ngClass","svgIcon"],[1,"igo-layer-legend-container"],["legend",""],[3,"layer",4,"ngIf"],[3,"layer"],[1,"mat-typography","advancedOgcFilters"],["labelPosition","before",3,"ngModel","change","ngModelChange"]],template:function(e,t){1&e&&(Object(i.mc)(0,"mat-list-item"),Object(i.Yc)(1,hh,1,2,"mat-icon",0),Object(i.Yc)(2,mh,2,5,"h4",1),Object(i.Yc)(3,gh,3,5,"button",2),Object(i.Yc)(4,fh,5,12,"button",3),Object(i.lc)(),Object(i.mc)(5,"div",null,4),Object(i.Yc)(7,Oh,4,3,"div",5),Object(i.hc)(8,"igo-ogc-filterable-form",6),Object(i.Yc)(9,vh,5,4,"section",7),Object(i.lc)()),2&e&&(Object(i.Tb)(1),Object(i.Dc)("ngIf",t.header),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.header),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.isAdvancedOgcFilters()&&t.filtersAreEditable),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.header),Object(i.Tb)(3),Object(i.Dc)("ngIf",t.header),Object(i.Tb)(1),Object(i.Dc)("datasource",t.datasource)("map",t.map)("refreshFilters",t.refreshFunc),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.hasSelector&&t.filtersAreEditable))},styles:["[_nghost-%COMP%]{overflow:hidden}.advancedOgcFilters[_ngcontent-%COMP%]{display:inline-block;text-align:center;width:100%}.mat-list-item[_ngcontent-%COMP%]{height:auto}.igo-layer-legend-container[_ngcontent-%COMP%]{padding-left:1.125em;width:calc(100% - 18px)}mat-icon.disabled[_ngcontent-%COMP%]{color:rgba(0,0,0,.38)}"]}),e})();function wh(e,t){if(1&e&&Object(i.hc)(0,"igo-ogc-filterable-item",2),2&e){const e=t.$implicit;Object(i.Dc)("header",!0)("layer",e)("map",e.map)}}let Sh=(()=>{class e{constructor(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-ogc-filterable-list"]],inputs:{layers:"layers",map:"map"},decls:3,vars:6,consts:[[3,"navigation","selection"],["ngFor","",3,"ngForOf"],["igoListItem","",3,"header","layer","map"]],template:function(e,t){1&e&&(Object(i.mc)(0,"igo-list",0),Object(i.Yc)(1,wh,1,3,"ng-template",1),Object(i.yc)(2,"filterableDataSource"),Object(i.lc)()),2&e&&(Object(i.Dc)("navigation",!1)("selection",!1),Object(i.Tb)(1),Object(i.Dc)("ngForOf",Object(i.Ac)(2,3,t.layers,"ogc")))},encapsulation:2,changeDetection:0}),e})();function xh(e,t){if(1&e&&(Object(i.mc)(0,"button",2),Object(i.yc)(1,"translate"),Object(i.hc)(2,"mat-icon",3),Object(i.lc)()),2&e){const e=Object(i.xc)();Object(i.Dc)("matTooltip",Object(i.zc)(1,3,"igo.geo.filter.filterBy"))("color",e.color),Object(i.Tb)(2),Object(i.Dc)("matBadge",e.badge)}}function Ch(e,t){if(1&e&&Object(i.hc)(0,"igo-ogc-filterable-item",7),2&e){const e=Object(i.xc)(2);Object(i.Dc)("header",!1)("map",e.layer.map)("layer",e.layer)}}function Th(e,t){if(1&e&&(Object(i.mc)(0,"div",4,5),Object(i.Yc)(2,Ch,1,3,"igo-ogc-filterable-item",6),Object(i.lc)()),2&e){const e=Object(i.xc)();Object(i.Tb)(2),Object(i.Dc)("ngIf",e.ogcFilterCollapse&&e.options.ogcFilters.enabled)}}let Lh=(()=>{class e{constructor(){this.color="primary",this.ogcFilterCollapse=!1}get badge(){const e=this.options.ogcFilters;if(!e||e.advancedOgcFilters)return e&&e.filters&&!e.filters.filters?1:e&&e.filters&&e.filters.filters?e.filters.filters.length:void 0;if(e.pushButtons){const t=e.pushButtons.groups.find(e=>e.enabled);let o=0;return t&&t.computedSelectors.map(e=>o+=e.selectors.filter(e=>e.enabled).length),o>0?o:void 0}if(e.checkboxes){const t=e.checkboxes.groups.find(e=>e.enabled);let o=0;return t&&t.computedSelectors.map(e=>o+=e.selectors.filter(e=>e.enabled).length),o>0?o:void 0}if(e.radioButtons){const t=e.radioButtons.groups.find(e=>e.enabled);let o=0;return t&&t.computedSelectors.map(e=>o+=e.selectors.filter(e=>e.enabled).length),o>0?o:void 0}}get layer(){return this._layer}set layer(e){this._layer=e,e&&(this.options=this.layer.dataSource.options)}ngOnInit(){this.options=this.layer.dataSource.options}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-ogc-filter-button"]],inputs:{layer:"layer",map:"map",color:"color",header:"header"},decls:2,vars:2,consts:[["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color",4,"ngIf"],["class","igo-layer-actions-container",4,"ngIf"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color"],["matBadgeColor","warn","matBadgeSize","medium","svgIcon","filter",3,"matBadge"],[1,"igo-layer-actions-container"],["ogcFilter",""],["igoListItem","",3,"header","map","layer",4,"ngIf"],["igoListItem","",3,"header","map","layer"]],template:function(e,t){1&e&&(Object(i.Yc)(0,xh,3,5,"button",0),Object(i.Yc)(1,Th,3,1,"div",1)),2&e&&(Object(i.Dc)("ngIf",t.header&&t.options.ogcFilters&&t.options.ogcFilters.enabled&&(t.options.ogcFilters.pushButtons||t.options.ogcFilters.checkboxes||t.options.ogcFilters.radioButtons||t.options.ogcFilters.editable)),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.options.ogcFilters&&t.options.ogcFilters.enabled&&(t.options.ogcFilters.pushButtons||t.options.ogcFilters.checkboxes||t.options.ogcFilters.radioButtons||t.options.ogcFilters.editable)))},styles:[""],changeDetection:0}),e})();function Ih(e,t){if(1&e&&(Object(i.mc)(0,"mat-option",10),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()),2&e){const e=t.$implicit;Object(i.Dc)("value",e),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(2,2,"igo.geo.terrapi."+e)," ")}}let Fh=(()=>{class e{constructor(){this.queryType=["Arrond","CircFed","CircProv","DirReg","Mun","MRC","AdmRegion","RegTour"],this.selectedTypeIndex=new Ue.h(0),this.spatialType=Hu,this.activeDrawType=this.spatialType.Polygon,this.layers=[],this.eventType=new i.u,this.eventQueryType=new i.u,this.zoneChange=new i.u,this.zoneWithBufferChange=new i.u,this.bufferChange=new i.u,this.measureUnitChange=new i.u}get store(){return this._store}set store(e){this._store=e}ngOnInit(){0===this.selectedTypeIndex.value&&(this.type=this.spatialType.Predefined),1===this.selectedTypeIndex.value&&(this.type=this.activeDrawType),this.eventType.emit(this.type)}onTypeChange(e){0===this.selectedTypeIndex.value&&(this.type=Hu.Predefined),1===this.selectedTypeIndex.value&&(this.type=this.activeDrawType),this.eventType.emit(this.type)}onDrawTypeChange(e){this.activeDrawType=e,this.eventType.emit(this.activeDrawType)}onSelectionChange(){this.eventQueryType.emit(this.selectedQueryType),this.zoneChange.emit(void 0)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-spatial-filter-type"]],inputs:{store:"store",selectedQueryType:"selectedQueryType",zone:"zone",layers:"layers"},outputs:{eventType:"eventType",eventQueryType:"eventQueryType",zoneChange:"zoneChange",zoneWithBufferChange:"zoneWithBufferChange",bufferChange:"bufferChange",measureUnitChange:"measureUnitChange"},decls:20,vars:25,consts:[[3,"selectedIndex","selectedIndexChange","selectedTabChange"],[3,"label"],[3,"value","selectionChange","valueChange"],[3,"value",4,"ngFor","ngForOf"],[3,"store","queryType","zone","layers","zoneChange","zoneWithBufferChange","bufferChange","measureUnitChange"],[1,"spatial-type-toggle"],[3,"value","change"],[3,"value","matTooltip"],["svgIcon","pentagon-outline"],["svgIcon","record-circle-outline"],[3,"value"]],template:function(e,t){1&e&&(Object(i.mc)(0,"mat-tab-group",0),Object(i.tc)("selectedIndexChange",(function(e){return t.selectedTypeIndex.setValue(e)}))("selectedTabChange",(function(e){return t.onTypeChange(e)})),Object(i.mc)(1,"mat-tab",1),Object(i.yc)(2,"translate"),Object(i.mc)(3,"mat-form-field"),Object(i.mc)(4,"mat-label"),Object(i.ad)(5),Object(i.yc)(6,"translate"),Object(i.lc)(),Object(i.mc)(7,"mat-select",2),Object(i.tc)("selectionChange",(function(){return t.onSelectionChange()}))("valueChange",(function(e){return t.selectedQueryType=e})),Object(i.Yc)(8,Ih,3,4,"mat-option",3),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(9,"igo-spatial-filter-list",4),Object(i.tc)("zoneChange",(function(e){return t.zoneChange.emit(e)}))("zoneWithBufferChange",(function(e){return t.zoneWithBufferChange.emit(e)}))("bufferChange",(function(e){return t.bufferChange.emit(e)}))("measureUnitChange",(function(e){return t.measureUnitChange.emit(e)})),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(10,"mat-tab",1),Object(i.yc)(11,"translate"),Object(i.mc)(12,"div",5),Object(i.mc)(13,"mat-button-toggle-group",6),Object(i.tc)("change",(function(e){return t.onDrawTypeChange(e.value)})),Object(i.mc)(14,"mat-button-toggle",7),Object(i.yc)(15,"translate"),Object(i.hc)(16,"mat-icon",8),Object(i.lc)(),Object(i.mc)(17,"mat-button-toggle",7),Object(i.yc)(18,"translate"),Object(i.hc)(19,"mat-icon",9),Object(i.lc)(),Object(i.lc)(),Object(i.lc)(),Object(i.lc)(),Object(i.lc)()),2&e&&(Object(i.Dc)("selectedIndex",t.selectedTypeIndex.value),Object(i.Tb)(1),Object(i.Dc)("label",Object(i.zc)(2,15,"igo.geo.spatialFilter.predefined")),Object(i.Tb)(4),Object(i.bd)(Object(i.zc)(6,17,"igo.geo.spatialFilter.searchLabel")),Object(i.Tb)(2),Object(i.Dc)("value",t.selectedQueryType),Object(i.Tb)(1),Object(i.Dc)("ngForOf",t.queryType),Object(i.Tb)(1),Object(i.Dc)("store",t.store)("queryType",t.selectedQueryType)("zone",t.zone)("layers",t.layers),Object(i.Tb)(1),Object(i.Dc)("label",Object(i.zc)(11,19,"igo.geo.spatialFilter.draw")),Object(i.Tb)(3),Object(i.Dc)("value",t.activeDrawType),Object(i.Tb)(1),Object(i.Dc)("value",t.spatialType.Polygon)("matTooltip",Object(i.zc)(15,21,"igo.geo.spatialFilter.drawPolygon")),Object(i.Tb)(3),Object(i.Dc)("value",t.spatialType.Point)("matTooltip",Object(i.zc)(18,23,"igo.geo.spatialFilter.drawCircle")))},styles:[".mat-form-field[_ngcontent-%COMP%]{margin-left:2px;padding:5px;width:95%}.mat-tab-group[_ngcontent-%COMP%]     .mat-tab-body-content{overflow:hidden}.mat-tab-group[_ngcontent-%COMP%]     .mat-tab-label{padding:10px}.mat-tab-group[_ngcontent-%COMP%]     .mat-tab-body-wrapper{margin-top:5px}.spatial-type-toggle[_ngcontent-%COMP%]{padding:10px;text-align:center}.spatial-type-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%], .spatial-type-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]{width:50%}"],changeDetection:0}),e})();function Mh(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"mat-slide-toggle",15),Object(i.tc)("change",(function(){return Object(i.Nc)(e),Object(i.xc)().onDrawControlChange()})),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Dc)("checked",e.drawControlIsActive)("labelPosition","before"),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(2,3,"igo.geo.spatialFilter.drawControl")," ")}}function kh(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"mat-slide-toggle",15),Object(i.tc)("change",(function(){return Object(i.Nc)(e),Object(i.xc)().onfreehandControlChange()})),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Dc)("checked",e.freehandDrawIsActive)("labelPosition","before"),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(2,3,"igo.geo.spatialFilter.freehandControl")," ")}}function Dh(e,t){if(1&e&&(Object(i.mc)(0,"mat-option",6),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()),2&e){const e=t.$implicit;Object(i.Dc)("value",e),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(2,2,"igo.geo.measure."+e)," ")}}function Ph(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"div",16),Object(i.mc)(1,"form",17),Object(i.mc)(2,"mat-form-field",18),Object(i.hc)(3,"input",19),Object(i.yc)(4,"translate"),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(5,"mat-form-field",20),Object(i.mc)(6,"mat-select",21),Object(i.tc)("selectionChange",(function(t){return Object(i.Nc)(e),Object(i.xc)().onMeasureUnitChange(t.value)})),Object(i.Yc)(7,Dh,3,4,"mat-option",22),Object(i.lc)(),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Tb)(3),Object(i.Ec)("placeholder",Object(i.zc)(4,6,"igo.geo.spatialFilter.buffer")),Object(i.Dc)("formControl",e.bufferFormControl)("value",0)("readonly",null===e.formControl.value),Object(i.Tb)(3),Object(i.Dc)("value",e.measureUnit),Object(i.Tb)(1),Object(i.Dc)("ngForOf",e.measureUnits)}}function Ah(e,t){if(1&e&&(Object(i.mc)(0,"mat-option",6),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()),2&e){const e=t.$implicit;Object(i.Dc)("value",e),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(2,2,"igo.geo.measure."+e)," ")}}function $h(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"div",23),Object(i.mc)(1,"form",24),Object(i.mc)(2,"mat-form-field",25),Object(i.mc)(3,"input",26),Object(i.tc)("input",(function(){return Object(i.Nc)(e),Object(i.xc)().getRadius()})),Object(i.yc)(4,"translate"),Object(i.lc)(),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(5,"mat-form-field",20),Object(i.mc)(6,"mat-select",21),Object(i.tc)("selectionChange",(function(t){return Object(i.Nc)(e),Object(i.xc)().onMeasureUnitChange(t.value)})),Object(i.Yc)(7,Ah,3,4,"mat-option",22),Object(i.lc)(),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Tb)(3),Object(i.Ec)("placeholder",Object(i.zc)(4,6,"igo.geo.spatialFilter.radius")),Object(i.Dc)("formControl",e.radiusFormControl)("value",1e3)("readonly",e.freehandDrawIsActive&&null===e.formControl.value),Object(i.Tb)(3),Object(i.Dc)("value",e.measureUnit),Object(i.Tb)(1),Object(i.Dc)("ngForOf",e.measureUnits)}}function Eh(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"mat-radio-button",27),Object(i.tc)("change",(function(t){return Object(i.Nc)(e),Object(i.xc)().onItemTypeChange(t)})),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()}if(2&e){const e=t.$implicit;Object(i.Dc)("value",e),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(2,2,"igo.geo.spatialFilter."+e)," ")}}function Rh(e,t){1&e&&(Object(i.mc)(0,"mat-header-cell",38),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()),2&e&&(Object(i.Tb)(1),Object(i.bd)(Object(i.zc)(2,1,"igo.geo.spatialFilter.Thematics")))}function _h(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"mat-header-cell",39),Object(i.mc)(1,"mat-checkbox",40),Object(i.tc)("change",(function(t){Object(i.Nc)(e);const o=Object(i.xc)(2);return t?o.masterToggle():null})),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=Object(i.xc)(2);Object(i.Tb)(1),Object(i.Dc)("checked",e.isAllSelected())("indeterminate",e.selectedThematics.hasValue()&&!e.isAllSelected())}}function zh(e,t){1&e&&Object(i.hc)(0,"mat-header-row")}function Nh(e,t){1&e&&Object(i.hc)(0,"mat-row")}function Bh(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"mat-tree-node",41),Object(i.mc)(1,"li",42),Object(i.hc)(2,"button",43),Object(i.ad)(3),Object(i.mc)(4,"mat-checkbox",44),Object(i.tc)("click",(function(t){return Object(i.Nc)(e),t.stopPropagation()}))("change",(function(o){Object(i.Nc)(e);const r=t.$implicit,s=Object(i.xc)(2);return o?s.onToggleChange(r):null})),Object(i.lc)(),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=t.$implicit,o=Object(i.xc)(2);Object(i.Tb)(3),Object(i.cd)(" ",e.name," "),Object(i.Tb)(1),Object(i.Dc)("checked",o.selectedThematics.isSelected(e))}}function qh(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"mat-nested-tree-node"),Object(i.mc)(1,"div",42),Object(i.mc)(2,"button",45),Object(i.tc)("click",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)(2).onToggleClick(o)})),Object(i.hc)(3,"mat-icon",46),Object(i.lc)(),Object(i.ad)(4),Object(i.mc)(5,"mat-checkbox",47),Object(i.tc)("change",(function(o){Object(i.Nc)(e);const r=t.$implicit,s=Object(i.xc)(2);return o?s.childrensToggle(r):null})),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(6,"ul",48),Object(i.ic)(7,49),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=t.$implicit,o=Object(i.xc)(2);Object(i.Tb)(3),Object(i.Dc)("svgIcon",o.treeControl.isExpanded(e)?"chevron-down":"chevron-right"),Object(i.Tb)(1),Object(i.cd)(" ",e.name," "),Object(i.Tb)(1),Object(i.Dc)("checked",o.isAllSelected(e))("indeterminate",o.hasChildrenSelected(e)&&!o.isAllSelected(e)),Object(i.Tb)(1),Object(i.Yb)("example-tree-invisible",!o.treeControl.isExpanded(e))}}function Gh(e,t){if(1&e&&(Object(i.mc)(0,"div",28),Object(i.mc)(1,"mat-table"),Object(i.kc)(2,29),Object(i.Yc)(3,Rh,3,3,"mat-header-cell",30),Object(i.jc)(),Object(i.kc)(4,31),Object(i.Yc)(5,_h,2,2,"mat-header-cell",32),Object(i.jc)(),Object(i.Yc)(6,zh,1,0,"mat-header-row",33),Object(i.Yc)(7,Nh,1,0,"mat-row",34),Object(i.lc)(),Object(i.mc)(8,"mat-tree",35),Object(i.Yc)(9,Bh,5,2,"mat-tree-node",36),Object(i.Yc)(10,qh,8,6,"mat-nested-tree-node",37),Object(i.lc)(),Object(i.lc)()),2&e){const e=Object(i.xc)();Object(i.Tb)(6),Object(i.Dc)("matHeaderRowDef",e.displayedColumns),Object(i.Tb)(1),Object(i.Dc)("matRowDefColumns",e.displayedColumns),Object(i.Tb)(1),Object(i.Dc)("dataSource",e.dataSource)("treeControl",e.treeControl),Object(i.Tb)(2),Object(i.Dc)("matTreeNodeDefWhen",e.hasChild)}}function Vh(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",50),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.xc)().clearSearch()})),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Dc)("disabled",e.disabledClearSearch()),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(2,2,"igo.geo.spatialFilter.clearSearch")," ")}}function Uh(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",51),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.xc)().clearDrawZone()})),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Dc)("disabled",null===e.formControl.value),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(2,2,"igo.geo.spatialFilter.clearForm")," ")}}let Hh=(()=>{class e{constructor(e,t,o,r){this.cdRef=e,this.spatialFilterService=t,this.messageService=o,this.languageService=r,this.layers=[],this.allLayers=[],this.toggleSearch=new i.u,this.itemTypeChange=new i.u,this.thematicChange=new i.u,this.drawZoneEvent=new i.u,this.bufferEvent=new i.u,this.zoneWithBufferChange=new i.u,this.measureUnitChange=new i.u,this.radiusEvent=new i.u,this.freehandControl=new i.u,this.clearButtonEvent=new i.u,this.clearSearchEvent=new i.u,this.export=new i.u,this.openWorkspace=new i.u,this.itemType=[Yu.Address,Yu.Thematics],this.selectedItemType=Yu.Address,this.treeControl=new Mn.j(e=>e.children),this.displayedColumns=["name","select"],this.childrens=[],this.groups=[],this.thematics=[],this.dataSource=new Cn.d,this.selectedThematics=new We.c(!0,[]),this.value$=new C.a(void 0),this.drawGuide$=new C.a(null),this.overlayStyle$=new C.a(void 0),this.drawStyle$=new C.a(void 0),this.formControl=new Ue.h,this.geometryTypeField=!1,this.geometryTypes=["Point","Polygon"],this.drawGuideField=!1,this.drawGuide=null,this.drawGuidePlaceholder="",this.measure=!1,this.drawControlIsActive=!0,this.freehandDrawIsActive=!1,this.buffer=0,this.radiusFormControl=new Ue.h,this.bufferFormControl=new Ue.h,this.measureUnit=yd.Meters}get type(){return this._type}set type(e){this._type=e;const t=this.geometryTypes.findIndex(e=>e===this.type);this.geometryType=this.geometryTypes[t],this.formControl.reset(),this.radius=void 0,this.drawGuide$.next(null),this.drawStyle$.next(void 0),this.type===Hu.Predefined&&this.formControl.setValue({type:"Point",coordinates:""}),this.type===Hu.Point?(this.radius=1e3,this.radiusFormControl.setValue(this.radius),this.PointStyle=(e,t)=>{const o=Object(sa.s)(e.getGeometry().getCoordinates(),this.map.projection,"EPSG:4326");return new Ra.Style({image:new Ra.Circle({radius:this.radius/Math.cos(Math.PI/180*o[1])/t,stroke:new Ra.Stroke({width:2,color:"rgba(0, 153, 255)"}),fill:new Ra.Fill({color:"rgba(0, 153, 255, 0.2)"})})})},this.overlayStyle=this.PointStyle,this.drawStyle$.next(this.overlayStyle)):(this.radius=void 0,this.PolyStyle=(e,t)=>new Ra.Style({stroke:new Ra.Stroke({width:2,color:"rgba(0, 153, 255)"}),fill:new Ra.Fill({color:"rgba(0, 153, 255, 0.2)"})}),this.overlayStyle=this.PolyStyle),this.overlayStyle$.next(this.overlayStyle)}get store(){return this._store}set store(e){this._store=e,this._store.entities$.subscribe(()=>{this.cdRef.detectChanges()})}get measureUnits(){return[yd.Meters,yd.Kilometers]}get thematicLength(){return this._thematicLength}set thematicLength(e){this._thematicLength=e}ngOnInit(){this.spatialFilterService.loadThematicsList().subscribe(e=>{for(const o of e)this.childrens.push(o),this.childrens.sort((e,t)=>e.name.localeCompare(t.name));this.groups.push(this.languageService.translate.instant("igo.geo.terrapi.limites"));const t={name:this.groups[0],children:[]};this.thematics.push(t),this.childrens.forEach(e=>{e.group&&-1===this.groups.indexOf(e.group)&&(this.groups.push(e.group),this.thematics.push({name:e.group,children:[]})),e.group||(e.name===this.languageService.translate.instant("igo.geo.terrapi.AdmRegion")||e.name===this.languageService.translate.instant("igo.geo.terrapi.Mun")||e.name===this.languageService.translate.instant("igo.geo.terrapi.Arrond")||e.name===this.languageService.translate.instant("igo.geo.terrapi.CircFed")||e.name===this.languageService.translate.instant("igo.geo.terrapi.CircProv")||e.name===this.languageService.translate.instant("igo.geo.terrapi.DirReg")||e.name===this.languageService.translate.instant("igo.geo.terrapi.MRC")||e.name===this.languageService.translate.instant("igo.geo.terrapi.RegTour")?e.group=t.name:e.name===this.languageService.translate.instant("igo.geo.terrapi.routes")?e.group=this.languageService.translate.instant("igo.geo.spatialFilter.group.transport"):this.thematics.push({name:e.name,children:[],source:e.source})),this.thematics.sort((e,t)=>e.name.localeCompare(t.name))}),this.thematics.forEach(e=>{for(const t of this.childrens)t.group===e.name&&e.children.push(t)})}),this.dataSource.data=this.thematics,this.drawGuide$.next(null),this.value$.next(this.formControl.value?this.formControl.value:void 0),this.value$$=this.formControl.valueChanges.subscribe(e=>{e?(this.value$.next(e),this.drawZone=this.formControl.value,0!==this.buffer&&(this.drawZoneEvent.emit(this.drawZone),this.bufferFormControl.setValue(this.buffer))):(this.value$.next(void 0),this.drawZone=void 0)}),this.value$.subscribe(()=>{this.getRadius(),this.cdRef.detectChanges()}),this.radiusChanges$$=this.radiusFormControl.valueChanges.subscribe(()=>{this.getRadius(),this.cdRef.detectChanges()}),this.bufferChanges$$=this.bufferFormControl.valueChanges.pipe(Object(S.a)(500)).subscribe(e=>{this.measureUnit===yd.Meters&&e>0&&e<=1e5?(this.buffer=e,this.bufferEvent.emit(e),this.spatialFilterService.loadBufferGeometry(this.drawZone,Hu.Polygon,e).subscribe(e=>{this.zoneWithBuffer=e,this.zoneWithBufferChange.emit(this.zoneWithBuffer)})):this.measureUnit===yd.Kilometers&&e>0&&e<=100?(this.buffer=e,this.bufferEvent.emit(e),this.spatialFilterService.loadBufferGeometry(this.drawZone,Hu.Polygon,1e3*e).subscribe(e=>{this.zoneWithBuffer=e,this.zoneWithBufferChange.emit(this.zoneWithBuffer)})):0===e?(this.buffer=e,this.bufferEvent.emit(e),this.drawZoneEvent.emit(this.drawZone)):(e<0||this.measureUnit===yd.Meters&&e>1e5||this.measureUnit===yd.Kilometers&&e>100)&&(this.bufferFormControl.setValue(0),this.buffer=0,this.messageService.alert(this.languageService.translate.instant("igo.geo.spatialFilter.bufferAlert"),this.languageService.translate.instant("igo.geo.spatialFilter.warning")))})}ngOnDestroy(){this.value$$.unsubscribe(),this.radiusChanges$$.unsubscribe(),this.bufferChanges$$.unsubscribe(),this.cdRef.detach(),this.radiusChanges$$&&this.radiusChanges$$.unsubscribe(),this.value$$&&this.value$$.unsubscribe()}onItemTypeChange(e){this.selectedItemType=e.value,this.itemTypeChange.emit(this.selectedItemType)}onMeasureUnitChange(e){e!==this.measureUnit&&(this.measureUnit=e,this.measureUnitChange.emit(this.measureUnit),this.isPolygon()?this.bufferFormControl.setValue(this.measureUnit===yd.Meters?1e3*this.bufferFormControl.value:this.bufferFormControl.value/1e3):this.isPoint()&&this.radiusFormControl.setValue(this.measureUnit===yd.Meters?1e3*this.radiusFormControl.value:this.radiusFormControl.value/1e3))}isPredefined(){return this.type===Hu.Predefined}isPolygon(){return this.type===Hu.Polygon}isPoint(){return this.type===Hu.Point}hasChild(e,t){return!!t.children&&t.children.length}onToggleClick(e){this.treeControl.isExpanded(e)?this.treeControl.collapse(e):this.treeControl.expand(e)}isAllSelected(e){let t,o=0;return e?(t=e.children.length,e.children.forEach(e=>{this.selectedThematics.selected.find(t=>t===e)&&o++})):(t=this.selectedThematics.selected.length,this.thematics.forEach(e=>{-1===this.groups.indexOf(e.name)&&o++}),this.childrens.forEach(e=>{this.thematics.find(t=>t.source===e.source)||o++})),o>=1&&t===o}hasChildrenSelected(e){let t=!1;return e.children.forEach(e=>{this.selectedThematics.selected.find(t=>t.source===e.source)&&(t=!0)}),t}masterToggle(){this.isAllSelected()?this.selectedThematics.clear():this.selectAll();const e=[];for(const t of this.selectedThematics.selected)e.push(t);this.isAllSelected()?this.thematics.forEach(e=>{this.hasChild(0,e)&&this.treeControl.expand(e)}):this.thematics.forEach(e=>{this.hasChild(0,e)&&this.treeControl.collapse(e)}),this.thematicChange.emit(e)}selectAll(e){e?this.hasChild(0,e)&&e.children.forEach(e=>this.selectedThematics.select(e)):(this.thematics.forEach(e=>{-1===this.groups.indexOf(e.name)&&this.selectedThematics.select(e)}),this.childrens.forEach(e=>{this.selectedThematics.selected.find(t=>t.source===e.source)||this.selectedThematics.select(e)}))}childrensToggle(e){this.isAllSelected(e)?e.children.forEach(e=>this.selectedThematics.deselect(e)):this.selectAll(e);const t=[];for(const o of this.selectedThematics.selected)t.push(o);this.treeControl.expand(e),this.thematicChange.emit(t)}onToggleChange(e){let t=!1;void 0!==this.selectedThematics.selected.find(t=>t.source===e.source)&&(t=!0),this.childrens.forEach(o=>{o===e&&!1===t&&this.selectedThematics.select(o),o===e&&!0===t&&this.selectedThematics.deselect(o)}),this.thematics.forEach(o=>{o===e&&!1===t&&this.selectedThematics.select(o),o===e&&!0===t&&this.selectedThematics.deselect(o)});const o=[];for(const i of this.selectedThematics.selected)o.push(i);this.thematicChange.emit(o)}onDrawControlChange(){this.drawControlIsActive=!this.drawControlIsActive}onfreehandControlChange(){this.freehandDrawIsActive=!this.freehandDrawIsActive,this.freehandControl.emit(this.freehandDrawIsActive)}toggleSearchButton(){this.isPredefined()||(this.buffer>0?(this.zoneWithBuffer.meta={id:void 0,title:"Zone"},this.zoneWithBuffer.properties={nom:"Zone",type:this.type},this.drawZoneEvent.emit(this.zoneWithBuffer)):(this.drawZone.meta={id:void 0,title:"Zone"},this.drawZone.properties={nom:"Zone",type:this.type},this.drawZoneEvent.emit(this.drawZone))),this.isPoint()?this.radiusEvent.emit(this.radius):this.isPolygon()&&this.bufferEvent.emit(this.buffer),this.toggleSearch.emit(),this.store.entities$.subscribe(e=>{e.length&&this.layers.length===this.thematicLength+1&&this.openWorkspace.emit()})}clearButton(){this.loading=!0,this.store&&this.store.clear(),(this.isPoint()||this.isPolygon())&&(this.drawZone=void 0,this.formControl.reset()),this.bufferFormControl.setValue(0),this.buffer=0,this.bufferEvent.emit(0),this.clearButtonEvent.emit(),this.loading=!1}clearDrawZone(){this.formControl.reset(),this.bufferFormControl.setValue(0),this.buffer=0}clearSearch(){this.selectedThematics.clear(),this.bufferFormControl.setValue(0),this.buffer=0,this.bufferEvent.emit(0),this.thematicChange.emit([]),this.clearSearchEvent.emit()}disableSearchButton(){if(this.type===Hu.Predefined){if(this.selectedItemType===Yu.Address&&void 0!==this.queryType&&void 0!==this.zone)return this.loading;if(this.selectedItemType===Yu.Thematics&&void 0!==this.queryType&&void 0!==this.zone&&this.selectedThematics.selected.length>0)return this.loading}if(this.type===Hu.Polygon||this.type===Hu.Point){if(this.selectedItemType===Yu.Address&&null!==this.formControl.value)return this.loading;if(this.selectedItemType===Yu.Thematics&&this.selectedThematics.selected.length>0&&null!==this.formControl.value)return this.loading}return!0}disabledClearSearch(){let e=!0;return e=this.selectedItemType===Yu.Address?void 0===this.queryType:void 0===this.queryType&&0===this.selectedThematics.selected.length,e}getRadius(){let e;if(e=null!==this.formControl.value?this.measureUnit===yd.Meters?this.formControl.value.radius:this.formControl.value.radius/1e3:void 0,this.type===Hu.Point){if(this.freehandDrawIsActive){if(e){if(e>=1e5)return this.messageService.alert(this.languageService.translate.instant("igo.geo.spatialFilter.radiusAlert"),this.languageService.translate.instant("igo.geo.spatialFilter.warning")),void this.formControl.reset();if(e!==this.radiusFormControl.value)return void this.radiusFormControl.setValue(e)}}else if(this.radiusFormControl.value<0||this.measureUnit===yd.Meters&&this.radiusFormControl.value>=1e5||this.measureUnit===yd.Kilometers&&this.radiusFormControl.value>=100)return this.messageService.alert(this.languageService.translate.instant("igo.geo.spatialFilter.radiusAlert"),this.languageService.translate.instant("igo.geo.spatialFilter.warning")),this.radius=1e3,this.radiusFormControl.setValue(this.measureUnit===yd.Meters?this.radius:this.radius/1e3),void this.drawGuide$.next(this.radius);this.measureUnit===yd.Meters?(this.radius=this.radiusFormControl.value,this.drawGuide$.next(this.radius)):(this.radius=1e3*this.radiusFormControl.value,this.drawGuide$.next(1e3*this.radius)),this.overlayStyle$.next(this.PointStyle),this.drawStyle$.next(this.PointStyle)}}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(i.j),Object(i.gc)(Wu),Object(i.gc)(ce),Object(i.gc)(le))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-spatial-filter-item"]],inputs:{map:"map",type:"type",queryType:"queryType",zone:"zone",loading:"loading",store:"store",layers:"layers",allLayers:"allLayers",thematicLength:"thematicLength"},outputs:{toggleSearch:"toggleSearch",itemTypeChange:"itemTypeChange",thematicChange:"thematicChange",drawZoneEvent:"drawZoneEvent",bufferEvent:"bufferEvent",zoneWithBufferChange:"zoneWithBufferChange",measureUnitChange:"measureUnitChange",radiusEvent:"radiusEvent",freehandControl:"freehandControl",clearButtonEvent:"clearButtonEvent",clearSearchEvent:"clearSearchEvent",export:"export",openWorkspace:"openWorkspace"},decls:27,vars:40,consts:[[3,"formControl","map","geometryType","drawGuide","measure","drawControlIsActive","freehandDrawIsActive","drawStyle","overlayStyle","radius"],[1,"header"],[3,"checked","labelPosition","change",4,"ngIf"],["class","buffer-unit",4,"ngIf"],["class","radius-unit",4,"ngIf"],[1,"title","mat-typography"],[3,"value"],[3,"value","change",4,"ngFor","ngForOf"],["class","thematics",4,"ngIf"],[1,"buttons"],["mat-raised-button","","class","clear-search-button",3,"disabled","click",4,"ngIf"],["mat-raised-button","","class","clear-form-button",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","primary",1,"search-button",3,"disabled","click"],["mat-raised-button","",1,"remove-button",3,"disabled","click"],["mat-raised-button","",1,"export-button",3,"disabled","click"],[3,"checked","labelPosition","change"],[1,"buffer-unit"],[1,"buffer-form"],[1,"buffer"],["type","number","matInput","",3,"placeholder","formControl","value","readonly"],[1,"unit-field"],[3,"value","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"radius-unit"],[1,"radius-form"],[1,"radius"],["type","number","matInput","",3,"placeholder","formControl","value","readonly","input"],[3,"value","change"],[1,"thematics"],["matColumnDef","name"],["class","thematics-header",4,"matHeaderCellDef"],["matColumnDef","select"],["class","checks-header",4,"matHeaderCellDef"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[3,"dataSource","treeControl"],["matTreeNodeToggle","",4,"matTreeNodeDef"],[4,"matTreeNodeDef","matTreeNodeDefWhen"],[1,"thematics-header"],[1,"checks-header"],[3,"checked","indeterminate","change"],["matTreeNodeToggle",""],[1,"mat-tree-node"],["mat-icon-button","","disabled",""],[1,"tree-check",3,"checked","click","change"],["mat-icon-button","",3,"click"],[3,"svgIcon"],[1,"tree-check-2",3,"checked","indeterminate","change"],[1,"tree-ul"],["matTreeNodeOutlet",""],["mat-raised-button","",1,"clear-search-button",3,"disabled","click"],["mat-raised-button","",1,"clear-form-button",3,"disabled","click"]],template:function(e,t){1&e&&(Object(i.hc)(0,"igo-geometry-form-field-input",0),Object(i.yc)(1,"async"),Object(i.yc)(2,"async"),Object(i.yc)(3,"async"),Object(i.mc)(4,"div",1),Object(i.Yc)(5,Mh,3,5,"mat-slide-toggle",2),Object(i.Yc)(6,kh,3,5,"mat-slide-toggle",2),Object(i.lc)(),Object(i.Yc)(7,Ph,8,8,"div",3),Object(i.Yc)(8,$h,8,8,"div",4),Object(i.mc)(9,"mat-label",5),Object(i.ad)(10),Object(i.yc)(11,"translate"),Object(i.lc)(),Object(i.mc)(12,"mat-radio-group",6),Object(i.Yc)(13,Eh,3,4,"mat-radio-button",7),Object(i.lc)(),Object(i.Yc)(14,Gh,11,5,"div",8),Object(i.mc)(15,"div",9),Object(i.Yc)(16,Vh,3,4,"button",10),Object(i.Yc)(17,Uh,3,4,"button",11),Object(i.mc)(18,"button",12),Object(i.tc)("click",(function(){return t.toggleSearchButton()})),Object(i.ad)(19),Object(i.yc)(20,"translate"),Object(i.lc)(),Object(i.mc)(21,"button",13),Object(i.tc)("click",(function(){return t.clearButton()})),Object(i.ad)(22),Object(i.yc)(23,"translate"),Object(i.lc)(),Object(i.mc)(24,"button",14),Object(i.tc)("click",(function(){return t.export.emit()})),Object(i.ad)(25),Object(i.yc)(26,"translate"),Object(i.lc)(),Object(i.lc)()),2&e&&(Object(i.Dc)("formControl",t.formControl)("map",t.map)("geometryType",t.geometryType)("drawGuide",Object(i.zc)(1,26,t.drawGuide$))("measure",t.measure)("drawControlIsActive",t.drawControlIsActive)("freehandDrawIsActive",t.freehandDrawIsActive)("drawStyle",Object(i.zc)(2,28,t.drawStyle$))("overlayStyle",Object(i.zc)(3,30,t.overlayStyle$))("radius",t.radius),Object(i.Tb)(5),Object(i.Dc)("ngIf",!t.isPredefined()),Object(i.Tb)(1),Object(i.Dc)("ngIf",!t.isPredefined()),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.isPolygon()),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.isPoint()),Object(i.Tb)(2),Object(i.cd)("",Object(i.zc)(11,32,"igo.geo.spatialFilter.search")," : "),Object(i.Tb)(2),Object(i.Dc)("value",t.selectedItemType),Object(i.Tb)(1),Object(i.Dc)("ngForOf",t.itemType),Object(i.Tb)(1),Object(i.Dc)("ngIf","Thematics"===t.selectedItemType),Object(i.Tb)(2),Object(i.Dc)("ngIf",t.isPredefined()),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.isPolygon()||t.isPoint()),Object(i.Tb)(1),Object(i.Dc)("disabled",t.disableSearchButton()),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(20,34,"igo.geo.spatialFilter.goSearch")," "),Object(i.Tb)(2),Object(i.Dc)("disabled",0===t.allLayers.length),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(23,36,"igo.geo.spatialFilter.removeLayer")," "),Object(i.Tb)(2),Object(i.Dc)("disabled",!t.store.entities$.getValue().length),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(26,38,"igo.geo.spatialFilter.exportLayer")," "))},styles:[".header[_ngcontent-%COMP%]{margin-top:5px;width:100%}.mat-slide-toggle[_ngcontent-%COMP%]{margin-bottom:15px;padding:5px;width:98%}.mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content{width:calc(100% - 20px)}.title[_ngcontent-%COMP%]{font-size:medium;margin-left:5px}.mat-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-top:10px}.mat-radio-button[_ngcontent-%COMP%]{display:inline-flex;margin-left:16px;margin-top:10px;position:relative}.mat-form-field[_ngcontent-%COMP%]{margin-top:5px}.mat-column-select[_ngcontent-%COMP%]{overflow:auto}.buttons[_ngcontent-%COMP%]{margin-top:15px}.search-button[_ngcontent-%COMP%]{left:15px;width:165px}@media only screen and (orientation:landscape) and (max-width:959px),only screen and (orientation:portrait) and (max-width:599px){.search-button[_ngcontent-%COMP%]{left:10px;line-height:normal;min-height:35px;white-space:normal;width:45%}}.export-button[_ngcontent-%COMP%]{left:15px;width:165px}@media only screen and (orientation:landscape) and (max-width:959px),only screen and (orientation:portrait) and (max-width:599px){.export-button[_ngcontent-%COMP%]{left:10px;line-height:normal;margin-top:10px;min-height:35px;white-space:normal;width:45%}}.remove-button[_ngcontent-%COMP%]{left:5px;margin-top:12px;width:165px}@media only screen and (orientation:landscape) and (max-width:959px),only screen and (orientation:portrait) and (max-width:599px){.remove-button[_ngcontent-%COMP%]{line-height:normal;margin:0;min-height:35px;white-space:normal;width:45%}}.clear-form-button[_ngcontent-%COMP%]{left:5px;width:165px}@media only screen and (orientation:landscape) and (max-width:959px),only screen and (orientation:portrait) and (max-width:599px){.clear-form-button[_ngcontent-%COMP%]{line-height:normal;min-height:35px;white-space:normal;width:45%}}.clear-search-button[_ngcontent-%COMP%]{left:5px;width:165px}@media only screen and (orientation:landscape) and (max-width:959px),only screen and (orientation:portrait) and (max-width:599px){.clear-search-button[_ngcontent-%COMP%]{line-height:normal;min-height:35px;white-space:normal;width:45%}}.thematics[_ngcontent-%COMP%]{margin-top:5px;max-height:35%}.results[_ngcontent-%COMP%], .thematics[_ngcontent-%COMP%]{overflow:auto;width:98%}.results[_ngcontent-%COMP%]{max-height:250px}.mat-column-typeResults[_ngcontent-%COMP%]{margin-right:5px;max-width:100px}.buffer-unit[_ngcontent-%COMP%], .radius-unit[_ngcontent-%COMP%]{display:flex;margin-left:2px;padding:5px;width:100%}.buffer[_ngcontent-%COMP%], .radius[_ngcontent-%COMP%]{display:flex;flex-flow:column nowrap;width:110%}.unit-field[_ngcontent-%COMP%]{margin-left:30px;width:110px}.example-tree-invisible[_ngcontent-%COMP%]{display:none}.tree-ul[_ngcontent-%COMP%]{list-style-type:none;margin:0;padding:0 0 0 20px}.tree-check[_ngcontent-%COMP%], .tree-check-2[_ngcontent-%COMP%]{margin-left:auto;margin-right:5px;position:relative}.thematics-header[_ngcontent-%COMP%]{max-width:250px}.checks-header[_ngcontent-%COMP%]{max-width:calc(100% - 316px);overflow:hidden;padding:none}.mat-checkbox[_ngcontent-%COMP%]{padding:5px}.mat-tree-node[_ngcontent-%COMP%]{min-height:42px;position:relative;width:280px}.mat-header-cell[_ngcontent-%COMP%]{height:56px}"],changeDetection:0}),e})(),Yh=(()=>{class e{static forRoot(){return{ngModule:e,providers:[{provide:Pe.f,useValue:"fr-FR"}]}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},providers:[Vu,Uu,dh,Wu],imports:[[m.c,Ue.m,Ue.C,mn.b,c.b,n.c,xn.g,Sn.c,f.c,$e.q,Cn.c,gn.c,b.b,pn.b,hn.b,ke.e,Ve.c,Pe.q,De.b,l.e,h.b,wn.k,Pe.n,Tn.g,Tn.k,ie,Mu,$o,Ai,Fi,ih,Be.b]]}),e})();class Wh extends Error{}class Kh extends Wh{constructor(){super("Invalid file"),Object.setPrototypeOf(this,Kh.prototype)}}class Zh extends Wh{constructor(){super("Nothing to export"),Object.setPrototypeOf(this,Zh.prototype)}}const Qh=R(["URL","GeoJSON","GML","GPX","KML","Shapefile","CSVcomma","CSVsemicolon"]),Jh=R(["UTF8","LATIN1"]);let Xh=(()=>{class e{constructor(e){this.config=e,this.aggregateInComment=!0,this.ogreUrl=this.config.getConfig("importExport.url");const t=this.config.getConfig("importExport.gpxAggregateInComment");void 0!==t&&(this.aggregateInComment=t)}export(e,t,o,i,r="EPSG:4326",s="EPSG:4326"){const a=this.generateFeature(e,t);return this.exportAsync(a,t,o,i,r,s)}generateFeature(e,t){return t===Qh.GPX&&this.aggregateInComment?this.generateAggratedFeature(e):e.map(e=>{const t=e.getKeys().filter(e=>!e.startsWith("_")).reduce((t,o)=>(t[o]=e.get(o),t),{geometry:e.getGeometry()});return new Da.a(t)})}generateAggratedFeature(e){return e.map(e=>{const t=e.getKeys().filter(e=>!e.startsWith("_"));let o="";const i=t.reduce((t,i)=>(void 0!==i&&"geometry"!==i&&(o+=i+":"+e.get(i)+"   \r\n"),t[i]=e.get(i),t),{geometry:e.getGeometry()}),r=new Da.a(i);return r.set("name",e.getId()),r.set("cmt",o),r})}exportAsync(t,o,i,r,s,a){return new xe.a(n=>{if(!0!==this.nothingToExport(t,o))if(Object.keys(e.ogreFormats).indexOf(o)>=0){if(void 0===this.ogreUrl)return void(e.noOgreFallbacks.indexOf(o)>=0?this.exportToFile(t,n,o,i,s,a):n.error(new Kh));this.exportWithOgre(t,n,o,i,r,s,a)}else this.exportToFile(t,n,o,i,s,a);else n.error(new Zh)})}exportToFile(e,t,o,i,r,s){var a,n;a=(new ha[o]).writeFeatures(e,{dataProjection:s,featureProjection:r,featureType:"feature",featureNS:"http://example.com/feature"}),n=`${i}.${o.toLowerCase()}`,function(e,t){const o=document.createElement("a");o.setAttribute("href",e),o.setAttribute("download",t),o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o)}("data:text/plain;charset=utf-8,"+encodeURIComponent(a),n),t.complete()}exportWithOgre(t,o,i,r,s,a,n){const c=(new ha.GeoJSON).writeFeatures(t,{dataProjection:n,featureProjection:a,featureType:"feature",featureNS:"http://example.com/feature"}),l=this.ogreUrl+"/convertJson",u=document.createElement("form");if(u.style.display="none",document.body.appendChild(u),u.setAttribute("method","post"),u.setAttribute("target","_blank"),u.setAttribute("action",l),s===Jh.UTF8)u.acceptCharset="UTF-8",u.enctype="application/x-www-form-urlencoded; charset=utf-8;";else if(s===Jh.LATIN1){const e="ISO-8859-1",t=document.createElement("input");t.setAttribute("type","hidden"),t.setAttribute("name","encoding"),t.setAttribute("value",e),u.appendChild(t)}if("CSVsemicolon"===i){const e=document.createElement("input");e.setAttribute("type","hidden"),e.setAttribute("name","lco"),e.setAttribute("value","SEPARATOR=SEMICOLON"),u.appendChild(e)}const d=document.createElement("input");d.setAttribute("type","hidden"),d.setAttribute("name","json"),d.setAttribute("value",c),u.appendChild(d);const h=document.createElement("input");let p="Shapefile"===i?r+".zip":`${r}.${i.toLowerCase()}`;"CSVcomma"!==i&&"CSVsemicolon"!==i||(p=r+".csv"),p=p.replace(" ","_"),p=p.normalize("NFD").replace(/[\u0300-\u036f]/g,""),h.setAttribute("type","hidden"),h.setAttribute("name","outputName"),h.setAttribute("value",p),u.appendChild(h);let m=e.ogreFormats[i];"CSVcomma"!==i&&"CSVsemicolon"!==i||(m="CSV");const g=document.createElement("input");g.setAttribute("type","hidden"),g.setAttribute("name","format"),g.setAttribute("value",m),u.appendChild(g),u.submit(),document.body.removeChild(u),o.complete()}nothingToExport(e,t){return 0===e.length||"GPX"===t&&void 0===e.find(e=>["Point","LineString","MultiLineString"].indexOf(e.getGeometry().getType())>=0)}}return e.ogreFormats={GML:"gml",GPX:"gpx",KML:"kml",Shapefile:"ESRI Shapefile",CSVcomma:"CSVcomma",CSVsemicolon:"CSVsemicolon"},e.noOgreFallbacks=["GML","GPX","KML"],e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(K))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class ep extends Error{}class tp extends ep{constructor(){super("Invalid file"),Object.setPrototypeOf(this,tp.prototype)}}class op extends ep{constructor(){super("Failed to read file"),Object.setPrototypeOf(this,op.prototype)}}class ip extends ep{constructor(){super("Nothing to import"),Object.setPrototypeOf(this,ip.prototype)}}class rp extends ep{constructor(){super("File is too large"),Object.setPrototypeOf(this,ip.prototype)}}class sp extends ep{constructor(){super("Invalid SRS definition"),Object.setPrototypeOf(this,ip.prototype)}}function ap(e,t,o,i,r,s,a){if(0===t.length)return void function(e,t,o){const i=o.translate,r=i.instant("igo.geo.dropGeoFile.empty.title"),s=i.instant("igo.geo.dropGeoFile.empty.text",{value:e.name,mimeType:e.type});t.error(s,r)}(e,i,r);const n=hp(e);s?function(e,t,o,i,r){const s=e.map(e=>tl(e,t.projection));let a,n,c;if(i.getStyleList(o.toString()+".styleByAttribute")){const e=i.getStyleList(o.toString()+".styleByAttribute");a=t=>r.createStyleByAttribute(t,e)}else if(i.getStyleList(o.toString()+".clusterStyle")){const e=i.getStyleList(o.toString()+".clusterParam");n=i.getStyleList(o.toString()+".distance");const t=r.createStyle(i.getStyleList(o.toString()+".clusterStyle"));a=o=>r.createClusterStyle(o,e,t)}else if(i.getStyleList(o.toString()+".style"))a=r.createStyle(i.getStyleList(o.toString()+".style"));else if(i.getStyleList("default.clusterStyle")&&"Point"===e[0].geometry.type){const e=i.getStyleList("default.clusterParam");n=i.getStyleList("default.distance");const t=r.createStyle(i.getStyleList("default.clusterStyle"));a=o=>r.createClusterStyle(o,e,t)}else a=r.createStyle(i.getStyleList("default.style"));i.getStyleList(o.toString()+".clusterStyle")?(c=new Ac({distance:n,type:"cluster",queryable:!0}),c.ol.source.addFeatures(s)):i.getStyleList(o.toString())?(c=new vc({type:"vector",queryable:!0}),c.ol.addFeatures(s)):i.getStyleList("default.clusterStyle")&&"Point"===e[0].geometry.type?(c=new Ac({distance:n,type:"cluster",queryable:!0}),c.ol.source.addFeatures(s)):(c=new vc({type:"vector",queryable:!0}),c.ol.addFeatures(s));const l=new Wc({title:o,source:c,style:a});t.addLayer(l),rl(t,s)}(t,o,n,s,a):function(e,t,o){const i=e.map(e=>tl(e,t.projection)),r=Math.floor(255*Math.random()),s=Math.floor(255*Math.random()),a=Math.floor(255*Math.random()),n=new Ra.Stroke({color:[r,s,a,1],width:2}),c=new Ra.Fill({color:[r,s,a,.4]}),l=new vc({type:"vector",queryable:!0});l.ol.addFeatures(i);const u=new Wc({title:o,source:l,style:new Ra.Style({stroke:n,fill:c,image:new Ra.Circle({radius:5,stroke:n,fill:c})})});t.addLayer(u),rl(t,i)}(t,o,n);const c=r.translate,l=c.instant("igo.geo.dropGeoFile.success.title"),u=c.instant("igo.geo.dropGeoFile.success.text",{value:n});i.success(u,l)}function np(e,t,o,i){const r=i.translate,s=r.instant("igo.geo.dropGeoFile.invalid.title"),a=r.instant("igo.geo.dropGeoFile.invalid.text",{value:e.name,mimeType:e.type});o.error(a,s)}function cp(e,t,o,i){const r=i.translate,s=r.instant("igo.geo.dropGeoFile.unreadable.title"),a=r.instant("igo.geo.dropGeoFile.unreadable.text",{value:e.name});o.error(a,s)}function lp(e,t,o,i,r){const s=i.translate,a=s.instant("igo.geo.dropGeoFile.tooLarge.title"),n=s.instant("igo.geo.dropGeoFile.tooLarge.text",{value:e.name,size:r});o.error(n,a)}function up(e,t,o){const i=o.translate,r=i.instant("igo.geo.dropGeoFile.invalidSRS.title"),s=i.instant("igo.geo.dropGeoFile.invalidSRS.text",{value:e.name,mimeType:e.type});t.error(s,r)}function dp(e){return e.name.split(".").pop().toLowerCase()}function hp(e){return e.name.substr(0,e.name.lastIndexOf("."))}let pp=(()=>{class e{constructor(e,t){this.http=e,this.config=t,this.ogreUrl=this.config.getConfig("importExport.url");const o=this.config.getConfig("importExport.clientSideFileSizeMaxMb");this.clientSideFileSizeMax=(o||30)*Math.pow(1024,2)}import(e,t="EPSG:4326",o="EPSG:4326"){return this.importAsync(e,t,o)}getFileImporter(t){const o=dp(t),i=t.type,r=[...e.allowedMimeTypes,...e.allowedZipMimeTypes],s=e.allowedExtensions;if(!(r.indexOf(i)<0&&s.indexOf(o)<0))return"application/json"===i||["json","geojson","kml","gpx"].indexOf(o)>=0?this.importFile:void 0!==this.ogreUrl?this.importFileWithOgre:void 0}importAsync(e,t,o){return new xe.a(i=>{if(e.size>=this.clientSideFileSizeMax)return void i.error(new rp);const r=this.getFileImporter(e);void 0!==r?r.call(this,e,i,t,o):i.error(new tp)})}importFile(e,t,o,i){const r=new FileReader;r.onload=r=>{try{const s=this.parseFeaturesFromFile(e,r.target.result,o,i);t.next(s)}catch(s){t.error(new op)}t.complete()},r.onerror=e=>{t.error(new op)},r.readAsText(e,"UTF-8")}importFileWithOgre(e,t,o,i){const r=this.ogreUrl+"/convert",s=new FormData;s.append("upload",e),s.append("sourceSrs",o),s.append("targetSrs",i),s.append("formatOutput","GEOJSON"),s.append("skipFailures",""),this.http.post(r,s,{headers:new y.f}).subscribe(o=>{if(null!==o)if((o.errors||[]).length>0)t.error(new op);else{const r=this.parseFeaturesFromGeoJSON(e,o,i);t.next(r),t.complete()}else t.error(new op)},e=>{e.error.caught=!0;const o=e.error.msg||"";"No valid files found"===o?t.error(new tp):o.startWith("ERROR 1: Failed to process SRS definition")?t.error(new sp):t.error(new op)})}parseFeaturesFromFile(e,t,o,i){const r=dp(e),s=e.type,a=new ha.GeoJSON;let n;if("application/vnd.google-earth.kml+xml"===s)n=new ha.KML;else if("application/gml+xml"===s)n=new ha.GML;else if("application/gpx+xml"===s)n=new ha.GPX;else switch(r){case"kml":n=new ha.KML;break;case"gpx":n=new ha.GPX;break;case"gml":n=new ha.GML;break;default:n=a}return n.readFeatures(t,{dataProjection:o,featureProjection:i}).map(t=>Object.assign(a.writeFeatureObject(t),{projection:i,meta:{id:z(),title:hp(e)}}))}parseFeaturesFromGeoJSON(e,t,o){const i=new ha.GeoJSON;return i.readFeatures(t).map(t=>Object.assign(i.writeFeatureObject(t),{projection:o,meta:{id:z(),title:hp(e)}}))}}return e.allowedMimeTypes=["application/gml+xml","application/vnd.google-earth.kml+xml","application/gpx+xml","application/json"],e.allowedZipMimeTypes=["application/zip","application/x-zip-compressed","application/x-zip"],e.allowedExtensions=["geojson","kml","gpx","json","gml"],e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(y.b),Object(i.qc)(K))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),mp=(()=>{class e{constructor(e){this.injector=e,this.styleList={}}getStyleList(e){return E.resolve(this.styleList,e)}load(e){const t=e.default||{};if(!e.path)return this.styleList=t,!0;const o=this.injector.get(y.b);return new Promise((i,r)=>{o.get(e.path).pipe(Object(v.a)(t=>(console.log(`StyleList file ${e.path} could not be read`),i(!0),Object(T.a)(t.error||"Server error")))).subscribe(e=>{this.styleList=E.mergeDeep(t,e),i(!0)})})}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(i.C))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function gp(e,t){if(1&e&&(Object(i.mc)(0,"p",16),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()),2&e){const e=Object(i.xc)().$implicit;Object(i.Tb)(1),Object(i.bd)(Object(i.Ac)(2,1,"igo.geo.importExportForm.projections."+e.translateKey,e))}}function bp(e,t){if(1&e&&(Object(i.mc)(0,"p",16),Object(i.ad)(1),Object(i.lc)()),2&e){const e=Object(i.xc)().$implicit;Object(i.Tb)(1),Object(i.bd)(e.alias)}}function fp(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"mat-option",14),Object(i.tc)("click",(function(t){return Object(i.Nc)(e),t.stopPropagation()})),Object(i.Yc)(1,gp,3,4,"p",15),Object(i.Yc)(2,bp,2,1,"p",15),Object(i.lc)()}if(2&e){const e=t.$implicit;Object(i.Dc)("value",e),Object(i.Tb)(1),Object(i.Dc)("ngIf",e.translateKey),Object(i.Tb)(1),Object(i.Dc)("ngIf",!e.translateKey)}}function yp(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"form",5),Object(i.mc)(1,"div",6),Object(i.mc)(2,"mat-form-field"),Object(i.mc)(3,"mat-label"),Object(i.ad)(4),Object(i.yc)(5,"translate"),Object(i.lc)(),Object(i.mc)(6,"mat-select",7),Object(i.tc)("valueChange",(function(t){return Object(i.Nc)(e),Object(i.xc)().inputProj=t})),Object(i.Yc)(7,fp,3,3,"mat-option",8),Object(i.yc)(8,"async"),Object(i.lc)(),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(9,"div",9),Object(i.yc)(10,"translate"),Object(i.yc)(11,"translate"),Object(i.mc)(12,"button",10),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.Kc)(19).click()})),Object(i.yc)(13,"async"),Object(i.ad)(14),Object(i.yc)(15,"translate"),Object(i.lc)(),Object(i.hc)(16,"igo-spinner",11),Object(i.yc)(17,"async"),Object(i.mc)(18,"input",12,13),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.Kc)(19).value=null}))("change",(function(t){return Object(i.Nc)(e),Object(i.xc)().importFiles(t.target.files)})),Object(i.lc)(),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Dc)("formGroup",e.importForm),Object(i.Tb)(4),Object(i.bd)(Object(i.zc)(5,10,"igo.geo.importExportForm.importProjPlaceholder")),Object(i.Tb)(2),Object(i.Dc)("value",e.inputProj),Object(i.Tb)(1),Object(i.Dc)("ngForOf",Object(i.zc)(8,12,e.projections$)),Object(i.Tb)(2),Object(i.Dc)("matTooltip",e.importForm.invalid?Object(i.zc)(10,14,"igo.geo.importExportForm.projections.choose"):Object(i.zc)(11,16,"igo.geo.importExportForm.importButton")),Object(i.Tb)(3),Object(i.Dc)("disabled",e.importForm.invalid||Object(i.zc)(13,18,e.loading$)),Object(i.Tb)(2),Object(i.cd)(" ",Object(i.zc)(15,20,"igo.geo.importExportForm.importButton")," "),Object(i.Tb)(2),Object(i.Dc)("shown",Object(i.zc)(17,22,e.loading$)),Object(i.Tb)(2),Object(i.Vc)("display","none")}}const Op=function(e){return{size:e}};function vp(e,t){if(1&e&&(Object(i.mc)(0,"section",17),Object(i.mc)(1,"h4"),Object(i.ad)(2),Object(i.yc)(3,"translate"),Object(i.lc)(),Object(i.mc)(4,"ul"),Object(i.mc)(5,"li"),Object(i.ad)(6),Object(i.yc)(7,"translate"),Object(i.lc)(),Object(i.mc)(8,"li"),Object(i.ad)(9),Object(i.yc)(10,"translate"),Object(i.lc)(),Object(i.mc)(11,"li"),Object(i.ad)(12),Object(i.yc)(13,"translate"),Object(i.lc)(),Object(i.lc)(),Object(i.lc)()),2&e){const e=Object(i.xc)();Object(i.Tb)(2),Object(i.bd)(Object(i.zc)(3,4,"igo.geo.importExportForm.importClarifications")),Object(i.Tb)(4),Object(i.bd)(Object(i.Ac)(7,6,"igo.geo.importExportForm.importSizeMax",Object(i.Gc)(13,Op,e.fileSizeMb))),Object(i.Tb)(3),Object(i.bd)(Object(i.zc)(10,9,"igo.geo.importExportForm.importFormatAuthorized")),Object(i.Tb)(3),Object(i.bd)(Object(i.zc)(13,11,"igo.geo.importExportForm.importShpZip"))}}function jp(e,t){1&e&&(Object(i.mc)(0,"section",17),Object(i.mc)(1,"h4"),Object(i.ad)(2),Object(i.yc)(3,"translate"),Object(i.lc)(),Object(i.lc)()),2&e&&(Object(i.Tb)(2),Object(i.bd)(Object(i.zc)(3,1,"igo.geo.importExportForm.exportNoLayersExportable")))}function wp(e,t){if(1&e&&(Object(i.mc)(0,"span",27),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()),2&e){const e=Object(i.xc)(2);Object(i.Tb)(1),Object(i.dd)(" (+",e.layers.length-1," ",Object(i.zc)(2,2,2===(null==e.layers?null:e.layers.length)?"igo.geo.importExportForm.other":"igo.geo.importExportForm.others"),") ")}}function Sp(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"mat-slide-toggle",30),Object(i.tc)("click",(function(t){Object(i.Nc)(e);const o=Object(i.xc)().$implicit;return Object(i.xc)(2).onlySelectedClick(t,o.id)}))("checked",(function(){Object(i.Nc)(e);const t=Object(i.xc)().$implicit;return Object(i.xc)(2).inLayersIdToExportSelectionOnly(t)}))("change",(function(t){Object(i.Nc)(e);const o=Object(i.xc)().$implicit;return Object(i.xc)(2).onlySelected(t,o.id)})),Object(i.mc)(1,"small"),Object(i.ad)(2),Object(i.yc)(3,"translate"),Object(i.lc)(),Object(i.lc)()}2&e&&(Object(i.Dc)("labelPosition","after"),Object(i.Tb)(2),Object(i.bd)(Object(i.zc)(3,2,"igo.geo.importExportForm.exportSelectedFeature")))}const xp=function(e){return{"igo-export-layer-mat-option":e}};function Cp(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"mat-option",28),Object(i.tc)("click",(function(t){return Object(i.Nc)(e),t.stopPropagation()})),Object(i.mc)(1,"p",16),Object(i.ad)(2),Object(i.lc)(),Object(i.mc)(3,"p",16),Object(i.Yc)(4,Sp,4,4,"mat-slide-toggle",29),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=t.$implicit,o=Object(i.xc)(2);Object(i.Dc)("ngClass",Object(i.Gc)(4,xp,o.layerHasSelectedFeatures(e)))("value",e.id),Object(i.Tb)(2),Object(i.bd)(e.title),Object(i.Tb)(2),Object(i.Dc)("ngIf",o.layerHasSelectedFeatures(e))}}function Tp(e,t){if(1&e&&(Object(i.mc)(0,"mat-option",2),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()),2&e){const e=t.$implicit;Object(i.Dc)("value",e.key),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(2,2,"igo.geo.export.format."+e.value)," ")}}function Lp(e,t){if(1&e&&(Object(i.kc)(0),Object(i.Yc)(1,Tp,3,4,"mat-option",31),Object(i.yc)(2,"keyvalue"),Object(i.yc)(3,"async"),Object(i.jc)()),2&e){const e=Object(i.xc)(2);Object(i.Tb)(1),Object(i.Dc)("ngForOf",Object(i.zc)(2,1,Object(i.zc)(3,3,e.formats$)))}}function Ip(e,t){1&e&&(Object(i.mc)(0,"mat-option",32),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()),2&e&&(Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(2,1,"igo.geo.export.noFormat.title")," "))}function Fp(e,t){1&e&&(Object(i.mc)(0,"div",6),Object(i.mc)(1,"mat-form-field"),Object(i.hc)(2,"input",33),Object(i.yc)(3,"translate"),Object(i.lc)(),Object(i.lc)()),2&e&&(Object(i.Tb)(2),Object(i.Ec)("placeholder",Object(i.zc)(3,1,"igo.geo.importExportForm.exportFileNamePlaceholder")))}function Mp(e,t){if(1&e&&(Object(i.mc)(0,"mat-option",2),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()),2&e){const e=t.$implicit;Object(i.Dc)("value",e.key),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(2,2,"igo.geo.export.encoding."+e.value)," ")}}function kp(e,t){if(1&e&&(Object(i.kc)(0),Object(i.Yc)(1,Mp,3,4,"mat-option",31),Object(i.yc)(2,"keyvalue"),Object(i.yc)(3,"async"),Object(i.jc)()),2&e){const e=Object(i.xc)(3);Object(i.Tb)(1),Object(i.Dc)("ngForOf",Object(i.zc)(2,1,Object(i.zc)(3,3,e.encodings$)))}}function Dp(e,t){if(1&e&&(Object(i.mc)(0,"div",6),Object(i.mc)(1,"mat-form-field"),Object(i.mc)(2,"mat-label"),Object(i.ad)(3),Object(i.yc)(4,"translate"),Object(i.lc)(),Object(i.mc)(5,"mat-select",34),Object(i.Yc)(6,kp,4,5,"ng-container",22),Object(i.yc)(7,"async"),Object(i.lc)(),Object(i.lc)(),Object(i.lc)()),2&e){const e=Object(i.xc)(2);Object(i.Tb)(3),Object(i.bd)(Object(i.zc)(4,2,"igo.geo.importExportForm.encodingPlaceholder")),Object(i.Tb)(3),Object(i.Dc)("ngIf",0!==Object(i.zc)(7,4,e.encodings$).length)}}function Pp(e,t){1&e&&(Object(i.mc)(0,"div",35),Object(i.mc)(1,"mat-slide-toggle",36),Object(i.ad)(2),Object(i.yc)(3,"translate"),Object(i.lc)(),Object(i.lc)()),2&e&&(Object(i.Tb)(1),Object(i.Dc)("labelPosition","before"),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(3,2,"igo.geo.importExportForm.exportFeatureInExtent")," "))}function Ap(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"form",5),Object(i.mc)(1,"div",6),Object(i.mc)(2,"mat-form-field"),Object(i.mc)(3,"mat-label"),Object(i.ad)(4),Object(i.yc)(5,"translate"),Object(i.lc)(),Object(i.mc)(6,"mat-select",18),Object(i.tc)("valueChange",(function(t){return Object(i.Nc)(e),Object(i.xc)().layers=t})),Object(i.mc)(7,"mat-select-trigger"),Object(i.ad)(8),Object(i.Yc)(9,wp,3,4,"span",19),Object(i.lc)(),Object(i.Yc)(10,Cp,5,6,"mat-option",20),Object(i.yc)(11,"async"),Object(i.lc)(),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(12,"div",6),Object(i.mc)(13,"mat-form-field"),Object(i.mc)(14,"mat-label"),Object(i.ad)(15),Object(i.yc)(16,"translate"),Object(i.lc)(),Object(i.mc)(17,"mat-select",21),Object(i.Yc)(18,Lp,4,5,"ng-container",22),Object(i.yc)(19,"async"),Object(i.Yc)(20,Ip,3,3,"mat-option",23),Object(i.yc)(21,"async"),Object(i.lc)(),Object(i.lc)(),Object(i.lc)(),Object(i.Yc)(22,Fp,4,3,"div",24),Object(i.Yc)(23,Dp,8,6,"div",24),Object(i.Yc)(24,Pp,4,4,"div",25),Object(i.mc)(25,"div",26),Object(i.mc)(26,"button",10),Object(i.tc)("click",(function(){Object(i.Nc)(e);const t=Object(i.xc)();return t.handleExportFormSubmit(t.form.value)})),Object(i.yc)(27,"async"),Object(i.ad)(28),Object(i.yc)(29,"translate"),Object(i.yc)(30,"translate"),Object(i.yc)(31,"translate"),Object(i.lc)(),Object(i.hc)(32,"igo-spinner",11),Object(i.yc)(33,"async"),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Dc)("formGroup",e.form),Object(i.Tb)(4),Object(i.bd)(Object(i.zc)(5,15,"igo.geo.importExportForm.exportLayerPlaceholder")),Object(i.Tb)(2),Object(i.Dc)("value",e.layers),Object(i.Tb)(2),Object(i.cd)(" ",e.layers.length?e.getLayerTitleById(e.layers[0]):""," "),Object(i.Tb)(1),Object(i.Dc)("ngIf",e.layers.length>1),Object(i.Tb)(1),Object(i.Dc)("ngForOf",Object(i.zc)(11,17,e.exportableLayers$)),Object(i.Tb)(5),Object(i.bd)(Object(i.zc)(16,19,"igo.geo.importExportForm.exportFormatPlaceholder")),Object(i.Tb)(3),Object(i.Dc)("ngIf",0!==Object(i.zc)(19,21,e.formats$).length),Object(i.Tb)(2),Object(i.Dc)("ngIf",0===Object(i.zc)(21,23,e.formats$).length),Object(i.Tb)(2),Object(i.Dc)("ngIf",e.forceNaming&&"URL"!==e.form.value.format),Object(i.Tb)(1),Object(i.Dc)("ngIf","CSVcomma"===e.form.value.format||"CSVsemicolon"===e.form.value.format),Object(i.Tb)(1),Object(i.Dc)("ngIf","URL"!==e.form.value.format),Object(i.Tb)(2),Object(i.Dc)("disabled",!e.form.valid||Object(i.zc)(27,25,e.loading$)),Object(i.Tb)(2),Object(i.cd)(" ","URL"!==e.form.value.format?Object(i.zc)(29,27,"igo.geo.importExportForm.exportButton"):e.form.value.layers.length>1?Object(i.zc)(30,29,"igo.geo.importExportForm.exportButtonLinks"):Object(i.zc)(31,31,"igo.geo.importExportForm.exportButtonLink")," "),Object(i.Tb)(4),Object(i.Dc)("shown",Object(i.zc)(33,33,e.loading$))}}let $p=(()=>{class e{constructor(e,t,o,r,s,a,n,c,l,u,d){this.importService=e,this.exportService=t,this.languageService=o,this.messageService=r,this.styleListService=s,this.styleService=a,this.formBuilder=n,this.config=c,this.cdRef=l,this.storageService=u,this.downloadService=d,this.formats$=new C.a(void 0),this.encodings$=new C.a(void 0),this.exportableLayers$=new C.a([]),this.loading$=new C.a(!1),this.forceNaming=!1,this.controlFormat="format",this.espgCodeRegex=new RegExp("^\\d{4,6}"),this.projections$=new C.a([]),this.popupChecked=!1,this.previousLayerSpecs$=new C.a(void 0),this.selectFirstProj=!1,this._projectionsLimitations={},this.selectedMode="import",this.selectMode=new i.u,this.exportOptions$=new C.a(void 0),this.exportOptionsChange=new i.u,this.loadConfig(),this.buildForm(),this.computeProjections()}set projectionsLimitations(e){this._projectionsLimitations=e,this.computeProjections()}get projectionsLimitations(){return this._projectionsLimitations||{}}get layers(){return this.form.get("layers").value}set layers(e){this.form.patchValue({layers:e})}get inputProj(){return this.importForm.get("inputProj").value}set inputProj(e){this.importForm.patchValue({inputProj:e})}get popupAllowed(){return this.storageService.get("importExportPopupAllowed")||!1}set popupAllowed(e){this.storageService.set("importExportPopupAllowed",e)}ngOnInit(){this.layers$$=this.map.layers$.subscribe(e=>{this.exportableLayers$.next(e.filter(e=>e instanceof Wc&&!0===e.exportable||e.dataSource.options.download&&e.dataSource.options.download.url))});const e=this.config.getConfig("importExport.clientSideFileSizeMaxMb");this.clientSideFileSizeMax=(e||30)*Math.pow(1024,2),this.fileSizeMb=this.clientSideFileSizeMax/Math.pow(1024,2),this.exportOptions$$=this.exportOptions$.pipe(Object(ta.a)(e=>!e)).subscribe(e=>{this.form.patchValue(e,{emitEvent:!0}),e.layers&&this.computeFormats(e.layers.map(e=>this.map.getLayerById(e)))}),this.formLayer$$=this.form.get("format").valueChanges.subscribe(e=>{var t;const o=Object.keys(Xh.ogreFormats);!this.popupChecked&&(null===(t=this.form.get("layers").value)||void 0===t?void 0:t.length)>1&&(o.indexOf(e)>=0||e===Qh.URL)&&(this.handlePopup(!0)||this.form.patchValue({format:void 0},{emitEvent:!1}))}),this.formLayer$$=this.form.get("layers").valueChanges.subscribe(e=>{this.handlePreviousLayerSpecs();const t=e instanceof Array?e:[e];this.form.patchValue({layers:t},{emitEvent:!1});const o=t.map(e=>this.map.getLayerById(e));this.computeFormats(o),-1===Object.keys(this.formats$.value).indexOf(this.form.value.format)&&this.form.patchValue({format:void 0}),this.loading$.next(!0);const i=[];o.forEach(e=>{e instanceof Wc&&0===e.dataSource.ol.getFeatures().length&&(i.push({id:e.id,visible:e.visible,opacity:e.opacity,queryable:e.queryable}),e.opacity=0,e.visible=!0)}),this.previousLayerSpecs$.next(i),setTimeout(()=>{this.loading$.next(!1)},500)}),this.formats$$=this.formats$.pipe(Object(ta.a)(e=>!e)).subscribe(e=>{1===Object.keys(e).length&&this.form.patchValue({format:e[Object.keys(e)[0]]})}),this.encodings$$=this.encodings$.pipe(Object(ta.a)(e=>!e)).subscribe(e=>{1===Object.keys(e).length&&this.form.patchValue({encoding:e[Object.keys(e)[0]]})}),this.exportableLayers$$=this.exportableLayers$.pipe(Object(ta.a)(e=>!e)).subscribe(e=>{1===e.length&&this.form.patchValue({layers:e[0].id})}),this.form.controls[this.controlFormat].valueChanges.subscribe(e=>{this.form.patchValue(e===Qh.CSVcomma||e===Qh.CSVsemicolon?{encoding:Jh.LATIN1}:{encoding:Jh.UTF8}),this.cdRef.detectChanges()}),this.importForm.patchValue(this.selectFirstProj?0===this.projections$.value.length?{inputProj:{translateKey:"nad83",alias:"NAD83",code:"EPSG:4326",zone:""}}:{inputProj:this.projections$.value[0]}:{inputProj:void 0})}computeProjectionsConstraints(){const e=this.projectionsLimitations.utmZone,t=this.projectionsLimitations.mtmZone;this.projectionsConstraints={projFromConfig:!1!==this.projectionsLimitations.projFromConfig,nad83:!1!==this.projectionsLimitations.nad83,wgs84:!1!==this.projectionsLimitations.wgs84,webMercator:!1!==this.projectionsLimitations.webMercator,utm:!1!==this.projectionsLimitations.utm,mtm:!1!==this.projectionsLimitations.mtm,utmZone:{minZone:e&&e.minZone?e.minZone:1,maxZone:e&&e.maxZone?e.maxZone:60},mtmZone:{minZone:t&&t.minZone?t.minZone:1,maxZone:t&&t.maxZone?t.maxZone:10}}}computeProjections(){this.computeProjectionsConstraints();const e=[];if(this.projectionsConstraints.nad83&&e.push({translateKey:"nad83",alias:"NAD83",code:"EPSG:4326",zone:""}),this.projectionsConstraints.wgs84&&e.push({translateKey:"wgs84",alias:"WGS84",code:"EPSG:4269",zone:""}),this.projectionsConstraints.webMercator&&e.push({translateKey:"webMercator",alias:"Web Mercator",code:"EPSG:3857",zone:""}),this.projectionsConstraints.mtm){const t=this.projectionsConstraints.mtmZone.maxZone;for(let o=this.projectionsConstraints.mtmZone.minZone;o<=t;o++)e.push({translateKey:"mtm",alias:"MTM "+o,code:o<10?"EPSG:3218"+o:"EPSG:321"+(80+o),zone:""+o})}if(this.projectionsConstraints.utm){const t=this.projectionsConstraints.utmZone.maxZone;for(let o=this.projectionsConstraints.utmZone.minZone;o<=t;o++)e.push({translateKey:"utm",alias:"UTM "+o,code:o<10?"EPSG:3260"+o:"EPSG:326"+o,zone:""+o})}let t=[];this.projectionsConstraints.projFromConfig&&(t=this.config.getConfig("projections")||[]),this.projections$.next(t.concat(e))}getWorkspaceByLayerId(e){const t=this.store.all().find(t=>t.layer.id===e);if(t)return t}getLayerTitleById(e){return this.map.getLayerById(e).title}layerHasSelectedFeatures(e){const t=this.getWorkspaceByLayerId(e.id);if(t)return!!t.entityStore.stateView.firstBy(e=>!0===e.state.selected)}onlySelected(e,t){let o=this.form.value.layersWithSelection;e.checked?o.push(t):o=o.filter(e=>e!==t),this.form.patchValue({layersWithSelection:o})}onlySelectedClick(e,t){this.form.value.layers.find(e=>e===t)&&e.stopPropagation()}inLayersIdToExportSelectionOnly(e){return!!this.form.value.layersWithSelection.find(t=>t===e.id)}ngOnDestroy(){this.layers$$.unsubscribe(),this.exportableLayers$$.unsubscribe(),this.formats$$.unsubscribe(),this.encodings$$.unsubscribe(),this.formLayer$$.unsubscribe(),this.exportOptions$$&&this.exportOptions$$.unsubscribe(),this.exportOptionsChange.emit(this.form.value),this.handlePreviousLayerSpecs()}handlePreviousLayerSpecs(){const e=this.previousLayerSpecs$.value;e&&e.length&&e.forEach(e=>{const t=this.map.getLayerById(e.id);t.visible=e.visible,t.opacity=e.opacity,t.queryable=e.queryable}),this.previousLayerSpecs$.next(void 0)}importFiles(e){let t=this.inputProj.code;this.espgCodeRegex.test(t)&&(t="EPSG:"+t),this.loading$.next(!0);for(const o of e)this.importService.import(o,t).subscribe(e=>this.onFileImportSuccess(o,e),e=>this.onFileImportError(o,e),()=>{this.loading$.next(!1)})}handlePopup(e=!0){window.open("","popup","width=1, height=1").close();const t=window.open("","popup","width=1, height=1");return!t||t.closed||void 0===t.closed||null===t?(this.onPopupBlockedError(e),this.popupAllowed=!1):(t.close(),this.popupAllowed=!0,this.popupChecked=!0),this.popupAllowed}handleExportFormSubmit(e){this.loading$.next(!0);const t=Object.keys(Xh.ogreFormats);!this.popupChecked&&e.layers.length>1&&(t.indexOf(e.format)>=0||e.format===Qh.URL)&&!this.popupAllowed&&this.handlePopup(),e.layers.forEach(t=>{const o=this.map.getLayerById(t);let i=o.title;void 0!==e.name&&(i=e.name);const r=o.dataSource.options;if(e.format===Qh.URL&&r.download&&(r.download.url||r.download.dynamicUrl))return void setTimeout(()=>{const e=r.download.url||r.download.dynamicUrl;e.match(/service=wfs/gi)?this.downloadService.open(o):window.open(e,"_blank"),this.loading$.next(!1)},500);const s=this.getWorkspaceByLayerId(t);let a;s&&s.entityStore&&s.entityStore.stateView.all().length?a=-1!==e.layersWithSelection.indexOf(t)&&e.featureInMapExtent?s.entityStore.stateView.all().filter(e=>e.state.inMapExtent&&e.state.selected).map(e=>e.entity.ol):-1===e.layersWithSelection.indexOf(t)||e.featureInMapExtent?e.featureInMapExtent?s.entityStore.stateView.all().filter(e=>e.state.inMapExtent).map(e=>e.entity.ol):s.entityStore.stateView.all().map(e=>e.entity.ol):s.entityStore.stateView.all().filter(e=>e.state.selected).map(e=>e.entity.ol):(a=e.featureInMapExtent?o.dataSource.ol.getFeaturesInExtent(o.map.viewController.getExtent()):o.dataSource.ol.getFeatures(),o.dataSource instanceof Ac&&(a=a.flatMap(e=>e.get("features"))));const n=this.languageService.translate;let c=[];if(e.format===Qh.Shapefile||e.format===Qh.GPX?a.forEach(e=>{const t=e.getGeometry().getType(),o=c.find(e=>e.geometryType===t);o?o.features.push(e):c.push({geometryType:t,features:[e]})}):c=[{geometryType:"",features:a}],e.format===Qh.GPX){const e=c.length;if(c=c.filter(e=>["LineString","Point"].includes(e.geometryType)),e>c.length){const e=n.instant("igo.geo.export.gpx.error.poly.title"),t=n.instant("igo.geo.export.gpx.error.poly.text");this.messageService.error(t,e,{timeOut:2e4})}}if(0===c.length){this.loading$.next(!1);const e=n.instant("igo.geo.export.nothing.title"),t=n.instant("igo.geo.export.nothing.text");this.messageService.error(t,e,{timeOut:2e4})}else c.map(t=>this.exportService.export(t.features,e.format,i+t.geometryType,e.encoding,this.map.projection).subscribe(()=>{},e=>this.onFileExportError(e),()=>{this.onFileExportSuccess(),this.loading$.next(!1)}))})}buildForm(){this.importForm=this.formBuilder.group({inputProj:["",[Ue.G.required]]}),this.form=this.formBuilder.group(this.forceNaming?{format:["",[Ue.G.required]],layers:[[],[Ue.G.required]],layersWithSelection:[[]],encoding:[Jh.UTF8,[Ue.G.required]],featureInMapExtent:[!1,[Ue.G.required]],name:["",[Ue.G.required]]}:{format:["",[Ue.G.required]],layers:[[],[Ue.G.required]],layersWithSelection:[[]],encoding:[Jh.UTF8,[Ue.G.required]],featureInMapExtent:[!1,[Ue.G.required]]})}onFileImportSuccess(e,t){this.config.getConfig("importWithStyle")?ap(e,t,this.map,this.messageService,this.languageService,this.styleListService,this.styleService):ap(e,t,this.map,this.messageService,this.languageService)}onFileImportError(e,t){this.loading$.next(!1),function(e,t,o,i,r){({"Invalid file":np,"File is too large":lp,"Failed to read file":cp,"Invalid SRS definition":up})[t.message](e,t,o,i,r=r||30)}(e,t,this.messageService,this.languageService,this.fileSizeMb)}onPopupBlockedError(e=!0){this.loading$.next(!1);const t=this.languageService.translate,o=t.instant("igo.geo.export.popupBlocked.title"),i=t.instant(e?"igo.geo.export.popupBlocked.selectAgain":"igo.geo.export.popupBlocked.retry"),r=t.instant("igo.geo.export.popupBlocked.text",{extraMessage:i});this.messageService.error(r,o,{timeOut:2e4})}onFileExportError(e){this.loading$.next(!1),function(e,t,o){if(e instanceof Zh)return void function(e,t){const o=t.translate,i=o.instant("igo.geo.export.nothing.title"),r=o.instant("igo.geo.export.nothing.text");e.error(r,i)}(t,o);const i=o.translate,r=i.instant("igo.geo.export.failed.title"),s=i.instant("igo.geo.export.failed.text");t.error(s,r)}(e,this.messageService,this.languageService)}loadConfig(){void 0!==this.config.getConfig("importExport.forceNaming")&&(this.forceNaming=this.config.getConfig("importExport.forceNaming")),this.computeFormats(),this.loadEncodings()}encodingDefaultValue(e){return e===Qh.CSVcomma||e===Qh.CSVsemicolon?(this.form.patchValue({encoding:Jh.LATIN1}),Jh.LATIN1):(this.form.patchValue({encoding:Jh.UTF8}),Jh.UTF8)}loadEncodings(){this.encodings$.next(Jh)}computeFormats(e){let t=Object.keys(Qh);const o={onlyUrl:!1,onlyVector:!1,vectorAndUrl:!1,customList:!1},i=[];if(e&&e.length)if(e.forEach(e=>{var t;e&&((null===(t=e.dataSource.options.download)||void 0===t?void 0:t.allowedFormats)?(o.customList=!0,i.push({layer:e.title,formats:this.validateListFormat(e.dataSource.options.download.allowedFormats)})):e instanceof Wc||!e.dataSource.options.download||!e.dataSource.options.download.url?e.dataSource.options.download&&(e.dataSource.options.download.url||e.dataSource.options.download.dynamicUrl)?o.vectorAndUrl=!0:e instanceof Wc&&(o.onlyVector=!0):o.onlyUrl=!0)}),!0===o.onlyUrl&&!1===o.onlyVector)t=["URL"];else if(!0===o.onlyVector&&!1===o.onlyUrl){if(this.computeFormats(),Qh.URL in this.formats$.value){const e=Object.keys(this.formats$.value).filter(e=>"URL"!==e);t=e}}else if(!0===o.vectorAndUrl&&!1===o.onlyUrl&&!1===o.onlyVector&&(this.computeFormats(),!(Qh.URL in this.formats$.value))){const e=Object.keys(this.formats$.value);e.push("URL"),t=e}if(void 0!==this.config.getConfig("importExport.formats")){const e=this.validateListFormat(this.config.getConfig("importExport.formats"));t=e}if(o.customList){let o;const r=[];let s=i[0].formats;i.map(e=>{r.push(e.layer),o=e.formats.filter(e=>s.includes(e)),s=e.formats});const a=o.filter(e=>t.includes(e));a.length>0?(this.formats$.next(R(a)),e&&e.length&&e.length>1&&this.messageService.alert(this.languageService.translate.instant("igo.geo.export.customList.text",{value:r.join()}),this.languageService.translate.instant("igo.geo.export.customList.title"))):(this.formats$.next([]),this.messageService.alert(this.languageService.translate.instant("igo.geo.export.noFormat.text"),this.languageService.translate.instant("igo.geo.export.noFormat.title")))}else this.formats$.next(R(t))}validateListFormat(e){return e.filter(e=>{if(e.toUpperCase()===Qh.CSVcomma.toUpperCase()||e.toUpperCase()===Qh.CSVsemicolon.toUpperCase()||e.toUpperCase()===Qh.GML.toUpperCase()||e.toUpperCase()===Qh.GPX.toUpperCase()||e.toUpperCase()===Qh.GeoJSON.toUpperCase()||e.toUpperCase()===Qh.KML.toUpperCase()||e.toUpperCase()===Qh.Shapefile.toUpperCase()||e.toUpperCase()===Qh.URL.toUpperCase())return e}).map(e=>e.toUpperCase()===Qh.CSVcomma.toUpperCase()?e=Qh.CSVcomma:e.toUpperCase()===Qh.CSVsemicolon.toUpperCase()?e=Qh.CSVsemicolon:e.toUpperCase()===Qh.GML.toUpperCase()?e=Qh.GML:e.toUpperCase()===Qh.GPX.toUpperCase()?e=Qh.GPX:e.toUpperCase()===Qh.GeoJSON.toUpperCase()?e=Qh.GeoJSON:e.toUpperCase()===Qh.KML.toUpperCase()?e=Qh.KML:e.toUpperCase()===Qh.Shapefile.toUpperCase()?e=Qh.Shapefile:e.toUpperCase()===Qh.URL.toUpperCase()?e=Qh.URL:void 0)}modeChanged(e){this.selectMode.emit(e)}onFileExportSuccess(){!function(e,t){const o=t.translate,i=o.instant("igo.geo.export.success.title"),r=o.instant("igo.geo.export.success.text");e.success(r,i)}(this.messageService,this.languageService)}onImportExportChange(e){this.selectedMode=e.value}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(pp),Object(i.gc)(Xh),Object(i.gc)(le),Object(i.gc)(ce),Object(i.gc)(mp),Object(i.gc)(Qc),Object(i.gc)(Ue.g),Object(i.gc)(K),Object(i.gc)(i.j),Object(i.gc)(Oe),Object(i.gc)(Ku))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-import-export"]],inputs:{selectFirstProj:"selectFirstProj",map:"map",projectionsLimitations:"projectionsLimitations",store:"store",selectedMode:"selectedMode",exportOptions$:"exportOptions$"},outputs:{selectMode:"selectMode",exportOptionsChange:"exportOptionsChange"},decls:14,vars:17,consts:[[1,"import-export-toggle","mat-typography"],[3,"value","change"],[3,"value"],["class","igo-form",3,"formGroup",4,"ngIf"],["class","mat-typography",4,"ngIf"],[1,"igo-form",3,"formGroup"],[1,"igo-input-container"],[3,"value","valueChange"],[3,"value","click",4,"ngFor","ngForOf"],["tooltip-position","below","matTooltipShowDelay","500",1,"igo-form-button-group",3,"matTooltip"],["mat-raised-button","","type","button",3,"disabled","click"],[3,"shown"],["hidden","","type","file",3,"click","change"],["fileInput",""],[3,"value","click"],["mat-line","",4,"ngIf"],["mat-line",""],[1,"mat-typography"],["multiple","",3,"value","valueChange"],["class","export-select-trigger",4,"ngIf"],[3,"ngClass","value","click",4,"ngFor","ngForOf"],["formControlName","format"],[4,"ngIf"],["disabled","true",4,"ngIf"],["class","igo-input-container",4,"ngIf"],["class","export-options mat-typography",4,"ngIf"],[1,"igo-form-button-group"],[1,"export-select-trigger"],[3,"ngClass","value","click"],[3,"labelPosition","click","checked","change",4,"ngIf"],[3,"labelPosition","click","checked","change"],[3,"value",4,"ngFor","ngForOf"],["disabled","true"],["matInput","","formControlName","name",3,"placeholder"],["formControlName","encoding"],[1,"export-options","mat-typography"],["formControlName","featureInMapExtent",3,"labelPosition"]],template:function(e,t){1&e&&(Object(i.mc)(0,"div",0),Object(i.mc)(1,"mat-button-toggle-group",1),Object(i.tc)("change",(function(e){return t.onImportExportChange(e)})),Object(i.mc)(2,"mat-button-toggle",2),Object(i.ad)(3),Object(i.yc)(4,"translate"),Object(i.lc)(),Object(i.mc)(5,"mat-button-toggle",2),Object(i.ad)(6),Object(i.yc)(7,"translate"),Object(i.lc)(),Object(i.lc)(),Object(i.lc)(),Object(i.Yc)(8,yp,20,24,"form",3),Object(i.Yc)(9,vp,14,15,"section",4),Object(i.Yc)(10,jp,4,3,"section",4),Object(i.yc)(11,"async"),Object(i.Yc)(12,Ap,34,35,"form",3),Object(i.yc)(13,"async")),2&e&&(Object(i.Tb)(1),Object(i.Dc)("value",t.selectedMode),Object(i.Tb)(1),Object(i.Dc)("value","import"),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(4,9,"igo.geo.importExportForm.importTabTitle")," "),Object(i.Tb)(2),Object(i.Dc)("value","export"),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(7,11,"igo.geo.importExportForm.exportTabTitle")," "),Object(i.Tb)(2),Object(i.Dc)("ngIf","import"===t.selectedMode),Object(i.Tb)(1),Object(i.Dc)("ngIf","import"===t.selectedMode),Object(i.Tb)(1),Object(i.Dc)("ngIf",0===Object(i.zc)(11,13,t.exportableLayers$).length&&"export"===t.selectedMode),Object(i.Tb)(2),Object(i.Dc)("ngIf",Object(i.zc)(13,15,t.exportableLayers$).length>0&&"export"===t.selectedMode))},directives:[gn.b,gn.a,m.t,Ue.I,Ue.t,Ue.k,ke.c,ke.g,De.a,m.s,h.a,n.b,Bi,Pe.p,De.c,Ue.s,Ue.j,m.q,hn.a,Ve.b,Ue.d],pipes:[q.e,m.b,Ii],styles:["mat-option.igo-export-layer-mat-option[_ngcontent-%COMP%]{height:5em;line-height:1em}.import-export-toggle[_ngcontent-%COMP%]{padding:10px;text-align:center}.import-export-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]{width:100%}.import-export-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]{width:50%}h4[_ngcontent-%COMP%]{padding:0 5px}.igo-form[_ngcontent-%COMP%]{padding:15px 5px}.igo-input-container[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.igo-form-button-group[_ngcontent-%COMP%]{padding-top:10px;text-align:center}igo-spinner[_ngcontent-%COMP%]{padding-left:10px;position:absolute}.export-options[_ngcontent-%COMP%]{overflow-x:hidden}.export-options[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{margin:10px;width:100%}.export-options[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content{width:calc(100% - 60px)}.export-select-trigger[_ngcontent-%COMP%]{font-size:.75em;opacity:.75}"]}),e})(),Ep=new i.B("styleListOptions");function Rp(e){return{provide:Ep,useValue:e}}function _p(e,t){return()=>e.load(t)}let zp=(()=>{class e{static forRoot(){return{ngModule:e,providers:[Rp({}),{provide:i.d,useFactory:_p,multi:!0,deps:[mp,Ep]}]}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[]]}),e})(),Np=(()=>{class e{static forRoot(){return{ngModule:e}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[c.b,h.b,Ue.m,Ue.C,m.c,n.c,gn.c,xn.g,De.b,Pe.q,ke.e,Ve.c,hn.b,ie,Gi,Fi,qo,zp.forRoot()],zp]}),e})(),Bp=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,ie,_o,c.b,n.c,h.b]]}),e})(),qp=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,n.c,gn.c,c.b,h.b,ke.e,Ve.c,De.b,hn.b,ie,Oi]]}),e})(),Gp=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[],qp]}),e})();var Vp=function(e){return e[e.None=0]="None",e[e.Move=1]="Move",e[e.Zoom=2]="Zoom",e[e.ZoomIfOutMapExtent=3]="ZoomIfOutMapExtent",e}({});let Up=(()=>{class e{constructor(){this.features$=new C.a([[],void 0])}setFeatures(e,t=Vp.None){this.features$.next([e,t])}clear(){this.features$.next([[],Vp.None])}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Hp=(()=>{class e{constructor(e,t){this.component=e,this.overlayService=t,this.format=new sn.a}get map(){return this.component.map}ngOnInit(){this.features$$=this.overlayService.features$.subscribe(e=>this.handleFeatures(e[0],e[1]))}ngOnDestroy(){this.features$$.unsubscribe()}handleFeatures(e,t){}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(Sl,2),Object(i.gc)(Up))},e.\u0275dir=Object(i.bc)({type:e,selectors:[["","igoOverlay",""]]}),e})(),Yp=(()=>{class e{static forRoot(){return{ngModule:e}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[]]}),e})();const Wp=R(["Pdf","Image"]),Kp=R(["A0","A1","A2","A3","A4","A5","Letter","Legal"]),Zp=R(["landscape","portrait"]),Qp=R(["72","96","150","300"]),Jp=R(["Bmp","Gif","Jpeg","Png","Tiff"]);let Xp=(()=>{class e{constructor(e,t,o,i){this.http=e,this.messageService=t,this.activityService=o,this.languageService=i}print(e,t){const o=new k.a,i=t.paperFormat,r=+t.resolution,s=t.orientation;this.activityId=this.activityService.register();const a=new Dn({orientation:s,format:i.toLowerCase()}),n=[a.internal.pageSize.width,a.internal.pageSize.height],c=[10,10,10,10],l=n[0]-c[3]-c[1],u=n[1]-c[0]-c[2],d=[l,u];let h=[0,0];if(void 0!==t.title&&(h=this.getTitleSize(t.title,l,u,a),this.addTitle(a,t.title,h[0],c[3]+h[1],h[0]*(25.4/72))),void 0!==t.subtitle){let e=0;const o=h[0];e=this.getSubTitleSize(t.subtitle,l,u,a),this.addSubTitle(a,t.subtitle,.7*o,c[3]+e,1.7*o*(25.4/72)),c[0]=c[0]+.7*h[0]*(25.4/72)}return!0!==t.showProjection&&!0!==t.showScale||this.addProjScale(a,e,r,t.showProjection,t.showScale),""!==t.comment&&this.addComment(a,t.comment),this.addMap(a,e,r,d,c).subscribe(i=>Object(_e.a)(this,void 0,void 0,(function*(){i===N.Done&&(yield this.addScale(a,e,c),!0===t.showLegend?yield this.addLegend(a,e,c,r):yield this.saveDoc(a)),i!==N.Done&&i!==N.Error||(this.activityService.unregister(this.activityId),o.next(N.Done))}))),o}getLayersLegendHtml(e,t,o){return new xe.a(i=>{let r="";const s=function(e,t){const o=[];for(const i of e){if(!1===i.visible)continue;const e=i.dataSource.getLegend(void 0,t)||[];for(const t of e)void 0!==t.url&&o.push({title:i.title,url:t.url})}return o}(e.layers,{resolution:e.viewController.getResolution(),extent:e.viewController.getExtent(),projection:e.viewController.getOlProjection().getCode(),scale:e.viewController.getScale(o),size:e.ol.getSize()});if(0===s.length)return i.next(r),void i.complete();r+='<style media="screen" type="text/css">',r+=".html2canvas-container { width: "+t,r+="mm !important; height: 2000px !important; }",r+="</style>",r+='<font size="2" face="Courier New" >',r+='<div style="display:grid;grid-template-columns:'+t/2+"mm "+t/2+"mm;max-width:"+t+'mm">';const a=s.map(e=>this.getDataImage(e.url).pipe(Object(j.a)(t=>{let o='<table border=1 style="vertical-align:top">';return o+='<tr><th width="170px">'+e.title+"</th>",o+='<td><img class="printImageLegend" src="'+t+'">',o+="</td></tr></table>",o})));Object(Ks.a)(a).subscribe(e=>{r=e.reduce((e,t)=>e+t,r),r+="</div>",i.next(r),i.complete()})})}getDataImage(e){return new yt(this.http).transform(e)}getLayersLegendImage(e,t="png",o,i){return Object(_e.a)(this,void 0,void 0,(function*(){const r=new k.a;let s=yield this.getLayersLegendHtml(e,200,i).toPromise();t=t.toLowerCase(),0===s.length&&(s='<font size="12" face="Courier New" >',s+='<div align="center"><b>NO LEGEND</b></div>');const a=window.document.createElement("div");a.style.position="absolute",a.style.top="0",window.document.body.appendChild(a),a.innerHTML=s,yield this.timeout(1);const n=yield An()(a,{useCORS:!0}).catch(e=>{console.log(e)});if(n){let e=N.Done;try{o?this.generateCanvaFileToZip(n,"legendImage."+t):this.saveCanvasImageAsFile(n,"legendImage",t),a.parentNode.removeChild(a)}catch(c){e=N.Error}r.next(e)}return r}))}getTitleSize(e,t,o,i){const r=Math.round(2*(o+145)*.05)/2;i.setFont("Times"),i.setFontType("Bold"),i.getTextWidth(e);const s=i.getStringUnitWidth(e)*r/i.internal.scaleFactor,a=Math.round(2*(o+150)*.037)/2;let n,c=0;return s>=t?(n=0,c=Math.round(t/e.length*96/25.4),c<a&&(c=a)):(n=(t-s)/2,c=r),[c,n]}getSubTitleSize(e,t,o,i){const r=.7*Math.round(2*(o+145)*.05)/2;i.setFont("Times"),i.setFontType("Bold");const s=i.getStringUnitWidth(e)*r/i.internal.scaleFactor;let a;return a=s>=t?0:(t-s)/2,a}addTitle(e,t,o,i,r){e.setFont("Times"),e.setFontType("Bold"),e.setFontSize(o),e.text(t,i,r)}addSubTitle(e,t,o,i,r){e.setFont("Times"),e.setFontType(),e.setFontSize(o),e.text(t,i,r)}addComment(e,t){const o=e.internal.pageSize.height-5;e.setFont("courier"),e.setFontSize(16),e.text(t,20,o)}addProjScale(e,t,o,i,r){const s=this.languageService.translate,a=e.internal.pageSize.height-15;let n="";!0===i&&(n+=s.instant("igo.geo.printForm.projection")+": "+t.projection),!0===r&&(!0===i&&(n+="   "),n+=s.instant("igo.geo.printForm.scale")+": ~ 1 / "+_n(t.viewController.getScale(o))),e.setFont("courier"),e.setFontSize(16),e.text(n,20,a)}addLegend(e,t,o,i){return Object(_e.a)(this,void 0,void 0,(function*(){const r=e.internal.pageSize.width,s=yield this.getLayersLegendHtml(t,r,i).toPromise();if(""===s)return yield this.saveDoc(e),!0;const a=window.document.createElement("div");a.style.position="absolute",a.style.top="0",window.document.body.appendChild(a),a.innerHTML=s,yield this.timeout(1);const n=yield An()(a,{useCORS:!0}).catch(e=>{console.log(e)});if(n){let t;const i=10;t=n.toDataURL("image/png"),e.addPage();const r=this.getImageSizeToFitPdf(e,n,o);e.addImage(t,"PNG",10,i,r[0],r[1]),yield this.saveDoc(e),a.parentNode.removeChild(a)}}))}addScale(e,t,o){return Object(_e.a)(this,void 0,void 0,(function*(){const i=t.ol.getSize();let r;t.ol.getView().calculateExtent(i);const s=t.ol.getOverlayContainerStopEvent(),a=s.getElementsByTagName("button");for(const e of a)e.setAttribute("data-html2canvas-ignore","true");yield An()(s,{scale:1,backgroundColor:null,allowTaint:!0,useCORS:!0}).then(e=>{r=e}),this.addCanvas(e,r,o)}))}defineNbFileToProcess(e){this.nbFileToProcess=e}timeout(e){return new Promise(t=>setTimeout(t,e))}addCanvas(e,t,o){let i;if(t&&(i=t.toDataURL("image/png")),void 0!==i){const r=this.getImageSizeToFitPdf(e,t,o);e.addImage(i,"PNG",o[3],o[0],r[0],r[1]),e.rect(o[3],o[0],r[0],r[1])}}addMap(e,t,o,i,r){const s=new k.a,a=t.ol.getSize(),n=t.ol.getView().calculateExtent(a),c=Math.round(i[0]*o/25.4),l=Math.round(i[1]*o/25.4);let u;return t.ol.once("rendercomplete",o=>{const i=o.target.getViewport().getElementsByTagName("canvas"),c=t.status$.subscribe(o=>{if(clearTimeout(u),o!==N.Done)return;c.unsubscribe();let l=N.Done;try{for(const t of i)0!==t.width&&this.addCanvas(e,t,r)}catch(d){l=N.Error,this.messageService.error(this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageBody"),this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageHeader"))}this.renderMap(t,a,n),s.next(l)});u=window.setTimeout(()=>{c.unsubscribe();let o=N.Done;try{for(const t of i)0!==t.width&&this.addCanvas(e,t,r)}catch(l){o=N.Error,this.messageService.error(this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageBody"),this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageHeader"))}this.renderMap(t,a,n),s.next(o)},200)}),this.renderMap(t,[c,l],n),s}downloadMapImage(e,t,o="png",i=!1,r=!1,s=!1,a="",n="",c="",l=!0){const u=new k.a;this.activityId=this.activityService.register();const d=this.languageService.translate;return e.ol.once("rendercomplete",s=>{o=o.toLowerCase();const h=s.target.getViewport().getElementsByTagName("canvas")[0],p=document.createElement("canvas"),m=p.getContext("2d");let g=0,b=10;const f=h.width;let y=h.height;m.font="20px Calibri";const O=m.measureText(c).width;y=""!==a?y+30:y,y=""!==n?y+30:y,y=!1!==i||!1!==r?y+30:y;const v=y-10,j=Math.ceil(O/f);y=""!==c?y+30*j:y;let w=y-20*j+5;if(p.width=f,p.height=y,"jpeg"===o&&(m.fillStyle="#ffffff",m.fillRect(0,0,f,y),m.fillStyle="#000000"),""!==a&&(m.font="26px Calibri",g=30,m.textAlign="center",m.fillText(a,f/2,20,.9*f)),""!==n&&(m.font="26px Calibri",g=60,m.textAlign="center",m.fillText(n,f/2,50,.9*f)),m.font="20px Calibri",!1!==i){const t=d.instant("igo.geo.printForm.projection");m.textAlign="start",m.fillText(t+": "+e.projection,b,v),b+=200}if(!1!==r){const o=d.instant("igo.geo.printForm.scale"),i=e.viewController.getScale(t);m.textAlign="start",m.fillText(o+": ~ 1 / "+_n(i),b,v)}if(""!==c)if(m.textAlign="center",1===j)m.fillText(c,f/2,w);else{const e=Math.floor(c.length/j);let t,o="",i=0;for(let r=0;r<j;r++)j-1>r?(o=c.substr(i,e),t=o.lastIndexOf(" "),m.fillText(o.substr(0,t),f/2,w),i+=t,w+=20):m.fillText(c.substr(i),f/2,w)}m.drawImage(h,0,g);let S=N.Done;try{l?"tiff"===o.toLowerCase()?this.generateCanvaFileToZip(p,"map"+e.projection.replace(":","_")+"."+o):this.generateCanvaFileToZip(p,"map."+o):this.saveCanvasImageAsFile(p,"map",o)}catch(x){S=N.Error}if(u.next(S),"tiff"===o.toLowerCase()){const t=this.getWorldFileInformation(e),o=new Blob([t],{type:"text/plain;charset=utf-8"});l?this.addFileToZip("map"+e.projection.replace(":","_")+".tfw",o):(Object(kn.saveAs)(o,"map"+e.projection+".tfw"),this.saveFileProcessing())}}),e.ol.renderSync(),u}renderMap(e,t,o){e.ol.updateSize(),e.ol.renderSync()}saveDoc(e){return Object(_e.a)(this,void 0,void 0,(function*(){yield e.save("map.pdf",{returnPromise:!0})}))}getImageSizeToFitPdf(e,t,o){const i=e.internal.pageSize.getHeight()-(o[0]+o[2]),r=e.internal.pageSize.getWidth()-(o[1]+o[3]),s=t.height,a=t.width,n=s/i,c=a/r,l=n>c?n:c;return[l>1?a/l:a,l>1?s/l:s]}getWorldFileInformation(e){const t=e.viewController.getResolution(),o=e.viewController.getExtent();return[t,0,0,-t,o[0]+t/.5,o[3]-t/.5].join("\n")}saveCanvasImageAsFile(e,t,o){const i="image/"+o,r=this;try{e.toDataURL(),navigator.msSaveBlob?(navigator.msSaveBlob(e.msToBlob(),t+"."+o),this.saveFileProcessing()):e.toBlob(e=>{Object(kn.saveAs)(e,t+"."+o),r.saveFileProcessing()},i)}catch(s){this.messageService.error(this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageBody"),this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageHeader"))}}generateCanvaFileToZip(e,t){const o=this;this.hasOwnProperty("zipFile")&&void 0!==this.zipFile||(this.zipFile=new $n);try{e.toDataURL(),navigator.msSaveBlob?this.addFileToZip(t,e.msToBlob()):e.toBlob(e=>{o.addFileToZip(t,e)},"image/jpeg")}catch(i){this.messageService.error(this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageBody"),this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageHeader"))}}addFileToZip(e,t){this.zipFile.file(e,t),this.nbFileToProcess--,0===this.nbFileToProcess&&(this.getZipFile(),this.activityService.unregister(this.activityId))}saveFileProcessing(){this.nbFileToProcess--,0===this.nbFileToProcess&&this.activityService.unregister(this.activityId)}getZipFile(){const e=this;this.zipFile.generateAsync({type:"blob"}).then(t=>{Object(kn.saveAs)(t,"map.zip"),delete e.zipFile})}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(y.b),Object(i.qc)(ce),Object(i.qc)(U),Object(i.qc)(le))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function em(e,t){if(1&e&&(Object(i.mc)(0,"mat-option",19),Object(i.ad)(1),Object(i.lc)()),2&e){const e=t.$implicit;Object(i.Dc)("value",e.key),Object(i.Tb)(1),Object(i.cd)(" ",e.value," ")}}function tm(e,t){if(1&e&&(Object(i.mc)(0,"mat-option",19),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()),2&e){const e=t.$implicit;Object(i.Dc)("value",e.key),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(2,2,"igo.geo.printForm.paperFormats."+e.value)," ")}}function om(e,t){if(1&e&&(Object(i.mc)(0,"mat-option",19),Object(i.ad)(1),Object(i.lc)()),2&e){const e=t.$implicit;Object(i.Dc)("value",e.key),Object(i.Tb)(1),Object(i.cd)(" ",e.value," ")}}function im(e,t){if(1&e&&(Object(i.mc)(0,"mat-option",19),Object(i.ad)(1),Object(i.lc)()),2&e){const e=t.$implicit;Object(i.Dc)("value",e.key),Object(i.Tb)(1),Object(i.cd)(" ",e.value+" PPI"," ")}}function rm(e,t){if(1&e&&(Object(i.mc)(0,"mat-option",19),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()),2&e){const e=t.$implicit;Object(i.Dc)("value",e.key),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(2,2,"igo.geo.printForm."+e.value)," ")}}let sm=(()=>{class e{constructor(e){this.formBuilder=e,this.outputFormats=Wp,this.paperFormats=Kp,this.orientations=Zp,this.resolutions=Qp,this.imageFormats=Jp,this.isPrintService=!0,this.submit=new i.u,this.form=this.formBuilder.group({title:["",[]],subtitle:["",[]],comment:["",[]],outputFormat:["",[Ue.G.required]],paperFormat:["",[Ue.G.required]],imageFormat:["",[Ue.G.required]],resolution:["",[Ue.G.required]],orientation:["",[Ue.G.required]],showProjection:!1,showScale:!1,showLegend:!1,doZipFile:[{hidden:this.isPrintService}]})}get imageFormat(){return this.imageFormatField.value}set imageFormat(e){this.imageFormatField.setValue(e||Jp.Jpeg,{onlySelf:!0})}get outputFormat(){return this.outputFormatField.value}set outputFormat(e){this.outputFormatField.setValue(e||Wp.Pdf,{onlySelf:!0})}get paperFormat(){return this.paperFormatField.value}set paperFormat(e){this.paperFormatField.setValue(e||Kp.Letter,{onlySelf:!0})}get orientation(){return this.orientationField.value}set orientation(e){this.orientationField.setValue(e||Zp.landscape,{onlySelf:!0})}get resolution(){return this.resolutionField.value}set resolution(e){this.resolutionField.setValue(e||Qp[96],{onlySelf:!0})}get title(){return this.titleField.value}set title(e){this.titleField.setValue(e,{onlySelf:!0})}get subtitle(){return this.subtitleField.value}set subtitle(e){this.subtitleField.setValue(e,{onlySelf:!0})}get comment(){return this.commentField.value}set comment(e){this.commentField.setValue(e,{onlySelf:!0})}get showProjection(){return this.showProjectionField.value}set showProjection(e){this.showProjectionField.setValue(e,{onlySelf:!0})}get showScale(){return this.showScaleField.value}set showScale(e){this.showScaleField.setValue(e,{onlySelf:!0})}get showLegend(){return this.showLegendField.value}set showLegend(e){this.showLegendField.setValue(e,{onlySelf:!0})}get doZipFile(){return this.doZipFileField.value}set doZipFile(e){this.doZipFileField.setValue(e,{onlySelf:!0})}get outputFormatField(){return this.form.controls.outputFormat}get paperFormatField(){return this.form.controls.paperFormat}get imageFormatField(){return this.form.controls.imageFormat}get orientationField(){return this.form.controls.orientation}get resolutionField(){return this.form.controls.resolution}get commentField(){return this.form.controls.comment}get showProjectionField(){return this.form.controls.showProjection}get showScaleField(){return this.form.controls.showScale}get showLegendField(){return this.form.controls.showLegend}get doZipFileField(){return this.form.controls.doZipFile}get titleField(){return this.form.controls.title}get subtitleField(){return this.form.controls.subtitle}ngOnInit(){this.doZipFileField.setValue(!1)}handleFormSubmit(e,t){e.isPrintService=this.isPrintService,t&&this.submit.emit(e)}toggleImageSaveProp(){this.isPrintService="Image"!==this.outputFormatField.value}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(Ue.g))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-print-form"]],inputs:{disabled$:"disabled$",imageFormat:"imageFormat",outputFormat:"outputFormat",paperFormat:"paperFormat",orientation:"orientation",resolution:"resolution",title:"title",subtitle:"subtitle",comment:"comment",showProjection:"showProjection",showScale:"showScale",showLegend:"showLegend",doZipFile:"doZipFile"},outputs:{submit:"submit"},decls:62,vars:70,consts:[[1,"igo-form",3,"formGroup"],[1,"igo-input-container"],["matInput","","formControlName","title",3,"placeholder"],["matInput","","formControlName","subtitle",3,"placeholder"],["matInput","","formControlName","comment",3,"placeholder"],[1,"print-slide-toggle-container","mat-typography"],["formControlName","showProjection",1,"print-option",3,"labelPosition"],["formControlName","showScale",1,"print-option",3,"labelPosition"],["formControlName","showLegend",1,"print-option",3,"labelPosition"],["formControlName","doZipFile",1,"print-option",3,"labelPosition"],["formControlName","outputFormat",3,"placeholder","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["formControlName","paperFormat",3,"placeholder"],["formControlName","imageFormat",3,"placeholder"],[1,"igo-input-container",2,"display","none"],["formControlName","resolution",3,"placeholder"],["formControlName","orientation",3,"placeholder"],[1,"igo-form-button-group","print-button-top-padding"],["mat-raised-button","","type","button",3,"disabled","click"],[3,"value"]],template:function(e,t){1&e&&(Object(i.mc)(0,"form",0),Object(i.mc)(1,"div",1),Object(i.mc)(2,"mat-form-field"),Object(i.hc)(3,"input",2),Object(i.yc)(4,"translate"),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(5,"div",1),Object(i.mc)(6,"mat-form-field"),Object(i.hc)(7,"input",3),Object(i.yc)(8,"translate"),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(9,"div",1),Object(i.mc)(10,"mat-form-field"),Object(i.hc)(11,"input",4),Object(i.yc)(12,"translate"),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(13,"div",1),Object(i.mc)(14,"div",5),Object(i.mc)(15,"mat-slide-toggle",6),Object(i.ad)(16),Object(i.yc)(17,"translate"),Object(i.lc)(),Object(i.mc)(18,"mat-slide-toggle",7),Object(i.ad)(19),Object(i.yc)(20,"translate"),Object(i.lc)(),Object(i.mc)(21,"mat-slide-toggle",8),Object(i.ad)(22),Object(i.yc)(23,"translate"),Object(i.lc)(),Object(i.mc)(24,"mat-slide-toggle",9),Object(i.ad)(25),Object(i.yc)(26,"translate"),Object(i.lc)(),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(27,"div",1),Object(i.mc)(28,"mat-form-field"),Object(i.mc)(29,"mat-select",10),Object(i.tc)("selectionChange",(function(){return t.toggleImageSaveProp()})),Object(i.yc)(30,"translate"),Object(i.Yc)(31,em,2,2,"mat-option",11),Object(i.yc)(32,"keyvalue"),Object(i.lc)(),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(33,"div",1),Object(i.mc)(34,"mat-form-field"),Object(i.mc)(35,"mat-select",12),Object(i.yc)(36,"translate"),Object(i.Yc)(37,tm,3,4,"mat-option",11),Object(i.yc)(38,"keyvalue"),Object(i.lc)(),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(39,"div",1),Object(i.mc)(40,"mat-form-field"),Object(i.mc)(41,"mat-select",13),Object(i.yc)(42,"translate"),Object(i.Yc)(43,om,2,2,"mat-option",11),Object(i.yc)(44,"keyvalue"),Object(i.lc)(),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(45,"div",14),Object(i.mc)(46,"mat-form-field"),Object(i.mc)(47,"mat-select",15),Object(i.yc)(48,"translate"),Object(i.Yc)(49,im,2,2,"mat-option",11),Object(i.yc)(50,"keyvalue"),Object(i.lc)(),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(51,"div",1),Object(i.mc)(52,"mat-form-field"),Object(i.mc)(53,"mat-select",16),Object(i.yc)(54,"translate"),Object(i.Yc)(55,rm,3,4,"mat-option",11),Object(i.yc)(56,"keyvalue"),Object(i.lc)(),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(57,"div",17),Object(i.mc)(58,"button",18),Object(i.tc)("click",(function(){return t.handleFormSubmit(t.form.value,t.form.valid)})),Object(i.yc)(59,"async"),Object(i.ad)(60),Object(i.yc)(61,"translate"),Object(i.lc)(),Object(i.lc)(),Object(i.lc)()),2&e&&(Object(i.Dc)("formGroup",t.form),Object(i.Tb)(3),Object(i.Ec)("placeholder",Object(i.zc)(4,32,"igo.geo.printForm.title")),Object(i.Tb)(4),Object(i.Ec)("placeholder",Object(i.zc)(8,34,"igo.geo.printForm.subtitle")),Object(i.Tb)(4),Object(i.Ec)("placeholder",Object(i.zc)(12,36,"igo.geo.printForm.comment")),Object(i.Tb)(4),Object(i.Dc)("labelPosition","before"),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(17,38,"igo.geo.printForm.showProjection")," "),Object(i.Tb)(2),Object(i.Dc)("labelPosition","before"),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(20,40,"igo.geo.printForm.showScale")," "),Object(i.Tb)(2),Object(i.Dc)("labelPosition","before"),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(23,42,"igo.geo.printForm.showLegend")," "),Object(i.Tb)(2),Object(i.Vc)("display",t.isPrintService?"none":""),Object(i.Dc)("labelPosition","before"),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(26,44,"igo.geo.printForm.doZipFile")," "),Object(i.Tb)(4),Object(i.Ec)("placeholder",Object(i.zc)(30,46,"igo.geo.printForm.outputFormat")),Object(i.Tb)(2),Object(i.Dc)("ngForOf",Object(i.zc)(32,48,t.outputFormats)),Object(i.Tb)(2),Object(i.Vc)("display",t.isPrintService?"block":"none"),Object(i.Tb)(2),Object(i.Ec)("placeholder",Object(i.zc)(36,50,"igo.geo.printForm.paperFormat")),Object(i.Tb)(2),Object(i.Dc)("ngForOf",Object(i.zc)(38,52,t.paperFormats)),Object(i.Tb)(2),Object(i.Vc)("display",t.isPrintService?"none":"block"),Object(i.Tb)(2),Object(i.Ec)("placeholder",Object(i.zc)(42,54,"igo.geo.printForm.imageFormat")),Object(i.Tb)(2),Object(i.Dc)("ngForOf",Object(i.zc)(44,56,t.imageFormats)),Object(i.Tb)(4),Object(i.Ec)("placeholder",Object(i.zc)(48,58,"igo.geo.printForm.resolution")),Object(i.Tb)(2),Object(i.Dc)("ngForOf",Object(i.zc)(50,60,t.resolutions)),Object(i.Tb)(2),Object(i.Vc)("display",t.isPrintService?"block":"none"),Object(i.Tb)(2),Object(i.Ec)("placeholder",Object(i.zc)(54,62,"igo.geo.printForm.orientation")),Object(i.Tb)(2),Object(i.Dc)("ngForOf",Object(i.zc)(56,64,t.orientations)),Object(i.Tb)(3),Object(i.Dc)("disabled",!t.form.valid||Object(i.zc)(59,66,t.disabled$)),Object(i.Tb)(2),Object(i.cd)(" ",Object(i.zc)(61,68,"igo.geo.printForm.saveBtn")," "))},directives:[Ue.I,Ue.t,Ue.k,ke.c,Ve.b,Ue.d,Ue.s,Ue.j,hn.a,De.a,m.s,n.b,Pe.p],pipes:[q.e,Ii,m.b],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}.print-slide-toggle-container[_ngcontent-%COMP%]{overflow-x:hidden}.print-slide-toggle-container[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{margin:10px;width:100%}.print-slide-toggle-container[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content{width:calc(100% - 60px)}.print-option[_ngcontent-%COMP%]{display:block;margin-bottom:15px;margin-right:10px}.print-button-top-padding[_ngcontent-%COMP%]{padding-top:25px}.igo-form[_ngcontent-%COMP%]{padding:10px 5px 5px}.igo-form-button-group[_ngcontent-%COMP%]{text-align:center}"]}),e})(),am=(()=>{class e{constructor(e){this.printService=e,this.disabled$=new C.a(!1)}get map(){return this._map}set map(e){this._map=e}get outputFormat(){return this._outputFormat}set outputFormat(e){this._outputFormat=e}get paperFormat(){return this._paperFormat}set paperFormat(e){this._paperFormat=e}get orientation(){return this._orientation}set orientation(e){this._orientation=e}get imageFormat(){return this._imageFormat}set imageFormat(e){this._imageFormat=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}handleFormSubmit(e){if(this.disabled$.next(!0),!0===e.isPrintService)this.printService.print(this.map,e).pipe(Object(Me.a)(1)).subscribe(()=>{this.disabled$.next(!1)});else{let t=1;e.showLegend&&t++,"tiff"===e.imageFormat.toLowerCase()&&t++,this.printService.defineNbFileToProcess(t);const o=+e.resolution;let i=e.showLegend?2:1;this.printService.downloadMapImage(this.map,o,e.imageFormat,e.showProjection,e.showScale,e.showLegend,e.title,e.subtitle,e.comment,e.doZipFile).pipe(Object(Me.a)(1)).subscribe(()=>{i--,i||this.disabled$.next(!1)}),e.showLegend&&this.printService.getLayersLegendImage(this.map,e.imageFormat,e.doZipFile,+o).then(()=>{i--,i||this.disabled$.next(!1)})}}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(Xp))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-print"]],inputs:{map:"map",outputFormat:"outputFormat",paperFormat:"paperFormat",orientation:"orientation",imageFormat:"imageFormat",resolution:"resolution"},decls:1,vars:6,consts:[[3,"outputFormat","paperFormat","orientation","imageFormat","resolution","disabled$","submit"]],template:function(e,t){1&e&&(Object(i.mc)(0,"igo-print-form",0),Object(i.tc)("submit",(function(e){return t.handleFormSubmit(e)})),Object(i.lc)()),2&e&&Object(i.Dc)("outputFormat",t.outputFormat)("paperFormat",t.paperFormat)("orientation",t.orientation)("imageFormat",t.imageFormat)("resolution",t.resolution)("disabled$",t.disabled$)},directives:[sm],encapsulation:2}),e})(),nm=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,Ue.m,Ue.C,c.b,n.c,De.b,Pe.q,Ve.c,ke.e,hn.b,ie,Fi]]}),e})();function cm(e){return new Wl(e.getConfig("searchSources."+Wl.id)||{})}let lm=(()=>{class e{static forRoot(){return{ngModule:e,providers:[{provide:Yl,useFactory:cm,multi:!0,deps:[K]}]}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},providers:[Gl],imports:[[m.c]]}),e})();class um{constructor(e){this.sources=e}getSources(){return this.sources}getEnabledSources(){return this.getSources().filter(e=>!0===e.enabled)}enableSourcesByType(e){this.getSources().forEach(t=>{t.enabled=t.constructor.type===e})}setParamFromSetting(e,t){e.setParamFromSetting(t)}}function dm(e){return void 0!==e.search}function hm(e){return void 0!==e.reverseSearch}function pm(e){return void 0!==e.reverseSearch&&!0===e.showInPointerSummary}function mm(e,t){let o="";return t.split("").forEach((t,i)=>{t!==e.charAt(i)&&(o+=t)}),o}function gm(e,t,o=!1){if(!e||!t)return 0;const i=o?e:e.toLowerCase(),r=o?t:t.toLowerCase(),s=mm(i,r)+mm(r,i);let a=0;return s.length&&(a=s.length/i.length*100),100-Math.floor(a)}let bm=(()=>{class e{constructor(e,t){this.searchSourceService=e,this.mapService=t}search(e,t={}){var o,i;if(!this.termIsValid(e))return[];const r=function(e,t,o={}){let i,r,s,a,n,c,l,u,d,h,p,m,g,b,f,y,O,v,j,w;const S=new RegExp("(\\s*;\\s*[\\d]{4,6})","g"),x="([-+])?([\\d]{1,3})([,.](\\d+))?[\\s,]+([-+])?([\\d]{1,3})([,.](\\d+))?",C=new RegExp(`^${x}$`,"g"),T="([0-9]{1,2})[:|\xb0]?\\s*([0-9]{1,2})?[:|'|\u2032|\u2019]?\\s*([0-9]{1,2}(?:.[0-9]+){0,1})?\\s*[\"|\u2033|\u201d]?\\s*",L=`${T}([N|S|E|W|O]),?\\s*${T}([N|S|E|W|O])`,I=new RegExp(`^${L}$`,"gi"),F="(UTM)-?(\\d{1,2})[\\s,]*(\\d+[.,]?\\d+)[\\s,]+(\\d+[.,]?\\d+)",M=new RegExp("^"+F,"gi"),k="(MTM)-?(\\d{1,2})[\\s,]*(\\d+[.,]?\\d+)[\\s,]+(\\d+[.,]?\\d+)",D=new RegExp("^"+k,"gi"),P="([-+])?(\\d{1,3})[,.](\\d+)",A=`${P}\\s*[,]?\\s*${P}`,$=new RegExp("^"+A,"g"),E="([-+])?(\\d{1,3})[\\s,.]{1}(\\d{1,2})[\\s,.]{1}(\\d{1,2})[.,]?(\\d{1,5})?",R=`${E}\\s*[,.]?\\s*${E}`,_=new RegExp("^"+R,"g"),z="LAT\\s*[\\s:]*\\s*([-+])?(\\d{1,2})[\\s.,]?(\\d+)?[\\s.,]?\\s*(\\d{1,2}([.,]\\d+)?)?\\s*(N|S|E|W)?\\s*LONG\\s*[\\s:]*\\s*([-+])?(\\d{1,3})[\\s.,]?(\\d+)?[\\s.,]?\\s*(\\d{1,2}([.,]\\d+)?)?\\s*(N|S|E|W)?\\s*UNC\\s*[\\s:]?\\s*(\\d+)\\s*CONF\\s*[\\s:]?\\s*(\\d{1,3})",N=new RegExp(`^${z}?`,"gi"),B="([-+]?\\d+)[,.]?(\\d+)?[\\s,]+([-+]?\\d+)[,.]?(\\d+)?",q=new RegExp(`^${B}$`,"g");let G=!1;if(e=e.toLocaleUpperCase().trim(),S.test(e)?[r,w]=e.split(";").map(e=>e.trim()):r=e,C.test(r))[,s,v,,u,d,j,,b]=r.match(x),v=parseFloat((s||"")+v+"."+u),j=parseFloat((d||"")+j+"."+b);else if(I.test(r))[,a,n,c,l,h,p,m,g]=r.match(L),"S"!==l&&"N"!==l||(a=[h,h=a][0],n=[p,p=n][0],c=[m,m=c][0],l=[g,g=l][0]),v=Rn(parseFloat(a),parseFloat(n),parseFloat(c),l),j=Rn(parseFloat(h),parseFloat(p),parseFloat(m),g);else if(M.test(r)){G=!0,[,,f,v,j]=r.match(F);const e=Number(f)<10?"EPSG:3260"+f:"EPSG:326"+f;[v,j]=Object(sa.s)([parseFloat(v),parseFloat(j)],e,"EPSG:4326")}else if(D.test(r)){G=!0,[,,f,v,j]=r.match(k);const e=Number(f)<10?"EPSG:3218"+f:"EPSG:321"+(80+Number(f));[v,j]=Object(sa.s)([parseFloat(v),parseFloat(j)],e,"EPSG:4326")}else if(_.test(r))[,s,a,n,c,u,d,h,p,m,b]=r.match(R),v=Rn(parseFloat((s||"")+a),parseFloat(n),parseFloat(c),l),j=Rn(parseFloat((d||"")+h),parseFloat(p),parseFloat(m),g);else if($.test(r))[,s,a,u,d,h,b]=r.match(A),v=Rn(parseFloat((s||"")+a),parseFloat(n),parseFloat(c),l),j=Rn(parseFloat((d||"")+h),parseFloat(p),parseFloat(m),g);else if(N.test(r))[,d,h,p,m,,g,s,a,n,c,,l,y,O]=r.match(z),l||(l="W"),v=n&&n.length>2?parseFloat((s||"")+a+"."+n):Rn(parseFloat(a),parseFloat(n),parseFloat(c),l),j=p&&p.length>2?parseFloat((d||"")+h+"."+p):Rn(parseFloat(h),parseFloat(p),parseFloat(m),g);else{if(!q.test(r))return{lonLat:void 0,message:"",radius:void 0,conf:void 0};G=!0,[,v,u,j,b]=r.match(B),u&&(v=parseFloat(v+"."+u)),b&&(j=parseFloat(j+"."+b))}if(o.forceNA&&!G&&(v>0&&j>0&&(v>j?v=-v:j=-j),v>j&&(v=[j,j=v][0])),i=[Number(v),Number(j)],void 0!==w&&"4326"!==w||i[0]>180||i[0]<-180||i[1]>90||i[1]<-90){const e=w?"EPSG:"+w:t,o="EPSG:4326";try{i=Object(sa.s)(i,e,o)}catch(V){return{lonLat:void 0,message:"Projection "+e+" not supported",radius:void 0,conf:void 0}}}return Math.abs(i[0])<=180&&Math.abs(i[1])<=90?{lonLat:i,message:"",radius:y?parseInt(y,10):void 0,conf:O?parseInt(O,10):void 0}:{lonLat:void 0,message:"Coordinate out of Longitude/Latitude bounds",radius:void 0,conf:void 0}}(e,(null===(o=this.mapService.getMap())||void 0===o?void 0:o.projection)||"EPSG:3857",{forceNA:t.forceNA});if(r.lonLat)return this.reverseSearch(r.lonLat,{distance:r.radius,conf:r.conf});let s;return r.message&&console.log(r.message),t.extent=null===(i=this.mapService.getMap())||void 0===i?void 0:i.viewController.getExtent("EPSG:4326"),s=t.getEnabledOnly||void 0===t.getEnabledOnly?this.searchSourceService.getEnabledSources():this.searchSourceService.getSources(),t.sourceId?s=s.filter(e=>e.getId()===t.sourceId):t.searchType&&(s=s.filter(e=>e.getType()===t.searchType)),s=s.filter(dm),this.searchSources(s,e,t)}reverseSearch(e,t,o=!1){const i=o?pm:hm,r=this.searchSourceService.getEnabledSources().filter(i);return this.reverseSearchSources(r,e,t||{})}searchSources(e,t,o){return e.map(e=>({request:e.search(t,o),reverse:!1,source:e}))}reverseSearchSources(e,t,o){return e.map(e=>({request:e.reverseSearch(t,o),reverse:!0,source:e}))}termIsValid(e){return"string"==typeof e&&""!==e}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(um),Object(i.qc)(jl))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class fm{}class ym{constructor(e){this.sources=e}}function Om(e){return new ym(e)}function vm(){return{provide:ym,useFactory:Om,deps:[fm]}}let jm=(()=>{class e{constructor(e){this.directionsSourceService=e}route(e,t={}){if(0!==e.length)return this.directionsSourceService.sources.filter(e=>e.enabled).map(o=>this.routeSource(o,e,t))}routeSource(e,t,o={}){return e.route(t,o)}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(ym))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),wm=(()=>{class e{constructor(){}getStopsCoordinates(){const e=[];return this.stops&&this.stops.forEach(t=>{e.push(t.stopCoordinates)}),e}setStops(e){this.stops=e}getStops(){return this.stops}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac}),e})();function Sm(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",17),Object(i.tc)("click",(function(){Object(i.Nc)(e);const t=Object(i.xc)().index;return Object(i.xc)().geolocateStop(t)})),Object(i.yc)(1,"translate"),Object(i.hc)(2,"mat-icon",18),Object(i.lc)()}2&e&&Object(i.Dc)("matTooltip",Object(i.zc)(1,1,"igo.geo.directionsForm.geolocate"))}function xm(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",19),Object(i.tc)("click",(function(){Object(i.Nc)(e);const t=Object(i.xc)().index;return Object(i.xc)().clearStop(t)})),Object(i.hc)(1,"mat-icon",20),Object(i.lc)()}}function Cm(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"mat-option",23),Object(i.tc)("onSelectionChange",(function(){Object(i.Nc)(e);const o=t.$implicit,r=Object(i.xc)(2).index;return Object(i.xc)().chooseProposal(o,r)})),Object(i.ad)(1),Object(i.lc)()}if(2&e){const e=t.$implicit;Object(i.Dc)("value",e.meta?e.meta.title:"")("matTooltip",e.meta?e.meta.title:""),Object(i.Tb)(1),Object(i.cd)(" ",e.meta?e.meta.title:""," ")}}function Tm(e,t){if(1&e&&(Object(i.mc)(0,"mat-optgroup",21),Object(i.Yc)(1,Cm,2,3,"mat-option",22),Object(i.lc)()),2&e){const e=t.$implicit;Object(i.Dc)("label",e.source.title)("disabled",!1===e.source.enabled),Object(i.Tb)(1),Object(i.Dc)("ngForOf",e.results)}}function Lm(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",24),Object(i.tc)("click",(function(){Object(i.Nc)(e);const t=Object(i.xc)().index;return Object(i.xc)().removeStop(t)})),Object(i.yc)(1,"translate"),Object(i.hc)(2,"mat-icon",25),Object(i.lc)()}2&e&&Object(i.Dc)("matTooltip",Object(i.zc)(1,1,"igo.geo.directionsForm.removeStop"))}function Im(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"div",8,9),Object(i.mc)(2,"mat-list-item",10),Object(i.mc)(3,"div",11),Object(i.Yc)(4,Sm,3,3,"button",12),Object(i.mc)(5,"mat-form-field"),Object(i.mc)(6,"input",13),Object(i.tc)("focus",(function(){Object(i.Nc)(e);const o=t.index;return Object(i.xc)().focus(o)}))("keyup",(function(o){Object(i.Nc)(e);const r=t.index;return Object(i.xc)().keyup(r,o)}))("keydown.enter",(function(t){return Object(i.Nc)(e),Object(i.xc)().prevent(t)})),Object(i.yc)(7,"translate"),Object(i.lc)(),Object(i.Yc)(8,xm,2,0,"button",14),Object(i.mc)(9,"mat-autocomplete",null,15),Object(i.Yc)(11,Tm,2,3,"mat-optgroup",16),Object(i.lc)(),Object(i.lc)(),Object(i.Yc)(12,Lm,3,3,"button",6),Object(i.lc)(),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=t.$implicit,o=t.index,r=Object(i.Kc)(10),s=Object(i.xc)();Object(i.Tb)(2),Object(i.Dc)("formGroupName",o),Object(i.Tb)(2),Object(i.Dc)("ngIf",s.map.geolocationFeature),Object(i.Tb)(2),Object(i.Ec)("placeholder",Object(i.zc)(7,7,"igo.geo.directionsForm."+e.value.directionsText)),Object(i.Dc)("matAutocomplete",r),Object(i.Tb)(2),Object(i.Dc)("ngIf",e.value&&(e.value.stopPoint.length>0||e.value.stopProposals.length>0)),Object(i.Tb)(3),Object(i.Dc)("ngForOf",e.value.stopProposals),Object(i.Tb)(1),Object(i.Dc)("ngIf",0!==o&&o!==s.stops.length-1)}}function Fm(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",3),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.xc)().zoomRoute()})),Object(i.yc)(1,"translate"),Object(i.hc)(2,"mat-icon",26),Object(i.lc)()}2&e&&Object(i.Dc)("matTooltip",Object(i.zc)(1,1,"igo.geo.directionsForm.zoomRoute"))}function Mm(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",24),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.xc)().resetForm(!0)})),Object(i.yc)(1,"translate"),Object(i.hc)(2,"mat-icon",27),Object(i.lc)()}2&e&&Object(i.Dc)("matTooltip",Object(i.zc)(1,1,"igo.geo.directionsForm.resetDirectionsBtn"))}function km(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",3),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.xc)().copyDirectionsToClipboard()})),Object(i.yc)(1,"translate"),Object(i.hc)(2,"mat-icon",28),Object(i.lc)()}2&e&&Object(i.Dc)("matTooltip",Object(i.zc)(1,1,"igo.geo.directionsForm.copy"))}function Dm(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",3),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.xc)().copyLinkToClipboard()})),Object(i.yc)(1,"translate"),Object(i.hc)(2,"mat-icon",29),Object(i.lc)()}2&e&&Object(i.Dc)("matTooltip",Object(i.zc)(1,1,"igo.geo.directionsForm.link"))}function Pm(e,t){if(1&e&&(Object(i.mc)(0,"mat-option",36),Object(i.ad)(1),Object(i.lc)()),2&e){const e=t.$implicit,o=t.index,r=Object(i.xc)(3);Object(i.Dc)("value",e),Object(i.Tb)(1),Object(i.ed)(" Option ",o+1," : ",r.formatDistance(e.distance)," (",r.formatDuration(e.duration),") ")}}function Am(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"mat-form-field"),Object(i.mc)(1,"mat-select",34),Object(i.tc)("selectionChange",(function(){return Object(i.Nc)(e),Object(i.xc)(2).changeRoute()}))("ngModelChange",(function(t){return Object(i.Nc)(e),Object(i.xc)(2).activeRoute=t})),Object(i.yc)(2,"translate"),Object(i.Yc)(3,Pm,2,4,"mat-option",35),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=Object(i.xc)(2);Object(i.Tb)(1),Object(i.Ec)("placeholder",Object(i.zc)(2,3,"igo.geo.directionsForm.drivingOptions")),Object(i.Dc)("ngModel",e.activeRoute),Object(i.Tb)(2),Object(i.Dc)("ngForOf",e.routesResults)}}function $m(e,t){1&e&&Object(i.hc)(0,"mat-divider")}function Em(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"mat-list-item",37),Object(i.tc)("mouseenter",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)(2).showSegment(o)}))("click",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)(2).showSegment(o,!0)})),Object(i.hc)(1,"mat-icon",38),Object(i.mc)(2,"h4",39),Object(i.ad)(3),Object(i.lc)(),Object(i.mc)(4,"h4",40),Object(i.ad)(5),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=t.$implicit,o=t.index,r=Object(i.xc)(2);Object(i.Tb)(1),Object(i.Ec)("svgIcon",r.formatStep(e,o).image),Object(i.Dc)("ngClass",r.formatStep(e,o).cssClass),Object(i.Tb)(2),Object(i.dd)("",o+1,". ",r.formatStep(e,o).instruction,""),Object(i.Tb)(2),Object(i.bd)(r.formatDistance(e.distance))}}function Rm(e,t){if(1&e&&(Object(i.mc)(0,"div",11),Object(i.Yc)(1,Am,4,5,"mat-form-field",30),Object(i.Yc)(2,$m,1,0,"mat-divider",30),Object(i.mc)(3,"mat-list"),Object(i.mc)(4,"h2",31),Object(i.ad)(5),Object(i.lc)(),Object(i.mc)(6,"h2",32),Object(i.ad)(7),Object(i.lc)(),Object(i.Yc)(8,Em,6,5,"mat-list-item",33),Object(i.hc)(9,"mat-divider"),Object(i.lc)(),Object(i.lc)()),2&e){const e=Object(i.xc)();Object(i.Tb)(1),Object(i.Dc)("ngIf",e.routesResults&&e.routesResults.length>1),Object(i.Tb)(1),Object(i.Dc)("ngIf",e.routesResults&&0===e.routesResults.length),Object(i.Tb)(3),Object(i.bd)(e.activeRoute.title),Object(i.Tb)(2),Object(i.dd)("",e.formatDistance(e.activeRoute.distance),", ",e.formatDuration(e.activeRoute.duration),""),Object(i.Tb)(1),Object(i.Dc)("ngForOf",e.activeRoute.steps)}}let _m=(()=>{class e{constructor(e,t,o,r,s,a,n,c,l){this.formBuilder=e,this.directionsService=t,this.languageService=o,this.messageService=r,this.searchService=s,this.queryService=a,this.directionsFormService=n,this.changeDetectorRefs=c,this.route=l,this.invalidKeys=["Control","Shift","Alt"],this.projection="EPSG:4326",this.routesQueries$$=[],this.stream$=new k.a,this.activeRoute$=new C.a(void 0),this.focusOnStop=!1,this.focusKey=[],this.debounce=200,this.length=2,this.stopsStore$=new C.a(void 0),this.activeRouteDescription=new i.u}get activeRoute(){return this._activeRoute}set activeRoute(e){this._activeRoute=e,e&&this.activeRoute$.getValue()&&e.id!==this.activeRoute$.getValue().id&&this.activeRoute$.next(e),this.activeRouteDescription.emit(this.directionsToText())}get stopsStore(){return this._stopsStore}set stopsStore(e){this._stopsStore=e,this.stopsStore$.next(e)}get routeFromFeatureDetail(){return this._routeFromFeatureDetail}set routeFromFeatureDetail(e){this._routeFromFeatureDetail=e}changeRoute(){this.showRouteGeometry(!0)}prevent(e){e.preventDefault()}ngOnInit(){this.queryService.queryEnabled=!1,this.focusOnStop=!1,this.browserLanguage=this.languageService.getLanguage(),this.stopsForm=this.formBuilder.group({directionsType:"car",directionsMode:"driving",stopOrderPriority:!0,directionsFixedStartEnd:!1,stops:this.formBuilder.array([this.createStop("start"),this.createStop("end")])}),setTimeout(()=>{this.initStores(),this.initOlInteraction()},1),this.subscribeToFormChange(),this.routesQueries$$.push(this.stream$.pipe(Object(S.a)(this.debounce),Object(D.a)()).subscribe(e=>this.handleTermChanged(e))),this.stopsStore$.subscribe(()=>{!0===this.routeFromFeatureDetail&&(this.directionsFormService.setStops([]),setTimeout(()=>{this.resetForm(!1);for(const e of this.stopsStore.all())e.properties.id&&e.properties.id.toString().startsWith("directionsStop")&&this.stopsStore.delete(e);if(2===this.stopsStore.all().length){let e=0;const t=[];for(const i of this.stopsStore.all())t.push(i.geometry.coordinates),this.handleLocationProposals(i.geometry.coordinates,e),this.chooseProposal(i,e),e++;this.writeStopsToFormService(t);const o=this.directionsService.route(t,{});o&&o.map(e=>this.routesQueries$$.push(e.subscribe(e=>{this.routesResults=e,this.activeRoute=this.routesResults[0],this.showRouteGeometry(!0),this.changeDetectorRefs.detectChanges()})))}else 1===this.stopsStore.all().length&&(this.handleLocationProposals(this.stopsStore.all()[0].geometry.coordinates,1),this.chooseProposal(this.stopsStore.all()[0],1),this.writeStopsToFormService(this.stopsStore.all()[0].geometry.coordinates))},1),this.routeFromFeatureDetail=!1)})}ngOnDestroy(){this.unsubscribeRoutesQueries(),this.unlistenSingleClick(),this.queryService.queryEnabled=!0,this.freezeStores(),this.writeStopsToFormService()}initStores(){const e=new ll({motion:el.None}),t=this.stopsStore;sl(t,new Wc({title:this.languageService.translate.instant("igo.geo.directionsForm.stopLayer"),zIndex:911,source:new vc,showInLayerList:!0,workspace:{enabled:!1},exportable:!0,browsable:!1,style:zm})),pl(t,e);const o=this.routeStore;sl(o,new Wc({title:this.languageService.translate.instant("igo.geo.directionsForm.routeLayer"),zIndex:910,source:new vc,showInLayerList:!0,workspace:{enabled:!1},exportable:!0,browsable:!1,style:zm})),pl(o,e)}initOlInteraction(){let e;this.selectStop=new Ja.a({layers:[this.stopsStore.layer.ol],condition:En.k,hitTolerance:7,filter:e=>"stop"===e.get("type")}),this.selectStop.on("select",t=>{e=t.target.getFeatures()[0]}),this.translateStop=new Ja.b({layers:[this.stopsStore.layer.ol],features:e}),this.translateStop.on("translating",e=>{const t=e.features;0!==t.getLength()&&this.executeTranslation(t,!1,50,!0)}),this.translateStop.on("translateend",e=>{const t=e.features;0!==t.getLength()&&this.executeTranslation(t,!0,0,!1)}),this.selectedRoute=new Ja.a({layers:[this.routeStore.layer.ol],condition:En.e,hitTolerance:7,filter:e=>"route"===e.getId()}),this.selectedRoute.on("select",e=>{if(!1===this.focusOnStop){const t=Object(sa.s)(e.mapBrowserEvent.coordinate,this.map.projection,this.projection);this.addStop();const o=this.stops.length-2;this.stops.at(o).patchValue({stopCoordinates:t}),this.handleLocationProposals(t,o),this.addStopOverlay(t,o),this.selectedRoute.getFeatures().clear()}this.selectedRoute.getFeatures().clear()}),this.map.ol.addInteraction(this.selectStop),this.map.ol.addInteraction(this.translateStop),this.map.ol.addInteraction(this.selectedRoute)}subscribeToFormChange(){this.routesQueries$$.push(this.stopsForm.valueChanges.pipe(Object(S.a)(this.debounce)).subscribe(e=>{this.writeStopsToFormService()}))}freezeStores(){const e=this.stopsStore,t=this.routeStore;this.map.ol.removeInteraction(this.selectStop),this.map.ol.removeInteraction(this.translateStop),this.map.ol.removeInteraction(this.selectedRoute),e.deactivateStrategyOfType(ll),t.deactivateStrategyOfType(ll)}executeTranslation(e,t=!1,o=0,i=!1){this.routeStore.clear();const r=e.getArray()[0],s=r.getId().split("_");let a;switch(s[1]){case"start":a=0;break;case"end":a=this.stops.length-1;break;default:a=Number(s[1])}const n=Object(sa.s)(r.getGeometry().getCoordinates(),this.map.projection,this.projection);this.stops.at(a).patchValue({stopCoordinates:n,stopProposals:[]}),t&&this.handleLocationProposals(n,a);const c={steps:!0,overview:!1,alternatives:!0};i&&(c.overview=!0,c.steps=!1,c.alternatives=!1),o>0?(void 0!==this.lastTimeoutRequest&&clearTimeout(this.lastTimeoutRequest),this.lastTimeoutRequest=setTimeout(()=>{this.getRoutes(void 0,c)},o)):(clearTimeout(this.lastTimeoutRequest),this.getRoutes(void 0,c))}handleLocationProposals(e,t){const o=[],i=[e[0].toFixed(5),e[1].toFixed(5)];this.stops.at(t).patchValue({stopPoint:i.join(",")}),this.searchService.reverseSearch(e,{zoom:this.map.viewController.getZoom()}).map(e=>this.routesQueries$$.push(e.request.pipe(Object(j.a)(e=>e)).subscribe(e=>{if(e.forEach(t=>{0===o.filter(e=>e.source===t.source).length&&o.push({source:t.source,results:e.map(e=>e.data)})}),this.stops.at(t).patchValue({stopProposals:o}),e[0])if("icherchereverse"===e[0].source.getId()){let o=0;for(let t=0;t<e.length;t++)if("adresses"===e[t].data.properties.type){o=t;break}this.stops.at(t).patchValue({stopPoint:ot(e[o])}),"Point"===e[o].data.geometry.type&&this.stops.at(t).patchValue({stopCoordinates:e[o].data.geometry.coordinates})}else"coordinatesreverse"===e[0].source.getId()&&(this.stops.at(t).patchValue({stopPoint:[e[0].data.geometry.coordinates[0].toFixed(5),e[0].data.geometry.coordinates[1].toFixed(5)].join(",")}),"Point"===e[0].data.geometry.type&&this.stops.at(t).patchValue({stopCoordinates:e[0].data.geometry.coordinates}));else this.stops.at(t).patchValue({stopPoint:i.join(","),stopProposals:[]});this.changeDetectorRefs.detectChanges()})))}directionsText(e,t=this.stops.length){return 0===e?"start":e===t-1||1===t?"end":"intermediate"}raiseStop(e){e>0&&this.moveStop(e,-1)}lowerStop(e){e<this.stops.length-1&&this.moveStop(e,1)}moveStop(e,t){const o=this.stops.at(e);this.removeStop(e),this.stops.insert(e+t,o),this.stops.at(e).patchValue({directionsText:this.directionsText(e)}),this.stops.at(e+t).patchValue({directionsText:this.directionsText(e+t)}),this.stops.at(e).value.stopCoordinates&&this.addStopOverlay(this.stops.at(e).value.stopCoordinates,e),this.stops.at(e+t).value.stopCoordinates&&this.addStopOverlay(this.stops.at(e+t).value.stopCoordinates,e+t)}get stops(){return this.stopsForm.get("stops")}writeStopsToFormService(e){if(e)this.directionsFormService.setStops(e);else{const e=[];this.stops.value.forEach(t=>{t.stopCoordinates instanceof Array&&e.push(t)}),this.directionsFormService.setStops(e)}}addStop(){this.stops.insert(this.stops.length-1,this.createStop())}createStop(e="intermediate"){return this.formBuilder.group({stopPoint:[""],stopProposals:[[]],directionsText:e,stopCoordinates:["",[Ue.G.required]]})}removeStop(e){const t=this.getStopOverlayID(e);this.deleteStoreFeatureByID(this.stopsStore,t),this.stops.removeAt(e);let o=0;this.stops.value.forEach(e=>{this.stops.at(o).patchValue({directionsText:this.directionsText(o)}),this.addStopOverlay(this.stops.at(o).value.stopCoordinates,o),o++})}resetForm(e){this.routesResults=void 0;const t=this.stops.length;for(let o=0;o<t;o++)this.stops.removeAt(0);this.stops.insert(0,this.createStop("start")),this.stops.insert(1,this.createStop("end")),!0===e&&this.stopsStore.clear(),this.routeStore.clear()}formatStep(e,t){return this.formatInstruction(e.maneuver.type,e.maneuver.modifier,e.name,e.maneuver.bearing_after,t,e.maneuver.exit,t===this.activeRoute.steps.length-1)}formatInstruction(e,t,o,i,r,s,a=!1){let n,c,l="forward",u="rotate-270";const d=this.translateBearing(i),h=this.translateModifier(t);let p,m=("straight"===t?"":"\xe0 ")+h,g=("straight"===t?"":"on the ")+h;if(t&&t.search("slight")>=0&&(g=h),"uturn"===t?(l="forward",u="rotate-90"):"sharp right"===t||"right"===t?(l="subdirectory-arrow-right",u="icon-flipped"):"slight right"===t?(l="forward",u="rotate-290"):"straight"===t?l="forward":"slight left"===t?(l="forward",u="rotate-250"):("left"===t||"sharp left"===t)&&(l="subdirectory-arrow-left",u="icon-flipped"),"turn"===e)"straight"===t?(n="Continuer sur "+o,c="Continue on "+o):"uturn"===t?(n="Faire demi-tour sur "+o,c="Make u-turn on "+o):(n="Tourner "+m+" sur "+o,c="Turn "+h+" onto "+o);else if("new name"===e)n="Continuer en direction "+d+" sur "+o,c="Head "+d+" on "+o,l="compass",u="";else if("depart"===e)n="Aller en direction "+d+" sur "+o,c="Head "+d+" on "+o,l="compass",u="";else if("arrive"===e)if(a){let e=", ";h||(m="",g="",e=""),n="Vous \xeates arriv\xe9"+e+m,c="You have reached your destination"+e+g}else n="Vous atteignez le point interm\xe9diare sur "+o,c="You have reached the intermediate stop onto "+o,l="map-marker",u="";else"merge"===e?(n="Continuer sur "+o,c="Continue on "+o,l="forward",u="rotate-270"):"on ramp"===e?(n="Prendre l'entr\xe9e d'autoroute "+m,c="Take the ramp "+g):"off ramp"===e?(n="Prendre la sortie d'autoroute "+m,c="Take exit "+g):"fork"===e?t.search("left")>=0?(n="Garder la gauche sur "+o,c="Merge left onto "+o):t.search("right")>=0?(n="Garder la droite sur "+o,c="Merge right onto "+o):(n="Continuer sur "+o,c="Continue on "+o):"end of road"===e?(n="\xc0 la fin de la route, tourner "+h+" sur "+o,c="At the end of the road, turn "+h+" onto "+o):"use lane"===e?(n="Prendre la voie de ... ",c="Take the lane ..."):"continue"===e&&"uturn"!==t?(n="Continuer sur "+o,c="Continue on "+o,l="forward",u="rotate-270"):"roundabout"===e?(n="Au rond-point, prendre la "+s,n+=1===s?"re":"e",n+=" sortie vers "+o,c="At the roundabout, take the "+s,c+=1===s?"st":"rd",c+=" exit towards "+o,l="chart-donut",u=""):"rotary"===e?(n="Rond-point rotary....",c="Roundabout rotary....",l="chart-donut",u=""):"roundabout turn"===e?(n="Rond-point, prendre la ...",c="Roundabout, take the ...",l="chart-donut",u=""):"exit roundabout"===e?(n="Poursuivre vers "+o,c="Continue to "+o,l="forward",u="rotate-270"):"notification"===e?(n="notification ....",c="notification ...."):"uturn"===t?(n="Faire demi-tour et continuer en direction "+d+" sur "+o,c="Make u-turn and head "+d+" on "+o):(n="???",c="???");return a&&(l="flag-variant",u=""),0===r&&(l="compass",u=""),"fr"===this.browserLanguage?p=n:"en"===this.browserLanguage&&(p=c),{instruction:p,image:l,cssClass:u}}translateModifier(e){return"uturn"===e?this.languageService.translate.instant("igo.geo.directions.uturn"):"sharp right"===e?this.languageService.translate.instant("igo.geo.directions.sharp right"):"right"===e?this.languageService.translate.instant("igo.geo.directions.right"):"slight right"===e?this.languageService.translate.instant("igo.geo.directions.slight right"):"sharp left"===e?this.languageService.translate.instant("igo.geo.directions.sharp left"):"left"===e?this.languageService.translate.instant("igo.geo.directions.left"):"slight left"===e?this.languageService.translate.instant("igo.geo.directions.slight left"):"straight"===e?this.languageService.translate.instant("igo.geo.directions.straight"):e}translateBearing(e){return e>=337||e<23?this.languageService.translate.instant("igo.geo.cardinalPoints.n"):e<67?this.languageService.translate.instant("igo.geo.cardinalPoints.ne"):e<113?this.languageService.translate.instant("igo.geo.cardinalPoints.e"):e<157?this.languageService.translate.instant("igo.geo.cardinalPoints.se"):e<203?this.languageService.translate.instant("igo.geo.cardinalPoints.s"):e<247?this.languageService.translate.instant("igo.geo.cardinalPoints.sw"):e<293?this.languageService.translate.instant("igo.geo.cardinalPoints.w"):e<337?this.languageService.translate.instant("igo.geo.cardinalPoints.nw"):void 0}formatDistance(e){if(0!==e)return e>=1e5?Math.round(e/1e3)+" km":e>=1e4||e>=100?Math.round(e/100)/10+" km":e+" m"}formatDuration(e,t=!1){if(e>=3600){const t=Math.floor(e/3600),o=Math.round(60*(e/3600-t));return 60===o?t+1+" h":t+" h "+o+" min"}return e>=60?Math.round(e/60)+" min":e+" s"}showSegment(e,t=!1){this.showRouteSegmentGeometry(e.geometry.coordinates,t)}showRouteSegmentGeometry(e,t=!1){const o=new cn.b(e).transform("EPSG:4326",this.map.projection).getCoordinates(),i=new cn.e(o[0]),r=new Da.a({geometry:i}),s=(new sn.a).writeGeometryObject(i,{featureProjection:this.map.projection,dataProjection:this.map.projection}),a=this.routeStore.get("vertex");this.routeStore.update({type:Xc,geometry:s,projection:this.map.projection,properties:{id:"vertex",type:"vertex"},meta:{id:"vertex",revision:(a?a.meta.revision:0)+1},ol:r}),t&&this.map.viewController.zoomToExtent(r.getGeometry().getExtent())}zoomRoute(e){if(e)this.map.viewController.zoomToExtent(e);else if(this.routeStore.layer){const e=this.routeStore.layer.ol.getSource().getFeatures().find(e=>"route"===e.getId());if(e){const t=e.getGeometry().getExtent();this.map.viewController.zoomToExtent(t)}}}showRouteGeometry(e=!1){const t=new cn.b(this.activeRoute.geometry.coordinates).transform("EPSG:4326",this.map.projection);e&&this.zoomRoute(t.getExtent());const o=(new sn.a).writeGeometryObject(t,{featureProjection:this.map.projection,dataProjection:this.map.projection}),i=this.routeStore.get("route"),r={type:Xc,geometry:o,projection:this.map.projection,properties:{id:"route",type:"route"},meta:{id:"route",revision:(i?i.meta.revision:0)+1},ol:new Da.a({geometry:t})};this.routeStore.update(r)}getRoutes(e=!0,t={}){this.deleteStoreFeatureByID(this.routeStore,"vertex"),this.writeStopsToFormService();const o=this.directionsFormService.getStopsCoordinates();if(o.length<2)return;const i=this.directionsService.route(o,t);i&&i.map(t=>this.routesQueries$$.push(t.subscribe(t=>{this.routesResults=t,this.activeRoute=this.routesResults[0],this.showRouteGeometry(e),this.changeDetectorRefs.detectChanges()})))}unlistenSingleClick(){0!==this.focusKey.length&&this.focusKey.forEach(e=>{Object(Ga.b)(e)})}unsubscribeRoutesQueries(){this.routesQueries$$.forEach(e=>e.unsubscribe()),this.routesQueries$$=[]}copyLinkToClipboard(){if($.copy(this.getUrl())){const e=this.languageService.translate,t=e.instant("igo.geo.directionsForm.dialog.copyTitle"),o=e.instant("igo.geo.directionsForm.dialog.copyMsgLink");this.messageService.success(o,t)}}copyDirectionsToClipboard(){const e=this.directionsToText();if($.copy(e)){const e=this.languageService.translate,t=e.instant("igo.geo.directionsForm.dialog.copyTitle"),o=e.instant("igo.geo.directionsForm.dialog.copyMsg");this.messageService.success(o,t)}}directionsToText(){let e=this.languageService.translate.instant("igo.geo.directionsForm.instructions")+":\n",t="";const o=this.languageService.translate.instant("igo.geo.directionsForm.summary")+": \n\t"+this.activeRoute.title+"\n\t"+this.formatDistance(this.activeRoute.distance)+"\n\t"+this.formatDuration(this.activeRoute.duration)+"\n\n"+this.languageService.translate.instant("igo.geo.directionsForm.stopsList")+":\n",i=this.languageService.translate.instant("igo.geo.directionsForm.link")+":\n\t"+this.getUrl();let r=1;this.stops.value.forEach(e=>{let o="",i="";e.stopPoint!==e.stopCoordinates?(i=e.stopPoint,o=" ("+[e.stopCoordinates[1],e.stopCoordinates[0]].join(",")+")"):i=[e.stopCoordinates[1],e.stopCoordinates[0]].join(","),t=t+"\t"+r.toLocaleString()+". "+i+o+"\n",r++});let s=0;return this.activeRoute.steps.forEach(t=>{const o=this.formatStep(t,s).instruction,i=void 0===this.formatDistance(t.distance)?"":" ("+this.formatDistance(t.distance)+")";e=e+"\t"+(s+1).toLocaleString()+". "+o+i+"\n",s++}),o+t+"\n"+i+"\n\n"+e}handleTermChanged(e){if(void 0!==e||0!==e.length){const t=[];this.search$$&&this.search$$.unsubscribe(),this.searchService.search(e,{searchType:"Feature"}).map(e=>this.search$$=e.request.subscribe(e=>{e.filter(e=>e.data.geometry).forEach(o=>{0===t.filter(e=>e.source===o.source).length&&t.push({source:o.source,meta:o.meta,results:e.map(e=>e.data)})}),this.stops&&this.stops.at(this.currentStopIndex).patchValue({stopProposals:t}),this.changeDetectorRefs.detectChanges()}))}}setTerm(e){this.term=e,this.keyIsValid(e)&&(e.length>=this.length||0===e.length)&&this.stream$.next(e)}keyIsValid(e){return void 0===this.invalidKeys.find(t=>t===e)}keyup(e,t){this.setTerm(t.target.value),this.map.ol.un("singleclick",t=>{this.handleMapClick(t,e)})}clearStop(e){const t=this.getStopOverlayID(e);this.deleteStoreFeatureByID(this.stopsStore,t),this.routeStore.clear();const o=this.stops.length;this.stops.removeAt(e),this.stops.insert(e,this.createStop(this.directionsText(e,o))),this.routesResults=void 0,this.getRoutes(!1)}chooseProposal(e,t){if(void 0!==e){let o;const i=e.geometry;if("Point"===i.type)o=i.coordinates;else if(i.type.search("Line")>=0)o=(new sn.a).readFeatures(i)[0].getGeometry().getFirstCoordinate(),o=[o[0],o[1]];else if(i.type.search("Polygon")>=0){const e=(new sn.a).readFeatures(i);o=o="Polygon"===e[0].getGeometry().getType()?e[0].getGeometry().getInteriorPoint().getFirstCoordinate():e[0].getGeometry().getInteriorPoints().getFirstCoordinate(),o=[o[0],o[1]]}void 0!==o&&(this.stops.at(t).patchValue({stopCoordinates:o}),this.addStopOverlay(o,t))}}focus(e){this.unlistenSingleClick(),this.currentStopIndex=e,this.focusOnStop=!0,this.focusKey.push(this.map.ol.once("singleclick",t=>{this.handleMapClick(t,e)}))}handleMapClick(e,t){void 0===this.currentStopIndex?(this.addStop(),this.stops.at(t=this.stops.length-2).value.stopProposals=[]):t=this.currentStopIndex;const o=Object(sa.s)(e.coordinate,this.map.projection,this.projection);this.stops.at(t).patchValue({stopProposals:[],stopCoordinates:o}),this.handleLocationProposals(o,t),this.addStopOverlay(o,t),setTimeout(()=>{this.focusOnStop=!1},500)}geolocateStop(e){rl(this.map,[this.map.geolocationFeature],el.Move);const t=this.map.viewController.getCenter(this.projection);this.stops.at(e).patchValue({stopCoordinates:t}),this.addStopOverlay(t,e),this.handleLocationProposals(t,e)}addStopOverlay(e,t){const o=this.directionsText(t);let i,r;"start"===o?(i="#008000",r=this.languageService.translate.instant("igo.geo.directionsForm.start")):"end"===o?(i="#f64139",r=this.languageService.translate.instant("igo.geo.directionsForm.end")):(i="#ffd700",r=this.languageService.translate.instant("igo.geo.directionsForm.intermediate")+" #"+t);const s=new cn.e(Object(sa.s)(e,this.projection,this.map.projection)),a=this.getStopOverlayID(t),n=(new sn.a).writeGeometryObject(s,{featureProjection:this.map.projection,dataProjection:this.map.projection}),c=this.stopsStore.get(a),l={type:Xc,geometry:n,projection:this.map.projection,properties:{id:a,type:"stop",stopText:r,stopColor:i,stopOpacity:1},meta:{id:a,revision:(c?c.meta.revision:0)+1},ol:new Da.a({geometry:s})};this.stopsStore.update(l),this.getRoutes()}getStopOverlayID(e){let t;return t=0===e?"start":e===this.stops.length-1?"end":e,"directionsStop_"+t}deleteStoreFeatureByID(e,t){const o=e.get(t);o&&e.delete(o)}getUrl(){if(!this.route)return;const e=this.route.options.directionsCoordKey,t=[];this.directionsFormService&&this.directionsFormService.getStopsCoordinates()&&0!==this.directionsFormService.getStopsCoordinates().length&&this.directionsFormService.getStopsCoordinates().forEach(e=>{t.push(Bn(e,6))});let o="";return t.length>=2&&(o=`${e}=${t.join(";")}`),`${location.origin}${location.pathname}?tool=directions&sidenav=1&${o}`}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(Ue.g),Object(i.gc)(jm),Object(i.gc)(le),Object(i.gc)(ce),Object(i.gc)(bm),Object(i.gc)(Gl),Object(i.gc)(wm),Object(i.gc)(i.j),Object(i.gc)(pe,8))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-directions-form"]],inputs:{term:"term",debounce:"debounce",length:"length",map:"map",stopsStore:"stopsStore",routeFromFeatureDetail:"routeFromFeatureDetail",routeStore:"routeStore"},outputs:{activeRouteDescription:"activeRouteDescription"},decls:11,vars:10,consts:[[1,"igo-form",3,"formGroup"],["formArrayName","stops",4,"ngFor","ngForOf"],[1,"igo-form-button-group"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","primary",3,"matTooltip","click"],["svgIcon","map-marker-plus"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","primary",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip","click",4,"ngIf"],["class","igo-input-container",4,"ngIf"],["formArrayName","stops"],["inputs",""],[3,"formGroupName"],[1,"igo-input-container"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","click",4,"ngIf"],["matInput","","formControlName","stopPoint",3,"matAutocomplete","placeholder","focus","keyup","keydown.enter"],["mat-button","","matSuffix","","mat-icon-button","","color","warn","aria-label","Clear",3,"click",4,"ngIf"],["auto","matAutocomplete"],[3,"label","disabled",4,"ngFor","ngForOf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","click"],["svgIcon","crosshairs-gps"],["mat-button","","matSuffix","","mat-icon-button","","color","warn","aria-label","Clear",3,"click"],["svgIcon","close"],[3,"label","disabled"],["matTooltipShowDelay","500",3,"value","matTooltip","onSelectionChange",4,"ngFor","ngForOf"],["matTooltipShowDelay","500",3,"value","matTooltip","onSelectionChange"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip","click"],["svgIcon","delete"],["svgIcon","magnify-plus-outline"],["svgIcon","file-restore"],["svgIcon","content-copy"],["svgIcon","link"],[4,"ngIf"],["mat-header","",1,"igo-route-title","mat-typography"],["mat-subheader",""],["class","igo-steps","igoListItem","",3,"mouseenter","click",4,"ngFor","ngForOf"],[3,"placeholder","ngModel","selectionChange","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["igoListItem","",1,"igo-steps",3,"mouseenter","click"],["mat-list-icon","",3,"ngClass","svgIcon"],["mat-line",""],["mat-line","",1,"right"]],template:function(e,t){1&e&&(Object(i.mc)(0,"form",0),Object(i.Yc)(1,Im,13,9,"div",1),Object(i.mc)(2,"div",2),Object(i.mc)(3,"button",3),Object(i.tc)("click",(function(){return t.addStop()})),Object(i.yc)(4,"translate"),Object(i.hc)(5,"mat-icon",4),Object(i.lc)(),Object(i.Yc)(6,Fm,3,3,"button",5),Object(i.Yc)(7,Mm,3,3,"button",6),Object(i.Yc)(8,km,3,3,"button",5),Object(i.Yc)(9,Dm,3,3,"button",5),Object(i.lc)(),Object(i.lc)(),Object(i.Yc)(10,Rm,10,6,"div",7)),2&e&&(Object(i.Dc)("formGroup",t.stopsForm),Object(i.Tb)(1),Object(i.Dc)("ngForOf",t.stops.controls),Object(i.Tb)(2),Object(i.Dc)("matTooltip",Object(i.zc)(4,8,"igo.geo.directionsForm.addStop")),Object(i.Tb)(3),Object(i.Dc)("ngIf",t.routesResults),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.routesResults),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.routesResults),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.routesResults),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.routesResults))},directives:[Ue.I,Ue.t,Ue.k,m.s,n.b,h.a,c.a,m.t,Ue.f,l.d,Ue.l,ke.c,Ve.b,Ue.d,mn.d,Ue.s,Ue.j,mn.a,ke.j,Pe.o,Pe.p,l.a,l.g,dn.a,De.a,Ue.v,l.c,m.q,Pe.l],pipes:[q.e],styles:["mat-form-field[_ngcontent-%COMP%]{width:85%}.igo-route-title[_ngcontent-%COMP%]{font-weight:700}.igo-steps[_ngcontent-%COMP%]{cursor:pointer}form[_ngcontent-%COMP%]{padding:10px}h3[_ngcontent-%COMP%]{padding-left:5px;padding-right:5px}.mat-line[_ngcontent-%COMP%]{white-space:pre-wrap!important;word-wrap:break-word!important}.mat-line.right[_ngcontent-%COMP%]{text-align:right}.rotate-90[_ngcontent-%COMP%]{transform:rotate(90deg)}.rotate-45[_ngcontent-%COMP%]{transform:rotate(45deg)}.rotate-270[_ngcontent-%COMP%]{transform:rotate(270deg)}.rotate-250[_ngcontent-%COMP%]{transform:rotate(250deg)}.rotate-290[_ngcontent-%COMP%]{transform:rotate(290deg)}.icon-flipped[_ngcontent-%COMP%]{transform:scaleY(-1)}"]}),e})();function zm(e,t){const o=[new Ra.Style({geometry:e.getGeometry(),image:new Ra.Circle({radius:7,stroke:new Ra.Stroke({color:"#FF0000",width:3})})})],i=Zc({text:e.get("stopText"),opacity:e.get("stopOpacity"),markerColor:e.get("stopColor"),markerOutlineColor:[255,255,255]}),r=[new Ra.Style({stroke:new Ra.Stroke({color:"#6a7982",width:10,opacity:.75})}),new Ra.Style({stroke:new Ra.Stroke({color:"#4fa9dd",width:6,opacity:.75})})];return"stop"===e.get("type")?i:"vertex"===e.get("type")?o:"route"===e.get("type")?r:void 0}let Nm=(()=>{class e{static forRoot(){return{ngModule:e}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},providers:[wm,vm()],imports:[[m.c,Ue.m,Ue.C,c.b,n.c,l.e,dn.b,ke.e,Ve.c,Pe.q,De.b,h.b,mn.b,ie]]}),e})();function Bm(e){return new um(e)}let qm=(()=>{class e{constructor(e){this.languageService=e}formatResult(e){return e}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(le))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac}),e})();class Gm{encodeKey(e){return encodeURIComponent(e)}encodeValue(e){return encodeURIComponent(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}let Vm=(()=>{class e extends Yl{constructor(e,t,o,i,r,s){super(i,o),this.http=e,this.languageService=t,this.formatter=r,this.title$=new C.a(""),this.hashtagsLieuxToKeep=[],this.languageService.translate.get(this.options.title).subscribe(e=>this.title$.next(e));const a=s.get(xs);this.settings.length&&(a?a.authenticate$.subscribe(()=>{this.getAllowedTypes()}):this.getAllowedTypes())}get title(){return this.title$.getValue()}getId(){return e.id}getType(){return e.type}getDefaultOptions(){var e;const t=this.options.params&&this.options.params.limit?Number(this.options.params.limit):void 0,o=this.options.params&&this.options.params.ecmax?Number(this.options.params.ecmax):void 0,i=(null===(e=this.options.params)||void 0===e?void 0:e.type)?this.options.params.type.replace(/\s/g,"").toLowerCase().split(","):["adresses","codes-postaux","routes","intersections","municipalites","mrc","regadmin","lieux"];return{title:"igo.geo.search.icherche.name",searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/icherche",settings:[{type:"checkbox",title:"results type",name:"type",values:[{title:"igo.geo.search.icherche.type.address",value:"adresses",enabled:-1!==i.indexOf("adresses"),hashtags:["adresse"]},{title:"igo.geo.search.icherche.type.oldAddress",value:"anciennes-adresses",enabled:-1!==i.indexOf("anciennes-adresses"),hashtags:["anciennes-adresses"]},{title:"igo.geo.search.icherche.type.postalCode",value:"codes-postaux",enabled:-1!==i.indexOf("codes-postaux"),hashtags:["code-postal"]},{title:"igo.geo.search.icherche.type.road",value:"routes",enabled:-1!==i.indexOf("routes"),hashtags:["route"]},{title:"igo.geo.search.icherche.type.intersection",value:"intersections",enabled:-1!==i.indexOf("intersections"),hashtags:["intersection","+"]},{title:"igo.geo.search.icherche.type.city",value:"municipalites",enabled:-1!==i.indexOf("municipalites"),hashtags:["municipalit\xe9","mun"]},{title:"igo.geo.search.icherche.type.oldCity",value:"anciennes-municipalites",enabled:-1!==i.indexOf("anciennes-municipalites"),hashtags:["anciennes-municipalites"]},{title:"igo.geo.search.icherche.type.mrc",value:"mrc",enabled:-1!==i.indexOf("mrc"),hashtags:["mrc"]},{title:"igo.geo.search.icherche.type.regadmin",value:"regadmin",enabled:-1!==i.indexOf("regadmin"),hashtags:["r\xe9gion-administrative","regadmin"]},{title:"igo.geo.search.icherche.type.entreprise",value:"entreprises",enabled:-1!==i.indexOf("entreprises"),available:!1,hashtags:["entreprise"]},{title:"igo.geo.search.icherche.type.place",value:"lieux",enabled:-1!==i.indexOf("lieux"),hashtags:["lieu"]},{title:"igo.geo.search.icherche.type.exit",value:"sorties-autoroute",enabled:-1!==i.indexOf("sorties-autoroute"),hashtags:["sortie","sorties","exit"]},{title:"igo.geo.search.icherche.type.km",value:"bornes-km",enabled:-1!==i.indexOf("bornes-km"),hashtags:["borne","bornes","rep\xe8re","km"]},{title:"igo.geo.search.icherche.type.gcc",value:"bornes-gcc",enabled:-1!==i.indexOf("bornes-gcc"),hashtags:["borne","bornes","rep\xe8re","gcc","ccg"]},{title:"igo.geo.search.icherche.type.cn",value:"bornes-cn",enabled:-1!==i.indexOf("bornes-cn"),hashtags:["borne","bornes","cn"]},{title:"igo.geo.search.icherche.type.sumi",value:"bornes-sumi",enabled:-1!==i.indexOf("bornes-sumi"),hashtags:["borne","bornes","sumi"]},{title:"igo.geo.search.icherche.type.cadastre",value:"cadastre",enabled:-1!==i.indexOf("cadastre"),hashtags:["cadastre"]}]},{type:"radiobutton",title:"results limit",name:"limit",values:[{title:"1",value:1,enabled:1===t},{title:"5",value:5,enabled:5===t||!t},{title:"10",value:10,enabled:10===t},{title:"25",value:25,enabled:25===t},{title:"50",value:50,enabled:50===t}]},{type:"radiobutton",title:"ecmax",name:"ecmax",values:[{title:"10 %",value:10,enabled:10===o},{title:"30 %",value:30,enabled:30===o||!o},{title:"50 %",value:50,enabled:50===o},{title:"75 %",value:75,enabled:75===o},{title:"100 %",value:100,enabled:100===o}]},{type:"radiobutton",title:"restrictExtent",name:"loc",values:[{title:"igo.geo.search.icherche.restrictExtent.map",value:"true",enabled:!1},{title:"igo.geo.search.icherche.restrictExtent.quebec",value:"false",enabled:!0}]}]}}search(e,t){const o=this.computeRequestParams(e,t||{});return o.get("type").length?(this.options.params.page=o.get("page")||"1",this.http.get(this.searchUrl+"/geocode",{params:o}).pipe(Object(j.a)(t=>this.extractResults(t,e)),Object(v.a)(e=>{throw e.error.toDisplay=!0,e.error.title=this.languageService.translate.instant(this.getDefaultOptions().title),e}))):Object(L.a)([])}getAllowedTypes(){return this.http.get(this.searchUrl+"/types").subscribe(e=>{this.settings.find(e=>"type"===e.name).values.forEach(t=>{const o=new RegExp(`^${t.value}(\\.|$)`),i=e.filter(e=>o.test(e));t.available=i.length>0,"lieux"===t.value&&(this.hashtagsLieuxToKeep=[...new Set(i.map(e=>e.split(".")).reduce((e,t)=>e.concat(t)).filter(e=>"lieux"!==e))])})})}computeRequestParams(e,t){const o=Object.assign({geometry:!0,bbox:!0,icon:!0,type:"adresses,codes-postaux,municipalites,mrc,regadmin,lieux,entreprises,bornes-sumi"},this.params,this.computeOptionsParam(e,t||{}).params,{q:this.computeTerm(e),page:t.page});if("true"===o.loc){const[e,i,r,s]=t.extent;o.loc=`${e},${i};${r},${i};${r},${s};${e},${s};${e},${i}`}else"false"===o.loc&&delete o.loc;return-1!==o.q.indexOf("#")&&(o.type="lieux"),new y.g({fromObject:E.removeUndefined(o),encoder:new Gm})}extractResults(e,t){return e.features.map(o=>this.formatter.formatResult(this.dataToResult(o,t,e)))}dataToResult(e,t,o){const i=this.computeProperties(e),r=[this.getId(),i.type,i.code].join(".");return{source:this,data:{type:Xc,projection:"EPSG:4326",geometry:e.geometry,extent:e.bbox,properties:i,meta:{id:r,title:e.properties.nom}},meta:{dataType:Xc,id:r,title:e.properties.nom,titleHtml:(e.highlight.title||e.properties.nom)+(e.highlight.title2?" <small> "+e.highlight.title2+"</small>":"")+(e.highlight.title3?"<br><small> "+e.highlight.title3+"</small>":""),icon:e.icon||"map-marker",score:e.score||gm(t.trim(),e.properties.nom),nextPage:o.features.length%+this.options.params.limit==0&&+this.options.params.page<10}}}computeProperties(t){const o=E.removeKeys(t.properties,e.propertiesBlacklist);if(!t.geometry)return Object.assign({type:t.index},o);const i={GoogleMaps:""};let r,s;if("Point"===t.geometry.type)r=Kl.getGoogleMapsCoordLink(t.geometry.coordinates[0],t.geometry.coordinates[1]);else{const e=Object(jn.a)(t.geometry);r=Kl.getGoogleMapsCoordLink(e.geometry.coordinates[0],e.geometry.coordinates[1])}s=Kl.getGoogleMapsNameLink("routes"===t.index?t.properties.nom+", "+t.properties.municipalite:"municipalites"===t.index?t.properties.nom+", ville":"mrc"===t.index?"mrc+"+t.properties.nom:"regadmin"===t.index?t.properties.nom+",+QC":t.properties.nom||t.highlight.title),i.GoogleMaps="<a href="+r+' target="_blank">'+this.languageService.translate.instant("igo.geo.searchByCoord")+"</a> <br /> <a href="+s+' target="_blank">'+this.languageService.translate.instant("igo.geo.searchByName")+"</a>","Point"===t.geometry.type&&(i.GoogleStreetView=Kl.getGoogleStreetViewLink(t.geometry.coordinates[0],t.geometry.coordinates[1]));const a={Route:'<span class="routing"> <u>'+this.languageService.translate.instant("igo.geo.seeRouting")+"</u> </span>"};return Object.assign({type:t.index},o,i,a)}computeTerm(e){let t=!1;return t=(e.match(/(#[^\s]+)/g)||[]).some(e=>{const t=e.substring(1);return this.hashtagsLieuxToKeep.some(e=>e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")===t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""))}),t||(e=e.replace(/(#[^\s]*)/g,"")),e.replace(/[^\w\xc0-\xff !\-\+\(\)\.\/\xbd\xbc\xbe,'#]+/g,"")}computeOptionsParam(e,t){const o=super.getHashtagsValid(e,"type");return o&&(t.params=Object.assign(t.params||{},{type:o.join(",")})),t}}return e.id="icherche",e.type=Xc,e.propertiesBlacklist=[],e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(y.b),Object(i.qc)(le),Object(i.qc)(Oe),Object(i.qc)("options"),Object(i.qc)(qm),Object(i.qc)(i.C))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac}),e})(),Um=(()=>{class e extends Yl{constructor(e,t,o,i,r){super(i,o),this.http=e,this.languageService=t,this.title$=new C.a(""),this.languageService.translate.get(this.options.title).subscribe(e=>this.title$.next(e));const s=r.get(xs);this.settings.length&&(s?s.authenticate$.subscribe(()=>{this.getAllowedTypes()}):this.getAllowedTypes())}get title(){return this.title$.getValue()}getId(){return e.id}getType(){return e.type}getDefaultOptions(){const e=this.options.params&&this.options.params.type?this.options.params.type.replace(/\s/g,"").toLowerCase().split(","):["adresses","municipalites","mrc","regadmin"];return{title:"igo.geo.search.ichercheReverse.name",searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/terrapi",settings:[{type:"checkbox",title:"results type",name:"type",values:[{title:"igo.geo.search.icherche.type.address",value:"adresses",enabled:-1!==e.indexOf("adresses")},{title:"igo.geo.search.icherche.type.road",value:"routes",enabled:-1!==e.indexOf("routes"),available:!1},{title:"igo.geo.search.icherche.type.district",value:"arrondissements",enabled:-1!==e.indexOf("arrondissements")},{title:"igo.geo.search.icherche.type.city",value:"municipalites",enabled:-1!==e.indexOf("municipalites")},{title:"igo.geo.search.icherche.type.mrc",value:"mrc",enabled:-1!==e.indexOf("mrc")},{title:"igo.geo.search.icherche.type.regadmin",value:"regadmin",enabled:-1!==e.indexOf("regadmin")}]},{type:"radiobutton",title:"radius",name:"bufferInput",values:[{title:"100 m",value:100,enabled:!this.options.distance||100===this.options.distance},{title:"500 m",value:500,enabled:500===this.options.distance},{title:"1 km",value:1e3,enabled:1e3===this.options.distance},{title:"2 km",value:2e3,enabled:2e3===this.options.distance},{title:"5 km",value:5e3,enabled:5e3===this.options.distance}]}]}}reverseSearch(e,t){const o=this.computeRequestParams(e,t||{});return o.get("type").length?this.http.get(this.searchUrl+"/locate",{params:o}).pipe(Object(j.a)(e=>this.extractResults(e))):Object(L.a)([])}getAllowedTypes(){return this.http.get(this.searchUrl+"/types").subscribe(e=>{this.settings.find(e=>"type"===e.name).values.forEach(t=>{t.available=e.indexOf(t.value)>-1})})}computeRequestParams(e,t){return(t.distance||this.options.distance)&&(t.params=Object.assign(t.params||{},{bufferInput:t.distance||this.options.distance})),new y.g({fromObject:Object.assign({loc:e.join(","),sort:"distance",geometry:!0,icon:!0},t.params||{},this.params)})}extractResults(e){return e.features.map(e=>this.dataToResult(e))}getSubtitle(e){if(!this.settings.length)return"";let t="";switch(e.properties.type){case"arrondissements":t=e.properties.municipalite+" (Arrondissement)";break;default:const o=this.settings.find(e=>"type"===e.name).values.find(t=>t.value===e.properties.type);o&&(t=this.languageService.translate.instant(o.title))}return t}dataToResult(e){const t=this.computeProperties(e),o=this.computeExtent(e),i=[this.getId(),t.type,t.code].join("."),r=e.properties.nom,s=" <small> "+this.getSubtitle(e)+"</small>";return{source:this,data:{type:Xc,projection:"EPSG:4326",geometry:e.geometry,extent:o,properties:t,meta:{id:i,title:e.properties.nom}},meta:{dataType:Xc,id:i,title:e.properties.nom,titleHtml:r+s,icon:e.icon||"map-marker"}}}computeProperties(t){const o=E.removeKeys(t.properties,e.propertiesBlacklist),i={Route:'<span class="routing"> <u>'+this.languageService.translate.instant("igo.geo.seeRouting")+"</u> </span>"};return Object.assign(o,i)}computeExtent(e){return e.bbox?[e.bbox[0],e.bbox[2],e.bbox[1],e.bbox[3]]:void 0}}return e.id="icherchereverse",e.type=Xc,e.propertiesBlacklist=[],e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(y.b),Object(i.qc)(le),Object(i.qc)(Oe),Object(i.qc)("options"),Object(i.qc)(i.C))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac}),e})();function Hm(e){return new qm(e)}function Ym(e,t,o,i,r,s){return new Vm(e,t,o,i.getConfig("searchSources."+Vm.id),r,s)}function Wm(e,t,o,i,r){return new Um(e,t,o,i.getConfig("searchSources."+Um.id),r)}let Km=(()=>{class e{constructor(e){this.languageService=e}formatResult(e){return e}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(le))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac}),e})(),Zm=(()=>{class e extends Yl{constructor(e,t,o,i){super(e,o),this.languageService=t,this.title$=new C.a(""),this.projections=i,this.languageService.translate.get(this.options.title).subscribe(e=>this.title$.next(e))}get title(){return this.title$.getValue()}getId(){return e.id}getType(){return e.type}getDefaultOptions(){return{title:"igo.geo.search.coordinates.name",order:1,showInSettings:!1}}reverseSearch(e,t){return Object(L.a)([this.dataToResult(e,t)])}dataToResult(e,t){const o=function(e,t){const o=Object(sa.s)(e,"EPSG:4326","EPSG:3857"),i=[{code:"EPSG:3857",alias:"Web mercator",coord:o,igo2CoordFormat:Bn(o).join(", ")+" ; 3857"}],r=function(e){return Math.ceil((e[0]+180)/6)}(e),s=r<10?"EPSG:3260"+r:"EPSG:326"+r,a="UTM-"+r,n=Object(sa.s)(e,"EPSG:4326",s);i.push({code:s,alias:"UTM",coord:n,igo2CoordFormat:`${a} ${Bn(n).join(", ")}`});const c=function(e){const t=e[0];let o;return t<-51&&t>-54&&(o=1),t<-54&&t>-57&&(o=2),t<-57&&t>-60&&(o=3),t<-60&&t>-63&&(o=4),t<-63&&t>-66&&(o=5),t<-66&&t>-69&&(o=6),t<-69&&t>-72&&(o=7),t<-72&&t>-75&&(o=8),t<-75&&t>-78&&(o=9),t<-78&&t>-81&&(o=10),o}(e);if(c){const t=c<10?"EPSG:3218"+c:"EPSG:321"+(80+c),o="MTM-"+c,r=Object(sa.s)(e,"EPSG:4326",t);i.push({code:t,alias:"MTM",coord:r,igo2CoordFormat:`${o} ${Bn(r).join(", ")}`})}return t.forEach(t=>{const o=Object(sa.s)(e,"EPSG:4326",t.code),r=t.code.split(":")[1];i.push({code:t.code,alias:t.alias||t.code,coord:o,igo2CoordFormat:`${Bn(o).join(", ")} ; ${r}`})}),i}(e,this.projections).reduce((e,t)=>(e[t.alias]=t.igo2CoordFormat,e),{}),i=Bn(e,6).join(", ");let r={type:"Point",coordinates:[e[0],e[1]]};const s={};let a="";if(t.distance){s[this.languageService.translate.instant("igo.geo.search.coordinates.radius")]=t.distance,a="<br><small>Rayon: "+t.distance+" m</small>";const o=Object(sa.s)([e[0],e[1]],"EPSG:4326","EPSG:3857"),i=new Xa.a(o,t.distance),n=Object(tn.c)(i),c=new ha.GeoJSON;r=JSON.parse(c.writeGeometry(n.transform("EPSG:3857","EPSG:4326")))}return t.conf&&(s[this.languageService.translate.instant("igo.geo.search.coordinates.conf")]=t.conf,a+=""===a?"<br>":"<small> - </small>",a+="<small>Confiance: "+t.conf+"%</small>"),s[this.languageService.translate.instant("igo.geo.search.coordinates.coord")]=i,{source:this,data:{type:Xc,projection:"EPSG:4326",geometry:r,extent:void 0,properties:Object.assign(s,o,{GoogleMaps:Kl.getGoogleMapsCoordLink(e[0],e[1]),GoogleStreetView:Kl.getGoogleStreetViewLink(e[0],e[1]),OpenStreetMap:Zl.getOpenStreetMapLink(e[0],e[1],14),Route:'<span class="routing"> <u>'+this.languageService.translate.instant("igo.geo.seeRouting")+"</u> </span>"}),meta:{id:e[0].toString()+","+e[1].toString(),title:i}},meta:{dataType:Xc,id:e[0].toString()+","+e[1].toString(),title:i,titleHtml:i+a,icon:"map-marker",score:100}}}}return e.id="coordinatesreverse",e.type=Xc,e.\u0275fac=function(t){return new(t||e)(Object(i.qc)("options"),Object(i.qc)(le),Object(i.qc)(Oe),Object(i.qc)("projections"))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac}),e})();function Qm(e){return new Km(e)}function Jm(e,t,o,i){return new Zm(e.getConfig("searchSources."+Zm.id),t,o,e.getConfig("projections")||[])}let Xm=(()=>{class e{constructor(e){this.languageService=e}formatResult(e){const t=["title","abstract","groupTitle","metadataUrl","downloadUrl","urlInfo","name"],o=Object.entries(e.properties).filter(([e])=>-1!==t.indexOf(e)).reduce((e,t)=>{const[o,i]=t;let r;try{r=this.languageService.translate.instant("igo.geo.search.ilayer.properties."+o)}catch(s){r=o}return e[r]=i||"",e},{}),i=Object.assign({},e);return i.properties=o,i}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(le))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac}),e})(),eg=(()=>{class e extends Yl{constructor(e,t,o,i,r){super(i,o),this.http=e,this.languageService=t,this.formatter=r,this.title$=new C.a(""),this.languageService.translate.get(this.options.title).subscribe(e=>this.title$.next(e))}get title(){return this.title$.getValue()}getId(){return e.id}getType(){return e.type}getDefaultOptions(){const e=this.options.params&&this.options.params.limit?Number(this.options.params.limit):void 0,t=this.options.params&&this.options.params.ecmax?Number(this.options.params.ecmax):void 0;return{title:"igo.geo.search.ilayer.name",searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/layers/search",settings:[{type:"checkbox",title:"results type",name:"type",values:[{title:"igo.geo.search.ilayer.type.layer",value:"layer",enabled:!0,hashtags:["layer","layers","couche","couches"]},{title:"igo.geo.search.ilayer.type.groupLayer",value:"group",enabled:!1,hashtags:["gr-layer","gr-layers","gr-couche","gr-couches"]}]},{type:"radiobutton",title:"results limit",name:"limit",values:[{title:"1",value:1,enabled:1===e},{title:"5",value:5,enabled:5===e||!e},{title:"10",value:10,enabled:10===e},{title:"25",value:25,enabled:25===e},{title:"50",value:50,enabled:50===e}]},{type:"radiobutton",title:"ecmax",name:"ecmax",values:[{title:"10 %",value:10,enabled:10===t},{title:"30 %",value:30,enabled:30===t},{title:"50 %",value:50,enabled:50===t||!t},{title:"75 %",value:75,enabled:75===t},{title:"100 %",value:100,enabled:100===t}]}]}}search(e,t){const o=this.computeSearchRequestParams(e,t||{});return o.get("q")&&o.get("type")?(this.options.params.page=o.get("page")||"1",this.http.get(this.searchUrl,{params:o}).pipe(Object(j.a)(t=>this.extractResults(t,e)))):Object(L.a)([])}computeSearchRequestParams(e,t){return new y.g({fromObject:E.removeUndefined(Object.assign({q:this.computeTerm(e)},this.params,this.computeOptionsParam(e,t||{}).params,{page:t.page}))})}computeTerm(e){return e.replace(/(#[^\s]*)/g,"").replace(/[^\w\xc0-\xff !\-\(\),'#]+/g,"")}computeOptionsParam(e,t){const o=super.getHashtagsValid(e,"type");return o&&(t.params=Object.assign(t.params||{},{type:o.join(",")})),t}extractResults(e,t){return e.items.map(o=>this.dataToResult(o,t,e))}dataToResult(e,t,o){const i=this.computeLayerOptions(e),r=e.highlight.title||e.properties.title,s=e.highlight.groupTitle||e.properties.groupTitle,a=s?' <small style="color: #6f6969"> '+s+"</small>":"";return{source:this,meta:{dataType:"Layer",id:[this.getId(),e.properties.id].join("."),title:e.properties.title,titleHtml:r+a,icon:"Layer"===e.properties.type?"layers":"map",score:e.score||gm(t.trim(),e.properties.name),nextPage:o.items.length%+this.options.params.limit==0&&+this.options.params.page<10},data:i}}computeLayerOptions(e){const t=e.properties.url,o=this.extractQueryParamsFromSourceUrl(t);return E.removeUndefined({sourceOptions:{id:e.properties.id,type:e.properties.format,url:t,queryFormat:o.queryFormat,queryHtmlTarget:o.queryHtmlTarget,params:"wms"===e.properties.format?{LAYERS:e.properties.name}:void 0,layer:"wms"===e.properties.format?void 0:e.properties.name,optionsFromCapabilities:!0,crossOrigin:"anonymous"},title:e.properties.title,maxResolution:zn(Number(e.properties.maxScaleDenom)),minResolution:zn(Number(e.properties.minScaleDenom)),metadata:{url:e.properties.metadataUrl,extern:!0},properties:this.formatter.formatResult(e).properties})}extractQueryParamsFromSourceUrl(e){let t,o;const i=this.options.queryFormat;if(i){for(const o of Object.keys(i)){const r=i[o];if("*"===r){t=ic[o.toUpperCase()];break}const s=r.urls;if(Array.isArray(s)){s.forEach(i=>{-1!==e.indexOf(i)&&(t=ic[o.toUpperCase()])});break}}t!==ic.HTML&&t!==ic.HTMLGML2||(o="iframe")}return{queryFormat:t,queryHtmlTarget:o}}}return e.id="ilayer",e.type="Layer",e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(y.b),Object(i.qc)(le),Object(i.qc)(Oe),Object(i.qc)("options"),Object(i.qc)(Xm))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac}),e})();function tg(e){return new Xm(e)}function og(e,t,o,i,r){return new eg(e,t,o,i.getConfig("searchSources."+eg.id),r)}const ig=[Xc,"Layer"];function rg(e,t){if(1&e&&(Object(i.mc)(0,"mat-radio-button",7),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()),2&e){const e=t.$implicit,o=Object(i.xc)();Object(i.Dc)("value",e),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(2,2,o.getSearchTypeTitle(e))," ")}}let sg=(()=>{class e{constructor(e){this.searchSourceService=e,this.searchType$=new C.a(void 0),this.searchTypes=ig,this.searchTypeChange=new i.u}set searchType(e){this.setSearchType(e)}get searchType(){return this.searchType$.value}ngOnInit(){this.searchType$$=this.searchType$.pipe(Object(D.a)()).subscribe(e=>this.onSetSearchType(e))}ngOnDestroy(){this.searchType$$.unsubscribe()}onSearchTypeChange(e){this.setSearchType(e)}getSearchTypeTitle(e){return`igo.geo.search.${e.toLowerCase()}.title`}setSearchType(e){this.searchType$.next(e)}onSetSearchType(e){null!=e&&(this.searchSourceService.enableSourcesByType(e),this.searchTypeChange.emit(e))}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(um))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-search-selector"]],inputs:{searchTypes:"searchTypes",searchType:"searchType"},outputs:{searchTypeChange:"searchTypeChange"},decls:9,vars:8,consts:[[1,"igo-search-selector"],["mat-icon-button","","color","primary","tooltip-position","below","matTooltipShowDelay","500",1,"igo-search-selector-button",3,"matTooltip","matMenuTriggerFor"],["svgIcon","menu-down"],["xPosition","before","yPosition","above",1,"no-border-radius"],["searchSelectorMenu","matMenu"],[1,"igo-search-selector-radio-group",3,"value","change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){if(1&e&&(Object(i.mc)(0,"div",0),Object(i.mc)(1,"button",1),Object(i.yc)(2,"translate"),Object(i.hc)(3,"mat-icon",2),Object(i.lc)(),Object(i.mc)(4,"mat-menu",3,4),Object(i.mc)(6,"mat-radio-group",5),Object(i.tc)("change",(function(e){return t.onSearchTypeChange(e.value)})),Object(i.yc)(7,"async"),Object(i.Yc)(8,rg,3,4,"mat-radio-button",6),Object(i.lc)(),Object(i.lc)(),Object(i.lc)()),2&e){const e=Object(i.Kc)(5);Object(i.Tb)(1),Object(i.Dc)("matTooltip",Object(i.zc)(2,4,"igo.geo.search.menu.tooltip"))("matMenuTriggerFor",e),Object(i.Tb)(5),Object(i.Dc)("value",Object(i.zc)(7,6,t.searchType$)),Object(i.Tb)(2),Object(i.Dc)("ngForOf",t.searchTypes)}},directives:[n.b,h.a,f.d,c.a,f.e,Sn.b,m.s,Sn.a],pipes:[q.e,m.b],styles:[".igo-search-selector-button[_ngcontent-%COMP%]     div.mat-button-ripple-round{border-radius:0}.igo-search-selector-radio-group[_ngcontent-%COMP%]{display:inline-flex;flex-direction:column}.igo-search-selector-radio-group[_ngcontent-%COMP%]   mat-radio-button[_ngcontent-%COMP%]{margin:5px}"],changeDetection:0}),e})(),ag=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,h.b,c.b,n.c,f.c,Sn.c,xn.g,b.b,ie]]}),e})();function ng(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"div",8),Object(i.mc)(1,"button",9),Object(i.tc)("click",(function(t){return Object(i.Nc)(e),Object(i.xc)().checkUncheckAllSources(t)})),Object(i.ad)(2),Object(i.yc)(3,"translate"),Object(i.yc)(4,"translate"),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Tb)(2),Object(i.bd)(e.searchSourcesAllEnabled?Object(i.zc)(4,3,"igo.geo.search.searchSources.selectAll"):Object(i.zc)(3,1,"igo.geo.search.searchSources.unselectAll"))}}function cg(e,t){if(1&e&&(Object(i.mc)(0,"button",15),Object(i.ad)(1),Object(i.lc)()),2&e){const e=Object(i.xc)().$implicit,t=Object(i.Kc)(6);Object(i.Dc)("matMenuTriggerFor",t),Object(i.Tb)(1),Object(i.cd)("",e.title," ")}}function lg(e,t){if(1&e&&(Object(i.mc)(0,"button",16),Object(i.ad)(1),Object(i.lc)()),2&e){const e=Object(i.xc)().$implicit;Object(i.Tb)(1),Object(i.cd)(" ",e.title," ")}}function ug(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"mat-radio-button",22),Object(i.tc)("click",(function(t){return Object(i.Nc)(e),t.stopPropagation()}))("change",(function(o){Object(i.Nc)(e);const r=t.$implicit,s=Object(i.xc)(2).$implicit,a=Object(i.xc)().$implicit;return Object(i.xc)().settingsValueCheckedRadioButton(o,a,s,r)})),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()}if(2&e){const e=t.$implicit,o=Object(i.xc)(4);Object(i.Dc)("value",e)("matTooltip",o.getAvailableHashtagsValues(e))("checked",e.enabled),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(2,4,e.title)," ")}}function dg(e,t){if(1&e&&(Object(i.mc)(0,"span"),Object(i.mc)(1,"mat-radio-group",20),Object(i.Yc)(2,ug,3,6,"mat-radio-button",21),Object(i.lc)(),Object(i.lc)()),2&e){const e=Object(i.xc)().$implicit;Object(i.Tb)(1),Object(i.Dc)("value",e),Object(i.Tb)(1),Object(i.Dc)("ngForOf",e.values)}}function hg(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"div",8),Object(i.mc)(1,"button",9),Object(i.tc)("click",(function(t){Object(i.Nc)(e);const o=Object(i.xc)(2).$implicit,r=Object(i.xc)().$implicit;return Object(i.xc)().checkUncheckAll(t,r,o)})),Object(i.ad)(2),Object(i.yc)(3,"translate"),Object(i.yc)(4,"translate"),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=Object(i.xc)(2).$implicit;Object(i.Tb)(2),Object(i.bd)(e.allEnabled||void 0===e.allEnabled?Object(i.zc)(3,1,"igo.geo.search.searchSources.settings.unselectAll"):Object(i.zc)(4,3,"igo.geo.search.searchSources.settings.selectAll"))}}function pg(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"mat-checkbox",24),Object(i.tc)("click",(function(t){return Object(i.Nc)(e),t.stopPropagation()}))("change",(function(o){Object(i.Nc)(e);const r=t.$implicit,s=Object(i.xc)(2).$implicit,a=Object(i.xc)().$implicit;return Object(i.xc)().settingsValueCheckedCheckbox(o,a,s,r)})),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)()}if(2&e){const e=t.$implicit,o=Object(i.xc)(2).$implicit,r=Object(i.xc)(2);Object(i.Dc)("checked",e.enabled)("value",o)("matTooltip",r.getAvailableHashtagsValues(e)),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(2,4,e.title)," ")}}function mg(e,t){if(1&e&&(Object(i.mc)(0,"span"),Object(i.Yc)(1,hg,5,5,"div",5),Object(i.Yc)(2,pg,3,6,"mat-checkbox",23),Object(i.lc)()),2&e){const e=Object(i.xc)().$implicit,t=Object(i.xc)(2);Object(i.Tb)(1),Object(i.Dc)("ngIf",e.values.length>3),Object(i.Tb)(1),Object(i.Dc)("ngForOf",t.getAvailableValues(e))}}function gg(e,t){if(1&e&&(Object(i.kc)(0),Object(i.mc)(1,"button",15),Object(i.ad)(2),Object(i.yc)(3,"translate"),Object(i.lc)(),Object(i.mc)(4,"mat-menu",17,18),Object(i.Yc)(6,dg,3,2,"span",19),Object(i.Yc)(7,mg,3,2,"span",19),Object(i.lc)(),Object(i.jc)()),2&e){const e=t.$implicit,o=Object(i.Kc)(5);Object(i.Tb)(1),Object(i.Dc)("matMenuTriggerFor",o),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(3,5,"igo.geo.search.searchSources.settings."+e.title)," "),Object(i.Tb)(2),Object(i.Dc)("ngSwitch",e.type),Object(i.Tb)(2),Object(i.Dc)("ngSwitchCase","radiobutton"),Object(i.Tb)(1),Object(i.Dc)("ngSwitchCase","checkbox")}}function bg(e,t){if(1&e){const e=Object(i.nc)();Object(i.kc)(0),Object(i.mc)(1,"span",10),Object(i.mc)(2,"mat-checkbox",11),Object(i.tc)("click",(function(t){return Object(i.Nc)(e),t.stopPropagation()}))("change",(function(o){Object(i.Nc)(e);const r=t.$implicit;return Object(i.xc)().onCheckSearchSource(o,r)})),Object(i.lc)(),Object(i.Yc)(3,cg,2,2,"button",12),Object(i.Yc)(4,lg,2,1,"button",13),Object(i.lc)(),Object(i.mc)(5,"mat-menu",null,14),Object(i.Yc)(7,gg,8,7,"ng-container",6),Object(i.lc)(),Object(i.jc)()}if(2&e){const e=t.$implicit;Object(i.Tb)(2),Object(i.Dc)("checked",e.enabled)("value",e),Object(i.Tb)(1),Object(i.Dc)("ngIf",e.settings.length>0),Object(i.Tb)(1),Object(i.Dc)("ngIf",0===e.settings.length),Object(i.Tb)(3),Object(i.Dc)("ngForOf",e.settings)}}function fg(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"span"),Object(i.hc)(1,"mat-divider"),Object(i.mc)(2,"span",25),Object(i.mc)(3,"mat-slide-toggle",26),Object(i.tc)("change",(function(t){return Object(i.Nc)(e),Object(i.xc)().changePointerReverseSearch(t)}))("click",(function(t){return Object(i.Nc)(e),t.stopPropagation()})),Object(i.yc)(4,"translate"),Object(i.ad)(5),Object(i.yc)(6,"translate"),Object(i.lc)(),Object(i.mc)(7,"mat-slide-toggle",26),Object(i.tc)("change",(function(t){return Object(i.Nc)(e),Object(i.xc)().changeSearchResultsGeometry(t)}))("click",(function(t){return Object(i.Nc)(e),t.stopPropagation()})),Object(i.yc)(8,"translate"),Object(i.ad)(9),Object(i.yc)(10,"translate"),Object(i.lc)(),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Tb)(3),Object(i.Dc)("matTooltip",Object(i.zc)(4,8,"igo.geo.search.pointerSearchSummary.tooltip"))("checked",e.pointerSummaryEnabled)("labelPosition","after"),Object(i.Tb)(2),Object(i.cd)(" ",Object(i.zc)(6,10,"igo.geo.search.pointerSearchSummary.title")," "),Object(i.Tb)(2),Object(i.Dc)("matTooltip",Object(i.zc)(8,12,"igo.geo.search.searchResultsGeometry.tooltip"))("checked",e.searchResultsGeometryEnabled)("labelPosition","after"),Object(i.Tb)(2),Object(i.cd)(" ",Object(i.zc)(10,14,"igo.geo.search.searchResultsGeometry.title")," ")}}let yg=(()=>{class e{constructor(e,t,o){this.searchSourceService=e,this.mediaService=t,this.storageService=o,this.hasPointerReverseSearchSource=!1,this.searchSourcesAllEnabled=!1,this.buffer=[],this.lastKeyTime=Date.now(),this.pointerSummaryEnabled=!1,this.searchResultsGeometryEnabled=!1,this.searchSourceChange=new i.u,this.pointerSummaryStatus=new i.u,this.searchResultsGeometryStatus=new i.u}get isTouchScreen(){return this.mediaService.isTouchScreen()}handleKeyboardEvent(e){"F2"===e.key&&(this.pointerSummaryEnabled=!this.pointerSummaryEnabled,this.pointerSummaryStatus.emit(this.pointerSummaryEnabled))}ngOnInit(){this.hasPointerReverseSearchSource=this.hasReverseSearchSourcesForPointerSummary()}getSearchSources(){const e=this.searchSourceService.getSources().filter(dm).filter(e=>e.available&&"map"!==e.getId()&&e.showInSettings),t=this.searchSourceService.getSources().filter(hm).filter(e=>e.available&&"map"!==e.getId()&&e.showInSettings),o=e.concat(t);return this.computeSourcesCheckAllBehavior(o),o}hasReverseSearchSourcesForPointerSummary(){return!!this.searchSourceService.getEnabledSources().filter(pm).length}settingsValueCheckedCheckbox(e,t,o,i){i.enabled=e.checked,t.setParamFromSetting(o),this.searchSourceChange.emit(t)}computeSettingCheckAllBehavior(e){e.allEnabled=void 0===e.allEnabled?!e.values.find(e=>e.enabled):!e.allEnabled}computeSourcesCheckAllBehavior(e){const t=e.filter(e=>e.enabled).length,o=e.filter(e=>!e.enabled).length;this.searchSourcesAllEnabled=!(t>=o)}checkUncheckAll(e,t,o){e.stopPropagation(),this.computeSettingCheckAllBehavior(o),o.values.forEach(e=>{e.enabled=o.allEnabled}),t.setParamFromSetting(o),this.searchSourceChange.emit(t)}checkUncheckAllSources(e){e.stopPropagation(),this.getSearchSources().map(e=>{e.enabled=this.searchSourcesAllEnabled,this.searchSourceChange.emit(e)})}settingsValueCheckedRadioButton(e,t,o,i){o.values.forEach(t=>{t.enabled=t.value!==i.value?!e.source.checked:e.source.checked}),t.setParamFromSetting(o),this.searchSourceChange.emit(t)}onCheckSearchSource(e,t){t.enabled=e.checked;const o=this.storageService.get(t.getId()+".options")||{};o.enabled=t.enabled,this.storageService.set(t.getId()+".options",o),this.searchSourceChange.emit(t)}getAvailableValues(e){return e.values.filter(e=>!1!==e.available)}getAvailableHashtagsValues(e){if(e.hashtags)return e.hashtags.map(e=>"#"+e).join(", ")}stopPropagation(e){e.stopPropagation()}changePointerReverseSearch(e){this.pointerSummaryEnabled=e.checked,this.pointerSummaryStatus.emit(this.pointerSummaryEnabled)}changeSearchResultsGeometry(e){this.searchResultsGeometryEnabled=e.checked,this.searchResultsGeometryStatus.emit(this.searchResultsGeometryEnabled)}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(um),Object(i.gc)(be),Object(i.gc)(Oe))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-search-settings"]],hostBindings:function(e,t){1&e&&Object(i.tc)("keydown",(function(e){return t.handleKeyboardEvent(e)}),!1,i.Mc)},inputs:{pointerSummaryEnabled:"pointerSummaryEnabled",searchResultsGeometryEnabled:"searchResultsGeometryEnabled"},outputs:{searchSourceChange:"searchSourceChange",pointerSummaryStatus:"pointerSummaryStatus",searchResultsGeometryStatus:"searchResultsGeometryStatus"},decls:9,vars:7,consts:[[1,"igo-search-settings"],["mat-icon-button","","color","primary","tooltip-position","below","matTooltipShowDelay","500",1,"igo-search-settings-button",3,"matTooltip","matMenuTriggerFor"],["svgIcon","chevron-down"],[1,"no-border-radius"],["searchSettingsMenu","matMenu"],["class","checkAllButton",4,"ngIf"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"checkAllButton"],["mat-raised-button","",3,"click"],[1,"igo-search-settings-search-source"],[1,"igo-search-settings-checkbox",3,"checked","value","click","change"],["mat-menu-item","",3,"matMenuTriggerFor",4,"ngIf"],["mat-menu-item","",4,"ngIf"],["sub_menu","matMenu"],["mat-menu-item","",3,"matMenuTriggerFor"],["mat-menu-item",""],["yPosition","above",3,"ngSwitch"],["test_sub_menu","matMenu"],[4,"ngSwitchCase"],[1,"igo-search-settings-radio-group",3,"value"],["class","mat-typography",3,"value","matTooltip","checked","click","change",4,"ngFor","ngForOf"],[1,"mat-typography",3,"value","matTooltip","checked","click","change"],["class","mat-menu-item",3,"checked","value","matTooltip","click","change",4,"ngFor","ngForOf"],[1,"mat-menu-item",3,"checked","value","matTooltip","click","change"],[1,"pointer-summary-slide-toggle-container","mat-typography"],["tooltip-position","below","matTooltipShowDelay","500",1,"pointer-summary-option",3,"matTooltip","checked","labelPosition","change","click"]],template:function(e,t){if(1&e&&(Object(i.mc)(0,"div",0),Object(i.mc)(1,"button",1),Object(i.yc)(2,"translate"),Object(i.hc)(3,"mat-icon",2),Object(i.lc)(),Object(i.mc)(4,"mat-menu",3,4),Object(i.Yc)(6,ng,5,5,"div",5),Object(i.Yc)(7,bg,8,5,"ng-container",6),Object(i.Yc)(8,fg,11,16,"span",7),Object(i.lc)(),Object(i.lc)()),2&e){const e=Object(i.Kc)(5);Object(i.Tb)(1),Object(i.Dc)("matTooltip",Object(i.zc)(2,5,"igo.geo.search.menu.tooltip"))("matMenuTriggerFor",e),Object(i.Tb)(5),Object(i.Dc)("ngIf",t.getSearchSources().length>4),Object(i.Tb)(1),Object(i.Dc)("ngForOf",t.getSearchSources()),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.hasPointerReverseSearchSource&&!t.isTouchScreen)}},directives:[n.b,h.a,f.d,c.a,f.e,m.t,m.s,b.a,f.b,m.x,m.y,Sn.b,Sn.a,dn.a,hn.a],pipes:[q.e],styles:[".checkAllButton[_ngcontent-%COMP%]{padding:0 5px;text-align:center}.igo-search-settings-button[_ngcontent-%COMP%]     div.mat-button-ripple-round{border-radius:0}.igo-search-settings-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.igo-search-settings-radio-group[_ngcontent-%COMP%]   mat-radio-button[_ngcontent-%COMP%]{margin:5px}.igo-search-settings-checkbox[_ngcontent-%COMP%]   mat-radio-button[_ngcontent-%COMP%]{display:flex}.igo-search-settings-search-source[_ngcontent-%COMP%]{display:flex;width:100%}.igo-search-settings-search-source[_ngcontent-%COMP%]   mat-checkbox[_ngcontent-%COMP%]{display:flex;margin-left:5px;margin-right:5px}.pointer-summary-option[_ngcontent-%COMP%]{display:block;margin-bottom:15px;margin-right:10px}.pointer-summary-slide-toggle-container[_ngcontent-%COMP%]{overflow-x:hidden}.pointer-summary-slide-toggle-container[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{margin:10px}"],changeDetection:0}),e})(),Og=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,h.b,c.b,n.c,f.c,Sn.c,b.b,dn.b,hn.b,ie]]}),e})();const vg=["input"];function jg(e,t){if(1&e&&(Object(i.mc)(0,"mat-label"),Object(i.ad)(1),Object(i.lc)()),2&e){const e=Object(i.xc)();Object(i.Tb)(1),Object(i.bd)(e.label)}}function wg(e,t){if(1&e&&(Object(i.mc)(0,"button",10),Object(i.hc)(1,"mat-icon",11),Object(i.lc)()),2&e){const e=Object(i.xc)();Object(i.Dc)("color",e.color),Object(i.Tb)(1),Object(i.Ec)("svgIcon",e.searchIcon)}}function Sg(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",12),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.xc)().onClearButtonClick()})),Object(i.hc)(1,"mat-icon",13),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Dc)("color",e.color)}}function xg(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"igo-search-selector",14),Object(i.tc)("searchTypeChange",(function(t){return Object(i.Nc)(e),Object(i.xc)().onSearchTypeChange(t)})),Object(i.yc)(1,"async"),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Dc)("searchTypes",e.searchTypes)("searchType",Object(i.zc)(1,2,e.searchType$))}}function Cg(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"igo-search-settings",15),Object(i.tc)("pointerSummaryStatus",(function(t){return Object(i.Nc)(e),Object(i.xc)().pointerSummaryStatus.emit(t)}))("searchResultsGeometryStatus",(function(t){return Object(i.Nc)(e),Object(i.xc)().searchResultsGeometryStatus.emit(t)}))("searchSourceChange",(function(){return Object(i.Nc)(e),Object(i.xc)().onSearchSettingsChange()})),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Dc)("pointerSummaryEnabled",e.pointerSummaryEnabled)("searchResultsGeometryEnabled",e.searchResultsGeometryEnabled)}}const Tg=function(e){return{empty:e}},Lg=function(e){return{hasSearchIcon:e}};let Ig=(()=>{class e{constructor(e,t,o){this.languageService=e,this.searchService=t,this.searchSourceService=o,this.placeholder$=new C.a("igo.geo.search.placeholder"),this.empty$=new C.a(!0),this.stream$=new C.a(""),this.searchTypes=ig,this.searchType$=new C.a(void 0),this.pointerSummaryStatus=new i.u,this.searchResultsGeometryStatus=new i.u,this.term$=new C.a(""),this.disabled$=new C.a(!1),this.pointerSummaryEnabled=!1,this.searchResultsGeometryEnabled=!1,this.floatLabel="never",this.appearance="legacy",this.color="primary",this.termSplitter="|",this.debounce=200,this.minLength=2,this.searchSelector=!1,this.searchSettings=!1,this.forceNA=!1,this.searchTermChange=new i.u,this.search=new i.u,this.searchTypeChange=new i.u,this.clearFeature=new i.u,this.searchSettingsChange=new i.u}set searchType(e){this.setSearchType(e)}get searchType(){return this.searchType$.value}set term(e){this.setTerm(e)}get term(){return this.term$.value}set disabled(e){this.disabled$.next(e)}get disabled(){return this.disabled$.value}get empty(){return 0===this.term.length}ngOnInit(){this.term$$=this.term$.subscribe(e=>{this.empty$.next(void 0===e||0===e.length)}),this.stream$$=this.stream$.pipe(Object(ia.a)(e=>""===e?Qs.a:Object(Js.a)(this.debounce))).subscribe(e=>this.onSetTerm(e)),this.handlePlaceholder(),this.searchType$$=this.searchType$.pipe(Object(D.a)()).subscribe(e=>this.onSetSearchType(e))}ngOnDestroy(){this.term$$.unsubscribe(),this.stream$$.unsubscribe(),this.searchType$$.unsubscribe()}onKeyup(e){this.keyIsValid(e.key)&&this.setTerm(e.target.value)}onClearButtonClick(){this.clear(),this.clearFeature.emit()}onSearchTypeChange(e){this.setSearchType(e)}setSearchType(e){this.searchType$.next(e)}onSearchSettingsChange(){this.doSearch(this.term),this.searchSettingsChange.emit(),this.handlePlaceholder()}setTerm(e){if(this.disabled)return;(e=e||"")!==this.term&&this.term$.next(e);const t=e.replace(/(#[^\s]*)/g,"").trim();(t.length>=this.minLength||0===t.length)&&this.stream$.next(e)}clear(){this.term$.next(""),this.stream$.next(""),this.input.nativeElement.focus()}keyIsValid(t){return-1===e.invalidKeys.indexOf(t)}onSetTerm(e){this.searchTermChange.emit(e),this.doSearch(e)}handlePlaceholder(){const e=[...new Set(this.searchSourceService.getEnabledSources().filter(e=>!["map","coordinatesreverse"].includes(e.getId())).map(e=>e.getType()))];let t="igo.geo.search.placeholder";1===e.length?t=`igo.geo.search.${e[0].toLowerCase()}.placeholder`:0===e.length&&(t="igo.geo.search.emptyType.placeholder"),this.placeholder$.next(t)}onSetSearchType(e){if(null==e)return;this.searchTypeChange.emit(e);const t=`igo.geo.search.${e.toLowerCase()}.placeholder`;this.placeholder$.next(t),this.setTerm(this.term)}doSearch(e){let t;this.researches$$&&(this.researches$$.map(e=>e.unsubscribe()),this.researches$$=void 0),this.termSplitter&&e.match(new RegExp(this.termSplitter,"g"))?(t=e.split(this.termSplitter).filter(e=>e.length>=this.minLength),this.store.clear()):t=[e];let o=[];t.map(e=>{""!==(e?e.replace(/(#[^\s]*)/g,"").trim():"")?o=o.concat(this.searchService.search(e,{forceNA:this.forceNA})):void 0!==this.store&&this.store.clear()}),this.researches$$=o.map(e=>e.request.subscribe(t=>{this.onResearchCompleted(e,t)}))}onResearchCompleted(e,t){if(this.search.emit({research:e,results:t}),void 0!==this.store){const o=this.store.all().filter(t=>t.source!==e.source).concat(t);this.store.updateMany(o)}}}return e.invalidKeys=["Control","Shift","Alt","ArrowDown","ArrowUp","ArrowRight","ArrowLeft"],e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(le),Object(i.gc)(bm),Object(i.gc)(um))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-search-bar"]],viewQuery:function(e,t){var o;1&e&&Object(i.Uc)(vg,!0),2&e&&Object(i.Jc)(o=Object(i.uc)())&&(t.input=o.first)},inputs:{searchTypes:"searchTypes",searchType:"searchType",term:"term",disabled:"disabled",pointerSummaryEnabled:"pointerSummaryEnabled",searchResultsGeometryEnabled:"searchResultsGeometryEnabled",floatLabel:"floatLabel",appearance:"appearance",placeholder:"placeholder",label:"label",color:"color",termSplitter:"termSplitter",debounce:"debounce",minLength:"minLength",searchIcon:"searchIcon",searchSelector:"searchSelector",searchSettings:"searchSettings",forceNA:"forceNA",store:"store"},outputs:{pointerSummaryStatus:"pointerSummaryStatus",searchResultsGeometryStatus:"searchResultsGeometryStatus",searchTermChange:"searchTermChange",search:"search",searchTypeChange:"searchTypeChange",clearFeature:"clearFeature",searchSettingsChange:"searchSettingsChange"},decls:16,vars:28,consts:[[1,"igo-search-bar-container",3,"ngClass"],[3,"floatLabel","appearance"],[4,"ngIf"],["matInput","","autocomplete","off",3,"ngClass","disabled","placeholder","value","keyup","touchend"],["input",""],[1,"search-bar-buttons"],["mat-icon-button","",3,"color",4,"ngIf"],["mat-icon-button","",3,"color","click",4,"ngIf"],[3,"searchTypes","searchType","searchTypeChange",4,"ngIf"],[3,"pointerSummaryEnabled","searchResultsGeometryEnabled","pointerSummaryStatus","searchResultsGeometryStatus","searchSourceChange",4,"ngIf"],["mat-icon-button","",3,"color"],[3,"svgIcon"],["mat-icon-button","",3,"color","click"],["svgIcon","close"],[3,"searchTypes","searchType","searchTypeChange"],[3,"pointerSummaryEnabled","searchResultsGeometryEnabled","pointerSummaryStatus","searchResultsGeometryStatus","searchSourceChange"]],template:function(e,t){1&e&&(Object(i.mc)(0,"div",0),Object(i.yc)(1,"async"),Object(i.mc)(2,"mat-form-field",1),Object(i.Yc)(3,jg,2,1,"mat-label",2),Object(i.mc)(4,"input",3,4),Object(i.tc)("keyup",(function(e){return t.onKeyup(e)}))("touchend",(function(e){return t.onKeyup(e)})),Object(i.yc)(6,"async"),Object(i.yc)(7,"async"),Object(i.yc)(8,"translate"),Object(i.yc)(9,"async"),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(10,"div",5),Object(i.Yc)(11,wg,2,2,"button",6),Object(i.Yc)(12,Sg,2,1,"button",7),Object(i.yc)(13,"async"),Object(i.Yc)(14,xg,2,4,"igo-search-selector",8),Object(i.Yc)(15,Cg,1,2,"igo-search-settings",9),Object(i.lc)(),Object(i.lc)()),2&e&&(Object(i.Dc)("ngClass",Object(i.Gc)(24,Tg,Object(i.zc)(1,12,t.empty$))),Object(i.Tb)(2),Object(i.Dc)("floatLabel",t.floatLabel)("appearance",t.appearance),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.label),Object(i.Tb)(1),Object(i.Dc)("ngClass",Object(i.Gc)(26,Lg,t.searchIcon))("disabled",Object(i.zc)(6,14,t.disabled$))("placeholder",t.placeholder?t.placeholder:Object(i.zc)(7,16,t.placeholder$)?Object(i.zc)(8,18,t.placeholder$.value):void 0)("value",Object(i.zc)(9,20,t.term$)),Object(i.Tb)(7),Object(i.Dc)("ngIf",void 0!==t.searchIcon),Object(i.Tb)(1),Object(i.Dc)("ngIf",!Object(i.zc)(13,22,t.empty$)),Object(i.Tb)(2),Object(i.Dc)("ngIf",t.searchSelector),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.searchSettings))},directives:[m.q,ke.c,m.t,Ve.b,ke.g,n.b,c.a,sg,yg],pipes:[m.b,q.e],styles:['[_nghost-%COMP%]     .mat-form-field{padding:0 5px}[_nghost-%COMP%]     .mat-form-field-wrapper{margin-bottom:-1.5em}[_nghost-%COMP%]     span.mat-form-field-label-wrapper{top:-20px}[_nghost-%COMP%]     div.mat-form-field-infix{left:5px;padding:0 0 12px!important;right:5px}[_nghost-%COMP%]     div.mat-form-field-underline{display:none}.igo-search-bar-container[_ngcontent-%COMP%]{display:inline-flex;overflow:hidden;position:relative;width:100%}.igo-search-bar-container[_ngcontent-%COMP%] > mat-form-field[_ngcontent-%COMP%]{width:calc(100% - 80px)}.igo-search-bar-container.empty[_ngcontent-%COMP%] > mat-form-field[_ngcontent-%COMP%]{width:calc(100% - 40px)}.search-bar-buttons[_ngcontent-%COMP%]{display:inline-flex;position:relative;right:0;top:0}.search-bar-buttons[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]:nth-child(2):before{border-right:1px solid #ddd;content:"";height:28px;left:0;top:5px}igo-search-selector[_ngcontent-%COMP%], igo-search-settings[_ngcontent-%COMP%]{background-color:#fff;border-radius:0;top:0}'],changeDetection:0}),e})(),Fg=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,Ue.m,h.b,c.b,n.c,f.c,Sn.c,ke.e,Ve.c,ie,ag,Og]]}),e})();function Mg(e,t){if(1&e&&Object(i.hc)(0,"mat-icon",4),2&e){const e=Object(i.xc)();Object(i.Ec)("svgIcon",e.showIcons?e.icon:"blank")}}function kg(e,t){if(1&e&&Object(i.hc)(0,"h4",5),2&e){const e=Object(i.xc)();Object(i.Dc)("innerHtml",e.titleHtml,i.Oc)("matTooltip",e.tooltipHtml)}}function Dg(e,t){if(1&e&&(Object(i.mc)(0,"h4",6),Object(i.ad)(1),Object(i.lc)()),2&e){const e=Object(i.xc)();Object(i.Dc)("matTooltip",e.title),Object(i.Tb)(1),Object(i.bd)(e.title)}}function Pg(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",7),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.xc)().onZoomHandler()})),Object(i.hc)(1,"mat-icon",8),Object(i.lc)()}}const Ag=[[["","igoSearchItemToolbar",""]]],$g=["[igoSearchItemToolbar]"];let Eg=(()=>{class e{constructor(){this.withZoomButton=!1,this.zoomEvent=new i.u,this.format=new sn.a}get title(){return ot(this.result)}get titleHtml(){return function(e){const t=e.meta||{};return t.titleHtml?t.titleHtml:et(e,t.titleHtmlProperty||"titleHtml")}(this.result)}get tooltipHtml(){return this.titleHtml.replace(/<small?[^>]+(>|$)/g,"\n").replace(/<\/?[^>]+(>|$)/g,"")}get icon(){return it(this.result)}onZoomHandler(){const e=this.format.readFeature(this.result.data,{dataProjection:this.result.data.projection,featureProjection:this.map.projection});rl(this.map,[e],el.Default)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-search-results-item"]],inputs:{result:"result",map:"map",showIcons:"showIcons",withZoomButton:"withZoomButton"},outputs:{zoomEvent:"zoomEvent"},ngContentSelectors:$g,decls:6,vars:4,consts:[["mat-list-avatar","",3,"svgIcon",4,"ngIf"],["matLine","","matTooltipShowDelay","500","matTooltipClass","search-result-tooltip",3,"innerHtml","matTooltip",4,"ngIf"],["matLine","","matTooltipShowDelay","500",3,"matTooltip",4,"ngIf"],["igoStopPropagation","","mat-icon-button","",3,"click",4,"ngIf"],["mat-list-avatar","",3,"svgIcon"],["matLine","","matTooltipShowDelay","500","matTooltipClass","search-result-tooltip",3,"innerHtml","matTooltip"],["matLine","","matTooltipShowDelay","500",3,"matTooltip"],["igoStopPropagation","","mat-icon-button","",3,"click"],["svgIcon","magnify"]],template:function(e,t){1&e&&(Object(i.Cc)(Ag),Object(i.mc)(0,"mat-list-item"),Object(i.Yc)(1,Mg,1,1,"mat-icon",0),Object(i.Yc)(2,kg,1,2,"h4",1),Object(i.Yc)(3,Dg,2,2,"h4",2),Object(i.Yc)(4,Pg,2,0,"button",3),Object(i.Bc)(5),Object(i.lc)()),2&e&&(Object(i.Tb)(1),Object(i.Dc)("ngIf",t.icon),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.titleHtml),Object(i.Tb)(1),Object(i.Dc)("ngIf",!t.titleHtml),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.withZoomButton))},directives:[l.d,m.t,c.a,l.b,Pe.l,h.a,n.b,gt],styles:["[_nghost-%COMP%]     small{color:#8c8c8c}  .search-result-tooltip{white-space:pre-line}"],changeDetection:0}),e})();const Rg=["igoSearchItemToolbar"];function _g(e,t){1&e&&Object(i.ic)(0)}const zg=function(e){return{results:e}};function Ng(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"igo-collapsible",6),Object(i.tc)("toggle",(function(t){Object(i.Nc)(e);const o=Object(i.xc)().$implicit;return Object(i.xc)().collapsed[o.source.title]=t})),Object(i.Yc)(1,_g,1,0,"ng-container",7),Object(i.lc)()}if(2&e){const e=Object(i.xc)().$implicit,t=Object(i.Kc)(4),o=Object(i.xc)();Object(i.Vb)(e.source.getId()),Object(i.Dc)("title",o.computeGroupTitle(e))("collapsed",o.collapsed[e.source.title]),Object(i.Tb)(1),Object(i.Dc)("ngTemplateOutlet",t)("ngTemplateOutletContext",Object(i.Gc)(6,zg,e.results))}}function Bg(e,t){1&e&&Object(i.ic)(0)}function qg(e,t){if(1&e&&Object(i.Yc)(0,Bg,1,0,"ng-container",7),2&e){const e=Object(i.xc)().$implicit,t=Object(i.Kc)(4);Object(i.Dc)("ngTemplateOutlet",t)("ngTemplateOutletContext",Object(i.Gc)(2,zg,e.results))}}const Gg=function(e){return{result:e}};function Vg(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"igo-search-results-item",9),Object(i.tc)("focus",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)(3).resultFocus.emit(o)}))("unfocus",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)(3).resultUnfocus.emit(o)}))("select",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)(3).onResultSelect(o)}))("mouseenter",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)(3).resultFocus.emit(o)}))("mouseleave",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)(3).resultUnfocus.emit(o)})),Object(i.ic)(1,10),Object(i.lc)()}if(2&e){const e=t.$implicit,o=Object(i.xc)(3);Object(i.Dc)("map",o.map)("result",e)("showIcons",o.showIcons)("withZoomButton",o.withZoomButton)("focused",o.store.state.get(e).focused)("selected",o.store.state.get(e).selected),Object(i.Tb)(1),Object(i.Dc)("ngTemplateOutlet",o.templateSearchToolbar)("ngTemplateOutletContext",Object(i.Gc)(8,Gg,e))}}function Ug(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"span",11),Object(i.tc)("click",(function(){Object(i.Nc)(e);const t=Object(i.xc)(2).$implicit;return Object(i.xc)().displayMoreResults(t)})),Object(i.mc)(1,"u"),Object(i.ad)(2),Object(i.yc)(3,"translate"),Object(i.lc)(),Object(i.lc)()}2&e&&(Object(i.Tb)(2),Object(i.bd)(Object(i.zc)(3,1,"igo.geo.search.displayMoreResults")))}function Hg(e,t){if(1&e&&(Object(i.Yc)(0,Vg,2,10,"ng-template",1),Object(i.Yc)(1,Ug,4,3,"span",8)),2&e){const e=t.results,o=Object(i.xc)().$implicit,r=Object(i.xc)();Object(i.Dc)("ngForOf",e),Object(i.Tb)(1),Object(i.Dc)("ngIf",r.isMoreResults(o))}}function Yg(e,t){if(1&e&&(Object(i.Yc)(0,Ng,2,8,"igo-collapsible",3),Object(i.Yc)(1,qg,1,4,"ng-template",null,4,i.Zc),Object(i.Yc)(3,Hg,2,2,"ng-template",null,5,i.Zc)),2&e){const e=Object(i.Kc)(2),t=Object(i.xc)();Object(i.Dc)("ngIf",t.mode===t.searchResultMode.Grouped)("ngIfElse",e)}}var Wg=function(e){return e.Grouped="grouped",e.Flat="flat",e}({});let Kg=(()=>{class e{constructor(e,t){this.cdRef=e,this.searchService=t,this.searchResultMode=Wg,this.pageIterator=[],this.collapsed=[],this.mode=Wg.Grouped,this.withZoomButton=!1,this.settingsChange$=new C.a(void 0),this.termSplitter="|",this.resultFocus=new i.u,this.resultUnfocus=new i.u,this.resultSelect=new i.u,this.moreResults=new i.u,this.resultMouseenter=new i.u,this.resultMouseleave=new i.u}get term(){return this._term}set term(e){this._term=e,this.pageIterator=[]}get results$(){return void 0===this._results$&&(this._results$=this.liftResults()),this._results$}ngOnInit(){this.watcher=new nt(this.store,this.cdRef),this.settingsChange$$=this.settingsChange$.subscribe(()=>{this.pageIterator=[]})}ngOnDestroy(){this.watcher.destroy(),this.settingsChange$$.unsubscribe()}computeGroupTitle(e){const t=[e.source.title],o=e.results.length;return o>1&&t.push(`(${o})`),t.join(" ")}onResultSelect(e){this.store.state.get(e)&&!0===this.store.state.get(e).selected||(this.store.state.update(e,{focused:!0,selected:!0},!0),this.resultSelect.emit(e))}liftResults(){return this.store.stateView.all$().pipe(Object(ia.a)(e=>0===e.length?Qs.a:Object(Js.a)(200)),Object(j.a)(e=>this.groupResults(e.map(e=>e.entity).sort(this.sortByOrder))))}sortByOrder(e,t){return e.source.displayOrder-t.source.displayOrder}groupResults(e){const t=new Map;return e.forEach(e=>{const o=e.source;let i=t.get(o);void 0===i&&(i=[],t.set(o,i)),i.push(e)}),Array.from(t.keys()).map(e=>(void 0===this.pageIterator[e.getId()]&&(this.pageIterator[e.getId()]=1),{source:e,results:t.get(e)}))}isMoreResults(e){const t=this.store.getStrategyOfType(lt);return!(null==t?void 0:t.active)&&e.results&&!0===e.results[e.results.length-1].meta.nextPage}displayMoreResults(e){const t={sourceId:e.source.getId(),page:++this.pageIterator[e.source.getId()]};let o;o=this.termSplitter&&this.term.match(new RegExp(this.termSplitter,"g"))?this.term.split(this.termSplitter):[this.term];let i=[];o.map(e=>{i=i.concat(this.searchService.search(e,t))}),i.map(t=>{t.request.subscribe(o=>{const i=e.results.concat(o);o.length||(i[i.length-1].meta.nextPage=!1),this.moreResults.emit({research:t,results:i})})})}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(i.j),Object(i.gc)(bm))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-search-results"]],contentQueries:function(e,t,o){var r;1&e&&Object(i.Zb)(o,Rg,!0),2&e&&Object(i.Jc)(r=Object(i.uc)())&&(t.templateSearchToolbar=r.first)},inputs:{map:"map",store:"store",showIcons:"showIcons",mode:"mode",withZoomButton:"withZoomButton",term:"term",settingsChange$:"settingsChange$",termSplitter:"termSplitter"},outputs:{resultFocus:"resultFocus",resultUnfocus:"resultUnfocus",resultSelect:"resultSelect",moreResults:"moreResults",resultMouseenter:"resultMouseenter",resultMouseleave:"resultMouseleave"},decls:4,vars:4,consts:[[3,"navigation"],["ngFor","",3,"ngForOf"],["groupTemplate",""],[3,"class","title","collapsed","toggle",4,"ngIf","ngIfElse"],["flatTemplate",""],["storeItemTemplate",""],[3,"title","collapsed","toggle"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["class","moreResults mat-typography",3,"click",4,"ngIf"],["igoListItem","","color","accent",3,"map","result","showIcons","withZoomButton","focused","selected","focus","unfocus","select","mouseenter","mouseleave"],["igoSearchItemToolbar","",3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"moreResults","mat-typography",3,"click"]],template:function(e,t){1&e&&(Object(i.mc)(0,"igo-list",0),Object(i.Yc)(1,Yg,5,2,"ng-template",1,2,i.Zc),Object(i.yc)(3,"async"),Object(i.lc)()),2&e&&(Object(i.Dc)("navigation",!0),Object(i.Tb)(1),Object(i.Dc)("ngForOf",Object(i.zc)(3,2,t.results$)))},directives:[Pi,m.s,m.t,Ao,m.A,Eg,Mi],pipes:[m.b,q.e],styles:[".moreResults[_ngcontent-%COMP%]{color:#00f;cursor:pointer;float:right;margin-right:10px;margin-top:5px}igo-list[_ngcontent-%COMP%]     mat-list{height:100%}"],changeDetection:0}),e})();function Zg(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",1),Object(i.tc)("mouseenter",(function(t){return Object(i.Nc)(e),Object(i.xc)().onMouseEvent(t)}))("mouseleave",(function(t){return Object(i.Nc)(e),Object(i.xc)().onMouseEvent(t)}))("click",(function(t){return Object(i.Nc)(e),Object(i.xc)().onToggleClick(t)})),Object(i.yc)(1,"translate"),Object(i.yc)(2,"async"),Object(i.yc)(3,"async"),Object(i.hc)(4,"mat-icon",2),Object(i.yc)(5,"async"),Object(i.yc)(6,"async"),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Dc)("matTooltip",Object(i.zc)(1,4,Object(i.zc)(2,6,e.tooltip$)))("color",Object(i.zc)(3,8,e.isPreview$)?"":e.added?"warn":""),Object(i.Tb)(4),Object(i.Dc)("matBadgeHidden",Object(i.zc)(5,10,e.inRange$))("svgIcon",Object(i.zc)(6,12,e.isPreview$)?"plus":e.added?"delete":"plus")}}let Qg=(()=>{class e{constructor(e){this.layerService=e,this.tooltip$=new C.a("igo.geo.catalog.layer.addToMap"),this.inRange$=new C.a(!0),this.isPreview$=new C.a(!1),this.layersSubcriptions=[],this.mouseInsideAdd=!1,this._color="primary"}get color(){return this._color}set color(e){this._color=e}ngOnInit(){"Layer"===this.layer.meta.dataType&&(this.added=-1!==this.map.layers.findIndex(e=>e.id===this.layer.data.sourceOptions.id)),this.resolution$$=this.map.viewController.resolution$.subscribe(e=>{this.isInResolutionsRange(e),this.tooltip$.next(this.computeTooltip())})}ngOnDestroy(){this.resolution$$.unsubscribe()}onMouseEvent(e){this.onToggleClick(e)}onToggleClick(e){if(void 0!==this.lastTimeoutRequest&&clearTimeout(this.lastTimeoutRequest),"mouseenter"!==e.type||!this.mouseInsideAdd)switch(e.type){case"click":this.isPreview$.value||(this.added?this.remove():this.add()),this.isPreview$.next(!1);break;case"mouseenter":this.isPreview$.value||this.added||(this.lastTimeoutRequest=setTimeout(()=>{this.add(),this.isPreview$.next(!0)},500)),this.mouseInsideAdd=!0;break;case"mouseleave":this.isPreview$.value&&(this.remove(),this.isPreview$.next(!1)),this.mouseInsideAdd=!1}}add(){this.added||(this.added=!0,this.addLayerToMap())}remove(){this.added&&(this.added=!1,this.removeLayerFromMap(),this.layersSubcriptions.map(e=>e.unsubscribe()),this.layersSubcriptions=[])}addLayerToMap(){if(void 0===this.map)return;if("Layer"!==this.layer.meta.dataType)return;const e=this.layer.data;void 0===e.sourceOptions.optionsFromApi&&(e.sourceOptions.optionsFromApi=!0),this.layersSubcriptions.push(this.layerService.createAsyncLayer(e).subscribe(e=>this.map.addLayer(e)))}removeLayerFromMap(){if(void 0===this.map)return;if("Layer"!==this.layer.meta.dataType)return;const e=this.map.getLayerById(this.layer.data.sourceOptions.id);this.map.removeLayer(e)}isInResolutionsRange(e){this.inRange$.next(e>=(this.layer.data.minResolution||0)&&e<=(this.layer.data.maxResolution||1/0))}computeTooltip(){return this.added?this.inRange$.value?"igo.geo.catalog.layer.removeFromMap":"igo.geo.catalog.layer.removeFromMapOutRange":this.inRange$.value?"igo.geo.catalog.layer.addToMap":"igo.geo.catalog.layer.addToMapOutRange"}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(Jc))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-search-add-button"]],inputs:{layer:"layer",added:"added",map:"map",color:"color"},decls:1,vars:1,consts:[["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","mouseenter","mouseleave","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","mouseenter","mouseleave","click"],["matBadge","","igoMatBadgeIcon","eye-off","igoMatBadgeInverseColor","true","matBadgeDisabled","true","matBadgeSize","small","matBadgePosition","after",3,"matBadgeHidden","svgIcon"]],template:function(e,t){1&e&&Object(i.Yc)(0,Zg,7,14,"button",0),2&e&&Object(i.Dc)("ngIf","Layer"===t.layer.meta.dataType)},directives:[m.t,n.b,h.a,c.a,Be.a,Io],pipes:[q.e,m.b],styles:[""],changeDetection:0}),e})(),Jg=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,Be.b,h.b,c.b,l.e,n.c,$o,Ai,bi,ie,Fo,Oc]]}),e})(),Xg=(()=>{class e{constructor(e,t,o,i){this.component=e,this.searchService=t,this.searchSourceService=o,this.mediaService=i,this.pointerSearchStore=new at([]),this.reverseSearch$$=[],this.hasPointerReverseSearchSource=!1,this.searchPointerSummaryFeatureId="searchPointerSummaryFeatureId",this.igoSearchPointerSummaryDelay=1e3,this.igoSearchPointerSummaryEnabled=!1}get map(){return this.component.map}get mapProjection(){return this.component.map.projection}ngOnInit(){this.listenToMapPointerMove(),this.subscribeToPointerStore(),this.map.status$.pipe(Object(Me.a)(1)).subscribe(()=>{this.store=new al([],{map:this.map}),this.initStore()}),this.layers$$=this.map.layers$.subscribe(e=>{this.store&&!e.find(e=>"searchPointerSummaryId"===e.id)&&this.initStore()})}initStore(){sl(this.store,new Wc({id:"searchPointerSummaryId",title:"searchPointerSummary",zIndex:900,source:new vc,showInLayerList:!1,exportable:!1,browsable:!1,style:eb}))}ngAfterContentChecked(){this.hasPointerReverseSearchSource=!!this.searchSourceService.getEnabledSources().filter(pm).length}ngOnDestroy(){this.unlistenToMapPointerMove(),this.unsubscribeToPointerStore(),this.unsubscribeReverseSearch(),this.layers$$.unsubscribe()}subscribeToPointerStore(){this.store$$=this.pointerSearchStore.entities$.subscribe(e=>{this.entitiesToPointerOverlay(e)})}computeSummaryClosestFeature(e){const t={};return e.map(e=>{e.data.properties.type&&e.data.properties.distance>=0&&(t.hasOwnProperty(e.data.properties.type)?e.data.properties.distance<t[e.data.properties.type].distance&&(t[e.data.properties.type]={distance:e.data.properties.distance,title:e.meta.title}):t[e.data.properties.type]={distance:e.data.properties.distance,title:e.meta.title})}),t}entitiesToPointerOverlay(e){const t=this.computeSummaryClosestFeature(e),o=Object.keys(t),i=[],r=[];e.map(e=>{const s=o.indexOf(e.data.properties.type);-1!==s?(r.push(t[e.data.properties.type].title),o.splice(s,1),i.push(e.data.properties.type)):-1===i.indexOf(e.data.properties.type)&&r.push(e.meta.title)}),r.length&&this.addPointerOverlay(r.join("\n"))}listenToMapPointerMove(){this.pointerMoveListener=this.map.ol.on("pointermove",e=>this.onMapEvent(e))}unsubscribeToPointerStore(){this.store$$.unsubscribe()}unsubscribeReverseSearch(){this.reverseSearch$$.map(e=>e.unsubscribe()),this.reverseSearch$$=[]}unlistenToMapPointerMove(){this.map.ol.un(this.pointerMoveListener.type,this.pointerMoveListener.listener),this.pointerMoveListener=void 0}onMapEvent(e){!e.dragging&&this.igoSearchPointerSummaryEnabled&&this.hasPointerReverseSearchSource&&!this.mediaService.isTouchScreen()?(void 0!==this.lastTimeoutRequest&&(clearTimeout(this.lastTimeoutRequest),this.clearLayer(),this.unsubscribeReverseSearch()),this.lonLat=Object(sa.s)(e.coordinate,this.mapProjection,"EPSG:4326"),this.lastTimeoutRequest=setTimeout(()=>{this.onSearchCoordinate()},this.igoSearchPointerSummaryDelay)):this.clearLayer()}onSearchCoordinate(){this.pointerSearchStore.clear();const e=this.searchService.reverseSearch(this.lonLat,{params:{geometry:"false",icon:"false"}},!0);for(const t in e)e.length>0&&this.reverseSearch$$.push(e[t].request.subscribe(o=>{this.onSearch({research:e[t],results:o})}))}onSearch(e){const t=e.results,o=this.pointerSearchStore.all().filter(t=>t.source!==e.research.source).concat(t);this.pointerSearchStore.load(o)}addPointerOverlay(e){this.clearLayer();const t=new cn.e(Object(sa.s)(this.lonLat,"EPSG:4326",this.mapProjection)),o=new Da.a({geometry:t}),i=(new sn.a).writeGeometryObject(t,{featureProjection:this.mapProjection,dataProjection:this.mapProjection});this.store.setLayerFeatures([{type:Xc,geometry:i,projection:this.mapProjection,properties:{id:this.searchPointerSummaryFeatureId,pointerSummary:e},meta:{id:this.searchPointerSummaryFeatureId},ol:o}],el.None)}clearLayer(){this.store&&this.store.clearLayer()}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(Sl,2),Object(i.gc)(bm),Object(i.gc)(um),Object(i.gc)(be))},e.\u0275dir=Object(i.bc)({type:e,selectors:[["","igoSearchPointerSummary",""]],inputs:{igoSearchPointerSummaryDelay:"igoSearchPointerSummaryDelay",igoSearchPointerSummaryEnabled:"igoSearchPointerSummaryEnabled"}}),e})();function eb(e,t){return new Ra.Style({image:new Ra.Icon({src:"./assets/igo2/geo/icons/cross_black_18px.svg",imgSize:[18,18]}),text:new Ra.Text({text:e.get("pointerSummary"),textAlign:"left",textBaseline:"bottom",font:"12px Calibri,sans-serif",fill:new Ra.Fill({color:"#000"}),backgroundFill:new Ra.Fill({color:"rgba(255, 255, 255, 0.5)"}),backgroundStroke:new Ra.Stroke({color:"rgba(200, 200, 200, 0.75)",width:2}),stroke:new Ra.Stroke({color:"#fff",width:3}),overflow:!0,offsetX:10,offsetY:-10,padding:[2.5,2.5,2.5,2.5]})})}let tb=(()=>{class e{static forRoot(){return{ngModule:e,providers:[bm,{provide:um,useFactory:Bm,deps:[Yl]},{provide:qm,useFactory:Hm,deps:[le]},{provide:Km,useFactory:Qm,deps:[le]},{provide:Xm,useFactory:tg,deps:[le]}]}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,Fg,ag,Jg,Og],Fg,ag,Jg,Og]}),e})(),ob=(()=>{class e{constructor(e){this.cdRef=e,this.complete=new i.u,this.cancel=new i.u}onUpdateInputs(){this.cdRef.detectChanges()}onClose(){this.cancel.emit()}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(i.j))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-ogc-filter"]],inputs:{layer:"layer",map:"map"},outputs:{complete:"complete",cancel:"cancel"},decls:1,vars:3,consts:[["igoListItem","",3,"layer","header","map"]],template:function(e,t){1&e&&Object(i.hc)(0,"igo-ogc-filterable-item",0),2&e&&Object(i.Dc)("layer",t.layer)("header",!1)("map",t.map)},directives:[jh],styles:[""],changeDetection:0}),e})();const ib=new i.B("OgcFilterWidget");function rb(e){return e.create(ob)}function sb(){return{provide:ib,useFactory:rb,deps:[Cr]}}let ab=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,n.c,ie,Yh]]}),e})();class nb extends Mr{constructor(e){super(e),this.options=e,this.inResolutionRange$=new C.a(!0),this.map.viewController.resolution$.subscribe(e=>{this.inResolutionRange$.next(e>this.layer.minResolution&&e<this.layer.maxResolution)})}get layer(){return this.options.layer}get map(){return this.options.map}}let cb=(()=>{class e{constructor(e){this.storageService=e}get zoomAuto(){return this.storageService.get("zoomAuto")}createWorkspace(e,t){var o;if(!1===(null===(o=e.options.workspace)||void 0===o?void 0:o.enabled))return;e.options.workspace=Object.assign({},e.options.workspace,{enabled:!0,srcId:e.id,workspaceId:e.id});const i=new nb({id:e.id,title:e.title,layer:e,map:t,entityStore:this.createFeatureStore(e,t),actionStore:new ao([]),meta:{tableTemplate:void 0}});return this.createTableTemplate(i,e),i}createFeatureStore(e,t){const o=new al([],{map:t});o.bindLayer(e);const i=new ul({}),r=new nl({}),s=new cl({}),a=new ut({}),n=new hl({layer:new Wc({zIndex:300,source:new vc,style:void 0,showInLayerList:!1,exportable:!1,browsable:!1}),map:t,hitTolerance:15,motion:this.zoomAuto?el.Default:el.None,many:!0,dragBox:!0});return o.addStrategy(i,!0),o.addStrategy(r,!0),o.addStrategy(s,!0),o.addStrategy(n,!0),o.addStrategy(a,!1),o.addStrategy(this.createFilterInMapExtentOrResolutionStrategy(),!0),o}createTableTemplate(e,t){const o=t.dataSource.options.sourceFields||[];if(0===o.length)return void e.entityStore.entities$.pipe(Object(ta.a)(e=>0===e.length),Object(Me.a)(1)).subscribe(t=>{const o=t[0].ol.getKeys().filter(e=>!e.startsWith("_")&&"geometry"!==e&&e!==t[0].ol.getGeometryName()&&!e.match(/boundedby/gi)).map(e=>({name:"properties."+e,title:e,renderer:Qe.UnsanitizedHTML}));e.meta.tableTemplate={selection:!0,sort:!0,columns:o}});const i=o.map(e=>({name:"properties."+e.name,title:e.alias?e.alias:e.name,renderer:Qe.UnsanitizedHTML}));e.meta.tableTemplate={selection:!0,sort:!0,columns:i}}createFilterInMapExtentOrResolutionStrategy(){return new lt({filterClauseFunc:e=>!0===e.state.inMapExtent&&!0===e.state.inMapResolution})}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(Oe))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),lb=(()=>{class e{constructor(e,t){this.layerService=e,this.storageService=t}get zoomAuto(){return this.storageService.get("zoomAuto")}createWorkspace(e,t){var o,i,r,s,a,n;if(!0!==(null===(o=e.options.workspace)||void 0===o?void 0:o.enabled))return;const c=e.dataSource,l=e.id+".WmsWorkspaceTableSrc",u=e.id+".WfsWorkspaceTableDest";e.options.linkedLayers||(e.options.linkedLayers={linkId:l,links:[]});const d={bidirectionnal:!0,syncedDelete:!0,linkedIds:[u],properties:[qn.ZINDEX,qn.VISIBLE]};(null===(i=e.options.workspace)||void 0===i?void 0:i.minResolution)||d.properties.push(qn.MINRESOLUTION);let h=!1;(null===(r=c.options.ogcFilters)||void 0===r?void 0:r.enabled)&&(d.properties.push(qn.OGCFILTERS),h=!0),(null===(s=e.options.workspace)||void 0===s?void 0:s.maxResolution)||d.properties.push(qn.MAXRESOLUTION);let p,m=[];return e.options.linkedLayers.links&&(m=JSON.parse(JSON.stringify(e.options.linkedLayers.links))),m.push(d),e.options.linkedLayers.linkId=e.options.linkedLayers.linkId?e.options.linkedLayers.linkId:l,e.options.linkedLayers.links=m,this.layerService.createAsyncLayer({id:u,linkedLayers:{linkId:u},workspace:{srcId:e.id,workspaceId:void 0,enabled:!1},showInLayerList:!1,opacity:0,title:e.title,minResolution:(null===(a=e.options.workspace)||void 0===a?void 0:a.minResolution)||e.minResolution||0,maxResolution:(null===(n=e.options.workspace)||void 0===n?void 0:n.maxResolution)||e.maxResolution||1/0,sourceOptions:{download:c.options.download,type:"wfs",url:c.options.urlWfs||c.options.url,queryable:!0,queryTitle:c.options.queryTitle,params:c.options.paramsWFS,ogcFilters:Object.assign({},c.ogcFilters$.value,{enabled:h}),sourceFields:c.options.sourceFields||void 0}}).subscribe(o=>(t.addLayer(o),e.ol.setProperties({linkedLayers:{linkId:e.options.linkedLayers.linkId,links:m}},!1),o.dataSource.ol.refresh(),p=new nb({id:e.id,title:e.title,layer:o,map:t,entityStore:this.createFeatureStore(o,t),actionStore:new ao([]),meta:{tableTemplate:void 0}}),this.createTableTemplate(p,o),o.options.workspace.workspaceId=o.id,e.options.workspace=Object.assign({},e.options.workspace,{enabled:!0,srcId:e.id,workspaceId:o.id}),delete c.options.download,p)),p}createFeatureStore(e,t){const o=new al([],{map:t});o.bindLayer(e);const i=new ul({}),r=new nl({}),s=new cl({}),a=new ut({}),n=new hl({layer:new Wc({zIndex:300,source:new vc,style:void 0,showInLayerList:!1,exportable:!1,browsable:!1}),map:t,hitTolerance:15,motion:this.zoomAuto?el.Default:el.None,many:!0,dragBox:!0});return o.addStrategy(i,!0),o.addStrategy(r,!0),o.addStrategy(s,!0),o.addStrategy(n,!0),o.addStrategy(a,!1),o.addStrategy(this.createFilterInMapExtentOrResolutionStrategy(),!0),o}createTableTemplate(e,t){const o=t.dataSource.options.sourceFields||[];if(0===o.length)return void e.entityStore.entities$.pipe(Object(ta.a)(e=>0===e.length),Object(Me.a)(1)).subscribe(t=>{const o=t[0].ol.getKeys().filter(e=>!e.startsWith("_")&&"geometry"!==e&&e!==t[0].ol.getGeometryName()&&!e.match(/boundedby/gi)).map(e=>({name:"properties."+e,title:e,renderer:Qe.UnsanitizedHTML}));e.meta.tableTemplate={selection:!0,sort:!0,columns:o}});const i=o.map(e=>({name:"properties."+e.name,title:e.alias?e.alias:e.name,renderer:Qe.UnsanitizedHTML}));e.meta.tableTemplate={selection:!0,sort:!0,columns:i}}createFilterInMapExtentOrResolutionStrategy(){return new lt({filterClauseFunc:e=>!0===e.state.inMapExtent&&!0===e.state.inMapResolution})}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(Jc),Object(i.qc)(Oe))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class ub extends Mr{constructor(e){super(e),this.options=e,this.inResolutionRange$=new C.a(!0),this.map.viewController.resolution$.subscribe(e=>{this.inResolutionRange$.next(e>this.layer.minResolution&&e<this.layer.maxResolution)})}get layer(){return this.options.layer}get map(){return this.options.map}}let db=(()=>{class e{constructor(e){this.storageService=e}get zoomAuto(){return this.storageService.get("zoomAuto")}createWorkspace(e,t){var o;if(!1===(null===(o=e.options.workspace)||void 0===o?void 0:o.enabled))return;e.options.workspace=Object.assign({},e.options.workspace,{enabled:!0}),e.options.workspace=Object.assign({},e.options.workspace,{enabled:!0,srcId:e.id,workspaceId:e.id});const i=new ub({id:e.id,title:e.title,layer:e,map:t,entityStore:this.createFeatureStore(e,t),actionStore:new ao([]),meta:{tableTemplate:void 0}});return this.createTableTemplate(i,e),i}createFeatureStore(e,t){const o=new al([],{map:t});o.bindLayer(e);const i=new ul({}),r=new nl({}),s=new cl({}),a=new ut({}),n=new hl({layer:new Wc({zIndex:300,source:new vc,style:void 0,showInLayerList:!1,exportable:!1,browsable:!1}),map:t,hitTolerance:15,motion:this.zoomAuto?el.Default:el.None,many:!0,dragBox:!0});return o.addStrategy(i,!0),o.addStrategy(r,!0),o.addStrategy(s,!0),o.addStrategy(n,!0),o.addStrategy(a,!1),o.addStrategy(this.createFilterInMapExtentOrResolutionStrategy(),!0),o}createTableTemplate(e,t){const o=t.dataSource.options.sourceFields||[];if(0===o.length)return void e.entityStore.entities$.pipe(Object(ta.a)(e=>0===e.length),Object(Me.a)(1)).subscribe(t=>{const o=t[0].ol.getKeys().filter(e=>!e.startsWith("_")&&"geometry"!==e&&e!==t[0].ol.getGeometryName()&&!e.match(/boundedby/gi)).map(e=>({name:"properties."+e,title:e,renderer:Qe.UnsanitizedHTML}));e.meta.tableTemplate={selection:!0,sort:!0,columns:o}});const i=o.map(e=>({name:"properties."+e.name,title:e.alias?e.alias:e.name,renderer:Qe.UnsanitizedHTML}));e.meta.tableTemplate={selection:!0,sort:!0,columns:i}}createFilterInMapExtentOrResolutionStrategy(){return new lt({filterClauseFunc:e=>!0===e.state.inMapExtent&&!0===e.state.inMapResolution})}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(Oe))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),hb=(()=>{class e{constructor(e,t,o,i){this.component=e,this.wfsWorkspaceService=t,this.wmsWorkspaceService=o,this.featureWorkspaceService=i,this.entities$$=[]}get workspaceStore(){return this.component.store}ngOnInit(){this.layers$$=this.map.layers$.pipe(Object(S.a)(50)).subscribe(e=>this.onLayersChange(e))}ngOnDestroy(){this.layers$$.unsubscribe(),this.entities$$.map(e=>e.unsubscribe())}onLayersChange(e){const t=e.filter(e=>this.layerIsEditable(e)),o=t.map(e=>e.id),i=t.map(e=>this.getOrCreateWorkspace(e)).filter(e=>void 0!==e),r=this.workspaceStore.all().filter(e=>o.indexOf(e.id)<0);r.length>0&&(r.forEach(e=>{e.entityStore.deactivateStrategyOfType(nl),e.deactivate()}),this.workspaceStore.state.updateMany(r,{active:!1,selected:!1}),this.workspaceStore.deleteMany(r)),i.length>0&&this.workspaceStore.insertMany(i)}getOrCreateWorkspace(e){if(void 0===this.workspaceStore.get(e.id)){if(e.dataSource instanceof Sc)return this.wfsWorkspaceService.createWorkspace(e,this.map);if(e.dataSource instanceof uc){if(!e.dataSource.options.paramsWFS)return;const t=this.wmsWorkspaceService.createWorkspace(e,this.map);return null==t||t.inResolutionRange$.subscribe(o=>{e.dataSource.options.queryable=!o,t.layer.dataSource.options.queryable=o}),t}if(e.dataSource instanceof vc&&!0===e.exportable)return this.featureWorkspaceService.createWorkspace(e,this.map)}}layerIsEditable(e){var t,o;const i=e.dataSource;return i instanceof Sc||i instanceof vc||i instanceof uc&&((null===(t=(i.options||{}).ogcFilters)||void 0===t?void 0:t.enabled)||void 0!==(null===(o=i.options.paramsWFS)||void 0===o?void 0:o.featureTypes))}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(Ir),Object(i.gc)(cb),Object(i.gc)(lb),Object(i.gc)(db))},e.\u0275dir=Object(i.bc)({type:e,selectors:[["","igoWorkspaceSelector",""]],inputs:{map:"map"}}),e})(),pb=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c]]}),e})(),mb=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c]]}),e})(),gb=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},providers:[sb()],imports:[[m.c,Tr,pb,mb,ab],pb,mb,ab]}),e})();var bb=function(e){return e[e.GeoJSON=0]="GeoJSON",e[e.JSON=1]="JSON",e}({}),fb=function(e){return e.Route="Route",e.Trip="Trip",e}({});let yb=(()=>{class e extends fm{constructor(e,t){super(),this.http=e,this.config=t,this.directionsUrl="https://geoegl.msp.gouv.qc.ca/services/itineraire/route/v1/driving/",this.options=this.config.getConfig("directionsSources.osrm")||{},this.directionsUrl=this.options.url||this.directionsUrl}get enabled(){return!1!==this.options.enabled}set enabled(e){this.options.enabled=e}getName(){return e._name}route(e,t={}){const o=this.getRouteParams(t);return this.http.get(this.directionsUrl+e.join(";"),{params:o}).pipe(Object(j.a)(e=>this.extractRoutesData(e)))}extractRoutesData(e){const t=[];return e.routes.forEach(o=>{t.push(this.formatRoute(o,e.waypoints))}),t}getRouteParams(e={}){return e.alternatives=void 0===e.alternatives||e.alternatives,e.steps=void 0===e.steps||e.steps,e.geometries=void 0!==e.geometries?e.geometries:"geojson",e.overview=void 0!==e.overview&&e.overview,new y.g({fromObject:{alternatives:e.alternatives?"true":"false",overview:e.overview?"simplified":"full",steps:e.steps?"true":"false",geometries:e.geometries?e.geometries:"geojson"}})}formatRoute(t,o){const i=[];return t.legs.forEach(e=>{e.steps.forEach(e=>{i.push(e)})}),{id:z(),title:t.legs[0].summary,source:e._name,sourceType:fb.Route,order:1,format:bb.GeoJSON,icon:"directions",projection:"EPSG:4326",waypoints:o,distance:t.distance,duration:t.duration,geometry:t.geometry,legs:t.legs,steps:i,weight:t.weight,weight_name:t.weight_name}}}return e._name="OSRM Qu\xe9bec",e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(y.b),Object(i.qc)(K))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac}),e})();function Ob(e,t){return new yb(e,t)}let vb=(()=>{class e extends Yl{constructor(e,t,o,i){super(i,o),this.http=e,this.languageService=t}getId(){return e.id}getType(){return e.type}getDefaultOptions(){return{title:"Cadastre (Qu\xe9bec)",searchUrl:"https://carto.cptaq.gouv.qc.ca/php/find_lot_v1.php?"}}search(e,t){e=(e=(e=e.endsWith(",")?e.slice(0,-1):e).startsWith(",")?e.substr(1):e).replace(/ /g,"");const o=this.computeSearchRequestParams(e,t||{});return o.get("numero")&&o.get("numero").match(/^[0-9,]+$/g)?this.http.get(this.searchUrl,{params:o,responseType:"text"}).pipe(Object(j.a)(t=>this.extractResults(t,e))):Object(L.a)([])}computeSearchRequestParams(e,t){return new y.g({fromObject:Object.assign({numero:e,epsg:"4326"},this.params,t.params||{})})}extractResults(e,t){return e.split("<br />").filter(e=>e.length>0).map(e=>this.dataToResult(e,t))}dataToResult(e,t){const o=e.split(";"),i=o[0],r=this.computeGeometry(o[7]),s={NoLot:i,Route:'<span class="routing"> <u>'+this.languageService.translate.instant("igo.geo.seeRouting")+"</u> </span>"},a=[this.getId(),"cadastre",i].join(".");return{source:this,meta:{dataType:Xc,id:a,title:i,score:gm(t.trim(),i),icon:"map-marker"},data:{type:Xc,projection:"EPSG:4326",geometry:r,properties:s,meta:{id:a,title:i}}}}computeGeometry(e){const t=(new la.a).readFeature(e,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});return{type:t.getGeometry().getType(),coordinates:t.getGeometry().getCoordinates()}}}return e.id="cadastre",e.type=Xc,e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(y.b),Object(i.qc)(le),Object(i.qc)(Oe),Object(i.qc)("options"))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac}),e})();function jb(e,t,o,i){return new vb(e,t,o,i.getConfig("searchSources."+vb.id))}let wb=(()=>{class e extends Yl{constructor(e,t,o){super(t,o),this.http=e}getId(){return e.id}getType(){return e.type}getDefaultOptions(){return{title:"Nominatim (OSM)",searchUrl:"https://nominatim.openstreetmap.org/search",settings:[{type:"checkbox",title:"results type",name:"amenity",values:[{title:"igo.geo.search.nominatim.type.food",value:"bar,bbq,biergaten,cafe,drinking_water,fast_food,food_court,ice_cream,pub,restaurant",enabled:!1},{title:"igo.geo.search.nominatim.type.health",value:"baby_hatch,clinic,dentist,doctors,hospital,nursing_home,pharmacy,social_facility,veterinary",enabled:!1},{title:"igo.geo.search.nominatim.type.entertainment",value:"arts_centre,brothel,casino,cinema,community_center_fountain,gambling,nightclub,planetarium                           ,public_bookcase,social_centre,stripclub,studio,swingerclub,theatre,internet_cafe",enabled:!1},{title:"igo.geo.search.nominatim.type.finance",value:"atm,bank,bureau_de_change",enabled:!1}]},{type:"radiobutton",title:"results limit",name:"limit",values:[{title:"10",value:10,enabled:!0},{title:"20",value:20,enabled:!1},{title:"50",value:50,enabled:!1}]},{type:"radiobutton",title:"restrictExtent",name:"countrycodes",values:[{title:"igo.geo.search.nominatim.country.canada",value:"CA",enabled:!0},{title:"igo.geo.search.nominatim.country.all",value:null,enabled:!1}]},{type:"radiobutton",title:"multiple object",name:"dedupe",values:[{title:"igo.geo.search.searchSources.settings.true",value:0,enabled:!1},{title:"igo.geo.search.searchSources.settings.false",value:1,enabled:!0}]}]}}search(e,t){const o=this.computeSearchRequestParams(e,t||{});return o.get("q")?this.http.get(this.searchUrl,{params:o}).pipe(Object(j.a)(t=>this.extractResults(t,e))):Object(L.a)([])}computeSearchRequestParams(e,t){return new y.g({fromObject:Object.assign({q:this.computeTerm(e),format:"json"},this.params,t.params||{})})}extractResults(e,t){return e.map(e=>this.dataToResult(e,t))}dataToResult(e,t){const o=this.computeProperties(e),i=this.computeGeometry(e),r=this.computeExtent(e),s=[this.getId(),"place",e.place_id].join(".");return{source:this,meta:{dataType:Xc,id:s,title:e.display_name,icon:"map-marker",score:gm(t.trim(),e.display_name)},data:{type:Xc,projection:"EPSG:4326",geometry:i,extent:r,properties:o,meta:{id:s,title:e.display_name}}}}computeProperties(e){return{display_name:e.display_name,place_id:e.place_id,osm_type:e.osm_type,class:e.class,type:e.type}}computeGeometry(e){return{type:"Point",coordinates:[parseFloat(e.lon),parseFloat(e.lat)]}}computeExtent(e){return[parseFloat(e.boundingbox[2]),parseFloat(e.boundingbox[0]),parseFloat(e.boundingbox[3]),parseFloat(e.boundingbox[1])]}computeTerm(e){return this.computeTermTags(e)}computeTermTags(e){const t=super.getHashtagsValid(e,"amenity");return t?t.length?(e=e.replace(/(#[^\s]*)/g,""),t.forEach(t=>{e+="+["+t+"]"}),e):null:this.computeTermSettings(e)}computeTermSettings(e){return this.options.settings.forEach(t=>{"amenity"===t.name&&t.values.forEach(t=>{t.enabled&&"string"==typeof t.value&&t.value.split(",").forEach(t=>{e+="+["+t+"]"})})}),e}}return e.id="nominatim",e.type=Xc,e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(y.b),Object(i.qc)("options"),Object(i.qc)(Oe))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac}),e})();function Sb(e,t,o){return new wb(e,t.getConfig("searchSources."+wb.id),o)}let xb=(()=>{class e extends Yl{constructor(e,t,o,i){if(super(i,o),this.http=e,this.languageService=t,this.storedQueriesOptions=i,!this.storedQueriesOptions||this.storedQueriesOptions.available){if(this.storedQueriesOptions||(console.log(" No configuration for this search source (storedqueries). You will use the default values"),this.storedQueriesOptions={storedquery_id:"rtss",fields:[{name:"rtss",defaultValue:"-99"},{name:"chainage",defaultValue:"0",splitPrefix:"\\+"}],outputformat:"text/xml; subtype=gml/3.1.1",srsname:"EPSG:4326",resultTitle:"title"},this.resultTitle="title",console.log("Default values",this.storedQueriesOptions)),!this.storedQueriesOptions.storedquery_id)throw new Error('Stored Queries :You have to set "storedquery_id" into StoredQueries options. ex: storedquery_id: "nameofstoredquerie"');if(!this.storedQueriesOptions.fields)throw new Error('Stored Queries :You have to set "fields" into options. ex: fields: {"name": "rtss", "defaultValue": "-99"}');if(this.storedQueriesOptions.outputformat=this.storedQueriesOptions.outputformat||"text/xml; subtype=gml/3.1.1",this.storedQueriesOptions.srsname=this.storedQueriesOptions.srsname||"EPSG:4326",this.storedQueriesOptions.storedquery_id.toLowerCase().includes("getfeaturebyid")&&this.storedQueriesOptions.outputformat.toLowerCase().includes("getfeaturebyid")){let e="You must set a geojson format for your stored query. This is due to an openlayers issue)";throw e+=" (wfs 1.1.0 & gml 3.1.1 limitation)",new Error(e)}this.storedQueriesOptions.fields instanceof Array||(this.storedQueriesOptions.fields=[this.storedQueriesOptions.fields]),this.multipleFieldsQuery=this.storedQueriesOptions.fields.length>1,this.storedQueriesOptions.fields.forEach((e,t)=>{if(this.multipleFieldsQuery&&!e.splitPrefix&&0!==t)throw new Error("Stored Queries :You must set a field spliter into your field definition (optional for the first one!)");if(!e.defaultValue)throw new Error("Stored Queries :You must set a field default value into your field definition")}),this.storedQueriesOptions.resultTitle=this.storedQueriesOptions.resultTitle||this.resultTitle}}getId(){return e.id}getType(){return e.type}getDefaultOptions(){return{title:"Stored Queries",searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/ws/swtq"}}search(e,t){const o=this.termSplitter(e,this.storedQueriesOptions.fields),i=this.computeRequestParams(t||{},o);return null==this.options.params?this.options.params={page:"1"}:this.options.params.page=null!=t.page?String(t.page):"1",new RegExp(".*?gml.*?","i").test(this.storedQueriesOptions.outputformat)?this.http.get(this.searchUrl,{params:i,responseType:"text"}).pipe(Object(j.a)(t=>{let o=this.extractResults(this.extractWFSData(t),e);if(o.sort((e,t)=>e.meta.score>t.meta.score||e.meta.score===t.meta.score&&e.meta.titleHtml<t.meta.titleHtml?1:-1),o.reverse(),o.length>Number(this.options.params.limit)){const e=Number(this.options.params.limit)*Number(this.options.params.page),t=o.length;o=o.slice(0,e),o[o.length-1].meta.nextPage=e<t}return o})):this.http.get(this.searchUrl,{params:i}).pipe(Object(j.a)(t=>this.extractResults(this.extractWFSData(t),e)))}getFormatFromOptions(){let e;const t=this.storedQueriesOptions.outputformat,o=new RegExp(".*?gml.*?","i");return new RegExp(".*?json.*?","i").test(t)&&(e=ha.GeoJSON),o.test(t)&&(e=ha.WFS),new e}extractWFSData(e){const t=this.getFormatFromOptions(),o=ha.GeoJSON,i=t.readFeatures(e);return JSON.parse((new o).writeFeatures(i))}termSplitter(e,t){const o={};let i=e,r=0;return t.forEach(e=>{o[e.name]=e.defaultValue;const t=new RegExp(e.splitPrefix+"(.+)","i");t.test(i)&&(r=e.splitPrefix?r+=1:r,i=i.split(t)[1])}),0===r?(o[t[0].name]=e,o):(i=e,[...t].reverse().forEach(e=>{const t=new RegExp(e.splitPrefix||"(.+)","i");if(i||""!==i){const r=i.split(t);i=r[0],r[1]&&(o[e.name]=r[1].trim())}}),o)}computeRequestParams(e,t){const o=this.storedQueriesOptions.storedquery_id.toLowerCase().includes("getfeaturebyid")?"2.0.0":"1.1.0";return new y.g({fromObject:Object.assign({service:"wfs",version:o,request:"GetFeature",storedquery_id:this.storedQueriesOptions.storedquery_id,srsname:this.storedQueriesOptions.srsname,outputformat:this.storedQueriesOptions.outputformat},t,this.params,e.params||{})})}extractResults(e,t){return e.features.map(e=>this.dataToResult(e,t))}dataToResult(e,t){const o=this.computeProperties(e),i=[this.getId(),o.type,e.id].join("."),r=e.properties[this.storedQueriesOptions.resultTitle]?this.storedQueriesOptions.resultTitle:this.resultTitle;return{source:this,data:{type:Xc,projection:"EPSG:4326",geometry:e.geometry,properties:o,meta:{id:i,title:e.properties[r]}},meta:{dataType:Xc,id:i,title:e.properties.title,titleHtml:e.properties[r],icon:"map-marker",score:gm(t.trim(),e.properties.title?e.properties.title:e.properties[r])}}}computeProperties(t){return Object.assign({},E.removeKeys(t.properties,e.propertiesBlacklist),{Route:'<span class="routing"> <u>'+this.languageService.translate.instant("igo.geo.seeRouting")+"</u> </span>"})}}return e.id="storedqueries",e.type=Xc,e.propertiesBlacklist=["boundedBy","id","coord_x","coord_y"],e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(y.b),Object(i.qc)(le),Object(i.qc)(Oe),Object(i.qc)("options"))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac}),e})(),Cb=(()=>{class e extends Yl{constructor(e,t,o,i){if(super(i,o),this.http=e,this.languageService=t,this.storedQueriesOptions=i,this.storedQueriesOptions&&(!this.storedQueriesOptions||this.storedQueriesOptions.available)){if(!this.storedQueriesOptions.storedquery_id)throw new Error('Stored Queries :You have to set "storedquery_id" into StoredQueries options. ex: storedquery_id: "nameofstoredquerie"');if(!this.storedQueriesOptions.longField)throw new Error('Stored Queries :You have to set "longField" to map the longitude coordinate to the query params.');if(!this.storedQueriesOptions.latField)throw new Error('Stored Queries :You have to set "latField" to map the latitude coordinate to the query params.');this.storedQueriesOptions.outputformat=this.storedQueriesOptions.outputformat||"text/xml; subtype=gml/3.1.1",this.storedQueriesOptions.srsname=this.storedQueriesOptions.srsname||"EPSG:4326",this.storedQueriesOptions.resultTitle=this.storedQueriesOptions.resultTitle||this.resultTitle}}getId(){return e.id}getType(){return e.type}getDefaultOptions(){return{title:"Stored Queries (reverse)",searchUrl:"https://ws.mapserver.transports.gouv.qc.ca/swtq"}}reverseSearch(e,t){const o=this.computeRequestParams(e,t||{});return new RegExp(".*?gml.*?","i").test(this.storedQueriesOptions.outputformat)?this.http.get(this.searchUrl,{params:o,responseType:"text"}).pipe(Object(j.a)(e=>this.extractResults(this.extractWFSData(e)))):this.http.get(this.searchUrl,{params:o}).pipe(Object(j.a)(e=>this.extractResults(this.extractWFSData(e))))}getFormatFromOptions(){let e;const t=this.storedQueriesOptions.outputformat,o=new RegExp(".*?gml.*?","i");return new RegExp(".*?json.*?","i").test(t)&&(e=ha.GeoJSON),o.test(t)&&(e=ha.WFS),new e}extractWFSData(e){const t=this.getFormatFromOptions(),o=ha.GeoJSON,i=t.readFeatures(e);return JSON.parse((new o).writeFeatures(i))}computeRequestParams(e,t){const o={};return o[this.storedQueriesOptions.longField]=e[0],o[this.storedQueriesOptions.latField]=e[1],new y.g({fromObject:Object.assign({service:"WFS",version:"1.1.0",request:"GetFeature",storedquery_id:this.storedQueriesOptions.storedquery_id,srsname:this.storedQueriesOptions.srsname,outputformat:this.storedQueriesOptions.outputformat},o,this.params,t.params||{})})}extractResults(e){return e.features.map(e=>this.dataToResult(e))}dataToResult(e){const t=this.computeProperties(e),o=[this.getId(),t.type,e.id].join("."),i=e.properties[this.storedQueriesOptions.resultTitle]?this.storedQueriesOptions.resultTitle:this.resultTitle;return{source:this,data:{type:Xc,projection:"EPSG:4326",geometry:e.geometry,properties:t,meta:{id:o,title:e.properties[i]}},meta:{dataType:Xc,id:o,title:e.properties[i],icon:"map-marker"}}}computeProperties(t){const o=E.removeKeys(t.properties,e.propertiesBlacklist),i={Route:'<span class="routing"> <u>'+this.languageService.translate.instant("igo.geo.seeRouting")+"</u> </span>"};return Object.assign(o,{type:t.properties.doc_type},i)}}return e.id="storedqueriesreverse",e.type=Xc,e.propertiesBlacklist=[],e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(y.b),Object(i.qc)(le),Object(i.qc)(Oe),Object(i.qc)("options"))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac}),e})();function Tb(e,t,o,i){return new xb(e,t,o,i.getConfig("searchSources."+xb.id))}function Lb(e,t,o,i){return new Cb(e,t,o,i.getConfig("searchSources."+Cb.id))}function Ib(e){return e.entityStore.getStrategyOfType(lt).active$.pipe(Object(j.a)(e=>e?"igo.geo.workspace.inMapExtent.active.tooltip":"igo.geo.workspace.inMapExtent.inactive.tooltip"))}function Fb(e){return e.entityStore.stateView.manyBy$(e=>!0===e.state.selected).pipe(Object(j.a)(e=>e.length>=1))}function Mb(e,t){if(1&e&&(i.mc(0,"p"),i.ad(1),i.lc()),2&e){const e=i.xc();i.Tb(1),i.bd(e.pointerCoord)}}const kb=p.e.forChild([{path:"simple-map",component:(()=>{class e{constructor(e,t,o,i){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.mediaService=i,this.pointerCoordDelay=0,this.map=new vl({controls:{attribution:{collapsed:!0},scaleLine:!0}}),this.view={center:[-73,47.2],zoom:6,rotation:.75},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e}))})}get media(){return this.mediaService.getMedia()}get isTouchScreen(){return this.mediaService.isTouchScreen()}onPointerMove(e){this.pointerCoord=e}}return e.\u0275fac=function(t){return new(t||e)(i.gc(le),i.gc(qc),i.gc(Jc),i.gc(be))},e.\u0275cmp=i.ac({type:e,selectors:[["app-simple-map"]],decls:18,vars:8,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/simple-map"],["igoPointerPosition","",3,"map","view","pointerPositionDelay","pointerPositionCoord"],["color","primary",3,"map"],["color","primary",3,"map","showIfNoRotation"],[4,"ngIf"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Geo"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Simple Map"),i.lc(),i.mc(5,"mat-card-content"),i.mc(6,"li"),i.ad(7,"Dependencies: LanguageService"),i.lc(),i.hc(8,"br"),i.ad(9," See the "),i.mc(10,"a",0),i.ad(11,"code of this example"),i.lc(),i.hc(12,"hr"),i.lc(),i.mc(13,"igo-map-browser",1),i.tc("pointerPositionCoord",(function(e){return t.onPointerMove(e)})),i.hc(14,"igo-zoom-button",2),i.hc(15,"igo-geolocate-button",2),i.hc(16,"igo-rotation-button",3),i.lc(),i.lc(),i.Yc(17,Mb,2,1,"p",4)),2&e&&(i.Tb(13),i.Dc("map",t.map)("view",t.view)("pointerPositionDelay",t.pointerCoordDelay),i.Tb(1),i.Dc("map",t.map),i.Tb(1),i.Dc("map",t.map),i.Tb(1),i.Dc("map",t.map)("showIfNoRotation",!0),i.Tb(1),i.Dc("ngIf",!t.isTouchScreen))},directives:[g.a,g.e,g.f,g.c,Sl,xl,Il,Fl,Dl,m.t],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}"]}),e})()}]);let Db=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[m.c,kb,g.d,n.c,Bp]]}),e})();function Pb(e,t){if(1&e&&(i.hc(0,"igo-metadata-button",6),i.hc(1,"igo-download-button",6),i.hc(2,"igo-ogc-filter-button",7),i.hc(3,"igo-time-filter-button",7),i.hc(4,"igo-track-feature-button",8)),2&e){const e=t.layer;i.Dc("layer",e),i.Tb(1),i.Dc("layer",e),i.Tb(1),i.Dc("header",!0)("layer",e),i.Tb(1),i.Dc("header",!0)("layer",e),i.Tb(1),i.Dc("layer",e)("trackFeature",!0)}}const Ab=p.e.forChild([{path:"layer",component:(()=>{class e{constructor(e,t,o){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.map=new vl({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:7},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",visible:!0,baseLayer:!0,source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"shp"},ogcFilters:{enabled:!0,editable:!0,filters:{operator:"PropertyIsEqualTo",propertyName:"code_municipalite",expression:"10043"}}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"WFS ",visible:!0,source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:"geojson_utf8",srsName:"EPSG:32198",outputFormatDownload:"shp"},ogcFilters:{enabled:!0,editable:!0,filters:{operator:"PropertyIsEqualTo",propertyName:"code_municipalite",expression:"12072"}},formatOptions:{dataProjection:"EPSG:32198"}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"WFS (Custom EPSG)",visible:!0,source:e,removable:!1}))}),this.layerService.createAsyncLayer({sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"MELS_CS_ANGLO_S",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"R\xe9seau routier",visible:!1,sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/swtq",params:{LAYERS:"bgr_v_sous_route_res_sup_act",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"lieu habit\xe9",visible:!1,sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/swtq",optionsFromCapabilities:!0,params:{LAYERS:"lieuhabite",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"sh_dis_eco",visible:!1,sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/mffpecofor.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"sh_dis_eco",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"nurc:Arc_Sample_Parent",visible:!1,legendOptions:{display:!0,stylesAvailable:[{name:"rain",title:"Pluie"},{name:"raster",title:"D\xe9faut"}]},sourceOptions:{type:"wms",url:"https://demo.geo-solutions.it/geoserver/ows",optionsFromCapabilities:!0,params:{LAYERS:"nurc:Arc_Sample",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"Avertissements routier",visible:!1,sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/swtq",params:{LAYERS:"evenements",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",refreshIntervalSec:15,params:{LAYERS:"vg_observation_v_inondation_embacle_wmst",VERSION:"1.3.0"}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle",source:e,metadata:{url:"https://www.donneesquebec.ca/recherche/fr/dataset/historique-publique-d-embacles-repertories-au-msp",extern:!0}}))})}}return e.\u0275fac=function(t){return new(t||e)(i.gc(le),i.gc(qc),i.gc(Jc))},e.\u0275cmp=i.ac({type:e,selectors:[["app-layer"]],decls:19,vars:7,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/layer"],[3,"map","view"],["color","primary",3,"map"],["title","Layers"],["floatLabel","never",3,"map","layers","expandLegendOfVisibleLayers","queryBadge"],["igoLayerItemToolbar",""],[3,"layer"],[3,"header","layer"],[3,"layer","trackFeature"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Geo"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Simple Map"),i.lc(),i.mc(5,"mat-card-content"),i.mc(6,"li"),i.ad(7,"Dependencies: LanguageService"),i.lc(),i.hc(8,"br"),i.ad(9," See the "),i.mc(10,"a",0),i.ad(11,"code of this example"),i.lc(),i.hc(12,"hr"),i.lc(),i.mc(13,"igo-map-browser",1),i.hc(14,"igo-zoom-button",2),i.lc(),i.mc(15,"igo-panel",3),i.mc(16,"igo-layer-list",4),i.Yc(17,Pb,5,8,"ng-template",null,5,i.Zc),i.lc(),i.lc(),i.lc()),2&e&&(i.Tb(13),i.Dc("map",t.map)("view",t.view),i.Tb(1),i.Dc("map",t.map),i.Tb(2),i.Dc("map",t.map)("layers",t.map.layers)("expandLegendOfVisibleLayers",!1)("queryBadge",!0))},directives:[g.a,g.e,g.f,g.c,Sl,Il,_i,fu,fc,Qu,Lh,nh,Fu],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),e})()}]);let $b=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[Ab,g.d,n.c,c.b,zi,Bp,Mu,Yh,Oc,Ju]]}),e})();const Eb=p.e.forChild([{path:"legend",component:(()=>{class e{constructor(e,t,o){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.map=new vl({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:7},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",visible:!0,baseLayer:!0,source:e}))}),this.layerService.createAsyncLayer({title:"legend with display:false",visible:!0,legendOptions:{display:!1,html:"test html"},sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/mffpecofor.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"sh_dis_eco",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"legend in html",visible:!0,legendOptions:{display:!0,html:"<h2>HTML l\xe9gende</h2>"},sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/mffpecofor.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"sh_sreg_eco",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"legend with url param",visible:!0,legendOptions:{url:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxASEhUQEBISFRUVFRAQFRUQFRUVFRAPFRUWFhUVFRUYHSggGBolGxUVITEiJSkrLi4uFx8zODMsNygtLisBCgoKDg0OGhAQGy0dHyUtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tKy0tLS0tLS0tLf/AABEIAKgBLAMBIgACEQEDEQH/xAAbAAABBQEBAAAAAAAAAAAAAAACAQMEBQYAB//EADwQAAIBAwEGAwYFAgUEAwAAAAECAAMEESEFEjFBUWETInEGFDKBkaFCscHR8FJyFSNTYoIzQ5LxFqLh/8QAGQEAAwEBAQAAAAAAAAAAAAAAAAECAwQF/8QAJREBAQACAgEFAAEFAAAAAAAAAAECERIhAwQTMUFRYRQiI3Gh/9oADAMBAAIRAxEAPwB0QhAEMTFQhCEEQhACEIQRFEYEIQgiEIAU6IIsAWLEnQAp0KmBqSdFBY+g5D1OBGD4nxYBHQafQzLPzTDLVbYeHLObh2LARwwyD+4PQiFNJZZuMrLLqlnRJ0ZFiTp0A6KEOM4OITuF8q4L8ydVp9sc2+0atrlw/hVGLBw2MnO66gsMdBpjHeYZeoxmXGOjH0+Vx5UsSLEm7ndEM6IYAhgmEYJgCGCYRgmIBMEwjAJgAmAYRgkwAGjTxxjGniBipGo5UjcAthCEAGEIwMQhAEIGAHFEERcxgYiiBmEDADzFgAxcwA50HMXMANh5H/tA+rrJhXy8JDXJDAcSpx6jB/SE18u6uuhGnqeU4vPP8m7+PR9N34tT9V20FZD4ifMcmHSSra5V1DKdD9Qeh7yLd1d4HAOJm7W9q27NlWKE55cOozzleLLTPz4b7bPM7MrbXbC1AFRQGb4d84OemP17Rk7YYsUREJUn8XxhfjI7gzp5xyXGrjMj3l5uYVfjYeX/AGrzb15D5mRau0N0Bt3e3uAVhoO56ympms1Z6lTtgaaDHAdgBiZZ+Tc1G3i8fe60FsN0AZ1iLUzXpDTRifqpHGVh2ioGMP8AIQtm3G9WUdmbX+04nNw3Y7+Wsb/peRJ0Qz0HkOMQzokQcTBM4xCYBxgGKTBJgCEwTFJgEwBCYBMUmCTABaMvHGMacxGZeNw3jUCWwMIGNAwgYwdBhAxoGEDAHAYQMbBigwBzMIGNAwgYA4DFzGwYWYwPMXMbzCBgD1PjxxylRUuEpv4J0PDXPx9BLNDrI17bMtd2PmVgrNngHwNdZzeeTqur02dm4RquAWK4A111yOxme2tXZicaAcuZGf3/ADl7UrFtRwA68x69jM/eVGffZcBkyxA0bdAGZHjna/Jl0pKdJmuFUN8A3ufyA+UGz3jVABIOWBOez5z05fWSrxs0qV2g1DbrY/pJAx35H6yMoxWDjhq2Ou8Dp/5GdDmBYsy7yF87rnGpx/NZfWd4yrg65JGeJHM6SjpjcthUK+apUI7glifyMnUKhV9zPH4vpjT7yMpteF0tL6qwAK6j0zr6x72YY1HLlQNwNnHMnQfrIyVAujHThx0lt7MhQKqjj5W/46iRjO42zyvG6XGYhMSJmdLjdmITOJgkwBSYJMQmITAOJgkziYJMA4mATOJgEwDiYBM4mATAOYxpzCJjTGIG3MbzFcwMwCzBhAxpQekPdPSPVLcOAwgYzgxd6GjPAwsxkNFDQB7MUNGhnpDCGPVLcOAxQY3unpFzA9nQYoMaBhAxBO2bS3qijvk+g1kXbFVqlY0qWAB56jHn0EnbPfw1ZzngeExu3L2qRu0iVNVtWGclQPyyZz+T+7LTfx9Y7XdfaNvRQh2ydFAXBJY6AADhrjjMlW2jRSqCyVFLb2vlO8uobKjQj9oT2lMUmpHILbp8TGSHU6b2OIzIVwtVt1moFmUEK9IhlI7a9esMJB5Ll9L1dnqLUCk29TJJ05KSfuAT9BK/w/PpodBwGdOGny9NInsrfstSpQq+UMDuqdd0jj+hkg4Fbf5Zzj7Qm5bKq9yWHLq1QUEeqd1UffAxx5LpzPDSU9G/pl2dKTnd0YlgCfly4R72huHqV6dKjhgi4wdBvEfY6SOthUGfFZKYbG8KZLVHA5Y5SsZNdoz3vpate0agXdyuQG3X4gH85P8AZ2p4dfdfmCgP+08P0lNcW3jDK090IMIc6jHAd47sWuxanv8AEFR8wZOuul7beoMEiBmFVyTnrGjmdHbmKTBJiZnYgCExCYpWAYg4mAWiEwC0AItAJiFoBaAKTAJiFoJMA5jGnMJjG2gDTmDmKwMHBhomsFsI4trLJLaP07aepxjjtqmNn2jbWA6TRi1gNbCK4Y0TLJnvch0hrZdpc+COkcShJ4YnyyVVOzjwtO0tVoiOCkJWoXalNnANl2l74U4UIaxPtRe59oq2faXvgTnTAJ0+gkZSKm2M9pK2F8NSQeOnT9pQJbFqbVq9ZRpujGm4O2ect/amoynLZ3dfh00PUzMW9AK2uMH4S3mHbAPOeLbvderJrUO+IHXcRqjqOBekx9QGUg4+RjKW1VGyhK9cAjP/ABM0lihGFqPT64Ua/wD1kza9gXVGViMHOFpv59eBMmZ96O4xjaNBxVNTdw7ndXPEA8TIj3JBPE68wdZtKeyvGTB31ZSSrqGTB5EZOT85namyqu97rk+Lx8TAx4e98Weu7p1zNMcti46VtrSZnFRR5hkH04D6ayStlU1YAknJydSPU/WaB9jigoCbxYnLMys28Txzidsy2KKcsxzyKFQO2WzFzK4M8XXIR9/e0KsWA83TdXQQrOo6VlBXy7+8OfHiJZ7QsS2rboA1UhRnI4a6SHswO9dd4g6jkVOnYiPG7icpp6LTtwVB7RDajpBt78DRvvH/AH1ZvPPYxvilR/dlne7iSPGUwHdYf1U/C9j+TDWwgGzzHGrATkuR1mmPqML8xN8GU+Ki1LDtGv8ADzLujWUyQKAM6Zhhe3PblOmaNlBNjNT7oOkZqW4j9vEuVZr3CC1oJoDbxipZw4Q+VULUBGzb9polsIZsBF7cHJmPdD0ie5zTe4RPcu0qeKJudaJbacaMaW9ne9TH3m3tnRTMUWxMKjWllQIMfvUe3FctnFNsZdLTE40BF7lPhFL7tE92ls9CR3oGL3aOEREoR8W8NaZEdEPdo4REa2kPaFLdQky33pA2yM0mHaTl5bqqmE2yF8ErJgg4xxI4ntnjMc9N0yppgINTUYjyjkWc8PQYlvR2luVGSrndUgZ6k8FH3k7aNrTqqoqaLxWmuSSepxr+vpPPn8uxmLFwrb9Niyg6u5O4D0A+Jzrw9Jq7C/p1BuFjjucHeHHOD3GnLnrpMnteg4ICEBVyCyjSmnMKvXlnnnAwDqxb3wUhcYxhDg5wF1K/fB6lm7StS9lu/bf+5Mo8gU548vrxMpG2NW8fxd8cMbpXQjP1kKx2zcAZVsjjg8DrJr+0tXnTXPDOsXU+D+Vi1uxH+YFUDnnOR+kp9pbVpou4nDUZ46+n8/SQ7zaNWpjeY45gcBKa+vV1GBk/U6/nz/8AcJjunbqHql+w1NUlTwHEHtrofQiFb3qrh38nJQOHqU5fKV1FN3LvjH9J4N0P84QqVJqzg/g7jgOhmmmdu2pvr1t1cZ1Gc/hP04SGu2WQ7rR2nWVk3AVwowN7OCZn9s13yKemBqMYixm+itaVdtA8DJ9ttANznm4uWXnLSy2lgZzDLx/gmbZ3lbTIMrqN6d7GZWU9rqeJkb3vLgrFMP1VybaxdidJorJmHGUGwwzAEiX7XAAwY/H5ssPhOfjmS0R1Mbq0hK1nIGQY5bXe8NTOvH1Eyc98OkoUYnu8RLgR9amZtM2dxAtvOahJIEBjK5xPFEqUwJBeprJt3UAEzdzdeY6zPLzaOePbcps9e0L/AA4dJW09o1BxWSKe1+oM5OUdXE89liAodYX+KrOF6hj5wcTyXhHGODaYkZipgG3Uw5jinC/U84a3APOVhsl6wDa9GMXKjiuBVWGMGUPgVOTSXRFQcY5kNLTwRIm0LfyH0MEXbDiI1dbSBUiPotMNtawR8OOKZO7nAL/zny5a6jF3l/cU3L587ZHDRKY00HLJ4dh3mr2lvhjVpkFMtvr1A79ZE8ajcDBAD8xzHQZ+k5rdNpNswdsOiDxBlm1HLGuhx24/MSDUuVxvU9NBkdcgZ/naX+1dj7zDGCNEHYAfw/OUd7sKoDoDz4fQSsbiLMg0L9eRZTofLwJ5nEsVvSQMEHn007zPvs6qOXI4wOcdt7e4A3TqOGvDMu4xPKrK8r1GGE0zrK0lE1Ygtr9ZEqUq+8QoYZ5dPST9mbHz56p0HIx6khbtqRs62asByAz5Tkj+cZZ3VZKaGjTxvt9usgXF+f8Ap0RjGBnkO8C2UJlmbLccnv0zJ190966iws3VFwQGxqe31lZcMu8TjGekds7nVmYZz5cc4l5bEciM8MjEufKag3FvkZWQDvLLClX3TumSXtlaVtOlNTZidJodhW53gWjFCgqydZVSGzIzvS8Me29s75KaY5yBd7Wzw+0qQ5PGMuxBnJa6pjFqu1anDlJFLaeBrKRq2kAVsysUZRa0/aDdfBOk0uydso/AzynajkHIh7P2g9MhgSJ1Y7nbmuq9sN0McZWXe1FHEiZq22m1ZNG+kS22O1U5ZjD3h7azvdrKRoZlbi5JYnM1dD2YTmWPzjh2BRGm4PpJ7vdPUnw0NGgx+IYhtbCW7UpFqWy88iGhtULa68ZKS1XtHfcFJyHM6tZNyePUG3NZ9DGXsao+FozVsq/4XEVLW6/1F+kWv4Dmo3A6GMV2uRwUH5yZv3K8d0wm2qy/HSPy1ho0K2vao+ND8pY09rrzBHqIFLbFBtOB7x2rbpUGVIilB9b6mw4iQ7w02U4xwMYr7PbGglXWsXXJ1Eq5CRQ1qLGk3hnO4xGP9szW6lQgklH+IngSM66GW3+IFC6qMgtu4P4uWgme2xc+bygZGpI7Hh9dJGrs9xOb3mm3HfGOXEAc+8JNsgndIKnkCMcOEpBt5kwTjQa4568B9oR21Tc+dRoQo7aZOvpF7d+4rnPqr1LpSQB3PXGRgfpGGZs4ABGn01IP86SppIh1QkajTPLOknWTMjEE59f6c4+uknjpUy2kJqx0Hy5aZlZtO6GoB04a8AeklOzZYKJQ3jK2jNjtLwxRlkb97J8qDA4EnnOe4Pwrr8v3nF6IGCfl1hU95x/lKFX+o8Zqz2KgAmrnXiB0mh9/NWhlk0XTMzFeg40G8x68pK2O1Viafhs2RoADmFn2UokUE4IkqpSKiC9AqcEFSDqDxEnOuV1itVIrLepvHEuLeljUyBQoYOZNNWZZ1rhE4NOqtI9N51SpMuDbloDVI2z44Rlt5jhQT/aM/lJFLZF2w0oVPmMfnNJGWWSDdJvSFd6LiXjez17/AKLfMr+8hXexrofFRf5YP5TWVjew+z+0igmq2f7UAYXHGU+xvZhviqndHTnLC62Va6qr+YDkRmZZZY29LmOWu24ttpBlGCIFVWJ4mZT2c2dVQ5Z/T0mqLGLnvo+Om4DwWAPKMLCDTfbLTmtUPLEaOzRyJj2/6wg8Ogrq+yHPwuZCqbGuR8NQ/OX+8YYc9fyhqBl22Rd/6sae0vV/Eh9QZqKtZxwUn+3EHxcjJRvprFYcrJVEqf8AdoBu6a/Yxmnof8moyH+ipn9ZsPBzqAV9RKu+2dVbiiOv0Mjirki2ntCVIS4XHLe5H5y2uHpumQRqJm721qoMeE7pzUgkj+085SJfvRPlLGm3JshkPTBi3Z8nqX4RtpWtKmlR6jYPiNu4x5RMlV2Z4qnwgxUebI54zgA8M/vNPV2OtxVFWuc0qYyFzoWJzrJVrWp1AapA8FDu00XgzD8Rx3hy0VxYil7NVCm8FJAIAAGdSAePPlIdXZaqPMCOJJweWh/Oenrf1ar+HTUIAN9ieRI8oA689eEZuEWoDSuAjZ47vlA7b2fN8oTy/o4fjzZaCqcjTHCPVr8annqPUHj+8l7Z2HUouSgLodQVGcfIcJR1mA0PPryM11Kjek6zqkNkNnXnKe8phqrdznEstnWdWq2KSlsfTHrNLsj2URH8W4IJ4hAeJ7mFymI1az+yNg75B0A5F8y7q0UoEK64HBWOCra6AGLta7u97IUIg0AQ4wO3IwrfaAqLuVNQ2hBBAJ7f0kdpF3e1TU6NeDSqkKh3W6/hbtkcD2jaq1u281XXBwFVgQegbGD9Yxf7JqU8VKJ38fhPxYGvz/PSS6hS5okjRlBOD8SkcQecc/4VDWvKdUZyS3VskyOwPIymt3K1N09cazTWNMtooLHoNZVx0UyRKNJzyku12RVqHyAn0ms2T7Lu2GqkAdBrNTQtqNEYAGn84CRdLlrIbO9i3YDxHx2XUy+tfY61p6shc/7tf/yWr7RxooP/AIn8sSK+0UY+YVVPZTg/XSLo7s74NOmMU6aL6LGffQ3lzg+kYN1RByXYf8WB9eOPtHqN5bVPxjPDJGDJCsudpVkbcYadeokG6vqg83FTx04TV07ZOJdHXln9JL8OnjAVT2wBCSj4YY12chcZzoMSds72NtUqeNVyznXU6D5cJqVorn/poMcMYMSuBzXP7R446K3Y1taOBhRpwkKvbrn4BCNUE+Rs9uYjqk8xH0O04Oen3hmQaVxHQ8pKauOs7HeRd4wlJ6wCSSP/AFBL9MxsRcmAPo/Uzt8dzGgIYWMONbtAas3yhPpIdZzHsaSTV7/eMXNJXGHVWHRgD+cbWqOAEcCdY52FTfbCouhRVZAcE+G3T1z9pSXexqlNadOnh0Vt473kxrkZHMCbMiRquDpJuMPahegtOmFGMsxZyPxdsyjvL2lTfKrvMRrnXHp0mpvLEOMA4lDtL2WqMd5GGnUcfpMbhdtJlNKOl7TVN4gBR2lXdWdC8rA1PIx0O7oGMXbOzqlFt90I5EjUGVlglZ6quadUIuSCqnX7TTDH7ic7GztLBLVXRMKgAJJ1Zmmd2rdMy75JGuF5GOUPfXfd3SygkgucEjlkTrzYl61QOyAqOQPOTwvLsTKadTu2NMipwA4HnGNneEy7yjUHjnOnTEtP/itzVQhmCZ+ZxFs/YitSXcVxgnU45RzHorlNoV9cimA3MlcfvHqQtCQ7O9NyDnChlIP9XD85p7T2ctwAKi75HNjmHfez1vU0A3ca+XT6yuPSeW2HX2cUtvU7iiykg+clGHyOn3m02PbW9BQDUTqSGBLH5cpW3fskRqnm7DQ/aV52Qy6MHHqTC205I2F17UUlG7SBbvwEz9z7Q12/Hx5KMYjVts4D8DH6mFb7IqbxCocciREfR+32rWHmZyf1k239oXPHQyPU2DXOuAOgzGDs9wQCsCae020rDDYj1SiG1plfRgCJkLi2qLjcU9TLjZVZ9CYocy0sjQdf+zSz/tHGLb+Lzor8s/vJi3MJLnJ0jvRy7O0Cw/CAPU/vHDUx3iUzn4sQXccBHpBqqik7w0PUfr1jxRzqpGO/WNEQPFxwMVitomHzHkqHrEnQkI5TrmOi4nTpRDW5jouDOnRmIV2jq3ESdFQJ68YJJnToASkLqZFr7S1wonTobBErMRrG3M6dEAKxkynV0nTowi3Qpt8QBi0FpcAonToEbr2VPO9gQhTUjAnTpROWniGyTp0ZK+uwBgb/AEE6dIqofpEwy4X4hn1nToqccbxQMhRH7a7zyAnToYlXVq0ZVA3ETp0mnB1LVcaxilQXOAIk6HxSSjSAEra+8moiTppZuJnRy3vAeJklWXOQZ06R8KO+IesBlnTo7Q//2Q=="},sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/mffpecofor.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"sh_reg_eco",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"shp"},ogcFilters:{enabled:!0,editable:!0,filters:{operator:"PropertyIsEqualTo",propertyName:"code_municipalite",expression:"10043"}}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"WFS ",visible:!0,source:e}))}),this.layerService.createAsyncLayer({sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"MELS_CS_ANGLO_S",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"R\xe9seau routier",visible:!1,sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/swtq",params:{LAYERS:"bgr_v_sous_route_res_sup_act",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"lieu habit\xe9",visible:!1,sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/swtq",optionsFromCapabilities:!0,params:{LAYERS:"lieuhabite",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"2 styles nurc:Arc_Sample_Parent",visible:!0,legendOptions:{display:!0,stylesAvailable:[{name:"rain",title:"Pluie"},{name:"raster",title:"D\xe9faut"}]},sourceOptions:{type:"wms",url:"https://demo.geo-solutions.it/geoserver/ows",optionsFromCapabilities:!0,params:{LAYERS:"nurc:Arc_Sample",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"Avertissements routier",visible:!1,sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/swtq",params:{LAYERS:"evenements",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",refreshIntervalSec:15,params:{LAYERS:"vg_observation_v_inondation_embacle_wmst",VERSION:"1.3.0"}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle",visible:!0,source:e,metadata:{url:"https://www.donneesquebec.ca/recherche/fr/dataset/historique-publique-d-embacles-repertories-au-msp",extern:!0}}))})}}return e.\u0275fac=function(t){return new(t||e)(i.gc(le),i.gc(qc),i.gc(Jc))},e.\u0275cmp=i.ac({type:e,selectors:[["app-legend"]],decls:17,vars:8,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/layer"],[3,"map","view"],["color","primary",3,"map"],["title","Legends"],[3,"layers","excludeBaseLayers","allowShowAllLegends","updateLegendOnResolutionChange","showAllLegendsValue"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Geo"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Simple Map with a legend list"),i.lc(),i.mc(5,"mat-card-content"),i.mc(6,"li"),i.ad(7,"Dependencies: LanguageService"),i.lc(),i.hc(8,"br"),i.ad(9," See the "),i.mc(10,"a",0),i.ad(11,"code of this example"),i.lc(),i.hc(12,"hr"),i.lc(),i.mc(13,"igo-map-browser",1),i.hc(14,"igo-zoom-button",2),i.lc(),i.mc(15,"igo-panel",3),i.hc(16,"igo-layer-legend-list",4),i.lc(),i.lc()),2&e&&(i.Tb(13),i.Dc("map",t.map)("view",t.view),i.Tb(1),i.Dc("map",t.map),i.Tb(2),i.Dc("layers",t.map.layers)("excludeBaseLayers",!0)("allowShowAllLegends",!0)("updateLegendOnResolutionChange",!1)("showAllLegendsValue",!1))},directives:[g.a,g.e,g.f,g.c,Sl,Il,_i,Lu],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),e})()}]);let Rb=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[Eb,g.d,n.c,c.b,zi,Bp,Mu,Yh,Oc,Ju]]}),e})();const _b=p.e.forChild([{path:"overlay",component:(()=>{class e{constructor(e,t,o){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.map=new vl({overlay:!0,controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:6}}ngOnInit(){this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e}))})}ngAfterViewInit(){this.map.overlay.setFeatures([{type:Xc,projection:"EPSG:4326",meta:{id:1},properties:{},geometry:{type:"Point",coordinates:[-73,46.6]}},{type:Xc,projection:"EPSG:4326",meta:{id:2},properties:{},geometry:{type:"LineString",coordinates:[[-72,47.8],[-73.5,47.4],[-72.4,48.6]]}},{type:Xc,projection:"EPSG:4326",meta:{id:3},properties:{},geometry:{type:"Polygon",coordinates:[[[-71,46.8],[-73,47],[-71.2,46.6]]]}}],el.None)}}return e.\u0275fac=function(t){return new(t||e)(i.gc(le),i.gc(qc),i.gc(Jc))},e.\u0275cmp=i.ac({type:e,selectors:[["app-overlay"]],decls:15,vars:3,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/overlay"],[3,"map","view"],["color","primary",3,"map"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Geo"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Overlay"),i.lc(),i.mc(5,"mat-card-content"),i.mc(6,"li"),i.ad(7,"Dependencies: LanguageService"),i.lc(),i.hc(8,"br"),i.ad(9," See the "),i.mc(10,"a",0),i.ad(11,"code of this example"),i.lc(),i.hc(12,"hr"),i.lc(),i.mc(13,"igo-map-browser",1),i.hc(14,"igo-zoom-button",2),i.lc(),i.lc()),2&e&&(i.Tb(13),i.Dc("map",t.map)("view",t.view),i.Tb(1),i.Dc("map",t.map))},directives:[g.a,g.e,g.f,g.c,Sl,Il],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}"]}),e})()}]);let zb=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[_b,g.d,n.c,Bp,Yp]]}),e})();function Nb(e,t){if(1&e){const e=i.nc();i.mc(0,"igo-form",4),i.tc("submitForm",(function(t){return i.Nc(e),i.xc().onSubmit(t)})),i.yc(1,"async"),i.hc(2,"igo-form-group",5),i.mc(3,"div",6),i.mc(4,"button",7),i.tc("click",(function(){return i.Nc(e),i.xc().fillForm()})),i.ad(5," Fill Form "),i.lc(),i.mc(6,"button",7),i.tc("click",(function(){return i.Nc(e),i.xc().clearForm()})),i.ad(7," Clear Form "),i.lc(),i.mc(8,"button",8),i.ad(9," Submit "),i.lc(),i.lc(),i.lc()}if(2&e){const e=t.ngIf,o=i.xc();i.Dc("form",e)("formData",i.zc(1,4,o.data$)),i.Tb(2),i.Dc("group",e.groups[0]),i.Tb(6),i.Dc("disabled",o.submitDisabled)}}const Bb=p.e.forChild([{path:"geometry",component:(()=>{class e{constructor(e,t,o,i){this.languageService=e,this.formService=t,this.dataSourceService=o,this.layerService=i,this.map=new vl({controls:{attribution:{collapsed:!0},scaleLine:!0}}),this.view={center:[-73,47.2],zoom:15},this.form$=new C.a(void 0),this.data$=new C.a(void 0),this.submitDisabled=!0}ngOnInit(){this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e}))});const e=[{name:"geometry",title:"Geometry",options:{validator:Ue.G.required},type:"geometry",inputs:{map:this.map,geometryTypeField:!0,geometryType:"Polygon",drawGuideField:!0,drawGuide:50,drawGuidePlaceholder:"Draw Guide",drawStyle:new Ra.Style({stroke:new Ra.Stroke({color:[255,0,0,1],width:2}),fill:new Ra.Fill({color:[255,0,0,.2]}),image:new Ra.Circle({radius:8,stroke:new Ra.Stroke({color:[255,0,0,1]}),fill:new Ra.Fill({color:[255,0,0,.2]})})})}},{name:"name",title:"Name",options:{validator:Ue.G.required}}].map(e=>this.formService.field(e)),t=this.formService.form([],[this.formService.group({name:"info"},e)]);this.valueChanges$$=t.control.valueChanges.subscribe(()=>{this.submitDisabled=!t.control.valid}),this.form$.next(t)}ngOnDestroy(){this.valueChanges$$.unsubscribe()}fillForm(){this.data$.next({name:"Place",geometry:JSON.stringify({type:"Polygon",coordinates:[[[-106,42],[-107,31],[-81,32],[-82,42],[-106,42]]]})})}clearForm(){this.form$.value.control.reset()}onSubmit(e){alert(JSON.stringify(e))}}return e.\u0275fac=function(t){return new(t||e)(i.gc(le),i.gc(ri),i.gc(qc),i.gc(Jc))},e.\u0275cmp=i.ac({type:e,selectors:[["app-geometry"]],decls:13,vars:6,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/form"],[3,"map","view"],["color","primary",3,"map"],[3,"form","formData","submitForm",4,"ngIf"],[3,"form","formData","submitForm"],[3,"group"],["formButtons",""],["mat-stroked-button","","type","button","color","primary",3,"click"],["mat-flat-button","","type","submit","color","primary",3,"disabled"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Geo"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Geometry Form"),i.lc(),i.mc(5,"mat-card-content"),i.ad(6," See the "),i.mc(7,"a",0),i.ad(8,"code of this example"),i.lc(),i.lc(),i.mc(9,"igo-map-browser",1),i.hc(10,"igo-zoom-button",2),i.lc(),i.Yc(11,Nb,10,6,"igo-form",3),i.yc(12,"async"),i.lc()),2&e&&(i.Tb(9),i.Dc("map",t.map)("view",t.view),i.Tb(1),i.Dc("map",t.map),i.Tb(1),i.Dc("ngIf",i.zc(12,4,t.form$)))},directives:[g.a,g.e,g.f,g.c,Sl,Il,m.t,ti,hi,n.b],pipes:[m.b],styles:["code[_ngcontent-%COMP%], pre[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}igo-map-browser[_ngcontent-%COMP%]{width:500px;height:500px}"]}),e})()}]);let qb=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[m.c,Bb,n.c,g.d,mi,ih,Bp]]}),e})();const Gb=p.e.forChild([{path:"feature",component:(()=>{class e{constructor(e,t,o){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.map=new vl({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:6},this.tableTemplate={selection:!0,selectMany:!0,sort:!0,columns:[{name:"properties.id",title:"ID"},{name:"properties.name",title:"Name"},{name:"properties.description",title:"Description"}]},this.store=new al([],{map:this.map})}ngOnInit(){const e=new ll({});this.store.addStrategy(e);const t=new hl({map:this.map,motion:el.Default});this.store.addStrategy(t),this.store.load([{meta:{id:1},type:"Feature",geometry:{type:"Point",coordinates:[-72,47.8]},projection:"EPSG:4326",properties:{id:1,name:"Name 1",description:"Description 1"}},{meta:{id:2},type:"Feature",geometry:{type:"LineString",coordinates:[[-72,47.8],[-73.5,47.4],[-72.4,48.6]]},projection:"EPSG:4326",properties:{id:2,name:"Name 2",description:"Description 2"}},{meta:{id:3},type:"Feature",geometry:{type:"Polygon",coordinates:[[[-71,46.8],[-73,47],[-71.2,46.6]]]},projection:"EPSG:4326",properties:{id:3,name:"Name 3",description:"Description 3"}}]),this.layerService.createAsyncLayer({title:"MVT test",visible:!0,sourceOptions:{type:"mvt",url:"https://ahocevar.com/geoserver/gwc/service/tms/1.0.0/ne:ne_10m_admin_0_countries@EPSG:900913@pbf/{z}/{x}/{-y}.pbf",queryable:!0},mapboxStyle:{url:"assets/mapboxStyleExample-vectortile.json",source:"ahocevar"}}).subscribe(e=>this.map.addLayer(e)),this.dataSourceService.createAsyncDataSource({type:"vector"}).subscribe(o=>{const i=this.layerService.createLayer({title:"Vector Layer",source:o,animation:{duration:2e3},mapboxStyle:{url:"assets/mapboxStyleExample-feature.json",source:"source_nameX"}});this.map.addLayer(i),this.store.bindLayer(i),e.activate(),t.activate()})}ngOnDestroy(){this.store.destroy()}}return e.\u0275fac=function(t){return new(t||e)(i.gc(le),i.gc(qc),i.gc(Jc))},e.\u0275cmp=i.ac({type:e,selectors:[["app-feature"]],decls:12,vars:5,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geom/feature"],[3,"map","view"],["color","primary",3,"map"],[3,"store","template"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Geo"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Feature"),i.lc(),i.mc(5,"mat-card-content"),i.ad(6," See the "),i.mc(7,"a",0),i.ad(8,"code of this example"),i.lc(),i.lc(),i.mc(9,"igo-map-browser",1),i.hc(10,"igo-zoom-button",2),i.lc(),i.hc(11,"igo-entity-table",3),i.lc()),2&e&&(i.Tb(9),i.Dc("map",t.map)("view",t.view),i.Tb(1),i.Dc("map",t.map),i.Tb(1),i.Dc("store",t.store)("template",t.tableTemplate))},directives:[g.a,g.e,g.f,g.c,Sl,Il,ro],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),e})()}]);let Vb=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[Gb,m.c,g.d,n.c,c.b,zi,Oi,Bp,Zd]]}),e})();const Ub=p.e.forChild([{path:"hover",component:(()=>{class e{constructor(e,t,o,i){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.mediaService=i,this.pointerCoordDelay=0,this.pointerHoverFeatureDelay=0,this.map=new vl({controls:{attribution:{collapsed:!0},scaleLine:!0}}),this.view={center:[-73,47.2],zoom:8,projection:"EPSG:3857"},this.dataSourceService.createAsyncDataSource({type:"wmts",url:"https://geoegl.msp.gouv.qc.ca/carto/wmts/1.0.0/wmts",layer:"carte_gouv_qc_public",matrixSet:"EPSG_3857",version:"1.3.0"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Quebec",visible:!0,baseLayer:!0,source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/ws/igo_gouvouvert.fcgi",params:{featureTypes:"adn_bassin_n1_public_v",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"3.0.0",outputFormat:void 0,outputFormatDownload:"shp"}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"WFS (polygon)",visible:!0,source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/ws/igo_gouvouvert.fcgi",params:{featureTypes:"CASERNE",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"3.0.0",outputFormat:void 0,outputFormatDownload:"shp"}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"WFS (point)",visible:!0,source:e,styleByAttribute:{attribute:"en_caserne",data:["true","false"],stroke:["red","blue"],fill:["#ffffff","#ffffff"],radius:[7,7],width:[2,2],hoverStyle:{label:{attribute:"Caserne: ${nom_service_incendie}\xa0\n Mun: ${ville}",style:{textAlign:"left",textBaseline:"bottom",font:"12px Calibri,sans-serif",fill:{color:"#000"},backgroundFill:{color:"rgba(255, 255, 255, 0.5)"},backgroundStroke:{color:"rgba(200, 200, 200, 0.75)",width:2},stroke:{color:"#fff",width:3},overflow:!0,offsetX:10,offsetY:-10,padding:[2.5,2.5,2.5,2.5]}},baseStyle:{circle:{stroke:{color:"orange",width:5},width:[5],radius:15}}}}}))})}get media(){return this.mediaService.getMedia()}get isTouchScreen(){return this.mediaService.isTouchScreen()}}return e.\u0275fac=function(t){return new(t||e)(i.gc(le),i.gc(qc),i.gc(Jc),i.gc(be))},e.\u0275cmp=i.ac({type:e,selectors:[["app-hover"]],decls:17,vars:8,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/hover"],["igoHoverFeature","",3,"map","view","igoHoverFeatureDelay","igoHoverFeatureEnabled"],["color","primary",3,"map"],["color","primary",3,"map","showIfNoRotation"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Geo"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Hover"),i.lc(),i.mc(5,"mat-card-content"),i.mc(6,"li"),i.ad(7,"Dependencies: LanguageService"),i.lc(),i.hc(8,"br"),i.ad(9," See the "),i.mc(10,"a",0),i.ad(11,"code of this example"),i.lc(),i.hc(12,"hr"),i.lc(),i.mc(13,"igo-map-browser",1),i.hc(14,"igo-zoom-button",2),i.hc(15,"igo-geolocate-button",2),i.hc(16,"igo-rotation-button",3),i.lc(),i.lc()),2&e&&(i.Tb(13),i.Dc("map",t.map)("view",t.view)("igoHoverFeatureDelay",t.pointerHoverFeatureDelay)("igoHoverFeatureEnabled",!0),i.Tb(1),i.Dc("map",t.map),i.Tb(1),i.Dc("map",t.map),i.Tb(1),i.Dc("map",t.map)("showIfNoRotation",!0))},directives:[g.a,g.e,g.f,g.c,Sl,Cl,Il,Fl,Dl],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:500px}"]}),e})()}]);let Hb=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[m.c,Ub,g.d,n.c,Bp]]}),e})();const Yb=p.e.forChild([{path:"measure",component:(()=>{class e{constructor(e,t,o){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.map=new vl({controls:{attribution:{collapsed:!0},scaleLine:!0}}),this.view={center:[-73,47.2],zoom:6,projection:"EPSG:3857"},this.store=new al([],{map:this.map}),this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e}))})}}return e.\u0275fac=function(t){return new(t||e)(i.gc(le),i.gc(qc),i.gc(Jc))},e.\u0275cmp=i.ac({type:e,selectors:[["app-measure"]],decls:16,vars:5,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/measure"],[3,"map","view"],["color","primary",3,"map"],[3,"store","map"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Geo"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Simple Map"),i.lc(),i.mc(5,"mat-card-content"),i.mc(6,"li"),i.ad(7,"Dependencies: LanguageService"),i.lc(),i.hc(8,"br"),i.ad(9," See the "),i.mc(10,"a",0),i.ad(11,"code of this example"),i.lc(),i.hc(12,"hr"),i.lc(),i.mc(13,"igo-map-browser",1),i.hc(14,"igo-zoom-button",2),i.lc(),i.hc(15,"igo-measurer",3),i.lc()),2&e&&(i.Tb(13),i.Dc("map",t.map)("view",t.view),i.Tb(1),i.Dc("map",t.map),i.Tb(1),i.Dc("store",t.store)("map",t.map))},directives:[g.a,g.e,g.f,g.c,Sl,Il,th],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-measurer[_ngcontent-%COMP%]     mat-divider{position:inherit!important;left:inherit!important;width:160px!important}"]}),e})()}]);let Wb=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[Yb,g.d,Bp,Gp]]}),e})();const Kb=p.e.forChild([{path:"draw",component:(()=>{class e{constructor(e,t,o){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.map=new vl({controls:{attribution:{collapsed:!0},scaleLine:!0}}),this.view={center:[-73,47.2],zoom:6,projection:"EPSG:3857"},this.store=new al([],{map:this.map}),this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e}))})}}return e.\u0275fac=function(t){return new(t||e)(i.gc(le),i.gc(qc),i.gc(Jc))},e.\u0275cmp=i.ac({type:e,selectors:[["app-draw"]],decls:16,vars:5,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/draw"],[3,"map","view"],["color","primary",3,"map"],[3,"store","map"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Geo"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Simple Map"),i.lc(),i.mc(5,"mat-card-content"),i.mc(6,"li"),i.ad(7,"Dependencies: LanguageService"),i.lc(),i.hc(8,"br"),i.ad(9," See the "),i.mc(10,"a",0),i.ad(11,"code of this example"),i.lc(),i.hc(12,"hr"),i.lc(),i.mc(13,"igo-map-browser",1),i.hc(14,"igo-zoom-button",2),i.lc(),i.hc(15,"igo-draw",3),i.lc()),2&e&&(i.Tb(13),i.Dc("map",t.map)("view",t.view),i.Tb(1),i.Dc("map",t.map),i.Tb(1),i.Dc("store",t.store)("map",t.map))},directives:[g.a,g.e,g.f,g.c,Sl,Il,Hd],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-draw[_ngcontent-%COMP%]     mat-divider{position:inherit!important;left:inherit!important;width:160px!important}"]}),e})()}]);let Zb=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[Kb,g.d,Bp,Yd]]}),e})();function Qb(e,t){if(1&e&&(i.kc(0),i.mc(1,"h1"),i.ad(2,"Query Title : "),i.mc(3,"span",5),i.ad(4),i.lc(),i.lc(),i.hc(5,"igo-feature-details",6),i.jc()),2&e){const e=t.ngIf,o=i.xc();i.Tb(4),i.bd(o.getTitle(e)),i.Tb(1),i.Dc("feature",e)}}const Jb=p.e.forChild([{path:"query",component:(()=>{class e{constructor(e,t,o,i){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.overlayService=i,this.feature$=new C.a(void 0),this.map=new vl({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:6},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/swtq",queryable:!0,queryTitle:"num_rts",params:{layers:"bgr_v_sous_route_res_sup_act",version:"1.3.0"}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"WMS",source:e,sourceOptions:e.options}))}),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/swtq",queryable:!0,queryFormat:ic.HTMLGML2,queryHtmlTarget:sc.IFRAME,params:{layers:"bgr_v_sous_route_res_sup_act",version:"1.3.0"}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"WMS html with a pre call in GML",source:e,sourceOptions:e.options}))}),this.dataSourceService.createAsyncDataSource({type:"vector",queryable:!0,queryTitle:"So beautiful ${name}",sourceFields:[{name:"name",alias:"Alias name"},{name:"description",alias:"Alias description"}]}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Vector Layer",source:e,sourceOptions:e.options})),this.addFeatures(e)})}addFeatures(e){const t=new Da.a({name:"feature1",geometry:new rn.a([sa.s([-72,47.8],"EPSG:4326","EPSG:3857"),sa.s([-73.5,47.4],"EPSG:4326","EPSG:3857"),sa.s([-72.4,48.6],"EPSG:4326","EPSG:3857")])}),o=new Da.a({name:"feature2",geometry:new on.a(sa.s([-73,46.6],"EPSG:4326","EPSG:3857"))}),i=new Da.a({name:"feature3",geometry:new tn.b([[sa.s([-71,46.8],"EPSG:4326","EPSG:3857"),sa.s([-73,47],"EPSG:4326","EPSG:3857"),sa.s([-71.2,46.6],"EPSG:4326","EPSG:3857")]])});e.ol.addFeatures([t,o,i])}handleQueryResults(e){const t=e.features;let o;t.length&&(o=t[0]),this.feature$.next(o),this.map.queryResultsOverlay.setFeatures([o],el.None)}getTitle(e){return ot(e)}}return e.\u0275fac=function(t){return new(t||e)(i.gc(le),i.gc(qc),i.gc(Jc),i.gc(Up))},e.\u0275cmp=i.ac({type:e,selectors:[["app-query"]],decls:18,vars:7,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/query"],["igoOverlay","","igoQuery","",3,"map","view","queryFeatures","query"],["color","primary",3,"map"],["title","Details"],[4,"ngIf"],[2,"background-color","#e0e0e0"],[3,"feature"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Geo"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Query"),i.lc(),i.mc(5,"mat-card-content"),i.mc(6,"li"),i.ad(7,"Dependencies: LanguageService"),i.lc(),i.hc(8,"br"),i.ad(9," See the "),i.mc(10,"a",0),i.ad(11,"code of this example"),i.lc(),i.hc(12,"hr"),i.lc(),i.mc(13,"igo-map-browser",1),i.tc("query",(function(e){return t.handleQueryResults(e)})),i.hc(14,"igo-zoom-button",2),i.lc(),i.mc(15,"igo-panel",3),i.Yc(16,Qb,6,2,"ng-container",4),i.yc(17,"async"),i.lc(),i.lc()),2&e&&(i.Tb(13),i.Dc("map",t.map)("view",t.view)("queryFeatures",!0),i.Tb(1),i.Dc("map",t.map),i.Tb(2),i.Dc("ngIf",i.zc(17,5,t.feature$)))},directives:[g.a,g.e,g.f,g.c,Sl,Hp,Hl,Il,_i,m.t,ud],pipes:[m.b],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),e})()}]);let Xb=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[Jb,m.c,g.d,n.c,c.b,zi,Bp,Yp,lm,Zd]]}),e})();const ef=p.e.forChild([{path:"catalog",component:(()=>{class e{constructor(e,t,o,i,r){this.configService=e,this.languageService=t,this.layerService=o,this.catalogService=i,this.storageService=r,this.map=new vl({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:7},this.catalogStore=new at([]),this.catalogItemStore=new at([])}ngOnInit(){this.layerService.createAsyncLayer({title:"OSM",sourceOptions:{type:"osm"}}).subscribe(e=>this.map.addLayer(e)),this.loadCatalogs()}onCatalogSelectChange(e){this.loadCatalogItems(e.catalog)}loadCatalogs(){this.catalogService.loadCatalogs().subscribe(e=>{this.catalogStore.clear(),this.catalogStore.load(e.concat(this.storageService.get("addedCatalogs")||[]))})}loadCatalogItems(e){this.catalogService.loadCatalogItems(e).subscribe(e=>{this.catalogItemStore.clear(),this.catalogItemStore.load(e)})}}return e.\u0275fac=function(t){return new(t||e)(i.gc(K),i.gc(le),i.gc(Jc),i.gc(Ql),i.gc(Oe))},e.\u0275cmp=i.ac({type:e,selectors:[["app-catalog"]],decls:23,vars:6,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/catalog"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/environments"],[3,"map","view"],["color","primary",3,"map"],["title","Catalog Library"],[3,"store","catalogSelectChange"],["title","Catalog Browser"],[3,"store","map"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Geo"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Catalog"),i.lc(),i.mc(5,"mat-card-content"),i.mc(6,"li"),i.ad(7,"Dependencies: ConfigService, LanguageService"),i.lc(),i.hc(8,"br"),i.ad(9," See the "),i.mc(10,"a",0),i.ad(11,"code of this example"),i.lc(),i.hc(12,"br"),i.ad(13," See catalog section of the "),i.mc(14,"a",1),i.ad(15," environment config"),i.lc(),i.hc(16,"hr"),i.lc(),i.mc(17,"igo-map-browser",2),i.hc(18,"igo-zoom-button",3),i.lc(),i.mc(19,"igo-panel",4),i.mc(20,"igo-catalog-library",5),i.tc("catalogSelectChange",(function(e){return t.onCatalogSelectChange(e)})),i.lc(),i.lc(),i.mc(21,"igo-panel",6),i.hc(22,"igo-catalog-browser",7),i.lc(),i.lc()),2&e&&(i.Tb(17),i.Dc("map",t.map)("view",t.view),i.Tb(1),i.Dc("map",t.map),i.Tb(2),i.Dc("store",t.catalogStore),i.Tb(2),i.Dc("store",t.catalogItemStore)("map",t.map))},directives:[g.a,g.e,g.f,g.c,Sl,Il,_i,Bu,tu],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}"]}),e})()}]);let tf=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},providers:[Q({default:r.igo})],imports:[[m.c,ef,g.d,n.c,c.b,h.b,X,zi,Bp,Gu]]}),e})();var of=o("p9/F");Error;var rf=function(e){return e[e.null=0]="null",e[e.read=1]="read",e[e.write=2]="write",e}({});let sf=(()=>{class e{constructor(e,t,o,i,r,s){this.http=e,this.authService=t,this.languageService=o,this.config=i,this.messageService=r,this.route=s,this.context$=new C.a(void 0),this.contexts$=new C.a({ours:[]}),this.defaultContextId$=new C.a(void 0),this.editedContext$=new C.a(void 0),this.importedContext=[],this.toolsChanged$=new k.a,this.mapViewFromRoute={},this.options=Object.assign({basePath:"contexts",contextListFile:"_contexts.json",defaultContextUri:"_default"},this.config.getConfig("context")),this.baseUrl=this.options.url,this.readParamsFromRoute(),this.authService.hasAuthService?this.authService.logged$.subscribe(e=>{e&&(this.contexts$.pipe(Object(Le.a)(1),Object(Xs.a)()).subscribe(e=>{this.handleContextsChange()}),this.loadContexts())}):(this.loadContexts(),this.handleContextsChange(!1))}get defaultContextUri(){return this._defaultContextUri||this.options.defaultContextUri}set defaultContextUri(e){this._defaultContextUri=e}get(e,t){let o=this.baseUrl+"/contexts";return e&&this.authService.authenticated&&(o+="?permission="+e.join(),t&&(o+="&hidden=true")),this.http.get(o)}getById(e){return this.http.get(this.baseUrl+"/contexts/"+e)}getDetails(e){return this.http.get(`${this.baseUrl}/contexts/${e}/details`).pipe(Object(v.a)(t=>this.handleError(t,e)))}getDefault(){return this.http.get(this.baseUrl+"/contexts/default").pipe(Object(w.a)(e=>{this.defaultContextId$.next(e.id)}))}getProfilByUser(){return this.baseUrl?this.http.get(this.baseUrl+"/profils?"):Object(L.a)([])}setDefault(e){return this.http.post(this.baseUrl+"/contexts/default",{defaultContextId:e})}hideContext(e){return this.http.post(this.baseUrl+"/contexts/"+e+"/hide",{})}showContext(e){return this.http.post(this.baseUrl+"/contexts/"+e+"/show",{})}delete(e,t=!1){const o={ours:[]};return Object.keys(this.contexts$.value).forEach(t=>o[t]=this.contexts$.value[t].filter(t=>t.id!==e)),t?(this.importedContext=this.importedContext.filter(t=>t.id!==e),Object(L.a)(this.contexts$.next(o))):this.http.delete(this.baseUrl+"/contexts/"+e).pipe(Object(w.a)(e=>{this.contexts$.next(o)}))}create(e){return this.http.post(this.baseUrl+"/contexts",e).pipe(Object(j.a)(e=>(e.permission=this.authService.authenticated?rf[rf.write]:rf[rf.read],this.contexts$.value.ours.unshift(e),this.contexts$.next(this.contexts$.value),e)))}clone(e,t={}){return this.http.post(this.baseUrl+"/contexts/"+e+"/clone",t).pipe(Object(j.a)(e=>(e.permission=rf[rf.write],this.contexts$.value.ours.unshift(e),this.contexts$.next(this.contexts$.value),e)))}update(e,t){return this.http.patch(this.baseUrl+"/contexts/"+e,t)}addToolAssociation(e,t){return this.http.post(`${this.baseUrl}/contexts/${e}/tools`,{toolId:t})}deleteToolAssociation(e,t){return this.http.delete(`${this.baseUrl}/contexts/${e}/tools/${t}`)}getPermissions(e){return this.http.get(this.baseUrl+"/contexts/"+e+"/permissions")}addPermissionAssociation(e,t,o){return this.http.post(`${this.baseUrl}/contexts/${e}/permissions`,{profil:t,typePermission:o}).pipe(Object(v.a)(e=>[this.handleError(e,void 0,!0)]))}deletePermissionAssociation(e,t){return this.http.delete(`${this.baseUrl}/contexts/${e}/permissions/${t}`)}getLocalContexts(){const e=this.getPath(this.options.contextListFile);return this.http.get(e).pipe(Object(j.a)(e=>({ours:e})))}getLocalContext(e){const t=this.getPath(e+".json");return this.http.get(t).pipe(Object(oa.a)(t=>{if(!t.base)return Object(L.a)(t);const o=this.getPath(t.base+".json");return this.http.get(o).pipe(Object(j.a)(e=>{const o=t;return o.map=E.mergeDeep(e.map,t.map),o.layers=(e.layers||[]).concat(t.layers||[]).reverse().filter((e,t,o)=>!e.id||o.findIndex(t=>t.id===e.id)===t).reverse(),o.toolbar=t.toolbar||e.toolbar,o.message=t.message||e.message,o.tools=(t.tools||[]).concat(e.tools||[]).filter((e,t,o)=>o.findIndex(t=>t.name===e.name)===t),o}),Object(v.a)(t=>this.handleError(t,e)))}),Object(v.a)(t=>this.handleError(t,e)))}loadContexts(e,t){let o;o=this.baseUrl?this.get(e,t):this.getLocalContexts(),o.subscribe(e=>{e.ours=this.importedContext.concat(e.ours),this.contexts$.next(e)})}loadDefaultContext(){const e=(e=!1)=>{!e&&this.baseUrl&&this.authService.authenticated?this.getDefault().subscribe(e=>{this.defaultContextUri=e.uri,this.addContextToList(e),this.setContext(e)},()=>{this.defaultContextId$.next(void 0),this.loadContext(this.defaultContextUri)}):this.loadContext(this.defaultContextUri)};this.route&&this.route.options.contextKey?this.route.queryParams.pipe(Object(S.a)(100)).subscribe(t=>{const o=t[this.route.options.contextKey];let i=!1;o&&(this.defaultContextUri=o,i=!0),e(i)}):e()}loadContext(e){const t=this.context$.value;t&&t.uri===e||this.getContextByUri(e).pipe(Object(Xs.a)()).subscribe(e=>{this.addContextToList(e),this.setContext(e)},t=>{e!==this.options.defaultContextUri&&this.loadContext(this.options.defaultContextUri)})}setContext(e){this.handleContextMessage(e);const t=this.context$.value;if(t&&e&&e.id===t.id)return void 0===e.map.view.keepCurrentView&&(e.map.view.keepCurrentView=!0),void this.context$.next(e);e.map||(e.map={view:{}}),Object.assign(e.map.view,this.mapViewFromRoute),this.context$.next(e)}loadEditedContext(e){this.getContextByUri(e).subscribe(e=>{this.setEditedContext(e)})}setEditedContext(e){this.editedContext$.next(e)}getContextFromMap(e,t){const o=e.ol.getView(),i=o.getProjection().getCode(),r=new on.a(o.getCenter()).transform(i,"EPSG:4326"),s={uri:z(),title:"",scope:"private",map:{view:{center:r.getCoordinates(),zoom:o.getZoom(),projection:i,maxZoomOnExtent:e.viewController.maxZoomOnExtent}},layers:[],tools:[]};let a=[];a=!0===t?e.layers$.getValue().filter(e=>!0===e.baseLayer||"searchPointerSummaryId"===e.options.id).sort((e,t)=>e.zIndex-t.zIndex):e.layers$.getValue().sort((e,t)=>e.zIndex-t.zIndex);let n=0;for(const c of a){const e=c,t={id:e.options.id?String(e.options.id):void 0,layerOptions:{title:e.options.title,zIndex:++n,visible:e.visible},sourceOptions:{type:e.dataSource.options.type,params:e.dataSource.options.params,url:e.dataSource.options.url,queryable:e.queryable}};t.sourceOptions.type&&s.layers.push(t)}return s.tools=this.tools.map(e=>({id:String(e.id),global:e.global})),s}getContextFromLayers(e,t,o){const i=this.context$.getValue(),r=e.ol.getView(),s=r.getProjection().getCode(),a={uri:o,title:o,map:{view:{center:new on.a(r.getCenter()).transform(s,"EPSG:4326").getCoordinates(),zoom:r.getZoom(),projection:s}},layers:[],toolbar:[],tools:[],extraFeatures:[]},n=e.layers$.getValue();return a.layers=n.filter(e=>e.baseLayer).map(e=>({baseLayer:!0,sourceOptions:e.options.sourceOptions,title:e.options.title,visible:e.visible})),t.forEach(e=>{const t=i.layers.find(t=>e.id===t.source.id&&!t.baseLayer);if(t){let o=t.style;t.styleByAttribute?o=void 0:t.clusterBaseStyle&&(o=void 0,delete t.sourceOptions.source,delete t.sourceOptions.format),a.layers.push({baseLayer:t.baseLayer,title:e.options.title,zIndex:e.zIndex,styleByAttribute:t.styleByAttribute,clusterBaseStyle:t.clusterBaseStyle,style:o,clusterParam:t.clusterParam,visible:e.visible,opacity:e.opacity,sourceOptions:t.sourceOptions})}else if("VECTOR"!==e.ol.type){const t=e.options;t.zIndex=e.zIndex,delete t.source,a.layers.push(t)}else{let t;const o=new sn.a;t=e.ol.getSource()instanceof $a.a?o.writeFeatures(e.ol.getSource().getSource().getFeatures(),{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"}):o.writeFeatures(e.ol.getSource().getFeatures(),{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"}),t=JSON.parse(t),t.name=e.options.title,a.extraFeatures.push(t)}}),a.toolbar=this.toolbar,a.tools=this.tools,a}setTools(e){this.tools=e}setToolbar(e){this.toolbar=e}handleContextMessage(e){this.contextMessage&&this.messageService.remove(this.contextMessage.id);const t=e.message;t&&(t.title=t.title?this.languageService.translate.instant(t.title):void 0,t.text=t.text?this.languageService.translate.instant(t.text):void 0,this.messageService.message(t))}getContextByUri(e){if(this.baseUrl){let t;for(const o of Object.keys(this.contexts$.value))if(t=this.contexts$.value[o].find(t=>t.uri===e),t)break;return t&&t.imported?Object(L.a)(t):this.getDetails(t?t.id:e)}const t=this.contexts$.value.ours.find(t=>t.uri===e&&!0===t.imported);return t?Object(L.a)(t):this.getLocalContext(e)}getContextLayers(e){const t=[];return e.layers$.getValue().forEach(e=>{e.baseLayer||"searchPointerSummaryId"===e.options.id||t.push(e)}),t}readParamsFromRoute(){this.route&&this.route.queryParams.subscribe(e=>{const t=this.route.options.centerKey;t&&e[t]&&(this.mapViewFromRoute.center=e[t].split(",").map(Number),this.mapViewFromRoute.geolocate=!1);const o=this.route.options.projectionKey;o&&e[o]&&(this.mapViewFromRoute.projection=e[o]);const i=this.route.options.zoomKey;i&&e[i]&&(this.mapViewFromRoute.zoom=Number(e[i]))})}getPath(e){return`${this.options.basePath.replace(/\/$/,"")}/${e}`}handleError(e,t,o){const i=this.contexts$.value.ours.find(e=>e.uri===t),r=i?i.title:t;throw e.error.title=this.languageService.translate.instant("igo.context.contextManager.invalid.title"),e.error.message=this.languageService.translate.instant("igo.context.contextManager.invalid.text",{value:r}),e.error.toDisplay=!0,o&&(e.error.title=this.languageService.translate.instant("igo.context.contextManager.errors.addPermissionTitle"),e.error.message=this.languageService.translate.instant("igo.context.contextManager.errors.addPermission")),e}handleContextsChange(e=!0){const t=this.context$.value,o=this.editedContext$.value;t&&t.uri!==this.options.defaultContextUri||(e=!1),e&&this.findContext(t)?(this.getContextByUri(t.uri).pipe(Object(Xs.a)()).subscribe(e=>{this.toolsChanged$.next(e)}),this.baseUrl&&this.authService.authenticated&&this.getDefault().subscribe()):(this.defaultContextUri=void 0,this.loadDefaultContext());const i=this.findContext(o);i&&"write"===i.permission||this.setEditedContext(void 0)}addContextToList(e){if(!this.findContext(e)){const t={id:e.id,uri:e.uri,title:e.title,scope:e.scope,permission:rf[rf.read]};this.contexts$.value&&this.contexts$.value.public&&(this.contexts$.value.public.push(t),this.contexts$.next(this.contexts$.value))}}findContext(e){if(!e)return!1;const t=this.contexts$.value;let o;for(const i of Object.keys(t))if(o=t[i].find(t=>e.id&&t.id===e.id||e.uri&&t.uri===e.uri),o)break;return o}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(y.b),Object(i.qc)(xs),Object(i.qc)(le),Object(i.qc)(K),Object(i.qc)(ce),Object(i.qc)(pe,8))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();Error;let af=(()=>{class e{static forRoot(){return{ngModule:e}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[Ue.m,Ue.C,m.c,n.c,gn.c,dn.b,xn.g,De.b,Pe.q,ke.e,Ve.c,b.b,ie,Gi,h.b]]}),e})(),nf=(()=>{class e{constructor(e,t){this.contextService=t,this.component=e}get map(){return this.component.map}ngOnInit(){this.context$$=this.contextService.context$.pipe(Object(Fe.a)(e=>void 0!==e)).subscribe(e=>this.handleContextChange(e))}ngOnDestroy(){this.context$$.unsubscribe()}handleContextChange(e){if(void 0===e.map)return;const t=e.map.view;this.component.view&&!0===t.keepCurrentView||(this.component.view=t)}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(Sl),Object(i.gc)(sf))},e.\u0275dir=Object(i.bc)({type:e,selectors:[["","igoMapContext",""]]}),e})(),cf=(()=>{class e{constructor(e,t,o,i,r,s,a){this.component=e,this.contextService=t,this.layerService=o,this.configService=i,this.styleListService=r,this.styleService=s,this.route=a,this.contextLayers=[],this.removeLayersOnContextChange=!0}get map(){return this.component.map}ngOnInit(){if(this.context$$=this.contextService.context$.pipe(Object(Fe.a)(e=>void 0!==e)).subscribe(e=>this.handleContextChange(e)),this.route&&this.route.options.visibleOnLayersKey&&this.route.options.visibleOffLayersKey&&this.route.options.contextKey){const e=this.route.queryParams.subscribe(t=>{Object.keys(t).length>0&&(this.queryParams=t,e.unsubscribe())})}}ngOnDestroy(){this.context$$.unsubscribe()}handleContextChange(e){if(void 0===e.layers)return;!0===this.removeLayersOnContextChange?this.map.removeAllLayers():this.map.removeLayers(this.contextLayers),this.contextLayers=[];const t=Object(Te.a)(...e.layers.map((t,o)=>this.layerService.createAsyncLayer(t,e.uri)));t.pipe(Object(of.a)(t.pipe(Object(S.a)(500)))).subscribe(t=>{t=t.filter(e=>void 0!==e).map(e=>(e.visible=this.computeLayerVisibilityFromUrl(e),e.zIndex=e.zIndex,e)),this.contextLayers.concat(t),this.map.addLayers(t),e.extraFeatures&&e.extraFeatures.forEach(e=>{const t=new sn.a,o=e.name;e=JSON.stringify(e),e=t.readFeatures(e,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"}),this.configService.getConfig("importWithStyle")?function(e,t,o,i,r){let s,a,n;if(i.getStyleList(o.toString()+".styleByAttribute")){const e=i.getStyleList(o.toString()+".styleByAttribute");s=t=>r.createStyleByAttribute(t,e)}else if(i.getStyleList(o.toString()+".clusterStyle")){const e=i.getStyleList(o.toString()+".clusterParam");a=i.getStyleList(o.toString()+".distance");const t=r.createStyle(i.getStyleList(o.toString()+".clusterStyle"));s=o=>r.createClusterStyle(o,e,t)}else s=i.getStyleList(o.toString()+".style")?r.createStyle(i.getStyleList(o.toString()+".style")):r.createStyle(i.getStyleList("default.style"));i.getStyleList(o.toString()+".clusterStyle")?(n=new Ac({distance:a,type:"cluster",queryable:!0}),n.ol.source.addFeatures(e)):(n=new vc({type:"vector",queryable:!0}),n.ol.addFeatures(e));const c=new Wc({title:o,source:n,style:s});t.addLayer(c)}(e,this.map,o,this.styleListService,this.styleService):function(e,t,o){const i=Math.floor(255*Math.random()),r=Math.floor(255*Math.random()),s=Math.floor(255*Math.random()),a=new Ra.Stroke({color:[i,r,s,1],width:2}),n=new Ra.Fill({color:[i,r,s,.4]}),c=new vc({type:"vector",queryable:!0});c.ol.addFeatures(e);const l=new Wc({title:o,source:c,style:new Ra.Style({stroke:a,fill:n,image:new Ra.Circle({radius:5,stroke:a,fill:n})})});t.addLayer(l)}(e,this.map,o)})})}computeLayerVisibilityFromUrl(e){const t=this.queryParams,o=e.id;let i=e.visible;if(!t||!o)return i;const r=t[this.route.options.contextKey];if(r===this.contextService.context$.value.uri||!r){let e="",r="",s=[],a=[];this.route.options.visibleOnLayersKey&&t[this.route.options.visibleOnLayersKey]&&(e=t[this.route.options.visibleOnLayersKey]),this.route.options.visibleOffLayersKey&&t[this.route.options.visibleOffLayersKey]&&(r=t[this.route.options.visibleOffLayersKey]),"*"===e&&(i=!0),"*"===r&&(i=!1),s=e.split(","),a=r.split(","),(s.indexOf(o)>-1||s.indexOf(o.toString())>-1)&&(i=!0),(a.indexOf(o)>-1||a.indexOf(o.toString())>-1)&&(i=!1)}return i}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(Sl),Object(i.gc)(sf),Object(i.gc)(Jc),Object(i.gc)(K),Object(i.gc)(mp),Object(i.gc)(Qc),Object(i.gc)(pe,8))},e.\u0275dir=Object(i.bc)({type:e,selectors:[["","igoLayerContext",""]],inputs:{removeLayersOnContextChange:"removeLayersOnContextChange"}}),e})();var lf=function(e){return e.always="always",e.never="never",e.default="default",e}({});let uf=(()=>{class e{constructor(e){this.dialogRef=e}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(qe.h))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-bookmark-dialog"]],decls:14,vars:14,consts:[["mat-dialog-title","",1,"mat-typography"],["mat-dialog-content","",1,"mat-typography"],["matInput","","required","","autocomplete","off","maxlength","128",3,"placeholder","ngModel","ngModelChange"],["mat-dialog-actions",""],["mat-button","","color","primary",3,"disabled","click"],["mat-button","",3,"click"]],template:function(e,t){1&e&&(Object(i.mc)(0,"h1",0),Object(i.ad)(1),Object(i.yc)(2,"translate"),Object(i.lc)(),Object(i.mc)(3,"div",1),Object(i.mc)(4,"mat-form-field"),Object(i.mc)(5,"input",2),Object(i.tc)("ngModelChange",(function(e){return t.title=e})),Object(i.yc)(6,"translate"),Object(i.lc)(),Object(i.lc)(),Object(i.lc)(),Object(i.mc)(7,"div",3),Object(i.mc)(8,"button",4),Object(i.tc)("click",(function(){return t.dialogRef.close(t.title)})),Object(i.ad)(9),Object(i.yc)(10,"translate"),Object(i.lc)(),Object(i.mc)(11,"button",5),Object(i.tc)("click",(function(){return t.dialogRef.close(!1)})),Object(i.ad)(12),Object(i.yc)(13,"translate"),Object(i.lc)(),Object(i.lc)()),2&e&&(Object(i.Tb)(1),Object(i.bd)(Object(i.zc)(2,6,"igo.context.bookmarkButton.dialog.title")),Object(i.Tb)(4),Object(i.Dc)("placeholder",Object(i.zc)(6,8,"igo.context.bookmarkButton.dialog.placeholder"))("ngModel",t.title),Object(i.Tb)(3),Object(i.Dc)("disabled",!t.title),Object(i.Tb)(1),Object(i.cd)(" ",Object(i.zc)(10,10,"igo.common.confirmDialog.confirmBtn")," "),Object(i.Tb)(3),Object(i.cd)(" ",Object(i.zc)(13,12,"igo.common.confirmDialog.cancelBtn")," "))},directives:[qe.i,qe.f,ke.c,Ve.b,Ue.d,Ue.D,Ue.n,Ue.s,Ue.v,qe.c,n.b],pipes:[q.e],encapsulation:2}),e})();function df(e,t){if(1&e&&Object(i.hc)(0,"mat-icon",7),2&e){const e=Object(i.xc)(2);Object(i.Ec)("svgIcon",e.context.icon?e.context.icon:"public"===e.context.scope?"earth":"star")}}function hf(e,t){if(1&e&&Object(i.hc)(0,"img",8),2&e){const e=Object(i.xc)(2);Object(i.Dc)("src",e.context.iconImage,i.Qc)}}function pf(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",4),Object(i.tc)("click",(function(){Object(i.Nc)(e);const t=Object(i.xc)();return t.favoriteClick(t.context)})),Object(i.yc)(1,"translate"),Object(i.Yc)(2,df,1,1,"mat-icon",5),Object(i.Yc)(3,hf,1,1,"img",6),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Dc)("matTooltip",e.auth.authenticated?Object(i.zc)(1,4,"igo.context.contextManager.favorite"):"")("color",e.default?"primary":"default"),Object(i.Tb)(2),Object(i.Dc)("ngIf",!e.context.iconImage),Object(i.Tb)(1),Object(i.Dc)("ngIf",e.context.iconImage)}}function mf(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",20),Object(i.tc)("click",(function(){Object(i.Nc)(e);const t=Object(i.xc)(2);return t.save.emit(t.context)})),Object(i.yc)(1,"translate"),Object(i.hc)(2,"mat-icon",21),Object(i.lc)()}if(2&e){const e=Object(i.xc)(2);Object(i.Dc)("matTooltip",Object(i.zc)(1,2,"igo.context.contextManager.save"))("color",e.color)}}function gf(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",22),Object(i.tc)("click",(function(){Object(i.Nc)(e);const t=Object(i.xc)(2);return t.managePermissions.emit(t.context)})),Object(i.yc)(1,"translate"),Object(i.hc)(2,"mat-icon",23),Object(i.lc)()}if(2&e){const e=Object(i.xc)(2);Object(i.Dc)("matTooltip",Object(i.zc)(1,2,"igo.context.contextManager.managePermissions"))("color",e.color)}}function bf(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",24),Object(i.tc)("click",(function(){Object(i.Nc)(e);const t=Object(i.xc)(2);return t.clone.emit(t.context)})),Object(i.yc)(1,"translate"),Object(i.hc)(2,"mat-icon",25),Object(i.lc)()}if(2&e){const e=Object(i.xc)(2);Object(i.Dc)("matTooltip",Object(i.zc)(1,2,"igo.context.contextManager.clone"))("color",e.color)}}function ff(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",26),Object(i.tc)("click",(function(){Object(i.Nc)(e);const t=Object(i.xc)(2);return t.edit.emit(t.context)})),Object(i.yc)(1,"translate"),Object(i.hc)(2,"mat-icon",27),Object(i.lc)()}if(2&e){const e=Object(i.xc)(2);Object(i.Dc)("color",e.color)("matTooltip",Object(i.zc)(1,2,"igo.context.contextManager.edit"))}}function yf(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",28),Object(i.tc)("click",(function(){Object(i.Nc)(e);const t=Object(i.xc)(2);return t.hide.emit(t.context)})),Object(i.yc)(1,"translate"),Object(i.hc)(2,"mat-icon",29),Object(i.lc)()}if(2&e){const e=Object(i.xc)(2);Object(i.Dc)("color",e.color)("matTooltip",Object(i.zc)(1,2,"igo.context.contextManager.hide"))}}function Of(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",28),Object(i.tc)("click",(function(){Object(i.Nc)(e);const t=Object(i.xc)(2);return t.show.emit(t.context)})),Object(i.yc)(1,"translate"),Object(i.hc)(2,"mat-icon",30),Object(i.lc)()}if(2&e){const e=Object(i.xc)(2);Object(i.Dc)("color",e.color)("matTooltip",Object(i.zc)(1,2,"igo.context.contextManager.show"))}}function vf(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",31),Object(i.tc)("click",(function(){Object(i.Nc)(e);const t=Object(i.xc)(2);return t.delete.emit(t.context)})),Object(i.yc)(1,"translate"),Object(i.hc)(2,"mat-icon",32),Object(i.lc)()}2&e&&Object(i.Dc)("matTooltip",Object(i.zc)(1,1,"igo.context.contextManager.delete"))}function jf(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"div",9),Object(i.Yc)(1,mf,3,4,"button",10),Object(i.mc)(2,"div",11,12),Object(i.Yc)(4,gf,3,4,"button",13),Object(i.Yc)(5,bf,3,4,"button",14),Object(i.Yc)(6,ff,3,4,"button",15),Object(i.Yc)(7,yf,3,4,"button",16),Object(i.Yc)(8,Of,3,4,"button",16),Object(i.Yc)(9,vf,3,3,"button",17),Object(i.lc)(),Object(i.mc)(10,"button",18),Object(i.tc)("click",(function(){Object(i.Nc)(e);const t=Object(i.xc)();return t.collapsed=!t.collapsed})),Object(i.hc)(11,"mat-icon",19),Object(i.lc)(),Object(i.lc)()}if(2&e){const e=Object(i.Kc)(3),t=Object(i.xc)();Object(i.Tb)(1),Object(i.Dc)("ngIf",t.collapsed&&t.selected&&(t.context.permission===t.typePermission[t.typePermission.write]||t.context.imported)),Object(i.Tb)(3),Object(i.Dc)("ngIf",t.canShare&&!t.context.imported),Object(i.Tb)(1),Object(i.Dc)("ngIf",!t.context.imported),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.context.permission===t.typePermission[t.typePermission.write]&&!t.context.imported),Object(i.Tb)(1),Object(i.Dc)("ngIf",!t.context.hidden&&!t.context.imported),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.context.hidden&&!t.context.imported),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.context.permission===t.typePermission[t.typePermission.write]||t.context.imported),Object(i.Tb)(1),Object(i.Dc)("color",t.color)("target",e)("collapsed",t.collapsed)}}const wf=function(e){return{"mat-list-item-light":e}};let Sf=(()=>{class e{constructor(e,t){this.auth=e,this.storageService=t,this.typePermission=rf,this.color="primary",this.collapsed=!0,this._default=!1,this.edit=new i.u,this.delete=new i.u,this.save=new i.u,this.clone=new i.u,this.hide=new i.u,this.show=new i.u,this.favorite=new i.u,this.managePermissions=new i.u,this.manageTools=new i.u}get context(){return this._context}set context(e){this._context=e}get default(){return this._default}set default(e){this._default=e}get hidden(){return this.context.hidden}get canShare(){return!0===this.storageService.get("canShare")}favoriteClick(e){this.auth.authenticated&&this.favorite.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(xs),Object(i.gc)(Oe))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-context-item"]],inputs:{context:"context",default:"default",selected:"selected"},outputs:{edit:"edit",delete:"delete",save:"save",clone:"clone",hide:"hide",show:"show",favorite:"favorite",managePermissions:"managePermissions",manageTools:"manageTools"},decls:5,vars:6,consts:[[1,"mat-list-item",3,"ngClass"],["mat-list-avatar","","mat-icon-button","","igoStopPropagation","","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],["matLine",""],["igoStopPropagation","","class","igo-actions-container",4,"ngIf"],["mat-list-avatar","","mat-icon-button","","igoStopPropagation","","matTooltipShowDelay","500",3,"matTooltip","color","click"],[3,"svgIcon",4,"ngIf"],[3,"src",4,"ngIf"],[3,"svgIcon"],[3,"src"],["igoStopPropagation","",1,"igo-actions-container"],["class","save-button","mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],[1,"igo-actions-expand-container"],["actions",""],["mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],["class","clone-button","mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],["class","edit-button","mat-icon-button","","matTooltipShowDelay","500",3,"color","matTooltip","click",4,"ngIf"],["class","hide-button","mat-icon-button","","matTooltipShowDelay","500",3,"color","matTooltip","click",4,"ngIf"],["class","delete-button","mat-icon-button","","color","warn","matTooltipShowDelay","500",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","igoCollapse","",1,"actions-button",3,"color","target","collapsed","click"],["svgIcon","dots-horizontal"],["mat-icon-button","","matTooltipShowDelay","500",1,"save-button",3,"matTooltip","color","click"],["svgIcon","content-save"],["mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","color","click"],["svgIcon","account-arrow-right"],["mat-icon-button","","matTooltipShowDelay","500",1,"clone-button",3,"matTooltip","color","click"],["svgIcon","content-copy"],["mat-icon-button","","matTooltipShowDelay","500",1,"edit-button",3,"color","matTooltip","click"],["svgIcon","pencil"],["mat-icon-button","","matTooltipShowDelay","500",1,"hide-button",3,"color","matTooltip","click"],["svgIcon","eye"],["svgIcon","eye-off"],["mat-icon-button","","color","warn","matTooltipShowDelay","500",1,"delete-button",3,"matTooltip","click"],["svgIcon","delete"]],template:function(e,t){1&e&&(Object(i.mc)(0,"mat-list-item",0),Object(i.Yc)(1,pf,4,6,"button",1),Object(i.mc)(2,"h4",2),Object(i.ad)(3),Object(i.lc)(),Object(i.Yc)(4,jf,12,10,"div",3),Object(i.lc)()),2&e&&(Object(i.Dc)("ngClass",Object(i.Gc)(4,wf,t.hidden)),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.auth.authenticated),Object(i.Tb)(2),Object(i.bd)(t.context.title),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.auth.authenticated))},directives:[l.d,m.q,m.t,Pe.l,n.b,l.b,gt,h.a,c.a,Do],pipes:[q.e],styles:["[_nghost-%COMP%]{overflow:hidden}.igo-actions-container[_ngcontent-%COMP%]{flex-shrink:0}.igo-actions-expand-container[_ngcontent-%COMP%]{display:inline-flex}mat-list-item[_ngcontent-%COMP%]     .mat-list-item-content .mat-list-text{padding:0}mat-icon.disabled[_ngcontent-%COMP%]{color:rgba(0,0,0,.38)}mat-list-item.mat-list-item-light[_ngcontent-%COMP%]     .mat-list-item-content{color:#969696}"],changeDetection:0}),e})();function xf(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",14),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.xc)(2).clearFilter()})),Object(i.hc)(1,"mat-icon",15),Object(i.lc)()}}function Cf(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"mat-form-field",11),Object(i.mc)(1,"input",12),Object(i.tc)("ngModelChange",(function(t){return Object(i.Nc)(e),Object(i.xc)().term=t})),Object(i.yc)(2,"translate"),Object(i.lc)(),Object(i.Yc)(3,xf,2,0,"button",13),Object(i.lc)()}if(2&e){const e=Object(i.xc)();Object(i.Dc)("ngClass",e.auth.authenticated&&e.configService.getConfig("context")?"context-filter-min-width":"context-filter-max-width"),Object(i.Tb)(1),Object(i.Dc)("placeholder",Object(i.zc)(2,4,"igo.context.contextManager.filterPlaceHolder"))("ngModel",e.term),Object(i.Tb)(2),Object(i.Dc)("ngIf",e.term.length)}}function Tf(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",16),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.xc)().toggleSort(!0)})),Object(i.yc)(1,"translate"),Object(i.hc)(2,"mat-icon",17),Object(i.lc)()}2&e&&Object(i.Dc)("matTooltip",Object(i.zc)(1,1,"igo.context.contextManager.sortAlphabetically"))}function Lf(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"button",16),Object(i.tc)("click",(function(){return Object(i.Nc)(e),Object(i.xc)().toggleSort(!1)})),Object(i.yc)(1,"translate"),Object(i.hc)(2,"mat-icon",18),Object(i.lc)()}2&e&&Object(i.Dc)("matTooltip",Object(i.zc)(1,1,"igo.context.contextManager.sortContextOrder"))}function If(e,t){if(1&e&&Object(i.hc)(0,"igo-actionbar",19),2&e){const e=Object(i.xc)();Object(i.Dc)("iconColor",e.color)("store",e.actionStore)("withIcon",!0)("withTitle","overlay"===e.actionbarMode)("horizontal",!1)("mode",e.actionbarMode)}}function Ff(e,t){if(1&e&&(Object(i.mc)(0,"button",20),Object(i.yc)(1,"translate"),Object(i.hc)(2,"mat-icon",21),Object(i.lc)()),2&e){Object(i.xc)();const e=Object(i.Kc)(7);Object(i.Dc)("matTooltip",Object(i.zc)(1,2,"igo.context.contextManager.filterUser"))("matMenuTriggerFor",e)}}function Mf(e,t){if(1&e&&(Object(i.mc)(0,"button",27),Object(i.ad)(1),Object(i.lc)()),2&e){const e=Object(i.xc)().$implicit,t=Object(i.Kc)(6);Object(i.Dc)("matMenuTriggerFor",t),Object(i.Tb)(1),Object(i.cd)(" ",e.title," ")}}function kf(e,t){if(1&e&&(Object(i.mc)(0,"button",9),Object(i.ad)(1),Object(i.lc)()),2&e){const e=Object(i.xc)().$implicit;Object(i.Tb)(1),Object(i.cd)(" ",e.title," ")}}function Df(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"mat-checkbox",8),Object(i.tc)("click",(function(t){return Object(i.Nc)(e),t.stopPropagation()}))("change",(function(){Object(i.Nc)(e);const o=t.$implicit,r=Object(i.xc)().$implicit;return Object(i.xc)().userSelection(o,r)})),Object(i.ad)(1),Object(i.lc)()}if(2&e){const e=t.$implicit,o=Object(i.xc)(2);Object(i.Dc)("checked",o.getPermission(e).checked),Object(i.Tb)(1),Object(i.cd)(" ",e.title," ")}}function Pf(e,t){if(1&e){const e=Object(i.nc)();Object(i.kc)(0),Object(i.mc)(1,"span",7),Object(i.mc)(2,"mat-checkbox",22),Object(i.tc)("click",(function(t){return Object(i.Nc)(e),t.stopPropagation()}))("change",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)().userSelection(o)})),Object(i.lc)(),Object(i.Yc)(3,Mf,2,2,"button",23),Object(i.Yc)(4,kf,2,1,"button",24),Object(i.lc)(),Object(i.mc)(5,"mat-menu",null,25),Object(i.Yc)(7,Df,2,2,"mat-checkbox",26),Object(i.lc)(),Object(i.jc)()}if(2&e){const e=t.$implicit,o=Object(i.xc)();Object(i.Tb)(2),Object(i.Dc)("checked",o.getPermission(e).checked)("indeterminate",o.getPermission(e).indeterminate),Object(i.Tb)(1),Object(i.Dc)("ngIf",e.childs),Object(i.Tb)(1),Object(i.Dc)("ngIf",!e.childs),Object(i.Tb)(3),Object(i.Dc)("ngForOf",e.childs)}}function Af(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"igo-context-item",31),Object(i.tc)("edit",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)(3).edit.emit(o)}))("delete",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)(3).delete.emit(o)}))("clone",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)(3).clone.emit(o)}))("save",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)(3).save.emit(o)}))("hide",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)(3).hideContext(o)}))("show",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)(3).showContext(o)}))("favorite",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)(3).favorite.emit(o)}))("manageTools",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)(3).manageTools.emit(o)}))("managePermissions",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)(3).managePermissions.emit(o)}))("select",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)(3).select.emit(o)}))("unselect",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)(3).unselect.emit(o)})),Object(i.lc)()}if(2&e){const e=t.$implicit,o=Object(i.xc)(3);Object(i.Dc)("selected",o.selectedContext&&o.selectedContext.uri===e.uri)("context",e)("default",e.id&&o.defaultContextId&&o.defaultContextId===e.id)}}function $f(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"igo-collapsible",30),Object(i.tc)("toggle",(function(t){Object(i.Nc)(e);const o=Object(i.xc)().$implicit,r=Object(i.xc)();return r.collapsed[r.titleMapping[o.key]]=t})),Object(i.yc)(1,"translate"),Object(i.Yc)(2,Af,1,3,"ng-template",10),Object(i.lc)()}if(2&e){const e=Object(i.xc)().$implicit,t=Object(i.xc)();Object(i.Dc)("title",Object(i.zc)(1,3,t.titleMapping[e.key]))("collapsed",t.collapsed[t.titleMapping[e.key]]),Object(i.Tb)(2),Object(i.Dc)("ngForOf",e.value)}}function Ef(e,t){if(1&e){const e=Object(i.nc)();Object(i.mc)(0,"igo-context-item",32),Object(i.tc)("select",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)(3).select.emit(o)}))("unselect",(function(){Object(i.Nc)(e);const o=t.$implicit;return Object(i.xc)(3).unselect.emit(o)})),Object(i.lc)()}if(2&e){const e=t.$implicit,o=Object(i.xc)(3);Object(i.Dc)("selected",o.selectedContext&&o.selectedContext.uri===e.uri)("context",e)("default",o.defaultContextId===e.id)}}function Rf(e,t){if(1&e&&Object(i.Yc)(0,Ef,1,3,"ng-template",10),2&e){const e=Object(i.xc)().$implicit;Object(i.Dc)("ngForOf",e.value)}}function _f(e,t){if(1&e&&(Object(i.Yc)(0,$f,3,5,"igo-collapsible",28),Object(i.Yc)(1,Rf,1,1,void 0,29)),2&e){const e=t.$implicit,o=Object(i.xc)();Object(i.Dc)("ngIf",e.value.length&&o.auth.authenticated),Object(i.Tb)(1),Object(i.Dc)("ngIf",e.value.length&&!o.auth.authenticated)}}let zf=(()=>{class e{constructor(e,t,o,r,s,a,n){this.cdRef=e,this.contextService=t,this.configService=o,this.auth=r,this.dialog=s,this.languageService=a,this.storageService=n,this.contextsInitial={ours:[]},this.contexts$=new C.a(this.contextsInitial),this.change$=new Se.a(1),this._contexts={ours:[]},this.collapsed=[],this.select=new i.u,this.unselect=new i.u,this.edit=new i.u,this.delete=new i.u,this.save=new i.u,this.clone=new i.u,this.create=new i.u,this.hide=new i.u,this.show=new i.u,this.showHiddenContexts=new i.u,this.favorite=new i.u,this.managePermissions=new i.u,this.manageTools=new i.u,this.filterPermissionsChanged=new i.u,this.titleMapping={ours:"igo.context.contextManager.ourContexts",shared:"igo.context.contextManager.sharedContexts",public:"igo.context.contextManager.publicContexts"},this.permissions=[],this.actionStore=new ao([]),this.actionbarMode=so.Overlay,this.color="primary",this.showHidden=!1,this._term="",this._sortedAlpha=void 0,this.showContextFilter=lf.always,this.thresholdToFilter=5}get contexts(){return this._contexts}set contexts(e){this._contexts=e,this.cdRef.detectChanges(),this.next()}get selectedContext(){return this._selectedContext}set selectedContext(e){this._selectedContext=e,this.cdRef.detectChanges()}get map(){return this._map}set map(e){this._map=e}get defaultContextId(){return this._defaultContextId}set defaultContextId(e){this._defaultContextId=e}set term(e){this._term=e,this.next()}get term(){return this._term}get sortedAlpha(){return this._sortedAlpha}set sortedAlpha(e){this._sortedAlpha=e,this.next()}ngOnInit(){this.change$$=this.change$.pipe(Object(ia.a)(()=>0===this.contexts.ours.length?Qs.a:Object(Js.a)(50))).subscribe(()=>{this.contexts$.next(this.filterContextsList(this.contexts))}),this.actionStore.load([{id:"emptyContext",title:this.languageService.translate.instant("igo.context.contextManager.emptyContext"),icon:"map-outline",tooltip:this.languageService.translate.instant("igo.context.contextManager.emptyContextTooltip"),handler:()=>{this.createContext(!0)}},{id:"contextFromMap",title:this.languageService.translate.instant("igo.context.contextManager.contextMap"),icon:"map-check",tooltip:this.languageService.translate.instant("igo.context.contextManager.contextMapTooltip"),handler:()=>{this.createContext(!1)}}])}next(){this.change$.next()}filterContextsList(e){if(""===this.term)return this.sortedAlpha&&(e=this.sortContextsList(e)),e;{let t={ours:e.ours.filter(e=>{const t=this.term.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return e.title.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t)})};if(this.contexts.public){const o=e.public.filter(e=>{const t=this.term.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return e.title.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t)});t.public=o}if(this.contexts.shared){const o=e.shared.filter(e=>{const t=this.term.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return e.title.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t)});t.shared=o}return this.sortedAlpha&&(t=this.sortContextsList(t)),t}}ngOnDestroy(){this.change$$.unsubscribe()}showFilter(){switch(this.showContextFilter){case lf.always:return!0;case lf.never:return!1;default:let e=this.contexts.ours.length;return e+=this.contexts.public?this.contexts.public.length:0,e+=this.contexts.shared?this.contexts.shared.length:0,e>=this.thresholdToFilter}}sortContextsList(e){if(e){const t=JSON.parse(JSON.stringify(e));return t.ours.sort((e,t)=>this.normalize(e.title)<this.normalize(t.title)?-1:this.normalize(e.title)>this.normalize(t.title)?1:0),t.shared?t.shared.sort((e,t)=>this.normalize(e.title)<this.normalize(t.title)?-1:this.normalize(e.title)>this.normalize(t.title)?1:0):t.public&&t.public.sort((e,t)=>this.normalize(e.title)<this.normalize(t.title)?-1:this.normalize(e.title)>this.normalize(t.title)?1:0),t}}normalize(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}toggleSort(e){this.sortedAlpha=e}clearFilter(){this.term=""}createContext(e){this.dialog.open(uf,{disableClose:!1}).afterClosed().pipe(Object(Me.a)(1)).subscribe(t=>{t&&this.create.emit({title:t,empty:e})})}getPermission(e){if(e)return this.permissions.find(t=>t.name===e.name)}userSelection(e,t){const o=this.getPermission(e);if(o&&(o.checked=!o.checked,this.storageService.set("contexts.permissions."+o.name,o.checked),o.indeterminate=!1),t){let e=!1;for(const r of t.childs)if(this.getPermission(r).checked!==o.checked){e=!0;break}const i=this.getPermission(t);i&&(i.checked=o.checked,this.storageService.set("contexts.permissions."+i.name,o.checked),i.indeterminate=e)}if(e.childs)for(const i of e.childs){const e=this.getPermission(i);e&&e.checked!==o.checked&&(e.checked=o.checked,this.storageService.set("contexts.permissions."+e.name,o.checked))}this.filterPermissionsChanged.emit(this.permissions)}hideContext(e){if(e.hidden=!0,!this.showHidden){const t={ours:[],shared:[],public:[]};t.ours=this.contexts.ours.filter(t=>t.id!==e.id),t.shared=this.contexts.shared.filter(t=>t.id!==e.id),t.public=this.contexts.public.filter(t=>t.id!==e.id),this.contexts=t}this.hide.emit(e)}showContext(e){e.hidden=!1,this.show.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(i.j),Object(i.gc)(sf),Object(i.gc)(K),Object(i.gc)(xs),Object(i.gc)(qe.b),Object(i.gc)(le),Object(i.gc)(Oe))},e.\u0275cmp=Object(i.ac)({type:e,selectors:[["igo-context-list"]],inputs:{contexts:"contexts",selectedContext:"selectedContext",map:"map",defaultContextId:"defaultContextId",term:"term"},outputs:{select:"select",unselect:"unselect",edit:"edit",delete:"delete",save:"save",clone:"clone",create:"create",hide:"hide",show:"show",showHiddenContexts:"showHiddenContexts",favorite:"favorite",managePermissions:"managePermissions",manageTools:"manageTools",filterPermissionsChanged:"filterPermissionsChanged"},decls:17,vars:16,consts:[[3,"navigation"],[3,"ngClass",4,"ngIf"],["class","sort-alpha","mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","click",4,"ngIf"],["class","add-context-button","icon","plus",3,"iconColor","store","withIcon","withTitle","horizontal","mode",4,"ngIf"],["class","users-filter","mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","matMenuTriggerFor",4,"ngIf"],["accountMenu","matMenu"],[4,"ngFor","ngForOf"],[1,"profilsMenu"],[1,"mat-menu-item",3,"checked","click","change"],["mat-menu-item",""],["ngFor","",3,"ngForOf"],[3,"ngClass"],["matInput","","type","text",3,"placeholder","ngModel","ngModelChange"],["mat-button","","mat-icon-button","","matSuffix","","class","clear-button","aria-label","Clear","color","warn",3,"click",4,"ngIf"],["mat-button","","mat-icon-button","","matSuffix","","aria-label","Clear","color","warn",1,"clear-button",3,"click"],["svgIcon","close"],["mat-icon-button","","matTooltipShowDelay","500",1,"sort-alpha",3,"matTooltip","click"],["color","primary","svgIcon","sort-alphabetical-variant"],["color","warn","svgIcon","sort-variant-remove"],["icon","plus",1,"add-context-button",3,"iconColor","store","withIcon","withTitle","horizontal","mode"],["mat-icon-button","","matTooltipShowDelay","500",1,"users-filter",3,"matTooltip","matMenuTriggerFor"],["color","primary","svgIcon","filter-menu"],[1,"mat-menu-item",3,"checked","indeterminate","click","change"],["mat-menu-item","",3,"matMenuTriggerFor",4,"ngIf"],["mat-menu-item","",4,"ngIf"],["subAccountMenu","matMenu"],["class","mat-menu-item",3,"checked","click","change",4,"ngFor","ngForOf"],["mat-menu-item","",3,"matMenuTriggerFor"],[3,"title","collapsed","toggle",4,"ngIf"],[4,"ngIf"],[3,"title","collapsed","toggle"],["igoListItem","","color","accent",3,"selected","context","default","edit","delete","clone","save","hide","show","favorite","manageTools","managePermissions","select","unselect"],["igoListItem","","color","accent",3,"selected","context","default","select","unselect"]],template:function(e,t){1&e&&(Object(i.mc)(0,"igo-list",0),Object(i.Yc)(1,Cf,4,6,"mat-form-field",1),Object(i.Yc)(2,Tf,3,3,"button",2),Object(i.Yc)(3,Lf,3,3,"button",2),Object(i.Yc)(4,If,1,6,"igo-actionbar",3),Object(i.Yc)(5,Ff,3,4,"button",4),Object(i.mc)(6,"mat-menu",null,5),Object(i.Yc)(8,Pf,8,5,"ng-container",6),Object(i.mc)(9,"span",7),Object(i.mc)(10,"mat-checkbox",8),Object(i.tc)("click",(function(e){return e.stopPropagation()}))("change",(function(){return t.showHiddenContexts.emit()})),Object(i.lc)(),Object(i.mc)(11,"button",9),Object(i.ad)(12),Object(i.yc)(13,"translate"),Object(i.lc)(),Object(i.lc)(),Object(i.lc)(),Object(i.Yc)(14,_f,2,2,"ng-template",10),Object(i.yc)(15,"keyvalue"),Object(i.yc)(16,"async"),Object(i.lc)()),2&e&&(Object(i.Dc)("navigation",!0),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.showFilter()),Object(i.Tb)(1),Object(i.Dc)("ngIf",!t.sortedAlpha),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.sortedAlpha),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.auth.authenticated&&t.configService.getConfig("context")),Object(i.Tb)(1),Object(i.Dc)("ngIf",t.auth.authenticated&&t.configService.getConfig("context")),Object(i.Tb)(3),Object(i.Dc)("ngForOf",t.users),Object(i.Tb)(2),Object(i.Dc)("checked",t.showHidden),Object(i.Tb)(2),Object(i.cd)(" ",Object(i.zc)(13,10,"igo.context.contextManager.showHidden")," "),Object(i.Tb)(2),Object(i.Dc)("ngForOf",Object(i.zc)(15,12,Object(i.zc)(16,14,t.contexts$))))},directives:[Pi,m.t,f.e,m.s,b.a,f.b,ke.c,m.q,Ve.b,Ue.d,Ue.s,Ue.v,n.b,ke.j,c.a,h.a,Co,f.d,Ao,Sf,Mi],pipes:[q.e,Ii,m.b],styles:[".context-filter-max-width[_ngcontent-%COMP%]{margin:5px;padding-left:6px;width:calc(100% - 100px)}.context-filter-min-width[_ngcontent-%COMP%]{margin:5px;padding-left:6px;width:calc(100% - 135px)}.clear-button[_ngcontent-%COMP%]{padding-right:5px}mat-form-field[_ngcontent-%COMP%]{height:40px}.profilsMenu[_ngcontent-%COMP%]{display:flex}.profilsMenu[_ngcontent-%COMP%] > mat-checkbox[_ngcontent-%COMP%]{width:8px}.add-context-button[_ngcontent-%COMP%]{display:inline-flex;margin:0;width:40px}"],changeDetection:0}),e})(),Nf=(()=>{class e{constructor(e,t,o,i,r,s,a,n){this.contextService=t,this.mapService=o,this.languageService=i,this.confirmDialogService=r,this.messageService=s,this.auth=a,this.storageService=n,this.component=e}onSelect(e){this.contextService.loadContext(e.uri)}onEdit(e){this.contextService.loadEditedContext(e.uri)}onSave(e){const t=this.mapService.getMap(),o=this.contextService.getContextFromMap(t),i=()=>{const t=this.languageService.translate,o=t.instant("igo.context.contextManager.dialog.saveMsg",{value:e.title}),i=t.instant("igo.context.contextManager.dialog.saveTitle");this.messageService.success(o,i)};if(e.imported)return o.title=e.title,this.contextService.delete(e.id,!0),void this.contextService.create(o).subscribe(e=>{this.contextService.loadContext(e.uri),i()});this.contextService.update(e.id,{layers:o.layers,map:{view:o.map.view}}).subscribe(()=>{i()})}onFavorite(e){this.contextService.setDefault(e.id).subscribe(()=>{this.contextService.defaultContextId$.next(e.id);const t=this.languageService.translate,o=t.instant("igo.context.contextManager.dialog.favoriteMsg",{value:e.title}),i=t.instant("igo.context.contextManager.dialog.favoriteTitle");this.messageService.success(o,i)})}onManageTools(e){this.contextService.loadEditedContext(e.uri)}onManagePermissions(e){this.contextService.loadEditedContext(e.uri)}onDelete(e){const t=this.languageService.translate;this.confirmDialogService.open(t.instant("igo.context.contextManager.dialog.confirmDelete")).subscribe(o=>{o&&this.contextService.delete(e.id,e.imported).subscribe(()=>{const o=t.instant("igo.context.contextManager.dialog.deleteMsg",{value:e.title}),i=t.instant("igo.context.contextManager.dialog.deleteTitle");this.messageService.info(o,i)})})}onClone(e){this.contextService.clone(e.id,{title:e.title+"-copy",uri:e.uri+"-copy"}).subscribe(()=>{const t=this.languageService.translate,o=t.instant("igo.context.contextManager.dialog.cloneMsg",{value:e.title}),i=t.instant("igo.context.contextManager.dialog.cloneTitle");this.messageService.success(o,i)})}onCreate(e){const{title:t,empty:o}=e,i=this.contextService.getContextFromMap(this.component.map,o);i.title=t,this.contextService.create(i).subscribe(()=>{const e=this.languageService.translate,t=e.instant("igo.context.bookmarkButton.dialog.createTitle"),o=e.instant("igo.context.bookmarkButton.dialog.createMsg",{value:i.title});this.messageService.success(o,t),this.contextService.loadContext(i.uri)})}loadContexts(){const e=["none"];for(const t of this.component.permissions)!0!==t.checked&&!0!==t.indeterminate||e.push(t.name);this.contextService.loadContexts(e,!!this.component.showHidden)}showHiddenContexts(){this.component.showHidden=!this.component.showHidden,this.storageService.set("contexts.showHidden",this.component.showHidden),this.loadContexts()}onShowContext(e){this.contextService.showContext(e.id).subscribe()}onHideContext(e){this.contextService.hideContext(e.id).subscribe()}ngOnInit(){this.component.contexts={ours:[]},this.component.showHidden=this.storageService.get("contexts.showHidden"),this.contexts$$=this.contextService.contexts$.subscribe(e=>this.handleContextsChange(e)),this.defaultContextId$$=this.contextService.defaultContextId$.subscribe(e=>{this.component.defaultContextId=e}),this.selectedContext$$=this.contextService.context$.pipe(Object(S.a)(100)).subscribe(e=>this.component.selectedContext=e),this.auth.authenticate$.subscribe(e=>{e&&this.contextService.getProfilByUser().subscribe(e=>{this.component.users=e,this.component.permissions=[];const t=this.component.users.reduce((e,t)=>(e=e.concat(t),t.childs?e.concat(t.childs):e),[]);for(const i of t){const e={name:i.name,checked:this.storageService.get("contexts.permissions."+i.name)};null===e.checked&&(e.checked=!0),this.component.permissions.push(e)}const o=["none"];for(const i of this.component.permissions)!0!==i.checked&&!0!==i.indeterminate||o.push(i.name);this.contextService.loadContexts(o,!!this.component.showHidden)})})}ngOnDestroy(){this.contexts$$.unsubscribe(),this.selectedContext$$.unsubscribe(),this.defaultContextId$$.unsubscribe()}handleContextsChange(e){this.component.contexts=e}}return e.\u0275fac=function(t){return new(t||e)(Object(i.gc)(zf,2),Object(i.gc)(sf),Object(i.gc)(jl),Object(i.gc)(le),Object(i.gc)(Ro),Object(i.gc)(ce),Object(i.gc)(xs),Object(i.gc)(Oe))},e.\u0275dir=Object(i.bc)({type:e,selectors:[["","igoContextListBinding",""]],hostBindings:function(e,t){1&e&&Object(i.tc)("select",(function(e){return t.onSelect(e)}))("edit",(function(e){return t.onEdit(e)}))("save",(function(e){return t.onSave(e)}))("favorite",(function(e){return t.onFavorite(e)}))("manageTools",(function(e){return t.onManageTools(e)}))("managePermissions",(function(e){return t.onManagePermissions(e)}))("delete",(function(e){return t.onDelete(e)}))("clone",(function(e){return t.onClone(e)}))("create",(function(e){return t.onCreate(e)}))("filterPermissionsChanged",(function(){return t.loadContexts()}))("showHiddenContexts",(function(){return t.showHiddenContexts()}))("show",(function(e){return t.onShowContext(e)}))("hide",(function(e){return t.onHideContext(e)}))}}),e})(),Bf=(()=>{class e{constructor(e,t){this.http=e,this.config=t,this.baseUrl=this.config.getConfig("context.url")}get(){return this.baseUrl?this.http.get(this.baseUrl+"/pois"):Qs.a}delete(e){return this.http.delete(this.baseUrl+"/pois/"+e)}create(e){return this.http.post(this.baseUrl+"/pois",e)}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(y.b),Object(i.qc)(K))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac}),e})(),qf=(()=>{class e{static forRoot(){return{ngModule:e}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},providers:[Bf],imports:[[m.c,ie,_o,bi,Hs,Ue.m,c.b,n.c,De.b,Pe.q,h.b,ke.e,qe.g,Ve.c]]}),e})(),Gf=(()=>{class e{static forRoot(){return{ngModule:e}}}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,Ue.m,Ue.C,ke.e,Ve.c,c.b,n.c,h.b,l.e,b.b,Sn.c,qe.g,f.c,Pe.q,mn.b,Hs,Ai,Fi,$o,bi,ie,af,qf,To]]}),e})();var Vf=function(e){return e.layer="layer",e.context="context",e}({}),Uf=function(e){return e.import="import",e.export="export",e}({});let Hf=(()=>{class e{constructor(){this.importExportType$=new C.a(Vf.layer),this.selectedMode$=new C.a(Uf.import),this.exportOptions$=new C.a(void 0)}setImportExportType(e){this.importExportType$.next(e)}setMode(e){this.selectedMode$.next(e)}setsExportOptions(e){this.exportOptions$.next(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Yf=(()=>{class e{constructor(e,t){this.toolService=e,this.importExportState=t,this.openSidenav$=new C.a(void 0)}get toolbox(){return this.toolService.toolbox}toolToActivateFromOptions(e){if(e){if("importExport"===e.tool){let t=this.importExportState.exportOptions$.value;t?(t.layers=e.options.layers,t.featureInMapExtent=e.options.featureInMapExtent):t={layers:e.options.layers,featureInMapExtent:e.options.featureInMapExtent},this.importExportState.setsExportOptions(t),this.importExportState.setMode(Uf.export)}this.toolbox.getTool(e.tool)&&(this.toolbox.activateTool(e.tool),this.openSidenav$.next(!0))}}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(xi),Object(i.qc)(Hf))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Wf=(()=>{class e{constructor(e){this.igoStorageService=e}get storageService(){return this.igoStorageService}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(Oe))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Kf(e,t){e.entityStore.getStrategyOfType(hl).setMotion(t.get("zoomAuto")?el.Default:el.None)}let Zf=(()=>{class e{constructor(e,t,o,i){this.storageState=e,this.languageService=t,this.toolState=o,this.mediaService=i,this.maximize$=new C.a(this.storageService.get("workspaceMaximize")),this.zoomAuto$=new C.a(!1)}get storageService(){return this.storageState.storageService}get zoomAuto(){return this.storageService.get("zoomAuto")}ngOnDestroy(){this.storageChange$$&&this.storageChange$$.unsubscribe()}loadActions(e,t,o){const i=this.buildActions(e,t,o);e.actionStore.load(i)}buildActions(e,t,o){return this.zoomAuto$.next(this.zoomAuto),this.storageChange$$=this.storageService.storageChange$.pipe(Object(ta.a)(e=>"zoomAuto"!==e.key||e.event===ye.CLEARED)).subscribe(()=>{this.zoomAuto$.next(this.zoomAuto),Kf(e,this.storageService)}),[{id:"zoomAuto",checkbox:!0,title:"igo.integration.workspace.zoomAuto.title",tooltip:"igo.integration.workspace.zoomAuto.tooltip",checkCondition:this.zoomAuto$,handler:()=>{Kf(e,this.storageService),this.storageService.set("zoomAuto",!this.storageService.get("zoomAuto"))}},{id:"filterInMapExtent",checkbox:!0,title:"igo.integration.workspace.inMapExtent.title",tooltip:Ib(e),checkCondition:t,handler:()=>t.next(!t.value)},{id:"selectedOnly",checkbox:!0,title:"igo.integration.workspace.selected.title",tooltip:"igo.integration.workspace.selected.tooltip",checkCondition:o,handler:()=>o.next(!o.value)},{id:"clearselection",icon:"select-off",title:"igo.integration.workspace.clearSelection.title",tooltip:"igo.integration.workspace.clearSelection.tooltip",handler:e=>{e.entityStore.state.updateMany(e.entityStore.view.all(),{selected:!1})},args:[e],availability:e=>Fb(e)},{id:"featureDownload",icon:"file-export",title:"igo.integration.workspace.download.title",tooltip:"igo.integration.workspace.download.tooltip",handler:e=>{const t=e.entityStore.getStrategyOfType(lt),o=e.entityStore.getStrategyOfType(ut);this.toolState.toolToActivateFromOptions({tool:"importExport",options:{layers:[e.layer.id],featureInMapExtent:t.active,layersWithSelection:o.active?[e.layer.id]:[]}})},args:[e]},{id:"maximize",title:this.languageService.translate.instant("igo.integration.workspace.maximize"),tooltip:this.languageService.translate.instant("igo.integration.workspace.maximizeTooltip"),icon:"resize",display:()=>this.maximize$.pipe(Object(j.a)(e=>!e&&!this.mediaService.isMobile())),handler:()=>{this.mediaService.isMobile()||this.maximize$.next(!0)}},{id:"standardExtent",title:this.languageService.translate.instant("igo.integration.workspace.standardExtent"),tooltip:this.languageService.translate.instant("igo.integration.workspace.standardExtentTooltip"),icon:"resize",display:()=>this.maximize$.pipe(Object(j.a)(e=>e&&!this.mediaService.isMobile())),handler:()=>{this.maximize$.next(!1)}}]}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(Wf),Object(i.qc)(le),Object(i.qc)(Yf),Object(i.qc)(be))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Qf=(()=>{class e{constructor(e,t,o,i,r){this.ogcFilterWidget=e,this.storageState=t,this.languageService=o,this.mediaService=i,this.toolState=r,this.maximize$=new C.a(this.storageService.get("workspaceMaximize")),this.selectOnlyCheckCondition$=new C.a(!1),this.zoomAuto$=new C.a(!1)}get storageService(){return this.storageState.storageService}get zoomAuto(){return this.storageService.get("zoomAuto")}ngOnDestroy(){this.storageChange$$&&this.storageChange$$.unsubscribe()}loadActions(e,t,o){const i=this.buildActions(e,t,o);e.actionStore.load(i)}buildActions(e,t,o){var i,r;this.zoomAuto$.next(this.zoomAuto),this.storageChange$$=this.storageService.storageChange$.pipe(Object(ta.a)(e=>"zoomAuto"!==e.key||e.event===ye.CLEARED)).subscribe(()=>{this.zoomAuto$.next(this.zoomAuto),Kf(e,this.storageService)});const s=[{id:"zoomAuto",checkbox:!0,title:"igo.integration.workspace.zoomAuto.title",tooltip:"igo.integration.workspace.zoomAuto.tooltip",checkCondition:this.zoomAuto$,handler:()=>{Kf(e,this.storageService),this.storageService.set("zoomAuto",!this.storageService.get("zoomAuto"))}},{id:"filterInMapExtent",checkbox:!0,title:"igo.integration.workspace.inMapExtent.title",tooltip:Ib(e),checkCondition:t,handler:()=>t.next(!t.value)},{id:"selectedOnly",checkbox:!0,title:"igo.integration.workspace.selected.title",tooltip:"igo.integration.workspace.selected.title",checkCondition:o,handler:()=>o.next(!o.value)},{id:"clearselection",icon:"select-off",title:"igo.integration.workspace.clearSelection.title",tooltip:"igo.integration.workspace.clearSelection.tooltip",handler:e=>{e.entityStore.state.updateMany(e.entityStore.view.all(),{selected:!1})},args:[e],availability:e=>Fb(e)},{id:"wfsDownload",icon:"file-export",title:"igo.integration.workspace.download.title",tooltip:"igo.integration.workspace.download.tooltip",handler:e=>{const t=e.entityStore.getStrategyOfType(lt),o=e.entityStore.getStrategyOfType(ut);this.toolState.toolToActivateFromOptions({tool:"importExport",options:{layers:[e.layer.id],featureInMapExtent:t.active,layersWithSelection:o.active?[e.layer.id]:[]}})},args:[e]},{id:"ogcFilter",icon:"filter",title:"igo.integration.workspace.ogcFilter.title",tooltip:"igo.integration.workspace.ogcFilter.tooltip",handler:(e,t)=>{t.activateWidget(e,{map:t.map,layer:t.layer})},args:[this.ogcFilterWidget,e]},{id:"maximize",title:this.languageService.translate.instant("igo.integration.workspace.maximize"),tooltip:this.languageService.translate.instant("igo.integration.workspace.maximizeTooltip"),icon:"resize",display:()=>this.maximize$.pipe(Object(j.a)(e=>!e&&!this.mediaService.isMobile())),handler:()=>{this.mediaService.isMobile()||this.maximize$.next(!0)}},{id:"standardExtent",title:this.languageService.translate.instant("igo.integration.workspace.standardExtent"),tooltip:this.languageService.translate.instant("igo.integration.workspace.standardExtentTooltip"),icon:"resize",display:()=>this.maximize$.pipe(Object(j.a)(e=>e&&!this.mediaService.isMobile())),handler:()=>{this.maximize$.next(!1)}}];return(null===(r=null===(i=e.layer.dataSource.ogcFilters$)||void 0===i?void 0:i.value)||void 0===r?void 0:r.enabled)?s:s.filter(e=>"ogcFilter"!==e.id)}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(ib),Object(i.qc)(Wf),Object(i.qc)(le),Object(i.qc)(be),Object(i.qc)(Yf))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Jf=(()=>{class e{constructor(e,t,o){this.featureActionsService=e,this.wfsActionsService=t,this.storageService=o,this.workspacePanelExpanded=!1,this.workspaceEnabled$=new C.a(!1),this.rowsInMapExtentCheckCondition$=new C.a(!0),this.selectOnlyCheckCondition$=new C.a(!1),this.workspaceMaximize$=new C.a(this.storageService.get("workspaceMaximize")),this.actionMaximize$$=[],this.activeWorkspaceWidget$=new C.a(void 0),this.workspace$=new C.a(void 0),this.initWorkspaces()}get store(){return this._store}initWorkspaces(){this._store=new Lr([]),this._store.stateView.firstBy$(e=>!0===e.state.active).subscribe(e=>{this.workspace$.next(e?e.entity:void 0)}),this._store.stateView.all$().subscribe(e=>{e.map(e=>{e.entity.actionStore.empty&&(e.entity instanceof nb?this.wfsActionsService.loadActions(e.entity,this.rowsInMapExtentCheckCondition$,this.selectOnlyCheckCondition$):e.entity instanceof ub&&this.featureActionsService.loadActions(e.entity,this.rowsInMapExtentCheckCondition$,this.selectOnlyCheckCondition$))})}),this.actionMaximize$$.push(this.featureActionsService.maximize$.subscribe(e=>{this.setWorkspaceIsMaximized(e)})),this.actionMaximize$$.push(this.wfsActionsService.maximize$.subscribe(e=>{this.setWorkspaceIsMaximized(e)})),this.activeWorkspace$$=this.workspace$.subscribe(e=>{void 0!==this.activeWorkspaceWidget$$&&(this.activeWorkspaceWidget$$.unsubscribe(),this.activeWorkspaceWidget$$=void 0),void 0!==e&&(this.activeWorkspaceWidget$$=e.widget$.subscribe(e=>this.activeWorkspaceWidget$.next(e)))}),this.rowsInMapExtentCheckCondition$$=this.rowsInMapExtentCheckCondition$.subscribe(e=>{this._store.stateView.all().map(t=>{if(!t.entity.actionStore.empty){const o=t.entity.entityStore.getStrategyOfType(lt);o&&(e?o.activate():o.deactivate())}})}),this.selectOnlyCheckCondition$$=this.selectOnlyCheckCondition$.subscribe(e=>{this._store.stateView.all().map(t=>{if(!t.entity.actionStore.empty){const o=t.entity.entityStore.getStrategyOfType(ut);o&&(e?o.activate():o.deactivate())}})})}setWorkspaceIsMaximized(e){this.storageService.set("workspaceMaximize",e),this.workspaceMaximize$.next(e)}setActiveWorkspaceById(e){const t=this.store.all().find(t=>t.id===e);t&&this.store.activateWorkspace(t)}ngOnDestroy(){this.teardownWorkspaces(),this.actionMaximize$$.map(e=>e.unsubscribe()),this.rowsInMapExtentCheckCondition$$&&this.selectOnlyCheckCondition$$.unsubscribe(),this.selectOnlyCheckCondition$$&&this.selectOnlyCheckCondition$$.unsubscribe()}teardownWorkspaces(){this.store.clear(),void 0!==this.activeWorkspaceWidget$$&&this.activeWorkspaceWidget$$.unsubscribe(),void 0!==this.activeWorkspace$$&&this.activeWorkspace$$.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(Zf),Object(i.qc)(Qf),Object(i.qc)(Oe))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Xf=(()=>{class e{constructor(e,t,o){this.searchSourceService=e,this.storageService=t,this.configService=o,this.searchOverlayStyle={},this.searchOverlayStyleSelection={},this.searchOverlayStyleFocus={},this.searchTermSplitter$=new C.a("|"),this.searchTerm$=new C.a(void 0),this.searchType$=new C.a(void 0),this.searchDisabled$=new C.a(!1),this.searchResultsGeometryEnabled$=new C.a(!1),this.searchSettingsChange$=new C.a(void 0),this.selectedResult$=new C.a(void 0),this.store=new at([]);const i=this.configService.getConfig("searchOverlayStyle");i&&(this.searchOverlayStyle=i.base,this.searchOverlayStyleSelection=i.selection,this.searchOverlayStyleFocus=i.focus);const r=this.storageService.get("searchResultsGeometryEnabled");r&&this.searchResultsGeometryEnabled$.next(r),this.store.addStrategy(this.createCustomFilterTermStrategy(),!1)}get searchTypes(){return this.searchSourceService.getEnabledSources().map(e=>e.constructor.type)}createCustomFilterTermStrategy(){return new lt({filterClauseFunc:e=>100===e.entity.meta.score})}activateCustomFilterTermStrategy(){const e=this.store.getStrategyOfType(lt);void 0!==e&&e.activate()}deactivateCustomFilterTermStrategy(){const e=this.store.getStrategyOfType(lt);void 0!==e&&e.deactivate()}enableSearch(){this.searchDisabled$.next(!1)}disableSearch(){this.searchDisabled$.next(!0)}setSearchTerm(e){this.searchTerm$.next(e)}setSearchType(e){this.searchSourceService.enableSourcesByType(e),this.searchType$.next(e)}setSearchSettingsChange(){this.searchSettingsChange$.next(!0)}setSelectedResult(e){this.selectedResult$.next(e)}setSearchResultsGeometryStatus(e){this.storageService.set("searchResultsGeometryEnabled",e),this.searchResultsGeometryEnabled$.next(e)}}return e.\u0275fac=function(t){return new(t||e)(Object(i.qc)(um),Object(i.qc)(Oe),Object(i.qc)(K))},e.\u0275prov=Object(i.cc)({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),ey=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[tb]]}),e})(),ty=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[m.c,c.b,Be.b,h.b,n.c,ie,Zd,tb,Zo,zi,Wd,Bo]]}),e})(),oy=(()=>{class e{}return e.\u0275mod=Object(i.ec)({type:e}),e.\u0275inj=Object(i.dc)({factory:function(t){return new(t||e)},imports:[[],ey,ty]}),e})();const iy=["mapBrowser"];function ry(e,t){1&e&&(i.mc(0,"span",11),i.ad(1," F2 activate/deactivate the pointer location. "),i.lc())}function sy(e,t){if(1&e&&i.hc(0,"igo-search-add-button",12),2&e){const e=t.result,o=i.xc();i.Dc("map",o.map)("layer",e)}}function ay(e,t){if(1&e&&(i.mc(0,"igo-panel",11),i.hc(1,"igo-feature-details",13),i.lc()),2&e){const e=i.xc();i.Tb(1),i.Dc("feature",e.selectedFeature)}}function ny(e,t){if(1&e&&i.hc(0,"igo-actionbar",14),2&e){const e=i.xc();i.Dc("store",e.store)("withIcon",!1)("horizontal",!0)("mode","context")}}const cy=p.e.forChild([{path:"search",component:(()=>{class e{constructor(e,t,o,i,r,s,a){this.languageService=e,this.projectionService=t,this.mapService=o,this.layerService=i,this.searchState=r,this.searchService=s,this.mediaService=a,this.store=new ao([]),this.igoSearchPointerSummaryEnabled=!1,this.termSplitter="|",this.map=new vl({overlay:!0,controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:7},this.settingsChange$=new C.a(void 0),this.mapService.setMap(this.map),this.layerService.createAsyncLayer({title:"OSM",sourceOptions:{type:"osm"}}).subscribe(e=>{this.osmLayer=e,this.map.addLayer(e)})}get searchStore(){return this.searchState.store}get isTouchScreen(){return this.mediaService.isTouchScreen()}onPointerSummaryStatusChange(e){this.igoSearchPointerSummaryEnabled=e}onSearchTermChange(e=""){this.term=e,e.replace(/(#[^\s]*)/g,"").trim().length<2&&(this.searchStore.clear(),this.selectedFeature=void 0)}onSearch(e){const t=e.results;this.searchStore.state.updateAll({focused:!1,selected:!1});const o=this.searchStore.entities$.value.filter(t=>t.source!==e.research.source).concat(t);this.searchStore.updateMany(o)}onSearchSettingsChange(){this.settingsChange$.next(!0)}onResultFocus(e){this.tryAddFeatureToMap(e),this.selectedFeature=e.data}tryAddFeatureToMap(e){e.meta.dataType===Xc&&void 0!==e.data.geometry&&this.map.searchResultsOverlay.setFeatures([e.data],el.Default)}ngOnInit(){this.store.load([{id:"coordinates",title:"coordinates",handler:this.onSearchCoordinate.bind(this)},{id:"googleMaps",title:"googleMap",handler:this.onOpenGoogleMaps.bind(this),args:["1"]},{id:"googleStreetView",title:"googleStreetView",handler:this.onOpenGoogleStreetView.bind(this)}])}ngOnDestroy(){this.store.destroy()}removeFeatureFromMap(){this.map.searchResultsOverlay.clear()}onContextMenuOpen(e){const t=this.mapPosition(e),o=this.mapService.getMap().ol.getCoordinateFromPixel(t);this.mapProjection=this.mapService.getMap().projection,this.lonlat=sa.s(o,this.mapProjection,"EPSG:4326")}mapPosition(e){const t=e;return t.y=t.y-this.mapBrowser.nativeElement.getBoundingClientRect().top+window.scrollY,t.x=t.x-this.mapBrowser.nativeElement.getBoundingClientRect().left+window.scrollX,[t.x,t.y]}onPointerSearch(e){this.lonlat=e,this.onSearchCoordinate()}onSearchCoordinate(){this.searchStore.clear();const e=this.searchService.reverseSearch(this.lonlat);for(const t in e)e.length>0&&e[t].request.subscribe(o=>{this.onSearch({research:e[t],results:o})})}onOpenGoogleMaps(){window.open(Kl.getGoogleMapsCoordLink(this.lonlat[0],this.lonlat[1]))}onOpenGoogleStreetView(){window.open(Kl.getGoogleStreetViewLink(this.lonlat[0],this.lonlat[1]))}}return e.\u0275fac=function(t){return new(t||e)(i.gc(le),i.gc(Bc),i.gc(jl),i.gc(Jc),i.gc(Xf),i.gc(bm),i.gc(be))},e.\u0275cmp=i.ac({type:e,selectors:[["app-search"]],viewQuery:function(e,t){var o;1&e&&i.Uc(iy,!0,i.r),2&e&&i.Jc(o=i.uc())&&(t.mapBrowser=o.first)},decls:31,vars:15,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/search"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/environments"],["title","Details",4,"ngIf"],["igoOverlay","","igoSearchPointerSummary","",3,"map","view","igoContextMenu","igoSearchPointerSummaryDelay","igoSearchPointerSummaryEnabled","menuPosition"],["mapBrowser",""],["color","primary",3,"map"],["title","Search"],[3,"searchSettings","store","termSplitter","pointerSummaryStatus","searchTermChange","search","clearFeature","searchSettingsChange"],["placeholder","false",3,"store","term","termSplitter","settingsChange$","resultFocus","resultSelect","moreResults"],["igoSearchItemToolbar",""],["actionbarMenu",""],["title","Details"],[3,"map","layer"],[3,"feature"],[3,"store","withIcon","horizontal","mode"]],template:function(e,t){if(1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Geo"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Search"),i.lc(),i.mc(5,"mat-card-content"),i.mc(6,"li"),i.ad(7,"Dependencies: ConfigService, LanguageService"),i.lc(),i.hc(8,"br"),i.ad(9," See the "),i.mc(10,"a",0),i.ad(11,"code of this example"),i.lc(),i.hc(12,"br"),i.ad(13," See search section of the "),i.mc(14,"a",1),i.ad(15," environment config"),i.lc(),i.hc(16,"hr"),i.hc(17,"br"),i.Yc(18,ry,2,0,"span",2),i.lc(),i.mc(19,"igo-map-browser",3,4),i.tc("menuPosition",(function(e){return t.onContextMenuOpen(e)})),i.hc(21,"igo-zoom-button",5),i.lc(),i.mc(22,"igo-panel",6),i.mc(23,"igo-search-bar",7),i.tc("pointerSummaryStatus",(function(e){return t.onPointerSummaryStatusChange(e)}))("searchTermChange",(function(e){return t.onSearchTermChange(e)}))("search",(function(e){return t.onSearch(e)}))("clearFeature",(function(){return t.removeFeatureFromMap()}))("searchSettingsChange",(function(){return t.onSearchSettingsChange()})),i.lc(),i.mc(24,"igo-search-results",8),i.tc("resultFocus",(function(e){return t.onResultFocus(e)}))("resultSelect",(function(e){return t.onResultFocus(e)}))("moreResults",(function(e){return t.onSearch(e)})),i.Yc(25,sy,1,2,"ng-template",null,9,i.Zc),i.lc(),i.lc(),i.Yc(27,ay,2,1,"igo-panel",2),i.lc(),i.Yc(28,ny,1,4,"ng-template",null,10,i.Zc),i.hc(30,"igo-message-center")),2&e){const e=i.Kc(29);i.Tb(18),i.Dc("ngIf",!t.isTouchScreen),i.Tb(1),i.Dc("map",t.map)("view",t.view)("igoContextMenu",e)("igoSearchPointerSummaryDelay",500)("igoSearchPointerSummaryEnabled",t.igoSearchPointerSummaryEnabled),i.Tb(2),i.Dc("map",t.map),i.Tb(2),i.Dc("searchSettings",!0)("store",t.searchStore)("termSplitter",t.termSplitter),i.Tb(1),i.Dc("store",t.searchStore)("term",t.term)("termSplitter",t.termSplitter)("settingsChange$",t.settingsChange$),i.Tb(3),i.Dc("ngIf",t.selectedFeature)}},directives:[g.a,g.e,g.f,g.c,m.t,Sl,Xg,zo,Il,_i,Ig,Kg,se,Qg,ud,Co],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{height:100%;width:100%;padding-top:10px}"]}),e})()}]);let ly=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},providers:[{provide:Yl,useFactory:Jm,multi:!0,deps:[K,le,Oe,Bc]},{provide:Yl,useFactory:jb,multi:!0,deps:[y.b,le,Oe,K]},{provide:Yl,useFactory:Ym,multi:!0,deps:[y.b,le,Oe,K,qm,i.C]},{provide:Yl,useFactory:og,multi:!0,deps:[y.b,le,Oe,K,Xm]},{provide:Yl,useFactory:Sb,multi:!0,deps:[y.b,K,Oe]},{provide:Yl,useFactory:Wm,multi:!0,deps:[y.b,le,Oe,K,i.C]},{provide:Yl,useFactory:Tb,multi:!0,deps:[y.b,le,Oe,K]},{provide:Yl,useFactory:Lb,multi:!0,deps:[y.b,le,Oe,K]}],imports:[[m.c,cy,g.d,n.c,c.b,h.b,ae.forRoot(),zi,Bp,tb.forRoot(),oy,To,No,Zd]]}),e})();const uy=p.e.forChild([{path:"print",component:(()=>{class e{constructor(e,t){this.languageService=e,this.layerService=t,this.map=new vl({controls:{attribution:{collapsed:!1}}}),this.view={center:[-73,47.2],zoom:9},this.layerService.createAsyncLayer({title:"Quebec Base Map",sourceOptions:{type:"wmts",url:"https://geoegl.msp.gouv.qc.ca/apis/carto/wmts/1.0.0/wmts",layer:"carte_gouv_qc_ro",matrixSet:"EPSG_3857",version:"1.3.0",crossOrigin:"anonymous",attributions:"\xa9 <a href='http://www.droitauteur.gouv.qc.ca/copyright.php' target='_blank'><img src='https://geoegl.msp.gouv.qc.ca/gouvouvert/public/images/quebec/gouv_qc_logo.png' width='64' height='14'>Gouvernement du Qu\xe9bec</a> / <a href='https://www.igouverte.org/' target='_blank'>IGO2</a>"}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"School board",sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{LAYERS:"MELS_CS_ANGLO_S",VERSION:"1.3.0"},crossOrigin:"anonymous"}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"Embacle",sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{LAYERS:"vg_observation_v_inondation_embacle_wmst",VERSION:"1.3.0"},crossOrigin:"anonymous"}}).subscribe(e=>this.map.addLayer(e))}}return e.\u0275fac=function(t){return new(t||e)(i.gc(le),i.gc(Jc))},e.\u0275cmp=i.ac({type:e,selectors:[["app-print"]],decls:29,vars:7,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/print"],[3,"map","view"],["color","primary",3,"map"],["color","primary",3,"map","showIfNoRotation"],[3,"map"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Geo"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Print"),i.lc(),i.mc(5,"mat-card-content"),i.mc(6,"li"),i.ad(7,"npm install --save html2canvas@1.0.0-alpha.12"),i.lc(),i.mc(8,"li"),i.ad(9,"npm install --save jspdf@1.4.1"),i.lc(),i.mc(10,"li"),i.ad(11,"npm install --save file-saver@1.3.8"),i.lc(),i.mc(12,"li"),i.ad(13,"npm install --save jszip@3.1.5"),i.lc(),i.mc(14,"li"),i.ad(15,"npm install --save stream@0.0.2"),i.lc(),i.mc(16,"li"),i.ad(17,"Dependencies: LanguageService"),i.lc(),i.hc(18,"br"),i.ad(19," See the "),i.mc(20,"a",0),i.ad(21,"code of this example"),i.lc(),i.hc(22,"hr"),i.lc(),i.mc(23,"igo-map-browser",1),i.hc(24,"igo-zoom-button",2),i.hc(25,"igo-geolocate-button",2),i.hc(26,"igo-rotation-button",3),i.lc(),i.hc(27,"igo-print",4),i.lc(),i.hc(28,"igo-message-center")),2&e&&(i.Tb(23),i.Dc("map",t.map)("view",t.view),i.Tb(1),i.Dc("map",t.map),i.Tb(1),i.Dc("map",t.map),i.Tb(1),i.Dc("map",t.map)("showIfNoRotation",!1),i.Tb(1),i.Dc("map",t.map))},directives:[g.a,g.e,g.f,g.c,Sl,Il,Fl,Dl,am,se],styles:["igo-map-browser[_ngcontent-%COMP%]{width:900px;height:1000px}"]}),e})()}]);let dy=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[uy,g.d,n.c,ae,Bp,nm]]}),e})();const hy=p.e.forChild([{path:"import-export",component:(()=>{class e{constructor(e,t){this.languageService=e,this.layerService=t,this.map=new vl({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:9},this.layerService.createAsyncLayer({title:"OSM",sourceOptions:{type:"osm"}}).subscribe(e=>this.map.addLayer(e))}}return e.\u0275fac=function(t){return new(t||e)(i.gc(le),i.gc(Jc))},e.\u0275cmp=i.ac({type:e,selectors:[["app-import-export"]],decls:17,vars:4,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/import-export"],[3,"map","view"],["color","primary",3,"map"],[3,"map"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Geo"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Import / Export"),i.lc(),i.mc(5,"mat-card-content"),i.mc(6,"li"),i.ad(7,"Dependencies: LanguageService"),i.lc(),i.hc(8,"br"),i.ad(9," See the "),i.mc(10,"a",0),i.ad(11,"code of this example"),i.lc(),i.hc(12,"hr"),i.lc(),i.mc(13,"igo-map-browser",1),i.hc(14,"igo-zoom-button",2),i.lc(),i.hc(15,"igo-import-export",3),i.lc(),i.hc(16,"igo-message-center")),2&e&&(i.Tb(13),i.Dc("map",t.map)("view",t.view),i.Tb(1),i.Dc("map",t.map),i.Tb(1),i.Dc("map",t.map))},directives:[g.a,g.e,g.f,g.c,Sl,Il,$p,se],styles:["igo-map-browser[_ngcontent-%COMP%]{width:900px;height:1000px}"]}),e})()}]);let py=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},providers:[Rp({path:"./assets/import-style.json"})],imports:[[hy,g.d,n.c,ae,Bp,Np]]}),e})();const my=p.e.forChild([{path:"directions",component:(()=>{class e{constructor(e,t,o,i){this.projectionService=e,this.languageService=t,this.layerService=o,this.mapService=i,this.map=new vl({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:9,geolocate:!0},this.stopsStore=new al([],{map:this.map}),this.routeStore=new al([],{map:this.map}),this.mapService.setMap(this.map),this.layerService.createAsyncLayer({title:"OSM",sourceOptions:{type:"osm"}}).subscribe(e=>this.map.addLayer(e))}}return e.\u0275fac=function(t){return new(t||e)(i.gc(Bc),i.gc(le),i.gc(Jc),i.gc(jl))},e.\u0275cmp=i.ac({type:e,selectors:[["app-directions"]],decls:18,vars:9,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/directions"],[3,"map","view"],["color","primary",3,"map"],["color","primary",3,"map","showIfNoRotation"],[3,"stopsStore","routeStore","map"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Geo"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Directions"),i.lc(),i.mc(5,"mat-card-content"),i.mc(6,"li"),i.ad(7,"Dependencies: LanguageService"),i.lc(),i.hc(8,"br"),i.ad(9," See the "),i.mc(10,"a",0),i.ad(11,"code of this example"),i.lc(),i.hc(12,"hr"),i.lc(),i.mc(13,"igo-map-browser",1),i.hc(14,"igo-zoom-button",2),i.hc(15,"igo-geolocate-button",2),i.hc(16,"igo-rotation-button",3),i.lc(),i.hc(17,"igo-directions-form",4),i.lc()),2&e&&(i.Tb(13),i.Dc("map",t.map)("view",t.view),i.Tb(1),i.Dc("map",t.map),i.Tb(1),i.Dc("map",t.map),i.Tb(1),i.Dc("map",t.map)("showIfNoRotation",!1),i.Tb(1),i.Dc("stopsStore",t.stopsStore)("routeStore",t.routeStore)("map",t.map))},directives:[g.a,g.e,g.f,g.c,Sl,Il,Fl,Dl,_m],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}"]}),e})()}]);let gy=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},providers:[{provide:fm,useFactory:Ob,multi:!0,deps:[y.b,K]}],imports:[[my,g.d,n.c,ae,Bp,Nm]]}),e})();const by=p.e.forChild([{path:"time-filter",component:(()=>{class e{constructor(e,t,o){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.map=new vl({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:7},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://geoegl.msp.gouv.qc.ca/ws/igo_gouvouvert.fcgi",params:{LAYERS:"vg_observation_v_inondation_embacle_wmst",VERSION:"1.3.0"},timeFilterable:!0,timeFilter:{min:"2013",max:"2019",range:!1,type:Ec.YEAR,style:Rc.SLIDER,step:1,timeInterval:2e3}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle YEAR",visible:!0,source:e}))})}}return e.\u0275fac=function(t){return new(t||e)(i.gc(le),i.gc(qc),i.gc(Jc))},e.\u0275cmp=i.ac({type:e,selectors:[["app-time-filter"]],decls:21,vars:4,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/time-filter"],[3,"map","view"],["color","primary",3,"map"],["title","Layers"],[3,"layers"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Geo"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Time filter"),i.lc(),i.mc(5,"mat-card-content"),i.mc(6,"li"),i.ad(7,"npm install --save moment@2.22.2"),i.lc(),i.mc(8,"li"),i.ad(9,"npm install --save @mat-datetimepicker/core@3.0.0-beta.0"),i.lc(),i.mc(10,"li"),i.ad(11,"Dependencies: LanguageService"),i.lc(),i.hc(12,"br"),i.ad(13," See the "),i.mc(14,"a",0),i.ad(15,"code of this example"),i.lc(),i.hc(16,"hr"),i.lc(),i.mc(17,"igo-map-browser",1),i.hc(18,"igo-zoom-button",2),i.lc(),i.mc(19,"igo-panel",3),i.hc(20,"igo-time-filter-list",4),i.lc(),i.lc()),2&e&&(i.Tb(17),i.Dc("map",t.map)("view",t.view),i.Tb(1),i.Dc("map",t.map),i.Tb(2),i.Dc("layers",t.map.layers))},directives:[g.a,g.e,g.f,g.c,Sl,Il,_i,lh],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),e})()}]);let fy=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[by,g.d,n.c,c.b,zi,Bp,Yh]]}),e})();const yy=p.e.forChild([{path:"ogc-filter",component:(()=>{class e{constructor(e,t,o){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.map=new vl({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:7},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"code_municipalite",alias:"# de la municipalit\xe9e"},{name:"date_observation",excludeFromOgcFilters:!0},{name:"urgence",values:["imm\xe9diate","inconnue"]}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:Xn.All,filters:{logical:"Or",filters:[{operator:"PropertyIsEqualTo",propertyName:"code_municipalite",expression:"10043"},{operator:"Intersects",geometryName:"the_geom",wkt_geometry:"MULTIPOLYGON(((\n              -8379441.158019895 5844447.897707146,\n              -8379441.158019895 5936172.331649357,\n              -8134842.66750733 5936172.331649357,\n              -8134842.66750733 5844447.897707146,\n              -8379441.158019895 5844447.897707146\n            ), (\n              -8015003 5942074,\n              -8015003 5780349,\n              -7792364 5780349,\n              -7792364 5942074,\n              -8015003 5942074\n            )))"}]}}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle (PropertyIsEqualTo OR Intersects)",source:e,style:{circle:{radius:5,fill:{color:"white"},stroke:{color:"orange",width:1}}}}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:Xn.All,filters:{operator:"During",propertyName:"date_observation",begin:"2016-01-21T00:00:00-05:00",end:"2016-01-26T00:00:00-05:00"}},minDate:"2016-01-01T00:00:00-05:00",maxDate:"2016-02-10T00:00:00-05:00",stepDate:"P2D"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle (During, Step: P2D)",id:"1",source:e,style:{circle:{radius:5,fill:{color:"white"},stroke:{color:"red",width:1}}}}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:Xn.All,filters:{operator:"During",propertyName:"date_observation",begin:"2016-01-01T04:00:00-05:00",end:"2016-01-12T16:00:00-05:00"}},minDate:"2016-01-01T00:00:00-05:00",maxDate:"2016-02-14T20:00:00-05:00",stepDate:"PT4H"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle (During, Step: PT4H)",id:"2",source:e,style:{circle:{radius:5,fill:{color:"white"},stroke:{color:"blue",width:1}}}}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:Xn.All,filters:{operator:"During",propertyName:"date_observation",begin:"2016-01-01T00:00:00-05:00",end:"2016-03-31T00:00:00-05:00",displayFormat:"MMMM"}},minDate:"2016-01-01T00:00:00-05:00",maxDate:"2018-12-31T00:00:00-05:00",stepDate:"P1M"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle (During, Step: P1M)",id:"3",source:e,style:{circle:{radius:5,fill:{color:"white"},stroke:{color:"yellow",width:1}}}}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:Xn.All,filters:{operator:"During",propertyName:"date_observation",begin:"2014-01-01T00:00:00-05:00",end:"2019-12-31T00:00:00-05:00",sliderOptions:{interval:2e3,displayFormat:"YY"},displayFormat:"YYYY"}},minDate:"2014-01-01T00:00:00-05:00",maxDate:"2019-12-31T00:00:00-05:00",stepDate:"P1Y"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle (During, Step: P1Y)",id:"4",source:e,style:{circle:{radius:5,fill:{color:"white"},stroke:{color:"green",width:1}}}}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:Xn.All,filters:{operator:"During",propertyName:"date_observation",begin:"today - 2 days",end:"today"}},minDate:"2016-01-01T00:00:00-05:00",maxDate:"2025-12-31T00:00:00-05:00",stepDate:"P1D"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle (During, Interval from Now, Step: P1D)",id:"5",source:e,style:{circle:{radius:5,fill:{color:"white"},stroke:{color:"black",width:1}}}}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:Xn.All,filters:{operator:"During",propertyName:"date_observation",begin:"2019-01-01 00:00:00",restrictToStep:!0}},minDate:"2016-01-01T00:00:00-05:00",maxDate:"2025-12-31T00:00:00-05:00",stepDate:"P1M"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle (During, RestrictToStep, Step: P1M)",id:"6",source:e,style:{circle:{radius:5,fill:{color:"black"},stroke:{color:"red",width:1}}}}))}),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"vg_observation_v_inondation23avril2017_wmst",VERSION:"1.3.0"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,filters:{operator:"During",propertyName:"date_observation"},allowedOperatorsType:Xn.Time}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Inondation (During, optionsFromCapabilities)",source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/swtq",urlWfs:"https://geoegl.msp.gouv.qc.ca/apis/ws/swtq",params:{LAYERS:"radars_photos",VERSION:"1.3.0"},ogcFilters:{enabled:!0,editable:!0,pushButtons:{selectorType:"pushButton",order:2,groups:[{title:"Nom du group1 - push",name:"1 - push",ids:["id1"]}],bundles:[{id:"id1",title:"R\xe9gions",logical:"Or",vertical:!0,selectors:[{title:"Montr\xe9al & Laval",enabled:!1,tooltip:"Here a tooltip explaning ...",filters:{logical:"Or",filters:[{operator:"PropertyIsEqualTo",propertyName:"region",expression:"Montr\xe9al"},{operator:"PropertyIsEqualTo",propertyName:"region",expression:"Laval"}]}},{title:"Outside Montr\xe9al & Laval",enabled:!1,tooltip:"Here a tooltip explaning ...",filters:{logical:"And",filters:[{operator:"PropertyIsNotEqualTo",propertyName:"region",expression:"Montr\xe9al"},{operator:"PropertyIsNotEqualTo",propertyName:"region",expression:"Laval"}]}}]}]},checkboxes:{selectorType:"checkbox",order:1,groups:[{title:"Nom du group1 - checkbox",name:"1 - checkbox",ids:["id1"]}],bundles:[{id:"id1",title:"Type de radar photo",logical:"Or",selectors:[{title:"Radar photo fixe",enabled:!0,tooltip:"Here a tooltip explaning ...",filters:{operator:"PropertyIsEqualTo",propertyName:"typeAppareil",expression:"Radar photo fixe"}},{title:"Radar photo mobile",enabled:!1,tooltip:"Here a tooltip explaning ...",filters:{operator:"PropertyIsEqualTo",propertyName:"typeAppareil",expression:"Radar photo mobile"}},{title:"Radar photo fixe + feu rouge",enabled:!1,color:"0,200,0",tooltip:"Here a tooltip explaning ...",filters:{operator:"PropertyIsEqualTo",propertyName:"typeAppareil",expression:"Radar photo fixe et surveillance au feu rouge"}},{title:"Radar feu rouge",enabled:!1,color:"255,0,0",tooltip:"Here a tooltip explaning ...",filters:{operator:"PropertyIsEqualTo",propertyName:"typeAppareil",expression:"Appareil de surveillance au feu rouge"}}]}]},allowedOperatorsType:Xn.Basic},paramsWFS:{featureTypes:"radars_photos",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"1.1.0",outputFormat:"geojson",outputFormatDownload:"shp"}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Filterable WMS layers with predefined filters (push buttons)",source:e}))})}}return e.\u0275fac=function(t){return new(t||e)(i.gc(le),i.gc(qc),i.gc(Jc))},e.\u0275cmp=i.ac({type:e,selectors:[["app-ogc-filter"]],decls:17,vars:5,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/ogc-filter"],[3,"map","view"],["color","primary",3,"map"],["title","Layers"],[3,"map","layers"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Geo"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Ogc filter"),i.lc(),i.mc(5,"mat-card-content"),i.mc(6,"li"),i.ad(7,"Dependencies: LanguageService"),i.lc(),i.hc(8,"br"),i.ad(9," See the "),i.mc(10,"a",0),i.ad(11,"code of this example"),i.lc(),i.hc(12,"hr"),i.lc(),i.mc(13,"igo-map-browser",1),i.hc(14,"igo-zoom-button",2),i.lc(),i.mc(15,"igo-panel",3),i.hc(16,"igo-ogc-filterable-list",4),i.lc(),i.lc()),2&e&&(i.Tb(13),i.Dc("map",t.map)("view",t.view),i.Tb(1),i.Dc("map",t.map),i.Tb(2),i.Dc("map",t.map)("layers",t.map.layers))},directives:[g.a,g.e,g.f,g.c,Sl,Il,_i,Sh],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),e})()}]);let Oy=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[yy,g.d,n.c,c.b,zi,Bp,Yh]]}),e})();function vy(e,t){if(1&e&&(i.kc(0),i.hc(1,"igo-feature-details",8),i.jc()),2&e){const e=t.ngIf;i.Tb(1),i.Dc("feature",e)}}const jy=p.e.forChild([{path:"spatial-filter",component:(()=>{class e{constructor(e,t,o,i,r){this.spatialFilterService=e,this.dataSourceService=t,this.layerService=o,this.messageService=i,this.languageService=r,this.map=new vl({controls:{attribution:{collapsed:!0}}}),this.view={center:[-71.9,46.9],zoom:10},this.itemType=Yu.Address,this.layers=[],this.selectedFeature$=new C.a(void 0),this.format=new sn.a,this.store=new at([]),this.spatialListStore=new at([]),this.loading=!1,this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e,baseLayer:!0,visible:!0}))})}getOutputType(e){this.type=e,this.queryType=void 0,this.radius=void 0}getOutputQueryType(e){this.queryType=e,this.queryType&&this.loadFilterList()}loadFilterList(){this.spatialFilterService.loadFilterList(this.queryType).subscribe(e=>{e.sort((e,t)=>e.properties.nom<t.properties.nom?-1:e.properties.nom>t.properties.nom?1:0),this.spatialListStore.clear(),this.spatialListStore.load(e)})}getOutputToggleSearch(){this.loadThematics()}getOutputClearSearch(){this.zone=void 0,this.queryType=void 0}loadThematics(){this.loading=!0,this.tryAddFeaturesToMap([this.zone]),this.thematics||(this.thematics=[{name:""}]),this.type===Hu.Polygon&&(this.radius=void 0),this.thematics.forEach(e=>{this.spatialFilterService.loadFilterItem(this.zone,this.itemType,this.queryType,e,this.radius).subscribe(e=>{this.store.insertMany(e);const t=[],o=[];let i,r;e.forEach(e=>{"Point"===e.geometry.type?(t.push(e),i=e.meta.id):(o.push(e),r=e.meta.id)}),this.tryAddPointToMap(t,i),this.tryAddLayerToMap(o,r),this.loading=!1,e.length>=1e4&&this.messageService.alert(this.languageService.translate.instant("igo.geo.spatialFilter.maxSizeAlert"),this.languageService.translate.instant("igo.geo.spatialFilter.warning"),{timeOut:1e4}),e.length||this.messageService.alert(this.languageService.translate.instant("igo.geo.spatialFilter.zeroResults"),this.languageService.translate.instant("igo.geo.spatialFilter.warning"),{timeOut:1e4})})})}onZoneChange(e){this.zone=e,e&&(this.tryAddFeaturesToMap([e]),this.zoomToFeatureExtent(e))}tryAddFeaturesToMap(e){let t=1;for(const o of e){if(this.type===Hu.Predefined)for(const e of this.map.layers){if(e.options._internal&&e.options._internal.code===o.properties.code)return;e.title.startsWith("Zone")&&this.map.removeLayer(e)}for(const e of this.map.layers)e.title.startsWith("Zone")&&t++;this.dataSourceService.createAsyncDataSource({type:"vector",queryable:!0}).subscribe(i=>{const r=this.layerService.createLayer({title:"Zone "+t,_internal:{code:this.type===Hu.Predefined?o.properties.code:void 0},source:i,visible:!0,style:(t,o)=>{const i=e[0].coordinates;return new Ra.Style({image:new Ra.Circle({radius:i?this.radius/Math.cos(Math.PI/180*i[1])/o:void 0,fill:new Ra.Fill({color:"rgba(200, 200, 20, 0.2)"}),stroke:new Ra.Stroke({width:1,color:"orange"})}),stroke:new Ra.Stroke({width:1,color:"orange"}),fill:new Ra.Fill({color:"rgba(200, 200, 20, 0.2)"})})}}),s=e.map(e=>tl(e,this.map.projection));i.ol.addFeatures(s),this.map.addLayer(r),this.layers.push(r)})}}tryAddPointToMap(e,t){let o=1;if(e.length>=1){if(void 0===this.map)return;for(const t of this.map.layers)t.title.startsWith(e[0].meta.title)&&o++;this.dataSourceService.createAsyncDataSource({type:"cluster",id:t,queryable:!0,distance:120,meta:{title:"Cluster"}}).subscribe(t=>{const i=this.layerService.createLayer({title:e[0].meta.title+" "+o,source:t,visible:!0,clusterParam:{clusterRanges:[{minRadius:1,maxRadius:5,style:{}}]}}),r=e.map(e=>tl(e,this.map.projection));t.ol.source.addFeatures(r),this.map.layers.find(e=>e.id===i.id)&&(this.map.removeLayer(this.map.layers.find(e=>e.id===i.id)),o-=1,i.title=e[0].meta.title+" "+o,i.options.title=i.title),this.map.addLayer(i),this.layers.push(i)})}}tryAddLayerToMap(e,t){let o=1;if(e.length>1){if(void 0===this.map)return;for(const t of this.map.layers)t.title.startsWith(e[0].meta.title)&&o++;this.dataSourceService.createAsyncDataSource({type:"vector",id:t,queryable:!0}).subscribe(t=>{const i=this.layerService.createLayer({title:e[0].meta.title+" "+o,source:t,visible:!0}),r=e.map(e=>tl(e,this.map.projection));t.ol.addFeatures(r),this.map.layers.find(e=>e.id===i.id)&&(this.map.removeLayer(this.map.layers.find(e=>e.id===i.id)),o-=1,i.title=e[0].meta.title+" "+o,i.options.title=i.title),this.map.addLayer(i),this.layers.push(i)})}}zoomToFeatureExtent(e){if(e){const t=this.format.readFeature(e,{dataProjection:e.projection,featureProjection:this.map.projection});rl(this.map,[t],el.Zoom)}}handleQueryResults(e){const t=e.features;let o;t.length&&(o=t[0]),this.selectedFeature$.next(o)}}return e.\u0275fac=function(t){return new(t||e)(i.gc(Wu),i.gc(qc),i.gc(Jc),i.gc(ce),i.gc(le))},e.\u0275cmp=i.ac({type:e,selectors:[["app-spatial-filter"]],inputs:{type:"type",itemType:"itemType",freehandDrawIsActive:"freehandDrawIsActive"},decls:26,vars:17,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/spatial-filter"],["igoOverlay","","igoQuery","",3,"map","view","queryFeatures","query"],["color","primary",3,"map"],["title","Spatial Filter"],[3,"store","selectedQueryType","zone","eventType","eventQueryType","zoneChange"],[3,"type","queryType","map","zone","loading","store","layers","radiusEvent","freehandControl","drawZoneEvent","itemTypeChange","thematicChange","toggleSearch","clearButtonEvent","clearSearchEvent"],["title","Details"],[4,"ngIf"],[3,"feature"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Geo"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Spatial filter"),i.lc(),i.mc(5,"mat-card-content"),i.mc(6,"li"),i.ad(7,"npm install --save moment@2.22.2"),i.lc(),i.mc(8,"li"),i.ad(9,"npm install --save @mat-datetimepicker/core@3.0.0-beta.0"),i.lc(),i.mc(10,"li"),i.ad(11,"Dependencies: LanguageService"),i.lc(),i.hc(12,"br"),i.ad(13," See the "),i.mc(14,"a",0),i.ad(15,"code of this example"),i.lc(),i.hc(16,"hr"),i.lc(),i.mc(17,"igo-map-browser",1),i.tc("query",(function(e){return t.handleQueryResults(e)})),i.hc(18,"igo-zoom-button",2),i.lc(),i.mc(19,"igo-panel",3),i.mc(20,"igo-spatial-filter-type",4),i.tc("eventType",(function(e){return t.getOutputType(e)}))("eventQueryType",(function(e){return t.getOutputQueryType(e)}))("zoneChange",(function(e){return t.onZoneChange(e)})),i.lc(),i.mc(21,"igo-spatial-filter-item",5),i.tc("radiusEvent",(function(e){return t.radius=e}))("freehandControl",(function(e){return t.freehandDrawIsActive=e}))("drawZoneEvent",(function(e){return t.zone=e}))("itemTypeChange",(function(e){return t.itemType=e}))("thematicChange",(function(e){return t.thematics=e}))("toggleSearch",(function(){return t.getOutputToggleSearch()}))("clearButtonEvent",(function(e){return t.layers=e}))("clearSearchEvent",(function(){return t.getOutputClearSearch()})),i.lc(),i.lc(),i.mc(22,"igo-panel",6),i.Yc(23,vy,2,1,"ng-container",7),i.yc(24,"async"),i.lc(),i.hc(25,"igo-message-center"),i.lc()),2&e&&(i.Tb(17),i.Dc("map",t.map)("view",t.view)("queryFeatures",!0),i.Tb(1),i.Dc("map",t.map),i.Tb(2),i.Dc("store",t.spatialListStore)("selectedQueryType",t.queryType)("zone",t.zone),i.Tb(1),i.Dc("type",t.type)("queryType",t.queryType)("map",t.map)("zone",t.zone)("loading",t.loading)("store",t.store)("layers",t.layers),i.Tb(2),i.Dc("ngIf",i.zc(24,15,t.selectedFeature$)))},directives:[g.a,g.e,g.f,g.c,Sl,Hl,Il,_i,Fh,Hh,m.t,se,ud],pipes:[m.b],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}igo-form[_ngcontent-%COMP%]{display:none}igo-spatial-filter-item[_ngcontent-%COMP%]     .thematics-header{max-width:225px}"]}),e})()}]);let wy=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[jy,g.d,n.c,c.b,zi,Bp,ae,lm,Zd,Wd,Yh,mi,m.c]]}),e})();function Sy(e,t){if(1&e){const e=i.nc();i.mc(0,"igo-entity-table-paginator",6),i.tc("paginatorChange",(function(t){return i.Nc(e),i.xc(2).paginatorChange(t)})),i.lc()}if(2&e){const e=i.xc().ngIf,t=i.xc();i.Dc("store",e.entityStore)("paginatorOptions",t.paginatorOptions)("entitySortChange$",t.entitySortChange$)}}function xy(e,t){if(1&e&&(i.kc(0),i.Yc(1,Sy,1,3,"igo-entity-table-paginator",5),i.yc(2,"async"),i.jc()),2&e){const e=t.ngIf;i.Tb(1),i.Dc("ngIf",i.zc(2,1,e.inResolutionRange$))}}function Cy(e,t){if(1&e&&i.hc(0,"igo-actionbar",10),2&e){const e=i.xc().ngIf,t=i.xc();i.Dc("store",e.actionStore)("horizontal",!0)("withToggleButton",!0)("withTitle",!0)("mode",t.actionbarMode)}}function Ty(e,t){if(1&e&&i.hc(0,"igo-entity-table",11),2&e){const e=i.xc().ngIf,t=i.xc();i.Dc("paginator",t.workspacePaginator)("scrollBehavior",t.scrollBehavior)("store",e.entityStore)("template",e.meta.tableTemplate)}}function Ly(e,t){1&e&&(i.mc(0,"mat-card-content"),i.ad(1," No data available at this scale. Please zoom in. "),i.lc())}function Iy(e,t){if(1&e&&(i.kc(0),i.Yc(1,Cy,1,5,"igo-actionbar",7),i.Yc(2,Ty,1,4,"igo-entity-table",8),i.yc(3,"async"),i.Yc(4,Ly,2,0,"mat-card-content",4),i.yc(5,"async"),i.hc(6,"igo-workspace-widget-outlet",9),i.jc()),2&e){const e=t.ngIf;i.Tb(1),i.Dc("ngIf",e.actionStore),i.Tb(1),i.Dc("ngIf",e.entityStore&&e.meta&&e.meta.tableTemplate&&i.zc(3,4,e.inResolutionRange$)),i.Tb(2),i.Dc("ngIf",!i.zc(5,6,e.inResolutionRange$)),i.Tb(2),i.Dc("workspace",e)}}const Fy=p.e.forChild([{path:"workspace",component:(()=>{class e{constructor(e,t,o,i){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.workspaceState=i,this.entitySortChange$=new C.a(!1),this.paginatorOptions={pageSize:5,pageSizeOptions:[1,5,10,15,30,50,100],showFirstLastButtons:!0},this.map=new vl({controls:{attribution:{collapsed:!0}}}),this.view={center:[-72,47.2],zoom:5},this.actionbarMode=so.Overlay,this.scrollBehavior=Je.Instant}get workspaceStore(){return this.workspaceState.store}ngOnInit(){this.selectedWorkspace$=this.workspaceStore.stateView.firstBy$(e=>!0===e.state.selected).pipe(Object(j.a)(e=>{const t=void 0===e?void 0:e.entity;return t&&t.actionStore.view.filter(e=>"wfsDownload"!==e.id),t})),this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/swtq",params:{featureTypes:"etablissement_mtq",fieldNameGeometry:"geometry",version:"2.0.0",outputFormat:"geojson"},sourceFields:[{name:"idetablis",alias:"ID"},{name:"nometablis",alias:"Name"},{name:"typetablis",alias:"Type"}]}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Simple WFS ",maxResolution:3e3,visible:!0,source:e}))})}paginatorChange(e){this.workspacePaginator=e}}return e.\u0275fac=function(t){return new(t||e)(i.gc(le),i.gc(qc),i.gc(Jc),i.gc(Jf))},e.\u0275cmp=i.ac({type:e,selectors:[["app-workspace"]],decls:16,vars:11,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/workspace"],[3,"map","view"],["color","primary",3,"map"],["igoWorkspaceSelector","",3,"store","map"],[4,"ngIf"],[3,"store","paginatorOptions","entitySortChange$","paginatorChange",4,"ngIf"],[3,"store","paginatorOptions","entitySortChange$","paginatorChange"],[3,"store","horizontal","withToggleButton","withTitle","mode",4,"ngIf"],["class","table-compact table-centered",3,"paginator","scrollBehavior","store","template",4,"ngIf"],[3,"workspace"],[3,"store","horizontal","withToggleButton","withTitle","mode"],[1,"table-compact","table-centered",3,"paginator","scrollBehavior","store","template"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Geo"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Workspace"),i.lc(),i.mc(5,"mat-card-content"),i.ad(6," See the "),i.mc(7,"a",0),i.ad(8,"code of this example"),i.lc(),i.lc(),i.mc(9,"igo-map-browser",1),i.hc(10,"igo-zoom-button",2),i.lc(),i.hc(11,"igo-workspace-selector",3),i.Yc(12,xy,3,3,"ng-container",4),i.yc(13,"async"),i.Yc(14,Iy,7,8,"ng-container",4),i.yc(15,"async"),i.lc()),2&e&&(i.Tb(9),i.Dc("map",t.map)("view",t.view),i.Tb(1),i.Dc("map",t.map),i.Tb(1),i.Dc("store",t.workspaceStore)("map",t.map),i.Tb(1),i.Dc("ngIf",i.zc(13,7,t.selectedWorkspace$)),i.Tb(2),i.Dc("ngIf",i.zc(15,9,t.selectedWorkspace$)))},directives:[g.a,g.e,g.f,g.c,Sl,Il,Ir,hb,m.t,ft,Dr,Co,ro],pipes:[m.b],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}igo-entity-table[_ngcontent-%COMP%]{height:400px}igo-actionbar[_ngcontent-%COMP%]{height:48px}"]}),e})()}]);let My=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[m.c,Fy,g.d,n.c,c.b,Lo,vi,Ar,zi,Bp,gb]]}),e})();function ky(e,t){1&e&&i.hc(0,"igo-metadata-button",10),2&e&&i.Dc("layer",t.layer)}const Dy=p.e.forChild([{path:"context",component:(()=>{class e{constructor(e,t,o){this.languageService=e,this.mapService=t,this.overlayService=o,this.map=new vl({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:6},this.mapService.setMap(this.map)}}return e.\u0275fac=function(t){return new(t||e)(i.gc(le),i.gc(jl),i.gc(Up))},e.\u0275cmp=i.ac({type:e,selectors:[["app-context"]],decls:27,vars:7,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/context/context"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/contexts"],["igoMapContext","","igoLayerContext","",3,"map"],["color","primary",3,"map"],["color","primary",3,"map","showIfNoRotation"],["title","Contexts list"],["igoContextListBinding","",3,"map"],["title","Layers"],["igoLayerListBinding","",3,"map"],["igoLayerItemToolbar",""],[3,"layer"]],template:function(e,t){1&e&&(i.mc(0,"mat-card"),i.mc(1,"mat-card-subtitle"),i.ad(2,"Geo"),i.lc(),i.mc(3,"mat-card-title"),i.ad(4,"Context"),i.lc(),i.mc(5,"mat-card-content"),i.mc(6,"p"),i.ad(7,"* Dependencies: LanguageService"),i.lc(),i.hc(8,"br"),i.ad(9," See the "),i.mc(10,"a",0),i.ad(11,"code of this example"),i.lc(),i.hc(12,"br"),i.ad(13," See "),i.mc(14,"a",1),i.ad(15," contexts"),i.lc(),i.hc(16,"hr"),i.lc(),i.mc(17,"igo-map-browser",2),i.hc(18,"igo-zoom-button",3),i.hc(19,"igo-geolocate-button",3),i.hc(20,"igo-rotation-button",4),i.lc(),i.mc(21,"igo-panel",5),i.hc(22,"igo-context-list",6),i.lc(),i.mc(23,"igo-panel",7),i.mc(24,"igo-layer-list",8),i.Yc(25,ky,1,1,"ng-template",null,9,i.Zc),i.lc(),i.lc(),i.lc()),2&e&&(i.Tb(17),i.Dc("map",t.map),i.Tb(1),i.Dc("map",t.map),i.Tb(1),i.Dc("map",t.map),i.Tb(1),i.Dc("map",t.map)("showIfNoRotation",!0),i.Tb(2),i.Dc("map",t.map),i.Tb(2),i.Dc("map",t.map))},directives:[g.a,g.e,g.f,g.c,Sl,nf,cf,Il,Fl,Dl,_i,zf,Nf,fu,yu,fc],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{margin-bottom:5px}"]}),e})()}]);let Py=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[y.c,Dy,g.d,n.c,c.b,zi,Bp,Mu,Oc,Yp,lm,Zd,Gf]]}),e})();const Ay=[{path:"",redirectTo:"/home",pathMatch:"full"},{path:"**",redirectTo:"/home"}];let $y=(()=>{class e{}return e.\u0275mod=i.ec({type:e}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)},imports:[[p.e.forRoot(Ay,{useHash:!0})],p.e]}),e})(),Ey=(()=>{class e{constructor(e,t,o){this.changeDetectorRef=e,this.media=t,this.renderer=o,this.title="IGO",this.version=W,this.themeClass="deeppurple-theme",this.mobileQuery=t.matchMedia("(max-width: 600px)"),this._mobileQueryListener=()=>e.detectChanges(),this.mobileQuery.addEventListener("change",this._mobileQueryListener),this.renderer.addClass(document.body,this.themeClass),this.detectOldBrowser()}ngOnDestroy(){this.mobileQuery.removeEventListener("change",this._mobileQueryListener)}detectOldBrowser(){A.satisfies({ie:"<11",chrome:"<64",firefox:"<60"})&&console.log("Very old browser ! ",A.getBrowser())}}return e.\u0275fac=function(t){return new(t||e)(i.gc(i.j),i.gc(V.c),i.gc(i.U))},e.\u0275cmp=i.ac({type:e,selectors:[["app-root"]],decls:91,vars:8,consts:[[1,"example-container"],["color","primary",1,"example-toolbar"],["mat-icon-button","",3,"click"],["svgIcon","menu"],[1,"example-sidenav-container"],["opened","true","fixedTopGap","56",3,"mode","fixedInViewport"],["snav",""],["mat-list-item","","routerLink","."],["mat-list-item","","routerLink","activity"],["mat-list-item","","routerLink","config"],["mat-list-item","","routerLink","language"],["mat-list-item","","routerLink","media"],["mat-list-item","","routerLink","message"],["mat-list-item","","routerLink","request"],["mat-list-item","","routerLink","auth-form"],["mat-list-item","","routerLink","action"],["mat-list-item","","routerLink","dynamic-component"],["mat-list-item","","routerLink","entity-table"],["mat-list-item","","routerLink","entity-selector"],["mat-list-item","","routerLink","form"],["mat-list-item","","routerLink","table"],["mat-list-item","","routerLink","tool"],["mat-list-item","","routerLink","widget"],["mat-list-item","","routerLink","simple-map"],["mat-list-item","","routerLink","layer"],["mat-list-item","","routerLink","legend"],["mat-list-item","","routerLink","overlay"],["mat-list-item","","routerLink","geometry"],["mat-list-item","","routerLink","feature"],["mat-list-item","","routerLink","hover"],["mat-list-item","","routerLink","measure"],["mat-list-item","","routerLink","draw"],["mat-list-item","","routerLink","query"],["mat-list-item","","routerLink","catalog"],["mat-list-item","","routerLink","search"],["mat-list-item","","routerLink","print"],["mat-list-item","","routerLink","import-export"],["mat-list-item","","routerLink","directions"],["mat-list-item","","routerLink","time-filter"],["mat-list-item","","routerLink","ogc-filter"],["mat-list-item","","routerLink","spatial-filter"],["mat-list-item","","routerLink","workspace"],["mat-list-item","","routerLink","context"]],template:function(e,t){if(1&e){const e=i.nc();i.mc(0,"div",0),i.mc(1,"mat-toolbar",1),i.mc(2,"button",2),i.tc("click",(function(){return i.Nc(e),i.Kc(10).toggle()})),i.hc(3,"mat-icon",3),i.lc(),i.mc(4,"h1"),i.ad(5),i.lc(),i.mc(6,"h5"),i.ad(7),i.lc(),i.lc(),i.mc(8,"mat-sidenav-container",4),i.mc(9,"mat-sidenav",5,6),i.mc(11,"mat-nav-list"),i.mc(12,"a",7),i.ad(13,"Home"),i.lc(),i.hc(14,"hr"),i.mc(15,"a",8),i.ad(16,"Activity"),i.lc(),i.mc(17,"a",9),i.ad(18,"Config"),i.lc(),i.mc(19,"a",10),i.ad(20,"Language"),i.lc(),i.mc(21,"a",11),i.ad(22,"Media"),i.lc(),i.mc(23,"a",12),i.ad(24,"Message"),i.lc(),i.mc(25,"a",13),i.ad(26,"Request"),i.lc(),i.hc(27,"hr"),i.mc(28,"a",14),i.ad(29,"Authentification"),i.lc(),i.hc(30,"hr"),i.mc(31,"a",15),i.ad(32,"Action"),i.lc(),i.mc(33,"a",16),i.ad(34,"Dynamic Component"),i.lc(),i.mc(35,"a",17),i.ad(36,"Entity Table"),i.lc(),i.mc(37,"a",18),i.ad(38,"Entity Selector"),i.lc(),i.mc(39,"a",19),i.ad(40,"Form"),i.lc(),i.mc(41,"a",20),i.ad(42,"Table"),i.lc(),i.mc(43,"a",21),i.ad(44,"Tool"),i.lc(),i.mc(45,"a",22),i.ad(46,"Widget"),i.lc(),i.hc(47,"hr"),i.mc(48,"a",23),i.ad(49,"Simple map"),i.lc(),i.mc(50,"a",24),i.ad(51,"Layer"),i.lc(),i.mc(52,"a",25),i.ad(53,"Legend"),i.lc(),i.mc(54,"a",26),i.ad(55,"Overlay"),i.lc(),i.mc(56,"a",27),i.ad(57,"Geometry"),i.lc(),i.mc(58,"a",28),i.ad(59,"Feature"),i.lc(),i.mc(60,"a",29),i.ad(61,"Hover"),i.lc(),i.mc(62,"a",30),i.ad(63,"Measure"),i.lc(),i.mc(64,"a",31),i.ad(65,"Draw"),i.lc(),i.mc(66,"a",32),i.ad(67,"Query"),i.lc(),i.mc(68,"a",33),i.ad(69,"Catalog"),i.lc(),i.mc(70,"a",34),i.ad(71,"Search"),i.lc(),i.mc(72,"a",35),i.ad(73,"Print"),i.lc(),i.mc(74,"a",36),i.ad(75,"Import/Export"),i.lc(),i.mc(76,"a",37),i.ad(77,"Directions"),i.lc(),i.mc(78,"a",38),i.ad(79,"Time filter"),i.lc(),i.mc(80,"a",39),i.ad(81,"OGC filter"),i.lc(),i.mc(82,"a",40),i.ad(83,"Spatial filter"),i.lc(),i.mc(84,"a",41),i.ad(85,"Workspace"),i.lc(),i.hc(86,"hr"),i.mc(87,"a",42),i.ad(88,"Context"),i.lc(),i.lc(),i.lc(),i.mc(89,"mat-sidenav-content"),i.hc(90,"router-outlet"),i.lc(),i.lc(),i.lc()}2&e&&(i.Yb("example-is-mobile",t.mobileQuery.matches),i.Tb(5),i.bd(t.title),i.Tb(2),i.bd(t.version.lib),i.Tb(1),i.Vc("margin-top",t.mobileQuery.matches?56:0,"px"),i.Tb(1),i.Dc("mode",t.mobileQuery.matches?"over":"side")("fixedInViewport",t.mobileQuery.matches))},directives:[d.a,n.b,c.a,u.b,u.a,l.h,l.d,p.d,u.c,p.f],styles:["h1[_ngcontent-%COMP%]{width:100%;text-align:center;font-size:26px}.example-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:absolute;top:0;bottom:0;left:0;right:0}.example-is-mobile[_ngcontent-%COMP%]   .example-toolbar[_ngcontent-%COMP%]{position:fixed;z-index:2}.example-sidenav-container[_ngcontent-%COMP%]{flex:1}.example-is-mobile[_ngcontent-%COMP%]   .example-sidenav-container[_ngcontent-%COMP%]{flex:1 0 auto}mat-sidenav[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.03)}.example-is-mobile[_ngcontent-%COMP%]   mat-sidenav[_ngcontent-%COMP%]{background-color:#fff}mat-sidenav-content[_ngcontent-%COMP%]{padding:10px}"]}),e})(),Ry=(()=>{class e{constructor(e,t){e.addSvgIconSet(t.bypassSecurityTrustResourceUrl("./assets/igo2/core/icons/mdi.svg"))}}return e.\u0275mod=i.ec({type:e,bootstrap:[Ey]}),e.\u0275inj=i.dc({factory:function(t){return new(t||e)(i.qc(c.c),i.qc(s.b))},imports:[[s.a,a.b,u.d,d.b,n.c,c.b,l.e,Er,_r,Nr,qr,Vr,Hr,Wr,Qr,ts,is,as,ls,ds,gs,ys,Ws,Db,$b,Rb,zb,qb,Vb,Hb,Wb,Zb,Xb,tf,ly,dy,py,gy,fy,Oy,wy,My,Py,$y,s.e]]}),e})();r.production&&Object(i.lb)(),s.g().bootstrapModule(Ry).catch(e=>console.log(e))},RnhZ:function(e,t,o){var i={"./af":"K/tc","./af.js":"K/tc","./ar":"jnO4","./ar-dz":"o1bE","./ar-dz.js":"o1bE","./ar-kw":"Qj4J","./ar-kw.js":"Qj4J","./ar-ly":"HP3h","./ar-ly.js":"HP3h","./ar-ma":"CoRJ","./ar-ma.js":"CoRJ","./ar-sa":"gjCT","./ar-sa.js":"gjCT","./ar-tn":"bYM6","./ar-tn.js":"bYM6","./ar.js":"jnO4","./az":"SFxW","./az.js":"SFxW","./be":"H8ED","./be.js":"H8ED","./bg":"hKrs","./bg.js":"hKrs","./bm":"p/rL","./bm.js":"p/rL","./bn":"kEOa","./bn-bd":"loYQ","./bn-bd.js":"loYQ","./bn.js":"kEOa","./bo":"0mo+","./bo.js":"0mo+","./br":"aIdf","./br.js":"aIdf","./bs":"JVSJ","./bs.js":"JVSJ","./ca":"1xZ4","./ca.js":"1xZ4","./cs":"PA2r","./cs.js":"PA2r","./cv":"A+xa","./cv.js":"A+xa","./cy":"l5ep","./cy.js":"l5ep","./da":"DxQv","./da.js":"DxQv","./de":"tGlX","./de-at":"s+uk","./de-at.js":"s+uk","./de-ch":"u3GI","./de-ch.js":"u3GI","./de.js":"tGlX","./dv":"WYrj","./dv.js":"WYrj","./el":"jUeY","./el.js":"jUeY","./en-au":"Dmvi","./en-au.js":"Dmvi","./en-ca":"OIYi","./en-ca.js":"OIYi","./en-gb":"Oaa7","./en-gb.js":"Oaa7","./en-ie":"4dOw","./en-ie.js":"4dOw","./en-il":"czMo","./en-il.js":"czMo","./en-in":"7C5Q","./en-in.js":"7C5Q","./en-nz":"b1Dy","./en-nz.js":"b1Dy","./en-sg":"t+mt","./en-sg.js":"t+mt","./eo":"Zduo","./eo.js":"Zduo","./es":"iYuL","./es-do":"CjzT","./es-do.js":"CjzT","./es-mx":"tbfe","./es-mx.js":"tbfe","./es-us":"Vclq","./es-us.js":"Vclq","./es.js":"iYuL","./et":"7BjC","./et.js":"7BjC","./eu":"D/JM","./eu.js":"D/JM","./fa":"jfSC","./fa.js":"jfSC","./fi":"gekB","./fi.js":"gekB","./fil":"1ppg","./fil.js":"1ppg","./fo":"ByF4","./fo.js":"ByF4","./fr":"nyYc","./fr-ca":"2fjn","./fr-ca.js":"2fjn","./fr-ch":"Dkky","./fr-ch.js":"Dkky","./fr.js":"nyYc","./fy":"cRix","./fy.js":"cRix","./ga":"USCx","./ga.js":"USCx","./gd":"9rRi","./gd.js":"9rRi","./gl":"iEDd","./gl.js":"iEDd","./gom-deva":"qvJo","./gom-deva.js":"qvJo","./gom-latn":"DKr+","./gom-latn.js":"DKr+","./gu":"4MV3","./gu.js":"4MV3","./he":"x6pH","./he.js":"x6pH","./hi":"3E1r","./hi.js":"3E1r","./hr":"S6ln","./hr.js":"S6ln","./hu":"WxRl","./hu.js":"WxRl","./hy-am":"1rYy","./hy-am.js":"1rYy","./id":"UDhR","./id.js":"UDhR","./is":"BVg3","./is.js":"BVg3","./it":"bpih","./it-ch":"bxKX","./it-ch.js":"bxKX","./it.js":"bpih","./ja":"B55N","./ja.js":"B55N","./jv":"tUCv","./jv.js":"tUCv","./ka":"IBtZ","./ka.js":"IBtZ","./kk":"bXm7","./kk.js":"bXm7","./km":"6B0Y","./km.js":"6B0Y","./kn":"PpIw","./kn.js":"PpIw","./ko":"Ivi+","./ko.js":"Ivi+","./ku":"JCF/","./ku.js":"JCF/","./ky":"lgnt","./ky.js":"lgnt","./lb":"RAwQ","./lb.js":"RAwQ","./lo":"sp3z","./lo.js":"sp3z","./lt":"JvlW","./lt.js":"JvlW","./lv":"uXwI","./lv.js":"uXwI","./me":"KTz0","./me.js":"KTz0","./mi":"aIsn","./mi.js":"aIsn","./mk":"aQkU","./mk.js":"aQkU","./ml":"AvvY","./ml.js":"AvvY","./mn":"lYtQ","./mn.js":"lYtQ","./mr":"Ob0Z","./mr.js":"Ob0Z","./ms":"6+QB","./ms-my":"ZAMP","./ms-my.js":"ZAMP","./ms.js":"6+QB","./mt":"G0Uy","./mt.js":"G0Uy","./my":"honF","./my.js":"honF","./nb":"bOMt","./nb.js":"bOMt","./ne":"OjkT","./ne.js":"OjkT","./nl":"+s0g","./nl-be":"2ykv","./nl-be.js":"2ykv","./nl.js":"+s0g","./nn":"uEye","./nn.js":"uEye","./oc-lnc":"Fnuy","./oc-lnc.js":"Fnuy","./pa-in":"8/+R","./pa-in.js":"8/+R","./pl":"jVdC","./pl.js":"jVdC","./pt":"8mBD","./pt-br":"0tRk","./pt-br.js":"0tRk","./pt.js":"8mBD","./ro":"lyxo","./ro.js":"lyxo","./ru":"lXzo","./ru.js":"lXzo","./sd":"Z4QM","./sd.js":"Z4QM","./se":"//9w","./se.js":"//9w","./si":"7aV9","./si.js":"7aV9","./sk":"e+ae","./sk.js":"e+ae","./sl":"gVVK","./sl.js":"gVVK","./sq":"yPMs","./sq.js":"yPMs","./sr":"zx6S","./sr-cyrl":"E+lV","./sr-cyrl.js":"E+lV","./sr.js":"zx6S","./ss":"Ur1D","./ss.js":"Ur1D","./sv":"X709","./sv.js":"X709","./sw":"dNwA","./sw.js":"dNwA","./ta":"PeUW","./ta.js":"PeUW","./te":"XLvN","./te.js":"XLvN","./tet":"V2x9","./tet.js":"V2x9","./tg":"Oxv6","./tg.js":"Oxv6","./th":"EOgW","./th.js":"EOgW","./tk":"Wv91","./tk.js":"Wv91","./tl-ph":"Dzi0","./tl-ph.js":"Dzi0","./tlh":"z3Vd","./tlh.js":"z3Vd","./tr":"DoHr","./tr.js":"DoHr","./tzl":"z1FC","./tzl.js":"z1FC","./tzm":"wQk9","./tzm-latn":"tT3J","./tzm-latn.js":"tT3J","./tzm.js":"wQk9","./ug-cn":"YRex","./ug-cn.js":"YRex","./uk":"raLr","./uk.js":"raLr","./ur":"UpQW","./ur.js":"UpQW","./uz":"Loxo","./uz-latn":"AQ68","./uz-latn.js":"AQ68","./uz.js":"Loxo","./vi":"KSF8","./vi.js":"KSF8","./x-pseudo":"/X5v","./x-pseudo.js":"/X5v","./yo":"fzPg","./yo.js":"fzPg","./zh-cn":"XDpg","./zh-cn.js":"XDpg","./zh-hk":"SatO","./zh-hk.js":"SatO","./zh-mo":"OmwH","./zh-mo.js":"OmwH","./zh-tw":"kOpN","./zh-tw.js":"kOpN"};function r(e){var t=s(e);return o(t)}function s(e){if(!o.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}r.keys=function(){return Object.keys(i)},r.resolve=s,e.exports=r,r.id="RnhZ"},S9Br:function(e){e.exports=JSON.parse('{"igo":{"auth":{"accessAnonymous":"Rester anonyme","connection":"Connexion","login":"Connecter","password":"Mot de passe","signOut":"Se d\xe9connecter","user":"Utilisateur","welcome":"Bienvenue {{name}}!","deconnection":"Vous \xeates d\xe9connect\xe9","home":"Retourner \xe0 la page d\'accueil","error":{"Password expired":"Votre mot de passe est expir\xe9","Maximun logins exceeded":"Nombre maximal de connexions d\xe9pass\xe9","Login lockout":"Nombre maximal d\'essai d\xe9pass\xe9. Votre compte est verrouill\xe9.","Wrong password":"Mot de passe incorrect","Invalid username":"Utilisateur invalide"},"google":{"login":"Se connecter avec Google","logged":"Connect\xe9 avec Google"},"microsoft":{"login":"Se connecter avec Microsoft"}}}}')},SylJ:function(e){e.exports=JSON.parse('{"igo":{"auth":{"accessAnonymous":"Access as anonymous","connection":"Connection","login":"Login","password":"Password","signOut":"Sign out","user":"User","welcome":"Welcome {{name}}!","deconnection":"You are logged out.","home":"Return to the home page","error":{"Password expired":"Password expired","Maximun logins exceeded":"Maximum logins exceeded","Login lockout":"Maximum number of attempts exceeded. Your account is locked.","Wrong password":"Wrong password","Invalid username":"Invalid username"},"microsoft":{"login":"Sign in with Microsoft"}}}}')},U9wj:function(e,t){function o(e){return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}o.keys=function(){return[]},o.resolve=o,e.exports=o,o.id="U9wj"},VPSe:function(e){e.exports=JSON.parse('{"igo":{"core":{"errors":{"uncaught":{"message":"D\xe9sol\xe9! Le service que vous voulez utiliser n\u2019est malheureusement pas disponible pour le moment. Essayez plus tard!","title":"Erreur serveur"}},"network":{"online":{"message":"En ligne","title":"Statut:"},"offline":{"message":"Hors-Ligne","title":"Statut:"}}}}}')},fNJn:function(e){e.exports=JSON.parse('{"igo":{"auth":{"accessAnonymous":"Access as anonymous","connection":"Connection","login":"Login","password":"Password","signOut":"Sign out","user":"User","welcome":"Welcome {{name}}!","deconnection":"You are logged out.","home":"Return to the home page","error":{"Password expired":"Password expired","Maximun logins exceeded":"Maximum logins exceeded","Login lockout":"Maximum number of attempts exceeded. Your account is locked.","Wrong password":"Wrong password","Invalid username":"Invalid username"},"microsoft":{"login":"Sign in with Microsoft"}},"common":{"confirmDialog":{"cancelBtn":"Cancel","confirmBtn":"Confirm","title":"Confirm"},"table":{"filter":"Filter"},"entity-table":{"targetHtmlUrl":"Open the external link"},"form":{"errors":{"required":"This field is required"}},"actionbar":{"scrollUp":"Scroll up","scrollDown":"Scroll down","icon":"Action list"},"interactiveTour":{"tooltipTourToolButton":"Interactive tour of the application","disaledTooltipTourToolButton":"To have access to this tool\'s tour, add contexts or layers","buttonTitle":"Discover","exitButton":"Exit","backButton":"Back","nextButton":"Next"},"paginator":{"firstPageLabel":"First page","itemsPerPageLabel":"Items per page:","lastPageLabel":"Last page","nextPageLabel":"Next page","previousPageLabel":"Previous page","of":"of"}},"context":{"bookmarkButton":{"create":"Create a new context","dialog":{"createMsg":"The context \'{{value}}\' was created","createTitle":"Context created","placeholder":"Title","title":"New context"}},"contextManager":{"clone":"Clone this context","delete":"Delete this context","dialog":{"cloneMsg":"The context \'{{value}}\' was cloned","cloneTitle":"Context cloned","copyMsg":"Text copied","copyTitle":"Context ID","confirmDelete":"Are you sure you want to delete this context?","deleteMsg":"The context \'{{value}}\' was deleted","deleteTitle":"Context deleted","favoriteMsg":"The context \'{{value}}\' was set as favorite","favoriteTitle":"Favorite saved","saveMsg":"The context \'{{value}}\' was saved","saveTitle":"Context saved"},"edit":"Edit this context","errors":{"uncaught":{"message":"Sorry, service is currently not available. Please try again later","title":"Error server"},"addPermission":"The permission you are trying to add is already in the context.","addPermissionEmpty":"The permission you are trying to add is not valid","addPermissionTitle":"Add permission error"},"favorite":"Set as favorite context","form":{"copy":"Copy the context ID","edit":"Save","title":"Title","titleRequired":"Title required","uri":"ID","uriRequired":"ID required"},"invalid":{"text":"Context \'{{value}}\' is invalid. The default context was loaded.","title":"Invalid context"},"managePermissions":"Manage permissions context","manageTools":"Manage tools context","ourContexts":"Our contexts","publicContexts":"Public contexts","save":"Save this context","sharedContexts":"Shared contexts","filterPlaceHolder":"Filter by name","sortAlphabetically":"Sort alphabetically","sortContextOrder":"Replace according to the creation date","userAccount":"User account","filterUser":"Filter by user group","emptyContext":"Empty context","emptyContextTooltip":"Create a new empty context","contextMap":"Context from map","contextMapTooltip":"Create a new context from map layers","hide":"Hide this context","show":"Show up this context","showHidden":"Show hidden contexts"},"contextImportExport":{"export":{"exportPlaceHolder":"Layers","exportContextName":"Context name","exportSelectAll":"Select all","success":{"text":"Context has been exported.","title":"Context export success"},"nothing":{"text":"No context could be exported.","title":"Nothing to export"},"failed":{"text":"Failed to export","title":"Failed to export context"}},"import":{"success":{"title":"Imported context","text":"The context \'{{value}}\' was added to the map"},"empty":{"text":"The context \'{{value}}\' contained nothing that could be imported.","title":"Nothing to import"},"invalid":{"text":"The context \'{{value}}\' is invalid.","title":"Invalid context"},"unreadable":{"title":"Unreadable context","text":"The context \'{{value}}\' is unreadable"},"tooLarge":{"text":"The context \'{{value}}\' is too large (Max: {{size}} MB)","title":"Context too large"}}},"permission":{"addBtn":"Add","delete":"Remove permission","dialog":{"addMsg":"The permission \'{{value}}\' was added","addTitle":"Permission added","deleteMsg":"The permission \'{{value}}\' was removed","deleteTitle":"Permission removed","scopeChangedMsg":"The scope was changed to {{value}}","scopeChangedTitle":"Scope changed"},"profil":"Profil","user":"User or group","profilRequired":"Profil required","read":"Read only","readOnlyTitle":"Read-only context","readOnlyMsg":"You can only revoke permission if the context is shared directly to your username.","scope":{"private":"Private","protected":"Protected","shared":"Shared","public":"Public"},"write":"Read and Write"},"poiButton":{"create":"Create a new zone of interest","dialog":{"confirmDelete":"Are you sure you want to delete this zone of interest?","createMsg":"The zone of interest \'{{value}}\' was created","createTitle":"Zone of interest created","deleteMsg":"The zone of interest \'{{value}}\' was deleted","deleteTitle":"Zone of interest deleted","placeholder":"Title","title":"New zone of interest"},"placeholder":"Zones of interest"},"sidenav":{"goBack":"Go Back","mainMenu":"Main Menu"},"shareMap":{"button":"Share map","refreshBtn":"Refresh sharing","copy":"Copy to clipboard","shareWithApi":"Share by context","shareWithUrl":"Share by url","dialog":{"copyMsg":"Link copied to clipboard","copyTitle":"Link"},"errorTitle":"Share Map error","placeholderLink":"Link","included":"Included in shared URL :","context":"The context when creating the sharing link.","center":"The coordinates of the center of the map (longitude, latitude).","zoom":"The zoom level of the map.","addedLayers":"The layers added by the catalog or by the search bar.","visibleInvisible":"Visibility status of layers.","excluded":"Excluded in the shared URL :","order":"The order of the layers.","opacity":"Modifications made to the opacity of the layers.","filterOgc":"Additions / modifications made to filters by attribute.","filterTime":"The current value for time filters."},"tool":{"dialog":{"addMsg":"The tool \'{{value}}\' was added","addTitle":"Tool added","deleteMsg":"The tool \'{{value}}\' was removed","deleteTitle":"Tool removed"}},"userButton":{"dialog":{"email":"Email","expiration":"Expiration","user":"User","clearPreferences":"Clear my preferences"},"infoTitle":"User info","logout":"Logout"}},"core":{"errors":{"uncaught":{"message":"Sorry, service is currently not available. Please try again later","title":"Error server"}},"network":{"online":{"message":"Online","title":"Status:"},"offline":{"message":"Offline","title":"Status:"}}},"geo":{"catalog":{"layer.addToMap":"Add to map","layer.addToMapOutRange":"Add to map. The layer is not visible at the current scale. Please zoom in/out","layer.removeFromMap":"Remove from map","layer.removeFromMapOutRange":"Remove from map. The layer is not visible at the current scale. Please zoom in/out","group.addToMap":"Add all layers from this group to map","group.removeFromMap":"Remove all layers from this group to map","baseLayers":"Baselayers","unavailableTitle":"Catalog unavailable","unavailable":"The catalog \'{{value}}\' is unavailable at the moment or you don\'t have the required permissions.","externalProvider":{"catalog":"This catalog comes from an external organization.","layer":"This layer comes from an external organization.","unavailableWithEmail":"The catalog \'{{value}}\' is unavailable at the moment. To add an external service to the predefined list, please contact us at {{emailAddress}}. Delays can apply if problems occurs with the provider."},"library.add":"Add this catalog to the list","library.cancel":"Cancel","library.remove":"Remove this catalog from the list","library.inlist":{"title":"Catalog already contained","message":"The catalog is already contained in the list."},"library.addTitle":"Adding a catalog","library.addBtn":"Add a catalog"},"clickOnMap":{"clickedFeature":"Clicked Feature"},"baselayersSwitcher":{"title":"Basemaps"},"dataSource":{"unavailableTitle":"Layer unavailable","optionsApiUnavailable":"Layer information could not be retrieved. Some layers may not present the correct information.","unavailable":"The layer \'{{value}}\' is unavailable at the moment or you don\'t have the required permissions."},"dropGeoFile":{"invalid":{"text":"The file \'{{value}}\' is invalid ({{mimeType}})","title":"Invalid file"},"empty":{"text":"The file \'{{value}}\' contained nothing that could be imported.","title":"Nothing to import"},"success":{"text":"Imported file","title":"The layer \'{{value}}\' was added to the map"},"unreadable":{"text":"Unreadable file","title":"The file \'{{value}}\' is unreadable"},"tooLarge":{"text":"The file \'{{value}}\' is too large (Max: {{size}} MB)","title":"File too large"},"invalidSRS":{"text":"The projection is valid. It must start with EPSG:","title":"Invalid projection"}},"export":{"customList":{"text":"Some of the selected layers ( {{value}} ) limit the format\'s list","title":"Restricted list of formats"},"nothing":{"text":"No feature could be exported.","title":"Nothing to export"},"noFormat":{"text":"No export format valid for all selected layers. Please export the layers one at a time.","title":"No valid format"},"failed":{"text":"Failed to export","title":"Failed to export features"},"popupBlocked":{"text":"</br>Enable the popup in your browser. </br>For Chrome and Edge, on the right into the Address Bar.</br>{{extraMessage}}","selectAgain":"Fix it and re-select an output format.","retry":"Please retry to export","title":"Popup blocked by your browser"},"success":{"text":"Features have been exported.","title":"Features export success"},"format":{"GeoJSON":"GeoJSON","GML":"GML","GPX":"GPX","KML":"KML","Shapefile":"Shapefile","CSVcomma":"CSV (comma delimited)","CSVsemicolon":"CSV (semicolon delimited)","URL":"External link"},"gpx.error.poly":{"title":"GPX error","text":"GPX format do now allow polygon features"},"encoding":{"LATIN1":"LATIN-1","UTF8":"UTF-8"}},"importExportForm":{"exportButton":"Export","exportButtonLink":"Open the link","exportButtonLinks":"Open the links","exportFormatPlaceholder":"Format","exportLayerPlaceholder":"Layer","exportFileNamePlaceholder":"Filename","encodingPlaceholder":"Encoding","exportTabTitle":"Export","exportFeatureInExtent":"Export only features in map extent","exportNoLayersExportable":"There is no exportable layer in your map","exportSelectedFeature":"Export only selected features","importButton":"Import","importProjPlaceholder":"Coordinate system of the file to import","importTabTitle":"Import","importClarifications":"Clarifications","importSizeMax":"The file size limit is {{size}} Mb","importFormatAuthorized":"Formats authorized: geojson, kml, gpx, gml, shapefile","importShpZip":"Shapefiles must be zipped AND geometries stored in Latitude Longitude coordinate (EPSG:4326/WGS:84)","other":"other","others":"others","projections":{"mtm":"MTM zone {{zone}} ({{code}})","utm":"UTM zone {{zone}} ({{code}})","webMercator":"Web Mercator ({{code}})","nad83":"Lat-Long NAD83 ({{code}})","wgs84":"Lat-Long WGS84 ({{code}})","choose":"You must choose a projection for your input file."}},"operators":{"caseSensitive":"Case sensitive","And":"And","Or":"Or","PropertyIsEqualTo":"=","PropertyIsNotEqualTo":"!=","PropertyIsLike":"\u2248","PropertyIsGreaterThan":">","PropertyIsGreaterThanOrEqualTo":">=","PropertyIsLessThan":"<","PropertyIsLessThanOrEqualTo":"<=","PropertyIsBetween":"between","During":"during (temporal)","PropertyIsNull":"is null","Intersects":"intersects (spatial)","Within":"within (spatial)","Contains":"contains (spatial)","tooltip":{"And":"Logical operator between filters where both conditions must be true","Or":"Logical operator between filters where at least one (1) condition must be true","PropertyIsEqualTo":"Identical (case sensitive)","PropertyIsNotEqualTo":"Different(case sensitive)","PropertyIsLike":"Like Example: *road* Finds any values that have \'road\' in any position. road* Finds any values that begin by \'road\'. wildCard =\'*\', singleChar = \'.\' escapeChar = \'!\' (case sensitive)","PropertyIsGreaterThan":"Greater than","PropertyIsGreaterThanOrEqualTo":"Greater than or equal to ","PropertyIsLessThan":"Lesser than","PropertyIsLessThanOrEqualTo":"Lesser than or equal to","PropertyIsBetween":"Apply a range check between the lower and upper boundary (values are included)","During":"Apply a range check for time attributes","PropertyIsNull":"Return features where the attribute is null","Intersects":"Return features in geometric intersection with the provided geometry","Within":"Return feature which are completely contained by the provided geometry","Contains":"Return feature completely containing by the provided geometry"}},"sourceFields":{"selectField":"Choose a field"},"filter":{"addFilter":"Add an empty filter to the current list","removeFilter":"Remove the current filter from the filters\'s list","toggleFilterState":"Enable/disable the current filter","refreshFilters":"Update this datasource with the active filter(s). To enable this button, the layer must be visible (or in the defined scale ranges) or you must modify the current filter.","layerFiltered":"This layer is currently filtered","layerFilterable":"This layer is filterable","filterBy":"Filter by","advancedOgcFilters":"Advanced filters","displayMoreResults":"Display more (+)","displayLessResults":"Display less (-)","placeholder":"Enter a value","placeholderSnrc":"Ex: 21L14","selectOperator":"Select an operator","sliderModeTitle":"Time slider","reportingDate":"Reporting date"},"spatialSelector":{"fixedExtent":"Fixed extent","btnSetExtent":"Define the extent of the spatial filter to the current view","snrc":"SNRC","selectFeature":"","drawFeature":""},"layer":{"hideLayer":"Hide Layer","lowerLayer":"Bring layer backward","hideSelectedLayers":"Hide selected layers","filterLowerLayer":"The backward movement is always done according to the order of the map!","filterPlaceholder":"Filter the layers list","activateSelectionMode":"Activate multiple selection mode","deactivateSelectionMode":"Deactivate multiple selection mode","tools":"Tools","selectAll":"Select all","deselectAll":"Deselect all","opacity":"Opacity","raiseLayer":"Bring layer forward","filterRaiseLayer":"The forward movement is always done according to the order of the map!","moreOptions":"Layer\'s tools","removeLayer":"Remove this layer from the map","removeSelectedLayers":"Remove selected layers from the map","removeSelectedLayersRestriction":"Some selected layers cannot be removed","showFeaturesList":"Show features list","showLayer":"Show Layer","showSelectedLayers":"Show selected layers","subsetLayersListKeyword":"Subset the layers\'s list by title or type (wms, wfs,...)","deleteKeyword":"Delete the keyword","subsetLayersListOnlyVisible":"Subset the layers\'s list by visibility","subsetLayersListOnlyInRange":"Subset the layers\'s list by resolution range","sortAlphabetically":"Sort the layers\'s list alphabetically","sortMapOrder":"Sort the layers\'s list based on layer\'s order on the map","resetLayersList":"Remove the current applied filter to layers\'s list","trackFeature":"Track the feature","legend":{"default":"Default","loadingLegendText":"Loading legend","noLegendText":"No legend available for this layer","noLegendScale":"No legend available for this scale","selectStyle":"Select the style of the legend","showAll":"Show all legends (non visible and out of range)","noLayersVisibleWithShowAllButton":"No layer currently visible. Activate the button above to see all the legends.","noLayersVisibleWithShowAllButtonButZoom":"No layer currently visible. If you zoom in the map, some layers will appear OR activate the button above to see all the legends.","noLayersVisible":"No layers currently visible.","noLayersVisibleButZoom":"No layers currently visible. However, if you zoom in the map, some layers will appear."}},"download":{"action":"Download data","title":"Downloading file","start":"Started. Check the download progression in your browser","end":"Completed"},"mapButtons":{"baselayerSwitcher":"Change base layer","geolocate":"Geolocate","offline":"Offline mode","online":"Online mode","zoomIn":"Zoom in ({{zoom}})","zoomOut":"Zoom out ({{zoom}})","resetRotation":"Set map to north","tipRotation":"Hold Alt and SHIFT while dragging on map to rotate the map."},"metadata":{"show":"Show metadata"},"printForm":{"corsErrorMessageBody":"Unable to print due to non-owned access rights","corsErrorMessageHeader":"Print","comment":"Comment","doZipFile":"Zip file","outputFormat":"Output format","paperFormat":"Paper format","paperFormats":{"A0":"33.1 X 46.8\\" (A0)","A1":"23.4 X 33.1\\" (A1)","A2":"16.5 X 23.5\\" (A2)","A3":"11.7 X 16.5\\" (A3)","A4":"8.3 X 11.7\\" (A4)","A5":"5.8 X 8.3\\" (A5)","Letter":"Letter","Legal":"Legal"},"imageFormat":"Image format","orientation":"Orientation","landscape":"Landscape","portrait":"Portrait","projection":"Projection","resolution":"Resolution","saveBtn":"Save","scale":"Scale","showLegend":"Show legend","showProjection":"Show projection","showScale":"Show scale","title":"Title","subtitle":"Subtitle"},"directionsForm":{"stopLayer":"Directions - stops","routeLayer":"Directions - route","start":"Start","intermediate":"Intermediate","end":"End","directionsBtn":"Get route","resetDirectionsBtn":"Reset","zoomRoute":"Zoom on route","null":"","directions":"Directions","raiseStop":"Raise stop\'s priority","lowerStop":"Lower stop\'s priority","addStop":"Add a stop","removeStop":"Remove this stop","drivingOptions":"Options","summary":"Direction\'s summary","stopsList":"Stops\'s list","instructions":"Instructions","copy":"Copy directions","geolocate":"Use current localisation as stop","link":"Link","dialog":{"copyMsg":"Directions copied to clipboard","copyMsgLink":"Link for directions copied to clipboard","copyTitle":"Directions"}},"directions":{"uturn":"u-turn","sharp right":"sharp right","right":"right","slight right":"slightly on right","sharp left":"sharp left","left":"left","slight left":"slightly on left","straight":"forward"},"cardinalPoints":{"n":"north","ne":"northeast","e":"east","se":"southeast","s":"south","sw":"southwest","w":"west","nw":"northwest"},"search":{"placeholder":"Search for a localisation or a layer","emptyType.placeholder":"Please choose a search type","feature.title":"Localisation","feature.placeholder":"Search for a place localisation","layer.title":"Layer","layer.placeholder":"Search for a layer","ichercheReverse.name":"Search by coordinates","ilayer":{"name":"Layers","properties":{"abstract":"Abstract","groupTitle":"Group","title":"Title","type":"Type","url":"URL","metadataUrl":"Metadata","name":"Layer name","urlInfo":"URL - WMS/WFS","downloadUrl":"Data download"},"type":{"layer":"Layer","groupLayer":"Group of layers"}},"nominatim":{"type":{"food":"Food","health":"Health","entertainment":"Entertainment","finance":"Finance"},"country":{"all":"The world","canada":"Canada"}},"icherche":{"name":"iCherche","type":{"address":"Address","oldAddress":"Old address","district":"District","postalCode":"Postal Code","city":"City","oldCity":"Old city","mrc":"MRC","regadmin":"Administrative Region","road":"Road","intersection":"Intersection","place":"Place","exit":"Highway exit","cn":"CN mark","gcc":"Coast Guard mark (CCG)","sumi":"SUMI mark","km":"Mileage mark","entreprise":"Entreprise","cadastre":"Cadastre"},"restrictExtent":{"map":"\xc0 l\'\xe9tendue de la carte","quebec":"Au Qu\xe9bec"}},"coordinates":{"name":"Coordinates","coord":"Geographic (longitude, latitude)","radius":"Radius","conf":"Confidence"},"menu.tooltip":"Search Options","settings":{"title":"Settings"},"pointerSearchSummary":{"title":"Pointer position","tooltip":"Based on every search source, show the summary of the pointer location. Use F2 to activate/deactivate."},"searchResultsGeometry":{"title":"Show results geometries","tooltip":"Hide/ show the results geometries "},"searchSources":{"selectAll":"Select All","unselectAll":"Unselect All","settings":{"results type":"Results type","ecmax":"Maximum deviation","radius":"Search radius","results limit":"Number of results","multiple object":"Multiple object","restrictExtent":"Restrict the extent","selectAll":"Select All","unselectAll":"Unselect All","true":"Yes","false":"No"}},"displayMoreResults":"Display more results"},"geometry":{"geometry":"Geometry","point":"Point","line":"Line","polygon":"Polygon"},"targetHtmlUrl":"Open the external link","searchByCoord":"Search by coordinates","searchByName":"Search by name","seeRouting":"See routing","timeFilter":{"date":"Date","endDate":"End Date","startDate":"Start Date","hour":"Hour","minute":"Minute"},"spatialFilter":{"spatialFilter":"Spatial filter","predefined":"Predefined Zone","draw":"Draw","polygon":"Polygon","point":"Circle","drawPolygon":"Draw a polygon","drawCircle":"Draw a circle","searchLabel":"Search by","buffer":"Buffer","search":"Search","drawControl":"Activate draw control","listLabel":"Zone","layer":"Layer","goSearch":"Launch research","removeLayer":"Remove results","exportLayer":"Export results","clearForm":"Remove draw","clearSearch":"Reset field","Address":"Addresses","Thematics":"Thematics","searchResults":"Search Results","type":"Type","radius":"Radius","radiusAlert":"Radius must be between 0 and 100 kilometers (or 100 000 meters)","bufferAlert":"Buffer must be between 0 and 100 kilometers (or 100 000 meters)","maxSizeAlert":"Search results number exceeds 10000. Some may be missing.","zeroResults":"There are no results for this search.","warning":"Warning","freehandControl":"Freehand","group":{"toponyme":"Toponym","culturel":"Cultural","education":"Education","sante":"Health","securite":"Security","sepaq":"SEPAQ","transport":"Transportation"}},"terrapi":{"AdmRegion":"Administratives region","Mun":"Municipalities","Arrond":"Boroughs","CircFed":"Federals districts","CircProv":"Provincials districts","DirReg":"Regionals directorates","MRC":"RCM","RegTour":"Touristics regions","limites":"Administrative boundaries","bornes":"Landmarks","hydro":"Hydrography","routes":"Roads","bati":"Buildings","batiment":"Buildings","camping":"Camping","equipement":"Equipment","commun":"Public","geographie":"Natural sites","parc":"Parks","secteur":"Sector","immeubles":"Tenement","sites":"Cultural sites","cpe":"Children\'s education center","public":"Public schools","prive":"Private school","gouvernemental":"Government schools","colleges":"Colleges","universites":"University","aine":"Residences for seniors","ambulance":"Ambulance zones","clinique":"Clinics","etabl":"Health institutions","gmf":"Family doctors group","naissance":"Birth house","pharmacie":"Pharmacy","casernes":"Fire stations","correctionnel":"Correctional centres","organisme":"Security organization","palais-justice":"Courthouses","penitencier-fed":"Federal penitentiaries","penitencier-prov":"Provincial penitentiaries","polices":"Police station"},"measure":{"dialog":{"title":"Sum of the selection","length.title":"Length","area.title":"Area","lengthInMeters":"Meters","lengthInKilometers":"Kilometers","lengthInMiles":"Miles","lengthInFeet":"Feet","areaInSquareMeters":"Meters\xb2","areaInSquareKilometers":"Kilometers\xb2","areaInSquareMiles":"Miles\xb2","areaInHectares":"Hectares","areaInAcres":"Acres","perimeterInMeters":"Perimeter in meters"},"area":"Area","areaHeader":"Area","length":"Length","lengthHeader":"Length / Perimeter","perimeter":"Perimeter","meters":"Meters","m":"m","kilometers":"Kilometers","km":"km","miles":"Miles","mi":"mi","feet":"Feet","ft":"ft","squareMeters":"Meters\xb2","m\xb2":"m\xb2","squareKilometers":"Kilometers\xb2","km\xb2":"km\xb2","squareMiles":"Miles\xb2","mi\xb2":"mi\xb2","squareFeet":"Feet\xb2","ft\xb2":"ft\xb2","hectares":"Hectares","ha":"ha","acres":"Acres","ac":"ac","toggleActive":"Activate measures","toggleMapTooltips":"Show map tooltips","toggleAutoUnits":"Auto Units","actionbar":{"calculate.tooltip":"Calculate","delete.tooltip":"Delete","modify.tooltip":"Modify"}},"draw":{"cancelColorPicker":"Cancel","Circle":"Circle","dialogInstruction":"Enter your draw\'s label","dialogTitle":"Label","delete":"Remove Drawings from map","drawing":"Draws","fill":"Fill","icon":"Icons","labels":"Labels","LineString":"Line","okColorPicker":"OK","Point":"Point","Polygon":"Polygon","radius":"Radius","stroke":"Stroke","styleSelect":"Select style","toggleMapTooltips":"Show map tooltips","noIcon":"No icon"},"network":{"online":{"message":"Online","title":"Status:"},"offline":{"message":"Offline","title":"Status:"}},"workspace":{"inMapExtent.active.tooltip":"Ne montrer que les entit\xe9s contenues dans la carte","inMapExtent.inactive.tooltip":"Montrer tous les entit\xe9s"}},"integration":{"tools":{"catalog":"Catalog","contexts":"Contexts","directions":"Directions","draw":"Draw","importExport":"Import & export","ogcFilter":"Filter by","map":"Map","layers":"Layers","legend":"Legend","measurer":"Measure","print":"Print","searchResults":"Search Results","shareMap":"Share","timeFilter":"Time Filter","about":"About","spatialFilter":"Spatial Filter"},"searchResultsTool":{"noResults":"No results","doSearch":"Do a search in the search bar.","examples":"<b>Allow to search addresses, location, coordinates and layers</b>.<br><br><u>Adresses</u> research can be done with a combination of : <ul><li>building number</li><li>street name</li><li>city name</li><li>postal code</li></ul> Examples for <u>locations</u>: <ul><li>Lac Poulin</li><li>Mcdo L\xe9vis</li><li>Saint-Isidore</li></ul> You can also use keywords to refine your search. Examples: <ul><li>#mun qu\xe9bec (to search municipalities)</li><li>#sante L\xe9vis (to search health establishments)</li><li>#cpe joyeux (to search nurseries)</li><li>#intersection li\xe9gois + \xe9glise (to search an intersection, the #+ can also be used)</li></ul>*Keywords appear when hovering results type in search settings tab -> iCherche -> Results type.<br><br><u>Coordinates</u> examples :<ul><li>Decimal degree (-68.165547, 48.644546)</li><li>Degrees, minutes, seconds (-68 9 56, 48 38 40)</li><li>Degree, minutes, decimal (-68 9.56, 48 38.40)</li><li>Projected (UTM-19 561466.861, 5388278.862)</li><li>BELL (Lat: 48 38 40N Long: 68 9 56W UNC:100 CONF:90)</li><li>Meter Meter (111594.63, 445854.74;32198)</li></ul>For more informations on coordinate\'s research : <a href=\'https://igo2.readthedocs.io/fr/next/properties.html#coordonnees\' target=\'_blank\'>Consult IGO2\'s documentation</a>","zoomOnFeatureTooltip":"Zoom on selected feature.","zoomOnFeatureTooltipOutOfView":"The feature is out of view. Zoom on selected feature."},"aboutTool":{"html":"<style>#about .bold_class{font-weight: bold;}#about .red{color: red;}#about .tool_name{border-top: 1px solid; padding-top: 10px;}#about .titre_outil{font-weight: bold; font-size: 18px; padding-bottom: 8px;}#about .subtitle{font-size: 20px; padding-bottom: 10px;}#about .align_right{text-align: right;}#about .describe{text-align: justify;}#about a img{color: black; text-decoration: none;}</style><body> <div id=\'about\'> <div class=\'bold_class subtitle\'>Features overview</div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z\'> </path> </svg></mat-icon> Search Results </div><div class=\'describe\'>Located in the upper left portion of the interface, the search bar allows you to locate yourself using an address, location or GPS coordinates. The tool can also be used to search for a layer. </div></div><br><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z\'></path> </svg></mat-icon> Contexts </div><div class=\'describe\'> Visualize groupings of layers made by theme or by work context. When you select a <span class=\'bold_class\'>Context</span>, you will find in <span class=\'bold_class\'>Map</span> each of the layers it contains. You can add other layers to it from the <span class=\'bold_class\'>Catalog</span> or the <span class=\'bold_class\'>Search</span> tool. <br><div class=\'red\'> <span class=\'bold_class\'>WARNING :</span> If you select another <span class=\'bold_class\'>Context</span>, all the layers displayed in the <span class=\'bold_class\'>Map</span> will be replaced. </div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M15,19L9,16.89V5L15,7.11M20.5,3C20.44,3 20.39,3 20.34,3L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21C3.55,21 3.61,21 3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3Z\'> </path> </svg></mat-icon> Map </div><div class=\'describe\'>Personalize your map using the <span class=\'bold_class\'>Catalog</span> or the <span class=\'bold_class\'>Search</span> tool. This space allows you to add, delete and interrogate layers.</div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M1.39,18.36L3.16,16.6L4.58,18L5.64,16.95L4.22,15.54L5.64,14.12L8.11,16.6L9.17,15.54L6.7,13.06L8.11,11.65L9.53,13.06L10.59,12L9.17,10.59L10.59,9.17L13.06,11.65L14.12,10.59L11.65,8.11L13.06,6.7L14.47,8.11L15.54,7.05L14.12,5.64L15.54,4.22L18,6.7L19.07,5.64L16.6,3.16L18.36,1.39L22.61,5.64L5.64,22.61L1.39,18.36Z\'> </path> </svg></mat-icon> Measure </div><div class=\'describe\'>Measure distances or areas on the map.</div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M14,14.5V12H10V15H8V11A1,1 0 0,1 9,10H14V7.5L17.5,11M21.71,11.29L12.71,2.29H12.7C12.31,1.9 11.68,1.9 11.29,2.29L2.29,11.29C1.9,11.68 1.9,12.32 2.29,12.71L11.29,21.71C11.68,22.09 12.31,22.1 12.71,21.71L21.71,12.71C22.1,12.32 22.1,11.68 21.71,11.29Z\'> </path> </svg></mat-icon> Directions </div><div class=\'describe\'> Build a route between two points (by placing the two points on the map or by looking for addresses). You can then add intermediate points, copy the description of the route to the clipboard or share the link.</div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M17,14H19V17H22V19H19V22H17V19H14V17H17V14M11,16L2,9L11,2L20,9L11,16M11,18.54L12,17.75V18C12,18.71 12.12,19.39 12.35,20L11,21.07L2,14.07L3.62,12.81L11,18.54Z\'></path> </svg></mat-icon> Catalog </div><div class=\'describe\'> Find all the layers that can be added to the <span class=\'bold_class\'>Map</span>. Click on the desired layer to add it. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M14,17H18V14L23,18.5L18,23V20H14V17M13,9H18.5L13,3.5V9M6,2H14L20,8V12.34C19.37,12.12 18.7,12 18,12A6,6 0 0,0 12,18C12,19.54 12.58,20.94 13.53,22H6C4.89,22 4,21.1 4,20V4A2,2 0 0,1 6,2Z\'></path> </svg></mat-icon> Import & export </div><div class=\'describe\'> Import or export a layer with a specific projection. You can also save or reload a context. It allows you to save contexts as anonymous. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z\'></path> </svg></mat-icon> Print </div><div class=\'describe\'>Print the map displayed on the screen. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M18,16.08C17.24,16.08 16.56,16.38 16.04,16.85L8.91,12.7C8.96,12.47 9,12.24 9,12C9,11.76 8.96,11.53 8.91,11.3L15.96,7.19C16.5,7.69 17.21,8 18,8A3,3 0 0,0 21,5A3,3 0 0,0 18,2A3,3 0 0,0 15,5C15,5.24 15.04,5.47 15.09,5.7L8.04,9.81C7.5,9.31 6.79,9 6,9A3,3 0 0,0 3,12A3,3 0 0,0 6,15C6.79,15 7.5,14.69 8.04,14.19L15.16,18.34C15.11,18.55 15.08,18.77 15.08,19C15.08,20.61 16.39,21.91 18,21.91C19.61,21.91 20.92,20.61 20.92,19A2.92,2.92 0 0,0 18,16.08Z\'> </path> </svg></mat-icon> Share </div><div class=\'describe\'> Create a URL that redirects to an exact representation of your map on the screen. This link can be shared or distributed in a document and allows you to \\"save\\" your map for later use. </div><br></div><div class=\'tool_name\'> <p> <a href=\'http://igouverte.org/\' target=\'_blank\'><img src=\'./assets/igo2/core/logo.png\' alt=\'IGO\' height=32>IGO2</a> is a free web solution in geomatics, developed in collaborative mode by specialists from several departments and agencies of the government of Quebec. <p> Version :{{version.lib}}</p></div>","trainingGuide":"Training guide","trainingGuideTooltip":"Click here to access IGO2\'s self-training guide"},"mapTool":{"empty":"No layer is currently active on this map. ","customize":"Customize it by adding layer from the : ","search-tool":"Search tool","catalog-tool":"Data catalog","context-tool":"Context manager","noLayersVisible":"There is no visible layers.","noLayersInRange":"There is no visible layers at the current scale. Please zoom in or out to discover theses layers."},"importExportTool":{"importExportData":"Layer","importExportContext":"Context"},"workspace":{"toggleWorkspace":"Open/Close the table view","ogcFilter.close":"Close","ogcFilter.title":"Filters","ogcFilter.tooltip":"Apply filters","download.title":"Download","download.tooltip":"Download","inMapExtent.title":"Show records contained in map","inMapExtent.active.tooltip":"Show records contained in map","inMapExtent.inactive.tooltip":"Show all records","zoomAuto.title":"Zoom auto","zoomAuto.tooltip":"Zoom auto","selected.title":"Show selected records only","selected.tooltip":"Show selected records only","clearSelection.title":"Deselect all","clearSelection.tooltip":"Deselect all records","maximize":"Extend","maximizeTooltip":"Extend panel","standardExtent":"Reduce","standardExtentTooltip":"Reduce panel"}}}}')},"gy/B":function(e){e.exports=JSON.parse('{"igo":{"geo":{"catalog":{"layer.addToMap":"Ajouter \xe0 la carte","layer.addToMapOutRange":"Ajouter \xe0 la carte. La donn\xe9e est non visible \xe0 l\'\xe9chelle active. Veuillez zoomer +/- si vous voulez l\'apercevoir \xe0 la carte.","layer.removeFromMap":"Retirer de la carte","layer.removeFromMapOutRange":"Retirer de la carte. La donn\xe9e est non visible \xe0 l\'\xe9chelle active. Veuillez zoomer +/- si vous voulez l\'apercevoir \xe0 la carte.","group.addToMap":"Ajouter toutes les couches de ce groupe \xe0 la carte","group.removeFromMap":"Retirer toutes les couches de ce groupe de la carte","baseLayers":"Fonds de carte","unavailableTitle":"Catalogue indisponible","unavailable":"Le catalogue \'{{value}}\' est indisponible pour le moment ou vous n\'avez pas les permissions requises.","externalProvider":{"catalog":"Ce catalogue provient d\'une organisation externe.","layer":"Cette couche provient d\'une organisation externe.","unavailableWithEmail":"Le catalogue \'{{value}}\' est indisponible pour le moment. Pour ajouter un service externe \xe0 la liste pr\xe9d\xe9finie, veuillez contacter {{email}}. Des d\xe9lais peuvent s\'appliquer si probl\xe8me il y a avec le fournisseur externe."},"library.add":"Ajouter ce catalogue","library.cancel":"Annuler","library.remove":"Retirer ce catalogue de la liste","library.inlist":{"title":"Catalogue d\xe9j\xe0 contenu","message":"Le catalogue \xe0 ajouter est d\xe9j\xe0 dans la liste"},"library.addTitle":"Ajout d\'un catalogue","library.addBtn":"Ajouter un catalogue"},"clickOnMap":{"clickedFeature":"Entit\xe9s cliqu\xe9es"},"baselayersSwitcher":{"title":"Fonds de carte"},"dataSource":{"unavailableTitle":"Couche indisponible","optionsApiUnavailable":"L\'information sur les couches n\'a pas pu \xeatre r\xe9cup\xe9r\xe9e. Certaines couches pourraient ne pas pr\xe9senter la bonne information.","unavailable":"La couche \'{{value}}\' est indisponible pour le moment ou vous n\'avez pas les permissions requises."},"dropGeoFile":{"invalid":{"text":"Le fichier \'{{value}}\' est invalide. ({{mimeType}})","title":"Fichier invalide"},"empty":{"text":"Le fichier \'{{value}}\' est vide, impossible d\'importer","title":"Fichier vide"},"success":{"text":"La couche \'{{value}}\' a \xe9t\xe9 ajout\xe9e \xe0 la carte","title":"Fichier import\xe9"},"unreadable":{"text":"Le fichier \'{{value}}\' est impossible \xe0 lire","title":"Fichier illisible"},"tooLarge":{"text":"Le fichier \'{{value}}\' est trop volumineux (Maximum: {{size}} Mo)","title":"Fichier trop volumineux"},"invalidSRS":{"text":"La projection est valide. Elle doit commencer par EPSG:","title":"Projection invalid"}},"export":{"customList":{"text":"Certaines couches s\xe9lectionn\xe9es ( {{value}} ) r\xe9duisent la liste des formats possible","title":"Liste restreinte de formats"},"nothing":{"text":"Impossible d\u2019exporter, donn\xe9e non valide ou aucune donn\xe9e s\xe9lectionn\xe9e.","title":"Donn\xe9e non valide ou non pr\xe9sente"},"noFormat":{"text":"Aucun format d\'exportation valide pour toutes les couches s\xe9lectionn\xe9es. Veuillez exporter les couches une \xe0 la fois.","title":"Aucun format disponible"},"failed":{"text":"Impossible d\u2019exporter, probl\xe8me de donn\xe9e rencontr\xe9.","title":"Probl\xe8me d\u2019exportation"},"popupBlocked":{"text":"</br>Veuillez autoriser l\'ouverture des fen\xeatres (popup) dans votre fureteur. </br>Pour Chrome and Edge, \xe0 droite dans la barre d\'adresse).</br>{{extraMessage}}","selectAgain":"Faites le correctif et s\xe9lectionner \xe0 nouveau un format.","retry":"Veuillez recommencer l\'exportation.","title":"Ouverture de fen\xeatre bloqu\xe9e par votre fureteur"},"success":{"text":"Donn\xe9es export\xe9es avec succ\xe8s.","title":"Exportation r\xe9ussie"},"format":{"GeoJSON":"GeoJSON","GML":"GML","GPX":"GPX","KML":"KML","Shapefile":"Shapefile","CSVcomma":"CSV (s\xe9parateur virgule)","CSVsemicolon":"CSV (s\xe9parateur point-virgule)","URL":"Lien externe"},"gpx.error.poly":{"title":"GPX en erreur","text":"Le format GPX ne permet pas de stocker les polygones"},"encoding":{"LATIN1":"LATIN-1","UTF8":"UTF-8"}},"importExportForm":{"exportButton":"Exporter","exportButtonLink":"Ouvrir le lien","exportButtonLinks":"Ouvrir les liens","exportFormatPlaceholder":"Format","exportLayerPlaceholder":"Couche(s)","exportFileNamePlaceholder":"Nom du fichier","encodingPlaceholder":"Encodage","exportTabTitle":"Exporter","exportFeatureInExtent":"Seulement les entit\xe9s contenues dans la carte","exportNoLayersExportable":"Aucune couche exportable dans la carte courante","exportSelectedFeature":"Seulement les entit\xe9s s\xe9lectionn\xe9es","importButton":"Importer","importProjPlaceholder":"Syst\xe8me de coordonn\xe9es du fichier \xe0 importer","importTabTitle":"Importer","importClarifications":"Pr\xe9cisions","importSizeMax":"La taille limite du fichier est de {{size}} Mo","importFormatAuthorized":"Formats autoris\xe9s: geojson, kml, gpx, gml, shapefile","importShpZip":"Les shapefiles doivent \xeatre compress\xe9s (zipp\xe9s) ET leurs g\xe9om\xe9tries doivent \xeatre en coordonn\xe9es Latitude Longitude (EPSG:4326/WGS84)","other":"autre","others":"autres","projections":{"mtm":"MTM {{zone}} ({{code}})","utm":"UTM {{zone}} ({{code}})","webMercator":"Web Mercator ({{code}})","nad83":"Lat-Long NAD83 ({{code}})","wgs84":"Lat-Long WGS84 ({{code}})","choose":"Vous devez choisir une projection avant d\'importer le fichier."}},"operators":{"caseSensitive":"Sensible \xe0 la case","And":"Et","Or":"Ou","PropertyIsEqualTo":"=","PropertyIsNotEqualTo":"!=","PropertyIsLike":"\u2248","PropertyIsGreaterThan":">","PropertyIsGreaterThanOrEqualTo":">=","PropertyIsLessThan":"<","PropertyIsLessThanOrEqualTo":"<=","PropertyIsBetween":"entre","During":"durant (temporel)","PropertyIsNull":"est nul","Intersects":"intersecte (g\xe9om\xe9trique)","Within":"contenu dans (g\xe9om\xe9trique)","Contains":"contient (g\xe9om\xe9trique)","tooltip":{"And":"Op\xe9rateur logique entre les filtres o\xf9 les deux conditions doivent \xeatre remplies","Or":"Op\xe9rateur logique entre les filtres o\xf9 au moins une (1) condition doit \xeatre vraie","PropertyIsEqualTo":"Identique (sensible \xe0 la case)","PropertyIsNotEqualTo":"Diff\xe9rent (sensible \xe0 la case)","PropertyIsLike":"Comme. Exemple: *route* trouve toutes les valeurs contenent \'route\', peu importe sa position dans l\'attribut. route* trouve toutes les valeurs commencant par \'route\'. Options avanc\xe9es : wildCard =\'*\', singleChar = \'.\' escapeChar = \'!\' (sensible \xe0 la case)","PropertyIsGreaterThan":"Plus grand","PropertyIsGreaterThanOrEqualTo":"Plus grand ou \xe9gal","PropertyIsLessThan":"Plus petit","PropertyIsLessThanOrEqualTo":"Plus petit ou \xe9gal","PropertyIsBetween":"Doit \xeatre contenu entre les limites inf\xe9rieure et sup\xe9rieure (les valeurs sont incluses)","During":"Doit \xeatre contenu entre les p\xe9riodes de temps sp\xe9cifi\xe9es","PropertyIsNull":"Dont l\'attribut est nul","Intersects":"Retourne les entit\xe9s \xe9tant en intersection g\xe9om\xe9trique avec la g\xe9om\xe9trie fournie","Within":"Retourne les entit\xe9s \xe9tant enti\xe8rement contenue par la g\xe9om\xe9trie fournie (Within)","Contains":"Retourne les entit\xe9s compl\xe8tement contenues par la g\xe9om\xe9trie fournie (Contains)"}},"sourceFields":{"selectField":"Choisir un champ"},"filter":{"addFilter":"Ajouter un filtre vide \xe0 la liste courante","removeFilter":"Supprimer le pr\xe9sent filtre \xe0 la liste des filtres","toggleFilterState":"Activer/d\xe9sactiver le pr\xe9sent filtre","refreshFilters":"Mettre \xe0 jour la source de donn\xe9e avec les filtres actifs de la liste. Pour activer ce boutton, la couche doit etre visible (et dans les \xe9chelles permises) ou veillez modifier le pr\xe9sent filtre.","layerFiltered":"Cette couche d\'information est pr\xe9sentement filtr\xe9e.","layerFilterable":"Cette couche d\'information est filtrable","filterBy":"Filtrer par","advancedOgcFilters":"Filtres avanc\xe9s","displayMoreResults":"Afficher plus (+)","displayLessResults":"Afficher moins (-)","placeholder":"Saisir une valeur","placeholderSnrc":"Ex: 21L14","selectOperator":"Choisir un op\xe9rateur","sliderModeTitle":"Curseur temporel","reportingDate":"Date de signalement"},"spatialSelector":{"fixedExtent":"\xc9tendue fixe","btnSetExtent":"D\xe9finir l\'\xe9tendue du filtre selon l\'\xe9tendue courante de la carte","snrc":"SNRC","selectFeature":"","drawFeature":""},"layer":{"hideLayer":"Masquer la couche","hideSelectedLayers":"Masquer les couches s\xe9lectionn\xe9es","lowerLayer":"Mettre en arri\xe8re","filterLowerLayer":"Le d\xe9placement arri\xe8re se fait toujours selon l\'ordre de la carte!","filterPlaceholder":"Filtrer la liste de couches","activateSelectionMode":"Activer le mode de s\xe9lection multiple","deactivateSelectionMode":"D\xe9sactiver le mode de s\xe9lection multiple","tools":"Outils","selectAll":"Tout s\xe9lectionner","deselectAll":"Tout d\xe9s\xe9lectionner","opacity":"Opacit\xe9","raiseLayer":"Mettre en avant","filterRaiseLayer":"Le d\xe9placement avant se fait toujours selon l\'ordre de la carte!","moreOptions":"Outils de la couche","removeLayer":"Retirer la couche de la carte","removeSelectedLayers":"Retirer les couches s\xe9lectionn\xe9es de la carte","removeSelectedLayersRestriction":"Certaines couches s\xe9lectionn\xe9es ne peuvent \xeatre supprim\xe9es","showFeaturesList":"Afficher la liste des entit\xe9s","showLayer":"Afficher la couche","showSelectedLayers":"Afficher les couches s\xe9lectionn\xe9es","subsetLayersListKeyword":"Limiter l\'affichage de la liste selon le titre ou  par type (wms, wfs,...)","deleteKeyword":"Supprimer le mot-cl\xe9","subsetLayersListOnlyVisible":"Conserver seulement les couches visibles","subsetLayersListOnlyInRange":"Conserver seulement les couches de la plage d\'\xe9chelle active","sortAlphabetically":"Trier la liste des couches en ordre alphab\xe9tique","sortMapOrder":"Replacer les couches selon l\'ordre cartographique","resetLayersList":"R\xe9tablir l\'affichage de l\'ensemble des couches","trackFeature":"Suivre l\'entit\xe9","legend":{"default":"D\xe9faut","loadingLegendText":"Chargement de la l\xe9gende","noLegendText":"Aucune symbologie disponible pour cette couche","noLegendScale":"Aucune symbologie disponible pour cette \xe9chelle","selectStyle":"S\xe9lectionner le style de la l\xe9gende","showAll":"Montrer toutes les couches (non visible et hors \xe9chelle)","noLayersVisibleWithShowAllButton":"Aucune couche actuellement visible. Activez le bouton ci haut pour voir toutes les l\xe9gendes.","noLayersVisibleWithShowAllButtonButZoom":"Aucune couche actuellement visible. Si vous zoomez dans la carte, certaines couches appara\xeetront OU activez le bouton ci haut pour voir toutes les l\xe9gendes.","noLayersVisible":"Aucune couche actuellement visible.","noLayersVisibleButZoom":"Aucune couche actuellement visible. Par contre, si vous zoomez dans la carte, certaines couches appara\xeetront."}},"download":{"action":"T\xe9l\xe9charger les donn\xe9es associ\xe9es","title":"T\xe9l\xe9chargement des donn\xe9es","start":"V\xe9rifiez la progression du t\xe9l\xe9chargement dans votre navigateur","end":"Termin\xe9"},"mapButtons":{"baselayerSwitcher":"Changer le fond de carte","geolocate":"Afficher votre position","offline":"Passer en mode hors-ligne","online":"Passer en mode en ligne","zoomIn":"Zoomer ({{zoom}})","zoomOut":"D\xe9zoomer ({{zoom}})","resetRotation":"R\xe9initialiser la carte vers le nord","tipRotation":"Maintenez les touches Alt et Majuscule (shift) tout en cliquant sur la carte pour faire pivoter la carte"},"metadata":{"show":"Montrer les m\xe9tadonn\xe9es"},"printForm":{"corsErrorMessageBody":"Impossible d\'imprimer d\xfb \xe0 des droits d\'acc\xe8s non d\xe9tenus","corsErrorMessageHeader":"Impression","comment":"Commentaire","doZipFile":"Compresser le fichier","outputFormat":"Format de sortie","paperFormat":"Format du papier","paperFormats":{"A0":"33.1 X 46.8\\" (A0)","A1":"23.4 X 33.1\\" (A1)","A2":"16.5 X 23.5\\" (A2)","A3":"11.7 X 16.5\\" (A3)","A4":"8.3 X 11.7\\" (A4)","A5":"5.8 X 8.3\\" (A5)","Letter":"Lettre","Legal":"L\xe9gal"},"imageFormat":"Format de l\'image","orientation":"Orientation","landscape":"Paysage","portrait":"Portrait","projection":"Projection","resolution":"R\xe9solution","saveBtn":"Sauvegarder","scale":"\xc9chelle","showLegend":"Afficher la l\xe9gende","showProjection":"Afficher la projection","showScale":"Afficher l\'\xe9chelle","title":"Titre","subtitle":"Sous-titre"},"directionsForm":{"stopLayer":"Itin\xe9raire - arr\xeats","routeLayer":"Itin\xe9raire - Trac\xe9","start":"D\xe9but","intermediate":"Interm\xe9diaire","end":"Fin","directionsBtn":"Obtenir l\'itin\xe9raire","resetDirectionsBtn":"Supprimer l\'itin\xe9raire","zoomRoute":"Zoomer sur l\'itin\xe9raire","null":"","directions":"Itin\xe9raire","raiseStop":"Prioriser l\'arr\xeat","lowerStop":"Reporter l\'arr\xeat plus loin dans le parcours","addStop":"Ajouter un arr\xeat","removeStop":"Supprimer l\'arr\xeat","drivingOptions":"Choix d\'itin\xe9raires","summary":"R\xe9sum\xe9 de l\'itin\xe9raire","stopsList":"Liste des lieux d\'arr\xeats","instructions":"Indications","copy":"Copier l\'itin\xe9raire","geolocate":"Utiliser sa localisation comme point d\'arr\xeat","link":"Lien","dialog":{"copyMsg":"Itin\xe9raire copi\xe9 dans le presse-papier","copyMsgLink":"Le lien de l\'itin\xe9raire est copi\xe9 dans le presse-papier","copyTitle":"Itin\xe9raire"}},"directions":{"uturn":"demi-tour","sharp right":"fortement \xe0 droite","right":"droite","slight right":"l\xe9g\xe8rement \xe0 droite","sharp left":"fortement \xe0 gauche","left":"gauche","slight left":"l\xe9g\xe8rement \xe0 gauche","straight":"tout droit"},"cardinalPoints":{"n":"nord","ne":"nord-est","e":"est","se":"sud-est","s":"sud","sw":"sud-ouest","w":"ouest","nw":"nord-ouest"},"search":{"placeholder":"Rechercher une localisation ou une couche de donn\xe9es","emptyType.placeholder":"Veuillez choisir un type de recherche","feature.title":"Localisation","feature.placeholder":"Rechercher une localisation","layer.title":"Couche de donn\xe9es","layer.placeholder":"Rechercher une couche de donn\xe9es.","ichercheReverse.name":"Recherche par coordonn\xe9es","ilayer":{"name":"Couches","properties":{"abstract":"Description","groupTitle":"Groupe","title":"Titre","type":"Type","url":"URL","metadataUrl":"M\xe9tadonn\xe9es","name":"Nom de la couche","urlInfo":"Lien du service web WMS/WFS","downloadUrl":"Lien de t\xe9l\xe9chargement de la donn\xe9es"},"type":{"layer":"Couche","groupLayer":"Groupe de couches"}},"nominatim":{"type":{"food":"Restauration","health":"Sant\xe9","entertainment":"Divertissement","finance":"Finance"},"country":{"all":"Le monde","canada":"Canada"}},"icherche":{"name":"iCherche","type":{"address":"Adresse","oldAddress":"Ancienne adresse","district":"Arrondissement","postalCode":"Code Postal","city":"Municipalit\xe9","oldCity":"Ancienne municipalit\xe9","mrc":"MRC","regadmin":"R\xe9gion administrative","road":"Route","intersection":"Intersection","place":"Lieu","exit":"Sortie d\'autoroute","cn":"Borne du CN","gcc":"Rep\xe8re de la garde coti\xe8re (GCC)","sumi":"Borne SUMI","km":"Rep\xe8re kilom\xe9trique","entreprise":"Entreprise","cadastre":"Cadastre"},"restrictExtent":{"map":"\xc0 l\'\xe9tendue de la carte","quebec":"Au Qu\xe9bec"}},"coordinates":{"name":"Coordonn\xe9es","coord":"Coordonn\xe9e (longitude, latitude)","radius":"Rayon","conf":"Confiance"},"menu.tooltip":"Options de recherche","settings":{"title":"Param\xe8tres"},"pointerSearchSummary":{"title":"Position du curseur","tooltip":"Afficher les coordonn\xe9es du curseur ainsi que d\'autres informations sur sa position en fonction des types de r\xe9sultats activ\xe9es. Utiliser F2 pour activer / d\xe9sactiver."},"searchResultsGeometry":{"title":"Montrer tous les r\xe9sultats","tooltip":"Afficher/cacher la g\xe9om\xe9trie des r\xe9sultats"},"searchSources":{"selectAll":"Tout s\xe9lectionner","unselectAll":"Tout d\xe9s\xe9lectionner","settings":{"results type":"Type de r\xe9sultat","ecmax":"\xc9cart maximal","radius":"Rayon de recherche","results limit":"Nombre de r\xe9sultats","multiple object":"Objet multiple","restrictExtent":"Restreint l\'\xe9tendue","selectAll":"Tout s\xe9lectionner","unselectAll":"Tout d\xe9s\xe9lectionner","true":"Oui","false":"Non"}},"displayMoreResults":"Afficher plus de r\xe9sultats"},"geometry":{"geometry":"Geometrie","point":"Point","line":"Ligne","polygon":"Surface"},"targetHtmlUrl":"Ouvrir le lien externe","searchByCoord":"Rechercher par coordonn\xe9es","searchByName":"Rechercher par nom","seeRouting":"Voir l\'itin\xe9raire","timeFilter":{"date":"Date","endDate":"Date de fin","startDate":"Date de d\xe9but","hour":"Heure","minute":"Minute"},"spatialFilter":{"spatialFilter":"Filtre spatial","predefined":"Zone Pr\xe9d\xe9finie","draw":"Dessin","polygon":"Polygone","point":"Cercle","drawPolygon":"Dessiner un polygone","drawCircle":"Dessiner un cercle","searchLabel":"Rechercher par","buffer":"Zone tampon","search":"Recherche","drawControl":"Activer le contr\xf4le de dessin","listLabel":"Zone","entity":"Entit\xe9","layer":"Couche","goSearch":"Lancer la recherche","removeLayer":"Retirer les r\xe9sultats","exportLayer":"Exporter les r\xe9sultats","clearForm":"Retirer le dessin","clearSearch":"R\xe9initialiser les champs","Address":"Adresses","Thematics":"Th\xe9matiques","searchResults":"R\xe9sultats de la recherche","type":"Type","radius":"Rayon","radiusAlert":"Le rayon doit \xeatre compris entre 0 et 100 kilom\xe8tres (ou 100 000 m\xe8tres)","bufferAlert":"La zone tampon doit \xeatre comprise entre 0 et 100 kilom\xe8tres (ou 100 000 m\xe8tres)","maxSizeAlert":"Le nombre de r\xe9sultats exc\xe8de 10000. Certains pourraient \xeatre manquants.","zeroResults":"Aucun r\xe9sultat ne correspond \xe0 cette recherche.","warning":"Avertissement","freehandControl":"\xc0 main lev\xe9e","group":{"toponyme":"Toponyme","culturel":"Culturel","education":"\xc9ducation","sante":"Sant\xe9","securite":"S\xe9curit\xe9","sepaq":"S\xc9PAQ","transport":"Transport"}},"terrapi":{"AdmRegion":"R\xe9gions administratives","Mun":"Municipalit\xe9s","Arrond":"Arrondissements","CircFed":"Circonscriptions f\xe9d\xe9rales","CircProv":"Circonscriptions provinciales","DirReg":"Directions r\xe9gionales","MRC":"MRC","RegTour":"R\xe9gions touristiques","limites":"Limites administratives","bornes":"Bornes sumi","hydro":"Hydrographie","routes":"Routes","bati":"B\xe2timents","batiment":"B\xe2timents","camping":"Camping","equipement":"\xc9quipements","commun":"Commun","geographie":"Lieux naturels","parc":"Parcs","secteur":"Secteurs","immeubles":"Immeubles patrimoniaux","sites":"Sites patrimoniaux","cpe":"Centre de la petite enfance","public":"\xc9coles publiques","prive":"\xc9coles priv\xe9s","gouvernemental":"\xc9coles gouvernementales","colleges":"Coll\xe8ges","universites":"Universit\xe9s","aine":"R\xe9sidences pour a\xeen\xe9s","ambulance":"Zones d\'ambulance","clinique":"Cliniques","etabl":"\xc9tablissements de sant\xe9","gmf":"Groupes de m\xe9decins de famille","naissance":"Maisons de naissances","pharmacie":"Pharmacies","casernes":"Casernes de pompiers","correctionnel":"Centres correctionnels","organisme":"Organismes de s\xe9curit\xe9","palais-justice":"Palais de justice","penitencier-fed":"P\xe9nitenciers f\xe9d\xe9raux","penitencier-prov":"P\xe9nitenciers provinciaux","polices":"Poste de police"},"measure":{"dialog":{"title":"Sommes de la s\xe9lection","length.title":"Distance","area.title":"Superficie","lengthInMeters":"M\xe8tres","lengthInKilometers":"Kilom\xe8tres","lengthInMiles":"Miles","lengthInFeet":"Pieds","areaInSquareMeters":"M\xe8tres\xb2","areaInSquareKilometers":"Kilom\xe8tres\xb2","areaInSquareMiles":"Miles\xb2","areaInHectares":"Hectares","areaInAcres":"Acres","perimeterInMeters":"P\xe9rim\xe8tre en m\xe8tres"},"area":"Superficie","areaHeader":"Superficie","length":"Distance","lengthHeader":"Distance / P\xe9rim\xe8tre","perimeter":"P\xe9rim\xe8tre","meters":"M\xe8tres","m":"m","kilometers":"Kilom\xe8tres","km":"km","miles":"Miles","mi":"mi","feet":"Pieds","ft":"pi","squareMeters":"M\xe8tres\xb2","m\xb2":"m\xb2","squareKilometers":"Kilom\xe8tres\xb2","km\xb2":"km\xb2","squareMiles":"Miles\xb2","mi\xb2":"mi\xb2","squareFeet":"Pieds\xb2","ft\xb2":"pi\xb2","hectares":"Hectares","ha":"ha","acres":"Acres","ac":"ac","toggleActive":"Activer le contr\xf4le de mesure","toggleMapTooltips":"Mesures sur la carte","toggleAutoUnits":"Unit\xe9s automatiques","actionbar":{"calculate.tooltip":"Calculer","delete.tooltip":"Supprimer","modify.tooltip":"Modifier"}},"draw":{"cancelColorPicker":"Annul\xe9","Circle":"Cercle","dialogInstruction":"Veuillez entrer l\'\xe9tiquette de votre dessin","dialogTitle":"\xc9tiquette","delete":"Retirer les dessins de la carte","drawing":"Dessins","fill":"Remplissage","icon":"Ic\xf4nes","labels":"\xc9tiquettes","LineString":"Ligne","okColorPicker":"OK","Point":"Point","Polygon":"Polygone","radius":"Rayon","stroke":"Contour","styleSelect":"S\xe9lectionner le style","toggleMapTooltips":"Afficher les \xe9tiquettes","noIcon":"Aucune ic\xf4ne"},"network":{"online":{"message":"En ligne","title":"Statut:"},"offline":{"message":"Hors-Ligne","title":"Statut:"}},"workspace":{"inMapExtent.active.tooltip":"Ne montrer que les enregistrements contenus dans la carte","inMapExtent.inactive.tooltip":"Montrer tous les enregistrements"}}}}')},tqkM:function(e){e.exports=JSON.parse('{"igo":{"auth":{"accessAnonymous":"Rester anonyme","connection":"Connexion","login":"Connecter","password":"Mot de passe","signOut":"Se d\xe9connecter","user":"Utilisateur","welcome":"Bienvenue {{name}}!","deconnection":"Vous \xeates d\xe9connect\xe9","home":"Retourner \xe0 la page d\'accueil","error":{"Password expired":"Votre mot de passe est expir\xe9","Maximun logins exceeded":"Nombre maximal de connexions d\xe9pass\xe9","Login lockout":"Nombre maximal d\'essai d\xe9pass\xe9. Votre compte est verrouill\xe9.","Wrong password":"Mot de passe incorrect","Invalid username":"Utilisateur invalide"},"google":{"login":"Se connecter avec Google","logged":"Connect\xe9 avec Google"},"microsoft":{"login":"Se connecter avec Microsoft"}},"common":{"confirmDialog":{"cancelBtn":"Annuler","confirmBtn":"Confirmer","title":"Confirmation"},"table":{"filter":"Filtre"},"entity-table":{"targetHtmlUrl":"Ouvrir le lien externe"},"form":{"errors":{"required":"Ce champ est requis"}},"actionbar":{"scrollUp":"D\xe9filer vers le haut","scrollDown":"D\xe9filer vers le bas","icon":"Actions suppl\xe9mentaires"},"interactiveTour":{"tooltipTourToolButton":"Aide interactive sur l\'outil","disaledTooltipTourToolButton":"Pour avoir acc\xe8s au tour interactif de cet outil, ajouter des contextes ou des couches","buttonTitle":"D\xe9couvrir","exitButton":"Quitter","backButton":"Pr\xe9c\xe9dent","nextButton":"Suivant"},"paginator":{"firstPageLabel":"Premi\xe8re page","itemsPerPageLabel":"Entit\xe9s par page:","lastPageLabel":"Derni\xe8re page","nextPageLabel":"Page suivante","previousPageLabel":"Page pr\xe9c\xe9dente","of":"de"}},"context":{"bookmarkButton":{"create":"Cr\xe9er un contexte","dialog":{"createMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 cr\xe9\xe9","createTitle":"Contexte cr\xe9\xe9","placeholder":"Titre","title":"Nouveau contexte"}},"contextManager":{"clone":"Cloner ce contexte","delete":"Supprimer ce contexte","dialog":{"cloneMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 clon\xe9","cloneTitle":"Contexte clon\xe9","copyMsg":"Texte copi\xe9","copyTitle":"Identifiant du contexte","confirmDelete":"\xcates-vous s\xfbr de vouloir supprimer ce contexte ?","deleteMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 supprim\xe9","deleteTitle":"Contexte supprim\xe9","favoriteMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 d\xe9fini comme favori","favoriteTitle":"Favori enregistr\xe9","saveMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 enregistr\xe9","saveTitle":"Contexte enregistr\xe9"},"edit":"\xc9diter ce contexte","errors":{"uncaught":{"message":"D\xe9sol\xe9! Le service que vous voulez utiliser n\u2019est malheureusement pas disponible pour le moment. Essayez plus tard!","title":"Erreur de serveur"},"addPermission":"La permission que vous tentez d\'ajouter est d\xe9j\xe0 pr\xe9sente dans le contexte.","addPermissionEmpty":"La permission que vous tentez d\'ajouter n\'est pas valide","addPermissionTitle":"Erreur d\'ajout de permission"},"favorite":"D\xe9finir comme contexte favori","form":{"copy":"Copier l\'identifiant du contexte","edit":"Enregistrer","title":"Titre","titleRequired":"Le titre est obligatoire","uri":"Identifiant","uriRequired":"L\'identifiant est obligatoire"},"invalid":{"text":"Le contexte \\"{{value}}\\" est invalide. Le contexte par d\xe9faut a \xe9t\xe9 charg\xe9.","title":"Contexte invalide"},"managePermissions":"G\xe9rer les permissions du contexte","manageTools":"G\xe9rer les outils du contexte","ourContexts":"Mes contextes","publicContexts":"Contextes publics","save":"Sauvegarder ce contexte","sharedContexts":"Contextes partag\xe9s","filterPlaceHolder":"Filtrer par nom","sortAlphabetically":"Trier en ordre alphab\xe9tique","sortContextOrder":"Replacer selon la date de cr\xe9ation","userAccount":"Profils utilisateurs","filterUser":"Filtrer par groupe d\'utilisateur","emptyContext":"Contexte vide","emptyContextTooltip":"Cr\xe9er un nouveau contexte vide","contextMap":"Contexte \xe0 partir de la carte","contextMapTooltip":"Cr\xe9er un nouveau contexte \xe0 partir des couches la carte","hide":"Masquer ce contexte","show":"Montrer ce contexte","showHidden":"Montrer les contextes masqu\xe9s"},"contextImportExport":{"export":{"exportPlaceHolder":"Couches","exportContextName":"Nom du contexte","exportSelectAll":"Tout s\xe9lectionner","success":{"text":"Contexte export\xe9 avec succ\xe8s.","title":"Exportation r\xe9ussie"},"nothing":{"text":"Impossible d\u2019exporter, contexte non valide ou aucun contexte s\xe9lectionn\xe9.","title":"Donn\xe9e non valide ou non pr\xe9sente"},"failed":{"text":"Impossible d\u2019exporter, probl\xe8me de contexte rencontr\xe9.","title":"Probl\xe8me d\u2019exportation"}},"import":{"success":{"title":"Contexte import\xe9","text":"Le contexte \'{{value}}\' a \xe9t\xe9 ajout\xe9 \xe0 la carte"},"empty":{"text":"Le contexte \'{{value}}\' est vide, impossible d\'importer","title":"Contexte vide"},"invalid":{"text":"Le contexte \'{{value}}\' est invalide.","title":"Context invalide"},"unreadable":{"text":"Le contexte \'{{value}}\' est impossible \xe0 lire","title":"Context illisible"},"tooLarge":{"text":"Le contexte \'{{value}}\' est trop volumineux (Maximum: {{size}} Mo)","title":"Context trop volumineux"}}},"permission":{"addBtn":"Ajouter","delete":"Retirer la permission","dialog":{"addMsg":"La permission \'{{value}}\' a \xe9t\xe9 ajout\xe9e","addTitle":"Permission ajout\xe9e","deleteMsg":"La permission \'{{value}}\' a \xe9t\xe9 supprim\xe9e","deleteTitle":"Permission retir\xe9e","scopeChangedMsg":"La port\xe9e du contexte a \xe9t\xe9 chang\xe9e pour {{value}}","scopeChangedTitle":"Changement de la port\xe9e"},"profil":"Profil","user":"Utilisateur ou groupe","profilRequired":"Le profil est obligatoire","read":"Lecture seule","readOnlyTitle":"Contexte en lecture seule","readOnlyMsg":"Vous pouvez seulement retirer la permission si le contexte est directement partag\xe9 \xe0 votre nom d\'utilisateur.","scope":{"private":"Priv\xe9","protected":"Prot\xe9g\xe9","shared":"Partag\xe9","public":"Public"},"write":"Lecture et \xe9criture"},"poiButton":{"create":"Cr\xe9er une zone d\'int\xe9r\xeat","dialog":{"confirmDelete":"\xcates-vous s\xfbr de vouloir supprimer cette zone d\'int\xe9r\xeat ?","createMsg":"La zone d\'int\xe9r\xeat \'{{value}}\' a \xe9t\xe9 cr\xe9\xe9e","createTitle":"Zone d\'int\xe9r\xeat cr\xe9\xe9e","deleteMsg":"La zone d\'int\xe9r\xeat \'{{value}}\' a \xe9t\xe9 supprim\xe9e","deleteTitle":"Zone d\'int\xe9r\xeat supprim\xe9e","placeholder":"Titre","title":"Nouvelle zone d\'int\xe9r\xeat"},"placeholder":"Zones d\'int\xe9r\xeat"},"sidenav":{"goBack":"Revenir","mainMenu":"Revenir au menu principal"},"shareMap":{"button":"Partager la carte","refreshBtn":"Actualiser le partage","copy":"Copier le lien","shareWithApi":"Partage par contexte","shareWithUrl":"Partage par url","dialog":{"copyMsg":"Lien copi\xe9","copyTitle":"Lien"},"errorTitle":"Erreur lors du partage","placeholderLink":"Lien","included":"Inclus dans le lien de partage :","context":"Le contexte ouvert lors de la cr\xe9ation du lien de partage.","center":"Les coordonn\xe9es du centre de la carte (longitude, latitude).","zoom":"Le niveau de zoom de la carte.","addedLayers":"Les couches ajout\xe9es via le catalogue ou via la barre de recherche.","visibleInvisible":"Le statut de visibilit\xe9 des couches.","excluded":"Exclus dans le lien de partage :","order":"L\'ordre des couches.","opacity":"Les modifications effectu\xe9es \xe0 l\'opacit\xe9 des couches.","filterOgc":"Les ajouts/modifications faits aux filtres par attribut.","filterTime":"La valeur en cours pour les filtres temporels."},"tool":{"dialog":{"addMsg":"L\'outil a \xe9t\xe9 ajout\xe9","addTitle":"Outil ajout\xe9","deleteMsg":"L\'outil a \xe9t\xe9 supprim\xe9","deleteTitle":"Outil retir\xe9"}},"userButton":{"dialog":{"email":"Courriel","expiration":"Expiration","user":"Utilisateur","clearPreferences":"Supprimer mes pr\xe9f\xe9rences"},"infoTitle":"Info sur l\'utilisateur","logout":"Se d\xe9connecter"}},"core":{"errors":{"uncaught":{"message":"D\xe9sol\xe9! Le service que vous voulez utiliser n\u2019est malheureusement pas disponible pour le moment. Essayez plus tard!","title":"Erreur serveur"}},"network":{"online":{"message":"En ligne","title":"Statut:"},"offline":{"message":"Hors-Ligne","title":"Statut:"}}},"geo":{"catalog":{"layer.addToMap":"Ajouter \xe0 la carte","layer.addToMapOutRange":"Ajouter \xe0 la carte. La donn\xe9e est non visible \xe0 l\'\xe9chelle active. Veuillez zoomer +/- si vous voulez l\'apercevoir \xe0 la carte.","layer.removeFromMap":"Retirer de la carte","layer.removeFromMapOutRange":"Retirer de la carte. La donn\xe9e est non visible \xe0 l\'\xe9chelle active. Veuillez zoomer +/- si vous voulez l\'apercevoir \xe0 la carte.","group.addToMap":"Ajouter toutes les couches de ce groupe \xe0 la carte","group.removeFromMap":"Retirer toutes les couches de ce groupe de la carte","baseLayers":"Fonds de carte","unavailableTitle":"Catalogue indisponible","unavailable":"Le catalogue \'{{value}}\' est indisponible pour le moment ou vous n\'avez pas les permissions requises.","externalProvider":{"catalog":"Ce catalogue provient d\'une organisation externe.","layer":"Cette couche provient d\'une organisation externe.","unavailableWithEmail":"Le catalogue \'{{value}}\' est indisponible pour le moment. Pour ajouter un service externe \xe0 la liste pr\xe9d\xe9finie, veuillez contacter {{email}}. Des d\xe9lais peuvent s\'appliquer si probl\xe8me il y a avec le fournisseur externe."},"library.add":"Ajouter ce catalogue","library.cancel":"Annuler","library.remove":"Retirer ce catalogue de la liste","library.inlist":{"title":"Catalogue d\xe9j\xe0 contenu","message":"Le catalogue \xe0 ajouter est d\xe9j\xe0 dans la liste"},"library.addTitle":"Ajout d\'un catalogue","library.addBtn":"Ajouter un catalogue"},"clickOnMap":{"clickedFeature":"Entit\xe9s cliqu\xe9es"},"baselayersSwitcher":{"title":"Fonds de carte"},"dataSource":{"unavailableTitle":"Couche indisponible","optionsApiUnavailable":"L\'information sur les couches n\'a pas pu \xeatre r\xe9cup\xe9r\xe9e. Certaines couches pourraient ne pas pr\xe9senter la bonne information.","unavailable":"La couche \'{{value}}\' est indisponible pour le moment ou vous n\'avez pas les permissions requises."},"dropGeoFile":{"invalid":{"text":"Le fichier \'{{value}}\' est invalide. ({{mimeType}})","title":"Fichier invalide"},"empty":{"text":"Le fichier \'{{value}}\' est vide, impossible d\'importer","title":"Fichier vide"},"success":{"text":"La couche \'{{value}}\' a \xe9t\xe9 ajout\xe9e \xe0 la carte","title":"Fichier import\xe9"},"unreadable":{"text":"Le fichier \'{{value}}\' est impossible \xe0 lire","title":"Fichier illisible"},"tooLarge":{"text":"Le fichier \'{{value}}\' est trop volumineux (Maximum: {{size}} Mo)","title":"Fichier trop volumineux"},"invalidSRS":{"text":"La projection est valide. Elle doit commencer par EPSG:","title":"Projection invalid"}},"export":{"customList":{"text":"Certaines couches s\xe9lectionn\xe9es ( {{value}} ) r\xe9duisent la liste des formats possible","title":"Liste restreinte de formats"},"nothing":{"text":"Impossible d\u2019exporter, donn\xe9e non valide ou aucune donn\xe9e s\xe9lectionn\xe9e.","title":"Donn\xe9e non valide ou non pr\xe9sente"},"noFormat":{"text":"Aucun format d\'exportation valide pour toutes les couches s\xe9lectionn\xe9es. Veuillez exporter les couches une \xe0 la fois.","title":"Aucun format disponible"},"failed":{"text":"Impossible d\u2019exporter, probl\xe8me de donn\xe9e rencontr\xe9.","title":"Probl\xe8me d\u2019exportation"},"popupBlocked":{"text":"</br>Veuillez autoriser l\'ouverture des fen\xeatres (popup) dans votre fureteur. </br>Pour Chrome and Edge, \xe0 droite dans la barre d\'adresse).</br>{{extraMessage}}","selectAgain":"Faites le correctif et s\xe9lectionner \xe0 nouveau un format.","retry":"Veuillez recommencer l\'exportation.","title":"Ouverture de fen\xeatre bloqu\xe9e par votre fureteur"},"success":{"text":"Donn\xe9es export\xe9es avec succ\xe8s.","title":"Exportation r\xe9ussie"},"format":{"GeoJSON":"GeoJSON","GML":"GML","GPX":"GPX","KML":"KML","Shapefile":"Shapefile","CSVcomma":"CSV (s\xe9parateur virgule)","CSVsemicolon":"CSV (s\xe9parateur point-virgule)","URL":"Lien externe"},"gpx.error.poly":{"title":"GPX en erreur","text":"Le format GPX ne permet pas de stocker les polygones"},"encoding":{"LATIN1":"LATIN-1","UTF8":"UTF-8"}},"importExportForm":{"exportButton":"Exporter","exportButtonLink":"Ouvrir le lien","exportButtonLinks":"Ouvrir les liens","exportFormatPlaceholder":"Format","exportLayerPlaceholder":"Couche(s)","exportFileNamePlaceholder":"Nom du fichier","encodingPlaceholder":"Encodage","exportTabTitle":"Exporter","exportFeatureInExtent":"Seulement les entit\xe9s contenues dans la carte","exportNoLayersExportable":"Aucune couche exportable dans la carte courante","exportSelectedFeature":"Seulement les entit\xe9s s\xe9lectionn\xe9es","importButton":"Importer","importProjPlaceholder":"Syst\xe8me de coordonn\xe9es du fichier \xe0 importer","importTabTitle":"Importer","importClarifications":"Pr\xe9cisions","importSizeMax":"La taille limite du fichier est de {{size}} Mo","importFormatAuthorized":"Formats autoris\xe9s: geojson, kml, gpx, gml, shapefile","importShpZip":"Les shapefiles doivent \xeatre compress\xe9s (zipp\xe9s) ET leurs g\xe9om\xe9tries doivent \xeatre en coordonn\xe9es Latitude Longitude (EPSG:4326/WGS84)","other":"autre","others":"autres","projections":{"mtm":"MTM {{zone}} ({{code}})","utm":"UTM {{zone}} ({{code}})","webMercator":"Web Mercator ({{code}})","nad83":"Lat-Long NAD83 ({{code}})","wgs84":"Lat-Long WGS84 ({{code}})","choose":"Vous devez choisir une projection avant d\'importer le fichier."}},"operators":{"caseSensitive":"Sensible \xe0 la case","And":"Et","Or":"Ou","PropertyIsEqualTo":"=","PropertyIsNotEqualTo":"!=","PropertyIsLike":"\u2248","PropertyIsGreaterThan":">","PropertyIsGreaterThanOrEqualTo":">=","PropertyIsLessThan":"<","PropertyIsLessThanOrEqualTo":"<=","PropertyIsBetween":"entre","During":"durant (temporel)","PropertyIsNull":"est nul","Intersects":"intersecte (g\xe9om\xe9trique)","Within":"contenu dans (g\xe9om\xe9trique)","Contains":"contient (g\xe9om\xe9trique)","tooltip":{"And":"Op\xe9rateur logique entre les filtres o\xf9 les deux conditions doivent \xeatre remplies","Or":"Op\xe9rateur logique entre les filtres o\xf9 au moins une (1) condition doit \xeatre vraie","PropertyIsEqualTo":"Identique (sensible \xe0 la case)","PropertyIsNotEqualTo":"Diff\xe9rent (sensible \xe0 la case)","PropertyIsLike":"Comme. Exemple: *route* trouve toutes les valeurs contenent \'route\', peu importe sa position dans l\'attribut. route* trouve toutes les valeurs commencant par \'route\'. Options avanc\xe9es : wildCard =\'*\', singleChar = \'.\' escapeChar = \'!\' (sensible \xe0 la case)","PropertyIsGreaterThan":"Plus grand","PropertyIsGreaterThanOrEqualTo":"Plus grand ou \xe9gal","PropertyIsLessThan":"Plus petit","PropertyIsLessThanOrEqualTo":"Plus petit ou \xe9gal","PropertyIsBetween":"Doit \xeatre contenu entre les limites inf\xe9rieure et sup\xe9rieure (les valeurs sont incluses)","During":"Doit \xeatre contenu entre les p\xe9riodes de temps sp\xe9cifi\xe9es","PropertyIsNull":"Dont l\'attribut est nul","Intersects":"Retourne les entit\xe9s \xe9tant en intersection g\xe9om\xe9trique avec la g\xe9om\xe9trie fournie","Within":"Retourne les entit\xe9s \xe9tant enti\xe8rement contenue par la g\xe9om\xe9trie fournie (Within)","Contains":"Retourne les entit\xe9s compl\xe8tement contenues par la g\xe9om\xe9trie fournie (Contains)"}},"sourceFields":{"selectField":"Choisir un champ"},"filter":{"addFilter":"Ajouter un filtre vide \xe0 la liste courante","removeFilter":"Supprimer le pr\xe9sent filtre \xe0 la liste des filtres","toggleFilterState":"Activer/d\xe9sactiver le pr\xe9sent filtre","refreshFilters":"Mettre \xe0 jour la source de donn\xe9e avec les filtres actifs de la liste. Pour activer ce boutton, la couche doit etre visible (et dans les \xe9chelles permises) ou veillez modifier le pr\xe9sent filtre.","layerFiltered":"Cette couche d\'information est pr\xe9sentement filtr\xe9e.","layerFilterable":"Cette couche d\'information est filtrable","filterBy":"Filtrer par","advancedOgcFilters":"Filtres avanc\xe9s","displayMoreResults":"Afficher plus (+)","displayLessResults":"Afficher moins (-)","placeholder":"Saisir une valeur","placeholderSnrc":"Ex: 21L14","selectOperator":"Choisir un op\xe9rateur","sliderModeTitle":"Curseur temporel","reportingDate":"Date de signalement"},"spatialSelector":{"fixedExtent":"\xc9tendue fixe","btnSetExtent":"D\xe9finir l\'\xe9tendue du filtre selon l\'\xe9tendue courante de la carte","snrc":"SNRC","selectFeature":"","drawFeature":""},"layer":{"hideLayer":"Masquer la couche","hideSelectedLayers":"Masquer les couches s\xe9lectionn\xe9es","lowerLayer":"Mettre en arri\xe8re","filterLowerLayer":"Le d\xe9placement arri\xe8re se fait toujours selon l\'ordre de la carte!","filterPlaceholder":"Filtrer la liste de couches","activateSelectionMode":"Activer le mode de s\xe9lection multiple","deactivateSelectionMode":"D\xe9sactiver le mode de s\xe9lection multiple","tools":"Outils","selectAll":"Tout s\xe9lectionner","deselectAll":"Tout d\xe9s\xe9lectionner","opacity":"Opacit\xe9","raiseLayer":"Mettre en avant","filterRaiseLayer":"Le d\xe9placement avant se fait toujours selon l\'ordre de la carte!","moreOptions":"Outils de la couche","removeLayer":"Retirer la couche de la carte","removeSelectedLayers":"Retirer les couches s\xe9lectionn\xe9es de la carte","removeSelectedLayersRestriction":"Certaines couches s\xe9lectionn\xe9es ne peuvent \xeatre supprim\xe9es","showFeaturesList":"Afficher la liste des entit\xe9s","showLayer":"Afficher la couche","showSelectedLayers":"Afficher les couches s\xe9lectionn\xe9es","subsetLayersListKeyword":"Limiter l\'affichage de la liste selon le titre ou  par type (wms, wfs,...)","deleteKeyword":"Supprimer le mot-cl\xe9","subsetLayersListOnlyVisible":"Conserver seulement les couches visibles","subsetLayersListOnlyInRange":"Conserver seulement les couches de la plage d\'\xe9chelle active","sortAlphabetically":"Trier la liste des couches en ordre alphab\xe9tique","sortMapOrder":"Replacer les couches selon l\'ordre cartographique","resetLayersList":"R\xe9tablir l\'affichage de l\'ensemble des couches","trackFeature":"Suivre l\'entit\xe9","legend":{"default":"D\xe9faut","loadingLegendText":"Chargement de la l\xe9gende","noLegendText":"Aucune symbologie disponible pour cette couche","noLegendScale":"Aucune symbologie disponible pour cette \xe9chelle","selectStyle":"S\xe9lectionner le style de la l\xe9gende","showAll":"Montrer toutes les couches (non visible et hors \xe9chelle)","noLayersVisibleWithShowAllButton":"Aucune couche actuellement visible. Activez le bouton ci haut pour voir toutes les l\xe9gendes.","noLayersVisibleWithShowAllButtonButZoom":"Aucune couche actuellement visible. Si vous zoomez dans la carte, certaines couches appara\xeetront OU activez le bouton ci haut pour voir toutes les l\xe9gendes.","noLayersVisible":"Aucune couche actuellement visible.","noLayersVisibleButZoom":"Aucune couche actuellement visible. Par contre, si vous zoomez dans la carte, certaines couches appara\xeetront."}},"download":{"action":"T\xe9l\xe9charger les donn\xe9es associ\xe9es","title":"T\xe9l\xe9chargement des donn\xe9es","start":"V\xe9rifiez la progression du t\xe9l\xe9chargement dans votre navigateur","end":"Termin\xe9"},"mapButtons":{"baselayerSwitcher":"Changer le fond de carte","geolocate":"Afficher votre position","offline":"Passer en mode hors-ligne","online":"Passer en mode en ligne","zoomIn":"Zoomer ({{zoom}})","zoomOut":"D\xe9zoomer ({{zoom}})","resetRotation":"R\xe9initialiser la carte vers le nord","tipRotation":"Maintenez les touches Alt et Majuscule (shift) tout en cliquant sur la carte pour faire pivoter la carte"},"metadata":{"show":"Montrer les m\xe9tadonn\xe9es"},"printForm":{"corsErrorMessageBody":"Impossible d\'imprimer d\xfb \xe0 des droits d\'acc\xe8s non d\xe9tenus","corsErrorMessageHeader":"Impression","comment":"Commentaire","doZipFile":"Compresser le fichier","outputFormat":"Format de sortie","paperFormat":"Format du papier","paperFormats":{"A0":"33.1 X 46.8\\" (A0)","A1":"23.4 X 33.1\\" (A1)","A2":"16.5 X 23.5\\" (A2)","A3":"11.7 X 16.5\\" (A3)","A4":"8.3 X 11.7\\" (A4)","A5":"5.8 X 8.3\\" (A5)","Letter":"Lettre","Legal":"L\xe9gal"},"imageFormat":"Format de l\'image","orientation":"Orientation","landscape":"Paysage","portrait":"Portrait","projection":"Projection","resolution":"R\xe9solution","saveBtn":"Sauvegarder","scale":"\xc9chelle","showLegend":"Afficher la l\xe9gende","showProjection":"Afficher la projection","showScale":"Afficher l\'\xe9chelle","title":"Titre","subtitle":"Sous-titre"},"directionsForm":{"stopLayer":"Itin\xe9raire - arr\xeats","routeLayer":"Itin\xe9raire - Trac\xe9","start":"D\xe9but","intermediate":"Interm\xe9diaire","end":"Fin","directionsBtn":"Obtenir l\'itin\xe9raire","resetDirectionsBtn":"Supprimer l\'itin\xe9raire","zoomRoute":"Zoomer sur l\'itin\xe9raire","null":"","directions":"Itin\xe9raire","raiseStop":"Prioriser l\'arr\xeat","lowerStop":"Reporter l\'arr\xeat plus loin dans le parcours","addStop":"Ajouter un arr\xeat","removeStop":"Supprimer l\'arr\xeat","drivingOptions":"Choix d\'itin\xe9raires","summary":"R\xe9sum\xe9 de l\'itin\xe9raire","stopsList":"Liste des lieux d\'arr\xeats","instructions":"Indications","copy":"Copier l\'itin\xe9raire","geolocate":"Utiliser sa localisation comme point d\'arr\xeat","link":"Lien","dialog":{"copyMsg":"Itin\xe9raire copi\xe9 dans le presse-papier","copyMsgLink":"Le lien de l\'itin\xe9raire est copi\xe9 dans le presse-papier","copyTitle":"Itin\xe9raire"}},"directions":{"uturn":"demi-tour","sharp right":"fortement \xe0 droite","right":"droite","slight right":"l\xe9g\xe8rement \xe0 droite","sharp left":"fortement \xe0 gauche","left":"gauche","slight left":"l\xe9g\xe8rement \xe0 gauche","straight":"tout droit"},"cardinalPoints":{"n":"nord","ne":"nord-est","e":"est","se":"sud-est","s":"sud","sw":"sud-ouest","w":"ouest","nw":"nord-ouest"},"search":{"placeholder":"Rechercher une localisation ou une couche de donn\xe9es","emptyType.placeholder":"Veuillez choisir un type de recherche","feature.title":"Localisation","feature.placeholder":"Rechercher une localisation","layer.title":"Couche de donn\xe9es","layer.placeholder":"Rechercher une couche de donn\xe9es.","ichercheReverse.name":"Recherche par coordonn\xe9es","ilayer":{"name":"Couches","properties":{"abstract":"Description","groupTitle":"Groupe","title":"Titre","type":"Type","url":"URL","metadataUrl":"M\xe9tadonn\xe9es","name":"Nom de la couche","urlInfo":"Lien du service web WMS/WFS","downloadUrl":"Lien de t\xe9l\xe9chargement de la donn\xe9es"},"type":{"layer":"Couche","groupLayer":"Groupe de couches"}},"nominatim":{"type":{"food":"Restauration","health":"Sant\xe9","entertainment":"Divertissement","finance":"Finance"},"country":{"all":"Le monde","canada":"Canada"}},"icherche":{"name":"iCherche","type":{"address":"Adresse","oldAddress":"Ancienne adresse","district":"Arrondissement","postalCode":"Code Postal","city":"Municipalit\xe9","oldCity":"Ancienne municipalit\xe9","mrc":"MRC","regadmin":"R\xe9gion administrative","road":"Route","intersection":"Intersection","place":"Lieu","exit":"Sortie d\'autoroute","cn":"Borne du CN","gcc":"Rep\xe8re de la garde coti\xe8re (GCC)","sumi":"Borne SUMI","km":"Rep\xe8re kilom\xe9trique","entreprise":"Entreprise","cadastre":"Cadastre"},"restrictExtent":{"map":"\xc0 l\'\xe9tendue de la carte","quebec":"Au Qu\xe9bec"}},"coordinates":{"name":"Coordonn\xe9es","coord":"Coordonn\xe9e (longitude, latitude)","radius":"Rayon","conf":"Confiance"},"menu.tooltip":"Options de recherche","settings":{"title":"Param\xe8tres"},"pointerSearchSummary":{"title":"Position du curseur","tooltip":"Afficher les coordonn\xe9es du curseur ainsi que d\'autres informations sur sa position en fonction des types de r\xe9sultats activ\xe9es. Utiliser F2 pour activer / d\xe9sactiver."},"searchResultsGeometry":{"title":"Montrer tous les r\xe9sultats","tooltip":"Afficher/cacher la g\xe9om\xe9trie des r\xe9sultats"},"searchSources":{"selectAll":"Tout s\xe9lectionner","unselectAll":"Tout d\xe9s\xe9lectionner","settings":{"results type":"Type de r\xe9sultat","ecmax":"\xc9cart maximal","radius":"Rayon de recherche","results limit":"Nombre de r\xe9sultats","multiple object":"Objet multiple","restrictExtent":"Restreint l\'\xe9tendue","selectAll":"Tout s\xe9lectionner","unselectAll":"Tout d\xe9s\xe9lectionner","true":"Oui","false":"Non"}},"displayMoreResults":"Afficher plus de r\xe9sultats"},"geometry":{"geometry":"Geometrie","point":"Point","line":"Ligne","polygon":"Surface"},"targetHtmlUrl":"Ouvrir le lien externe","searchByCoord":"Rechercher par coordonn\xe9es","searchByName":"Rechercher par nom","seeRouting":"Voir l\'itin\xe9raire","timeFilter":{"date":"Date","endDate":"Date de fin","startDate":"Date de d\xe9but","hour":"Heure","minute":"Minute"},"spatialFilter":{"spatialFilter":"Filtre spatial","predefined":"Zone Pr\xe9d\xe9finie","draw":"Dessin","polygon":"Polygone","point":"Cercle","drawPolygon":"Dessiner un polygone","drawCircle":"Dessiner un cercle","searchLabel":"Rechercher par","buffer":"Zone tampon","search":"Recherche","drawControl":"Activer le contr\xf4le de dessin","listLabel":"Zone","entity":"Entit\xe9","layer":"Couche","goSearch":"Lancer la recherche","removeLayer":"Retirer les r\xe9sultats","exportLayer":"Exporter les r\xe9sultats","clearForm":"Retirer le dessin","clearSearch":"R\xe9initialiser les champs","Address":"Adresses","Thematics":"Th\xe9matiques","searchResults":"R\xe9sultats de la recherche","type":"Type","radius":"Rayon","radiusAlert":"Le rayon doit \xeatre compris entre 0 et 100 kilom\xe8tres (ou 100 000 m\xe8tres)","bufferAlert":"La zone tampon doit \xeatre comprise entre 0 et 100 kilom\xe8tres (ou 100 000 m\xe8tres)","maxSizeAlert":"Le nombre de r\xe9sultats exc\xe8de 10000. Certains pourraient \xeatre manquants.","zeroResults":"Aucun r\xe9sultat ne correspond \xe0 cette recherche.","warning":"Avertissement","freehandControl":"\xc0 main lev\xe9e","group":{"toponyme":"Toponyme","culturel":"Culturel","education":"\xc9ducation","sante":"Sant\xe9","securite":"S\xe9curit\xe9","sepaq":"S\xc9PAQ","transport":"Transport"}},"terrapi":{"AdmRegion":"R\xe9gions administratives","Mun":"Municipalit\xe9s","Arrond":"Arrondissements","CircFed":"Circonscriptions f\xe9d\xe9rales","CircProv":"Circonscriptions provinciales","DirReg":"Directions r\xe9gionales","MRC":"MRC","RegTour":"R\xe9gions touristiques","limites":"Limites administratives","bornes":"Bornes sumi","hydro":"Hydrographie","routes":"Routes","bati":"B\xe2timents","batiment":"B\xe2timents","camping":"Camping","equipement":"\xc9quipements","commun":"Commun","geographie":"Lieux naturels","parc":"Parcs","secteur":"Secteurs","immeubles":"Immeubles patrimoniaux","sites":"Sites patrimoniaux","cpe":"Centre de la petite enfance","public":"\xc9coles publiques","prive":"\xc9coles priv\xe9s","gouvernemental":"\xc9coles gouvernementales","colleges":"Coll\xe8ges","universites":"Universit\xe9s","aine":"R\xe9sidences pour a\xeen\xe9s","ambulance":"Zones d\'ambulance","clinique":"Cliniques","etabl":"\xc9tablissements de sant\xe9","gmf":"Groupes de m\xe9decins de famille","naissance":"Maisons de naissances","pharmacie":"Pharmacies","casernes":"Casernes de pompiers","correctionnel":"Centres correctionnels","organisme":"Organismes de s\xe9curit\xe9","palais-justice":"Palais de justice","penitencier-fed":"P\xe9nitenciers f\xe9d\xe9raux","penitencier-prov":"P\xe9nitenciers provinciaux","polices":"Poste de police"},"measure":{"dialog":{"title":"Sommes de la s\xe9lection","length.title":"Distance","area.title":"Superficie","lengthInMeters":"M\xe8tres","lengthInKilometers":"Kilom\xe8tres","lengthInMiles":"Miles","lengthInFeet":"Pieds","areaInSquareMeters":"M\xe8tres\xb2","areaInSquareKilometers":"Kilom\xe8tres\xb2","areaInSquareMiles":"Miles\xb2","areaInHectares":"Hectares","areaInAcres":"Acres","perimeterInMeters":"P\xe9rim\xe8tre en m\xe8tres"},"area":"Superficie","areaHeader":"Superficie","length":"Distance","lengthHeader":"Distance / P\xe9rim\xe8tre","perimeter":"P\xe9rim\xe8tre","meters":"M\xe8tres","m":"m","kilometers":"Kilom\xe8tres","km":"km","miles":"Miles","mi":"mi","feet":"Pieds","ft":"pi","squareMeters":"M\xe8tres\xb2","m\xb2":"m\xb2","squareKilometers":"Kilom\xe8tres\xb2","km\xb2":"km\xb2","squareMiles":"Miles\xb2","mi\xb2":"mi\xb2","squareFeet":"Pieds\xb2","ft\xb2":"pi\xb2","hectares":"Hectares","ha":"ha","acres":"Acres","ac":"ac","toggleActive":"Activer le contr\xf4le de mesure","toggleMapTooltips":"Mesures sur la carte","toggleAutoUnits":"Unit\xe9s automatiques","actionbar":{"calculate.tooltip":"Calculer","delete.tooltip":"Supprimer","modify.tooltip":"Modifier"}},"draw":{"cancelColorPicker":"Annul\xe9","Circle":"Cercle","dialogInstruction":"Veuillez entrer l\'\xe9tiquette de votre dessin","dialogTitle":"\xc9tiquette","delete":"Retirer les dessins de la carte","drawing":"Dessins","fill":"Remplissage","icon":"Ic\xf4nes","labels":"\xc9tiquettes","LineString":"Ligne","okColorPicker":"OK","Point":"Point","Polygon":"Polygone","radius":"Rayon","stroke":"Contour","styleSelect":"S\xe9lectionner le style","toggleMapTooltips":"Afficher les \xe9tiquettes","noIcon":"Aucune ic\xf4ne"},"network":{"online":{"message":"En ligne","title":"Statut:"},"offline":{"message":"Hors-Ligne","title":"Statut:"}},"workspace":{"inMapExtent.active.tooltip":"Ne montrer que les enregistrements contenus dans la carte","inMapExtent.inactive.tooltip":"Montrer tous les enregistrements"}},"integration":{"tools":{"catalog":"Catalogue","contexts":"Contextes","directions":"Itin\xe9raire","draw":"Dessin","importExport":"Importer et exporter","ogcFilter":"Filtrer par","map":"Carte","layers":"Couches","legend":"L\xe9gende","measurer":"Mesure","print":"Imprimer","searchResults":"R\xe9sultats de recherche","shareMap":"Partager","timeFilter":"Filtre temporel","about":"\xc0 propos","spatialFilter":"Filtre spatial"},"searchResultsTool":{"noResults":"Aucun r\xe9sultat","doSearch":"Veuillez effectuer une recherche dans la barre de recherche ci-dessus.","examples":"<b>Permet de rechercher des adresses, des lieux, des coordonn\xe9es ou des couches</b>.<br><br>Les recherches d\'<u>adresses</u> peuvent \xeatre effectu\xe9es selon une combinaison: <ul><li>du no. immeuble</li><li>du nom de la rue</li><li>de la ville</li><li>du code postal</li></ul> Exemples pour les <u>lieux</u>: <ul><li>Lac Poulin</li><li>Mcdo L\xe9vis</li><li>Saint-Isidore</li></ul> Vous pouvez aussi utiliser des mots cl\xe9s pour pr\xe9ciser votre recherche. Exemples: <ul><li>#mun qu\xe9bec (pour rechercher une municipalit\xe9)</li><li>#sante L\xe9vis (pour rechercher un \xe9tablissement de sant\xe9)</li><li>#cpe joyeux (pour rechercher un centre de la petite enfance)</li><li>#intersection li\xe9gois + \xe9glise (pour rechercher une intersection, le #+ peut aussi \xeatre utilis\xe9)</li></ul>*Les mots cl\xe9s apparaissent au survol d\'un type dans l\'onglet des param\xe8tres de recherche -> iCherche -> Type de r\xe9sultat.<br><br>Exemple pour les <u>coordonn\xe9es</u> :<ul><li>Degr\xe9 d\xe9cimal (-68.165547, 48.644546)</li><li>Degr\xe9 minute seconde (-68 9 56, 48 38 40)</li><li>Degr\xe9 minute d\xe9cimal (-68 9.56, 48 38.40)</li><li>Projet\xe9 (UTM-19 561466.861, 5388278.862)</li><li>BELL (Lat: 48 38 40N Long: 68 9 56W UNC:100 CONF:90)</li><li>Metre Metre (111594.63, 445854.74;32198)</li></ul>Pour plus d\'informations sur la recherche par coordonn\xe9es : <a href=\'https://igo2.readthedocs.io/fr/next/properties.html#coordonnees\' target=\'_blank\'>Consulter la documentation d\'IGO2</a>","zoomOnFeatureTooltip":"Zoomer sur l\'entit\xe9 s\xe9lectionn\xe9e.","zoomOnFeatureTooltipOutOfView":"L\'entit\xe9 est hors de la vue. Zoomer sur l\'entit\xe9 s\xe9lectionn\xe9e."},"aboutTool":{"html":"<style>#about .bold_class{font-weight: bold;}#about .red{color: red;}#about .tool_name{border-top: 1px solid; padding-top: 10px;}#about .titre_outil{font-weight: bold; font-size: 18px; padding-bottom: 8px;}#about .subtitle{font-size: 20px; padding-bottom: 10px;}#about .align_right{text-align: right;}#about .describe{text-align: justify;}#about a img{color: black; text-decoration: none;}</style><body> <div id=\'about\'> <div class=\'bold_class subtitle\'>Aper\xe7u des fonctionnalit\xe9s</div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z\'> </path> </svg></mat-icon> Recherche </div><div class=\'describe\'> Situ\xe9e dans la portion sup\xe9rieure gauche de l\u2019interface, la barre de recherche permet de vous positionner \xe0 l\u2019aide d\u2019une adresse, d\u2019un lieu ou de coordonn\xe9es GPS et peut \xe9galement servir \xe0 chercher une couche. Il est aussi possible de rechercher un \xe9l\xe9ment par type de r\xe9sultats en utilisant le hashtag \xab # \xbb (par exemple, #municipalites qu\xe9bec). Les accents et les lettres majuscules n\'importent pas lors de l\'utilisation du hashtag.</div></div><br><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z\'></path> </svg></mat-icon> Contextes </div><div class=\'describe\'> Visualisez des regroupements de couches faits par th\xe8me ou par contexte de travail. Lorsque vous s\xe9lectionnez un <span class=\'bold_class\'>Contexte</span>, vous trouverez dans <span class=\'bold_class\'>Carte</span> chacune des couches qu\u2019il contient. Vous pouvez y ajouter d\u2019autres couches \xe0 partir du <span class=\'bold_class\'>Catalogue</span> ou de l\u2019outil <span class=\'bold_class\'>Recherche.</span> </div><br><div class=\'red\'> <span class=\'bold_class\'>ATTENTION :</span> Si vous s\xe9lectionnez un autre <span class=\'bold_class\'>Contexte</span>, toutes les couches affich\xe9es dans <span class=\'bold_class\'>Carte</span> seront remplac\xe9es. </div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M15,19L9,16.89V5L15,7.11M20.5,3C20.44,3 20.39,3 20.34,3L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21C3.55,21 3.61,21 3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3Z\'> </path> </svg></mat-icon> Carte </div><div class=\'describe\'> Personnalisez votre carte \xe0 partir du <span class=\'bold_class\'>Catalogue</span> ou de l\u2019outil <span class=\'bold_class\'>Recherche.</span> Cet espace permet d\u2019ajouter, de supprimer et d\u2019interroger des couches. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M1.39,18.36L3.16,16.6L4.58,18L5.64,16.95L4.22,15.54L5.64,14.12L8.11,16.6L9.17,15.54L6.7,13.06L8.11,11.65L9.53,13.06L10.59,12L9.17,10.59L10.59,9.17L13.06,11.65L14.12,10.59L11.65,8.11L13.06,6.7L14.47,8.11L15.54,7.05L14.12,5.64L15.54,4.22L18,6.7L19.07,5.64L16.6,3.16L18.36,1.39L22.61,5.64L5.64,22.61L1.39,18.36Z\'> </path> </svg></mat-icon> Outil de mesure </div><div class=\'describe\'> Mesurez des distances ou des superficies sur la carte. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M14,14.5V12H10V15H8V11A1,1 0 0,1 9,10H14V7.5L17.5,11M21.71,11.29L12.71,2.29H12.7C12.31,1.9 11.68,1.9 11.29,2.29L2.29,11.29C1.9,11.68 1.9,12.32 2.29,12.71L11.29,21.71C11.68,22.09 12.31,22.1 12.71,21.71L21.71,12.71C22.1,12.32 22.1,11.68 21.71,11.29Z\'> </path> </svg></mat-icon> Itin\xe9raire </div><div class=\'describe\'> Construisez un itin\xe9raire entre deux points (en placant les deux points dans la carte ou en cherchant des adresses). Vous pourrez ensuite ajouter des points interm\xe9diaires, copier la description de l\'itin\xe9raire dans le presse papier ou partager le lien. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M17,14H19V17H22V19H19V22H17V19H14V17H17V14M11,16L2,9L11,2L20,9L11,16M11,18.54L12,17.75V18C12,18.71 12.12,19.39 12.35,20L11,21.07L2,14.07L3.62,12.81L11,18.54Z\'></path> </svg></mat-icon> Catalogue </div><div class=\'describe\'> Trouvez toutes les couches qui peuvent \xeatre ajout\xe9es \xe0 la <span class=\'bold_class\'>Carte.</span> Cliquez sur la couche d\xe9sir\xe9e pour l\u2019ajouter. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M14,17H18V14L23,18.5L18,23V20H14V17M13,9H18.5L13,3.5V9M6,2H14L20,8V12.34C19.37,12.12 18.7,12 18,12A6,6 0 0,0 12,18C12,19.54 12.58,20.94 13.53,22H6C4.89,22 4,21.1 4,20V4A2,2 0 0,1 6,2Z\'></path> </svg></mat-icon> Importer/Exporter </div><div class=\'describe\'> Importez ou exportez un fichier vectoriel en sp\xe9cifiant la projection. Vous pouvez aussi sauvegarder ou recharger un contexte localement. Cela vous permet de sauvegarder des contextes en mode non-authentifi\xe9 ou anonyme. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z\'></path> </svg></mat-icon> Imprimer </div><div class=\'describe\'> Imprimez la carte affich\xe9e \xe0 l\u2019\xe9cran. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M18,16.08C17.24,16.08 16.56,16.38 16.04,16.85L8.91,12.7C8.96,12.47 9,12.24 9,12C9,11.76 8.96,11.53 8.91,11.3L15.96,7.19C16.5,7.69 17.21,8 18,8A3,3 0 0,0 21,5A3,3 0 0,0 18,2A3,3 0 0,0 15,5C15,5.24 15.04,5.47 15.09,5.7L8.04,9.81C7.5,9.31 6.79,9 6,9A3,3 0 0,0 3,12A3,3 0 0,0 6,15C6.79,15 7.5,14.69 8.04,14.19L15.16,18.34C15.11,18.55 15.08,18.77 15.08,19C15.08,20.61 16.39,21.91 18,21.91C19.61,21.91 20.92,20.61 20.92,19A2.92,2.92 0 0,0 18,16.08Z\'> </path> </svg></mat-icon> Partager </div><div class=\'describe\'> Cr\xe9ez une adresse URL qui redirige vers une repr\xe9sentation exacte de votre carte qui se trouve \xe0 l\u2019\xe9cran. Ce lien peut \xeatre partag\xe9 ou diffus\xe9 dans un document et permet de \xab&nbspsauvegarder \xbb votre carte pour une utilisation ult\xe9rieure. </div><br></div><div class=\'tool_name\'> <p> <a href=\'http://igouverte.org/\' target=\'_blank\'><img src=\'./assets/igo2/core/logo.png\' alt=\'IGO\' height=32>IGO2</a> est une solution Web libre en g\xe9omatique, d\xe9velopp\xe9e en mode collaboratif par des sp\xe9cialistes provenant de plusieurs minist\xe8res et organismes du gouvernement du Qu\xe9bec.</p><p>Version :{{version.lib}}</p></div>","trainingGuide":"Guide de formation","trainingGuideTooltip":"Cliquez ici pour acc\xe9der au guide d\'autoformation de IGO2"},"mapTool":{"empty":"La carte ne contient aucune couche de donn\xe9es.","customize":"Personnalisez-l\xe0 en ajoutant des couches \xe0 partir des outils suivants : ","search-tool":"Recherche","catalog-tool":"Catalogue de donn\xe9es","context-tool":"Gestionnaire de contextes","noLayersVisible":"Aucune couche visible.","noLayersInRange":"Aucune couche visible dans la plage d\'\xe9chelle active. Veuillez zoomer ou d\xe9zoomer pour d\xe9couvrir ces couches."},"importExportTool":{"importExportData":"Couche","importExportContext":"Contexte"},"workspace":{"toggleWorkspace":"Ouvrir/fermer la vue tabulaire","ogcFilter.close":"Fermer","ogcFilter.title":"Filtres","ogcFilter.tooltip":"Appliquer des filtres sur la couche","download.title":"T\xe9l\xe9charger les donn\xe9es associ\xe9es","download.tooltip":"T\xe9l\xe9charger les donn\xe9es associ\xe9es","inMapExtent.title":"Montrer les entit\xe9s contenues dans la carte","inMapExtent.active.tooltip":"Montrer les entit\xe9s contenues dans la carte","inMapExtent.inactive.tooltip":"Montrer toutes les entit\xe9s","zoomAuto.title":"Zoom auto","zoomAuto.tooltip":"Zoom auto","selected.title":"Montrer les entit\xe9s s\xe9lectionn\xe9es","selected.tooltip":"Montrer les entit\xe9s s\xe9lectionn\xe9es","clearSelection.title":"Tout d\xe9s\xe9lectionner","clearSelection.tooltip":"D\xe9s\xe9lectionner les enregistrements s\xe9lectionn\xe9s","maximize":"Agrandir","maximizeTooltip":"Agrandir la fen\xeatre","standardExtent":"R\xe9duire","standardExtentTooltip":"R\xe9duire la fen\xeatre"}}}}')},tshS:function(e){e.exports=JSON.parse("{\"igo\":{\"integration\":{\"tools\":{\"catalog\":\"Catalog\",\"contexts\":\"Contexts\",\"directions\":\"Directions\",\"draw\":\"Draw\",\"importExport\":\"Import & export\",\"ogcFilter\":\"Filter by\",\"map\":\"Map\",\"layers\":\"Layers\",\"legend\":\"Legend\",\"measurer\":\"Measure\",\"print\":\"Print\",\"searchResults\":\"Search Results\",\"shareMap\":\"Share\",\"timeFilter\":\"Time Filter\",\"about\":\"About\",\"spatialFilter\":\"Spatial Filter\"},\"searchResultsTool\":{\"noResults\":\"No results\",\"doSearch\":\"Do a search in the search bar.\",\"examples\":\"<b>Allow to search addresses, location, coordinates and layers</b>.<br><br><u>Adresses</u> research can be done with a combination of : <ul><li>building number</li><li>street name</li><li>city name</li><li>postal code</li></ul> Examples for <u>locations</u>: <ul><li>Lac Poulin</li><li>Mcdo L\xe9vis</li><li>Saint-Isidore</li></ul> You can also use keywords to refine your search. Examples: <ul><li>#mun qu\xe9bec (to search municipalities)</li><li>#sante L\xe9vis (to search health establishments)</li><li>#cpe joyeux (to search nurseries)</li><li>#intersection li\xe9gois + \xe9glise (to search an intersection, the #+ can also be used)</li></ul>*Keywords appear when hovering results type in search settings tab -> iCherche -> Results type.<br><br><u>Coordinates</u> examples :<ul><li>Decimal degree (-68.165547, 48.644546)</li><li>Degrees, minutes, seconds (-68 9 56, 48 38 40)</li><li>Degree, minutes, decimal (-68 9.56, 48 38.40)</li><li>Projected (UTM-19 561466.861, 5388278.862)</li><li>BELL (Lat: 48 38 40N Long: 68 9 56W UNC:100 CONF:90)</li><li>Meter Meter (111594.63, 445854.74;32198)</li></ul>For more informations on coordinate's research : <a href='https://igo2.readthedocs.io/fr/next/properties.html#coordonnees' target='_blank'>Consult IGO2's documentation</a>\",\"zoomOnFeatureTooltip\":\"Zoom on selected feature.\",\"zoomOnFeatureTooltipOutOfView\":\"The feature is out of view. Zoom on selected feature.\"},\"aboutTool\":{\"html\":\"<style>#about .bold_class{font-weight: bold;}#about .red{color: red;}#about .tool_name{border-top: 1px solid; padding-top: 10px;}#about .titre_outil{font-weight: bold; font-size: 18px; padding-bottom: 8px;}#about .subtitle{font-size: 20px; padding-bottom: 10px;}#about .align_right{text-align: right;}#about .describe{text-align: justify;}#about a img{color: black; text-decoration: none;}</style><body> <div id='about'> <div class='bold_class subtitle'>Features overview</div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z'> </path> </svg></mat-icon> Search Results </div><div class='describe'>Located in the upper left portion of the interface, the search bar allows you to locate yourself using an address, location or GPS coordinates. The tool can also be used to search for a layer. </div></div><br><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z'></path> </svg></mat-icon> Contexts </div><div class='describe'> Visualize groupings of layers made by theme or by work context. When you select a <span class='bold_class'>Context</span>, you will find in <span class='bold_class'>Map</span> each of the layers it contains. You can add other layers to it from the <span class='bold_class'>Catalog</span> or the <span class='bold_class'>Search</span> tool. <br><div class='red'> <span class='bold_class'>WARNING :</span> If you select another <span class='bold_class'>Context</span>, all the layers displayed in the <span class='bold_class'>Map</span> will be replaced. </div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M15,19L9,16.89V5L15,7.11M20.5,3C20.44,3 20.39,3 20.34,3L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21C3.55,21 3.61,21 3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3Z'> </path> </svg></mat-icon> Map </div><div class='describe'>Personalize your map using the <span class='bold_class'>Catalog</span> or the <span class='bold_class'>Search</span> tool. This space allows you to add, delete and interrogate layers.</div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M1.39,18.36L3.16,16.6L4.58,18L5.64,16.95L4.22,15.54L5.64,14.12L8.11,16.6L9.17,15.54L6.7,13.06L8.11,11.65L9.53,13.06L10.59,12L9.17,10.59L10.59,9.17L13.06,11.65L14.12,10.59L11.65,8.11L13.06,6.7L14.47,8.11L15.54,7.05L14.12,5.64L15.54,4.22L18,6.7L19.07,5.64L16.6,3.16L18.36,1.39L22.61,5.64L5.64,22.61L1.39,18.36Z'> </path> </svg></mat-icon> Measure </div><div class='describe'>Measure distances or areas on the map.</div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M14,14.5V12H10V15H8V11A1,1 0 0,1 9,10H14V7.5L17.5,11M21.71,11.29L12.71,2.29H12.7C12.31,1.9 11.68,1.9 11.29,2.29L2.29,11.29C1.9,11.68 1.9,12.32 2.29,12.71L11.29,21.71C11.68,22.09 12.31,22.1 12.71,21.71L21.71,12.71C22.1,12.32 22.1,11.68 21.71,11.29Z'> </path> </svg></mat-icon> Directions </div><div class='describe'> Build a route between two points (by placing the two points on the map or by looking for addresses). You can then add intermediate points, copy the description of the route to the clipboard or share the link.</div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M17,14H19V17H22V19H19V22H17V19H14V17H17V14M11,16L2,9L11,2L20,9L11,16M11,18.54L12,17.75V18C12,18.71 12.12,19.39 12.35,20L11,21.07L2,14.07L3.62,12.81L11,18.54Z'></path> </svg></mat-icon> Catalog </div><div class='describe'> Find all the layers that can be added to the <span class='bold_class'>Map</span>. Click on the desired layer to add it. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M14,17H18V14L23,18.5L18,23V20H14V17M13,9H18.5L13,3.5V9M6,2H14L20,8V12.34C19.37,12.12 18.7,12 18,12A6,6 0 0,0 12,18C12,19.54 12.58,20.94 13.53,22H6C4.89,22 4,21.1 4,20V4A2,2 0 0,1 6,2Z'></path> </svg></mat-icon> Import & export </div><div class='describe'> Import or export a layer with a specific projection. You can also save or reload a context. It allows you to save contexts as anonymous. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z'></path> </svg></mat-icon> Print </div><div class='describe'>Print the map displayed on the screen. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M18,16.08C17.24,16.08 16.56,16.38 16.04,16.85L8.91,12.7C8.96,12.47 9,12.24 9,12C9,11.76 8.96,11.53 8.91,11.3L15.96,7.19C16.5,7.69 17.21,8 18,8A3,3 0 0,0 21,5A3,3 0 0,0 18,2A3,3 0 0,0 15,5C15,5.24 15.04,5.47 15.09,5.7L8.04,9.81C7.5,9.31 6.79,9 6,9A3,3 0 0,0 3,12A3,3 0 0,0 6,15C6.79,15 7.5,14.69 8.04,14.19L15.16,18.34C15.11,18.55 15.08,18.77 15.08,19C15.08,20.61 16.39,21.91 18,21.91C19.61,21.91 20.92,20.61 20.92,19A2.92,2.92 0 0,0 18,16.08Z'> </path> </svg></mat-icon> Share </div><div class='describe'> Create a URL that redirects to an exact representation of your map on the screen. This link can be shared or distributed in a document and allows you to \\\"save\\\" your map for later use. </div><br></div><div class='tool_name'> <p> <a href='http://igouverte.org/' target='_blank'><img src='./assets/igo2/core/logo.png' alt='IGO' height=32>IGO2</a> is a free web solution in geomatics, developed in collaborative mode by specialists from several departments and agencies of the government of Quebec. <p> Version :{{version.lib}}</p></div>\",\"trainingGuide\":\"Training guide\",\"trainingGuideTooltip\":\"Click here to access IGO2's self-training guide\"},\"mapTool\":{\"empty\":\"No layer is currently active on this map. \",\"customize\":\"Customize it by adding layer from the : \",\"search-tool\":\"Search tool\",\"catalog-tool\":\"Data catalog\",\"context-tool\":\"Context manager\",\"noLayersVisible\":\"There is no visible layers.\",\"noLayersInRange\":\"There is no visible layers at the current scale. Please zoom in or out to discover theses layers.\"},\"importExportTool\":{\"importExportData\":\"Layer\",\"importExportContext\":\"Context\"},\"workspace\":{\"toggleWorkspace\":\"Open/Close the table view\",\"ogcFilter.close\":\"Close\",\"ogcFilter.title\":\"Filters\",\"ogcFilter.tooltip\":\"Apply filters\",\"download.title\":\"Download\",\"download.tooltip\":\"Download\",\"inMapExtent.title\":\"Show records contained in map\",\"inMapExtent.active.tooltip\":\"Show records contained in map\",\"inMapExtent.inactive.tooltip\":\"Show all records\",\"zoomAuto.title\":\"Zoom auto\",\"zoomAuto.tooltip\":\"Zoom auto\",\"selected.title\":\"Show selected records only\",\"selected.tooltip\":\"Show selected records only\",\"clearSelection.title\":\"Deselect all\",\"clearSelection.tooltip\":\"Deselect all records\",\"maximize\":\"Extend\",\"maximizeTooltip\":\"Extend panel\",\"standardExtent\":\"Reduce\",\"standardExtentTooltip\":\"Reduce panel\"}}}}")},yhJE:function(e){e.exports=JSON.parse('{"igo":{"context":{"bookmarkButton":{"create":"Create a new context","dialog":{"createMsg":"The context \'{{value}}\' was created","createTitle":"Context created","placeholder":"Title","title":"New context"}},"contextManager":{"clone":"Clone this context","delete":"Delete this context","dialog":{"cloneMsg":"The context \'{{value}}\' was cloned","cloneTitle":"Context cloned","copyMsg":"Text copied","copyTitle":"Context ID","confirmDelete":"Are you sure you want to delete this context?","deleteMsg":"The context \'{{value}}\' was deleted","deleteTitle":"Context deleted","favoriteMsg":"The context \'{{value}}\' was set as favorite","favoriteTitle":"Favorite saved","saveMsg":"The context \'{{value}}\' was saved","saveTitle":"Context saved"},"edit":"Edit this context","errors":{"uncaught":{"message":"Sorry, service is currently not available. Please try again later","title":"Error server"},"addPermission":"The permission you are trying to add is already in the context.","addPermissionEmpty":"The permission you are trying to add is not valid","addPermissionTitle":"Add permission error"},"favorite":"Set as favorite context","form":{"copy":"Copy the context ID","edit":"Save","title":"Title","titleRequired":"Title required","uri":"ID","uriRequired":"ID required"},"invalid":{"text":"Context \'{{value}}\' is invalid. The default context was loaded.","title":"Invalid context"},"managePermissions":"Manage permissions context","manageTools":"Manage tools context","ourContexts":"Our contexts","publicContexts":"Public contexts","save":"Save this context","sharedContexts":"Shared contexts","filterPlaceHolder":"Filter by name","sortAlphabetically":"Sort alphabetically","sortContextOrder":"Replace according to the creation date","userAccount":"User account","filterUser":"Filter by user group","emptyContext":"Empty context","emptyContextTooltip":"Create a new empty context","contextMap":"Context from map","contextMapTooltip":"Create a new context from map layers","hide":"Hide this context","show":"Show up this context","showHidden":"Show hidden contexts"},"contextImportExport":{"export":{"exportPlaceHolder":"Layers","exportContextName":"Context name","exportSelectAll":"Select all","success":{"text":"Context has been exported.","title":"Context export success"},"nothing":{"text":"No context could be exported.","title":"Nothing to export"},"failed":{"text":"Failed to export","title":"Failed to export context"}},"import":{"success":{"title":"Imported context","text":"The context \'{{value}}\' was added to the map"},"empty":{"text":"The context \'{{value}}\' contained nothing that could be imported.","title":"Nothing to import"},"invalid":{"text":"The context \'{{value}}\' is invalid.","title":"Invalid context"},"unreadable":{"title":"Unreadable context","text":"The context \'{{value}}\' is unreadable"},"tooLarge":{"text":"The context \'{{value}}\' is too large (Max: {{size}} MB)","title":"Context too large"}}},"permission":{"addBtn":"Add","delete":"Remove permission","dialog":{"addMsg":"The permission \'{{value}}\' was added","addTitle":"Permission added","deleteMsg":"The permission \'{{value}}\' was removed","deleteTitle":"Permission removed","scopeChangedMsg":"The scope was changed to {{value}}","scopeChangedTitle":"Scope changed"},"profil":"Profil","user":"User or group","profilRequired":"Profil required","read":"Read only","readOnlyTitle":"Read-only context","readOnlyMsg":"You can only revoke permission if the context is shared directly to your username.","scope":{"private":"Private","protected":"Protected","shared":"Shared","public":"Public"},"write":"Read and Write"},"poiButton":{"create":"Create a new zone of interest","dialog":{"confirmDelete":"Are you sure you want to delete this zone of interest?","createMsg":"The zone of interest \'{{value}}\' was created","createTitle":"Zone of interest created","deleteMsg":"The zone of interest \'{{value}}\' was deleted","deleteTitle":"Zone of interest deleted","placeholder":"Title","title":"New zone of interest"},"placeholder":"Zones of interest"},"sidenav":{"goBack":"Go Back","mainMenu":"Main Menu"},"shareMap":{"button":"Share map","refreshBtn":"Refresh sharing","copy":"Copy to clipboard","shareWithApi":"Share by context","shareWithUrl":"Share by url","dialog":{"copyMsg":"Link copied to clipboard","copyTitle":"Link"},"errorTitle":"Share Map error","placeholderLink":"Link","included":"Included in shared URL :","context":"The context when creating the sharing link.","center":"The coordinates of the center of the map (longitude, latitude).","zoom":"The zoom level of the map.","addedLayers":"The layers added by the catalog or by the search bar.","visibleInvisible":"Visibility status of layers.","excluded":"Excluded in the shared URL :","order":"The order of the layers.","opacity":"Modifications made to the opacity of the layers.","filterOgc":"Additions / modifications made to filters by attribute.","filterTime":"The current value for time filters."},"tool":{"dialog":{"addMsg":"The tool \'{{value}}\' was added","addTitle":"Tool added","deleteMsg":"The tool \'{{value}}\' was removed","deleteTitle":"Tool removed"}},"userButton":{"dialog":{"email":"Email","expiration":"Expiration","user":"User","clearPreferences":"Clear my preferences"},"infoTitle":"User info","logout":"Logout"}}}}')}},[[0,0,5]]]);
//# sourceMappingURL=main-es2015.a876d6c4f6e0db5001d6.js.map