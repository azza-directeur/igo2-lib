(self.webpackChunk_igo_demo=self.webpackChunk_igo_demo||[]).push([[179],{98255:function(e){function t(e){return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}t.keys=function(){return[]},t.resolve=t,t.id=98255,e.exports=t},36438:function(e,t,o){var i={"./en.auth.json":50257,"./en.common.json":35488,"./en.context.json":88952,"./en.core.json":63154,"./en.geo.json":10711,"./en.integration.json":32766,"./en.json":10503,"./fr.auth.json":8555,"./fr.common.json":20551,"./fr.context.json":68079,"./fr.core.json":5415,"./fr.geo.json":27268,"./fr.integration.json":63031,"./fr.json":65962};function r(e){var t=s(e);return o(t)}function s(e){if(!o.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}r.keys=function(){return Object.keys(i)},r.resolve=s,e.exports=r,r.id=36438},88214:function(e,t,o){"use strict";var i=o(4919),r=o(91477),s=o(99613),n=o(45159),a=o(3323),l=o(43635),c=o(80902),u=o(63266),p=o(30620),d=o(3259),h=o(40093),g=o(74354),m=o(73393),f=o(87227),y=o(34301),v=o(71435),b=o(18293),x=o(33927),w=o(80639),S=o(1143),C=o(76491),T=o(45871),A=o(81134),L=o(79097),Z=o(82516),F=o(13492),O=o(79441),M=o(83720);let I=(()=>{class e{static getByte(e,t){return e.charCodeAt(t)}static getByte64(e,t){return this.ALPHA.indexOf(e.charAt(t))}static decode(e){let t,o,i=0,r=e.length,s=[];if(e=String(e),0===r)return e;for(e.charAt(r-1)===this.PADCHAR&&(i=1,e.charAt(r-2)===this.PADCHAR&&(i=2),r-=4),t=0;t<r;t+=4)o=this.getByte64(e,t)<<18|this.getByte64(e,t+1)<<12|this.getByte64(e,t+2)<<6|this.getByte64(e,t+3),s.push(String.fromCharCode(o>>16,o>>8&255,255&o));switch(i){case 1:o=this.getByte64(e,t)<<18|this.getByte64(e,t+1)<<12|this.getByte64(e,t+2)<<6,s.push(String.fromCharCode(o>>16,o>>8&255));break;case 2:o=this.getByte64(e,t)<<18|this.getByte64(e,t+1)<<12,s.push(String.fromCharCode(o>>16))}return s.join("")}static encode(e){let t,o,i=[],r=(e=String(e)).length-e.length%3;if(0===e.length)return e;for(t=0;t<r;t+=3)o=this.getByte(e,t)<<16|this.getByte(e,t+1)<<8|this.getByte(e,t+2),i.push(this.ALPHA.charAt(o>>18)),i.push(this.ALPHA.charAt(o>>12&63)),i.push(this.ALPHA.charAt(o>>6&63)),i.push(this.ALPHA.charAt(63&o));switch(e.length-r){case 1:o=this.getByte(e,t)<<16,i.push(this.ALPHA.charAt(o>>18)+this.ALPHA.charAt(o>>12&63)+this.PADCHAR+this.PADCHAR);break;case 2:o=this.getByte(e,t)<<16|this.getByte(e,t+1)<<8,i.push(this.ALPHA.charAt(o>>18)+this.ALPHA.charAt(o>>12&63)+this.ALPHA.charAt(o>>6&63)+this.PADCHAR)}return i.join("")}}return e.PADCHAR="=",e.ALPHA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e})();const k=F.getParser(window.navigator.userAgent);class P{static copy(e){let t=!1;if("string"==typeof e){const o=P.createTextArea(e);P.selectText(o),t=P.copyTextToClipboard(),P.destroyTextArea(o)}else P.selectText(e),t=P.copyTextToClipboard();return t}static createTextArea(e){const t=document.createElement("textArea");return t.value=e,document.body.appendChild(t),t}static destroyTextArea(e){document.body.removeChild(e)}static selectText(e){if("iOS"===k.getOSName()){const t=e.contentEditable,o=e.readOnly,i=document.createRange(),r=window.getSelection();e.contenteditable=!0,e.readonly=!1,i.selectNodeContents(e),r.removeAllRanges(),r.addRange(i),e.setSelectionRange(0,999999),e.contentEditable=t,e.readOnly=o}else e.select()}static copyTextToClipboard(){return("iOS"!==k.getOSName()||!k.compareVersion("<10"))&&document.execCommand("copy")}}class _{static diff(e,t,o=4){if(!e&&!t)return"";if(!e)return'<span class="inserted">'+t+"</span>";if(!t)return'<span class="deleted">'+e+"</span>";e=e.toString(),t=t.toString();const i=_.getChanges(e,t,"",o),r=t.slice(i.mtc.length+i.ins.length+i.sbs.length),s=e.slice(i.mtc.length+i.del.length+i.sbs.length);let n="";return i.del.length>0&&(i.del='<span class="deleted">'+i.del+"</span>"),i.ins.length>0&&(i.ins='<span class="inserted">'+i.ins+"</span>"),n=i.mtc+i.del+i.ins+i.sbs,n+=""!==s||""!==r?_.diff(s,r,o):"",n}static getMatchingSubstring(e,t,o){let i=0,r=!1;const s=e.length,n={fis:s,mtc:o,sbs:""};for(;i<s;)t[i]===e[i]?r?n.sbs+=e[i]:(r=!0,n.fis=i,n.sbs=e[i]):i=r?s:i,++i;return n}static getChanges(e,t,o,i){const r=e.length>=e.length;let[s,n]=r?[e,t]:[t,e],a=0;for(;n[a]===s[a]&&a<n.length;)++a;s=s.split("").slice(a),n=n.slice(a);const l=s.length;let c={fis:n.length,fil:l,sbs:"",mtc:o+t.slice(0,a)},u={sbs:""};if(""!==n)for(let p=0;p<l&&u.sbs.length<i;p++)u=_.getMatchingSubstring(n,_.rotateArray(s,p),c.mtc),u.fil=p<l-u.fis?u.fis+p:u.fis-l+p,u.sbs.length>c.sbs.length&&(c=u);return[c.del,c.ins]=r?[s.slice(0,c.fil).join(""),n.slice(0,c.fis)]:[n.slice(0,c.fis),s.slice(0,c.fil).join("")],-1===c.del.indexOf(" ")||-1===c.ins.indexOf(" ")||""===c.del||""===c.ins||""===c.sbs?c:_.getChanges(c.del,c.ins,c.mtc,i)}static rotateArray(e,t){const o=e.length,i=new Array(e.length);if(t%o==0)return e.slice();for(let r=0;r<o;r++)i[r]=e[(r+(o+t%o))%o];return i}}var $=(()=>{return(e=$||($={})).ADDED="added",e.DELETED="deleted",e.MODIFIED="modified",$;var e})();class q{static findChanges(e,t,o=[]){const i={added:[],deleted:[],modified:[]};if(!e||!t)return i;const r=[...e],s=[...t];for(const n of r){const e=s.findIndex(e=>e.id===n.id);if(-1===e){i.deleted.push({change:{type:$.DELETED},value:n});continue}const t=s.splice(e,1)[0],r=JSON.parse(JSON.stringify(n)),a=JSON.parse(JSON.stringify(t)),l=q.compareObject(r,a,void 0,o);l.length&&i.modified.push({change:{type:$.MODIFIED,keysChanged:l},value:r,oldValue:n,newValue:t})}return i.added=s.map(e=>({change:{type:$.ADDED},value:e})),i}static compareObject(e,t,o,i=[]){const r=JSON.parse(JSON.stringify(e)),s=JSON.parse(JSON.stringify(t)),n=new Set([...Object.keys(e),...Object.keys(t)]);let a=[];return n.forEach(n=>{const l=o?`${o}.${n}`:n;-1===i.indexOf(l)&&(Array.isArray(e[n])&&(e[n]=e[n].join(",<br>")),Array.isArray(t[n])&&(t[n]=t[n].join(",<br>")),"object"==typeof e[n]&&"object"==typeof t[n]&&null!==e[n]&&null!==t[n]?a=a.concat(this.compareObject(e[n],t[n],l)):e[n]!==t[n]&&(a.push({key:l,oldValue:r[n],newValue:s[n]}),e[n]=_.diff(e[n],t[n])))}),a}}class D{static resolve(e,t){const o=t.replace(/\[/g,".").replace(/\]/g,"").split(".");let i=e;for(;o.length;){if("object"!=typeof i)return;i=i[o.shift()]}return i}static isObject(e){return e&&"object"==typeof e&&!Array.isArray(e)&&null!==e&&!(e instanceof Date)}static mergeDeep(e,t,o=!1){const i=Object.assign({},e);return D.isObject(e)&&D.isObject(t)&&Object.keys(t).filter(e=>!o||void 0!==t[e]).forEach(r=>{D.isObject(t[r])?r in e?i[r]=D.mergeDeep(e[r],t[r],o):Object.assign(i,{[r]:t[r]}):Object.assign(i,{[r]:t[r]})}),i}static copyDeep(e){const t=Array.isArray(e)?[]:{};for(const o in e)if(e.hasOwnProperty(o)){const i=e[o];t[o]=i&&"object"==typeof i?this.copyDeep(i):i}return t}static removeDuplicateCaseInsensitive(e){const t={},o={},i=[];for(const r in e)if(e.hasOwnProperty(r)){const o=r.toUpperCase();t.hasOwnProperty(o)?t[o].push({[r]:e[r]}):t[o]=[{[r]:e[r]}],i.push({key:r,count:r.replace(/[^A-Z]/g,"").length})}for(const r in t)if(t.hasOwnProperty(r)&&t.hasOwnProperty(r)){const s=t[r];if(1===s.length){const e=s[0];o[r]=e[Object.keys(e)[0]]}else if(s.length>1){const t=i.filter(e=>e.key.toLowerCase()===r.toLowerCase()).reduce((e,t)=>e.y<t.y?e:t);o[t.key.toUpperCase()]=e[t.key]}}for(const r in e)e.hasOwnProperty(r)&&delete e[r];for(const r in o)o.hasOwnProperty(r)&&(e[r]=o[r])}static removeUndefined(e){const t={};return D.isObject(e)?(Object.keys(e).filter(t=>void 0!==e[t]).forEach(o=>{t[o]=D.isObject(e[o])||Array.isArray(e[o])?D.removeUndefined(e[o]):e[o]}),t):Array.isArray(e)?e.map(e=>D.removeUndefined(e)):e}static removeNull(e){const t={};return D.isObject(e)?(Object.keys(e).filter(t=>null!==e[t]).forEach(o=>{t[o]=D.isObject(e[o])||Array.isArray(e[o])?D.removeNull(e[o]):e[o]}),t):Array.isArray(e)?e.map(e=>D.removeNull(e)):e}static naturalCompare(e,t,o="asc",i){if("desc"===o&&(t=[e,e=t][0]),null===e||""===e||void 0===e||null===t||""===t||void 0===t){const r=e===t?0:void 0===e?3:void 0===t?-3:null===e?2:null===t?-2:""===e?1:-1;return"desc"===o?!1!==i?r:-1*r:!0===i?-1*r:r}const r=[],s=[];for(t=""+t,(e=""+e).replace(/(\d+)|(\D+)/g,(e,t,o)=>{r.push([t||1/0,o||""])}),t.replace(/(\d+)|(\D+)/g,(e,t,o)=>{s.push([t||1/0,o||""])});r.length&&s.length;){const e=r.shift(),t=s.shift(),o=e[0]-t[0]||e[1].localeCompare(t[1]);if(o)return o}return r.length-s.length}static objectsAreEquivalent(e,t){if(e===t)return!0;const o=Object.getOwnPropertyNames(e),i=Object.getOwnPropertyNames(t);if(o.length!==i.length)return!1;for(const r of o)if(e[r]!==t[r])return!1;return!0}static removeKeys(e,t){return Object.keys(e).filter(e=>t.indexOf(e)<0).reduce((t,o)=>(t[o]=e[o],t),{})}}class E{static roundToNDecimal(e,t=3){const o=Math.pow(10,t);return Math.round(e*o)/o}}function R(e){return e.reduce((e,t)=>(e[t]=t,e),Object.create(null))}function U(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function N(){return`${U()}${U()}-${U()}-${U()}-${U()}-${U()}${U()}${U()}`.toLowerCase()}var J=(()=>{return(e=J||(J={}))[e.Error=0]="Error",e[e.Done=1]="Done",e[e.Working=2]="Working",e[e.Waiting=3]="Waiting",J;var e})();class B{constructor(){this.status$=new O.xQ}get status(){return this._status}set status(e){this._status=e,this.status$.next(e)}subscribe(e,t){this.watch(),this.status$$=this.status$.pipe((0,M.x)()).subscribe(o=>{this.handleStatusChange(o),e.call(t,this)})}unsubscribe(){this.unwatch(),void 0!==this.status$$&&(this.status$$.unsubscribe(),this.status$$=void 0),this.status=J.Waiting}handleStatusChange(e){}}var j=o(13828),Q=o(14994),G=o(13216);let Y=(()=>{class e{constructor(){this.counter$=new C.X(0),this.ids=[]}register(){const e=N();return this.ids.push(e),this.counter$.next(this.ids.length),e}unregister(e){const t=this.ids.indexOf(e);-1!==t&&(this.ids.splice(t,1),this.counter$.next(this.ids.length))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),z=(()=>{class e{constructor(e){this.activityService=e}intercept(e,t){const o=e.headers.get("activityInterceptor");if(o){const i=e.clone({headers:e.headers.delete("activityInterceptor")});if("false"===o)return t.handle(i)}const i=this.activityService.register();return t.handle(e).pipe((0,v.x)(()=>{this.activityService.unregister(i)}))}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(Y))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})(),H=(()=>{class e{static forRoot(){return{ngModule:e,providers:[{provide:y.TP,useClass:z,multi:!0}]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[]]}),e})();const V={lib:"1.9.3",releaseDate:1634566158790};let W=(()=>{class e{constructor(e){this.injector=e,this.config={}}getConfig(e){return D.resolve(this.config,e)}load(e){const t=e.default||{};if(!e.path)return this.config=t,!0;const o=this.injector.get(y.eN);return new Promise((i,r)=>{o.get(e.path).pipe((0,b.K)(t=>(console.log(`Configuration file ${e.path} could not be read`),i(!0),(0,T._)(t.error||"Server error")))).subscribe(e=>{this.config=D.mergeDeep(D.mergeDeep({version:V},t),e),i(!0)})})}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(r.zs3))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),X=new r.OlP("configOptions");function K(e){return{provide:X,useValue:e}}function ee(e,t){return()=>e.load(t)}let te=(()=>{class e{static forRoot(){return{ngModule:e,providers:[K({}),{provide:r.ip1,useFactory:ee,multi:!0,deps:[W,X]}]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[]]}),e})();class oe{constructor(e,t,o=".json",i){this.http=e,this.prefix=t,this.suffix=o,this.config=i}getTranslation(e){const t=o(36438)(`./${e}.json`),i=(0,A.of)(t);if(this.config&&!this.prefix){const e=this.config.getConfig("language.prefix");this.prefix=!e||Array.isArray(e)?e:[e]}if(!this.prefix||0===this.prefix.length)return i;const r=this.prefix.map(t=>this.http.get(`${t}${e}${this.suffix}`));return(0,L.aj)([i,...r]).pipe((0,x.U)(e=>e.reduce((e,t)=>D.mergeDeep(e,t),{})))}}function ie(e,t){return new oe(e,void 0,void 0,t)}function re(e){return{provide:j.Zw,useFactory:e||ie,deps:[y.eN,W]}}class se{handle(e){if(!e.translateService.langs.length)throw new Error("Translations are not yet loaded.          Check that the LanguageService is injected.");if("igo."===e.key.substr(0,4))throw new Error(`The Key "${e.key}" is missing in locale file.`);return e.key}}let ne=(()=>{class e{static forRoot(){return{ngModule:e,providers:[re()]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[j.aw.forRoot({missingTranslationHandler:{provide:j.gC,useClass:se}})],j.aw]}),e})();const ae=function(e){return{closeIcon:e}};let le=(()=>{class e{constructor(){this._options={}}get options(){return Object.assign({},e.defaultOptions,this._options)}set options(e){this._options=e}}return e.defaultOptions={timeOut:5e3,hasCloseIcon:!1,showProgressBar:!0,pauseOnHover:!0,clickToClose:!0,maxLength:100,maxStack:3,preventDuplicates:!0},e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-message-center"]],inputs:{options:"options"},decls:1,vars:4,consts:[[1,"mat-typography",3,"ngClass","options"]],template:function(e,t){1&e&&r._UZ(0,"simple-notifications",0),2&e&&r.Q6J("ngClass",r.VKq(2,ae,t.options.hasCloseIcon))("options",t.options)},directives:[Q.F0,h.mk],styles:['[_nghost-%COMP%]     div.simple-notification-wrapper{bottom:0;right:calc(50% - 150px)}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){[_nghost-%COMP%]     div.simple-notification-wrapper{right:0;left:0;width:100%}}[_nghost-%COMP%]     .closeIcon   .sn-title:after{content:"close";font-family:"Material Icons";font-feature-settings:"liga" 1;font-size:24px;font-weight:normal;right:5px;top:5px;position:absolute}[_nghost-%COMP%]     .simple-notification .icon{top:0;left:0;width:45px;height:45px;height:100%;padding:7px}[_nghost-%COMP%]     .simple-notification .icon mat-icon{display:flex;align-items:center;height:100%;font-size:32px}[_nghost-%COMP%]     div.simple-notification{min-height:50px;margin-bottom:5px;padding-left:45px;padding-right:25px}[_nghost-%COMP%]     div.simple-notification.noIcon{padding-left:25px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){[_nghost-%COMP%]     div.simple-notification{margin-bottom:0}}[_nghost-%COMP%]     div.simple-notification .sn-title{line-height:23px;font-size:15px;font-weight:bold}[_nghost-%COMP%]     div.simple-notification .sn-content{line-height:18px;font-size:15px}']}),e})(),ce=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,Q.CT.forRoot()]]}),e})(),ue=(()=>{class e{constructor(e){this.translate=e,this.language=this.translate.getBrowserLang();const t=this.getLanguage();this.translate.setDefaultLang(t)}getLanguage(){return this.language.match(/en|fr/)?this.language:"en"}setLanguage(e){this.language=e.match(/en|fr/)?e:"en",this.translate.use(this.language),this.translate.reloadLang(this.language)}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(j.sK))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var pe=(()=>{return(e=pe||(pe={})).ERROR="error",e.ALERT="alert",e.INFO="info",e.SUCCESS="success",pe;var e})();let de=(()=>{class e{constructor(e,t){this.notificationService=e,this.configService=t,this.messages$=new C.X([]),this.options=this.configService.getConfig("message")||{}}showError(e){return e.error.caught=!0,this.error(e.error.message,e.error.title)}message(e){this.messages$.next(this.messages$.value.concat([e])),e.options=e.options||{};const t=new Date;if(e.options.from=e.options.from?e.options.from:new Date("1 jan 1900"),e.options.to=e.options.to?e.options.to:new Date("1 jan 3000"),"string"==typeof e.options.from&&(e.options.from=new Date(Date.parse(e.options.from.replace(/-/g," ")))),"string"==typeof e.options.to&&(e.options.to=new Date(Date.parse(e.options.to.replace(/-/g," ")))),t>e.options.from&&t<e.options.to){let t;if((e=this.handleTemplate(e)).text)t=this.notificationService.create(e.title,e.text,e.type,e.options);else{if(!e.html)return;e.icon||(e.options.theClass=e.options.theClass?e.options.theClass+" noIcon":"noIcon"),t=this.notificationService.html(e.html,e.type,e.options)}return void 0!==e.icon&&this.addIcon(t,e.icon),e.options.id=t.id,t}}success(e,t,o={}){return this.message({text:e,title:t,icon:o.icon||"check",options:o,type:pe.SUCCESS})}error(e,t,o={}){return this.message({text:e,title:t,icon:o.icon||"error_outline",options:o,type:pe.ERROR})}info(e,t,o={}){return this.message({text:e,title:t,icon:o.icon||"info_outline",options:o,type:pe.INFO})}alert(e,t,o={}){return this.message({text:e,title:t,icon:o.icon||"access_alarm",options:o,type:pe.ALERT})}remove(e){this.notificationService.remove(e)}removeAllAreNotError(){for(const e of this.messages$.value)"error"!==e.type&&this.remove(e.options.id)}addIcon(e,t){e.icon=`\n      <mat-icon class="material-icons mat-icon mat-list-avatar" svgIcon="${t}">\n      </mat-icon>`}handleTemplate(e){if(!this.options.template||e.html)return e;let t=this.options.template;return t=t.replace("${text}",e.text),t=t.replace("${title}",e.title),t=t.replace("${icon}",e.icon),e.html=t,e.text=void 0,e.title=void 0,e.icon=void 0,e}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(Q.TF),r.LFG(W))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),he=(()=>{class e{constructor(e,t){this.messageService=e,this.injector=t}intercept(e,t){const o={httpError:void 0};return t.handle(e).pipe((0,b.K)(e=>this.handleError(e,o)),(0,v.x)(()=>{this.handleCaughtError(o),this.handleUncaughtError(o)}))}handleError(e,t){if(e instanceof y.UA){const t="object"===e.error?e.error:{};t.message=e.error.message||e.statusText,t.caught=!1,e=new y.UA({error:t,headers:e.headers,status:e.status,statusText:e.statusText,url:e.url})}return t.httpError=e,(0,T._)(e)}handleCaughtError(e){const t=e.httpError;t&&t.error.toDisplay&&(t.error.caught=!0,this.messageService.error(t.error.message,t.error.title))}handleUncaughtError(e){const t=e.httpError;if(t&&!t.error.caught){const e=this.injector.get(ue).translate,o=e.instant("igo.core.errors.uncaught.message"),i=e.instant("igo.core.errors.uncaught.title");t.error.caught=!0,this.messageService.error(o,i)}}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(de),r.LFG(r.zs3))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),ge=(()=>{class e{constructor(e){if(e)throw new Error("IgoErrorModule is already loaded. Import it in the AppModule only")}static forRoot(){return{ngModule:e,providers:[{provide:y.TP,useClass:he,multi:!0}]}}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(e,12))},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[]]}),e})(),me=new r.OlP("routeServiceOptions"),fe=(()=>{class e{constructor(e,t){this.route=e,this.options=Object.assign({},{centerKey:"center",zoomKey:"zoom",projectionKey:"projection",contextKey:"context",searchKey:"search",visibleOnLayersKey:"visiblelayers",visibleOffLayersKey:"invisiblelayers",directionsCoordKey:"routing",directionsOptionsKey:"routingOptions",toolKey:"tool",wmsUrlKey:"wmsUrl",wmsLayersKey:"wmsLayers",wmtsUrlKey:"wmtsUrl",wmtsLayersKey:"wmtsLayers",arcgisUrlKey:"arcgisUrl",arcgisLayersKey:"arcgisLayers",iarcgisUrlKey:"iarcgisUrl",iarcgisLayersKey:"iarcgisLayers",tarcgisUrlKey:"tarcgisUrl",tarcgisLayersKey:"tarcgisLayers",vectorKey:"vector"},t)}get queryParams(){return this.route.queryParams}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(d.gz),r.LFG(me,8))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var ye=(()=>{return(e=ye||(ye={})).Mobile="mobile",e.Tablet="tablet",e.Desktop="desktop",ye;var e})(),ve=(()=>{return(e=ve||(ve={})).Portrait="portrait",e.Landscape="landscape",ve;var e})();let be=(()=>{class e{constructor(e){this.media$=new C.X(void 0),this.orientation$=new C.X(void 0),e.observe([G.u3.HandsetLandscape]).subscribe(e=>{e.matches&&(this.media$.next(ye.Mobile),this.orientation$.next(ve.Landscape))}),e.observe([G.u3.HandsetPortrait]).subscribe(e=>{e.matches&&(this.media$.next(ye.Mobile),this.orientation$.next(ve.Portrait))}),e.observe([G.u3.TabletLandscape]).subscribe(e=>{e.matches&&(this.media$.next(ye.Tablet),this.orientation$.next(ve.Landscape))}),e.observe([G.u3.TabletPortrait]).subscribe(e=>{e.matches&&(this.media$.next(ye.Tablet),this.orientation$.next(ve.Portrait))}),e.observe([G.u3.WebLandscape]).subscribe(e=>{e.matches&&(this.media$.next(ye.Desktop),this.orientation$.next(ve.Landscape))}),e.observe([G.u3.WebPortrait]).subscribe(e=>{e.matches&&(this.media$.next(ye.Desktop),this.orientation$.next(ve.Portrait))})}getMedia(){return this.media$.value}getOrientation(){return this.orientation$.value}isTouchScreen(){return"ontouchstart"in document.documentElement}isMobile(){return"mobile"===this.getMedia()}isDesktop(){return"desktop"===this.getMedia()}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(G.Yg))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var xe=(()=>{return(e=xe||(xe={})).SESSION="Session",e.LOCAL="Local",xe;var e})(),we=(()=>{return(e=we||(we={})).ADDED="Added",e.MODIFIED="Modified",e.REMOVED="Removed",e.CLEARED="Cleared",we;var e})();let Se=(()=>{class e{constructor(e){this.config=e,this.storageChange$=new C.X(void 0),this.options=this.config.getConfig("storage")||{key:"igo"}}get(e,t){let o;if((!t||t===xe.SESSION)&&(o=sessionStorage.getItem(`${this.options.key}.${e}`)),(t===xe.LOCAL||!o&&!t)&&(o=localStorage.getItem(`${this.options.key}.${e}`)),o)try{o=JSON.parse(o)}catch(i){o=o}return o}set(e,t,o=xe.LOCAL){const i=this.get(e,o);o===xe.SESSION?sessionStorage.setItem(`${this.options.key}.${e}`,JSON.stringify(t)):localStorage.setItem(`${this.options.key}.${e}`,JSON.stringify(t));const r=this.get(e,o);r!==i&&this.storageChange$.next({key:e,scope:o,event:void 0!==i?we.MODIFIED:we.ADDED,previousValue:i,currentValue:r})}remove(e,t=xe.LOCAL){const o=this.get(e,t);t===xe.SESSION?sessionStorage.removeItem(`${this.options.key}.${e}`):localStorage.removeItem(`${this.options.key}.${e}`),this.storageChange$.next({key:e,scope:t,event:we.REMOVED,previousValue:o})}clear(e=xe.LOCAL){e===xe.SESSION?sessionStorage.clear():localStorage.clear(),this.storageChange$.next({scope:e,event:we.CLEARED})}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(W))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Ce=(()=>{class e{constructor(e,t){this.messageService=e,this.injector=t,this.stateChangeEventEmitter=new r.vpe,this.state={connection:window.navigator.onLine},this.checkNetworkState()}checkNetworkState(){this.onlineSubscription=(0,Z.R)(window,"online").subscribe(()=>{const e=this.injector.get(ue).translate,t=e.instant("igo.core.network.online.message"),o=e.instant("igo.core.network.online.title");this.messageService.info(t,o),this.state.connection=!0,this.emitEvent()}),this.offlineSubscription=(0,Z.R)(window,"offline").subscribe(()=>{const e=this.injector.get(ue).translate,t=e.instant("igo.core.network.offline.message"),o=e.instant("igo.core.network.offline.title");this.messageService.info(t,o),this.state.connection=!1,this.emitEvent()})}emitEvent(){this.stateChangeEventEmitter.emit(this.state)}ngOnDestroy(){try{this.offlineSubscription.unsubscribe(),this.onlineSubscription.unsubscribe()}catch(e){}}currentState(e=!0){return e?this.stateChangeEventEmitter.pipe((0,w.b)(300),(0,S.O)(this.state)):this.stateChangeEventEmitter.pipe((0,w.b)(300))}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(de),r.LFG(r.zs3))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Te=o(24411),Ae=o(84224),Le=o(89544),Ze=o(64674),Fe=o(89919),Oe=o(84515),Me=o(79902),Ie=o(14921),ke=o(85816),Pe=o(65318),_e=o(22663),$e=o(9170),qe=o(53466),De=o(63176),Ee=o(77820),Re=o(66360),Ue=o(33579),Ne=o(40062),Je=o(836),Be=o(9636),je=o(3786),Qe=o(94757),Ge=o(22297),Ye=o(72012),ze=o(18931),He=o(16529),Ve=o(74813),We=o(59298),Xe=o(87013),Ke=o(91039),et=o(14613),tt=o(80198),ot=o(82458),it=(()=>{return(e=it||(it={})).Default="Default",e.HTML="HTML",e.UnsanitizedHTML="UnsanitizedHTML",e.Icon="Icon",e.ButtonGroup="ButtonGroup",it;var e})(),rt=(()=>{return(e=rt||(rt={})).Auto="auto",e.Instant="instant",e.Smooth="smooth",rt;var e})(),st=(()=>{return(e=st||(st={})).None="None",e.All="All",e.Some="Some",st;var e})();function nt(e,t){return(0,Te.ZP)(e,t).safeObject}function at(e){const t=e.meta||{};return t.id?t.id:nt(e,t.idProperty||"id")}function lt(e){const t=e.meta||{};return t.title?t.title:nt(e,t.titleProperty||"title")}function ct(e){const t=e.meta||{};return t.icon?t.icon:nt(e,t.iconProperty||"icon")}class ut{constructor(e={}){this.index=new Map,this.change$=new Ae.t(1),this.store=e.store?e.store:void 0,this.getKey=e.getKey?e.getKey:this.store?this.store.getKey:at,this.next()}clear(){this.index.size>0&&(this.index.clear(),this.next())}get(e){return this.index.get(this.getKey(e))||{}}set(e,t){this.setMany([e],t)}setMany(e,t){e.forEach(e=>{this.index.set(this.getKey(e),Object.assign({},t))}),this.next()}setAll(e){Array.from(this.index.keys()).forEach(t=>{this.index.set(t,Object.assign({},e))}),this.next()}update(e,t,o=!1){this.updateMany([e],t,o)}updateMany(e,t,o=!1){if(!0===o)return this.updateManyExclusive(e,t);e.forEach(e=>{const o=Object.assign({},this.get(e),t);this.index.set(this.getKey(e),o)}),this.next()}reverse(e,t){this.reverseMany([e],t)}reverseMany(e,t){e.forEach(e=>{const o=this.get(e),i=t.reduce((e,t)=>(e[t]=o[t]||!1,e),{}),r=this.reverseChanges(i),s=Object.assign({},o,r);this.index.set(this.getKey(e),s)}),this.next()}updateAll(e){const t=this.getAllKeys();Array.from(t).forEach(t=>{const o=Object.assign({},this.index.get(t),e);this.index.set(t,o)}),this.next()}updateManyExclusive(e,t){const o=this.reverseChanges(t),i=e.map(e=>this.getKey(e));new Set(i.concat(Array.from(this.getAllKeys()))).forEach(e=>{const r=this.index.get(e)||{};i.indexOf(e)>=0?this.index.set(e,Object.assign({},r,t)):!0===Object.keys(o).some(e=>void 0!==r[e]&&r[e]!==o[e])&&this.index.set(e,Object.assign({},r,o))}),this.next()}reverseChanges(e){return Object.entries(e).reduce((e,t)=>{const[o,i]=t;return"boolean"==typeof i&&(e[o]=!i),e},{})}getAllKeys(){const e=this.store?Array.from(this.store.index.keys()):[];return new Set(Array.from(this.index.keys()).concat(e))}next(){this.change$.next()}}class pt{constructor(e){this.source$=e,this.values$=new C.X([]),this.lifted=!1,this.joins=[],this.filter$=new C.X(void 0),this.filters$=new C.X([]),this.filterIndex=new Map,this.sort$=new C.X(void 0),this.getKey$=new C.X(void 0),this.count$=new C.X(0),this.empty$=new C.X(!0)}get getKey(){return this.getKey$.value}get count(){return this.count$.value}get empty(){return this.empty$.value}get index(){return this._index}get(e){if(void 0===this._index)throw new Error("This view has no index, therefore, this method is unavailable.");return this.index.get(e)}all(){return this.values$.value}all$(){return this.values$}firstBy(e){return this.values$.value.find(e)}firstBy$(e){return this.values$.pipe((0,x.U)(t=>t.find(e)))}manyBy(e){return this.values$.value.filter(e)}manyBy$(e){return this.values$.pipe((0,x.U)(t=>t.filter(e)))}clear(){this.filter(void 0),this.sort(void 0)}destroy(){void 0!==this.values$$&&this.values$$.unsubscribe(),this.clear()}createIndex(e){return this._index=new Map,this.getKey$.next(e),this}join(e){if(!0===this.lifted)throw new Error("This view has already been lifted, therefore, no join is allowed.");return this.joins.push(e),this}filter(e){return this.filter$.next(e),this}addFilter(e){const t=N();return this.filterIndex.set(t,e),this.filters$.next(Array.from(this.filterIndex.values())),t}removeFilter(e){this.filterIndex.delete(e),this.filters$.next(Array.from(this.filterIndex.values()))}sort(e){return this.sort$.next(e),this}lift(){this.lifted=!0;const e=[this.joins.length>0?this.liftJoinedSource():this.liftSource(),this.filters$,this.filter$,this.sort$,this.getKey$];this.values$$=(0,L.aj)(e).pipe((0,Oe.T)(1),(0,w.b)(5)).subscribe(e=>{const[t,o,i,r,s]=e,n=this.processValues(t,o,i,r);this.setValues(n,void 0!==s)})}liftSource(){return this.source$}liftJoinedSource(){const e=[this.source$,(0,L.aj)(this.joins.map(e=>e.source))];return(0,L.aj)(e).pipe((0,x.U)(e=>{const[t,o]=e;return t.reduce((e,t)=>{const i=this.computeJoinedValue(t,o);return void 0!==i&&e.push(i),e},[])}))}computeJoinedValue(e,t){let o=e,i=0;for(;void 0!==o&&i<this.joins.length;)o=this.joins[i].reduce(o,t[i]),i+=1;return o}processValues(e,t,o,i){return e=e.slice(0),e=this.filterValues(e,t.concat([o])),this.sortValues(e,i)}filterValues(e,t){return 0===t.length?e:e.filter(e=>t.filter(e=>void 0!==e).every(t=>t(e)))}sortValues(e,t){return void 0===t?e:e.sort((e,o)=>D.naturalCompare(t.valueAccessor(e),t.valueAccessor(o),t.direction,t.nullsFirst))}setValues(e,t){!0===t&&(this._index=this.generateIndex(e)),this.values$.next(e);const o=e.length,i=0===o;this.count$.next(o),this.empty$.next(i)}generateIndex(e){const t=e.map(e=>[this.getKey(e),e]);return new Map(t)}}class dt{constructor(e,t={}){this.entities$=new C.X([]),this.count$=new C.X(0),this.empty$=new C.X(!0),this._pristine=!0,this.strategies=[],this.getKey=t.getKey?t.getKey:at,this.getProperty=t.getProperty?t.getProperty:nt,this.state=this.createStateManager(),this.view=this.createDataView(),this.stateView=this.createStateView(),this.view.lift(),this.stateView.lift(),e.length>0?this.load(e):this._index=this.generateIndex(e)}get count(){return this.count$.value}get empty(){return this.empty$.value}get index(){return this._index}get pristine(){return this._pristine}get(e){return this.index.get(e)}all(){return this.entities$.value}load(e,t=!0){this._index=this.generateIndex(e),this._pristine=t,this.next()}softClear(){this.index&&this.index.size>0?(this.index.clear(),this._pristine=!0,this.next()):this.index&&this.updateCount()}clear(){this.stateView.clear(),this.view.clear(),this.state.clear(),this.softClear()}destroy(){this.stateView.destroy(),this.view.destroy(),this.clear()}insert(e){this.insertMany([e])}insertMany(e){e.forEach(e=>this.index.set(this.getKey(e),e)),this._pristine=!1,this.next()}update(e){this.updateMany([e])}updateMany(e){e.forEach(e=>this.index.set(this.getKey(e),e)),this._pristine=!1,this.next()}delete(e){this.deleteMany([e])}deleteMany(e){e.forEach(e=>this.index.delete(this.getKey(e))),this._pristine=!1,this.next()}addStrategy(e,t=!1){if(void 0!==this.strategies.find(t=>e.constructor===t.constructor))throw new Error("A strategy of this type already exists on that EntityStore.");return this.strategies.push(e),e.bindStore(this),!0===t&&e.activate(),this}removeStrategy(e){const t=this.strategies.indexOf(e);return t>=0&&(this.strategies.splice(t,1),e.unbindStore(this)),this}getStrategyOfType(e){return this.strategies.find(t=>t instanceof e)}activateStrategyOfType(e){const t=this.getStrategyOfType(e);void 0!==t&&t.activate()}deactivateStrategyOfType(e){const t=this.getStrategyOfType(e);void 0!==t&&t.deactivate()}generateIndex(e){const t=e.map(e=>[this.getKey(e),e]);return new Map(t)}next(){this.entities$.next(Array.from(this.index.values())),this.updateCount()}updateCount(){const e=this.index.size,t=0===e;this.count$.next(e),this.empty$.next(t)}createStateManager(){return new ut({store:this})}createDataView(){return new pt(this.entities$)}createStateView(){return new pt(this.view.all$()).join({source:this.state.change$,reduce:e=>{const t=this.getKey(e),o=this.state.get(e),i=this.stateView.get(t);if(void 0!==i&&i.entity===e&&this.statesAreTheSame(i.state,o))return i;const r=i?i.revision+1:1;return{entity:e,state:o,revision:r,ref:`${t}-${r}`}}}).createIndex(e=>this.getKey(e.entity))}statesAreTheSame(e,t){if(e===t)return!0;const o=0===Object.keys(e).length,i=0===Object.keys(t).length;return o&&i}}class ht{constructor(e,t){this.innerStateIndex=new Map,this.setChangeDetector(t),this.setStore(e)}destroy(){this.setChangeDetector(void 0),this.setStore(void 0)}setStore(e){if(void 0===e)return this.teardownObservers(),this.innerStateIndex.clear(),void(this.store=void 0);this.setStore(void 0),this.store=e,this.setupObservers(),this.detectChanges()}setChangeDetector(e){this.cdRef=e}setupObservers(){this.teardownObservers(),this.entities$$=this.store.entities$.subscribe(e=>this.onEntitiesChange(e)),this.state$$=this.store.state.change$.pipe((0,Oe.T)(1)).subscribe(()=>this.onStateChange())}teardownObservers(){void 0!==this.entities$$&&this.entities$$.unsubscribe(),void 0!==this.state$$&&this.state$$.unsubscribe(),this.entities$$=void 0,this.state$$=void 0}onEntitiesChange(e){this.detectChanges()}onStateChange(){let e=!1;const t=this.store.state.index,o=this.innerStateIndex;t.size!==o.size&&(e=this.detectChanges());const i=Array.from(t.keys());for(const r of i){const i=t.get(r),s=o.get(r);!1===e&&(void 0===s?e=this.detectChanges():D.objectsAreEquivalent(i,s)||(e=this.detectChanges())),this.innerStateIndex.set(r,Object.assign({},i))}}detectChanges(){return void 0!==this.cdRef&&this.cdRef.detectChanges(),!0}}class gt{constructor(e={}){this.options=e,this.stores=[],this.active$=new C.X(!1),this.options=e}get active(){return this.active$.value}activate(){!0===this.active&&this.doDeactivate(),this.active$.next(!0),this.doActivate()}deactivate(){this.active$.next(!1),this.doDeactivate()}bindStore(e){this.stores.indexOf(e)<0&&this.stores.push(e)}unbindStore(e){const t=this.stores.indexOf(e);t>=0&&this.stores.splice(t,1)}doActivate(){}doDeactivate(){}}class mt extends gt{constructor(e){super(e),this.options=e,this.filters=new Map}bindStore(e){super.bindStore(e),!0===this.active&&this.filterStore(e)}unbindStore(e){super.unbindStore(e),!0===this.active&&this.unfilterStore(e)}doActivate(){this.filterAll()}doDeactivate(){this.unfilterAll()}filterAll(){this.stores.forEach(e=>this.filterStore(e))}unfilterAll(){this.stores.forEach(e=>this.unfilterStore(e))}filterStore(e){this.filters.set(e,e.stateView.addFilter(this.options.filterClauseFunc))}unfilterStore(e){const t=this.filters.get(e);void 0!==t&&(e.stateView.removeFilter(t),this.filters.delete(e))}}class ft extends gt{constructor(){super(...arguments),this.filters=new Map}bindStore(e){super.bindStore(e),!0===this.active&&this.filterStore(e)}unbindStore(e){super.unbindStore(e),!0===this.active&&this.unfilterStore(e)}doActivate(){this.filterAll()}doDeactivate(){this.unfilterAll()}filterAll(){this.stores.forEach(e=>this.filterStore(e))}unfilterAll(){this.stores.forEach(e=>this.unfilterStore(e))}filterStore(e){this.filters.has(e)||this.filters.set(e,e.stateView.addFilter(e=>!0===e.state.selected))}unfilterStore(e){const t=this.filters.get(e);void 0!==t&&(e.stateView.removeFilter(t),this.filters.delete(e))}}function yt(e,t){if(1&e&&(r.TgZ(0,"mat-option",4),r._uU(1),r.qZA()),2&e){const e=r.oxw();r.Q6J("value",e.emptyValue),r.xp6(1),r.Oqu(e.emptyText)}}function vt(e,t){if(1&e&&(r.TgZ(0,"mat-option",4),r._uU(1),r.ALo(2,"async"),r.qZA()),2&e){const e=r.oxw();r.Q6J("value",e.multiSelectValue),r.xp6(1),r.Oqu(r.lcZ(2,2,e.multiText$))}}function bt(e,t){if(1&e&&(r.TgZ(0,"mat-option",4),r._uU(1),r.qZA()),2&e){const e=t.$implicit,o=r.oxw();r.Q6J("value",e.entity),r.xp6(1),r.hij(" ",o.titleAccessor(e.entity)," ")}}let xt=(()=>{class e{constructor(e){this.cdRef=e,this.selected$=new C.X(void 0),this.multiText$=new C.X(void 0),this.multiSelectValue={id:"IGO_MULTI_SELECT"},this.emptyValue={id:"IGO_EMPTY_SELECT"},this.titleAccessor=lt,this.emptyText=void 0,this.multi=!1,this.multiAllText="All",this.multiNoneText="None",this.disabled=!1,this.selectedChange=new r.vpe}ngOnInit(){this.watcher=new ht(this.store,this.cdRef),this.selected$$=this.store.stateView.manyBy$(e=>!0===e.state.selected).subscribe(e=>{const t=e.map(e=>e.entity);this.onSelectFromStore(t)})}ngOnDestroy(){this.watcher.destroy(),this.selected$$.unsubscribe()}onSelectionChange(e){const t=e.value instanceof Array?e.value:[e.value],o=t.find(e=>e===this.multiSelectValue);let i=t.filter(e=>e!==this.multiSelectValue);void 0!==o&&(i.length===this.store.count?i=[]:i.length<this.store.count&&(i=this.store.all())),i=i.filter(e=>e!==this.emptyValue),0===i.length?this.store.state.updateAll({selected:!1}):this.store.state.updateMany(i,{selected:!0},!0),this.selectedChange.emit({selected:!0,value:this.multi?i:e.value})}onSelectFromStore(e){this.selected$.next(!0===this.multi?e:e.length>0?e[0]:void 0),this.updateMultiToggleWithEntities(e)}updateMultiToggleWithEntities(e){e.length===this.store.count&&this.multiText$.value!==this.multiNoneText?this.multiText$.next(this.multiNoneText):e.length<this.store.count&&this.multiText$.value!==this.multiAllText&&this.multiText$.next(this.multiAllText)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.sBO))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-entity-selector"]],inputs:{store:"store",titleAccessor:"titleAccessor",emptyText:"emptyText",multi:"multi",multiAllText:"multiAllText",multiNoneText:"multiNoneText",placeholder:"placeholder",disabled:"disabled"},outputs:{selectedChange:"selectedChange"},decls:7,vars:11,consts:[[1,"igo-entity-selector"],[3,"disabled","value","multiple","placeholder","selectionChange"],[3,"value",4,"ngIf"],["ngFor","",3,"ngForOf"],[3,"value"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-form-field",0),r.TgZ(1,"mat-select",1),r.NdJ("selectionChange",function(e){return t.onSelectionChange(e)}),r.ALo(2,"async"),r.YNc(3,yt,2,2,"mat-option",2),r.YNc(4,vt,3,4,"mat-option",2),r.YNc(5,bt,2,2,"ng-template",3),r.ALo(6,"async"),r.qZA(),r.qZA()),2&e&&(r.xp6(1),r.Q6J("disabled",t.disabled)("value",r.lcZ(2,7,t.selected$))("multiple",t.multi)("placeholder",t.placeholder),r.xp6(2),r.Q6J("ngIf",void 0!==t.emptyText&&!1===t.multi),r.xp6(1),r.Q6J("ngIf",!0===t.multi),r.xp6(1),r.Q6J("ngForOf",r.lcZ(6,9,t.store.stateView.all$())))},directives:[De.KE,Ee.gD,h.O5,h.sg,Re.ey],pipes:[h.Ov],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}"],changeDetection:0}),e})(),wt=(()=>{class e{onClick(e){e.stopPropagation()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=r.lG2({type:e,selectors:[["","igoStopPropagation",""]],hostBindings:function(e,t){1&e&&r.NdJ("click",function(e){return t.onClick(e)})}}),e})(),St=(()=>{class e{constructor(e,t){this.renderer=e,this.el=t,this.selection=!1,this.selectOnClick=!0,this.highlightSelection=!0,this._selected=!1,this.scrollBehavior=rt.Auto,this.select=new r.vpe}set selected(e){!1!==this.selection&&e!==this._selected&&(this.toggleSelected(e),this.scroll())}get selected(){return this._selected}onClick(){!1===this.selection||!1===this.selectOnClick||(this.toggleSelected(!0),this.select.emit(this))}toggleSelected(t){this._selected=t,!0===t?(this.addCls(e.selectedCls),!0===this.highlightSelection&&this.addCls(e.highlightedCls)):(this.removeCls(e.selectedCls),this.removeCls(e.highlightedCls))}scroll(){!0===this._selected&&(0,Je.Z)(this.el.nativeElement,{scrollMode:"if-needed",behavior:"smooth",block:"end",inline:"nearest"})}addCls(e){this.renderer.addClass(this.el.nativeElement,e)}removeCls(e){this.renderer.removeClass(this.el.nativeElement,e)}}return e.selectedCls="igo-entity-table-row-selected",e.highlightedCls="igo-entity-table-row-highlighted",e.\u0275fac=function(t){return new(t||e)(r.Y36(r.Qsj),r.Y36(r.SBq))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoEntityTableRow",""]],hostBindings:function(e,t){1&e&&r.NdJ("click",function(){return t.onClick()})},inputs:{selection:"selection",selectOnClick:"selectOnClick",highlightSelection:"highlightSelection",selected:"selected",scrollBehavior:"scrollBehavior"},outputs:{select:"select"}}),e})(),Ct=(()=>{class e{constructor(e,t){this.languageService=e,this.mediaService=t,this.disabled=!1,this.hidePageSize=!1,this.pageIndex=0,this.pageSize=50,this.pageSizeOptions=[5,10,20,50,100,200],this.showFirstLastButtons=!0,this.paginationLabelTranslation$$=[],this.entitySortChange$=new C.X(!1),this.length=0,this.paginatorChange=new r.vpe,this.rangeLabel=(e,t,o)=>{const i=new C.X("");if(this.paginationLabelTranslation$$.push(this.languageService.translate.get("igo.common.paginator.of").subscribe(e=>{i.next(e)})),0===o||0===t)return`0 ${i.value} ${o}`;const r=e*t;return`${r+1} - ${r<(o=Math.max(o,0))?Math.min(r+t,o):r+t} ${i.value} ${o}`}}ngOnChanges(){this.unsubscribeAll(),this.count$$=this.store.stateView.count$.subscribe(e=>{this.length=e,this.emitPaginator()}),this.entitySortChange$$=this.entitySortChange$.subscribe(()=>{this.paginator&&this.paginator.firstPage()}),this.initPaginatorOptions(),this.translateLabels()}initPaginatorOptions(){var e,t,o,i,r,s;this.disabled=(null===(e=this.paginatorOptions)||void 0===e?void 0:e.disabled)||this.disabled,this.pageIndex=(null===(t=this.paginatorOptions)||void 0===t?void 0:t.pageIndex)||this.pageIndex,this.pageSize=(null===(o=this.paginatorOptions)||void 0===o?void 0:o.pageSize)||this.pageSize,this.pageSizeOptions=(null===(i=this.paginatorOptions)||void 0===i?void 0:i.pageSizeOptions)||this.pageSizeOptions,this.mediaService.isMobile()?(this.showFirstLastButtons=!1,this.hidePageSize=!0):(this.showFirstLastButtons=(null===(r=this.paginatorOptions)||void 0===r?void 0:r.showFirstLastButtons)||this.showFirstLastButtons,this.hidePageSize=(null===(s=this.paginatorOptions)||void 0===s?void 0:s.hidePageSize)||this.hidePageSize)}translateLabels(){this.paginationLabelTranslation$$.push(this.languageService.translate.get("igo.common.paginator.firstPageLabel").subscribe(e=>{this.paginator._intl.firstPageLabel=e})),this.paginator._intl.getRangeLabel=this.rangeLabel,this.paginationLabelTranslation$$.push(this.languageService.translate.get("igo.common.paginator.itemsPerPageLabel").subscribe(e=>{this.paginator._intl.itemsPerPageLabel=e})),this.paginationLabelTranslation$$.push(this.languageService.translate.get("igo.common.paginator.lastPageLabel").subscribe(e=>{this.paginator._intl.lastPageLabel=e})),this.paginationLabelTranslation$$.push(this.languageService.translate.get("igo.common.paginator.nextPageLabel").subscribe(e=>{this.paginator._intl.nextPageLabel=e})),this.paginationLabelTranslation$$.push(this.languageService.translate.get("igo.common.paginator.previousPageLabel").subscribe(e=>{this.paginator._intl.previousPageLabel=e}))}unsubscribeAll(){this.paginationLabelTranslation$$.map(e=>e.unsubscribe()),this.count$$&&this.count$$.unsubscribe(),this.entitySortChange$$&&this.entitySortChange$$.unsubscribe()}ngOnDestroy(){this.unsubscribeAll()}emitPaginator(){this.paginatorChange.emit(this.paginator)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ue),r.Y36(be))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-entity-table-paginator"]],viewQuery:function(e,t){if(1&e&&r.Gf(Be.NW,7),2&e){let e;r.iGM(e=r.CRH())&&(t.paginator=e.first)}},inputs:{entitySortChange$:"entitySortChange$",store:"store",paginatorOptions:"paginatorOptions"},outputs:{page:"page",paginatorChange:"paginatorChange"},features:[r.TTD],decls:1,vars:7,consts:[[3,"disabled","hidePageSize","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons","page"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-paginator",0),r.NdJ("page",function(){return t.emitPaginator()}),r.qZA()),2&e&&r.Q6J("disabled",t.disabled)("hidePageSize",t.hidePageSize)("length",t.length)("pageIndex",t.pageIndex)("pageSize",t.pageSize)("pageSizeOptions",t.pageSizeOptions)("showFirstLastButtons",t.showFirstLastButtons)},directives:[Be.NW],styles:["[_nghost-%COMP%]{margin-top:-10px;padding-right:15px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){[_nghost-%COMP%]{margin-top:0;padding-right:5px}}"],changeDetection:0}),e})(),Tt=(()=>{class e{constructor(e){this.http=e}transform(e){const t=new y.WM({"Content-Type":"text/plain",activityInterceptor:"false"});return this.http.get(e,{headers:t,responseType:"blob"}).pipe((0,Me.w)(e=>new Le.y(t=>{const o=new FileReader;o.readAsDataURL(e),o.onloadend=()=>{t.next(o.result),t.complete()}})))}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(y.eN,16))},e.\u0275pipe=r.Yjl({name:"secureImage",type:e,pure:!0}),(0,je.gn)([(0,Qe.q)({maxCacheCount:20})],e.prototype,"transform",null),e})(),At=(()=>{class e{constructor(e){this._sanitizer=e}transform(e){return this._sanitizer.bypassSecurityTrustHtml(e)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(i.H7,16))},e.\u0275pipe=r.Yjl({name:"sanitizeHtml",type:e,pure:!0}),e})();function Lt(e,t){if(1&e){const e=r.EpF();r.ynx(0),r.TgZ(1,"mat-checkbox",11),r.NdJ("change",function(t){return r.CHM(e),r.oxw(3).onToggleRows(t.checked)}),r.qZA(),r.BQk()}if(2&e){const e=t.ngIf,o=r.oxw(3);r.xp6(1),r.Q6J("checked",e===o.entityTableSelectionState.All)("indeterminate",e===o.entityTableSelectionState.Some)}}function Zt(e,t){if(1&e&&(r.ynx(0),r.YNc(1,Lt,2,2,"ng-container",10),r.ALo(2,"async"),r.BQk()),2&e){const e=r.oxw(2);r.xp6(1),r.Q6J("ngIf",r.lcZ(2,1,e.selectionState$))}}function Ft(e,t){if(1&e&&(r.TgZ(0,"th",9),r.YNc(1,Zt,3,3,"ng-container",10),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf",e.selectMany)}}function Ot(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"td",12),r.TgZ(1,"mat-checkbox",13),r.NdJ("mousedown",function(e){return e.shiftKey?e.preventDefault():null})("click",function(t){const o=r.CHM(e).$implicit,i=r.oxw();return t.shiftKey?i.onShiftToggleRow(!i.rowIsSelected(o),o,t):t.stopPropagation()})("change",function(t){const o=r.CHM(e).$implicit;return r.oxw().onToggleRow(t.checked,o)}),r.qZA(),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw();r.xp6(1),r.Q6J("checked",o.rowIsSelected(e))}}function Mt(e,t){if(1&e&&(r.TgZ(0,"th",16),r._uU(1),r.qZA()),2&e){const e=r.oxw(2).$implicit;r.xp6(1),r.hij(" ",e.title," ")}}function It(e,t){1&e&&(r.ynx(0),r.YNc(1,Mt,2,1,"th",15),r.BQk())}function kt(e,t){if(1&e&&(r.TgZ(0,"th",9),r._uU(1),r.qZA()),2&e){const e=r.oxw(2).$implicit;r.xp6(1),r.hij(" ",e.title," ")}}function Pt(e,t){1&e&&(r.ynx(0),r.YNc(1,kt,2,1,"th",3),r.BQk())}function _t(e,t){if(1&e&&(r.TgZ(0,"td",20),r._uU(1),r.qZA()),2&e){const e=r.oxw().$implicit,t=r.oxw(3).$implicit,o=r.oxw();r.Q6J("ngClass",o.getCellClass(e,t)),r.xp6(1),r.hij(" ",o.getValue(e,t)," ")}}function $t(e,t){if(1&e&&(r._UZ(0,"img",24),r.ALo(1,"async"),r.ALo(2,"secureImage")),2&e){const e=r.oxw(2).$implicit,t=r.oxw(3).$implicit,o=r.oxw();r.s9C("src",r.lcZ(1,1,r.lcZ(2,3,o.getValue(e,t))),r.LSH)}}function qt(e,t){1&e&&(r.TgZ(0,"span"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij("",r.lcZ(2,1,"igo.common.entity-table.targetHtmlUrl")," "))}function Dt(e,t){if(1&e&&(r.TgZ(0,"td",20),r.TgZ(1,"a",21),r.NdJ("click",function(e){return e.stopPropagation()}),r.YNc(2,$t,3,5,"img",22),r.YNc(3,qt,3,3,"ng-template",null,23,r.W1O),r.qZA(),r.qZA()),2&e){const e=r.MAs(4),t=r.oxw().$implicit,o=r.oxw(3).$implicit,i=r.oxw();r.Q6J("ngClass",i.getCellClass(t,o)),r.xp6(1),r.s9C("href",i.getValue(t,o),r.LSH),r.xp6(1),r.Q6J("ngIf",i.isImg(i.getValue(t,o)))("ngIfElse",e)}}function Et(e,t){if(1&e&&(r.ynx(0),r.YNc(1,_t,2,2,"td",18),r.YNc(2,Dt,5,4,"ng-template",null,19,r.W1O),r.BQk()),2&e){const e=t.$implicit,o=r.MAs(3),i=r.oxw(3).$implicit,s=r.oxw();r.xp6(1),r.Q6J("ngIf",!s.isUrl(s.getValue(e,i)))("ngIfElse",o)}}function Rt(e,t){1&e&&(r.ynx(0),r.YNc(1,Et,4,2,"ng-container",17),r.BQk())}function Ut(e,t){if(1&e&&r._UZ(0,"td",27),2&e){const e=r.oxw().$implicit,t=r.oxw(3).$implicit,o=r.oxw();r.Q6J("ngClass",o.getCellClass(e,t))("innerHTML",o.getValue(e,t),r.oJD)}}function Nt(e,t){if(1&e&&(r._UZ(0,"img",24),r.ALo(1,"async"),r.ALo(2,"secureImage")),2&e){const e=r.oxw(2).$implicit,t=r.oxw(3).$implicit,o=r.oxw();r.s9C("src",r.lcZ(1,1,r.lcZ(2,3,o.getValue(e,t))),r.LSH)}}function Jt(e,t){1&e&&(r.TgZ(0,"span"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij("",r.lcZ(2,1,"igo.geo.targetHtmlUrl")," "))}function Bt(e,t){if(1&e&&(r.TgZ(0,"td",20),r.TgZ(1,"a",21),r.NdJ("click",function(e){return e.stopPropagation()}),r.YNc(2,Nt,3,5,"img",22),r.YNc(3,Jt,3,3,"ng-template",null,23,r.W1O),r.qZA(),r.qZA()),2&e){const e=r.MAs(4),t=r.oxw().$implicit,o=r.oxw(3).$implicit,i=r.oxw();r.Q6J("ngClass",i.getCellClass(t,o)),r.xp6(1),r.s9C("href",i.getValue(t,o),r.LSH),r.xp6(1),r.Q6J("ngIf",i.isImg(i.getValue(t,o)))("ngIfElse",e)}}function jt(e,t){if(1&e&&(r.ynx(0),r.YNc(1,Ut,1,2,"td",25),r.YNc(2,Bt,5,4,"ng-template",null,26,r.W1O),r.BQk()),2&e){const e=t.$implicit,o=r.MAs(3),i=r.oxw(3).$implicit,s=r.oxw();r.xp6(1),r.Q6J("ngIf",!s.isUrl(s.getValue(e,i)))("ngIfElse",o)}}function Qt(e,t){1&e&&(r.ynx(0),r.YNc(1,jt,4,2,"ng-container",17),r.BQk())}function Gt(e,t){if(1&e&&(r._UZ(0,"td",27),r.ALo(1,"sanitizeHtml")),2&e){const e=r.oxw().$implicit,t=r.oxw(3).$implicit,o=r.oxw();r.Q6J("ngClass",o.getCellClass(e,t))("innerHTML",r.lcZ(1,2,o.getValue(e,t)),r.oJD)}}function Yt(e,t){if(1&e&&(r._UZ(0,"img",24),r.ALo(1,"async"),r.ALo(2,"secureImage")),2&e){const e=r.oxw(2).$implicit,t=r.oxw(3).$implicit,o=r.oxw();r.s9C("src",r.lcZ(1,1,r.lcZ(2,3,o.getValue(e,t))),r.LSH)}}function zt(e,t){1&e&&(r.TgZ(0,"span"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij("",r.lcZ(2,1,"igo.geo.targetHtmlUrl")," "))}function Ht(e,t){if(1&e&&(r.TgZ(0,"td",20),r.TgZ(1,"a",21),r.NdJ("click",function(e){return e.stopPropagation()}),r.YNc(2,Yt,3,5,"img",22),r.YNc(3,zt,3,3,"ng-template",null,23,r.W1O),r.qZA(),r.qZA()),2&e){const e=r.MAs(4),t=r.oxw().$implicit,o=r.oxw(3).$implicit,i=r.oxw();r.Q6J("ngClass",i.getCellClass(t,o)),r.xp6(1),r.s9C("href",i.getValue(t,o),r.LSH),r.xp6(1),r.Q6J("ngIf",i.isImg(i.getValue(t,o)))("ngIfElse",e)}}function Vt(e,t){if(1&e&&(r.ynx(0),r.YNc(1,Gt,2,4,"td",25),r.YNc(2,Ht,5,4,"ng-template",null,28,r.W1O),r.BQk()),2&e){const e=t.$implicit,o=r.MAs(3),i=r.oxw(3).$implicit,s=r.oxw();r.xp6(1),r.Q6J("ngIf",!s.isUrl(s.getValue(e,i)))("ngIfElse",o)}}function Wt(e,t){1&e&&(r.ynx(0),r.YNc(1,Vt,4,2,"ng-container",17),r.BQk())}function Xt(e,t){if(1&e&&(r.TgZ(0,"td",20),r._UZ(1,"mat-icon",30),r.qZA()),2&e){const e=t.$implicit,o=r.oxw(3).$implicit,i=r.oxw();r.Q6J("ngClass",i.getCellClass(e,o)),r.xp6(1),r.s9C("svgIcon",i.getValue(e,o))}}function Kt(e,t){1&e&&(r.ynx(0),r.YNc(1,Xt,2,2,"td",29),r.BQk())}function eo(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",34),r.NdJ("click",function(){r.CHM(e);const t=r.oxw().$implicit,o=r.oxw().$implicit;return r.oxw(4).onButtonClick(t.click,o)}),r._UZ(1,"mat-icon",30),r.qZA()}if(2&e){const e=r.oxw().$implicit;r.Q6J("color",e.color),r.xp6(1),r.s9C("svgIcon",e.icon)}}function to(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",35),r.NdJ("click",function(){r.CHM(e);const t=r.oxw().$implicit,o=r.oxw().$implicit;return r.oxw(4).onButtonClick(t.click,o)}),r._UZ(1,"mat-icon",30),r.qZA()}if(2&e){const e=r.oxw().$implicit;r.Q6J("color",e.color),r.xp6(1),r.s9C("svgIcon",e.icon)}}function oo(e,t){if(1&e&&(r.TgZ(0,"span"),r.YNc(1,eo,2,2,"button",32),r.YNc(2,to,2,2,"button",33),r.qZA()),2&e){const e=t.$implicit;r.xp6(1),r.Q6J("ngIf","mat-icon-button"===e.style),r.xp6(1),r.Q6J("ngIf","mat-icon-button"!==e.style)}}function io(e,t){if(1&e&&(r.TgZ(0,"td",20),r.YNc(1,oo,3,2,"span",31),r.qZA()),2&e){const e=t.$implicit,o=r.oxw(3).$implicit,i=r.oxw();r.Q6J("ngClass",i.getCellClass(e,o)),r.xp6(1),r.Q6J("ngForOf",i.getValue(e,o))}}function ro(e,t){1&e&&(r.ynx(0),r.YNc(1,io,2,2,"td",29),r.BQk())}function so(e,t){if(1&e&&(r.ynx(0),r.YNc(1,Rt,2,0,"ng-container",10),r.YNc(2,Qt,2,0,"ng-container",10),r.YNc(3,Wt,2,0,"ng-container",10),r.YNc(4,Kt,2,0,"ng-container",10),r.YNc(5,ro,2,0,"ng-container",10),r.BQk()),2&e){const e=t.ngIf,o=r.oxw(2);r.xp6(1),r.Q6J("ngIf",e===o.entityTableColumnRenderer.Default),r.xp6(1),r.Q6J("ngIf",e===o.entityTableColumnRenderer.HTML),r.xp6(1),r.Q6J("ngIf",e===o.entityTableColumnRenderer.UnsanitizedHTML),r.xp6(1),r.Q6J("ngIf",e===o.entityTableColumnRenderer.Icon),r.xp6(1),r.Q6J("ngIf",e===o.entityTableColumnRenderer.ButtonGroup)}}function no(e,t){if(1&e&&(r.ynx(0,14),r.YNc(1,It,2,0,"ng-container",10),r.YNc(2,Pt,2,0,"ng-container",10),r.YNc(3,so,6,5,"ng-container",10),r.BQk()),2&e){const e=t.$implicit,o=r.oxw();r.Q6J("matColumnDef",e.name),r.xp6(1),r.Q6J("ngIf",o.columnIsSortable(e)),r.xp6(1),r.Q6J("ngIf",!o.columnIsSortable(e)),r.xp6(1),r.Q6J("ngIf",o.getColumnRenderer(e))}}function ao(e,t){if(1&e&&r._UZ(0,"tr",36),2&e){const e=r.oxw();r.Q6J("ngClass",e.getHeaderClass())}}function lo(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"tr",37),r.NdJ("select",function(){const t=r.CHM(e).$implicit;return r.oxw().onRowSelect(t)})("click",function(){const t=r.CHM(e).$implicit;return r.oxw().onRowClick(t)}),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw();r.Q6J("scrollBehavior",o.scrollBehavior)("ngClass",o.getRowClass(e))("selection",o.selection)("selected",o.rowIsSelected(e))}}function co(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-entity-table-paginator",38),r.NdJ("paginatorChange",function(t){return r.CHM(e),r.oxw().paginatorChange(t)}),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("store",e.store)("paginatorOptions",e.paginatorOptions)("entitySortChange$",e.entitySortChange$)}}let uo=(()=>{class e{constructor(e){this.cdRef=e,this.entitySortChange$=new C.X(!1),this.entityTableColumnRenderer=it,this.entityTableSelectionState=st,this.selectionState$=new C.X(void 0),this.scrollBehavior=rt.Auto,this.sortNullsFirst=!1,this.withPaginator=!1,this.entityClick=new r.vpe,this.entitySelectChange=new r.vpe,this.entitySortChange=new r.vpe(void 0),this.dataSource=new Ue.by}set paginator(e){this._paginator=e,this.dataSource.paginator=e}get paginator(){return this._paginator}get headers(){let e=this.template.columns.filter(e=>!1!==e.visible).map(e=>e.name);return!0===this.selectionCheckbox&&(e=["selectionCheckbox"].concat(e)),e}get selection(){return this.template.selection||!1}get selectionCheckbox(){return this.template.selectionCheckbox||!1}get selectMany(){return this.template.selectMany||!1}get fixedHeader(){return void 0===this.template.fixedHeader||this.template.fixedHeader}ngOnInit(){this.handleDatasource(),this.dataSource.paginator=this.paginator}ngOnChanges(e){const t=e.store;t&&t.currentValue!==t.previousValue&&this.handleDatasource()}handleDatasource(){this.unsubscribeStore(),this.selection$$=this.store.stateView.manyBy$(e=>!0===e.state.selected).subscribe(e=>{const t=e[0],o=this.store.stateView.all().indexOf(t),i=this.paginator?this.paginator.pageSize*(this.paginator.pageIndex+1):0;if(this.paginator&&(o<(this.paginator?i-this.paginator.pageSize:0)||o>=i)){const e=Math.floor(o/this.paginator.pageSize);this.dataSource.paginator.pageIndex=e}this.selectionState$.next(this.computeSelectionState(e))}),this.dataSource$$=this.store.stateView.all$().subscribe(e=>{this.dataSource.data=e})}ngOnDestroy(){this.unsubscribeStore()}unsubscribeStore(){this.selection$$&&this.selection$$.unsubscribe(),this.dataSource$$&&this.dataSource$$.unsubscribe()}getTrackByFunction(){return(e,t)=>t.ref}refresh(){this.cdRef.detectChanges()}paginatorChange(e){this.paginator=e}onSort(e){const t=e.direction,o=this.template.columns.find(t=>t.name===e.active);"asc"===t||"desc"===t?(this.store.stateView.sort({valueAccessor:e=>this.getValue(e,o),direction:t,nullsFirst:this.sortNullsFirst}),this.entitySortChange.emit({column:o,direction:t}),this.entitySortChange$.next(!0)):this.store.stateView.sort(void 0)}onRowClick(e){this.lastRecordCheckedKey=this.store.stateView.getKey(e),this.entityClick.emit(e.entity)}onRowSelect(e){if(!1===this.selection)return;const t=e.entity;this.store.state.update(t,{selected:!0},!0),this.entitySelectChange.emit({added:[t]})}onToggleRows(e){if(!1!==this.selection&&(this.store.state.updateAll({selected:e}),!0===e)){const e=this.store.stateView.all().map(e=>e.entity);this.entitySelectChange.emit({added:[e]})}}onToggleRow(e,t){if(!1===this.selection)return;const o=t.entity;this.store.state.update(o,{selected:e},!0===e&&!this.selectMany),!0===e&&this.entitySelectChange.emit({added:[o]}),this.lastRecordCheckedKey=this.store.stateView.getKey(t)}onShiftToggleRow(e,t,o){if(!1===this.selection)return;if(!1===this.selectMany||void 0===this.lastRecordCheckedKey)return void this.onToggleRow(e,t);const i=window.document.createRange();i.selectNode(o.target),window.getSelection().removeAllRanges(),window.getSelection().addRange(i),o.stopImmediatePropagation();const r=this.store.stateView.all(),s=r.indexOf(t),n=this.store.stateView.get(this.lastRecordCheckedKey),a=[s,r.indexOf(n)],l=r.slice(Math.min(...a),Math.max(...a)+1).map(e=>e.entity);this.store.state.updateMany(l,{selected:e}),!0===e&&this.entitySelectChange.emit({added:l}),this.lastRecordCheckedKey=this.store.stateView.getKey(t)}computeSelectionState(e){const t=e.length;return 0===t?st.None:t===this.store.stateView.count?st.All:st.Some}columnIsSortable(e){let t=e.sort;return void 0===t&&(t=void 0!==this.template.sort&&this.template.sort),t}rowIsSelected(e){const t=e.state;return!!t.selected&&t.selected}isImg(e){return!!this.isUrl(e)&&-1!==["jpg","png","gif"].indexOf(e.split(".").pop().toLowerCase())}isUrl(e){return"string"==typeof e&&("https://"===e.slice(0,8)||"http://"===e.slice(0,7))}getValue(e,t){const o=e.entity;return void 0!==t.valueAccessor?t.valueAccessor(o,e):void 0!==this.template.valueAccessor?this.template.valueAccessor(o,t.name,e):this.store.getProperty(o,t.name)}getColumnRenderer(e){return void 0!==e.renderer?e.renderer:it.Default}getTableClass(){return{"igo-entity-table-with-selection":this.selection}}getHeaderClass(){const e=this.template.headerClassFunc;return e instanceof Function?e():{}}getRowClass(e){const t=this.template.rowClassFunc;return t instanceof Function?t(e.entity,e):{}}getCellClass(e,t){const o=e.entity,i={},r=this.template.cellClassFunc;r instanceof Function&&Object.assign(i,r(o,t,e));const s=t.cellClassFunc;return s instanceof Function&&Object.assign(i,s(o,e)),i}onButtonClick(e,t){"function"==typeof e&&e(t.entity,t)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.sBO))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-entity-table"]],inputs:{store:"store",paginator:"paginator",template:"template",scrollBehavior:"scrollBehavior",sortNullsFirst:"sortNullsFirst",withPaginator:"withPaginator",paginatorOptions:"paginatorOptions"},outputs:{entityClick:"entityClick",entitySelectChange:"entitySelectChange",entitySortChange:"entitySortChange"},features:[r.TTD],decls:9,vars:8,consts:[[1,"table-container"],["mat-table","","matSort","",3,"ngClass","dataSource","trackBy","matSortChange"],["matColumnDef","selectionCheckbox",1,"mat-cell-checkbox"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],[3,"matColumnDef",4,"ngFor","ngForOf"],["mat-header-row","",3,"ngClass",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","igoEntityTableRow","",3,"scrollBehavior","ngClass","selection","selected","select","click",4,"matRowDef","matRowDefColumns"],[3,"store","paginatorOptions","entitySortChange$","paginatorChange",4,"ngIf"],["mat-header-cell",""],[4,"ngIf"],[3,"checked","indeterminate","change"],["mat-cell",""],[3,"checked","mousedown","click","change"],[3,"matColumnDef"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-header-cell","","mat-sort-header",""],[4,"matCellDef"],["mat-cell","","class","mat-cell-text",3,"ngClass",4,"ngIf","ngIfElse"],["isAnUrlDefault",""],["mat-cell","",1,"mat-cell-text",3,"ngClass"],["target","_blank","rel","noopener noreferrer",3,"href","click"],["width","50","heigth","auto",3,"src",4,"ngIf","ngIfElse"],["notImg",""],["width","50","heigth","auto",3,"src"],["mat-cell","","class","mat-cell-text",3,"ngClass","innerHTML",4,"ngIf","ngIfElse"],["isAnUrlHTML",""],["mat-cell","",1,"mat-cell-text",3,"ngClass","innerHTML"],["isAnUrlUnsanitizedHTML",""],["mat-cell","","class","mat-cell-text",3,"ngClass",4,"matCellDef"],[3,"svgIcon"],[4,"ngFor","ngForOf"],["igoStopPropagation","","mat-icon-button","",3,"color","click",4,"ngIf"],["igoStopPropagation","","mat-mini-fab","",3,"color","click",4,"ngIf"],["igoStopPropagation","","mat-icon-button","",3,"color","click"],["igoStopPropagation","","mat-mini-fab","",3,"color","click"],["mat-header-row","",3,"ngClass"],["mat-row","","igoEntityTableRow","",3,"scrollBehavior","ngClass","selection","selected","select","click"],[3,"store","paginatorOptions","entitySortChange$","paginatorChange"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"table",1),r.NdJ("matSortChange",function(e){return t.onSort(e)}),r.ynx(2,2),r.YNc(3,Ft,2,1,"th",3),r.YNc(4,Ot,2,1,"td",4),r.BQk(),r.YNc(5,no,4,4,"ng-container",5),r.YNc(6,ao,1,1,"tr",6),r.YNc(7,lo,1,4,"tr",7),r.qZA(),r.YNc(8,co,1,3,"igo-entity-table-paginator",8),r.qZA()),2&e&&(r.xp6(1),r.Q6J("ngClass",t.getTableClass())("dataSource",t.dataSource)("trackBy",t.getTrackByFunction()),r.xp6(4),r.Q6J("ngForOf",t.template.columns),r.xp6(1),r.Q6J("matHeaderRowDef",t.headers)("matHeaderRowDefSticky",t.fixedHeader),r.xp6(1),r.Q6J("matRowDefColumns",t.headers),r.xp6(1),r.Q6J("ngIf",t.withPaginator))},directives:[Ue.BZ,Ne.YE,h.mk,Ue.w1,Ue.fO,Ue.Dz,h.sg,Ue.as,Ue.nj,h.O5,Ue.ge,m.oG,Ue.ev,Ne.nU,a.Hw,n.lW,wt,Ue.XQ,Ue.Gk,St,Ct],pipes:[h.Ov,Tt,j.X$,At],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:block}.table-compact[_nghost-%COMP%]   tr.mat-header-row[_ngcontent-%COMP%], .table-compact[_nghost-%COMP%]     .mat-checkbox .mat-checkbox-ripple{height:36px}.table-compact[_nghost-%COMP%]   tr.mat-row[_ngcontent-%COMP%], .table-compact[_nghost-%COMP%]     .mat-checkbox .mat-checkbox-ripple{height:28px}.table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;overflow:auto;flex:1 1 auto}.mat-cell-text[_ngcontent-%COMP%]{overflow:hidden;word-wrap:break-word}th.mat-header-cell[_ngcontent-%COMP%], td.mat-cell[_ngcontent-%COMP%], td.mat-footer-cell[_ngcontent-%COMP%]{padding:0 3px}entity-table[_ngcontent-%COMP%]   table.igo-entity-table-with-selection[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{-o-box-shadow:2px 0px 2px 0px #dddddd;box-shadow:2px 0 2px #ddd;cursor:pointer}table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:7px}"],changeDetection:0}),e})();var po=(()=>{return(e=po||(po={})).Dock="dock",e.Overlay="overlay",e.Context="context",po;var e})();function ho(e,t){if(1&e&&(r._UZ(0,"mat-icon",7),r.ALo(1,"async")),2&e){const e=r.oxw(3);r.s9C("svgIcon",r.lcZ(1,1,e.icon$))}}function go(e,t){if(1&e&&(r.TgZ(0,"button",5),r.ALo(1,"async"),r.YNc(2,ho,2,3,"mat-icon",6),r.qZA()),2&e){const e=r.oxw(2);r.Q6J("color",e.color)("disabled",r.lcZ(1,3,e.disabled$)),r.xp6(2),r.Q6J("ngIf",e.withIcon)}}function mo(e,t){if(1&e&&(r.TgZ(0,"h4",8),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.Oqu(r.lcZ(2,1,e.title))}}function fo(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-list-item",2),r.NdJ("click",function(){return r.CHM(e),r.oxw().onClick()}),r.ALo(1,"translate"),r.ALo(2,"async"),r.ALo(3,"async"),r.YNc(4,go,3,5,"button",3),r.YNc(5,mo,3,3,"h4",4),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("matTooltip",e.withTooltip?r.lcZ(1,4,r.lcZ(2,6,e.tooltip$)||e.title):"")("ngClass",r.lcZ(3,8,e.ngClass$)),r.xp6(4),r.Q6J("ngIf",e.withIcon),r.xp6(1),r.Q6J("ngIf",e.withTitle)}}function yo(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-checkbox",11),r.NdJ("change",function(){return r.CHM(e),r.oxw(2).action.handler()}),r.ALo(1,"async"),r._uU(2),r.ALo(3,"translate"),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("checked",r.lcZ(1,2,e.checkCondition$)),r.xp6(2),r.hij(" ",r.lcZ(3,4,e.title)," ")}}function vo(e,t){if(1&e&&(r.TgZ(0,"mat-list-item",9),r.ALo(1,"translate"),r.ALo(2,"async"),r.ALo(3,"async"),r.YNc(4,yo,4,6,"mat-checkbox",10),r.qZA()),2&e){const e=r.oxw();r.Q6J("matTooltip",e.withTooltip?r.lcZ(1,3,r.lcZ(2,5,e.tooltip$)||e.title):"")("ngClass",r.lcZ(3,7,e.ngClass$)),r.xp6(4),r.Q6J("ngIf",e.withTitle)}}let bo=(()=>{class e{constructor(){this.disabled$=new C.X(!1),this.checkCondition$=new C.X(void 0),this.icon$=new C.X(void 0),this.tooltip$=new C.X(void 0),this.noDisplay$=new C.X(!1),this.ngClass$=new C.X({}),this.color="default",this.withTitle=!0,this.withIcon=!0,this.withTooltip=!0,this.trigger=new r.vpe}set disabled(e){this.disabled$.next(e)}get disabled(){return this.disabled$.value}set noDisplay(e){this.noDisplay$.next(e)}get noDisplay(){return this.noDisplay$.value}get title(){return this.action.title}ngOnInit(){const e=this.action.args||[];void 0!==this.action.ngClass&&(this.ngClass$$=this.action.ngClass(...e).subscribe(e=>this.updateNgClass(e))),(0,Ze.b)(this.action.icon)?this.icon$$=this.action.icon.subscribe(e=>this.updateIcon(e)):this.updateIcon(this.action.icon),(0,Ze.b)(this.action.checkCondition)?this.checkCondition$$=this.action.checkCondition.subscribe(e=>this.updateCheckCondition(e)):this.updateCheckCondition(this.action.checkCondition),(0,Ze.b)(this.action.tooltip)?this.tooltip$$=this.action.tooltip.subscribe(e=>this.updateTooltip(e)):this.updateTooltip(this.action.tooltip),void 0!==this.action.availability&&(this.availability$$=this.action.availability(...e).subscribe(e=>this.disabled=!e)),this.disabled$$=this.disabled$.subscribe(e=>this.updateNgClass({"igo-actionbar-item-disabled":e})),void 0!==this.action.display&&(this.display$$=this.action.display(...e).subscribe(e=>this.noDisplay=!e)),this.noDisplay$$=this.noDisplay$.subscribe(e=>this.updateNgClass({"igo-actionbar-item-no-display":e}))}ngOnDestroy(){void 0!==this.ngClass$$&&(this.ngClass$$.unsubscribe(),this.ngClass$$=void 0),void 0!==this.availability$$&&(this.availability$$.unsubscribe(),this.availability$$=void 0),void 0!==this.display$$&&(this.display$$.unsubscribe(),this.display$$=void 0),void 0!==this.checkCondition$$&&(this.checkCondition$$.unsubscribe(),this.checkCondition$$=void 0),void 0!==this.icon$$&&(this.icon$$.unsubscribe(),this.icon$$=void 0),void 0!==this.tooltip$$&&(this.tooltip$$.unsubscribe(),this.tooltip$$=void 0),this.disabled$$.unsubscribe(),this.noDisplay$$.unsubscribe()}onClick(){!0!==this.disabled&&this.trigger.emit(this.action)}updateNgClass(e){this.ngClass$.next(Object.assign({},this.ngClass$.value,e))}updateTooltip(e){this.tooltip$.next(e)}updateCheckCondition(e){this.checkCondition$.next(e)}updateIcon(e){this.icon$.next(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-actionbar-item"]],inputs:{action:"action",color:"color",withTitle:"withTitle",withIcon:"withIcon",withTooltip:"withTooltip",disabled:"disabled",noDisplay:"noDisplay"},outputs:{trigger:"trigger"},decls:2,vars:2,consts:[["matTooltipClass","actionbarItemTooltip","matTooltipShowDelay","500",3,"matTooltip","ngClass","click",4,"ngIf"],["class","item-checkbox","matTooltipClass","actionbarItemTooltip","matTooltipShowDelay","500",3,"matTooltip","ngClass",4,"ngIf"],["matTooltipClass","actionbarItemTooltip","matTooltipShowDelay","500",3,"matTooltip","ngClass","click"],["mat-list-avatar","","mat-icon-button","",3,"color","disabled",4,"ngIf"],["matLine","",4,"ngIf"],["mat-list-avatar","","mat-icon-button","",3,"color","disabled"],[3,"svgIcon",4,"ngIf"],[3,"svgIcon"],["matLine",""],["matTooltipClass","actionbarItemTooltip","matTooltipShowDelay","500",1,"item-checkbox",3,"matTooltip","ngClass"],[3,"checked","change",4,"ngIf"],[3,"checked","change"]],template:function(e,t){1&e&&(r.YNc(0,fo,6,10,"mat-list-item",0),r.YNc(1,vo,5,9,"mat-list-item",1)),2&e&&(r.Q6J("ngIf",!t.action.checkbox),r.xp6(1),r.Q6J("ngIf",t.action.checkbox))},directives:[h.O5,l.Tg,p.gM,h.mk,n.lW,l.eA,a.Hw,Re.X2,m.oG],pipes:[j.X$,h.Ov],styles:["mat-list-item.igo-actionbar-item-disabled[_ngcontent-%COMP%]{color:#00000042;cursor:default!important}mat-list-item.igo-actionbar-item-no-display[_ngcontent-%COMP%]{display:none}mat-checkbox[_ngcontent-%COMP%]{padding:12px}.item-checkbox[_ngcontent-%COMP%]{height:56px}.item-checkbox[_ngcontent-%COMP%]     .mat-checkbox-label{margin-left:20px}"],changeDetection:0}),e})();function xo(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",5),r.TgZ(1,"button",6),r.NdJ("click",function(){return r.CHM(e),r.oxw(2).scrollUp()}),r.ALo(2,"translate"),r._UZ(3,"mat-icon",7),r.qZA(),r.qZA()}2&e&&(r.xp6(1),r.Q6J("matTooltip",r.lcZ(2,1,"igo.common.actionbar.scrollUp")))}function wo(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-actionbar-item",8),r.NdJ("trigger",function(){r.CHM(e);const t=r.oxw(2);return t.onTriggerAction(t.toggleCollapseAction)}),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("withTitle",!1)("withIcon",!0)("color",e.color)("disabled",e.store.view.empty)("action",e.toggleCollapseAction)}}function So(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-actionbar-item",11),r.NdJ("trigger",function(){const t=r.CHM(e).$implicit;return r.oxw(3).onTriggerAction(t)}),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(3);r.Q6J("withTitle",o.withTitle)("withIcon",o.withIcon)("withTooltip",o.withTooltip)("color",o.color)("disabled",o.store.state.get(e).disabled)("action",e)}}function Co(e,t){if(1&e&&(r.YNc(0,So,1,6,"ng-template",9,10,r.W1O),r.ALo(2,"async")),2&e){const e=r.oxw(2);r.Q6J("ngForOf",r.lcZ(2,1,e.store.view.all$()))}}function To(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",12),r.TgZ(1,"button",6),r.NdJ("click",function(){return r.CHM(e),r.oxw(2).scrollDown()}),r.ALo(2,"translate"),r._UZ(3,"mat-icon",13),r.qZA(),r.qZA()}2&e&&(r.xp6(1),r.Q6J("matTooltip",r.lcZ(2,1,"igo.common.actionbar.scrollDown")))}function Ao(e,t){if(1&e&&(r.TgZ(0,"mat-list"),r.YNc(1,xo,4,3,"div",2),r.YNc(2,wo,1,5,"igo-actionbar-item",3),r.YNc(3,Co,3,3,void 0,0),r.YNc(4,To,4,3,"div",4),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf",e.heightCondition&&e.positionConditionTop&&e.isDesktop),r.xp6(1),r.Q6J("ngIf",e.withToggleButton),r.xp6(1),r.Q6J("ngIf",!e.collapsed),r.xp6(1),r.Q6J("ngIf",e.heightCondition&&e.positionConditionLow&&e.isDesktop)}}function Lo(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-actionbar-item",18),r.NdJ("trigger",function(){const t=r.CHM(e).$implicit;return r.oxw(2).onTriggerAction(t)}),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(2);r.Q6J("withTitle",o.withTitle)("withIcon",o.withIcon)("color",o.color)("action",e)}}function Zo(e,t){if(1&e&&(r.TgZ(0,"div"),r.TgZ(1,"button",14),r.ALo(2,"translate"),r._UZ(3,"mat-icon",15),r.qZA(),r.TgZ(4,"mat-menu",16,17),r.TgZ(6,"mat-list"),r.YNc(7,Lo,1,4,"ng-template",9),r.ALo(8,"async"),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.MAs(5),t=r.oxw();r.xp6(1),r.Q6J("matTooltip",r.lcZ(2,10,"igo.common.actionbar.icon"))("matMenuTriggerFor",e)("disabled",t.store.view.empty)("color",t.iconColor),r.xp6(2),r.Q6J("svgIcon",t.icon),r.xp6(1),r.Tol(t.overlayClass),r.Q6J("xPosition",t.xPosition)("yPosition",t.yPosition),r.xp6(3),r.Q6J("ngForOf",r.lcZ(8,12,t.store.view.all$()))}}function Fo(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-actionbar-item",18),r.NdJ("trigger",function(){const t=r.CHM(e).$implicit;return r.oxw(2).onTriggerAction(t)}),r.qZA(),r._UZ(1,"br")}if(2&e){const e=t.$implicit,o=r.oxw(2);r.Q6J("withTitle",o.withTitle)("withIcon",o.withIcon)("color",o.color)("action",e)}}function Oo(e,t){if(1&e&&(r.TgZ(0,"mat-card",19),r.TgZ(1,"mat-list"),r.YNc(2,Fo,2,4,"ng-template",9),r.ALo(3,"async"),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(2),r.Q6J("ngForOf",r.lcZ(3,1,e.store.view.all$()))}}let Mo=(()=>{class e{constructor(e,t,o,i){this.overlay=e,this.elRef=t,this.cdRef=o,this.mediaService=i,this.actionbarMode=po,this.collapsed=!1,this.toggleCollapseAction={id:"actionbar_toggle",icon:"dots-vertical",handler:()=>{this.collapsed=!this.collapsed}},this.heightCondition$=new C.X(!1),this.positionConditionTop$=new C.X(!0),this.positionConditionLow$=new C.X(!0),this.mode=po.Dock,this.withToggleButton=!1,this.horizontal=!1,this.color="default",this.iconColor="default",this.withTitle=!0,this.withTooltip=!0,this.scrollActive=!0,this.withIcon=!0,this.icon="dots-horizontal",this.xPosition="before",this.yPosition="above",this._overlayClass=""}set overlayClass(e){this._overlayClass=e}get overlayClass(){return[this._overlayClass,"igo-actionbar-overlay"].join(" ")}get withTitleClass(){return this.withTitle}get withIconClass(){return this.withIcon}get horizontalClass(){return this.horizontal}get heightCondition(){const e=this.elRef.nativeElement;return!1===this.scrollActive&&e.clientHeight<e.scrollHeight}get positionConditionTop(){return 0!==this.elRef.nativeElement.scrollTop}get positionConditionLow(){const e=this.elRef.nativeElement;return!(e.scrollTop>=e.scrollHeight-e.clientHeight)}get isDesktop(){return this.mediaService.getMedia()===ye.Desktop}ngOnChanges(e){const t=e.store;t&&t.currentValue!==t.previousValue&&(void 0!==this.watcher&&this.watcher.destroy(),this.watcher=new ht(this.store,this.cdRef))}ngOnDestroy(){this.watcher.destroy()}onTriggerAction(e){e.handler(...e.args||[])}scrollDown(){this.elRef.nativeElement.scrollBy(0,52)}scrollUp(){this.elRef.nativeElement.scrollBy(0,-52)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Ge.aV),r.Y36(r.SBq),r.Y36(r.sBO),r.Y36(be))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-actionbar"]],hostVars:6,hostBindings:function(e,t){2&e&&r.ekj("with-title",t.withTitleClass)("with-icon",t.withIconClass)("horizontal",t.horizontalClass)},inputs:{store:"store",mode:"mode",withToggleButton:"withToggleButton",horizontal:"horizontal",color:"color",iconColor:"iconColor",withTitle:"withTitle",withTooltip:"withTooltip",scrollActive:"scrollActive",withIcon:"withIcon",icon:"icon",xPosition:"xPosition",yPosition:"yPosition",overlayClass:"overlayClass"},features:[r.TTD],decls:3,vars:3,consts:[[4,"ngIf"],["class","context-menu-card mat-elevation-z4",4,"ngIf"],["id","topChevron",4,"ngIf"],["color","accent",3,"withTitle","withIcon","color","disabled","action","trigger",4,"ngIf"],["id","lowChevron",4,"ngIf"],["id","topChevron"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","click"],["svgIcon","chevron-up"],["color","accent",3,"withTitle","withIcon","color","disabled","action","trigger"],["ngFor","",3,"ngForOf"],["buttonContent",""],["color","accent",3,"withTitle","withIcon","withTooltip","color","disabled","action","trigger"],["id","lowChevron"],["svgIcon","chevron-down"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",1,"buttonOverlay",3,"matTooltip","matMenuTriggerFor","disabled","color"],[3,"svgIcon"],["overlapTrigger","true",1,"igo-compact-menu","igo-no-min-width-menu",3,"xPosition","yPosition"],["actionbarMenu","matMenu"],["color","accent",3,"withTitle","withIcon","color","action","trigger"],[1,"context-menu-card","mat-elevation-z4"]],template:function(e,t){1&e&&(r.YNc(0,Ao,5,4,"mat-list",0),r.YNc(1,Zo,9,14,"div",0),r.YNc(2,Oo,4,3,"mat-card",1)),2&e&&(r.Q6J("ngIf",t.mode===t.actionbarMode.Dock),r.xp6(1),r.Q6J("ngIf",t.mode===t.actionbarMode.Overlay),r.xp6(1),r.Q6J("ngIf",t.mode===t.actionbarMode.Context))},directives:[h.O5,l.i$,n.lW,p.gM,a.Hw,bo,h.sg,f.p6,f.VK,g.a8],pipes:[j.X$,h.Ov],styles:["[_nghost-%COMP%]{display:block;height:100%;overflow:auto;position:relative}button[_ngcontent-%COMP%]{margin:4px}.buttonOverlay[_ngcontent-%COMP%]{margin:0}mat-list[_ngcontent-%COMP%]{padding-top:0}.horizontal[_nghost-%COMP%]{max-width:100%;overflow:unset}.horizontal[_nghost-%COMP%]   mat-list[_ngcontent-%COMP%]{width:auto;white-space:nowrap}.horizontal[_nghost-%COMP%]   igo-actionbar-item[_ngcontent-%COMP%]{display:inline-block}[_nghost-%COMP%]     .mat-list .mat-list-item .mat-list-text>*{white-space:normal;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;max-height:36px;line-height:18px;-webkit-box-orient:vertical;-webkit-line-clamp:2}[_nghost-%COMP%]     .mat-list-base .mat-list-item.mat-list-item-with-avatar{height:46px}[_nghost-%COMP%]     .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content{display:-webkit-flex;height:46px;padding:3px}[_nghost-%COMP%]     .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content>mat-icon{padding:8px}igo-actionbar-item[_ngcontent-%COMP%]     mat-list-item [mat-list-avatar]{height:auto;width:40px}igo-actionbar-item[_ngcontent-%COMP%]     mat-list-item:hover{cursor:pointer}.context-menu-card[_ngcontent-%COMP%]{padding:8px 3px;margin:10px}#topChevron[_ngcontent-%COMP%]{position:sticky;top:0;background-color:#fff;z-index:3}@media all and (-ms-high-contrast: none),(-ms-high-contrast: active){#topChevron[_ngcontent-%COMP%]{position:fixed;top:unset}}@supports (-ms-accelerator: true){#topChevron[_ngcontent-%COMP%]{position:fixed;top:unset}}#lowChevron[_ngcontent-%COMP%]{position:fixed;position:sticky;bottom:0;background-color:#fff;z-index:3}"],changeDetection:0}),e})(),Io=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,ne,n.ot,a.Ps,p.AV,f.Tx,l.ie,g.QW,m.p9]]}),e})(),ko=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[],imports:[[h.ez,Io],Io]}),e})(),Po=(()=>{class e{constructor(e,t){this.el=e,this.matIconRegistry=t,this.hidden=!1,this.disabled=!1,this.inverseColor=!1,this.inheritColor=!1}set igoMatBadgeIcon(e){this.matIconRegistry.getNamedSvgIcon(e).subscribe(e=>{this.svg=e,this.updateSvg()})}set matBadgeHidden(e){this.hidden=e,this.updateHidden()}set matBadgeDisabled(e){this.disabled=e,this.updateDisabled()}set igoMatBadgeInverseColor(e){this.inverseColor=e,this.updateColor()}set igoMatBadgeInheritColor(e){this.inheritColor=e,this.updateColor()}get badge(){return this.el.nativeElement.querySelector(".mat-badge-content")}ngOnInit(){this.badge.style.alignItems="center",this.badge.style.justifyContent="center",this.updateHidden(),this.updateColor(),this.updateSvg()}updateSvg(){!this.badge||(this.badge.innerHTML="",this.svg&&this.badge.appendChild(this.svg))}updateColor(){!this.badge||(this.inheritColor?this.inverseColor?(this.badge.style.color="currentColor",this.badge.style.background="none"):(this.badge.style.color="",this.badge.style.background="currentColor"):this.inverseColor?(this.badge.style.color=window.getComputedStyle(this.badge,null).getPropertyValue("background-color"),this.badge.style.background="none"):(this.badge.style.color="",this.badge.style.background=""),this.originalColor=this.badge.style.color,this.updateDisabled())}updateHidden(){!this.badge||(this.badge.style.display=this.hidden?"none":"flex")}updateDisabled(){!this.badge||!this.inverseColor||(this.disabled?(this.originalColor=this.badge.style.color,this.badge.style.color="#b9b9b9"):this.badge.style.color=this.originalColor)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.SBq),r.Y36(a.jv))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoMatBadgeIcon",""]],inputs:{igoMatBadgeIcon:"igoMatBadgeIcon",matBadgeHidden:"matBadgeHidden",matBadgeDisabled:"matBadgeDisabled",igoMatBadgeInverseColor:"igoMatBadgeInverseColor",igoMatBadgeInheritColor:"igoMatBadgeInheritColor"}}),e})(),_o=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[Ye.g,a.Ps],Ye.g]}),e})(),$o=(()=>{class e{constructor(e){this.el=e,this.clickout=new r.vpe}handleMouseClick(e,t){!t||this.el.nativeElement.contains(t)||this.clickout.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.SBq))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoClickout",""]],hostBindings:function(e,t){1&e&&r.NdJ("click",function(e){return t.handleMouseClick(e,e.target)},!1,r.evT)},outputs:{clickout:"clickout"}}),e})(),qo=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[]]}),e})(),Do=(()=>{class e{constructor(e,t){this.renderer=e,this.el=t,this._collapsed=!1,this.toggle=new r.vpe}get target(){return this._target}set target(e){this._target=e}get collapsed(){return this._collapsed}set collapsed(e){e?this.collapseTarget():this.expandTarget(),this._collapsed=e,this.toggle.emit(e)}click(){this.collapsed=!this.collapsed}collapseTarget(){this.renderer.addClass(this.target,"igo-collapsed"),this.renderer.addClass(this.el.nativeElement,"collapsed")}expandTarget(){this.renderer.removeClass(this.target,"igo-collapsed"),this.renderer.removeClass(this.el.nativeElement,"collapsed")}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.Qsj),r.Y36(r.SBq))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoCollapse",""]],hostBindings:function(e,t){1&e&&r.NdJ("click",function(){return t.click()})},inputs:{target:"target",collapsed:"collapsed"},outputs:{toggle:"toggle"}}),e})();const Eo=["*"];let Ro=(()=>{class e{constructor(){this._title="",this._collapsed=!1,this.toggle=new r.vpe}get title(){return this._title}set title(e){this._title=e}get collapsed(){return this._collapsed}set collapsed(e){this._collapsed=e,this.toggle.emit(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-collapsible"]],inputs:{title:"title",collapsed:"collapsed"},outputs:{toggle:"toggle"},ngContentSelectors:Eo,decls:7,vars:3,consts:[["svgIcon","chevron-up","mat-list-avatar","","igoCollapse","",1,"igo-chevron",3,"target","collapsed","toggle"],["matLine",""],["content",""]],template:function(e,t){if(1&e&&(r.F$t(),r.TgZ(0,"mat-list-item"),r.TgZ(1,"mat-icon",0),r.NdJ("toggle",function(e){return t.collapsed=e}),r.qZA(),r.TgZ(2,"h4",1),r._uU(3),r.qZA(),r.qZA(),r.TgZ(4,"div",null,2),r.Hsn(6),r.qZA()),2&e){const e=r.MAs(5);r.xp6(1),r.Q6J("target",e)("collapsed",t.collapsed),r.xp6(2),r.Oqu(t.title)}},directives:[l.Tg,a.Hw,l.eA,Do,Re.X2],styles:["[_nghost-%COMP%]     .mat-list .mat-list-item.mat-list-avatar{height:auto;width:auto;padding:0}mat-list-item[_ngcontent-%COMP%]{overflow:hidden}"]}),e})(),Uo=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[a.Ps,l.ie]]}),e})(),No=(()=>{class e{constructor(e){this.dialogRef=e}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ze.so))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-confirm-dialog"]],decls:12,vars:10,consts:[["mat-dialog-title","",1,"mat-typography"],["mat-dialog-content","",1,"mat-typography"],["mat-dialog-actions",""],["mat-button","","color","primary",3,"click"],["mat-button","",3,"click"]],template:function(e,t){1&e&&(r.TgZ(0,"h2",0),r._uU(1),r.ALo(2,"translate"),r.qZA(),r.TgZ(3,"div",1),r._uU(4),r.qZA(),r.TgZ(5,"div",2),r.TgZ(6,"button",3),r.NdJ("click",function(){return t.dialogRef.close(!0)}),r._uU(7),r.ALo(8,"translate"),r.qZA(),r.TgZ(9,"button",4),r.NdJ("click",function(){return t.dialogRef.close(!1)}),r._uU(10),r.ALo(11,"translate"),r.qZA(),r.qZA()),2&e&&(r.xp6(1),r.Oqu(r.lcZ(2,4,"igo.common.confirmDialog.title")),r.xp6(3),r.Oqu(t.confirmMessage),r.xp6(3),r.Oqu(r.lcZ(8,6,"igo.common.confirmDialog.confirmBtn")),r.xp6(3),r.Oqu(r.lcZ(11,8,"igo.common.confirmDialog.cancelBtn")))},directives:[ze.uh,ze.xY,ze.H8,n.lW],pipes:[j.X$],styles:["h2[_ngcontent-%COMP%]{margin:5px 0 10px}div[mat-dialog-content][_ngcontent-%COMP%]{max-width:200px}div[mat-dialog-actions][_ngcontent-%COMP%]{margin:10px 0 0}"]}),e})(),Jo=(()=>{class e{constructor(e){this.dialog=e}open(e){const t=this.dialog.open(No,{disableClose:!1});return t.componentInstance.confirmMessage=e,t.afterClosed()}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(ze.uw))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})(),Bo=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[Jo],imports:[[n.ot,ze.Is,ne]]}),e})(),jo=(()=>{class e{constructor(e,t,o){this.overlay=e,this.viewContainerRef=t,this.elementRef=o,this.isDragging=!1,this.touchDelayMs=500,this.menuPosition=new r.vpe;const i=(0,Z.R)(o.nativeElement,"touchstart"),s=(0,Z.R)(o.nativeElement,"touchmove"),n=(0,Z.R)(o.nativeElement,"touchend");s.subscribe(()=>{this.isDragging=!0,this.close()}),n.subscribe(()=>this.isDragging=!1);const a=i.pipe((0,Ie.b)(e=>{e.preventDefault(),window.document.body.style["-webkit-user-select"]="none"}),(0,ke.zg)(e=>(0,A.of)(e).pipe((0,Pe.g)(this.touchDelayMs),(0,_e.R)(n))));this.longTouch$$=a.pipe((0,Ie.b)(e=>{this.onContextMenu(e)}),(0,Pe.g)(2e3)).subscribe(()=>window.document.body.style["-webkit-user-select"]="auto")}ngOnDestroy(){this.longTouch$$&&this.longTouch$$.unsubscribe(),this.touchmove$$&&this.touchmove$$.unsubscribe(),this.touchend$$&&this.touchend$$.unsubscribe()}onContextMenu(e){if(this.isDragging)return;let t=0,o=0;if(e instanceof TouchEvent){if(e.touches.length>1)return;t=e.touches[0].clientX,o=e.touches[0].clientY}else t=e.x,o=e.y;this.close(),e.preventDefault(),this.menuPosition.emit({x:t,y:o}),this.overlayRef=null;const i=this.overlay.position().flexibleConnectedTo({x:t,y:o}).withPositions([{originX:"end",originY:"bottom",overlayX:"start",overlayY:"top"}]);this.overlayRef=this.overlay.create({positionStrategy:i,scrollStrategy:this.overlay.scrollStrategies.close()}),this.overlayRef.attach(new He.UE(this.menuContext,this.viewContainerRef,{$implicit:void 0})),this.sub=(0,Z.R)(document,"click").pipe((0,$e.h)(e=>{const t=e.target;return this.close(),!!this.overlayRef&&!this.overlayRef.overlayElement.contains(t)}),(0,qe.q)(1)).subscribe(()=>this.close()),this.sub=(0,Z.R)(document,"contextmenu").pipe((0,$e.h)(e=>{const t=e.target;if(t&&!this.elementRef.nativeElement.contains(t)&&!this.overlayRef.overlayElement.contains(t))return!0;e.preventDefault()}),(0,qe.q)(1)).subscribe(()=>this.close())}close(){this.overlayRef&&(this.overlayRef.dispose(),this.overlayRef=null),this.sub&&this.sub.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Ge.aV),r.Y36(r.s_b),r.Y36(r.SBq))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoContextMenu",""]],hostBindings:function(e,t){1&e&&r.NdJ("contextmenu",function(e){return t.onContextMenu(e)})},inputs:{menuContext:["igoContextMenu","menuContext"],touchDelayMs:"touchDelayMs"},outputs:{menuPosition:"menuPosition"}}),e})(),Qo=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[]]}),e})(),Go=(()=>{class e{static forRoot(){return{ngModule:e}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,a.Ps,p.AV,Ve.c,n.ot,ne]]}),e})(),Yo=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[]]}),e})();class zo{constructor(e){this.componentFactory=e,this.subscriptions=[],this.inputs={},this.inputs$$={},this.subscribers={}}setTarget(e){this.target=e,this.componentRef=e.createComponent(this.componentFactory),this.updateInputs(this.inputs),this.updateSubscribers(this.subscribers)}destroy(){void 0!==this.target&&this.target.clear(),void 0!==this.componentRef&&(this.componentRef.destroy(),this.componentRef=void 0),this.unobserveAllInputs(),this.unsubscribeAll()}updateInputs(e){if(this.inputs=e,void 0===this.componentRef)return;const t=this.componentRef.instance;this.componentFactory.inputs.forEach(o=>{const i=o.propName;this.unobserveInput(i);const r=e[i];e.hasOwnProperty(i)&&(r instanceof Le.y?this.observeInput(i,r):this.setInputValue(t,i,r))}),"function"==typeof t.onUpdateInputs&&t.onUpdateInputs()}setInputValue(e,t,o){if(o===e[t])return;const i=Object.getPrototypeOf(e),r=Object.getOwnPropertyDescriptor(i,t);void 0!==r&&void 0!==r.set?r.set.call(e,o):e[t]=o}updateSubscribers(e){if(this.subscribers=e,void 0===this.componentRef)return;const t=this.componentRef.instance;this.componentFactory.outputs.forEach(o=>{const i=o.propName;if(e.hasOwnProperty(i)){const o=t[i],r=e[i];Array.isArray(r)?r.forEach(e=>{this.subscriptions.push(o.subscribe(e))}):this.subscriptions.push(o.subscribe(r))}})}observeInput(e,t){this.inputs$$[e]=t.subscribe(t=>{const o=this.componentRef.instance;this.setInputValue(o,e,t),"function"==typeof o.onUpdateInputs&&o.onUpdateInputs()})}unobserveInput(e){void 0!==this.inputs$$[e]&&(this.inputs$$[e].unsubscribe(),this.inputs$$[e]=void 0)}unobserveAllInputs(){Object.values(this.inputs$$).forEach(e=>{void 0!==e&&e.unsubscribe()}),this.inputs$$={}}unsubscribeAll(){this.subscriptions.forEach(e=>e.unsubscribe()),this.subscriptions=[]}}let Ho=(()=>{class e{constructor(e){this.resolver=e}create(e){const t=this.resolver.resolveComponentFactory(e);return new zo(t)}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(r._Vd))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const Vo=["target"];function Wo(e,t){}let Xo=(()=>{class e{constructor(e,t){this.dynamicComponentService=e,this.cdRef=t,this.inputs={},this.subscribers={}}ngOnChanges(e){const t=e.component,o=e.inputs,i=e.subscribers,r=D.objectsAreEquivalent;if(t&&t.currentValue!==t.previousValue)this.createComponent(t.currentValue);else{const e=o&&r(o.currentValue||{},o.previousValue||{}),t=i&&r(i.currentValue||{},i.previousValue||{});!1===e&&this.updateInputs(),!1===t&&this.updateSubscribers()}this.cdRef.detectChanges()}ngOnDestroy(){this.dynamicComponent&&this.dynamicComponent.destroy()}createComponent(e){void 0!==this.dynamicComponent&&this.dynamicComponent.destroy(),this.dynamicComponent=e instanceof zo?e:this.dynamicComponentService.create(e),this.renderComponent()}renderComponent(){this.updateInputs(),this.updateSubscribers(),this.dynamicComponent.setTarget(this.target)}updateInputs(){this.dynamicComponent.updateInputs(this.inputs)}updateSubscribers(){this.dynamicComponent.updateSubscribers(this.subscribers)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Ho),r.Y36(r.sBO))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-dynamic-outlet"]],viewQuery:function(e,t){if(1&e&&r.Gf(Vo,7,r.s_b),2&e){let e;r.iGM(e=r.CRH())&&(t.target=e.first)}},inputs:{component:"component",inputs:"inputs",subscribers:"subscribers"},features:[r.TTD],decls:2,vars:0,consts:[["target",""]],template:function(e,t){1&e&&r.YNc(0,Wo,0,0,"ng-template",null,0,r.W1O)},styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}"],changeDetection:0}),e})(),Ko=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez]]}),e})(),ei=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[Ho],imports:[[h.ez,Ko],Ko]}),e})(),ti=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[]]}),e})();const oi=["buttons"],ii=["*",[["","formButtons",""]]],ri=function(e){return{"igo-form-body-with-buttons":e}},si=["*","[formButtons]"];let ni=(()=>{class e{constructor(){this.autocomplete="off",this.submitForm=new r.vpe}get hasButtons(){return 0!==this.buttons.nativeElement.children.length}ngOnChanges(e){const t=e.formData;t&&t.currentValue!==t.previousValue&&(void 0===t.currentValue?this.clear():this.setData(t.currentValue))}onSubmit(){this.submitForm.emit(this.getData())}getData(){const e={};return function(e){return e.groups.reduce((e,t)=>e.concat(t.fields),[].concat(e.fields))}(this.form).forEach(t=>{this.updateDataWithFormField(e,t)}),e}setData(e){this.form.fields.forEach(t=>{t.control.setValue((0,Te.ZP)(e,t.name).safeObject)}),this.form.groups.forEach(t=>{t.fields.forEach(t=>{t.control.setValue((0,Te.ZP)(e,t.name).safeObject)})})}updateDataWithFormField(e,t){const o=t.control;o.disabled||(e[t.name]=o.value)}clear(){this.form.control.reset()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-form"]],viewQuery:function(e,t){if(1&e&&r.Gf(oi,7),2&e){let e;r.iGM(e=r.CRH())&&(t.buttons=e.first)}},inputs:{form:"form",formData:"formData",autocomplete:"autocomplete"},outputs:{submitForm:"submitForm"},features:[r.TTD],ngContentSelectors:si,decls:7,vars:5,consts:[[3,"autocomplete","formGroup","ngSubmit"],[1,"igo-form-body",3,"ngClass"],[1,"igo-form-content"],[1,"igo-form-buttons"],["buttons",""]],template:function(e,t){1&e&&(r.F$t(ii),r.TgZ(0,"form",0),r.NdJ("ngSubmit",function(){return t.onSubmit()}),r.TgZ(1,"div",1),r.TgZ(2,"div",2),r.Hsn(3),r.qZA(),r.TgZ(4,"div",3,4),r.Hsn(6,1),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.Q6J("autocomplete",t.autocomplete)("formGroup",t.form.control),r.xp6(1),r.Q6J("ngClass",r.VKq(3,ri,t.hasButtons)))},directives:[We._Y,We.JL,We.sg,h.mk],styles:["[_nghost-%COMP%]{display:block}form[_ngcontent-%COMP%]{width:100%;height:100%}.igo-form-body[_ngcontent-%COMP%], .igo-form-content[_ngcontent-%COMP%]{height:100%}.igo-form-body-with-buttons[_ngcontent-%COMP%]   .igo-form-content[_ngcontent-%COMP%]{height:calc(100% - 56px)}.igo-form-content[_ngcontent-%COMP%]{display:flex}"],changeDetection:0}),e})(),ai=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,We.u5,We.UX],We.u5,We.UX]}),e})(),li=(()=>{class e{constructor(e){this.formBuilder=e}form(e,t){const o=this.formBuilder.group({});return e.forEach(e=>{o.addControl(e.name,e.control)}),t.forEach(e=>{o.addControl(e.name,e.control)}),{fields:e,groups:t,control:o}}group(e,t){const o=e.options||{},i=this.formBuilder.group({});t.forEach(e=>{i.addControl(e.name,e.control)});const r=this.getValidators(o.validator);return i.setValidators(r),Object.assign({},e,{fields:t,control:i})}field(e){const t=e.options||{},o=this.formBuilder.control({value:"",disabled:t.disabled}),i=this.getValidators(t.validator);return o.setValidators(i),Object.assign({type:"text"},e,{control:o})}extendFieldConfig(e,t){const o=Object.assign({},e.options||{},t.options||{}),i=Object.assign({},e.inputs||{},t.inputs||{}),r=Object.assign({},e.subscribers||{},t.subscribers||{});return Object.assign({},e,{options:o,inputs:i,subscribers:r})}getValidators(e){return Array.isArray(e)?e.map(e=>this.getValidator(e)):this.getValidator(e)}getValidator(e){if("string"!=typeof e)return e;const t=e.match(/^([a-zA-Z]{3,15})\((.{0,20})\)$/);return t?We.kI[t[1]](t[2]):We.kI[e]}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(We.qu))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),ci=(()=>{class e{constructor(){}static register(t,o){e.fields[t]=o}getFieldByType(t){return e.fields[t]}}return e.fields={},e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function ui(e,t){if(1&e&&(r.ynx(0),r._UZ(1,"igo-dynamic-outlet",1),r.BQk()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("component",e.getFieldComponent())("inputs",e.getFieldInputs())("subscribers",e.getFieldSubscribers())}}let pi=(()=>{class e{constructor(e){this.formFieldService=e,this.fieldInputs=void 0,this.fieldSubscribers=void 0}get fieldOptions(){return this.field.options||{}}getFieldComponent(){return this.formFieldService.getFieldByType(this.field.type||"text")}getFieldInputs(){if(void 0!==this.fieldInputs)return this.fieldInputs;const e=this.fieldOptions.errors||{};return this.fieldInputs=Object.assign({placeholder:this.field.title,disableSwitch:this.fieldOptions.disableSwitch||!1},Object.assign({},this.field.inputs||{}),{formControl:this.field.control,errors:Object.assign({},{required:"igo.common.form.errors.required"},e)}),this.fieldInputs}getFieldSubscribers(){return void 0!==this.fieldSubscribers||(this.fieldSubscribers=Object.assign({},this.field.subscribers||{})),this.fieldSubscribers}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ci))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-form-field"]],inputs:{field:"field"},decls:1,vars:1,consts:[[4,"ngIf"],[3,"component","inputs","subscribers"]],template:function(e,t){1&e&&r.YNc(0,ui,2,3,"ng-container",0),2&e&&r.Q6J("ngIf",void 0!==t.field)},directives:[h.O5,Xo],styles:["mat-form-field{width:100%}  .igo-form-disable-switch{margin-right:8px}"],changeDetection:0}),e})(),di=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,We.u5,We.UX,a.Ps,De.lN,Ve.c,Ee.LD,ne,Ko]]}),e})();function hi(e,t){if(1&e&&(r.TgZ(0,"div",5),r._UZ(1,"igo-form-field",6),r.qZA()),2&e){const e=t.$implicit,o=r.oxw(2);r.Q6J("ngClass",o.getFieldNgClass(e)),r.xp6(1),r.Q6J("field",e)}}function gi(e,t){if(1&e&&(r.TgZ(0,"div",3),r.YNc(1,hi,2,2,"div",4),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngForOf",e.group.fields)}}function mi(e,t){if(1&e&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Oqu(r.lcZ(2,1,e.getErrorMessage()))}}const fi=["*"];let yi=(()=>{class e{constructor(){}get formControl(){return this.group.control}getFieldColSpan(e){let t=2;const o=e.options||{};return o.cols&&o.cols>0&&(t=Math.min(o.cols,2)),t}getFieldNgClass(e){return{[`igo-form-field-colspan-${this.getFieldColSpan(e)}`]:!0}}getErrorMessage(){return function(e,t){const o=Object.keys(e.errors||{}).map(e=>t[e]).filter(e=>void 0!==e);return o.length>0?o[0]:""}(this.formControl,(this.group.options||{}).errors||{})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-form-group"]],inputs:{group:"group",errors:"errors"},ngContentSelectors:fi,decls:4,vars:2,consts:[["class","igo-form-group-fields",4,"ngIf"],[1,"igo-form-group-extra-content"],[4,"ngIf"],[1,"igo-form-group-fields"],["class","igo-form-field-wrapper",3,"ngClass",4,"ngFor","ngForOf"],[1,"igo-form-field-wrapper",3,"ngClass"],[3,"field"]],template:function(e,t){1&e&&(r.F$t(),r.YNc(0,gi,2,1,"div",0),r.TgZ(1,"div",1),r.Hsn(2),r.qZA(),r.YNc(3,mi,3,3,"mat-error",2)),2&e&&(r.Q6J("ngIf",t.group&&t.group.fields.length>0),r.xp6(3),r.Q6J("ngIf",t.formControl.errors))},directives:[h.O5,h.sg,h.mk,pi,De.TO],pipes:[j.X$],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:block;overflow:auto;padding:10px 5px}.igo-form-field-wrapper[_ngcontent-%COMP%]{display:inline-block;padding:0 5px}.igo-form-field-colspan-2[_ngcontent-%COMP%]{width:100%}.igo-form-field-colspan-1[_ngcontent-%COMP%]{width:50%}"],changeDetection:0}),e})(),vi=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,De.lN,ne,di]]}),e})(),bi=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[li,ci],imports:[[h.ez,vi,di],ai,vi,di]}),e})(),xi=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,We.u5,Ee.LD]]}),e})(),wi=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[]]}),e})(),Si=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[Be.TU]]}),e})(),Ci=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[]]}),e})(),Ti=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,Ue.p0,Ne.JX,a.Ps,n.ot,m.p9,Be.TU,wi,Go,Si,Ci,ne]]}),e})(),Ai=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez],xi,Ti,Si]}),e})(),Li=(()=>{class e{constructor(e,t){this.http=e,this.configService=t,this.jsonURL=this.getPathToConfigFile()}loadConfigTour(){this.getJSON().subscribe(e=>{this.allToursOptions=e},e=>{throw new Error("Problem with Interactive tour configuration file: interactiveTour.json not find. Check if the file and is path is set correctly.")})}getPathToConfigFile(){return this.configService.getConfig("interactiveTour.pathToConfigFile")||"./config/interactiveTour.json"}getJSON(){return this.http.get(this.jsonURL).pipe((0,b.K)(e=>{throw e.error.caught=!0,e}))}getTourOptionData(e){if(void 0===this.allToursOptions)return;let t=e;return t=t.replace(/\s/g,""),this.allToursOptions[t]}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(W))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})(),Zi=(()=>{class e{constructor(e,t,o,i,r){this.configService=e,this.mediaService=t,this.languageService=o,this.interactiveTourLoader=i,this.shepherdService=r,this.nextIndex=1,this.isAppHaveTour()&&this.interactiveTourLoader.loadConfigTour()}isAppHaveTour(){const e=this.configService.getConfig("interactiveTour.activateInteractiveTour");return void 0===e||e}isToolHaveTourConfig(e){return void 0!==this.interactiveTourLoader.getTourOptionData(e)}disabledTourButton(e){const t=this.interactiveTourLoader.getTourOptionData(e);if(null==t?void 0:t.conditions)for(const o of null==t?void 0:t.conditions)if(null===document.querySelector(o))return!0;return!1}isMobile(){return this.mediaService.isMobile()}isTourDisplayInMobile(){return void 0===this.configService.getConfig("interactiveTour.tourInMobile")||this.configService.getConfig("interactiveTour.tourInMobile")}getButtons(e){return"noBackButton"===e?[{classes:"shepherd-button-primary",text:this.languageService.translate.instant("igo.common.interactiveTour.nextButton"),type:"next"}]:"first"===e?[{classes:"shepherd-button-secondary",text:this.languageService.translate.instant("igo.common.interactiveTour.exitButton"),type:"cancel"},{classes:"shepherd-button-primary",text:this.languageService.translate.instant("igo.common.interactiveTour.nextButton"),type:"next"}]:"last"===e?[{classes:"shepherd-button-secondary",text:this.languageService.translate.instant("igo.common.interactiveTour.backButton"),type:"back"},{classes:"shepherd-button-primary",text:this.languageService.translate.instant("igo.common.interactiveTour.exitButton"),type:"cancel"}]:[{classes:"shepherd-button-secondary",text:this.languageService.translate.instant("igo.common.interactiveTour.backButton"),type:"back"},{classes:"shepherd-button-primary",text:this.languageService.translate.instant("igo.common.interactiveTour.nextButton"),type:"next"}]}getAction(e){return{click:"click"}[e.toLowerCase()]}addProgress(){const e=this;let t=0;const o=setInterval(()=>{if(e.getCurrentStep()){if(e.getCurrentStep().options.attachTo.element&&!document.querySelector(e.getCurrentStep().options.attachTo.element))return e.cancel(),void clearInterval(o);{const i=e.getCurrentStep().getElement();i&&i.querySelectorAll(".shepherd-content, .shepherd-text").forEach(e=>{e.classList.add("mat-typography")});const r=i?i.querySelector(".shepherd-header"):void 0;if(t++,(r||t>21)&&clearInterval(o),r){const t=e.steps,o=document.createElement("span");o.className="shepherd-progress",o.innerText=`${t.indexOf(e.getCurrentStep())+1}/${t.length}`,r.insertBefore(o,i.querySelector(".shepherd-cancel-icon"))}}}},100)}checkNext(e,t,o){if(t.getCurrentStep()){if(t.getCurrentStep().options.attachTo.element&&document.querySelector(t.getCurrentStep().options.attachTo.element))return void t.complete();if(e.index===t.steps.length-1)return void t.complete();t.steps.splice(e.index,1);const i=t.steps[e.index];i.options.attachTo.element&&!document.querySelector(i.options.attachTo.element)?o.checkNext(e,t,o):(t._setupModal(),t.show(i.id))}}executeAction(e,t){if(!t||t.condition&&("!"===t.condition.charAt(0)&&document.querySelector(t.condition.slice(1))||"!"!==t.condition.charAt(0)&&!document.querySelector(t.condition)))return;const o=document.querySelector(t.element||e.element),i=this.getAction(t.action);o&&i&&o[i]()}executeActionPromise(e,t){return new Promise(o=>{if(this.executeAction(e,t),!t||!t.waitFor)return void o();let i=0;const r=t.maxWait?t.maxWait/100:20,s=setInterval(()=>{i++,(i>r||document.querySelector(t.waitFor))&&(clearInterval(s),o())},100)})}getShepherdSteps(e){const t=[];let o=0;for(const i of e.steps)t.push({attachTo:{element:i.element,on:i.position||e.position},popperOptions:{modifiers:[{name:"offset",options:{offset:[0,15]}}]},beforeShowPromise:()=>Promise.all([this.executeActionPromise(this.previousStep,this.previousStep?this.previousStep.beforeChange:void 0),this.executeActionPromise(i,i.beforeShow)]),buttons:this.getButtons(0===o?"first":o+1===e.steps.length?"last":e.steps[o].noBackButton?"noBackButton":void 0),classes:i.class,highlightClass:i.highlightClass,scrollTo:i.scrollToElement||e.scrollToElement||!0,canClickTarget:i.disableInteraction?!i.disableInteraction:void 0,title:this.languageService.translate.instant(i.title||e.title),text:[this.languageService.translate.instant(i.text)],when:{show:()=>{this.executeAction(i,i.onShow)},hide:()=>{this.previousStep=i,this.executeAction(i,i.onHide)}}}),o++;return t}startTour(e){const t=this.interactiveTourLoader.getTourOptionData(e);this.shepherdService.defaultStepOptions={classes:t.class,highlightClass:t.highlightClass,canClickTarget:!t.disableInteraction||!t.disableInteraction,cancelIcon:{enabled:!0}};const o=this.getShepherdSteps(t);this.shepherdService.modal=!0,this.shepherdService.confirmCancel=!1,this.shepherdService.addSteps(o),this.shepherdService.tourObject.on("show",this.addProgress),this.shepherdService.tourObject.on("cancel",e=>{this.checkNext(e,this.shepherdService.tourObject,this)}),this.shepherdService.start()}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(W),r.LFG(be),r.LFG(ue),r.LFG(Li),r.LFG(Xe.a))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class Fi{constructor(e={}){this.options=e,this.activeTool$=new C.X(void 0),this.toolbar$=new C.X([]),this.activeToolHistory=[],this.store=new dt([],{getKey:e=>e.name}),this.setToolbar(e.toolbar),this.initStore()}get tools$(){return this.store.entities$}destroy(){this.activeTool$$.unsubscribe(),this.store.destroy()}getTool(e){return this.store.get(e)}getTools(){return this.store.all()}setTools(e){this.store.load(e)}getToolbar(){return this.toolbar$.getValue()}setToolbar(e){this.toolbar$.next(e||[])}activateTool(e,t={}){const o=this.getTool(e);void 0!==o&&this.store.state.update(o,{active:!0,options:t},!0)}activatePreviousTool(){if(this.activeToolHistory.length<=1)return void this.deactivateTool();const[e,t]=this.activeToolHistory.splice(-2,2);this.activateTool(e)}deactivateTool(){this.clearActiveToolHistory(),this.store.state.updateAll({active:!1})}initStore(){this.store=new dt([],{getKey:e=>e.name}),this.activeTool$$=this.store.stateView.firstBy$(e=>!0===e.state.active).subscribe(e=>{if(void 0===e)return void this.setActiveTool(void 0);const t=e.entity,o=Object.assign({},t.options||{},e.state.options||{});this.setActiveTool(Object.assign({},t,{options:o}))})}setActiveTool(e){this.activeTool$.next(e),void 0===e?this.clearActiveToolHistory():this.activeToolHistory=this.activeToolHistory.filter(t=>t!==e.name).concat([e.name])}clearActiveToolHistory(){this.activeToolHistory=[]}}let Oi=(()=>{class e{constructor(){this.toolbox=new Fi,this.toolbox.setTools(this.getTools())}static register(t){e.tools[t.name]=t}getTool(t){return e.tools[t]}getTools(){return Object.values(e.tools)}}return e.tools={},e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Mi(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",1),r.NdJ("click",function(){return r.CHM(e),r.oxw().startInteractiveTour()}),r.TgZ(1,"span",2),r._uU(2),r.ALo(3,"translate"),r.ALo(4,"translate"),r.ALo(5,"async"),r.qZA(),r._UZ(6,"mat-icon",3),r.ALo(7,"translate"),r.ALo(8,"translate"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("ngClass",e.getClass())("disabled",e.disabledTourButton),r.xp6(2),r.AsE("",r.lcZ(3,5,"igo.common.interactiveTour.buttonTitle")," ",r.lcZ(4,7,r.lcZ(5,9,e.discoverTitleInLocale$)),""),r.xp6(4),r.Q6J("matTooltip",e.disabledTourButton?r.lcZ(7,11,"igo.common.interactiveTour.disaledTooltipTourToolButton"):r.lcZ(8,13,"igo.common.interactiveTour.tooltipTourToolButton"))}}let Ii=(()=>{class e{constructor(e,t){this.interactiveTourService=e,this.toolService=t,this.tourToStart="",this.discoverTitleInLocale$=(0,A.of)("IGO")}getClass(){return{"tour-button-tool-icon":"icon"===this.styleButton,"tour-button-tool":"raised"===this.styleButton}}get toolbox(){return this.toolService.toolbox}getTourToStart(){return this.tourToStart?this.tourToStart:this.activeToolName}get activeToolName(){if(this.toolbox)return this.isActiveTool?this.toolbox.activeTool$.getValue().name:"global"}get isActiveTool(){if(this.toolbox)return void 0!==this.toolbox.activeTool$.getValue()}get isToolHaveTour(){return!("about"===this.activeToolName&&!this.tourToStart)&&this.interactiveTourService.isToolHaveTourConfig(this.getTourToStart())}get showTourButton(){let e,t;return e=this.isToolHaveTour,!1!==e&&!(this.interactiveTourService.isMobile()&&(t=this.isTourDisplayInMobile,!1===t))}get isTourDisplayInMobile(){return this.interactiveTourService.isTourDisplayInMobile()}get disabledTourButton(){return this.interactiveTourService.disabledTourButton(this.activeToolName)}startInteractiveTour(){const e=this.getTourToStart();e&&this.interactiveTourService.startTour(e)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Zi),r.Y36(Oi))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-interactive-tour"]],inputs:{tourToStart:"tourToStart",styleButton:"styleButton",discoverTitleInLocale$:"discoverTitleInLocale$"},decls:1,vars:1,consts:[["mat-raised-button","","tooltip-position","below","matTooltipShowDelay","500",3,"ngClass","disabled","click",4,"ngIf"],["mat-raised-button","","tooltip-position","below","matTooltipShowDelay","500",3,"ngClass","disabled","click"],[1,"interactive-tour-button-title"],["svgIcon","presentation-play",3,"matTooltip"]],template:function(e,t){1&e&&r.YNc(0,Mi,9,15,"button",0),2&e&&r.Q6J("ngIf",t.showTourButton)},directives:[h.O5,n.lW,h.mk,a.Hw,p.gM],pipes:[j.X$,h.Ov],styles:[".shepherd-has-title .shepherd-content .shepherd-header{padding:.5em .75em}.shepherd-title{margin:0!important;font-weight:revert!important}.shepherd-progress{margin-right:15px;color:#737373}.shepherd-text{font-size:14px!important}.shepherd-element{border:1px solid;border-color:#474747;box-shadow:4px 5px #65656599}\n"],encapsulation:2}),e})(),ki=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[Zi,Li],imports:[[h.ez,a.Ps,n.ot,p.AV,ne]]}),e})(),Pi=(()=>{class e{transform(e,t){const o=[];return Object.getOwnPropertyNames(e).forEach(t=>o.push({key:t,value:e[t]})),o}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=r.Yjl({name:"keyvalue",type:e,pure:!0}),e})(),_i=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[]]}),e})(),$i=(()=>{class e{constructor(e,t){this.renderer=e,this.el=t,this._color="primary",this._focused=!1,this._selected=!1,this._disabled=!1,this.beforeSelect=new r.vpe,this.beforeFocus=new r.vpe,this.beforeUnselect=new r.vpe,this.beforeUnfocus=new r.vpe,this.beforeDisable=new r.vpe,this.beforeEnable=new r.vpe,this.focus=new r.vpe,this.unfocus=new r.vpe,this.select=new r.vpe,this.unselect=new r.vpe,this.disable=new r.vpe,this.enable=new r.vpe}get color(){return this._color}set color(e){this._color=e}get focused(){return this._focused}set focused(e){e!==this._focused&&(this.disabled||(e?this.beforeFocus.emit(this):this.beforeUnfocus.emit(this),this._focused=e,!0!==this.selected&&this.toggleFocusedClass(),e?this.focus.emit(this):this.unfocus.emit(this)))}get selected(){return this._selected}set selected(e){e!==this._selected&&(this.disabled||(e?this.beforeSelect.emit(this):this.beforeUnselect.emit(this),this._selected=e,this._focused=e,this.toggleSelectedClass(),e?this.select.emit(this):this.unselect.emit(this)))}get disabled(){return this._disabled}set disabled(e){e!==this._disabled&&(!0===e&&(this.selected=!1),e?this.beforeDisable.emit(this):this.beforeEnable.emit(this),this._disabled=e,this.toggleDisabledClass(),e?this.disable.emit(this):this.enable.emit(this))}onClick(){this.selected=!0}getOffsetTop(){return this.el.nativeElement.offsetTop-5}toggleFocusedClass(){this.focused?this.addCls(e.focusedCls):this.removeCls(e.focusedCls)}toggleSelectedClass(){this.selected?(this.addCls(e.selectedCls),this.removeCls(e.focusedCls)):this.removeCls(e.selectedCls)}toggleDisabledClass(){this.disabled?this.addCls(e.disabledCls):this.removeCls(e.disabledCls)}addCls(e){this.renderer.addClass(this.el.nativeElement,e)}removeCls(e){this.renderer.removeClass(this.el.nativeElement,e)}}return e.focusedCls="igo-list-item-focused",e.selectedCls="igo-list-item-selected",e.disabledCls="igo-list-item-disabled",e.\u0275fac=function(t){return new(t||e)(r.Y36(r.Qsj),r.Y36(r.SBq))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoListItem",""]],hostBindings:function(e,t){1&e&&r.NdJ("click",function(){return t.onClick()})},inputs:{color:"color",focused:"focused",selected:"selected",disabled:"disabled"},outputs:{beforeSelect:"beforeSelect",beforeFocus:"beforeFocus",beforeUnselect:"beforeUnselect",beforeUnfocus:"beforeUnfocus",beforeDisable:"beforeDisable",beforeEnable:"beforeEnable",focus:"focus",unfocus:"unfocus",select:"select",unselect:"unselect",disable:"disable",enable:"enable"}}),e})();const qi=function(e){return{selectable:e}},Di=["*"];let Ei=(()=>{class e{constructor(e){this.el=e,this._navigation=!0,this._selection=!0,this.subscriptions=[]}get navigation(){return this._navigation}set navigation(e){this._navigation=e}get selection(){return this._selection}set selection(e){this._selection=e}get selectedItem(){return this._selectedItem}set selectedItem(e){this.focusedItem=e,this._selectedItem=e}get focusedItem(){return this._focusedItem}set focusedItem(e){this._focusedItem=e}handleKeyboardEvent(e){this.navigationEnabled&&("ArrowUp"===e.key||"ArrowDown"===e.key?(e.preventDefault(),this.navigate(e.key)):"Enter"===e.key&&this.select(this.focusedItem))}ngOnInit(){this.enableNavigation()}ngAfterViewInit(){this.listItems.length&&this.init(),this.listItems$$=this.listItems.changes.subscribe(e=>this.init())}ngOnDestroy(){this.listItems$$.unsubscribe()}focus(e){!this.selection||(this.unfocus(),void 0!==e&&(e.focused=!0))}unfocus(){void 0!==this.focusedItem&&(this.focusedItem.focused=!1),this.focusedItem=void 0}focusNext(){const e=this.listItems.toArray();let t;const o=this.el.nativeElement;let i=!0,r=this.getFocusedIndex();for(void 0===r&&(r=-1);i&&r<e.length-1;)r+=1,t=e[r],i=t.disabled;void 0!==t&&this.focus(t),e[r+1]?void 0!==t&&!this.isScrolledIntoView(t.el.nativeElement)&&(o.scrollTop=t.el.nativeElement.offsetTop+t.el.nativeElement.children[0].offsetHeight-o.clientHeight):o.scrollTop=o.scrollHeight-o.clientHeight}focusPrevious(){const e=this.listItems.toArray();let t;const o=this.el.nativeElement;let i=!0,r=this.getFocusedIndex();for(;i&&r>0;)r-=1,t=e[r],i=t.disabled;void 0!==t&&this.focus(t),e[r-1]?void 0===t||this.isScrolledIntoView(t.el.nativeElement)||(o.scrollTop=t.el.nativeElement.offsetTop-3):o.scrollTop=0}select(e){!this.selection||(this.unselect(),void 0!==e&&(e.selected=!0))}unselect(){this.unfocus(),void 0!==this.selectedItem&&(this.selectedItem.selected=!1),this.selectedItem=void 0}enableNavigation(){this.navigation&&(this.navigationEnabled=!0)}disableNavigation(){this.navigationEnabled=!1}scrollToItem(e){this.el.nativeElement.scrollTop=e.getOffsetTop()}isScrolledIntoView(e){const t=this.el.nativeElement.scrollTop+this.el.nativeElement.offsetTop,o=e.offsetTop;return o+e.children[0].offsetHeight<=t+this.el.nativeElement.clientHeight&&o>=t}init(){this.subscribe(),this.selectedItem=this.findSelectedItem(),this.focusedItem=this.findFocusedItem(),this.enableNavigation()}subscribe(){this.unsubscribe(),this.listItems.toArray().forEach(e=>{this.subscriptions.push(e.beforeSelect.subscribe(e=>this.handleItemBeforeSelect(e))),this.subscriptions.push(e.select.subscribe(e=>this.handleItemSelect(e))),this.subscriptions.push(e.beforeFocus.subscribe(e=>this.handleItemBeforeFocus(e))),this.subscriptions.push(e.focus.subscribe(e=>this.handleItemFocus(e)))},this)}unsubscribe(){this.subscriptions.forEach(e=>e.unsubscribe()),this.subscriptions=[]}handleItemBeforeFocus(e){e!==this.focusedItem&&this.unfocus()}handleItemFocus(e){this.focusedItem=e}handleItemBeforeSelect(e){e!==this.focusedItem&&this.unselect()}handleItemSelect(e){this.selectedItem=e}findSelectedItem(){return this.listItems.toArray().find(e=>e.selected)}findFocusedItem(){return this.listItems.toArray().find(e=>e.focused)}getFocusedIndex(){return this.listItems.toArray().findIndex(e=>e===this.focusedItem)}navigate(e){switch(e){case"ArrowUp":this.focusPrevious();break;case"ArrowDown":this.focusNext()}}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.SBq))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-list"]],contentQueries:function(e,t,o){if(1&e&&r.Suo(o,$i,5),2&e){let e;r.iGM(e=r.CRH())&&(t.listItems=e)}},hostBindings:function(e,t){1&e&&r.NdJ("keydown",function(e){return t.handleKeyboardEvent(e)},!1,r.evT)("enter",function(e){return t.handleKeyboardEvent(e)},!1,r.evT)},inputs:{navigation:"navigation",selection:"selection"},ngContentSelectors:Di,decls:2,vars:3,consts:[["igoClickout","",3,"ngClass","clickout","click"]],template:function(e,t){1&e&&(r.F$t(),r.TgZ(0,"mat-list",0),r.NdJ("clickout",function(){return t.disableNavigation()})("click",function(){return t.enableNavigation()}),r.Hsn(1),r.qZA()),2&e&&r.Q6J("ngClass",r.VKq(1,qi,t.selection))},directives:[l.i$,$o,h.mk],styles:["[_nghost-%COMP%]{display:block;height:100%;overflow:auto;position:relative}mat-list[_ngcontent-%COMP%]{padding-top:0}[_nghost-%COMP%]{position:static}[_nghost-%COMP%]     .mat-list .mat-list-item .mat-list-text>*{white-space:normal;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;max-height:36px;line-height:18px;-webkit-box-orient:vertical;-webkit-line-clamp:2}[_nghost-%COMP%]     .mat-list .mat-list-item.mat-list-item-avatar .mat-list-item-content{display:-webkit-flex;height:46px;padding:3px}[_nghost-%COMP%]     .mat-list .mat-list-item.mat-list-item-avatar{height:46px}[_nghost-%COMP%]     .mat-list   igo-collapsible>.mat-list-item>.mat-list-item-content>.mat-list-text>.mat-line{font-weight:bold;opacity:.9}[_nghost-%COMP%]     .mat-list .mat-list-item.mat-list-item-avatar .mat-list-item-content>mat-icon{padding:8px}[_nghost-%COMP%]     [igolistitem] mat-list-item [mat-list-avatar]{height:auto;width:40px}[_nghost-%COMP%]   mat-list.selectable[_ngcontent-%COMP%]     [igolistitem]:not(.igo-list-item-disabled) mat-list-item:hover{cursor:pointer}[_nghost-%COMP%]     [igolistitem]:focus{outline:none}"]}),e})(),Ri=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,a.Ps,l.ie,qo]]}),e})();function Ui(e,t){if(1&e&&(r.TgZ(0,"div",2),r.TgZ(1,"h3"),r.Hsn(2,1),r.TgZ(3,"div",3),r._uU(4),r.Hsn(5,2),r.qZA(),r.Hsn(6,3),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(4),r.hij(" ",e.title," ")}}const Ni=["*",[["","panelLeftButton",""]],[["","panelHeader",""]],[["","panelRightButton",""]]],Ji=["*","[panelLeftButton]","[panelHeader]","[panelRightButton]"];let Bi=(()=>{class e{constructor(){this._withHeader=!0}get title(){return this._title}set title(e){this._title=e}get withHeader(){return this._withHeader}set withHeader(e){this._withHeader=e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-panel"]],hostVars:2,hostBindings:function(e,t){2&e&&r.ekj("igo-panel-with-header",t.withHeader)},inputs:{title:"title",withHeader:"withHeader"},ngContentSelectors:Ji,decls:3,vars:1,consts:[["class","igo-panel-header mat-typography","title","",4,"ngIf"],["title","",1,"igo-panel-content"],["title","",1,"igo-panel-header","mat-typography"],[1,"igo-panel-title"]],template:function(e,t){1&e&&(r.F$t(Ni),r.YNc(0,Ui,7,1,"div",0),r.TgZ(1,"div",1),r.Hsn(2),r.qZA()),2&e&&r.Q6J("ngIf",t.withHeader)},directives:[h.O5],styles:["[_nghost-%COMP%]{display:block}.igo-panel-header[_ngcontent-%COMP%]{height:46px;padding:3px;text-align:center}.igo-panel-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;height:40px}.igo-panel-header[_ngcontent-%COMP%]     [panelleftbutton]{float:left;margin-right:-40px}.igo-panel-header[_ngcontent-%COMP%]     [panelrightbutton]{float:right}.igo-panel-content[_ngcontent-%COMP%]{overflow:auto}.igo-panel-with-header[_nghost-%COMP%]   .igo-panel-content[_ngcontent-%COMP%]{height:calc(100% - 46px)}[_nghost-%COMP%]:not(.igo-panel-with-header)   .igo-panel-content[_ngcontent-%COMP%]{height:100%}.igo-panel-title[_ngcontent-%COMP%]{display:block;width:calc(100% - 80px);margin-left:40px;height:100%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;line-height:40px;float:left;font-weight:bold;font-size:1.17em}"],changeDetection:0}),e})(),ji=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez]]}),e})();const Qi=function(e){return{"igo-spinner-container":!0,"igo-spinner-shown":e}};let Gi=(()=>{class e{constructor(){this.shown$=new C.X(!1)}set shown(e){this.shown$.next(e)}get shown(){return this.shown$.value}show(){this.shown=!0}hide(){this.shown=!1}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-spinner"]],inputs:{shown:"shown"},decls:4,vars:5,consts:[[3,"ngClass"],[1,"igo-spinner-background"],["diameter","40","mode","indeterminate"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.ALo(1,"async"),r._UZ(2,"div",1),r._UZ(3,"mat-progress-spinner",2),r.qZA()),2&e&&r.Q6J("ngClass",r.VKq(3,Qi,r.lcZ(1,1,t.shown$)))},directives:[h.mk,Ke.Ou],pipes:[h.Ov],styles:[".igo-spinner-container[_ngcontent-%COMP%]{display:none;pointer-events:none}.igo-spinner-container.igo-spinner-shown[_ngcontent-%COMP%]{display:block}mat-progress-spinner[_ngcontent-%COMP%]{height:40px;width:40px;border-radius:50%}.igo-spinner-background[_ngcontent-%COMP%]{height:36px;width:36px;border-radius:50%;border:4px solid #ffffff;position:absolute;top:2px;left:2px}"]}),e})(),Yi=(()=>{class e{constructor(e,t){this.spinner=e,this.activityService=t}ngOnInit(){this.counter$$=this.activityService.counter$.pipe((0,w.b)(50)).subscribe(e=>{e>0?this.spinner.show():this.spinner.hide()})}ngOnDestroy(){this.counter$$.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Gi,2),r.Y36(Y))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoSpinnerActivity",""]]}),e})(),zi=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,Ke.Cq]]}),e})();class Hi extends tt.o2{constructor(e,t,o){super(),this._database=e,this._model=t,this._sort=o,this._filterChange=new C.X("")}get filter(){return this._filterChange.value}set filter(e){this._filterChange.next(e)}connect(){return this._database?(0,Fe.T)(this._database.dataChange,this._filterChange,this._sort.sortChange).pipe((0,x.U)(()=>this.getFilteredData(this._database.data)),(0,x.U)(e=>this.getSortedData(e))):(0,Fe.T)([])}disconnect(){}getFilteredData(e){return this.filter?e.slice().filter(e=>-1!==this._model.columns.filter(e=>e.filterable).map(t=>D.resolve(e,t.name)).join(" ").toLowerCase().indexOf(this.filter.toLowerCase())):e}getSortedData(e){return this._sort.active&&""!==this._sort.direction?e.sort((e,t)=>{const o=D.resolve(e,this._sort.active),i=D.resolve(t,this._sort.active);return D.naturalCompare(i,o,this._sort.direction)}):e}}var Vi=(()=>{return(e=Vi||(Vi={}))[e.primary=0]="primary",e[e.accent=1]="accent",e[e.warn=2]="warn",Vi;var e})();const Wi=["filter"];function Xi(e,t){1&e&&(r.TgZ(0,"div",12),r.TgZ(1,"mat-form-field",13),r._UZ(2,"input",14,15),r.ALo(4,"translate"),r.qZA(),r.qZA()),2&e&&(r.xp6(2),r.Q6J("placeholder",r.lcZ(4,1,"igo.common.table.filter")))}function Ki(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"th",16),r.TgZ(1,"mat-checkbox",17),r.NdJ("change",function(t){r.CHM(e);const o=r.oxw();return t?o.masterToggle():null}),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(1),r.Q6J("checked",e.selection.hasValue()&&e.isAllSelected())("indeterminate",e.selection.hasValue()&&!e.isAllSelected())}}function er(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"td",18),r.TgZ(1,"mat-checkbox",19),r.NdJ("click",function(e){return e.stopPropagation()})("change",function(t){const o=r.CHM(e).$implicit,i=r.oxw();return t?i.selection.toggle(o):null}),r.qZA(),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw();r.xp6(1),r.Q6J("checked",o.selection.isSelected(e))}}function tr(e,t){if(1&e&&(r.TgZ(0,"th",25),r._uU(1),r.qZA()),2&e){const e=r.oxw(2).$implicit;r.xp6(1),r.hij(" ",e.title," ")}}function or(e,t){1&e&&(r.ynx(0),r.YNc(1,tr,2,1,"th",24),r.BQk())}function ir(e,t){if(1&e&&(r.TgZ(0,"th",16),r._uU(1),r.qZA()),2&e){const e=r.oxw(2).$implicit;r.xp6(1),r.hij(" ",e.title," ")}}function rr(e,t){1&e&&(r.ynx(0),r.YNc(1,ir,2,1,"th",6),r.BQk())}const sr=function(){return{}};function nr(e,t){if(1&e&&(r.TgZ(0,"td",27),r._uU(1),r.qZA()),2&e){const e=t.$implicit,o=r.oxw(2).$implicit,i=r.oxw();r.Q6J("ngClass",i.model.cellClassFunc?i.model.cellClassFunc(e,o):r.DdM(2,sr)),r.xp6(1),r.hij(" ",i.getValue(e,o.name)," ")}}function ar(e,t){1&e&&(r.ynx(0),r.YNc(1,nr,2,3,"td",26),r.BQk())}function lr(e,t){if(1&e&&r._UZ(0,"td",29),2&e){const e=t.$implicit,o=r.oxw(2).$implicit,i=r.oxw();r.Q6J("ngClass",i.model.cellClassFunc?i.model.cellClassFunc(e,o):r.DdM(2,sr))("innerHTML",i.getValue(e,o.name),r.oJD)}}function cr(e,t){1&e&&r.YNc(0,lr,1,3,"td",28)}function ur(e,t){if(1&e&&(r.ynx(0,20),r.YNc(1,or,2,0,"ng-container",21),r.YNc(2,rr,2,0,"ng-container",21),r.YNc(3,ar,2,0,"ng-container",22),r.YNc(4,cr,1,0,"ng-template",null,23,r.W1O),r.BQk()),2&e){const e=t.$implicit,o=r.MAs(5);r.Q6J("matColumnDef",e.name),r.xp6(1),r.Q6J("ngIf",e.sortable),r.xp6(1),r.Q6J("ngIf",!e.sortable),r.xp6(1),r.Q6J("ngIf",!e.html)("ngIfElse",o)}}function pr(e,t){1&e&&r._UZ(0,"th",16)}function dr(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",31),r.NdJ("click",function(t){const o=r.CHM(e).$implicit,i=r.oxw().$implicit;return r.oxw().handleClickAction(t,o,i)}),r._UZ(1,"mat-icon",32),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(2);r.Q6J("color",o.getActionColor(e.color)),r.xp6(1),r.s9C("svgIcon",e.icon)}}function hr(e,t){if(1&e&&(r.TgZ(0,"td",18),r.YNc(1,dr,2,2,"button",30),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngForOf",e.model.actions)}}function gr(e,t){1&e&&r._UZ(0,"tr",33)}function mr(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"tr",34),r.NdJ("click",function(){const t=r.CHM(e).$implicit;return r.oxw().selection.toggle(t)}),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw();r.Q6J("ngClass",o.model.rowClassFunc?o.model.rowClassFunc(e):r.DdM(1,sr))}}let fr=(()=>{class e{constructor(){this._hasFIlterInput=!0,this.selection=new tt.Ov(!0,[]),this.select=new r.vpe}get database(){return this._database}set database(e){this._database=e}get model(){return this._model}set model(e){this._model=e}get hasFilterInput(){return this._hasFIlterInput}set hasFilterInput(e){this._hasFIlterInput=e}ngOnInit(){this.dataSource=new Hi(this.database,this.model,this.sort),this.model&&(this.displayedColumns=this.model.columns.filter(e=>!1!==e.displayed).map(e=>e.name),this.model.selectionCheckbox&&this.displayedColumns.unshift("selectionCheckbox"),this.model.actions&&this.model.actions.length&&this.displayedColumns.push("action")),this.selection.changed.subscribe(e=>this.select.emit(e))}ngAfterViewInit(){this.filter&&(0,Z.R)(this.filter.nativeElement,"keyup").pipe((0,w.b)(150),(0,M.x)()).subscribe(()=>{!this.dataSource||(this.dataSource.filter=this.filter.nativeElement.value)})}ngOnChanges(e){e.database&&(this.dataSource=new Hi(this.database,this.model,this.sort),this.selection.clear())}getActionColor(e){return Vi[e]}getValue(e,t){return D.resolve(e,t)}isAllSelected(){return this.selection.selected.length===this.database.data.length}masterToggle(){this.isAllSelected()?this.selection.clear():this.database.data.forEach(e=>this.selection.select(e))}handleClickAction(e,t,o){e.stopPropagation(),t.click(o)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-table"]],viewQuery:function(e,t){if(1&e&&(r.Gf(Wi,5),r.Gf(Ne.YE,7)),2&e){let e;r.iGM(e=r.CRH())&&(t.filter=e.first),r.iGM(e=r.CRH())&&(t.sort=e.first)}},inputs:{database:"database",model:"model",hasFilterInput:"hasFilterInput"},outputs:{select:"select"},features:[r.TTD],decls:14,vars:5,consts:[[1,"table-box"],["class","table-header",4,"ngIf"],[1,"table-container"],["mat-table","","matSort","",3,"dataSource"],["table",""],["matColumnDef","selectionCheckbox"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"ngClass","click",4,"matRowDef","matRowDefColumns"],[1,"table-header"],["floatPlaceholder","never"],["matInput","",3,"placeholder"],["filter",""],["mat-header-cell",""],[3,"checked","indeterminate","change"],["mat-cell",""],[3,"checked","click","change"],[3,"matColumnDef"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["cellHTML",""],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell","","class","mat-cell-text",3,"ngClass",4,"matCellDef"],["mat-cell","",1,"mat-cell-text",3,"ngClass"],["mat-cell","","class","mat-cell-text",3,"ngClass","innerHTML",4,"matCellDef"],["mat-cell","",1,"mat-cell-text",3,"ngClass","innerHTML"],["mat-mini-fab","",3,"color","click",4,"ngFor","ngForOf"],["mat-mini-fab","",3,"color","click"],[3,"svgIcon"],["mat-header-row",""],["mat-row","",3,"ngClass","click"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.YNc(1,Xi,5,3,"div",1),r.TgZ(2,"div",2),r.TgZ(3,"table",3,4),r.ynx(5,5),r.YNc(6,Ki,2,2,"th",6),r.YNc(7,er,2,1,"td",7),r.BQk(),r.YNc(8,ur,6,5,"ng-container",8),r.ynx(9,9),r.YNc(10,pr,1,0,"th",6),r.YNc(11,hr,2,1,"td",7),r.BQk(),r.YNc(12,gr,1,0,"tr",10),r.YNc(13,mr,1,2,"tr",11),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.xp6(1),r.Q6J("ngIf",t.hasFilterInput),r.xp6(2),r.Q6J("dataSource",t.dataSource),r.xp6(5),r.Q6J("ngForOf",t.model.columns),r.xp6(4),r.Q6J("matHeaderRowDef",t.displayedColumns),r.xp6(1),r.Q6J("matRowDefColumns",t.displayedColumns))},directives:[h.O5,Ue.BZ,Ne.YE,Ue.w1,Ue.fO,Ue.Dz,h.sg,Ue.as,Ue.nj,De.KE,Ve.Nt,Ue.ge,m.oG,Ue.ev,Ne.nU,h.mk,n.lW,a.Hw,Ue.XQ,Ue.Gk],pipes:[j.X$],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:block}.table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;overflow:auto;flex:1 1 auto}.table-box[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}.table-header[_ngcontent-%COMP%]{min-height:64px;max-width:500px;display:flex;flex:0 1 auto;align-items:baseline;padding:8px 24px 0;font-size:20px;justify-content:space-between}tr[mat-header-row][_ngcontent-%COMP%], tr[mat-row][_ngcontent-%COMP%]{height:60px}.mat-cell-text[_ngcontent-%COMP%]{overflow:hidden;word-wrap:break-word}td[mat-cell][_ngcontent-%COMP%]{padding-right:15px}th.mat-header-cell[_ngcontent-%COMP%]{padding-right:5px}button[_ngcontent-%COMP%]{margin-right:10px}"]}),e})(),yr=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,We.u5,et.HT,a.Ps,n.ot,Ue.p0,De.lN,Ve.c,Ne.JX,m.p9,ne]]}),e})();class vr extends dt{}var br=(()=>{return(e=br||(br={})).White="white",e.Grey="grey",e.Primary="primary",br;var e})();function xr(e="300ms",t="ease-in-out"){return(0,ot.X$)("toolSlideInOut",[(0,ot.SB)("enter",(0,ot.oB)({transform:"translate3d(0, 0, 0)"})),(0,ot.eR)("void => enter",(0,ot.jt)(e+" "+t))])}function wr(e,t){if(1&e&&(r._UZ(0,"igo-actionbar",2),r.ALo(1,"async"),r.ALo(2,"async"),r.ALo(3,"async")),2&e){const e=r.oxw();r.Q6J("store",e.actionStore)("withIcon",!0)("withTitle",r.lcZ(1,6,e.toolbarWithTitle$))("withTooltip",!1===r.lcZ(2,8,e.toolbarWithTitle$))("scrollActive",r.lcZ(3,10,e.toolbarWithTitle$))("horizontal",!1)}}const Sr=function(e,t){return{"igo-tool-container-with-toolbar":e,"igo-tool-container-with-animation":t}};function Cr(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",3),r.NdJ("@toolSlideInOut.start",function(){return r.CHM(e),r.oxw().onAnimationStart()})("@toolSlideInOut.done",function(){return r.CHM(e),r.oxw().onAnimationComplete()}),r.ALo(1,"async"),r._UZ(2,"igo-dynamic-outlet",4),r.qZA()}if(2&e){const e=t.ngIf,o=r.oxw();r.Q6J("ngClass",r.WLB(6,Sr,!o.actionStore.empty,o.animate))("@toolSlideInOut",r.lcZ(1,4,o.animation$)),r.xp6(2),r.Q6J("component",e.component)("inputs",o.getToolInputs(e))}}let Tr=(()=>{class e{constructor(){this.activeTool$=new C.X(void 0),this.actionStore=new vr([]),this.animation$=new C.X("none"),this.toolbar$=new C.X([]),this.toolbarWithTitle$=this.activeTool$.pipe((0,x.U)(e=>void 0===e)),this.animating$=new C.X(!1),this.animate=!1,this.color=br.White}get classColorGrey(){return this.color===br.Grey}get classColorPrimary(){return this.color===br.Primary}ngOnInit(){this.toolbar$$=this.toolbox.toolbar$.subscribe(e=>this.onToolbarChange(e)),this.activeTool$$=this.toolbox.activeTool$.subscribe(e=>this.onActiveToolChange(e))}ngOnDestroy(){this.toolbar$$.unsubscribe(),this.activeTool$$.unsubscribe(),this.actionStore.destroy()}onAnimationStart(){this.animating$.next(!0)}onAnimationComplete(){this.animating$.next(!1)}getToolInputs(e){return e.options||{}}onToolbarChange(e){this.setToolbar(e)}onActiveToolChange(e){this.animate?this.onAnimate(()=>this.setActiveTool(e)):this.setActiveTool(e)}setActiveTool(e){if(void 0===e)this.actionStore.state.updateAll({active:!1});else{const t=this.actionStore.get(e.name);void 0!==t&&this.actionStore.state.update(t,{active:!0},!0)}this.activeTool$.next(e),this.animate&&this.animation$.next("enter")}setToolbar(e){const t=e.reduce((e,t)=>{const o=this.toolbox.getTool(t);return void 0===o||e.push({id:o.name,title:o.title,icon:o.icon,tooltip:o.tooltip,args:[o,this.toolbox],handler:(e,t)=>{t.activateTool(e.name)},ngClass:(e,t)=>this.toolbox.activeTool$.pipe((0,x.U)(t=>{let o=!1;void 0!==t&&e.name===t.name&&(o=!0);let i=!1;return void 0!==t&&e.name===t.parent&&(i=!0),{"tool-activated":o,"children-tool-activated":i}}))}),e},[]);this.actionStore.load(t),this.toolbar$.next(e)}onAnimate(e){this.unAnimate(),this.animating$$=this.animating$.subscribe(t=>{t||(e.call(this),this.unAnimate())})}unAnimate(){this.animating$$&&this.animating$$.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-toolbox"]],hostVars:4,hostBindings:function(e,t){2&e&&r.ekj("color-grey",t.classColorGrey)("color-primary",t.classColorPrimary)},inputs:{toolbox:"toolbox",animate:"animate",color:"color"},decls:4,vars:6,consts:[[3,"store","withIcon","withTitle","withTooltip","scrollActive","horizontal",4,"ngIf"],["class","igo-tool-container",3,"ngClass",4,"ngIf"],[3,"store","withIcon","withTitle","withTooltip","scrollActive","horizontal"],[1,"igo-tool-container",3,"ngClass"],[3,"component","inputs"]],template:function(e,t){1&e&&(r.YNc(0,wr,4,12,"igo-actionbar",0),r.ALo(1,"async"),r.YNc(2,Cr,3,9,"div",1),r.ALo(3,"async")),2&e&&(r.Q6J("ngIf",r.lcZ(1,2,t.toolbar$).length>0),r.xp6(2),r.Q6J("ngIf",r.lcZ(3,4,t.activeTool$)))},directives:[h.O5,Mo,h.mk,Xo],pipes:[h.Ov],styles:["[_nghost-%COMP%]{display:block;position:relative;overflow:hidden;width:100%;height:100%}.igo-tool-container[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0}.igo-tool-container-with-animation[_ngcontent-%COMP%]{transform:translate(100%)}.igo-tool-container-with-toolbar[_ngcontent-%COMP%]{left:50px}igo-actionbar[_ngcontent-%COMP%]{height:100%}igo-actionbar.with-title[_ngcontent-%COMP%]{width:100%;overflow:auto}igo-actionbar[_ngcontent-%COMP%]:not(.with-title){width:48px;overflow:hidden;-o-box-shadow:2px 0px 2px 0px #dddddd;box-shadow:2px 0 2px #ddd}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){igo-actionbar[_ngcontent-%COMP%]:not(.with-title){overflow:auto}}igo-dynamic-outlet[_ngcontent-%COMP%]{overflow:auto}"],data:{animation:[xr()]},changeDetection:0}),e})(),Ar=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,ko,ei]]}),e})(),Lr=(()=>{class e{static forRoot(){return{ngModule:e,providers:[Oi]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez],Ar]}),e})();function Zr(e,t){if(1&e&&r._UZ(0,"igo-dynamic-outlet",1),2&e){const e=r.oxw();r.Q6J("component",e.widget)("inputs",e.inputs)("subscribers",e.getEffectiveSubscribers())}}let Fr=(()=>{class e{constructor(){this.baseSubscribers={cancel:e=>this.onCancel(e),complete:e=>this.onComplete(e)},this.subscribers={},this.complete=new r.vpe,this.cancel=new r.vpe}ngOnDestroy(){this.destroyWidget()}getEffectiveSubscribers(){const e=Object.assign({},this.subscribers);return Object.keys(this.baseSubscribers).forEach(t=>{const o=e[t],i=this.baseSubscribers[t];e[t]=void 0!==o?e=>{o(e),i(e)}:i}),e}onCancel(e){this.cancel.emit(e),this.destroyWidget()}onComplete(e){this.complete.emit(e),this.destroyWidget()}destroyWidget(){void 0!==this.widget&&this.widget.destroy(),this.widget=void 0}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-widget-outlet"]],inputs:{widget:"widget",inputs:"inputs",subscribers:"subscribers"},outputs:{complete:"complete",cancel:"cancel"},decls:1,vars:1,consts:[[3,"component","inputs","subscribers",4,"ngIf"],[3,"component","inputs","subscribers"]],template:function(e,t){1&e&&r.YNc(0,Zr,1,3,"igo-dynamic-outlet",0),2&e&&r.Q6J("ngIf",t.widget)},directives:[h.O5,Xo],styles:["igo-dynamic-outlet[_ngcontent-%COMP%]{height:100%}"],changeDetection:0}),e})(),Or=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,ei]]}),e})(),Mr=(()=>{class e{constructor(e){this.dynamicComponentService=e}create(e){return this.dynamicComponentService.create(e)}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(Ho))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Ir=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[Mr],imports:[[h.ez,Or],Or]}),e})(),kr=(()=>{class e{constructor(){this.selectedChange=new r.vpe}getWorkspaceTitle(e){return lt(e)}onSelectedChange(e){const t=e.value;this.store.activateWorkspace(t),this.selectedChange.emit({selected:!0,value:t})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-workspace-selector"]],inputs:{store:"store"},outputs:{selectedChange:"selectedChange"},decls:1,vars:3,consts:[[3,"store","multi","titleAccessor","selectedChange"]],template:function(e,t){1&e&&(r.TgZ(0,"igo-entity-selector",0),r.NdJ("selectedChange",function(e){return t.onSelectedChange(e)}),r.qZA()),2&e&&r.Q6J("store",t.store)("multi",!1)("titleAccessor",t.getWorkspaceTitle)},directives:[xt],styles:["igo-entity-selector[_ngcontent-%COMP%]     mat-form-field .mat-form-field-infix{padding:0}igo-entity-selector[_ngcontent-%COMP%]     mat-form-field .mat-form-field-wrapper{padding-bottom:1.75em}"],changeDetection:0}),e})(),Pr=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,xi]]}),e})();function _r(e,t){if(1&e){const e=r.EpF();r.ynx(0),r.TgZ(1,"igo-widget-outlet",1),r.NdJ("cancel",function(){const t=r.CHM(e).ngIf;return r.oxw().onWidgetCancel(t)})("complete",function(){const t=r.CHM(e).ngIf;return r.oxw().onWidgetComplete(t)}),r.ALo(2,"async"),r.ALo(3,"async"),r.qZA(),r.BQk()}if(2&e){const e=t.ngIf,o=r.oxw();r.xp6(1),r.Q6J("widget",e)("inputs",r.lcZ(2,3,o.widgetInputs$))("subscribers",r.lcZ(3,5,o.widgetSubscribers$))}}let $r=(()=>{class e{constructor(){this.deactivateWidget=new r.vpe}get widget$(){return this.workspace.widget$}get widgetInputs$(){return this.workspace.widgetInputs$}get widgetSubscribers$(){return this.workspace.widgetSubscribers$}onWidgetCancel(e){this.workspace.deactivateWidget(),this.deactivateWidget.emit(e)}onWidgetComplete(e){this.workspace.deactivateWidget(),this.deactivateWidget.emit(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-workspace-widget-outlet"]],inputs:{workspace:"workspace"},outputs:{deactivateWidget:"deactivateWidget"},decls:2,vars:3,consts:[[4,"ngIf"],[3,"widget","inputs","subscribers","cancel","complete"]],template:function(e,t){1&e&&(r.YNc(0,_r,4,7,"ng-container",0),r.ALo(1,"async")),2&e&&r.Q6J("ngIf",r.lcZ(1,1,t.widget$))},directives:[h.O5,Fr],pipes:[h.Ov],styles:["igo-widget-outlet[_ngcontent-%COMP%]{height:100%}"],changeDetection:0}),e})(),qr=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,Or]]}),e})(),Dr=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez],Pr,qr]}),e})();class Er{constructor(e){this.dataChange=new C.X([]),e&&this.dataChange.next(e)}get data(){return this.dataChange.value}set(e){this.dataChange.next(e)}add(e){const t=this.data.slice();t.push(e),this.set(t)}remove(e){const t=this.data.slice(),o=t.indexOf(e);t.splice(o,1),this.set(t)}}function Rr(e){return t=>{Oi.register(Object.assign({},e,{component:t}))}}class Ur extends dt{constructor(){super(...arguments),this.activeWorkspace$=new C.X(void 0)}activateWorkspace(e){const t=this.activeWorkspace$.value;void 0!==t&&t.deactivate(),this.deactivateWorkspace(),void 0!==e&&(this.state.update(e,{active:!0,selected:!0},!0),this.activeWorkspace$.next(e),e.activate())}deactivateWorkspace(){const e=this.activeWorkspace$.value;void 0!==e&&(e.deactivate(),this.activeWorkspace$.next(void 0))}}class Nr{constructor(e){this.options=e,this.widget$=new C.X(void 0),this.widgetInputs$=new C.X({}),this.widgetSubscribers$=new C.X({}),this.change=new O.xQ,this.active$=new C.X(!1)}get id(){return this.options.id}get title(){return this.options.title}get meta(){return this.options.meta||{}}get entityStore(){return this.options.entityStore}get actionStore(){return this.options.actionStore}get widget(){return this.widget$.value}get hasWidget(){return void 0!==this.widget}get active(){return this.active$.value}activate(){!0===this.active&&this.deactivate(),this.active$.next(!0),void 0!==this.entityStore&&(this.entities$$=this.entityStore.stateView.all$().subscribe(()=>this.onStateChange())),this.change.next()}deactivate(){this.active$.next(!1),this.deactivateWidget(),void 0!==this.entities$$&&this.entities$$.unsubscribe(),void 0!==this.change$&&this.change$.unsubscribe()}activateWidget(e,t={},o={}){this.widget$.next(e),this.widgetInputs$.next(t),this.widgetSubscribers$.next(o),this.change.next()}deactivateWidget(){this.widget$.next(void 0),this.change.next()}onStateChange(){this.change.next()}}const Jr=d.Bz.forChild([{path:"home",component:(()=>{class e{constructor(e){this.interactiveTourService=e}startTour(){this.interactiveTourService.startTour("global")}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Zi))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-home"]],decls:56,vars:0,consts:[[2,"text-align","center"],["id","igo-title"],["width","180","src","assets/igo2/core/logo.png",1,"igo-logo"],["tourToStart","global","menuIsOpen","true","styleButton","raised"],["target","_blank","rel","noopener","href","https://github.com/infra-geo-ouverte/igo2-lib/blob/master/README.md#user-installation"],["target","_blank","rel","noopener","href","https://angular.io/docs"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"h1",1),r._uU(2," Welcome to IGO "),r.qZA(),r._UZ(3,"img",2),r.qZA(),r.TgZ(4,"p"),r._UZ(5,"igo-interactive-tour",3),r.qZA(),r.TgZ(6,"p"),r._uU(7," IGO2 library contains many components and services that may benefit any web application. "),r._UZ(8,"br"),r._uU(9," IGO2 library is open source project using Angular, Angular Material and OpenLayers.\n"),r.qZA(),r.TgZ(10,"h3"),r._uU(11,"IGO2 library is divided into several elements: "),r.qZA(),r.TgZ(12,"ul"),r.TgZ(13,"li"),r.TgZ(14,"b"),r._uU(15,"@igo2/utils"),r.qZA(),r._uU(16," : Basic utilies without dependency (ex: base64, clipboard, uuid)"),r.qZA(),r.TgZ(17,"li"),r.TgZ(18,"b"),r._uU(19,"@igo2/core"),r.qZA(),r._uU(20," : Element affecting the core of the application (ex: config, language, message, media, request)"),r.qZA(),r.TgZ(21,"li"),r.TgZ(22,"b"),r._uU(23,"@igo2/common"),r.qZA(),r._uU(24," : Library containing reusable components (ex: clickout, drag-drop, list, panel, spinner, table)"),r.qZA(),r.TgZ(25,"li"),r.TgZ(26,"b"),r._uU(27,"@igo2/auth"),r.qZA(),r._uU(28," : Library grouping the authentication and security module"),r.qZA(),r.TgZ(29,"li"),r.TgZ(30,"b"),r._uU(31,"@igo2/geo"),r.qZA(),r._uU(32," : Library containing the geomatic components. Depends on Openlayers."),r.qZA(),r.TgZ(33,"li"),r.TgZ(34,"b"),r._uU(35,"@igo2/context"),r.qZA(),r._uU(36," : Library of components uniting @igo2/geo and @igo2/auth"),r.qZA(),r.TgZ(37,"li"),r.TgZ(38,"b"),r._uU(39,"@igo2/integration"),r.qZA(),r._uU(40," : Library integrate basic components"),r.qZA(),r.qZA(),r.TgZ(41,"h2"),r._uU(42,"Here are some links to help you start: "),r.qZA(),r.TgZ(43,"ul"),r.TgZ(44,"li"),r.TgZ(45,"h2"),r.TgZ(46,"a",4),r._uU(47,"Installation"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(48,"li"),r.TgZ(49,"h2"),r.TgZ(50,"a",5),r._uU(51,"Angular Documentation"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r._uU(52," *** Modules in "),r.TgZ(53,"code"),r._uU(54,"@igo2/core"),r.qZA(),r._uU(55," must be imported only once\n"))},directives:[Ii],styles:[""]}),e})()}]);let Br=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[Jr,ki,p.AV,a.Ps,n.ot]]}),e})();const jr=d.Bz.forChild([{path:"activity",component:(()=>{class e{constructor(e){this.activityService=e,this.idsActivity=[]}register(){this.idsActivity.push(this.activityService.register())}unregister(){this.activityService.unregister(this.idsActivity.pop())}get counter(){return this.activityService.counter$.value}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Y))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-activity"]],decls:31,vars:1,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/activity"],["mat-raised-button","",3,"click"],["igoSpinnerActivity",""]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Core"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Activity"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"p"),r._uU(7,"Register activities in service. Use to display a loading icon"),r.qZA(),r.TgZ(8,"li"),r._uU(9,"Import "),r.TgZ(10,"code"),r._uU(11,"IgoActivityModule"),r.qZA(),r._uU(12," only if you want register http calls"),r.qZA(),r.TgZ(13,"li"),r._uU(14,"Import "),r.TgZ(15,"code"),r._uU(16,"IgoActivityModule"),r.qZA(),r._uU(17," only once"),r.qZA(),r._UZ(18,"br"),r._uU(19," See the "),r.TgZ(20,"a",0),r._uU(21," code of this example"),r.qZA(),r._UZ(22,"hr"),r.qZA(),r.TgZ(23,"mat-card-actions"),r.TgZ(24,"button",1),r.NdJ("click",function(){return t.register()}),r._uU(25,"Register"),r.qZA(),r.TgZ(26,"button",1),r.NdJ("click",function(){return t.unregister()}),r._uU(27,"Unregister"),r.qZA(),r.qZA(),r.TgZ(28,"p"),r._uU(29),r.qZA(),r._UZ(30,"igo-spinner",2),r.qZA()),2&e&&(r.xp6(29),r.hij("Counter: ",t.counter,""))},directives:[g.a8,g.$j,g.n5,g.dn,g.hq,n.lW,Gi,Yi],styles:[""]}),e})()}]);let Qr=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[jr,g.QW,n.ot,H.forRoot(),zi]]}),e})();const Gr={production:!0,igo:{projections:[{code:"EPSG:32198",alias:"Quebec Lambert",def:"+proj=lcc +lat_1=60 +lat_2=46 +lat_0=44 +lon_0=-68.5 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs",extent:[-886251.0296,180252.9126,897177.3418,2106143.8139]}],auth:{intern:{enabled:!0},allowAnonymous:!0},interactiveTour:{tourInMobile:!0},importExport:{url:"https://geoegl.msp.gouv.qc.ca/apis/ogre"},language:{prefix:"./locale/"},catalog:{sources:[{id:"Gououvert",title:"Gouvouvert",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi"},{id:"DefiningInfoFormat",title:"Defining info_format",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",queryFormat:{html:"*","application/json":["stations_meteoroutieres","histo_stations_meteoroutieres"]},queryHtmlTarget:"iframe",count:30},{id:"catalogwithregex",title:"Filtered catalog by regex",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",regFilters:["zpegt"]},{id:"catalogwithtooltipcontrol",title:"Controling tooltip format",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",tooltipType:"abstract"}]},searchSources:{nominatim:{enabled:!1},icherche:{searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/icherche",order:2,enabled:!0,params:{limit:"8"}},coordinatesreverse:{showInPointerSummary:!0},icherchereverse:{showInPointerSummary:!0,searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/terrapi",order:3,enabled:!0},ilayer:{searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/layers/search",order:4,enabled:!0,params:{limit:"5"}}}}},Yr=d.Bz.forChild([{path:"config",component:(()=>{class e{constructor(e){this.configService=e,this.configLanguage=this.configService.getConfig("language")}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(W))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-config"]],decls:26,vars:3,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/config"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/environments"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Core"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"config"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"p"),r._uU(7,"Load config in your angular application"),r.qZA(),r.TgZ(8,"li"),r._uU(9,"Import "),r.TgZ(10,"code"),r._uU(11,"IgoConfigModule"),r.qZA(),r._uU(12," only once"),r.qZA(),r._UZ(13,"br"),r._uU(14," See the "),r.TgZ(15,"a",0),r._uU(16," code of this example"),r.qZA(),r._UZ(17,"br"),r._uU(18," See the "),r.TgZ(19,"a",1),r._uU(20," environment config"),r.qZA(),r._UZ(21,"hr"),r.qZA(),r.TgZ(22,"p"),r._uU(23),r.ALo(24,"json"),r.qZA(),r._UZ(25,"p"),r.qZA()),2&e&&(r.xp6(23),r.hij("Config language: ",r.lcZ(24,1,t.configLanguage),""))},directives:[g.a8,g.$j,g.n5,g.dn],pipes:[h.Ts],styles:[""]}),e})()}]);let zr=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[K({default:Gr.igo})],imports:[[Yr,h.ez,g.QW,n.ot,te.forRoot()]]}),e})();const Hr=d.Bz.forChild([{path:"language",component:(()=>{class e{constructor(e){this.languageService=e,this.app={title:"IGO"}}changeLanguage(e){this.languageService.setLanguage(e),console.log(this.languageService)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ue))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-language"]],decls:35,vars:4,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/language"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/environments"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/locale"],["mat-raised-button","",3,"click"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Core"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"language"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"p"),r._uU(7,"Translate your angular application"),r.qZA(),r.TgZ(8,"li"),r._uU(9,"Import "),r.TgZ(10,"code"),r._uU(11,"IgoLanguageModule"),r.qZA(),r._uU(12," only once"),r.qZA(),r._UZ(13,"br"),r._uU(14," See the "),r.TgZ(15,"a",0),r._uU(16,"code of this example"),r.qZA(),r._UZ(17,"br"),r._uU(18," See language section of the "),r.TgZ(19,"a",1),r._uU(20," environment config"),r.qZA(),r._UZ(21,"br"),r._uU(22," See "),r.TgZ(23,"a",2),r._uU(24,"locale files"),r.qZA(),r._UZ(25,"hr"),r.qZA(),r.TgZ(26,"mat-card-actions"),r.TgZ(27,"button",3),r.NdJ("click",function(){return t.changeLanguage("en")}),r._uU(28,"English"),r.qZA(),r.TgZ(29,"button",3),r.NdJ("click",function(){return t.changeLanguage("fr")}),r._uU(30,"Fran\xe7ais"),r.qZA(),r.qZA(),r.TgZ(31,"p"),r._uU(32),r.ALo(33,"translate"),r.qZA(),r._UZ(34,"p"),r.qZA()),2&e&&(r.xp6(32),r.Oqu(r.xi3(33,1,"welcome",t.app)))},directives:[g.a8,g.$j,g.n5,g.dn,g.hq,n.lW],pipes:[j.X$],styles:[""]}),e})()}]);let Vr=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[Hr,g.QW,n.ot,ne.forRoot()]]}),e})();const Wr=d.Bz.forChild([{path:"media",component:(()=>{class e{constructor(e){this.mediaService=e}get media(){return this.mediaService.getMedia()}get orientation(){return this.mediaService.getOrientation()}get isTouchScreen(){return this.mediaService.isTouchScreen()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(be))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-media"]],decls:19,vars:3,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/media"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Core"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Media"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"p"),r._uU(7,"Detect type of media (mobile, tablet, desktop)"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"hr"),r.qZA(),r.TgZ(13,"p"),r._uU(14),r.qZA(),r.TgZ(15,"p"),r._uU(16),r.qZA(),r.TgZ(17,"p"),r._uU(18),r.qZA(),r.qZA()),2&e&&(r.xp6(14),r.hij("Current media: ",t.media,""),r.xp6(2),r.hij("Current orientation: ",t.orientation,""),r.xp6(2),r.hij("Device mode: ",t.isTouchScreen?"Touch device":"Not a touch device ",""))},directives:[g.a8,g.$j,g.n5,g.dn],styles:[""]}),e})()}]);let Xr=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[Wr,g.QW]]}),e})();const Kr=d.Bz.forChild([{path:"message",component:(()=>{class e{constructor(e){this.messageService=e}success(){this.messageService.success("Congratulations","Success")}info(){this.messageService.info("Welcome to IGO","Info")}alert(){this.messageService.alert("Warning","Alert")}error(){this.messageService.error("There is a bug","Error")}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(de))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-message"]],decls:30,vars:0,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/message"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","accent",3,"click"],["mat-raised-button","","color","warn",3,"click"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Core"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Message"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"p"),r._uU(7,"Show message to user."),r.qZA(),r.TgZ(8,"li"),r._uU(9,"Import "),r.TgZ(10,"code"),r._uU(11,"IgoMessageModule"),r.qZA(),r._uU(12," only once"),r.qZA(),r.TgZ(13,"li"),r._uU(14,"Dependencies: BrowserAnimationsModule "),r.qZA(),r._UZ(15,"br"),r._uU(16," See the "),r.TgZ(17,"a",0),r._uU(18,"code of this example"),r.qZA(),r._UZ(19,"hr"),r.qZA(),r.TgZ(20,"mat-card-actions"),r.TgZ(21,"button",1),r.NdJ("click",function(){return t.success()}),r._uU(22,"Success message"),r.qZA(),r.TgZ(23,"button",2),r.NdJ("click",function(){return t.info()}),r._uU(24,"Info message"),r.qZA(),r.TgZ(25,"button",3),r.NdJ("click",function(){return t.alert()}),r._uU(26,"Alert message"),r.qZA(),r.TgZ(27,"button",4),r.NdJ("click",function(){return t.error()}),r._uU(28,"Error message"),r.qZA(),r.qZA(),r.qZA(),r._UZ(29,"igo-message-center"))},directives:[g.a8,g.$j,g.n5,g.dn,g.hq,n.lW,le],styles:[""]}),e})()}]);let es=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[Kr,g.QW,n.ot,ce.forRoot()]]}),e})();const ts=d.Bz.forChild([{path:"request",component:(()=>{class e{constructor(e,t){this.http=e,this.languageService=t}callHttp(){this.http.get("https://geoegl.msp.gouv.qc.ca/apis/icherche/info").subscribe(e=>{console.log(e)})}callHttpError(){this.http.get("404").subscribe(e=>{console.log(e)})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(y.eN),r.Y36(ue))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-request"]],decls:30,vars:0,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/request"],["mat-raised-button","",3,"click"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Core"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Request"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"p"),r._uU(7,"Register http calls in console"),r.qZA(),r.TgZ(8,"li"),r._uU(9,"Import "),r.TgZ(10,"code"),r._uU(11,"IgoLoggingModule"),r.qZA(),r._uU(12," only if you want register http calls in console"),r.qZA(),r.TgZ(13,"li"),r._uU(14,"Import "),r.TgZ(15,"code"),r._uU(16,"IgoErrorModule"),r.qZA(),r._uU(17," only if you want register errors from http call in console"),r.qZA(),r.TgZ(18,"li"),r._uU(19,"Import modules only once"),r.qZA(),r._UZ(20,"br"),r._uU(21," See the "),r.TgZ(22,"a",0),r._uU(23,"code of this example"),r.qZA(),r._UZ(24,"hr"),r.qZA(),r.TgZ(25,"mat-card-actions"),r.TgZ(26,"button",1),r.NdJ("click",function(){return t.callHttp()}),r._uU(27,"Log"),r.qZA(),r.TgZ(28,"button",1),r.NdJ("click",function(){return t.callHttpError()}),r._uU(29,"Error"),r.qZA(),r.qZA(),r.qZA())},directives:[g.a8,g.$j,g.n5,g.dn,g.hq,n.lW],styles:[""]}),e})()}]);let os=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[ts,g.QW,n.ot,y.JF,ne.forRoot(),ge.forRoot()]]}),e})();function is(e,t){if(1&e&&r._UZ(0,"igo-actionbar",4),2&e){const e=r.oxw();r.Q6J("store",e.store)("withIcon",!0)("horizontal",!0)("mode","context")}}const rs=d.Bz.forChild([{path:"action",component:(()=>{class e{constructor(e,t,o){this.overlay=e,this.mediaService=t,this.languageService=o,this.store=new vr([]),this.added$=new C.X(!1)}get actionbarMode(){return this.mediaService.media$.value===ye.Desktop&&this.mediaService.orientation$.value===ve.Landscape?po.Dock:po.Overlay}ngOnInit(){this.store.load([{id:"add",title:"Add",icon:"plus",tooltip:"Add Tooltip",handler:()=>{alert("Add!"),this.added$.next(!0)}},{id:"edit",title:"Edit",icon:"pencil",tooltip:"Edit Tooltip",args:["1"],handler:e=>{alert(`Edit item ${e}!`)},availability:()=>this.added$},{id:"delete",title:"Delete",tooltip:"Delete Tooltip",icon:"delete",handler:()=>{alert("Delete!"),this.added$.next(!1)},availability:()=>this.added$}])}ngOnDestroy(){this.store.destroy()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Ge.aV),r.Y36(be),r.Y36(ue))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-action"]],decls:19,vars:6,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/action"],[3,"store","withIcon","withTitle","horizontal","mode"],[3,"igoContextMenu"],["actionbarMenu",""],[3,"store","withIcon","horizontal","mode"]],template:function(e,t){if(1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Common"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Action"),r.qZA(),r.TgZ(5,"mat-card-content"),r._uU(6," See the "),r.TgZ(7,"a",0),r._uU(8,"code of this example"),r.qZA(),r.qZA(),r._UZ(9,"igo-actionbar",1),r.qZA(),r._UZ(10,"p"),r.TgZ(11,"mat-card",2),r.TgZ(12,"mat-card-subtitle"),r._uU(13,"Common"),r.qZA(),r.TgZ(14,"mat-card-title"),r._uU(15,"Action context-menu"),r.qZA(),r._UZ(16,"div"),r.qZA(),r.YNc(17,is,1,4,"ng-template",null,3,r.W1O)),2&e){const e=r.MAs(18);r.xp6(9),r.Q6J("store",t.store)("withIcon",!0)("withTitle","overlay"===t.actionbarMode)("horizontal",!0)("mode",t.actionbarMode),r.xp6(2),r.Q6J("igoContextMenu",e)}},directives:[g.a8,g.$j,g.n5,g.dn,Mo,jo],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e})()}]);let ss=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[rs,n.ot,g.QW,ko,Qo]]}),e})(),ns=(()=>{class e{constructor(e){this.cdRef=e}onUpdateInputs(){this.cdRef.detectChanges()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.sBO))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-salutation-component"]],inputs:{name:"name"},decls:2,vars:1,template:function(e,t){1&e&&(r.TgZ(0,"p"),r._uU(1),r.qZA()),2&e&&(r.xp6(1),r.hij("Hello, my name is ",t.name,"."))},encapsulation:2,changeDetection:0}),e})(),as=(()=>{class e{constructor(e){this.cdRef=e}onUpdateInputs(){this.cdRef.detectChanges()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.sBO))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-explanation-component"]],decls:2,vars:0,template:function(e,t){1&e&&(r.TgZ(0,"p"),r._uU(1,"I am a dynamic component, rendered into an IgoDynamicOutlet."),r.qZA())},encapsulation:2,changeDetection:0}),e})();const ls=d.Bz.forChild([{path:"dynamic-component",component:(()=>{class e{constructor(){this.component=ns,this.inputs={name:"Bob"}}toggleComponent(){this.component=this.component===ns?as:ns}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-dynamic-component"]],decls:12,vars:2,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/dynamic-component"],[3,"component","inputs"],["mat-flat-button","","color","primary",3,"click"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Common"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Dynamic Component"),r.qZA(),r.TgZ(5,"mat-card-content"),r._uU(6," See the "),r.TgZ(7,"a",0),r._uU(8,"code of this example"),r.qZA(),r.qZA(),r._UZ(9,"igo-dynamic-outlet",1),r.TgZ(10,"button",2),r.NdJ("click",function(){return t.toggleComponent()}),r._uU(11,"Toggle Component"),r.qZA(),r.qZA()),2&e&&(r.xp6(9),r.Q6J("component",t.component)("inputs",t.inputs))},directives:[g.a8,g.$j,g.n5,g.dn,Xo,n.lW],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e})()}]);let cs=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[ls,n.ot,g.QW,ei]]}),e})();const us=d.Bz.forChild([{path:"entity-table",component:(()=>{class e{constructor(e){this.languageService=e,this.store=new dt([]),this.entitySortChange$=new C.X(!1),this.paginatorOptions={pageSize:10},this.template={selection:!0,selectionCheckbox:!0,selectMany:!0,sort:!0,valueAccessor:(e,t)=>nt(e,t),columns:[{name:"selected",title:"Selected",valueAccessor:e=>this.store.state.get(e).selected?"radiobox-marked":"radiobox-blank",renderer:it.Icon},{name:"id",title:"ID"},{name:"name",title:"Name"},{name:"description",title:"Description",renderer:it.HTML},{name:"url",title:"Hyperlink"},{name:"image",title:"Image"},{name:"action",title:"",valueAccessor:e=>[{icon:"home",color:"warn",click:e=>{console.log(e)}}],renderer:it.ButtonGroup}]}}ngOnInit(){const e=[2,1,3,4,5,6,7,8,9,10,11,12,13].map(e=>({id:e,name:`Name ${e}`,description:`<b>Description ${e}</b>`,url:"https://igouverte.org",image:"https://www.igouverte.org/assets/img/Igo_logoavec.png"}));this.store.load(e)}entitySortChange(){this.entitySortChange$.next(!0)}paginatorChange(e){this.paginator=e}ngOnDestroy(){this.store.destroy()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ue))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-entity-table"]],decls:10,vars:4,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/entity-table"],[3,"store","withPaginator","paginatorOptions","template","entitySortChange"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Common"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Entity Table"),r.qZA(),r.TgZ(5,"mat-card-content"),r._uU(6," See the "),r.TgZ(7,"a",0),r._uU(8,"code of this example"),r.qZA(),r.qZA(),r.TgZ(9,"igo-entity-table",1),r.NdJ("entitySortChange",function(){return t.entitySortChange()}),r.qZA(),r.qZA()),2&e&&(r.xp6(9),r.Q6J("store",t.store)("withPaginator",!0)("paginatorOptions",t.paginatorOptions)("template",t.template))},directives:[g.a8,g.$j,g.n5,g.dn,uo],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e})()}]);let ps=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[us,g.QW,Ti,Si]]}),e})();function ds(e,t){if(1&e&&(r.TgZ(0,"div"),r.TgZ(1,"p"),r._uU(2),r.qZA(),r.TgZ(3,"p"),r._uU(4),r.qZA(),r.TgZ(5,"p"),r._uU(6,"Description: "),r._UZ(7,"span",3),r.qZA(),r.qZA()),2&e){const e=t.ngIf;r.xp6(2),r.hij("ID: ",e.id,""),r.xp6(2),r.hij("Name: ",e.name,""),r.xp6(3),r.Q6J("innerHtml",e.description,r.oJD)}}const hs=d.Bz.forChild([{path:"entity-selector",component:(()=>{class e{constructor(e){this.languageService=e,this.store=new dt([]),this.selected$=new C.X(void 0)}ngOnInit(){this.store.load([{id:"2",name:"Name 2",description:"<b>Description 2</b>"},{id:"1",name:"Name 1",description:"<b>Description 1</b>"},{id:"3",name:"Name 3",description:"<b>Description 3</b>"}])}ngOnDestroy(){this.store.destroy()}getTitle(e){return e.name}onSelectedChange(e){this.selected$.next(e.entity)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ue))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-entity-selector"]],decls:12,vars:7,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/entity-selector"],[3,"store","titleAccessor","emptyText","placeholder","selectedChange"],[4,"ngIf"],[3,"innerHtml"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Common"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Entity Selector"),r.qZA(),r.TgZ(5,"mat-card-content"),r._uU(6," See the "),r.TgZ(7,"a",0),r._uU(8,"code of this example"),r.qZA(),r.qZA(),r.TgZ(9,"igo-entity-selector",1),r.NdJ("selectedChange",function(e){return t.onSelectedChange(e)}),r.qZA(),r.YNc(10,ds,8,3,"div",2),r.ALo(11,"async"),r.qZA()),2&e&&(r.xp6(9),r.Q6J("store",t.store)("titleAccessor",t.getTitle)("emptyText","")("placeholder","Select an entity"),r.xp6(1),r.Q6J("ngIf",r.lcZ(11,5,t.selected$)))},directives:[g.a8,g.$j,g.n5,g.dn,xt,h.O5],pipes:[h.Ov],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e})()}]);let gs=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,hs,g.QW,xi]]}),e})();function ms(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-form",2),r.NdJ("submitForm",function(t){return r.CHM(e),r.oxw().onSubmit(t)}),r.ALo(1,"async"),r._UZ(2,"igo-form-group",3),r.TgZ(3,"div",4),r.TgZ(4,"button",5),r.NdJ("click",function(){return r.CHM(e),r.oxw().fillForm()}),r._uU(5," Fill Form "),r.qZA(),r.TgZ(6,"button",5),r.NdJ("click",function(){return r.CHM(e),r.oxw().clearForm()}),r._uU(7," Clear Form "),r.qZA(),r.TgZ(8,"button",6),r._uU(9," Submit "),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=t.ngIf,o=r.oxw();r.Q6J("form",e)("formData",r.lcZ(1,4,o.data$)),r.xp6(2),r.Q6J("group",e.groups[0]),r.xp6(6),r.Q6J("disabled",o.submitDisabled)}}const fs=d.Bz.forChild([{path:"form",component:(()=>{class e{constructor(e,t){this.formService=e,this.languageService=t,this.form$=new C.X(void 0),this.data$=new C.X(void 0),this.submitDisabled=!0}ngOnInit(){const e=[{name:"id",title:"ID",options:{cols:1,validator:We.kI.required}},{name:"name",title:"Name",options:{cols:1,validator:We.kI.required}},{name:"status",title:"Status",type:"select",options:{cols:2},inputs:{choices:[{value:1,title:"Single"},{value:2,title:"Married"}]}}].map(e=>this.formService.field(e)),t=this.formService.form([],[this.formService.group({name:"info"},e)]);this.valueChanges$$=t.control.valueChanges.subscribe(()=>{this.submitDisabled=!t.control.valid}),this.form$.next(t)}ngOnDestroy(){this.valueChanges$$.unsubscribe()}fillForm(){this.data$.next({id:1,name:"Bob",status:2})}clearForm(){this.form$.value.control.reset()}onSubmit(e){alert(JSON.stringify(e))}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(li),r.Y36(ue))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-form"]],decls:11,vars:3,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/form"],[3,"form","formData","submitForm",4,"ngIf"],[3,"form","formData","submitForm"],[3,"group"],["formButtons",""],["mat-stroked-button","","type","button","color","primary",3,"click"],["mat-flat-button","","type","submit","color","primary",3,"disabled"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Common"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Form"),r.qZA(),r.TgZ(5,"mat-card-content"),r._uU(6," See the "),r.TgZ(7,"a",0),r._uU(8,"code of this example"),r.qZA(),r.qZA(),r.YNc(9,ms,10,6,"igo-form",1),r.ALo(10,"async"),r.qZA()),2&e&&(r.xp6(9),r.Q6J("ngIf",r.lcZ(10,1,t.form$)))},directives:[g.a8,g.$j,g.n5,g.dn,h.O5,ni,yi,n.lW],pipes:[h.Ov],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e})()}]);let ys=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,fs,n.ot,g.QW,bi]]}),e})();const vs=d.Bz.forChild([{path:"table",component:(()=>{class e{constructor(e){this.languageService=e,this.model={columns:[{name:"id",title:"ID",sortable:!1,filterable:!0},{name:"name",title:"Name",sortable:!0,filterable:!0},{name:"description",title:"Description",sortable:!0,filterable:!0}],actions:[{icon:"file-document",color:Vi.primary,click:e=>this.showName(e.name)}],selectionCheckbox:!0}}ngOnInit(){this.database=new Er([{id:"2",name:"Name 2",description:"Hello 2"},{id:"1",name:"Name 1",description:"Bonjour 1"},{id:"3",name:"Name 3",description:"Hola 3"}])}showName(e){alert(e)}handleSelect(e){console.log(e)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ue))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-table"]],decls:10,vars:3,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/table"],[3,"database","model","hasFilterInput","select"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Common"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Table"),r.qZA(),r.TgZ(5,"mat-card-content"),r._uU(6," See the "),r.TgZ(7,"a",0),r._uU(8,"code of this example"),r.qZA(),r.qZA(),r.TgZ(9,"igo-table",1),r.NdJ("select",function(e){return t.handleSelect(e)}),r.qZA(),r.qZA()),2&e&&(r.xp6(9),r.Q6J("database",t.database)("model",t.model)("hasFilterInput",!0))},directives:[g.a8,g.$j,g.n5,g.dn,fr],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e})()}]);let bs=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[vs,g.QW,yr]]}),e})();function xs(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",6),r.NdJ("click",function(){return r.CHM(e),r.oxw().toolbox.activatePreviousTool()}),r._UZ(1,"mat-icon",7),r.qZA()}}function ws(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",8),r.NdJ("click",function(){return r.CHM(e),r.oxw().toolbox.deactivateTool()}),r._UZ(1,"mat-icon",9),r.qZA()}}let Ss=class{constructor(e){this.cdRef=e}onUpdateInputs(){this.cdRef.detectChanges()}};Ss.\u0275fac=function(e){return new(e||Ss)(r.Y36(r.sBO))},Ss.\u0275cmp=r.Xpm({type:Ss,selectors:[["app-salutation-tool"]],inputs:{name:"name"},decls:2,vars:1,template:function(e,t){1&e&&(r.TgZ(0,"p"),r._uU(1),r.qZA()),2&e&&(r.xp6(1),r.hij("Hello, my name is ",t.name,"."))},encapsulation:2,changeDetection:0}),Ss=(0,je.gn)([Rr({name:"demo-salutation",title:"Salutation",icon:"account",options:{name:"Jack"}}),(0,je.w6)("design:paramtypes",[r.sBO])],Ss);let Cs=class{};Cs.\u0275fac=function(e){return new(e||Cs)},Cs.\u0275cmp=r.Xpm({type:Cs,selectors:[["app-about-tool"]],decls:2,vars:0,template:function(e,t){1&e&&(r.TgZ(0,"p"),r._uU(1,"I'm a tool inside a toolbox."),r.qZA())},encapsulation:2,changeDetection:0}),Cs=(0,je.gn)([Rr({name:"demo-about",title:"About",icon:"information"})],Cs);const Ts=d.Bz.forChild([{path:"tool",component:(()=>{class e{constructor(e,t){this.toolService=e,this.languageService=t,this.toolbox=new Fi}get activeTool$(){return this.toolbox.activeTool$}get panelTitle(){return this.activeTool$.value?this.activeTool$.value.title:"Toolbox"}ngOnInit(){this.toolbox.setToolbar(["demo-salutation","demo-about"]),this.toolbox.setTools(this.toolService.getTools())}ngOnDestroy(){this.toolbox.destroy()}activateSalutationTool(){this.toolbox.activateTool("demo-salutation",{name:"Bob"})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Oi),r.Y36(ue))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-tool"]],decls:17,vars:9,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/tool"],[3,"title"],["mat-icon-button","","panelLeftButton","",3,"click",4,"ngIf"],["mat-icon-button","","panelRightButton","",3,"click",4,"ngIf"],[3,"toolbox","animate"],["mat-flat-button","","type","button","color","primary",3,"click"],["mat-icon-button","","panelLeftButton","",3,"click"],["svgIcon","arrow-back"],["mat-icon-button","","panelRightButton","",3,"click"],["svgIcon","menu"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Common"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Tool"),r.qZA(),r.TgZ(5,"mat-card-content"),r._uU(6," See the "),r.TgZ(7,"a",0),r._uU(8,"code of this example"),r.qZA(),r.qZA(),r.TgZ(9,"igo-panel",1),r.YNc(10,xs,2,0,"button",2),r.ALo(11,"async"),r.YNc(12,ws,2,0,"button",3),r.ALo(13,"async"),r._UZ(14,"igo-toolbox",4),r.qZA(),r.TgZ(15,"button",5),r.NdJ("click",function(){return t.activateSalutationTool()}),r._uU(16," Activate Salutation Tool "),r.qZA(),r.qZA()),2&e&&(r.xp6(9),r.Q6J("title",t.panelTitle),r.xp6(1),r.Q6J("ngIf",r.lcZ(11,5,t.activeTool$)),r.xp6(2),r.Q6J("ngIf",r.lcZ(13,7,t.activeTool$)),r.xp6(2),r.Q6J("toolbox",t.toolbox)("animate",!0))},directives:[g.a8,g.$j,g.n5,g.dn,Bi,h.O5,Tr,n.lW,a.Hw],pipes:[h.Ov],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e})()}]);let As=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,Ts,n.ot,a.Ps,g.QW,ne,ji,Lr.forRoot()]]}),e})(),Ls=(()=>{class e{constructor(e){this.cdRef=e,this.complete=new r.vpe,this.cancel=new r.vpe}onUpdateInputs(){this.cdRef.detectChanges()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.sBO))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-salutation-widget"]],inputs:{name:"name"},outputs:{complete:"complete",cancel:"cancel"},decls:6,vars:1,consts:[["mat-flat-button","",3,"click"]],template:function(e,t){1&e&&(r.TgZ(0,"p"),r._uU(1),r.qZA(),r.TgZ(2,"button",0),r.NdJ("click",function(){return t.complete.emit(t.name)}),r._uU(3,"Nice to meet you"),r.qZA(),r.TgZ(4,"button",0),r.NdJ("click",function(){return t.cancel.emit(t.name)}),r._uU(5,"Dismiss"),r.qZA()),2&e&&(r.xp6(1),r.hij("Hello, my name is ",t.name,"."))},directives:[n.lW],encapsulation:2,changeDetection:0}),e})();const Zs=d.Bz.forChild([{path:"widget",component:(()=>{class e{constructor(e){this.widgetService=e,this.widget=this.widgetService.create(Ls),this.inputs={name:"Bob"}}onWidgetComplete(e){alert(`${e} emitted event 'complete' then got automatically destroyed.`)}onWidgetCancel(){alert("Widget emitted event 'cancel' then got automatically destroyed.")}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Mr))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-widget"]],decls:10,vars:2,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/widget"],[3,"widget","inputs","complete","cancel"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Common"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Widget"),r.qZA(),r.TgZ(5,"mat-card-content"),r._uU(6," See the "),r.TgZ(7,"a",0),r._uU(8,"code of this example"),r.qZA(),r.qZA(),r.TgZ(9,"igo-widget-outlet",1),r.NdJ("complete",function(e){return t.onWidgetComplete(e)})("cancel",function(){return t.onWidgetCancel()}),r.qZA(),r.qZA()),2&e&&(r.xp6(9),r.Q6J("widget",t.widget)("inputs",t.inputs))},directives:[g.a8,g.$j,g.n5,g.dn,Fr],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e})()}]);let Fs=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[Zs,n.ot,g.QW,Ir]]}),e})();var Os=o(30400),Ms=o(74192),Is=o.n(Ms),ks=o(50836),Ps=o(41389),_s=o(55347),$s=o(1754),qs=o(37822),Ds=o(30999);let Es=(()=>{class e{constructor(e){this.injector=e}set(e){localStorage.setItem(this.tokenKey,e)}remove(){localStorage.removeItem(this.tokenKey)}get(){return localStorage.getItem(this.tokenKey)}decode(){const e=this.get();if(e)return Is()(e)}isExpired(){const e=this.decode(),t=(new Date).getTime()/1e3;return!(e&&t<e.exp)}get tokenKey(){const e=this.injector.get(W);return this.options=e.getConfig("auth")||{},this.options.tokenKey}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(r.zs3))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Rs=(()=>{class e{constructor(e,t,o,i,r,s){this.http=e,this.tokenService=t,this.config=o,this.languageService=i,this.messageService=r,this.router=s,this.authenticate$=new C.X(void 0),this.logged$=new C.X(void 0),this.anonymous=!1,this.authenticate$.next(this.authenticated),this.authenticate$.subscribe(e=>{this.logged$.next(e),Qe.h.next()})}get hasAuthService(){return void 0!==this.config.getConfig("auth.url")}login(e,t){const o=new y.WM({"Content-Type":"application/json"}),i={username:e,password:this.encodePassword(t)};return this.loginCall(i,o)}loginWithToken(e,t,o){const i=new y.WM({"Content-Type":"application/json"});return this.loginCall({token:e,typeConnection:t,infosUser:o},i)}loginAnonymous(){return this.anonymous=!0,this.logged$.next(!0),(0,A.of)(!0)}refresh(){const e=this.config.getConfig("auth.url");return this.http.post(`${e}/refresh`,{}).pipe((0,Ie.b)(e=>{this.tokenService.set(e.token)}),(0,b.K)(e=>{throw e.error.caught=!0,e}))}logout(){return this.anonymous=!1,this.tokenService.remove(),this.authenticate$.next(!1),(0,A.of)(!0)}isAuthenticated(){return!this.tokenService.isExpired()}getToken(){return this.tokenService.get()}decodeToken(){return!!this.isAuthenticated()&&this.tokenService.decode()}goToRedirectUrl(){if(!this.router)return;const e=this.redirectUrl||this.router.url,t=this.config.getConfig("auth")||{};e===t.loginRoute?this.router.navigateByUrl(t.homeRoute||"/"):e&&this.router.navigateByUrl(e)}getUserInfo(){const e=this.config.getConfig("auth.url")+"/info";return this.http.get(e)}getProfils(){const e=this.config.getConfig("auth.url");return this.http.get(`${e}/profils`)}updateUser(e){const t=this.config.getConfig("auth.url");return this.http.patch(t,e)}encodePassword(e){return I.encode(e)}get logged(){return this.authenticated||this.isAnonymous}get isAnonymous(){return this.anonymous}get authenticated(){return this.isAuthenticated()}get isAdmin(){const e=this.decodeToken();return!!(e&&e.user&&e.user.isAdmin)}loginCall(e,t){const o=this.config.getConfig("auth.url");return this.http.post(`${o}/login`,e,{headers:t}).pipe((0,Ie.b)(e=>{this.tokenService.set(e.token);const t=this.decodeToken();t&&t.user&&(t.user.locale&&this.languageService.setLanguage(t.user.locale),t.user.isExpired&&this.languageService.translate.get("igo.auth.error.Password expired").subscribe(e=>this.messageService.alert(e))),this.authenticate$.next(!0)}),(0,b.K)(e=>{throw e.error.caught=!0,e}))}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(Es),r.LFG(W),r.LFG(ue),r.LFG(de),r.LFG(d.F0,8))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Us=(()=>{class e{constructor(e,t,o,i){this.authService=e,this.config=t,this.languageService=o,this.appRef=i,this.login=new r.vpe,this.options=this.config.getConfig("auth.google")||{},this.options.apiKey&&this.options.clientId?(this.loadSDKGoogle(),this.loadPlatform()):console.warn('Google authentification needs "apiKey" and "clientId" options')}handleSignInClick(){window.gapi.auth2.getAuthInstance().signIn()}handleSignOutClick(){window.gapi.auth2.getAuthInstance().signOut()}handleClientLoad(){window.gapi.load("client:auth2",()=>this.initClient())}initClient(){window.gapi.client.init({apiKey:this.options.apiKey,clientId:this.options.clientId,discoveryDocs:["https://people.googleapis.com/$discovery/rest?version=v1"],scope:"profile"}).then(()=>{this.handleSignOutClick(),this.updateTextButton(),window.gapi.auth2.getAuthInstance().isSignedIn.listen(e=>{this.updateSigninStatus(e)})})}updateSigninStatus(e){this.updateTextButton(),e&&this.loginGoogle(window.gapi.client.getToken().access_token)}updateTextButton(){const e=document.querySelector('span[id^="not_signed_"]');e&&"en"!==this.languageService.getLanguage()&&("Sign in with Google"===e.innerHTML?e.innerHTML=this.languageService.translate.instant("igo.auth.google.login"):"Signed in with Google"===e.innerHTML&&(e.innerHTML=this.languageService.translate.instant("igo.auth.google.logged")))}loginGoogle(e){this.authService.loginWithToken(e,"google").subscribe(()=>{this.appRef.tick(),this.login.emit(!0)})}loadSDKGoogle(){const e=document.getElementsByTagName("script")[0],t=document.createElement("script");t.id="google-jssdk",t.src="https://apis.google.com/js/api.js",t.onload=()=>{this.handleClientLoad()},e.parentNode.insertBefore(t,e)}loadPlatform(){const e=document.getElementsByTagName("script")[0],t=document.createElement("script");t.id="google-platform",t.src="https://apis.google.com/js/platform.js",e.parentNode.insertBefore(t,e)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Rs),r.Y36(W),r.Y36(ue),r.Y36(r.z2F))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-auth-google"]],outputs:{login:"login"},decls:1,vars:0,consts:[["data-height","40","data-width","265","data-longtitle","true",1,"g-signin2","google-login-button"]],template:function(e,t){1&e&&r._UZ(0,"div",0)},styles:["[_nghost-%COMP%]{padding:10px 10px 10px 0;display:inline-block}.google-login-button[_ngcontent-%COMP%]     .abcRioButton{color:#000000de}"],changeDetection:0}),e})(),Ns=(()=>{class e{constructor(e,t,o,i,s){this.authService=e,this.config=t,this.appRef=o,this.msalService=i,this.msalGuardConfig=s,this._destroying$=new O.xQ,this.login=new r.vpe,this.options=this.config.getConfig("auth.microsoft")||{},this.msalService.instance=new Ps.L({auth:this.options,cache:{cacheLocation:"sessionStorage"}}),this.broadcastService=new ks.J$(this.msalService.instance,this.msalService),this.options.clientId?this.broadcastService.inProgress$.pipe((0,$e.h)(e=>e===_s.$H.None),(0,_e.R)(this._destroying$)).subscribe(()=>{this.checkAccount()}):console.warn('Microsoft authentification needs "clientId" option')}loginMicrosoft(){this.msalService.loginPopup(Object.assign({},this.getConf().authRequest)).subscribe(e=>{this.msalService.instance.setActiveAccount(e.account),this.checkAccount()})}checkAccount(){this.msalService.instance.acquireTokenSilent(this.getConf().authRequest).then(e=>{this.authService.loginWithToken(e.accessToken,"microsoft",{tokenId:e.idToken}).subscribe(()=>{this.appRef.tick(),this.login.emit(!0)})}).catch(e=>(0,je.mG)(this,void 0,void 0,function*(){if(e instanceof $s.Yo)return this.msalService.acquireTokenPopup(this.getConf().authRequest);console.log(e)})).catch(e=>{console.log("Silent token fails")})}getConf(){return this.msalGuardConfig.filter(e=>"add"===e.type)[0]}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Rs),r.Y36(W),r.Y36(r.z2F),r.Y36(ks.W2),r.Y36(ks.S9))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-auth-microsoft"]],outputs:{login:"login"},decls:4,vars:3,consts:[["mat-raised-button","",1,"microsoft-login-button",3,"click"],["svgIcon","microsoft"]],template:function(e,t){1&e&&(r.TgZ(0,"button",0),r.NdJ("click",function(){return t.loginMicrosoft()}),r._UZ(1,"mat-icon",1),r._uU(2),r.ALo(3,"translate"),r.qZA()),2&e&&(r.xp6(2),r.hij(" ",r.lcZ(3,1,"igo.auth.microsoft.login"),"\n"))},directives:[n.lW,a.Hw],pipes:[j.X$],styles:["[_nghost-%COMP%]{padding:10px 10px 10px 0;display:inline-block;position:relative;top:-15px}[_nghost-%COMP%] > button[_ngcontent-%COMP%]{font-size:15px;height:40px;width:265px}mat-icon[_ngcontent-%COMP%]{margin-right:10px}"],changeDetection:0}),e})(),Js=(()=>{class e{constructor(e,t){this.instance=e,this.location=t,this.name="@azure/msal-angular",this.version="2.0.0-beta.2";const o=this.location.path(!0).split("#").pop();o&&(this.redirectHash=`#${o}`),this.instance.initializeWrapperLibrary(_s.lA.Angular,this.version)}acquireTokenPopup(e){return(0,Os.D)(this.instance.acquireTokenPopup(e))}acquireTokenRedirect(e){return(0,Os.D)(this.instance.acquireTokenRedirect(e))}acquireTokenSilent(e){return(0,Os.D)(this.instance.acquireTokenSilent(e))}handleRedirectObservable(e){return(0,Os.D)(this.instance.handleRedirectPromise(e||this.redirectHash))}loginPopup(e){return(0,Os.D)(this.instance.loginPopup(e))}loginRedirect(e){return(0,Os.D)(this.instance.loginRedirect(e))}logout(e){return(0,Os.D)(this.instance.logout(e))}logoutRedirect(e){return(0,Os.D)(this.instance.logoutRedirect(e))}logoutPopup(e){return(0,Os.D)(this.instance.logoutPopup(e))}ssoSilent(e){return(0,Os.D)(this.instance.ssoSilent(e))}getLogger(){return this.logger||(this.logger=this.instance.getLogger().clone(this.name,this.version)),this.logger}setLogger(e){this.logger=e.clone(this.name,this.version),this.instance.setLogger(e)}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(ks.sK),r.LFG(h.Ye))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})(),Bs=(()=>{class e{constructor(e,t){this.msalInstance=e,this.authService=t,this._msalSubject=new O.xQ,this.msalSubject$=this._msalSubject.asObservable(),this._inProgress=new C.X(_s.$H.Startup),this.inProgress$=this._inProgress.asObservable(),this.msalInstance.addEventCallback(e=>{this._msalSubject.next(e);const t=qs.w.getInteractionStatusFromEvent(e);null!==t&&(this.authService.getLogger().verbose(`BroadcastService - ${e.eventType} results in setting inProgress to ${t}`),this._inProgress.next(t))})}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(ks.sK),r.LFG(Js))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})(),js=(()=>{class e{constructor(e,t,o,i,s){this.authService=e,this.config=t,this.appRef=o,this.msalService=i,this.msalGuardConfig=s,this._destroying$=new O.xQ,this.login=new r.vpe,this.options=this.config.getConfig("auth.microsoftb2c")||{},this.msalService.instance=new Ps.L({auth:this.options.browserAuthOptions,cache:{cacheLocation:"sessionStorage"}}),this.broadcastService=new Bs(this.msalService.instance,this.msalService),this.options.browserAuthOptions.clientId?this.broadcastService.inProgress$.pipe((0,$e.h)(e=>e===_s.$H.None),(0,_e.R)(this._destroying$)).subscribe(()=>{this.checkAccount()}):console.warn('Microsoft authentification needs "clientId" option')}loginMicrosoftb2c(){this.msalService.loginPopup(Object.assign({},this.getConf().authRequest)).subscribe(e=>{this.msalService.instance.setActiveAccount(e.account),this.checkAccount()})}checkAccount(){this.msalService.instance.acquireTokenSilent(this.getConf().authRequest).then(e=>{this.authService.loginWithToken(e.idToken,"microsoftb2c").subscribe(()=>{this.appRef.tick(),this.login.emit(!0)})}).catch(e=>(0,je.mG)(this,void 0,void 0,function*(){if(e instanceof $s.Yo)return this.msalService.acquireTokenPopup(this.getConf().authRequest)})).catch(e=>{console.log("Silent token fails")})}getConf(){return this.msalGuardConfig.filter(e=>"b2c"===e.type)[0]}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Rs),r.Y36(W),r.Y36(r.z2F),r.Y36(Js),r.Y36(ks.S9))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-auth-microsoftb2c"]],outputs:{login:"login"},decls:4,vars:3,consts:[["mat-raised-button","",1,"microsoft-login-button",3,"click"],["svgIcon","microsoft"]],template:function(e,t){1&e&&(r.TgZ(0,"button",0),r.NdJ("click",function(){return t.loginMicrosoftb2c()}),r._UZ(1,"mat-icon",1),r._uU(2),r.ALo(3,"translate"),r.qZA()),2&e&&(r.xp6(2),r.hij(" ",r.lcZ(3,1,"igo.auth.microsoftb2c.login"),"\n"))},directives:[n.lW,a.Hw],pipes:[j.X$],styles:["[_nghost-%COMP%]{padding:10px 10px 10px 0;display:inline-block;position:relative;top:-15px}[_nghost-%COMP%] > button[_ngcontent-%COMP%]{font-size:15px;height:40px;width:265px}mat-icon[_ngcontent-%COMP%]{margin-right:10px}"],changeDetection:0}),e})(),Qs=(()=>{class e{constructor(e,t,o){this.authService=e,this.config=t,this.appRef=o,this.login=new r.vpe,this.options=this.config.getConfig("auth.facebook")||{},this.options.appId?this.loadSDKFacebook():console.warn('Facebook authentification needs "appId" option')}subscribeEvents(){window.FB.Event.subscribe("auth.statusChange",e=>{this.statusChangeCallback(e)})}statusChangeCallback(e){"connected"===e.status&&this.loginFacebook(e.authResponse.accessToken)}loginFacebook(e){this.authService.loginWithToken(e,"facebook").subscribe(()=>{this.appRef.tick(),this.login.emit(!0)})}loadSDKFacebook(){if(document.getElementById("facebook-jssdk"))return;const e=document.getElementsByTagName("script")[0],t=document.createElement("script");t.id="facebook-jssdk",t.src=`https://connect.facebook.net/fr_CA/sdk.js#xfbml=1&version=v2.9&appId=${this.options.appId}`,t.onload=()=>{this.subscribeEvents()},e.parentNode.insertBefore(t,e)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Rs),r.Y36(W),r.Y36(r.z2F))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-auth-facebook"]],outputs:{login:"login"},decls:1,vars:0,consts:[["scope","public_profile,email","data-max-rows","1","data-size","large","data-button-type","login_with","data-show-faces","false","data-auto-logout-link","false","data-use-continue-as","false",1,"fb-login-button"]],template:function(e,t){1&e&&r._UZ(0,"div",0)},styles:["[_nghost-%COMP%]{padding:10px 10px 10px 0;display:inline-block;position:relative;top:-3px}"],changeDetection:0}),e})();function Gs(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",7),r.NdJ("click",function(){return r.CHM(e),r.oxw().loginAnonymous()}),r._uU(1),r.ALo(2,"translate"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("disabled",e.loading),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.auth.accessAnonymous")," ")}}function Ys(e,t){if(1&e&&(r.TgZ(0,"div"),r._UZ(1,"br"),r.TgZ(2,"font",8),r._uU(3),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(3),r.Oqu(e.error)}}let zs=(()=>{class e{constructor(e,t,o){this.auth=e,this.languageService=t,this._allowAnonymous=!0,this.error="",this.loading=!1,this.login=new r.vpe,this.form=o.group({username:["",We.kI.required],password:["",We.kI.required]})}get allowAnonymous(){return this._allowAnonymous}set allowAnonymous(e){this._allowAnonymous=e}loginUser(e){return this.loading=!0,this.auth.login(e.username,e.password).subscribe(()=>{this.login.emit(!0),this.loading=!1},e=>{try{this.languageService.translate.get("igo.auth.error."+e.error.message).subscribe(e=>this.error=e)}catch(t){this.error=e.error.message}this.loading=!1}),!1}loginAnonymous(){this.auth.loginAnonymous().subscribe(()=>{this.login.emit(!0)})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Rs),r.Y36(ue),r.Y36(We.qu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-auth-intern"]],inputs:{allowAnonymous:"allowAnonymous"},outputs:{login:"login"},decls:14,vars:13,consts:[["role","form",3,"formGroup","ngSubmit"],[1,"full-width"],["matInput","","required","","formControlName","username",3,"placeholder"],["matInput","","required","","type","password","formControlName","password",3,"placeholder"],["mat-raised-button","","type","submit",3,"disabled"],["mat-raised-button","","class","anonymous","type","button",3,"disabled","click",4,"ngIf"],[4,"ngIf"],["mat-raised-button","","type","button",1,"anonymous",3,"disabled","click"],["size","3","color","red"]],template:function(e,t){1&e&&(r.TgZ(0,"form",0),r.NdJ("ngSubmit",function(){return t.loginUser(t.form.value)}),r.TgZ(1,"div"),r.TgZ(2,"mat-form-field",1),r._UZ(3,"input",2),r.ALo(4,"translate"),r.qZA(),r.qZA(),r.TgZ(5,"div"),r.TgZ(6,"mat-form-field",1),r._UZ(7,"input",3),r.ALo(8,"translate"),r.qZA(),r.qZA(),r.TgZ(9,"button",4),r._uU(10),r.ALo(11,"translate"),r.qZA(),r.YNc(12,Gs,3,4,"button",5),r.YNc(13,Ys,4,1,"div",6),r.qZA()),2&e&&(r.Q6J("formGroup",t.form),r.xp6(3),r.s9C("placeholder",r.lcZ(4,7,"igo.auth.user")),r.xp6(4),r.s9C("placeholder",r.lcZ(8,9,"igo.auth.password")),r.xp6(2),r.Q6J("disabled",!t.form.valid||t.loading),r.xp6(1),r.Oqu(r.lcZ(11,11,"igo.auth.login")),r.xp6(2),r.Q6J("ngIf",t.allowAnonymous),r.xp6(1),r.Q6J("ngIf",t.error))},directives:[We._Y,We.JL,We.sg,De.KE,Ve.Nt,We.Fj,We.Q7,We.JJ,We.u,n.lW,h.O5],pipes:[j.X$],styles:[".full-width[_ngcontent-%COMP%]{width:100%}.anonymous[_ngcontent-%COMP%]{margin-left:10px}"]}),e})();function Hs(e,t){1&e&&r._UZ(0,"div",3)}function Vs(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-auth-google",7),r.NdJ("login",function(){return r.CHM(e),r.oxw(3).onLogin()}),r.qZA()}}function Ws(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-auth-microsoft",7),r.NdJ("login",function(){return r.CHM(e),r.oxw(3).onLogin()}),r.qZA()}}function Xs(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-auth-microsoftb2c",7),r.NdJ("login",function(){return r.CHM(e),r.oxw(3).onLogin()}),r.qZA()}}function Ks(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-auth-facebook",7),r.NdJ("login",function(){return r.CHM(e),r.oxw(3).onLogin()}),r.qZA()}}function en(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-auth-intern",8),r.NdJ("login",function(){return r.CHM(e),r.oxw(3).onLogin()}),r.qZA()}if(2&e){const e=r.oxw(3);r.Q6J("allowAnonymous",e.options.allowAnonymous)}}function tn(e,t){if(1&e&&(r.TgZ(0,"div",4),r.TgZ(1,"h1"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.YNc(4,Vs,1,0,"igo-auth-google",5),r.YNc(5,Ws,1,0,"igo-auth-microsoft",5),r.YNc(6,Xs,1,0,"igo-auth-microsoftb2c",5),r.YNc(7,Ks,1,0,"igo-auth-facebook",5),r.YNc(8,en,1,1,"igo-auth-intern",6),r.qZA()),2&e){const e=r.oxw(2);r.xp6(2),r.Oqu(r.lcZ(3,6,"igo.auth.connection")),r.xp6(2),r.Q6J("ngIf",e.options.google&&!1!==e.options.google.enabled),r.xp6(1),r.Q6J("ngIf",e.options.microsoft&&!1!==e.options.microsoft.enabled),r.xp6(1),r.Q6J("ngIf",e.options.microsoftb2c&&!1!==e.options.microsoftb2c.enabled),r.xp6(1),r.Q6J("ngIf",e.options.facebook&&!1!==e.options.facebook.enabled),r.xp6(1),r.Q6J("ngIf",!e.options.intern||!1!==e.options.intern.enabled)}}function on(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",4),r.TgZ(1,"p"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"button",9),r.NdJ("click",function(){return r.CHM(e),r.oxw(2).logout()}),r._uU(5),r.ALo(6,"translate"),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(2);r.xp6(2),r.Oqu(r.xi3(3,2,"igo.auth.welcome",e.user)),r.xp6(3),r.Oqu(r.lcZ(6,5,"igo.auth.signOut"))}}function rn(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",9),r.NdJ("click",function(){return r.CHM(e),r.oxw(3).home()}),r._uU(1),r.ALo(2,"translate"),r.qZA()}2&e&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"igo.auth.home")))}function sn(e,t){if(1&e&&(r.TgZ(0,"div",4),r.TgZ(1,"p"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.YNc(4,rn,3,3,"button",10),r.qZA()),2&e){const e=r.oxw(2);r.xp6(2),r.Oqu(r.lcZ(3,2,"igo.auth.deconnection")),r.xp6(2),r.Q6J("ngIf",e.options.homeRoute)}}function nn(e,t){if(1&e&&(r.TgZ(0,"div"),r.YNc(1,Hs,1,0,"div",1),r.YNc(2,tn,9,8,"div",2),r.YNc(3,on,7,7,"div",2),r.YNc(4,sn,5,4,"div",2),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf",!e.auth.logged&&e.backgroundDisable),r.xp6(1),r.Q6J("ngIf",!e.auth.logged&&e.showLoginDiv),r.xp6(1),r.Q6J("ngIf",e.auth.logged&&e.showAlreadyConnectedDiv),r.xp6(1),r.Q6J("ngIf",e.showLogoutDiv)}}let an=(()=>{class e{constructor(e,t,o){this.auth=e,this.config=t,this.router=o,this._backgroundDisable=!0,this._hasAlreadyConnectedDiv=!0,this._hasLogoutDiv=!0,this._showAlreadyConnectedDiv=!1,this._showLogoutDiv=!1,this.login=new r.vpe,this.visible=!0,this.options=this.config.getConfig("auth")||{},this.visible=0!==Object.getOwnPropertyNames(this.options).length}get backgroundDisable(){return!this.isLogoutRoute&&!this.isLogoutRoute&&this._backgroundDisable}set backgroundDisable(e){this._backgroundDisable="true"===e.toString()}get hasAlreadyConnectedDiv(){return this._hasAlreadyConnectedDiv}set hasAlreadyConnectedDiv(e){this._hasAlreadyConnectedDiv="true"===e.toString()}get hasLogoutDiv(){return this._hasLogoutDiv}set hasLogoutDiv(e){this._hasLogoutDiv="true"===e.toString()}get showAlreadyConnectedDiv(){return this.isLogoutRoute?this.hasAlreadyConnectedDiv:this._showAlreadyConnectedDiv}set showAlreadyConnectedDiv(e){this._showAlreadyConnectedDiv="true"===e.toString()}get showLogoutDiv(){return this.isLogoutRoute?this.hasLogoutDiv:this._showLogoutDiv}set showLogoutDiv(e){this._showLogoutDiv="true"===e.toString()}get showLoginDiv(){if(!this.isLogoutRoute)return!0}ngOnInit(){this.analyzeRoute(),this.getName()}onLogin(){this.auth.goToRedirectUrl(),this.getName(),this.login.emit(!0)}logout(){this.auth.logout().subscribe(()=>{this.user=void 0,this.router&&(this.options.logoutRoute?this.router.navigate([this.options.logoutRoute]):this.options.homeRoute&&this.router.navigate([this.options.homeRoute]))})}home(){this.router&&this.options.homeRoute&&this.router.navigate([this.options.homeRoute])}getName(){const e=this.auth.decodeToken();e&&(this.user={name:e.user.firstName||e.user.sourceId})}analyzeRoute(){!this.router||this.router.events.pipe((0,$e.h)(e=>e instanceof d.OD)).subscribe(e=>{if(e.url){const t=e.url,o=this.options.loginRoute;this.isLogoutRoute=t===this.options.logoutRoute,this.isLoginRoute=t===o,this.isLogoutRoute&&this.auth.logout()}})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Rs),r.Y36(W),r.Y36(d.F0,8))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-auth-form"]],inputs:{backgroundDisable:"backgroundDisable",hasAlreadyConnectedDiv:"hasAlreadyConnectedDiv",hasLogoutDiv:"hasLogoutDiv",showAlreadyConnectedDiv:"showAlreadyConnectedDiv",showLogoutDiv:"showLogoutDiv"},outputs:{login:"login"},decls:1,vars:1,consts:[[4,"ngIf"],["class","backgroundDisable",4,"ngIf"],["class","login center-block",4,"ngIf"],[1,"backgroundDisable"],[1,"login","center-block"],[3,"login",4,"ngIf"],[3,"allowAnonymous","login",4,"ngIf"],[3,"login"],[3,"allowAnonymous","login"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","button",3,"click",4,"ngIf"]],template:function(e,t){1&e&&r.YNc(0,nn,5,4,"div",0),2&e&&r.Q6J("ngIf",t.visible)},directives:[h.O5,Us,Ns,js,Qs,zs,n.lW],pipes:[j.X$],styles:["[_nghost-%COMP%]{z-index:999}div.login[_ngcontent-%COMP%]{z-index:200;width:90%;min-width:360px;max-width:600px;padding:25px 50px;border:1px solid;background-color:#fff;border-color:#888}.center-block[_ngcontent-%COMP%]{position:fixed;top:20%;left:50%;transform:translate(-50%)}.backgroundDisable[_ngcontent-%COMP%]{position:fixed;top:0;left:0;background:#000;opacity:.8;z-index:100;height:100%;width:100%}"]}),e})(),ln=(()=>{class e{constructor(e,t,o){this.config=e,this.tokenService=t,this.http=o,this.refreshInProgress=!1}get trustHosts(){const e=this.config.getConfig("auth.trustHosts")||[];return e.push(window.location.hostname),e}get hostsWithCredentials(){return this.config.getConfig("auth.hostsWithCredentials")||[]}intercept(e,t){const o=this.handleHostsWithCredentials(e.url);let i=e.clone();o&&(i=e.clone({withCredentials:o})),this.refreshToken();const r=this.tokenService.get(),s=document.createElement("a");if(s.href=i.url,""===s.host&&(s.href=s.href),!r||-1===this.trustHosts.indexOf(s.hostname))return t.handle(i);let n=i.clone({headers:i.headers.set("Authorization",`Bearer ${r}`)});const a=this.tokenService.decode();if("true"===n.params.get("_i")&&a&&a.user&&a.user.sourceId){const e=Ds.V.hashStr(a.user.sourceId);n=n.clone({params:n.params.set("_i",e)})}else"true"===n.params.get("_i")&&(n=n.clone({params:n.params.delete("_i")}));return t.handle(n)}interceptXhr(e,t){const o=this.handleHostsWithCredentials(t);if(o)return e.withCredentials=o,!0;this.refreshToken();const i=document.createElement("a");i.href=t;const r=this.tokenService.get();return!(!r||-1===this.trustHosts.indexOf(i.hostname)||(e.setRequestHeader("Authorization","Bearer "+r),0))}handleHostsWithCredentials(e){let t=!1;for(const o of this.hostsWithCredentials)if(new RegExp(o.domainRegFilters).test(e)){t=void 0!==o.withCredentials?o.withCredentials:void 0;break}return t}refreshToken(){const e=this.tokenService.decode(),t=(new Date).getTime()/1e3;if(!this.refreshInProgress&&e&&t<e.exp&&t>e.exp-1800){this.refreshInProgress=!0;const e=this.config.getConfig("auth.url");return this.http.post(`${e}/refresh`,{}).subscribe(e=>{this.tokenService.set(e.token),this.refreshInProgress=!1},e=>(e.error.caught=!0,e))}}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(W),r.LFG(Es),r.LFG(y.eN))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function cn(e){const t=e.getConfig("auth.microsoft")||{};return t.redirectUri=t.redirectUri||window.location.href,t.authority=t.authority||"https://login.microsoftonline.com/organizations",new Ps.L({auth:t,cache:{cacheLocation:"sessionStorage"}})}function un(e){const t=e.getConfig("auth.microsoftb2c.browserAuthOptions")||{};return t.redirectUri=t.redirectUri||window.location.href,t.authority=t.authority||"https://login.microsoftonline.com/organizations",new Ps.L({auth:t,cache:{cacheLocation:"sessionStorage"}})}function pn(e){return e.getConfig("auth.microsoft"),{interactionType:_s.s_.Popup,authRequest:{scopes:["user.read"],loginHint:"todo"},type:"add"}}function dn(e){const t=e.getConfig("auth.microsoftb2c.browserAuthOptions")||{};return{interactionType:_s.s_.Popup,authRequest:{scopes:[t.clientId]},type:"b2c"}}function hn(e){return"b2c"===e?[{provide:ks.sK,useFactory:un,deps:[W]},{provide:ks.S9,useFactory:dn,deps:[W],multi:!0},Js]:[{provide:ks.sK,useFactory:cn,deps:[W]},{provide:ks.S9,useFactory:pn,deps:[W],multi:!0},ks.W2]}let gn=(()=>{class e extends Se{constructor(e,t,o,i){super(e),this.http=t,this.authService=o,this.tokenService=i,this.authService.authenticate$.subscribe(e=>{e&&this.options.url&&this.http.get(this.options.url).subscribe(e=>{if(e&&e.preference)for(const t of Object.keys(e.preference))super.set(t,e.preference[t])})})}set(e,t,o=xe.LOCAL){if(o===xe.LOCAL&&this.authService.authenticated&&this.options.url){const o={};o[e]=t,this.http.patch(this.options.url,{preference:o}).subscribe()}super.set(e,t,o)}remove(e,t=xe.LOCAL){if(t===xe.LOCAL&&this.authService.authenticated&&this.options.url){const t={};t[e]=void 0,this.http.patch(this.options.url,{preference:t}).subscribe()}super.remove(e,t)}clear(e=xe.LOCAL){let t;e===xe.LOCAL&&this.authService.authenticated&&this.options.url&&this.http.patch(this.options.url,{preference:{}},{params:{mergePreference:"false"}}).subscribe(),e===xe.LOCAL&&(t=this.tokenService.get()),super.clear(e),t&&this.tokenService.set(t),e===xe.LOCAL&&this.authService.authenticated&&this.options.url&&this.http.get(this.options.url).subscribe(e=>{if(e&&e.preference)for(const t of Object.keys(e.preference))super.set(t,e.preference[t])})}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(W),r.LFG(y.eN),r.LFG(Rs),r.LFG(Es))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),mn=(()=>{class e{static forRoot(){return{ngModule:e,providers:[{provide:y.TP,useClass:ln,multi:!0},{provide:Se,useClass:gn},...hn("add"),...hn("b2c")]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,We.UX,De.lN,Ve.c,a.Ps,n.ot,ne,ks.up]]}),e})();const fn=d.Bz.forChild([{path:"auth-form",component:(()=>{class e{constructor(e){this.languageService=e,this.idsActivity=[]}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ue))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-auth-form"]],decls:17,vars:0,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/auth/auth-form"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/environments"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Auth"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Authentification"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: ConfigService, LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"br"),r._uU(13," See auth section of the "),r.TgZ(14,"a",1),r._uU(15," environment config"),r.qZA(),r.qZA(),r.qZA(),r._UZ(16,"igo-auth-form"))},directives:[g.a8,g.$j,g.n5,g.dn,an],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e})()}]);let yn=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[fn,g.QW,mn.forRoot()]]}),e})();var vn=o(42720),bn=o(90490),xn=o(8117),wn=o(12702),Sn=o(20088),Cn=o(56816),Tn=o(78767),An=o(85105),Ln=o(13513),Zn=o(21753),Fn=o(33697),On=o(57969),Mn=o(13966),In=o(83136),kn=o(93405),Pn=o(38549),_n=o(32475),$n=o(21380),qn=o(53809),Dn=o(31391),En=o(56274),Rn=o(20737),Un=o(16274),Nn=o(6888),Jn=o(49040),Bn=o(16212),jn=o(21049),Qn=o(94770),Gn=o(64330),Yn=o(51819),zn=o(88257),Hn=o(88176),Vn=o(22798),Wn=o(18570),Xn=o(5883),Kn=o(76238),ea=o(82146),ta=o(70032),oa=o(95403),ia=o(6037),ra=o(82424),sa=o(39968),na=o(6001),aa=o(57743),la=o(74154),ca=o(40113),ua=o(2281),pa=o(16801),da=o(95567),ha=o(73951),ga=o(75529),ma=o(33809),fa=o(44280),ya=o(68190),va=o(40866),ba=o(47976),xa=o(62346),wa=o(70690),Sa=o(6203),Ca=o(56384),Ta=o(61273),Aa=o(49010),La=o(21119),Za=o(72966),Fa=o(95361),Oa=o(83437),Ma=o(25031),Ia=o(3421),ka=o(14426),Pa=o(26101),_a=o(12891),$a=o(43219),qa=o(92804),Da=o(91099),Ea=o(52162),Ra=o(64961),Ua=o(22850),Na=o(37202),Ja=o(3096),Ba=o(98358),ja=o(67496),Qa=o(17226),Ga=o(66613),Ya=o(62294),za=o(98431),Ha=o(16176),Va=o(19031),Wa=o(60186),Xa=o(99034),Ka=o(70764),el=o(62738),tl=o(45552),ol=o(87730),il=o(73277),rl=(o(90714),o(24492),o(28519)),sl=o(80521),nl=o(97411),al=o(65877),ll=o(99673),cl=o(10757),ul=o(42127),pl=o(3023),dl=o(70509),hl=o(74749),gl=o(97797),ml=o(14425),fl=o(52195),yl=o.n(fl),vl=o(17284),bl=o(37254);let xl=(()=>{class e{constructor(){}open(e){e.extern&&window.open(e.url,"_blank")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function wl(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",1),r.NdJ("click",function(){r.CHM(e);const t=r.oxw();return t.openMetadata(t.options.metadata)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",2),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("matTooltip",r.lcZ(1,2,"igo.geo.metadata.show"))("color",e.color)}}function Sl(e,t){if(1&e&&(r.TgZ(0,"mat-dialog-content",3),r.TgZ(1,"h3"),r._uU(2),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(2),r.Oqu(e.data.abstract)}}function Cl(e,t){if(1&e&&(r.TgZ(0,"mat-dialog-content",3),r._UZ(1,"h3",4),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("innerHTML",e.data.abstract,r.oJD)}}let Tl=(()=>{class e{constructor(e,t){this.metadataService=e,this.dialog=t,this._color="primary"}get layer(){return this._layer}set layer(e){this._layer=e}get color(){return this._color}set color(e){this._color=e}openMetadata(e){e.extern?this.metadataService.open(e):!e.extern&&e.abstract&&this.dialog.open(Al,{data:{layerTitle:this.layer.title,abstract:e.abstract,type:e.type}})}get options(){if(this.layer)return this.layer.options}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(xl),r.Y36(ze.uw))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-metadata-button"]],inputs:{layer:"layer",color:"color"},decls:1,vars:1,consts:[["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click"],["svgIcon","information-outline"]],template:function(e,t){1&e&&r.YNc(0,wl,3,4,"button",0),2&e&&r.Q6J("ngIf",t.options&&t.options.metadata&&t.options.metadata.url||t.options&&t.options.metadata&&t.options.metadata.abstract)},directives:[h.O5,n.lW,p.gM,a.Hw],pipes:[j.X$],styles:[""],changeDetection:0}),e})(),Al=(()=>{class e{constructor(e){this.data=e}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ze.WI))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-metadata-abstract"]],decls:6,vars:3,consts:[["mat-dialog-title",""],["mat-button","","mat-dialog-close","",1,"close-button"],["class","mat-typography",4,"ngIf"],[1,"mat-typography"],[3,"innerHTML"]],template:function(e,t){1&e&&(r.TgZ(0,"h2",0),r._uU(1),r.qZA(),r.TgZ(2,"button",1),r._uU(3,"X"),r.qZA(),r.YNc(4,Sl,3,1,"mat-dialog-content",2),r.YNc(5,Cl,2,1,"mat-dialog-content",2)),2&e&&(r.xp6(1),r.Oqu(t.data.layerTitle),r.xp6(3),r.Q6J("ngIf","arcgisrest"!==t.data.type),r.xp6(1),r.Q6J("ngIf","arcgisrest"===t.data.type))},directives:[ze.uh,n.lW,ze.ZT,h.O5,ze.xY],styles:[".close-button{top:5px;right:5px;padding:7px;line-height:10px;position:absolute!important;min-width:auto}mat-dialog-container{position:relative}\n"],encapsulation:2}),e})(),Ll=(()=>{class e{static forRoot(){return{ngModule:e,providers:[]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,a.Ps,n.ot,p.AV,ne,ze.Is]]}),e})();const Zl="Feature";var Fl=(()=>{return(e=Fl||(Fl={}))[e.None=0]="None",e[e.Move=1]="Move",e[e.Zoom=2]="Zoom",e[e.Default=3]="Default",Fl;var e})();class Ol extends B{constructor(e,t,o){super(),this.loaded=0,this.loading=0,this.source=e.options.source.ol,this.id=N(),this.messageService=t,this.languageService=o}watch(){this.source.on("imageloadstart",e=>this.handleLoadStart(e)),this.source.on("imageloadend",e=>this.handleLoadEnd(e)),this.source.on("imageloaderror",e=>this.handleLoadEnd(e)),this.source.on("imageloaderror",e=>this.handleLoadError(e))}unwatch(){this.source.un("imageloadstart",e=>this.handleLoadStart(e)),this.source.un("imageloadend",e=>this.handleLoadEnd(e)),this.source.un("imageloaderror",e=>this.handleLoadEnd(e)),this.source.un("imageloaderror",e=>this.handleLoadError(e))}handleLoadStart(e){e.image.__watchers__||(e.image.__watchers__=[]),e.image.__watchers__.push(this.id),this.loading+=1,this.status=J.Working}handleLoadEnd(e){if(!e.image.__watchers__)return;const t=e.image.__watchers__.indexOf(this.id);if(t<0)return;e.image.__watchers__.splice(t,1),this.loaded+=1;const o=this.loading;this.loaded>=o&&o===this.loading&&(this.status=J.Done,this.loaded=this.loading=0)}handleLoadError(e){if(!e.image.__watchers__)return;const t=this.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),o=this.languageService.translate.instant("igo.geo.dataSource.unavailable",{value:e.target.params_.LAYERS});this.messageService.error(o,t),this.loaded=-1,this.loading=0,this.status=J.Error}}var Ml=(()=>{return(e=Ml||(Ml={})).OPACITY="opacity",e.VISIBLE="visible",e.OGCFILTERS="ogcFilters",e.MINRESOLUTION="minResolution",e.MAXRESOLUTION="maxResolution",e.ZINDEX="zIndex",e.TIMEFILTER="timeFilter",Ml;var e})(),Il=(()=>{return(e=Il||(Il={})).TITLE="title",e.ABSTRACT="abstract",e.CUSTOM="custom",Il;var e})();function kl(e){return({wms:Pl,wmts:_l,xyz:$l,feature:ql,wfs:Dl,arcgisrest:El,imagearcgisrest:El,tilearcgisrest:El,osm:e=>"OSM",tiledebug:e=>"tiledebug"}[e.type]||Rl)(e)}function Pl(e){const t=e.params.LAYERS,o=Ul(e.url);return Ds.V.hashStr("wms"+o+t)}function _l(e){const t=e.layer,o=Ul(e.url);return Ds.V.hashStr("wmts"+o+t)}function $l(e){const t=Ul(e.url);return Ds.V.hashStr("xyz"+t)}function ql(e){if(!e.url)return Rl();const t=Ul(e.url);return Ds.V.hashStr("feature"+t)}function Dl(e){if(!e.url||!e.params)return Rl();const t=Ul(e.url);return Ds.V.hashStr("wfs"+t+e.params.featureTypes)}function El(e){const t=e.layer,o=Ul(e.url);return Ds.V.hashStr((e.type||"arcgis")+o+t)}function Rl(e){return N()}function Ul(e){const t=("/"===e.charAt(0)?window.location.origin+e:e).split(/[?&]/);let o=t.shift();const i=t.filter(e=>0!==e.length&&"_"!==e.charAt(0));return i.length&&(o+="?"+i.join("&")),o}class Nl{constructor(e={},t){this.options=e,this.dataService=t,this.options=e,this.id=this.options.id||this.generateId(),this.ol=this.createOlSource()}generateId(){return kl(this.options)}getLegend(e,t){return this.legend?this.legend:[]}setLegend(e){return this.legend=e.url?[{url:e.url}]:e.html?[{html:e.html}]:[],this.legend}}var Jl=(()=>{return(e=Jl||(Jl={})).BasicNumericOperator="basicnumericoperator",e.Basic="basic",e.BasicAndSpatial="basicandspatial",e.Spatial="spatial",e.All="all",e.Time="time",Jl;var e})(),Bl=(()=>{return(e=Bl||(Bl={})).BBOX="BBox",e.PropertyIsBetween="PropertyIsBetween",e.Contains="Contains",e.During="During",e.PropertyIsEqualTo="PropertyIsEqualTo",e.PropertyIsGreaterThan="PropertyIsGreaterThan",e.PropertyIsGreaterThanOrEqualTo="PropertyIsGreaterThanOrEqualTo",e.Intersects="Intersects",e.PropertyIsNull="PropertyIsNull",e.PropertyIsLessThan="PropertyIsLessThan",e.PropertyIsLessThanOrEqualTo="PropertyIsLessThanOrEqualTo",e.PropertyIsLike="PropertyIsLike",e.PropertyIsNotEqualTo="PropertyIsNotEqualTo",e.Within="Within",e.And="And",e.Or="Or",e.Not="Not",Bl;var e})();const jl=ua;class Ql{constructor(){this.filterSequence=[],this.operators={[Bl.PropertyIsEqualTo]:{spatial:!1,fieldRestrict:[]},[Bl.PropertyIsNotEqualTo]:{spatial:!1,fieldRestrict:[]},[Bl.PropertyIsLike]:{spatial:!1,fieldRestrict:["string"]},[Bl.PropertyIsGreaterThan]:{spatial:!1,fieldRestrict:["number"]},[Bl.PropertyIsGreaterThanOrEqualTo]:{spatial:!1,fieldRestrict:["number"]},[Bl.PropertyIsLessThan]:{spatial:!1,fieldRestrict:["number"]},[Bl.PropertyIsLessThanOrEqualTo]:{spatial:!1,fieldRestrict:["number"]},[Bl.PropertyIsBetween]:{spatial:!1,fieldRestrict:["number"]},[Bl.During]:{spatial:!1,fieldRestrict:[]},[Bl.PropertyIsNull]:{spatial:!1,fieldRestrict:[]},[Bl.Intersects]:{spatial:!0,fieldRestrict:[]},[Bl.Within]:{spatial:!0,fieldRestrict:[]},[Bl.Contains]:{spatial:!0,fieldRestrict:[]}}}defineOgcFiltersDefaultOptions(e,t,o){let i=!0;return o&&"wms"===o&&(i=!1),(e=e||{}).enabled=void 0===e.enabled?i:e.enabled,e.editable=void 0===e.editable?i:e.editable,e.geometryName=t,e.advancedOgcFilters=!0,e.enabled&&(e.pushButtons||e.checkboxes||e.radioButtons||e.select)&&(e.advancedOgcFilters=!1),e}buildFilter(e,t,o,i,r){let s,n,a;if(n=!/intersects|contains|within/gi.test(JSON.stringify(e)),e&&(i=void 0!==e.geometryName?e.geometryName:i),t&&e&&(s=aa.VW(i,t,o.getCode())),!e)return"bbox="+t.join(",")+","+o.getCode();e=this.checkIgoFiltersProperties(e,i,o),a=t&&n?aa.xD(s,this.bundleFilter(e,r)):this.bundleFilter(e,r);const l={srsName:"",featureNS:"",featurePrefix:"",featureTypes:["featureTypes"],filter:a,outputFormat:"",geometryName:i},c=(new ca.Z).writeGetFeature(l);return"filter="+(new XMLSerializer).serializeToString(c).split(/typenames *=|typename *=\"featureTypes\" *>/gi)[1].split(/<\/Query><\/GetFeature>/gi)[0]}bundleFilter(e,t){if(e instanceof Array){const o=[];return e.forEach(e=>{o.push(this.bundleFilter(e,t))}),o}return e.hasOwnProperty("logical")?this.createFilter({operator:e.logical,logicalArray:this.bundleFilter(e.filters,t)},t):e.hasOwnProperty("operator")?this.createFilter(e,t):void 0}createFilter(e,t){const o=e.operator,i=e.logicalArray,r=e.propertyName,s=e.pattern,n=!e.matchCase||e.matchCase,a=e.wildCard?e.wildCard:"*",l=e.singleChar?e.singleChar:".",c=e.escapeChar?e.escapeChar:"!",u=e.lowerBoundary,p=e.upperBoundary,d=e.geometryName,h=e.extent,g=e.wkt_geometry,m=e.srsName?e.srsName:"EPSG:3857",f=this.parseFilterOptionDate(e.begin,t?t.minDate:void 0),y=this.parseFilterOptionDate(e.end,t?t.maxDate:void 0),v=e.expression;let b;switch(g&&(b=(new la.Z).readGeometry(g,{dataProjection:m,featureProjection:m||"EPSG:3857"})),o.toLowerCase()){case Bl.BBOX.toLowerCase():return aa.VW(d,h,m);case Bl.PropertyIsBetween.toLowerCase():return aa.vX(r,u,p);case Bl.Contains.toLowerCase():return aa.r3(d,b,m);case Bl.During.toLowerCase():return aa.Q9(r,f,y);case Bl.PropertyIsEqualTo.toLowerCase():return aa.EW(r,v,n);case Bl.PropertyIsGreaterThan.toLowerCase():return aa.tS(r,v);case Bl.PropertyIsGreaterThanOrEqualTo.toLowerCase():return aa.wZ(r,v);case Bl.Intersects.toLowerCase():return aa.kK(d,b,m);case Bl.PropertyIsNull.toLowerCase():return aa.Ft(r);case Bl.PropertyIsLessThan.toLowerCase():return aa.Qj(r,v);case Bl.PropertyIsLessThanOrEqualTo.toLowerCase():return aa.MK(r,v);case Bl.PropertyIsLike.toLowerCase():return aa.vL(r,s.replace(/[()_]/gi,l),a,l,c,n);case Bl.PropertyIsNotEqualTo.toLowerCase():return aa.eI(r,v,n);case Bl.Within.toLowerCase():return aa.uh(d,b,m);case Bl.And.toLowerCase():return aa.xD.apply(null,i);case Bl.Or.toLowerCase():return aa.or.apply(null,i);case Bl.Not.toLowerCase():return aa.ff.apply(null,i);default:return}}defineInterfaceFilterSequence(e,t,o="",i=-1){return e instanceof Array?e.forEach(e=>{this.filterSequence.concat(this.defineInterfaceFilterSequence(e,t,o,i))}):e.hasOwnProperty("logical")?this.filterSequence.concat(this.defineInterfaceFilterSequence(e.filters,t,e.logical,i+=1)):e.hasOwnProperty("operator")&&this.filterSequence.push(this.addInterfaceFilter(e,t,i,o)),this.filterSequence}computeAllowedOperators(e,t,o){let i,r,s,n={};if(e&&t){const r=e.find(e=>e.name===t);i=r&&r.allowedOperatorsType?r.allowedOperatorsType:o}switch(e&&e.map(e=>{if(!e.allowedOperatorsType)return;const t=e.allowedOperatorsType.toLowerCase();(t===Jl.All.toLowerCase()||t===Jl.Spatial.toLowerCase()||t===Jl.BasicAndSpatial.toLowerCase())&&(r=!0,t===Jl.All.toLowerCase()&&(s=!0))}),i=i||Jl.BasicAndSpatial,i.toLowerCase()){case Jl.All:n=this.operators;break;case Jl.Spatial:n={[Bl.Intersects]:{spatial:!0,fieldRestrict:[]},[Bl.Within]:{spatial:!0,fieldRestrict:[]}};break;case Jl.BasicAndSpatial:n={[Bl.PropertyIsEqualTo]:{spatial:!1,fieldRestrict:[]},[Bl.PropertyIsNotEqualTo]:{spatial:!1,fieldRestrict:[]},[Bl.Intersects]:{spatial:!0,fieldRestrict:[]},[Bl.Within]:{spatial:!0,fieldRestrict:[]}};break;case Jl.Basic:n={[Bl.PropertyIsEqualTo]:{spatial:!1,fieldRestrict:[]},[Bl.PropertyIsNotEqualTo]:{spatial:!1,fieldRestrict:[]}};break;case Jl.Time:n={[Bl.During]:{spatial:!1,fieldRestrict:[]}};break;case Jl.BasicNumericOperator:n={[Bl.PropertyIsEqualTo]:{spatial:!1,fieldRestrict:[]},[Bl.PropertyIsNotEqualTo]:{spatial:!1,fieldRestrict:[]},[Bl.PropertyIsGreaterThan]:{spatial:!1,fieldRestrict:["number"]},[Bl.PropertyIsGreaterThanOrEqualTo]:{spatial:!1,fieldRestrict:["number"]},[Bl.PropertyIsLessThan]:{spatial:!1,fieldRestrict:["number"]},[Bl.PropertyIsLessThanOrEqualTo]:{spatial:!1,fieldRestrict:["number"]}};break;default:n={[Bl.PropertyIsEqualTo]:{spatial:!1,fieldRestrict:[]},[Bl.PropertyIsNotEqualTo]:{spatial:!1,fieldRestrict:[]},[Bl.Intersects]:{spatial:!0,fieldRestrict:[]},[Bl.Within]:{spatial:!0,fieldRestrict:[]}}}return r&&(n.Intersects={spatial:!0,fieldRestrict:[]},n.Within={spatial:!0,fieldRestrict:[]},s&&(n.Contains={spatial:!0,fieldRestrict:[]})),n}addInterfaceFilter(e,t,o=0,i="Or"){e||(e={operator:"PropertyIsEqualTo"});const r={propertyName:"",operator:"",active:"",filterid:N(),step:"",begin:"",end:"",sliderOptions:{},lowerBoundary:"",upperBoundary:"",expression:"",pattern:"",wildCard:"*",singleChar:".",escapeChar:"!",matchCase:!0,igoSpatialSelector:"",igoSNRC:"",geometryName:"",geometry:"",wkt_geometry:"",extent:"",srsName:"",parentLogical:"",level:0};return Object.assign(r,{parentLogical:i,level:o,geometryName:t},e)}checkIgoFiltersProperties(e,t,o,i=!1){const r=[];return e instanceof Array?(e.forEach(e=>{r.push(this.checkIgoFiltersProperties(e,t,o,i))}),r):e.hasOwnProperty("logical")?Object.assign({},{logical:e.logical,filters:this.checkIgoFiltersProperties(e.filters,t,o,i)}):e.hasOwnProperty("operator")?this.addFilterProperties(e,t,o,i):void 0}addFilterProperties(e,t,o,i=!1){const r=e.hasOwnProperty("filterid")?e.filterid:N(),s=e.hasOwnProperty("active")?e.active:i,n=e.hasOwnProperty("srsName")?e.srsName:o?o.getCode():"EPSG:3857";return Object.assign({},{filterid:r,active:s,igoSpatialSelector:"fixedExtent",srsName:n},e,{geometryName:t})}rebuiltIgoOgcFilterObjectFromSequence(e){if(e instanceof Array&&e.length>=1){let t,o,i=e[0].parentLogical,r=[];return e.forEach(s=>{const n=Object.assign({},s),a=e.indexOf(s);t=a>=0&&a<e.length-1?e[a+1]:n,delete n.active,delete n.filterid,delete n.parentLogical,r.push(n),1===e.length?o=n:i!==t.parentLogical&&(1===r.length?console.log("You must set at least two operator in a logical ("+i+")"):(o=Object.assign({},{logical:i,filters:r}),r=[o],i=t.parentLogical))}),o}}computeIgoSelector(e){if(e.groups.every(e=>void 0!==e.computedSelectors))return e;let t;if(e.groups&&e.bundles){if(!e.bundles.every(e=>void 0!==e.id))throw new Error("You must set an id for each of your bundles");t=D.copyDeep(e),t.groups.forEach(e=>{e.title=e.title?e.title:e.name,e.enabled=!!e.enabled&&e.enabled,e.computedSelectors=D.copyDeep(t.bundles.filter(t=>e.ids.includes(t.id)))})}else!e.groups&&e.bundles?(t=D.copyDeep(e),t.groups=[{title:"group1",name:"group1",computedSelectors:D.copyDeep(t.bundles)}]):t={bundles:e,groups:[{title:"group1",name:"group1",computedSelectors:D.copyDeep(e)}],selectorType:t.selectorType};return t.groups.find(e=>e.enabled)||(t.groups[0].enabled=!0),t}handleOgcFiltersAppliedValue(e,t,o,i){const r=e.ogcFilters;if(!r)return;const s=[];let n="",a="";if(r.enabled&&(r.pushButtons||r.checkboxes||r.radioButtons||r.select)){let e;if(r.pushButtons){e=r.pushButtons;const t=this.formatGroupAndFilter(r,e);for(const e of t)s.push(e)}if(r.checkboxes){e=r.checkboxes;const t=this.formatGroupAndFilter(r,e);for(const e of t)s.push(e)}if(r.radioButtons){e=r.radioButtons;const t=this.verifyMultipleEnableds(e),o=this.formatGroupAndFilter(r,t);for(const e of o)s.push(e)}if(r.select){e=r.select;const t=this.verifyMultipleEnableds(e),o=this.formatGroupAndFilter(r,t);for(const e of o)s.push(e)}s.length>=1&&(n=this.buildFilter(1===s.length?s[0]:{logical:"And",filters:s},o,i,r.geometryName))}r.enabled&&r.filters&&(r.geometryName=r.geometryName||t,a=this.buildFilter(r.filters,o,i,r.geometryName,e));let l=r.advancedOgcFilters?a:n;return"wms"===e.type&&(l=this.formatProcessedOgcFilter(l,e.params.LAYERS)),"wfs"===e.type&&(l=this.formatProcessedOgcFilter(l,e.params.featureTypes)),l}verifyMultipleEnableds(e){return e.bundles.forEach(e=>{if(!e.multiple){const t=e.selectors.reduce((e,t,o)=>!0===t.enabled?e.concat(o):e,[]);t.length>1&&(t.splice(0,1),t.forEach(t=>{e.selectors[t].enabled=!1}))}}),e}formatGroupAndFilter(e,t){const o=(t=this.computeIgoSelector(t)).groups.find(e=>e.enabled).computedSelectors,i=[];return o.map(e=>{const t=[],o=e.selectors;!o||(o.filter(e=>!0===e.enabled).forEach(e=>t.push(e.filters)),1===t.length?i.push(t[0]):t.length>1&&i.push({logical:e.logical,filters:t}))}),"pushButton"===t.selectorType?e.pushButtons=t:"checkbox"===t.selectorType?e.checkboxes=t:"radioButton"===t.selectorType?e.radioButtons=t:"select"===t.selectorType&&(e.select=t),i}formatProcessedOgcFilter(e,t){let o="";return 0===e.length&&-1===t.indexOf(",")?o=e:t.split(",").forEach(t=>{o=`${o}(${e.replace("filter=","")})`}),o=o.replace(/\(\)/g,""),o.length>0?o.replace("filter=",""):void 0}parseFilterOptionDate(e,t){return e?jl(e).isValid()?e:void 0:t}}var Gl=(()=>{return(e=Gl||(Gl={})).GML2="gml2",e.GML3="gml3",e.JSON="json",e.GEOJSON="geojson",e.GEOJSON2="geojson2",e.ESRIJSON="esrijson",e.TEXT="text",e.HTML="html",e.HTMLGML2="htmlgml2",Gl;var e})(),Yl=(()=>{return(e=Yl||(Yl={})).GML2="application/vnd.ogc.gml",e.GML3="application/vnd.ogc.gml/3.1.1",e.JSON="application/json",e.GEOJSON="application/geojson",e.GEOJSON2="geojson",e.ESRIJSON="application/json",e.TEXT="text/plain",e.HTML="text/html",e.HTMLGML2="text/html",Yl;var e})(),zl=(()=>{return(e=zl||(zl={})).IFRAME="iframe",e.BLANK="_blank",zl;var e})();const Hl="EPSG:3857",Vl=5e3,Wl="geometry",Xl=new RegExp(/(.*)?gml(.*)?/gi);function Kl(e,t,o,i){const r=e.paramsWFS,s=ec(e,void 0,e.paramsWFS.srsName);let n;i&&i.enabled&&(n=i.filters);const a=new Ql,l=a.buildFilter(n,t,o,i.geometryName,e);let c=a.handleOgcFiltersAppliedValue(e,i.geometryName,t,o),u="filter";c||(u="bbox",c=t.join(",")+","+o.getCode()),r.xmlFilter=i.advancedOgcFilters?l:`${u}=${c}`;let p=s.find(e=>"getfeature"===e.name).value;return p=/(filter|bbox)=.*/gi.test(r.xmlFilter)?`${p}&${r.xmlFilter}`:p,e.download=Object.assign({},e.download,{dynamicUrl:p}),p.replace(/&&/g,"&")}function ec(e,t,o,i,r=0,s=!1){const n="2.0.0",a=e.urlWfs,l=e.paramsWFS,c=t||Vl,u=l.version===n?`startIndex=${r}`:"",p=o||Hl;let d=l.outputFormat?`outputFormat=${l.outputFormat}`:"",h=l.version?`version=${l.version}`:"version=2.0.0";const g=`${l.version===n?"typenames":"typename"}=${l.featureTypes}`,m=l.version===n?"count":"maxFeatures";let f=t?`${m}=${c}`:l.maxFeatures?`${m}=${l.maxFeatures}`:`${m}=${c}`;s&&(d="",h="version=1.1.0",f=f.replace("count","maxFeatures"));const y=o?`srsname=${p}`:l.srsName?"srsname="+l.srsName:`srsname=${p}`;let v="",b="";i&&(v=`propertyName=${i}`,b=`valueReference=${i}`);const x=e.sourceFields;if(!v&&x&&x.length>0){const t=[];e.sourceFields.forEach(e=>{t.push(e.name)}),v=`propertyName=${t.join(",")},${l.fieldNameGeometry}`}const w=-1===a.indexOf("?")?"?":"&";let S=`${a}${w}service=WFS&request=GetFeature&${h}&${g}&`;S+=`${d}&${y}&${f}&${v}&${u}`;let C=`${a}?service=WFS&request=GetPropertyValue&version=${n}&${g}&`;return C+=`&${f}&${b}`,[{name:"outputformat",value:d},{name:"version",value:h},{name:"typename",value:g},{name:"count",value:f},{name:"srsname",value:y},{name:"propertyname",value:v},{name:"valuereference",value:b},{name:"getcapabilities",value:`${a}${w}service=WFS&request=GetCapabilities&${h}`.replace(/&&/g,"&")},{name:"getfeature",value:S.replace(/&&/g,"&")},{name:"getpropertyvalue",value:C.replace(/&&/g,"&")}]}function tc(e,t){t&&"wfs"===t&&(e.paramsWFS=e.params);const o=e.paramsWFS;let i;return e.urlWfs=e.urlWfs||e.url,o.version=o.version||"2.0.0",o.fieldNameGeometry=o.fieldNameGeometry||Wl,o.maxFeatures=o.maxFeatures||Vl,o.outputFormat&&(i=o.outputFormat),(Xl.test(i)||!i)&&(o.version="1.1.0"),Object.assign({},e)}function oc(e){const t=e;let o;const i=t.paramsWFS.outputFormat?t.paramsWFS.outputFormat:void 0;return i?pa[i]?(o=pa[i],new o(t.formatOptions)):i.toLowerCase().match("gml2")?(o=ca.Z,new o(Object.assign(Object.assign({},t.formatOptions),{gmlFormat:xa.Z}))):i.toLowerCase().match("gml32")?(o=ca.Z,new o(Object.assign(Object.assign({},t.formatOptions),{gmlFormat:Sa.Z}))):i.toLowerCase().match("gml3")?(o=ca.Z,new o(Object.assign(Object.assign({},t.formatOptions),{gmlFormat:wa.Z}))):i.toLowerCase().match("topojson")?(o=da.Z,new o(t.formatOptions)):i.toLowerCase().match("geojson")?(o=Xn.Z,new o(t.formatOptions)):i.toLowerCase().match("esrijson")?(o=ha.Z,new o(t.formatOptions)):i.toLowerCase().match("json")?(o=Xn.Z,new o(t.formatOptions)):i.toLowerCase().match("gpx")?(o=ga.Z,new o(t.formatOptions)):i.toLowerCase().match("WKT")?(o=la.Z,new o(t.formatOptions)):i.toLowerCase().match("osmxml")?(o=Ca.Z,new o(t.formatOptions)):i.toLowerCase().match("kml")?(o=ma.ZP,new o(t.formatOptions)):new o:(o=ca.Z,new o(t.formatOptions))}class ic extends Nl{constructor(e,t){super(e),this.options=e,this.wfsService=t,this.ogcFilters$=new C.X(void 0),this.timeFilter$=new C.X(void 0);const o=e.params,i=o.DPI||96;o.DPI=i,o.MAP_RESOLUTION=i,o.FORMAT_OPTIONS="dpi:"+i,e.refreshIntervalSec&&e.refreshIntervalSec>0&&setInterval(()=>{this.refresh()},1e3*e.refreshIntervalSec);let r=Wl;if(e.paramsWFS){const t=tc(e,"wms");D.mergeDeep(e.paramsWFS,t.paramsWFS),r=e.paramsWFS.fieldNameGeometry||r,e.download=Object.assign({},e.download,{dynamicUrl:this.buildDynamicDownloadUrlFromParamsWFS(e)})}e.sourceFields&&0!==e.sourceFields.length?e.sourceFields.forEach(e=>{e.alias=e.alias?e.alias:e.name}):e.sourceFields=[];const s=e.ogcFilters,n=new Ql;s?(s.advancedOgcFilters=!(s.pushButtons||s.checkboxes||s.radioButtons||s.select),s.pushButtons&&(s.pushButtons.selectorType="pushButton"),s.checkboxes&&(s.checkboxes.selectorType="checkbox"),s.radioButtons&&(s.radioButtons.selectorType="radioButton"),s.select&&(s.select.selectorType="select")):e.ogcFilters=n.defineOgcFiltersDefaultOptions(s,r,"wms"),o.LAYERS.split(",").length>1&&s&&s.enabled&&(console.log("*******************************"),console.log("BE CAREFULL, YOUR WMS LAYERS ("+o.LAYERS+") MUST SHARE THE SAME FIELDS TO ALLOW ogcFilters TO WORK !! "),console.log("*******************************")),e.paramsWFS&&s&&s.enabled&&s.editable&&(e.sourceFields||[]).filter(e=>!e.values).length>0&&this.wfsService.getSourceFieldsFromWFS(e);const a=n.handleOgcFiltersAppliedValue(e,r);o.FILTER=a,this.setOgcFilters(s,!0),(null==e?void 0:e.timeFilterable)&&(null==e?void 0:e.timeFilter)&&this.setTimeFilter(e.timeFilter,!0)}get params(){return this.options.params}get queryTitle(){return this.options.queryTitle?this.options.queryTitle:"title"}get mapLabel(){return this.options.mapLabel}get queryHtmlTarget(){return this.options.queryHtmlTarget?this.options.queryHtmlTarget:zl.BLANK}set ogcFilters(e){this.options.ogcFilters=e}get ogcFilters(){return this.options.ogcFilters}set timeFilter(e){this.options.timeFilter=e}get timeFilter(){return this.options.timeFilter}refresh(){this.ol.updateParams({igoRefresh:Math.random()})}buildDynamicDownloadUrlFromParamsWFS(e){return ec(e).find(e=>"getfeature"===e.name).value}createOlSource(){return new na.Z(Object.assign({ratio:1},this.options))}setOgcFilters(e,t=!1){this.ogcFilters=e,t&&this.ogcFilters$.next(this.ogcFilters)}setTimeFilter(e,t=!1){this.timeFilter=e,t&&this.timeFilter$.next(this.timeFilter)}getLegend(e,t){let o=super.getLegend();if(o.length>0&&void 0===e&&!(null==t?void 0:t.scale))return o;let i,r=!1;(null==t?void 0:t.size)&&(null==t?void 0:t.extent)&&(null==t?void 0:t.projection)&&this.options.contentDependentLegend&&(i="1.3.0"===this.params.VERSION||void 0===this.params.VERSION?"CRS":"SRS",r=!0);const s=this.params;let n=[];void 0!==s.LAYERS&&(n=s.LAYERS.split(","));const a=this.options.url.replace(/\?$/,""),l=["REQUEST=GetLegendGraphic","SERVICE=WMS","FORMAT=image/png","SLD_VERSION=1.1.0",`VERSION=${s.VERSION||"1.3.0"}`];return void 0!==e&&l.push(`STYLE=${e}`),void 0!==(null==t?void 0:t.scale)&&l.push(`SCALE=${t.scale}`),r&&(l.push(`WIDTH=${t.size[0]}`),l.push(`HEIGHT=${t.size[1]}`),l.push(`BBOX=${t.extent.join(",")}`),l.push(`${i}=${t.projection}`)),o=n.map(t=>{const o=a.match(/\?/)?"&":"?";return{url:`${a}${o}${l.join("&")}&LAYER=${t}`,title:n.length>1?t:void 0,currentStyle:void 0===e?void 0:e}}),o}onUnwatch(){}}class rc extends B{constructor(e,t){super(),this.ol=e.ol,this.layer=e,this.dataSource=e.options.source,this.map=t,this.ogcFilterWriter=new Ql}watch(){this.ol.on("propertychange",e=>this.transferCommonProperties(e)),this.dataSource.ogcFilters$&&(this.ogcFilters$$=this.dataSource.ogcFilters$.subscribe(e=>this.transferOgcFiltersProperties(e))),this.dataSource.timeFilter$&&(this.timeFilter$$=this.dataSource.timeFilter$.subscribe(e=>this.transferTimeFilterProperties(e))),this.syncChildLayers()}unwatch(){this.ol.un("propertychange",e=>this.transferCommonProperties(e)),this.ogcFilters$$&&this.ogcFilters$$.unsubscribe(),this.timeFilter$$&&this.timeFilter$$.unsubscribe()}syncChildLayers(){!this.map||this.map.status$.pipe((0,Sn.P)()).subscribe(()=>{this.map.layers.filter(e=>{var t;return null===(t=e.options.linkedLayers)||void 0===t?void 0:t.links}).map(e=>{e.options.linkedLayers.links.map(t=>{var o,i,r,s,n,a;if(-1!==(null===(o=t.properties)||void 0===o?void 0:o.indexOf(Ml.VISIBLE))&&(e.ol.set("visible",!e.visible,!1),e.ol.set("visible",!e.visible,!1),e.visible=e.visible),-1!==(null===(i=t.properties)||void 0===i?void 0:i.indexOf(Ml.OPACITY))){const t=e.ol.get("opacity");e.ol.set("opacity",0,!1),e.ol.set("opacity",t,!1),e.opacity=e.opacity}if(-1!==(null===(r=t.properties)||void 0===r?void 0:r.indexOf(Ml.MINRESOLUTION))){const t=e.ol.get("minResolution");e.ol.set("minResolution",0,!1),e.ol.set("minResolution",t,!1),e.minResolution=e.minResolution}if(-1!==(null===(s=t.properties)||void 0===s?void 0:s.indexOf(Ml.MAXRESOLUTION))){const t=e.ol.get("maxResolution");e.ol.set("maxResolution",0,!1),e.ol.set("maxResolution",t,!1),e.minResolution=e.minResolution}if(-1!==(null===(n=t.properties)||void 0===n?void 0:n.indexOf(Ml.OGCFILTERS))){const t=e.dataSource.ogcFilters$;t.next(t.value)}if(-1!==(null===(a=t.properties)||void 0===a?void 0:a.indexOf(Ml.TIMEFILTER))){const t=e.dataSource.timeFilter$;t.next(t.value)}})})})}transferCommonProperties(e){const t=e.key,o=e.target.getProperties(),i=o[t];if(-1===["visible","opacity","minResolution","maxResolution"].indexOf(t))return;const r=o.linkedLayers;if(!r)return;const s=r.linkId,n=r.links;if(n){const e=!0;n.map(o=>{!o.properties||-1===o.properties.indexOf(t)||o.linkedIds.map(o=>{const r=this.map.layers.find(e=>{var t;return(null===(t=e.options.linkedLayers)||void 0===t?void 0:t.linkId)===o});r&&(r.ol.set(t,i,e),"visible"===t&&r.visible$.next(i))})})}else{const e=!1;this.map.layers.map(o=>{var r;(null===(r=o.options.linkedLayers)||void 0===r?void 0:r.links)&&o.options.linkedLayers.links.map(r=>{r.properties&&-1!==r.properties.indexOf(t)&&!1!==r.bidirectionnal&&-1!==r.linkedIds.indexOf(s)&&(o.ol.set(t,i,e),"visible"===t&&o.visible$.next(i))})})}}transferOgcFiltersProperties(e){const t=this.ol.getProperties().linkedLayers;if(!t)return;const o=t.linkId,i=t.links;i?i.map(t=>{!t.properties||-1===t.properties.indexOf(Ml.OGCFILTERS)||t.linkedIds.map(t=>{const o=this.map.layers.find(e=>{var o;return(null===(o=e.options.linkedLayers)||void 0===o?void 0:o.linkId)===t});if(o){const t=o.ol.getProperties().sourceOptions.type;if(o.dataSource.setOgcFilters(e,!1),"wfs"===t&&o.ol.getSource().refresh(),"wms"===t){let e;"wfs"===this.ol.getProperties().sourceOptions.type?e=this.ogcFilterWriter.handleOgcFiltersAppliedValue(this.layer.dataSource.options,this.dataSource.options.fieldNameGeometry,void 0,this.map.viewController.getOlProjection()):"wms"===this.ol.getProperties().sourceOptions.type&&(e=this.dataSource.ol.getParams().FILTER),o.dataSource.ol.updateParams({FILTER:e})}}})}):this.map.layers.map(t=>{var i;(null===(i=t.options.linkedLayers)||void 0===i?void 0:i.links)&&t.options.linkedLayers.links.map(i=>{if(i.properties&&-1!==i.properties.indexOf(Ml.OGCFILTERS)&&!1!==i.bidirectionnal&&-1!==i.linkedIds.indexOf(o)){const o=t.ol.getProperties().sourceOptions.type;if("wfs"===o&&(t.dataSource.setOgcFilters(e,!0),t.ol.getSource().refresh()),"wms"===o){let o;"wfs"===this.ol.getProperties().sourceOptions.type?o=this.ogcFilterWriter.handleOgcFiltersAppliedValue(t.dataSource.options,this.dataSource.options.fieldNameGeometry,void 0,this.map.viewController.getOlProjection()):"wms"===this.ol.getProperties().sourceOptions.type&&(o=this.dataSource.ol.getParams().FILTER),t.dataSource.ol.updateParams({FILTER:o}),t.dataSource.setOgcFilters(e,!0)}}})})}transferTimeFilterProperties(e){const t=this.ol.getProperties().linkedLayers;if(!t)return;const o=t.linkId,i=t.links;i?i.map(t=>{!t.properties||-1===t.properties.indexOf(Ml.TIMEFILTER)||t.linkedIds.map(t=>{const o=this.map.layers.find(e=>{var o;return e.dataSource instanceof ic&&(null===(o=e.options.linkedLayers)||void 0===o?void 0:o.linkId)===t});if(o){o.dataSource.setTimeFilter(e,!1);const t=this.ol.get("values_").source.getParams().TIME;o.dataSource.ol.updateParams({TIME:t})}})}):this.map.layers.filter(e=>e.dataSource instanceof ic).map(t=>{var i;(null===(i=t.options.linkedLayers)||void 0===i?void 0:i.links)&&t.options.linkedLayers.links.map(i=>{if(i.properties&&-1!==i.properties.indexOf(Ml.TIMEFILTER)&&!1!==i.bidirectionnal&&-1!==i.linkedIds.indexOf(o)){const o=this.ol.get("values_").source.getParams().TIME;t.dataSource.ol.updateParams({TIME:o}),t.dataSource.setTimeFilter(e,!0)}})})}}class sc extends B{constructor(e){super(),this.loaded=0,this.loading=0,this.source=e.options.source.ol,this.id=N()}watch(){this.source.on("tileloadstart",e=>this.handleLoadStart(e)),this.source.on("tileloadend",e=>this.handleLoadEnd(e)),this.source.on("tileloaderror",e=>this.handleLoadEnd(e))}unwatch(){this.source.un("tileloadstart",e=>this.handleLoadStart(e)),this.source.un("tileloadend",e=>this.handleLoadEnd(e)),this.source.un("tileloaderror",e=>this.handleLoadEnd(e))}handleLoadStart(e){e.tile.__watchers__||(e.tile.__watchers__=[]),e.tile.__watchers__.push(this.id),this.loading+=1,this.status=J.Working}handleLoadEnd(e){if(!e.tile.__watchers__)return;const t=e.tile.__watchers__.indexOf(this.id);if(t<0)return;e.tile.__watchers__.splice(t,1),this.loaded+=1;const o=this.loading;this.loaded>=o&&o===this.loading&&(this.status=J.Done,this.loaded=this.loading=0)}}class nc extends Nl{createOlSource(){const e={format:this.getSourceFormatFromOptions(this.options)};return new Aa.Z(Object.assign(e,this.options))}getSourceFormatFromOptions(e){if(e.format)return e.format;let t;const o=e.formatType;if(o){if(t=pa[o],void 0===t)throw new Error("Invalid vector source format ${formatType}.")}else t=Xn.Z;const i=e.formatOptions;let r;return r=i?new t(i):new t,r}onUnwatch(){}get queryTitle(){return this.options.queryTitle?this.options.queryTitle:"title"}}class ac extends nc{createOlSource(){return this.options.format=this.getSourceFormatFromOptions(this.options),this.options.source=super.createOlSource(),new Ta.Z(this.options)}generateId(){return N()}onUnwatch(){}}class lc extends B{constructor(e){super(),this.loaded=0,this.loading=0,this.layer=e,this.id=N()}watch(){let e=this.layer.options.source.ol;this.layer.dataSource instanceof ac&&(e=this.layer.options.source.options.source),e.getUrl()&&(e.on("featuresloadstart",e=>this.handleLoadStart(e)),e.on("featuresloadend",e=>this.handleLoadEnd(e)),e.on("featuresloaderror",e=>this.handleLoadEnd(e)))}unwatch(){let e=this.layer.options.source.ol;this.layer.dataSource instanceof ac&&(e=this.layer.options.source.options.source),e.getUrl()&&(e.un("featuresloadstart",e=>this.handleLoadStart(e)),e.un("featuresloadend",e=>this.handleLoadEnd(e)),e.un("featuresloaderror",e=>this.handleLoadEnd(e)))}handleLoadStart(e){this.loading+=1,this.status=J.Working}handleLoadEnd(e){this.loaded+=1;const t=this.loading;this.loaded>=t&&t===this.loading&&(this.status=J.Done,this.loaded=this.loading=0)}}function cc(e,t,o={}){let i,r,s,n,a,l,c,u,p,d,h,g,m,f,y,v,b,x,w,S;const C=new RegExp("(\\s*;\\s*[\\d]{4,6})","g"),T="([-+])?([\\d]{1,3})([,.](\\d+))?",A=`${T}[\\s,]+${T}`,L=new RegExp(`^${A}$`,"g"),Z="([0-9]{1,2})[:|\xb0]?\\s*([0-9]{1,2})?[:|'|\u2032|\u2019]?\\s*([0-9]{1,2}(?:.[0-9]+){0,1})?\\s*[\"|\u2033|\u201d]?\\s*",F=`${Z}([N|S|E|W|O]),?\\s*${Z}([N|S|E|W|O])`,O=new RegExp(`^${F}$`,"gi"),M="(UTM)-?(\\d{1,2})[\\s,]*(\\d+[.,]?\\d+)[\\s,]+(\\d+[.,]?\\d+)",I=new RegExp(`^${M}`,"gi"),k="(MTM)-?(\\d{1,2})[\\s,]*(\\d+[.,]?\\d+)[\\s,]+(\\d+[.,]?\\d+)",P=new RegExp(`^${k}`,"gi"),_="([-+])?(\\d{1,3})[,.](\\d+)",$=`${_}\\s*[,]?\\s*${_}`,q=new RegExp(`^${$}`,"g"),D="([-+])?(\\d{1,3})[\\s,.]{1}(\\d{1,2})[\\s,.]{1}(\\d{1,2})[.,]?(\\d{1,5})?",E=`${D}\\s*[,.]?\\s*${D}`,R=new RegExp(`^${E}`,"g"),U="LAT\\s*[\\s:]*\\s*([-+])?(\\d{1,2})[\\s.,]?(\\d+)?[\\s.,]?\\s*(\\d{1,2}([.,]\\d+)?)?\\s*(N|S|E|W)?\\s*LONG\\s*[\\s:]*\\s*([-+])?(\\d{1,3})[\\s.,]?(\\d+)?[\\s.,]?\\s*(\\d{1,2}([.,]\\d+)?)?\\s*(N|S|E|W)?\\s*UNC\\s*[\\s:]?\\s*(\\d+)\\s*CONF\\s*[\\s:]?\\s*(\\d{1,3})",N=new RegExp(`^${U}?`,"gi"),J="([-+]?\\d+)[,.]?(\\d+)?",B=`${J}[\\s,]+${J}`,j=new RegExp(`^${B}$`,"g");let Q=!1;if(e=e.toLocaleUpperCase().trim(),C.test(e)?[r,S]=e.split(";").map(e=>e.trim()):r=e,L.test(r))[,s,x,,u,p,w,,f]=r.match(A),x=parseFloat((s||"")+x+"."+u),w=parseFloat((p||"")+w+"."+f);else if(O.test(r))[,n,a,l,c,d,h,g,m]=r.match(F),("S"===c||"N"===c)&&(n=[d,d=n][0],a=[h,h=a][0],l=[g,g=l][0],c=[m,m=c][0]),x=uc(parseFloat(n),parseFloat(a),parseFloat(l),c),w=uc(parseFloat(d),parseFloat(h),parseFloat(g),m);else if(I.test(r)){Q=!0,[,,y,x,w]=r.match(M);const e=Number(y)<10?`EPSG:3260${y}`:`EPSG:326${y}`;[x,w]=kn.vs([parseFloat(x),parseFloat(w)],e,"EPSG:4326")}else if(P.test(r)){Q=!0,[,,y,x,w]=r.match(k);const e=Number(y)<10?`EPSG:3218${y}`:`EPSG:321${80+Number(y)}`;[x,w]=kn.vs([parseFloat(x),parseFloat(w)],e,"EPSG:4326")}else if(R.test(r))[,s,n,a,l,u,p,d,h,g,f]=r.match(E),x=uc(parseFloat((s||"")+n),parseFloat(a),parseFloat(l),c),w=uc(parseFloat((p||"")+d),parseFloat(h),parseFloat(g),m);else if(q.test(r))[,s,n,u,p,d,f]=r.match($),x=uc(parseFloat((s||"")+n),parseFloat(a),parseFloat(l),c),w=uc(parseFloat((p||"")+d),parseFloat(h),parseFloat(g),m);else if(N.test(r))[,p,d,h,g,,m,s,n,a,l,,c,v,b]=r.match(U),c||(c="W"),x=a&&a.length>2?parseFloat((s||"")+n+"."+a):uc(parseFloat(n),parseFloat(a),parseFloat(l),c),w=h&&h.length>2?parseFloat((p||"")+d+"."+h):uc(parseFloat(d),parseFloat(h),parseFloat(g),m);else{if(!j.test(r))return{lonLat:void 0,message:"",radius:void 0,conf:void 0};Q=!0,[,x,u,w,f]=r.match(B),u&&(x=parseFloat(x+"."+u)),f&&(w=parseFloat(w+"."+f))}if(o.forceNA&&!Q&&(x>0&&w>0&&(x>w?x=-x:w=-w),x>w&&(x=[w,w=x][0])),i=[Number(x),Number(w)],void 0!==S&&"4326"!==S||i[0]>180||i[0]<-180||i[1]>90||i[1]<-90){const e=S?"EPSG:"+S:t,o="EPSG:4326";try{i=kn.vs(i,e,o)}catch(G){return{lonLat:void 0,message:"Projection "+e+" not supported",radius:void 0,conf:void 0}}}return Math.abs(i[0])<=180&&Math.abs(i[1])<=90?{lonLat:i,message:"",radius:v?parseInt(v,10):void 0,conf:b?parseInt(b,10):void 0}:{lonLat:void 0,message:"Coordinate out of Longitude/Latitude bounds",radius:void 0,conf:void 0}}function uc(e,t,o,i){t=t||0,o=o||0;const r=e<0;let s=Math.abs(e)+t/60+o/3600;return(r||"S"===i||"W"===i)&&(s=-s),s}function pc(e){return(e=Math.round(e))<1e4?e+"":(e=Math.round(e/1e3))<1e3?e+"K":(e=Math.round(e/1e3))+"M"}function dc(e,t=96){return e/(39.3701*t)}function hc(e){const t=e.originalEvent;return!t.altKey&&(La.tK?t.metaKey:t.ctrlKey)&&!t.shiftKey}function gc(e,t=3){return[E.roundToNDecimal(e[0],t),E.roundToNDecimal(e[1],t)]}class mc{constructor(e,t,o){this.options=e,this.messageService=t,this.authInterceptor=o,this.legendCollapsed=!0,this.firstLoadComponent=!0,this.olLoadingProblem=!1,this.hasBeenVisible$=new C.X(void 0),this.isInResolutionsRange$=new C.X(!1),this.visible$=new C.X(void 0),this.displayed$=(0,L.aj)([this.isInResolutionsRange$,this.visible$]).pipe((0,x.U)(e=>e[0]&&e[1])),this.dataSource=e.source,this.ol=this.createOlLayer(),void 0!==e.zIndex&&(this.zIndex=e.zIndex),e.baseLayer&&void 0===e.visible&&(e.visible=!1),this.maxResolution=e.maxResolution||dc(Number(e.maxScaleDenom)),this.minResolution=e.minResolution||dc(Number(e.minScaleDenom)),this.visible=void 0===e.visible||e.visible,this.opacity=void 0===e.opacity?1:e.opacity,e.legendOptions&&(e.legendOptions.url||e.legendOptions.html)&&(this.legend=this.dataSource.setLegend(e.legendOptions)),this.legendCollapsed=!e.legendOptions||!e.legendOptions.collapsed||e.legendOptions.collapsed,this.ol.set("_layer",this,!0)}get id(){return this.options.id||this.dataSource.id}get alias(){return this.options.alias}get title(){return this.options.title}set title(e){this.options.title=e}get zIndex(){return this.ol.getZIndex()}set zIndex(e){this.ol.setZIndex(e)}get baseLayer(){return this.options.baseLayer}set baseLayer(e){this.options.baseLayer=e}get opacity(){return this.ol.get("opacity")}set opacity(e){this.ol.setOpacity(e)}set isInResolutionsRange(e){this.isInResolutionsRange$.next(e)}get isInResolutionsRange(){return this.isInResolutionsRange$.value}set maxResolution(e){this.ol.setMaxResolution(e||1/0),this.updateInResolutionsRange()}get maxResolution(){return this.ol.getMaxResolution()}set minResolution(e){this.ol.setMinResolution(e||0),this.updateInResolutionsRange()}get minResolution(){return this.ol.getMinResolution()}set visible(e){this.ol.setVisible(e),this.visible$.next(e),!this.hasBeenVisible$.value&&e&&this.messageService&&this.hasBeenVisible$.next(e)}get visible(){return this.visible$.value}get displayed(){return this.visible&&this.isInResolutionsRange}get showInLayerList(){return!1!==this.options.showInLayerList}setMap(e){this.map=e,this.unobserveResolution(),void 0!==e?(this.observeResolution(),this.layerSyncWatcher=new rc(this,this.map),this.layerSyncWatcher.subscribe(()=>{}),this.hasBeenVisible$$=this.hasBeenVisible$.subscribe(()=>{this.options.messages&&this.visible&&this.options.messages.map(e=>{e.title=e.title,e.text=e.text,this.messageService.message(e)})})):this.layerSyncWatcher.unsubscribe()}observeResolution(){this.resolution$$=this.map.viewController.resolution$.subscribe(()=>this.updateInResolutionsRange())}unobserveResolution(){void 0!==this.resolution$$&&(this.resolution$$.unsubscribe(),this.resolution$$=void 0)}updateInResolutionsRange(){if(void 0!==this.map){const e=this.map.viewController.getResolution(),t=void 0===this.maxResolution?1/0:this.maxResolution;this.isInResolutionsRange=e>=this.minResolution&&e<=t}else this.isInResolutionsRange=!1}}class fc extends mc{constructor(e,t,o){super(e,t,o),this.messageService=t,this.authInterceptor=o,this.watcher=new lc(this),this.status$=this.watcher.status$}get browsable(){return!1!==this.options.browsable}get exportable(){return!1!==this.options.exportable}createOlLayer(){const e=Object.assign({},this.options,{source:this.options.source.ol});this.options.animation&&this.dataSource.ol.on("addfeature",(function(e){this.flash(e.feature)}).bind(this)),this.options.trackFeature&&this.enableTrackFeature(this.options.trackFeature);const t=new Kn.Z(e),o=t.getSource(),i=o.getUrl();if(i){let t;const r=e.sourceOptions;t="wfs"===(null==r?void 0:r.type)&&(r.params||r.paramsWFS)?(e,t,i,s,n)=>{this.customWFSLoader(o,r,this.authInterceptor,e,t,i,s,n)}:(e,t,r,s,n)=>{this.customLoader(o,i,this.authInterceptor,e,t,r,s,n)},t&&o.setLoader(t)}return t}flash(e){const t=(new Date).getTime(),o=this.ol.on("postrender",(function(i){const r=(0,ia.u3)(i),s=i.frameState,n=e.getGeometry().clone(),a=s.time-t,l=a/this.options.animation.duration,c=(0,ta.Vv)(1-l),u=(0,oa._2)(this.options.animation.color||"red");u[3]=c;let p=this.ol.getStyleFunction().call(this,e).find(e=>e.getImage());p||(p=this.ol.getStyleFunction().call(this,e)[0]);const d=p.clone();switch(e.getGeometry().getType()){case"Point":const e=(0,ta.Vv)(l)*(3*d.getImage().getRadius());d.getImage().setRadius(e),d.getImage().setOpacity(c);break;case"LineString":d.getImage()&&(d.getImage().getStroke().setColor(u),d.getImage().getStroke().setWidth((0,ta.Vv)(l)*(3*d.getImage().getStroke().getWidth()))),d.getStroke()&&(d.getStroke().setColor(u),d.getStroke().setWidth((0,ta.Vv)(l)*(3*d.getStroke().getWidth())));break;case"Polygon":d.getImage()&&d.getImage().getFill().setColor(u),d.getFill()&&d.getFill().setColor(u)}if(d.setText(""),r.setStyle(d),r.drawGeometry(n),a>this.options.animation.duration)return(0,ea.B)(o),void this.map.ol.render();this.map.ol.render()}).bind(this))}setMap(e){void 0===e?this.watcher.unsubscribe():this.watcher.subscribe(()=>{}),super.setMap(e)}onUnwatch(){this.dataSource.onUnwatch(),this.stopAnimation()}stopAnimation(){this.dataSource.ol.un("addfeature",(function(e){this.visible&&this.flash(e.feature)}).bind(this))}enableTrackFeature(e){this.trackFeatureListenerId=this.dataSource.ol.on("addfeature",this.trackFeature.bind(this,e))}centerMapOnFeature(e){const t=this.dataSource.ol.getFeatureById(e);t&&this.map.ol.getView().setCenter(t.getGeometry().getCoordinates())}trackFeature(e,t){t.feature.getId()===e&&this.visible&&this.centerMapOnFeature(e)}disableTrackFeature(e){(0,ea.B)(this.trackFeatureListenerId)}customWFSLoader(e,t,o,i,r,s,n,a){{const r=t.paramsWFS,l=r.srsName?new sa.Z({code:r.srsName}):s,c=kn.$A(i,s,l);r.srsName=r.srsName||s.getCode();const u=Kl(t,c,l,t.ogcFilters);let p=0;if("2.0.0"===r.version&&r.maxFeatures>Vl){const t=1e3;for(;p<r.maxFeatures;){let i=u.replace("count="+r.maxFeatures,"count="+t);i=i.replace("startIndex=0","0"),i+="&startIndex="+p,i.replace(/&&/g,"&"),this.getFeatures(e,o,c,l,s,i,t,n,a),p+=t}}else this.getFeatures(e,o,c,l,s,u,r.maxFeatures,n,a)}}getFeatures(e,t,o,i,r,s,n,a,l){const c=new XMLHttpRequest;c.open("GET",s),t&&t.interceptXhr(c,s);const u=()=>{e.removeLoadedExtent(o),l()};c.onerror=u,c.onload=()=>{if(200===c.status&&c.responseText.length>0){const t=e.getFormat().readFeatures(c.responseText,{dataProjection:i,featureProjection:r});e.addFeatures(t),a(t)}else u()},c.send()}customLoader(e,t,o,i,r,s,n,a){const l=new XMLHttpRequest;l.open("GET","function"==typeof t?t=t(i,r,s):t);const c=e.getFormat();c.getType()===ra.Z.ARRAY_BUFFER&&(l.responseType="arraybuffer"),o&&o.interceptXhr(l,t);const u=()=>{e.removeLoadedExtent(i),a()};l.onerror=u,l.onload=()=>{if(!l.status||l.status>=200&&l.status<300){const t=c.getType();let o;if(t===ra.Z.JSON||t===ra.Z.TEXT?o=l.responseText:t===ra.Z.XML?(o=l.responseXML,o||(o=(new DOMParser).parseFromString(l.responseText,"application/xml"))):t===ra.Z.ARRAY_BUFFER&&(o=l.response),o){const t=c.readFeatures(o,{extent:i,featureProjection:s});e.addFeatures(t,c.readProjection(o)),n(t)}else u()}else u()},l.send()}}class yc extends Nl{createOlSource(){return this.options.url||(this.options.url="https://tile.openstreetmap.org/{z}/{x}/{y}.png"),new Za.Z(this.options)}onUnwatch(){}}class vc extends Nl{createOlSource(){return new Fa.Z(this.options)}onUnwatch(){}}class bc extends Nl{constructor(e,t,o){super(tc(e,"wfs")),this.options=e,this.wfsService=t,this.authInterceptor=o,this.ogcFilters$=new C.X(void 0);const i=this.options.ogcFilters,r=this.options.paramsWFS.fieldNameGeometry||Wl,s=new Ql;this.options.ogcFilters=s.defineOgcFiltersDefaultOptions(i,r),this.options.ogcFilters.enabled&&this.options.ogcFilters.editable&&(e.sourceFields||[]).filter(e=>!e.values).length>0&&this.wfsService.getSourceFieldsFromWFS(this.options),(null==i?void 0:i.pushButtons)&&(i.pushButtons.selectorType="pushButton"),(null==i?void 0:i.checkboxes)&&(i.checkboxes.selectorType="checkbox"),(null==i?void 0:i.radioButtons)&&(i.radioButtons.selectorType="radioButton"),(null==i?void 0:i.select)&&(i.select.selectorType="select"),this.setOgcFilters(this.options.ogcFilters,!0)}set ogcFilters(e){this.options.ogcFilters=e}get ogcFilters(){return this.options.ogcFilters}createOlSource(){return new Aa.Z({format:oc(this.options),url:(e,t,o)=>{const i=this.options.paramsWFS,r=i.srsName?new sa.Z({code:i.srsName}):o,s=this.options.ogcFilters,n=kn.$A(e,o,r);return i.srsName=i.srsName||o.getCode(),Kl(this.options,n,r,s)},strategy:Oa.VW})}setOgcFilters(e,t=!1){this.ogcFilters=e,t&&this.ogcFilters$.next(this.ogcFilters)}onUnwatch(){}}let xc=(()=>{class e extends class{}{constructor(e){super(),this.http=e}getData(){return console.log("This is defining a data service."),"This is defining a data service."}getSourceFieldsFromWFS(e){e.sourceFields&&0!==e.sourceFields.length?this.defineFieldAndValuefromWFS(e).subscribe(t=>{e.sourceFields.forEach(e=>{void 0===e.alias&&(e.alias=e.name),(void 0===e.values||0===e.values.length)&&(e.values=t.find(t=>t.name===e.name).values)})}):(e.sourceFields=[],this.defineFieldAndValuefromWFS(e).subscribe(t=>{e.sourceFields=t}))}wfsGetFeature(e,t=Vl,o=Hl,i,r=0,s=!1){const n=ec(e,t,o,i,r,s).find(e=>"getfeature"===e.name).value,a=e.paramsWFS.outputFormat;return s||Xl.test(a)||!a?this.http.get(n,{responseType:"text"}):this.http.get(n)}defineFieldAndValuefromWFS(e){return new Le.y(t=>{var o;const i=[];let r,s,n,a,l;a=oc(e);const c=JSON.parse(JSON.stringify(e));delete c.paramsWFS.outputFormat,delete c.formatOptions,l=oc(c);let u=null===(o=e.sourceFields)||void 0===o?void 0:o.filter(e=>!e.values).map(e=>e.name);this.wfsGetFeature(e,1,void 0,void 0,0,!0).pipe((0,Cn.b)(e=>String(e).toLowerCase().includes("exception")?(0,A.of)(!1):(0,A.of)(!0)),(0,Cn.b)(t=>this.wfsGetFeature(e,1).pipe((0,Cn.b)(o=>{const i=a.readFeatures(o);r=i[0].getKeys(),(e.sourceFields||0===e.sourceFields.length)&&(u=r),s=r.filter(e=>u.includes(e)&&e!==i[0].getGeometryName()&&!e.match(/boundedby/gi)),n=s.join(",");const c=[];let p=0;if(!t&&"2.0.0"===e.paramsWFS.version&&e.paramsWFS.maxFeatures>Vl){const t=1e3;for(;p<e.paramsWFS.maxFeatures;)c.push(this.wfsGetFeature(e,t,e.paramsWFS.srsName,n,p)),p+=t;l=a}else c.push(this.wfsGetFeature(e,e.paramsWFS.maxFeatures||Vl,e.paramsWFS.srsName,n,0,!0));return(0,L.aj)(c)})))).subscribe(e=>{let o=[];e.map(e=>{const t=l.readFeatures(e);o=o.concat(t)}),this.built_properties_value(o).forEach(e=>{i.push(e)}),t.next(i),t.complete()})})}built_properties_value(e){if(0===e.length)return[];const t=Object.assign({},e[0].getProperties());delete t[e[0].getGeometryName()],delete t.boundedBy;const o=[];for(const i in t)if(t.hasOwnProperty(i)){const r="object"==typeof e[0].get(i)?void 0:typeof e[0].get(i);o.push({name:i,alias:i,type:r,values:[t[i]]})}return e.every(e=>{const i=e.getProperties();for(const r in i)i.hasOwnProperty(r)&&r in t&&o.filter(e=>e.name===r).forEach(e=>{-1===e.values.indexOf(i[r])&&e.values.push(i[r])});return!0}),o}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function wc(e){const t=kn.U2(e||"EPSG:3857").getExtent(),o=(0,zn.dz)(t)/256,i=new Array(20),r=new Array(20);for(let s=0;s<20;++s)i[s]=o/Math.pow(2,s),r[s]=s;return new Ia.Z({origin:(0,zn.rL)(t),resolutions:i,matrixIds:r})}class Sc extends Nl{constructor(e){super(e)}createOlSource(){const e=Object.assign({tileGrid:wc(this.options.projection)},this.options);return new Ma.Z(e)}onUnwatch(){}}class Cc extends Nl{get params(){return this.options.params}get queryTitle(){return this.options.queryTitle?this.options.queryTitle:"title"}get mapLabel(){return this.options.mapLabel}get queryHtmlTarget(){return this.options.queryHtmlTarget?this.options.queryHtmlTarget:zl.BLANK}createOlSource(){const e=Object.assign({crossOrigin:this.options.crossOrigin?this.options.crossOrigin:"anonymous"},this.options);return new ka.Z(e)}getLegend(){const e=super.getLegend();if(e.length>0)return e;let t="<table>";if(null!==this.options.config.layers[0].legend)return this.options.config.layers[0].legend.items.forEach(e=>{!0===e.visible&&(t+='<tr><td><p><font size="5" color="'+e.value+'"> &#9679</font></p></td><td>'+e.name+"</td></tr>")}),t+="</table>",[{html:t}];{const e=this.options.config.layers[0].options,o=["polygon-fill:","marker-fill:","shield-fill:","building-fill:","line-color:"];for(const i of o)if(e.cartocss.includes(i)){const o=e.cartocss.split(i).pop(),r=o.substr(0,o.indexOf(";"));if(r.includes("ramp")){const e=r.split(", (")[1].split(","),o=r.split(", (")[2].split(",");for(let i=0;i<e.length;i++)e[i]=e[i].replace(/("|\))/g,""),o[i]=o[i].replace(/("|\))/g,""),"="===o[i].replace(/\s+/g,"")&&(o[i]="Autres"),t+='<tr><td><p><font size="5" color="'+e[i]+'"> &#9679</font></p></td><td>'+o[i]+"</td></tr>";break}t+='<tr><td><p><font size="5" color="'+r+'"> &#9679</font></p></td><td>'+(e.layer_name?e.layer_name:"")+"</td></tr>";break}return t+="</table>",[{html:t}]}}onUnwatch(){}}class Tc extends Nl{createOlSource(){const e=new ha.Z;return new Aa.Z({attributions:this.options.params.attributions,overlaps:!1,format:e,url:(function(e,t,o){const i=this.options.url+"/"+this.options.layer+"/query/",r=["f=json",`geometry=${encodeURIComponent('{"xmin":'+e[0]+',"ymin":'+e[1]+',"xmax":'+e[2]+',"ymax":'+e[3]+',"spatialReference":{"wkid":102100}}')}`,"geometryType=esriGeometryEnvelope","inSR=102100","spatialRel=esriSpatialRelIntersects","outFields=*","returnGeometry=true","outSR=102100"];return this.options.params.time&&r.push(`time=${this.options.params.time}`),this.options.params.customParams&&this.options.params.customParams.forEach(e=>{r.push(e)}),`${i}?${r.join("&")}`}).bind(this),strategy:Oa.VW})}getLegend(){const e=this.options.legendInfo,t=super.getLegend();if(void 0===e||t.length>0)return t;const o=parseInt(this.options.layer,10),i=e.layers.find(e=>e.layerId===o);if(!i)return;let r="<table>";for(const s of i.legend)r+=`<tr><td align='left'><img src="${this.options.url.replace("FeatureServer","MapServer")}/${i.layerId}/images/${s.url}" alt ='' /></td><td>`+s.label.replace("<Null>","Null")+"</td></tr>";return r+="</table>",[{html:r}]}onUnwatch(){}}class Ac extends Nl{get params(){return this.options.params}get queryTitle(){return this.options.queryTitle?this.options.queryTitle:"title"}get mapLabel(){return this.options.mapLabel}get queryHtmlTarget(){return this.options.queryHtmlTarget?this.options.queryHtmlTarget:zl.BLANK}createOlSource(){const e=void 0===this.options.layer?this.options.params:Object.assign({LAYERS:`show:${this.options.layer}`},this.options.params);return"object"==typeof e.renderingRule&&(e.renderingRule=JSON.stringify(e.renderingRule)),new Pa.Z({ratio:1,params:e,url:this.options.url})}getLegend(){var e,t;const o=(null===(e=this.options.options)||void 0===e?void 0:e.legendInfo)||(null===(t=this.params)||void 0===t?void 0:t.legendInfo),i=super.getLegend();if(void 0===o||void 0===this.options.layer||i.length>0)return i;const r=parseInt(this.options.layer,10),s=o.layers.find(e=>e.layerId===r);if(!s)return;let n="<table>";for(const a of s.legend)n+=`<tr><td align='left'><img src="${this.options.url}/${s.layerId}/images/${a.url}" alt ='' /></td><td>`+a.label.replace("<Null>","Null")+"</td></tr>";return n+="</table>",[{html:n}]}onUnwatch(){}}class Lc extends Nl{get params(){return this.options.params}get queryTitle(){return this.options.queryTitle?this.options.queryTitle:"title"}get mapLabel(){return this.options.mapLabel}get queryHtmlTarget(){return this.options.queryHtmlTarget?this.options.queryHtmlTarget:zl.BLANK}createOlSource(){return new _a.Z(this.options)}getLegend(){const e=this.options.legendInfo,t=super.getLegend();if(void 0===e||t.length>0)return t;const o=parseInt(this.options.layer,10),i=e.layers.find(e=>e.layerId===o);if(!i)return;let r="<table>";for(const s of i.legend)r+=`<tr><td align='left'><img src="${this.options.url}/${i.layerId}/images/${s.url}" alt ='' /></td><td>`+s.label.replace("<Null>","Null")+"</td></tr>";return r+="</table>",[{html:r}]}onUnwatch(){}}class Zc extends Nl{createOlSource(){const e=JSON.parse(JSON.stringify(this.options));return this.options.tileGrid&&(delete e.tileGrid,e.tileGrid=new qa.Z(this.options.tileGrid)),new $a.Z(e)}onUnwatch(){}}class Fc extends nc{createOlSource(){return this.createWebSocket(),this.options.format=this.getSourceFormatFromOptions(this.options),super.createOlSource()}createWebSocket(){this.ws=new WebSocket(this.options.url),this.ws.onmessage=this.onMessage.bind(this),this.options.onclose&&(this.ws.onclose=this.onClose.bind(this)),this.options.onerror&&(this.ws.onerror=this.onError.bind(this)),this.options.onopen&&(this.ws.onopen=this.onOpen.bind(this))}onMessage(e){const t=this.options.format.readFeature(e.data);switch(this.options.onmessage){case"update":const e=this.ol.getFeatureById(t.getId());e&&this.ol.removeFeature(e),this.ol.addFeature(t);break;case"delete":this.ol.clear(!0),this.ol.addFeature(t);break;case"add":default:this.ol.addFeature(t)}}onClose(e){}onError(e){}onOpen(e){}onUnwatch(){this.ws.close()}}class Oc extends Nl{createOlSource(){let e;return"feature"===this.options.featureClass?e=new Ea.Z({featureClass:Fn.Z}):void 0===this.options.featureClass&&(e=new Ea.Z),this.options.format=e,new Da.Z(this.options)}generateId(){return this.options.url?Ds.V.hashStr("mvt"+this.options.url):N()}onUnwatch(){}}class Mc{constructor(){this._converters={},this._converters.esriPMS=Mc._convertEsriPMS,this._converters.esriSFS=Mc._convertEsriSFS,this._converters.esriSLS=Mc._convertEsriSLS,this._converters.esriSMS=Mc._convertEsriSMS,this._converters.esriTS=Mc._convertEsriTS,this._renderers={},this._renderers.uniqueValue=this._renderUniqueValue,this._renderers.simple=this._renderSimple,this._renderers.classBreaks=this._renderClassBreaks}static _convertPointToPixel(e){return e/.75}static _transformColor(e){return[e[0],e[1],e[2],e[3]/255]}static _getResolutionForScale(e,t){const o=kn.Wm[t];return parseFloat(e)/(39.3701*o*96)}static _convertEsriTS(e){const t=Mc._transformAngle(e.angle),o=void 0!==e.text?e.text:void 0;return new Un.ZP({text:new Nn.Z({fill:new Jn.Z({color:Mc._transformColor(e.color)}),font:e.font.style+" "+e.font.weight+" "+e.font.size+" px "+e.font.family,textBaseline:e.verticalAlignment,textAlign:e.horizontalAlignment,offsetX:Mc._convertPointToPixel(e.xoffset),offsetY:Mc._convertPointToPixel(e.yoffset),rotation:t,text:o})})}static _convertEsriPMS(e){const t="data:"+e.contentType+";base64, "+e.imageData,o=Mc._transformAngle(e.angle);return new Un.ZP({image:new Bn.Z({src:t,rotation:o})})}static _convertEsriSFS(e){const t=new Jn.Z({color:Mc._transformColor(e.color)}),o=e.outline?Mc._convertOutline(e.outline):void 0;return new Un.ZP({fill:t,stroke:o})}static _convertOutline(e){let t;const o=Mc._transformColor(e.color);return"esriSLSDash"===e.style?t=[5]:"esriSLSDashDot"===e.style?t=[5,5,1,2]:"esriSLSDashDotDot"===e.style?t=[5,5,1,2,1,2]:"esriSLSDot"===e.style?t=[1,2]:"esriSLSNull"===e.style&&(o[3]=0),new jn.Z({color:o,lineDash:t,width:Mc._convertPointToPixel(e.width)})}static _convertEsriSLS(e){return new Un.ZP({stroke:Mc._convertOutline(e)})}static _transformAngle(e){if(0===e||void 0===e)return;const t=-e*Math.PI/180+Math.PI/2;return t<0?2*Math.PI+t:t}static _convertEsriSMS(e){const t=new Jn.Z({color:Mc._transformColor(e.color)}),o=e.outline?Mc._convertOutline(e.outline):void 0,i=Mc._convertPointToPixel(e.size)/2,r=Mc._transformAngle(e.angle);return"esriSMSCircle"===e.style?new Un.ZP({image:new Qn.Z({radius:i,fill:t,stroke:o})}):"esriSMSCross"===e.style?new Un.ZP({image:new Gn.Z({fill:t,stroke:o,points:4,radius:i,radius2:0,angle:0,rotation:r})}):"esriSMSDiamond"===e.style?new Un.ZP({image:new Gn.Z({fill:t,stroke:o,points:4,radius:i,rotation:r})}):"esriSMSSquare"===e.style?new Un.ZP({image:new Gn.Z({fill:t,stroke:o,points:4,radius:i,angle:Math.PI/4,rotation:r})}):"esriSMSX"===e.style?new Un.ZP({image:new Gn.Z({fill:t,stroke:o,points:4,radius:i,radius2:0,angle:Math.PI/4,rotation:r})}):"esriSMSTriangle"===e.style?new Un.ZP({image:new Gn.Z({fill:t,stroke:o,points:3,radius:i,angle:0,rotation:r})}):void 0}_convertLabelingInfo(e,t){const o=[];for(let i=0,r=e.length;i<r;++i){const r=e[i].labelExpression,s=r.substr(r.indexOf("[")+1,r.indexOf("]")-1),n=e[i].symbol,a=e[i].maxScale,l=e[i].minScale;let c=null;0!==a&&(c=Mc._getResolutionForScale(a,t));let u=null;0!==l&&(u=Mc._getResolutionForScale(l,t));const p=this._converters[n.type].call(this,n);o.push((function(e,t){let o=!0;if(null!==this.minResolution&&null!==this.maxResolution?o=t<this.maxResolution&&t>=this.minResolution:null!==this.minResolution?o=t>=this.minResolution:null!==this.maxResolution&&(o=t<this.maxResolution),o){const t=e.get(this.field);return this.style.getText().setText(t),[this.style]}}).bind({minResolution:c,maxResolution:u,field:s,style:p}))}return o}_renderSimple(e){const t=this._converters[e.symbol.type].call(this,e.symbol);return()=>[t]}_renderClassBreaks(e){const t=e.defaultSymbol,o=this._converters[t.type].call(this,t),i=e.field,r=[];for(let s=0,n=e.classBreakInfos.length;s<n;++s){const t=e.classBreakInfos[s];let o;o=null==t.classMinValue?0===s?e.minValue:e.classBreakInfos[s-1].classMaxValue:t.classMinValue;const i=t.classMaxValue,n=t.symbol,a=this._converters[n.type].call(this,n);r.push({min:o,max:i,style:a})}return e=>{const t=e.get(i);for(let o=0,i=r.length;o<i;++o){let e;if(e=0===o?t>=r[o].min&&t<=r[o].max:t>r[o].min&&t<=r[o].max,e)return[r[o].style]}return[o]}}_renderUniqueValue(e){const t=e.defaultSymbol;let o=[];t&&(o=[this._converters[t.type].call(this,t)]);const i=e.field1,r=e.uniqueValueInfos,s=this;return(()=>{const e={};for(let t=0,o=r.length;t<o;++t){const o=r[t],i=o.symbol;e[o.value]=[s._converters[i.type].call(s,i)]}return t=>e[t.get(i)]||o})()}generateStyle(e,t){const o=e.drawingInfo;let i=[];const r=this._renderers[o.renderer.type].call(this,o.renderer);if(void 0!==r&&i.push(r),e.labelingInfo){const o=this._convertLabelingInfo(e.labelingInfo,t);i=i.concat(o)}return 1===i.length?i[0]:(e,t)=>{let o=[];for(let r=0,s=i.length;r<s;++r){const s=i[r].call(null,e,t);s&&(o=o.concat(s))}return o}}}var Ic=(()=>{return(e=Ic||(Ic={})).DATE="date",e.TIME="time",e.DATETIME="datetime",e.YEAR="year",Ic;var e})(),kc=(()=>{return(e=kc||(kc={})).CALENDAR="calendar",e.SLIDER="slider",kc;var e})();let Pc=(()=>{class e{constructor(){}getMap(){return this.map}setMap(e){this.map=e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var _c=(()=>{return(e=_c||(_c={})).wms="wms",e.wmts="wmts",e.arcgisrest="esriJSON",e.imagearcgisrest="esriJSON",e.tilearcgisrest="esriJSON",_c;var e})();let $c=(()=>{class e{constructor(e,t){this.http=e,this.mapService=t,this.parsers={wms:new va.Z,wmts:new ba.Z,esriJSON:new ha.Z}}getWMSOptions(e){return this.getCapabilities("wms",e.url,e.params.VERSION).pipe((0,x.U)(t=>t?this.parseWMSOptions(e,t):void 0))}getWMTSOptions(e){return this.getCapabilities("wmts",e.url,e.version).pipe((0,x.U)(t=>t?this.parseWMTSOptions(e,t):void 0))}getCartoOptions(e){return this.http.jsonp("https://"+e.account+".carto.com/api/v2/viz/"+e.mapId+"/viz.json","callback").pipe((0,x.U)(t=>this.parseCartoOptions(e,t)))}getArcgisOptions(e){const t=e.url+"/"+e.layer+"?f=json",o=e.url.replace("FeatureServer","MapServer")+"/legend?f=json",i=this.getCapabilities("arcgisrest",e.url),r=this.http.get(t),s=this.http.get(o).pipe((0,x.U)(e=>e),(0,b.K)(e=>(console.log("No legend associated with this Feature Service"),(0,A.of)(e))));return(0,vn.D)([r,s,i]).pipe((0,x.U)(t=>this.parseArcgisOptions(e,t[0],t[1],t[2])))}getImageArcgisOptions(e){const t=e.url+"/"+e.layer+"?f=json",o=e.url.replace("FeatureServer","MapServer")+"/legend?f=json",i=this.getCapabilities("imagearcgisrest",e.url),r=this.http.get(t),s=this.http.get(o).pipe((0,x.U)(e=>e),(0,b.K)(e=>(console.log("No legend associated with this Image Service"),(0,A.of)(e))));return(0,vn.D)([r,s,i]).pipe((0,x.U)(t=>this.parseTileOrImageArcgisOptions(e,t[0],t[1],t[2])))}getTileArcgisOptions(e){const t=e.url+"/"+e.layer+"?f=json",o=e.url+"/legend?f=json",i=this.getCapabilities("tilearcgisrest",e.url),r=this.http.get(t),s=this.http.get(o).pipe((0,x.U)(e=>e),(0,b.K)(e=>(console.log("No legend associated with this Tile Service"),(0,A.of)(e))));return(0,vn.D)([r,s,i]).pipe((0,x.U)(t=>this.parseTileOrImageArcgisOptions(e,t[0],t[1],t[2])))}getCapabilities(e,t,o){const i=new y.LE({fromObject:{request:"GetCapabilities",service:e.toUpperCase(),version:o||"1.3.0",_i:"true"}});let r;return r="esriJSON"===_c[e]?this.http.get(t+"?f=json"):this.http.get(t,{params:i,responseType:"text"}),r.pipe((0,x.U)(t=>{if("esriJSON"===_c[e])return t;if(String(t).toLowerCase().includes("serviceexception")&&String(t).toLowerCase().includes("access denied"))throw{error:{message:"Service error getCapabilities: Access is denied"}};return this.parsers[e].read(t)}),(0,b.K)(e=>{throw void 0!==e.error&&(e.error.caught=!0),e}))}parseWMSOptions(e,t){const o=this.findDataSourceInCapabilities(t.Capability.Layer,e.params.LAYERS);if(!o)throw{error:{message:"Layer not found"}};const i=o.DataURL?o.DataURL[0]:void 0,r=o.Abstract?o.Abstract:void 0,s=o.KeywordList?o.KeywordList:void 0;let n=o.queryable;const a=this.getTimeFilter(o),l=a&&Object.keys(a).length>0,c=o.Style?this.getStyle(o.Style):void 0;let u=!0;o.EX_GeographicBoundingBox?o.EX_GeographicBoundingBox.forEach((e,t)=>{t<2&&(e>180||e<-180)&&(u=!1),t>=2&&(e>90||e<-90)&&(u=!1)}):u=!1;const p=u?kn.$A(o.EX_GeographicBoundingBox,"EPSG:4326",this.mapService.getMap().projection):void 0;let d;const h=[Yl.GEOJSON,Yl.GEOJSON2,Yl.GML3,Yl.GML2,Yl.JSON,Yl.HTML];for(const m of h)if(-1!==t.Capability.Request.GetFeatureInfo.Format.indexOf(m)){const e=Object.keys(Yl).find(e=>Yl[e]===m);d=Gl[e];break}d||(n=!1);const g=D.removeUndefined({_layerOptionsFromSource:{title:o.Title,maxResolution:dc(o.MaxScaleDenominator),minResolution:dc(o.MinScaleDenominator),extent:p,metadata:{url:i?i.OnlineResource:void 0,extern:!!i||void 0,abstract:r,keywordList:s},legendOptions:c},queryable:n,queryFormat:d,timeFilter:l?a:void 0,timeFilterable:!!l||void 0,minDate:l?a.min:void 0,maxDate:l?a.max:void 0,stepDate:l?a.step:void 0});return D.mergeDeep(g,e)}parseWMTSOptions(e,t){const o=t.Contents.Layer.find(t=>t.Identifier===e.layer),i=(0,Ma.B)(t,e),r=Object.assign(i,e),s=D.removeUndefined({_layerOptionsFromSource:{title:o.Title}});return D.mergeDeep(s,r)}parseCartoOptions(e,t){const o=[],i=t.layers[1].options.layer_definition;i.layers.forEach(e=>{o.push({type:e.type.toLowerCase(),options:e.options,legend:e.legend})});const r=D.removeUndefined({config:{version:i.version,layers:o}});return D.mergeDeep(r,e)}parseArcgisOptions(e,t,o,i){const r=t.name,s=i.layers?i:void 0,n=(new Mc).generateStyle(t,"esriMeters"===t.units?"m":"degrees"),a=new Mn.Z({target:t.copyrightText});let l,c;if(t.timeInfo){const e=t.timeInfo.timeExtent;l=e[0]+","+e[1];const o=new Date;o.setTime(e[0]);const i=new Date;i.setTime(e[1]),c={min:o.toUTCString(),max:i.toUTCString(),range:!0,type:Ic.DATETIME,style:kc.CALENDAR}}const u=Object.assign({},{legendInfo:s,style:n,timeFilter:c,timeExtent:l,attributions:a}),p=D.removeUndefined({params:u,_layerOptionsFromSource:{title:r,minResolution:dc(t.maxScale),maxResolution:dc(t.minScale),metadata:{extern:!1,abstract:t.description||o.serviceDescription}},sourceFields:t.fields,queryTitle:t.displayField});return D.mergeDeep(p,e)}parseTileOrImageArcgisOptions(e,t,o,i){const r=t.name,s=o.layers?o:void 0,n=new Mn.Z({target:t.copyrightText});let a,l;if(t.timeInfo){const e=t.timeInfo.timeExtent;a=e[0]+","+e[1];const o=new Date;o.setTime(e[0]);const i=new Date;i.setTime(e[1]),l={min:o.toUTCString(),max:i.toUTCString(),range:!0,type:Ic.DATETIME,style:kc.CALENDAR}}const c=Object.assign({},{LAYERS:e.layer?"show:"+e.layer:void 0,time:a}),u=D.removeUndefined({params:c,_layerOptionsFromSource:{title:r,minResolution:dc(t.maxScale),maxResolution:dc(t.minScale),metadata:{extern:!1,abstract:t.description||i.serviceDescription}},legendInfo:s,timeFilter:l,attributions:n,sourceFields:t.fields,queryTitle:t.displayField});return D.mergeDeep(u,e)}findDataSourceInCapabilities(e,t){if(Array.isArray(e)){let o;return e.find(e=>(o=this.findDataSourceInCapabilities(e,t),void 0!==o),this),o}return e.Layer?this.findDataSourceInCapabilities(e.Layer,t):e.Name&&e.Name===t?e:void 0}getTimeFilter(e){let t;if(e.Dimension){const o={};if(t=e.Dimension[0],t.values){const e=t.values.split("/");o.min=void 0!==e[0]?e[0]:void 0,o.max=void 0!==e[1]?e[1]:void 0,o.step=void 0!==e[2]?e[2]:void 0}return t.default&&(o.value=t.default),o}}getStyle(e){return{stylesAvailable:e.map(e=>({name:e.Name,title:e.Title})).filter((e,t,o)=>o.findIndex(t=>t.name===e.name)===t)}}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(Pc))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),(0,je.gn)([(0,Qe.q)({maxCacheCount:20})],e.prototype,"getCapabilities",null),e})();class qc{}let Dc=(()=>{class e{constructor(e){this.config=e,(this.config.getConfig("projections")||[]).forEach(e=>{e.alias=e.alias?e.alias:e.code,this.registerProjection(e)});for(let t=1;t<61;t++)this.registerProjection({code:t<10?`EPSG:3260${t}`:`EPSG:326${t}`,def:`+proj=utm +zone=${t} +datum=WGS84 +units=m +no_defs`,extent:void 0});for(let t=1;t<11;t++){const e=t<10?`EPSG:3218${t}`:`EPSG:321${80+t}`;let o;o=Number(t)<=2?-50-3*Number(t):Number(t)>=12?-81-3*(Number(t)-12):-49.5-3*Number(t),this.registerProjection({code:e,def:`+proj=tmerc +lat_0=0 +lon_0=${o} +k=0.9999 +x_0=304800 +y_0=0 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"`,extent:void 0})}}registerProjection(e){Yn.Z.defs(e.code,e.def),Pn.z(Yn.Z),e.extent&&kn.U2(e.code).setExtent(e.extent)}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(W))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Ec=(()=>{class e{constructor(e,t,o,i,r,s,n){this.capabilitiesService=e,this.optionsService=t,this.wfsDataSourceService=o,this.languageService=i,this.messageService=r,this.projectionService=s,this.authInterceptor=n,this.datasources$=new C.X([])}createAsyncDataSource(e,t){if(!e.type)throw console.error(e),new Error("Datasource needs a type");let o;switch(e.type.toLowerCase()){case"osm":o=this.createOSMDataSource(e);break;case"vector":o=this.createFeatureDataSource(e);break;case"wfs":o=this.createWFSDataSource(e);break;case"wms":const i=e;D.removeDuplicateCaseInsensitive(i.params),o=this.createWMSDataSource(i,t);break;case"wmts":o=this.createWMTSDataSource(e);break;case"xyz":o=this.createXYZDataSource(e);break;case"tiledebug":o=this.createTileDebugDataSource(e);break;case"carto":o=this.createCartoDataSource(e);break;case"arcgisrest":o=this.createArcGISRestDataSource(e,t);break;case"imagearcgisrest":o=this.createArcGISRestImageDataSource(e,t);break;case"websocket":o=this.createWebSocketDataSource(e);break;case"mvt":o=this.createMVTDataSource(e);break;case"tilearcgisrest":o=this.createTileArcGISRestDataSource(e,t);break;case"cluster":o=this.createClusterDataSource(e);break;default:throw console.error(e),new Error("Invalid datasource type")}return this.datasources$.next(this.datasources$.value.concat([o])),o}createOSMDataSource(e){return new Le.y(t=>t.next(new yc(e)))}createFeatureDataSource(e){return new Le.y(t=>t.next(new nc(e)))}createWebSocketDataSource(e){return new Le.y(t=>t.next(new Fc(e)))}createWFSDataSource(e){return new Le.y(t=>t.next(new bc(e,this.wfsDataSourceService,this.authInterceptor)))}createWMSDataSource(e,t){const o=[];return e.optionsFromCapabilities&&o.push(this.capabilitiesService.getWMSOptions(e).pipe((0,b.K)(t=>{const o=this.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),i=this.languageService.translate.instant("igo.geo.dataSource.unavailable",{value:e.params.LAYERS});throw this.messageService.error(i,o),t}))),this.optionsService&&!0===e.optionsFromApi&&o.push(this.optionsService.getWMSOptions(e,t).pipe((0,b.K)(e=>(e.error.toDisplay=!0,e.error.title=this.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),e.error.message=this.languageService.translate.instant("igo.geo.dataSource.optionsApiUnavailable"),(0,A.of)({}))))),o.push((0,A.of)(e)),(0,vn.D)(o).pipe((0,x.U)(e=>{const t=e.reduce((e,t)=>D.mergeDeep(e,t));return new ic(t,this.wfsDataSourceService)}),(0,b.K)(()=>(0,A.of)(void 0)))}createWMTSDataSource(e){return e.optionsFromCapabilities?this.capabilitiesService.getWMTSOptions(e).pipe((0,x.U)(e=>e?new Sc(e):void 0),(0,b.K)(()=>{const t=this.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),o=this.languageService.translate.instant("igo.geo.dataSource.unavailable",{value:e.layer});return this.messageService.error(o,t),(0,A.of)(void 0)})):new Le.y(t=>t.next(new Sc(e)))}createXYZDataSource(e){return new Le.y(t=>t.next(new vc(e)))}createTileDebugDataSource(e){return new Le.y(t=>t.next(new Zc(e)))}createCartoDataSource(e){return e.mapId?this.capabilitiesService.getCartoOptions(e).pipe((0,x.U)(e=>new Cc(e))):new Le.y(t=>t.next(new Cc(e)))}createArcGISRestDataSource(e,t){const o=[];return o.push(this.capabilitiesService.getArcgisOptions(e).pipe((0,b.K)(t=>{const o=this.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),i=this.languageService.translate.instant("igo.geo.dataSource.unavailable",{value:e.layer});throw this.messageService.error(i,o),t}))),this.optionsService&&!0===e.optionsFromApi&&o.push(this.optionsService.getArcgisRestOptions(e,t).pipe((0,b.K)(e=>(e.error.toDisplay=!0,e.error.title=this.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),e.error.message=this.languageService.translate.instant("igo.geo.dataSource.optionsApiUnavailable"),(0,A.of)({}))))),o.push((0,A.of)(e)),(0,vn.D)(o).pipe((0,x.U)(e=>{const t=e.reduce((e,t)=>D.mergeDeep(e,t));return new Tc(t)}),(0,b.K)(()=>(0,A.of)(void 0)))}createArcGISRestImageDataSource(e,t){const o=[];return o.push(this.capabilitiesService.getImageArcgisOptions(e).pipe((0,b.K)(t=>{const o=this.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),i=this.languageService.translate.instant("igo.geo.dataSource.unavailable",{value:e.params.LAYERS});throw this.messageService.error(i,o),t}))),this.optionsService&&!0===e.optionsFromApi&&o.push(this.optionsService.getArcgisRestOptions(e,t).pipe((0,b.K)(e=>(e.error.toDisplay=!0,e.error.title=this.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),e.error.message=this.languageService.translate.instant("igo.geo.dataSource.optionsApiUnavailable"),(0,A.of)({}))))),o.push((0,A.of)(e)),(0,vn.D)(o).pipe((0,x.U)(e=>{const t=e.reduce((e,t)=>D.mergeDeep(e,t));return new Ac(t)}),(0,b.K)(()=>(0,A.of)(void 0)))}createTileArcGISRestDataSource(e,t){const o=[];return o.push(this.capabilitiesService.getImageArcgisOptions(e).pipe((0,b.K)(t=>{const o=this.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),i=this.languageService.translate.instant("igo.geo.dataSource.unavailable",{value:e.params.LAYERS});throw this.messageService.error(i,o),t}))),this.optionsService&&!0===e.optionsFromApi&&o.push(this.optionsService.getArcgisRestOptions(e,t).pipe((0,b.K)(e=>(e.error.toDisplay=!0,e.error.title=this.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),e.error.message=this.languageService.translate.instant("igo.geo.dataSource.optionsApiUnavailable"),(0,A.of)({}))))),o.push((0,A.of)(e)),(0,vn.D)(o).pipe((0,x.U)(e=>{const t=e.reduce((e,t)=>D.mergeDeep(e,t));return new Lc(t)}),(0,b.K)(()=>(0,A.of)(void 0)))}createMVTDataSource(e){return new Le.y(t=>t.next(new Oc(e)))}createClusterDataSource(e){return new Le.y(t=>t.next(new ac(e)))}}return e.\u0275fac=function(t){return new(t||e)(r.LFG($c),r.LFG(qc,8),r.LFG(xc),r.LFG(ue),r.LFG(de),r.LFG(Dc),r.LFG(ln))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Rc(e,t,o){o=o||at;const i=(new Xn.Z).readFeature(e,{dataProjection:e.projection,featureProjection:t});i.setId(o(e));const r=lt(e);void 0!==r&&i.set("_title",r,!0),void 0!==e.extent&&i.set("_extent",e.extent,!0),void 0!==e.projection&&i.set("_projection",e.projection,!0);const s=nt(e,"meta.mapTitle");void 0!==s&&i.set("_mapTitle",s,!0),i.set("_entityRevision",function(e){return(e.meta||{}).revision||0}(e),!0);const n=ct(e);return void 0!==n&&i.set("_icon",n,!0),e.meta&&e.meta.style&&i.set("_style",e.meta.style,!0),e.sourceId&&i.set("_sourceId",e.sourceId,!0),i}function Uc(e,t,o,i="EPSG:4326"){let r,s,n,a;const l=new Xn.Z,c=e.getKeys().filter(e=>!e.startsWith("_")&&"geometry"!==e).reduce((t,o)=>(t[o]=e.get(o),t),{}),u=l.writeGeometryObject(e.getGeometry(),{dataProjection:i,featureProjection:t});if(o){r=o.get("title");const e=o.get("sourceOptions");e&&(s=e.excludeAttribute,n=e.excludeAttributeOffline,a=e.idColumn||("arcgisrest"===e.type||"tilearcgisrest"===e.type?"OBJECTID":void 0))}else r=e.get("_title");const p=e.get("_mapTitle"),d=e.getId()?e.getId():e.get(a)?e.get(a):N();return{type:Zl,projection:i,extent:e.get("_extent"),meta:{id:d,title:r||p||d,mapTitle:p,revision:e.getRevision(),style:e.get("_style"),excludeAttribute:s,excludeAttributeOffline:n},properties:c,geometry:u,ol:e}}function Nc(e,t){const[o,i]=zn.ap(e);return[t[3]?e[0]-o*t[3]:e[0],t[2]?e[1]-i*t[2]:e[1],t[1]?e[2]+o*t[1]:e[2],t[0]?e[3]+i*t[0]:e[3]]}function Jc(e,t,o=Fl.Default,i,r){const s=function(e,t){const o=zn.lJ();return t.forEach(t=>{const i=function(e,t){let o=zn.lJ();const i=t.get("_extent"),r=t.get("_projection");if(void 0!==i&&void 0!==r)o=kn.$A(i,r,e.projection);else{const e=t.getGeometry();null!==e&&(o=e.getExtent())}return o}(e,t);zn.l7(o,i)}),o}(e,t);let n=s;void 0!==i&&(n=Nc(n,i)),o===Fl.Zoom?e.viewController.zoomToExtent(n):o===Fl.Move?e.viewController.moveToExtent(n):o===Fl.Default&&(function(e,t){const o=Nc(e.viewController.getExtent(),[-1,-1,-1,-1].map(e=>.05*e));return!zn.r4(o,t)}(e,s)||function(e,t,o){o=o||.004;const i=e.viewController.getExtent(),r=zn.bg(i),s=zn.bg(t);return!(0===s&&e.viewController.getZoom()>13)&&s/r<o}(e,s,r))&&e.viewController.zoomToExtent(n)}function Bc(e,t){void 0===e.layer?(t=t||new fc({source:new nc}),e.bindLayer(t),void 0===e.layer.map&&e.map.addLayer(e.layer)):void 0===e.layer.map&&e.map.addLayer(e.layer)}class jc extends dt{constructor(e,t){super(e,t),this.map=t.map}get source(){return this.layer?this.layer.dataSource:void 0}bindLayer(e){return this.layer=e,this}setLayerFeatures(e,t=Fl.Default,o,i,r){r=r||at,this.checkLayer();const s=e.map(e=>Rc(e,this.map.projection,r));this.setLayerOlFeatures(s,t,o,i)}setStoreOlFeatures(e){this.checkLayer();const t=e.map(e=>(e.set("_featureStore",this,!0),Uc(e,this.layer.map.projection)));this.load(t)}clearLayer(){this.checkLayer(),this.source.ol.clear()}checkLayer(){if(void 0===this.layer)throw new Error("This FeatureStore is not bound to a layer.")}setLayerOlFeatures(e,t=Fl.Default,o,i){const r=function(e,t){const o=new Map;t.forEach(e=>{o.set(e.getId(),e)});const i=[];e.forEach(e=>{const t=o.get(e.getId());void 0===t||t.get("_entityRevision")!==e.get("_entityRevision")?i.push(e):o.delete(t.getId())});const r=Array.from(o.keys());return{add:t.filter(e=>r.indexOf(e.getId())>=0),remove:i}}(this.layer.ol.getSource().getFeatures(),e);r.remove.length>0&&this.removeOlFeaturesFromLayer(r.remove),r.add.length>0&&this.addOlFeaturesToLayer(r.add),r.add.length>0?Jc(this.map,r.add,t,o,i):r.remove.length>0&&Jc(this.map,e,t,o,i)}addOlFeaturesToLayer(e){e.forEach(e=>{e.set("_featureStore",this,!0)}),this.source.ol.addFeatures(e)}removeOlFeaturesFromLayer(e){e.forEach(e=>{this.source.ol.removeFeature(e)})}}class Qc extends gt{constructor(e){super(e),this.options=e,this.stores$$=new Map,this.states$$=[]}bindStore(e){super.bindStore(e),!0===this.active&&this.watchStore(e),this.empty$$=e.empty$.pipe((0,Tn.n)(e=>!e)).subscribe(()=>this.updateEntitiesInExtent(e))}unbindStore(e){super.unbindStore(e),!0===this.active&&this.unwatchStore(e)}doActivate(){this.stores.forEach(e=>this.watchStore(e))}doDeactivate(){this.unwatchAll()}watchStore(e){this.stores$$.has(e)||(this.updateEntitiesInExtent(e),this.states$$.push(e.layer.map.viewController.state$.subscribe(()=>{this.updateEntitiesInExtent(e)})))}updateEntitiesInExtent(e){var t,o;if(null===(o=null===(t=null==e?void 0:e.layer)||void 0===t?void 0:t.map)||void 0===o?void 0:o.viewController){e.state.updateAll({inMapExtent:!1});const t=e.layer.map.viewController.getExtent(),o=e.entities$.value.filter(e=>zn.kK(e.ol.getGeometry().getExtent(),t));o.length>0&&e.state.updateMany(o,{inMapExtent:!0},!0)}}unwatchStore(e){void 0!==this.stores$$.get(e)&&this.stores$$.delete(e)}unwatchAll(){this.stores$$.clear(),this.states$$.map(e=>e.unsubscribe()),this.empty$$&&this.empty$$.unsubscribe()}}class Gc extends gt{constructor(e){super(e),this.options=e,this.stores$$=new Map,this.resolution$$=[]}bindStore(e){super.bindStore(e),!0===this.active&&this.watchStore(e),this.empty$$=e.empty$.subscribe(()=>this.updateEntitiesInResolution(e,e.layer.map.viewController.getResolution()))}unbindStore(e){super.unbindStore(e),!0===this.active&&this.unwatchStore(e)}doActivate(){this.stores.forEach(e=>this.watchStore(e))}doDeactivate(){this.unwatchAll()}watchStore(e){this.stores$$.has(e)||(this.updateEntitiesInResolution(e,e.layer.map.viewController.getResolution()),this.resolution$$.push(e.layer.map.viewController.resolution$.subscribe(t=>{this.updateEntitiesInResolution(e,t)})))}updateEntitiesInResolution(e,t){e.state.updateAll(t>e.layer.minResolution&&t<e.layer.maxResolution?{inMapResolution:!0}:{inMapResolution:!1})}unwatchStore(e){void 0!==this.stores$$.get(e)&&this.stores$$.delete(e)}unwatchAll(){this.stores$$.clear(),this.resolution$$.map(e=>e.unsubscribe()),this.empty$$&&this.empty$$.unsubscribe()}}class Yc extends gt{constructor(e){super(e),this.options=e,this.stores$$=new Map,this.setMotion(e.motion)}bindStore(e){super.bindStore(e),!0===this.active&&this.watchStore(e)}unbindStore(e){super.unbindStore(e),!0===this.active&&this.unwatchStore(e)}setMotion(e){this.motion=e}doActivate(){this.stores.forEach(e=>this.watchStore(e))}doDeactivate(){this.unwatchAll()}watchStore(e){if(this.stores$$.has(e))return;const t=e.view.all$().subscribe(t=>this.onFeaturesChange(t,e));this.stores$$.set(e,t)}unwatchStore(e){const t=this.stores$$.get(e);void 0!==t&&(t.unsubscribe(),this.stores$$.delete(e))}unwatchAll(){Array.from(this.stores$$.entries()).forEach(e=>{e[1].unsubscribe()}),this.stores$$.clear()}onFeaturesChange(e,t){0===e.length?t.clearLayer():t.setLayerFeatures(e,this.selectMotion(t),this.options.viewScale,this.options.areaRatio,this.options.getFeatureId)}selectMotion(e){return void 0!==this.motion?this.motion:!0===e.pristine||e.count>e.view.count?Fl.Default:Fl.None}}class zc extends gt{constructor(e){super(e),this.options=e,this.stores$$=new Map}bindStore(e){super.bindStore(e),!0===this.active&&this.watchStore(e)}unbindStore(e){super.unbindStore(e),!0===this.active&&this.unwatchStore(e)}doActivate(){this.stores.forEach(e=>this.watchStore(e))}doDeactivate(){this.unwatchAll()}watchStore(e){this.stores$$.has(e)||(this.onSourceChanges(e),e.layer.ol.getSource().on("change",t=>{this.onSourceChanges(e)}))}unwatchStore(e){void 0!==this.stores$$.get(e)&&this.stores$$.delete(e)}unwatchAll(){Array.from(this.stores$$.entries()).forEach(e=>{}),this.stores$$.clear()}onSourceChanges(e){let t=e.layer.ol.getSource().getFeatures();e.layer.dataSource instanceof ac&&(t=t.flatMap(e=>e.get("features"))),0===t.length?e.clear():e.setStoreOlFeatures(t)}}class Hc extends Ra.Z{constructor(e){super(e)}}class Vc extends gt{constructor(e){super(e),this.options=e,this.setMotion(e.motion),this._overlayStore=this.createOverlayStore()}get map(){return this.options.map}get overlayStore(){return this._overlayStore}bindStore(e){super.bindStore(e),!0===this.active&&this.activate()}unbindStore(e){super.unbindStore(e),!0===this.active&&this.activate()}setMotion(e){this.motion=e}unselectAll(){this.stores.forEach(e=>{e.state.updateAll({selected:!1})})}clear(){this.overlayStore.source.ol.clear(),this.overlayStore.clear()}deactivateSelection(){this.unlistenToMapClick(),this.removeDragBoxInteraction(),this.unwatchAll()}doActivate(){this.addOverlayLayer(),this.listenToMapClick(),!0===this.options.dragBox&&this.addDragBoxInteraction(),this.watchAll()}doDeactivate(){this.deactivateSelection(),this.removeOverlayLayer()}watchAll(){this.unwatchAll();const e=this.stores.map(e=>e.stateView.manyBy$(e=>!0===e.state.selected).pipe((0,x.U)(e=>e.map(e=>e.entity))));this.stores$$=(0,L.aj)(e).pipe((0,w.b)(5),(0,Oe.T)(1),(0,x.U)(e=>e.reduce((e,t)=>e.concat(t)))).subscribe(e=>this.onSelectFromStore(e))}unwatchAll(){void 0!==this.stores$$&&this.stores$$.unsubscribe()}listenToMapClick(){this.mapClickListener=this.map.ol.on("singleclick",e=>{this.onMapClick(e)})}unlistenToMapClick(){(0,ea.B)(this.mapClickListener)}onMapClick(e){const t=!hc(e),o=!t,i=e.map.getFeaturesAtPixel(e.pixel,{hitTolerance:this.options.hitTolerance||0,layerFilter:e=>void 0!==this.stores.find(t=>t.layer.ol===e)});this.onSelectFromMap(i,t,o)}addDragBoxInteraction(){let e;const t=this.map.ol.getInteractions().getArray();for(const o of t)if(o instanceof Hc){e=o;break}void 0===e&&(e=new Hc({condition:hc}),this.map.ol.addInteraction(e),this.olDragSelectInteraction=e),this.olDragSelectInteractionEndKey=e.on("boxend",e=>this.onDragBoxEnd(e))}removeDragBoxInteraction(){void 0!==this.olDragSelectInteractionEndKey&&(0,ea.B)(this.olDragSelectInteractionEndKey),void 0!==this.olDragSelectInteraction&&this.map.ol.removeInteraction(this.olDragSelectInteraction),this.olDragSelectInteraction=void 0}onDragBoxEnd(e){const t=!hc(e.mapBrowserEvent),o=e.target.getGeometry().getExtent(),i=this.stores.reduce((e,t)=>{const i=t.layer.ol.getSource();return e.push(...i.getFeaturesInExtent(o)),e},[]);this.onSelectFromMap(i,t,!1)}onSelectFromStore(e){const t=this.motion,o=this.overlayStore.layer.ol.getSource().getFeatures().map(e=>e.getId()),i=e.map(this.overlayStore.getKey);let r;r=0!==e.length&&(o.length!==i.length||!o.every(e=>i.indexOf(e)>=0)),this.overlayStore.setLayerFeatures(e,r?t:Fl.None,this.options.viewScale,this.options.areaRatio,this.options.getFeatureId)}onSelectFromMap(e,t,o){const i=this.groupFeaturesByStore(e);this.stores.forEach(e=>{const r=i.get(e);void 0===r&&!0===t?this.unselectAllFeaturesFromStore(e):void 0===r&&!1===t||this.selectFeaturesFromStore(e,r,t,o)})}selectFeaturesFromStore(e,t,o,i){!0===i?e.state.reverseMany(t,["selected"]):e.state.updateMany(t,{selected:!0},o)}unselectAllFeaturesFromStore(e){e.state.updateAll({selected:!1})}groupFeaturesByStore(e){const t=new Map;return null==e||e.forEach(e=>{const o=e.get("_featureStore");if(void 0===o)return;let i=t.get(o);void 0===i&&(i=[],t.set(o,i));const r=o.get(e.getId());void 0!==r&&i.push(r)}),t}createOverlayStore(){const e=this.options.layer?this.options.layer:this.createOverlayLayer();return new jc([],{map:this.map}).bindLayer(e)}createOverlayLayer(){return new fc({zIndex:300,source:new nc,style:void 0,showInLayerList:!1,exportable:!1,browsable:!1})}addOverlayLayer(){void 0===this.overlayStore.layer.map&&this.map.addLayer(this.overlayStore.layer)}removeOverlayLayer(){this.overlayStore.source.ol.clear(),this.map.removeLayer(this.overlayStore.layer)}}function Wc(e,t){void 0===e.getStrategyOfType(Yc)?(t=t||new Yc({}),e.addStrategy(t),t.activate()):e.activateStrategyOfType(Yc)}function Xc(e,t){void 0===e.getStrategyOfType(Vc)?(t=t||new Vc({map:e.map}),e.addStrategy(t),t.activate()):e.activateStrategyOfType(Vc)}function Kc({text:e,opacity:t=1,markerColor:o=[0,161,222],markerOutlineColor:i=[255,255,255]}={}){let r,s,n,a;const l=/msie\s|trident\/|edge\//i.test(window.navigator.userAgent),c=(0,oa._2)(o).slice(0),u=(0,oa._2)(i).slice(0);let p;if(4===c.length&&("string"!=typeof o||/^#[0-9A-F]{8}$/i.test(o))&&(t=c[3]),s=`"rgba(${c[0]},${c[1]},${c[2]},${t})"`,r=o,n=`"rgb(${u[0]},${u[1]},${u[2]})"`,a='data:image/svg+xml;utf8,<svg version="1.1" xmlns="http://www.w3.org/2000/svg" height="36" width="36" viewBox="0 0 36 36"><path fill='+s+" stroke="+n+' stroke-width="2" d="M 17.692635,32.565644 C 15.71852,30.330584 13.290925,27.058065 11.6766,24.455732 9.3398623,20.688851 7.8905694,17.205334 7.6297492,14.728733 7.5616025,14.081649 7.5739557,12.528552 7.6513363,12.014724 8.1013861,9.0262716 9.8047068,6.3655569 12.310675,4.7364878 c 1.113691,-0.7239832 2.508083,-1.2834131 3.776687,-1.5152052 0.242945,-0.044389 0.451656,-0.09393 0.463804,-0.1100911 0.01215,-0.016161 0.638282,-0.025502 1.391411,-0.02076 1.088235,0.00685 1.450932,0.024316 1.766871,0.085071 2.650763,0.5097353 4.947142,1.8701891 6.498786,3.8501033 0.628018,0.8013587 1.297046,2.0200608 1.640967,2.9891872 0.191065,0.538399 0.427644,1.447408 0.477391,1.834287 0.0164,0.127546 0.0434,0.231902 0.06,0.231902 0.0166,0 0.03122,0.626135 0.03249,1.391411 0.0013,0.765276 -0.011,1.391411 -0.02726,1.391411 -0.01626,0 -0.05449,0.154049 -0.08495,0.342331 -0.08815,0.544879 -0.387235,1.721449 -0.604837,2.379406 -1.209421,3.656888 -4.014463,8.349762 -7.849521,13.132357 -0.790496,0.985807 -1.795217,2.167992 -1.842543,2.167992 -0.01896,0 -0.161766,-0.144111 -0.317336,-0.320246 z m 1.066937,-15.36525 c 0.133519,-0.02121 0.248766,-0.05657 0.256105,-0.07859 0.0073,-0.02202 0.04918,-0.03066 0.09298,-0.0192 0.0438,0.01145 0.107628,-0.0072 0.141834,-0.04137 0.03421,-0.03421 0.08456,-0.05474 0.111888,-0.04563 0.02733,0.0091 0.07703,-0.01077 0.110429,-0.04417 0.03341,-0.03341 0.08416,-0.05293 0.112796,-0.04338 0.02863,0.0095 0.08974,-0.01867 0.135802,-0.06271 0.04606,-0.04403 0.111902,-0.08625 0.146319,-0.09381 0.204084,-0.04483 0.762371,-0.519108 1.079463,-0.917027 0.26749,-0.335672 0.570987,-0.878795 0.529019,-0.946701 -0.01496,-0.0242 -0.0067,-0.044 0.01835,-0.044 0.05645,0 0.196809,-0.467982 0.158801,-0.529481 -0.01521,-0.02461 -0.0043,-0.04475 0.02427,-0.04475 0.03157,0 0.04365,-0.04329 0.03082,-0.11043 -0.01161,-0.06074 -0.0066,-0.110429 0.01124,-0.110429 0.01779,0 0.03235,-0.258405 0.03235,-0.574233 0,-0.315829 -0.01545,-0.574234 -0.03434,-0.574234 -0.01889,0 -0.02437,-0.03811 -0.01219,-0.08469 0.04412,-0.168712 -0.336329,-1.152668 -0.481536,-1.245401 -0.02327,-0.01486 -0.04022,-0.03992 -0.03765,-0.05568 0.01222,-0.07498 -0.156557,-0.318365 -0.406379,-0.586027 -0.295921,-0.317054 -0.773059,-0.690104 -0.83427,-0.652274 -0.0206,0.01273 -0.03745,0.0024 -0.03745,-0.02289 0,-0.06107 -0.433076,-0.2789369 -0.487546,-0.245273 -0.02338,0.01445 -0.04251,0.0068 -0.04251,-0.01695 0,-0.056281 -0.393995,-0.1865457 -0.613804,-0.2029397 -0.0943,-0.00703 -0.188579,-0.023183 -0.209503,-0.035888 -0.02092,-0.012705 -0.276571,-0.023337 -0.568105,-0.023627 -0.534044,-5.301e-4 -1.12638,0.091025 -1.12638,0.1741017 0,0.023781 -0.01713,0.032648 -0.03808,0.019705 -0.05054,-0.031232 -0.403641,0.1088602 -0.403641,0.1601422 0,0.02204 -0.01988,0.02779 -0.04417,0.01278 -0.0243,-0.01501 -0.04417,-0.0051 -0.04417,0.02209 0,0.02716 -0.01988,0.0371 -0.04417,0.02209 -0.0243,-0.01501 -0.04417,-0.0051 -0.04417,0.02209 0,0.02716 -0.01915,0.03755 -0.04256,0.02308 -0.02341,-0.01447 -0.08138,0.01252 -0.128834,0.05997 -0.04745,0.04745 -0.0974,0.07515 -0.111001,0.06155 -0.0136,-0.0136 -0.03722,0.0078 -0.05248,0.0476 -0.01526,0.03978 -0.0411,0.06408 -0.0574,0.054 -0.03277,-0.02025 -0.462299,0.323995 -0.491977,0.394291 -0.01026,0.02429 -0.07454,0.0912 -0.142856,0.148686 -0.248033,0.208705 -0.730279,0.974169 -0.672565,1.067553 0.0145,0.02346 0.0059,0.04266 -0.01914,0.04266 -0.05907,0 -0.241471,0.599428 -0.208527,0.685278 0.01385,0.0361 0.0044,0.06564 -0.02098,0.06564 -0.02539,0 -0.04169,0.0646 -0.03622,0.143558 0.0055,0.07896 -0.0042,0.213129 -0.02144,0.29816 -0.04741,0.233576 0.0511,1.055502 0.167516,1.397721 0.126048,0.370516 0.310099,0.740163 0.426484,0.856548 0.04776,0.04776 0.07554,0.08684 0.06174,0.08684 -0.0138,0 0.01516,0.05653 0.06436,0.125632 0.131301,0.184396 0.499365,0.587266 0.518785,0.567846 0.0092,-0.0092 0.09821,0.06081 0.197812,0.155562 0.09961,0.09475 0.190589,0.162786 0.202187,0.151188 0.0116,-0.0116 0.05991,0.01774 0.107361,0.06519 0.04745,0.04745 0.105426,0.07444 0.128834,0.05997 0.02341,-0.01447 0.04256,-0.0057 0.04256,0.01958 0,0.06106 0.344664,0.23496 0.399061,0.201341 0.02346,-0.0145 0.04266,-0.0059 0.04266,0.01914 0,0.05907 0.599429,0.241471 0.685279,0.208527 0.0361,-0.01385 0.06564,-0.0065 0.06564,0.01645 0,0.05196 1.079115,0.04833 1.413314,-0.0048 z"></path></svg>',l){switch(o){case"blue":r="blue";break;case"red":r="red";break;case"yellow":r="yellow";break;case"green":r="green";break;default:r="blue"}p="./assets/igo2/geo/icons/place_"+r+"_36px.svg"}else p=a;return new Un.ZP({image:new Bn.Z({src:a,opacity:t,imgSize:[36,36],anchor:[.5,.92]}),text:new Nn.Z({text:e,font:"12px Calibri,sans-serif",fill:new Jn.Z({color:"#000"}),stroke:new jn.Z({color:"#fff",width:3}),overflow:!0})})}let eu=(()=>{class e{createStyle(e){return e?"function"==typeof e||e instanceof Un.ZP?e:this.parseStyle("style",e):Kc()}parseStyle(e,t){const o={},i=this.getOlCls(e);return i&&t instanceof Object?(Object.keys(t).forEach(e=>{const i=this.getOlKey(e);o[i]=this.parseStyle(e,t[e])}),new i(o)):t}getOlKey(e){let t;switch(e.toLowerCase()){case"circle":case"regularshape":case"icon":t="image"}return t||e}getOlCls(e){let t=Rn[e.charAt(0).toUpperCase()+e.slice(1)];return"regularshape"===e&&(t=Gn.Z),"backgroundFill"===e&&(t=Jn.Z),"backgroundStroke"===e&&(t=jn.Z),t}createStyleByAttribute(e,t){let o;const i=t.type?t.type:this.guessTypeFeature(e),r=t.attribute,s=t.data,n=t.stroke,a=t.width,l=t.fill,c=t.radius,u=t.icon,p=t.scale,d=s?s.length:0,h=t.label,g=h instanceof Un.ZP?this.parseStyle("text",t.label)||new Nn.Z:void 0,m=t.baseStyle;if(g){const t={text:this.getLabel(e,h)};g.setText(g instanceof Un.ZP?new Nn.Z(t):this.getLabel(e,h))}if("circle"===i){for(let t=0;t<d;t++){const i=void 0!==e.get(r)?e.get(r):"";if(i===s[t]||i.toString().match(s[t]))return u?(o=[new Un.ZP({image:new Bn.Z({src:u[t],scale:p?p[t]:1})})],o):(o=[new Un.ZP({image:new Qn.Z({radius:c?c[t]:4,stroke:new jn.Z({color:n?n[t]:"black",width:a?a[t]:1}),fill:new Jn.Z({color:l?l[t]:"black"})}),text:g instanceof Nn.Z?g:void 0})],o)}if(!e.getStyle())return m?(o=this.createStyle(m),g&&o.setText(g),o):(o=[new Un.ZP({image:new Qn.Z({radius:4,stroke:new jn.Z({color:"black"}),fill:new Jn.Z({color:"#bbbbf2"})})})],o)}else if("regular"===i){for(let t=0;t<d;t++){const i=void 0!==e.get(r)?e.get(r):"";if(i===s[t]||i.toString().match(s[t]))return o=[new Un.ZP({stroke:new jn.Z({color:n?n[t]:"black",width:a?a[t]:1}),fill:new Jn.Z({color:l?l[t]:"rgba(255,255,255,0.4)"}),text:g instanceof Nn.Z?g:void 0})],o}if(e instanceof Fn.Z&&!e.getStyle())return m?(o=this.createStyle(m),g&&o.setText(g),o):(o=[new Un.ZP({stroke:new jn.Z({color:"black"}),fill:new Jn.Z({color:"#bbbbf2"})})],o)}}createClusterStyle(e,t={},o){let i;const r=e.get("features").length;if(1!==r){if(t.clusterRanges)for(const e of t.clusterRanges)if((!e.minRadius||e.minRadius<=r)&&(!e.maxRadius||e.maxRadius>=r)){if(i=this.createStyle(e.style),e.showRange){const e=new Nn.Z({text:r.toString(),fill:new Jn.Z({color:"#fff"})});i.setText(e)}if(e.dynamicRadius){let e;const t=i.getRadius();e=5*Math.log(r),e<t&&(e=t),i.image_.setRadius(e)}break}if(!i){let e;if(t.radiusCalc)e=t.radiusCalc(r);else{const t=6;e=5*Math.log(r),e<t&&(e=t)}i=[new Un.ZP({image:new Qn.Z({radius:e,stroke:new jn.Z({color:"black"}),fill:new Jn.Z({color:"rgba(24, 134, 45, 0.5)"})}),text:new Nn.Z({text:r.toString(),fill:new Jn.Z({color:"#fff"})})})]}}else i=this.createStyle(o);return i}getLabel(e,t){let o=t;const i=Array.from(t.matchAll(/\$\{([^\{\}]+)\}/g));return i.forEach(t=>{o=o.replace(t[0],e.get(t[1]))}),0===i.length&&o===t&&(o=e.get(t)||t),o}guessTypeFeature(e){switch(e.getGeometry().getType()){case"Point":case"MultiPoint":case"Circle":return"circle";default:return"regular"}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function tu(){const e=function({text:e,strokeWidth:t=2,fillColor:o=[0,161,222,.3],strokeColor:i=[0,161,222,.9]}={}){const r=(0,oa._2)(o).slice(0),s=(0,oa._2)(i).slice(0),n=new jn.Z({width:t,color:s}),a=new Jn.Z({color:r});return new Un.ZP({stroke:n,fill:a,image:new Qn.Z({radius:5,stroke:n,fill:a}),text:new Nn.Z({text:e,font:"12px Calibri,sans-serif",fill:new Jn.Z({color:"#000"}),stroke:new jn.Z({color:"#fff",width:3}),overflow:!0})})}(),t=Kc();let o;return i=>{if("bufferFeature"===i.getId())return o=function(e=[0,161,222,1],t=2,o=[0,161,222,.15],i){const r=new jn.Z({width:t,color:e}),s=new Jn.Z({color:o});return new Un.ZP({stroke:r,fill:s,image:new Qn.Z({radius:5,stroke:r,fill:s}),text:new Nn.Z({font:"12px Calibri,sans-serif",text:i,fill:new Jn.Z({color:"#000"}),stroke:new jn.Z({color:"#fff",width:3}),overflow:!0})})}(i.get("bufferStroke"),2,i.get("bufferFill"),i.get("bufferText")),o;{const r=i.get("_style");return r?(new eu).createStyle(r):(o="Point"===i.getGeometry().getType()?t:e,o.getText().setText(i.get("_mapTitle")),o)}}}class ou{constructor(e){this.layer=function(){const e=new nc;return new fc({title:"Overlay",zIndex:300,source:e,style:tu()})}(),this.setMap(e)}get dataSource(){return this.layer.dataSource}setMap(e){void 0===e?void 0!==this.map&&this.map.ol.removeLayer(this.layer.ol):e.ol.addLayer(this.layer.ol),this.map=e}setFeatures(e,t=Fl.Default,o){if(o)for(const i of this.dataSource.ol.getFeatures())i.get("_sourceId")===o&&this.removeOlFeature(i);else this.clear();this.addFeatures(e,t)}addFeature(e,t=Fl.Default){this.addFeatures([e],t)}addFeatures(e,t=Fl.Default){const o=[];e.forEach(e=>{const t=Rc(e,this.map.projection);null!==t.getGeometry()&&o.push(t)}),this.addOlFeatures(o,t)}addOlFeature(e,t=Fl.Default){this.addOlFeatures([e],t)}addOlFeatures(e,t=Fl.Default){this.dataSource.ol.addFeatures(e),Jc(this.map,e,t)}removeFeature(e){this.removeFeatures([e])}removeFeatures(e){e.forEach(e=>{e.meta&&this.dataSource.ol.getFeatureById(e.meta.id)&&this.removeOlFeature(this.dataSource.ol.getFeatureById(e.meta.id))})}removeOlFeature(e){this.dataSource.ol.removeFeature(e)}clear(){this.dataSource.ol.clear()}}class iu extends B{constructor(){super(),this.loaded=0,this.loading=0,this.layers=[],this.subscriptions=[]}watch(){}unwatch(){this.layers.forEach(e=>this.unwatchLayer(e),this)}watchLayer(e){if(void 0===e.status$)return;this.layers.push(e);const t=e.status$.pipe((0,M.x)()).subscribe(e=>{e===J.Error&&(this.loading=0,this.loaded=-1),e===J.Working?this.loading+=1:e===J.Done&&(this.loaded+=1),this.loaded>=this.loading?(this.loading=this.loaded=0,this.status=J.Done):this.loading>0&&(this.status=J.Working)});this.subscriptions.push(t)}unwatchLayer(e){e.status$.next(J.Done);const t=this.layers.indexOf(e);t>=0&&(-1!==[J.Working,J.Waiting].indexOf(e.watcher.status)&&(this.loaded+=1),this.subscriptions[t].unsubscribe(),this.subscriptions.splice(t,1),this.layers.splice(t,1),e.watcher.unwatch())}}var ru=(()=>{return(e=ru||(ru={}))[e.Move=0]="Move",e[e.Zoom=1]="Zoom",ru;var e})();class su extends class{constructor(){this.observerKeys=[]}getOlMap(){return this.olMap}setOlMap(e){if(void 0!==e&&void 0!==this.getOlMap())throw new Error("This controller is already bound to a map.");if(void 0===e)return this.teardownObservers(),void(this.olMap=e);this.olMap=e}teardownObservers(){this.observerKeys.forEach(e=>(0,ea.B)(e)),this.observerKeys=[]}}{constructor(e){super(),this.options=e,this.resolution$=new C.X(void 0),this.state$=new C.X(void 0),this.padding=[0,0,0,0],this.maxZoomOnExtent=19,this.extent$=new O.xQ,this.states=[],this.stateIndex=0}get stateHistory(){return!!this.options&&!0===this.options.stateHistory}get olView(){return this.olMap.getView()}setOlMap(e){super.setOlMap(e),this.setupObservers()}setupObservers(){!0===this.stateHistory&&this.observerKeys.push(this.olMap.on("moveend",e=>this.onMoveEnd(e))),this.extent$$=this.extent$.pipe((0,w.b)(25)).subscribe(e=>{this.setExtent(e.extent,e.action)})}teardownObservers(){super.teardownObservers(),void 0!==this.extent$$&&(this.extent$$.unsubscribe(),this.extent$$=void 0)}getOlProjection(){return this.olView.getProjection()}getCenter(e){let t=this.olView.getCenter();return e&&t&&(t=kn.vs(t,this.getOlProjection(),e)),t}getExtent(e){let t=this.olView.calculateExtent(this.olMap.getSize());return e&&t&&(t=kn.$A(t,this.getOlProjection(),e)),t}getScale(e=96){return function(e,t="m",o=96){return e*kn.Wm[t]*39.3701*o}(this.getResolution(),this.getOlProjection().getUnits(),e)}getResolution(){return this.olView.getResolution()}getZoom(){return Math.round(this.olView.getZoom())}zoomIn(){this.zoomTo(this.olView.getZoom()+1)}zoomOut(){this.zoomTo(this.olView.getZoom()-1)}zoomTo(e){this.olView.cancelAnimations(),this.olView.animate({zoom:e,duration:250,easing:ta.Vv})}moveToExtent(e){this.extent$.next({extent:e,action:ru.Move})}zoomToExtent(e){this.extent$.next({extent:e,action:ru.Zoom})}getRotation(){return this.olView.getRotation()}resetRotation(){this.olView.animate({rotation:0})}hasPreviousState(){return this.states.length>1&&this.stateIndex>0}hasNextState(){return this.states.length>1&&this.stateIndex<this.states.length-1}previousState(){this.hasPreviousState()&&this.setStateIndex(this.stateIndex-1)}nextState(){this.hasNextState()&&this.setStateIndex(this.stateIndex+1)}clearStateHistory(){this.states=[],this.stateIndex=0}setInitialState(){this.states.length>0&&this.setStateIndex(0)}setExtent(e,t,o=!0){const i=this.olView;i.cancelAnimations();const r=o?500:0,s=i.getZoom(),n=i.getCenter(),a=[e[0]+(e[2]-e[0])/2,e[1]+(e[3]-e[1])/2],l=Math.sqrt(Math.pow(n[0]-a[0],2)+Math.pow(n[1]-a[1],2)),c=i.calculateExtent(),u=Math.sqrt(Math.pow(c[2]-c[0],2)+Math.pow(c[3]-c[1],2)),p=l/((Math.sqrt(Math.pow(e[2]-e[0],2)+Math.pow(e[3]-e[1],2))+u)/2),d=t===ru.Move||s>this.maxZoomOnExtent?s:this.maxZoomOnExtent;i.fit(e,{size:this.olMap.getSize(),maxZoom:d,padding:this.padding,duration:p>4?0:r,callback:t=>{t||i.fit(e,{size:this.olMap.getSize(),maxZoom:d,padding:this.padding,duration:p>4?0:r})}})}setStateIndex(e){this.stateIndex=e,this.setState(this.states[e])}setState(e){this.olView.animate({resolution:e.resolution,center:e.center,duration:0})}onMoveEnd(e){const t=this.getResolution();this.resolution$.value!==t&&this.resolution$.next(t);const o={resolution:t,center:this.getCenter(),zoom:this.getZoom()};if(!0===this.stateHistory){const e=this.stateIndex;(function(e,t){if(void 0===e||void 0===t)return!1;const o=1e-4;return e.zoom===t.zoom&&Math.trunc(e.center[0]/o)===Math.trunc(t.center[0]/o)&&Math.trunc(e.center[1]/o)===Math.trunc(t.center[1]/o)})(o,0===this.states.length?void 0:this.states[e])||(this.states=this.states.slice(0,e+1).concat([o]),this.stateIndex=this.states.length-1)}this.state$.next(o)}}class nu{constructor(e){this.offlineButtonToggle$=new C.X(!1),this.layers$=new C.X([]),this.positionFollower=!0,this.geolocation$=new C.X(void 0),this.swipeEnabled$=new C.X(!1),this.mapCenter$=new C.X(!1),this.selectedFeatures$=new C.X(null),this.defaultOptions={controls:{attribution:!1}},this.options=Object.assign({},this.defaultOptions,e),this.layerWatcher=new iu,this.status$=this.layerWatcher.status$,Pn.z(Yn.Z),this.init()}get layers(){return this.layers$.value}get projection(){return this.viewController.getOlProjection().getCode()}init(){const e=[];this.options.controls&&(this.options.controls.attribution&&e.push(new Mn.Z(!0===this.options.controls.attribution?{}:this.options.controls.attribution)),this.options.controls.scaleLine&&e.push(new In.Z(!0===this.options.controls.scaleLine?{}:this.options.controls.scaleLine)));let t={};!1===this.options.interactions&&(t={altShiftDragRotate:!1,doubleClickZoom:!1,keyboard:!1,mouseWheelZoom:!1,shiftDragZoom:!1,dragPan:!1,pinchRotate:!1,pinchZoom:!1}),this.ol=new Ln.Z({interactions:$n.ce(t),controls:e}),this.setView(this.options.view||{}),this.viewController=new su({stateHistory:!0}),this.viewController.setOlMap(this.ol),this.overlay=new ou(this),this.queryResultsOverlay=new ou(this),this.searchResultsOverlay=new ou(this),this.buffer=new ou(this)}setTarget(e){this.ol.setTarget(e),void 0!==e?this.layerWatcher.subscribe(()=>{},null):this.layerWatcher.unsubscribe()}updateView(e){const t=this.ol.getView(),o=Object.assign({zoom:t.getZoom()},t.getProperties());this.setView(Object.assign(o,e)),e.maxZoomOnExtent&&(this.viewController.maxZoomOnExtent=e.maxZoomOnExtent)}setView(e){void 0!==this.viewController&&this.viewController.clearStateHistory(),e=Object.assign({constrainResolution:!0},e);const t=new Zn.ZP(e);if(this.ol.setView(t),this.unsubscribeGeolocate(),e){if(e.maxLayerZoomExtent&&(this.viewController.maxLayerZoomExtent=e.maxLayerZoomExtent),e.center){const o=t.getProjection().getCode(),i=kn.mi(e.center,o);t.setCenter(i)}e.geolocate&&this.geolocate(!0),e.alwaysTracking&&(this.alwaysTracking=!0)}}updateControls(e){if(void 0===e)return;const t=[];e.attribution&&t.push(new Mn.Z(!0===e.attribution?{}:e.attribution)),e.scaleLine&&t.push(new In.Z(!0===e.scaleLine?{}:e.scaleLine)),Object.assign([],this.ol.getControls().getArray()).forEach(e=>{this.ol.removeControl(e)}),t.forEach(e=>{this.ol.addControl(e)})}getCenter(e){return this.viewController.getCenter(e)}getExtent(e){return this.viewController.getExtent(e)}getZoom(){return this.viewController.getZoom()}changeBaseLayer(e){if(e){for(const e of this.getBaseLayers())e.visible=!1;e.visible=!0,this.viewController.olView.setMinZoom(e.dataSource.options.minZoom||(this.options.view||{}).minZoom),this.viewController.olView.setMaxZoom(e.dataSource.options.maxZoom||(this.options.view||{}).maxZoom)}}getBaseLayers(){return this.layers.filter(e=>!0===e.baseLayer)}getLayerById(e){return this.layers.find(t=>t.id&&t.id===e)}getLayerByAlias(e){return this.layers.find(t=>t.alias&&t.alias===e)}getLayerByOlUId(e){return this.layers.find(t=>t.ol.get("ol_uid")&&t.ol.get("ol_uid")===e)}addLayer(e,t=!0){this.addLayers([e])}addLayers(e,t=!0){let o=0,i=0;const r=e.map(e=>{if(!e)return;const t=e.zIndex?0:e.baseLayer?i++:o++;return this.doAddLayer(e,t)}).filter(e=>void 0!==e);this.setLayers([].concat(this.layers,r))}removeLayer(e){this.removeLayers([e])}removeLayers(e){const t=this.layers$.value.slice(0),o=[];e.forEach(e=>{const i=t.indexOf(e);i>=0&&(o.push(e),t.splice(i,1),this.handleLinkedLayersDeletion(e,o),o.map(e=>{o.push(e);const i=t.indexOf(e);i>=0&&t.splice(i,1)}))}),o.forEach(e=>this.doRemoveLayer(e)),this.setLayers(t)}handleLinkedLayersDeletion(e,t){const o=e.options.linkedLayers;if(!o)return;const i=o.linkId,r=o.links;r?r.map(e=>{!e.syncedDelete||e.linkedIds.map(e=>{const o=this.layers.find(t=>{var o;return(null===(o=t.options.linkedLayers)||void 0===o?void 0:o.linkId)===e});o&&t.push(o)})}):this.layers.map(e=>{var o;(null===(o=e.options.linkedLayers)||void 0===o?void 0:o.links)&&e.options.linkedLayers.links.map(o=>{o.syncedDelete&&!1!==o.bidirectionnal&&-1!==o.linkedIds.indexOf(i)&&(t.push(e),this.handleLinkedLayersDeletion(e,t))})})}removeAllLayers(){this.layers.forEach(e=>this.doRemoveLayer(e)),this.layers$.next([])}raiseLayer(e){const t=this.getLayerIndex(e);t>1&&this.moveLayer(e,t,t-1)}raiseLayers(e){for(const t of e)this.raiseLayer(t)}lowerLayer(e){const t=this.getLayerIndex(e);t<this.layers.length-1&&this.moveLayer(e,t,t+1)}lowerLayers(e){const t=e.reverse();for(const o of t)this.lowerLayer(o)}moveLayer(e,t,o){const i=this.layers[o],r=e.zIndex;i.baseLayer||e.baseLayer||(e.zIndex=i.zIndex,i.zIndex=r,this.layers[o]=e,this.layers[t]=i,this.layers$.next(this.layers.slice(0)))}doAddLayer(e,t){e.baseLayer&&e.visible&&this.changeBaseLayer(e);const o=this.getLayerById(e.id);if(void 0===o){if(!e.baseLayer&&e.zIndex&&(e.zIndex+=10),void 0===e.zIndex||0===e.zIndex){const o=Math.max(e.baseLayer?0:10,...this.layers.filter(t=>t.baseLayer===e.baseLayer&&t.zIndex<200).map(e=>e.zIndex));e.zIndex=o+1+t}return e.baseLayer&&e.zIndex>9&&(e.zIndex=10),e.setMap(this),this.layerWatcher.watchLayer(e),this.ol.addLayer(e.ol),e}o.visible=!0}doRemoveLayer(e){this.layerWatcher.unwatchLayer(e),this.ol.removeLayer(e.ol),e.setMap(void 0)}setLayers(e){this.layers$.next(this.sortLayersByZIndex(e).slice(0))}sortLayersByZIndex(e){return e.sort((e,t)=>t.zIndex-e.zIndex)}getLayerIndex(e){return this.layers.findIndex(t=>t===e)}geolocate(e=!1){let t=!0;this.geolocation$$&&(e=this.geolocation.getTracking(),this.unsubscribeGeolocate()),this.startGeolocation(),this.geolocation$$=this.geolocation$.subscribe(o=>{var i;if(!o)return;const r=o.getAccuracy(),s=o.getPosition();if(r<1e4){const e=s?new _n.Z(s):null,r=o.getAccuracyGeometry(),n=r.getExtent();if([this.geolocationPositionFeature,this.geolocationAccuracyFeature].map(e=>{e&&this.overlay.dataSource.ol.getFeatureById(e.getId())&&this.overlay.dataSource.ol.removeFeature(e)}),this.bufferFeature&&this.buffer.dataSource.ol.removeFeature(this.bufferFeature),this.geolocationPositionFeature=new Fn.Z({geometry:e}),this.geolocationPositionFeature.setId("geolocationPositionFeature"),this.geolocationPositionFeature.setStyle(new Un.ZP({image:new Qn.Z({radius:6,fill:new Jn.Z({color:"#3399CC"}),stroke:new jn.Z({color:"#fff",width:2})})})),this.geolocationAccuracyFeature=new Fn.Z({geometry:r}),this.geolocationAccuracyFeature.setId("geolocationAccuracyFeature"),[this.geolocationPositionFeature,this.geolocationAccuracyFeature].map(this.alwaysTracking?e=>{this.overlay.addOlFeature(e,this.positionFollower?Fl.Move:Fl.None)}:e=>{this.overlay.addOlFeature(e)}),null===(i=this.ol.getView().get("options_"))||void 0===i?void 0:i.buffer){const e=this.ol.getView().get("options_").buffer.bufferRadius;this.bufferGeom=new En.Z(s,e);const t=this.ol.getView().get("options_").buffer.bufferStroke,o=this.ol.getView().get("options_").buffer.bufferFill;let i;i=this.ol.getView().get("options_").buffer.showBufferRadius?e.toString()+"m":"",this.bufferFeature=new Fn.Z(this.bufferGeom),this.bufferFeature.setId("bufferFeature"),this.bufferFeature.set("bufferStroke",t),this.bufferFeature.set("bufferFill",o),this.bufferFeature.set("bufferText",i),this.buffer.addOlFeature(this.bufferFeature,Fl.None)}t&&(this.viewController.zoomToExtent(n),this.positionFollower=!this.positionFollower)}else if(t){const e=this.ol.getView();e.setCenter(s),e.setZoom(14)}!0!==e&&!0!==this.alwaysTracking&&this.unsubscribeGeolocate(),t=!1})}unsubscribeGeolocate(){this.stopGeolocation(),this.geolocation$$&&(this.geolocation$$.unsubscribe(),this.geolocation$$=void 0)}startGeolocation(){this.geolocation?this.geolocation.setTracking(!0):(this.geolocation=new On.Z({trackingOptions:{enableHighAccuracy:!0},projection:this.projection,tracking:!0}),this.geolocation.on("change",e=>{this.geolocation$.next(this.geolocation)}))}stopGeolocation(){this.geolocation&&this.geolocation.setTracking(!1)}onOfflineToggle(e){this.offlineButtonToggle$.next(e)}}const au=["*"];let lu=(()=>{class e{constructor(e){this.activityService=e,this.id=`igo-map-target-${(new Date).getTime()}`}get view(){return this._view}set view(e){this._view=e,void 0!==this.map&&this.map.updateView(e)}get controls(){return this._controls}set controls(e){this._controls=e,void 0!==this.map&&this.map.updateControls(e)}ngOnInit(){this.status$$=this.map.status$.subscribe(e=>this.handleStatusChange(e))}ngAfterViewInit(){this.map.setTarget(this.id)}ngOnDestroy(){this.map.setTarget(void 0),this.activityService.unregister(this.activityId),this.status$$.unsubscribe()}handleStatusChange(e){e===J.Working&&void 0===this.activityId?this.activityId=this.activityService.register():e===J.Done&&void 0!==this.activityId&&(this.activityService.unregister(this.activityId),this.activityId=void 0)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Y))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-map-browser"]],inputs:{map:"map",view:"view"},ngContentSelectors:au,decls:2,vars:1,consts:[[1,"igo-map-browser-target",3,"id"]],template:function(e,t){1&e&&(r.F$t(),r._UZ(0,"div",0),r.Hsn(1)),2&e&&r.Q6J("id",t.id)},styles:["[_nghost-%COMP%]{position:relative;display:block}[_nghost-%COMP%], .igo-map-browser-target[_ngcontent-%COMP%]{width:100%;height:100%}[_nghost-%COMP%]     igo-zoom-button{position:absolute;bottom:5px;right:5px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){[_nghost-%COMP%]     igo-zoom-button{display:none}}[_nghost-%COMP%]     igo-offline-button{position:absolute;bottom:15px;right:5px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){[_nghost-%COMP%]     igo-offline-button{bottom:5px}}[_nghost-%COMP%]     igo-geolocate-button{position:absolute;bottom:5px;right:5px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){[_nghost-%COMP%]     igo-geolocate-button{bottom:5px}}[_nghost-%COMP%]     igo-rotation-button{position:absolute;top:calc(40px + 5px + 5px);right:5px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){[_nghost-%COMP%]     igo-rotation-button{top:calc(40px + 5px + 5px)}}[_nghost-%COMP%]     igo-user-button{position:absolute;bottom:5px;right:calc(5px + 50px)}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){[_nghost-%COMP%]     igo-user-button{right:calc(5px + 90px)}}[_nghost-%COMP%]     igo-baselayers-switcher{position:absolute;bottom:5px;left:5px}[_nghost-%COMP%]     .ol-attribution{flex-flow:row;left:calc(40px + 5px + 5px);bottom:5px;text-align:left;padding:0;margin-right:90px;background-color:#fff0;width:calc(100% - 100px)}[_nghost-%COMP%]     .ol-attribution.ol-logo-only{height:inherit}[_nghost-%COMP%]     .ol-attribution.ol-collapsed{background:none}[_nghost-%COMP%]     .ol-attribution.ol-collapsed button{transform:none}[_nghost-%COMP%]     .ol-attribution button{transform:rotate(180deg);background-color:#fff;cursor:pointer;outline:none}[_nghost-%COMP%]     .ol-scale-line-inner{color:#000;border-color:#000;text-shadow:white -1px -1px 3px,white 1px -1px 3px,white -1px 1px 3px,white 1px 1px 4px;box-shadow:0 1px 0 1px #fff9}[_nghost-%COMP%]     .ol-scale-line{background-color:#fff0;bottom:4px;transform:translate(-50%);left:50%}[_nghost-%COMP%]     .ol-scale-bar{background-color:#fff0;bottom:4px;transform:translate(-50%);left:50%}[_nghost-%COMP%]     .ol-scale-text{text-shadow:white -1px -1px 3px,white 1px -1px 3px,white -1px 1px 3px,white 1px 1px 4px}[_nghost-%COMP%]     .ol-scale-step-text{text-shadow:white -1px -1px 3px,white 1px -1px 3px,white -1px 1px 3px,white 1px 1px 4px}[_nghost-%COMP%]     canvas{display:block}"]}),e})(),cu=(()=>{class e{constructor(e,t){this.component=e,this.mediaService=t,this.pointerPositionDelay=1e3,this.pointerPositionCoord=new r.vpe}get map(){return this.component.map}get mapProjection(){return this.component.map.projection}ngOnInit(){this.listenToMapPointerMove(),this.listenToMapClick()}ngOnDestroy(){this.unlistenToMapPointerMove(),this.unlistenToMapClick()}listenToMapPointerMove(){this.pointerMoveListener=this.map.ol.on("pointermove",e=>this.onPointerEvent(e,this.pointerPositionDelay))}listenToMapClick(){this.mapClickListener=this.map.ol.on("singleclick",e=>this.onPointerEvent(e,0))}unlistenToMapPointerMove(){(0,ea.B)(this.pointerMoveListener),this.pointerMoveListener=void 0}unlistenToMapClick(){this.mapClickListener=void 0}onPointerEvent(e,t){if(e.dragging||this.mediaService.isTouchScreen())return;void 0!==this.lastTimeoutRequest&&clearTimeout(this.lastTimeoutRequest);const o=(0,kn.vs)(e.coordinate,this.mapProjection,"EPSG:4326");this.lastTimeoutRequest=setTimeout(()=>{this.pointerPositionCoord.emit(o)},t)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(lu,2),r.Y36(be))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoPointerPosition",""]],inputs:{pointerPositionDelay:"pointerPositionDelay"},outputs:{pointerPositionCoord:"pointerPositionCoord"}}),e})();class uu extends mc{constructor(e,t,o,i){super(e,t,i),this.messageService=t,this.languageService=o,this.authInterceptor=i,this.watcher=new Ol(this,this.messageService,this.languageService),this.status$=this.watcher.status$,this.status$.subscribe(e=>{0===e&&(this.olLoadingProblem=!0)})}createOlLayer(){const e=Object.assign({},this.options,{source:this.options.source.ol}),t=new ja.Z(e);return this.authInterceptor&&t.getSource().setImageLoadFunction((e,t)=>{this.customLoader(e,t,this.authInterceptor,this.messageService,this.languageService)}),t}setMap(e){void 0===e?this.watcher.unsubscribe():this.watcher.subscribe(()=>{}),super.setMap(e)}customLoader(e,t,o,i,r){const s=new XMLHttpRequest;if(s.open("GET",t),!o.interceptXhr(s,t))return s.abort(),void(e.getImage().src=t);s.responseType="arraybuffer",s.onload=function(){const t=new Uint8Array(this.response);(new TextDecoder).decode(t).includes("ServiceExceptionReport")&&i.error(r.translate.instant("igo.geo.dataSource.optionsApiUnavailable"),r.translate.instant("igo.geo.dataSource.unavailableTitle"));const o=new Blob([t],{type:"image/png"}),s=window.URL.createObjectURL(o);e.getImage().src=s},s.send()}}class pu extends mc{constructor(e,t){super(e,t),this.messageService=t,this.watcher=new sc(this),this.status$=this.watcher.status$}createOlLayer(){const e=Object.assign({},this.options,{source:this.options.source.ol});return new Qa.Z(e)}setMap(e){void 0===e?this.watcher.unsubscribe():this.watcher.subscribe(()=>{}),super.setMap(e)}}class du extends mc{constructor(e,t,o){super(e,t,o),this.messageService=t,this.authInterceptor=o,this.watcher=new sc(this),this.status$=this.watcher.status$}createOlLayer(){const e=Object.assign({},this.options,{source:this.options.source.ol}),t=new Ba.Z(e);return t.getSource().setTileLoadFunction((e,t)=>{const o=this.customLoader(t,e.getFormat(),this.authInterceptor,e.onLoad.bind(e));o&&e.setLoader(o)}),t}customLoader(e,t,o,i,r){return(s,n,a)=>{const l=new XMLHttpRequest;l.open("GET","function"==typeof e?e=e(s,n,a):e),o&&o.interceptXhr(l,e),"arraybuffer"===t.getType()&&(l.responseType="arraybuffer"),l.onload=e=>{if(!l.status||l.status>=200&&l.status<300){const e=t.getType();let o;"json"===e||"text"===e?o=l.responseText:"xml"===e?(o=l.responseXML,o||(o=(new DOMParser).parseFromString(l.responseText,"application/xml"))):"arraybuffer"===e&&(o=l.response),o?i.call(this,t.readFeatures(o,{extent:s,featureProjection:a}),t.readProjection(o)):r.call(this)}else r.call(this)},l.onerror=()=>{r.call(this)},l.send()}}setMap(e){void 0===e?this.watcher.unsubscribe():this.watcher.subscribe(()=>{}),super.setMap(e)}}let hu=(()=>{class e{constructor(e,t,o){this.component=e,this.mediaService=t,this.styleService=o,this.pointerHoverFeatureStore=new dt([]),this.hoverFeatureId="hoverFeatureId",this.igoHoverFeatureDelay=1e3,this.igoHoverFeatureEnabled=!1}mouseout(){clearTimeout(this.lastTimeoutRequest),this.clearLayer()}get map(){return this.component.map}get mapProjection(){return this.component.map.projection}ngOnInit(){this.listenToMapPointerMove(),this.subscribeToPointerStore(),this.listenToMapClick(),this.map.status$.pipe((0,qe.q)(1)).subscribe(()=>{this.store=new jc([],{map:this.map}),this.initStore()}),this.layers$$=this.map.layers$.subscribe(e=>{this.store&&!e.find(e=>"hoverFeatureId"===e.id)&&this.initStore()})}initStore(e){Bc(this.store,new fc({id:"hoverFeatureId",title:"hoverFeature",zIndex:900,source:new nc,showInLayerList:!1,exportable:!1,browsable:!1,style:gu}))}ngOnDestroy(){this.unlistenToMapPointerMove(),this.unsubscribeToPointerStore(),this.unlistenToMapSingleClick(),this.layers$$.unsubscribe()}subscribeToPointerStore(){this.store$$=this.pointerHoverFeatureStore.entities$.subscribe(e=>{this.entitiesToPointerOverlay(e)})}entitiesToPointerOverlay(e){this.addFeatureOverlay(e)}listenToMapPointerMove(){this.pointerMoveListener=this.map.ol.on("pointermove",e=>this.onMapEvent(e))}listenToMapClick(){this.singleClickMapListener=this.map.ol.on("singleclick",e=>this.onMapSingleClickEvent(e))}unsubscribeToPointerStore(){this.store$$.unsubscribe()}unlistenToMapPointerMove(){(0,ea.B)(this.pointerMoveListener),this.pointerMoveListener=void 0}unlistenToMapSingleClick(){(0,ea.B)(this.singleClickMapListener),this.singleClickMapListener=void 0}onMapSingleClickEvent(e){this.clearLayer()}onMapEvent(e){if(e.dragging||!this.igoHoverFeatureEnabled||this.mediaService.isTouchScreen())return void this.clearLayer();void 0!==this.lastTimeoutRequest&&clearTimeout(this.lastTimeoutRequest);const t=this.map.ol.getPixelFromCoordinate(e.coordinate);this.lastTimeoutRequest=setTimeout(()=>{this.map.ol.forEachFeatureAtPixel(t,(function(e,t){if(void 0===e.get("hoverSummary")){const o=this.map.getLayerByOlUId(t.ol_uid);this.setLayerStyleFromOptions(o,e),this.pointerHoverFeatureStore.load([{layer:o,feature:e}])}return!0}).bind(this))},this.igoHoverFeatureDelay)}addFeatureOverlay(e){if(e.length>0){e=e[0],this.clearLayer();let t=this.getGeometry(e.feature);e.layer.ol instanceof Ba.Z&&(t=[t],this.getSameFeatureNeighbour(e.feature,e.layer).forEach(e=>{t.push(e.getGeometry())}));const o=new Fn.Z({geometry:t instanceof Array?new Ua.Z(t):t,meta:{id:this.hoverFeatureId},hoverSummary:this.getHoverSummary(e.feature.getProperties())});this.store.setLayerOlFeatures([o],Fl.None)}}setLayerStyleFromOptions(e,t){var o,i;(null===(i=null===(o=e.options)||void 0===o?void 0:o.styleByAttribute)||void 0===i?void 0:i.hoverStyle)?this.store.layer.ol.setStyle(this.styleService.createStyleByAttribute(t,e.options.styleByAttribute.hoverStyle)):this.store.layer.ol.setStyle(gu)}getHoverSummary(e){let t="";for(const[o,i]of Object.entries(e))t+=`${o}: ${i}\n`;return t}getGeometry(e){let t;if(e.getOrientedFlatCoordinates){const o=e.getOrientedFlatCoordinates(),i=[];switch(o.forEach((e,t)=>{t%2==0&&i.push([parseFloat(o[t]),parseFloat(o[t+1])])}),e.getType()){case"Point":t=new _n.Z(i);break;case"Polygon":t=new Vn.ZP([i]);break;case"LineString":t=new Wn.Z([i])}}else t=e.getGeometry();return t}getSameFeatureNeighbour(e,t,o=[]){0===o.length&&o.push(new Fn.Z({geometry:this.getGeometry(e),meta:{id:this.hoverFeatureId}}));const i=[];return t.ol.getSource().getFeaturesInExtent(e.getGeometry().getExtent()).forEach(t=>{const r=o.find(e=>e===t);t.getId()===e.getId()&&!r&&(i.push(t),o.push(t))}),o.map(e=>new Fn.Z({geometry:this.getGeometry(e),meta:{id:this.hoverFeatureId}}))}clearLayer(){this.store&&this.store.clearLayer()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(lu,2),r.Y36(be),r.Y36(eu))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoHoverFeature",""]],hostBindings:function(e,t){1&e&&r.NdJ("mouseout",function(){return t.mouseout()})},inputs:{igoHoverFeatureDelay:"igoHoverFeatureDelay",igoHoverFeatureEnabled:"igoHoverFeatureEnabled"}}),e})();function gu(e,t){const o=[new Un.ZP({text:new Nn.Z({text:e.get("hoverSummary"),textAlign:"left",textBaseline:"bottom",font:"12px Calibri,sans-serif",fill:new Jn.Z({color:"#000"}),backgroundFill:new Jn.Z({color:"rgba(255, 255, 255, 0.5)"}),backgroundStroke:new jn.Z({color:"rgba(200, 200, 200, 0.75)",width:2}),stroke:new jn.Z({color:"#fff",width:3}),overflow:!0,offsetX:10,offsetY:-10,padding:[2.5,2.5,2.5,2.5]})})];switch(e.getGeometry().getType()){case"Point":o.push(new Un.ZP({image:new Qn.Z({radius:10,stroke:new jn.Z({color:"blue",width:3})})}));break;default:o.push(new Un.ZP({stroke:new jn.Z({color:"white",width:5})})),o.push(new Un.ZP({stroke:new jn.Z({color:"blue",width:3})}))}return o}const mu=function(e){return{zoom:e}};let fu=(()=>{class e{constructor(){}get zoom(){return this.map.viewController.getZoom()}get minZoom(){return this.map.viewController.olView.getMinZoom()||1}get maxZoom(){return this.map.viewController.olView.getMaxZoom()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-zoom-button"]],inputs:{map:"map",color:"color"},decls:7,vars:16,consts:[[1,"igo-zoom-button-container"],["mat-icon-button","","matTooltipPosition","left",3,"matTooltip","color","disabled","click"],["svgIcon","plus"],["svgIcon","minus"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"button",1),r.NdJ("click",function(){return t.map.viewController.zoomIn()}),r.ALo(2,"translate"),r._UZ(3,"mat-icon",2),r.qZA(),r.TgZ(4,"button",1),r.NdJ("click",function(){return t.map.viewController.zoomOut()}),r.ALo(5,"translate"),r._UZ(6,"mat-icon",3),r.qZA(),r.qZA()),2&e&&(r.xp6(1),r.Q6J("matTooltip",r.xi3(2,6,"igo.geo.mapButtons.zoomIn",r.VKq(12,mu,t.zoom+1)))("color",t.color)("disabled",t.zoom>=t.maxZoom),r.xp6(3),r.Q6J("matTooltip",r.xi3(5,9,"igo.geo.mapButtons.zoomOut",r.VKq(14,mu,t.zoom-1)))("color",t.color)("disabled",t.zoom<=t.minZoom))},directives:[n.lW,p.gM,a.Hw],pipes:[j.X$],styles:[".igo-zoom-button-container[_ngcontent-%COMP%]{width:40px}.igo-zoom-button-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#fff}.igo-zoom-button-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#efefef}.igo-zoom-button-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child{margin-bottom:2px}button[_ngcontent-%COMP%], [_nghost-%COMP%]     button .mat-button-ripple-round{border-radius:0}"]}),e})(),yu=(()=>{class e{constructor(){}get map(){return this._map}set map(e){this._map=e}get color(){return this._color}set color(e){this._color=e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-geolocate-button"]],inputs:{map:"map",color:"color"},decls:4,vars:4,consts:[[1,"igo-geolocate-button-container"],["mat-icon-button","","matTooltipPosition","left",3,"matTooltip","color","click"],["svgIcon","crosshairs-gps"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"button",1),r.NdJ("click",function(){return t.map.geolocate()}),r.ALo(2,"translate"),r._UZ(3,"mat-icon",2),r.qZA(),r.qZA()),2&e&&(r.xp6(1),r.Q6J("matTooltip",r.lcZ(2,2,"igo.geo.mapButtons.geolocate"))("color",t.color))},directives:[n.lW,p.gM,a.Hw],pipes:[j.X$],styles:[".igo-geolocate-button-container[_ngcontent-%COMP%]{width:40px;background-color:#fff}.igo-geolocate-button-container[_ngcontent-%COMP%]:hover{background-color:#efefef}button[_ngcontent-%COMP%], [_nghost-%COMP%]     button .mat-button-ripple-round{border-radius:0}"]}),e})();function vu(e,t){1&e&&(r.TgZ(0,"div",6),r.TgZ(1,"button",7),r.ALo(2,"translate"),r._UZ(3,"mat-icon",8),r.qZA(),r.qZA()),2&e&&(r.xp6(1),r.Q6J("matTooltip",r.lcZ(2,1,"igo.geo.mapButtons.baselayerSwitcher")))}function bu(e,t){if(1&e&&(r._UZ(0,"igo-mini-basemap",9),r.ALo(1,"translate")),2&e){const e=t.$implicit,o=t.index,i=r.oxw(2);r.Q6J("map",i.map)("baseLayer",e)("title",i.baseLayers.length>2&&!i.expand?r.lcZ(1,5,"igo.geo.baselayersSwitcher.title"):e.title)("display",i.expand||0===o&&!i.useStaticIcon)("disabled",!i.expand&&i.baseLayers.length>1)}}const xu=function(e){return{"container-expand":e}};function wu(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",1),r.NdJ("@baseLayerSwitcherState.start",function(){return r.CHM(e),r.oxw().showButton=!1})("@baseLayerSwitcherState.done",function(){return r.CHM(e),r.oxw().showButton=!0})("click",function(){return r.CHM(e),r.oxw().collapseOrExpand()}),r.YNc(1,vu,4,3,"div",2),r.YNc(2,bu,2,7,"igo-mini-basemap",3),r.TgZ(3,"div",4),r._UZ(4,"mat-icon",5),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("ngClass",r.VKq(4,xu,e.expand))("@baseLayerSwitcherState",e.expand?"expand":e.useStaticIcon?"collapseIcon":"collapseMap"),r.xp6(1),r.Q6J("ngIf",e.useStaticIcon&&!e.expand&&e.showButton),r.xp6(1),r.Q6J("ngForOf",e.baseLayers)}}let Su=(()=>{class e{constructor(e){this.mediaService=e,this._baseLayers=[],this.expand=!1,this.showButton=!0,this.mediaService.media$.value===ye.Mobile&&void 0===this.useStaticIcon&&(this.useStaticIcon=!0)}ngAfterViewInit(){this.layers$$=this.map.layers$.subscribe(e=>{this._baseLayers=e.filter(e=>e.baseLayer)})}ngOnDestroy(){this.layers$$.unsubscribe()}collapseOrExpand(){this.expand=!!(this.baseLayers.length>1||this.useStaticIcon)&&!this.expand}get baseLayers(){const e=this.map.viewController.getResolution(),t=this.map.viewController.getZoom(),o=this._baseLayers.filter(o=>(!o.options.maxResolution||e<=o.options.maxResolution)&&(!o.options.minResolution||e>=o.options.minResolution)&&(!o.options.source.options.maxZoom||t<=o.options.source.options.maxZoom)&&(!o.options.source.options.minZoom||t>=o.options.source.options.minZoom)),i=o.filter(e=>!e.visible);return i.length+1===o.length?i:o}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(be))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-baselayers-switcher"]],inputs:{map:"map",useStaticIcon:"useStaticIcon"},decls:1,vars:1,consts:[["class","igo-baselayers-switcher-container",3,"ngClass","click",4,"ngIf"],[1,"igo-baselayers-switcher-container",3,"ngClass","click"],["class","igo-baselayers-switcher-button-container",4,"ngIf"],["class","mat-typography",3,"map","baseLayer","title","display","disabled",4,"ngFor","ngForOf"],[1,"more-baselayers"],["color","primary","svgIcon","menu-down",1,"material-icons","mat-icon","mat-list-avatar"],[1,"igo-baselayers-switcher-button-container"],["mat-icon-button","","matTooltipPosition","right","color","primary",3,"matTooltip"],["svgIcon","image-multiple"],[1,"mat-typography",3,"map","baseLayer","title","display","disabled"]],template:function(e,t){1&e&&r.YNc(0,wu,5,6,"div",0),2&e&&r.Q6J("ngIf",t.baseLayers.length>0)},styles:[".igo-baselayers-switcher-container[_ngcontent-%COMP%]{height:auto;position:relative}.container-expand[_ngcontent-%COMP%]{overflow:hidden;border-width:0}.more-baselayers[_ngcontent-%COMP%]{width:80px;height:20px;background-color:#fff;text-align:center;cursor:pointer}.more-baselayers[_ngcontent-%COMP%]:hover{background-color:#efefef}.igo-baselayers-switcher-button-container[_ngcontent-%COMP%]{width:40px;background-color:#fff}.igo-baselayers-switcher-button-container[_ngcontent-%COMP%]:hover{background-color:#efefef}button[_ngcontent-%COMP%], [_nghost-%COMP%]     button .mat-button-ripple-round{border-radius:0}"],data:{animation:[(0,ot.X$)("baseLayerSwitcherState",[(0,ot.SB)("collapseIcon",(0,ot.oB)({height:"40px",width:"40px",overflow:"hidden"})),(0,ot.SB)("collapseMap",(0,ot.oB)({height:"85px",overflow:"hidden"})),(0,ot.SB)("expand",(0,ot.oB)({overflow:"hidden"})),(0,ot.eR)("collapse => expand",(0,ot.jt)("200ms")),(0,ot.eR)("expand => collapse",(0,ot.jt)("200ms"))])]}}),e})(),Cu=(()=>{class e{constructor(e,t,o,i,r,s){this.http=e,this.styleService=t,this.dataSourceService=o,this.messageService=i,this.languageService=r,this.authInterceptor=s}createLayer(e){if(!e.source)return;let t;switch(e.source.options&&e.source.options._layerOptionsFromSource&&(e=D.mergeDeep(e.source.options._layerOptionsFromSource,e||{})),e.source.constructor){case yc:case Sc:case vc:case Zc:case Cc:case Lc:t=this.createTileLayer(e);break;case nc:case bc:case Tc:case Fc:case ac:t=this.createVectorLayer(e);break;case Ac:case ic:t=this.createImageLayer(e);break;case Oc:t=this.createVectorTileLayer(e)}return t}createAsyncLayer(e,t){return e.source?new Le.y(t=>t.next(this.createLayer(e))):this.dataSourceService.createAsyncDataSource(e.sourceOptions,t).pipe((0,x.U)(t=>{if(void 0!==t)return this.createLayer(Object.assign(e,{source:t}))}))}createImageLayer(e){return new uu(e,this.messageService,this.languageService,this.authInterceptor)}createTileLayer(e){return new pu(e,this.messageService)}createVectorLayer(e){let t,o;if(void 0!==e.style&&(t=this.styleService.createStyle(e.style)),e.source instanceof Tc)t=e.source.options.params.style;else if(e.styleByAttribute){const t=this.styleService;e.style=o=>t.createStyleByAttribute(o,e.styleByAttribute),o=new fc(e,this.messageService,this.authInterceptor)}if(e.source instanceof ac){const t=this.styleService,i=e.clusterBaseStyle;e.style=o=>t.createClusterStyle(o,e.clusterParam,i),o=new fc(e,this.messageService,this.authInterceptor)}const i=Object.assign({},e,{style:t});return o||(o=new fc(i,this.messageService,this.authInterceptor)),this.applyMapboxStyle(o,i),o}createVectorTileLayer(e){let t,o;if(void 0!==e.style&&(t=this.styleService.createStyle(e.style)),e.styleByAttribute){const t=this.styleService;e.style=o=>t.createStyleByAttribute(o,e.styleByAttribute),o=new du(e,this.messageService,this.authInterceptor)}const i=Object.assign({},e,{style:t});return o||(o=new du(i,this.messageService,this.authInterceptor)),this.applyMapboxStyle(o,i),o}applyMapboxStyle(e,t){t.mapboxStyle&&this.getMapboxGlStyle(t.mapboxStyle.url).subscribe(o=>{(0,Ga.ZP)(e.ol,o,t.mapboxStyle.source)})}getMapboxGlStyle(e){return this.http.get(e).pipe((0,x.U)(e=>e),(0,b.K)(e=>(console.log("No style was found"),(0,A.of)(e))))}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(eu),r.LFG(Ec),r.LFG(de),r.LFG(ue),r.LFG(ln,8))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Tu(e,t){if(1&e&&(r.TgZ(0,"div",5),r._uU(1),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.hij(" ",e.title," ")}}function Au(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",2),r.NdJ("click",function(){r.CHM(e);const t=r.oxw();return t.changeBaseLayer(t.baseLayer)}),r._UZ(1,"igo-map-browser",3),r.YNc(2,Tu,2,1,"div",4),r.qZA()}if(2&e){const e=r.oxw();r.xp6(1),r.Q6J("map",e.basemap),r.xp6(1),r.Q6J("ngIf",e.title)}}let Lu=(()=>{class e{constructor(e,t){this.layerService=e,this.appRef=t,this.basemap=new nu({controls:{},interactions:!1})}get baseLayer(){return this._baseLayer}set baseLayer(e){this._baseLayer=e,this.handleBaseLayerChanged(e)}ngAfterViewInit(){this.handleMainMapViewChange(this.map.ol.getView()),this.map.viewController.olView.on("change",e=>{this.handleMainMapViewChange(e.target)}),this.map.ol.on("pointerdrag",e=>{this.handleMainMapViewChange(e.target.getView())})}ngOnDestroy(){this.map.viewController.olView.un("change",e=>{this.handleMainMapViewChange(e.target)}),this.map.ol.un("pointerdrag",e=>{this.handleMainMapViewChange(e.target.getView())})}changeBaseLayer(e){this.disabled||(this.map.changeBaseLayer(e),this.appRef.tick())}handleMainMapViewChange(e){const t=e.getProperties();this.basemap.viewController.olView.setResolution(t.resolution),this.basemap.viewController.olView.setRotation(t.rotation),this.basemap.viewController.olView.setCenter(this.map.viewController.getCenter())}handleBaseLayerChanged(e){this.basemap.removeAllLayers();const t=Object.assign(Object.create(e.options),e.options,{visible:!0,baseLayer:!1}),o=this.layerService.createLayer(t);this.basemap.addLayer(o),this.handleLinkedBaseLayer(o)}handleLinkedBaseLayer(e){const t=e.options.linkedLayers;if(!t)return;const o=t.links;o&&t.linkId===e.options.linkedLayers.linkId&&o.map(e=>{e.linkedIds.map(e=>{const t=this.map.layers.find(t=>{var o;return(null===(o=t.options.linkedLayers)||void 0===o?void 0:o.linkId)===e});if(t){const e=Object.assign(Object.create(t.options),t.options,{zIndex:9e3,visible:!0,baseLayer:!1});this.basemap.addLayer(this.layerService.createLayer(e))}})})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Cu),r.Y36(r.z2F))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-mini-basemap"]],inputs:{map:"map",disabled:"disabled",display:"display",title:"title",baseLayer:"baseLayer"},decls:2,vars:1,consts:[[1,"igo-mini-basemap-container"],[3,"click",4,"ngIf"],[3,"click"],[3,"map"],["class","igo-mini-basemap-title",4,"ngIf"],[1,"igo-mini-basemap-title"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.YNc(1,Au,3,2,"div",1),r.qZA()),2&e&&(r.xp6(1),r.Q6J("ngIf",t.display))},styles:[".igo-mini-basemap-container[_ngcontent-%COMP%]{width:calc(40px * 2);height:calc(40px * 2);background-color:#ffffff03;border:2px solid white;box-shadow:0 1px 4px #0000004d;cursor:pointer;margin-top:5px}.igo-mini-basemap-container[_ngcontent-%COMP%]:hover   .igo-mini-basemap-title[_ngcontent-%COMP%]{color:#000;text-shadow:0 0 5px white}.igo-mini-basemap-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%;height:100%}.igo-mini-basemap-title[_ngcontent-%COMP%]{position:relative;top:-76px;height:76px;width:76px;text-align:center;vertical-align:bottom;color:#fff;text-shadow:0 0 5px black;white-space:normal;display:flex;align-items:flex-end;justify-content:center}"]}),e})();function Zu(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",1),r.ALo(1,"translate"),r.ALo(2,"translate"),r.TgZ(3,"button",2),r.NdJ("click",function(){return r.CHM(e),r.oxw().map.viewController.resetRotation()}),r._UZ(4,"mat-icon",3),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("matTooltip",e.rotated?r.lcZ(1,4,"igo.geo.mapButtons.resetRotation"):r.lcZ(2,6,"igo.geo.mapButtons.tipRotation")),r.xp6(3),r.Q6J("color",e.color)("disabled",!e.rotated),r.xp6(1),r.Q6J("ngStyle",e.rotationStyle(e.map.viewController.getRotation()))}}function Fu(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",1),r.ALo(1,"translate"),r.ALo(2,"translate"),r.TgZ(3,"button",2),r.NdJ("click",function(){return r.CHM(e),r.oxw().map.viewController.resetRotation()}),r._UZ(4,"mat-icon",3),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("matTooltip",e.rotated?r.lcZ(1,4,"igo.geo.mapButtons.resetRotation"):r.lcZ(2,6,"igo.geo.mapButtons.tipRotation")),r.xp6(3),r.Q6J("color",e.color)("disabled",!e.rotated),r.xp6(1),r.Q6J("ngStyle",e.rotationStyle(e.map.viewController.getRotation()))}}let Ou=(()=>{class e{constructor(){}get map(){return this._map}set map(e){this._map=e}get showIfNoRotation(){return this._showIfNoRotation}set showIfNoRotation(e){this._showIfNoRotation=e}get color(){return this._color}set color(e){this._color=e}get rotated(){return 0!==this.map.viewController.getRotation()}rotationStyle(e){return{transform:"rotate("+e+"rad)"}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-rotation-button"]],inputs:{map:"map",showIfNoRotation:"showIfNoRotation",color:"color"},decls:2,vars:2,consts:[["class","igo-rotation-button-container","matTooltipPosition","left",3,"matTooltip",4,"ngIf"],["matTooltipPosition","left",1,"igo-rotation-button-container",3,"matTooltip"],["mat-icon-button","","matTooltipPosition","left",3,"color","disabled","click"],["svgIcon","navigation",3,"ngStyle"]],template:function(e,t){1&e&&(r.YNc(0,Zu,5,8,"div",0),r.YNc(1,Fu,5,8,"div",0)),2&e&&(r.Q6J("ngIf",t.rotated&&!t.showIfNoRotation),r.xp6(1),r.Q6J("ngIf",t.showIfNoRotation))},directives:[h.O5,p.gM,n.lW,a.Hw,h.PC],pipes:[j.X$],styles:[".igo-rotation-button-container[_ngcontent-%COMP%]{width:40px;background-color:#fff}.igo-rotation-button-container[_ngcontent-%COMP%]:hover{background-color:#efefef}button[_ngcontent-%COMP%], [_nghost-%COMP%]     button .mat-button-ripple-round{border-radius:0}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){button[_ngcontent-%COMP%]:disabled, [_nghost-%COMP%]     button .mat-button-ripple-round:disabled{display:none}}"]}),e})();var Mu=(()=>{return(e=Mu||(Mu={})).Layer="layer",e.Group="group",Mu;var e})(),Iu=(()=>{return(e=Iu||(Iu={}))[e.wms=0]="wms",e[e.wmts=1]="wmts",e[e.baselayers=2]="baselayers",e[e.arcgisrest=3]="arcgisrest",e[e.tilearcgisrest=4]="tilearcgisrest",e[e.imagearcgisrest=5]="imagearcgisrest",e[e.composite=6]="composite",Iu;var e})();class ku{constructor(e,t){Object.assign(this,e),this.catalogService=t}}class Pu extends ku{constructor(e,t){super(e,t),this.type=Iu[Iu[Iu.wms]]}collectCatalogItems(){return this.catalogService.loadCatalogWMSLayerItems(this)}}class _u extends ku{constructor(e,t){super(e,t),this.type=Iu[Iu[Iu.wmts]]}collectCatalogItems(){return this.catalogService.loadCatalogWMTSLayerItems(this)}}class $u extends ku{constructor(e,t){super(e,t),this.type=Iu[Iu[Iu.baselayers]]}collectCatalogItems(){return this.catalogService.loadCatalogBaseLayerItems(this)}}class qu extends ku{constructor(e,t){super(e,t),this.type=Iu[Iu[Iu.arcgisrest]]}collectCatalogItems(){return this.catalogService.loadCatalogArcGISRestItems(this)}}class Du extends ku{constructor(e,t,o){super(e,t),this.type=Iu[Iu[o]]}collectCatalogItems(){return this.catalogService.loadCatalogArcGISRestItems(this)}}class Eu extends ku{constructor(e,t){super(e,t),this.type=Iu[Iu[Iu.composite]],this.url=null}collectCatalogItems(){return this.catalogService.loadCatalogCompositeLayerItems(this)}}class Ru{static createInstanceCatalog(e,t){let o;return o=e.hasOwnProperty("composite")?new Eu(e,t):e.type===Iu[Iu.baselayers]?new $u(e,t):e.type===Iu[Iu.arcgisrest]?new qu(e,t):e.type===Iu[Iu.tilearcgisrest]?new Du(e,t,Iu.tilearcgisrest):e.type===Iu[Iu.imagearcgisrest]?new Du(e,t,Iu.imagearcgisrest):e.type===Iu[Iu.wmts]?new _u(e,t):new Pu(e,t),o}}let Uu=(()=>{class e{constructor(e){this.http=e,this.queryEnabled=!0}query(e,t){return e.filter(e=>e.visible&&e.isInResolutionsRange).map(e=>this.queryLayer(e,t))}queryLayer(e,t){const o=this.getQueryUrl(e.dataSource,t,!1,e.map.viewController.getExtent());if(!o)return(0,A.of)([]);if(e.dataSource.options.queryFormat===Gl.HTMLGML2){const i=this.getQueryUrl(e.dataSource,t,!0);return this.http.get(i,{responseType:"text"}).pipe((0,ke.zg)(i=>{const r=this.mergeGML(i,o);return this.http.get(o,{responseType:"text"}).pipe((0,x.U)(i=>this.extractData(i,e,t,o,r)))}))}return this.http.get(o,{responseType:"text"}).pipe((0,x.U)(i=>this.extractData(i,e,t,o)))}mergeGML(e,t){let o=(new xa.Z).readFeatures(e);0===o.length&&(o=(new fa.Z).readFeatures(e));const i=new Na.Z([]);let r;const s=[];let n,a=new Ja.Z([]);const l=o.length,c=this.getQueryParams(t.toLowerCase()).bbox.split(","),u=zn.lJ();let p;switch(zn.l7(u,c),o.map(e=>{const t=e.getGeometry().getCoordinates(),o=e.getGeometry().getType();switch(!n&&(n=o),o){case"Point":1===l?r=new _n.Z(t,"XY"):s.push(t);break;case"LineString":i.appendLineString(new Wn.Z(t,"XY"));break;case"Polygon":a.appendPolygon(new Vn.ZP(t,"XY"));break;case"MultiPolygon":a=new Ja.Z(t,"XY");break;default:return}}),p=0===s.length&&r?{type:r.getType(),coordinates:r.getCoordinates()}:{type:"Polygon",coordinates:[this.convexHull(s)]},n){case"LineString":return{type:i.getType(),coordinates:i.getCoordinates()};case"Point":return p;case"Polygon":case"MultiPolygon":return{type:a.getType(),coordinates:a.getCoordinates()};default:return}}cross(e,t,o){return(e[0]-o[0])*(t[1]-o[1])-(e[1]-o[1])*(t[0]-o[0])}convexHull(e){e.sort((e,t)=>e[0]===t[0]?e[1]-t[1]:e[0]-t[0]);const t=[];for(const i of e){for(;t.length>=2&&this.cross(t[t.length-2],t[t.length-1],i)<=0;)t.pop();t.push(i)}const o=[];for(let i=e.length-1;i>=0;i--){for(;o.length>=2&&this.cross(o[o.length-2],o[o.length-1],e[i])<=0;)o.pop();o.push(e[i])}return o.pop(),t.pop(),t.concat(o)}extractData(e,t,o,i,r){const s=t.dataSource,n=this.getAllowedFieldsAndAlias(t);let a=[];switch(s.options.queryFormat){case Gl.GML3:a=this.extractGML3Data(e,t.zIndex,n);break;case Gl.JSON:case Gl.GEOJSON:case Gl.GEOJSON2:a=this.extractGeoJSONData(e,t.zIndex,n);break;case Gl.ESRIJSON:a=this.extractEsriJSONData(e,t.zIndex,n);break;case Gl.TEXT:a=this.extractTextData(e);break;case Gl.HTML:a=this.extractHtmlData(e,s.queryHtmlTarget,i);break;case Gl.HTMLGML2:a=this.extractHtmlData(e,s.queryHtmlTarget,i,r);break;case Gl.GML2:default:a=this.extractGML2Data(e,t,n)}if(a.length>0&&null===a[0].geometry){const e=this.createGeometryFromUrlClick(i);for(const t of a)t.geometry=e}return a.map((e,i)=>{const r=e.properties[s.mapLabel];let n;if("wms"===t.options.sourceOptions.type){const e=t.options.sourceOptions;n=e?e.excludeAttribute:void 0}let l=this.getQueryTitle(e,t);!l&&a.length>1?l=`${t.title} (${i+1})`:l||(l=t.title);const c=Object.assign({},e.meta||{},{id:N(),title:l,mapTitle:r,sourceTitle:t.title,order:1e3-t.zIndex,excludeAttribute:n});return Object.assign(e,{meta:c,projection:"carto"===s.options.type?"EPSG:4326":o.projection})})}createGeometryFromUrlClick(e){const t=this.getQueryParams(e.toLowerCase()),o=t.bbox,i=parseInt(t.width,10),r=parseInt(t.height,10),s=parseInt(t.i||t.x,10),n=parseInt(t.j||t.y,10),a=o.split(",");let l=.05*(Math.abs(parseFloat(a[0]))-Math.abs(parseFloat(a[2])));Math.abs(parseFloat(a[0]))<180&&(l=.045);const c=parseFloat(a[0])+Math.abs(parseFloat(a[0])-parseFloat(a[2]))*s/i-l,u=parseFloat(a[1])+Math.abs(parseFloat(a[1])-parseFloat(a[3]))*n/r-l,p=c+2*l,d=u+2*l,h="POLYGON(("+c+" "+u+", "+c+" "+d+", "+p+" "+d+", "+p+" "+u+", "+c+" "+u+"))",g=(new la.Z).readFeature(h).getGeometry();return{type:g.getType(),coordinates:g.getCoordinates()}}extractGML2Data(e,t,o){let i=(new xa.Z).readFeatures(e);if(0===i.length){const t=new fa.Z;try{i=t.readFeatures(e)}catch(r){console.warn("query.service: Multipolygons are badly managed in mapserver in GML2. Use another format.")}}return i.map(e=>this.featureToResult(e,t,o))}extractGML3Data(e,t,o){const i=new wa.Z;let r=[];try{r=i.readFeatures(e)}catch(s){console.warn("query.service: GML3 is not well supported")}return r.map(e=>this.featureToResult(e,t,o))}extractGeoJSONData(e,t,o){let i=[];try{i=JSON.parse(e.replace(/(\r|\n)/g," ")).features}catch(r){console.warn("query.service: Unable to parse geojson","\n",e)}return i.map(e=>e.meta={id:N(),order:1e3-t,alias:o}),i}extractEsriJSONData(e,t,o){if(e)try{if(JSON.parse(e).error)return[]}catch(i){}return(new ha.Z).readFeatures(e).map(e=>this.featureToResult(e,t,o))}extractTextData(e){return[]}extractHtmlData(e,t,o,i){const r=this.getQueryParams(o.toLowerCase()),s=r.crs||r.srs||"EPSG:3857",n=this.createGeometryFromUrlClick(o);t!==zl.BLANK&&t!==zl.IFRAME&&(t=zl.IFRAME);const a=e.toLowerCase().indexOf("<body>"),l=e.toLowerCase().lastIndexOf("</body>")+7;return""===Ya(e.slice(a,l).replace(/(\r|\n|\s)/g,""))||""===e?[]:[{type:Zl,projection:s,properties:{target:t,body:e,url:o},geometry:i||n}]}getQueryParams(e){const t=e.split("?");if(!t[1])return;const o=t[1].split("&"),i={};return o.forEach(e=>{e=e.split("="),i[e[0]]=decodeURIComponent(e[1]||"")}),i}featureToResult(e,t,o){const i=e.getGeometry(),r=Object.assign({},e.getProperties());let s;return delete r.geometry,delete r.GEOMETRIE,delete r.boundedBy,delete r.shape,delete r.SHAPE,delete r.the_geom,delete r.geom,i&&(s={type:i.getType(),coordinates:i.getCoordinates()}),{type:Zl,projection:void 0,properties:r,geometry:s,meta:{id:N(),order:1e3-t,alias:o}}}getQueryUrl(e,t,o=!1,i){let r;switch(e.constructor){case ic:const s=e,n={INFO_FORMAT:s.params.INFO_FORMAT||this.getMimeInfoFormat(e.options.queryFormat),QUERY_LAYERS:s.params.LAYERS,FEATURE_COUNT:s.params.FEATURE_COUNT||"5"};o&&(n.INFO_FORMAT=this.getMimeInfoFormat(Gl.GML2)),r=s.ol.getFeatureInfoUrl(t.coordinates,t.resolution,t.projection,n);break;case Cc:const a=e;r=`${"https://"+a.options.account+".carto.com/api/v2/sql?"}format=GeoJSON${"&q="+a.options.config.layers[0].options.sql} WHERE ST_Intersects(the_geom_webmercator,ST_BUFFER(ST_SetSRID(ST_POINT(${t.coordinates[0]+","+t.coordinates[1]+"),3857),"+(a.options.queryPrecision?a.options.queryPrecision:"1000")+"))"}`;break;case Ac:case Lc:const l=e,c=Math.abs(i[0]-i[2]),u=Math.abs(i[1]-i[3]),p=.005*(c>u?c:u),d=l.options.queryPrecision?l.options.queryPrecision:p,h=zn.f3(zn.hI([t.coordinates]),d);r=`${l.options.url+"/"+l.options.layer+"/query/"}?${["f=json",`geometry=${encodeURIComponent('{"xmin":'+h[0]+',"ymin":'+h[1]+',"xmax":'+h[2]+',"ymax":'+h[3]+',"spatialReference":{"wkid":102100}}')}`,"geometryType=esriGeometryEnvelope","inSR=102100","spatialRel=esriSpatialRelIntersects","outFields=*","returnGeometry=true","outSR=102100"].join("&")}`}return r}getMimeInfoFormat(e){let t="application/vnd.ogc.gml";const o=Object.keys(Gl).find(t=>Gl[t]===e);return o&&(t=Yl[o]),t}getAllowedFieldsAndAlias(e){var t,o,i;let r;return(null===(i=null===(o=null===(t=e.options)||void 0===t?void 0:t.source)||void 0===o?void 0:o.options)||void 0===i?void 0:i.sourceFields)&&e.options.source.options.sourceFields.length>=1&&(r={},e.options.source.options.sourceFields.forEach(e=>{r[e.name]=e.alias?e.alias:e.name})),r}getQueryTitle(e,t){var o,i;let r;if(null===(i=null===(o=t.options)||void 0===o?void 0:o.source)||void 0===i?void 0:i.options){const o=t.options.source.options;o.queryTitle&&(r=this.getLabelMatch(e,o.queryTitle))}return r}getLabelMatch(e,t){let o=t;const i=Array.from(t.matchAll(/\$\{([^\{\}]+)\}/g));return i.forEach(t=>{o=o.replace(t[0],e.properties[t[1]])}),0===i.length&&o===t&&(o=e.properties[t]||t),o}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Nu(e){return!0===e.dataSource.options.queryable}function Ju(e){const t=e.get("_layer");return void 0!==t&&Nu(t)}let Bu=(()=>{class e{constructor(e,t){this.component=e,this.queryService=t,this.queries$$=[],this.queryFeatures=!1,this.queryFeaturesHitTolerance=0,this.waitForAllQueries=!0,this.query=new r.vpe}get map(){return this.component.map}ngAfterViewInit(){this.listenToMapClick(),this.addDragBoxInteraction()}ngOnDestroy(){this.cancelOngoingQueries(),this.unlistenToMapClick(),this.removeDragBoxInteraction()}listenToMapClick(){this.mapClickListener=this.map.ol.on("singleclick",e=>this.onMapEvent(e))}unlistenToMapClick(){(0,ea.B)(this.mapClickListener),this.mapClickListener=void 0}onMapEvent(e){if(this.cancelOngoingQueries(),!this.queryService.queryEnabled)return;const t=[];this.queryFeatures&&t.push(this.doQueryFeatures(e));const o=this.map.ol.getView().getResolution(),i=this.map.layers.filter(Nu);t.push(...this.queryService.query(i,{coordinates:e.coordinate,projection:this.map.projection,resolution:o})),0!==t.length&&(this.waitForAllQueries?this.queries$$.push((0,bn.$R)(...t).subscribe(t=>{const o=[].concat(...t);this.query.emit({features:o,event:e})})):this.queries$$=t.map(t=>t.subscribe(t=>{this.query.emit({features:t,event:e})})))}doQueryFeatures(e){const t=[];if("singleclick"===e.type)this.map.ol.forEachFeatureAtPixel(e.pixel,(e,o)=>{const i=this.map.getLayerById(o.values_._layer.id);if(e)if(e.get("features"))for(const r of e.get("features")){const e=Uc(r,this.map.projection);e.meta={title:r.values_.nom,id:o.values_._layer.id+"."+r.id_,icon:r.values_._icon,sourceTitle:o.values_.title,alias:this.queryService.getAllowedFieldsAndAlias(i)},t.push(e)}else if(e instanceof za.Z){const r=function(e,t,o,i="EPSG:4326"){let r,s,n,a;o?(s=o.get("title"),o.get("sourceOptions")&&(n=o.get("sourceOptions").excludeAttribute,a=o.get("sourceOptions").excludeAttributeOffline)):s=e.get("_title");const l=new Xn.Z,c=e.getProperties(),u=e.getType();if("Polygon"===u){const t=e.getEnds();r=new Vn.ZP(e.getFlatCoordinates(),Hn.Z.XY,t)}else"Point"===u?r=new _n.Z(e.getFlatCoordinates(),Hn.Z.XY):"LineString"===u&&(r=new Wn.Z(e.getFlatCoordinates(),Hn.Z.XY));const p=l.writeGeometryObject(r,{dataProjection:i,featureProjection:t}),d=e.getId()?e.getId():N(),h=e.get("_mapTitle"),g=kn.$A(e.getExtent(),t,i);return{type:Zl,projection:i,extent:g,meta:{id:d,title:s||h||d,mapTitle:h,excludeAttribute:n,excludeAttributeOffline:a},properties:c,geometry:p,ol:e}}(e,this.map.projection,o);r.meta={id:o.values_._layer.id+"."+r.meta.id,sourceTitle:o.values_.title,alias:this.queryService.getAllowedFieldsAndAlias(i),title:this.queryService.getQueryTitle(r,i)||r.meta.title},t.push(r)}else{const r=Uc(e,this.map.projection,o);r.meta={id:o.values_._layer.id+"."+r.meta.id,sourceTitle:o.values_.title,alias:this.queryService.getAllowedFieldsAndAlias(i),title:this.queryService.getQueryTitle(r,i)||r.meta.title},t.push(r)}},{hitTolerance:this.queryFeaturesHitTolerance||0,layerFilter:this.queryFeaturesCondition?this.queryFeaturesCondition:Ju});else if("boxend"===e.type){const o=e.target.getGeometry().getExtent();this.map.layers.filter(Nu).filter(e=>e instanceof fc&&e.visible).map(e=>{e.dataSource.ol.forEachFeatureIntersectingExtent(o,o=>{const i=Uc(o,this.map.projection,e.ol);i.meta={id:e.id+"."+o.getId(),icon:o.values_._icon,sourceTitle:e.title,alias:this.queryService.getAllowedFieldsAndAlias(e),title:this.queryService.getQueryTitle(i,e)||i.meta.title},t.push(i)})})}return(0,A.of)(t)}cancelOngoingQueries(){this.queries$$.forEach(e=>e.unsubscribe()),this.queries$$=[]}addDragBoxInteraction(){let e;const t=this.map.ol.getInteractions().getArray();for(const o of t)if(o instanceof Hc){e=o;break}void 0===e&&(e=new Hc({condition:hc}),this.map.ol.addInteraction(e),this.olDragSelectInteraction=e),this.olDragSelectInteractionEndKey=e.on("boxend",e=>this.onMapEvent(e))}removeDragBoxInteraction(){void 0!==this.olDragSelectInteractionEndKey&&(0,ea.B)(this.olDragSelectInteractionEndKey),void 0!==this.olDragSelectInteraction&&this.map.ol.removeInteraction(this.olDragSelectInteraction),this.olDragSelectInteraction=void 0}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(lu,2),r.Y36(Uu))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoQuery",""]],inputs:{queryFeatures:"queryFeatures",queryFeaturesHitTolerance:"queryFeaturesHitTolerance",queryFeaturesCondition:"queryFeaturesCondition",waitForAllQueries:"waitForAllQueries"},outputs:{query:"query"}}),e})(),ju=(()=>{class e{constructor(e,t){if(this.storageService=t,this.options=e,this.storageService){const e=this.storageService.get(this.getId()+".options");e&&(this.options=D.mergeDeep(this.options,e))}this.options=D.mergeDeep(this.getDefaultOptions(),this.options),this.settings.forEach(e=>{this.setParamFromSetting(e,!1)})}getId(){throw new Error('You have to implement the method "getId".')}getType(){throw new Error('You have to implement the method "getType".')}getDefaultOptions(){throw new Error('You have to implement the method "getDefaultOptions".')}get title(){return this.options.title}get available(){return!1!==this.options.available}set enabled(e){this.options.enabled=e}get enabled(){return this.available&&!1!==this.options.enabled}get showInPointerSummary(){return this.options.showInPointerSummary||!1}get showInSettings(){const e=this.options.showInSettings;return void 0===e||e}get searchUrl(){return this.options.searchUrl}get params(){return void 0===this.options.params?{}:this.options.params}get settings(){return void 0===this.options.settings?[]:this.options.settings}setParamFromSetting(e,t=!0){switch(e.type){case"radiobutton":e.values.forEach(t=>{t.enabled&&(this.options.params=Object.assign(this.options.params||{},{[e.name]:t.value}))});break;case"checkbox":let t="";e.values.filter(e=>!1!==e.available).forEach(e=>{e.enabled&&(t+=e.value+",")}),t=t.slice(0,-1),this.options.params=Object.assign(this.options.params||{},{[e.name]:t})}t&&this.storageService&&this.storageService.set(this.getId()+".options",{params:this.options.params})}get displayOrder(){return void 0===this.options.order?99:this.options.order}getHashtagsValid(e,t){const o=e.match(/(#[A-Za-z]+)/g);if(!o)return;const i=this.getSettingsValues(t),r=[];return o.forEach(e=>{i.values.forEach(t=>{const o=e.substring(1);if("string"==typeof t.value){const e=t.value.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").split(","),i=e.indexOf(o.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""));-1!==i&&r.push(e[i])}t.hashtags&&-1!==t.hashtags.indexOf(o)&&r.push(t.value)})}),r.filter((e,t)=>r.indexOf(e)===t)}getSettingsValues(e){return this.getDefaultOptions().settings.find(t=>t.name===e)}}return e.id="",e.type="",e})(),Qu=(()=>{class e extends ju{constructor(e){super(e)}getId(){return e.id}getType(){return e.type}getDefaultOptions(){return{title:"Carte"}}}return e.id="map",e.type=Zl,e.\u0275fac=function(t){return new(t||e)(r.LFG("options"))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})();class Gu{static getGoogleMapsCoordLink(e,t){return"https://www.google.com/maps?q="+t+","+e}static getGoogleStreetViewLink(e,t){return"https://www.google.com/maps?q=&layer=c&cbll="+t+","+e}static getGoogleMapsNameLink(e){return"https://www.google.com/maps?q="+encodeURI(e)}}class Yu{static getOpenStreetMapLink(e,t,o=17){return`https://www.openstreetmap.org/?mlat=${t}&mlon=${e}#map=${o}/${t}/${e}`}static getOpenStreetCamLink(e,t,o=17){return`https://openstreetcam.org/map/@${t},${e},${o}z`}}let zu=(()=>{class e{constructor(e,t,o,i,r){this.http=e,this.config=t,this.languageService=o,this.messageService=i,this.capabilitiesService=r}loadCatalogs(){const e=this.config.getConfig("context")||{},t=this.config.getConfig("catalog")||{},o=t.url||e.url,i=t.sources||[],r=[];if(o){if(t.baseLayers){const e=this.languageService.translate.instant("igo.geo.catalog.baseLayers");r.push((0,A.of)([{id:"catalog.baselayers",title:e,url:`${o}/baselayers`,type:"baselayers"}]))}const e=this.http.get(`${o}/catalogs`).pipe((0,x.U)(e=>e.map(e=>Object.assign(e,e.options))),(0,b.K)(e=>xn.E));r.push(e)}return i.length>0&&r.push((0,A.of)(i).pipe((0,x.U)(e=>e.map(e=>(e.id||(e.id=N()),e))))),(0,bn.$R)(...r).pipe((0,x.U)(e=>[].concat.apply([],e)))}loadCatalogItems(e){let t;return t=Ru.createInstanceCatalog(e,this),t.collectCatalogItems()}loadCatalogBaseLayerItems(e){return this.getCatalogBaseLayersOptions(e).pipe((0,x.U)(t=>{const o=t.map(t=>({id:kl(t.sourceOptions),title:t.title,type:Mu.Layer,externalProvider:e.externalProvider,options:t}));return[{id:"catalog.group.baselayers",type:Mu.Group,externalProvider:e.externalProvider,title:e.title,items:o}]}))}getCatalogBaseLayersOptions(e){return this.http.get(e.url)}loadCatalogWMSLayerItems(e){return this.getCatalogCapabilities(e).pipe((0,x.U)(t=>{const o=[];if(!t)return o;t.Service&&t.Service.Abstract&&t.Service.Abstract.length&&(e.abstract=t.Service.Abstract);const i=[];this.flattenWmsCapabilities(t.Capability.Layer,0,i,e.groupSeparator);const r=Object.assign({},t.Capability.Layer);return r.Layer=i.filter(e=>0!==e.Layer.length),this.includeRecursiveItems(e,r,o),o}))}flattenWmsCapabilities(e,t=0,o,i=" / "){if(!o.includes(e.Title)){const t=Object.assign({},e);t.Layer=[],o.push(t)}for(const r of e.Layer){const s=Object.assign({},r);t>0&&(s.Title=e.Title+i+r.Title),r.Layer?this.flattenWmsCapabilities(s,t+1,o,i):o.find(t=>t.Title===e.Title).Layer.push(r)}}loadCatalogWMTSLayerItems(e){return this.getCatalogCapabilities(e).pipe((0,x.U)(t=>this.getWMTSItems(e,t)))}loadCatalogArcGISRestItems(e){return this.getCatalogCapabilities(e).pipe((0,x.U)(t=>this.getArcGISRESTItems(e,t)))}loadCatalogCompositeLayerItems(e){const t=e.composite,o=[];t.map(t=>{t.sortDirection=e.sortDirection,o.push(Ru.createInstanceCatalog(t,this))});const i=[];o.map(e=>i.push(e.collectCatalogItems()));let r=[];function s(e){return e.reduce((e,t)=>e.concat(t.type===Mu.Group?s(t.items):t),[])}if(Object.keys(t).find(e=>t[e].groupImpose)){const e=(e,t)=>{const i=o[t],r=Object.assign({},i.groupImpose);r.address=i.id,r.type=Mu.Group,r.externalProvider=i.externalProvider,void 0===r.sortDirection&&(r.sortDirection=i.sortDirection),r.items=[];const n=s(e);return n.map(e=>e.address=`${r.address}.${r.id}`),r.items=n,r};r=i.map((o,i)=>o.pipe((0,x.U)(o=>t[i].groupImpose?e(o,i):o)))}else r=i;const n=(0,bn.$R)(...r).pipe((0,x.U)(e=>[].concat(...e))),a=(e,t)=>e.reduce((e,o,i,r)=>{const s=t(o),n=Object.assign({},o);if(o.type===Mu.Layer){const t=[];if(r.filter((e,r)=>{let n=!1;return e.title===s&&e.type===Mu.Layer&&(r!==i&&e.address!==o.address&&(n=!0),t.push(r)),n}).length>0){const e=t.findIndex(e=>e===i)+1;n.title=`${o.title} (${e})`}e.find(e=>e.title===n.title&&e.type===Mu.Layer)||(e[e.length]=n)}else o.type===Mu.Group&&(n.items=a(o.items,e=>e.title),e[e.length]=n);return e},[]);return n.pipe((0,x.U)(e=>((e,t)=>e.reduce((e,t)=>{const o=(e=>e.id)(t),i=e.find(e=>e.id===o);if(i){const o=e.indexOf(i);-1===e[o].address.split("|").indexOf(t.address)&&(e[o].address=`${e[o].address}|${t.address}`),e[o].items.push(...t.items)}else e[e.length]=t;return e},[]))(e)),(0,x.U)(e=>[].concat(...e)),(0,x.U)(e=>a(e,e=>e.title)))}getCatalogCapabilities(e){return this.capabilitiesService.getCapabilities(Iu[e.type],e.url,e.version).pipe((0,b.K)(t=>{const o=this.languageService.translate.instant("igo.geo.catalog.unavailableTitle"),i=e.title?this.languageService.translate.instant("igo.geo.catalog.unavailable",{value:e.title}):this.languageService.translate.instant("igo.geo.catalog.someUnavailable");return this.messageService.error(i,o),console.error(t),(0,A.of)(void 0)}))}prepareCatalogItemLayer(e,t,o,i){const r=this.retrieveLayerInfoFormat(e.Name,o),s=e.DataURL?e.DataURL[0]:void 0,n=i.showLegend&&e.Style?this.capabilitiesService.getStyle(e.Style):void 0,a=Object.assign({},i.queryParams,{LAYERS:e.Name,VERSION:i.version}),l={type:"wms",url:i.url,crossOrigin:i.setCrossOriginAnonymous?"anonymous":void 0,queryFormat:r,queryHtmlTarget:r===Gl.HTML||r===Gl.HTMLGML2?"iframe":void 0,optionsFromCapabilities:!0},c=Object.assign({},l,i.sourceOptions,{params:a});let u,p;if(i.forcedProperties)for(const h of i.forcedProperties)e.Name===h.layerName&&h.title&&(u=h.title);e.Abstract?p=e.Abstract:!e.Abstract&&i.abstract&&(p=i.abstract);const d={id:kl(c),type:Mu.Layer,title:void 0!==u?u:e.Title,address:t,externalProvider:i.externalProvider||!1,options:{maxResolution:dc(e.MaxScaleDenominator),minResolution:dc(e.MinScaleDenominator),metadata:{url:s?s.OnlineResource:void 0,extern:!!s||void 0,abstract:p,type:l.type},legendOptions:n,tooltip:{type:i.tooltipType},sourceOptions:c}};return D.removeUndefined(d)}prepareCatalogItemGroup(e,t,o,i,r){return{id:o,type:Mu.Group,title:e.Title,address:r.id,externalProvider:r.externalProvider||!1,sortDirection:r.sortDirection,items:e.Layer.reduce((e,s)=>{if(void 0!==s.Layer){const n=this.prepareCatalogItemGroup(s,t,o+`.group.${s.Name||s.Layer[0].Name}`,i,r);e.push(n)}else{if(!1===this.testLayerRegexes(s.Name,t))return e;const n=this.prepareCatalogItemLayer(s,o,i,r);e.push(n)}return e},[])}}includeRecursiveItems(e,t,o,i=0){const r=(e.regFilters||[]).map(e=>new RegExp(e));if(t.Layer)for(const s of t.Layer){if(void 0!==s.Layer){this.includeRecursiveItems(e,s,o,i+1);continue}const n=this.findCatalogInfoFormat(e);if(0!==i){const i=this.prepareCatalogItemGroup(t,r,`catalog.group.${t.Name||s.Name}`,n,e);0!==i.items.length&&o.push(i);break}if(!1!==this.testLayerRegexes(s.Name,r)){const t=this.prepareCatalogItemLayer(s,e.id,n,e);o.push(t)}}}getWMTSItems(e,t){if(!t)return[];const o=t.Contents.Layer,i=(e.regFilters||[]).map(e=>new RegExp(e));return t.ServiceIdentification&&t.ServiceIdentification.Abstract&&t.ServiceIdentification.Abstract.length&&(e.abstract=t.ServiceIdentification.Abstract),o.map(t=>{let o;if(e.forcedProperties)for(const i of e.forcedProperties)t.Title===i.layerName&&i.title&&(o=i.title);if(!1===this.testLayerRegexes(t.Identifier,i))return;const r=Object.assign({},e.queryParams,{version:"1.0.0"}),s={type:"wmts",url:e.url,crossOrigin:e.setCrossOriginAnonymous?"anonymous":void 0,layer:t.Identifier,matrixSet:e.matrixSet,optionsFromCapabilities:!0,requestEncoding:e.requestEncoding||"KVP",style:"default"},n=Object.assign({},s,e.sourceOptions,{params:r});return D.removeUndefined({id:kl(n),type:Mu.Layer,title:void 0!==o?o:t.Title,address:e.id,externalProvider:e.externalProvider,options:{sourceOptions:n,metadata:{url:void 0,extern:void 0,abstract:e.abstract,type:s.type}}})}).filter(e=>void 0!==e)}getArcGISRESTItems(e,t){if(!t)return[];const o=t.layers.filter(e=>!e.type||"Feature Layer"===e.type),i=(e.regFilters||[]).map(e=>new RegExp(e));let r;return t.serviceDescription&&t.serviceDescription.length&&(r=t.serviceDescription.replace(/(<([^>]+)>)/gi,"")),o.map(t=>{let o;if(e.forcedProperties)for(const i of e.forcedProperties)t.name===i.layerName&&i.title&&(o=i.title);if(!1===this.testLayerRegexes(t.id,i))return;const s={type:Iu[e.type],url:e.url,crossOrigin:e.setCrossOriginAnonymous?"anonymous":void 0,layer:t.id,queryable:!0,queryFormat:"esrijson",matrixSet:e.matrixSet,optionsFromCapabilities:!0,style:"default"},n=Object.assign({},s,e.sourceOptions);return D.removeUndefined({id:kl(n),type:Mu.Layer,title:void 0!==o?o:t.name,externalProvider:e.externalProvider,address:e.id,options:{sourceOptions:n,minResolution:dc(t.maxScale),maxResolution:dc(t.minScale),metadata:{url:void 0,extern:void 0,abstract:r,type:s.type},title:void 0!==o?o:t.name}})}).filter(e=>void 0!==e)}testLayerRegexes(e,t){return 0===t.length||void 0!==t.find(t=>t.test(e))}retrieveLayerInfoFormat(e,t){const o=t.find(t=>t.layer===e),i=t.find(e=>"*"===e.layer);let r;return o?r=o.queryFormat:i&&(r=i.queryFormat),r}findCatalogInfoFormat(e){const t=[];return e.queryFormat&&Object.keys(e.queryFormat).forEach(o=>{e.queryFormat[o]instanceof Array?e.queryFormat[o].forEach(e=>{t.find(t=>t.layer===e)||t.push({layer:e,queryFormat:o})}):t.find(t=>t.layer===e.queryFormat[o])||t.push({layer:e.queryFormat[o],queryFormat:o})}),t}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(W),r.LFG(ue),r.LFG(de),r.LFG($c))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Hu(e,t){if(1&e){const e=r.EpF();r.ynx(0),r.TgZ(1,"igo-catalog-browser-group",3),r.NdJ("addedChange",function(t){return r.CHM(e),r.oxw(2).onGroupAddedChange(t)})("layerAddedChange",function(t){return r.CHM(e),r.oxw(2).onLayerAddedChange(t)}),r.ALo(2,"async"),r.qZA(),r.BQk()}if(2&e){const e=r.oxw().$implicit,t=r.oxw();r.xp6(1),r.Q6J("catalog",t.catalog)("group",e)("state",t.store.state)("resolution",r.lcZ(2,7,t.resolution$))("catalogAllowLegend",t.catalogAllowLegend)("collapsed",1!==t.store.count)("toggleCollapsed",t.toggleCollapsedGroup)}}function Vu(e,t){if(1&e){const e=r.EpF();r.ynx(0),r.TgZ(1,"igo-catalog-browser-layer",4),r.NdJ("addedChange",function(t){return r.CHM(e),r.oxw(2).onLayerAddedChange(t)}),r.ALo(2,"async"),r.qZA(),r.BQk()}if(2&e){const e=r.oxw().$implicit,t=r.oxw();r.xp6(1),r.Q6J("layer",e)("resolution",r.lcZ(2,4,t.resolution$))("catalogAllowLegend",t.catalogAllowLegend)("added",t.store.state.get(e).added)}}function Wu(e,t){if(1&e&&(r.YNc(0,Hu,3,9,"ng-container",2),r.YNc(1,Vu,3,6,"ng-container",2)),2&e){const e=t.$implicit,o=r.oxw();r.Q6J("ngIf",o.isGroup(e)),r.xp6(1),r.Q6J("ngIf",o.isLayer(e))}}let Xu=(()=>{class e{constructor(e,t){this.layerService=e,this.cdRef=t,this.catalogAllowLegend=!1,this.toggleCollapsedGroup=!0}get resolution$(){return this.map.viewController.resolution$}ngOnInit(){const e=this.map.layers.map(e=>({id:e.options.source.id,title:e.title,type:Mu.Layer}));this.store.state.updateMany(e,{added:!0},!0),this.catalog&&void 0!==this.catalog.sortDirection&&this.store.view.sort({direction:this.catalog.sortDirection,valueAccessor:e=>e.title}),this.catalogAllowLegend=!!this.catalog&&this.catalog.showLegend||this.catalogAllowLegend,this.watcher=new ht(this.store,this.cdRef)}ngOnDestroy(){this.watcher.destroy()}isGroup(e){return e.type===Mu.Group}isLayer(e){return e.type===Mu.Layer}onLayerAddedChange(e){const t=e.layer;this.store.state.update(t,{added:e.added},!1),e.added?this.addLayerToMap(t):this.removeLayerFromMap(t)}onGroupAddedChange(e){const t=e.group;this.store.state.update(t,{added:e.added},!1),e.added?this.addGroupToMap(t):this.removeGroupFromMap(t)}addLayerToMap(e){this.addLayersToMap([e])}removeLayerFromMap(e){this.removeLayersFromMap([e])}addLayersToMap(e){const t=e.map(e=>(void 0===e.options.sourceOptions.optionsFromApi&&(e.options.sourceOptions.optionsFromApi=!0),this.layerService.createAsyncLayer(e.options)));(0,bn.$R)(...t).subscribe(t=>{this.store.state.updateMany(e,{added:!0}),this.map.addLayers(t)})}removeLayersFromMap(e){e.forEach(e=>{if(this.store.state.update(e,{added:!1}),!0===e.options.baseLayer){const t=this.map.getLayerById(e.options.id);void 0!==t&&this.map.removeLayer(t)}else{const t=this.map.getLayerById(e.id);void 0!==t&&this.map.removeLayer(t)}})}sortCatalogItemsByTitle(e,t){const o=e.sort((e,t)=>{const o=e.title.normalize("NFD").replace(/[\u0300-\u036f]/g,""),i=t.title.normalize("NFD").replace(/[\u0300-\u036f]/g,"");return o<i?-1:o>i?1:0});switch(t){case"asc":return o;case"desc":return o.reverse();default:return e}}addGroupToMap(e){let t=e.items.filter(e=>{const t=this.store.state.get(e).added||!1;return this.isLayer(e)&&!1===t});void 0!==e.sortDirection&&(t=this.sortCatalogItemsByTitle(t,e.sortDirection)),this.addLayersToMap(t.reverse())}removeGroupFromMap(e){const t=e.items.filter(e=>{const t=this.store.state.get(e).added||!1;return this.isLayer(e)&&!0===t});this.removeLayersFromMap(t)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Cu),r.Y36(r.sBO))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-catalog-browser"]],inputs:{catalogAllowLegend:"catalogAllowLegend",catalog:"catalog",store:"store",map:"map",toggleCollapsedGroup:"toggleCollapsedGroup"},decls:3,vars:5,consts:[[3,"navigation","selection"],["ngFor","",3,"ngForOf"],[4,"ngIf"],[3,"catalog","group","state","resolution","catalogAllowLegend","collapsed","toggleCollapsed","addedChange","layerAddedChange"],["igoListItem","",3,"layer","resolution","catalogAllowLegend","added","addedChange"]],template:function(e,t){1&e&&(r.TgZ(0,"igo-list",0),r.YNc(1,Wu,2,2,"ng-template",1),r.ALo(2,"async"),r.qZA()),2&e&&(r.Q6J("navigation",!1)("selection",!1),r.xp6(1),r.Q6J("ngForOf",r.lcZ(2,3,t.store.view.all$())))},encapsulation:2,changeDetection:0}),e})();const Ku=["renderedLegend"];function ep(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-list-item"),r.TgZ(1,"mat-icon",7),r.NdJ("toggle",function(t){r.CHM(e);const o=r.oxw(2).$implicit;return r.oxw(3).toggleLegendItem(t,o)}),r.qZA(),r.TgZ(2,"h4",8),r._uU(3),r.ALo(4,"async"),r.qZA(),r.qZA()}if(2&e){r.oxw();const e=r.MAs(3),t=r.oxw().$implicit,o=r.oxw(3);r.xp6(1),r.Q6J("target",e)("collapsed",t.collapsed),r.xp6(2),r.hij("",r.lcZ(4,3,o.computeItemTitle(t))," ")}}function tp(e,t){if(1&e&&(r.TgZ(0,"mat-option",11),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.name),r.xp6(1),r.Oqu(e.title)}}function op(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div"),r.TgZ(1,"mat-form-field"),r.TgZ(2,"mat-select",9),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw(5).currentStyle=t})("selectionChange",function(){return r.CHM(e),r.oxw(5).onChangeStyle()}),r.ALo(3,"translate"),r.YNc(4,tp,2,2,"mat-option",10),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(5);r.xp6(2),r.Q6J("matTooltip",r.lcZ(3,3,"igo.geo.layer.legend.selectStyle"))("ngModel",e.currentStyle),r.xp6(2),r.Q6J("ngForOf",e.styles)}}function ip(e,t){1&e&&(r.TgZ(0,"small"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"igo.geo.layer.legend.noLegendScale")," "))}function rp(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div"),r.TgZ(1,"img",13,14),r.NdJ("load",function(){r.CHM(e);const t=r.oxw(3).$implicit;return r.oxw(3).onLoadImage(t.title)}),r.ALo(3,"translate"),r.qZA(),r.YNc(4,ip,3,3,"small",0),r.qZA()}if(2&e){const e=r.oxw(3).$implicit,t=r.oxw(3);r.xp6(1),r.s9C("id",e.title),r.s9C("src",t.legendGraphic,r.LSH),r.s9C("alt",r.lcZ(3,4,"igo.geo.layer.legend.loadingLegendText")),r.xp6(3),r.Q6J("ngIf",t.imagesHeight[e.title]<16)}}function sp(e,t){if(1&e&&r._UZ(0,"div",15),2&e){const e=r.oxw(3).$implicit;r.Q6J("ngStyle",e.style)("innerHTML",e.html,r.oJD)}}function np(e,t){if(1&e&&(r.TgZ(0,"div"),r.YNc(1,rp,5,6,"div",0),r.YNc(2,sp,1,2,"div",12),r.qZA()),2&e){const e=r.oxw(2).$implicit;r.xp6(1),r.Q6J("ngIf",e.url),r.xp6(1),r.Q6J("ngIf",e.html)}}const ap=function(e){return{"with-title":e}};function lp(e,t){if(1&e&&(r.TgZ(0,"div"),r.YNc(1,ep,5,5,"mat-list-item",0),r.TgZ(2,"div",5,6),r.YNc(4,op,5,5,"div",0),r.YNc(5,np,3,2,"div",0),r.qZA(),r.qZA()),2&e){const e=r.oxw().$implicit,t=r.oxw(3);r.xp6(1),r.Q6J("ngIf",e.title),r.xp6(1),r.Q6J("ngClass",r.VKq(4,ap,e.title)),r.xp6(2),r.Q6J("ngIf",void 0!==t.currentStyle),r.xp6(1),r.Q6J("ngIf",!e.collapsed)}}function cp(e,t){if(1&e&&(r.ynx(0,null,4),r.YNc(2,lp,6,6,"div",1),r.BQk()),2&e){r.oxw(2);const e=r.MAs(3),t=r.oxw();r.xp6(2),r.Q6J("ngIf",t.getLegend)("ngIfElse",e)}}function up(e,t){if(1&e&&(r.ynx(0),r.YNc(1,cp,3,2,"ng-container",3),r.BQk()),2&e){const e=r.oxw().ngIf;r.xp6(1),r.Q6J("ngForOf",e.slice().reverse())}}function pp(e,t){1&e&&(r.TgZ(0,"small"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"igo.geo.layer.legend.noLegendText")," "))}function dp(e,t){if(1&e&&(r.ynx(0),r.YNc(1,up,2,1,"ng-container",1),r.YNc(2,pp,3,3,"ng-template",null,2,r.W1O),r.BQk()),2&e){const e=t.ngIf,o=r.MAs(3);r.xp6(1),r.Q6J("ngIf",e.length)("ngIfElse",o)}}let hp=(()=>{class e{constructor(e,t,o,i){this.capabilitiesService=e,this.languageService=t,this.http=o,this.cdRef=i,this.updateLegendOnResolutionChange=!1,this.legendItems$=new C.X([]),this.scale=void 0,this.view=void 0,this.imagesHeight={},this.getLegend=!0}ngOnInit(){let e=this.layer.legend;this.styles=this.listStyles();const t=this.layer.options.source.options;if(t&&t.params&&t.params.STYLES?this.currentStyle=this.styles.find(e=>e.name===t.params.STYLES).name:this.layer.legend?this.styles&&this.styles.length>1&&(this.currentStyle=e[0].currentStyle):this.styles&&this.styles.length>1&&(this.currentStyle=this.styles[0].name),e=void 0!==this.layer.options.legendOptions&&!1===this.layer.options.legendOptions.display?[]:this.layer.dataSource.getLegend(this.currentStyle,this.view),!0===this.updateLegendOnResolutionChange||t.contentDependentLegend)this.state$$=this.layer.map.viewController.state$.subscribe(()=>this.onViewControllerStateChange());else if(e&&0!==e.length){this.legendItems$.next(e);for(const t of e)this.getLegendGraphic(t)}}ngOnDestroy(){void 0!==this.state$$&&this.state$$.unsubscribe()}getLegendGraphic(e){new Tt(this.http).transform(e.url).pipe((0,b.K)(e=>{if(e.error)return e.error.caught=!0,this.getLegend=!1,this.cdRef.detectChanges(),e})).subscribe(e=>{this.legendGraphic=e,this.cdRef.detectChanges()})}toggleLegendItem(e,t){t.collapsed=e}transfertToggleLegendItem(e){const t=e,o=this.layer.legend;for(let i=0;i<o.length;i++)t[i].collapsed=o[i].collapsed;return t}computeItemTitle(e){const t=this.layer.dataSource.options;if("wms"!==t.type)return(0,A.of)(e.title);const o=t.params.LAYERS.split(","),i=JSON.parse(JSON.stringify(t));return i.params.LAYERS=o.find(t=>t===e.title),this.capabilitiesService.getWMSOptions(i).pipe((0,x.U)(e=>e._layerOptionsFromSource.title))}onViewControllerStateChange(){this.view={resolution:this.layer.map.viewController.getResolution(),extent:this.layer.map.viewController.getExtent(),projection:this.layer.map.viewController.getOlProjection().getCode(),scale:this.layer.map.viewController.getScale(),size:this.layer.map.ol.getSize()},this.updateLegend()}updateLegend(){let e=this.layer.dataSource.getLegend(this.currentStyle,this.view);if(this.layer.legend&&this.layer.legend.length>1&&(e=this.transfertToggleLegendItem(e)),this.layer.legend=e,0!==e.length||0!==this.legendItems$.value.length){this.legendItems$.next(e);for(const e of this.legendItems$.value)this.getLegendGraphic(e)}}listStyles(){const e=this.layer.options;if(e&&e.legendOptions){let t=[{name:"",title:this.languageService.translate.instant("igo.geo.layer.legend.default")}];return e.legendOptions.stylesAvailable&&(t=t.concat(e.legendOptions.stylesAvailable.filter(e=>"default"!==e.name.normalize("NFD").replace(/[\u0300-\u036f]/gi,"")&&"defaut"!==e.name.normalize("NFD").replace(/[\u0300-\u036f]/gi,"")))),t.filter(e=>!e.title).map(e=>e.title=e.name),t.map(e=>e.title=e.title.charAt(0).toUpperCase()+e.title.slice(1).replace(/_/g," ")),t}}onChangeStyle(){this.updateLegend();let e="";this.layer.dataSource instanceof ic&&(this.layer.dataSource.ol.getParams().LAYERS.split(",").map(t=>e+=this.currentStyle+","),e=e.slice(0,-1),this.layer.dataSource.ol.updateParams({STYLES:e}))}onLoadImage(e){let t;t=1===this.renderedLegends.length?this.renderedLegends.first.nativeElement:this.renderedLegends.find(t=>t.nativeElement.id===e).nativeElement,this.imagesHeight[e]=t.height}}return e.\u0275fac=function(t){return new(t||e)(r.Y36($c),r.Y36(ue),r.Y36(y.eN),r.Y36(r.sBO))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-layer-legend"]],viewQuery:function(e,t){if(1&e&&r.Gf(Ku,5),2&e){let e;r.iGM(e=r.CRH())&&(t.renderedLegends=e)}},inputs:{updateLegendOnResolutionChange:"updateLegendOnResolutionChange",layer:"layer"},decls:2,vars:3,consts:[[4,"ngIf"],[4,"ngIf","ngIfElse"],["noItems",""],[4,"ngFor","ngForOf"],["renderedLegends",""],[1,"igo-layer-legend",3,"ngClass"],["legend",""],["id","legend-toggle","mat-list-avatar","","igoCollapse","","svgIcon","chevron-up",1,"igo-chevron",3,"target","collapsed","toggle"],["matLine",""],["tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[3,"ngStyle","innerHTML",4,"ngIf"],[3,"id","src","alt","load"],["renderedLegend",""],[3,"ngStyle","innerHTML"]],template:function(e,t){1&e&&(r.YNc(0,dp,4,2,"ng-container",0),r.ALo(1,"async")),2&e&&r.Q6J("ngIf",r.lcZ(1,1,t.legendItems$))},directives:[h.O5,h.sg,h.mk,l.Tg,a.Hw,l.eA,Do,Re.X2,De.KE,Ee.gD,p.gM,We.JJ,We.On,Re.ey,h.PC],pipes:[h.Ov,j.X$],styles:['.igo-layer-legend.with-title[_ngcontent-%COMP%]{padding-left:18px}img[_ngcontent-%COMP%]:after{content:" ";position:relative;height:17px;float:left;width:17px;top:-3px;right:19px;background-color:#fff;border:3px solid #f3f3f3;border-radius:50%;-webkit-animation:2s linear infinite spin;animation:2s linear infinite spin}@-moz-document url-prefix(){img:after{margin-left:19px}}@-webkit-keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}'],changeDetection:0}),e})();function gp(e,t){1&e&&r._UZ(0,"mat-icon",9)}function mp(e,t){1&e&&(r.TgZ(0,"mat-icon",12),r.NdJ("click",function(e){return e.stopPropagation()}),r.ALo(1,"translate"),r.qZA()),2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.catalog.externalProvider.layer"))}function fp(e,t){if(1&e&&(r.TgZ(0,"button",10),r.YNc(1,mp,2,3,"mat-icon",11),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf",e.layer.externalProvider)}}function yp(e,t){if(1&e&&(r._UZ(0,"igo-layer-legend",3),r.ALo(1,"async")),2&e){const e=r.oxw();r.Q6J("layer",r.lcZ(1,1,e.igoLayer$))}}let vp=(()=>{class e{constructor(e){this.layerService=e,this.inRange$=new C.X(!0),this.isPreview$=new C.X(!1),this.layerLegendShown$=new C.X(!1),this.igoLayer$=new C.X(void 0),this.mouseInsideAdd=!1,this.catalogAllowLegend=!1,this.added=!1,this.addedChange=new r.vpe,this.addedLayerIsPreview=new r.vpe}get title(){return lt(this.layer)}get icon(){return ct(this.layer)||"layers"}ngOnInit(){this.isInResolutionsRange(),this.isPreview$$=this.isPreview$.subscribe(e=>this.addedLayerIsPreview.emit(e))}ngOnDestroy(){this.isPreview$$.unsubscribe()}computeTitleTooltip(){const e=this.layer.options;if(!e.tooltip)return lt(this.layer);const t=e.tooltip,o=e.metadata;switch(e.tooltip.type){case Il.TITLE:return this.layer.title;case Il.ABSTRACT:return o&&o.abstract?o.abstract:this.layer.title;case Il.CUSTOM:return t&&t.text?t.text:this.layer.title;default:return this.layer.title}}onMouseEvent(e){this.onToggleClick(e)}askForLegend(e){this.layerLegendShown$.next(!this.layerLegendShown$.value),this.layerService.createAsyncLayer(this.layer.options).pipe((0,Sn.P)()).subscribe(e=>this.igoLayer$.next(e))}onToggleClick(e){if(void 0!==this.lastTimeoutRequest&&clearTimeout(this.lastTimeoutRequest),"mouseenter"!==e.type||!this.mouseInsideAdd)switch(e.type){case"click":this.isPreview$.value||(this.added?this.remove():this.add()),this.isPreview$.next(!1);break;case"mouseenter":!this.isPreview$.value&&!this.added&&(this.lastTimeoutRequest=setTimeout(()=>{this.add(),this.isPreview$.next(!0)},500)),this.mouseInsideAdd=!0;break;case"mouseleave":this.isPreview$.value&&(this.remove(),this.isPreview$.next(!1)),this.mouseInsideAdd=!1}}add(){this.added||(this.added=!0,this.addedChange.emit({added:!0,layer:this.layer}))}remove(){this.added&&(this.added=!1,this.addedChange.emit({added:!1,layer:this.layer}))}haveGroup(){return!(!this.layer.address||1===this.layer.address.split(".").length)}isInResolutionsRange(){return this.inRange$.next(this.resolution>=(this.layer.options.minResolution||0)&&this.resolution<=(this.layer.options.maxResolution||1/0)),this.inRange$.value}computeTooltip(){return this.added?this.isPreview$.value?"igo.geo.catalog.layer.addToMap":this.inRange$.value?"igo.geo.catalog.layer.removeFromMap":"igo.geo.catalog.layer.removeFromMapOutRange":this.inRange$.value?"igo.geo.catalog.layer.addToMap":"igo.geo.catalog.layer.addToMapOutRange"}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Cu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-catalog-browser-layer"]],inputs:{resolution:"resolution",catalogAllowLegend:"catalogAllowLegend",layer:"layer",added:"added"},outputs:{addedChange:"addedChange",addedLayerIsPreview:"addedLayerIsPreview"},decls:16,vars:21,consts:[["mat-list-avatar","","svgIcon","blank",4,"ngIf"],["mat-line","","matTooltipShowDelay","500",3,"ngClass","matTooltip","click"],["disabled","true","mat-icon-button","",4,"ngIf"],[3,"layer"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","mouseenter","mouseleave","click"],["matBadge","icon","igoMatBadgeIcon","eye-off","igoMatBadgeInverseColor","true","matBadgeDisabled","true","matBadgeSize","small","matBadgePosition","after",3,"matBadgeHidden","svgIcon"],[1,"igo-cataloglayer-legend-container"],["legend",""],[3,"layer",4,"ngIf"],["mat-list-avatar","","svgIcon","blank"],["disabled","true","mat-icon-button",""],["class","igo-cataloglayer-external-icon","tooltip-position","below","matTooltipShowDelay","500","color","primary","svgIcon","earth-arrow-right",3,"matTooltip","click",4,"ngIf"],["tooltip-position","below","matTooltipShowDelay","500","color","primary","svgIcon","earth-arrow-right",1,"igo-cataloglayer-external-icon",3,"matTooltip","click"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-list-item"),r.YNc(1,gp,1,0,"mat-icon",0),r.TgZ(2,"h4",1),r.NdJ("click",function(e){return t.askForLegend(e)}),r._uU(3),r.qZA(),r.YNc(4,fp,2,1,"button",2),r._UZ(5,"igo-metadata-button",3),r.TgZ(6,"button",4),r.NdJ("mouseenter",function(e){return t.onMouseEvent(e)})("mouseleave",function(e){return t.onMouseEvent(e)})("click",function(e){return t.onToggleClick(e)}),r.ALo(7,"translate"),r.ALo(8,"async"),r._UZ(9,"mat-icon",5),r.ALo(10,"async"),r.qZA(),r.qZA(),r.TgZ(11,"div",6,7),r.YNc(13,yp,2,3,"igo-layer-legend",8),r.ALo(14,"async"),r.ALo(15,"async"),r.qZA()),2&e&&(r.xp6(1),r.Q6J("ngIf",t.haveGroup()),r.xp6(1),r.Q6J("ngClass",t.catalogAllowLegend?"igo-cataloglayer-title":"")("matTooltip",t.computeTitleTooltip()),r.xp6(1),r.Oqu(t.title),r.xp6(1),r.Q6J("ngIf",t.layer.externalProvider),r.xp6(1),r.Q6J("layer",t.layer),r.xp6(1),r.Q6J("matTooltip",r.lcZ(7,11,t.computeTooltip()))("color",r.lcZ(8,13,t.isPreview$)?"":t.added?"warn":""),r.xp6(3),r.Q6J("matBadgeHidden",t.isInResolutionsRange())("svgIcon",r.lcZ(10,15,t.isPreview$)?"plus":t.added?"delete":"plus"),r.xp6(4),r.Q6J("ngIf",r.lcZ(14,17,t.layerLegendShown$)&&r.lcZ(15,19,t.igoLayer$)&&t.catalogAllowLegend))},directives:[l.Tg,h.O5,Re.X2,h.mk,p.gM,Tl,n.lW,a.Hw,Ye.k,Po,l.eA,hp],pipes:[j.X$,h.Ov],styles:[".igo-cataloglayer-title[_ngcontent-%COMP%]{cursor:pointer}.igo-cataloglayer-legend-container[_ngcontent-%COMP%]{padding-left:18px;width:calc(100% - 18px);margin-left:40px}.igo-cataloglayer-external-icon[_ngcontent-%COMP%]{cursor:help}"],changeDetection:0}),e})();function bp(e,t){1&e&&(r.TgZ(0,"mat-icon",9),r.NdJ("click",function(e){return e.stopPropagation()}),r.ALo(1,"translate"),r.qZA()),2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.catalog.externalProvider.group"))}function xp(e,t){if(1&e&&(r.TgZ(0,"button",7),r.YNc(1,bp,2,3,"mat-icon",8),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf",e.group.externalProvider)}}function wp(e,t){if(1&e){const e=r.EpF();r.ynx(0),r.TgZ(1,"button",10),r.NdJ("click",function(){return r.CHM(e),r.oxw().onToggleClick()}),r.ALo(2,"translate"),r.ALo(3,"async"),r._UZ(4,"mat-icon",11),r.qZA(),r.BQk()}if(2&e){const e=r.oxw();r.xp6(1),r.Q6J("matTooltip",r.lcZ(2,2,"igo.geo.catalog.group.removeFromMap"))("disabled",r.lcZ(3,4,e.disabled$))}}function Sp(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",12),r.NdJ("click",function(){return r.CHM(e),r.oxw().onToggleClick()}),r.ALo(1,"translate"),r.ALo(2,"async"),r._UZ(3,"mat-icon",13),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("matTooltip",r.lcZ(1,2,"igo.geo.catalog.group.addToMap"))("disabled",r.lcZ(2,4,e.disabled$))}}function Cp(e,t){1&e&&r.GkF(0)}function Tp(e,t){if(1&e){const e=r.EpF();r.ynx(0),r.TgZ(1,"igo-catalog-browser-layer",15),r.NdJ("addedLayerIsPreview",function(t){return r.CHM(e),r.oxw(2).onLayerPreview(t)})("addedChange",function(t){return r.CHM(e),r.oxw(2).onLayerAddedChange(t)}),r.qZA(),r.BQk()}if(2&e){const e=r.oxw().$implicit,t=r.oxw();r.xp6(1),r.Q6J("layer",e)("resolution",t.resolution)("catalogAllowLegend",t.catalogAllowLegend)("added",t.state.get(e).added)}}function Ap(e,t){if(1&e&&(r.YNc(0,Cp,1,0,"ng-container",14),r.YNc(1,Tp,2,4,"ng-container",14)),2&e){const e=t.$implicit,o=r.oxw();r.Q6J("ngIf",o.isGroup(e)),r.xp6(1),r.Q6J("ngIf",o.isLayer(e))}}let Lp=(()=>{class e{constructor(){this.store=new dt([]),this.added$=new C.X(!1),this.preview$=new C.X(!1),this.disabled$=new C.X(!1),this.collapsed=!0,this.catalogAllowLegend=!1,this.toggleCollapsed=!0,this.addedChange=new r.vpe,this.layerAddedChange=new r.vpe}get title(){return this.group.title}ngOnInit(){this.store.load(this.group.items),this.evaluateAdded(),this.evaluateDisabled(this.collapsed),void 0!==this.group.sortDirection&&this.store.view.sort({direction:this.group.sortDirection,valueAccessor:e=>e.title})}ngOnDestroy(){this.store.destroy()}isGroup(e){return e.type===Mu.Group}isLayer(e){return e.type===Mu.Layer}onToggleClick(){this.added$.value?this.remove():this.add()}onToggleCollapsed(e){this.evaluateDisabled(e)}onLayerAddedChange(e){this.layerAddedChange.emit(e),this.tryToggleGroup(e)}add(){this.added$.next(!0),this.addedChange.emit({added:!0,group:this.group})}remove(){this.added$.next(!1),this.addedChange.emit({added:!1,group:this.group})}onLayerPreview(e){this.preview$.next(e)}tryToggleGroup(e){const t=e.added,o=e.layer;this.store.view.all().filter(e=>e.id!==o.id).map(e=>this.state.get(e).added||!1).every(e=>e===t)?t?this.add():this.remove():!0===this.added$.value&&this.added$.next(!1)}evaluateAdded(){const e=this.store.all().every(e=>!0===(this.state.get(e).added||!1));this.added$.next(e)}evaluateDisabled(e){let t=!1;!1===this.toggleCollapsed&&(t=e),this.disabled$.next(t)}onTitleClick(){this.collapsed=!this.collapsed}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-catalog-browser-group"]],inputs:{catalog:"catalog",group:"group",collapsed:"collapsed",resolution:"resolution",catalogAllowLegend:"catalogAllowLegend",toggleCollapsed:"toggleCollapsed",state:"state"},outputs:{addedChange:"addedChange",layerAddedChange:"layerAddedChange"},decls:14,vars:14,consts:[["mat-list-avatar","","svgIcon","chevron-up","igoCollapse","",1,"igo-chevron",3,"target","collapsed","toggle"],["id","catalog-group-title","mat-line","","matTooltipShowDelay","500",1,"igo-catalog-group-title",3,"matTooltip","click"],["disabled","true","mat-icon-button","",4,"ngIf"],[4,"ngIf","ngIfElse"],["notadded",""],["items",""],["ngFor","",3,"ngForOf"],["disabled","true","mat-icon-button",""],["class","igo-cataloggroup-external-icon","tooltip-position","below","matTooltipShowDelay","500","color","primary","svgIcon","earth-arrow-right",3,"matTooltip","click",4,"ngIf"],["tooltip-position","below","matTooltipShowDelay","500","color","primary","svgIcon","earth-arrow-right",1,"igo-cataloggroup-external-icon",3,"matTooltip","click"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip","disabled","click"],["svgIcon","delete"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","disabled","click"],["svgIcon","plus"],[4,"ngIf"],["igoListItem","",3,"layer","resolution","catalogAllowLegend","added","addedLayerIsPreview","addedChange"]],template:function(e,t){if(1&e&&(r.TgZ(0,"mat-list-item"),r.TgZ(1,"mat-icon",0),r.NdJ("toggle",function(e){return t.onToggleCollapsed(e)}),r.qZA(),r.TgZ(2,"h4",1),r.NdJ("click",function(){return t.onTitleClick()}),r._uU(3),r.qZA(),r.YNc(4,xp,2,1,"button",2),r.YNc(5,wp,5,6,"ng-container",3),r.ALo(6,"async"),r.ALo(7,"async"),r.YNc(8,Sp,4,6,"ng-template",null,4,r.W1O),r.qZA(),r.TgZ(10,"div",null,5),r.YNc(12,Ap,2,2,"ng-template",6),r.ALo(13,"async"),r.qZA()),2&e){const e=r.MAs(9),o=r.MAs(11);r.xp6(1),r.Q6J("target",o)("collapsed",t.collapsed),r.xp6(1),r.Q6J("matTooltip",t.title),r.xp6(1),r.Oqu(t.title),r.xp6(1),r.Q6J("ngIf",t.group.externalProvider),r.xp6(1),r.Q6J("ngIf",r.lcZ(6,8,t.added$)&&!1===r.lcZ(7,10,t.preview$))("ngIfElse",e),r.xp6(7),r.Q6J("ngForOf",r.lcZ(13,12,t.store.view.all$()))}},directives:[l.Tg,a.Hw,l.eA,Do,Re.X2,p.gM,h.O5,h.sg,n.lW,vp,$i],pipes:[h.Ov,j.X$],styles:[".igo-catalog-group-title[_ngcontent-%COMP%]{cursor:pointer;opacity:.9}#catalog-group-title[_ngcontent-%COMP%]{font-weight:bold}.igo-cataloggroup-external-icon[_ngcontent-%COMP%]{cursor:help}"],changeDetection:0}),e})(),Zp=(()=>{class e{constructor(){this.sortAlpha=!1,this.onlyVisible=!1,this.onlyInRange=!1,this.keywordInitialized=!1,this.sortedAlphaInitialized=!1,this.onlyVisibleInitialized=!1,this.onlyInRangeInitialized=!1}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Fp(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-checkbox",9),r.NdJ("change",function(){return r.CHM(e),r.oxw().check()}),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("checked",e.layerCheck)}}const Op=function(e){return{disabled:e}};function Mp(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",10),r.NdJ("click",function(){return r.CHM(e),r.oxw().toggleVisibility()}),r.ALo(1,"translate"),r.ALo(2,"translate"),r._UZ(3,"mat-icon",11),r.ALo(4,"async"),r.ALo(5,"async"),r.ALo(6,"async"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("color",e.layer.visible?"primary":"default")("matTooltip",e.layer.visible?r.lcZ(1,5,"igo.geo.layer.hideLayer"):r.lcZ(2,7,"igo.geo.layer.showLayer")),r.xp6(3),r.Q6J("matBadgeHidden",r.lcZ(4,9,e.queryBadgeHidden$))("ngClass",r.VKq(15,Op,!1===r.lcZ(5,11,e.inResolutionRange$)))("svgIcon",r.lcZ(6,13,e.layer.visible$)?"eye":"eye-off")}}function Ip(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",12),r.NdJ("click",function(){return r.CHM(e),r.oxw().toggleVisibility()}),r.ALo(1,"translate"),r.ALo(2,"translate"),r._UZ(3,"mat-icon",11),r.ALo(4,"async"),r.ALo(5,"async"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("color",e.layer.visible?"primary":"default")("matTooltip",e.layer.visible?r.lcZ(1,5,"igo.geo.layer.hideLayer"):r.lcZ(2,7,"igo.geo.layer.showLayer")),r.xp6(3),r.Q6J("matBadgeHidden",r.lcZ(4,9,e.queryBadgeHidden$))("ngClass",r.VKq(13,Op,!1===r.lcZ(5,11,e.inResolutionRange$)))("svgIcon",e.layer.visible?"eye":"eye-off")}}function kp(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",13),r.NdJ("click",function(){return r.CHM(e),r.oxw().toggleLayerTool()}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",14),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.layer.moreOptions"))}function Pp(e,t){if(1&e&&r._UZ(0,"igo-layer-legend",15),2&e){const e=r.oxw();r.Q6J("layer",e.layer)("updateLegendOnResolutionChange",e.updateLegendOnResolutionChange)}}let _p=(()=>{class e{constructor(e,t,o,i){this.networkService=e,this.renderer=t,this.elRef=o,this.cdRef=i,this.focusedCls="igo-layer-item-focused",this.layerTool$=new C.X(!1),this.showLegend$=new C.X(!0),this.inResolutionRange$=new C.X(!0),this.queryBadgeHidden$=new C.X(!0),this._selectAll=!1,this.layers$=new C.X(void 0),this.toggleLegendOnVisibilityChange=!1,this.expandLegendIfVisible=!1,this.updateLegendOnResolutionChange=!1,this.orderable=!0,this.lowerDisabled=!1,this.raiseDisabled=!1,this.queryBadge=!1,this.action=new r.vpe(void 0),this.checkbox=new r.vpe}get activeLayer(){return this._activeLayer}set activeLayer(e){e&&this.layer&&e.id===this.layer.id&&!this.selectionMode?(this.layerTool$.next(!0),this.renderer.addClass(this.elRef.nativeElement,this.focusedCls)):this.renderer.removeClass(this.elRef.nativeElement,this.focusedCls)}get selectAll(){return this._selectAll}set selectAll(e){this._selectAll=e,!0===e&&(this.layerCheck=!0)}get layer(){return this._layer}set layer(e){this._layer=e,this.layers$.next(e)}get opacity(){return 100*this.layer.opacity}set opacity(e){this.layer.opacity=e/100}ngOnInit(){this.layer.visible&&this.expandLegendIfVisible&&!0===this.layer.firstLoadComponent&&(this.layer.firstLoadComponent=!1,this.layer.legendCollapsed=!1),this.toggleLegend(this.layer.legendCollapsed),this.updateQueryBadge(),this.resolution$$=this.layer.map.viewController.resolution$.subscribe(()=>{this.onResolutionChange()}),this.tooltipText=this.computeTooltip(),this.network$$=this.networkService.currentState().subscribe(e=>{this.state=e,this.onResolutionChange()}),this.layers$$=this.layers$.subscribe(()=>{this.layer&&this.layer.options.active&&(this.layerTool$.next(!0),this.renderer.addClass(this.elRef.nativeElement,this.focusedCls))}),this.changeDetection&&this.changeDetection.subscribe(()=>this.cdRef.detectChanges())}ngOnDestroy(){this.resolution$$.unsubscribe(),this.network$$.unsubscribe(),this.layers$$.unsubscribe()}toggleLegend(e){this.layer.legendCollapsed=e,this.showLegend$.next(!e)}toggleLegendOnClick(){this.toggleLegend(this.showLegend$.value)}toggleVisibility(){this.layer.visible=!this.layer.visible,this.toggleLegendOnVisibilityChange&&this.toggleLegend(!this.layer.visible),this.updateQueryBadge()}computeTooltip(){const e=this.layer.options;if(!e.tooltip)return this.layer.title;const t=e.tooltip,o=e.metadata;switch(e.tooltip.type){case Il.TITLE:return this.layer.title;case Il.ABSTRACT:return o&&o.abstract?o.abstract:this.layer.title;case Il.CUSTOM:return t&&t.text?t.text:this.layer.title;default:return this.layer.title}}onResolutionChange(){const e=this.layer.isInResolutionsRange;!1===e&&!0===this.updateLegendOnResolutionChange&&this.toggleLegend(!0),this.inResolutionRange$.next(e)}updateQueryBadge(){const e=!1===this.queryBadge||!1===this.layer.visible||!Nu(this.layer);this.queryBadgeHidden$.next(e)}toggleLayerTool(){this.layerTool$.next(!this.layerTool$.getValue()),!0===this.layerTool$.getValue()?this.renderer.addClass(this.elRef.nativeElement,this.focusedCls):this.renderer.removeClass(this.elRef.nativeElement,this.focusedCls),this.action.emit(this.layer)}check(){this.layerCheck=!this.layerCheck,this.checkbox.emit({layer:this.layer,check:this.layerCheck})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Ce),r.Y36(r.Qsj),r.Y36(r.SBq),r.Y36(r.sBO))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-layer-item"]],inputs:{activeLayer:"activeLayer",selectAll:"selectAll",layerCheck:"layerCheck",layer:"layer",toggleLegendOnVisibilityChange:"toggleLegendOnVisibilityChange",expandLegendIfVisible:"expandLegendIfVisible",updateLegendOnResolutionChange:"updateLegendOnResolutionChange",orderable:"orderable",lowerDisabled:"lowerDisabled",raiseDisabled:"raiseDisabled",queryBadge:"queryBadge",selectionMode:"selectionMode",changeDetection:"changeDetection"},outputs:{action:"action",checkbox:"checkbox"},decls:11,vars:9,consts:[[1,"igo-layer-list-item"],["class","layerCheck","mat-list-icon","",3,"checked","change",4,"ngIf"],["matLine","","matTooltipShowDelay","500",1,"igo-layer-title",3,"matTooltip","click"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"color","matTooltip","click",4,"ngIf"],["class","selection-eye","mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"color","matTooltip","click",4,"ngIf"],["class","actions-button","tooltip-position","below","matTooltipShowDelay","500","mat-icon-button","","color","primary",3,"matTooltip","click",4,"ngIf"],[1,"igo-layer-legend-container"],["legend",""],[3,"layer","updateLegendOnResolutionChange",4,"ngIf"],["mat-list-icon","",1,"layerCheck",3,"checked","change"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"color","matTooltip","click"],["matBadge","?","matBadgeColor","accent","matBadgeSize","small","matBadgePosition","after",3,"matBadgeHidden","ngClass","svgIcon"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",1,"selection-eye",3,"color","matTooltip","click"],["tooltip-position","below","matTooltipShowDelay","500","mat-icon-button","","color","primary",1,"actions-button",3,"matTooltip","click"],["svgIcon","dots-horizontal"],[3,"layer","updateLegendOnResolutionChange"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-list-item",0),r.YNc(1,Fp,1,1,"mat-checkbox",1),r.TgZ(2,"h4",2),r.NdJ("click",function(){return t.toggleLegendOnClick()}),r._uU(3),r.qZA(),r.YNc(4,Mp,7,17,"button",3),r.YNc(5,Ip,6,15,"button",4),r.YNc(6,kp,3,3,"button",5),r.qZA(),r.TgZ(7,"div",6,7),r.YNc(9,Pp,1,2,"igo-layer-legend",8),r.ALo(10,"async"),r.qZA()),2&e&&(r.xp6(1),r.Q6J("ngIf",t.selectionMode),r.xp6(1),r.Q6J("matTooltip",t.tooltipText),r.xp6(1),r.Oqu(t.layer.title),r.xp6(1),r.Q6J("ngIf",!t.selectionMode),r.xp6(1),r.Q6J("ngIf",t.selectionMode),r.xp6(1),r.Q6J("ngIf",!t.selectionMode),r.xp6(3),r.Q6J("ngIf",r.lcZ(10,7,t.showLegend$)))},styles:["[_nghost-%COMP%]{overflow:hidden}mat-list-item[_ngcontent-%COMP%]     .mat-list-item-content .layerCheck{align-self:baseline;width:16px;padding-right:0}.igo-layer-list-item[_ngcontent-%COMP%]{height:46px;clear:both}.igo-layer-title[_ngcontent-%COMP%]{cursor:pointer}.igo-layer-legend-container[_ngcontent-%COMP%]{padding-left:18px;width:calc(100% - 18px)}mat-icon.disabled[_ngcontent-%COMP%]{color:#00000061}mat-icon[matBadge][_ngcontent-%COMP%]     .mat-badge-content{font-size:12px}.selection-eye[_ngcontent-%COMP%]{padding-right:45px}"],changeDetection:0}),e})();var $p=(()=>{return(e=$p||($p={})).always="always",e.never="never",e.default="default",$p;var e})(),qp=(()=>{return(e=qp||(qp={})).ALL_VISIBLE="ALL_VISIBLE",e.ALL_HIDDEN="ALL_HIDDEN",e.MIXED="MIXED",e.NULL="NULL",qp;var e})(),Dp=(()=>{return(e=Dp||(Dp={})).Raise="raise",e.Lower="lower",Dp;var e})();const Ep=["igoLayerItemToolbar"];function Rp(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-layer-list-tool",6),r.NdJ("appliedFilterAndSort",function(t){return r.CHM(e),r.oxw().onAppliedFilterAndSortChange(t)})("selection",function(t){return r.CHM(e),r.oxw().toggleSelectionMode(t)}),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("layersAreAllVisible",e.layersAreAllVisible)("term",e.layerFilterAndSortOptions.keyword)("onlyVisible",e.layerFilterAndSortOptions.onlyVisible)("sortAlpha",e.layerFilterAndSortOptions.sortAlpha)}}function Up(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-list-item",7),r.TgZ(1,"mat-checkbox",8),r.NdJ("change",function(){return r.CHM(e),r.oxw().selectAll()}),r._uU(2),r.ALo(3,"translate"),r.ALo(4,"translate"),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(1),r.Q6J("color",!e.selectAllCheck&&e.layersChecked.length>0?"accent":"primary")("checked",e.selectAllCheck)("indeterminate",!e.selectAllCheck&&e.layersChecked.length>0),r.xp6(1),r.hij(" ",e.selectAllCheck?r.lcZ(3,4,"igo.geo.layer.deselectAll"):r.lcZ(4,6,"igo.geo.layer.selectAll")," ")}}function Np(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-layer-item",10),r.NdJ("action",function(t){return r.CHM(e),r.oxw(2).toggleLayerTool(t)})("checkbox",function(t){return r.CHM(e),r.oxw(2).layersCheck(t)}),r.qZA()}if(2&e){const e=r.oxw().$implicit,t=r.oxw();r.Q6J("layer",e)("activeLayer",t.activeLayer)("orderable",t.orderable&&!e.baseLayer)("lowerDisabled",t.getLowerLayer().id===e.id)("raiseDisabled",t.getUpperLayer().id===e.id)("queryBadge",t.queryBadge)("expandLegendIfVisible",t.expandLegendOfVisibleLayers)("updateLegendOnResolutionChange",t.updateLegendOnResolutionChange)("toggleLegendOnVisibilityChange",t.toggleLegendOnVisibilityChange)("selectionMode",t.selection)("selectAll",t.selectAllCheck)("layerCheck",e.options.check)("changeDetection",t.layerItemChangeDetection$)}}function Jp(e,t){if(1&e&&r.YNc(0,Np,1,13,"igo-layer-item",9),2&e){const e=t.$implicit,o=r.oxw();r.Q6J("ngIf",!(o.excludeBaseLayers&&e.baseLayer))}}function Bp(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",26),r.NdJ("click",function(){return r.CHM(e),r.oxw(2).removeLayers()}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",27),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.layer.removeLayer"))}function jp(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",28),r.NdJ("click",function(){r.CHM(e);const t=r.oxw(2);return t.zoomLayerExtents(t.activeLayer)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",29),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.layer.zoomLayer"))}const Qp=function(e){return{layer:e}};function Gp(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-panel",11),r.TgZ(1,"div",12),r.YNc(2,Bp,3,3,"button",13),r.TgZ(3,"button",14),r.NdJ("click",function(){r.CHM(e);const t=r.oxw();return t.moveActiveLayer(t.activeLayer,t.layerListDisplacement.Lower)}),r.ALo(4,"translate"),r.ALo(5,"translate"),r._UZ(6,"mat-icon",15),r.qZA(),r.TgZ(7,"button",16),r.NdJ("click",function(){r.CHM(e);const t=r.oxw();return t.moveActiveLayer(t.activeLayer,t.layerListDisplacement.Raise)}),r.ALo(8,"translate"),r.ALo(9,"translate"),r._UZ(10,"mat-icon",17),r.qZA(),r.TgZ(11,"button",18),r.ALo(12,"translate"),r._UZ(13,"mat-icon",19),r.qZA(),r.TgZ(14,"mat-menu",20,21),r.TgZ(16,"div",22),r.TgZ(17,"mat-slider",23),r.NdJ("input",function(t){return r.CHM(e),r.oxw().changeOpacity(t)})("click",function(e){return e.stopPropagation()}),r.ALo(18,"translate"),r.qZA(),r.qZA(),r.qZA(),r.YNc(19,jp,3,3,"button",24),r.GkF(20,25),r.Hsn(21),r.qZA(),r.qZA()}if(2&e){const e=r.MAs(15),t=r.oxw();r.Q6J("title",t.activeLayer.title),r.xp6(2),r.Q6J("ngIf",t.isLayerRemovable(t.activeLayer)),r.xp6(1),r.Q6J("matTooltip",t.sortAlpha||t.onlyVisible||t.keyword?r.lcZ(4,20,"igo.geo.layer.filterLowerLayer"):r.lcZ(5,22,"igo.geo.layer.lowerLayer"))("disabled",t.lowerDisabled),r.xp6(3),r.Q6J("matBadge",t.sortAlpha||t.onlyVisible||t.keyword?"!":"")("matBadgeHidden",t.lowerDisabled),r.xp6(1),r.Q6J("matTooltip",t.sortAlpha||t.onlyVisible||t.keyword?r.lcZ(8,24,"igo.geo.layer.filterRaiseLayer"):r.lcZ(9,26,"igo.geo.layer.raiseLayer"))("disabled",t.raiseDisabled),r.xp6(3),r.Q6J("matBadge",t.sortAlpha||t.onlyVisible||t.keyword?"!":"")("matBadgeHidden",t.raiseDisabled),r.xp6(1),r.Q6J("matMenuTriggerFor",e)("matTooltip",r.lcZ(12,28,"igo.geo.layer.opacity")),r.xp6(2),r.Q6J("matBadge",t.badgeOpacity),r.xp6(4),r.Q6J("min",0)("max",100)("value",t.opacity)("matTooltip",r.lcZ(18,30,"igo.geo.layer.opacity")),r.xp6(2),r.Q6J("ngIf",t.activeLayerIsValid(t.activeLayer)),r.xp6(1),r.Q6J("ngTemplateOutlet",t.templateLayerToolbar)("ngTemplateOutletContext",r.VKq(32,Qp,t.activeLayer))}}function Yp(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-slider",38),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw(2).checkOpacity=t})("click",function(e){return e.stopPropagation()}),r.ALo(1,"translate"),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("min",0)("max",100)("ngModel",e.checkOpacity)("matTooltip",r.lcZ(1,4,"igo.geo.layer.opacity"))}}function zp(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",28),r.NdJ("click",function(){r.CHM(e);const t=r.oxw(2);return t.zoomLayersExtents(t.layersChecked)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",39),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.layer.zoomLayers"))}function Hp(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-panel",11),r.ALo(1,"translate"),r.TgZ(2,"div",30),r.TgZ(3,"button",31),r.NdJ("click",function(){r.CHM(e);const t=r.oxw();return t.removeLayers(t.layersChecked)}),r.ALo(4,"translate"),r.ALo(5,"translate"),r._UZ(6,"mat-icon",32),r.qZA(),r.TgZ(7,"button",33),r.NdJ("click",function(){r.CHM(e);const t=r.oxw();return t.toggleVisibility(t.layersChecked)}),r.ALo(8,"translate"),r.ALo(9,"translate"),r._UZ(10,"mat-icon",34),r.qZA(),r.TgZ(11,"button",14),r.NdJ("click",function(){r.CHM(e);const t=r.oxw();return t.lowerLayers(t.layersChecked)}),r.ALo(12,"translate"),r.ALo(13,"translate"),r._UZ(14,"mat-icon",15),r.qZA(),r.TgZ(15,"button",16),r.NdJ("click",function(){r.CHM(e);const t=r.oxw();return t.raiseLayers(t.layersChecked)}),r.ALo(16,"translate"),r.ALo(17,"translate"),r._UZ(18,"mat-icon",17),r.qZA(),r.TgZ(19,"button",35),r.ALo(20,"translate"),r._UZ(21,"mat-icon",36),r.qZA(),r.TgZ(22,"mat-menu",20,21),r.TgZ(24,"div",22),r.YNc(25,Yp,2,6,"mat-slider",37),r.qZA(),r.qZA(),r.YNc(26,zp,3,3,"button",24),r.qZA(),r.qZA()}if(2&e){const e=r.MAs(23),t=r.oxw();r.Q6J("title",r.lcZ(1,21,"igo.geo.layer.tools")),r.xp6(3),r.Q6J("disabled",0===t.layersChecked.length)("matTooltip",t.isAllLayersRemovable(t.layersChecked)?r.lcZ(4,23,"igo.geo.layer.removeSelectedLayers"):r.lcZ(5,25,"igo.geo.layer.removeSelectedLayersRestriction")),r.xp6(3),r.Q6J("matBadge","!")("matBadgeHidden",t.isAllLayersRemovable(t.layersChecked)),r.xp6(1),r.Q6J("disabled",0===t.layersChecked.length)("matTooltip","ALL_HIDDEN"===t.statusSelectedLayersCheck?r.lcZ(8,27,"igo.geo.layer.showSelectedLayers"):r.lcZ(9,29,"igo.geo.layer.hideSelectedLayers")),r.xp6(3),r.Q6J("svgIcon","ALL_HIDDEN"===t.statusSelectedLayersCheck?"eye-off":"eye"),r.xp6(1),r.Q6J("matTooltip",t.sortAlpha||t.onlyVisible||t.keyword?r.lcZ(12,31,"igo.geo.layer.filterLowerLayer"):r.lcZ(13,33,"igo.geo.layer.lowerLayer"))("disabled",t.lowerDisabledSelection),r.xp6(3),r.Q6J("matBadge",t.sortAlpha||t.onlyVisible||t.keyword?"!":"")("matBadgeHidden",t.lowerDisabledSelection),r.xp6(1),r.Q6J("matTooltip",t.sortAlpha||t.onlyVisible||t.keyword?r.lcZ(16,35,"igo.geo.layer.filterRaiseLayer"):r.lcZ(17,37,"igo.geo.layer.raiseLayer"))("disabled",t.raiseDisabledSelection),r.xp6(3),r.Q6J("matBadge",t.sortAlpha||t.onlyVisible||t.keyword?"!":"")("matBadgeHidden",t.raiseDisabledSelection),r.xp6(1),r.Q6J("disabled",0===t.layersChecked.length)("matMenuTriggerFor",e)("matTooltip",r.lcZ(20,39,"igo.geo.layer.opacity")),r.xp6(6),r.Q6J("ngIf",t.layersChecked.length),r.xp6(1),r.Q6J("ngIf",0!==t.layersChecked.length&&t.activeLayersAreValid(t.layersChecked))}}const Vp=[[["","igoLayerItemToolbar",""]]],Wp=function(e,t,o){return{"igo-list-tools-multi":e,"igo-list-tools-single":t,"igo-list-no-tools":o}},Xp=["[igoLayerItemToolbar]"];let Kp=(()=>{class e{constructor(e){this.elRef=e,this.orderable=!0,this.thresholdToFilterAndSort=5,this.layers$=new C.X([]),this.change$=new Ae.t(1),this.showToolbar$=new C.X(!1),this.hideSelectedLayers=!0,this.activeLayer$=new C.X(void 0),this.layersChecked=[],this.layerItemChangeDetection$=new C.X(void 0),this.layersAreAllVisible=!0,this.ogcButton=!0,this.timeButton=!0,this.floatLabel="auto",this.layerFilterAndSortOptions={},this.excludeBaseLayers=!1,this.toggleLegendOnVisibilityChange=!1,this.expandLegendOfVisibleLayers=!1,this.updateLegendOnResolutionChange=!1,this.queryBadge=!1,this.appliedFilterAndSort=new r.vpe,this._keyword=void 0,this._onlyVisible=!1,this._sortedAlpha=!1,this.toggleOpacity=!1,this.selectAllCheck$=new C.X(void 0)}get map(){return this._map}set map(e){this._map=e}set layers(e){this._layers=this.removeProblemLayerInList(e),this.next()}get layers(){return this._layers}set activeLayer(e){this._activeLayer=e,this.activeLayer$.next(e)}get activeLayer(){return this._activeLayer}get keyword(){return this._keyword}set keyword(e){this._keyword=e,this.next()}get onlyVisible(){return this._onlyVisible}set onlyVisible(e){this._onlyVisible=e,this.next()}get sortAlpha(){return this._sortedAlpha}set sortAlpha(e){this._sortedAlpha=e,this.next()}get opacity(){return Math.round(100*this.activeLayer$.getValue().opacity)}set opacity(e){this.activeLayer$.getValue().opacity=e/100}get badgeOpacity(){if(100!==this.opacity)return this.opacity}get raiseDisabled(){return!(this.orderable&&!this.activeLayer.baseLayer&&this.getUpperLayer().id!==this.activeLayer.id&&!this.isUpperBaselayer(this.activeLayer))}get lowerDisabled(){return!(this.orderable&&!this.activeLayer.baseLayer&&this.getLowerLayer().id!==this.activeLayer.id&&!this.isLowerBaselayer(this.activeLayer))}get raiseDisabledSelection(){return 0===this.layersChecked.length||!this.orderable||!this.raisableLayers(this.layersChecked)||!0===this.selectAllCheck}get lowerDisabledSelection(){return 0===this.layersChecked.length||!this.orderable||!this.lowerableLayers(this.layersChecked)||!0===this.selectAllCheck}get checkOpacity(){return 100*this.layersCheckedOpacity()}set checkOpacity(e){for(const t of this.layersChecked)t.opacity=e/100}get layerListDisplacement(){return Dp}ngOnInit(){this.change$$=this.change$.pipe((0,An.D)(()=>0===this.layers.length?xn.E:(0,wn.H)(50))).subscribe(()=>{this.showToolbar$.next(this.computeShowToolbar()),this.layers$.next(this.computeLayers(this.layers.slice(0))),this.appliedFilterAndSort.emit({keyword:this.keyword,sortAlpha:this.sortAlpha,onlyVisible:this.onlyVisible})}),this.selectAllCheck$$=this.selectAllCheck$.subscribe(e=>{this.selectAllCheck=e}),this.layers$$=this.layers$.subscribe(()=>{if(this.layers){let e=0;for(const t of this.layers)t.status$.subscribe(e=>{0===e&&this.map.removeLayer(t)}),t.options.active&&(this.activeLayer=t,this.layerTool=!0),t.options.check&&(e+=1);this.selectAllCheck=this.excludeBaseLayers?e===this.layers.filter(e=>!0!==e.baseLayer&&e.showInLayerList).length:e===this.layers.filter(e=>e.showInLayerList).length}})}ngOnDestroy(){this.change$$.unsubscribe(),this.selectAllCheck$$.unsubscribe(),this.layers$$.unsubscribe()}activeLayerIsValid(e){let t=!1;const o=e.options.extent,i=this.map.viewController.maxLayerZoomExtent;return o&&(t=!i||zn.r4(i,o)),t}activeLayersAreValid(e){let t=!1;const o=zn.lJ(),i=this.map.viewController.maxLayerZoomExtent;for(const r of e){const e=r.options.extent;e&&!e.includes(1/0)&&zn.l7(o,e)}return zn.xb(o)||(t=!i||zn.r4(i,o)),t}zoomLayerExtents(e){this.map.viewController.zoomToExtent(e.options.extent)}zoomLayersExtents(e){const t=zn.lJ();for(const o of e){const e=o.options.extent;e&&zn.l7(t,e)}this.map.viewController.zoomToExtent(t)}changeOpacity(e){this.opacity=e.value}clearKeyword(){this.keyword=void 0}getLowerLayer(){return this.layers.filter(e=>!e.baseLayer).reduce((e,t)=>e.zIndex<t.zIndex?e:t,{zIndex:void 0,id:void 0})}isLowerBaselayer(e){const t=this.layers.findIndex(t=>e.id===t.id);return!(!this.layers||!this.layers[t+1]||!0!==this.layers[t+1].baseLayer)}getUpperLayer(){return this.layers.filter(e=>!e.baseLayer).reduce((e,t)=>e.zIndex>t.zIndex?e:t,{zIndex:void 0,id:void 0})}isUpperBaselayer(e){const t=this.layers.findIndex(t=>e.id===t.id);return!(!this.layers||!this.layers[t-1]||!0!==this.layers[t-1].baseLayer)}moveActiveLayer(e,t){const o=[e],i=[];this.getLinkedLayers(e,o),this.layers.map(e=>{-1!==o.indexOf(e)&&i.push(e)}),t===Dp.Raise?this.raiseLayers(i,!1):t===Dp.Lower&&this.lowerLayers(i,!1)}getLinkedLayers(e,t){const o=e.options.linkedLayers;if(!o)return;const i=o.linkId,r=o.links;r?r.map(e=>{!e.properties||-1===e.properties.indexOf(Ml.ZINDEX)||e.linkedIds.map(e=>{const o=this.layers.find(t=>{var o;return(null===(o=t.options.linkedLayers)||void 0===o?void 0:o.linkId)===e});o&&(t.includes(o)||t.push(o))})}):this.layers.map(e=>{var o;(null===(o=e.options.linkedLayers)||void 0===o?void 0:o.links)&&e.options.linkedLayers.links.map(o=>{var r;-1!==(null===(r=o.properties)||void 0===r?void 0:r.indexOf(Ml.ZINDEX))&&!1!==o.bidirectionnal&&-1!==o.linkedIds.indexOf(i)&&(t.push(e),this.getLinkedLayers(e,t))})})}raisableLayers(e){let t=!1,o=0;for(const i of e){const r=this.layers.findIndex(e=>i.id===e.id),s=this.layers[r];s.baseLayer&&(o+=1);const n=this.layers[r-1];n&&!0!==n.baseLayer&&!e.find(e=>n.id===e.id)&&!0!==s.baseLayer&&(t=!0)}return(1===this.layersChecked.length&&this.layersChecked[0].baseLayer||o===this.layersChecked.length)&&(t=!1),t}raisableLayer(e){return!(e<1)&&(!this.layers[e-1].options.check||this.raisableLayer(e-1))}raiseLayers(e,t=!0){const o=[];for(const i of e){const e=this.layers.findIndex(e=>e.id===i.id);this.raisableLayer(e)&&o.push(i)}this.map.raiseLayers(o),t&&setTimeout(()=>{const e=this.computeElementRef();this.isScrolledIntoView(e[0],e[1].offsetParent)||(e[0].scrollTop=e[1].offsetParent.offsetTop)},100)}lowerableLayers(e){let t=!1,o=0;for(const i of e){const r=this.layers.findIndex(e=>i.id===e.id);this.layers[r].baseLayer&&(o+=1);const s=this.layers[r+1];s&&!0!==s.baseLayer&&!e.find(e=>s.id===e.id)&&(t=!0)}return(1===this.layersChecked.length&&this.layersChecked[0].baseLayer||o===this.layersChecked.length)&&(t=!1),t}lowerableLayer(e){return!(e>this.layers.filter(e=>!0!==e.baseLayer).length-2)&&(!this.layers[e+1].options.check||this.lowerableLayer(e+1))}lowerLayers(e,t=!0){const o=[];for(const i of e){const e=this.layers.findIndex(e=>e.id===i.id);this.lowerableLayer(e)&&o.push(i)}this.map.lowerLayers(o),t&&setTimeout(()=>{const e=this.computeElementRef("lower");this.isScrolledIntoView(e[0],e[1].offsetParent)||(e[0].scrollTop=e[1].offsetParent.offsetTop+e[1].offsetParent.offsetHeight-e[0].clientHeight)},100)}next(){this.change$.next()}computeLayers(e){let t=this.filterLayers(e);return t=this.sortAlpha?this.sortLayersByTitle(t):this.sortLayersByZindex(t),t}onKeywordChange(e){this.keyword=e}onAppliedFilterAndSortChange(e){this.keyword=e.keyword,this.onlyVisible=e.onlyVisible,this.sortAlpha=e.sortAlpha}filterLayers(e){if(this.layerFilterAndSortOptions.showToolbar===$p.never||!this.keyword&&!this.onlyVisible)return e;const t=e.map(e=>e.id);return e.forEach(e=>{const o=e.dataSource.options||{},i=(((e.options||{}).metadata||{}).keywordList||[]).map(e=>e.normalize("NFD").replace(/[\u0300-\u036f]/g,""));if(this.keyword&&e.title){const r=this.keyword.normalize("NFD").replace(/[\u0300-\u036f]/g,""),s=e.title.normalize("NFD").replace(/[\u0300-\u036f]/g,""),n=o.type||"",a=new RegExp(r,"gi"),l=void 0!==i.find(e=>a.test(e));if(!a.test(s)&&this.keyword.toLowerCase()!==n.toLowerCase()&&!l){const o=t.indexOf(e.id);o>-1&&t.splice(o,1)}}if(this.onlyVisible&&!1===e.visible){const o=t.indexOf(e.id);o>-1&&t.splice(o,1)}}),e.filter(e=>-1!==t.indexOf(e.id))}sortLayersByZindex(e){return e.sort((e,t)=>t.zIndex-e.zIndex)}sortLayersByTitle(e){return e.sort((e,t)=>this.normalize(e.title)<this.normalize(t.title)?-1:this.normalize(e.title)>this.normalize(t.title)?1:0)}normalize(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}computeShowToolbar(){switch(this.layerFilterAndSortOptions.showToolbar){case $p.always:return!0;case $p.never:return!1;default:return!!(this.layers.length>=this.thresholdToFilterAndSort||this.keyword||this.onlyVisible)}}toggleLayerTool(e){this.toggleOpacity=!1,this.layerTool=!this.layerTool||e!==this.activeLayer;for(const t of this.layers)t.options.active=!1;e.options.active=!0,this.activeLayer=e}removeLayers(e){if(e&&e.length>0){this.layersChecked=[];for(const t of e)!1!==t.options.removable?t.map.removeLayer(t):this.layersChecked.push(t)}else!e&&!1!==this.activeLayer.options.removable&&(this.activeLayer.map.removeLayer(this.activeLayer),this.layerTool=!1)}toggleVisibility(e){if(e&&e.length>0)for(const t of e)t.visible=this.hideSelectedLayers;this.layerItemChangeDetection$.next(!0)}isLayerRemovable(e){return!1!==e.options.removable}isAllLayersRemovable(e){return e.every(e=>this.isLayerRemovable(e))}get statusSelectedLayersCheck(){let e=qp.NULL,t=!1,o=!1;if(0===this.layersChecked.length)e=qp.NULL;else{e=qp.MIXED,this.hideSelectedLayers=!1;for(const e of this.layersChecked)!0===e.visible&&(t=!0),!1===e.visible&&(o=!0);!0===t&&!1===o&&(e=qp.ALL_VISIBLE),!1===t&&!0===o&&(e=qp.ALL_HIDDEN,this.hideSelectedLayers=!0)}return e}layersCheck(e){if(e.layer.options.check=e.check,!0===e.check){const t=this.layers.findIndex(t=>e.layer.id===t.id);for(const o of this.layersChecked)if(t<this.layers.findIndex(e=>o.id===e.id))return this.layersChecked.splice(this.layersChecked.findIndex(e=>o.id===e.id),0,e.layer),void(this.excludeBaseLayers?this.selectAllCheck=this.layersChecked.length===this.layers.filter(e=>!0!==e.baseLayer&&e.showInLayerList).length:this.excludeBaseLayers||(this.selectAllCheck=this.layersChecked.length===this.layers.filter(e=>e.showInLayerList).length));this.layersChecked.push(e.layer)}else{const t=this.layersChecked.findIndex(t=>e.layer.id===t.id);this.layersChecked.splice(t,1)}this.excludeBaseLayers?this.selectAllCheck=this.layersChecked.length===this.layers.filter(e=>!0!==e.baseLayer&&e.showInLayerList).length:this.excludeBaseLayers||(this.selectAllCheck=this.layersChecked.length===this.layers.filter(e=>e.showInLayerList).length)}toggleSelectionMode(e){if(this.selection=e,this.activeLayer=void 0,!0===e){this.layerTool=!1;for(const e of this.layers)e.options.check&&this.layersChecked.push(e)}}layersCheckedOpacity(){if(this.layersChecked.length>1)return 1;{const e=[];for(const t of this.layersChecked)e.push(t.opacity);return e}}selectAll(){if(this.selectAllCheck){for(const e of this.layers)e.options.check=!1;this.layersChecked=[],this.selectAllCheck$.next(!1)}else{for(const e of this.layers)(this.excludeBaseLayers&&!0!==e.baseLayer&&e.showInLayerList||!this.excludeBaseLayers&&e.showInLayerList)&&(e.options.check=!0,this.layersChecked.push(e));this.selectAllCheck$.next(!0)}}isScrolledIntoView(e,t){const o=e.scrollTop,i=t.offsetTop;return i+t.clientHeight<=o+e.clientHeight&&i>=o}computeElementRef(e){const t=this.elRef.nativeElement.getElementsByClassName("mat-checkbox-checked"),o="lower"===e?this.elRef.nativeElement.getElementsByClassName("mat-checkbox-checked")[t.length-1]:this.elRef.nativeElement.getElementsByClassName("mat-checkbox-checked")[0];return[this.elRef.nativeElement.getElementsByTagName("igo-list")[0],o]}removeProblemLayerInList(e){for(const t of e)!0===t.olLoadingProblem&&this.map.removeLayer(t);return e}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.SBq))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-layer-list"]],contentQueries:function(e,t,o){if(1&e&&r.Suo(o,Ep,5),2&e){let e;r.iGM(e=r.CRH())&&(t.templateLayerToolbar=e.first)}},inputs:{layersAreAllVisible:"layersAreAllVisible",ogcButton:"ogcButton",timeButton:"timeButton",map:"map",layers:"layers",floatLabel:"floatLabel",layerFilterAndSortOptions:"layerFilterAndSortOptions",excludeBaseLayers:"excludeBaseLayers",toggleLegendOnVisibilityChange:"toggleLegendOnVisibilityChange",expandLegendOfVisibleLayers:"expandLegendOfVisibleLayers",updateLegendOnResolutionChange:"updateLegendOnResolutionChange",queryBadge:"queryBadge"},outputs:{appliedFilterAndSort:"appliedFilterAndSort"},ngContentSelectors:Xp,decls:11,vars:16,consts:[["floatLabel","auto",3,"layersAreAllVisible","term","onlyVisible","sortAlpha","appliedFilterAndSort","selection",4,"ngIf"],["class","select-all",4,"ngIf"],[3,"ngClass","navigation","selection"],["igoList",""],["ngFor","",3,"ngForOf"],["class","igo-layer-actions-container",3,"title",4,"ngIf"],["floatLabel","auto",3,"layersAreAllVisible","term","onlyVisible","sortAlpha","appliedFilterAndSort","selection"],[1,"select-all"],[1,"select-all-checkbox","mat-subheading-2",3,"color","checked","indeterminate","change"],["igoListItem","",3,"layer","activeLayer","orderable","lowerDisabled","raiseDisabled","queryBadge","expandLegendIfVisible","updateLegendOnResolutionChange","toggleLegendOnVisibilityChange","selectionMode","selectAll","layerCheck","changeDetection","action","checkbox",4,"ngIf"],["igoListItem","",3,"layer","activeLayer","orderable","lowerDisabled","raiseDisabled","queryBadge","expandLegendIfVisible","updateLegendOnResolutionChange","toggleLegendOnVisibilityChange","selectionMode","selectAll","layerCheck","changeDetection","action","checkbox"],[1,"igo-layer-actions-container",3,"title"],[1,"igo-layer-button-group"],["class","delete-button","mat-icon-button","","color","warn","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","color","primary","tooltip-position","below","matTooltipShowDelay","500",1,"down-button",3,"matTooltip","disabled","click"],["matBadgeColor","warn","matBadgeSize","medium","svgIcon","arrow-down",3,"matBadge","matBadgeHidden"],["color","primary","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",1,"up-button",3,"matTooltip","disabled","click"],["matBadgeColor","warn","matBadgeSize","medium","svgIcon","arrow-up",3,"matBadge","matBadgeHidden"],["color","primary","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",1,"opacity-button",3,"matMenuTriggerFor","matTooltip"],["matBadgeColor","primary","matBadgeSize","medium","svgIcon","opacity",3,"matBadge"],[1,"mat-menu-opacity-slider"],["opacityMenu","matMenu"],["id","opacity-menu"],["id","opacity-slider","color","primary","thumbLabel","","tickInterval","5","step","5","matTooltipShowDelay","500","tooltip-position","below",3,"min","max","value","matTooltip","input","click"],["class","zoomLayer-button","color","primary","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","click",4,"ngIf"],["igoLayerItemToolbar","",3,"ngTemplateOutlet","ngTemplateOutletContext"],["mat-icon-button","","color","warn","tooltip-position","below","matTooltipShowDelay","500",1,"delete-button",3,"matTooltip","click"],["svgIcon","delete"],["color","primary","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",1,"zoomLayer-button",3,"matTooltip","click"],["matBadgeColor","primary","matBadgeSize","medium","svgIcon","magnify-scan"],[1,"actions-buttons-multi"],["mat-icon-button","","color","warn","tooltip-position","below","matTooltipShowDelay","500",1,"delete-button",3,"disabled","matTooltip","click"],["matBadgeColor","warn","matBadgeSize","medium","svgIcon","delete",3,"matBadge","matBadgeHidden"],["mat-icon-button","","color","primary","tooltip-position","below","matTooltipShowDelay","500",1,"eye-button",3,"disabled","matTooltip","click"],[3,"svgIcon"],["color","primary","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",1,"opacity-button",3,"disabled","matMenuTriggerFor","matTooltip"],["svgIcon","opacity"],["id","opacity-slider","color","primary","thumbLabel","","tickInterval","5","step","5","matTooltipShowDelay","500","tooltip-position","below",3,"min","max","ngModel","matTooltip","ngModelChange","click",4,"ngIf"],["id","opacity-slider","color","primary","thumbLabel","","tickInterval","5","step","5","matTooltipShowDelay","500","tooltip-position","below",3,"min","max","ngModel","matTooltip","ngModelChange","click"],["svgIcon","magnify-scan"]],template:function(e,t){1&e&&(r.F$t(Vp),r.TgZ(0,"mat-list"),r.YNc(1,Rp,1,4,"igo-layer-list-tool",0),r.ALo(2,"async"),r.qZA(),r.YNc(3,Up,5,8,"mat-list-item",1),r._UZ(4,"mat-divider"),r.TgZ(5,"igo-list",2,3),r.YNc(7,Jp,1,1,"ng-template",4),r.ALo(8,"async"),r.qZA(),r.YNc(9,Gp,22,34,"igo-panel",5),r.YNc(10,Hp,27,41,"igo-panel",5)),2&e&&(r.xp6(1),r.Q6J("ngIf",r.lcZ(2,8,t.showToolbar$)),r.xp6(2),r.Q6J("ngIf",t.selection),r.xp6(2),r.Q6J("ngClass",r.kEZ(12,Wp,t.selection,t.layerTool&&!t.selection,!t.layerTool&&!t.selection))("navigation",!1)("selection",!1),r.xp6(2),r.Q6J("ngForOf",r.lcZ(8,10,t.layers$)),r.xp6(2),r.Q6J("ngIf",!t.selection&&t.layerTool&&t.activeLayer),r.xp6(1),r.Q6J("ngIf",t.selection&&t.layers.length>0))},styles:["[_nghost-%COMP%]   .igo-list-no-tools[_ngcontent-%COMP%]{height:calc(100% - 57px);padding-top:8px}[_nghost-%COMP%]   .igo-list-tools-single[_ngcontent-%COMP%]{height:calc(100% - 153px);padding-top:8px}[_nghost-%COMP%]   .igo-list-tools-multi[_ngcontent-%COMP%]{height:calc(100% - 191px);padding-top:8px}mat-form-field.inputFilter[_ngcontent-%COMP%]{width:calc(100% - 100px);max-width:200px}.igo-layer-actions-container[_ngcontent-%COMP%]{width:calc(100% - 5px);padding-left:4px}.igo-layer-actions-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{text-align:center}mat-list-item[_ngcontent-%COMP%]     .mat-list-item-content{margin-bottom:10px}mat-checkbox[_ngcontent-%COMP%]     .mat-checkbox-inner-container{margin-left:8px;margin-right:16px}#opacity-slider[_ngcontent-%COMP%]{float:left;min-width:unset;width:110px;left:10px;top:10px}.igo-layer-button-group[_ngcontent-%COMP%], .actions-buttons-multi[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:row-reverse;overflow-x:auto}.igo-layer-button-group[_ngcontent-%COMP%]::-webkit-scrollbar, .actions-buttons-multi[_ngcontent-%COMP%]::-webkit-scrollbar{height:4px}.igo-layer-button-group[_ngcontent-%COMP%]::-webkit-scrollbar-track, .actions-buttons-multi[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1}.igo-layer-button-group[_ngcontent-%COMP%]::-webkit-scrollbar-thumb, .actions-buttons-multi[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#888}.igo-layer-button-group[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover, .actions-buttons-multi[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#555}.igo-layer-button-group[_ngcontent-%COMP%]{padding-top:5px}[_nghost-%COMP%]   igo-panel[_ngcontent-%COMP%]{height:unset}#opacity-menu[_ngcontent-%COMP%]{max-width:unset;width:132px;height:50px}#opacity-menu[_ngcontent-%COMP%]   .mat-menu-content[_ngcontent-%COMP%]:not(:empty){padding-top:20px}.select-all[_ngcontent-%COMP%]     .mat-list-item-content{margin:0}"],changeDetection:0}),e})();function ed(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",9),r.NdJ("click",function(){return r.CHM(e),r.oxw().clearTerm()}),r._UZ(1,"mat-icon",10),r.qZA()}}let td=(()=>{class e{constructor(){this.onlyVisible$=new C.X(!1),this.sortAlpha$=new C.X(!1),this.term$=new C.X(void 0),this.layersAreAllVisible=!0,this.floatLabel="auto",this.selectionMode=!1,this.appliedFilterAndSort=new r.vpe,this.selection=new r.vpe}set onlyVisible(e){this.onlyVisible$.next(e)}get onlyVisible(){return this.onlyVisible$.value}set sortAlpha(e){this.sortAlpha$.next(e)}get sortAlpha(){return this.sortAlpha$.value}set term(e){this.term$.next(e)}get term(){return this.term$.value}ngOnInit(){this.term$$=this.term$.subscribe(e=>{this.appliedFilterAndSort.emit({keyword:e,onlyVisible:this.onlyVisible,sortAlpha:this.sortAlpha})}),this.onlyVisible$$=this.onlyVisible$.subscribe(e=>{this.appliedFilterAndSort.emit({keyword:this.term,onlyVisible:e,sortAlpha:this.sortAlpha})}),this.sortAlpha$$=this.sortAlpha$.subscribe(e=>{this.appliedFilterAndSort.emit({keyword:this.term,onlyVisible:this.onlyVisible,sortAlpha:e})})}ngOnDestroy(){this.onlyVisible$$.unsubscribe(),this.sortAlpha$$.unsubscribe(),this.term$$.unsubscribe()}clearTerm(){this.term=void 0}toggleSortAlpha(){this.sortAlpha=!this.sortAlpha}toggleOnlyVisible(){this.onlyVisible=!this.onlyVisible}toggleSelectionMode(){this.selectionMode=!this.selectionMode,this.selection.emit(this.selectionMode)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-layer-list-tool"]],inputs:{layersAreAllVisible:"layersAreAllVisible",floatLabel:"floatLabel",onlyVisible:"onlyVisible",sortAlpha:"sortAlpha",term:"term"},outputs:{appliedFilterAndSort:"appliedFilterAndSort",selection:"selection"},decls:21,vars:30,consts:[[1,"inputFilter",3,"floatLabel"],["matInput","","matTooltipShowDelay","500","type","text",3,"placeholder","matTooltip","ngModel","ngModelChange"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear","color","warn",3,"click",4,"ngIf"],["matTooltipShowDelay","500",3,"matTooltip"],["mat-icon-button","",1,"sort-alpha",3,"color","click"],[3,"svgIcon"],["mat-icon-button","",1,"only-visible",3,"disabled","color","click"],["matBadge","icon","igoMatBadgeIcon","eye","igoMatBadgeInverseColor","true","igoMatBadgeInheritColor","true",3,"svgIcon"],["mat-icon-button","","color","primary",1,"selection-mode",3,"click"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear","color","warn",3,"click"],["svgIcon","close"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-list-item"),r.TgZ(1,"mat-form-field",0),r.TgZ(2,"input",1),r.NdJ("ngModelChange",function(e){return t.term=e}),r.ALo(3,"translate"),r.ALo(4,"translate"),r.qZA(),r.YNc(5,ed,2,0,"button",2),r.qZA(),r.TgZ(6,"div",3),r.ALo(7,"translate"),r.ALo(8,"translate"),r.TgZ(9,"button",4),r.NdJ("click",function(){return t.toggleSortAlpha()}),r._UZ(10,"mat-icon",5),r.qZA(),r.qZA(),r.TgZ(11,"div",3),r.ALo(12,"translate"),r.ALo(13,"translate"),r.TgZ(14,"button",6),r.NdJ("click",function(){return t.toggleOnlyVisible()}),r._UZ(15,"mat-icon",7),r.qZA(),r.qZA(),r.TgZ(16,"div",3),r.ALo(17,"translate"),r.ALo(18,"translate"),r.TgZ(19,"button",8),r.NdJ("click",function(){return t.toggleSelectionMode()}),r._UZ(20,"mat-icon",5),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.xp6(1),r.Q6J("floatLabel",t.floatLabel),r.xp6(1),r.Q6J("placeholder",r.lcZ(3,14,"igo.geo.layer.filterPlaceholder"))("matTooltip",r.lcZ(4,16,"igo.geo.layer.subsetLayersListKeyword"))("ngModel",t.term),r.xp6(3),r.Q6J("ngIf",t.term),r.xp6(1),r.Q6J("matTooltip",t.sortAlpha?r.lcZ(7,18,"igo.geo.layer.sortMapOrder"):r.lcZ(8,20,"igo.geo.layer.sortAlphabetically")),r.xp6(3),r.Q6J("color",t.sortAlpha?"warn":"primary"),r.xp6(1),r.Q6J("svgIcon",t.sortAlpha?"sort-ascending":"sort-alphabetical-ascending"),r.xp6(1),r.Q6J("matTooltip",t.onlyVisible?r.lcZ(12,22,"igo.geo.layer.resetLayersList"):r.lcZ(13,24,"igo.geo.layer.subsetLayersListOnlyVisible")),r.xp6(3),r.Q6J("disabled",t.layersAreAllVisible&&!t.onlyVisible)("color",t.onlyVisible?"warn":"primary"),r.xp6(1),r.Q6J("svgIcon",t.onlyVisible?"filter-remove":"filter"),r.xp6(1),r.Q6J("matTooltip",t.selectionMode?r.lcZ(17,26,"igo.geo.layer.deactivateSelectionMode"):r.lcZ(18,28,"igo.geo.layer.activateSelectionMode")),r.xp6(4),r.Q6J("svgIcon",t.selectionMode?"checkbox-multiple-marked-outline":"checkbox-multiple-blank-outline"))},directives:[l.Tg,De.KE,Ve.Nt,We.Fj,p.gM,We.JJ,We.On,h.O5,n.lW,a.Hw,Ye.k,Po,De.R9],pipes:[j.X$],styles:["mat-form-field.inputFilter[_ngcontent-%COMP%]{width:calc(100% - 100px);max-width:200px}.selection-mode[_ngcontent-%COMP%]{margin-left:5px}"],changeDetection:0}),e})(),od=(()=>{class e{constructor(e,t,o){this.mapService=t,this.route=o,this.component=e}ngOnInit(){this.layersOrResolutionChange$$=(0,L.aj)([this.mapService.getMap().layers$,this.mapService.getMap().viewController.resolution$]).pipe((0,w.b)(10)).subscribe(e=>{const t=e[0].filter(e=>!0===e.showInLayerList);this.component.layers=t,this.setLayersVisibilityStatus(t,this.component.excludeBaseLayers)})}setLayersVisibilityStatus(e,t){void 0!==this.layersVisibility$$&&(this.layersVisibility$$.unsubscribe(),this.layersVisibility$$=void 0),this.layersVisibility$$=(0,L.aj)(e.filter(e=>e.baseLayer!==t).map(e=>e.visible$)).pipe((0,x.U)(e=>e.every(Boolean))).subscribe(e=>this.component.layersAreAllVisible=e)}ngOnDestroy(){this.layersOrResolutionChange$$.unsubscribe(),void 0!==this.layersVisibility$$&&(this.layersVisibility$$.unsubscribe(),this.layersVisibility$$=void 0)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Kp,2),r.Y36(Pc),r.Y36(fe,8))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoLayerListBinding",""]]}),e})();function id(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-slide-toggle",6),r.NdJ("change",function(t){return r.CHM(e),r.oxw().toggleShowAllLegends(t.checked)}),r.ALo(1,"translate"),r._uU(2),r.ALo(3,"translate"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("matTooltip",r.lcZ(1,4,"igo.geo.layer.legend.showAll"))("checked",e.showAllLegendsValue)("labelPosition","before"),r.xp6(2),r.hij(" ",r.lcZ(3,6,"igo.geo.layer.legend.showAll")," ")}}function rd(e,t){1&e&&r._UZ(0,"mat-divider")}function sd(e,t){if(1&e&&r._UZ(0,"igo-layer-legend-item",8),2&e){const e=r.oxw().$implicit,t=r.oxw();r.Q6J("layer",e)("updateLegendOnResolutionChange",t.updateLegendOnResolutionChange)}}function nd(e,t){if(1&e&&r.YNc(0,sd,1,2,"igo-layer-legend-item",7),2&e){const e=t.$implicit,o=r.oxw();r.Q6J("ngIf",!(o.excludeBaseLayers&&e.baseLayer))}}function ad(e,t){1&e&&(r.TgZ(0,"p",9),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"igo.geo.layer.legend.noLayersVisibleWithShowAllButton")," "))}function ld(e,t){1&e&&(r.TgZ(0,"p",9),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"igo.geo.layer.legend.noLayersVisibleWithShowAllButtonButZoom")," "))}function cd(e,t){1&e&&(r.TgZ(0,"p",9),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"igo.geo.layer.legend.noLayersVisible")," "))}function ud(e,t){1&e&&(r.TgZ(0,"p",9),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"igo.geo.layer.legend.noLayersVisibleButZoom")," "))}let pd=(()=>{class e{constructor(){this.orderable=!0,this.hasVisibleOrInRangeLayers$=new C.X(!0),this.hasVisibleAndNotInRangeLayers$=new C.X(!0),this.layersInUi$=new C.X([]),this.layers$=new C.X([]),this.showAllLegend=!1,this.change$=new Ae.t(1),this.excludeBaseLayers=!1,this.updateLegendOnResolutionChange=!1,this.allowShowAllLegends=!1,this.showAllLegendsValue=!1,this.allLegendsShown=new r.vpe(!1)}set layers(e){this._layers=e,this.next()}get layers(){return this._layers}ngOnInit(){this.change$$=this.change$.pipe((0,An.D)(()=>0===this.layers.length?xn.E:(0,wn.H)(50))).subscribe(()=>{const e=this.computeShownLayers(this.layers.slice(0));this.layers$.next(e),this.hasVisibleOrInRangeLayers$.next(this.layers.slice(0).filter(e=>!0!==e.baseLayer).filter(e=>e.visible$.value&&e.isInResolutionsRange$.value).length>0),this.hasVisibleAndNotInRangeLayers$.next(this.layers.slice(0).filter(e=>!0!==e.baseLayer).filter(e=>e.visible$.value&&!e.isInResolutionsRange$.value).length>0),this.layersInUi$.next(this.layers.slice(0).filter(e=>!(!1===e.showInLayerList||this.excludeBaseLayers&&e.baseLayer)))})}ngOnDestroy(){this.change$$.unsubscribe()}next(){this.change$.next()}computeShownLayers(e){let t=e.filter(e=>e.visible&&e.isInResolutionsRange);return this.showAllLegendsValue&&(t=e),this.sortLayersByZindex(t)}sortLayersByZindex(e){return e.sort((e,t)=>t.zIndex-e.zIndex)}toggleShowAllLegends(e){this.showAllLegendsValue=e,this.next(),this.allLegendsShown.emit(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-layer-legend-list"]],inputs:{layers:"layers",excludeBaseLayers:"excludeBaseLayers",updateLegendOnResolutionChange:"updateLegendOnResolutionChange",allowShowAllLegends:"allowShowAllLegends",showAllLegendsValue:"showAllLegendsValue"},outputs:{allLegendsShown:"allLegendsShown"},decls:24,vars:39,consts:[[1,"layer-legend-list-container"],["tooltip-position","above","matTooltipShowDelay","500","class","mat-typography",3,"matTooltip","checked","labelPosition","change",4,"ngIf"],[4,"ngIf"],[3,"navigation","selection"],["ngFor","",3,"ngForOf"],["class","layers-empty mat-typography",4,"ngIf"],["tooltip-position","above","matTooltipShowDelay","500",1,"mat-typography",3,"matTooltip","checked","labelPosition","change"],["igoListItem","",3,"layer","updateLegendOnResolutionChange",4,"ngIf"],["igoListItem","",3,"layer","updateLegendOnResolutionChange"],[1,"layers-empty","mat-typography"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.YNc(1,id,4,8,"mat-slide-toggle",1),r.ALo(2,"async"),r.YNc(3,rd,1,0,"mat-divider",2),r.ALo(4,"async"),r.TgZ(5,"igo-list",3),r.YNc(6,nd,1,1,"ng-template",4),r.ALo(7,"async"),r.qZA(),r.YNc(8,ad,3,3,"p",5),r.ALo(9,"async"),r.ALo(10,"async"),r.ALo(11,"async"),r.YNc(12,ld,3,3,"p",5),r.ALo(13,"async"),r.ALo(14,"async"),r.ALo(15,"async"),r.YNc(16,cd,3,3,"p",5),r.ALo(17,"async"),r.ALo(18,"async"),r.ALo(19,"async"),r.YNc(20,ud,3,3,"p",5),r.ALo(21,"async"),r.ALo(22,"async"),r.ALo(23,"async"),r.qZA()),2&e&&(r.xp6(1),r.Q6J("ngIf",r.lcZ(2,9,t.layersInUi$).length&&t.allowShowAllLegends),r.xp6(2),r.Q6J("ngIf",r.lcZ(4,11,t.layersInUi$).length&&t.allowShowAllLegends),r.xp6(2),r.Q6J("navigation",!1)("selection",!1),r.xp6(1),r.Q6J("ngForOf",r.lcZ(7,13,t.layers$)),r.xp6(2),r.Q6J("ngIf",!t.showAllLegendsValue&&r.lcZ(9,15,t.layersInUi$).length&&!1===r.lcZ(10,17,t.hasVisibleOrInRangeLayers$)&&!1===r.lcZ(11,19,t.hasVisibleAndNotInRangeLayers$)&&t.allowShowAllLegends),r.xp6(4),r.Q6J("ngIf",!t.showAllLegendsValue&&r.lcZ(13,21,t.layersInUi$).length&&!1===r.lcZ(14,23,t.hasVisibleOrInRangeLayers$)&&r.lcZ(15,25,t.hasVisibleAndNotInRangeLayers$)&&t.allowShowAllLegends),r.xp6(4),r.Q6J("ngIf",r.lcZ(17,27,t.layersInUi$).length&&!1===r.lcZ(18,29,t.hasVisibleOrInRangeLayers$)&&!1===r.lcZ(19,31,t.hasVisibleAndNotInRangeLayers$)&&!t.allowShowAllLegends),r.xp6(4),r.Q6J("ngIf",r.lcZ(21,33,t.layersInUi$).length&&!1===r.lcZ(22,35,t.hasVisibleOrInRangeLayers$)&&r.lcZ(23,37,t.hasVisibleAndNotInRangeLayers$)&&!t.allowShowAllLegends))},styles:["mat-slide-toggle[_ngcontent-%COMP%]{width:100%;margin:10px}mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content{width:calc(100% - 60px)}igo-list[_ngcontent-%COMP%]{display:contents}.layers-empty[_ngcontent-%COMP%]{text-align:justify;margin:10px}.layer-legend-list-container[_ngcontent-%COMP%]{max-height:100%;overflow:auto}"],changeDetection:0}),e})();function dd(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",1),r.NdJ("click",function(){return r.CHM(e),r.oxw().toggleTrackFeature()}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",2),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("matTooltip",r.lcZ(1,2,"igo.geo.layer.trackFeature"))("color",e.color)}}let hd=(()=>{class e{constructor(){this.trackFeature=!1,this.color="primary"}get options(){if(this.layer)return this.layer.options}ngOnInit(){this.color=this.trackFeature?"primary":"basic"}toggleTrackFeature(){this.trackFeature?(this.layer.disableTrackFeature(this.layer.options.trackFeature),this.color="basic"):(this.layer.enableTrackFeature(this.layer.options.trackFeature),this.color="primary"),this.trackFeature=!this.trackFeature}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-track-feature-button"]],inputs:{layer:"layer",trackFeature:"trackFeature"},decls:1,vars:1,consts:[["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click"],["svgIcon","crosshairs-gps"]],template:function(e,t){1&e&&r.YNc(0,dd,3,4,"button",0),2&e&&r.Q6J("ngIf",t.options.trackFeature)},directives:[h.O5,n.lW,p.gM,a.Hw],pipes:[j.X$],styles:[""],changeDetection:0}),e})(),gd=(()=>{class e{constructor(e){this.networkService=e,this.inResolutionRange$=new C.X(!0),this.updateLegendOnResolutionChange=!1}ngOnInit(){this.resolution$$=this.layer.map.viewController.resolution$.subscribe(()=>{this.onResolutionChange()}),this.tooltipText=this.computeTooltip(),this.network$$=this.networkService.currentState().subscribe(e=>{this.state=e,this.onResolutionChange()})}ngOnDestroy(){this.resolution$$.unsubscribe(),this.network$$.unsubscribe()}computeTooltip(){const e=this.layer.options;if(!e.tooltip)return this.layer.title;const t=e.tooltip,o=e.metadata;switch(e.tooltip.type){case Il.TITLE:return this.layer.title;case Il.ABSTRACT:return o&&o.abstract?o.abstract:this.layer.title;case Il.CUSTOM:return t&&t.text?t.text:this.layer.title;default:return this.layer.title}}onResolutionChange(){this.inResolutionRange$.next(this.layer.isInResolutionsRange)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Ce))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-layer-legend-item"]],inputs:{layer:"layer",updateLegendOnResolutionChange:"updateLegendOnResolutionChange"},decls:6,vars:4,consts:[[1,"igo-layer-list-item"],["matLine","","matTooltipShowDelay","500",1,"igo-layer-title",3,"matTooltip"],[1,"igo-layer-legend-container"],["legend",""],[3,"layer","updateLegendOnResolutionChange"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-list-item",0),r.TgZ(1,"h4",1),r._uU(2),r.qZA(),r.qZA(),r.TgZ(3,"div",2,3),r._UZ(5,"igo-layer-legend",4),r.qZA()),2&e&&(r.xp6(1),r.Q6J("matTooltip",t.tooltipText),r.xp6(1),r.Oqu(t.layer.title),r.xp6(3),r.Q6J("layer",t.layer)("updateLegendOnResolutionChange",t.updateLegendOnResolutionChange))},styles:["[_nghost-%COMP%]{overflow:hidden}.igo-layer-list-item[_ngcontent-%COMP%]{height:46px;clear:both}.igo-layer-legend-container[_ngcontent-%COMP%]{padding-left:18px;width:calc(100% - 18px)}"],changeDetection:0}),e})(),md=(()=>{class e{static forRoot(){return{ngModule:e,providers:[Cu,eu,Zp]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[Ve.c,De.lN,h.ez,We.u5,Ha.t,f.Tx,a.Ps,n.ot,Va.rP,Ee.LD,p.AV,l.ie,Wa.KP,Ye.g,m.p9,ne,Ri,Uo,Ci,ji,_o]]}),e})();r.B6R(_p,[l.Tg,h.O5,m.oG,l.Nh,Re.X2,p.gM,n.lW,a.Hw,Ye.k,h.mk,hp],[j.X$,h.Ov]),r.B6R(gd,[l.Tg,Re.X2,p.gM,hp],[]),r.B6R(Kp,[l.i$,h.O5,td,l.Tg,m.oG,Ha.d,Ei,h.mk,h.sg,_p,$i,Bi,n.lW,p.gM,a.Hw,Ye.k,f.p6,f.VK,Wa.pH,h.tP,We.JJ,We.On],[h.Ov,j.X$]),r.B6R(pd,[h.O5,Va.Rr,p.gM,Ha.d,Ei,h.sg,gd,$i],[j.X$,h.Ov]);let fd=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,Ye.g,n.ot,a.Ps,l.ie,p.AV,_o,ne,Ri,Uo,Ll,md]]}),e})();function yd(e,t){if(1&e&&(r.TgZ(0,"mat-option",16),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("matTooltip",e.url)("value",e),r.xp6(1),r.hij(" ",e.url," ")}}function vd(e,t){if(1&e&&(r.TgZ(0,"mat-option",17),r.NdJ("click",function(e){return e.stopPropagation()}),r.TgZ(1,"p",18),r._uU(2),r.qZA(),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(2),r.Oqu(e)}}r.B6R(Xu,[Ei,h.sg,h.O5,Lp,vp,$i],[h.Ov]);const bd=function(e,t){return{value:e,email:t}};function xd(e,t){if(1&e&&(r.TgZ(0,"span"),r.TgZ(1,"p",19),r._uU(2),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(2),r.Oqu(e.languageService.translate.instant("igo.geo.catalog.externalProvider.unavailableWithEmail",r.WLB(1,bd,e.addedCatalog.url,e.emailAddress)))}}const wd=function(e){return{value:e}};function Sd(e,t){if(1&e&&(r.TgZ(0,"span"),r.TgZ(1,"p",19),r._uU(2),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(2),r.Oqu(e.languageService.translate.instant("igo.geo.catalog.unavailable",r.VKq(1,wd,e.addedCatalog.url)))}}let Cd=(()=>{class e{constructor(e,t,o,i,r){this.formBuilder=e,this.languageService=t,this.configService=o,this.dialogRef=i,this.data=r,this.defaultAddedCatalogType="wms",this.predefinedCatalogsList$=new C.X([]),this.predefinedCatalogs=[],this.error=!1,this.store=r.store,this.predefinedCatalogs=r.predefinedCatalogs,this.error=r.error,this.addedCatalog=r.addedCatalog,this.form=this.formBuilder.group({id:["",[]],title:["",[]],url:["",[We.kI.required]],type:[this.defaultAddedCatalogType,[We.kI.required]]})}ngOnInit(){this.store.state.clear(),this.typeCapabilities=Object.keys(_c),this.addedCatalogType$$=this.form.get("type").valueChanges.subscribe(e=>{"wmts"===e?this.form.get("title").setValidators(We.kI.required):this.form.get("title").setValidators([]),this.form.get("title").updateValueAndValidity()}),this.computePredefinedCatalogList(),this.storeViewAll$$=this.store.view.all$().subscribe(()=>this.computePredefinedCatalogList()),this.emailAddress=this.configService.getConfig("emailAddress")}ngOnDestroy(){this.addedCatalogType$$.unsubscribe(),this.storeViewAll$$.unsubscribe()}changeUrl(e){this.form.patchValue(e),this.error=!1,this.computePredefinedCatalogList()}computePredefinedCatalogList(){this.predefinedCatalogsList$.next(this.predefinedCatalogs.filter(e=>!this.store.get(e.id)))}addCatalog(e){this.error=!1,this.dialogRef.close(e)}cancel(){this.error=!1,this.dialogRef.close()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(We.qu),r.Y36(ue),r.Y36(W),r.Y36(ze.so),r.Y36(ze.WI,8))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-add-catalog-dialog"]],decls:30,vars:21,consts:[["mat-dialog-title","",1,"mat-typography"],["mat-dialog-content","",1,"mat-typography"],[1,"igo-form",3,"formGroup"],[1,"igo-input-container"],["type","text","formControlName","url","placeholder","URL","matInput","",3,"matAutocomplete"],[3,"optionSelected"],["auto","matAutocomplete"],["matTooltipShowDelay","500",3,"matTooltip","value",4,"ngFor","ngForOf"],["matInput","","formControlName","title",3,"placeholder"],["formControlName","type","placeholder","Type"],[3,"value","click",4,"ngFor","ngForOf"],[4,"ngIf"],["mat-dialog-actions","",2,"justify-content","center"],[1,"igo-form-button-group","add-catalog-button-top-padding"],["mat-raised-button","","type","button",3,"click"],["id","addCatalogBtnDialog","mat-raised-button","","type","button","color","primary",3,"disabled","click"],["matTooltipShowDelay","500",3,"matTooltip","value"],[3,"value","click"],["mat-line",""],[1,"error"]],template:function(e,t){if(1&e&&(r.TgZ(0,"h1",0),r._uU(1),r.ALo(2,"translate"),r.qZA(),r.TgZ(3,"div",1),r.TgZ(4,"form",2),r.TgZ(5,"div",3),r.TgZ(6,"mat-form-field"),r._UZ(7,"input",4),r.TgZ(8,"mat-autocomplete",5,6),r.NdJ("optionSelected",function(e){return t.changeUrl(e.option.value)}),r.YNc(10,yd,2,3,"mat-option",7),r.ALo(11,"async"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(12,"div",3),r.TgZ(13,"mat-form-field"),r._UZ(14,"input",8),r.ALo(15,"translate"),r.qZA(),r.qZA(),r.TgZ(16,"div",3),r.TgZ(17,"mat-form-field"),r.TgZ(18,"mat-select",9),r.YNc(19,vd,3,2,"mat-option",10),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.YNc(20,xd,3,4,"span",11),r.YNc(21,Sd,3,3,"span",11),r.qZA(),r.TgZ(22,"div",12),r.TgZ(23,"div",13),r.TgZ(24,"button",14),r.NdJ("click",function(){return t.cancel()}),r._uU(25),r.ALo(26,"translate"),r.qZA(),r.TgZ(27,"button",15),r.NdJ("click",function(){return t.addCatalog(t.form.value)}),r._uU(28),r.ALo(29,"translate"),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.MAs(9);r.xp6(1),r.Oqu(r.lcZ(2,11,"igo.geo.catalog.library.addTitle")),r.xp6(3),r.Q6J("formGroup",t.form),r.xp6(3),r.Q6J("matAutocomplete",e),r.xp6(3),r.Q6J("ngForOf",r.lcZ(11,13,t.predefinedCatalogsList$)),r.xp6(4),r.s9C("placeholder",r.lcZ(15,15,"igo.geo.printForm.title")),r.xp6(5),r.Q6J("ngForOf",t.typeCapabilities),r.xp6(1),r.Q6J("ngIf",t.error&&t.addedCatalog&&t.emailAddress),r.xp6(1),r.Q6J("ngIf",t.error&&t.addedCatalog&&!t.emailAddress),r.xp6(4),r.hij(" ",r.lcZ(26,17,"igo.geo.catalog.library.cancel")," "),r.xp6(2),r.Q6J("disabled",!t.form.valid),r.xp6(1),r.hij(" ",r.lcZ(29,19,"igo.geo.catalog.library.add")," ")}},directives:[ze.uh,ze.xY,We._Y,We.JL,We.sg,De.KE,We.Fj,Ve.Nt,Xa.ZL,We.JJ,We.u,Xa.XC,h.sg,Ee.gD,h.O5,ze.H8,n.lW,Re.ey,p.gM,Re.X2],pipes:[j.X$,h.Ov],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}.add-catalog-button-top-padding[_ngcontent-%COMP%]{padding-top:25px}.igo-form[_ngcontent-%COMP%]{padding:10px 5px 5px}.igo-form-button-group[_ngcontent-%COMP%]{text-align:center}button[_ngcontent-%COMP%]{cursor:pointer}button#addCatalogBtnDialog[disabled=true][_ngcontent-%COMP%]{cursor:default;background-color:#0000001f;color:#00000042}.error[_ngcontent-%COMP%]{color:red}"]}),e})();function Td(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-catalog-library-item",3),r.NdJ("catalogRemove",function(){const t=r.CHM(e).$implicit;return r.oxw().onCatalogRemove(t)})("select",function(){const t=r.CHM(e).$implicit;return r.oxw().onCatalogSelect(t)}),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw();r.Q6J("map",o.map)("catalog",e)}}function Ad(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",4),r.TgZ(1,"button",5),r.NdJ("click",function(){return r.CHM(e),r.oxw().addCatalogDialog()}),r.ALo(2,"translate"),r._uU(3),r.ALo(4,"translate"),r._UZ(5,"mat-icon",6),r.qZA(),r.qZA()}2&e&&(r.xp6(1),r.Q6J("matTooltip",r.lcZ(2,2,"igo.geo.catalog.library.addBtn")),r.xp6(2),r.hij(" ",r.lcZ(4,4,"igo.geo.catalog.library.addBtn")," "))}let Ld=(()=>{class e{constructor(e,t,o,i,s){this.capabilitiesService=e,this.messageService=t,this.languageService=o,this.storageService=i,this.dialog=s,this.addCatalogAllowed=!1,this.predefinedCatalogs=[],this.catalogSelectChange=new r.vpe,this.submitDisabled=!0}get addedCatalogs(){return this.storageService.get("addedCatalogs")||[]}set addedCatalogs(e){this.storageService.set("addedCatalogs",e)}ngOnInit(){this.store.state.clear(),this.predefinedCatalogs=this.predefinedCatalogs.map(e=>(e.id=Ds.V.hashStr((e.type||"wms")+Ul(e.url)),e))}getCatalogs(){return this.store.view.all$()}onCatalogSelect(e){this.store.state.update(e,{selected:!0,focused:!0},!0),this.catalogSelectChange.emit({selected:!0,catalog:e})}unsubscribeAddingCatalog(){this.addingCatalog$$&&this.addingCatalog$$.unsubscribe()}addCatalog(e){if(!e)return;let t=Ds.V.hashStr(e.type+Ul(e.url));const o=this.predefinedCatalogs.find(t=>t.id===e.id);if(o&&(e.version=o.version,e.externalProvider=o.externalProvider,t=o.id),this.store.get(t)){const e=this.languageService.translate.instant("igo.geo.catalog.library.inlist.title"),t=this.languageService.translate.instant("igo.geo.catalog.library.inlist.message");this.messageService.alert(t,e)}else this.unsubscribeAddingCatalog(),this.addingCatalog$$=this.capabilitiesService.getCapabilities(e.type,e.url,e.version).pipe((0,b.K)(t=>{const o=this.languageService.translate.instant("igo.geo.catalog.unavailableTitle");if(t.error)return this.addCatalogDialog(!0,e),t.error.caught=!0,t;const i=this.languageService.translate.instant("igo.geo.catalog.unavailable",{value:e.url});throw this.messageService.error(i,o),t})).subscribe(i=>{let r,s;switch(e.type){case"wms":r=e.title||i.Service.Title,s=e.version||i.version;break;case"arcgisrest":case"imagearcgisrest":case"tilearcgisrest":r=e.title||i.mapName;break;case"wmts":r=e.title||i.ServiceIdentification.ServiceType;break;default:r=e.title}const n=D.removeUndefined(Object.assign({},o,D.removeUndefined({id:t,title:r,url:e.url,type:e.type||"wms",externalProvider:e.externalProvider||!1,removable:!0,version:s})));this.store.insert(n);const a=this.addedCatalogs.slice(0);a.push(n),this.addedCatalogs=a,this.unsubscribeAddingCatalog()})}ngOnDestroy(){this.unsubscribeAddingCatalog()}onCatalogRemove(e){this.store.delete(e),this.addedCatalogs=this.addedCatalogs.slice(0).filter(t=>t.id!==e.id)}addCatalogDialog(e,t){this.dialog.open(Cd,{width:"700px",data:{predefinedCatalogs:this.predefinedCatalogs,store:this.store,error:e,addedCatalog:t}}).afterClosed().subscribe(e=>{this.addCatalog(e)})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36($c),r.Y36(de),r.Y36(ue),r.Y36(Se),r.Y36(ze.uw))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-catalog-library"]],inputs:{store:"store",map:"map",addCatalogAllowed:"addCatalogAllowed",predefinedCatalogs:"predefinedCatalogs"},outputs:{catalogSelectChange:"catalogSelectChange"},decls:4,vars:5,consts:[[3,"navigation"],["ngFor","",3,"ngForOf"],["class","btnAddCatalog",4,"ngIf"],["igoListItem","","color","accent",3,"map","catalog","catalogRemove","select"],[1,"btnAddCatalog"],["mat-raised-button","","matTooltipPosition","above","color","primary",3,"matTooltip","click"],["svgIcon","earth-plus"]],template:function(e,t){1&e&&(r.TgZ(0,"igo-list",0),r.YNc(1,Td,1,2,"ng-template",1),r.ALo(2,"async"),r.qZA(),r.YNc(3,Ad,6,6,"div",2)),2&e&&(r.Q6J("navigation",!1),r.xp6(1),r.Q6J("ngForOf",r.lcZ(2,3,t.getCatalogs())),r.xp6(2),r.Q6J("ngIf",t.addCatalogAllowed))},styles:["igo-list[_ngcontent-%COMP%]{height:auto}.btnAddCatalog[_ngcontent-%COMP%]{justify-content:center;display:flex;margin:30px 0}"],changeDetection:0}),e})();function Zd(e,t){1&e&&(r.TgZ(0,"mat-icon",4),r.NdJ("click",function(e){return e.stopPropagation()}),r.ALo(1,"translate"),r.qZA()),2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.catalog.externalProvider.catalog"))}function Fd(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",5),r.NdJ("click",function(t){return r.CHM(e),r.oxw().removeCatalogFromLibrary(t)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",6),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.catalog.library.remove"))}function Od(e,t){1&e&&(r.TgZ(0,"button",7),r._UZ(1,"mat-icon",8),r.qZA())}let Md=(()=>{class e{constructor(){this.catalogRemove=new r.vpe}get title(){return lt(this.catalog)}removeCatalogFromLibrary(e){e.stopPropagation(),this.catalogRemove.emit()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-catalog-library-item"]],inputs:{catalog:"catalog",map:"map"},outputs:{catalogRemove:"catalogRemove"},decls:6,vars:4,consts:[["mat-line",""],["class","igo-external-provider","tooltip-position","below","matTooltipShowDelay","500","color","primary","svgIcon","earth-arrow-right",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip","click",4,"ngIf"],["class","igo-blank","disabled","true","mat-icon-button","",4,"ngIf"],["tooltip-position","below","matTooltipShowDelay","500","color","primary","svgIcon","earth-arrow-right",1,"igo-external-provider",3,"matTooltip","click"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip","click"],["svgIcon","delete"],["disabled","true","mat-icon-button","",1,"igo-blank"],["svgIcon","blank"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-list-item"),r.TgZ(1,"h4",0),r._uU(2),r.qZA(),r.YNc(3,Zd,2,3,"mat-icon",1),r.YNc(4,Fd,3,3,"button",2),r.YNc(5,Od,2,0,"button",3),r.qZA()),2&e&&(r.xp6(2),r.hij(" ",t.title," "),r.xp6(1),r.Q6J("ngIf",t.catalog.externalProvider),r.xp6(1),r.Q6J("ngIf",t.catalog.removable),r.xp6(1),r.Q6J("ngIf",!t.catalog.removable))},directives:[l.Tg,Re.X2,h.O5,a.Hw,p.gM,n.lW],pipes:[j.X$],styles:[".igo-blank[_ngcontent-%COMP%]{cursor:pointer}.igo-external-provider[_ngcontent-%COMP%]{cursor:help}"],changeDetection:0}),e})(),Id=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,a.Ps,Ye.g,l.ie,p.AV,Ri,ne,n.ot,De.lN,We.UX,Ve.c,Ee.LD,Xa.Bb,ze.Is]]}),e})();r.B6R(Ld,[Ei,h.sg,Md,$i,h.O5,n.lW,p.gM,a.Hw],[h.Ov,j.X$]);let kd=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,Ye.g,a.Ps,l.ie,p.AV,_o,Ri,Uo],fd,Id]}),e})(),Pd=(()=>{class e{transform(e,t){let o;return"time"===t&&(o=e.filter(e=>{const t=e.dataSource;return this.isTimeFilterable(t)&&void 0!==t.options.timeFilter&&Object.keys(t.options.timeFilter).length})),"ogc"===t&&(o=e.filter(e=>this.isOgcFilterable(e.dataSource))),o}isTimeFilterable(e){return"wms"===e.options.type&&e.options.timeFilterable}isOgcFilterable(e){let t=!1;return e.options.ogcFilters&&e.options.ogcFilters.enabled&&e.options.ogcFilters.editable&&(t=!0),e.options.ogcFilters&&e.options.ogcFilters.enabled&&(e.options.ogcFilters.pushButtons||e.options.ogcFilters.checkboxes||e.options.ogcFilters.radioButtons||e.options.ogcFilters.select)&&(t=!0),t}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=r.Yjl({name:"filterableDataSource",type:e,pure:!0}),e})(),_d=(()=>{class e{constructor(){}filterByDate(e,t){let o,i,r,s;if(Array.isArray(t)){const i=[];t[0]&&(r=this.reformatDateTime(t[0]),i.push(t[0])),t[1]&&(s=this.reformatDateTime(t[1]),i.push(t[1])),2===i.length&&r!==s&&(o=e instanceof Lc?r+","+s:r+"/"+s),r===s&&(o=r)}else t&&(i=this.reformatDateTime(t),o=i);e.ol.updateParams({TIME:o}),e instanceof ic&&e.setTimeFilter(e.timeFilter,!0)}filterByYear(e,t){let o,i,r;if(Array.isArray(t)){const s=[];t[0]&&(i=t[0],s.push(t[0])),t[1]&&(r=t[1],s.push(t[1])),2===s.length&&i!==r&&(o=e instanceof Lc?i+","+r:i+"/"+r),i===r&&(o=i)}else o=t;e.ol.updateParams({TIME:o}),e instanceof ic&&e.setTimeFilter(e.timeFilter,!0)}reformatDateTime(e){const t=e.getFullYear();let o=e.getMonth()+1,i=e.getUTCDate(),r=e.getUTCHours(),s=e.getUTCMinutes();return Number(o)<10&&(o="0"+o),Number(i)<10&&(i="0"+i),Number(r)<10&&(r="0"+r),Number(s)<10&&(s="0"+s),t+"-"+o+"-"+i+"T"+r+":"+s+":00Z"}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})(),$d=(()=>{class e{constructor(){}filterByOgc(e,t){const o=(new Ql).formatProcessedOgcFilter(t,e.options.params.LAYERS);e.ol.updateParams({FILTER:o})}setOgcWFSFiltersOptions(e){const t=e.options,o=new Ql;t.ogcFilters.enabled&&t.ogcFilters.filters&&(t.ogcFilters.filters=o.checkIgoFiltersProperties(t.ogcFilters.filters,t.paramsWFS.fieldNameGeometry,new sa.Z({code:t.paramsWFS.srsName}),!0),t.ogcFilters.interfaceOgcFilters||(t.ogcFilters.interfaceOgcFilters=o.defineInterfaceFilterSequence(t.ogcFilters.filters,t.paramsWFS.fieldNameGeometry)))}setOgcWMSFiltersOptions(e){const t=e.options,o=new Ql;t.ogcFilters.enabled&&t.ogcFilters.filters?(t.ogcFilters.filters=o.checkIgoFiltersProperties(t.ogcFilters.filters,t.fieldNameGeometry,void 0,!0),t.ogcFilters.interfaceOgcFilters||(t.ogcFilters.interfaceOgcFilters=o.defineInterfaceFilterSequence(t.ogcFilters.filters,t.fieldNameGeometry)),this.filterByOgc(e,o.buildFilter(t.ogcFilters.filters,void 0,void 0,void 0,e.options)),t.filtered=!0):(t.ogcFilters.filters=void 0,t.ogcFilters.interfaceOgcFilters=[],t.filtered=!1)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})();var qd=(()=>{return(e=qd||(qd={})).Predefined="Predefined",e.Polygon="Polygon",e.Point="Point",qd;var e})(),Dd=(()=>{return(e=Dd||(Dd={})).Address="Address",e.Thematics="Thematics",Dd;var e})();let Ed=(()=>{class e{constructor(e,t,o){this.http=e,this.languageService=t,this.configService=o,this.baseUrl="https://geoegl.msp.gouv.qc.ca/apis/terrapi/",this.urlFilterList={AdmRegion:"regadmin",Arrond:"arrondissements",CircFed:"circ-fed",CircProv:"circ-prov",DirReg:"dir-reg",MRC:"mrc",Mun:"municipalites",RegTour:"tourisme",bornes:"bornes-sumi",hydro:"hydro",routes:"routes"},this.baseUrl=this.configService.getConfig("spatialFilter.url")||this.baseUrl}getKeyByValue(e,t){return Object.keys(e).find(o=>e[o]===t)}loadFilterList(e){if(e)return this.http.get(this.baseUrl+this.urlFilterList[e]).pipe((0,x.U)(e=>e.features.map(e=>(e.meta={id:e.properties.code},e))))}loadThematicsList(){const e=[];return this.http.get(this.baseUrl+"types").pipe((0,x.U)(t=>(t.forEach(t=>{if(t.startsWith("lieux")){const i={name:void 0,source:t};let r=t.substring(6,t.length),s=r;if(r.includes(".")){const e=r.indexOf(".");s=r.substring(e+1,r.length),r=r.substring(0,e)}try{i.name=this.languageService.translate.instant("igo.geo.terrapi."+s)}catch(o){i.name=s.substring(0,1).toUpperCase()+s.substring(1,s.length-1)}try{i.group=this.languageService.translate.instant("igo.geo.spatialFilter.group."+r)}catch(o){i.group=r.substring(0,1).toUpperCase()+r.substring(1,s.length-1)}e.push(i)}else if(this.getKeyByValue(this.urlFilterList,t)){const o={name:void 0,source:t},r=this.getKeyByValue(this.urlFilterList,t);try{o.name=this.languageService.translate.instant("igo.geo.terrapi."+r)}catch(i){o.name=r.substring(0,1).toUpperCase()+r.substring(1,r.length-1)}o.source=t,e.push(o)}}),e)))}loadFilterItem(e,t,o,i,r){if(o){const s=this.baseUrl+this.urlFilterList[o];let n="";return t===Dd.Address?(n="adresses",this.http.get(s+"/"+e.properties.code+"/"+n,{params:{geometry:"true",icon:"true",bufferInput:r.toString(),simplified:"100"}}).pipe((0,x.U)(e=>e.features.map(e=>(e.meta={id:e.properties.code,title:this.languageService.translate.instant("igo.geo.spatialFilter.Address"),icon:e.icon},e))))):(n=i.source,this.http.get(s+"/"+e.properties.code+"/"+n,{params:{geometry:"true",icon:"true",bufferInput:r.toString(),simplified:"100"}}).pipe((0,x.U)(e=>e.features.map(e=>(e.meta={id:e.properties.code,title:i.name,icon:e.icon},e)))))}{const o=this.baseUrl+"locate";return t===Dd.Address?this.http.post(o+"?type=adresses",{geometry:"true",icon:"true",loc:JSON.stringify(e),bufferInput:r.toString(),simplified:"100"}).pipe((0,x.U)(e=>e.features.map(e=>(e.meta={id:e.properties.code,title:this.languageService.translate.instant("igo.geo.spatialFilter.Address"),icon:e.icon},e)))):this.http.post(o+"?type="+i.source,{geometry:"true",icon:"true",loc:JSON.stringify(e),bufferInput:r.toString(),simplified:"100"}).pipe((0,x.U)(e=>e.features.map(e=>(e.meta={id:e.properties.code,title:i.name,icon:e.icon},e))))}}loadItemById(e,t){const o=this.urlFilterList[t],i="/"+e.properties.code;if(o&&i)return this.http.get(this.baseUrl+o+i,{params:{geometry:"true"}}).pipe((0,x.U)(e=>(e.meta={id:e.properties.code,alias:e.properties.nom,title:e.properties.nom},e)))}loadBufferGeometry(e,t,o,i){if(t!==qd.Predefined)return this.http.post(this.baseUrl+"geospatial/buffer?",{buffer:o,loc:JSON.stringify(e)}).pipe((0,x.U)(e=>e));{const t=this.urlFilterList[i],r="/"+e.properties.code;if(t&&r)return this.http.get(this.baseUrl+t+r,{params:{geometry:"100",bufferOutput:o.toString()}}).pipe((0,x.U)(e=>(e.meta={id:e.properties.code,alias:e.properties.nom,title:e.properties.nom},e)))}}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(ue),r.LFG(W))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Rd=(()=>{class e{constructor(e,t){this.messageService=e,this.languageService=t}open(e){const t=this.languageService.translate,o=t.instant("igo.geo.download.title");this.messageService.success(t.instant("igo.geo.download.start"),o);const i=e.dataSource.options;if(Object.keys(i.download).length>0)if(i.download.dynamicUrl&&void 0===i.download.url){let t,o=new sa.Z({code:e.map.projection});const r=e.dataSource.options.paramsWFS;r&&Object.keys(r).length>0?(o=r.srsName?new sa.Z({code:r.srsName}):o,t=e.dataSource.options.paramsWFS):t=e.dataSource.options.params;const s=kn.$A(e.map.viewController.getExtent(),new sa.Z({code:e.map.projection}),o),n=void 0===t.outputFormatDownload?void 0===t.outputFormat?"":"outputformat="+t.outputFormat:"outputformat="+t.outputFormatDownload,a=i.download.dynamicUrl.replace(/&?outputformat=[^&]*/gi,"").replace(/&?filter=[^&]*/gi,"").replace(/&?bbox=[^&]*/gi,""),l=e.dataSource.options.ogcFilters;let c;c=(new Ql).handleOgcFiltersAppliedValue(e.dataSource.options,l.geometryName,s,o),c=c?"filter="+encodeURIComponent(c):(new Ql).buildFilter(void 0,s,o,l.geometryName),window.open(`${a}&${c}&${n}`,"_blank")}else i.download&&window.open(i.download.url,"_blank")}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(de),r.LFG(ue))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Ud(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",1),r.NdJ("click",function(){r.CHM(e);const t=r.oxw();return t.openDownload(t.layer)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",2),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("matTooltip",r.lcZ(1,2,"igo.geo.download.action"))("color",e.color)}}let Nd=(()=>{class e{constructor(e){this.downloadService=e,this._color="primary"}get layer(){return this._layer}set layer(e){this._layer=e}get color(){return this._color}set color(e){this._color=e}openDownload(e){this.downloadService.open(e)}get options(){if(this.layer)return this.layer.dataSource.options}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Rd))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-download-button"]],inputs:{layer:"layer",color:"color"},decls:1,vars:1,consts:[["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click"],["svgIcon","download"]],template:function(e,t){1&e&&r.YNc(0,Ud,3,4,"button",0),2&e&&r.Q6J("ngIf",t.options&&t.options.download&&(t.options.download.dynamicUrl||t.options.download.url))},directives:[h.O5,n.lW,p.gM,a.Hw],pipes:[j.X$],styles:[""],changeDetection:0}),e})(),Jd=(()=>{class e{static forRoot(){return{ngModule:e}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,a.Ps,n.ot,p.AV,ne]]}),e})();function Bd(e,t){if(1&e&&(r.TgZ(0,"td"),r._UZ(1,"mat-icon",7),r.qZA()),2&e){const e=r.oxw(3);r.xp6(1),r.s9C("svgIcon",e.icon)}}function jd(e,t){if(1&e&&(r.TgZ(0,"td"),r.TgZ(1,"a",8),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.qZA()),2&e){const e=r.oxw().$implicit,t=r.oxw(2);r.xp6(1),r.s9C("href",e.value,r.LSH),r.xp6(1),r.AsE(" ",r.lcZ(3,3,"igo.geo.targetHtmlUrl")," ",t.title,"")}}function Qd(e,t){if(1&e&&(r.TgZ(0,"td",9),r._uU(1),r.qZA()),2&e){const e=r.oxw().$implicit;r.xp6(1),r.hij(" ",e.key," ")}}function Gd(e,t){if(1&e&&r._UZ(0,"td",10),2&e){const e=r.oxw().$implicit;r.Q6J("innerHTML",e.value,r.oJD)}}function Yd(e,t){if(1&e&&(r._UZ(0,"img",13),r.ALo(1,"async"),r.ALo(2,"secureImage")),2&e){const e=r.oxw(2).$implicit;r.s9C("src",r.lcZ(1,1,r.lcZ(2,3,e.value)),r.LSH)}}function zd(e,t){1&e&&(r.TgZ(0,"span"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij("",r.lcZ(2,1,"igo.geo.targetHtmlUrl")," "))}function Hd(e,t){if(1&e&&(r.TgZ(0,"td"),r.TgZ(1,"a",8),r.YNc(2,Yd,3,5,"img",11),r.YNc(3,zd,3,3,"ng-template",null,12,r.W1O),r.qZA(),r.qZA()),2&e){const e=r.MAs(4),t=r.oxw().$implicit,o=r.oxw(2);r.xp6(1),r.s9C("href",t.value,r.LSH),r.xp6(1),r.Q6J("ngIf",o.isImg(t.value))("ngIfElse",e)}}function Vd(e,t){if(1&e&&(r._UZ(0,"td",10),r.ALo(1,"json")),2&e){const e=r.oxw().$implicit;r.Q6J("innerHTML",r.lcZ(1,1,e.value),r.oJD)}}function Wd(e,t){if(1&e&&(r.TgZ(0,"tr"),r.YNc(1,Bd,2,1,"td",4),r.YNc(2,jd,4,5,"td",4),r.YNc(3,Qd,2,1,"td",5),r.YNc(4,Gd,1,1,"td",6),r.YNc(5,Hd,5,3,"td",4),r.YNc(6,Vd,2,3,"td",6),r.qZA()),2&e){const e=t.$implicit,o=r.oxw(2);r.xp6(1),r.Q6J("ngIf","_blank"===o.feature.properties.target&&"url"===e.key),r.xp6(1),r.Q6J("ngIf","_blank"===o.feature.properties.target&&"url"===e.key),r.xp6(1),r.Q6J("ngIf",void 0===o.feature.properties.target),r.xp6(1),r.Q6J("ngIf",void 0===o.feature.properties.target&&!o.isObject(e.value)&&!o.isUrl(e.value)),r.xp6(1),r.Q6J("ngIf",void 0===o.feature.properties.target&&!o.isObject(e.value)&&o.isUrl(e.value)),r.xp6(1),r.Q6J("ngIf",void 0===o.feature.properties.target&&o.isObject(e.value))}}function Xd(e,t){if(1&e&&(r.TgZ(0,"table",2),r.TgZ(1,"tbody"),r.YNc(2,Wd,7,6,"tr",3),r.ALo(3,"keyvalue"),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(2),r.Q6J("ngForOf",r.lcZ(3,1,e.filterFeatureProperties(e.feature)))}}function Kd(e,t){if(1&e&&r._UZ(0,"iframe",14),2&e){const e=r.oxw();r.Q6J("srcdoc",e.htmlSanitizer(e.feature.properties),r.oJD)("src",e.urlSanitizer(e.feature.properties.url),r.uOi)}}let eh=(()=>{class e{constructor(e,t,o){this.cdRef=e,this.sanitizer=t,this.networkService=o,this.unsubscribe$=new O.xQ,this.ready=!1,this.routeEvent=new r.vpe,this.selectFeature=new r.vpe,this.htmlDisplayEvent=new r.vpe,this.networkService.currentState().pipe((0,_e.R)(this.unsubscribe$)).subscribe(e=>{this.state=e})}get source(){return this._source}set source(e){this._source=e,this.cdRef.detectChanges()}get feature(){return this._feature}set feature(e){this._feature=e,this.cdRef.detectChanges(),this.selectFeature.emit()}get title(){return lt(this.feature)}get icon(){return ct(this.feature)||"link"}ngOnInit(){this.ready=!0}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}urlSanitizer(e){return this.sanitizer.bypassSecurityTrustResourceUrl(e)}isHtmlDisplay(){return this.feature&&this.isObject(this.feature.properties)&&"iframe"===this.feature.properties.target?(this.htmlDisplayEvent.emit(!0),!0):(this.htmlDisplayEvent.emit(!1),!1)}htmlSanitizer(e){if(e.body&&"Internet Explorer"!==k.getBrowserName()){if(!/<base href="[\w:\/\.]+">/.test(e.body)){const t=new URL(e.url,window.location.origin);e.body=e.body.replace("<head>",`<head><base href="${t.origin}">`)}return this.sanitizer.bypassSecurityTrustHtml(e.body)}}isObject(e){return"object"==typeof e}isUrl(e){return"string"==typeof e&&("https://"===e.slice(0,8)||"http://"===e.slice(0,7))}isImg(e){return!!this.isUrl(e)&&["jpg","png","gif"].includes(e.split(".").pop().toLowerCase())}filterFeatureProperties(e){const t=e.meta?e.meta.alias:void 0,o={};let i;return this.map&&this.map.offlineButtonToggle$.pipe((0,_e.R)(this.unsubscribe$)).subscribe(e=>{i=e}),e.properties&&e.properties.Route&&this.toolbox&&!this.toolbox.getTool("directions")&&delete e.properties.Route,t?(Object.keys(t).forEach(i=>{o[t[i]]=e.properties[i]}),o):(void 0!==i&&i?e.meta&&e.meta.excludeAttributeOffline&&e.meta.excludeAttributeOffline.forEach(t=>{delete e.properties[t]}):this.state.connection&&e.meta&&e.meta.excludeAttribute?e.meta.excludeAttribute.forEach(t=>{delete e.properties[t]}):!this.state.connection&&e.meta&&e.meta.excludeAttributeOffline&&e.meta.excludeAttributeOffline.forEach(t=>{delete e.properties[t]}),e.properties)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.sBO),r.Y36(i.H7),r.Y36(Ce))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-feature-details"]],inputs:{source:"source",map:"map",toolbox:"toolbox",feature:"feature"},outputs:{routeEvent:"routeEvent",selectFeature:"selectFeature",htmlDisplayEvent:"htmlDisplayEvent"},decls:2,vars:2,consts:[["class","igo-striped mat-typography",4,"ngIf"],[3,"srcdoc","src",4,"ngIf"],[1,"igo-striped","mat-typography"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","keyValue",4,"ngIf"],[3,"innerHTML",4,"ngIf"],["mat-list-avatar","",3,"svgIcon"],["target","_blank","rel","noopener noreferrer",3,"href"],["id","keyValue"],[3,"innerHTML"],["width","225","heigth","auto",3,"src",4,"ngIf","ngIfElse"],["notImg",""],["width","225","heigth","auto",3,"src"],[3,"srcdoc","src"]],template:function(e,t){1&e&&(r.YNc(0,Xd,4,3,"table",0),r.YNc(1,Kd,1,2,"iframe",1)),2&e&&(r.Q6J("ngIf",t.ready&&t.feature&&t.isObject(t.feature.properties)&&"iframe"!==t.feature.properties.target),r.xp6(1),r.Q6J("ngIf",t.isHtmlDisplay()))},directives:[h.O5,h.sg,a.Hw],pipes:[Pi,j.X$,h.Ov,Tt,h.Ts],styles:["table[_ngcontent-%COMP%]{width:100%}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px}#keyValue[_ngcontent-%COMP%]{width:30%}table[_ngcontent-%COMP%]     .routing{cursor:pointer}iframe[_ngcontent-%COMP%]{height:calc(100% - 4px);width:100%;border:0}"],changeDetection:0}),e})();var th=(()=>{return(e=th||(th={})).Point="Point",e.LineString="LineString",e.Polygon="Polygon",e.Circle="Circle",th;var e})();function oh(e){return new Qn.Z({stroke:new jn.Z({color:(e=e||[0,153,255]).concat([1]),width:2}),fill:new Jn.Z({color:e.concat([.2])}),radius:8})}function ih(){return new Un.ZP({stroke:new jn.Z({color:[0,153,255,1],width:2})})}function rh(e){const t=e.target;return t instanceof Vn.ZP?t.getFlatCoordinates().slice(-4,-2):t.getFlatCoordinates().slice(-2)}Error;class sh{constructor(e){this.options=e,this.start$=new O.xQ,this.end$=new O.xQ,this.changes$=new O.xQ,this.modify$=new O.xQ,this.select$=new O.xQ,this.freehand$=new C.X(!1),this.olDrawingLayer=e.drawingLayer?e.drawingLayer:this.createOlInnerOverlayLayer(),this.olGeometryType=this.options.geometryType}get active(){return void 0!==this.olMap}get olDrawingLayerSource(){return this.olDrawingLayer.getSource()}setOlMap(e,t){if(!e)return this.clearOlInnerOverlaySource(),this.removeOlInnerOverlayLayer(),this.removeOlInteractions(),void(this.olMap=e);this.olMap=e,this.addOlInnerOverlayLayer(),this.addOlInteractions(t)}getSource(){return this.olDrawingLayerSource}setGeometryType(e){this.olGeometryType=e}createOlInnerOverlayLayer(){return new Kn.Z({source:this.options.drawingLayerSource?this.options.drawingLayerSource:new Aa.Z,style:this.options.drawingLayerStyle,zIndex:500})}removeOlInnerOverlayLayer(){!this.options.drawingLayer&&this.olMap&&this.olMap.removeLayer(this.olDrawingLayer)}addOlInnerOverlayLayer(){this.options.drawingLayer||this.olMap.addLayer(this.olDrawingLayer)}clearOlInnerOverlaySource(){!this.options.drawingLayer&&!this.options.drawingLayerSource&&this.olDrawingLayerSource.clear(!0)}addOlInteractions(e){let t;if(t=this.freehand$.getValue()?new tl.ZP("Point"===this.olGeometryType?{type:"Circle",source:this.getSource(),maxPoints:this.options.maxPoints,freehand:!0}:{type:this.olGeometryType,source:this.getSource(),maxPoints:this.options.maxPoints,freehand:!0}):new tl.ZP({type:this.olGeometryType,source:this.getSource(),stopClick:!0,style:this.options.interactionStyle,maxPoints:this.options.maxPoints,freehand:!1,freehandCondition:()=>!1}),this.olMap.addInteraction(t),this.olDrawInteraction=t,this.onDrawStartKey=t.on("drawstart",e=>this.onDrawStart(e)),this.onDrawEndKey=t.on("drawend",e=>this.onDrawEnd(e)),e){const e=new ol.Z({source:this.getSource()});if(this.olMap.addInteraction(e),this.olModifyInteraction=e,!this.olSelectInteraction){const e=new qn.Z({condition:il.OK,style:void 0});this.olMap.addInteraction(e),this.olSelectInteraction=e,this.olSelectInteraction.on("select",e=>this.onSelect(e))}}}removeOlInteractions(){this.unsubscribeKeyDown(),(0,ea.B)([this.onDrawStartKey,this.onDrawEndKey,this.onDrawKey]),this.olMap&&(this.olMap.removeInteraction(this.olDrawInteraction),this.olMap.removeInteraction(this.olModifyInteraction)),this.olDrawInteraction=void 0,this.olModifyInteraction=void 0}onDrawStart(e){const t=e.feature.getGeometry();this.start$.next(t),this.clearOlInnerOverlaySource(),this.onDrawKey=t.on("change",e=>{this.mousePosition=rh(e),this.changes$.next(e.target)}),this.subscribeKeyDown()}onDrawEnd(e){this.unsubscribeKeyDown(),(0,ea.B)(this.onDrawKey);const t=e.feature.getGeometry();t.on("change",()=>{this.modify$.next(t)}),this.end$.next(t)}onSelect(e){1===e.selected.length&&this.select$.next(e.selected[0])}subscribeKeyDown(){this.unsubscribeKeyDown(),this.keyDown$$=(0,Z.R)(document,"keydown").subscribe(e=>{"Escape"!==e.key?("Backspace"===e.key&&this.olDrawInteraction.removeLastPoint(),"Enter"===e.key&&this.olDrawInteraction.finishDrawing()," "!==e.key||this.olMap.getView().animate({center:this.mousePosition,duration:100})):this.olDrawInteraction.abortDrawing()})}unsubscribeKeyDown(){this.keyDown$$&&(this.keyDown$$.unsubscribe(),this.keyDown$$=void 0)}}let nh=(()=>{class e{constructor(e,t){this.dialogRef=e,this.data=t}noLabel(){this.dialogRef.close()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ze.so),r.Y36(ze.WI))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-draw-popup-component"]],decls:14,vars:11,consts:[["mat-dialog-content",""],[1,"mat-typography"],[1,"example-full-width"],["matInput","",3,"placeholder","value"],["input",""],["mat-dialog-actions",""],["mat-raised-button","",3,"click"],["mat-raised-button","","color","primary",3,"mat-dialog-close"]],template:function(e,t){if(1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"p",1),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"mat-form-field",2),r._UZ(5,"input",3,4),r.ALo(7,"translate"),r.qZA(),r.qZA(),r.TgZ(8,"div",5),r.TgZ(9,"button",6),r.NdJ("click",function(){return t.noLabel()}),r._uU(10),r.ALo(11,"translate"),r.qZA(),r.TgZ(12,"button",7),r._uU(13,"OK "),r.qZA(),r.qZA()),2&e){const e=r.MAs(6);r.xp6(2),r.Oqu(r.lcZ(3,5,"igo.geo.draw.dialogInstruction")),r.xp6(3),r.s9C("placeholder",r.lcZ(7,7,"igo.geo.draw.dialogTitle")),r.s9C("value",t.data.currentLabel),r.xp6(5),r.hij("",r.lcZ(11,9,"igo.geo.draw.noLabel")," "),r.xp6(2),r.Q6J("mat-dialog-close",e.value)}},directives:[ze.xY,De.KE,Ve.Nt,ze.H8,n.lW,ze.ZT],pipes:[j.X$],styles:[""]}),e})(),ah=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-draw-shorcuts"]],decls:24,vars:12,consts:[[1,"shortcut","mat-typography"],["svgIcon","keyboard-return",1,"shortcut-icon"],["svgIcon","backspace-outline",1,"shortcut-icon"],["svgIcon","keyboard-esc",1,"shortcut-icon"],["svgIcon","keyboard-space",1,"shortcut-icon"],[1,"shortcuts-close"],["mat-raised-button","","mat-dialog-close","","color","primary"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-dialog-content"),r.TgZ(1,"div"),r.TgZ(2,"span",0),r._UZ(3,"mat-icon",1),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.qZA(),r.TgZ(6,"div"),r.TgZ(7,"span",0),r._UZ(8,"mat-icon",2),r._uU(9),r.ALo(10,"translate"),r.qZA(),r.qZA(),r.TgZ(11,"div"),r.TgZ(12,"span",0),r._UZ(13,"mat-icon",3),r._uU(14),r.ALo(15,"translate"),r.qZA(),r.qZA(),r.TgZ(16,"div"),r.TgZ(17,"span",0),r._UZ(18,"mat-icon",4),r._uU(19),r.ALo(20,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(21,"mat-dialog-actions",5),r.TgZ(22,"button",6),r._uU(23,"OK"),r.qZA(),r.qZA()),2&e&&(r.xp6(4),r.Oqu(r.lcZ(5,4,"igo.geo.draw.finish")),r.xp6(5),r.Oqu(r.lcZ(10,6,"igo.geo.draw.undo")),r.xp6(5),r.Oqu(r.lcZ(15,8,"igo.geo.draw.abort")),r.xp6(5),r.Oqu(r.lcZ(20,10,"igo.geo.draw.move")))},directives:[ze.xY,a.Hw,ze.H8,n.lW,ze.ZT],pipes:[j.X$],styles:[".shortcut[_ngcontent-%COMP%]{display:flex;align-items:center}.shortcut-icon[_ngcontent-%COMP%]{margin-right:10px}.shortcuts-close[_ngcontent-%COMP%]{display:flex;justify-content:center}"]}),e})();var lh=(()=>{return(e=lh||(lh={})).Length="length",e.Area="area",lh;var e})(),ch=(()=>{return(e=ch||(ch={})).Meters="meters",e.Kilometers="kilometers",e.Miles="miles",e.Feet="feet",ch;var e})();const uh={[ch.Meters]:"m",[ch.Kilometers]:"km",[ch.Miles]:"mi",[ch.Feet]:"ft"};var ph=(()=>{return(e=ph||(ph={})).SquareMeters="squareMeters",e.SquareKilometers="squareKilometers",e.SquareMiles="squareMiles",e.SquareFeet="squareFeet",e.Hectares="hectares",e.Acres="acres",ph;var e})();const dh={[ph.SquareMeters]:"m\xb2",[ph.SquareKilometers]:"km\xb2",[ph.SquareMiles]:"mi\xb2",[ph.SquareFeet]:"ft\xb2",[ph.Hectares]:"ha",[ph.Acres]:"ac"};function hh(e){return.001*e}function gh(e){return 3.2808*e}function mh(e){return 621e-6*e}function fh(e){return 1e-6*e}function yh(e){return 3.861e-7*e}function vh(e){return 10.764*e}function bh(e){return 1e-4*e}function xh(e){return 24711e-8*e}function wh(e,t){const o=new Map([[ch.Meters,e=>e],[ch.Kilometers,hh],[ch.Miles,mh],[ch.Feet,gh]]).get(t);return o?o(e):void 0}function Sh(e,t){const o=new Map([[ph.SquareMeters,e=>e],[ph.SquareKilometers,fh],[ph.SquareMiles,yh],[ph.SquareFeet,vh],[ph.Hectares,bh],[ph.Acres,xh]]).get(t);return o?o(e):void 0}function Ch(e,t,o){let i=t.decimal;(void 0===i||i<0)&&(i=1);const r=[];return r.push(void 0!==t.locale?e.toLocaleString(t.locale,{minimumFractionDigits:i,maximumFractionDigits:i}):e.toFixed(i).toString()),void 0!==t.unit&&!0===t.unitAbbr&&r.push(o?o.translate.instant(uh[t.unit]?"igo.geo.measure."+uh[t.unit]:"igo.geo.measure."+dh[t.unit]):uh[t.unit]||dh[t.unit]),r.filter(e=>void 0!==e).join(" ")}function Th(){return new Un.ZP({stroke:new jn.Z({color:"#ffcc33",lineDash:[10,10],width:2}),fill:new Jn.Z({color:"rgba(255, 255, 255, 0.2)"}),image:new Qn.Z({radius:5,stroke:new jn.Z({color:"#ffcc33"}),fill:new Jn.Z({color:"rgba(255, 255, 255, 0.2)"})})})}function Ah(e,t){if(!(e instanceof _n.Z)&&0!==e.getFlatCoordinates().length)return(0,rl.xA)(e,{projection:t})}function Lh(e,t){const o=Ah(e,t),i=function(e,t){if(!(e instanceof _n.Z||e instanceof Wn.Z)&&0!==e.getFlatCoordinates().length)return(0,rl.bg)(e,{projection:t})}(e,t),r=[],s=e.getFlatCoordinates(),n=s.length;for(let a=0;a<=n-4;a+=2){const e=new Wn.Z([[s[a],s[a+1]],[s[a+2],s[a+3]]]);r.push(Ah(e,t))}return{area:i,length:o,lengths:r}}function Zh(e){let t;if(e instanceof _n.Z){const o=new _n.Z(e.getFlatCoordinates());t=new Array(1),t[0]=o}else{t=Fh(e);const o=e.getFlatCoordinates(),i=t.length;for(let e=0;e<i;e++){const i=2*e,r=new Wn.Z([[o[i],o[i+1]],[o[i+2],o[i+3]]]).getCoordinateAt(.5),s=t[e];void 0!==s?s.setCoordinates(r):t[e]=new _n.Z(r)}}return t}function Fh(e){let t;t=e instanceof En.Z?0:Math.max(e.getFlatCoordinates().length/2-1,0);let o=e.get("_midpoints");if(void 0===o)return o=new Array(e instanceof _n.Z?1:t),e.set("_midpoints",o,!0),o;if(0===t||t===o.length)return o;if(t>o.length)return o.push(...new Array(t-o.length)),o;for(let i=t;i<o.length;i++){const e=o[t];void 0!==e&&Oh(e)}return o.splice(t),o}function Oh(e){const t=e.get("_tooltip");if(void 0!==t){const e=t.getMap();void 0!==e&&e.removeOverlay(t)}}function Mh(e){const t=[].concat(function(e){return Fh(e).map(e=>e?e.get("_tooltip"):void 0)}(e)||[]),o=function(e){const t=e.get("_center");return t?t.get("_tooltip"):void 0}(e);return void 0!==o&&t.push(o),t}function Ih(e,t=!1,o=""){const i=new sl.Z({element:document.createElement("div"),offset:[-30,-10],className:(t?["igo-map-tooltip","igo-map-tooltip-measure","igo-map-tooltip-measure-area"]:["igo-map-tooltip","igo-map-tooltip-measure",`igo-map-tooltip-measure-${o}segments`]).join(" "),stopEvent:!1});return i.setPosition(e.getFlatCoordinates()),e.set("_tooltip",i),i}function kh(e,t,o,i){return new Un.ZP({stroke:new jn.Z({color:t||"rgba(143,7,7,1)",width:o||1}),fill:new Jn.Z({color:e||"rgba(255,255,255,0.4)"}),image:new Qn.Z({radius:5,stroke:new jn.Z({color:t||"rgba(143,7,7,1)",width:o||1}),fill:new Jn.Z({color:e||"rgba(255,255,255,0.4)"})})})}let Ph=(()=>{class e{constructor(e){this.mapService=e,this.fillColor="rgba(255,255,255,0.4)",this.strokeColor="rgba(143,7,7,1)",this.strokeWidth=1,this.labelsAreShown=!0}getFillColor(){return this.fillColor}setFillColor(e){this.fillColor=e}getStrokeColor(){return this.strokeColor}setStrokeColor(e){this.strokeColor=e}getStrokeWidth(){return this.strokeWidth}getLabelsAreShown(){return this.labelsAreShown}toggleLabelsAreShown(){this.labelsAreShown=!this.labelsAreShown}setIcon(e){this.icon=e}getIcon(){return this.icon}createDrawingLayerStyle(e,t,o,i){let r,s=!1;const n=this.mapService.getMap().projection;if(e.getGeometry()instanceof _n.Z&&(s=!s),e.get("rad")){const i=(0,kn.vs)(e.getGeometry().flatCoordinates,n,"EPSG:4326");return r=new Un.ZP({text:new Nn.Z({text:o?e.get("draw"):"",stroke:new jn.Z({color:"white",width:.75}),fill:new Jn.Z({color:"black"}),font:"20px sans-serif",overflow:!0}),image:new Qn.Z({radius:e.get("rad")/Math.cos(Math.PI/180*i[1])/t,stroke:new jn.Z({color:this.strokeColor,width:this.strokeWidth}),fill:new Jn.Z({color:this.fillColor})})}),r}return i?(r=new Un.ZP({text:new Nn.Z({text:o?e.get("draw"):"",offsetY:-26,stroke:new jn.Z({color:"white",width:.75}),fill:new Jn.Z({color:"black"}),font:"20px sans-serif",overflow:!0}),stroke:new jn.Z({color:this.strokeColor,width:this.strokeWidth}),fill:new Jn.Z({color:this.fillColor}),image:new Bn.Z({src:i})}),r):(r=new Un.ZP({text:new Nn.Z({text:o?e.get("draw"):"",stroke:new jn.Z({color:"white",width:.75}),fill:new Jn.Z({color:"black"}),font:"20px sans-serif",overflow:!0,offsetY:s?-15:0}),stroke:new jn.Z({color:this.strokeColor,width:this.strokeWidth}),fill:new Jn.Z({color:this.fillColor}),image:new Qn.Z({radius:5,stroke:new jn.Z({color:this.strokeColor,width:this.strokeWidth}),fill:new Jn.Z({color:this.fillColor})})}),r)}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(Pc))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),_h=(()=>{class e{constructor(e){this.config=e,this.getIconsList()}getIcons(){return this.icons}getPath(){return this.config.getConfig("drawingTool.icons")||[]}getIconsList(){this.icons=this.getPath()}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(W))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function $h(e,t){if(1&e&&(r.TgZ(0,"div",24),r._UZ(1,"img",25),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.s9C("src",e.icon,r.LSH)}}function qh(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-option",26),r.NdJ("click",function(){const t=r.CHM(e).$implicit;return r.oxw(2).onIconChange(t)}),r.TgZ(1,"div",24),r._UZ(2,"img",25),r.qZA(),r.qZA()}if(2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(2),r.s9C("src",e,r.LSH)}}function Dh(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-form-field"),r.TgZ(1,"mat-label"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"mat-select"),r.TgZ(5,"mat-select-trigger"),r.YNc(6,$h,2,1,"div",21),r.qZA(),r.TgZ(7,"mat-option",22),r.NdJ("click",function(){return r.CHM(e),r.oxw().onIconChange()}),r._uU(8),r.ALo(9,"translate"),r.qZA(),r.YNc(10,qh,3,2,"mat-option",23),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(2),r.Oqu(r.lcZ(3,4,"igo.geo.draw.icon")),r.xp6(4),r.Q6J("ngIf",e.icon),r.xp6(2),r.Oqu(r.lcZ(9,6,"igo.geo.draw.noIcon")),r.xp6(2),r.Q6J("ngForOf",e.icons)}}function Eh(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",27),r.NdJ("click",function(){return r.CHM(e),r.oxw().deleteDrawings()}),r.ALo(1,"translate"),r.ALo(2,"async"),r._UZ(3,"mat-icon",28),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("matTooltip",r.lcZ(1,2,"igo.geo.draw.delete"))("disabled",0===r.lcZ(2,4,e.selectedFeatures$).length)}}let Rh=(()=>{class e{constructor(e,t,o,i,r){this.languageService=e,this.formBuilder=t,this.drawStyleService=o,this.dialog=i,this.drawIconService=r,this.tableTemplate={selection:!0,selectMany:!0,selectionCheckbox:!0,sort:!0,columns:[{name:"Drawing",title:this.languageService.translate.instant("igo.geo.draw.labels"),valueAccessor:e=>e.properties.draw}]},this.geometryType=th,this.draw$=new C.X({}),this.olDrawingLayerSource=new Aa.Z,this.selectedFeatures$=new C.X([]),this.drawControlIsDisabled=!0,this.drawControlIsActive=!1,this.subscriptions$$=[],this.position="bottom",this.buildForm(),this.fillColor=this.drawStyleService.getFillColor(),this.strokeColor=this.drawStyleService.getStrokeColor(),this.strokeWidth=this.drawStyleService.getStrokeWidth(),this.labelsAreShown=this.drawStyleService.getLabelsAreShown(),this.icons=this.drawIconService.getIcons(),this.icon=this.drawStyleService.getIcon()}ngOnInit(){this.initStore(),this.drawControl=this.createDrawControl(this.fillColor,this.strokeColor,this.strokeWidth),this.drawControl.setGeometryType(this.geometryType.Point),this.toggleDrawControl()}ngOnDestroy(){this.drawControl.setOlMap(void 0),this.subscriptions$$.map(e=>e.unsubscribe())}createDrawControl(e,t,o){return new sh({geometryType:void 0,drawingLayerSource:this.olDrawingLayerSource,drawingLayerStyle:new Un.ZP({}),interactionStyle:kh(e,t,o)})}onGeometryTypeChange(e){this.drawControl.setGeometryType(e),this.toggleDrawControl()}initStore(){this.map.removeLayer(this.olDrawingLayer),this.olDrawingLayer=new fc({id:"igo-draw-layer",title:this.languageService.translate.instant("igo.geo.draw.drawing"),zIndex:200,source:new nc,style:(e,t)=>this.drawStyleService.createDrawingLayerStyle(e,t,this.labelsAreShown,this.icon),showInLayerList:!0,exportable:!0,browsable:!1,workspace:{enabled:!1}}),Bc(this.store,this.olDrawingLayer),Wc(this.store,new Yc({motion:Fl.None})),Xc(this.store,new Vc({map:this.map,motion:Fl.None,many:!0})),this.store.layer.visible=!0,this.store.source.ol.on("removefeature",e=>{const t=e.feature.getGeometry();this.clearLabelsOfOlGeometry(t)}),this.subscriptions$$.push(this.store.stateView.manyBy$(e=>!0===e.state.selected).pipe((0,Oe.T)(1)).subscribe(e=>{this.selectedFeatures$.next(e.map(e=>e.entity))})),this.subscriptions$$.push(this.store.count$.subscribe(e=>{this.store.layer.options.showInLayerList=e>=1}))}onColorChange(e,t){this.fillForm=this.fillColor,this.strokeForm=this.strokeColor,this.drawStyleService.setFillColor(this.fillColor),this.drawStyleService.setStrokeColor(this.strokeColor),t?(this.store.layer.ol.setStyle((t,o)=>this.drawStyleService.createDrawingLayerStyle(t,o,e,this.icon)),this.icon=void 0):this.store.layer.ol.setStyle((t,o)=>this.drawStyleService.createDrawingLayerStyle(t,o,e)),this.createDrawControl()}onToggleDrawControl(e){e?this.toggleDrawControl():this.deactivateDrawControl()}toggleDrawControl(){this.deactivateDrawControl(),this.activateDrawControl()}openDialog(e,t){setTimeout(()=>{this.dialog.open(nh,{disableClose:!1,data:{currentLabel:e.get("draw")}}).afterClosed().subscribe(o=>{this.updateLabelOfOlGeometry(e,o),t?this.onDrawEnd(e):this.onSelectDraw(e,o)})},250)}activateDrawControl(){this.drawControlIsDisabled=!1,this.drawControlIsActive=!0,this.drawEnd$$=this.drawControl.end$.subscribe(e=>{this.openDialog(e,!0)}),this.drawControl.modify$.subscribe(e=>{this.onModifyDraw(e)}),this.drawSelect$$||(this.drawSelect$$=this.drawControl.select$.subscribe(e=>{this.openDialog(e,!1)})),this.drawControl.setOlMap(this.map.ol,!0)}deactivateDrawControl(){!this.drawControl||(this.drawEnd$$&&this.drawEnd$$.unsubscribe(),this.drawControl.setOlMap(void 0),this.drawControlIsActive=!1)}onDrawEnd(e,t){this.addFeatureToStore(e,t),this.clearLabelsOfOlGeometry(e),this.store.layer.ol.getSource().refresh()}onModifyDraw(e){this.store.all().forEach(t=>{t.properties.id===e.ol_uid&&(this.updateLabelOfOlGeometry(e,t.properties.draw),this.replaceFeatureInStore(t,e))})}onSelectDraw(e,t){const o=this.store.all(),i=e.getGeometry();i.ol_uid=e.get("id");const r=JSON.stringify(i.getCoordinates()[0]);o.forEach(e=>{const o=JSON.stringify(e.geometry.coordinates[0]);if(r===o){const o=e.properties.rad?e.properties.rad:void 0;this.updateLabelOfOlGeometry(i,t),this.replaceFeatureInStore(e,i,o)}})}addFeatureToStore(e,t,o){let i,r,s,n,a;const l=o?o.properties.id:e.ol_uid,c=this.map.ol.getView().getProjection(),u=(new Xn.Z).writeGeometryObject(e,{featureProjection:c,dataProjection:c});if(e instanceof En.Z||t)if(t)i=t;else{u.type="Point",u.coordinates=e.getCenter();const t=(0,kn.vs)([e.getFlatCoordinates()[2],e.getFlatCoordinates()[3]],c,"EPSG:4326");r=(0,kn.vs)([e.getFlatCoordinates()[0],e.getFlatCoordinates()[1]],c,"EPSG:4326"),n=r[0],a=r[1],i=(0,rl.Sp)(r,t)}e instanceof _n.Z&&(s=(0,kn.vs)(e.getFlatCoordinates(),c,"EPSG:4326"),n=s[0],a=s[1]),this.store.update({type:Zl,geometry:u,projection:c.getCode(),properties:{id:l,draw:e.get("_label"),longitude:n||null,latitude:a||null,rad:i||null},meta:{id:l}})}replaceFeatureInStore(e,t,o){this.store.delete(e),this.onDrawEnd(t,o)}buildForm(){this.form=this.formBuilder.group({fill:[""],stroke:[""]})}deleteDrawings(){this.store.deleteMany(this.selectedFeatures$.value),this.selectedFeatures$.value.forEach(e=>{this.olDrawingLayerSource.getFeatures().forEach(t=>{const o=t.getGeometry();e.properties.id===o.ol_uid&&this.olDrawingLayerSource.removeFeature(t)})})}clearLabelsOfOlGeometry(e){Mh(e).forEach(e=>{e&&e.getMap()&&this.map.ol.removeOverlay(e)})}onToggleLabels(){this.drawStyleService.toggleLabelsAreShown(),this.labelsAreShown=!this.labelsAreShown,this.onColorChange(this.labelsAreShown,!!this.icon)}updateLabelOfOlGeometry(e,t){e.setProperties({_label:t},!0)}onIconChange(e){this.icon=e,this.drawStyleService.setIcon(this.icon),this.store.layer.ol.setStyle((e,t)=>this.drawStyleService.createDrawingLayerStyle(e,t,!0,this.icon))}openShorcutsDialog(){this.dialog.open(ah)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ue),r.Y36(We.qu),r.Y36(Ph),r.Y36(ze.uw),r.Y36(_h))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-draw"]],inputs:{map:"map",store:"store"},outputs:{fillColor:"fillColor",strokeColor:"strokeColor",strokeWidth:"strokeWidth"},decls:55,vars:78,consts:[[1,"geometry-type-toggle","mat-typography"],[3,"value","change"],[3,"value"],[1,"draw-options","mat-typography"],[3,"disabled","checked","labelPosition","change"],[3,"checked","labelPosition","change"],[1,"igo-form",3,"formGroup"],[1,"fill-color-picker","mat-typography"],["svgIcon","square",1,"stroke-palette-icon"],["appearance","outline","floatLabel","always","tooltip-position","below","matTooltipShowDelay","500",1,"fill-field",3,"matTooltip"],["formControlName","fill","matInput","","type","text",3,"colorPicker","readonly","cpWidth","cpOutputFormat","cpPosition","cpPositionOffset","cpCancelButton","cpCancelButtonText","cpOKButton","colorPickerChange"],[1,"stroke-color-picker","mat-typography"],["svgIcon","square-outline",1,"stroke-palette-icon"],["appearance","outline","floatLabel","always","tooltip-position","below","matTooltipShowDelay","500",1,"stroke-field",3,"matTooltip"],["formControlName","stroke","matInput","","type","text",3,"colorPicker","readonly","cpWidth","cpPosition","cpPositionOffset","cpOutputFormat","cpCancelButton","cpCancelButtonText","cpOKButton","colorPickerChange"],[4,"ngIf"],["class","deleteBtn","mat-icon-button","","color","warn","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","disabled","click",4,"ngIf"],[1,"table-compact",3,"store","template"],["table",""],["mat-icon-button","","color","accent","disableRipple","true",3,"click"],["svgIcon","keyboard-outline","tooltip-position","below","matTooltipShowDelay","500",1,"shortcuts-icon",3,"matTooltip"],["class","box",4,"ngIf"],["value","",3,"click"],[3,"value","click",4,"ngFor","ngForOf"],[1,"box"],[3,"src"],[3,"value","click"],["mat-icon-button","","color","warn","tooltip-position","below","matTooltipShowDelay","500",1,"deleteBtn",3,"matTooltip","disabled","click"],["svgIcon","delete"]],template:function(e,t){1&e&&(r.TgZ(0,"div"),r.TgZ(1,"div",0),r.TgZ(2,"mat-button-toggle-group",1),r.NdJ("change",function(e){return t.onGeometryTypeChange(e.value)}),r.TgZ(3,"mat-button-toggle",2),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.TgZ(6,"mat-button-toggle",2),r._uU(7),r.ALo(8,"translate"),r.qZA(),r.TgZ(9,"mat-button-toggle",2),r._uU(10),r.ALo(11,"translate"),r.qZA(),r.TgZ(12,"mat-button-toggle",2),r._uU(13),r.ALo(14,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(15,"div",3),r.TgZ(16,"mat-slide-toggle",4),r.NdJ("change",function(e){return t.onToggleDrawControl(e.checked)}),r._uU(17),r.ALo(18,"translate"),r.qZA(),r.TgZ(19,"mat-slide-toggle",5),r.NdJ("change",function(){return t.onToggleLabels()}),r._uU(20),r.ALo(21,"translate"),r.qZA(),r.qZA(),r.TgZ(22,"form",6),r.TgZ(23,"div",7),r.TgZ(24,"span"),r._UZ(25,"mat-icon",8),r._uU(26),r.ALo(27,"translate"),r.qZA(),r.TgZ(28,"mat-form-field",9),r.ALo(29,"translate"),r.TgZ(30,"mat-label"),r._uU(31),r.qZA(),r.TgZ(32,"input",10),r.NdJ("colorPickerChange",function(e){return t.fillColor=e})("colorPickerChange",function(){return t.onColorChange(t.labelsAreShown,!1)}),r.ALo(33,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(34,"div",11),r.TgZ(35,"span"),r._UZ(36,"mat-icon",12),r._uU(37),r.ALo(38,"translate"),r.qZA(),r.TgZ(39,"mat-form-field",13),r.ALo(40,"translate"),r.TgZ(41,"mat-label"),r._uU(42),r.qZA(),r.TgZ(43,"input",14),r.NdJ("colorPickerChange",function(e){return t.strokeColor=e})("colorPickerChange",function(){return t.onColorChange(t.labelsAreShown,!1)}),r.ALo(44,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(45,"div"),r.YNc(46,Dh,11,8,"mat-form-field",15),r.qZA(),r.qZA(),r._UZ(47,"mat-divider"),r.TgZ(48,"div"),r.YNc(49,Eh,4,6,"button",16),r._UZ(50,"igo-entity-table",17,18),r.qZA(),r.TgZ(52,"button",19),r.NdJ("click",function(){return t.openShorcutsDialog()}),r._UZ(53,"mat-icon",20),r.ALo(54,"translate"),r.qZA(),r.qZA()),2&e&&(r.xp6(2),r.Q6J("value",t.geometryType.Point),r.xp6(1),r.Q6J("value",t.geometryType.Point),r.xp6(1),r.hij(" ",r.lcZ(5,52,"igo.geo.draw."+t.geometryType.Point)," "),r.xp6(2),r.Q6J("value",t.geometryType.LineString),r.xp6(1),r.hij(" ",r.lcZ(8,54,"igo.geo.draw."+t.geometryType.LineString)," "),r.xp6(2),r.Q6J("value",t.geometryType.Polygon),r.xp6(1),r.hij(" ",r.lcZ(11,56,"igo.geo.draw."+t.geometryType.Polygon)," "),r.xp6(2),r.Q6J("value",t.geometryType.Circle),r.xp6(1),r.hij(" ",r.lcZ(14,58,"igo.geo.draw."+t.geometryType.Circle)," "),r.xp6(3),r.Q6J("disabled",t.drawControlIsDisabled)("checked",t.drawControlIsActive)("labelPosition","before"),r.xp6(1),r.hij(" ",r.lcZ(18,60,"igo.geo.spatialFilter.drawControl")," "),r.xp6(2),r.Q6J("checked",t.labelsAreShown)("labelPosition","before"),r.xp6(1),r.hij(" ",r.lcZ(21,62,"igo.geo.draw.toggleMapTooltips")," "),r.xp6(2),r.Q6J("formGroup",t.form),r.xp6(4),r.hij(" ",r.lcZ(27,64,"igo.geo.draw.fill")," "),r.xp6(2),r.Q6J("matTooltip",r.lcZ(29,66,"igo.geo.draw.colorPicker")),r.xp6(3),r.Oqu(t.fillColor),r.xp6(1),r.Udp("background",t.fillColor),r.Q6J("colorPicker",t.fillColor)("readonly",!0)("colorPicker",t.fillColor)("cpWidth","200px")("cpOutputFormat","rgba")("cpPosition","bottom")("cpPositionOffset","-75%")("cpCancelButton",!0)("cpCancelButtonText",r.lcZ(33,68,"igo.geo.draw.cancelColorPicker"))("cpOKButton",!0),r.xp6(5),r.hij(" ",r.lcZ(38,70,"igo.geo.draw.stroke")," "),r.xp6(2),r.Q6J("matTooltip",r.lcZ(40,72,"igo.geo.draw.colorPicker")),r.xp6(3),r.Oqu(t.strokeColor),r.xp6(1),r.Udp("background",t.strokeColor),r.Q6J("colorPicker",t.strokeColor)("readonly",!0)("colorPicker",t.strokeColor)("cpWidth","200px")("cpPosition","bottom")("cpPositionOffset","-75%")("cpOutputFormat","rgba")("cpCancelButton",!0)("cpCancelButtonText",r.lcZ(44,74,"igo.geo.draw.cancelColorPicker"))("cpOKButton",!0),r.xp6(3),r.Q6J("ngIf",t.icons.length>=1),r.xp6(3),r.Q6J("ngIf",t.store.count$.getValue()>0),r.xp6(1),r.Q6J("store",t.store)("template",t.tableTemplate),r.xp6(3),r.Q6J("matTooltip",r.lcZ(54,76,"igo.geo.draw.shortcuts")))},directives:[Ka.A9,Ka.Yi,Va.Rr,We._Y,We.JL,We.sg,a.Hw,De.KE,p.gM,De.hX,We.Fj,Ve.Nt,We.JJ,We.u,el.Kk,h.O5,Ha.d,uo,n.lW,Ee.gD,Ee.$L,Re.ey,h.sg],pipes:[j.X$,h.Ov],styles:[".geometry-type-toggle[_ngcontent-%COMP%]{padding:10px;text-align:center}.geometry-type-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]{width:100%}.geometry-type-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]{width:25%}.draw-options[_ngcontent-%COMP%]{overflow-x:hidden}.draw-options[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{width:100%;margin:10px}.draw-options[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content{width:calc(100% - 60px)}.igo-form[_ngcontent-%COMP%]{padding:10px}.fill-field[_ngcontent-%COMP%], .stroke-field[_ngcontent-%COMP%]{width:130px}.fill-color-picker[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{position:relative;top:7px}.fill-color-picker[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{left:8px}.stroke-color-picker[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{position:relative;top:7px}.stroke-color-picker[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{left:35px}.box[_ngcontent-%COMP%]{width:25px;height:25px}img[_ngcontent-%COMP%]{width:100%;height:100%}.deleteBtn[_ngcontent-%COMP%]{margin-left:12px}"],changeDetection:0}),e})(),Uh=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[We.u5,We.UX,h.ez,n.ot,Ka.vV,Ha.t,De.lN,a.Ps,p.AV,De.lN,Ve.c,l.ie,Ee.LD,Va.rP,ze.Is,ne,Ti,el.e4]]}),e})(),Nh=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,a.Ps,ne,_i,Ci]]}),e})(),Jh=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,bi],bi]}),e})(),Bh=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[],imports:[[h.ez],Nh,Jh]}),e})();class jh{constructor(e){this.options=e,this.start$=new O.xQ,this.end$=new O.xQ,this.changes$=new O.xQ,this.olModifyInteractionIsActive=!1,this.olTranslateInteractionIsActive=!1,this.olDrawInteractionIsActive=!1,this.removedOlInteractions=[],this.modify=!0,this.translate=!0,void 0!==e.modify&&(this.modify=e.modify),void 0!==e.translate&&(this.translate=e.translate),this.olOverlayLayer=void 0!==e.layer?e.layer:this.createOlInnerOverlayLayer(),this.olLinearRingsLayer=this.createOlLinearRingsLayer()}get active(){return void 0!==this.olMap}get olOverlaySource(){return this.olOverlayLayer.getSource()}get olLinearRingsSource(){return this.olLinearRingsLayer.getSource()}setOlMap(e){if(void 0===e)return this.clearOlInnerOverlaySource(),this.removeOlInnerOverlayLayer(),this.removeOlModifyInteraction(),this.removeOlTranslateInteraction(),this.removeOlDrawInteraction(),void(this.olMap=e);this.olMap=e,this.addOlInnerOverlayLayer(),!0===this.modify&&this.addOlDrawInteraction(),!0===this.translate&&(this.addOlTranslateInteraction(),this.activateTranslateInteraction()),!0===this.modify&&(this.addOlModifyInteraction(),this.activateModifyInteraction())}getSource(){return this.olOverlaySource}setOlGeometry(e){const t=new Fn.Z({geometry:e});this.olOverlaySource.clear(),this.olOverlaySource.addFeature(t)}createOlInnerOverlayLayer(){return new Kn.Z({source:this.options.source?this.options.source:new Aa.Z,style:this.options.layerStyle,zIndex:500})}addOlInnerOverlayLayer(){void 0===this.options.layer&&this.olMap.addLayer(this.olOverlayLayer)}removeOlInnerOverlayLayer(){void 0===this.options.layer&&void 0!==this.olMap&&this.olMap.removeLayer(this.olOverlayLayer)}clearOlInnerOverlaySource(){void 0===this.options.layer&&void 0===this.options.source&&this.olOverlaySource.clear(!0)}createOlLinearRingsLayer(){return new Kn.Z({source:new Aa.Z,style:ih(),zIndex:500})}addOlLinearRingsLayer(){this.olMap.addLayer(this.olLinearRingsLayer)}removeOlLinearRingsLayer(){this.olMap.removeLayer(this.olLinearRingsLayer)}clearOlLinearRingsSource(){this.olLinearRingsSource.clear(!0)}addOlModifyInteraction(){const e=new ol.Z({source:this.olOverlaySource,style:this.options.drawStyle});this.olModifyInteraction=e}removeOlModifyInteraction(){void 0!==this.olModifyInteraction&&(this.deactivateModifyInteraction(),this.olModifyInteraction=void 0)}activateModifyInteraction(){!0!==this.olModifyInteractionIsActive&&(this.olModifyInteractionIsActive=!0,this.onModifyStartKey=this.olModifyInteraction.on("modifystart",e=>this.onModifyStart(e)),this.onModifyEndKey=this.olModifyInteraction.on("modifyend",e=>this.onModifyEnd(e)),this.olMap.addInteraction(this.olModifyInteraction))}deactivateModifyInteraction(){!1!==this.olModifyInteractionIsActive&&(this.olModifyInteractionIsActive=!1,(0,ea.B)([this.onModifyStartKey,this.onModifyEndKey,this.onModifyKey]),void 0!==this.olMap&&this.olMap.removeInteraction(this.olModifyInteraction))}onModifyStart(e){const t=e.features.item(0).getGeometry();this.start$.next(t),this.onModifyKey=t.on("change",e=>{this.mousePosition=rh(e),this.changes$.next(e.target)}),this.subscribeToKeyDown()}onModifyEnd(e){(0,ea.B)(this.onModifyKey),this.end$.next(e.features.item(0).getGeometry()),this.unsubscribeToKeyDown()}subscribeToKeyDown(){this.keyDown$$=(0,Z.R)(document,"keydown").subscribe(e=>{" "!==e.key||this.olMap.getView().animate({center:this.mousePosition,duration:0})})}unsubscribeToKeyDown(){void 0!==this.keyDown$$&&this.keyDown$$.unsubscribe()}addOlTranslateInteraction(){const e=new Dn.Z({layers:[this.olOverlayLayer]});this.olTranslateInteraction=e}removeOlTranslateInteraction(){void 0!==this.olTranslateInteraction&&(this.deactivateTranslateInteraction(),this.olTranslateInteraction=void 0)}activateTranslateInteraction(){!0!==this.olTranslateInteractionIsActive&&(this.olTranslateInteractionIsActive=!0,this.onTranslateStartKey=this.olTranslateInteraction.on("translatestart",e=>this.onTranslateStart(e)),this.onTranslateEndKey=this.olTranslateInteraction.on("translateend",e=>this.onTranslateEnd(e)),this.olMap.addInteraction(this.olTranslateInteraction))}deactivateTranslateInteraction(){!1!==this.olTranslateInteractionIsActive&&(this.olTranslateInteractionIsActive=!1,(0,ea.B)([this.onTranslateStartKey,this.onTranslateEndKey,this.onTranslateKey]),void 0!==this.olMap&&this.olMap.removeInteraction(this.olTranslateInteraction))}onTranslateStart(e){const t=e.features.item(0).getGeometry();this.start$.next(t),this.onTranslateKey=t.on("change",e=>{})}onTranslateEnd(e){(0,ea.B)(this.onTranslateKey),this.end$.next(e.features.item(0).getGeometry())}addOlDrawInteraction(){const e=new tl.ZP({type:"Polygon",source:this.olLinearRingsSource,stopClick:!0,style:ih(),condition:e=>(this.olOuterGeometry||this.getOlGeometry()).intersectsCoordinate(e.coordinate)});this.olDrawInteraction=e,this.subscribeToDrawKeyDown()}subscribeToDrawKeyDown(){this.drawKeyDown$$=(0,Z.R)(document,"keydown").subscribe(e=>{if("Control"!==e.key)return;this.unsubscribeToDrawKeyDown();const t=this.getOlGeometry();!t||!(t instanceof Vn.ZP)||(this.subscribeToDrawKeyUp(),this.deactivateModifyInteraction(),this.deactivateTranslateInteraction(),this.activateDrawInteraction())})}subscribeToDrawKeyUp(){this.drawKeyUp$$=(0,Z.R)(document,"keyup").subscribe(e=>{"Control"===e.key&&(this.unsubscribeToDrawKeyUp(),this.unsubscribeToKeyDown(),this.deactivateDrawInteraction(),this.activateModifyInteraction(),!0===this.translate&&this.activateTranslateInteraction(),this.subscribeToDrawKeyDown(),this.olOuterGeometry=void 0,this.clearOlLinearRingsSource(),this.end$.next(this.getOlGeometry()))})}unsubscribeToDrawKeyDown(){void 0!==this.drawKeyDown$$&&this.drawKeyDown$$.unsubscribe()}unsubscribeToDrawKeyUp(){void 0!==this.drawKeyUp$$&&this.drawKeyUp$$.unsubscribe()}removeOlDrawInteraction(){void 0!==this.olDrawInteraction&&(this.unsubscribeToKeyDown(),this.unsubscribeToDrawKeyUp(),this.unsubscribeToDrawKeyDown(),this.deactivateDrawInteraction(),this.clearOlLinearRingsSource(),this.olDrawInteraction=void 0)}activateDrawInteraction(){!0!==this.olDrawInteractionIsActive&&(this.clearOlLinearRingsSource(),this.addOlLinearRingsLayer(),this.olMap.getInteractions().forEach(e=>{e instanceof Ra.Z&&(this.olMap.removeInteraction(e),this.removedOlInteractions.push(e))}),this.olDrawInteractionIsActive=!0,this.onDrawStartKey=this.olDrawInteraction.on("drawstart",e=>this.onDrawStart(e)),this.onDrawEndKey=this.olDrawInteraction.on("drawend",e=>this.onDrawEnd(e)),this.olMap.addInteraction(this.olDrawInteraction))}deactivateDrawInteraction(){!1!==this.olDrawInteractionIsActive&&(this.removeOlLinearRingsLayer(),this.removedOlInteractions.forEach(e=>{this.olMap.addInteraction(e)}),this.removedOlInteractions=[],this.olDrawInteractionIsActive=!1,(0,ea.B)([this.onDrawStartKey,this.onDrawEndKey,this.onDrawKey]),void 0!==this.olMap&&this.olMap.removeInteraction(this.olDrawInteraction))}onDrawStart(e){const t=e.feature.getGeometry();this.olOuterGeometry=this.getOlGeometry().clone();const o=t.getLinearRing().getCoordinates();this.addLinearRingToOlGeometry(o),this.start$.next(this.getOlGeometry()),this.onDrawKey=t.on("change",e=>{this.mousePosition=rh(e);const t=e.target.getLinearRing(0).getCoordinates();this.updateLinearRingOfOlGeometry(t),this.changes$.next(this.getOlGeometry())}),this.subscribeToKeyDown()}onDrawEnd(e){(0,ea.B)(this.onDrawKey),this.olOuterGeometry=void 0;const t=e.feature.getGeometry().getLinearRing().getCoordinates();this.updateLinearRingOfOlGeometry(t),this.clearOlLinearRingsSource(),this.end$.next(this.getOlGeometry()),this.unsubscribeToKeyDown()}addLinearRingToOlGeometry(e){!function(e,t){e.appendLinearRing(t)}(this.getOlGeometry(),new dl.Z(e))}updateLinearRingOfOlGeometry(e){const t=this.getOlGeometry(),o=t.getLinearRings().slice(0,-1).map(e=>e.getCoordinates());o.push(e),t.setCoordinates(o)}getOlGeometry(){const e=this.olOverlaySource.getFeatures();return e.length>0?e[0].getGeometry():void 0}}const Qh="Layer";function Gh(e,t){if(1&e&&(r.TgZ(0,"table",2),r.TgZ(1,"thead"),r.TgZ(2,"tr"),r.TgZ(3,"th",3),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(6,"tbody"),r.TgZ(7,"tr"),r.TgZ(8,"td"),r._uU(9),r.ALo(10,"measureFormat"),r.qZA(),r.TgZ(11,"td"),r._uU(12),r.ALo(13,"translate"),r.qZA(),r.qZA(),r.TgZ(14,"tr"),r.TgZ(15,"td"),r._uU(16),r.ALo(17,"measureFormat"),r.qZA(),r.TgZ(18,"td"),r._uU(19),r.ALo(20,"translate"),r.qZA(),r.qZA(),r.TgZ(21,"tr"),r.TgZ(22,"td"),r._uU(23),r.ALo(24,"measureFormat"),r.qZA(),r.TgZ(25,"td"),r._uU(26),r.ALo(27,"translate"),r.qZA(),r.qZA(),r.TgZ(28,"tr"),r.TgZ(29,"td"),r._uU(30),r.ALo(31,"measureFormat"),r.qZA(),r.TgZ(32,"td"),r._uU(33),r.ALo(34,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(4),r.Oqu(r.lcZ(5,9,"igo.geo.measure.dialog.length.title")),r.xp6(5),r.Oqu(r.xi3(10,11,e.data.length,e.measureLengthUnit.Meters)),r.xp6(3),r.Oqu(r.lcZ(13,14,"igo.geo.measure.dialog.lengthInMeters")),r.xp6(4),r.Oqu(r.xi3(17,16,e.data.length,e.measureLengthUnit.Kilometers)),r.xp6(3),r.Oqu(r.lcZ(20,19,"igo.geo.measure.dialog.lengthInKilometers")),r.xp6(4),r.Oqu(r.xi3(24,21,e.data.length,e.measureLengthUnit.Miles)),r.xp6(3),r.Oqu(r.lcZ(27,24,"igo.geo.measure.dialog.lengthInMiles")),r.xp6(4),r.Oqu(r.xi3(31,26,e.data.length,e.measureLengthUnit.Feet)),r.xp6(3),r.Oqu(r.lcZ(34,29,"igo.geo.measure.dialog.lengthInFeet"))}}function Yh(e,t){if(1&e&&(r.TgZ(0,"table",2),r.TgZ(1,"thead"),r.TgZ(2,"tr"),r.TgZ(3,"th",3),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(6,"tbody"),r.TgZ(7,"tr"),r.TgZ(8,"td"),r._uU(9),r.ALo(10,"measureFormat"),r.qZA(),r.TgZ(11,"td"),r._uU(12),r.ALo(13,"translate"),r.qZA(),r.qZA(),r.TgZ(14,"tr"),r.TgZ(15,"td"),r._uU(16),r.ALo(17,"measureFormat"),r.qZA(),r.TgZ(18,"td"),r._uU(19),r.ALo(20,"translate"),r.qZA(),r.qZA(),r.TgZ(21,"tr"),r.TgZ(22,"td"),r._uU(23),r.ALo(24,"measureFormat"),r.qZA(),r.TgZ(25,"td"),r._uU(26),r.ALo(27,"translate"),r.qZA(),r.qZA(),r.TgZ(28,"tr"),r.TgZ(29,"td"),r._uU(30),r.ALo(31,"measureFormat"),r.qZA(),r.TgZ(32,"td"),r._uU(33),r.ALo(34,"translate"),r.qZA(),r.qZA(),r.TgZ(35,"tr"),r.TgZ(36,"td"),r._uU(37),r.ALo(38,"measureFormat"),r.qZA(),r.TgZ(39,"td"),r._uU(40),r.ALo(41,"translate"),r.qZA(),r.qZA(),r.TgZ(42,"tr"),r.TgZ(43,"td"),r._uU(44),r.ALo(45,"translate"),r.qZA(),r.TgZ(46,"td"),r._uU(47),r.ALo(48,"measureFormat"),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(4),r.Oqu(r.lcZ(5,13,"igo.geo.measure.dialog.area.title")),r.xp6(5),r.Oqu(r.xi3(10,15,e.data.area,e.measureAreaUnit.SquareMeters)),r.xp6(3),r.Oqu(r.lcZ(13,18,"igo.geo.measure.dialog.areaInSquareMeters")),r.xp6(4),r.Oqu(r.xi3(17,20,e.data.area,e.measureAreaUnit.SquareKilometers)),r.xp6(3),r.Oqu(r.lcZ(20,23,"igo.geo.measure.dialog.areaInSquareKilometers")),r.xp6(4),r.Oqu(r.xi3(24,25,e.data.area,e.measureAreaUnit.SquareMiles)),r.xp6(3),r.Oqu(r.lcZ(27,28,"igo.geo.measure.dialog.areaInSquareMiles")),r.xp6(4),r.Oqu(r.xi3(31,30,e.data.area,e.measureAreaUnit.Acres)),r.xp6(3),r.Oqu(r.lcZ(34,33,"igo.geo.measure.dialog.areaInAcres")),r.xp6(4),r.Oqu(r.xi3(38,35,e.data.area,e.measureAreaUnit.Hectares)),r.xp6(3),r.Oqu(r.lcZ(41,38,"igo.geo.measure.dialog.areaInHectares")),r.xp6(4),r.Oqu(r.lcZ(45,40,"igo.geo.measure.dialog.perimeterInMeters")),r.xp6(3),r.Oqu(r.xi3(48,42,e.data.perimeter,e.measureLengthUnit.Meters))}}let zh=(()=>{class e{constructor(e,t){this.dialogRef=e,this.data=t,this.measureAreaUnit=ph,this.measureLengthUnit=ch}onNoClick(){this.dialogRef.close()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ze.so),r.Y36(ze.WI))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-measurer-dialog"]],decls:5,vars:5,consts:[["mat-dialog-title",""],["class","mat-typography",4,"ngIf"],[1,"mat-typography"],["colspan","2"]],template:function(e,t){1&e&&(r.TgZ(0,"h3",0),r._uU(1),r.ALo(2,"translate"),r.qZA(),r.YNc(3,Gh,35,31,"table",1),r.YNc(4,Yh,49,45,"table",1)),2&e&&(r.xp6(1),r.Oqu(r.lcZ(2,3,"igo.geo.measure.dialog.title")),r.xp6(2),r.Q6J("ngIf",t.data.length>0),r.xp6(1),r.Q6J("ngIf",t.data.area>0))},styles:['[_nghost-%COMP%]{font-family:Roboto,"Helvetica Neue",sans-serif}h3[_ngcontent-%COMP%]{text-align:center;margin:0}table[_ngcontent-%COMP%]{width:100%;padding:10px}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{padding-left:10px}']}),e})();const Hh=["table"];function Vh(e,t){1&e&&r._UZ(0,"mat-divider")}function Wh(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-slide-toggle",7),r.NdJ("change",function(t){return r.CHM(e),r.oxw().onToggleDisplayLines(t.checked)}),r._uU(1),r.ALo(2,"translate"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("checked",e.displayLines)("labelPosition","before"),r.xp6(1),r.hij(" ",r.lcZ(2,3,"igo.geo.measure.toggleDisplayLines")," ")}}function Xh(e,t){1&e&&r._UZ(0,"mat-divider")}function Kh(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-slide-toggle",7),r.NdJ("change",function(t){return r.CHM(e),r.oxw().onToggleDisplayDistance(t.checked)}),r._uU(1),r.ALo(2,"translate"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("checked",e.displayDistance)("labelPosition","before"),r.xp6(1),r.hij(" ",r.lcZ(2,3,"igo.geo.measure.toggleDisplayDistance")," ")}}function eg(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-slide-toggle",7),r.NdJ("change",function(t){return r.CHM(e),r.oxw().onToggleDisplayAreas(t.checked)}),r._uU(1),r.ALo(2,"translate"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("checked",e.displayAreas)("labelPosition","before"),r.xp6(1),r.hij(" ",r.lcZ(2,3,"igo.geo.measure.toggleDisplayAreas")," ")}}function tg(e,t){1&e&&r._UZ(0,"mat-divider")}function og(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-measurer-item",14),r.NdJ("measureUnitChange",function(t){return r.CHM(e),r.oxw(2).onLengthUnitChange(t)}),r.ALo(1,"translate"),r.qZA()}if(2&e){const e=r.oxw().ngIf,t=r.oxw();r.Q6J("measureType",t.measureType.Length)("measureUnit",t.measureLengthUnit.Meters)("measure",e.length)("auto",t.measureUnitsAuto)("placeholder",r.lcZ(1,5,t.activeMeasureType===t.measureType.Area?"igo.geo.measure.perimeter":"igo.geo.measure.length"))}}function ig(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-measurer-item",14),r.NdJ("measureUnitChange",function(t){return r.CHM(e),r.oxw(2).onAreaUnitChange(t)}),r.ALo(1,"translate"),r.qZA()}if(2&e){const e=r.oxw().ngIf,t=r.oxw();r.Q6J("measureType",t.measureType.Area)("measureUnit",t.measureAreaUnit.SquareMeters)("measure",e.area)("auto",t.measureUnitsAuto)("placeholder",r.lcZ(1,5,"igo.geo.measure.area"))}}function rg(e,t){if(1&e&&(r.ynx(0),r.YNc(1,og,2,7,"igo-measurer-item",13),r.YNc(2,ig,2,7,"igo-measurer-item",13),r.BQk()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf",e.activeMeasureType===e.measureType.Length||e.activeMeasureType===e.measureType.Area),r.xp6(1),r.Q6J("ngIf",e.activeMeasureType===e.measureType.Area)}}function sg(e,t){1&e&&r._UZ(0,"mat-divider")}function ng(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",15),r.NdJ("click",function(){return r.CHM(e),r.oxw().onCalculateClick()}),r.ALo(1,"translate"),r.ALo(2,"async"),r._UZ(3,"mat-icon",16),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("matTooltip",r.lcZ(1,2,"igo.geo.measure.actionbar.calculate.tooltip"))("disabled",0===r.lcZ(2,4,e.selectedFeatures$).length)}}function ag(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",17),r.NdJ("click",function(){return r.CHM(e),r.oxw().onDeleteClick()}),r.ALo(1,"translate"),r.ALo(2,"async"),r._UZ(3,"mat-icon",18),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("matTooltip",r.lcZ(1,2,"igo.geo.measure.actionbar.delete.tooltip"))("disabled",0===r.lcZ(2,4,e.selectedFeatures$).length)}}let lg=(()=>{class e{constructor(e,t,o){this.languageService=e,this.dialog=t,this.storageService=o,this.tableTemplate={selection:!0,selectMany:!0,selectionCheckbox:!0,sort:!0,columns:[{name:"length",title:this.languageService.translate.instant("igo.geo.measure.lengthHeader"),valueAccessor:e=>{const t=this.activeLengthUnit;return Ch(wh(e.properties.measure.length,t),{decimal:1,unit:t,unitAbbr:!1,locale:"fr"})}},{name:"area",title:this.languageService.translate.instant("igo.geo.measure.areaHeader"),valueAccessor:e=>{const t=this.activeAreaUnit,o=Sh(e.properties.measure.area,t);return o?Ch(o,{decimal:1,unit:t,unitAbbr:!1,locale:"fr"}):""}}]},this.subscriptions$$=[],this.measureType=lh,this.measureAreaUnit=ph,this.measureLengthUnit=ch,this.measureUnitsAuto=!1,this.displayDistance=!0,this.displayLines=!0,this.displayAreas=!0,this.hasLine$=new C.X(!1),this.hasArea$=new C.X(!1),this.measure$=new C.X({}),this.selectedFeatures$=new C.X([]),this.showTooltips=!0,this.drawControlIsDisabled=!0,this.activeLengthUnit=ch.Meters,this.activeAreaUnit=ph.SquareMeters,this.olDrawSource=new Aa.Z,this.minSegmentLength=10}set activeMeasureType(e){this.setActiveMeasureType(e)}get activeMeasureType(){return this._activeMeasureType}get drawControlIsActive(){return void 0!==this.activeDrawControl}get projection(){return this.map.ol.getView().getProjection().getCode()}ngOnInit(){this.initStore(),this.createDrawLineControl(),this.createDrawPolygonControl(),this.createModifyControl(),this.toggleDrawControl(),this.updateTooltipsOfOlSource(this.store.source.ol),this.checkDistanceAreaToggle(),this.setActiveMeasureType(lh.Length)}ngOnDestroy(){this.setActiveMeasureType(void 0),this.deactivateModifyControl(),this.freezeStore(),this.subscriptions$$.map(e=>e.unsubscribe())}onMeasureTypeChange(e){this.activeMeasureType=e}onToggleDrawControl(e){!0===e?this.toggleDrawControl():this.deactivateDrawControl()}onToggleMeasureUnitsAuto(e){this.measureUnitsAuto=e}onToggleDisplayDistance(e){this.displayDistance=e,this.onDisplayDistance(),this.storageService.set("distanceToggle",!!e,xe.SESSION)}onToggleDisplayLines(e){this.displayLines=e,this.onDisplayLines(),this.storageService.set("linesToggle",!!e,xe.SESSION)}onToggleDisplayAreas(e){this.displayAreas=e,this.onDisplayAreas(),this.storageService.set("areasToggle",!!e,xe.SESSION)}checkDistanceAreaToggle(){!1===this.storageService.get("distanceToggle")&&(this.displayDistance=!1),!1===this.storageService.get("linesToggle")&&(this.displayLines=!1),!1===this.storageService.get("areasToggle")&&(this.displayAreas=!1)}onDisplayDistance(){this.displayDistance?Array.from(document.getElementsByClassName("igo-map-tooltip-measure-polygone-segments")).map(e=>e.classList.remove("igo-map-tooltip-hidden")):Array.from(document.getElementsByClassName("igo-map-tooltip-measure-polygone-segments")).map(e=>e.classList.add("igo-map-tooltip-hidden"))}onDisplayLines(){this.displayLines?Array.from(document.getElementsByClassName("igo-map-tooltip-measure-line-segments")).map(e=>e.classList.remove("igo-map-tooltip-hidden")):Array.from(document.getElementsByClassName("igo-map-tooltip-measure-line-segments")).map(e=>e.classList.add("igo-map-tooltip-hidden"))}onDisplayAreas(){this.displayAreas?Array.from(document.getElementsByClassName("igo-map-tooltip-measure-area")).map(e=>e.classList.remove("igo-map-tooltip-hidden")):Array.from(document.getElementsByClassName("igo-map-tooltip-measure-area")).map(e=>e.classList.add("igo-map-tooltip-hidden"))}onLengthUnitChange(e){this.activeLengthUnit=e,this.table.refresh(),this.updateTooltipsOfOlSource(this.store.source.ol),void 0!==this.activeOlGeometry&&this.updateTooltipsOfOlGeometry(this.activeOlGeometry)}onAreaUnitChange(e){this.activeAreaUnit=e,this.table.refresh(),this.updateTooltipsOfOlSource(this.store.source.ol),void 0!==this.activeOlGeometry&&this.updateTooltipsOfOlGeometry(this.activeOlGeometry)}onCalculateClick(){const e=this.selectedFeatures$.value,t=e.reduce((e,t)=>e+t.properties.measure.area||0,0),o=e.reduce((e,t)=>"Polygon"===t.geometry.type?e:e+t.properties.measure.length||0,0),i=e.reduce((e,t)=>"LineString"===t.geometry.type?e:e+t.properties.measure.length||0,0);this.openDialog({area:t,length:o,perimeter:i})}onDeleteClick(){this.store.deleteMany(this.selectedFeatures$.value),this.selectedFeatures$.value.forEach(e=>{this.olDrawSource.getFeatures().forEach(t=>{const o=t.getGeometry();e.properties.id===o.ol_uid&&this.olDrawSource.removeFeature(t)})})}onModifyClick(){if(1===this.selectedFeatures$.value.length)if(!0===this.modifyControl.active)this.deactivateModifyControl(),this.toggleDrawControl();else{const e=this.selectedFeatures$.value[0],t=this.store.layer.ol.getSource().getFeatures().find(t=>t.get("id")===e.properties.id);if(void 0!==t){this.deactivateDrawControl(),this.activateModifyControl();const e=t.getGeometry();this.clearTooltipsOfOlGeometry(e),this.modifyControl.setOlGeometry(e)}}}openDialog(e){this.dialog.open(zh,{data:e})}initStore(){const e=this.store,t=new fc({title:this.languageService.translate.instant("igo.geo.measure.layerTitle"),id:`igo-measures-${N()}`,zIndex:200,source:new nc,style:new Un.ZP({stroke:new jn.Z({color:"#ffcc33",width:2}),fill:new Jn.Z({color:"rgba(255, 255, 255, 0.2)"})}),showInLayerList:!0,exportable:!1,browsable:!1,workspace:{enabled:!1}});Bc(e,t),e.layer.visible=!0,t.visible$.subscribe(e=>{e?Array.from(document.getElementsByClassName("igo-map-tooltip-measure")).map(e=>e.classList.remove("igo-map-tooltip-measure-by-display")):Array.from(document.getElementsByClassName("igo-map-tooltip-measure")).map(e=>e.classList.add("igo-map-tooltip-measure-by-display"))}),Wc(e),Xc(e,new Vc({map:this.map,many:!0})),this.onFeatureAddedKey=e.source.ol.on("addfeature",e=>{const t=e.feature,o=t.getGeometry();this.updateMeasureOfOlGeometry(o,t.get("measure")),this.onDisplayDistance()}),this.onFeatureRemovedKey=e.source.ol.on("removefeature",e=>{const t=e.feature.getGeometry();this.clearTooltipsOfOlGeometry(t)}),this.selectedFeatures$$=e.stateView.manyBy$(e=>!0===e.state.selected).pipe((0,Oe.T)(1)).subscribe(e=>{!0===this.modifyControl.active&&this.deactivateModifyControl(),this.selectedFeatures$.next(e.map(e=>e.entity))}),this.subscriptions$$.push(this.store.entities$.subscribe(e=>{e.find(e=>"Polygon"===e.geometry.type)?this.hasArea$.next(!0):this.hasArea$.next(!1),e.find(e=>"LineString"===e.geometry.type)?this.hasLine$.next(!0):this.hasLine$.next(!1)})),this.subscriptions$$.push(this.store.count$.subscribe(e=>{this.store.layer.options.showInLayerList=e>=1}))}freezeStore(){const e=this.store;this.selectedFeatures$$.unsubscribe(),(0,ea.B)(this.onFeatureAddedKey),(0,ea.B)(this.onFeatureRemovedKey),e.deactivateStrategyOfType(Yc),e.deactivateStrategyOfType(Vc)}createDrawLineControl(){this.drawLineControl=new sh({geometryType:"LineString",drawingLayerSource:this.olDrawSource,interactionStyle:Th(),drawingLayerStyle:new Un.ZP({})})}createDrawPolygonControl(){this.drawPolygonControl=new sh({geometryType:"Polygon",drawingLayerSource:this.olDrawSource,interactionStyle:Th(),drawingLayerStyle:new Un.ZP({})})}createModifyControl(){this.modifyControl=new jh({source:this.olDrawSource,drawStyle:Th(),layerStyle:new Un.ZP({})})}toggleDrawControl(){this.deactivateDrawControl(),this.activeMeasureType===lh.Length?this.activateDrawControl(this.drawLineControl):this.activeMeasureType===lh.Area&&this.activateDrawControl(this.drawPolygonControl)}activateDrawControl(e){this.drawControlIsDisabled=!1,this.activeDrawControl=e,this.drawStart$$=e.start$.subscribe(e=>this.onDrawStart(e)),this.drawEnd$$=e.end$.subscribe(e=>this.onDrawEnd(e)),this.drawChanges$$=e.changes$.subscribe(e=>this.onDrawChanges(e)),e.setOlMap(this.map.ol,!1)}deactivateDrawControl(){void 0!==this.activeDrawControl&&(this.olDrawSource.clear(),void 0!==this.drawStart$$&&this.drawStart$$.unsubscribe(),void 0!==this.drawEnd$$&&this.drawEnd$$.unsubscribe(),void 0!==this.drawChanges$$&&this.drawChanges$$.unsubscribe(),this.clearTooltipsOfOlSource(this.olDrawSource),void 0!==this.activeOlGeometry&&this.clearTooltipsOfOlGeometry(this.activeOlGeometry),this.activeDrawControl.setOlMap(void 0),this.activeDrawControl=void 0,this.activeOlGeometry=void 0)}setActiveMeasureType(e){this._activeMeasureType=e,this.clearMeasures(),this.toggleDrawControl()}onDrawStart(e){this.activeOlGeometry=e}onDrawEnd(e){this.activeOlGeometry=void 0,this.finalizeMeasureOfOlGeometry(e),this.addFeatureToStore(e),this.clearTooltipsOfOlGeometry(e),this.olDrawSource.clear(!0)}onDrawChanges(e){const t=Lh(e,this.projection);this.updateMeasureOfOlGeometry(e,Object.assign({},t,{area:void 0})),this.measure$.next(t)}activateModifyControl(){const e=this.store.getStrategyOfType(Vc);e.deactivate(),e.clear(),this.modifyStart$$=this.modifyControl.start$.subscribe(e=>this.onModifyStart(e)),this.modifyEnd$$=this.modifyControl.end$.subscribe(e=>this.onModifyEnd(e)),this.modifyChanges$$=this.modifyControl.changes$.subscribe(e=>this.onModifyChanges(e)),this.modifyControl.setOlMap(this.map.ol)}deactivateModifyControl(){void 0!==this.modifyStart$$&&this.modifyStart$$.unsubscribe(),void 0!==this.modifyEnd$$&&this.modifyEnd$$.unsubscribe(),void 0!==this.modifyChanges$$&&this.modifyChanges$$.unsubscribe(),void 0!==this.activeOlGeometry&&(1===this.selectedFeatures$.value.length&&this.addFeatureToStore(this.activeOlGeometry,this.selectedFeatures$.value[0]),this.finalizeMeasureOfOlGeometry(this.activeOlGeometry)),this.olDrawSource.clear(),this.store.activateStrategyOfType(Vc),this.activeOlGeometry=void 0,this.modifyControl.setOlMap(void 0)}onModifyStart(e){this.onDrawStart(e)}onModifyChanges(e){this.onDrawChanges(e)}onModifyEnd(e){this.finalizeMeasureOfOlGeometry(e)}finalizeMeasureOfOlGeometry(e){const t=Lh(e,this.projection);this.updateMeasureOfOlGeometry(e,t)}updateMeasureOfOlGeometry(e,t){e.setProperties({_measure:t},!0),this.updateTooltipsOfOlGeometry(e)}clearMeasures(){this.measure$.next({})}addFeatureToStore(e,t){const o=t?t.properties.id:e.ol_uid,i=this.map.ol.getView().getProjection(),r=(new Xn.Z).writeGeometryObject(e,{featureProjection:i,dataProjection:i});this.store.update({type:Zl,geometry:r,projection:i.getCode(),properties:{id:o,measure:e.get("_measure")},meta:{id:o}})}updateTooltipsOfOlGeometry(e){const t=e.get("_measure"),o=t.lengths,i=t.area,r=function(e){const t=Zh(e);let o="";return e instanceof Wn.Z?o="line-":e instanceof Vn.ZP&&(o="polygone-"),t.map(e=>{let t=e.get("_tooltip");return void 0===t?t=Ih(e,!1,o):t.setPosition(e.getFlatCoordinates()),t})}(e);if(o.length===r.length)for(let s=0;s<r.length;s++){const e=o[s];void 0!==e&&this.updateOlTooltip(r[s],wh(e,this.activeLengthUnit),this.activeLengthUnit,lh.Length)}void 0!==i&&this.updateOlTooltip(function(e){const t=function(e){let t=e.get("_center");const o=(0,zn.qg)(e.getExtent());return void 0!==t?t.setCoordinates(o):(t=new _n.Z(o),e.set("_center",t)),t}(e);let o=t.get("_tooltip");return void 0===o?o=Ih(t,!0):o.setPosition(t.getFlatCoordinates()),o}(e),Sh(i,this.activeAreaUnit),this.activeAreaUnit,lh.Area)}showTooltipsOfOlGeometry(e){Mh(e).forEach(e=>{this.shouldShowTooltip(e)&&this.map.ol.addOverlay(e)})}clearTooltipsOfOlGeometry(e){Mh(e).forEach(e=>{void 0!==e&&void 0!==e.getMap()&&this.map.ol.removeOverlay(e)})}updateTooltipsOfOlSource(e){e.forEachFeature(e=>{this.updateTooltipsOfOlGeometry(e.getGeometry())})}showTooltipsOfOlSource(e){e.forEachFeature(e=>{this.showTooltipsOfOlGeometry(e.getGeometry())})}clearTooltipsOfOlSource(e){e.forEachFeature(e=>{void 0!==e.getGeometry()&&this.clearTooltipsOfOlGeometry(e.getGeometry())})}updateOlTooltip(e,t,o,i){e.setProperties({_measure:t,_unit:o,_type:i},!0),e.getElement().innerHTML=this.computeTooltipInnerHTML(e),this.shouldShowTooltip(e)&&this.map.ol.addOverlay(e)}computeTooltipInnerHTML(e){const t=e.getProperties();return Ch(t._measure,{decimal:1,unit:t._unit,unitAbbr:!0,locale:"fr"},this.languageService)}shouldShowTooltip(e){if(!1===this.showTooltips)return!1;const t=e.getProperties(),o=t._measure;if(void 0===o)return!1;if(t._unit===lh.Length){const e=wh(this.minSegmentLength,t._unit)||0;return o>Math.max(e,0)}return!0}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ue),r.Y36(ze.uw),r.Y36(Se))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-measurer"]],viewQuery:function(e,t){if(1&e&&r.Gf(Hh,7),2&e){let e;r.iGM(e=r.CRH())&&(t.table=e.first)}},inputs:{map:"map",store:"store",activeMeasureType:"activeMeasureType",minSegmentLength:"minSegmentLength"},decls:43,vars:60,consts:[[1,"measure-type-toggle","mat-typography"],[3,"value","change"],[3,"value"],[1,"measure-options","mat-typography"],[3,"disabled","checked","labelPosition","change"],[4,"ngIf"],[3,"checked","labelPosition","change",4,"ngIf"],[3,"checked","labelPosition","change"],[1,"measure-store-buttons"],["mat-icon-button","","color","accent",3,"matTooltip","disabled","click",4,"ngIf"],["mat-icon-button","","color","warn",3,"matTooltip","disabled","click",4,"ngIf"],[1,"table-compact",3,"store","template"],["table",""],[3,"measureType","measureUnit","measure","auto","placeholder","measureUnitChange",4,"ngIf"],[3,"measureType","measureUnit","measure","auto","placeholder","measureUnitChange"],["mat-icon-button","","color","accent",3,"matTooltip","disabled","click"],["svgIcon","calculator"],["mat-icon-button","","color","warn",3,"matTooltip","disabled","click"],["svgIcon","delete"]],template:function(e,t){1&e&&(r.TgZ(0,"div"),r.TgZ(1,"div",0),r.TgZ(2,"mat-button-toggle-group",1),r.NdJ("change",function(e){return t.onMeasureTypeChange(e.value)}),r.TgZ(3,"mat-button-toggle",2),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.TgZ(6,"mat-button-toggle",2),r._uU(7),r.ALo(8,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(9,"div",3),r.TgZ(10,"mat-slide-toggle",4),r.NdJ("change",function(e){return t.onToggleDrawControl(e.checked)}),r._uU(11),r.ALo(12,"translate"),r.qZA(),r.YNc(13,Vh,1,0,"mat-divider",5),r.ALo(14,"async"),r.YNc(15,Wh,3,5,"mat-slide-toggle",6),r.ALo(16,"async"),r.YNc(17,Xh,1,0,"mat-divider",5),r.ALo(18,"async"),r.ALo(19,"async"),r.YNc(20,Kh,3,5,"mat-slide-toggle",6),r.ALo(21,"async"),r.YNc(22,eg,3,5,"mat-slide-toggle",6),r.ALo(23,"async"),r.YNc(24,tg,1,0,"mat-divider",5),r.ALo(25,"async"),r.TgZ(26,"mat-slide-toggle",7),r.NdJ("change",function(e){return t.onToggleMeasureUnitsAuto(e.checked)}),r._uU(27),r.ALo(28,"translate"),r.qZA(),r.qZA(),r.YNc(29,rg,3,2,"ng-container",5),r.ALo(30,"async"),r.YNc(31,sg,1,0,"mat-divider",5),r.ALo(32,"async"),r.ALo(33,"async"),r.TgZ(34,"div",8),r.YNc(35,ng,4,6,"button",9),r.ALo(36,"async"),r.ALo(37,"async"),r.YNc(38,ag,4,6,"button",10),r.ALo(39,"async"),r.ALo(40,"async"),r.qZA(),r._UZ(41,"igo-entity-table",11,12),r.qZA()),2&e&&(r.xp6(2),r.Q6J("value",t.activeMeasureType),r.xp6(1),r.Q6J("value",t.measureType.Length),r.xp6(1),r.hij(" ",r.lcZ(5,24,"igo.geo.measure."+t.measureType.Length)," "),r.xp6(2),r.Q6J("value",t.measureType.Area),r.xp6(1),r.hij(" ",r.lcZ(8,26,"igo.geo.measure."+t.measureType.Area)," "),r.xp6(3),r.Q6J("disabled",t.drawControlIsDisabled)("checked",t.drawControlIsActive)("labelPosition","before"),r.xp6(1),r.hij(" ",r.lcZ(12,28,"igo.geo.measure.toggleActive")," "),r.xp6(2),r.Q6J("ngIf",r.lcZ(14,30,t.hasLine$)),r.xp6(2),r.Q6J("ngIf",r.lcZ(16,32,t.hasLine$)),r.xp6(2),r.Q6J("ngIf",r.lcZ(18,34,t.hasLine$)||r.lcZ(19,36,t.hasArea$)),r.xp6(3),r.Q6J("ngIf",r.lcZ(21,38,t.hasArea$)),r.xp6(2),r.Q6J("ngIf",r.lcZ(23,40,t.hasArea$)),r.xp6(2),r.Q6J("ngIf",r.lcZ(25,42,t.hasArea$)),r.xp6(2),r.Q6J("checked",t.measureUnitsAuto)("labelPosition","before"),r.xp6(1),r.hij(" ",r.lcZ(28,44,"igo.geo.measure.toggleAutoUnits")," "),r.xp6(2),r.Q6J("ngIf",r.lcZ(30,46,t.measure$)),r.xp6(2),r.Q6J("ngIf",r.lcZ(32,48,t.hasLine$)||r.lcZ(33,50,t.hasArea$)),r.xp6(4),r.Q6J("ngIf",r.lcZ(36,52,t.hasLine$)||r.lcZ(37,54,t.hasArea$)),r.xp6(3),r.Q6J("ngIf",r.lcZ(39,56,t.hasLine$)||r.lcZ(40,58,t.hasArea$)),r.xp6(3),r.Q6J("store",t.store)("template",t.tableTemplate))},styles:[".measure-type-toggle[_ngcontent-%COMP%]{padding:10px;text-align:center}.measure-type-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]{width:100%}.measure-type-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]{width:50%}.measure-options[_ngcontent-%COMP%]{overflow-x:hidden}.measure-options[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{width:100%;margin:10px}.measure-options[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content{width:calc(100% - 60px)}.measure-store-buttons[_ngcontent-%COMP%]{margin-left:-2px}.measure-store-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-of-type{margin-left:14px}.table-compact[_ngcontent-%COMP%]     .mat-header-cell.mat-column-selectionCheckbox{width:52px}"],changeDetection:0}),e})(),cg=(()=>{class e{transform(e,t,o=!1,i=1){let r;return Object.values(ph).indexOf(t)>=0?r=Sh(e,t):Object.values(ch).indexOf(t)>=0&&(r=wh(e,t)),r&&Ch(r,{decimal:1,unit:t,unitAbbr:o,locale:"fr"})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=r.Yjl({name:"measureFormat",type:e,pure:!0}),e})();function ug(e,t){}let pg=(()=>{class e{constructor(e,t){this.cdRef=e,this.ngControl=t,this.olGeoJSON=new Xn.Z,this.ready=!1,this.olTooltip=this.createMeasureTooltip(),this.drawGuide=null,this.measure=!1,this._drawControlIsActive=!0,this.controlOptions={},this.onChange=()=>{},this.onTouched=()=>{},void 0!==this.ngControl&&(this.ngControl.valueAccessor=this)}set geometryType(e){this._geometryType=e,!1!==this.ready&&(this.deactivateControl(),this.createDrawControl(),this.drawControl.freehand$.next(this.freehandDrawIsActive),this.toggleControl())}get geometryType(){return this._geometryType}get drawControlIsActive(){return this._drawControlIsActive}set drawControlIsActive(e){if(this._drawControlIsActive=e,!1!==this.ready){if(this.deactivateControl(),!this._drawControlIsActive)return;this.toggleControl()}}get freehandDrawIsActive(){return this._freehandDrawIsActive}set freehandDrawIsActive(e){this._freehandDrawIsActive=e,this.deactivateControl(),this.createDrawControl(),this.createModifyControl(),this.drawControl.freehand$.next(this.freehandDrawIsActive),!1!==this.ready&&(!this.drawControlIsActive||this.toggleControl())}set drawStyle(e){void 0===e&&(e=oh()),this._drawStyle=e;const t=this.getGuideStyleFromDrawStyle(e);this.defaultDrawStyleRadius=void 0!==t?t.getRadius():null,!1!==this.ready&&(this.deactivateControl(),this.createDrawControl(),this.createModifyControl(),this.drawControl.freehand$.next(this.freehandDrawIsActive),this.toggleControl())}get drawStyle(){return this._drawStyle}set overlayStyle(e){this._overlayStyle=e}get overlayStyle(){return this._overlayStyle}set value(e){this._value=e,!1!==this.ready&&(e?this.addGeoJSONToOverlay(e):this.olOverlaySource.clear(!0),this.onChange(e),this.toggleControl(),this.cdRef.detectChanges())}get value(){return this._value}get olOverlaySource(){return this.olOverlayLayer.getSource()}set radius(e){if(!1!==this.ready&&(this.modifyControl.getSource()&&this.modifyControl.getSource().refresh(),this.freehandDrawIsActive)){let e;setTimeout(()=>{e=this.modifyControl.olModifyInteraction,e&&e.features_&&(e.features_.clear(),this.addGeoJSONToOverlay(this.value))},0)}}ngOnInit(){void 0===this.drawStyle&&(this.drawStyle=oh()),void 0===this.overlayStyle&&(this.overlayStyle=this.drawStyle),this.addOlOverlayLayer(),this.createDrawControl(),this.createModifyControl(),this.value&&this.addGeoJSONToOverlay(this.value),this.toggleControl(),this.ready=!0}ngOnDestroy(){this.ready=!1,this.deactivateControl(),this.olOverlaySource.clear(),this.map.ol.removeLayer(this.olOverlayLayer)}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}writeValue(e){this.value=e}addOlOverlayLayer(){this.olOverlayLayer=new Kn.Z({source:new Aa.Z,zIndex:500,style:null}),this.map.ol.addLayer(this.olOverlayLayer)}createDrawControl(){const e=Object.assign({},this.controlOptions,{geometryType:this.geometryType||"Point",drawingLayer:this.olOverlayLayer,interactionStyle:"function"==typeof this.drawStyle?this.drawStyle:(e,t)=>{const o=this.drawStyle;return this.updateDrawStyleWithDrawGuide(o,t),o}});this.drawControl=new sh(e)}createModifyControl(){const e=Object.assign({},this.controlOptions,{layer:this.olOverlayLayer,drawStyle:"function"==typeof this.drawStyle?this.drawStyle:(e,t)=>{const o=this.drawStyle;return this.updateDrawStyleWithDrawGuide(o,t),o}});this.modifyControl=new jh(e)}toggleControl(){let e;e=!this.value&&this.geometryType?this.drawControl:this.modifyControl,e!==this.activeControl&&(this.deactivateControl(),this.activateControl(e))}activateControl(e){this.activeControl=e,this.olGeometryEnds$$=e.end$.subscribe(e=>this.onOlGeometryEnds(e)),!0===this.measure&&e===this.drawControl&&(this.olGeometryChanges$$=e.changes$.subscribe(e=>this.onOlGeometryChanges(e))),e.setOlMap(this.map.ol,!1)}deactivateControl(){this.removeMeasureTooltip(),void 0!==this.activeControl&&this.activeControl.setOlMap(void 0),void 0!==this.olGeometryEnds$$&&this.olGeometryEnds$$.unsubscribe(),void 0!==this.olGeometryChanges$$&&this.olGeometryChanges$$.unsubscribe(),this.activeControl=void 0}onOlGeometryEnds(e){this.removeMeasureTooltip(),this.setOlGeometry(e)}onOlGeometryChanges(e){"Point"!==e.getType()&&this.updateMeasureTooltip(e)}setOlGeometry(e){let t;void 0!==e&&("Circle"===e.getType()&&(e=this.circleToPoint(e)),t=this.olGeoJSON.writeGeometryObject(e,{featureProjection:this.map.projection,dataProjection:"EPSG:4326"}),e.get("radius")&&(t.radius=e.get("radius"),e.set("radius",t.radius)),this.writeValue(t))}circleToPoint(e){const t=e.getCenter(),o=kn.vs(t,this.map.projection,"EPSG:4326"),i=Math.round(e.getRadius()*Math.cos(Math.PI/180*o[1]));return(e=new _n.Z(t)).set("radius",i,!0),e}addGeoJSONToOverlay(e){const t=this.olGeoJSON.readGeometry(e,{dataProjection:"EPSG:4326",featureProjection:this.map.projection}),o=new Fn.Z({geometry:t});o.setStyle(this.overlayStyle),this.olOverlaySource.clear(),this.olOverlaySource.addFeature(o)}createMeasureTooltip(){return new sl.Z({element:document.createElement("div"),offset:[-30,-10],className:["igo-map-tooltip","igo-map-tooltip-measure"].join(" "),stopEvent:!1})}updateMeasureTooltip(e){const t=Lh(e,this.map.projection).lengths,o="Polygon"===e.getType()?t.length-2:t.length-1,i=t[o],r=Zh(e),s=r[o];if(0===r.length||void 0===s)return void this.removeMeasureTooltip();this.olTooltip.setPosition(s.getFlatCoordinates());const n=Ch(i,{decimal:1,unit:ch.Meters,unitAbbr:!0,locale:"fr"});this.olTooltip.getElement().innerHTML=n,void 0===this.olTooltip.getMap()&&this.map.ol.addOverlay(this.olTooltip)}removeMeasureTooltip(){this.olTooltip.getMap&&void 0!==this.olTooltip.getMap()&&(this.map.ol.removeOverlay(this.olTooltip),this.olTooltip.setMap(void 0))}updateDrawStyleWithDrawGuide(e,t){const o=this.getGuideStyleFromDrawStyle(e);if(void 0===o)return;const i=this.drawGuide;let r;r=!i||i<0?this.defaultDrawStyleRadius:i>0?i/t:i,o.setRadius(r)}isStyleWithRadius(e){return"function"!=typeof e&&e.setRadius}getGuideStyleFromDrawStyle(e){if(Array.isArray(e)&&(e=e[0]),this.isStyleWithRadius(e))return e}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.sBO),r.Y36(We.a5,10))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-geometry-form-field-input"]],inputs:{map:"map",geometryType:"geometryType",drawGuide:"drawGuide",measure:"measure",drawControlIsActive:"drawControlIsActive",freehandDrawIsActive:"freehandDrawIsActive",controlOptions:"controlOptions",drawStyle:"drawStyle",overlayStyle:"overlayStyle",value:"value",radius:"radius"},decls:1,vars:0,template:function(e,t){1&e&&r.YNc(0,ug,0,0,"ng-template")},encapsulation:2,changeDetection:0}),e})(),dg=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,We.u5,We.UX,a.Ps,De.lN,Ve.c,n.ot,Ka.vV,ne]]}),e})(),hg=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[],imports:[[h.ez,dg],dg]}),e})();function gg(e,t){if(1&e&&(r.TgZ(0,"button",2),r.ALo(1,"translate"),r._UZ(2,"mat-icon",3),r.qZA()),2&e){const e=r.oxw();r.Q6J("matTooltip",r.lcZ(1,3,"igo.geo.filter.filterBy"))("color",e.color),r.xp6(2),r.Q6J("matBadge",e.badge)}}function mg(e,t){if(1&e&&r._UZ(0,"igo-time-filter-item",7),2&e){const e=r.oxw(2);r.Q6J("header",!1)("layer",e.layer)}}function fg(e,t){if(1&e&&(r.TgZ(0,"div",4,5),r.YNc(2,mg,1,2,"igo-time-filter-item",6),r.qZA()),2&e){const e=r.oxw();r.xp6(2),r.Q6J("ngIf",e.timeFilterCollapse&&e.options.timeFilter)}}let yg=(()=>{class e{constructor(){this.color="primary",this.header=!0,this.timeFilterCollapse=!1}get badge(){const e=this.options.timeFilter;if(e&&e.enabled)return 1}get layer(){return this._layer}set layer(e){this._layer=e,e&&(this.options=this.layer.dataSource.options)}ngOnInit(){this.options=this.layer.dataSource.options}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-time-filter-button"]],inputs:{layer:"layer",map:"map",color:"color",header:"header"},decls:2,vars:2,consts:[["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color",4,"ngIf"],["class","igo-layer-actions-container",4,"ngIf"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color"],["matBadgeColor","warn","matBadgeSize","medium","svgIcon","history",3,"matBadge"],[1,"igo-layer-actions-container"],["ogcFilter",""],["igoListItem","",3,"header","layer",4,"ngIf"],["igoListItem","",3,"header","layer"]],template:function(e,t){1&e&&(r.YNc(0,gg,3,5,"button",0),r.YNc(1,fg,3,1,"div",1)),2&e&&(r.Q6J("ngIf",t.header&&t.options.timeFilterable&&t.options.timeFilter),r.xp6(1),r.Q6J("ngIf",t.header&&t.options.timeFilterable&&t.options.timeFilter))},styles:[""],changeDetection:0}),e})();function vg(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",3),r.TgZ(1,"mat-form-field"),r._UZ(2,"mat-datetimepicker-toggle",4),r._UZ(3,"mat-datetimepicker",5,6),r.TgZ(5,"input",7),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw(2).date=t})("dateChange",function(t){return r.CHM(e),r.oxw(2).handleDateChange(t)}),r.ALo(6,"translate"),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.MAs(4),t=r.oxw(2);r.xp6(2),r.Q6J("for",e),r.xp6(1),r.s9C("type",t.type),r.xp6(2),r.s9C("placeholder",r.lcZ(6,7,"igo.geo.timeFilter.date")),r.Q6J("matDatetimepicker",e)("ngModel",t.date)("min",t.min)("max",t.max)}}function bg(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div"),r.TgZ(1,"div",8),r.TgZ(2,"mat-form-field"),r._UZ(3,"mat-datetimepicker-toggle",4),r._UZ(4,"mat-datetimepicker",5,9),r.TgZ(6,"input",10),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw(2).startDate=t})("input",function(){return r.CHM(e),r.oxw(2).startDate})("dateChange",function(t){return r.CHM(e),r.oxw(2).handleDateChange(t)}),r.ALo(7,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(8,"div",8),r.TgZ(9,"mat-form-field"),r._UZ(10,"mat-datetimepicker-toggle",4),r._UZ(11,"mat-datetimepicker",5,11),r.TgZ(13,"input",7),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw(2).endDate=t})("dateChange",function(t){return r.CHM(e),r.oxw(2).handleDateChange(t)}),r.ALo(14,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.MAs(5),t=r.MAs(12),o=r.oxw(2);r.xp6(3),r.Q6J("for",e),r.xp6(1),r.s9C("type",o.type),r.xp6(2),r.s9C("placeholder",r.lcZ(7,14,"igo.geo.timeFilter.startDate")),r.Q6J("matDatetimepicker",e)("ngModel",o.startDate)("min",o.min)("max",o.getRangeMaxDate()),r.xp6(4),r.Q6J("for",t),r.xp6(1),r.s9C("type",o.type),r.xp6(2),r.s9C("placeholder",r.lcZ(14,16,"igo.geo.timeFilter.endDate")),r.Q6J("matDatetimepicker",t)("ngModel",o.endDate)("min",o.getRangeMinDate())("max",o.max)}}function xg(e,t){if(1&e&&(r.TgZ(0,"div"),r.YNc(1,vg,7,9,"div",2),r.YNc(2,bg,15,18,"div",0),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf",!e.isRange),r.xp6(1),r.Q6J("ngIf",e.isRange)}}function wg(e,t){if(1&e&&(r.TgZ(0,"mat-option",14),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.Oqu(e)}}function Sg(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",3),r.TgZ(1,"mat-form-field"),r.TgZ(2,"mat-select",12),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw(2).year=t})("selectionChange",function(t){return r.CHM(e),r.oxw(2).handleYearChange(t)}),r.ALo(3,"translate"),r.YNc(4,wg,2,2,"mat-option",13),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(2);r.xp6(2),r.s9C("placeholder",r.lcZ(3,3,"igo.geo.timeFilter.date")),r.Q6J("ngModel",e.year),r.xp6(2),r.Q6J("ngForOf",e.listYears)}}function Cg(e,t){if(1&e&&(r.TgZ(0,"mat-option",14),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.Oqu(e)}}function Tg(e,t){if(1&e&&(r.TgZ(0,"mat-option",14),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.Oqu(e)}}function Ag(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div"),r.TgZ(1,"div",8),r.TgZ(2,"mat-form-field"),r.TgZ(3,"mat-select",12),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw(2).startYear=t})("selectionChange",function(t){return r.CHM(e),r.oxw(2).handleYearChange(t)}),r.ALo(4,"translate"),r.YNc(5,Cg,2,2,"mat-option",13),r.qZA(),r.qZA(),r.qZA(),r.TgZ(6,"div",8),r.TgZ(7,"mat-form-field"),r.TgZ(8,"mat-select",12),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw(2).endYear=t})("selectionChange",function(t){return r.CHM(e),r.oxw(2).handleYearChange(t)}),r.ALo(9,"translate"),r.YNc(10,Tg,2,2,"mat-option",13),r.qZA(),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(2);r.xp6(3),r.s9C("placeholder",r.lcZ(4,6,"igo.geo.timeFilter.startDate")),r.Q6J("ngModel",e.startYear),r.xp6(2),r.Q6J("ngForOf",e.startListYears),r.xp6(3),r.s9C("placeholder",r.lcZ(9,8,"igo.geo.timeFilter.endDate")),r.Q6J("ngModel",e.endYear),r.xp6(2),r.Q6J("ngForOf",e.endListYears)}}function Lg(e,t){if(1&e&&(r.TgZ(0,"div"),r.YNc(1,Sg,5,5,"div",2),r.YNc(2,Ag,11,10,"div",0),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf",!e.isRange),r.xp6(1),r.Q6J("ngIf",e.isRange)}}function Zg(e,t){if(1&e&&(r.TgZ(0,"p",23),r._uU(1),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.Oqu(e.year)}}function Fg(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",15),r.TgZ(1,"span"),r._uU(2),r.qZA(),r.TgZ(3,"mat-slider",16),r.NdJ("input",function(t){return r.CHM(e),r.oxw().handleSliderYearChange(t)})("change",function(t){return r.CHM(e),r.oxw().handleSliderYearChange(t)}),r.qZA(),r.TgZ(4,"span"),r._uU(5),r.qZA(),r.YNc(6,Zg,2,1,"p",17),r.TgZ(7,"div",18,19),r.TgZ(9,"mat-slide-toggle",20),r.NdJ("change",function(){return r.CHM(e),r.oxw().toggleFilterState()}),r.ALo(10,"translate"),r.qZA(),r.TgZ(11,"button",21),r.NdJ("click",function(t){return r.CHM(e),r.oxw().playYear(t)}),r._UZ(12,"mat-icon",22),r.qZA(),r.TgZ(13,"button",21),r.NdJ("click",function(t){return r.CHM(e),r.oxw().resetFilter(t)}),r._UZ(14,"mat-icon",22),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(2),r.Oqu(e.startYear),r.xp6(1),r.s9C("step",e.step),r.Q6J("min",e.startYear)("max",e.endYear)("value",e.handleSliderValue())("color",e.color)("disabled",!e.options.enabled||!e.layer.visible),r.xp6(2),r.Oqu(e.endYear),r.xp6(1),r.Q6J("ngIf",e.options.enabled),r.xp6(3),r.Q6J("matTooltip",r.lcZ(10,17,"igo.geo.filter.toggleFilterState"))("color",e.color)("checked",e.options.enabled)("disabled",!e.layer.visible),r.xp6(2),r.Q6J("disabled",!e.options.enabled||!e.layer.visible),r.xp6(1),r.s9C("svgIcon",e.playIcon),r.xp6(1),r.Q6J("disabled",!e.options.enabled||!e.layer.visible),r.xp6(1),r.s9C("svgIcon",e.resetIcon)}}function Og(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",3),r.TgZ(1,"mat-slider",24),r.NdJ("input",function(t){return r.CHM(e),r.oxw().handleSliderDateChange(t)})("selectionChange",function(t){return r.CHM(e),r.oxw().handleSliderDateChange(t)}),r.qZA(),r.TgZ(2,"p",23),r._uU(3),r.qZA(),r.TgZ(4,"button",25),r.NdJ("click",function(t){return r.CHM(e),r.oxw().playFilter(t)}),r._UZ(5,"mat-icon",22),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(1),r.s9C("step",e.step),r.Q6J("min",e.dateToNumber(e.min))("max",e.dateToNumber(e.max))("value",e.handleSliderValue()),r.xp6(2),r.Oqu(e.handleSliderTooltip()),r.xp6(2),r.s9C("svgIcon",e.playIcon)}}let Mg=(()=>{class e{constructor(e){this.dateAdapter=e,this.color="primary",this.listYears=[],this.startListYears=[],this.endListYears=[],this.playIcon="play-circle",this.resetIcon="replay",this.change=new r.vpe,this.yearChange=new r.vpe,this.dateAdapter.setLocale("fr")}set currentValue(e){if(e&&this.type!==Ic.YEAR){const t=e.split("/");if(t.length>0){const e=new Date(t[0]),o=new Date(t[1]);isNaN(e.valueOf())||(this.startDate=e),isNaN(o.valueOf())||(this.endDate=o)}}}get type(){return void 0===this.options.type?Ic.DATE:this.options.type}get isRange(){return void 0!==this.options.range&&this.options.style!==kc.SLIDER&&this.options.range}get style(){return void 0===this.options.style?kc.SLIDER:this.options.style}get step(){let e=108e5;if(void 0===this.options.step)switch(this.type){case Ic.DATE:case Ic.DATETIME:e=108e5;break;case Ic.TIME:e=36e5;break;case Ic.YEAR:e=31536e6;break;default:e=108e5}else e=this.getStepDefinition(this.options.step);return e}get timeInterval(){return void 0===this.options.timeInterval?2e3:this.options.timeInterval}get min(){if(this.options.min){const e=new Date(this.options.min);return new Date(e.getTime()+6e4*e.getTimezoneOffset())}}get max(){if(this.options.max){const e=new Date(this.options.max);return new Date(e.getTime()+6e4*e.getTimezoneOffset())}}get is(){return void 0!==this.options.range&&this.options.range}ngOnInit(){if(void 0===this.startDate&&(this.startDate=new Date(this.min)),void 0===this.endDate&&(this.endDate=new Date(this.max)),void 0===this.startYear&&(this.startYear=new Date(this.startDate).getFullYear(),this.initStartYear=this.startYear),void 0===this.endYear&&(this.endYear=new Date(this.endDate).getFullYear(),this.initEndYear=this.endYear),this.isRange){for(let e=this.startYear;e<this.endYear;e++)this.startListYears.push(e);for(let e=this.startYear+1;e<=this.endYear;e++)this.endListYears.push(e)}else for(let e=this.startYear;e<=this.endYear+1;e++)this.listYears.push(e);this.options.enabled=void 0===this.options.enabled||this.options.enabled,this.checkFilterValue(),this.options.enabled?!this.isRange&&"slider"===this.style&&"year"===this.type&&this.yearChange.emit(this.year):(this.storeCurrentFilterValue(),this.yearChange.emit(void 0))}storeCurrentFilterValue(){!this.isRange&&this.style===kc.SLIDER&&this.type===Ic.YEAR&&(this.options.value=this.year.toString())}checkFilterValue(){const e=this.layer.dataSource.ol.getParams().TIME;if(this.isRange||this.style!==kc.SLIDER||this.type!==Ic.YEAR){if(this.isRange&&this.style===kc.CALENDAR&&this.type===Ic.YEAR&&e){this.startYear=parseInt(e.substr(0,4),10),this.endYear=parseInt(e.substr(5,4),10);const t=[],o=[];for(let e=this.initStartYear;e<this.endYear;e++)t.push(e);for(let e=this.startYear+1;e<=this.initEndYear;e++)o.push(e);this.startListYears=t,this.endListYears=o}}else this.year=e?new Date(e.toString()).getFullYear()+1:this.options.value?new Date(this.options.value.toString()).getFullYear()+1:new Date(this.min).getFullYear()+1}handleDateChange(e){this.setupDateOutput(),this.applyTypeChange(),this.change.emit(this.isRange?[this.startDate,this.endDate]:this.startDate)}handleYearChange(e){if(this.isRange){this.endListYears=[];for(let e=this.startYear+1;e<=this.initEndYear;e++)this.endListYears.push(e);this.startListYears=[];for(let e=this.initStartYear+1;e<this.endYear;e++)this.startListYears.push(e);this.yearChange.emit([this.startYear,this.endYear])}else this.yearChange.emit(this.year)}handleListYearChange(e){this.handleYearChange([this.startYear,this.endYear])}handleListYearStartChange(e){this.change.emit([this.startDate,this.endDate])}dateToNumber(e){let t;return t=e?new Date(e):new Date(this.min),t.getTime()}setSliderThumbLabel(e){const t=this.findThumbLabel(this.mySlider._elementRef.nativeElement.childNodes);t&&(t.textContent=e)}findThumbLabel(e){let t;return e.forEach(e=>{"mat-slider-thumb-label-text"===e.className&&(t=e),e.children.length>0&&!t&&(t=this.findThumbLabel(e.childNodes))},this),t}toggleFilterState(){this.options.enabled=!this.options.enabled,this.options.enabled?!this.isRange&&kc.SLIDER&&this.type===Ic.YEAR&&this.yearChange.emit(this.year):(this.stopFilter(),this.storeCurrentFilterValue(),this.change.emit(void 0))}resetFilter(e){this.date=new Date(this.min),this.year=this.date.getFullYear(),!this.isRange&&kc.SLIDER&&this.type===Ic.YEAR?this.yearChange.emit(this.year):(this.setupDateOutput(),this.change.emit(void 0))}playFilter(e){this.interval?this.stopFilter():(this.playIcon="pause-circle",this.interval=setInterval(e=>{let t;const o=new Date(e.max);t=void 0===e.date?e.min.getTime():e.date.getTime(),t+=e.mySlider.step,e.date=new Date(t),t>o.getTime()&&e.stopFilter(),e.handleDateChange({value:e.date,date:e.date})},this.timeInterval,this))}playYear(e){this.year+this.mySlider.step>this.max.getFullYear()+this.mySlider.step&&(this.stopFilter(),this.resetFilter(e)),this.interval?this.stopFilter():(this.playIcon="pause-circle",this.interval=setInterval(()=>{this.year+this.mySlider.step>this.max.getFullYear()?this.stopFilter():this.year=this.year+this.mySlider.step,this.yearChange.emit(this.year)},this.timeInterval,this))}stopFilter(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.playIcon="play-circle"}handleSliderDateChange(e){this.date=new Date(e.value),this.setSliderThumbLabel(this.handleSliderTooltip()),this.handleDateChange(e)}handleSliderYearChange(e){this.year=e.value,this.yearChange.emit(this.year)}handleSliderValue(){if(!0===this.options.current||!this.min){const e=new Date;this.date=this.getRoundedDate(e)}return this.type===Ic.YEAR?this.year:void 0===this.date?this.min.getTime():this.date.getTime()}handleSliderTooltip(){let e;switch(this.type){case Ic.DATE:e=void 0===this.date?this.min.toDateString():this.date.toDateString();break;case Ic.TIME:e=void 0===this.date?this.min.toTimeString():this.date.toTimeString();break;default:e=void 0===this.date?this.min.toUTCString():this.date.toUTCString()}return e}setupDateOutput(){this.style===kc.SLIDER?(this.startDate=new Date(this.date),this.startDate.setSeconds(-this.step/1e3),this.endDate=new Date(this.startDate),this.endDate.setSeconds(this.step/1e3)):!this.isRange&&this.date?(this.endDate=new Date(this.date),this.startDate=new Date(this.date)):(!this.isRange||!this.date&&this.date)&&this.date||(this.startDate=void 0===this.startDate?new Date(this.min):this.startDate,this.endDate=void 0===this.endDate?new Date(this.max):this.endDate)}applyTypeChange(){switch(this.type){case Ic.DATE:(void 0!==this.startDate||void 0!==this.endDate)&&(this.startDate.setHours(0),this.startDate.setMinutes(0),this.startDate.setSeconds(0),this.endDate.setHours(23),this.endDate.setMinutes(59),this.endDate.setSeconds(59));break;case Ic.TIME:if(this.style===kc.CALENDAR){if(this.startDate.getDay()!==this.min.getDay()){const e=this.startDate.getHours(),t=this.startDate.getMinutes();this.startDate=this.min,this.startDate.setHours(e),this.startDate.setMinutes(t)}if(this.endDate.getDay()!==this.min.getDay()){const e=this.endDate.getHours(),t=this.endDate.getMinutes();this.endDate=this.min,this.endDate.setHours(e),this.endDate.setMinutes(t)}}!this.isRange&&this.step>36e5&&(this.startDate.setMinutes(0),this.startDate.setSeconds(0),this.endDate.setMinutes(59),this.endDate.setSeconds(59))}}getRangeMinDate(){return void 0===this.startDate?this.min:this.startDate}getRangeMaxDate(){return void 0===this.endDate?this.max:this.endDate}getRoundedDate(e,t=10){const o=6e4*t;return new Date(Math.round(e.getTime()/o)*o)}getStepDefinition(e){return ua.duration(e).asMilliseconds()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Re._A))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-time-filter-form"]],viewQuery:function(e,t){if(1&e&&r.Gf(Wa.pH,5),2&e){let e;r.iGM(e=r.CRH())&&(t.mySlider=e.first)}},inputs:{layer:"layer",options:"options",currentValue:"currentValue"},outputs:{change:"change",yearChange:"yearChange"},decls:5,vars:4,consts:[[4,"ngIf"],["class","igo-col igo-col-100 igo-col-100-m mat-typography",4,"ngIf"],["class","igo-col igo-col-100 igo-col-100-m",4,"ngIf"],[1,"igo-col","igo-col-100","igo-col-100-m"],["matSuffix","",3,"for"],["openOnFocus","true","timeInterval","5",3,"type"],["datetimePicker",""],["matInput","","autocomplete","false","readonly","readonly",3,"placeholder","matDatetimepicker","ngModel","min","max","ngModelChange","dateChange"],[1,"igo-col","igo-col-100"],["minDatetimePicker",""],["matInput","","autocomplete","false","readonly","readonly",3,"placeholder","matDatetimepicker","ngModel","min","max","ngModelChange","input","dateChange"],["maxDatetimePicker",""],[3,"placeholder","ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"igo-col","igo-col-100","igo-col-100-m","mat-typography"],["id","time-slider","tickInterval","auto","thumbLabel","",3,"step","min","max","value","color","disabled","input","change"],["class","date-below",4,"ngIf"],[1,"igo-layer-actions-container"],["actions",""],["tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","checked","disabled","change"],["mat-icon-button","","color","primary",3,"disabled","click"],[3,"svgIcon"],[1,"date-below"],["id","time-slider","tickInterval","auto","thumbLabel","",3,"step","min","max","value","input","selectionChange"],["mat-icon-button","","color","primary",3,"click"]],template:function(e,t){1&e&&(r.YNc(0,xg,3,2,"div",0),r.YNc(1,Lg,3,2,"div",0),r._UZ(2,"br"),r.YNc(3,Fg,15,19,"div",1),r.YNc(4,Og,6,6,"div",2)),2&e&&(r.Q6J("ngIf","calendar"===t.style&&"year"!==t.type),r.xp6(1),r.Q6J("ngIf","calendar"===t.style&&"year"===t.type),r.xp6(2),r.Q6J("ngIf",!t.isRange&&"slider"===t.style&&"year"===t.type),r.xp6(1),r.Q6J("ngIf","slider"===t.style&&"year"!==t.type))},directives:[h.O5,De.KE,pl.KA,De.R9,pl.k1,Ve.Nt,pl.Ry,We.Fj,We.JJ,We.On,Ee.gD,h.sg,Re.ey,Wa.pH,Va.Rr,p.gM,n.lW,a.Hw],pipes:[j.X$],styles:[".igo-layer-filters-container[_ngcontent-%COMP%]{padding-left:5px}mat-slider[_ngcontent-%COMP%]     div.mat-slider-thumb-label{width:32px;height:32px;margin:0 auto}mat-slider[_ngcontent-%COMP%]     span.mat-slider-thumb-label-text{font-size:10px}#time-slider[_ngcontent-%COMP%]{width:70%;margin:0 auto}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){#time-slider[_ngcontent-%COMP%]{width:60%;margin:0 auto}}.date-below[_ngcontent-%COMP%]{margin:0}mat-form-field[_ngcontent-%COMP%]{text-align:center}mat-datetimepicker-toggle[_ngcontent-%COMP%]     .mat-icon{padding-bottom:30px}.igo-layer-actions-container[_ngcontent-%COMP%] > .mat-slide-toggle[_ngcontent-%COMP%]{vertical-align:middle}"]}),e})();const Ig=function(e){return{disabled:e}};function kg(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",10),r.NdJ("click",function(){r.CHM(e);const t=r.oxw(2);return t.layer.visible=!t.layer.visible}),r.ALo(1,"translate"),r.ALo(2,"translate"),r._UZ(3,"mat-icon",11),r.ALo(4,"async"),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("color",e.layer.visible?"primary":"default")("matTooltip",e.layer.visible?r.lcZ(1,4,"igo.geo.layer.hideLayer"):r.lcZ(2,6,"igo.geo.layer.showLayer")),r.xp6(3),r.Q6J("ngClass",r.VKq(10,Ig,!1===r.lcZ(4,8,e.inResolutionRange$)))("svgIcon",e.layer.visible?"eye":"eye-off")}}const Pg=function(e){return{cursor:e}};function _g(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-list-item"),r.TgZ(1,"mat-icon",7),r.NdJ("click",function(){return r.CHM(e),r.oxw().toggleFiltersCollapsed()}),r.qZA(),r.TgZ(2,"h4",8),r.NdJ("click",function(){return r.CHM(e),r.oxw().toggleLegendOnClick()}),r._uU(3),r.qZA(),r.YNc(4,kg,5,12,"button",9),r.qZA()}if(2&e){const e=r.oxw(),t=r.MAs(2);r.xp6(1),r.Q6J("target",t)("collapsed",e.filtersCollapsed),r.xp6(1),r.Q6J("ngStyle",r.VKq(5,Pg,e.filtersCollapsed?"default":"pointer")),r.xp6(1),r.Oqu(e.layer.title),r.xp6(1),r.Q6J("ngIf",e.header)}}function $g(e,t){if(1&e&&r._UZ(0,"igo-layer-legend",12),2&e){const e=r.oxw();r.Q6J("layer",e.layer)}}let qg=(()=>{class e{constructor(e){this.timeFilterService=e,this.color="primary",this.showLegend$=new C.X(!1),this.inResolutionRange$=new C.X(!0),this.filtersCollapsed=!1,this.header=!0}get datasource(){return this.layer.dataSource}ngOnInit(){this.resolution$$=this.layer.map.viewController.resolution$.subscribe(()=>{this.inResolutionRange$.next(this.layer.isInResolutionsRange)})}ngOnDestroy(){this.resolution$$.unsubscribe()}handleYearChange(e){this.timeFilterService.filterByYear(this.datasource,e)}handleDateChange(e){this.timeFilterService.filterByDate(this.datasource,e)}toggleLegend(e){this.layer.legendCollapsed=e,this.showLegend$.next(!e)}toggleLegendOnClick(){this.filtersCollapsed||this.toggleLegend(this.showLegend$.value)}setVisible(){this.layer.visible=!0}toggleFiltersCollapsed(){this.filtersCollapsed=!this.filtersCollapsed}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(_d))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-time-filter-item"]],inputs:{header:"header",layer:"layer"},decls:8,vars:7,consts:[[4,"ngIf"],[1,"igo-datasource-filters-container"],["filters",""],[1,"igo-layer-legend-container"],["legend",""],[3,"layer",4,"ngIf"],[3,"layer","options","currentValue","change","yearChange"],["mat-list-avatar","","igoCollapse","","svgIcon","chevron-up",1,"igo-chevron",3,"target","collapsed","click"],["matLine","",3,"ngStyle","click"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"color","matTooltip","click",4,"ngIf"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"color","matTooltip","click"],[3,"ngClass","svgIcon"],[3,"layer"]],template:function(e,t){1&e&&(r.YNc(0,_g,5,7,"mat-list-item",0),r.TgZ(1,"div",1,2),r.TgZ(3,"div",3,4),r.YNc(5,$g,1,1,"igo-layer-legend",5),r.ALo(6,"async"),r.qZA(),r.TgZ(7,"igo-time-filter-form",6),r.NdJ("change",function(e){return t.handleDateChange(e)})("yearChange",function(e){return t.handleYearChange(e)}),r.qZA(),r.qZA()),2&e&&(r.Q6J("ngIf",t.header),r.xp6(5),r.Q6J("ngIf",r.lcZ(6,5,t.showLegend$)),r.xp6(2),r.Q6J("layer",t.layer)("options",t.datasource.options.timeFilter)("currentValue",t.datasource.options.params.TIME))},styles:["[_nghost-%COMP%]{overflow:hidden}.igo-datasource-filters-container[_ngcontent-%COMP%]{text-align:center;width:100%;display:inline-block;padding-top:5px}.igo-layer-legend-container[_ngcontent-%COMP%]{padding-left:1.125em;width:calc(100% - 18px)}"]}),e})();function Dg(e,t){if(1&e&&r._UZ(0,"igo-time-filter-item",2),2&e){const e=t.$implicit;r.Q6J("header",!0)("layer",e)}}let Eg=(()=>{class e{constructor(e){this.cdRef=e,this._layers=[]}get layers(){return this._layers}set layers(e){this._layers=e,this.cdRef.detectChanges()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.sBO))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-time-filter-list"]],inputs:{layers:"layers"},decls:3,vars:6,consts:[[3,"navigation","selection"],["ngFor","",3,"ngForOf"],["igoListItem","",3,"header","layer"]],template:function(e,t){1&e&&(r.TgZ(0,"igo-list",0),r.YNc(1,Dg,1,2,"ng-template",1),r.ALo(2,"filterableDataSource"),r.qZA()),2&e&&(r.Q6J("navigation",!1)("selection",!1),r.xp6(1),r.Q6J("ngForOf",r.xi3(2,3,t.layers,"time")))},encapsulation:2,changeDetection:0}),e})(),Rg=(()=>{class e{constructor(){}wktToFeature(e,t,o){return(new la.Z).readFeature(e,{dataProjection:t,featureProjection:o})}extentToWkt(e,t,o){let i=kn.$A(t,o,e);return i=this.roundCoordinateArray(i,e,0),{wktPoly:`POLYGON((\n      ${t[0]} ${t[1]},\n      ${t[0]} ${t[3]},\n      ${t[2]} ${t[3]},\n      ${t[2]} ${t[1]},\n      ${t[0]} ${t[1]}))`,wktLine:`LINESTRING(\n      ${t[0]} ${t[1]},\n      ${t[0]} ${t[3]},\n      ${t[2]} ${t[3]},\n      ${t[2]} ${t[1]},\n      ${t[0]} ${t[1]})`,wktMultiPoints:`MULTIPOINT(\n        ${t[0]} ${t[1]},\n        ${t[0]} ${t[3]},\n        ${t[2]} ${t[3]},\n        ${t[2]} ${t[1]})`}}roundCoordinateArray(e,t,o=0){const i=kn.U2(t).getUnits();return-1!==["ft","m","us-ft"].indexOf(i)&&(e=this.roundArray(e,o)),e}roundArray(e,t=0){let o=0;for(;o<e.length;)e[o]=e[o].toFixed(t),o++;return e}snrcToWkt(e,t){let o;e=e.toLowerCase();const i={1:{from:-56,to:-64},2:{from:-64,to:-72},3:{from:-72,to:-80},4:{from:-80,to:-88},5:{from:-88,to:-96},6:{from:-96,to:-104},7:{from:-104,to:-112},8:{from:-112,to:-120},9:{from:-120,to:-128},10:{from:-128,to:-136}},r={1:{from:44,to:48},2:{from:48,to:52},3:{from:52,to:56},4:{from:56,to:60},5:{from:60,to:64},6:{from:64,to:68},7:{from:68,to:72},8:{from:72,to:76},9:{from:76,to:-128}},s=[["m","n","o","p"],["l","k","j","i"],["e","f","g","h"],["d","c","b","a"]],n=[["13","14","15","16"],["12","11","10","09"],["05","06","07","08"],["04","03","02","01"]];let a=!1,l=!1,c=!1;if(/\d{2,3}[a-p][0,1][0-9]/gi.test(e)?c=!0:/\d{2,3}[a-p]/gi.test(e)?l=!0:/\d{2,3}/gi.test(e)&&(a=!0),a?e+="a01":l&&(e+="01"),/\d{2,3}[a-p][0,1][0-9]/gi.test(e)){const a=e.split(/(?=[a-p])/gi),u=a[0],p=a[1][0],d=a[1].split(p)[1];let h=1;3===u.length&&(h=2);const g=u.substring(0,h),m=u.substring(h),f=8,y=4,v=2,b=1,x=.5,w=.25;let S=0,C=0,T=0,A=0;s.forEach(e=>{-1!==e.indexOf(p)&&(C=s.indexOf(e),S=e.indexOf(p))}),n.forEach(e=>{-1!==e.indexOf(d)&&(A=n.indexOf(e),T=e.indexOf(d))});let L=0,Z=0,F=0,O=0,M=f,I=y;l?(L=S*v,Z=C*b,F=0,O=0,M=v,I=b):c&&(L=S*v,Z=C*b,F=T*x,O=A*w,M=x,I=w);const k={ul:[i[g].to+L+F,r[m].to-Z-O]};return k.lr=[k.ul[0]+M,k.ul[1]-I],k.ur=[k.ul[0],k.ul[1]-I],k.ll=[k.ul[0]+M,k.ul[1]],k.ul=kn.vs([k.ul[0],k.ul[1]],"EPSG:4326",t),k.lr=kn.vs([k.lr[0],k.lr[1]],"EPSG:4326",t),k.ur=kn.vs([k.ur[0],k.ur[1]],"EPSG:4326",t),k.ll=kn.vs([k.ll[0],k.ll[1]],"EPSG:4326",t),k.ul=this.roundCoordinateArray(k.ul,t,0),k.lr=this.roundCoordinateArray(k.lr,t,0),k.ur=this.roundCoordinateArray(k.ur,t,0),k.ll=this.roundCoordinateArray(k.ll,t,0),o="POLYGON(("+[k.ul.join(" "),k.ur.join(" "),k.lr.join(" "),k.ll.join(" "),k.ul.join(" ")].join(",")+"))",{wktPoly:o,wktLine:"LINESTRING("+[k.ul.join(" "),k.ur.join(" "),k.lr.join(" "),k.ll.join(" "),k.ul.join(" ")].join(",")+")",wktMultiPoints:"MULTIPOINT("+[k.ul.join(" "),k.ur.join(" "),k.lr.join(" "),k.ll.join(" ")].join(",")+")"}}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Ug(e,t){if(1&e&&(r.TgZ(0,"mat-option",23),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.alias)("id",e.name)("matTooltip",e.alias),r.xp6(1),r.hij(" ",e.alias," ")}}function Ng(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",24),r.NdJ("click",function(){return r.CHM(e),r.oxw(2).clearSelectedField()}),r._UZ(1,"mat-icon",25),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("disabled",!e.currentFilter.active)}}function Jg(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-form-field",17),r.NdJ("mouseenter",function(){return r.CHM(e),r.oxw().inputClearable="selectField"})("mouseleave",function(){return r.CHM(e),r.oxw().inputClearable=void 0}),r.TgZ(1,"input",18),r.NdJ("input",function(t){return r.CHM(e),r.oxw().updateFieldsList(t.target.value)}),r.ALo(2,"translate"),r.ALo(3,"async"),r.ALo(4,"async"),r.ALo(5,"async"),r.ALo(6,"async"),r.ALo(7,"translate"),r.qZA(),r.TgZ(8,"mat-autocomplete",19,20),r.NdJ("optionSelected",function(t){return r.CHM(e),r.oxw().changeField(t.option.id)}),r.YNc(10,Ug,2,4,"mat-option",21),r.ALo(11,"async"),r.qZA(),r.YNc(12,Ng,2,1,"button",22),r.qZA()}if(2&e){const e=r.MAs(9),t=r.oxw();r.Q6J("floatLabel",t.floatLabel),r.xp6(1),r.Q6J("placeholder",r.lcZ(2,8,"igo.geo.sourceFields.selectField"))("disabled",!t.currentFilter.active)("matAutocomplete",e)("value",r.lcZ(3,10,t.selectedField$)?r.lcZ(4,12,t.selectedField$).alias:"")("matTooltip",r.lcZ(5,14,t.selectedField$)?r.lcZ(6,16,t.selectedField$).alias:r.lcZ(7,18,"igo.geo.sourceFields.selectField")),r.xp6(9),r.Q6J("ngForOf",r.lcZ(11,20,t.filteredFields$)),r.xp6(2),r.Q6J("ngIf",t.currentFilter.propertyName&&"selectField"===t.inputClearable&&t.currentFilter.active)}}function Bg(e,t){if(1&e&&(r.TgZ(0,"mat-option",3),r.ALo(1,"translate"),r._uU(2),r.ALo(3,"translate"),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.key)("matTooltip",r.lcZ(1,3,"igo.geo.operators.tooltip."+e.key)),r.xp6(2),r.hij(" ",r.lcZ(3,5,"igo.geo.operators."+e.key)," ")}}function jg(e,t){if(1&e&&(r.TgZ(0,"mat-option",29),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.type),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.spatialSelector."+e.type)," ")}}function Qg(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-form-field",26),r.TgZ(1,"mat-select",27),r.NdJ("selectionChange",function(t){return r.CHM(e),r.oxw().changeSpatialSelector(t.value)}),r.YNc(2,jg,3,4,"mat-option",28),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(1),r.Q6J("disabled",!e.currentFilter.active)("value",e.currentFilter.igoSpatialSelector),r.xp6(1),r.Q6J("ngForOf",e.igoSpatialSelectors)}}function Gg(e,t){if(1&e&&(r.TgZ(0,"mat-option",33),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e)("matTooltip",e),r.xp6(1),r.hij(" ",e," ")}}function Yg(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",24),r.NdJ("click",function(){return r.CHM(e),r.oxw(2).clearProperty()}),r._UZ(1,"mat-icon",25),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("disabled",!e.currentFilter.active)}}function zg(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-form-field",30),r.NdJ("mouseenter",function(){return r.CHM(e),r.oxw().inputClearable="selectProperty"})("mouseleave",function(){return r.CHM(e),r.oxw().inputClearable=void 0}),r.TgZ(1,"input",18),r.NdJ("input",function(t){return r.CHM(e),r.oxw().updateValuesList(t.target.value)}),r.ALo(2,"translate"),r.qZA(),r.TgZ(3,"mat-autocomplete",19,31),r.NdJ("optionSelected",function(t){return r.CHM(e),r.oxw().changeProperty(t.option.value)}),r.YNc(5,Gg,2,3,"mat-option",32),r.ALo(6,"async"),r.qZA(),r.YNc(7,Yg,2,1,"button",22),r.qZA()}if(2&e){const e=r.MAs(4),t=r.oxw();r.Q6J("floatLabel",t.floatLabel),r.xp6(1),r.Q6J("placeholder",r.lcZ(2,8,"igo.geo.filter.placeholder"))("disabled",!t.currentFilter.active)("matAutocomplete",e)("value","expression"===t.detectProperty()?t.currentFilter.expression:t.currentFilter.pattern)("matTooltip","expression"===t.detectProperty()?t.currentFilter.expression||"":t.currentFilter.pattern||""),r.xp6(4),r.Q6J("ngForOf",r.lcZ(6,10,t.filteredValues$)),r.xp6(2),r.Q6J("ngIf",t.isClearable()&&"selectProperty"===t.inputClearable&&t.currentFilter.active)}}function Hg(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",24),r.NdJ("click",function(){return r.CHM(e),r.oxw(2).currentFilter.igoSNRC=""}),r._UZ(1,"mat-icon",25),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("disabled",!e.currentFilter.active&&"selectSNRC"===e.inputClearable&&e.currentFilter.active)}}function Vg(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-form-field",34),r.NdJ("mouseenter",function(){return r.CHM(e),r.oxw().inputClearable="selectSNRC"})("mouseleave",function(){return r.CHM(e),r.oxw().inputClearable=void 0}),r.TgZ(1,"input",35),r.NdJ("input",function(t){return r.CHM(e),r.oxw().changeSNRC(t.target.value)}),r.ALo(2,"translate"),r.qZA(),r.YNc(3,Hg,2,1,"button",22),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("floatLabel",e.floatLabel),r.xp6(1),r.Q6J("placeholder",r.lcZ(2,5,"igo.geo.filter.placeholderSnrc"))("value",e.currentFilter.igoSNRC)("matTooltip",e.currentFilter.igoSNRC?e.currentFilter.igoSNRC:""),r.xp6(2),r.Q6J("ngIf",e.currentFilter.igoSNRC)}}function Wg(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",37),r.NdJ("click",function(){return r.CHM(e),r.oxw(2).changeMapExtentGeometry()}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",38),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("disabled",!e.currentFilter.active)("disabled",!e.currentFilter.active)("matTooltip",r.lcZ(1,3,"igo.geo.spatialSelector.btnSetExtent"))}}function Xg(e,t){if(1&e&&(r.ynx(0),r.YNc(1,Wg,3,5,"button",36),r.BQk()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf","fixedExtent"===e.currentFilter.igoSpatialSelector)}}function Kg(e,t){if(1&e&&(r.TgZ(0,"mat-option",33),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e)("matTooltip",e),r.xp6(1),r.hij(" ",e," ")}}function em(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",24),r.NdJ("click",function(){return r.CHM(e),r.oxw(2).clearProperty(1)}),r._UZ(1,"mat-icon",25),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("disabled",!e.currentFilter.active)}}function tm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-form-field",39),r.NdJ("mouseenter",function(){return r.CHM(e),r.oxw().inputClearable="selectProperty1"})("mouseleave",function(){return r.CHM(e),r.oxw().inputClearable=void 0}),r.TgZ(1,"input",40),r.NdJ("input",function(t){return r.CHM(e),r.oxw().updateValuesList(t.target.value,1)}),r.ALo(2,"translate"),r.qZA(),r.TgZ(3,"mat-autocomplete",19,41),r.NdJ("optionSelected",function(t){return r.CHM(e),r.oxw().changeNumericProperty(t.option.value,1)}),r.YNc(5,Kg,2,3,"mat-option",32),r.ALo(6,"async"),r.qZA(),r.YNc(7,em,2,1,"button",22),r.qZA()}if(2&e){const e=r.MAs(4),t=r.oxw();r.Q6J("floatLabel",t.floatLabel),r.xp6(1),r.Q6J("placeholder",r.lcZ(2,7,"igo.geo.filter.placeholder"))("disabled",!t.currentFilter.active)("matAutocomplete",e)("value","lowerBoundary"===t.detectProperty(1)?t.currentFilter.lowerBoundary:t.currentFilter.begin),r.xp6(4),r.Q6J("ngForOf",r.lcZ(6,9,t.filteredValues$)),r.xp6(2),r.Q6J("ngIf",t.isClearable(1)&&"selectProperty1"===t.inputClearable&&t.currentFilter.active)}}function om(e,t){if(1&e&&(r.TgZ(0,"mat-option",33),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e)("matTooltip",e),r.xp6(1),r.hij(" ",e," ")}}function im(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",24),r.NdJ("click",function(){return r.CHM(e),r.oxw(2).clearProperty(2)}),r._UZ(1,"mat-icon",25),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("disabled",!e.currentFilter.active)}}function rm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-form-field",39),r.NdJ("mouseenter",function(){return r.CHM(e),r.oxw().inputClearable="selectProperty2"})("mouseleave",function(){return r.CHM(e),r.oxw().inputClearable=void 0}),r.TgZ(1,"input",40),r.NdJ("input",function(t){return r.CHM(e),r.oxw().updateValuesList(t.target.value,2)}),r.ALo(2,"translate"),r.qZA(),r.TgZ(3,"mat-autocomplete",19,42),r.NdJ("optionSelected",function(t){return r.CHM(e),r.oxw().changeNumericProperty(t.option.value,2)}),r.YNc(5,om,2,3,"mat-option",32),r.ALo(6,"async"),r.qZA(),r.YNc(7,im,2,1,"button",22),r.qZA()}if(2&e){const e=r.MAs(4),t=r.oxw();r.Q6J("floatLabel",t.floatLabel),r.xp6(1),r.Q6J("placeholder",r.lcZ(2,7,"igo.geo.filter.placeholder"))("disabled",!t.currentFilter.active)("matAutocomplete",e)("value","upperBoundary"===t.detectProperty(2)?t.currentFilter.upperBoundary:t.currentFilter.end),r.xp6(4),r.Q6J("ngForOf",r.lcZ(6,9,t.filteredValues$)),r.xp6(2),r.Q6J("ngIf",t.isClearable(2)&&"selectProperty2"===t.inputClearable&&t.currentFilter.active)}}function sm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-ogc-filter-time",43),r.NdJ("datasourceChange",function(t){return r.CHM(e),r.oxw().datasource=t})("currentFilterChange",function(t){return r.CHM(e),r.oxw().currentFilter=t})("changeProperty",function(t){return r.CHM(e),r.oxw().changeProperty(t.value,t.pos)}),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("datasource",e.datasource)("currentFilter",e.currentFilter)}}const nm=function(e,t){return{logical:e,logicalHidden:t}},am=function(e,t){return{operator:e,dualInput:t}},lm=function(){return["expression","pattern"]},cm=function(){return["lowerBoundary","begin"]},um=function(){return["upperBoundary","end"]};let pm=(()=>{class e{constructor(e){this.wktService=e,this.ogcFilterOperator=Bl,this.ogcFilterOperators$=new C.X(void 0),this.value="",this.selectedField$=new C.X(void 0),this.fields$=new C.X([]),this.color="primary",this.currentFilterIsSpatial$=new C.X(!1),this.defaultStepMillisecond=6e3,this._snrc="",this.floatLabel="never",this.allOgcFilterOperators=(new Ql).operators,this.ogcFilterOperators$.next(this.allOgcFilterOperators),this.igoSpatialSelectors=[{type:"fixedExtent"},{type:"snrc"}]}set snrc(e){(/^\d{2}$/gi.test(e)||/^\d{2}[a-p]$/gi.test(e)||/^\d{2}[a-l][0,1][0-9]$/gi.test(e))&&(this._snrc=e,this.currentFilter.igoSNRC=e)}get snrc(){return this._snrc}get activeFilters(){return this.datasource.options.ogcFilters.interfaceOgcFilters.filter(e=>!0===e.active)}get allowedOperators(){return(new Ql).computeAllowedOperators(this.fields$.value,this.currentFilter.propertyName,this.datasource.options.ogcFilters.allowedOperatorsType)}ngOnInit(){if(this.datasource.options.sourceFields){const e=this.datasource.options.sourceFields.filter(e=>void 0===e.excludeFromOgcFilters||!e.excludeFromOgcFilters);e.map(e=>{e.values&&e.values.sort()}),this.fields$.next(e)}this.updateFieldsList(),this.selectedField$.next(this.fields$.value.find(e=>e.name===this.currentFilter.propertyName)),this.updateValuesList(),this.selectedField$.subscribe(e=>{this.ogcFilterOperators$.next(this.allowedOperators),-1===Object.keys(this.allowedOperators).indexOf(this.currentFilter.operator)&&(this.currentFilter.operator=Object.keys(this.allowedOperators)[0],this.currentFilter.operator=Object.keys(this.allowedOperators)[0]),this.updateValuesList()}),this.currentFilterIsSpatial()}updateFieldsList(e){this.filteredFields$=e&&e.length>0?(0,A.of)(this._filterFields(e)):this.fields$,this.fields$.value.find(t=>t.name===e)&&this.changeField(e)}updateValuesList(e,t){this.filteredValues$=(0,A.of)(e&&e.length>0?this._filterValues(e):this.selectedField$.value?this.selectedField$.value.values:[]),e&&e.length>=1&&this.changeProperty(e,t)}_filterFields(e){const t=new RegExp(e.normalize("NFD").replace(/[\u0300-\u036f]/g,""),"gi");return this.fields$.value.filter(e=>t.test(e.alias.normalize("NFD").replace(/[\u0300-\u036f]/g,"")))}_filterValues(e){const t=new RegExp(e.toString().normalize("NFD").replace(/[\u0300-\u036f]/g,""),"gi");return this.selectedField$.value.values.filter(e=>e&&t.test(e.toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"")))}clearSelectedField(){this.currentFilter.propertyName="",this.selectedField$.next(void 0),this.clearProperty()}isClearable(e){const t=this.detectProperty(e);if(t)return this.currentFilter[t]}clearProperty(e){const t=this.detectProperty(e);if(t)return this.currentFilter[t]=""}toggleFilterState(e){this.datasource.options.ogcFilters.interfaceOgcFilters.find(e=>e.filterid===this.currentFilter.filterid).active=e.checked,this.refreshFilters()}deleteFilter(){const e=this.datasource.options.ogcFilters;e.interfaceOgcFilters=e.interfaceOgcFilters.filter(e=>e.filterid!==this.currentFilter.filterid),this.refreshFilters()}changeLogical(e){this.currentFilter.parentLogical=e,this.refreshFilters()}changeOperator(e){this.currentFilter.operator=e,this.currentFilterIsSpatial(),this.currentFilterIsSpatial$.value&&0===this.currentFilter.wkt_geometry.length?this.changeSpatialSelector(this.currentFilter.igoSpatialSelector):this.refreshFilters()}changeField(e){this.currentFilter.propertyName=e,this.selectedField$.next(this.fields$.value.find(e=>e.name===this.currentFilter.propertyName)),this.refreshFilters()}changeCaseSensitive(e){this.currentFilter.matchCase=e.checked,this.refreshFilters()}changeProperty(e,t,o=!0){const i=this.detectProperty(t);i&&(this.datasource.options.ogcFilters.interfaceOgcFilters.find(e=>e.filterid===this.currentFilter.filterid)[i]=e,o&&this.refreshFilters())}changeNumericProperty(e,t){this.changeProperty(parseFloat(e),t)}changeSpatialSelector(e){this.currentFilter.igoSpatialSelector=e,"fixedExtent"===e&&this.changeMapExtentGeometry(!1),this.currentFilterIsSpatial(),this.refreshFilters()}changeSNRC(e){this.snrc=e,this.changeSNRCGeometry()}changeSNRCGeometry(){!this.datasource.options.ogcFilters.interfaceOgcFilters.find(e=>e.filterid===this.currentFilter.filterid)||(this.snrc&&"snrc"===this.currentFilter.igoSpatialSelector&&(this.currentFilter.wkt_geometry=this.wktService.snrcToWkt(this.snrc,this.map.projection).wktPoly),this.refreshFilters())}changeMapExtentGeometry(e=!0){!this.datasource.options.ogcFilters.interfaceOgcFilters.find(e=>e.filterid===this.currentFilter.filterid)||("fixedExtent"===this.currentFilter.igoSpatialSelector&&(this.currentFilter.wkt_geometry=this.wktService.extentToWkt(this.map.projection,this.map.viewController.getExtent(),this.map.projection).wktPoly),e&&this.refreshFilters())}detectProperty(e){switch(this.currentFilter.operator){case Bl.PropertyIsNotEqualTo:case Bl.PropertyIsEqualTo:case Bl.PropertyIsGreaterThan:case Bl.PropertyIsGreaterThanOrEqualTo:case Bl.PropertyIsLessThan:case Bl.PropertyIsLessThanOrEqualTo:return"expression";case Bl.PropertyIsLike:return"pattern";case Bl.PropertyIsBetween:return e&&1===e?"lowerBoundary":e&&2===e?"upperBoundary":void 0;case Bl.During:return e&&1===e?"begin":e&&2===e?"end":void 0;default:return}}currentFilterIsSpatial(){let e=!1;this.currentFilter&&(e=-1!==[Bl.Contains,Bl.Intersects,Bl.Within].indexOf(this.currentFilter.operator)),this.currentFilterIsSpatial$.next(e)}isTemporalOperator(){return this.currentFilter.operator.toLowerCase()===this.ogcFilterOperator.During.toLowerCase()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Rg))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-ogc-filter-form"]],inputs:{refreshFilters:"refreshFilters",datasource:"datasource",map:"map",currentFilter:"currentFilter",floatLabel:"floatLabel"},decls:42,vars:76,consts:[["tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","checked","click","change"],[3,"ngClass"],["tooltip-position","above","matTooltipShowDelay","500",3,"disabled","value","matTooltip","selectionChange"],["tooltip-position","above","matTooltipShowDelay","500",3,"value","matTooltip"],["class","field",3,"floatLabel","mouseenter","mouseleave",4,"ngIf"],[3,"ngClass","floatLabel"],["tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","disabled","value","selectionChange"],["tooltip-position","above","matTooltipShowDelay","500",3,"value","matTooltip",4,"ngFor","ngForOf"],["class","spatialSelector",4,"ngIf"],["class","singleInput",3,"floatLabel","mouseenter","mouseleave",4,"ngIf"],[1,"igo-layer-button-group"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip","click"],["svgIcon","delete"],["class","snrc",3,"floatLabel","mouseenter","mouseleave",4,"ngIf"],[4,"ngIf"],["class","dualInput",3,"floatLabel","mouseenter","mouseleave",4,"ngIf"],[3,"datasource","currentFilter","datasourceChange","currentFilterChange","changeProperty",4,"ngIf"],[1,"field",3,"floatLabel","mouseenter","mouseleave"],["matInput","","tooltip-position","above","matTooltipShowDelay","500",3,"placeholder","disabled","matAutocomplete","value","matTooltip","input"],[3,"optionSelected"],["autoCompleteField","matAutocomplete"],["matTooltipShowDelay","500",3,"value","id","matTooltip",4,"ngFor","ngForOf"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"disabled","click",4,"ngIf"],["matTooltipShowDelay","500",3,"value","id","matTooltip"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"disabled","click"],["svgIcon","close"],[1,"spatialSelector"],[3,"disabled","value","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"singleInput",3,"floatLabel","mouseenter","mouseleave"],["autoCompleteValues","matAutocomplete"],["matTooltipShowDelay","500",3,"value","matTooltip",4,"ngFor","ngForOf"],["matTooltipShowDelay","500",3,"value","matTooltip"],[1,"snrc",3,"floatLabel","mouseenter","mouseleave"],["matInput","","tooltip-position","above","matTooltipShowDelay","500",3,"placeholder","value","matTooltip","input"],["mat-button","","matSuffix","","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"disabled","matTooltip","click",4,"ngIf"],["mat-button","","matSuffix","","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"disabled","matTooltip","click"],["svgIcon","arrow-expand-all"],[1,"dualInput",3,"floatLabel","mouseenter","mouseleave"],["matInput","","type","number",3,"placeholder","disabled","matAutocomplete","value","input"],["autoDualValueOperator1","matAutocomplete"],["autoDualValueOperator2","matAutocomplete"],[3,"datasource","currentFilter","datasourceChange","currentFilterChange","changeProperty"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-checkbox",0),r.NdJ("click",function(e){return e.stopPropagation()})("change",function(e){return t.toggleFilterState(e)}),r.ALo(1,"translate"),r.qZA(),r.TgZ(2,"mat-form-field",1),r.TgZ(3,"mat-select",2),r.NdJ("selectionChange",function(e){return t.changeLogical(e.value)}),r.ALo(4,"translate"),r.TgZ(5,"mat-option",3),r.ALo(6,"translate"),r._uU(7),r.ALo(8,"translate"),r.qZA(),r.TgZ(9,"mat-option",3),r.ALo(10,"translate"),r._uU(11),r.ALo(12,"translate"),r.qZA(),r.qZA(),r.qZA(),r.YNc(13,Jg,13,22,"mat-form-field",4),r.ALo(14,"async"),r.ALo(15,"async"),r.ALo(16,"async"),r.ALo(17,"async"),r.TgZ(18,"mat-form-field",5),r.ALo(19,"async"),r.ALo(20,"async"),r.TgZ(21,"mat-select",6),r.NdJ("selectionChange",function(e){return t.changeOperator(e.value)}),r.ALo(22,"translate"),r.ALo(23,"translate"),r.YNc(24,Bg,4,7,"mat-option",7),r.ALo(25,"keyvalue"),r.ALo(26,"async"),r.qZA(),r.qZA(),r.YNc(27,Qg,3,3,"mat-form-field",8),r.ALo(28,"async"),r.YNc(29,zg,8,12,"mat-form-field",9),r.TgZ(30,"div",10),r.TgZ(31,"button",11),r.NdJ("click",function(){return t.deleteFilter()}),r.ALo(32,"translate"),r._UZ(33,"mat-icon",12),r.qZA(),r.qZA(),r.YNc(34,Vg,4,7,"mat-form-field",13),r.ALo(35,"async"),r.YNc(36,Xg,2,1,"ng-container",14),r.ALo(37,"async"),r._UZ(38,"br"),r.YNc(39,tm,8,11,"mat-form-field",15),r.YNc(40,rm,8,11,"mat-form-field",15),r.YNc(41,sm,1,2,"igo-ogc-filter-time",16)),2&e&&(r.Q6J("matTooltip",r.lcZ(1,27,"igo.geo.filter.toggleFilterState"))("checked",t.currentFilter.active),r.xp6(2),r.Q6J("ngClass",r.WLB(67,nm,0!==t.activeFilters.indexOf(t.currentFilter)&&!0===t.currentFilter.active,0===t.activeFilters.indexOf(t.currentFilter)||!0!==t.currentFilter.active)),r.xp6(1),r.Q6J("disabled",!t.currentFilter.active)("value",t.currentFilter.parentLogical)("matTooltip",t.currentFilter.parentLogical?r.lcZ(4,29,"igo.geo.operators.tooltip."+t.currentFilter.parentLogical):""),r.xp6(2),r.Q6J("value",t.ogcFilterOperator.And)("matTooltip",r.lcZ(6,31,"igo.geo.operators.tooltip.And")),r.xp6(2),r.hij(" ",r.lcZ(8,33,"igo.geo.operators.And")," "),r.xp6(2),r.Q6J("value",t.ogcFilterOperator.Or)("matTooltip",r.lcZ(10,35,"igo.geo.operators.tooltip.Or")),r.xp6(2),r.hij(" ",r.lcZ(12,37,"igo.geo.operators.Or")," "),r.xp6(2),r.Q6J("ngIf",!1===r.lcZ(14,39,t.currentFilterIsSpatial$)&&r.lcZ(15,41,t.fields$)&&r.lcZ(16,43,t.fields$).length>0&&""!==r.lcZ(17,45,t.fields$)[0].name),r.xp6(5),r.Q6J("ngClass",r.WLB(70,am,!1===r.lcZ(19,47,t.currentFilterIsSpatial$),r.lcZ(20,49,t.currentFilterIsSpatial$)))("floatLabel",t.floatLabel),r.xp6(3),r.Q6J("matTooltip",t.currentFilter.operator?r.lcZ(22,51,"igo.geo.operators.tooltip."+t.currentFilter.operator):r.lcZ(23,53,"igo.geo.filter.selectOperator"))("disabled",!t.currentFilter.active)("value",t.currentFilter.operator),r.xp6(3),r.Q6J("ngForOf",r.lcZ(25,55,r.lcZ(26,57,t.ogcFilterOperators$))),r.xp6(3),r.Q6J("ngIf",r.lcZ(28,59,t.currentFilterIsSpatial$)),r.xp6(2),r.Q6J("ngIf",-1!==r.DdM(73,lm).indexOf(t.detectProperty())),r.xp6(2),r.Q6J("matTooltip",r.lcZ(32,61,"igo.geo.filter.removeFilter")),r.xp6(3),r.Q6J("ngIf",r.lcZ(35,63,t.currentFilterIsSpatial$)&&"snrc"===t.currentFilter.igoSpatialSelector),r.xp6(2),r.Q6J("ngIf",r.lcZ(37,65,t.currentFilterIsSpatial$)&&"fixedExtent"===t.currentFilter.igoSpatialSelector),r.xp6(3),r.Q6J("ngIf",!t.isTemporalOperator()&&-1!==r.DdM(74,cm).indexOf(t.detectProperty(1))),r.xp6(1),r.Q6J("ngIf",!t.isTemporalOperator()&&-1!==r.DdM(75,um).indexOf(t.detectProperty(2))),r.xp6(1),r.Q6J("ngIf",t.isTemporalOperator()))},styles:["[_nghost-%COMP%]{width:100%;padding:5px 10px}  .mat-form-field .mat-icon svg{width:1em;height:1em;color:#d3d3d3}.mat-form-field[_ngcontent-%COMP%]{width:100%}.mat-select-arrow[_ngcontent-%COMP%]{visibility:hidden}.mat-slide-toggle[_ngcontent-%COMP%]{margin-top:10px}.logical[_ngcontent-%COMP%]{flex-flow:column nowrap;width:10%;max-width:45px;margin-left:5px}.logicalHidden[_ngcontent-%COMP%]{flex-flow:column nowrap;width:10%;visibility:hidden;max-width:45px;margin-left:5px}  .logical .mat-select-arrow{visibility:hidden}  .logicalHidden .mat-select-arrow{visibility:hidden}.field[_ngcontent-%COMP%]{width:20%;margin-left:5px}  .field .mat-select-arrow{visibility:hidden}.operator[_ngcontent-%COMP%]{width:12%;margin-left:10px;text-align:center}  .operator .mat-select-arrow{visibility:hidden}.spatialSelector[_ngcontent-%COMP%]{width:15%;margin-left:5px}  .spatialSelector .mat-select-arrow{visibility:hidden}.singleInput[_ngcontent-%COMP%]{width:30%;margin-left:5px}.snrc[_ngcontent-%COMP%]{width:20%;margin-left:5px}  .singleInput .mat-select-arrow{visibility:hidden}.dualInput[_ngcontent-%COMP%]{width:20%;margin-left:5px}  .dualInput .mat-select-arrow{visibility:hidden}.igo-layer-button-group[_ngcontent-%COMP%]{display:flex;float:right;padding-top:5px}.container[_ngcontent-%COMP%]{display:flex}"]}),e})();function dm(e,t){if(1&e&&r._UZ(0,"igo-ogc-filter-selection",2),2&e){const e=r.oxw();r.Q6J("refreshFilters",e.refreshFunc)("datasource",e.datasource)("map",e.map)("currentFilter",e.currentFilter)}}function hm(e,t){if(1&e&&r._UZ(0,"igo-ogc-filter-form",4),2&e){const e=t.$implicit,o=r.oxw(2);r.Q6J("currentFilter",e)("refreshFilters",o.refreshFunc)("datasource",o.datasource)("map",o.map)}}function gm(e,t){if(1&e&&r.YNc(0,hm,1,4,"ng-template",3),2&e){const e=r.oxw();r.Q6J("ngForOf",e.datasource.options.ogcFilters.interfaceOgcFilters)}}let mm=(()=>{class e{constructor(){this.color="primary"}get refreshFunc(){return this.refreshFilters}get advancedOgcFilters(){if(this.datasource.options.ogcFilters)return this.datasource.options.ogcFilters.advancedOgcFilters}get currentFilter(){return this.datasource.options.ogcFilters.interfaceOgcFilters?this.datasource.options.ogcFilters.interfaceOgcFilters[0]:void 0}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-ogc-filterable-form"]],inputs:{datasource:"datasource",map:"map",refreshFilters:"refreshFilters"},decls:2,vars:2,consts:[["igoListItem","",3,"refreshFilters","datasource","map","currentFilter",4,"ngIf"],[4,"ngIf"],["igoListItem","",3,"refreshFilters","datasource","map","currentFilter"],["ngFor","",3,"ngForOf"],[3,"currentFilter","refreshFilters","datasource","map"]],template:function(e,t){1&e&&(r.YNc(0,dm,1,4,"igo-ogc-filter-selection",0),r.YNc(1,gm,1,1,void 0,1)),2&e&&(r.Q6J("ngIf",!t.advancedOgcFilters),r.xp6(1),r.Q6J("ngIf",t.advancedOgcFilters&&t.datasource.options.ogcFilters.editable))},encapsulation:2}),e})();function fm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-icon",8),r.NdJ("click",function(){return r.CHM(e),r.oxw().toggleFiltersCollapsed()}),r.qZA()}if(2&e){const e=r.oxw(),t=r.MAs(6);r.Q6J("target",t)("collapsed",e.filtersCollapsed)}}const ym=function(e){return{cursor:e}};function vm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"h4",9),r.NdJ("click",function(){return r.CHM(e),r.oxw().toggleLegendOnClick()}),r._uU(1),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("ngStyle",r.VKq(3,ym,e.filtersCollapsed?"default":"pointer"))("matTooltip",e.layer.title),r.xp6(1),r.Oqu(e.layer.title)}}function bm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",10),r.NdJ("click",function(){return r.CHM(e),r.oxw().addFilterToSequence()}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",11),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("disabled",e.addFilterDisabled())("matTooltip",r.lcZ(1,3,"igo.geo.filter.addFilter"))("color",e.color)}}const xm=function(e){return{disabled:e}};function wm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",12),r.NdJ("click",function(){r.CHM(e);const t=r.oxw();return t.layer.visible=!t.layer.visible}),r.ALo(1,"translate"),r.ALo(2,"translate"),r._UZ(3,"mat-icon",13),r.ALo(4,"async"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("color",e.layer.visible?"primary":"default")("matTooltip",e.layer.visible?r.lcZ(1,4,"igo.geo.layer.hideLayer"):r.lcZ(2,6,"igo.geo.layer.showLayer")),r.xp6(3),r.Q6J("ngClass",r.VKq(10,xm,!1===r.lcZ(4,8,e.inResolutionRange$)))("svgIcon",e.layer.visible?"eye":"eye-off")}}function Sm(e,t){if(1&e&&r._UZ(0,"igo-layer-legend",17),2&e){const e=r.oxw(2);r.Q6J("layer",e.layer)}}function Cm(e,t){if(1&e&&(r.TgZ(0,"div",14,15),r.YNc(2,Sm,1,1,"igo-layer-legend",16),r.ALo(3,"async"),r.qZA()),2&e){const e=r.oxw();r.xp6(2),r.Q6J("ngIf",r.lcZ(3,1,e.showLegend$))}}function Tm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"section",18),r._UZ(1,"mat-divider"),r.TgZ(2,"mat-checkbox",19),r.NdJ("change",function(t){return r.CHM(e),r.oxw().changeOgcFilterType(t)})("ngModelChange",function(t){return r.CHM(e),r.oxw().datasource.options.ogcFilters.advancedOgcFilters=t}),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(2),r.Q6J("ngModel",e.datasource.options.ogcFilters.advancedOgcFilters),r.xp6(1),r.hij(" ",r.lcZ(4,2,"igo.geo.filter.advancedOgcFilters")," ")}}let Am=(()=>{class e{constructor(e){this.ogcFilterService=e,this.color="primary",this.defaultLogicalParent=Bl.And,this.hasActiveSpatialFilter=!1,this.filtersAreEditable=!0,this.filtersCollapsed=!0,this.hasSelector=!1,this.showLegend$=new C.X(!1),this.inResolutionRange$=new C.X(!0),this.header=!0,this.ogcFilterWriter=new Ql}get refreshFunc(){return this.refreshFilters.bind(this)}get datasource(){return this.layer.dataSource}ngOnInit(){const e=this.datasource.options.ogcFilters;switch((e.pushButtons&&e.pushButtons.bundles.length>0||e.checkboxes&&e.checkboxes.bundles.length>0||e.radioButtons&&e.radioButtons.bundles.length>0||e.select&&e.select.bundles.length>0)&&(void 0===e.advancedOgcFilters&&(e.advancedOgcFilters=!1),this.hasSelector=!0),this.datasource.options.type){case"wms":this.ogcFilterService.setOgcWMSFiltersOptions(this.datasource);break;case"wfs":this.ogcFilterService.setOgcWFSFiltersOptions(this.datasource)}e&&(e.interfaceOgcFilters&&(this.lastRunOgcFilter=JSON.parse(JSON.stringify(e.interfaceOgcFilters)),e.interfaceOgcFilters.filter(e=>e.wkt_geometry).length>=1&&(this.hasActiveSpatialFilter=!0)),this.filtersAreEditable=!!e.editable&&e.editable),this.resolution$$=this.layer.map.viewController.resolution$.subscribe(()=>{this.inResolutionRange$.next(this.layer.isInResolutionsRange)})}ngOnDestroy(){this.resolution$$.unsubscribe()}addFilterToSequence(){this.filtersCollapsed=!1;const e=this.datasource.options.ogcFilters.interfaceOgcFilters||[],t=0===e.length?0:e[e.length-1].level;let o="";const i=this.datasource.options.sourceFields.filter(e=>!e.excludeFromOgcFilters);let r;i.length>0&&(o=void 0===i[0].name?"":i[0].name);const s=this.datasource.options;s.fieldNameGeometry?r=s.fieldNameGeometry:this.datasource.options.paramsWFS&&this.datasource.options.paramsWFS.fieldNameGeometry&&(r=this.datasource.options.paramsWFS.fieldNameGeometry);const n=this.ogcFilterWriter.computeAllowedOperators(this.datasource.options.sourceFields,o,this.datasource.options.ogcFilters.allowedOperatorsType),a=Object.keys(n)[0];e.push(this.ogcFilterWriter.addInterfaceFilter({propertyName:o,operator:a,active:!0,igoSpatialSelector:"fixedExtent",srsName:this.map.projection},r,t,this.defaultLogicalParent)),this.datasource.options.ogcFilters.interfaceOgcFilters=e}refreshFilters(e){!0===e&&(this.lastRunOgcFilter=void 0);const t=this.datasource.options.ogcFilters,o=t.interfaceOgcFilters?t.interfaceOgcFilters.filter(e=>!0===e.active):[];if(0===o.length&&(t.filters=void 0,t.filtered=!1),o.length>1&&(o[0].parentLogical=o[1].parentLogical),this.hasActiveSpatialFilter=0!==o.filter(e=>-1!==["Contains","Intersects","Within"].indexOf(e.operator)).length,JSON.stringify(this.lastRunOgcFilter)!==JSON.stringify(o)){if("wfs"===this.layer.dataSource.options.type)this.layer.dataSource.options.ogcFilters.filters=this.ogcFilterWriter.rebuiltIgoOgcFilterObjectFromSequence(o),this.layer.dataSource.ol.refresh();else if("wms"===this.layer.dataSource.options.type&&t.enabled){let e="";if(o.length>=1){const t=this.layer.dataSource,i=t.options.ogcFilters;i.filters=this.ogcFilterWriter.rebuiltIgoOgcFilterObjectFromSequence(o),e=this.ogcFilterWriter.buildFilter(i.filters,void 0,void 0,this.layer.dataSource.options.fieldNameGeometry,t.options)}this.ogcFilterService.filterByOgc(this.datasource,e),this.datasource.options.ogcFilters.filtered=0!==o.length}this.lastRunOgcFilter=JSON.parse(JSON.stringify(o))}this.layer.dataSource.setOgcFilters(t,!0)}setVisible(){this.layer.visible=!0}isAdvancedOgcFilters(){return this.datasource.options.ogcFilters.advancedOgcFilters}addFilterDisabled(){return!this.datasource.options.sourceFields||0===this.datasource.options.sourceFields.length}changeOgcFiltersAdvancedOgcFilters(e){this.datasource.options.ogcFilters.advancedOgcFilters=e}changeOgcFilterType(e){this.changeOgcFiltersAdvancedOgcFilters(e.checked),e.checked&&this.refreshFilters(!0)}toggleLegend(e){this.layer.legendCollapsed=e,this.showLegend$.next(!e)}toggleLegendOnClick(){this.filtersCollapsed||this.toggleLegend(this.showLegend$.value)}toggleFiltersCollapsed(){this.filtersCollapsed=!this.filtersCollapsed}}return e.\u0275fac=function(t){return new(t||e)(r.Y36($d))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-ogc-filterable-item"]],inputs:{layer:"layer",map:"map",header:"header"},decls:10,vars:9,consts:[["class","igo-chevron","mat-list-avatar","","igoCollapse","","svgIcon","chevron-up",3,"target","collapsed","click",4,"ngIf"],["matLine","","matTooltipShowDelay","500",3,"ngStyle","matTooltip","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"disabled","matTooltip","color","click",4,"ngIf"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"color","matTooltip","click",4,"ngIf"],["ogcFilters",""],["class","igo-layer-legend-container",4,"ngIf"],[3,"datasource","map","refreshFilters"],["class","mat-typography advancedOgcFilters",4,"ngIf"],["mat-list-avatar","","igoCollapse","","svgIcon","chevron-up",1,"igo-chevron",3,"target","collapsed","click"],["matLine","","matTooltipShowDelay","500",3,"ngStyle","matTooltip","click"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"disabled","matTooltip","color","click"],["svgIcon","plus"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"color","matTooltip","click"],[3,"ngClass","svgIcon"],[1,"igo-layer-legend-container"],["legend",""],[3,"layer",4,"ngIf"],[3,"layer"],[1,"mat-typography","advancedOgcFilters"],["labelPosition","before",3,"ngModel","change","ngModelChange"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-list-item"),r.YNc(1,fm,1,2,"mat-icon",0),r.YNc(2,vm,2,5,"h4",1),r.YNc(3,bm,3,5,"button",2),r.YNc(4,wm,5,12,"button",3),r.qZA(),r.TgZ(5,"div",null,4),r.YNc(7,Cm,4,3,"div",5),r._UZ(8,"igo-ogc-filterable-form",6),r.YNc(9,Tm,5,4,"section",7),r.qZA()),2&e&&(r.xp6(1),r.Q6J("ngIf",t.header),r.xp6(1),r.Q6J("ngIf",t.header),r.xp6(1),r.Q6J("ngIf",t.isAdvancedOgcFilters()&&t.filtersAreEditable),r.xp6(1),r.Q6J("ngIf",t.header),r.xp6(3),r.Q6J("ngIf",t.header),r.xp6(1),r.Q6J("datasource",t.datasource)("map",t.map)("refreshFilters",t.refreshFunc),r.xp6(1),r.Q6J("ngIf",t.hasSelector&&t.filtersAreEditable))},styles:["[_nghost-%COMP%]{overflow:hidden}.advancedOgcFilters[_ngcontent-%COMP%]{text-align:center;width:100%;display:inline-block}.mat-list-item[_ngcontent-%COMP%]{height:auto}.igo-layer-legend-container[_ngcontent-%COMP%]{padding-left:1.125em;width:calc(100% - 18px)}mat-icon.disabled[_ngcontent-%COMP%]{color:#00000061}"]}),e})();function Lm(e,t){if(1&e&&r._UZ(0,"igo-ogc-filterable-item",2),2&e){const e=t.$implicit;r.Q6J("header",!0)("layer",e)("map",e.map)}}let Zm=(()=>{class e{constructor(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-ogc-filterable-list"]],inputs:{layers:"layers",map:"map"},decls:3,vars:6,consts:[[3,"navigation","selection"],["ngFor","",3,"ngForOf"],["igoListItem","",3,"header","layer","map"]],template:function(e,t){1&e&&(r.TgZ(0,"igo-list",0),r.YNc(1,Lm,1,3,"ng-template",1),r.ALo(2,"filterableDataSource"),r.qZA()),2&e&&(r.Q6J("navigation",!1)("selection",!1),r.xp6(1),r.Q6J("ngForOf",r.xi3(2,3,t.layers,"ogc")))},encapsulation:2,changeDetection:0}),e})();function Fm(e,t){if(1&e&&(r.TgZ(0,"button",2),r.ALo(1,"translate"),r._UZ(2,"mat-icon",3),r.qZA()),2&e){const e=r.oxw();r.Q6J("matTooltip",r.lcZ(1,3,"igo.geo.filter.filterBy"))("color",e.color),r.xp6(2),r.Q6J("matBadge",e.badge)}}function Om(e,t){if(1&e&&r._UZ(0,"igo-ogc-filterable-item",7),2&e){const e=r.oxw(2);r.Q6J("header",!1)("map",e.layer.map)("layer",e.layer)}}function Mm(e,t){if(1&e&&(r.TgZ(0,"div",4,5),r.YNc(2,Om,1,3,"igo-ogc-filterable-item",6),r.qZA()),2&e){const e=r.oxw();r.xp6(2),r.Q6J("ngIf",e.ogcFilterCollapse&&e.options.ogcFilters.enabled)}}let Im=(()=>{class e{constructor(){this.color="primary",this.ogcFilterCollapse=!1}get badge(){const e=this.options.ogcFilters;let t=0;if(e&&!e.advancedOgcFilters){if(e.pushButtons){const o=e.pushButtons.groups.find(e=>e.enabled);let i=0;o&&o.computedSelectors.map(e=>i+=e.selectors.filter(e=>e.enabled).length),t+=i}if(e.checkboxes){const o=e.checkboxes.groups.find(e=>e.enabled);let i=0;o&&o.computedSelectors.map(e=>i+=e.selectors.filter(e=>e.enabled).length),t+=i}if(e.radioButtons){const o=e.radioButtons.groups.find(e=>e.enabled);let i=0;o&&o.computedSelectors.map(e=>i+=e.selectors.filter(e=>e.enabled).length),t+=i}if(e.select){const o=e.select.groups.find(e=>e.enabled);let i=0;o&&o.computedSelectors.map(e=>i+=e.selectors.filter(e=>e.enabled).length),t+=i}}else{if(e&&e.filters&&!e.filters.filters)return 1;if(e&&e.filters&&e.filters.filters)return e.filters.filters.length}return t>0?t:void 0}get layer(){return this._layer}set layer(e){this._layer=e,e&&(this.options=this.layer.dataSource.options)}ngOnInit(){this.options=this.layer.dataSource.options}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-ogc-filter-button"]],inputs:{layer:"layer",map:"map",color:"color",header:"header"},decls:2,vars:2,consts:[["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color",4,"ngIf"],["class","igo-layer-actions-container",4,"ngIf"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color"],["matBadgeColor","warn","matBadgeSize","medium","svgIcon","filter",3,"matBadge"],[1,"igo-layer-actions-container"],["ogcFilter",""],["igoListItem","",3,"header","map","layer",4,"ngIf"],["igoListItem","",3,"header","map","layer"]],template:function(e,t){1&e&&(r.YNc(0,Fm,3,5,"button",0),r.YNc(1,Mm,3,1,"div",1)),2&e&&(r.Q6J("ngIf",t.header&&t.options.ogcFilters&&t.options.ogcFilters.enabled&&(t.options.ogcFilters.pushButtons||t.options.ogcFilters.checkboxes||t.options.ogcFilters.radioButtons||t.options.ogcFilters.select||t.options.ogcFilters.editable)),r.xp6(1),r.Q6J("ngIf",t.options.ogcFilters&&t.options.ogcFilters.enabled&&(t.options.ogcFilters.pushButtons||t.options.ogcFilters.checkboxes||t.options.ogcFilters.radioButtons||t.options.ogcFilters.select||t.options.ogcFilters.editable)))},styles:[""],changeDetection:0}),e})();const km=ua;let Pm=(()=>{class e{constructor(){this.defaultStepMillisecond=6e4}step(e,t){return e.options.stepDate?e.options.stepDate:t.step}stepMillisecond(e,t){const o=km.duration(this.step(e,t)).asMilliseconds();return 0===o?this.defaultStepMillisecond:o}stepIsYearDuration(e){const t=km.duration(e);return 0!==t.years()&&0===t.months()&&0===t.weeks()&&0===t.days()&&0===t.hours()&&0===t.minutes()}stepIsMonthDuration(e){const t=km.duration(e);return 0!==t.months()&&0===t.weeks()&&0===t.days()&&0===t.hours()&&0===t.minutes()}stepIsWeekDuration(e){const t=km.duration(e);return 0!==t.weeks()&&7===t.days()&&0===t.hours()&&0===t.minutes()}stepIsDayDuration(e){const t=km.duration(e);return 0!==t.days()&&0===t.hours()&&0===t.minutes()}stepIsHourDuration(e){const t=km.duration(e);return 0!==t.hours()&&0===t.minutes()}stepIsMinuteDuration(e){return 0!==km.duration(e).minutes()}dateToNumber(e){let t=new Date;return e&&(t=new Date(e)),t.getTime()}addStep(e,t){return km(e).add(t,"milliseconds").toDate()}subtractStep(e,t){return km(e).subtract(t,"milliseconds").toDate()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})();const _m=["selection"];function $m(e,t){if(1&e&&(r.TgZ(0,"mat-option",12),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.hij("",e.title," ")}}function qm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",9),r.TgZ(1,"mat-form-field"),r.TgZ(2,"mat-select",10),r.NdJ("valueChange",function(t){return r.CHM(e),r.oxw(3).currentPushButtonsGroup=t}),r.ALo(3,"translate"),r.YNc(4,$m,2,2,"mat-option",11),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(3);r.xp6(2),r.Q6J("matTooltip",r.lcZ(3,3,"igo.geo.layer.legend.selectStyle"))("value",e.currentPushButtonsGroup),r.xp6(2),r.Q6J("ngForOf",e.getPushButtonsGroups())}}function Dm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-button-toggle",15),r.NdJ("change",function(){const t=r.CHM(e).$implicit,o=r.oxw(3).$implicit;return r.oxw().onSelectionChange(t,o.selectorType)}),r._uU(1),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(4);r.Q6J("matTooltip",o.getToolTip(e))("ngStyle",o.getButtonColor(e))("checked",e.enabled)("value",e),r.xp6(1),r.hij("",e.title," ")}}function Em(e,t){if(1&e&&(r.ynx(0),r.TgZ(1,"h4"),r._uU(2),r.qZA(),r.TgZ(3,"mat-button-toggle-group",13),r.YNc(4,Dm,2,5,"mat-button-toggle",14),r.qZA(),r.BQk()),2&e){const e=t.$implicit,o=r.oxw(3);r.xp6(2),r.Oqu(e.title),r.xp6(1),r.s9C("vertical",o.bundleIsVertical(e)),r.xp6(1),r.Q6J("ngForOf",e.selectors)}}function Rm(e,t){if(1&e&&(r.TgZ(0,"div",7),r._UZ(1,"mat-divider"),r.YNc(2,qm,5,5,"div",8),r.YNc(3,Em,5,3,"ng-container",1),r.qZA()),2&e){const e=r.oxw(2);r.xp6(2),r.Q6J("ngIf",e.getPushButtonsGroups().length>1),r.xp6(1),r.Q6J("ngForOf",e.currentPushButtonsGroup.computedSelectors)}}function Um(e,t){if(1&e&&(r.TgZ(0,"mat-option",12),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.hij("",e.title," ")}}function Nm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",9),r.TgZ(1,"mat-form-field"),r.TgZ(2,"mat-select",17),r.NdJ("valueChange",function(t){return r.CHM(e),r.oxw(3).currentCheckboxesGroup=t}),r.ALo(3,"translate"),r.YNc(4,Um,2,2,"mat-option",11),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(3);r.xp6(2),r.Q6J("matTooltip",r.lcZ(3,3,"igo.geo.layer.legend.selectStyle"))("value",e.currentCheckboxesGroup),r.xp6(2),r.Q6J("ngForOf",e.getCheckboxesGroups())}}function Jm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-checkbox",20),r.NdJ("change",function(){const t=r.CHM(e).$implicit,o=r.oxw(3).$implicit;return r.oxw().onSelectionChange(t,o.selectorType)}),r._uU(1),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(4);r.Q6J("matTooltip",o.getToolTip(e))("checked",e.enabled)("value",e),r.xp6(1),r.hij("",e.title," ")}}function Bm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"u",23),r.NdJ("click",function(){return r.CHM(e),r.oxw(5).displayLessResults("checkbox")}),r._uU(1),r.ALo(2,"translate"),r.qZA()}2&e&&(r.xp6(1),r.hij("",r.lcZ(2,1,"igo.geo.filter.displayLessResults")," "))}function jm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"u",24),r.NdJ("click",function(){return r.CHM(e),r.oxw(5).displayMoreResults("checkbox")}),r._uU(1),r.ALo(2,"translate"),r.qZA()}2&e&&(r.xp6(1),r.hij("",r.lcZ(2,1,"igo.geo.filter.displayMoreResults")," "))}function Qm(e,t){if(1&e&&(r.TgZ(0,"p"),r.YNc(1,Bm,3,3,"u",21),r.YNc(2,jm,3,3,"u",22),r.qZA()),2&e){const e=r.oxw().$implicit,t=r.oxw(3);r.xp6(1),r.Q6J("ngIf",t.isLessResults(e,"checkbox")),r.xp6(1),r.Q6J("ngIf",t.isMoreResults(e,"checkbox"))}}function Gm(e,t){if(1&e&&(r.ynx(0),r.TgZ(1,"h4"),r._uU(2),r.qZA(),r.TgZ(3,"div",18),r.YNc(4,Jm,2,4,"mat-checkbox",19),r.qZA(),r.YNc(5,Qm,3,2,"p",2),r.BQk()),2&e){const e=t.$implicit,o=r.oxw(3);r.xp6(2),r.Oqu(e.title),r.xp6(2),r.Q6J("ngForOf",e.selectors),r.xp6(1),r.Q6J("ngIf",o.isLessResults(e,"checkbox")||o.isMoreResults(e,"checkbox"))}}function Ym(e,t){if(1&e&&(r.TgZ(0,"div",16),r._UZ(1,"mat-divider"),r.YNc(2,Nm,5,5,"div",8),r.YNc(3,Gm,6,3,"ng-container",1),r.qZA()),2&e){const e=r.oxw(2);r.xp6(2),r.Q6J("ngIf",e.getCheckboxesGroups().length>1),r.xp6(1),r.Q6J("ngForOf",e.currentCheckboxesGroup.computedSelectors)}}function zm(e,t){if(1&e&&(r.TgZ(0,"mat-option",12),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.hij("",e.title," ")}}function Hm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",9),r.TgZ(1,"mat-form-field"),r.TgZ(2,"mat-select",26),r.NdJ("valueChange",function(t){return r.CHM(e),r.oxw(3).currentRadioButtonsGroup=t}),r.ALo(3,"translate"),r.YNc(4,zm,2,2,"mat-option",11),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(3);r.xp6(2),r.Q6J("matTooltip",r.lcZ(3,3,"igo.geo.layer.legend.selectStyle"))("value",e.currentRadioButtonsGroup),r.xp6(2),r.Q6J("ngForOf",e.getRadioButtonsGroups())}}function Vm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-radio-button",29),r.NdJ("change",function(){return r.CHM(e),r.oxw(4).emptyRadioButtons()}),r.ALo(1,"translate"),r._uU(2),r.ALo(3,"translate"),r.qZA()}2&e&&(r.Q6J("matTooltip",r.lcZ(1,2,"igo.geo.filter.resetFilters")),r.xp6(2),r.hij("",r.lcZ(3,4,"igo.geo.filter.resetFilters")," "))}function Wm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-radio-button",20),r.NdJ("change",function(){const t=r.CHM(e).$implicit,o=r.oxw(3).$implicit;return r.oxw().onSelectionChange(t,o.selectorType)}),r._uU(1),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(4);r.Q6J("matTooltip",o.getToolTip(e))("checked",e.enabled)("value",e),r.xp6(1),r.hij("",e.title," ")}}function Xm(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"u",23),r.NdJ("click",function(){return r.CHM(e),r.oxw(5).displayLessResults("radio")}),r._uU(1),r.ALo(2,"translate"),r.qZA()}2&e&&(r.xp6(1),r.hij("",r.lcZ(2,1,"igo.geo.filter.displayLessResults")," "))}function Km(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"u",24),r.NdJ("click",function(){return r.CHM(e),r.oxw(5).displayMoreResults("radio")}),r._uU(1),r.ALo(2,"translate"),r.qZA()}2&e&&(r.xp6(1),r.hij("",r.lcZ(2,1,"igo.geo.filter.displayMoreResults")," "))}function ef(e,t){if(1&e&&(r.TgZ(0,"p"),r.YNc(1,Xm,3,3,"u",21),r.YNc(2,Km,3,3,"u",22),r.qZA()),2&e){const e=r.oxw().$implicit,t=r.oxw(3);r.xp6(1),r.Q6J("ngIf",t.isLessResults(e,"radio")),r.xp6(1),r.Q6J("ngIf",t.isMoreResults(e,"radio"))}}function tf(e,t){if(1&e&&(r.ynx(0),r.TgZ(1,"h4"),r._uU(2),r.qZA(),r.TgZ(3,"mat-radio-group",27),r.YNc(4,Vm,4,6,"mat-radio-button",28),r.YNc(5,Wm,2,4,"mat-radio-button",19),r.YNc(6,ef,3,2,"p",2),r.qZA(),r.BQk()),2&e){const e=t.$implicit,o=r.oxw(3);r.xp6(2),r.Oqu(e.title),r.xp6(2),r.Q6J("ngIf",e.unfiltered),r.xp6(1),r.Q6J("ngForOf",e.selectors),r.xp6(1),r.Q6J("ngIf",o.isLessResults(e,"radio")||o.isMoreResults(e,"radio"))}}function of(e,t){if(1&e&&(r.TgZ(0,"div",25),r._UZ(1,"mat-divider"),r.YNc(2,Hm,5,5,"div",8),r.YNc(3,tf,7,4,"ng-container",1),r.qZA()),2&e){const e=r.oxw(2);r.xp6(2),r.Q6J("ngIf",e.getRadioButtonsGroups().length>1),r.xp6(1),r.Q6J("ngForOf",e.currentRadioButtonsGroup.computedSelectors)}}function rf(e,t){if(1&e&&(r.TgZ(0,"mat-option",12),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.hij("",e.title," ")}}function sf(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",9),r.TgZ(1,"mat-form-field"),r.TgZ(2,"mat-select",31),r.NdJ("valueChange",function(t){return r.CHM(e),r.oxw(3).currentSelectGroup=t}),r.ALo(3,"translate"),r.YNc(4,rf,2,2,"mat-option",11),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(3);r.xp6(2),r.Q6J("matTooltip",r.lcZ(3,3,"igo.geo.layer.legend.selectStyle"))("value",e.currentSelectGroup),r.xp6(2),r.Q6J("ngForOf",e.getSelectGroups())}}function nf(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-button",35),r.NdJ("click",function(){return r.CHM(e),r.oxw(4).emptySelect()}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",36),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.filter.resetFilters"))}const af=function(){return{standalone:!0}};function lf(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-checkbox",41),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw(5).allSelected=t})("change",function(){return r.CHM(e),r.oxw(5).toggleAllSelection()}),r._uU(1,"Tous "),r.qZA()}if(2&e){const e=r.oxw(5);r.Q6J("ngModel",e.allSelected)("ngModelOptions",r.DdM(2,af))}}function cf(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-option",42),r.NdJ("onSelectionChange",function(){return r.CHM(e),r.oxw(5).optionClick()}),r._uU(1),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(5);r.Q6J("matTooltip",o.getToolTip(e))("value",e),r.xp6(1),r.hij("",e.title," ")}}function uf(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div"),r.TgZ(1,"mat-select",37,38),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw(4).enableds=t}),r.TgZ(3,"div",18),r.YNc(4,lf,2,3,"mat-checkbox",39),r.qZA(),r.YNc(5,cf,2,3,"mat-option",40),r.qZA(),r.qZA()}if(2&e){const e=r.oxw().$implicit,t=r.oxw(3);r.xp6(1),r.Q6J("multiple",e.multiple)("placeholder",e.title)("formControl",t.select)("ngModel",t.enableds),r.xp6(3),r.Q6J("ngIf",e.multiple),r.xp6(1),r.Q6J("ngForOf",e.selectors)}}function pf(e,t){if(1&e&&(r.TgZ(0,"mat-option",45),r._uU(1),r.qZA()),2&e){const e=t.$implicit,o=r.oxw(5);r.Q6J("matTooltip",o.getToolTip(e))("value",e),r.xp6(1),r.hij("",e.title," ")}}function df(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-select",43),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw(4).enabled=t}),r.YNc(1,pf,2,3,"mat-option",44),r.qZA()}if(2&e){const e=r.oxw().$implicit,t=r.oxw(3);r.Q6J("placeholder",e.title)("formControl",t.select)("ngModel",t.enabled),r.xp6(1),r.Q6J("ngForOf",e.selectors)}}function hf(e,t){if(1&e&&(r.ynx(0),r.TgZ(1,"h4"),r._uU(2),r.qZA(),r.TgZ(3,"div",9),r.YNc(4,nf,3,3,"mat-button",32),r.TgZ(5,"mat-form-field"),r.YNc(6,uf,6,6,"div",33),r.YNc(7,df,2,4,"ng-template",null,34,r.W1O),r.qZA(),r.qZA(),r.BQk()),2&e){const e=t.$implicit,o=r.MAs(8);r.xp6(2),r.Oqu(e.title),r.xp6(2),r.Q6J("ngIf",e.unfiltered&&!e.multiple),r.xp6(2),r.Q6J("ngIf",e.multiple)("ngIfElse",o)}}function gf(e,t){if(1&e&&(r.TgZ(0,"div",30),r._UZ(1,"mat-divider"),r.YNc(2,sf,5,5,"div",8),r.YNc(3,hf,9,4,"ng-container",1),r.qZA()),2&e){const e=r.oxw(2);r.xp6(2),r.Q6J("ngIf",e.getSelectGroups().length>1),r.xp6(1),r.Q6J("ngForOf",e.currentSelectGroup.computedSelectors)}}function mf(e,t){if(1&e&&(r.TgZ(0,"div"),r.YNc(1,Rm,4,2,"div",3),r.YNc(2,Ym,4,2,"div",4),r.YNc(3,of,4,2,"div",5),r.YNc(4,gf,4,2,"div",6),r.qZA()),2&e){const e=t.$implicit;r.xp6(1),r.Q6J("ngIf","pushButton"===e.selectorType),r.xp6(1),r.Q6J("ngIf","checkbox"===e.selectorType),r.xp6(1),r.Q6J("ngIf","radioButton"===e.selectorType),r.xp6(1),r.Q6J("ngIf","select"===e.selectorType)}}function ff(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div"),r._UZ(1,"mat-divider"),r.TgZ(2,"h4"),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.TgZ(5,"igo-ogc-filter-time",46),r.NdJ("datasourceChange",function(t){return r.CHM(e),r.oxw().datasource=t})("currentFilterChange",function(t){return r.CHM(e),r.oxw().currentFilter=t})("changeProperty",function(t){return r.CHM(e),r.oxw().changeProperty(t.value,t.pos)}),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(3),r.Oqu(r.lcZ(4,3,"igo.geo.filter.reportingDate")),r.xp6(2),r.Q6J("datasource",e.datasource)("currentFilter",e.currentFilter)}}let yf=(()=>{class e{constructor(e,t){this.ogcFilterService=e,this.formBuilder=t,this.checkboxesIndex=5,this.radioButtonsIndex=5,this.baseIndex=5,this.ogcFilterOperator=Bl,this.color="primary",this.allSelected=!1,this.select=new We.NI,this.enabled$=new C.X(void 0),this.enableds$=new C.X([]),this.ogcFilterWriter=new Ql,this.buildForm()}get currentFilter(){return this._currentFilter}set currentFilter(e){var t;this._currentFilter=e,(null===(t=this._currentFilter)||void 0===t?void 0:t.sliderOptions)&&(this._currentFilter.sliderOptions.enabled=!1)}get ogcFiltersSelectors(){var e,t,o,i,r,s,n,a,l,c,u,p,d,h,g,m,f,y,v,b,x,w,S,C;const T=[];return(null===(o=null===(t=null===(e=this.datasource)||void 0===e?void 0:e.options)||void 0===t?void 0:t.ogcFilters)||void 0===o?void 0:o.pushButtons)&&T.push(null===(s=null===(r=null===(i=this.datasource)||void 0===i?void 0:i.options)||void 0===r?void 0:r.ogcFilters)||void 0===s?void 0:s.pushButtons),(null===(l=null===(a=null===(n=this.datasource)||void 0===n?void 0:n.options)||void 0===a?void 0:a.ogcFilters)||void 0===l?void 0:l.checkboxes)&&T.push(null===(p=null===(u=null===(c=this.datasource)||void 0===c?void 0:c.options)||void 0===u?void 0:u.ogcFilters)||void 0===p?void 0:p.checkboxes),(null===(g=null===(h=null===(d=this.datasource)||void 0===d?void 0:d.options)||void 0===h?void 0:h.ogcFilters)||void 0===g?void 0:g.radioButtons)&&T.push(null===(y=null===(f=null===(m=this.datasource)||void 0===m?void 0:m.options)||void 0===f?void 0:f.ogcFilters)||void 0===y?void 0:y.radioButtons),(null===(x=null===(b=null===(v=this.datasource)||void 0===v?void 0:v.options)||void 0===b?void 0:b.ogcFilters)||void 0===x?void 0:x.select)&&T.push(null===(C=null===(S=null===(w=this.datasource)||void 0===w?void 0:w.options)||void 0===S?void 0:S.ogcFilters)||void 0===C?void 0:C.select),T.sort((e,t)=>e.order<t.order?-1:e.order>t.order?1:0),T}get currentPushButtonsGroup(){return this.form.get("pushButtonsGroup").value}set currentPushButtonsGroup(e){this.form.patchValue({pushButtonsGroup:e})}get currentCheckboxesGroup(){return this.form.get("checkboxesGroup").value}set currentCheckboxesGroup(e){this.form.patchValue({checkboxesGroup:e})}get currentRadioButtonsGroup(){return this.form.get("radioButtonsGroup").value}set currentRadioButtonsGroup(e){this.form.patchValue({radioButtonsGroup:e})}get currentSelectGroup(){return this.form.get("selectGroup").value}set currentSelectGroup(e){this.form.patchValue({selectGroup:e})}get enabled(){return this.enabled$.value}set enabled(e){this.enabled$.next(e),clearTimeout(this.applyFiltersTimeout),this.currentSelectGroup.computedSelectors.forEach(t=>{t.selectors.forEach(t=>{t.enabled=e===t})}),this.applyFiltersTimeout=setTimeout(()=>{this.applyFilters()},750)}get enableds(){return this.enableds$.value}set enableds(e){this.enableds$.next(e),clearTimeout(this.applyFiltersTimeout),this.currentSelectGroup.computedSelectors.forEach(t=>{t.selectors.forEach(t=>{t.enabled=!!e.includes(t)})}),this.applyFiltersTimeout=setTimeout(()=>{this.applyFilters()},750)}buildForm(){this.form=this.formBuilder.group({pushButtons:["",[We.kI.required]],radioButtons:["",[We.kI.required]],pushButtonsGroup:["",[We.kI.required]],checkboxesGroup:["",[We.kI.required]],radioButtonsGroup:["",[We.kI.required]],selectGroup:["",[We.kI.required]]})}getPushButtonsGroups(){var e,t,o;if(null===(o=null===(t=null===(e=this.datasource)||void 0===e?void 0:e.options)||void 0===t?void 0:t.ogcFilters)||void 0===o?void 0:o.pushButtons)return this.datasource.options.ogcFilters.pushButtons.groups}getCheckboxesGroups(){var e,t,o;if(null===(o=null===(t=null===(e=this.datasource)||void 0===e?void 0:e.options)||void 0===t?void 0:t.ogcFilters)||void 0===o?void 0:o.checkboxes)return this.datasource.options.ogcFilters.checkboxes.groups}getRadioButtonsGroups(){var e,t,o;if(null===(o=null===(t=null===(e=this.datasource)||void 0===e?void 0:e.options)||void 0===t?void 0:t.ogcFilters)||void 0===o?void 0:o.radioButtons)return this.datasource.options.ogcFilters.radioButtons.groups}getSelectGroups(){var e,t,o;if(null===(o=null===(t=null===(e=this.datasource)||void 0===e?void 0:e.options)||void 0===t?void 0:t.ogcFilters)||void 0===o?void 0:o.select)return this.datasource.options.ogcFilters.select.groups}ngOnInit(){this.datasource.options.ogcFilters&&(this.datasource.options.ogcFilters.pushButtons&&(this.currentPushButtonsGroup=this.datasource.options.ogcFilters.pushButtons.groups.find(e=>e.enabled)||this.datasource.options.ogcFilters.pushButtons.groups[0]),this.datasource.options.ogcFilters.checkboxes&&(this.currentCheckboxesGroup=this.datasource.options.ogcFilters.checkboxes.groups.find(e=>e.enabled)||this.datasource.options.ogcFilters.checkboxes.groups[0]),this.datasource.options.ogcFilters.radioButtons&&(this.currentRadioButtonsGroup=this.datasource.options.ogcFilters.radioButtons.groups.find(e=>e.enabled)||this.datasource.options.ogcFilters.radioButtons.groups[0]),this.datasource.options.ogcFilters.select&&(this.currentSelectGroup=this.datasource.options.ogcFilters.select.groups.find(e=>e.enabled)||this.datasource.options.ogcFilters.select.groups[0],this.getSelectEnabled()),this.applyFilters()),this.form.get("pushButtonsGroup").valueChanges.pipe((0,w.b)(750)).subscribe(()=>{this.onPushButtonsChangeGroup(),this.applyFilters()}),this.form.get("checkboxesGroup").valueChanges.pipe((0,w.b)(750)).subscribe(()=>{this.onCheckboxesChangeGroup(),this.applyFilters()}),this.form.get("radioButtonsGroup").valueChanges.pipe((0,w.b)(750)).subscribe(()=>{this.onRadioButtonsChangeGroup(),this.applyFilters()}),this.form.get("selectGroup").valueChanges.pipe((0,w.b)(750)).subscribe(()=>{this.onSelectChangeGroup(),this.applyFilters()}),this.form.get("pushButtons").valueChanges.pipe((0,w.b)(750)).subscribe(()=>{this.applyFilters()}),this.form.get("radioButtons").valueChanges.pipe((0,w.b)(750)).subscribe(()=>{this.applyFilters()})}getSelectEnabled(){const e=[];let t;this.currentSelectGroup.computedSelectors.forEach(o=>{o.multiple?(o.selectors.forEach(t=>{t.enabled&&e.push(t)}),this.enableds=e):(o.selectors.forEach(e=>{e.enabled&&(t=e)}),this.enabled=t)})}getToolTip(e){let t;return e.tooltip&&(t=Array.isArray(e.tooltip)?e.tooltip.join("\n"):e.tooltip),t||""}getButtonColor(e){let t;return e.color&&e.enabled&&(t={"background-color":`rgba(${e.color})`}),t}bundleIsVertical(e){return!!e.vertical&&e.vertical}onPushButtonsChangeGroup(){this.getPushButtonsGroups().map(e=>e.enabled=!1),this.getPushButtonsGroups().find(e=>e===this.currentPushButtonsGroup).enabled=!0}onCheckboxesChangeGroup(){this.getCheckboxesGroups().map(e=>e.enabled=!1),this.getCheckboxesGroups().find(e=>e===this.currentCheckboxesGroup).enabled=!0}onRadioButtonsChangeGroup(){this.getRadioButtonsGroups().map(e=>e.enabled=!1),this.getRadioButtonsGroups().find(e=>e===this.currentRadioButtonsGroup).enabled=!0}onSelectChangeGroup(){this.getSelectGroups().map(e=>e.enabled=!1),this.getSelectGroups().find(e=>e===this.currentSelectGroup).enabled=!0}onSelectionChange(e,t){clearTimeout(this.applyFiltersTimeout),"radioButton"===t&&this.emptyRadioButtons(),e&&(e.enabled=!e.enabled),this.applyFiltersTimeout=setTimeout(()=>{this.applyFilters()},750)}emptyRadioButtons(){this.currentRadioButtonsGroup.computedSelectors.forEach(e=>{e.selectors.map(e=>e.enabled=!1),this.applyFiltersTimeout=setTimeout(()=>{this.applyFilters()},750)})}emptySelect(){this.enabled=[]}toggleAllSelection(){this.sel.options.forEach(this.allSelected?e=>e.select():e=>e.deselect())}optionClick(){let e=!0;this.sel.options.forEach(t=>{t.selected||(e=!1)}),this.allSelected=e}applyFilters(){let e="";const t=[],o=[this.currentPushButtonsGroup,this.currentCheckboxesGroup,this.currentRadioButtonsGroup,this.currentSelectGroup];for(const i of o)i.computedSelectors&&i.computedSelectors.map(e=>{const o=[];e.selectors.filter(e=>!0===e.enabled).forEach(e=>o.push(e.filters)),o.length>=1&&t.push(1===o.length?o[0]:{logical:e.logical,filters:o})});this.isTemporalOperator()&&t.push(this.datasource.options.ogcFilters.interfaceOgcFilters[0]),t.length>=1&&(e=this.ogcFilterWriter.buildFilter(1===t.length?t[0]:{logical:"And",filters:t})),"wms"===this.datasource.options.type&&this.ogcFilterService.filterByOgc(this.datasource,e),"wfs"===this.datasource.options.type&&this.datasource.ol.refresh(),this.datasource.setOgcFilters(this.datasource.options.ogcFilters,!0)}isMoreResults(e,t){let o=0;for(const i of e.selectors)o++;return o>("radio"===t?this.radioButtonsIndex:this.checkboxesIndex)}displayMoreResults(e){"radio"===e?this.radioButtonsIndex+=5:this.checkboxesIndex+=5}isLessResults(e,t){let o=0;for(const i of e.selectors)o++;return this.baseIndex!==("radio"===t?this.radioButtonsIndex:this.checkboxesIndex)&&o>this.baseIndex}displayLessResults(e){"radio"===e?this.radioButtonsIndex=this.baseIndex:this.checkboxesIndex=this.baseIndex}isTemporalOperator(){var e,t;return(null===(t=null===(e=this.currentFilter)||void 0===e?void 0:e.operator)||void 0===t?void 0:t.toLowerCase())===this.ogcFilterOperator.During.toLowerCase()}changeProperty(e,t,o=!0){const i=this.detectProperty(t);i&&(this.datasource.options.ogcFilters.interfaceOgcFilters.find(e=>e.filterid===this.currentFilter.filterid)[i]=e,o&&this.applyFilters())}detectProperty(e){switch(this.currentFilter.operator){case Bl.PropertyIsNotEqualTo:case Bl.PropertyIsEqualTo:case Bl.PropertyIsGreaterThan:case Bl.PropertyIsGreaterThanOrEqualTo:case Bl.PropertyIsLessThan:case Bl.PropertyIsLessThanOrEqualTo:return"expression";case Bl.PropertyIsLike:return"pattern";case Bl.PropertyIsBetween:return e&&1===e?"lowerBoundary":e&&2===e?"upperBoundary":void 0;case Bl.During:return e&&1===e?"begin":e&&2===e?"end":void 0;default:return}}}return e.\u0275fac=function(t){return new(t||e)(r.Y36($d),r.Y36(We.qu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-ogc-filter-selection"]],viewQuery:function(e,t){if(1&e&&r.Gf(_m,5),2&e){let e;r.iGM(e=r.CRH())&&(t.sel=e.first)}},inputs:{refreshFilters:"refreshFilters",datasource:"datasource",map:"map",checkboxesIndex:"checkboxesIndex",radioButtonsIndex:"radioButtonsIndex",baseIndex:"baseIndex",currentFilter:"currentFilter"},decls:3,vars:3,consts:[[3,"formGroup"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","pushButtonGroups",4,"ngIf"],["class","checkboxGroups",4,"ngIf"],["class","radioButtonGroups",4,"ngIf"],["class","selectGroups",4,"ngIf"],[1,"pushButtonGroups"],["class","groupsSelector",4,"ngIf"],[1,"groupsSelector"],["formControlName","pushButtonsGroup","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","value","valueChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["formControlName","pushButtons","appearance","legacy","multiple","true",1,"mat-typography",3,"vertical"],["tooltip-position","below","matTooltipShowDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","ngStyle","checked","value","change",4,"ngFor","ngForOf"],["tooltip-position","below","matTooltipShowDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","ngStyle","checked","value","change"],[1,"checkboxGroups"],["formControlName","checkboxesGroup","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","value","valueChange"],[1,"checkboxes","mat-typography"],["tooltip-position","below","matTooltipShowDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","checked","value","change",4,"ngFor","ngForOf"],["tooltip-position","below","matTooltipShowDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","checked","value","change"],["class","lessResults mat-typography",3,"click",4,"ngIf"],["class","moreResults mat-typography",3,"click",4,"ngIf"],[1,"lessResults","mat-typography",3,"click"],[1,"moreResults","mat-typography",3,"click"],[1,"radioButtonGroups"],["formControlName","radioButtonsGroup","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","value","valueChange"],["formControlName","radioButtons",1,"mat-typography"],["tooltip-position","below","matTooltipShowDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","change",4,"ngIf"],["tooltip-position","below","matTooltipShowDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","change"],[1,"selectGroups"],["formControlName","selectGroup","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","value","valueChange"],["mat-icon-button","","color","warn","tooltip-position","below","matTooltipShowDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","click",4,"ngIf"],[4,"ngIf","ngIfElse"],["notMulti",""],["mat-icon-button","","color","warn","tooltip-position","below","matTooltipShowDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","click"],["svgIcon","filter-remove"],[3,"multiple","placeholder","formControl","ngModel","ngModelChange"],["selection",""],[3,"ngModel","ngModelOptions","ngModelChange","change",4,"ngIf"],["tooltip-position","below","matTooltipDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","value","onSelectionChange",4,"ngFor","ngForOf"],[3,"ngModel","ngModelOptions","ngModelChange","change"],["tooltip-position","below","matTooltipDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","value","onSelectionChange"],[3,"placeholder","formControl","ngModel","ngModelChange"],["tooltip-position","below","matTooltipDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","value",4,"ngFor","ngForOf"],["tooltip-position","below","matTooltipDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","value"],[3,"datasource","currentFilter","datasourceChange","currentFilterChange","changeProperty"]],template:function(e,t){1&e&&(r.TgZ(0,"form",0),r.YNc(1,mf,5,4,"div",1),r.qZA(),r.YNc(2,ff,6,5,"div",2)),2&e&&(r.Q6J("formGroup",t.form),r.xp6(1),r.Q6J("ngForOf",t.ogcFiltersSelectors),r.xp6(1),r.Q6J("ngIf",t.isTemporalOperator()))},styles:[".mat-button-toggle-group[_ngcontent-%COMP%]{margin:5px;flex-wrap:wrap;box-shadow:none}.checkboxes[_ngcontent-%COMP%]{flex-wrap:wrap;box-shadow:none}.groupsSelector[_ngcontent-%COMP%]{text-align:center}mat-button-toggle[_ngcontent-%COMP%]{display:inline-flex;border:1.5px solid black;border-radius:5px;margin:5px;white-space:normal;min-height:40px;height:auto;width:150px}mat-button-toggle[_ngcontent-%COMP%]     .mat-button-toggle-label-content{line-height:unset;font-size:small;display:block}  .material-tooltip{white-space:pre-wrap}mat-checkbox[_ngcontent-%COMP%], mat-radio-button[_ngcontent-%COMP%]{margin:7px;width:95%;display:inline-flex;font-size:larger}mat-checkbox[_ngcontent-%COMP%]     label, mat-radio-button[_ngcontent-%COMP%]     label{white-space:normal}mat-checkbox[_ngcontent-%COMP%]{vertical-align:middle}mat-button[_ngcontent-%COMP%]{padding-right:10px}h4[_ngcontent-%COMP%]{margin:7px;text-align:left}u[_ngcontent-%COMP%]{cursor:pointer;color:#00f;margin:5px}p[_ngcontent-%COMP%]{margin:unset}igo-ogc-filter-time[_ngcontent-%COMP%]     .datetime-input{width:140px;margin:10px 0 5px 10px}"]}),e})();function vf(e,t){if(1&e&&(r.TgZ(0,"mat-option",10),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.terrapi."+e)," ")}}let bf=(()=>{class e{constructor(){this.queryType=["Arrond","CircFed","CircProv","DirReg","Mun","MRC","AdmRegion","RegTour"],this.selectedTypeIndex=new We.NI(0),this.spatialType=qd,this.activeDrawType=this.spatialType.Polygon,this.layers=[],this.eventType=new r.vpe,this.eventQueryType=new r.vpe,this.zoneChange=new r.vpe,this.zoneWithBufferChange=new r.vpe,this.bufferChange=new r.vpe,this.measureUnitChange=new r.vpe}get store(){return this._store}set store(e){this._store=e}ngOnInit(){0===this.selectedTypeIndex.value&&(this.type=this.spatialType.Predefined),1===this.selectedTypeIndex.value&&(this.type=this.activeDrawType),this.eventType.emit(this.type)}onTypeChange(e){0===this.selectedTypeIndex.value&&(this.type=qd.Predefined),1===this.selectedTypeIndex.value&&(this.type=this.activeDrawType),this.eventType.emit(this.type)}onDrawTypeChange(e){this.activeDrawType=e,this.eventType.emit(this.activeDrawType)}onSelectionChange(){this.eventQueryType.emit(this.selectedQueryType),this.zoneChange.emit(void 0)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-spatial-filter-type"]],inputs:{store:"store",selectedQueryType:"selectedQueryType",zone:"zone",layers:"layers"},outputs:{eventType:"eventType",eventQueryType:"eventQueryType",zoneChange:"zoneChange",zoneWithBufferChange:"zoneWithBufferChange",bufferChange:"bufferChange",measureUnitChange:"measureUnitChange"},decls:20,vars:25,consts:[[3,"selectedIndex","selectedIndexChange","selectedTabChange"],[3,"label"],[3,"value","selectionChange","valueChange"],[3,"value",4,"ngFor","ngForOf"],[3,"store","queryType","zone","layers","zoneChange","zoneWithBufferChange","bufferChange","measureUnitChange"],[1,"spatial-type-toggle"],[3,"value","change"],[3,"value","matTooltip"],["svgIcon","pentagon-outline"],["svgIcon","record-circle-outline"],[3,"value"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-tab-group",0),r.NdJ("selectedIndexChange",function(e){return t.selectedTypeIndex.setValue(e)})("selectedTabChange",function(e){return t.onTypeChange(e)}),r.TgZ(1,"mat-tab",1),r.ALo(2,"translate"),r.TgZ(3,"mat-form-field"),r.TgZ(4,"mat-label"),r._uU(5),r.ALo(6,"translate"),r.qZA(),r.TgZ(7,"mat-select",2),r.NdJ("selectionChange",function(){return t.onSelectionChange()})("valueChange",function(e){return t.selectedQueryType=e}),r.YNc(8,vf,3,4,"mat-option",3),r.qZA(),r.qZA(),r.TgZ(9,"igo-spatial-filter-list",4),r.NdJ("zoneChange",function(e){return t.zoneChange.emit(e)})("zoneWithBufferChange",function(e){return t.zoneWithBufferChange.emit(e)})("bufferChange",function(e){return t.bufferChange.emit(e)})("measureUnitChange",function(e){return t.measureUnitChange.emit(e)}),r.qZA(),r.qZA(),r.TgZ(10,"mat-tab",1),r.ALo(11,"translate"),r.TgZ(12,"div",5),r.TgZ(13,"mat-button-toggle-group",6),r.NdJ("change",function(e){return t.onDrawTypeChange(e.value)}),r.TgZ(14,"mat-button-toggle",7),r.ALo(15,"translate"),r._UZ(16,"mat-icon",8),r.qZA(),r.TgZ(17,"mat-button-toggle",7),r.ALo(18,"translate"),r._UZ(19,"mat-icon",9),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.Q6J("selectedIndex",t.selectedTypeIndex.value),r.xp6(1),r.Q6J("label",r.lcZ(2,15,"igo.geo.spatialFilter.predefined")),r.xp6(4),r.Oqu(r.lcZ(6,17,"igo.geo.spatialFilter.searchLabel")),r.xp6(2),r.Q6J("value",t.selectedQueryType),r.xp6(1),r.Q6J("ngForOf",t.queryType),r.xp6(1),r.Q6J("store",t.store)("queryType",t.selectedQueryType)("zone",t.zone)("layers",t.layers),r.xp6(1),r.Q6J("label",r.lcZ(11,19,"igo.geo.spatialFilter.draw")),r.xp6(3),r.Q6J("value",t.activeDrawType),r.xp6(1),r.Q6J("value",t.spatialType.Polygon)("matTooltip",r.lcZ(15,21,"igo.geo.spatialFilter.drawPolygon")),r.xp6(3),r.Q6J("value",t.spatialType.Point)("matTooltip",r.lcZ(18,23,"igo.geo.spatialFilter.drawCircle")))},styles:[".mat-form-field[_ngcontent-%COMP%]{padding:5px;width:95%;margin-left:2px}.mat-tab-group[_ngcontent-%COMP%]     .mat-tab-body-content{overflow:hidden}.mat-tab-group[_ngcontent-%COMP%]     .mat-tab-label{padding:10px}.mat-tab-group[_ngcontent-%COMP%]     .mat-tab-body-wrapper{margin-top:5px}.spatial-type-toggle[_ngcontent-%COMP%]{padding:10px;text-align:center}.spatial-type-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]{width:50%}.spatial-type-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]{width:50%}"],changeDetection:0}),e})();function xf(e,t){if(1&e&&(r.TgZ(0,"mat-option",13),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.hij(" ",e.properties.nom," ")}}function wf(e,t){if(1&e&&(r.TgZ(0,"mat-option",13),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.measure."+e)," ")}}let Sf=(()=>{class e{constructor(e,t,o){this.spatialFilterService=e,this.messageService=t,this.languageService=o,this.layers=[],this.measureUnit=ch.Meters,this.formControl=new We.NI,this.bufferFormControl=new We.NI,this.zoneChange=new r.vpe,this.zoneWithBufferChange=new r.vpe,this.bufferChange=new r.vpe,this.measureUnitChange=new r.vpe}get store(){return this._store}set store(e){this._store=e}get queryType(){return this._queryType}set queryType(e){this.formControl.setValue(""),this._queryType=e}get zone(){return this._zone}set zone(e){this._zone=e,e||(this.zoneWithBuffer=void 0,this.bufferFormControl.setValue(0))}get measureUnits(){return[ch.Meters,ch.Kilometers]}ngOnInit(){this.formValueChanges$$=this.formControl.valueChanges.subscribe(e=>{e.length&&this.store.view.filter(t=>{const o=e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return t.properties.nom.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(o)})}),this.bufferValueChanges$$=this.bufferFormControl.valueChanges.pipe((0,w.b)(500),(0,M.x)()).subscribe(e=>{this.measureUnit===ch.Meters&&e>0&&e<=1e5?(this.bufferChange.emit(e),this.spatialFilterService.loadBufferGeometry(this.selectedZone,qd.Predefined,e,this.queryType).subscribe(e=>{this.zoneWithBuffer=e,this.zoneWithBufferChange.emit(this.zoneWithBuffer)})):this.measureUnit===ch.Kilometers&&e>0&&e<=100?(this.bufferChange.emit(e),this.spatialFilterService.loadBufferGeometry(this.selectedZone,qd.Predefined,1e3*e,this.queryType).subscribe(e=>{this.zoneWithBuffer=e,this.zoneWithBufferChange.emit(this.zoneWithBuffer)})):0===e&&this.layers.length>0?(this.bufferChange.emit(e),this.zoneWithBufferChange.emit(this.selectedZone)):(e<0||this.measureUnit===ch.Meters&&e>1e5||this.measureUnit===ch.Kilometers&&e>100)&&(this.bufferFormControl.setValue(0),this.messageService.alert(this.languageService.translate.instant("igo.geo.spatialFilter.bufferAlert"),this.languageService.translate.instant("igo.geo.spatialFilter.warning")))})}ngOnDestroy(){this.formValueChanges$$.unsubscribe()}displayFn(e){return e?e.properties.nom:void 0}onZoneChange(e){e&&this.queryType&&this.spatialFilterService.loadItemById(e,this.queryType).subscribe(e=>{this.selectedZone=e,this.zoneChange.emit(e)})}onMeasureUnitChange(e){e!==this.measureUnit&&(this.measureUnit=e,this.measureUnitChange.emit(this.measureUnit),this.bufferFormControl.setValue(this.measureUnit===ch.Meters?1e3*this.bufferFormControl.value:this.bufferFormControl.value/1e3))}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Ed),r.Y36(de),r.Y36(ue))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-spatial-filter-list"]],inputs:{store:"store",queryType:"queryType",zone:"zone",layers:"layers"},outputs:{zoneChange:"zoneChange",zoneWithBufferChange:"zoneWithBufferChange",bufferChange:"bufferChange",measureUnitChange:"measureUnitChange"},decls:18,vars:17,consts:[[1,"form-list"],[1,"zone-list"],["type","text","matInput","",3,"placeholder","formControl","matAutocomplete"],["input",""],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[1,"buffer-div"],[1,"buffer-form"],[1,"buffer"],["type","number","matInput","",3,"placeholder","formControl","value","readonly"],[1,"unit-field"],[3,"value","selectionChange"],[3,"value"]],template:function(e,t){if(1&e&&(r.TgZ(0,"form",0),r.TgZ(1,"mat-form-field",1),r._UZ(2,"input",2,3),r.ALo(4,"translate"),r.TgZ(5,"mat-autocomplete",4,5),r.NdJ("optionSelected",function(e){return t.onZoneChange(e.option.value)}),r.YNc(7,xf,2,2,"mat-option",6),r.ALo(8,"async"),r.qZA(),r.qZA(),r.TgZ(9,"form"),r.TgZ(10,"div",7),r.TgZ(11,"form",8),r.TgZ(12,"mat-form-field",9),r._UZ(13,"input",10),r.ALo(14,"translate"),r.qZA(),r.qZA(),r.TgZ(15,"mat-form-field",11),r.TgZ(16,"mat-select",12),r.NdJ("selectionChange",function(e){return t.onMeasureUnitChange(e.value)}),r.YNc(17,wf,3,4,"mat-option",6),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.MAs(6);r.xp6(2),r.s9C("placeholder",r.lcZ(4,11,"igo.geo.spatialFilter.listLabel")),r.Q6J("formControl",t.formControl)("matAutocomplete",e),r.xp6(3),r.Q6J("displayWith",t.displayFn),r.xp6(2),r.Q6J("ngForOf",r.lcZ(8,13,t.store.view.all$())),r.xp6(6),r.s9C("placeholder",r.lcZ(14,15,"igo.geo.spatialFilter.buffer")),r.Q6J("formControl",t.bufferFormControl)("value",0)("readonly",!t.zone),r.xp6(3),r.Q6J("value",t.measureUnit),r.xp6(1),r.Q6J("ngForOf",t.measureUnits)}},directives:[We._Y,We.JL,We.F,De.KE,Ve.Nt,We.Fj,Xa.ZL,We.JJ,We.oH,Xa.XC,h.sg,We.wV,Ee.gD,Re.ey],pipes:[j.X$,h.Ov],styles:[".buffer-div[_ngcontent-%COMP%]{display:flex;width:100%;margin-left:2px;padding:5px}.zone-list[_ngcontent-%COMP%]{padding:5px;width:95%;margin-left:2px}.buffer[_ngcontent-%COMP%]{display:flex;flex-flow:column nowrap;width:110%}.unit-field[_ngcontent-%COMP%]{width:110px;margin-left:30px}"],changeDetection:0}),e})();function Cf(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-slide-toggle",15),r.NdJ("change",function(){return r.CHM(e),r.oxw().onDrawControlChange()}),r._uU(1),r.ALo(2,"translate"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("checked",e.drawControlIsActive)("labelPosition","before"),r.xp6(1),r.hij(" ",r.lcZ(2,3,"igo.geo.spatialFilter.drawControl")," ")}}function Tf(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-slide-toggle",15),r.NdJ("change",function(){return r.CHM(e),r.oxw().onfreehandControlChange()}),r._uU(1),r.ALo(2,"translate"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("checked",e.freehandDrawIsActive)("labelPosition","before"),r.xp6(1),r.hij(" ",r.lcZ(2,3,"igo.geo.spatialFilter.freehandControl")," ")}}function Af(e,t){if(1&e&&(r.TgZ(0,"mat-option",6),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.measure."+e)," ")}}function Lf(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",16),r.TgZ(1,"form",17),r.TgZ(2,"mat-form-field",18),r._UZ(3,"input",19),r.ALo(4,"translate"),r.qZA(),r.qZA(),r.TgZ(5,"mat-form-field",20),r.TgZ(6,"mat-select",21),r.NdJ("selectionChange",function(t){return r.CHM(e),r.oxw().onMeasureUnitChange(t.value)}),r.YNc(7,Af,3,4,"mat-option",22),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(3),r.s9C("placeholder",r.lcZ(4,6,"igo.geo.spatialFilter.buffer")),r.Q6J("formControl",e.bufferFormControl)("value",0)("readonly",null===e.formControl.value),r.xp6(3),r.Q6J("value",e.measureUnit),r.xp6(1),r.Q6J("ngForOf",e.measureUnits)}}function Zf(e,t){if(1&e&&(r.TgZ(0,"mat-option",6),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.measure."+e)," ")}}function Ff(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",23),r.TgZ(1,"form",24),r.TgZ(2,"mat-form-field",25),r.TgZ(3,"input",26),r.NdJ("input",function(){return r.CHM(e),r.oxw().getRadius()}),r.ALo(4,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(5,"mat-form-field",20),r.TgZ(6,"mat-select",21),r.NdJ("selectionChange",function(t){return r.CHM(e),r.oxw().onMeasureUnitChange(t.value)}),r.YNc(7,Zf,3,4,"mat-option",22),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(3),r.s9C("placeholder",r.lcZ(4,6,"igo.geo.spatialFilter.radius")),r.Q6J("formControl",e.radiusFormControl)("value",1e3)("readonly",e.freehandDrawIsActive&&null===e.formControl.value),r.xp6(3),r.Q6J("value",e.measureUnit),r.xp6(1),r.Q6J("ngForOf",e.measureUnits)}}function Of(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-radio-button",27),r.NdJ("change",function(t){return r.CHM(e),r.oxw().onItemTypeChange(t)}),r._uU(1),r.ALo(2,"translate"),r.qZA()}if(2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.spatialFilter."+e)," ")}}function Mf(e,t){1&e&&(r.TgZ(0,"mat-header-cell",38),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"igo.geo.spatialFilter.Thematics")))}function If(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-header-cell",39),r.TgZ(1,"mat-checkbox",40),r.NdJ("change",function(t){r.CHM(e);const o=r.oxw(2);return t?o.masterToggle():null}),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(2);r.xp6(1),r.Q6J("checked",e.isAllSelected())("indeterminate",e.selectedThematics.hasValue()&&!e.isAllSelected())}}function kf(e,t){1&e&&r._UZ(0,"mat-header-row")}function Pf(e,t){1&e&&r._UZ(0,"mat-row")}function _f(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-tree-node",41),r.TgZ(1,"li",42),r._UZ(2,"button",43),r._uU(3),r.TgZ(4,"mat-checkbox",44),r.NdJ("click",function(e){return e.stopPropagation()})("change",function(t){const o=r.CHM(e).$implicit,i=r.oxw(2);return t?i.onToggleChange(o):null}),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(2);r.xp6(3),r.hij(" ",e.name," "),r.xp6(1),r.Q6J("checked",o.selectedThematics.isSelected(e))}}function $f(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-nested-tree-node"),r.TgZ(1,"div",42),r.TgZ(2,"button",45),r.NdJ("click",function(){const t=r.CHM(e).$implicit;return r.oxw(2).onToggleClick(t)}),r._UZ(3,"mat-icon",46),r.qZA(),r._uU(4),r.TgZ(5,"mat-checkbox",47),r.NdJ("change",function(t){const o=r.CHM(e).$implicit,i=r.oxw(2);return t?i.childrensToggle(o):null}),r.qZA(),r.qZA(),r.TgZ(6,"ul",48),r.GkF(7,49),r.qZA(),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(2);r.xp6(3),r.Q6J("svgIcon",o.treeControl.isExpanded(e)?"chevron-down":"chevron-right"),r.xp6(1),r.hij(" ",e.name," "),r.xp6(1),r.Q6J("checked",o.isAllSelected(e))("indeterminate",o.hasChildrenSelected(e)&&!o.isAllSelected(e)),r.xp6(1),r.ekj("example-tree-invisible",!o.treeControl.isExpanded(e))}}function qf(e,t){if(1&e&&(r.TgZ(0,"div",28),r.TgZ(1,"mat-table"),r.ynx(2,29),r.YNc(3,Mf,3,3,"mat-header-cell",30),r.BQk(),r.ynx(4,31),r.YNc(5,If,2,2,"mat-header-cell",32),r.BQk(),r.YNc(6,kf,1,0,"mat-header-row",33),r.YNc(7,Pf,1,0,"mat-row",34),r.qZA(),r.TgZ(8,"mat-tree",35),r.YNc(9,_f,5,2,"mat-tree-node",36),r.YNc(10,$f,8,6,"mat-nested-tree-node",37),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(6),r.Q6J("matHeaderRowDef",e.displayedColumns),r.xp6(1),r.Q6J("matRowDefColumns",e.displayedColumns),r.xp6(1),r.Q6J("dataSource",e.dataSource)("treeControl",e.treeControl),r.xp6(2),r.Q6J("matTreeNodeDefWhen",e.hasChild)}}function Df(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",50),r.NdJ("click",function(){return r.CHM(e),r.oxw().clearSearch()}),r._uU(1),r.ALo(2,"translate"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("disabled",e.disabledClearSearch()),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.spatialFilter.clearSearch")," ")}}function Ef(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",51),r.NdJ("click",function(){return r.CHM(e),r.oxw().clearDrawZone()}),r._uU(1),r.ALo(2,"translate"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("disabled",null===e.formControl.value),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.spatialFilter.clearForm")," ")}}let Rf=(()=>{class e{constructor(e,t,o,i){this.cdRef=e,this.spatialFilterService=t,this.messageService=o,this.languageService=i,this.layers=[],this.allLayers=[],this.toggleSearch=new r.vpe,this.itemTypeChange=new r.vpe,this.thematicChange=new r.vpe,this.drawZoneEvent=new r.vpe,this.bufferEvent=new r.vpe,this.zoneWithBufferChange=new r.vpe,this.measureUnitChange=new r.vpe,this.radiusEvent=new r.vpe,this.freehandControl=new r.vpe,this.clearButtonEvent=new r.vpe,this.clearSearchEvent=new r.vpe,this.export=new r.vpe,this.openWorkspace=new r.vpe,this.itemType=[Dd.Address,Dd.Thematics],this.selectedItemType=Dd.Address,this.treeControl=new hl.VY(e=>e.children),this.displayedColumns=["name","select"],this.childrens=[],this.groups=[],this.thematics=[],this.dataSource=new ul.WX,this.selectedThematics=new tt.Ov(!0,[]),this.value$=new C.X(void 0),this.drawGuide$=new C.X(null),this.overlayStyle$=new C.X(void 0),this.drawStyle$=new C.X(void 0),this.formControl=new We.NI,this.geometryTypeField=!1,this.geometryTypes=["Point","Polygon"],this.drawGuideField=!1,this.drawGuide=null,this.drawGuidePlaceholder="",this.measure=!1,this.drawControlIsActive=!0,this.freehandDrawIsActive=!1,this.buffer=0,this.radiusFormControl=new We.NI,this.bufferFormControl=new We.NI,this.measureUnit=ch.Meters}get type(){return this._type}set type(e){this._type=e;const t=this.geometryTypes.findIndex(e=>e===this.type);if(this.geometryType=this.geometryTypes[t],this.formControl.reset(),this.radius=void 0,this.drawGuide$.next(null),this.drawStyle$.next(void 0),this.type===qd.Predefined&&this.formControl.setValue({type:"Point",coordinates:""}),this.type===qd.Point)this.radius=1e3,this.radiusFormControl.setValue(this.radius),this.PointStyle=(e,t)=>{const o=e.getGeometry(),i=kn.vs(o.getCoordinates(),this.map.projection,"EPSG:4326");return new Un.ZP({image:new Qn.Z({radius:this.radius/Math.cos(Math.PI/180*i[1])/t,stroke:new jn.Z({width:2,color:"rgba(0, 153, 255)"}),fill:new Jn.Z({color:"rgba(0, 153, 255, 0.2)"})})})},this.overlayStyle=this.PointStyle,this.drawStyle$.next(this.overlayStyle);else{this.radius=void 0,this.PolyStyle=()=>new Un.ZP({stroke:new jn.Z({width:2,color:"rgba(0, 153, 255)"}),fill:new Jn.Z({color:"rgba(0, 153, 255, 0.2)"})});const e=[0,153,255],t=()=>new Un.ZP({image:new Qn.Z({radius:8,stroke:new jn.Z({width:2,color:"rgba(0, 153, 255)"}),fill:new Jn.Z({color:"rgba(0, 153, 255, 0.2)"})}),stroke:new jn.Z({color:e.concat([1]),width:2}),fill:new Jn.Z({color:e.concat([.2])})});this.overlayStyle=this.PolyStyle,this.drawStyle$.next(t)}this.overlayStyle$.next(this.overlayStyle)}get store(){return this._store}set store(e){this._store=e,this._store.entities$.subscribe(()=>{this.cdRef.detectChanges()})}get measureUnits(){return[ch.Meters,ch.Kilometers]}get thematicLength(){return this._thematicLength}set thematicLength(e){this._thematicLength=e}ngOnInit(){this.spatialFilterService.loadThematicsList().subscribe(e=>{for(const o of e)this.childrens.push(o),this.childrens.sort((e,t)=>e.name.localeCompare(t.name));this.groups.push(this.languageService.translate.instant("igo.geo.terrapi.limites"));const t={name:this.groups[0],children:[]};this.thematics.push(t),this.childrens.forEach(e=>{e.group&&-1===this.groups.indexOf(e.group)&&(this.groups.push(e.group),this.thematics.push({name:e.group,children:[]})),e.group||(e.name===this.languageService.translate.instant("igo.geo.terrapi.AdmRegion")||e.name===this.languageService.translate.instant("igo.geo.terrapi.Mun")||e.name===this.languageService.translate.instant("igo.geo.terrapi.Arrond")||e.name===this.languageService.translate.instant("igo.geo.terrapi.CircFed")||e.name===this.languageService.translate.instant("igo.geo.terrapi.CircProv")||e.name===this.languageService.translate.instant("igo.geo.terrapi.DirReg")||e.name===this.languageService.translate.instant("igo.geo.terrapi.MRC")||e.name===this.languageService.translate.instant("igo.geo.terrapi.RegTour")?e.group=t.name:e.name===this.languageService.translate.instant("igo.geo.terrapi.routes")?e.group=this.languageService.translate.instant("igo.geo.spatialFilter.group.transport"):this.thematics.push({name:e.name,children:[],source:e.source})),this.thematics.sort((e,t)=>e.name.localeCompare(t.name))}),this.thematics.forEach(e=>{for(const t of this.childrens)t.group===e.name&&e.children.push(t)})}),this.dataSource.data=this.thematics,this.drawGuide$.next(null),this.value$.next(this.formControl.value?this.formControl.value:void 0),this.value$$=this.formControl.valueChanges.subscribe(e=>{e?(this.value$.next(e),this.drawZone=this.formControl.value,0!==this.buffer&&(this.drawZoneEvent.emit(this.drawZone),this.bufferFormControl.setValue(this.buffer))):(this.value$.next(void 0),this.drawZone=void 0)}),this.value$.subscribe(()=>{this.getRadius(),this.cdRef.detectChanges()}),this.radiusChanges$$=this.radiusFormControl.valueChanges.subscribe(()=>{this.getRadius(),this.cdRef.detectChanges()}),this.bufferChanges$$=this.bufferFormControl.valueChanges.pipe((0,w.b)(500)).subscribe(e=>{this.measureUnit===ch.Meters&&e>0&&e<=1e5?(this.buffer=e,this.bufferEvent.emit(e),this.spatialFilterService.loadBufferGeometry(this.drawZone,qd.Polygon,e).subscribe(e=>{this.zoneWithBuffer=e,this.zoneWithBufferChange.emit(this.zoneWithBuffer)})):this.measureUnit===ch.Kilometers&&e>0&&e<=100?(this.buffer=e,this.bufferEvent.emit(e),this.spatialFilterService.loadBufferGeometry(this.drawZone,qd.Polygon,1e3*e).subscribe(e=>{this.zoneWithBuffer=e,this.zoneWithBufferChange.emit(this.zoneWithBuffer)})):0===e?(this.buffer=e,this.bufferEvent.emit(e),this.drawZoneEvent.emit(this.drawZone)):(e<0||this.measureUnit===ch.Meters&&e>1e5||this.measureUnit===ch.Kilometers&&e>100)&&(this.bufferFormControl.setValue(0),this.buffer=0,this.messageService.alert(this.languageService.translate.instant("igo.geo.spatialFilter.bufferAlert"),this.languageService.translate.instant("igo.geo.spatialFilter.warning")))})}ngOnDestroy(){this.value$$.unsubscribe(),this.radiusChanges$$.unsubscribe(),this.bufferChanges$$.unsubscribe(),this.cdRef.detach(),this.radiusChanges$$&&this.radiusChanges$$.unsubscribe(),this.value$$&&this.value$$.unsubscribe()}onItemTypeChange(e){this.selectedItemType=e.value,this.itemTypeChange.emit(this.selectedItemType)}onMeasureUnitChange(e){e!==this.measureUnit&&(this.measureUnit=e,this.measureUnitChange.emit(this.measureUnit),this.isPolygon()?this.bufferFormControl.setValue(this.measureUnit===ch.Meters?1e3*this.bufferFormControl.value:this.bufferFormControl.value/1e3):this.isPoint()&&this.radiusFormControl.setValue(this.measureUnit===ch.Meters?1e3*this.radiusFormControl.value:this.radiusFormControl.value/1e3))}isPredefined(){return this.type===qd.Predefined}isPolygon(){return this.type===qd.Polygon}isPoint(){return this.type===qd.Point}hasChild(e,t){return!!t.children&&t.children.length}onToggleClick(e){this.treeControl.isExpanded(e)?this.treeControl.collapse(e):this.treeControl.expand(e)}isAllSelected(e){let t,o=0;return e?(t=e.children.length,e.children.forEach(e=>{this.selectedThematics.selected.find(t=>t===e)&&o++})):(t=this.selectedThematics.selected.length,this.thematics.forEach(e=>{-1===this.groups.indexOf(e.name)&&o++}),this.childrens.forEach(e=>{this.thematics.find(t=>t.source===e.source)||o++})),o>=1&&t===o}hasChildrenSelected(e){let t=!1;return e.children.forEach(e=>{this.selectedThematics.selected.find(t=>t.source===e.source)&&(t=!0)}),t}masterToggle(){this.isAllSelected()?this.selectedThematics.clear():this.selectAll();const e=[];for(const t of this.selectedThematics.selected)e.push(t);this.isAllSelected()?this.thematics.forEach(e=>{this.hasChild(0,e)&&this.treeControl.expand(e)}):this.thematics.forEach(e=>{this.hasChild(0,e)&&this.treeControl.collapse(e)}),this.thematicChange.emit(e)}selectAll(e){e?this.hasChild(0,e)&&e.children.forEach(e=>this.selectedThematics.select(e)):(this.thematics.forEach(e=>{-1===this.groups.indexOf(e.name)&&this.selectedThematics.select(e)}),this.childrens.forEach(e=>{this.selectedThematics.selected.find(t=>t.source===e.source)||this.selectedThematics.select(e)}))}childrensToggle(e){this.isAllSelected(e)?e.children.forEach(e=>this.selectedThematics.deselect(e)):this.selectAll(e);const t=[];for(const o of this.selectedThematics.selected)t.push(o);this.treeControl.expand(e),this.thematicChange.emit(t)}onToggleChange(e){let t=!1;void 0!==this.selectedThematics.selected.find(t=>t.source===e.source)&&(t=!0),this.childrens.forEach(o=>{o===e&&!1===t&&this.selectedThematics.select(o),o===e&&!0===t&&this.selectedThematics.deselect(o)}),this.thematics.forEach(o=>{o===e&&!1===t&&this.selectedThematics.select(o),o===e&&!0===t&&this.selectedThematics.deselect(o)});const o=[];for(const i of this.selectedThematics.selected)o.push(i);this.thematicChange.emit(o)}onDrawControlChange(){this.drawControlIsActive=!this.drawControlIsActive}onfreehandControlChange(){this.freehandDrawIsActive=!this.freehandDrawIsActive,this.freehandControl.emit(this.freehandDrawIsActive)}toggleSearchButton(){this.isPredefined()||(this.buffer>0?(this.zoneWithBuffer.meta={id:void 0,title:"Zone"},this.zoneWithBuffer.properties={nom:"Zone",type:this.type},this.drawZoneEvent.emit(this.zoneWithBuffer)):(this.drawZone.meta={id:void 0,title:"Zone"},this.drawZone.properties={nom:"Zone",type:this.type},this.drawZoneEvent.emit(this.drawZone))),this.isPoint()?this.radiusEvent.emit(this.radius):this.isPolygon()&&this.bufferEvent.emit(this.buffer),this.toggleSearch.emit(),this.store.entities$.subscribe(e=>{e.length&&this.layers.length===this.thematicLength+1&&this.openWorkspace.emit()})}clearButton(){this.loading=!0,this.store&&this.store.clear(),(this.isPoint()||this.isPolygon())&&(this.drawZone=void 0,this.formControl.reset()),this.bufferFormControl.setValue(0),this.buffer=0,this.bufferEvent.emit(0),this.clearButtonEvent.emit(),this.loading=!1}clearDrawZone(){this.formControl.reset(),this.bufferFormControl.setValue(0),this.buffer=0}clearSearch(){this.selectedThematics.clear(),this.bufferFormControl.setValue(0),this.buffer=0,this.bufferEvent.emit(0),this.thematicChange.emit([]),this.clearSearchEvent.emit()}disableSearchButton(){if(this.type===qd.Predefined){if(this.selectedItemType===Dd.Address&&void 0!==this.queryType&&void 0!==this.zone)return this.loading;if(this.selectedItemType===Dd.Thematics&&void 0!==this.queryType&&void 0!==this.zone&&this.selectedThematics.selected.length>0)return this.loading}if(this.type===qd.Polygon||this.type===qd.Point){if(this.selectedItemType===Dd.Address&&null!==this.formControl.value)return this.loading;if(this.selectedItemType===Dd.Thematics&&this.selectedThematics.selected.length>0&&null!==this.formControl.value)return this.loading}return!0}disabledClearSearch(){let e=!0;return e=this.selectedItemType===Dd.Address?void 0===this.queryType:void 0===this.queryType&&0===this.selectedThematics.selected.length,e}getRadius(){let e;if(e=null!==this.formControl.value?this.measureUnit===ch.Meters?this.formControl.value.radius:this.formControl.value.radius/1e3:void 0,this.type===qd.Point){if(this.freehandDrawIsActive){if(e){if(e>=1e5)return this.messageService.alert(this.languageService.translate.instant("igo.geo.spatialFilter.radiusAlert"),this.languageService.translate.instant("igo.geo.spatialFilter.warning")),void this.formControl.reset();if(e!==this.radiusFormControl.value)return void this.radiusFormControl.setValue(e)}}else if(this.radiusFormControl.value<0||this.measureUnit===ch.Meters&&this.radiusFormControl.value>=1e5||this.measureUnit===ch.Kilometers&&this.radiusFormControl.value>=100)return this.messageService.alert(this.languageService.translate.instant("igo.geo.spatialFilter.radiusAlert"),this.languageService.translate.instant("igo.geo.spatialFilter.warning")),this.radius=1e3,this.radiusFormControl.setValue(this.measureUnit===ch.Meters?this.radius:this.radius/1e3),void this.drawGuide$.next(this.radius);this.measureUnit===ch.Meters?(this.radius=this.radiusFormControl.value,this.drawGuide$.next(this.radius)):(this.radius=1e3*this.radiusFormControl.value,this.drawGuide$.next(1e3*this.radius)),this.overlayStyle$.next(this.PointStyle),this.drawStyle$.next(this.PointStyle)}}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.sBO),r.Y36(Ed),r.Y36(de),r.Y36(ue))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-spatial-filter-item"]],inputs:{map:"map",type:"type",queryType:"queryType",zone:"zone",loading:"loading",store:"store",layers:"layers",allLayers:"allLayers",thematicLength:"thematicLength"},outputs:{toggleSearch:"toggleSearch",itemTypeChange:"itemTypeChange",thematicChange:"thematicChange",drawZoneEvent:"drawZoneEvent",bufferEvent:"bufferEvent",zoneWithBufferChange:"zoneWithBufferChange",measureUnitChange:"measureUnitChange",radiusEvent:"radiusEvent",freehandControl:"freehandControl",clearButtonEvent:"clearButtonEvent",clearSearchEvent:"clearSearchEvent",export:"export",openWorkspace:"openWorkspace"},decls:27,vars:40,consts:[[3,"formControl","map","geometryType","drawGuide","measure","drawControlIsActive","freehandDrawIsActive","drawStyle","overlayStyle","radius"],[1,"header"],[3,"checked","labelPosition","change",4,"ngIf"],["class","buffer-unit",4,"ngIf"],["class","radius-unit",4,"ngIf"],[1,"title","mat-typography"],[3,"value"],[3,"value","change",4,"ngFor","ngForOf"],["class","thematics",4,"ngIf"],[1,"buttons"],["mat-raised-button","","class","clear-search-button",3,"disabled","click",4,"ngIf"],["mat-raised-button","","class","clear-form-button",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","primary",1,"search-button",3,"disabled","click"],["mat-raised-button","",1,"remove-button",3,"disabled","click"],["mat-raised-button","",1,"export-button",3,"disabled","click"],[3,"checked","labelPosition","change"],[1,"buffer-unit"],[1,"buffer-form"],[1,"buffer"],["type","number","matInput","",3,"placeholder","formControl","value","readonly"],[1,"unit-field"],[3,"value","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"radius-unit"],[1,"radius-form"],[1,"radius"],["type","number","matInput","",3,"placeholder","formControl","value","readonly","input"],[3,"value","change"],[1,"thematics"],["matColumnDef","name"],["class","thematics-header",4,"matHeaderCellDef"],["matColumnDef","select"],["class","checks-header",4,"matHeaderCellDef"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[3,"dataSource","treeControl"],["matTreeNodeToggle","",4,"matTreeNodeDef"],[4,"matTreeNodeDef","matTreeNodeDefWhen"],[1,"thematics-header"],[1,"checks-header"],[3,"checked","indeterminate","change"],["matTreeNodeToggle",""],[1,"mat-tree-node"],["mat-icon-button","","disabled",""],[1,"tree-check",3,"checked","click","change"],["mat-icon-button","",3,"click"],[3,"svgIcon"],[1,"tree-check-2",3,"checked","indeterminate","change"],[1,"tree-ul"],["matTreeNodeOutlet",""],["mat-raised-button","",1,"clear-search-button",3,"disabled","click"],["mat-raised-button","",1,"clear-form-button",3,"disabled","click"]],template:function(e,t){1&e&&(r._UZ(0,"igo-geometry-form-field-input",0),r.ALo(1,"async"),r.ALo(2,"async"),r.ALo(3,"async"),r.TgZ(4,"div",1),r.YNc(5,Cf,3,5,"mat-slide-toggle",2),r.YNc(6,Tf,3,5,"mat-slide-toggle",2),r.qZA(),r.YNc(7,Lf,8,8,"div",3),r.YNc(8,Ff,8,8,"div",4),r.TgZ(9,"mat-label",5),r._uU(10),r.ALo(11,"translate"),r.qZA(),r.TgZ(12,"mat-radio-group",6),r.YNc(13,Of,3,4,"mat-radio-button",7),r.qZA(),r.YNc(14,qf,11,5,"div",8),r.TgZ(15,"div",9),r.YNc(16,Df,3,4,"button",10),r.YNc(17,Ef,3,4,"button",11),r.TgZ(18,"button",12),r.NdJ("click",function(){return t.toggleSearchButton()}),r._uU(19),r.ALo(20,"translate"),r.qZA(),r.TgZ(21,"button",13),r.NdJ("click",function(){return t.clearButton()}),r._uU(22),r.ALo(23,"translate"),r.qZA(),r.TgZ(24,"button",14),r.NdJ("click",function(){return t.export.emit()}),r._uU(25),r.ALo(26,"translate"),r.qZA(),r.qZA()),2&e&&(r.Q6J("formControl",t.formControl)("map",t.map)("geometryType",t.geometryType)("drawGuide",r.lcZ(1,26,t.drawGuide$))("measure",t.measure)("drawControlIsActive",t.drawControlIsActive)("freehandDrawIsActive",t.freehandDrawIsActive)("drawStyle",r.lcZ(2,28,t.drawStyle$))("overlayStyle",r.lcZ(3,30,t.overlayStyle$))("radius",t.radius),r.xp6(5),r.Q6J("ngIf",!t.isPredefined()),r.xp6(1),r.Q6J("ngIf",!t.isPredefined()),r.xp6(1),r.Q6J("ngIf",t.isPolygon()),r.xp6(1),r.Q6J("ngIf",t.isPoint()),r.xp6(2),r.hij("",r.lcZ(11,32,"igo.geo.spatialFilter.search")," : "),r.xp6(2),r.Q6J("value",t.selectedItemType),r.xp6(1),r.Q6J("ngForOf",t.itemType),r.xp6(1),r.Q6J("ngIf","Thematics"===t.selectedItemType),r.xp6(2),r.Q6J("ngIf",t.isPredefined()),r.xp6(1),r.Q6J("ngIf",t.isPolygon()||t.isPoint()),r.xp6(1),r.Q6J("disabled",t.disableSearchButton()),r.xp6(1),r.hij(" ",r.lcZ(20,34,"igo.geo.spatialFilter.goSearch")," "),r.xp6(2),r.Q6J("disabled",0===t.allLayers.length),r.xp6(1),r.hij(" ",r.lcZ(23,36,"igo.geo.spatialFilter.removeLayer")," "),r.xp6(2),r.Q6J("disabled",!t.store.entities$.getValue().length),r.xp6(1),r.hij(" ",r.lcZ(26,38,"igo.geo.spatialFilter.exportLayer")," "))},styles:[".header[_ngcontent-%COMP%]{margin-top:5px;width:100%}.mat-slide-toggle[_ngcontent-%COMP%]{padding:5px;margin-bottom:15px;width:98%}.mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content{width:calc(100% - 20px)}.title[_ngcontent-%COMP%]{margin-left:5px;font-size:medium;font-size:initial}.mat-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-top:10px}.mat-radio-button[_ngcontent-%COMP%]{display:inline-flex;position:relative;margin-left:16px;margin-top:10px}.mat-form-field[_ngcontent-%COMP%]{margin-top:5px}.mat-column-select[_ngcontent-%COMP%]{overflow:auto}.buttons[_ngcontent-%COMP%]{margin-top:15px}.search-button[_ngcontent-%COMP%]{left:15px;width:165px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){.search-button[_ngcontent-%COMP%]{left:10px;width:45%;min-height:35px;white-space:normal;line-height:normal}}.export-button[_ngcontent-%COMP%]{left:15px;width:165px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){.export-button[_ngcontent-%COMP%]{left:10px;margin-top:10px;width:45%;min-height:35px;white-space:normal;line-height:normal}}.remove-button[_ngcontent-%COMP%]{margin-top:12px;left:5px;width:165px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){.remove-button[_ngcontent-%COMP%]{margin:0;width:45%;min-height:35px;white-space:normal;line-height:normal}}.clear-form-button[_ngcontent-%COMP%]{left:5px;width:165px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){.clear-form-button[_ngcontent-%COMP%]{width:45%;min-height:35px;white-space:normal;line-height:normal}}.clear-search-button[_ngcontent-%COMP%]{left:5px;width:165px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){.clear-search-button[_ngcontent-%COMP%]{width:45%;min-height:35px;white-space:normal;line-height:normal}}.thematics[_ngcontent-%COMP%]{max-height:35%;overflow:auto;margin-top:5px;width:98%}.results[_ngcontent-%COMP%]{overflow:auto;max-height:250px;width:98%}.mat-column-typeResults[_ngcontent-%COMP%]{max-width:100px;margin-right:5px}.buffer-unit[_ngcontent-%COMP%], .radius-unit[_ngcontent-%COMP%]{display:flex;width:100%;margin-left:2px;padding:5px}.radius[_ngcontent-%COMP%], .buffer[_ngcontent-%COMP%]{display:flex;flex-flow:column nowrap;width:110%}.unit-field[_ngcontent-%COMP%]{width:110px;margin-left:30px}.example-tree-invisible[_ngcontent-%COMP%]{display:none}.tree-ul[_ngcontent-%COMP%]{margin:0;padding:0 0 0 20px;list-style-type:none}.tree-check[_ngcontent-%COMP%], .tree-check-2[_ngcontent-%COMP%]{position:relative;margin-left:auto;margin-right:5px}.thematics-header[_ngcontent-%COMP%]{max-width:250px}.checks-header[_ngcontent-%COMP%]{padding:none;max-width:calc(100% - 316px);overflow:hidden}.mat-checkbox[_ngcontent-%COMP%]{padding:5px}.mat-tree-node[_ngcontent-%COMP%]{position:relative;min-height:42px;width:280px}.mat-header-cell[_ngcontent-%COMP%]{height:56px}"],changeDetection:0}),e})();const Uf=["endDatepickerTime"],Nf=["beginDatepickerTime"],Jf=["beginTime"],Bf=["endTime"];function jf(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-slide-toggle",4),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw().sliderMode=t})("change",function(t){return r.CHM(e),r.oxw().modeChange(t)}),r._uU(1),r.ALo(2,"translate"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("ngModel",e.sliderMode),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.filter.sliderModeTitle")," ")}}function Qf(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",5),r.TgZ(1,"igo-ogc-filter-time-slider",6),r.NdJ("changeProperty",function(t){return r.CHM(e),r.oxw().changePropertyByPass(t)}),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(1),r.Q6J("begin",e.beginValue)("max",e.restrictedToStep()?e.maxDate:e.endValue)("currentFilter",e.currentFilter)("datasource",e.datasource)}}function Gf(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",9),r.TgZ(1,"mat-form-field",10),r.TgZ(2,"mat-label"),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.TgZ(5,"input",11),r.NdJ("change",function(t){r.CHM(e);const o=r.MAs(8);return r.oxw(2).yearOnlyInputChange(t,o,"begin")}),r.qZA(),r._UZ(6,"mat-datepicker-toggle",12),r.TgZ(7,"mat-datepicker",13,14),r.NdJ("yearSelected",function(t){r.CHM(e);const o=r.MAs(8);return r.oxw(2).yearSelected(t,o,"begin")}),r.qZA(),r._UZ(9,"input",15,16),r.qZA(),r.TgZ(11,"mat-form-field",10),r.TgZ(12,"mat-label"),r._uU(13),r.ALo(14,"translate"),r.qZA(),r._UZ(15,"input",17),r._UZ(16,"mat-datepicker-toggle",12),r.TgZ(17,"mat-datepicker",13,18),r.NdJ("yearSelected",function(t){r.CHM(e);const o=r.MAs(18);return r.oxw(2).yearSelected(t,o,"end")}),r.qZA(),r._UZ(19,"input",15,19),r.qZA(),r.qZA()}if(2&e){const e=r.MAs(8),t=r.MAs(18),o=r.oxw(2);r.xp6(3),r.Oqu(r.lcZ(4,18,"igo.geo.timeFilter.startYear")),r.xp6(2),r.s9C("value",o.onlyYearBegin),r.xp6(1),r.Q6J("for",e),r.xp6(1),r.Q6J("startView",o.calendarView())("startAt",o.beginValue),r.xp6(2),r.Q6J("matDatepicker",e)("value",o.beginValue?o.beginValue:o.handleDate(o.datasource.options.minDate))("min",o.handleDate(o.datasource.options.minDate))("max",o.endValue&&!o.restrictedToStep()?o.endValue:o.handleDate(o.datasource.options.maxDate)),r.xp6(4),r.Oqu(r.lcZ(14,20,"igo.geo.timeFilter.endYear")),r.xp6(2),r.s9C("value",o.onlyYearEnd),r.xp6(1),r.Q6J("for",t),r.xp6(1),r.Q6J("startView",o.calendarView())("startAt",o.endValue),r.xp6(2),r.Q6J("matDatepicker",t)("value",o.endValue?o.endValue:o.handleDate(o.datasource.options.maxDate))("min",o.beginValue?o.beginValue:o.handleDate(o.datasource.options.minDate))("max",o.handleDate(o.datasource.options.maxDate))}}function Yf(e,t){if(1&e&&(r.TgZ(0,"mat-option",32),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.Oqu(e)}}function zf(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-form-field",29),r.TgZ(1,"mat-label"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"mat-select",30),r.NdJ("selectionChange",function(){r.CHM(e),r.oxw();const t=r.MAs(4);return r.oxw(2).changeTemporalProperty(t.value,1)}),r.YNc(5,Yf,2,2,"mat-option",31),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(3);r.xp6(2),r.Oqu(r.lcZ(3,4,"igo.geo.timeFilter.hour")),r.xp6(2),r.Q6J("formControl",e.beginHourFormControl),r.uIk("disabled",!e.currentFilter.active),r.xp6(1),r.Q6J("ngForOf",e.beginHours)}}function Hf(e,t){if(1&e&&(r.TgZ(0,"mat-option",32),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.Oqu(e)}}function Vf(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-form-field",33),r.TgZ(1,"mat-label"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"mat-select",30),r.NdJ("selectionChange",function(){r.CHM(e),r.oxw();const t=r.MAs(4);return r.oxw(2).changeTemporalProperty(t.value,1)}),r.YNc(5,Hf,2,2,"mat-option",31),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(3);r.xp6(2),r.Oqu(r.lcZ(3,4,"igo.geo.timeFilter.minute")),r.xp6(2),r.Q6J("formControl",e.beginMinuteFormControl),r.uIk("disabled",!e.currentFilter.active),r.xp6(1),r.Q6J("ngForOf",e.beginMinutes)}}function Wf(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",20),r.TgZ(1,"mat-form-field",21),r._UZ(2,"mat-datepicker-toggle",12),r.TgZ(3,"input",22,23),r.NdJ("dateChange",function(){r.CHM(e);const t=r.MAs(4);return r.oxw(2).changeTemporalProperty(t.value,1)}),r.ALo(5,"translate"),r.qZA(),r._UZ(6,"span",24),r.TgZ(7,"mat-datepicker",25,14),r.NdJ("yearSelected",function(t){r.CHM(e);const o=r.MAs(8);return r.oxw(2).yearSelected(t,o,"begin")})("monthSelected",function(t){r.CHM(e);const o=r.MAs(8);return r.oxw(2).monthSelected(t,o,"begin")}),r.qZA(),r.qZA(),r.TgZ(9,"div",26),r.YNc(10,zf,6,6,"mat-form-field",27),r.YNc(11,Vf,6,6,"mat-form-field",28),r.qZA(),r.qZA()}if(2&e){const e=r.MAs(8),t=r.oxw(2);r.xp6(2),r.Q6J("for",e),r.xp6(1),r.Q6J("matDatepicker",e)("placeholder",r.lcZ(5,12,"igo.geo.timeFilter.startDate"))("matDatepickerFilter",t.dateFilter.bind(t,"begin"))("value",t.beginValue?t.beginValue:t.handleDate(t.datasource.options.minDate))("min",t.handleDate(t.datasource.options.minDate))("max",t.endValue&&!t.restrictedToStep()?t.endValue:t.handleDate(t.datasource.options.maxDate)),r.uIk("disabled",!t.currentFilter.active),r.xp6(4),r.Q6J("startView",t.calendarView())("startAt",t.beginValue),r.xp6(3),r.Q6J("ngIf","datetime"===t.calendarType()),r.xp6(1),r.Q6J("ngIf","datetime"===t.calendarType())}}function Xf(e,t){if(1&e&&(r.TgZ(0,"mat-option",32),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.Oqu(e)}}function Kf(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-form-field",29),r.TgZ(1,"mat-label"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"mat-select",30),r.NdJ("selectionChange",function(){r.CHM(e),r.oxw();const t=r.MAs(4);return r.oxw(2).changeTemporalProperty(t.value,2)}),r.YNc(5,Xf,2,2,"mat-option",31),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(3);r.xp6(2),r.Oqu(r.lcZ(3,4,"igo.geo.timeFilter.hour")),r.xp6(2),r.Q6J("formControl",e.endHourFormControl),r.uIk("disabled",!e.currentFilter.active),r.xp6(1),r.Q6J("ngForOf",e.endHours)}}function ey(e,t){if(1&e&&(r.TgZ(0,"mat-option",32),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.Oqu(e)}}function ty(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-form-field",33),r.TgZ(1,"mat-label"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"mat-select",30),r.NdJ("selectionChange",function(){r.CHM(e),r.oxw();const t=r.MAs(4);return r.oxw(2).changeTemporalProperty(t.value,2)}),r.YNc(5,ey,2,2,"mat-option",31),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(3);r.xp6(2),r.Oqu(r.lcZ(3,4,"igo.geo.timeFilter.minute")),r.xp6(2),r.Q6J("formControl",e.endMinuteFormControl),r.uIk("disabled",!e.currentFilter.active),r.xp6(1),r.Q6J("ngForOf",e.endMinutes)}}function oy(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",20),r.TgZ(1,"mat-form-field",21),r._UZ(2,"mat-datepicker-toggle",12),r.TgZ(3,"input",22,34),r.NdJ("dateChange",function(){r.CHM(e);const t=r.MAs(4);return r.oxw(2).changeTemporalProperty(t.value,2)}),r.ALo(5,"translate"),r.qZA(),r._UZ(6,"span",24),r.TgZ(7,"mat-datepicker",25,18),r.NdJ("yearSelected",function(t){r.CHM(e);const o=r.MAs(8);return r.oxw(2).yearSelected(t,o,"end")})("monthSelected",function(t){r.CHM(e);const o=r.MAs(8);return r.oxw(2).monthSelected(t,o,"end")}),r.qZA(),r.qZA(),r.TgZ(9,"div",26),r.YNc(10,Kf,6,6,"mat-form-field",27),r.YNc(11,ty,6,6,"mat-form-field",28),r.qZA(),r.qZA()}if(2&e){const e=r.MAs(8),t=r.oxw(2);r.xp6(2),r.Q6J("for",e),r.xp6(1),r.Q6J("matDatepicker",e)("placeholder",r.lcZ(5,12,"igo.geo.timeFilter.endDate"))("matDatepickerFilter",t.dateFilter.bind(t,"end"))("value",t.endValue?t.endValue:t.handleDate(t.datasource.options.maxDate))("min",t.beginValue?t.beginValue:t.handleDate(t.datasource.options.minDate))("max",t.handleDate(t.datasource.options.maxDate)),r.uIk("disabled",!t.currentFilter.active),r.xp6(4),r.Q6J("startView",t.calendarView())("startAt",t.endValue),r.xp6(3),r.Q6J("ngIf","datetime"===t.calendarType()),r.xp6(1),r.Q6J("ngIf","datetime"===t.calendarType())}}function iy(e,t){if(1&e&&(r.TgZ(0,"div"),r.YNc(1,Gf,21,22,"div",7),r.YNc(2,Wf,12,14,"div",8),r.YNc(3,oy,12,14,"div",8),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf",e.calendarTypeYear),r.xp6(1),r.Q6J("ngIf","year"!==e.calendarType()),r.xp6(1),r.Q6J("ngIf",!e.restrictedToStep()&&"year"!==e.calendarType())}}const ry=ua;let sy=(()=>{class e{constructor(e){this.ogcFilterTimeService=e,this.changeProperty=new r.vpe,this.beginHourFormControl=new We.NI,this.beginMinuteFormControl=new We.NI,this.endHourFormControl=new We.NI,this.endMinuteFormControl=new We.NI,this._defaultMin="1900-01-01",this._defaultMax="2052-01-06",this._defaultDisplayFormat="DD/MM/YYYY HH:mm A",this._defaultSliderModeEnabled=!0,this.ogcFilterOperator=Bl,this.sliderMode=!1,this.defaultStepMillisecond=6e4,this.calendarTypeYear=!1}get step(){return this.datasource.options.stepDate?this.datasource.options.stepDate:this.currentFilter.step}get stepMilliseconds(){const e=ry.duration(this.step).asMilliseconds();return 0===e?this.defaultStepMillisecond:e}set beginValue(e){this._beginValue=e}get beginValue(){return this._beginValue}set endValue(e){this._endValue=e}get endValue(){return this._endValue}get sliderInterval(){return void 0===this.currentFilter.sliderInterval?2e3:this.currentFilter.sliderInterval}get maxDate(){return this.datasource.options.maxDate?this.datasource.options.maxDate:this._defaultMax}get displayFormat(){return this.currentFilter.displayFormat?this.currentFilter.displayFormat:this._defaultDisplayFormat}ngOnInit(){this.currentFilter.sliderOptions&&(this.currentFilter.sliderOptions.enabled=void 0!==this.currentFilter.sliderOptions.enabled?this.currentFilter.sliderOptions.enabled:this._defaultSliderModeEnabled),this.beginValue=this.parseFilter(this.handleMin()),this.endValue=this.parseFilter(this.handleMax()),this.onlyYearBegin=this.beginValue.getUTCFullYear(),this.onlyYearEnd=this.endValue.getUTCFullYear(),this.calendarTypeYear=this.isCalendarYearMode(),this.updateHoursMinutesArray(),this.updateValues(),this.currentFilter.calendarModeYear&&this.beginValue.setUTCFullYear(this.beginValue.getUTCFullYear()+1)}parseFilter(e){if(!e)return new Date;if(isNaN(new Date(e).getTime())){if(e.search("now")>=0){const t=e.match(/years|months|weeks|days|hours|seconds/);if(e.match(/\+/)){const o=parseInt(e.substring(e.search("+")+1,t.index),10);return ry().add(o,t[0]).toDate()}if(e.match(/\-/)){const o=parseInt(e.substring(e.search("-")+1,t.index),10);return ry().subtract(o,t[0]).toDate()}return new Date}if(e.search("today")>=0){const t=ry().endOf("day").toDate(),o=e.match(/years|months|weeks|days|hours|seconds/);if(e.match(/\+/)){const i=parseInt(e.substring(e.search("+")+1,o.index),10);return ry(t).add(i,o[0]).toDate()}if(e.match(/\-/)){const i=parseInt(e.substring(e.search("-")+1,o.index),10);return ry(t).subtract(i,o[0]).toDate()}return t}return new Date}return e?new Date(e):new Date}changeTemporalProperty(e,t,o=!0){let i=this.getDateTime(e,t);2===t&&"date"===this.calendarType()&&!this.sliderMode&&(i=ry(i).endOf("day").toDate()),1===t?(this.beginValue=i,this.restrictedToStep()&&this.changeTemporalProperty(this.ogcFilterTimeService.addStep(i,this.stepMilliseconds),2,o)):this.endValue=i,this.updateHoursMinutesArray(),this.changeProperty.next({value:i.toISOString(),pos:t,refreshFilter:o})}handleDate(e){if(e&&""!==e)return new Date(e)}calendarType(){return this.currentFilter.calendarModeYear?"year":this.stepMilliseconds<864e5?"datetime":"date"}isCalendarYearMode(){return"year"===this.calendarType()}yearOnlyInputChange(e,t,o){const i=new Date(`${e.target.value}-01-01T05:00:00.000Z`);this.yearSelected(i,t,o)}yearSelected(e,t,o,i=!0){if(this.ogcFilterTimeService.stepIsYearDuration(this.step)){t&&t.close();const r=e.getUTCFullYear();if("begin"===o&&this.currentFilter.calendarModeYear){this.onlyYearBegin=r;const t=e.getUTCFullYear()-1;e=ry().set("year",t).toDate(),e=ry(e).endOf("year").toDate()}if("end"===o?(this.onlyYearEnd=r,e=ry(e).endOf("year").toDate()):"begin"===o&&this.restrictedToStep()&&this.yearSelected(e,void 0,"end"),this.changeTemporalProperty(e,"begin"===o?1:2,i),"begin"===o&&this.currentFilter.calendarModeYear){const t=ry(e).startOf("year").set("year",e.getFullYear()+1).toDate();this.beginValue=t}}}monthSelected(e,t,o,i=!0){this.ogcFilterTimeService.stepIsMonthDuration(this.step)&&(t&&t.close(),"end"===o?e=ry(e).endOf("month").toDate():"begin"===o&&this.restrictedToStep()&&this.monthSelected(e,void 0,"end"),this.changeTemporalProperty(e,"begin"===o?1:2,i))}calendarView(){const e=this.stepMilliseconds,t=Math.abs(this.parseFilter(this.currentFilter.end).getTime()-this.parseFilter(this.currentFilter.begin).getTime());return this.ogcFilterTimeService.stepIsYearDuration(this.step)?"multi-year":this.ogcFilterTimeService.stepIsMonthDuration(this.step)?"year":e<864e5&&t<864e5?"clock":"month"}dateFilter(e,t){const o=new Date(t),i=o.getTime()-new Date(this.handleMin()).getTime();if(this.ogcFilterTimeService.stepIsYearDuration(this.step)){const t=ry(o).diff(ry(this.handleMin()),"years",!0);if("end"===e){const e=ry(o).add(1,"d");return ry(e).diff(ry(this.handleMin()),"years",!0)%ry.duration(this.step).asYears()==0}if("begin"===e)return t%ry.duration(this.step).asYears()==0}else if(this.ogcFilterTimeService.stepIsMonthDuration(this.step)){const t=ry(o).diff(ry(this.handleMin()),"months",!0);if("end"===e){const e=ry(o).add(1,"d");return ry(e).diff(ry(this.handleMin()),"months",!0)%ry.duration(this.step).asMonths()==0}if("begin"===e)return t%ry.duration(this.step).asMonths()==0}else if(this.ogcFilterTimeService.stepIsWeekDuration(this.step)){const t=ry(o).diff(ry(this.handleMin()),"weeks",!0);if("end"===e){const e=ry(o).add(1,"d");return ry(e).diff(ry(this.handleMin()),"weeks",!0)%ry.duration(this.step).asWeeks()==0}if("begin"===e)return t%ry.duration(this.step).asWeeks()==0}else if(this.ogcFilterTimeService.stepIsDayDuration(this.step)){const t=ry(o).diff(ry(this.handleMin()),"days",!0);if("end"===e){const e=ry(o).add(1,"d"),t=ry(e).diff(ry(this.handleMin()),"days",!0)%ry.duration(this.step).asDays();return t<1e-7&&t>-1e-7||0===t}if("begin"===e){const e=t%ry.duration(this.step).asDays()+1;return e<1e-7&&e>-1e-7&&0!==e||1===e}}else{if(this.ogcFilterTimeService.stepIsHourDuration(this.step))return ry(o).diff(ry(this.handleMin()),"hours",!0)%ry.duration(this.step).asHours()==0;if(this.ogcFilterTimeService.stepIsMinuteDuration(this.step))return!0}return i%this.stepMilliseconds==0}getDateTime(e,t){const o=new Date(e);let i;if(!this.sliderMode)switch(t){case 1:if(this.currentFilter.calendarModeYear){i=o.setHours(0,0);break}i=o.setHours(this.beginHourFormControl.value,this.beginMinuteFormControl.value);break;case 2:if(this.currentFilter.calendarModeYear){i=o.setHours(0,0);break}i=o.setHours(this.endHourFormControl.value,this.endMinuteFormControl.value)}return new Date(i||o)}handleMinuteIncrement(){return this.ogcFilterTimeService.stepIsMinuteDuration(this.step)?this.stepMilliseconds<36e5?this.stepMilliseconds/1e3==60?1:this.stepMilliseconds/1e3:this.stepMilliseconds%36e5/60:this.ogcFilterTimeService.stepIsHourDuration(this.step)?60:1}handleHourIncrement(){return this.ogcFilterTimeService.stepIsHourDuration(this.step)?this.stepMilliseconds/1e3/60/60:1}fullBeginHoursArray(e){this.beginHours=Array.from(e?{length:(this.endHourFormControl.value-0)/this.handleHourIncrement()+1}:{length:23/this.handleHourIncrement()+1},(e,t)=>0+t*this.handleHourIncrement()),this.beginHourFormControl.setValue(this.beginValue.getHours())}fullEndHoursArray(e){this.endHours=e?Array.from({length:(23-this.beginHourFormControl.value)/this.handleHourIncrement()+1},(e,t)=>this.beginHourFormControl.value+t*this.handleHourIncrement()):Array.from({length:23/this.handleHourIncrement()+1},(e,t)=>0+t*this.handleHourIncrement()),this.endHourFormControl.setValue(this.endValue.getHours())}fullBeginMinutesArray(e){this.beginMinutes=Array.from(e?{length:(this.endMinuteFormControl.value-0)/this.handleMinuteIncrement()+1}:{length:59/this.handleMinuteIncrement()+1},(e,t)=>0+t*this.handleMinuteIncrement()),this.beginMinuteFormControl.setValue(this.beginValue.getMinutes())}fullEndMinutesArray(e){this.endMinutes=e?Array.from({length:(59-this.beginMinuteFormControl.value)/this.handleMinuteIncrement()+1},(e,t)=>this.beginMinuteFormControl.value+t*this.handleMinuteIncrement()):Array.from({length:59/this.handleMinuteIncrement()+1},(e,t)=>0+t*this.handleMinuteIncrement()),this.endMinuteFormControl.setValue(this.endValue.getMinutes())}updateHoursMinutesArray(){const e=new Date(this.beginValue),t=new Date(this.endValue);e.setHours(0,0)===t.setHours(0,0)?(this.fullBeginHoursArray(!0),this.fullEndHoursArray(!0),this.beginValue.getHours()===this.endValue.getHours()&&(this.fullBeginMinutesArray(!0),this.fullEndMinutesArray(!0))):(this.fullBeginHoursArray(),this.fullEndHoursArray(),this.fullBeginMinutesArray(),this.fullEndMinutesArray())}updateValues(){this.changeTemporalProperty(this.beginValue,1,!1),this.changeTemporalProperty(this.endValue,2,!0)}restrictedToStep(){return!!this.currentFilter.restrictToStep&&this.currentFilter.restrictToStep}handleMin(){return this.currentFilter.begin?this.currentFilter.begin:this.datasource.options.minDate?this.datasource.options.minDate:this._defaultMin}handleMax(){return this.currentFilter.end?this.currentFilter.end:this.datasource.options.maxDate?this.datasource.options.maxDate:this._defaultMax}changePropertyByPass(e){this.changeProperty.next(e)}modeChange(e){e.checked||this.updateValues()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Pm))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-ogc-filter-time"]],viewQuery:function(e,t){if(1&e&&(r.Gf(Uf,5),r.Gf(Nf,5),r.Gf(Jf,5),r.Gf(Bf,5)),2&e){let e;r.iGM(e=r.CRH())&&(t.endDatepickerTime=e.first),r.iGM(e=r.CRH())&&(t.beginDatepickerTime=e.first),r.iGM(e=r.CRH())&&(t.beginTime=e.first),r.iGM(e=r.CRH())&&(t.endTime=e.first)}},inputs:{datasource:"datasource",currentFilter:"currentFilter"},outputs:{changeProperty:"changeProperty"},decls:4,vars:3,consts:[[1,"datetime-container"],[3,"ngModel","ngModelChange","change",4,"ngIf"],["class","slider-container",4,"ngIf"],[4,"ngIf"],[3,"ngModel","ngModelChange","change"],[1,"slider-container"],[3,"begin","max","currentFilter","datasource","changeProperty"],["class","year-input-container",4,"ngIf"],["class","datetime-input",4,"ngIf"],[1,"year-input-container"],[1,"year-input"],["matInput","",1,"year-input-only-year",3,"value","change"],["matSuffix","",3,"for"],["panelClass","datepicker-year",3,"startView","startAt","yearSelected"],["beginDatepicker",""],["matInput","","enabled","false","readonly","true",1,"year-input-hide",3,"matDatepicker","value","min","max"],["beginYear",""],["matInput","",1,"year-input-only-year",3,"value"],["endDatepicker",""],["endYear",""],[1,"datetime-input"],[1,"date-input"],["matInput","",3,"matDatepicker","placeholder","matDatepickerFilter","value","min","max","dateChange"],["begin",""],[1,"filler"],[3,"startView","startAt","yearSelected","monthSelected"],[1,"time-input"],["class","hour-input",4,"ngIf"],["class","minute-input",4,"ngIf"],[1,"hour-input"],[3,"formControl","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"minute-input"],["end",""]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.YNc(1,jf,3,4,"mat-slide-toggle",1),r.YNc(2,Qf,2,4,"div",2),r.YNc(3,iy,4,3,"div",3),r.qZA()),2&e&&(r.xp6(1),r.Q6J("ngIf",null==t.currentFilter.sliderOptions?null:t.currentFilter.sliderOptions.enabled),r.xp6(1),r.Q6J("ngIf",t.sliderMode),r.xp6(1),r.Q6J("ngIf",!t.sliderMode))},styles:["input{text-align:center!important;margin:auto 5px!important}.slider-container[_ngcontent-%COMP%]{text-align:center}.datetime-input[_ngcontent-%COMP%]{display:inline-block;margin:5px 25px}.year-input-container[_ngcontent-%COMP%]{display:inline-block;margin:5px 25px}.date-input[_ngcontent-%COMP%]{width:120px;margin-right:25px}.time-input[_ngcontent-%COMP%]{display:inherit;margin-right:25px}.hour-input[_ngcontent-%COMP%], .minute-input[_ngcontent-%COMP%]{width:40px}.minute-input[_ngcontent-%COMP%]{margin-left:10px}.year-input[_ngcontent-%COMP%]{width:120px;margin-right:25px}.year-input-hide[_ngcontent-%COMP%]{width:120px;margin-right:25px;display:none}.year-input-only-year[_ngcontent-%COMP%]{width:120px;margin-right:25px}  .datepicker-year   .mat-calendar-arrow{display:none}  .datepicker-year   .mat-calendar-period-button{pointer-events:none}  .datepicker-year   .mat-calendar-body-cell:not(.mat-calendar-body-disabled):hover{background-color:#0000001f;border-radius:999px}"]}),e})();const ny=ua;let ay=(()=>{class e{constructor(e){this.ogcFilterTimeService=e,this.changeProperty=new r.vpe,this.sliderValue=1,this.calculatedStep=0,this._defaultDisplayFormat="DD/MM/YYYY HH:mm A",this._defaultSliderInterval=2e3,this.playIcon="play-circle",this.resetIcon="replay",this.sliderDisplayWith=this.sliderDisplayWith.bind(this)}get sliderInterval(){return void 0===this.currentFilter.sliderInterval?this._defaultSliderInterval:this.currentFilter.sliderInterval}get displayFormat(){var e;return(null===(e=this.currentFilter.sliderOptions)||void 0===e?void 0:e.displayFormat)?this.currentFilter.sliderOptions.displayFormat:this.currentFilter.displayFormat?this.currentFilter.displayFormat:this._defaultDisplayFormat}get beginMillisecond(){return this.ogcFilterTimeService.dateToNumber(this.begin)}get maxMillisecond(){return this.ogcFilterTimeService.dateToNumber(this.max)}get stepMillisecond(){return this.ogcFilterTimeService.stepMillisecond(this.datasource,this.currentFilter)}ngOnInit(){this.calculateStep(),this.handleSliderInput({value:1})}sliderDisplayWith(e){let t=new Date(this.beginMillisecond+(e-1)*this.stepMillisecond);if(this.ogcFilterTimeService.stepIsYearDuration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter))){const o=ny.duration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter)).years();t=ny(this.beginMillisecond).add((e-1)*o,"year").toDate()}else if(this.ogcFilterTimeService.stepIsMonthDuration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter))){const o=ny.duration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter)).months();t=ny(this.beginMillisecond).add((e-1)*o,"month").toDate()}return ny(t).format(this.displayFormat)}playFilter(e){this.interval?this.stopFilter():(this.playIcon="pause-circle",this.interval=setInterval(e=>{if(this.slider.value<this.calculatedStep){const e="_emitInputEvent";this.slider._increment(1),this.slider[e]()}else this.stopFilter()},this.sliderInterval,this))}stopFilter(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.playIcon="play-circle"}resetFilter(e){this.interval&&clearInterval(this.interval),this.interval=void 0,this.playIcon="play-circle",this.slider.value=1,this.slider._emitInputEvent()}handleSliderInput(e){if(e)if(this.ogcFilterTimeService.stepIsYearDuration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter))){const t=ny.duration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter)).years(),o=ny(this.beginMillisecond).add((e.value-1)*t,"year").toDate(),i=ny(o).add(t,"year").toDate();this.changeProperty.next({value:ny(o).toDate().toISOString(),pos:1,refreshFilter:!1}),this.changeProperty.next({value:ny(i).toDate().toISOString(),pos:2,refreshFilter:!0})}else if(this.ogcFilterTimeService.stepIsMonthDuration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter))){const t=ny.duration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter)).months(),o=ny(this.beginMillisecond).add((e.value-1)*t,"month").toDate(),i=ny(o).add(t,"month").toDate();this.changeProperty.next({value:ny(o).startOf("month").toDate().toISOString(),pos:1,refreshFilter:!1}),this.changeProperty.next({value:ny(i).toDate().toISOString(),pos:2,refreshFilter:!0})}else if(this.ogcFilterTimeService.stepIsDayDuration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter))||this.ogcFilterTimeService.stepIsHourDuration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter))||this.ogcFilterTimeService.stepIsMinuteDuration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter))){const t=new Date(this.beginMillisecond+this.stepMillisecond*(e.value-1));this.changeProperty.next({value:t.toISOString(),pos:1,refreshFilter:!1}),this.changeProperty.next({value:new Date(this.ogcFilterTimeService.addStep(t.toISOString(),this.stepMillisecond)).toISOString(),pos:2,refreshFilter:!0})}}calculateStep(){for(let e=1;this.maxMillisecond-(this.beginMillisecond+e*this.stepMillisecond)>=-1;e++)this.calculatedStep=e}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Pm))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-ogc-filter-time-slider"]],viewQuery:function(e,t){if(1&e&&r.Gf(Wa.pH,5),2&e){let e;r.iGM(e=r.CRH())&&(t.slider=e.first)}},inputs:{currentFilter:"currentFilter",begin:"begin",max:"max",datasource:"datasource"},outputs:{changeProperty:"changeProperty"},decls:6,vars:7,consts:[[1,"slider-container"],["id","time-slider","thumbLabel","",3,"step","min","max","ngModel","displayWith","ngModelChange","input"],["mat-icon-button","","color","primary",3,"click"],[3,"svgIcon"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"mat-slider",1),r.NdJ("ngModelChange",function(e){return t.sliderValue=e})("input",function(e){return t.handleSliderInput(e)}),r.qZA(),r.TgZ(2,"button",2),r.NdJ("click",function(e){return t.playFilter(e)}),r._UZ(3,"mat-icon",3),r.qZA(),r.TgZ(4,"button",2),r.NdJ("click",function(e){return t.resetFilter(e)}),r._UZ(5,"mat-icon",3),r.qZA(),r.qZA()),2&e&&(r.xp6(1),r.Q6J("step",1)("min",1)("max",t.calculatedStep)("ngModel",t.sliderValue)("displayWith",t.sliderDisplayWith),r.xp6(2),r.Q6J("svgIcon",t.playIcon),r.xp6(2),r.s9C("svgIcon",t.resetIcon))},directives:[Wa.pH,We.JJ,We.On,n.lW,a.Hw],styles:["input{text-align:center!important;margin:auto 5px!important}  .mat-slider-thumb{transform:scale(0)!important}  .mat-slider-thumb-label{transform:rotate(45deg)!important;border-radius:50% 50% 0!important;background-color:#ffd740!important}  .mat-slider-thumb-label-text{opacity:1!important;transform:rotate(135deg)!important}  .mat-slider-horizontal .mat-slider-thumb-label{top:10px!important;transform:rotate(225deg)!important}  .mat-slider-horizontal.cdk-focused .mat-slider-thumb-label{transform:rotate(225deg)!important}.datetime-container[_ngcontent-%COMP%]{text-align:center}.slider-container[_ngcontent-%COMP%]{text-align:center}.datetime-input[_ngcontent-%COMP%]{display:inline-block;margin:5px 25px}.date-input[_ngcontent-%COMP%]{width:120px;margin-right:25px}.time-input[_ngcontent-%COMP%]{display:inherit;margin-right:25px}.hour-input[_ngcontent-%COMP%], .minute-input[_ngcontent-%COMP%]{width:40px}.minute-input[_ngcontent-%COMP%]{margin-left:10px}"]}),e})(),ly=(()=>{class e{static forRoot(){return{ngModule:e,providers:[{provide:Re.Ad,useValue:"fr-FR"}]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[_d,$d,Pm,Ed],imports:[[h.ez,We.u5,We.UX,Xa.Bb,a.Ps,n.ot,cl.Nh,ll.Fk,f.Tx,Ue.p0,ul.dp,Ka.vV,m.p9,Wa.KP,Va.rP,De.lN,Ve.c,Re.Ng,Ee.LD,l.ie,p.AV,al.FA,Re.XK,pl.ni,pl.IZ,ne,md,Uo,Ri,_i,hg,Ye.g]]}),e})();r.B6R(yg,[h.O5,n.lW,p.gM,a.Hw,Ye.k,qg,$i],[j.X$]),r.B6R(qg,[h.O5,l.Tg,a.Hw,l.eA,Do,Re.X2,h.PC,n.lW,p.gM,h.mk,hp,Mg],[j.X$,h.Ov]),r.B6R(Eg,[Ei,h.sg,qg,$i],[Pd]),r.B6R(pm,[m.oG,p.gM,De.KE,h.mk,Ee.gD,Re.ey,h.O5,Ve.Nt,Xa.ZL,Xa.XC,h.sg,n.lW,De.R9,a.Hw,sy],[j.X$,h.Ov,Pi]),r.B6R(Im,[h.O5,n.lW,p.gM,a.Hw,Ye.k,Am,$i],[j.X$]),r.B6R(yf,[We._Y,We.JL,We.sg,h.sg,h.O5,Ha.d,De.KE,Ee.gD,We.JJ,We.u,p.gM,Re.ey,Ka.A9,Ka.Yi,h.PC,m.oG,ll.VQ,ll.U0,a.Hw,We.oH,We.On,sy],[j.X$]),r.B6R(mm,[h.O5,yf,$i,h.sg,pm],[]),r.B6R(Am,[l.Tg,h.O5,a.Hw,l.eA,Do,Re.X2,h.PC,p.gM,n.lW,h.mk,hp,mm,Ha.d,m.oG,We.JJ,We.On],[j.X$,h.Ov]),r.B6R(Zm,[Ei,h.sg,Am,$i],[Pd]),r.B6R(bf,[cl.SP,cl.uX,De.KE,De.hX,Ee.gD,h.sg,Re.ey,Sf,Ka.A9,Ka.Yi,p.gM,a.Hw],[j.X$]),r.B6R(Rf,[pg,We.JJ,We.oH,h.O5,Va.Rr,We._Y,We.JL,We.F,De.KE,We.wV,Ve.Nt,We.Fj,Ee.gD,h.sg,Re.ey,De.hX,ll.VQ,ll.U0,Ue.BZ,Ue.w1,Ue.fO,Ue.ge,m.oG,Ue.as,Ue.XQ,Ue.nj,Ue.Gk,ul.gi,ul.fQ,ul.uo,ul.eu,n.lW,ul.GZ,a.Hw,ul.Ar],[h.Ov,j.X$]),r.B6R(sy,[h.O5,Va.Rr,We.JJ,We.On,ay,De.KE,De.hX,Ve.Nt,al.nW,De.R9,al.Mq,al.hl,Ee.gD,We.oH,h.sg,Re.ey],[j.X$]);class cy extends Error{}class uy extends cy{constructor(){super("Invalid file"),Object.setPrototypeOf(this,uy.prototype)}}class py extends cy{constructor(){super("Nothing to export"),Object.setPrototypeOf(this,py.prototype)}}const dy=R(["URL","GeoJSON","GML","GPX","KML","Shapefile","CSVcomma","CSVsemicolon"]),hy=R(["UTF8","LATIN1"]);let gy=(()=>{class e{constructor(e){this.config=e,this.aggregateInComment=!0,this.ogreUrl=this.config.getConfig("importExport.url");const t=this.config.getConfig("importExport.gpxAggregateInComment");void 0!==t&&(this.aggregateInComment=t)}export(e,t,o,i,r="EPSG:4326",s="EPSG:4326"){const n=this.generateFeature(e,t);return this.exportAsync(n,t,o,i,r,s)}generateFeature(e,t){return t===dy.GPX&&this.aggregateInComment?this.generateAggregatedFeature(e):e.map(e=>{const t=e.getKeys().filter(e=>!e.startsWith("_")).reduce((t,o)=>(t[o]=e.get(o),t),{geometry:e.getGeometry()});return new Fn.Z(t)})}generateAggregatedFeature(e){return e.map(e=>{const t=e.getKeys().filter(e=>!e.startsWith("_"));let o="";const i=t.reduce((t,i)=>(i&&"geometry"!==i&&("id"===i&&e.get("draw")?o+=i+":"+e.get("draw")+"   \r\n":o+=i+":"+e.get(i)+"   \r\n"),t[i]=e.get(i),t),{geometry:e.getGeometry()}),r=new Fn.Z(i);return r.set("name",e.getId()),r.set("cmt",o),r})}exportAsync(t,o,i,r,s,n){return new Le.y(a=>{if(this.nothingToExport(t,o))a.error(new py);else if(Object.keys(e.ogreFormats).indexOf(o)>=0){if(!this.ogreUrl)return void(e.noOgreFallbacks.indexOf(o)>=0?this.exportToFile(t,a,o,i,s,n):a.error(new uy));this.exportWithOgre(t,a,o,i,r,s,n)}else this.exportToFile(t,a,o,i,s,n)})}exportToFile(e,t,o,i,r,s){(function(e,t,o){!function(e,t){const o=document.createElement("a");o.setAttribute("href",e),o.setAttribute("download",t),o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o)}(`data:${t},${encodeURIComponent(e)}`,o)})((new pa[o]).writeFeatures(e,{dataProjection:s,featureProjection:r,featureType:"feature",featureNS:"http://example.com/feature"}),"text/plain;charset=utf-8",`${i}.${o.toLowerCase()}`),t.complete()}exportWithOgre(t,o,i,r,s,n,a){const l=(new Xn.Z).writeFeatures(t,{dataProjection:a,featureProjection:n}),c=`${this.ogreUrl}/convertJson`,u=document.createElement("form");if(u.style.display="none",document.body.appendChild(u),u.setAttribute("method","post"),u.setAttribute("target","_blank"),u.setAttribute("action",c),s===hy.UTF8)u.acceptCharset="UTF-8",u.enctype="application/x-www-form-urlencoded; charset=utf-8;";else if(s===hy.LATIN1){const e="ISO-8859-1",t=document.createElement("input");t.setAttribute("type","hidden"),t.setAttribute("name","encoding"),t.setAttribute("value",e),u.appendChild(t)}if("CSVsemicolon"===i){const e=document.createElement("input");e.setAttribute("type","hidden"),e.setAttribute("name","lco"),e.setAttribute("value","SEPARATOR=SEMICOLON"),u.appendChild(e)}const p=document.createElement("input");p.setAttribute("type","hidden"),p.setAttribute("name","json"),p.setAttribute("value",l),u.appendChild(p);const d=document.createElement("input");let h="Shapefile"===i?`${r}.zip`:`${r}.${i.toLowerCase()}`;("CSVcomma"===i||"CSVsemicolon"===i)&&(h=`${r}.csv`),h=h.replace(" ","_"),h=h.normalize("NFD").replace(/[\u0300-\u036f]/g,""),d.setAttribute("type","hidden"),d.setAttribute("name","outputName"),d.setAttribute("value",h),u.appendChild(d);let g=e.ogreFormats[i];("CSVcomma"===i||"CSVsemicolon"===i)&&(g="CSV");const m=document.createElement("input");m.setAttribute("type","hidden"),m.setAttribute("name","format"),m.setAttribute("value",g),u.appendChild(m),u.submit(),document.body.removeChild(u),o.complete()}nothingToExport(e,t){return 0===e.length||"GPX"===t&&void 0===e.find(e=>["Point","LineString","MultiLineString"].indexOf(e.getGeometry().getType())>=0)}}return e.ogreFormats={GML:"gml",GPX:"gpx",KML:"kml",Shapefile:"ESRI Shapefile",CSVcomma:"CSVcomma",CSVsemicolon:"CSVsemicolon"},e.noOgreFallbacks=["GML","GPX","KML"],e.\u0275fac=function(t){return new(t||e)(r.LFG(W))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function my(e,t,o,i,r,s,n){if(0===t.length)return void function(e,t,o){const i=o.translate,r=i.instant("igo.geo.dropGeoFile.empty.title"),s=i.instant("igo.geo.dropGeoFile.empty.text",{value:e.name,mimeType:e.type});t.error(s,r)}(e,i,r);const a=Sy(e);s?function(e,t,o,i,r){const s=e.map(e=>Rc(e,t.projection));let n,a,l;if(i.getStyleList(o.toString()+".styleByAttribute")){const e=i.getStyleList(o.toString()+".styleByAttribute");n=t=>r.createStyleByAttribute(t,e)}else if(i.getStyleList(o.toString()+".clusterStyle")){const e=i.getStyleList(o.toString()+".clusterParam");a=i.getStyleList(o.toString()+".distance");const t=r.createStyle(i.getStyleList(o.toString()+".clusterStyle"));n=o=>r.createClusterStyle(o,e,t)}else if(i.getStyleList(o.toString()+".style"))n=r.createStyle(i.getStyleList(o.toString()+".style"));else if(i.getStyleList("default.clusterStyle")&&"Point"===e[0].geometry.type){const e=i.getStyleList("default.clusterParam");a=i.getStyleList("default.distance");const t=r.createStyle(i.getStyleList("default.clusterStyle"));n=o=>r.createClusterStyle(o,e,t)}else n=r.createStyle(i.getStyleList("default.style"));i.getStyleList(o.toString()+".clusterStyle")?(l=new ac({distance:a,type:"cluster",queryable:!0}),l.ol.source.addFeatures(s)):i.getStyleList(o.toString())?(l=new nc({type:"vector",queryable:!0}),l.ol.addFeatures(s)):i.getStyleList("default.clusterStyle")&&"Point"===e[0].geometry.type?(l=new ac({distance:a,type:"cluster",queryable:!0}),l.ol.source.addFeatures(s)):(l=new nc({type:"vector",queryable:!0}),l.ol.addFeatures(s));const c=new fc({title:o,source:l,style:n});t.addLayer(c),Jc(t,s)}(t,o,a,s,n):function(e,t,o){const i=e.map(e=>Rc(e,t.projection)),r=Math.floor(255*Math.random()),s=Math.floor(255*Math.random()),n=Math.floor(255*Math.random()),a=new jn.Z({color:[r,s,n,1],width:2}),l=new Jn.Z({color:[r,s,n,.4]}),c=new nc({type:"vector",queryable:!0});c.ol.addFeatures(i);const u=new fc({title:o,source:c,style:new Un.ZP({stroke:a,fill:l,image:new Qn.Z({radius:5,stroke:a,fill:l})})});t.addLayer(u),Jc(t,i)}(t,o,a);const l=r.translate,c=l.instant("igo.geo.dropGeoFile.success.title"),u=l.instant("igo.geo.dropGeoFile.success.text",{value:a});i.success(u,c)}function fy(e,t,o,i){const r=i.translate,s=r.instant("igo.geo.dropGeoFile.invalid.title"),n=r.instant("igo.geo.dropGeoFile.invalid.text",{value:e.name,mimeType:e.type});o.error(n,s)}function yy(e,t,o,i){const r=i.translate,s=r.instant("igo.geo.dropGeoFile.unreadable.title"),n=r.instant("igo.geo.dropGeoFile.unreadable.text",{value:e.name});o.error(n,s)}function vy(e,t,o,i,r){const s=i.translate,n=s.instant("igo.geo.dropGeoFile.tooLarge.title"),a=s.instant("igo.geo.dropGeoFile.tooLarge.text",{value:e.name,size:r});o.error(a,n)}function by(e,t,o){const i=o.translate,r=i.instant("igo.geo.dropGeoFile.invalidSRS.title"),s=i.instant("igo.geo.dropGeoFile.invalidSRS.text",{value:e.name,mimeType:e.type});t.error(s,r)}function xy(e,t,o,i){const r=i.translate.instant("igo.geo.dropGeoFile.ogreServer.title"),s=i.translate.instant("igo.geo.dropGeoFile.ogreServer.text");o.error(s,r)}function wy(e){return e.name.split(".").pop().toLowerCase()}function Sy(e){return e.name.substr(0,e.name.lastIndexOf("."))}class Cy extends Error{}class Ty extends Cy{constructor(){super("Invalid file"),Object.setPrototypeOf(this,Ty.prototype)}}class Ay extends Cy{constructor(){super("Failed to read file"),Object.setPrototypeOf(this,Ay.prototype)}}class Ly extends Cy{constructor(){super("Nothing to import"),Object.setPrototypeOf(this,Ly.prototype)}}class Zy extends Cy{constructor(){super("File is too large"),Object.setPrototypeOf(this,Ly.prototype)}}class Fy extends Cy{constructor(){super("Invalid SRS definition"),Object.setPrototypeOf(this,Ly.prototype)}}class Oy extends Cy{constructor(){super("Error 500 with OGRE"),Object.setPrototypeOf(this,Oy.prototype)}}let My=(()=>{class e{constructor(e,t){this.http=e,this.config=t,this.ogreUrl=this.config.getConfig("importExport.url");const o=this.config.getConfig("importExport.clientSideFileSizeMaxMb");this.clientSideFileSizeMax=(o||30)*Math.pow(1024,2)}import(e,t="EPSG:4326",o="EPSG:4326"){return this.importAsync(e,t,o)}getFileImporter(t){const o=wy(t),i=t.type,r=[...e.allowedMimeTypes,...e.allowedZipMimeTypes],s=e.allowedExtensions;if(!(r.indexOf(i)<0&&s.indexOf(o)<0)){if("application/json"===i||["json","geojson","kml","gpx"].indexOf(o)>=0)return this.importFile;if(void 0!==this.ogreUrl)return this.importFileWithOgre}}importAsync(e,t,o){return new Le.y(i=>{if(e.size>=this.clientSideFileSizeMax)return void i.error(new Zy);const r=this.getFileImporter(e);void 0!==r?r.call(this,e,i,t,o):i.error(new Ty)})}importFile(e,t,o,i){const r=new FileReader;r.onload=r=>{try{const s=this.parseFeaturesFromFile(e,r.target.result,o,i);t.next(s)}catch(s){t.error(new Ay)}t.complete()},r.onerror=e=>{t.error(new Ay)},r.readAsText(e,"UTF-8")}importFileWithOgre(e,t,o,i){const r=`${this.ogreUrl}/convert`,s=new FormData;s.append("upload",e),s.append("sourceSrs",o),s.append("targetSrs",i),s.append("formatOutput","GEOJSON"),s.append("skipFailures",""),this.http.post(r,s,{headers:new y.WM}).subscribe(o=>{if(null!==o)if((o.errors||[]).length>0)t.error(new Ay);else{const r=this.parseFeaturesFromGeoJSON(e,o,i);t.next(r),t.complete()}else t.error(new Ay)},e=>{e.error.caught=!0;const o=e.error.msg||"";"No valid files found"===o?t.error(new Ty):o&&o.startWith("ERROR 1: Failed to process SRS definition")?t.error(new Fy):t.error(500===e.status?new Oy:new Ay)})}parseFeaturesFromFile(e,t,o,i){const r=wy(e),s=e.type,n=new Xn.Z;let a;if("application/vnd.google-earth.kml+xml"===s)a=new ma.ZP;else if("application/gml+xml"===s)a=new ya.Z;else if("application/gpx+xml"===s)a=new ga.Z;else switch(r){case"kml":a=new ma.ZP;break;case"gpx":a=new ga.Z;break;case"gml":a=new ya.Z;break;default:a=n}return a.readFeatures(t,{dataProjection:o,featureProjection:i}).map(t=>Object.assign(n.writeFeatureObject(t),{projection:i,meta:{id:N(),title:Sy(e)}}))}parseFeaturesFromGeoJSON(e,t,o){const i=new Xn.Z;return i.readFeatures(t).map(t=>Object.assign(i.writeFeatureObject(t),{projection:o,meta:{id:N(),title:Sy(e)}}))}}return e.allowedMimeTypes=["application/gml+xml","application/vnd.google-earth.kml+xml","application/gpx+xml","application/json"],e.allowedZipMimeTypes=["application/zip","application/x-zip-compressed","application/x-zip"],e.allowedExtensions=["geojson","kml","gpx","json","gml"],e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(W))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Iy=(()=>{class e{constructor(e){this.injector=e,this.styleList={}}getStyleList(e){return D.resolve(this.styleList,e)}load(e){const t=e.default||{};if(!e.path)return this.styleList=t,!0;const o=this.injector.get(y.eN);return new Promise((i,r)=>{o.get(e.path).pipe((0,b.K)(t=>(console.log(`StyleList file ${e.path} could not be read`),i(!0),(0,T._)(t.error||"Server error")))).subscribe(e=>{this.styleList=D.mergeDeep(t,e),i(!0)})})}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(r.zs3))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function ky(e,t){if(1&e&&(r.TgZ(0,"p",16),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=r.oxw().$implicit;r.xp6(1),r.Oqu(r.xi3(2,1,"igo.geo.importExportForm.projections."+e.translateKey,e))}}function Py(e,t){if(1&e&&(r.TgZ(0,"p",16),r._uU(1),r.qZA()),2&e){const e=r.oxw().$implicit;r.xp6(1),r.Oqu(e.alias)}}function _y(e,t){if(1&e&&(r.TgZ(0,"mat-option",14),r.NdJ("click",function(e){return e.stopPropagation()}),r.YNc(1,ky,3,4,"p",15),r.YNc(2,Py,2,1,"p",15),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.Q6J("ngIf",e.translateKey),r.xp6(1),r.Q6J("ngIf",!e.translateKey)}}function $y(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"form",5),r.TgZ(1,"div",6),r.TgZ(2,"mat-form-field"),r.TgZ(3,"mat-label"),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.TgZ(6,"mat-select",7),r.NdJ("valueChange",function(t){return r.CHM(e),r.oxw().inputProj=t}),r.YNc(7,_y,3,3,"mat-option",8),r.ALo(8,"async"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(9,"div",9),r.ALo(10,"translate"),r.ALo(11,"translate"),r.TgZ(12,"button",10),r.NdJ("click",function(){return r.CHM(e),r.MAs(19).click()}),r.ALo(13,"async"),r._uU(14),r.ALo(15,"translate"),r.qZA(),r._UZ(16,"igo-spinner",11),r.ALo(17,"async"),r.TgZ(18,"input",12,13),r.NdJ("click",function(){return r.CHM(e),r.MAs(19).value=null})("change",function(t){return r.CHM(e),r.oxw().importFiles(t.target.files)}),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("formGroup",e.importForm),r.xp6(4),r.Oqu(r.lcZ(5,10,"igo.geo.importExportForm.importProjPlaceholder")),r.xp6(2),r.Q6J("value",e.inputProj),r.xp6(1),r.Q6J("ngForOf",r.lcZ(8,12,e.projections$)),r.xp6(2),r.Q6J("matTooltip",e.importForm.invalid?r.lcZ(10,14,"igo.geo.importExportForm.projections.choose"):r.lcZ(11,16,"igo.geo.importExportForm.importButton")),r.xp6(3),r.Q6J("disabled",e.importForm.invalid||r.lcZ(13,18,e.loading$)),r.xp6(2),r.hij(" ",r.lcZ(15,20,"igo.geo.importExportForm.importButton")," "),r.xp6(2),r.Q6J("shown",r.lcZ(17,22,e.loading$)),r.xp6(2),r.Udp("display","none")}}const qy=function(e){return{size:e}};function Dy(e,t){if(1&e&&(r.TgZ(0,"section",17),r.TgZ(1,"h4"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"ul"),r.TgZ(5,"li"),r._uU(6),r.ALo(7,"translate"),r.qZA(),r.TgZ(8,"li"),r._uU(9),r.ALo(10,"translate"),r.qZA(),r.TgZ(11,"li"),r._uU(12),r.ALo(13,"translate"),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(2),r.Oqu(r.lcZ(3,4,"igo.geo.importExportForm.importClarifications")),r.xp6(4),r.Oqu(r.xi3(7,6,"igo.geo.importExportForm.importSizeMax",r.VKq(13,qy,e.fileSizeMb))),r.xp6(3),r.Oqu(r.lcZ(10,9,"igo.geo.importExportForm.importFormatAuthorized")),r.xp6(3),r.Oqu(r.lcZ(13,11,"igo.geo.importExportForm.importShpZip"))}}function Ey(e,t){1&e&&(r.TgZ(0,"section",17),r.TgZ(1,"h4"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.qZA()),2&e&&(r.xp6(2),r.Oqu(r.lcZ(3,1,"igo.geo.importExportForm.exportNoLayersExportable")))}function Ry(e,t){if(1&e&&(r.TgZ(0,"span",27),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.AsE(" (+",e.layers.length-1," ",r.lcZ(2,2,2===(null==e.layers?null:e.layers.length)?"igo.geo.importExportForm.other":"igo.geo.importExportForm.others"),") ")}}function Uy(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-slide-toggle",30),r.NdJ("click",function(t){r.CHM(e);const o=r.oxw().$implicit;return r.oxw(2).onlySelectedClick(t,o.id)})("checked",function(){r.CHM(e);const t=r.oxw().$implicit;return r.oxw(2).inLayersIdToExportSelectionOnly(t)})("change",function(t){r.CHM(e);const o=r.oxw().$implicit;return r.oxw(2).onlySelected(t,o.id)}),r.TgZ(1,"small"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.qZA()}2&e&&(r.Q6J("labelPosition","after"),r.xp6(2),r.Oqu(r.lcZ(3,2,"igo.geo.importExportForm.exportSelectedFeature")))}const Ny=function(e){return{"igo-export-layer-mat-option":e}};function Jy(e,t){if(1&e&&(r.TgZ(0,"mat-option",28),r.NdJ("click",function(e){return e.stopPropagation()}),r.TgZ(1,"p",16),r._uU(2),r.qZA(),r.TgZ(3,"p",16),r.YNc(4,Uy,4,4,"mat-slide-toggle",29),r.qZA(),r.qZA()),2&e){const e=t.$implicit,o=r.oxw(2);r.Q6J("ngClass",r.VKq(4,Ny,o.layerHasSelectedFeatures(e)))("value",e.id),r.xp6(2),r.Oqu(e.title),r.xp6(2),r.Q6J("ngIf",o.layerHasSelectedFeatures(e))}}function By(e,t){if(1&e&&(r.TgZ(0,"mat-option",2),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.key),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.export.format."+e.value)," ")}}function jy(e,t){if(1&e&&(r.ynx(0),r.YNc(1,By,3,4,"mat-option",31),r.ALo(2,"keyvalue"),r.ALo(3,"async"),r.BQk()),2&e){const e=r.oxw(2);r.xp6(1),r.Q6J("ngForOf",r.lcZ(2,1,r.lcZ(3,3,e.formats$)))}}function Qy(e,t){1&e&&(r.TgZ(0,"mat-option",32),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"igo.geo.export.noFormat.title")," "))}function Gy(e,t){1&e&&(r.TgZ(0,"div",6),r.TgZ(1,"mat-form-field"),r._UZ(2,"input",33),r.ALo(3,"translate"),r.qZA(),r.qZA()),2&e&&(r.xp6(2),r.s9C("placeholder",r.lcZ(3,1,"igo.geo.importExportForm.exportFileNamePlaceholder")))}function Yy(e,t){if(1&e&&(r.TgZ(0,"mat-option",2),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.key),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.export.encoding."+e.value)," ")}}function zy(e,t){if(1&e&&(r.ynx(0),r.YNc(1,Yy,3,4,"mat-option",31),r.ALo(2,"keyvalue"),r.ALo(3,"async"),r.BQk()),2&e){const e=r.oxw(3);r.xp6(1),r.Q6J("ngForOf",r.lcZ(2,1,r.lcZ(3,3,e.encodings$)))}}function Hy(e,t){if(1&e&&(r.TgZ(0,"div",6),r.TgZ(1,"mat-form-field"),r.TgZ(2,"mat-label"),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.TgZ(5,"mat-select",34),r.YNc(6,zy,4,5,"ng-container",22),r.ALo(7,"async"),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.oxw(2);r.xp6(3),r.Oqu(r.lcZ(4,2,"igo.geo.importExportForm.encodingPlaceholder")),r.xp6(3),r.Q6J("ngIf",0!==r.lcZ(7,4,e.encodings$).length)}}function Vy(e,t){1&e&&(r.TgZ(0,"div",35),r.TgZ(1,"mat-slide-toggle",36),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.qZA()),2&e&&(r.xp6(1),r.Q6J("labelPosition","before"),r.xp6(1),r.hij(" ",r.lcZ(3,2,"igo.geo.importExportForm.exportFeatureInExtent")," "))}function Wy(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"form",5),r.TgZ(1,"div",6),r.TgZ(2,"mat-form-field"),r.TgZ(3,"mat-label"),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.TgZ(6,"mat-select",18),r.NdJ("valueChange",function(t){return r.CHM(e),r.oxw().layers=t}),r.TgZ(7,"mat-select-trigger"),r._uU(8),r.YNc(9,Ry,3,4,"span",19),r.qZA(),r.YNc(10,Jy,5,6,"mat-option",20),r.ALo(11,"async"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(12,"div",6),r.TgZ(13,"mat-form-field"),r.TgZ(14,"mat-label"),r._uU(15),r.ALo(16,"translate"),r.qZA(),r.TgZ(17,"mat-select",21),r.YNc(18,jy,4,5,"ng-container",22),r.ALo(19,"async"),r.YNc(20,Qy,3,3,"mat-option",23),r.ALo(21,"async"),r.qZA(),r.qZA(),r.qZA(),r.YNc(22,Gy,4,3,"div",24),r.YNc(23,Hy,8,6,"div",24),r.YNc(24,Vy,4,4,"div",25),r.TgZ(25,"div",26),r.TgZ(26,"button",10),r.NdJ("click",function(){r.CHM(e);const t=r.oxw();return t.handleExportFormSubmit(t.form.value)}),r.ALo(27,"async"),r._uU(28),r.ALo(29,"translate"),r.ALo(30,"translate"),r.ALo(31,"translate"),r.qZA(),r._UZ(32,"igo-spinner",11),r.ALo(33,"async"),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("formGroup",e.form),r.xp6(4),r.Oqu(r.lcZ(5,15,"igo.geo.importExportForm.exportLayerPlaceholder")),r.xp6(2),r.Q6J("value",e.layers),r.xp6(2),r.hij(" ",e.layers.length?e.getLayerTitleById(e.layers[0]):""," "),r.xp6(1),r.Q6J("ngIf",e.layers.length>1),r.xp6(1),r.Q6J("ngForOf",r.lcZ(11,17,e.exportableLayers$)),r.xp6(5),r.Oqu(r.lcZ(16,19,"igo.geo.importExportForm.exportFormatPlaceholder")),r.xp6(3),r.Q6J("ngIf",0!==r.lcZ(19,21,e.formats$).length),r.xp6(2),r.Q6J("ngIf",0===r.lcZ(21,23,e.formats$).length),r.xp6(2),r.Q6J("ngIf",e.forceNaming&&"URL"!==e.form.value.format),r.xp6(1),r.Q6J("ngIf","CSVcomma"===e.form.value.format||"CSVsemicolon"===e.form.value.format),r.xp6(1),r.Q6J("ngIf","URL"!==e.form.value.format),r.xp6(2),r.Q6J("disabled",!e.form.valid||r.lcZ(27,25,e.loading$)),r.xp6(2),r.hij(" ","URL"!==e.form.value.format?r.lcZ(29,27,"igo.geo.importExportForm.exportButton"):e.form.value.layers.length>1?r.lcZ(30,29,"igo.geo.importExportForm.exportButtonLinks"):r.lcZ(31,31,"igo.geo.importExportForm.exportButtonLink")," "),r.xp6(4),r.Q6J("shown",r.lcZ(33,33,e.loading$))}}let Xy=(()=>{class e{constructor(e,t,o,i,s,n,a,l,c,u,p){this.importService=e,this.exportService=t,this.languageService=o,this.messageService=i,this.styleListService=s,this.styleService=n,this.formBuilder=a,this.config=l,this.cdRef=c,this.storageService=u,this.downloadService=p,this.formats$=new C.X(void 0),this.encodings$=new C.X(void 0),this.exportableLayers$=new C.X([]),this.loading$=new C.X(!1),this.forceNaming=!1,this.controlFormat="format",this.espgCodeRegex=new RegExp("^\\d{4,6}"),this.projections$=new C.X([]),this.popupChecked=!1,this.previousLayerSpecs$=new C.X(void 0),this.selectFirstProj=!1,this._projectionsLimitations={},this.selectedMode="import",this.selectMode=new r.vpe,this.exportOptions$=new C.X(void 0),this.exportOptionsChange=new r.vpe,this.loadConfig(),this.buildForm(),this.computeProjections()}set projectionsLimitations(e){this._projectionsLimitations=e,this.computeProjections()}get projectionsLimitations(){return this._projectionsLimitations||{}}get layers(){return this.form.get("layers").value}set layers(e){this.form.patchValue({layers:e})}get inputProj(){return this.importForm.get("inputProj").value}set inputProj(e){this.importForm.patchValue({inputProj:e})}get popupAllowed(){return this.storageService.get("importExportPopupAllowed")||!1}set popupAllowed(e){this.storageService.set("importExportPopupAllowed",e)}ngOnInit(){this.layers$$=this.map.layers$.subscribe(e=>{this.exportableLayers$.next(e.filter(e=>e instanceof fc&&!0===e.exportable||e.dataSource.options.download&&e.dataSource.options.download.url))});const e=this.config.getConfig("importExport.clientSideFileSizeMaxMb");this.clientSideFileSizeMax=(e||30)*Math.pow(1024,2),this.fileSizeMb=this.clientSideFileSizeMax/Math.pow(1024,2),this.exportOptions$$=this.exportOptions$.pipe((0,Tn.n)(e=>!e)).subscribe(e=>{this.form.patchValue(e,{emitEvent:!0}),e.layers&&this.computeFormats(e.layers.map(e=>this.map.getLayerById(e)))}),this.formLayer$$=this.form.get("format").valueChanges.subscribe(e=>{var t;const o=Object.keys(gy.ogreFormats);!this.popupChecked&&(null===(t=this.form.get("layers").value)||void 0===t?void 0:t.length)>1&&(o.indexOf(e)>=0||e===dy.URL)&&(this.handlePopup(!0)||this.form.patchValue({format:void 0},{emitEvent:!1}))}),this.formLayer$$=this.form.get("layers").valueChanges.subscribe(e=>{this.handlePreviousLayerSpecs();const t=e instanceof Array?e:[e];this.form.patchValue({layers:t},{emitEvent:!1});const o=t.map(e=>this.map.getLayerById(e));this.computeFormats(o),-1===Object.keys(this.formats$.value).indexOf(this.form.value.format)&&this.form.patchValue({format:void 0}),this.loading$.next(!0);const i=[];o.forEach(e=>{e instanceof fc&&0===e.dataSource.ol.getFeatures().length&&(i.push({id:e.id,visible:e.visible,opacity:e.opacity,queryable:e.queryable}),e.opacity=0,e.visible=!0)}),this.previousLayerSpecs$.next(i),setTimeout(()=>{this.loading$.next(!1)},500)}),this.formats$$=this.formats$.pipe((0,Tn.n)(e=>!e)).subscribe(e=>{1===Object.keys(e).length&&this.form.patchValue({format:e[Object.keys(e)[0]]})}),this.encodings$$=this.encodings$.pipe((0,Tn.n)(e=>!e)).subscribe(e=>{1===Object.keys(e).length&&this.form.patchValue({encoding:e[Object.keys(e)[0]]})}),this.exportableLayers$$=this.exportableLayers$.pipe((0,Tn.n)(e=>!e)).subscribe(e=>{1===e.length&&this.form.patchValue({layers:e[0].id})}),this.form.controls[this.controlFormat].valueChanges.subscribe(e=>{this.form.patchValue(e===dy.CSVcomma||e===dy.CSVsemicolon?{encoding:hy.LATIN1}:{encoding:hy.UTF8}),this.cdRef.detectChanges()}),this.importForm.patchValue(this.selectFirstProj?0===this.projections$.value.length?{inputProj:{translateKey:"nad83",alias:"NAD83",code:"EPSG:4326",zone:""}}:{inputProj:this.projections$.value[0]}:{inputProj:void 0})}computeProjections(){this.projectionsConstraints=function(e){const t=e.mtmZone,o=e.utmZone;return{projFromConfig:!1!==e.projFromConfig,nad83:!1!==e.nad83,wgs84:!1!==e.wgs84,webMercator:!1!==e.webMercator,utm:!1!==e.utm,mtm:!1!==e.mtm,utmZone:{minZone:o&&o.minZone?o.minZone:17,maxZone:o&&o.maxZone?o.maxZone:21},mtmZone:{minZone:t&&t.minZone?t.minZone:2,maxZone:t&&t.maxZone?t.maxZone:10}}}(this.projectionsLimitations);const e=[];if(this.projectionsConstraints.nad83&&e.push({translateKey:"nad83",alias:"NAD83",code:"EPSG:4269",zone:""}),this.projectionsConstraints.wgs84&&e.push({translateKey:"wgs84",alias:"WGS84",code:"EPSG:4326",zone:""}),this.projectionsConstraints.webMercator&&e.push({translateKey:"webMercator",alias:"Web Mercator",code:"EPSG:3857",zone:""}),this.projectionsConstraints.mtm){const t=this.projectionsConstraints.mtmZone.maxZone;for(let o=this.projectionsConstraints.mtmZone.minZone;o<=t;o++)e.push({translateKey:"mtm",alias:`MTM ${o}`,code:o<10?`EPSG:3218${o}`:`EPSG:321${80+o}`,zone:`${o}`})}if(this.projectionsConstraints.utm){const t=this.projectionsConstraints.utmZone.maxZone;for(let o=this.projectionsConstraints.utmZone.minZone;o<=t;o++)e.push({translateKey:"utm",alias:`UTM ${o}`,code:o<10?`EPSG:3260${o}`:`EPSG:326${o}`,zone:`${o}`})}let t=[];this.projectionsConstraints.projFromConfig&&(t=this.config.getConfig("projections")||[]),this.projections$.next(t.concat(e))}getWorkspaceByLayerId(e){const t=this.store.all().find(t=>t.layer.id===e);if(t)return t}getLayerTitleById(e){return this.map.getLayerById(e).title}layerHasSelectedFeatures(e){const t=this.getWorkspaceByLayerId(e.id);if(t)return!!t.entityStore.stateView.firstBy(e=>!0===e.state.selected)}onlySelected(e,t){let o=this.form.value.layersWithSelection;e.checked?o.push(t):o=o.filter(e=>e!==t),this.form.patchValue({layersWithSelection:o})}onlySelectedClick(e,t){this.form.value.layers.find(e=>e===t)&&e.stopPropagation()}inLayersIdToExportSelectionOnly(e){return!!this.form.value.layersWithSelection.find(t=>t===e.id)}ngOnDestroy(){this.layers$$.unsubscribe(),this.exportableLayers$$.unsubscribe(),this.formats$$.unsubscribe(),this.encodings$$.unsubscribe(),this.formLayer$$.unsubscribe(),this.exportOptions$$&&this.exportOptions$$.unsubscribe(),this.exportOptionsChange.emit(this.form.value),this.handlePreviousLayerSpecs()}handlePreviousLayerSpecs(){const e=this.previousLayerSpecs$.value;e&&e.length&&e.forEach(e=>{const t=this.map.getLayerById(e.id);t.visible=e.visible,t.opacity=e.opacity,t.queryable=e.queryable}),this.previousLayerSpecs$.next(void 0)}importFiles(e){let t=this.inputProj.code;this.espgCodeRegex.test(t)&&(t=`EPSG:${t}`),this.loading$.next(!0);for(const o of e)this.importService.import(o,t).subscribe(e=>this.onFileImportSuccess(o,e),e=>this.onFileImportError(o,e),()=>{this.loading$.next(!1)})}handlePopup(e=!0){window.open("","popup","width=1, height=1").close();const t=window.open("","popup","width=1, height=1");return!t||t.closed||void 0===t.closed||null===t?(this.onPopupBlockedError(e),this.popupAllowed=!1):(t.close(),this.popupAllowed=!0,this.popupChecked=!0),this.popupAllowed}handleExportFormSubmit(e){this.loading$.next(!0);const t=Object.keys(gy.ogreFormats);!this.popupChecked&&e.layers.length>1&&(t.indexOf(e.format)>=0||e.format===dy.URL)&&!this.popupAllowed&&this.handlePopup(),e.layers.forEach(t=>{const o=this.map.getLayerById(t);let i=o.title;void 0!==e.name&&(i=e.name);const r=o.dataSource.options;if(e.format===dy.URL&&r.download&&(r.download.url||r.download.dynamicUrl))return void setTimeout(()=>{const e=r.download.url||r.download.dynamicUrl;e.match(/service=wfs/gi)?this.downloadService.open(o):window.open(e,"_blank"),this.loading$.next(!1)},500);const s=this.getWorkspaceByLayerId(t);let n;if(s&&s.entityStore&&s.entityStore.stateView.all().length)n=-1!==e.layersWithSelection.indexOf(t)&&e.featureInMapExtent?s.entityStore.stateView.all().filter(e=>e.state.inMapExtent&&e.state.selected).map(e=>e.entity.ol):-1===e.layersWithSelection.indexOf(t)||e.featureInMapExtent?e.featureInMapExtent?s.entityStore.stateView.all().filter(e=>e.state.inMapExtent).map(e=>e.entity.ol):s.entityStore.stateView.all().map(e=>e.entity.ol):s.entityStore.stateView.all().filter(e=>e.state.selected).map(e=>e.entity.ol);else{const t=o.dataSource.ol;n=e.featureInMapExtent?t.getFeaturesInExtent(o.map.viewController.getExtent()):t.getFeatures(),o.dataSource instanceof ac&&(n=n.flatMap(e=>e.get("features")))}const a=this.languageService.translate;let l=[];if(e.format===dy.Shapefile||e.format===dy.GPX?n.forEach(e=>{const t=e.getGeometry().getType(),o=l.find(e=>e.geometryType===t);o?o.features.push(e):l.push({geometryType:t,features:[e]})}):l=[{geometryType:"",features:n}],l.forEach(e=>{e.features.forEach(e=>{const t=e.get("rad");if(t){const o=[e.get("longitude"),e.get("latitude")],i=(0,Vn.iu)(o,t,500);i.transform("EPSG:4326",e.get("_projection")),e.setGeometry(i)}})}),e.format===dy.GPX){const e=l.length;if(l=l.filter(e=>["LineString","Point"].includes(e.geometryType)),e>l.length){const e=a.instant("igo.geo.export.gpx.error.poly.title"),t=a.instant("igo.geo.export.gpx.error.poly.text");this.messageService.error(t,e,{timeOut:2e4})}}if(0===l.length){this.loading$.next(!1);const e=a.instant("igo.geo.export.nothing.title"),t=a.instant("igo.geo.export.nothing.text");this.messageService.error(t,e,{timeOut:2e4})}else l.map(t=>this.exportService.export(t.features,e.format,i+t.geometryType,e.encoding,this.map.projection).subscribe(()=>{},e=>this.onFileExportError(e),()=>{this.onFileExportSuccess(),t.features.forEach(e=>{if(e.get("rad")){const t=new _n.Z([e.get("longitude"),e.get("latitude")]);t.transform("EPSG:4326",e.get("_projection")),e.setGeometry(t)}}),this.loading$.next(!1)}))})}buildForm(){this.importForm=this.formBuilder.group({inputProj:["",[We.kI.required]]}),this.form=this.formBuilder.group(this.forceNaming?{format:["",[We.kI.required]],layers:[[],[We.kI.required]],layersWithSelection:[[]],encoding:[hy.UTF8,[We.kI.required]],featureInMapExtent:[!1,[We.kI.required]],name:["",[We.kI.required]]}:{format:["",[We.kI.required]],layers:[[],[We.kI.required]],layersWithSelection:[[]],encoding:[hy.UTF8,[We.kI.required]],featureInMapExtent:[!1,[We.kI.required]]})}onFileImportSuccess(e,t){this.config.getConfig("importWithStyle")?my(e,t,this.map,this.messageService,this.languageService,this.styleListService,this.styleService):my(e,t,this.map,this.messageService,this.languageService)}onFileImportError(e,t){this.loading$.next(!1),function(e,t,o,i,r){({"Invalid file":fy,"File is too large":vy,"Failed to read file":yy,"Invalid SRS definition":by,"Error 500 with OGRE":xy})[t.message](e,t,o,i,r=r||30)}(e,t,this.messageService,this.languageService,this.fileSizeMb)}onPopupBlockedError(e=!0){this.loading$.next(!1);const t=this.languageService.translate,o=t.instant("igo.geo.export.popupBlocked.title"),i=t.instant(e?"igo.geo.export.popupBlocked.selectAgain":"igo.geo.export.popupBlocked.retry"),r=t.instant("igo.geo.export.popupBlocked.text",{extraMessage:i});this.messageService.error(r,o,{timeOut:2e4})}onFileExportError(e){this.loading$.next(!1),function(e,t,o){if(e instanceof py)return void function(e,t){const o=t.translate,i=o.instant("igo.geo.export.nothing.title"),r=o.instant("igo.geo.export.nothing.text");e.error(r,i)}(t,o);const i=o.translate,r=i.instant("igo.geo.export.failed.title"),s=i.instant("igo.geo.export.failed.text");t.error(s,r)}(e,this.messageService,this.languageService)}loadConfig(){void 0!==this.config.getConfig("importExport.forceNaming")&&(this.forceNaming=this.config.getConfig("importExport.forceNaming")),this.computeFormats(),this.loadEncodings()}encodingDefaultValue(e){return e===dy.CSVcomma||e===dy.CSVsemicolon?(this.form.patchValue({encoding:hy.LATIN1}),hy.LATIN1):(this.form.patchValue({encoding:hy.UTF8}),hy.UTF8)}loadEncodings(){this.encodings$.next(hy)}computeFormats(e){let t=Object.keys(dy);const o={onlyUrl:!1,onlyVector:!1,vectorAndUrl:!1,customList:!1},i=[];if(e&&e.length)if(e.forEach(e=>{var t;!e||((null===(t=e.dataSource.options.download)||void 0===t?void 0:t.allowedFormats)?(o.customList=!0,i.push({layer:e.title,formats:this.validateListFormat(e.dataSource.options.download.allowedFormats)})):e instanceof fc||!e.dataSource.options.download||!e.dataSource.options.download.url?e.dataSource.options.download&&(e.dataSource.options.download.url||e.dataSource.options.download.dynamicUrl)?o.vectorAndUrl=!0:e instanceof fc&&(o.onlyVector=!0):o.onlyUrl=!0)}),!0===o.onlyUrl&&!1===o.onlyVector)t=["URL"];else if(!0===o.onlyVector&&!1===o.onlyUrl)this.computeFormats(),dy.URL in this.formats$.value&&(t=Object.keys(this.formats$.value).filter(e=>"URL"!==e));else if(!0===o.vectorAndUrl&&!1===o.onlyUrl&&!1===o.onlyVector&&(this.computeFormats(),!(dy.URL in this.formats$.value))){const e=Object.keys(this.formats$.value);e.push("URL"),t=e}if(void 0!==this.config.getConfig("importExport.formats")&&(t=this.validateListFormat(this.config.getConfig("importExport.formats"))),o.customList){let o;const r=[];let s=i[0].formats;i.map(e=>{r.push(e.layer),o=e.formats.filter(e=>s.includes(e)),s=e.formats});const n=o.filter(e=>t.includes(e));n.length>0?(this.formats$.next(R(n)),e&&e.length&&e.length>1&&this.messageService.alert(this.languageService.translate.instant("igo.geo.export.customList.text",{value:r.join()}),this.languageService.translate.instant("igo.geo.export.customList.title"))):(this.formats$.next([]),this.messageService.alert(this.languageService.translate.instant("igo.geo.export.noFormat.text"),this.languageService.translate.instant("igo.geo.export.noFormat.title")))}else this.formats$.next(R(t))}validateListFormat(e){return e.filter(e=>{if(e.toUpperCase()===dy.CSVcomma.toUpperCase()||e.toUpperCase()===dy.CSVsemicolon.toUpperCase()||e.toUpperCase()===dy.GML.toUpperCase()||e.toUpperCase()===dy.GPX.toUpperCase()||e.toUpperCase()===dy.GeoJSON.toUpperCase()||e.toUpperCase()===dy.KML.toUpperCase()||e.toUpperCase()===dy.Shapefile.toUpperCase()||e.toUpperCase()===dy.URL.toUpperCase())return e}).map(e=>e.toUpperCase()===dy.CSVcomma.toUpperCase()?e=dy.CSVcomma:e.toUpperCase()===dy.CSVsemicolon.toUpperCase()?e=dy.CSVsemicolon:e.toUpperCase()===dy.GML.toUpperCase()?e=dy.GML:e.toUpperCase()===dy.GPX.toUpperCase()?e=dy.GPX:e.toUpperCase()===dy.GeoJSON.toUpperCase()?e=dy.GeoJSON:e.toUpperCase()===dy.KML.toUpperCase()?e=dy.KML:e.toUpperCase()===dy.Shapefile.toUpperCase()?e=dy.Shapefile:e.toUpperCase()===dy.URL.toUpperCase()?e=dy.URL:void 0)}modeChanged(e){this.selectMode.emit(e)}onFileExportSuccess(){!function(e,t){const o=t.translate,i=o.instant("igo.geo.export.success.title"),r=o.instant("igo.geo.export.success.text");e.success(r,i)}(this.messageService,this.languageService)}onImportExportChange(e){this.selectedMode=e.value}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(My),r.Y36(gy),r.Y36(ue),r.Y36(de),r.Y36(Iy),r.Y36(eu),r.Y36(We.qu),r.Y36(W),r.Y36(r.sBO),r.Y36(Se),r.Y36(Rd))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-import-export"]],inputs:{selectFirstProj:"selectFirstProj",map:"map",projectionsLimitations:"projectionsLimitations",store:"store",selectedMode:"selectedMode",exportOptions$:"exportOptions$"},outputs:{selectMode:"selectMode",exportOptionsChange:"exportOptionsChange"},decls:14,vars:17,consts:[[1,"import-export-toggle","mat-typography"],[3,"value","change"],[3,"value"],["class","igo-form",3,"formGroup",4,"ngIf"],["class","mat-typography",4,"ngIf"],[1,"igo-form",3,"formGroup"],[1,"igo-input-container"],[3,"value","valueChange"],[3,"value","click",4,"ngFor","ngForOf"],["tooltip-position","below","matTooltipShowDelay","500",1,"igo-form-button-group",3,"matTooltip"],["mat-raised-button","","type","button",3,"disabled","click"],[3,"shown"],["hidden","","type","file",3,"click","change"],["fileInput",""],[3,"value","click"],["mat-line","",4,"ngIf"],["mat-line",""],[1,"mat-typography"],["multiple","",3,"value","valueChange"],["class","export-select-trigger",4,"ngIf"],[3,"ngClass","value","click",4,"ngFor","ngForOf"],["formControlName","format"],[4,"ngIf"],["disabled","true",4,"ngIf"],["class","igo-input-container",4,"ngIf"],["class","export-options mat-typography",4,"ngIf"],[1,"igo-form-button-group"],[1,"export-select-trigger"],[3,"ngClass","value","click"],[3,"labelPosition","click","checked","change",4,"ngIf"],[3,"labelPosition","click","checked","change"],[3,"value",4,"ngFor","ngForOf"],["disabled","true"],["matInput","","formControlName","name",3,"placeholder"],["formControlName","encoding"],[1,"export-options","mat-typography"],["formControlName","featureInMapExtent",3,"labelPosition"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"mat-button-toggle-group",1),r.NdJ("change",function(e){return t.onImportExportChange(e)}),r.TgZ(2,"mat-button-toggle",2),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.TgZ(5,"mat-button-toggle",2),r._uU(6),r.ALo(7,"translate"),r.qZA(),r.qZA(),r.qZA(),r.YNc(8,$y,20,24,"form",3),r.YNc(9,Dy,14,15,"section",4),r.YNc(10,Ey,4,3,"section",4),r.ALo(11,"async"),r.YNc(12,Wy,34,35,"form",3),r.ALo(13,"async")),2&e&&(r.xp6(1),r.Q6J("value",t.selectedMode),r.xp6(1),r.Q6J("value","import"),r.xp6(1),r.hij(" ",r.lcZ(4,9,"igo.geo.importExportForm.importTabTitle")," "),r.xp6(2),r.Q6J("value","export"),r.xp6(1),r.hij(" ",r.lcZ(7,11,"igo.geo.importExportForm.exportTabTitle")," "),r.xp6(2),r.Q6J("ngIf","import"===t.selectedMode),r.xp6(1),r.Q6J("ngIf","import"===t.selectedMode),r.xp6(1),r.Q6J("ngIf",0===r.lcZ(11,13,t.exportableLayers$).length&&"export"===t.selectedMode),r.xp6(2),r.Q6J("ngIf",r.lcZ(13,15,t.exportableLayers$).length>0&&"export"===t.selectedMode))},directives:[Ka.A9,Ka.Yi,h.O5,We._Y,We.JL,We.sg,De.KE,De.hX,Ee.gD,h.sg,p.gM,n.lW,Gi,Re.ey,Ee.$L,We.JJ,We.u,h.mk,Va.Rr,Ve.Nt,We.Fj],pipes:[j.X$,h.Ov,Pi],styles:["mat-option.igo-export-layer-mat-option[_ngcontent-%COMP%]{height:5em;line-height:1em}.import-export-toggle[_ngcontent-%COMP%]{padding:10px;text-align:center}.import-export-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]{width:100%}.import-export-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]{width:50%}h4[_ngcontent-%COMP%]{padding:0 5px}.igo-form[_ngcontent-%COMP%]{padding:15px 5px}.igo-input-container[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.igo-form-button-group[_ngcontent-%COMP%]{text-align:center;padding-top:10px}igo-spinner[_ngcontent-%COMP%]{position:absolute;padding-left:10px}.export-options[_ngcontent-%COMP%]{overflow-x:hidden}.export-options[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{width:100%;margin:10px}.export-options[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content{width:calc(100% - 60px)}.export-select-trigger[_ngcontent-%COMP%]{opacity:.75;font-size:.75em}"]}),e})(),Ky=new r.OlP("styleListOptions");function ev(e){return{provide:Ky,useValue:e}}function tv(e,t){return()=>e.load(t)}let ov=(()=>{class e{static forRoot(){return{ngModule:e,providers:[ev({}),{provide:r.ip1,useFactory:tv,multi:!0,deps:[Iy,Ky]}]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[]]}),e})(),iv=(()=>{class e{static forRoot(){return{ngModule:e}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[a.Ps,p.AV,We.u5,We.UX,h.ez,n.ot,Ka.vV,cl.Nh,Ee.LD,Re.Ng,De.lN,Ve.c,Va.rP,ne,zi,_i,Yo,ov.forRoot()],ov]}),e})(),rv=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,ne,Bo,a.Ps,n.ot,p.AV]]}),e})();function sv(e,t){if(1&e&&(r.TgZ(0,"mat-option",5),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.measure."+e)," ")}}r.B6R(Su,[h.O5,h.mk,n.lW,p.gM,a.Hw,h.sg,Lu],[j.X$]),r.B6R(Lu,[h.O5,lu],[]);let nv=(()=>{class e{constructor(){this.measure$=new C.X(void 0),this._auto=!1,this.measureUnitChange=new r.vpe}set measure(e){this.measure$.next(e)}get measure(){return this.measure$.value}set auto(e){this.toggleAutoUnit(e)}get auto(){return this._auto}get measureUnits(){return Object.values(this.measureType===lh.Area?ph:ch)}ngOnDestroy(){this.toggleAutoUnit(!1)}onMeasureUnitChange(e){this.measureUnit=e,this.measureUnitChange.emit(e)}toggleAutoUnit(e){void 0!==this.measure$$&&this.measure$$.unsubscribe(),!0===e&&(this.measure$$=this.measure$.subscribe(e=>{this.computeBestMeasureUnit(e)})),this._auto=e}computeBestMeasureUnit(e){let t=this.measureUnit;this.measureType===lh.Area?t=function(e){let t=ph.SquareMeters,o=e;const i=[ph.SquareKilometers];for(;o>1e6&&i.length>0;)t=i.pop(),o=Sh(e,t);return t}(e):this.measureType===lh.Length&&(t=function(e){let t=ch.Meters,o=e;const i=[ch.Kilometers];for(;o>1e3&&i.length>0;)t=i.pop(),o=wh(e,t);return t}(e)),t!==this.measureUnit&&this.onMeasureUnitChange(t)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-measurer-item"]],inputs:{measureType:"measureType",measureUnit:"measureUnit",measure:"measure",auto:"auto",placeholder:"placeholder"},outputs:{measureUnitChange:"measureUnitChange"},decls:9,vars:11,consts:[["appearance","outline","floatLabel","always",1,"measure-field"],["matInput","",3,"readonly","value"],[1,"unit-field"],[3,"value","disabled","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-form-field",0),r.TgZ(1,"mat-label"),r._uU(2),r.qZA(),r._UZ(3,"input",1),r.ALo(4,"measureFormat"),r.ALo(5,"async"),r.qZA(),r.TgZ(6,"mat-form-field",2),r.TgZ(7,"mat-select",3),r.NdJ("selectionChange",function(e){return t.onMeasureUnitChange(e.value)}),r.YNc(8,sv,3,4,"mat-option",4),r.qZA(),r.qZA()),2&e&&(r.xp6(2),r.Oqu(t.placeholder),r.xp6(1),r.Q6J("readonly",!0)("value",r.xi3(4,6,r.lcZ(5,9,t.measure$)||0,t.measureUnit)),r.xp6(4),r.Q6J("value",t.measureUnit)("disabled",t.auto),r.xp6(1),r.Q6J("ngForOf",t.measureUnits))},directives:[De.KE,De.hX,Ve.Nt,Ee.gD,h.sg,Re.ey],pipes:[cg,h.Ov,j.X$],styles:["[_nghost-%COMP%]{display:flex;width:100%;padding:5px 10px}.measure-field[_ngcontent-%COMP%]{pointer-events:none;display:flex;flex-flow:column nowrap;width:100%}.unit-field[_ngcontent-%COMP%]{width:50px;margin-left:10px;margin-top:10px}"],changeDetection:0}),e})(),av=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,n.ot,Ka.vV,a.Ps,p.AV,De.lN,Ve.c,Ee.LD,Va.rP,Ha.t,ne,Ti]]}),e})();r.B6R(lg,[Ka.A9,Ka.Yi,Va.Rr,h.O5,Ha.d,nv,n.lW,p.gM,a.Hw,uo],[j.X$,h.Ov]),r.B6R(zh,[h.O5],[j.X$,cg]);let lv=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[],av]}),e})();var cv=(()=>{return(e=cv||(cv={}))[e.None=0]="None",e[e.Move=1]="Move",e[e.Zoom=2]="Zoom",e[e.ZoomIfOutMapExtent=3]="ZoomIfOutMapExtent",cv;var e})();let uv=(()=>{class e{constructor(){this.features$=new C.X([[],void 0])}setFeatures(e,t=cv.None){this.features$.next([e,t])}clear(){this.features$.next([[],cv.None])}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),pv=(()=>{class e{constructor(e,t){this.component=e,this.overlayService=t,this.format=new Xn.Z}get map(){return this.component.map}ngOnInit(){this.features$$=this.overlayService.features$.subscribe(e=>this.handleFeatures(e[0],e[1]))}ngOnDestroy(){this.features$$.unsubscribe()}handleFeatures(e,t){}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(lu,2),r.Y36(uv))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoOverlay",""]]}),e})(),dv=(()=>{class e{static forRoot(){return{ngModule:e}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[]]}),e})(),hv=(()=>{class e{constructor(e,t,o,i){this.http=e,this.messageService=t,this.activityService=o,this.languageService=i}print(e,t){const o=new O.xQ,i=t.paperFormat,r=+t.resolution,s=t.orientation;this.activityId=this.activityService.register();const n=new ml.ZP({orientation:s,format:i.toLowerCase()}),a=[n.internal.pageSize.width,n.internal.pageSize.height],l=[10,10,10,10],c=a[0]-l[3]-l[1],u=a[1]-l[0]-l[2],p=[c,u];let d=[0,0];if(void 0!==t.title&&(d=this.getTitleSize(t.title,c,u,n),this.addTitle(n,t.title,d[0],l[3]+d[1],d[0]*(25.4/72))),void 0!==t.subtitle){let e=0;const o=d[0];e=this.getSubTitleSize(t.subtitle,c,u,n),this.addSubTitle(n,t.subtitle,.7*o,l[3]+e,1.7*o*(25.4/72)),l[0]=l[0]+.7*d[0]*(25.4/72)}return(!0===t.showProjection||!0===t.showScale)&&this.addProjScale(n,e,r,t.showProjection,t.showScale),""!==t.comment&&this.addComment(n,t.comment),this.addMap(n,e,r,p,l).subscribe(i=>(0,je.mG)(this,void 0,void 0,function*(){i===J.Done&&(yield this.addScale(n,e,l),yield this.handleMeasureLayer(n,e,l),"none"!==t.legendPosition?["topleft","topright","bottomleft","bottomright"].indexOf(t.legendPosition)>-1?yield this.addLegendSamePage(n,e,l,r,t.legendPosition):"newpage"===t.legendPosition&&(yield this.addLegend(n,e,l,r)):yield this.saveDoc(n)),(i===J.Done||i===J.Error)&&(this.activityService.unregister(this.activityId),o.next(J.Done))})),o}handleMeasureLayer(e,t,o){return(0,je.mG)(this,void 0,void 0,function*(){if(t.layers.find(e=>e.visible&&e.id.startsWith("igo-measures-"))){let i;const r=t.ol.getOverlayContainer();yield yl()(r,{scale:1,backgroundColor:null}).then(e=>{i=e}),this.addCanvas(e,i,o)}})}getLayersLegendHtml(e,t,o){return new Le.y(i=>{let r="";const s=function(e,t){const o=[];for(const i of e){if(!1===i.visible)continue;const e=i.dataSource.getLegend(void 0,t)||[];for(const t of e)void 0!==t.url&&o.push({title:i.title,url:t.url})}return o}(e.layers,{resolution:e.viewController.getResolution(),extent:e.viewController.getExtent(),projection:e.viewController.getOlProjection().getCode(),scale:e.viewController.getScale(o),size:e.ol.getSize()});if(0===s.length)return i.next(r),void i.complete();r+='<style media="screen" type="text/css">',r+=".html2canvas-container { width: "+t+"mm !important; height: 2000px !important; }",r+="table.tableLegend {table-layout: auto;}",r+="div.styleLegend {padding-top: 5px; padding-right:5px;padding-left:5px;padding-bottom:5px;}",r+="</style>",r+='<font size="3" face="Times" >',r+='<div class="styleLegend">',r+='<table class="tableLegend" >';const n=s.map(e=>this.getDataImage(e.url).pipe((0,x.U)(t=>{let o="<tr><td>"+e.title.toUpperCase()+"</td></tr>";return o+='<tr><td><img src="'+t+'"></td></tr>',o})));(0,vn.D)(n).subscribe(e=>{r=e.reduce((e,t)=>e+t,r),r+="</table>",r+="</div>",i.next(r),i.complete()})})}getDataImage(e){return new Tt(this.http).transform(e)}getLayersLegendImage(e,t="png",o,i){return(0,je.mG)(this,void 0,void 0,function*(){const r=new O.xQ;let s=yield this.getLayersLegendHtml(e,200,i).toPromise();t=t.toLowerCase(),0===s.length&&(s='<font size="12" face="Courier New" >',s+='<div align="center"><b>NO LEGEND</b></div>');const n=window.document.createElement("div");n.style.position="absolute",n.style.top="0",window.document.body.appendChild(n),n.innerHTML=s,yield this.timeout(1);const a=yield yl()(n,{useCORS:!0}).catch(e=>{console.log(e)});if(a){let e=J.Done;try{o?this.generateCanvaFileToZip(a,"legendImage."+t):this.saveCanvasImageAsFile(a,"legendImage",t),n.parentNode.removeChild(n)}catch(l){e=J.Error}r.next(e)}return r})}getTitleSize(e,t,o,i){const r=Math.round(2*(o+145)*.05)/2;i.setFont("Times","bold"),i.getTextWidth(e);const s=i.getStringUnitWidth(e)*r/i.internal.scaleFactor,n=Math.round(2*(o+150)*.037)/2;let a,l=0;return s>=t?(a=0,l=Math.round(t/e.length*96/25.4),l<n&&(l=n)):(a=(t-s)/2,l=r),[l,a]}getSubTitleSize(e,t,o,i){const r=.7*Math.round(2*(o+145)*.05)/2;i.setFont("Times","bold");const s=i.getStringUnitWidth(e)*r/i.internal.scaleFactor;let n;return n=s>=t?0:(t-s)/2,n}addTitle(e,t,o,i,r){e.setFont("Times","bold"),e.setFontSize(o),e.text(t,i,r)}addSubTitle(e,t,o,i,r){e.setFont("Times","bold"),e.setFontSize(o),e.text(t,i,r)}addComment(e,t){const o=e.internal.pageSize.height-5;e.setFont("courier"),e.setFontSize(16),e.text(t,20,o)}addProjScale(e,t,o,i,r){const s=this.languageService.translate,n=e.internal.pageSize.height-15;let a="";!0===i&&(a+=s.instant("igo.geo.printForm.projection")+": "+t.projection),!0===r&&(!0===i&&(a+="   "),a+=s.instant("igo.geo.printForm.scale")+": ~ 1 / "+pc(t.viewController.getScale(o))),e.setFont("courier"),e.setFontSize(16),e.text(a,20,n)}addLegend(e,t,o,i){return(0,je.mG)(this,void 0,void 0,function*(){const o=e.internal.pageSize.width,r=yield this.getLayersLegendHtml(t,o,i).toPromise();if(""===r)return yield this.saveDoc(e),!0;const s=window.document.createElement("div");s.style.position="absolute",s.style.top="0",window.document.body.appendChild(s),s.innerHTML=r,yield this.timeout(1);const n=yield yl()(s,{useCORS:!0}).catch(e=>{console.log(e)});if(n){const t=.85,o=[t*(25.4*n.width)/i,t*(25.4*n.height)/i];let r;e.addPage(),r=n.toDataURL("image/png"),e.addImage(r,"PNG",10,10,o[0],o[1]),s.parentNode.removeChild(s)}yield this.saveDoc(e)})}addLegendSamePage(e,t,o,i,r){return(0,je.mG)(this,void 0,void 0,function*(){const s=e.internal.pageSize.width,n=yield this.getLayersLegendHtml(t,s,i).toPromise();if(""===n)return yield this.saveDoc(e),!0;const a=window.document.createElement("div");a.style.position="absolute",a.style.top="0",window.document.body.appendChild(a),a.innerHTML=n,yield this.timeout(1);const l=yield yl()(a,{useCORS:!0}).catch(e=>{console.log(e)});let c;if(l){const t=.85,s=[t*(25.4*l.width)/i,t*(25.4*l.height)/i];"bottomright"===r?c=[e.internal.pageSize.height-o[2]-s[1],o[1],o[2],e.internal.pageSize.width-o[1]-s[0]]:"topright"===r?c=[o[0],o[1],e.internal.pageSize.height-o[0]-s[1],e.internal.pageSize.width-o[1]-s[0]]:"bottomleft"===r?c=[e.internal.pageSize.height-o[2]-s[1]-15,e.internal.pageSize.width-o[3]-s[0],o[2]+15,o[3]]:"topleft"===r&&(c=[o[0],e.internal.pageSize.width-o[3]-s[0],e.internal.pageSize.height-o[0]-s[1],o[3]]),this.addCanvas(e,l,c),a.parentNode.removeChild(a),yield this.saveDoc(e)}})}addScale(e,t,o){return(0,je.mG)(this,void 0,void 0,function*(){const i=t.ol.getSize();let r;t.ol.getView().calculateExtent(i);const s=t.ol.getOverlayContainerStopEvent(),n=s.getElementsByTagName("button"),a=Array.from(n);for(const e of a)e.setAttribute("data-html2canvas-ignore","true");yield yl()(s,{scale:1,backgroundColor:null,allowTaint:!0,useCORS:!0}).then(e=>{r=e}),this.addCanvas(e,r,o)})}defineNbFileToProcess(e){this.nbFileToProcess=e}timeout(e){return new Promise(t=>setTimeout(t,e))}addCanvas(e,t,o){let i;if(t&&(i=t.toDataURL("image/png")),void 0!==i){const r=this.getImageSizeToFitPdf(e,t,o);e.addImage(i,"PNG",o[3],o[0],r[0],r[1]),e.rect(o[3],o[0],r[0],r[1])}}addMap(e,t,o,i,r){const s=new O.xQ,n=t.ol.getSize(),a=t.ol.getView().calculateExtent(n),l=Math.round(i[0]*o/25.4),c=Math.round(i[1]*o/25.4);let u;return t.ol.once("rendercomplete",o=>{const i=o.target.getViewport().getElementsByTagName("canvas"),l=t.status$.subscribe(o=>{if(clearTimeout(u),o!==J.Done)return;l.unsubscribe();let c=J.Done;try{for(const t of i)0!==t.width&&this.addCanvas(e,t,r)}catch(p){c=J.Error,this.messageService.error(this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageBody"),this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageHeader"))}this.renderMap(t,n,a),s.next(c)});u=window.setTimeout(()=>{l.unsubscribe();let o=J.Done;try{for(const t of i)0!==t.width&&this.addCanvas(e,t,r)}catch(c){o=J.Error,this.messageService.error(this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageBody"),this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageHeader"))}this.renderMap(t,n,a),s.next(o)},200)}),this.renderMap(t,[l,c],a),s}downloadMapImage(e,t,o="png",i=!1,r=!1,s=!1,n="",a="",l="",c=!0){const u=new O.xQ;this.activityId=this.activityService.register();const p=this.languageService.translate;return e.ol.once("rendercomplete",s=>{o=o.toLowerCase();const d=s.target.getViewport().getElementsByTagName("canvas")[0],h=document.createElement("canvas"),g=h.getContext("2d");let m=0,f=10;const y=d.width;let v=d.height;g.font="20px Calibri";const b=g.measureText(l).width;v=""!==n?v+30:v,v=""!==a?v+30:v,v=!1!==i||!1!==r?v+30:v;const x=v-10,w=Math.ceil(b/y);v=""!==l?v+30*w:v;let S=v-20*w+5;if(h.width=y,h.height=v,"jpeg"===o&&(g.fillStyle="#ffffff",g.fillRect(0,0,y,v),g.fillStyle="#000000"),""!==n&&(g.font="26px Calibri",m=30,g.textAlign="center",g.fillText(n,y/2,20,.9*y)),""!==a&&(g.font="26px Calibri",m=60,g.textAlign="center",g.fillText(a,y/2,50,.9*y)),g.font="20px Calibri",!1!==i){const t=p.instant("igo.geo.printForm.projection");g.textAlign="start",g.fillText(t+": "+e.projection,f,x),f+=200}if(!1!==r){const o=p.instant("igo.geo.printForm.scale"),i=e.viewController.getScale(t);g.textAlign="start",g.fillText(o+": ~ 1 / "+pc(i),f,x)}if(""!==l)if(g.textAlign="center",1===w)g.fillText(l,y/2,S);else{const e=Math.floor(l.length/w);let t,o="",i=0;for(let r=0;r<w;r++)w-1>r?(o=l.substr(i,e),t=o.lastIndexOf(" "),g.fillText(o.substr(0,t),y/2,S),i+=t,S+=20):g.fillText(l.substr(i),y/2,S)}g.drawImage(d,0,m);let C=J.Done;try{c?"tiff"===o.toLowerCase()?this.generateCanvaFileToZip(h,"map"+e.projection.replace(":","_")+"."+o):this.generateCanvaFileToZip(h,"map."+o):this.saveCanvasImageAsFile(h,"map",o)}catch(T){C=J.Error}if(u.next(C),"tiff"===o.toLowerCase()){const t=this.getWorldFileInformation(e),o=new Blob([t],{type:"text/plain;charset=utf-8"});c?this.addFileToZip("map"+e.projection.replace(":","_")+".tfw",o):((0,gl.saveAs)(o,"map"+e.projection+".tfw"),this.saveFileProcessing())}}),e.ol.renderSync(),u}renderMap(e,t,o){e.ol.updateSize(),e.ol.renderSync()}saveDoc(e){return(0,je.mG)(this,void 0,void 0,function*(){yield e.save("map.pdf",{returnPromise:!0})})}getImageSizeToFitPdf(e,t,o){const i=e.internal.pageSize.getHeight()-(o[0]+o[2]),r=e.internal.pageSize.getWidth()-(o[1]+o[3]),s=t.height,n=t.width,a=s/i,l=n/r,c=a>l?a:l;return[c>1?n/c:n,c>1?s/c:s]}getWorldFileInformation(e){const t=e.viewController.getResolution(),o=e.viewController.getExtent();return[t,0,0,-t,o[0]+t/.5,o[3]-t/.5].join("\n")}saveCanvasImageAsFile(e,t,o){const i="image/"+o,r=this;try{e.toDataURL(),navigator.msSaveBlob?(navigator.msSaveBlob(e.msToBlob(),t+"."+o),this.saveFileProcessing()):e.toBlob(e=>{(0,gl.saveAs)(e,t+"."+o),r.saveFileProcessing()},i)}catch(s){this.messageService.error(this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageBody"),this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageHeader"))}}generateCanvaFileToZip(e,t){const o=this;(!this.hasOwnProperty("zipFile")||void 0===this.zipFile)&&(this.zipFile=new vl);try{e.toDataURL(),navigator.msSaveBlob?this.addFileToZip(t,e.msToBlob()):e.toBlob(e=>{o.addFileToZip(t,e)},"image/jpeg")}catch(i){this.messageService.error(this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageBody"),this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageHeader"))}}addFileToZip(e,t){this.zipFile.file(e,t),this.nbFileToProcess--,0===this.nbFileToProcess&&(this.getZipFile(),this.activityService.unregister(this.activityId))}saveFileProcessing(){this.nbFileToProcess--,0===this.nbFileToProcess&&this.activityService.unregister(this.activityId)}getZipFile(){const e=this;this.zipFile.generateAsync({type:"blob"}).then(t=>{(0,gl.saveAs)(t,"map.zip"),delete e.zipFile})}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(de),r.LFG(Y),r.LFG(ue))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const gv=R(["Pdf","Image"]),mv=R(["A0","A1","A2","A3","A4","A5","Letter","Legal"]),fv=R(["landscape","portrait"]),yv=R(["72","96","150","300"]),vv=R(["Bmp","Gif","Jpeg","Png","Tiff"]),bv=R(["none","topright","topleft","bottomleft","bottomright","newpage"]);function xv(e,t){if(1&e&&(r.TgZ(0,"mat-option",19),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.key),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.printForm.legendPositions."+e.value)," ")}}function wv(e,t){if(1&e&&(r.TgZ(0,"mat-option",19),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.key),r.xp6(1),r.hij(" ",e.value," ")}}function Sv(e,t){if(1&e&&(r.TgZ(0,"mat-option",19),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.key),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.printForm.paperFormats."+e.value)," ")}}function Cv(e,t){if(1&e&&(r.TgZ(0,"mat-option",19),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.key),r.xp6(1),r.hij(" ",e.value," ")}}function Tv(e,t){if(1&e&&(r.TgZ(0,"mat-option",19),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.key),r.xp6(1),r.hij(" ",e.value+" PPI"," ")}}function Av(e,t){if(1&e&&(r.TgZ(0,"mat-option",19),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.key),r.xp6(1),r.hij(" ",r.lcZ(2,2,"igo.geo.printForm."+e.value)," ")}}let Lv=(()=>{class e{constructor(e){this.formBuilder=e,this.outputFormats=gv,this.paperFormats=mv,this.orientations=fv,this.resolutions=yv,this.imageFormats=vv,this.legendPositions=bv,this.isPrintService=!0,this.submit=new r.vpe,this.form=this.formBuilder.group({title:["",[]],subtitle:["",[]],comment:["",[]],outputFormat:["",[We.kI.required]],paperFormat:["",[We.kI.required]],imageFormat:["",[We.kI.required]],resolution:["",[We.kI.required]],orientation:["",[We.kI.required]],legendPosition:["",[We.kI.required]],showProjection:!1,showScale:!1,showLegend:!1,doZipFile:[{hidden:this.isPrintService}]})}get imageFormat(){return this.imageFormatField.value}set imageFormat(e){this.imageFormatField.setValue(e||vv.Jpeg,{onlySelf:!0})}get outputFormat(){return this.outputFormatField.value}set outputFormat(e){this.outputFormatField.setValue(e||gv.Pdf,{onlySelf:!0})}get paperFormat(){return this.paperFormatField.value}set paperFormat(e){this.paperFormatField.setValue(e||mv.Letter,{onlySelf:!0})}get orientation(){return this.orientationField.value}set orientation(e){this.orientationField.setValue(e||fv.landscape,{onlySelf:!0})}get resolution(){return this.resolutionField.value}set resolution(e){this.resolutionField.setValue(e||yv[96],{onlySelf:!0})}get legendPosition(){return this.legendPositionField.value}set legendPosition(e){this.legendPositionField.setValue(e||bv.none,{onlySelf:!0})}get title(){return this.titleField.value}set title(e){this.titleField.setValue(e,{onlySelf:!0})}get subtitle(){return this.subtitleField.value}set subtitle(e){this.subtitleField.setValue(e,{onlySelf:!0})}get comment(){return this.commentField.value}set comment(e){this.commentField.setValue(e,{onlySelf:!0})}get showProjection(){return this.showProjectionField.value}set showProjection(e){this.showProjectionField.setValue(e,{onlySelf:!0})}get showScale(){return this.showScaleField.value}set showScale(e){this.showScaleField.setValue(e,{onlySelf:!0})}get showLegend(){return this.showLegendField.value}set showLegend(e){this.showLegendField.setValue(e,{onlySelf:!0})}get doZipFile(){return this.doZipFileField.value}set doZipFile(e){this.doZipFileField.setValue(e,{onlySelf:!0})}get outputFormatField(){return this.form.controls.outputFormat}get paperFormatField(){return this.form.controls.paperFormat}get imageFormatField(){return this.form.controls.imageFormat}get orientationField(){return this.form.controls.orientation}get resolutionField(){return this.form.controls.resolution}get commentField(){return this.form.controls.comment}get showProjectionField(){return this.form.controls.showProjection}get showScaleField(){return this.form.controls.showScale}get showLegendField(){return this.form.controls.showLegend}get doZipFileField(){return this.form.controls.doZipFile}get titleField(){return this.form.controls.title}get subtitleField(){return this.form.controls.subtitle}get legendPositionField(){return this.form.controls.legendPosition}ngOnInit(){this.doZipFileField.setValue(!1)}handleFormSubmit(e,t){e.isPrintService=this.isPrintService,t&&this.submit.emit(e)}toggleImageSaveProp(){this.isPrintService="Image"!==this.outputFormatField.value}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(We.qu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-print-form"]],inputs:{disabled$:"disabled$",imageFormat:"imageFormat",outputFormat:"outputFormat",paperFormat:"paperFormat",orientation:"orientation",resolution:"resolution",legendPosition:"legendPosition",title:"title",subtitle:"subtitle",comment:"comment",showProjection:"showProjection",showScale:"showScale",showLegend:"showLegend",doZipFile:"doZipFile"},outputs:{submit:"submit"},decls:65,vars:72,consts:[[1,"igo-form",3,"formGroup"],[1,"igo-input-container"],["matInput","","formControlName","title",3,"placeholder"],["matInput","","formControlName","subtitle",3,"placeholder"],["matInput","","formControlName","comment",3,"placeholder"],[1,"print-slide-toggle-container","mat-typography"],["formControlName","showProjection",1,"print-option",3,"labelPosition"],["formControlName","showScale",1,"print-option",3,"labelPosition"],["formControlName","doZipFile",1,"print-option",3,"labelPosition"],["formControlName","legendPosition",3,"placeholder"],[3,"value",4,"ngFor","ngForOf"],["formControlName","outputFormat",3,"placeholder","selectionChange"],["formControlName","paperFormat",3,"placeholder"],["formControlName","imageFormat",3,"placeholder"],[1,"igo-input-container",2,"display","none"],["formControlName","resolution",3,"placeholder"],["formControlName","orientation",3,"placeholder"],[1,"igo-form-button-group","print-button-top-padding"],["mat-raised-button","","type","button",3,"disabled","click"],[3,"value"]],template:function(e,t){1&e&&(r.TgZ(0,"form",0),r.TgZ(1,"div",1),r.TgZ(2,"mat-form-field"),r._UZ(3,"input",2),r.ALo(4,"translate"),r.qZA(),r.qZA(),r.TgZ(5,"div",1),r.TgZ(6,"mat-form-field"),r._UZ(7,"input",3),r.ALo(8,"translate"),r.qZA(),r.qZA(),r.TgZ(9,"div",1),r.TgZ(10,"mat-form-field"),r._UZ(11,"input",4),r.ALo(12,"translate"),r.qZA(),r.qZA(),r.TgZ(13,"div",1),r.TgZ(14,"div",5),r.TgZ(15,"mat-slide-toggle",6),r._uU(16),r.ALo(17,"translate"),r.qZA(),r.TgZ(18,"mat-slide-toggle",7),r._uU(19),r.ALo(20,"translate"),r.qZA(),r.TgZ(21,"mat-slide-toggle",8),r._uU(22),r.ALo(23,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(24,"div",1),r.TgZ(25,"mat-form-field"),r.TgZ(26,"mat-select",9),r.ALo(27,"translate"),r.YNc(28,xv,3,4,"mat-option",10),r.ALo(29,"keyvalue"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(30,"div",1),r.TgZ(31,"mat-form-field"),r.TgZ(32,"mat-select",11),r.NdJ("selectionChange",function(){return t.toggleImageSaveProp()}),r.ALo(33,"translate"),r.YNc(34,wv,2,2,"mat-option",10),r.ALo(35,"keyvalue"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(36,"div",1),r.TgZ(37,"mat-form-field"),r.TgZ(38,"mat-select",12),r.ALo(39,"translate"),r.YNc(40,Sv,3,4,"mat-option",10),r.ALo(41,"keyvalue"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(42,"div",1),r.TgZ(43,"mat-form-field"),r.TgZ(44,"mat-select",13),r.ALo(45,"translate"),r.YNc(46,Cv,2,2,"mat-option",10),r.ALo(47,"keyvalue"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(48,"div",14),r.TgZ(49,"mat-form-field"),r.TgZ(50,"mat-select",15),r.ALo(51,"translate"),r.YNc(52,Tv,2,2,"mat-option",10),r.ALo(53,"keyvalue"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(54,"div",1),r.TgZ(55,"mat-form-field"),r.TgZ(56,"mat-select",16),r.ALo(57,"translate"),r.YNc(58,Av,3,4,"mat-option",10),r.ALo(59,"keyvalue"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(60,"div",17),r.TgZ(61,"button",18),r.NdJ("click",function(){return t.handleFormSubmit(t.form.value,t.form.valid)}),r.ALo(62,"async"),r._uU(63),r.ALo(64,"translate"),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.Q6J("formGroup",t.form),r.xp6(3),r.s9C("placeholder",r.lcZ(4,32,"igo.geo.printForm.title")),r.xp6(4),r.s9C("placeholder",r.lcZ(8,34,"igo.geo.printForm.subtitle")),r.xp6(4),r.s9C("placeholder",r.lcZ(12,36,"igo.geo.printForm.comment")),r.xp6(4),r.Q6J("labelPosition","before"),r.xp6(1),r.hij(" ",r.lcZ(17,38,"igo.geo.printForm.showProjection")," "),r.xp6(2),r.Q6J("labelPosition","before"),r.xp6(1),r.hij(" ",r.lcZ(20,40,"igo.geo.printForm.showScale")," "),r.xp6(2),r.Udp("display",t.isPrintService?"none":""),r.Q6J("labelPosition","before"),r.xp6(1),r.hij(" ",r.lcZ(23,42,"igo.geo.printForm.doZipFile")," "),r.xp6(4),r.s9C("placeholder",r.lcZ(27,44,"igo.geo.printForm.legendPosition")),r.xp6(2),r.Q6J("ngForOf",r.lcZ(29,46,t.legendPositions)),r.xp6(4),r.s9C("placeholder",r.lcZ(33,48,"igo.geo.printForm.outputFormat")),r.xp6(2),r.Q6J("ngForOf",r.lcZ(35,50,t.outputFormats)),r.xp6(2),r.Udp("display",t.isPrintService?"block":"none"),r.xp6(2),r.s9C("placeholder",r.lcZ(39,52,"igo.geo.printForm.paperFormat")),r.xp6(2),r.Q6J("ngForOf",r.lcZ(41,54,t.paperFormats)),r.xp6(2),r.Udp("display",t.isPrintService?"none":"block"),r.xp6(2),r.s9C("placeholder",r.lcZ(45,56,"igo.geo.printForm.imageFormat")),r.xp6(2),r.Q6J("ngForOf",r.lcZ(47,58,t.imageFormats)),r.xp6(4),r.s9C("placeholder",r.lcZ(51,60,"igo.geo.printForm.resolution")),r.xp6(2),r.Q6J("ngForOf",r.lcZ(53,62,t.resolutions)),r.xp6(2),r.Udp("display",t.isPrintService?"block":"none"),r.xp6(2),r.s9C("placeholder",r.lcZ(57,64,"igo.geo.printForm.orientation")),r.xp6(2),r.Q6J("ngForOf",r.lcZ(59,66,t.orientations)),r.xp6(3),r.Q6J("disabled",!t.form.valid||r.lcZ(62,68,t.disabled$)),r.xp6(2),r.hij(" ",r.lcZ(64,70,"igo.geo.printForm.saveBtn")," "))},directives:[We._Y,We.JL,We.sg,De.KE,Ve.Nt,We.Fj,We.JJ,We.u,Va.Rr,Ee.gD,h.sg,n.lW,Re.ey],pipes:[j.X$,Pi,h.Ov],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}.print-slide-toggle-container[_ngcontent-%COMP%]{overflow-x:hidden}.print-slide-toggle-container[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{width:100%;margin:10px}.print-slide-toggle-container[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content{width:calc(100% - 60px)}.print-option[_ngcontent-%COMP%]{display:block;margin-right:10px;margin-bottom:15px}.print-button-top-padding[_ngcontent-%COMP%]{padding-top:25px}.igo-form[_ngcontent-%COMP%]{padding:10px 5px 5px}.igo-form-button-group[_ngcontent-%COMP%]{text-align:center}"]}),e})(),Zv=(()=>{class e{constructor(e){this.printService=e,this.disabled$=new C.X(!1)}get map(){return this._map}set map(e){this._map=e}get outputFormat(){return this._outputFormat}set outputFormat(e){this._outputFormat=e}get paperFormat(){return this._paperFormat}set paperFormat(e){this._paperFormat=e}get orientation(){return this._orientation}set orientation(e){this._orientation=e}get imageFormat(){return this._imageFormat}set imageFormat(e){this._imageFormat=e}get legendPosition(){return this._legendPosition}set legendPosition(e){this._legendPosition=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}handleFormSubmit(e){if(this.disabled$.next(!0),!0===e.isPrintService)this.printService.print(this.map,e).pipe((0,qe.q)(1)).subscribe(()=>{this.disabled$.next(!1)});else{let t=1;e.showLegend&&t++,"tiff"===e.imageFormat.toLowerCase()&&t++,this.printService.defineNbFileToProcess(t);const o=+e.resolution;let i=e.showLegend?2:1;this.printService.downloadMapImage(this.map,o,e.imageFormat,e.showProjection,e.showScale,e.showLegend,e.title,e.subtitle,e.comment,e.doZipFile).pipe((0,qe.q)(1)).subscribe(()=>{i--,i||this.disabled$.next(!1)}),e.showLegend&&this.printService.getLayersLegendImage(this.map,e.imageFormat,e.doZipFile,+o).then(()=>{i--,i||this.disabled$.next(!1)})}}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(hv))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-print"]],inputs:{map:"map",outputFormat:"outputFormat",paperFormat:"paperFormat",orientation:"orientation",imageFormat:"imageFormat",legendPosition:"legendPosition",resolution:"resolution"},decls:1,vars:7,consts:[[3,"outputFormat","paperFormat","orientation","imageFormat","resolution","legendPosition","disabled$","submit"]],template:function(e,t){1&e&&(r.TgZ(0,"igo-print-form",0),r.NdJ("submit",function(e){return t.handleFormSubmit(e)}),r.qZA()),2&e&&r.Q6J("outputFormat",t.outputFormat)("paperFormat",t.paperFormat)("orientation",t.orientation)("imageFormat",t.imageFormat)("resolution",t.resolution)("legendPosition",t.legendPosition)("disabled$",t.disabled$)},directives:[Lv],encapsulation:2}),e})(),Fv=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,We.u5,We.UX,a.Ps,n.ot,Ee.LD,Re.Ng,Ve.c,De.lN,Va.rP,ne,_i]]}),e})();function Ov(e){return new Qu(e.getConfig(`searchSources.${Qu.id}`)||{})}let Mv=(()=>{class e{static forRoot(){return{ngModule:e,providers:[{provide:ju,useFactory:Ov,multi:!0,deps:[W]}]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[Uu],imports:[[h.ez]]}),e})();class Iv{}class kv{constructor(e){this.sources=e}}function Pv(e){return new kv(e)}var _v=(()=>{return(e=_v||(_v={}))[e.GeoJSON=0]="GeoJSON",e[e.JSON=1]="JSON",_v;var e})(),$v=(()=>{return(e=$v||($v={})).Route="route",e.Trip="trip",$v;var e})(),qv=(()=>{return(e=qv||(qv={})).Stop="stop",e.Route="route",e.Vertex="vertex",qv;var e})(),Dv=(()=>{return(e=Dv||(Dv={})).Start="start",e.Intermediate="intermediate",e.End="end",Dv;var e})();function Ev(e,t="asc",o="position"){e.view.sort({direction:t,valueAccessor:e=>e[o]})}function Rv(e,t){let o=Dv.Intermediate;return 0===e?o=Dv.Start:e===t-1&&(o=Dv.End),o}function Uv(e){const t=N(),o=e.all();let i;i=0===e.count?[0]:o.map(e=>e.position);const r=Math.max(...i),s=r,n=r+1,a=e.all().find(e=>e.position===r);return a&&(a.position=n,a.relativePosition=Rv(n,e.count+1)),e.insert({id:t,position:s,relativePosition:Rv(s,e.count+1)}),Ev(e),e.get(t)}function Nv(e,t){const o=[new Un.ZP({geometry:e.getGeometry(),image:new Qn.Z({radius:7,stroke:new jn.Z({color:"#FF0000",width:3})})})],i=Kc({text:e.get("stopText"),opacity:e.get("stopOpacity"),markerColor:e.get("stopColor"),markerOutlineColor:[255,255,255]}),r=[new Un.ZP({stroke:new jn.Z({color:`rgba(106, 121, 130, ${e.get("active")?.75:0})`,width:10})}),new Un.ZP({stroke:new jn.Z({color:`rgba(79, 169, 221, ${e.get("active")?.75:0})`,width:6})})];return e.get("type")===qv.Stop?i:"vertex"===e.get("type")?o:e.get("type")===qv.Route?r:void 0}function Jv(e){if(0!==e)return e>=1e5?E.roundToNDecimal(Math.round(e)/1e3,1)+" km":e>=1e4||e>=1e3?E.roundToNDecimal(Math.round(e)/100/10,1)+" km":E.roundToNDecimal(e,0)+" m"}function Bv(e){if(e>=3600){const t=Math.floor(e/3600),o=Math.round(60*(e/3600-t));return 60===o?t+1+" h":t+" h "+o+" min"}return e>=60?Math.round(e/60)+" min":e+" s"}function jv(e,t,o,i,r,s,n,a=!1){const l=n.translate;let c,u="forward",p="rotate-270";const d=function(e,t){const o=t.translate;return e>=337||e<23?o.instant("igo.geo.cardinalPoints.n"):e<67?o.instant("igo.geo.cardinalPoints.ne"):e<113?o.instant("igo.geo.cardinalPoints.e"):e<157?o.instant("igo.geo.cardinalPoints.se"):e<203?o.instant("igo.geo.cardinalPoints.s"):e<247?o.instant("igo.geo.cardinalPoints.sw"):e<293?o.instant("igo.geo.cardinalPoints.w"):e<337?o.instant("igo.geo.cardinalPoints.nw"):void 0}(i,n),h=function(e,t){const o=t.translate;return"uturn"===e?o.instant("igo.geo.directions.uturn"):"sharp right"===e?o.instant("igo.geo.directions.sharp right"):"right"===e?o.instant("igo.geo.directions.right"):"slight right"===e?o.instant("igo.geo.directions.slight right"):"sharp left"===e?t.translate.instant("igo.geo.directions.sharp left"):"left"===e?t.translate.instant("igo.geo.directions.left"):"slight left"===e?t.translate.instant("igo.geo.directions.slight left"):"straight"===e?t.translate.instant("igo.geo.directions.straight"):e}(t,n);let g=("straight"===t?"":l.instant("igo.geo.directions.modifier.prefix"))+h;if((null==t?void 0:t.search("slight"))>=0&&(g=h),"uturn"===t?(u="forward",p="rotate-90"):"sharp right"===t||"right"===t?(u="subdirectory-arrow-right",p="icon-flipped"):"slight right"===t?(u="forward",p="rotate-290"):"straight"===t?u="forward":"slight left"===t?(u="forward",p="rotate-250"):("left"===t||"sharp left"===t)&&(u="subdirectory-arrow-left",p="icon-flipped"),"turn"===e)c="straight"===t?l.instant("igo.geo.directions.turn.straight",{route:o}):"uturn"===t?l.instant("igo.geo.directions.turn.uturn",{route:o}):l.instant("igo.geo.directions.turn.else",{route:o,aggregatedDirection:g,translatedModifier:h});else if("new name"===e)c=l.instant("igo.geo.directions.new name",{route:o,translatedDirection:d}),u="compass",p="";else if("depart"===e)c=l.instant("igo.geo.directions.depart",{route:o,translatedDirection:d}),u="compass",p="";else if("arrive"===e)a?(g=h?g:"",c=l.instant("igo.geo.directions.arrive.lastStep",{coma:h?", ":"",aggregatedDirection:g})):(c=l.instant("igo.geo.directions.arrive.intermediate",{route:o}),u="map-marker",p="");else if("merge"===e)c=l.instant("igo.geo.directions.merge",{route:o}),u="forward",p="rotate-270";else if("on ramp"===e)c=l.instant("igo.geo.directions.on ramp",{aggregatedDirection:g});else if("off ramp"===e)c=l.instant("igo.geo.directions.off ramp",{aggregatedDirection:g});else if("fork"===e)c=t.search("left")>=0?l.instant("igo.geo.directions.fork.left",{route:o}):t.search("right")>=0?l.instant("igo.geo.directions.fork.right",{route:o}):l.instant("igo.geo.directions.fork.else",{route:o});else if("end of road"===e)c=l.instant("igo.geo.directions.end of road",{translatedModifier:h,route:o});else if("use lane"===e)c=l.instant("igo.geo.directions.use lane");else if("continue"===e&&"uturn"!==t)c=l.instant("igo.geo.directions.continue.notUturn",{route:o}),u="forward",p="rotate-270";else if("roundabout"===e){const e=l.instant(1===s?"igo.geo.directions.cntSuffix.first":"igo.geo.directions.cntSuffix.secondAndMore");c=l.instant("igo.geo.directions.roundabout",{exit:s,cntSuffix:e,route:o}),u="chart-donut",p=""}else"rotary"===e?(c=l.instant("igo.geo.directions.rotary"),u="chart-donut",p=""):"roundabout turn"===e?(c=l.instant("igo.geo.directions.roundabout turn"),u="chart-donut",p=""):"exit roundabout"===e?(c=l.instant("igo.geo.directions.exit roundabout",{route:o}),u="forward",p="rotate-270"):c="notification"===e?l.instant("igo.geo.directions.notification"):"uturn"===t?l.instant("igo.geo.directions.uturnText",{translatedDirection:d,route:o}):l.instant("igo.geo.directions.unknown");return u=a?"flag-variant":u,p=a?"":p,u=0===r?"compass":u,p=0===r?"":p,{instruction:c,image:u,cssClass:p}}function Qv(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",10),r.NdJ("click",function(){r.CHM(e);const t=r.oxw().$implicit;return r.oxw().clearStop(t)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",11),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.directionsForm.clearStop"))}function Gv(e,t){if(1&e&&(r.TgZ(0,"mat-option",14),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e)("matTooltip",e.meta?e.meta.title:""),r.xp6(1),r.hij(" ",e.meta?e.meta.title:""," ")}}function Yv(e,t){if(1&e&&(r.TgZ(0,"mat-optgroup",12),r.YNc(1,Gv,2,3,"mat-option",13),r.qZA()),2&e){const e=t.$implicit;r.Q6J("label",e.source.title)("disabled",!1===e.source.enabled),r.xp6(1),r.Q6J("ngForOf",e.results)}}function zv(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",20),r.NdJ("click",function(){r.CHM(e);const t=r.oxw(2).$implicit;return r.oxw().removeStop(t)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",21),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.directionsForm.removeStop"))}function Hv(e,t){1&e&&(r.TgZ(0,"button",22),r.ALo(1,"translate"),r._UZ(2,"mat-icon",23),r.qZA()),2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.directionsForm.removeStop"))}function Vv(e,t){if(1&e&&(r.TgZ(0,"div",15),r.TgZ(1,"button",16),r.ALo(2,"translate"),r._UZ(3,"mat-icon",17),r.qZA(),r.YNc(4,zv,3,3,"button",18),r.ALo(5,"async"),r.YNc(6,Hv,3,3,"button",19),r.ALo(7,"async"),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.Q6J("matTooltip",r.lcZ(2,3,"igo.geo.directionsForm.moveStop")),r.xp6(3),r.Q6J("ngIf",r.lcZ(5,5,e.stopsStore.count$)>2),r.xp6(2),r.Q6J("ngIf",r.lcZ(7,7,e.stopsStore.count$)<=2)}}function Wv(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",2),r.NdJ("touchenter",function(){const t=r.CHM(e).$implicit;return r.oxw().onStopEnter(t)})("touchleave",function(){return r.CHM(e),r.oxw().onStopLeave()})("mouseover",function(){const t=r.CHM(e).$implicit;return r.oxw().onStopEnter(t)})("mouseleave",function(){return r.CHM(e),r.oxw().onStopLeave()})("cdkDragStarted",function(){return r.CHM(e),r.oxw().stopIsDragged=!0})("cdkDragEnded",function(){return r.CHM(e),r.oxw().stopIsDragged=!1}),r.TgZ(1,"div",3),r.TgZ(2,"mat-form-field"),r.TgZ(3,"input",4),r.NdJ("focus",function(){const t=r.CHM(e).$implicit;return r.oxw().onInputFocus(t)})("ngModelChange",function(t){return r.CHM(e).$implicit.text=t})("keyup",function(t){const o=r.CHM(e).$implicit;return r.oxw().setStopText(t,o)})("keydown.enter",function(e){return e.preventDefault()}),r.qZA(),r.YNc(4,Qv,3,3,"button",5),r.TgZ(5,"mat-autocomplete",6,7),r.NdJ("optionSelected",function(t){const o=r.CHM(e).$implicit;return r.oxw().chooseProposal(t,o)}),r.YNc(7,Yv,2,3,"mat-optgroup",8),r.qZA(),r.qZA(),r.qZA(),r.YNc(8,Vv,8,9,"div",9),r.qZA()}if(2&e){const e=t.$implicit,o=r.MAs(6),i=r.oxw();r.xp6(1),r.Q6J("ngClass",i.getNgClass(e)),r.xp6(2),r.s9C("id",e.id),r.Q6J("placeholder",i.getPlaceholder(e))("matTooltip",e.text)("ngModel",e.text)("matAutocomplete",o),r.xp6(1),r.Q6J("ngIf",(e.text||e.coordinates)&&i.stopWithHover&&e.id===i.stopWithHover.id),r.xp6(3),r.Q6J("ngForOf",e.searchProposals),r.xp6(1),r.Q6J("ngIf",!i.stopIsDragged&&i.stopWithHover&&e.id===i.stopWithHover.id)}}let Xv=(()=>{class e{constructor(e){this.languageService=e,this.invalidKeys=["Control","Shift","Alt"],this.onMapClickEventKeys=[],this.stopIsDragged=!1,this.coordRoundedDecimals=6,this.debounce=200,this.length=2,this.stopInputHasFocus=new r.vpe(!1)}ngOnDestroy(){this.unlistenMapSingleClick()}onStopEnter(e){this.stopWithHover=e}onStopLeave(){this.stopWithHover=void 0}chooseProposal(e,t){const o=e.option.value;if(o){let e;const i=o.geometry;if("Point"===i.type)e=i.coordinates;else{const t=(0,nl.Z)(o.geometry);e=[t.geometry.coordinates[0],t.geometry.coordinates[1]]}e&&(t.coordinates=e,t.text=o.meta.title,this.stopsStore.update(t))}}setStopText(e,t){this.unlistenMapSingleClick();const o=e.target.value;0===o.length?this.clearStop(t):this.validateTerm(o)&&(t.text=o,this.stopsStore.update(t))}validateTerm(e){return!(!this.keyIsValid(e)||!(e.length>=this.length||0===e.length))}keyIsValid(e){return void 0===this.invalidKeys.find(t=>t===e)}getNgClass(e){return this.stopWithHover&&e.id===this.stopWithHover.id?"igo-input-container reduce":"igo-input-container"}getPlaceholder(e){let t="";return e.relativePosition?(e.relativePosition===Dv.Intermediate&&(t=" #"+e.position),this.languageService.translate.instant("igo.geo.directionsForm."+e.relativePosition)+t):""}removeStop(e){!function(e,t){e.delete(t),function(e){const t=[...e.all()];t.sort((e,t)=>e.position-t.position),t.map((e,o)=>{e.position=o,e.relativePosition=Rv(e.position,t.length)}),t&&e.updateMany(t)}(e)}(this.stopsStore,e)}clearStop(e){this.stopsStore.update({id:e.id,relativePosition:e.relativePosition,position:e.position})}drop(e){this.moveStops(e.previousIndex,e.currentIndex)}moveStops(e,t){if(e!==t){const o=[...this.stopsStore.view.all()];(0,bl.bA)(o,e,t),o.map((e,t)=>{e.relativePosition=Rv(t,o.length),e.position=t}),this.stopsStore.updateMany(o),Ev(this.stopsStore)}}onInputFocus(e){var t;(!e.text||0===(null===(t=e.text)||void 0===t?void 0:t.length))&&(this.unlistenMapSingleClick(),this.stopInputHasFocus.emit(!0),this.listenMapSingleClick(e))}listenMapSingleClick(e){const t=this.stopsFeatureStore.layer.map.ol.once("singleclick",t=>{const o=gc(kn.vs(t.coordinate,this.stopsFeatureStore.layer.map.projection,this.projection),this.coordRoundedDecimals);e.text=o.join(","),e.coordinates=o,this.stopsStore.update(e),setTimeout(()=>{this.stopInputHasFocus.emit(!1)},500)});this.onMapClickEventKeys.push(t)}unlistenMapSingleClick(){this.onMapClickEventKeys.map(e=>{ea.B(e)}),this.onMapClickEventKeys=[]}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ue))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-directions-inputs"]],inputs:{stopsStore:"stopsStore",stopsFeatureStore:"stopsFeatureStore",projection:"projection",coordRoundedDecimals:"coordRoundedDecimals",debounce:"debounce",length:"length"},outputs:{stopInputHasFocus:"stopInputHasFocus"},decls:3,vars:3,consts:[["cdkDropList","",1,"stops-list",3,"cdkDropListDropped"],["touchleave","","cdkDragLockAxis","y","class","stop-box mat-typography","cdkDrag","",3,"touchenter","touchleave","mouseover","mouseleave","cdkDragStarted","cdkDragEnded",4,"ngFor","ngForOf"],["touchleave","","cdkDragLockAxis","y","cdkDrag","",1,"stop-box","mat-typography",3,"touchenter","touchleave","mouseover","mouseleave","cdkDragStarted","cdkDragEnded"],[3,"ngClass"],["type","text","matTooltipShowDelay","500","aria-label","Number","matInput","",3,"id","placeholder","matTooltip","ngModel","matAutocomplete","focus","ngModelChange","keyup","keydown.enter"],["mat-button","","matTooltipShowDelay","500","matSuffix","","mat-icon-button","","color","warn","aria-label","Clear",3,"matTooltip","click",4,"ngIf"],[3,"optionSelected"],["auto","matAutocomplete"],[3,"label","disabled",4,"ngFor","ngForOf"],["class","igo-form-button-group",4,"ngIf"],["mat-button","","matTooltipShowDelay","500","matSuffix","","mat-icon-button","","color","warn","aria-label","Clear",3,"matTooltip","click"],["svgIcon","close"],[3,"label","disabled"],["matTooltipShowDelay","500",3,"value","matTooltip",4,"ngFor","ngForOf"],["matTooltipShowDelay","500",3,"value","matTooltip"],[1,"igo-form-button-group"],["cdkDragHandle","","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","primary",1,"swipe-vertical",3,"matTooltip"],["svgIcon","gesture-swipe-vertical"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip","click",4,"ngIf"],["disabled","true","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip","click"],["svgIcon","delete"],["disabled","true","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip"],["svgIcon","blank"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.NdJ("cdkDropListDropped",function(e){return t.drop(e)}),r.YNc(1,Wv,9,9,"div",1),r.ALo(2,"async"),r.qZA()),2&e&&(r.xp6(1),r.Q6J("ngForOf",r.lcZ(2,1,t.stopsStore.view.all$())))},directives:[bl.Wj,h.sg,bl.Zt,h.mk,De.KE,Ve.Nt,We.Fj,Xa.ZL,p.gM,We.JJ,We.On,h.O5,Xa.XC,n.lW,De.R9,a.Hw,Re.Nv,Re.ey,bl.Bh],pipes:[h.Ov,j.X$],styles:[".igo-input-container[_ngcontent-%COMP%]{width:100%}.igo-input-container[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.igo-input-container.reduce[_ngcontent-%COMP%]{width:70%}.igo-input-container.reduce[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.stops-list[_ngcontent-%COMP%]{max-width:100%;min-height:60px;display:block;background:white;border-radius:4px;overflow:hidden;padding:20px 10px}.swipe-vertical[_ngcontent-%COMP%]{cursor:move}.stop-box[_ngcontent-%COMP%]{height:60px;padding:20px 10px;color:#000000de;display:flex;flex-direction:row;align-items:center;justify-content:space-between;box-sizing:border-box;background:white}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.stops-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .stop-box[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"]}),e})(),Kv=(()=>{class e{constructor(e){this.directionsSourceService=e}route(e,t={}){if(0!==e.length)return this.directionsSourceService.sources.filter(e=>e.enabled).map(o=>this.routeSource(o,e,t))}routeSource(e,t,o={}){return e.route(t,o)}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(kv))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function eb(e){return void 0!==e.search}function tb(e){return void 0!==e.reverseSearch}function ob(e){return void 0!==e.reverseSearch&&!0===e.showInPointerSummary}function ib(e,t){let o="";return t.split("").forEach((t,i)=>{t!==e.charAt(i)&&(o+=t)}),o}function rb(e,t,o=!1){if(!e||!t)return 0;const i=o?e:e.toLowerCase(),r=o?t:t.toLowerCase(),s=ib(i,r)+ib(r,i);let n=0;return s.length&&(n=s.length/i.length*100),100-Math.floor(n)}class sb{constructor(e){this.sources=e}getSources(){return this.sources}getEnabledSources(){return this.getSources().filter(e=>!0===e.enabled)}enableSourcesByType(e){this.getSources().forEach(t=>{t.enabled=t.constructor.type===e})}setParamFromSetting(e,t){e.setParamFromSetting(t)}}let nb=(()=>{class e{constructor(e,t){this.searchSourceService=e,this.mapService=t}search(e,t={}){var o,i;if(!this.termIsValid(e))return[];const r=cc(e,(null===(o=this.mapService.getMap())||void 0===o?void 0:o.projection)||"EPSG:3857",{forceNA:t.forceNA});if(r.lonLat)return this.reverseSearch(r.lonLat,{distance:r.radius,conf:r.conf});let s;return r.message&&console.log(r.message),t.extent=null===(i=this.mapService.getMap())||void 0===i?void 0:i.viewController.getExtent("EPSG:4326"),s=t.getEnabledOnly||void 0===t.getEnabledOnly?this.searchSourceService.getEnabledSources():this.searchSourceService.getSources(),t.sourceId?s=s.filter(e=>e.getId()===t.sourceId):t.searchType&&(s=s.filter(e=>e.getType()===t.searchType)),s=s.filter(eb),this.searchSources(s,e,t)}reverseSearch(e,t,o=!1){const i=o?ob:tb,r=this.searchSourceService.getEnabledSources().filter(i);return this.reverseSearchSources(r,e,t||{})}searchSources(e,t,o){return e.map(e=>({request:e.search(t,o),reverse:!1,source:e}))}reverseSearchSources(e,t,o){return e.map(e=>({request:e.reverseSearch(t,o),reverse:!0,source:e}))}termIsValid(e){return"string"==typeof e&&""!==e}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(sb),r.LFG(Pc))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function ab(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",5),r.NdJ("click",function(){return r.CHM(e),r.oxw().resetStops()}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",6),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.directionsForm.resetDirectionsBtn"))}function lb(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",1),r.NdJ("click",function(){return r.CHM(e),r.oxw().zoomRoute()}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",7),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.directionsForm.zoomRoute"))}function cb(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",1),r.NdJ("click",function(){return r.CHM(e),r.oxw().copyDirectionsToClipboard()}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",8),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.directionsForm.copy"))}function ub(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",1),r.NdJ("click",function(){return r.CHM(e),r.oxw().copyLinkToClipboard()}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",9),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.geo.directionsForm.link"))}let pb=(()=>{class e{constructor(e,t,o){this.languageService=e,this.messageService=t,this.route=o,this.zoomToActiveRoute$=new O.xQ}get activeRoute(){return this.routesFeatureStore.all().find(e=>e.properties.active)}resetStops(){this.stopsStore.clearStops()}addStop(){Uv(this.stopsStore)}copyLinkToClipboard(){if(P.copy(this.getUrl())){const e=this.languageService.translate,t=e.instant("igo.geo.directionsForm.dialog.copyTitle"),o=e.instant("igo.geo.directionsForm.dialog.copyMsgLink");this.messageService.success(o,t)}}zoomRoute(){this.zoomToActiveRoute$.next()}copyDirectionsToClipboard(){const e=this.directionsToText();if(P.copy(e)){const e=this.languageService.translate,t=e.instant("igo.geo.directionsForm.dialog.copyTitle"),o=e.instant("igo.geo.directionsForm.dialog.copyMsg");this.messageService.success(o,t)}}directionsToText(){const e="\t";let t=this.languageService.translate.instant("igo.geo.directionsForm.instructions")+":\n",o="";const i=this.languageService.translate.instant("igo.geo.directionsForm.summary")+": \n"+e+this.activeRoute.properties.direction.title+"\n"+e+Jv(this.activeRoute.properties.direction.distance)+"\n"+e+Bv(this.activeRoute.properties.direction.duration)+"\n\n"+this.languageService.translate.instant("igo.geo.directionsForm.stopsList")+":\n",r=this.languageService.translate.instant("igo.geo.directionsForm.link")+":\n"+e+this.getUrl();let s=1;this.stopsStore.view.all().forEach(t=>{let i="",r="";t.text!==t.coordinates.join(",")?(r=t.text,i=` ( ${t.coordinates.join(",")} )`):r=t.coordinates.join(","),o=o+e+s.toLocaleString()+". "+r+i+"\n",s++});let n=0;return this.activeRoute.properties.direction.steps.forEach(o=>{const i=this.formatStep(o,n).instruction,r=void 0===Jv(o.distance)?"":" ("+Jv(o.distance)+")";t=t+e+(n+1).toLocaleString()+". "+i+r+"\n",n++}),i+o+"\n"+r+"\n\n"+t}formatStep(e,t){return jv(e.maneuver.type,e.maneuver.modifier,e.name,e.maneuver.bearing_after,t,e.maneuver.exit,this.languageService,t===this.activeRoute.properties.direction.steps.length-1)}getUrl(){if(!this.route)return;const e=this.routesFeatureStore.all().map(e=>e.properties.id).indexOf(this.activeRoute.properties.id);let t="";0!==e&&(t=`&${this.route.options.directionsOptionsKey}=result:${e}`);const o=this.route.options.directionsCoordKey,i=this.stopsStore.view.all().map(e=>e.coordinates);let r="";return i.length>=2?(r=`${o}=${i.join(";")}`,`${location.origin}${location.pathname}?tool=directions&sidenav=1&${r}${t}`):void 0}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ue),r.Y36(de),r.Y36(fe,8))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-directions-buttons"]],inputs:{zoomToActiveRoute$:"zoomToActiveRoute$",stopsStore:"stopsStore",routesFeatureStore:"routesFeatureStore"},decls:13,vars:17,consts:[[1,"igo-form-button-group"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","primary",3,"matTooltip","click"],["svgIcon","map-marker-plus"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","primary",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip","click"],["svgIcon","file-restore"],["svgIcon","magnify-plus-outline"],["svgIcon","content-copy"],["svgIcon","link"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"button",1),r.NdJ("click",function(){return t.addStop()}),r.ALo(2,"translate"),r._UZ(3,"mat-icon",2),r.qZA(),r.YNc(4,ab,3,3,"button",3),r.ALo(5,"async"),r.ALo(6,"async"),r.YNc(7,lb,3,3,"button",4),r.ALo(8,"async"),r.YNc(9,cb,3,3,"button",4),r.ALo(10,"async"),r.YNc(11,ub,3,3,"button",4),r.ALo(12,"async"),r.qZA()),2&e&&(r.xp6(1),r.Q6J("matTooltip",r.lcZ(2,5,"igo.geo.directionsForm.addStop")),r.xp6(3),r.Q6J("ngIf",r.lcZ(5,7,t.routesFeatureStore.count$)>=1||r.lcZ(6,9,t.stopsStore.count$)>=1),r.xp6(3),r.Q6J("ngIf",r.lcZ(8,11,t.routesFeatureStore.count$)>=1),r.xp6(2),r.Q6J("ngIf",r.lcZ(10,13,t.routesFeatureStore.count$)>=1),r.xp6(2),r.Q6J("ngIf",r.lcZ(12,15,t.routesFeatureStore.count$)>=1))},directives:[n.lW,p.gM,a.Hw,h.O5],pipes:[j.X$,h.Ov],styles:[""]}),e})();function db(e,t){if(1&e&&(r.TgZ(0,"mat-option",9),r._uU(1),r.qZA()),2&e){const e=t.$implicit,o=t.index,i=r.oxw(3);r.Q6J("value",e),r.xp6(1),r.lnq(" Option ",o+1," : ",i.formatDistance(e.distance)," (",i.formatDuration(e.duration),") ")}}function hb(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-form-field"),r.TgZ(1,"mat-select",7),r.NdJ("selectionChange",function(){return r.CHM(e),r.oxw(2).changeRoute()})("ngModelChange",function(t){return r.CHM(e),r.oxw(2).activeDirection=t}),r.ALo(2,"translate"),r.YNc(3,db,2,4,"mat-option",8),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(2);r.xp6(1),r.s9C("placeholder",r.lcZ(2,3,"igo.geo.directionsForm.drivingOptions")),r.Q6J("ngModel",e.activeDirection),r.xp6(2),r.Q6J("ngForOf",e.directions)}}function gb(e,t){1&e&&r._UZ(0,"mat-divider")}function mb(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-list-item",10),r.NdJ("mouseenter",function(){const t=r.CHM(e).$implicit;return r.oxw(2).showSegment(t)})("click",function(){const t=r.CHM(e).$implicit;return r.oxw(2).showSegment(t,!0)}),r._UZ(1,"mat-icon",11),r.TgZ(2,"h4",12),r._uU(3),r.qZA(),r.TgZ(4,"h4",13),r._uU(5),r.qZA(),r.qZA()}if(2&e){const e=t.$implicit,o=t.index,i=r.oxw(2);r.xp6(1),r.s9C("svgIcon",i.formatStep(e,o).image),r.Q6J("ngClass",i.formatStep(e,o).cssClass),r.xp6(2),r.AsE("",o+1,". ",i.formatStep(e,o).instruction,""),r.xp6(2),r.Oqu(i.formatDistance(e.distance))}}function fb(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",1),r.YNc(1,hb,4,5,"mat-form-field",2),r.YNc(2,gb,1,0,"mat-divider",2),r.TgZ(3,"mat-list",3),r.NdJ("mouseleave",function(){return r.CHM(e),r.oxw().onStepsListBlur()}),r.TgZ(4,"h2",4),r._uU(5),r.qZA(),r.TgZ(6,"h2",5),r._uU(7),r.qZA(),r.YNc(8,mb,6,5,"mat-list-item",6),r._UZ(9,"mat-divider"),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(1),r.Q6J("ngIf",e.directions&&e.directions.length>1),r.xp6(1),r.Q6J("ngIf",e.directions&&0===e.directions.length),r.xp6(3),r.Oqu(e.activeDirection.title),r.xp6(2),r.AsE("",e.formatDistance(e.activeDirection.distance),", ",e.formatDuration(e.activeDirection.duration),""),r.xp6(1),r.Q6J("ngForOf",e.activeDirection.steps)}}let yb=(()=>{class e{constructor(e,t){this.languageService=e,this.cdRef=t}ngOnInit(){this.entities$$=this.routesFeatureStore.entities$.pipe((0,w.b)(200)).subscribe(e=>{const t=e.find(e=>e.properties.active);this.directions=e.map(e=>e.properties.direction),this.activeDirection=t?t.properties.direction:void 0,this.cdRef.detectChanges()})}ngOnDestroy(){this.entities$$.unsubscribe()}changeRoute(){this.routesFeatureStore.entities$.value.map(e=>e.properties.active=!e.properties.active),this.routesFeatureStore.layer.ol.getSource().getFeatures().map(e=>e.set("active",!e.get("active")))}formatDistance(e){return Jv(e)}formatDuration(e){return Bv(e)}formatStep(e,t){return jv(e.maneuver.type,e.maneuver.modifier,e.name,e.maneuver.bearing_after,t,e.maneuver.exit,this.languageService,t===this.activeDirection.steps.length-1)}onStepsListBlur(){this.stepFeatureStore.clear()}showSegment(e,t=!1){this.showRouteSegmentGeometry(e,t)}showRouteSegmentGeometry(e,t=!1){const o="vertex",i=new Wn.Z(e.geometry.coordinates).transform("EPSG:4326",this.stepFeatureStore.layer.map.projection).getCoordinates()[0],r=new _n.Z(i),s=new Fn.Z({geometry:r}),n=(new Xn.Z).writeGeometryObject(r,{featureProjection:this.stepFeatureStore.layer.map.projection,dataProjection:this.stepFeatureStore.layer.map.projection}),a=this.stepFeatureStore.get(o);this.stepFeatureStore.update({type:Zl,geometry:n,projection:this.stepFeatureStore.layer.map.projection,properties:{id:o,step:e,type:qv.Vertex},meta:{id:o,revision:(a?a.meta.revision:0)+1},ol:s}),t&&this.stepFeatureStore.layer.map.viewController.zoomToExtent(s.getGeometry().getExtent())}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ue),r.Y36(r.sBO))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-directions-results"]],inputs:{routesFeatureStore:"routesFeatureStore",stepFeatureStore:"stepFeatureStore"},decls:1,vars:1,consts:[["class","igo-input-container",4,"ngIf"],[1,"igo-input-container"],[4,"ngIf"],[3,"mouseleave"],["mat-header","",1,"igo-route-title","mat-typography"],["mat-subheader",""],["class","igo-steps","igoListItem","",3,"mouseenter","click",4,"ngFor","ngForOf"],[3,"placeholder","ngModel","selectionChange","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["igoListItem","",1,"igo-steps",3,"mouseenter","click"],["mat-list-icon","",3,"ngClass","svgIcon"],["mat-line",""],["mat-line","",1,"right"]],template:function(e,t){1&e&&r.YNc(0,fb,10,6,"div",0),2&e&&r.Q6J("ngIf",t.directions&&t.activeDirection)},directives:[h.O5,l.i$,l.gs,h.sg,Ha.d,De.KE,Ee.gD,We.JJ,We.On,Re.ey,l.Tg,a.Hw,l.Nh,h.mk,Re.X2],pipes:[j.X$],styles:[".igo-input-container[_ngcontent-%COMP%]{width:100%;padding:20px 10px}.igo-input-container[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:70%}.igo-route-title[_ngcontent-%COMP%]{font-weight:bold}.igo-steps[_ngcontent-%COMP%]{cursor:pointer}.mat-line[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:pre-wrap!important}.mat-line.right[_ngcontent-%COMP%]{text-align:right}.rotate-90[_ngcontent-%COMP%]{transform:rotate(90deg)}.rotate-45[_ngcontent-%COMP%]{transform:rotate(45deg)}.rotate-270[_ngcontent-%COMP%]{transform:rotate(270deg)}.rotate-250[_ngcontent-%COMP%]{transform:rotate(250deg)}.rotate-290[_ngcontent-%COMP%]{transform:rotate(290deg)}.icon-flipped[_ngcontent-%COMP%]{transform:scaleY(-1)}"]}),e})(),vb=(()=>{class e{constructor(e,t,o,i){this.cdRef=e,this.languageService=t,this.directionsService=o,this.searchService=i,this.projection="EPSG:4326",this.routesQueries$$=[],this.focusOnStop=!1,this.isTranslating=!1,this.previousStops=[],this.debounce=200,this.length=2,this.coordRoundedDecimals=6,this.zoomToActiveRoute$=new O.xQ}ngOnInit(){this.initEntityStores(),setTimeout(()=>{(function(e,t){const o=new Yc({motion:Fl.None});Bc(e,new fc({id:"igo-direction-stops-layer",title:t.translate.instant("igo.geo.directionsForm.stopLayer"),zIndex:911,source:new nc,showInLayerList:!0,workspace:{enabled:!1},linkedLayers:{linkId:"igo-direction-stops-layer",links:[{bidirectionnal:!1,syncedDelete:!0,linkedIds:["igo-direction-route-layer"],properties:[]}]},exportable:!0,browsable:!1,style:Nv})),e.layer.visible=!0,Wc(e,o)})(this.stopsFeatureStore,this.languageService),function(e,t){const o=new Yc({motion:Fl.None});Bc(e,new fc({id:"igo-direction-route-layer",title:t.translate.instant("igo.geo.directionsForm.routeLayer"),zIndex:910,source:new nc,showInLayerList:!0,workspace:{enabled:!1},linkedLayers:{linkId:"igo-direction-route-layer"},exportable:!0,browsable:!1,style:Nv})),e.layer.visible=!0,Wc(e,o)}(this.routesFeatureStore,this.languageService),function(e){const t=new Yc({motion:Fl.None});Bc(e,new fc({id:"igo-direction-step-layer",title:"",zIndex:910,source:new nc,showInLayerList:!1,workspace:{enabled:!1},linkedLayers:{linkId:"igo-direction-route-layer"},exportable:!1,browsable:!1,style:Nv})),e.layer.visible=!0,Wc(e,t)}(this.stepFeatureStore),this.initOlInteraction()},1)}ngOnDestroy(){this.storeEmpty$$.unsubscribe(),this.storeChange$$.unsubscribe(),this.routesQueries$$.map(e=>e.unsubscribe()),this.zoomRoute$$.unsubscribe(),this.freezeStores()}freezeStores(){this.stopsFeatureStore.layer.map.ol.removeInteraction(this.selectStopInteraction),this.stopsFeatureStore.layer.map.ol.removeInteraction(this.translateStop),this.routesFeatureStore.layer.map.ol.removeInteraction(this.selectedRoute),this.stopsFeatureStore.deactivateStrategyOfType(Yc),this.routesFeatureStore.deactivateStrategyOfType(Yc),this.stepFeatureStore.deactivateStrategyOfType(Yc)}initEntityStores(){this.watcher=new ht(this.stopsStore,this.cdRef),this.monitorEmptyEntityStore(),this.monitorEntityStoreChange(),this.monitorActiveRouteZoom()}monitorActiveRouteZoom(){this.zoomRoute$$=this.zoomToActiveRoute$.subscribe(()=>{if(this.routesFeatureStore.count>=1){const e=this.routesFeatureStore.all().find(e=>e.properties.active);if(e){e.ol.getGeometry();const t=e.ol.getGeometry().getExtent();this.routesFeatureStore.layer.map.viewController.zoomToExtent(t)}}})}initOlInteraction(){this.selectStopInteraction=new qn.Z({layers:[this.stopsFeatureStore.layer.ol],hitTolerance:7,condition:e=>"pointermove"===e.type&&!e.dragging}),this.translateStop=new Dn.Z({features:this.selectStopInteraction.getFeatures()}),this.translateStop.on("translating",e=>{this.isTranslating=!0,this.executeStopTranslation(e.features)}),this.translateStop.on("translateend",e=>{this.isTranslating=!1,this.executeStopTranslation(e.features)}),this.selectedRoute=new qn.Z({layers:[this.routesFeatureStore.layer.ol],condition:il.V4,hitTolerance:7,filter:e=>e.get("type")===qv.Route&&e.get("active")&&!this.isTranslating}),this.selectedRoute.on("select",e=>{if(!1===this.focusOnStop){const t=gc(kn.vs(e.mapBrowserEvent.coordinate,this.routesFeatureStore.layer.map.projection,this.projection),this.coordRoundedDecimals),o=Uv(this.stopsStore);o.text=t.join(","),o.coordinates=[t[0],t[1]]}}),this.stopsFeatureStore.layer.map.ol.addInteraction(this.selectStopInteraction),this.stopsFeatureStore.layer.map.ol.addInteraction(this.translateStop),this.routesFeatureStore.layer.map.ol.addInteraction(this.selectedRoute)}onStopInputHasFocusChange(e){e?this.routesFeatureStore.layer.map.ol.removeInteraction(this.selectedRoute):this.routesFeatureStore.layer.map.ol.addInteraction(this.selectedRoute)}executeStopTranslation(e){if(0===e.getLength())return;const t=e.getArray()[0],o=t.getId(),i=kn.vs(t.getGeometry().getCoordinates(),this.stopsFeatureStore.layer.map.projection,this.projection),r=this.stopsStore.get(o),s=gc(i,this.coordRoundedDecimals);r.coordinates=s,r.text=s.join(","),this.stopsStore.update(r)}monitorEmptyEntityStore(){this.storeEmpty$$=this.stopsStore.count$.pipe((0,M.x)()).subscribe(e=>{if(e<2){if(Uv(this.stopsStore),2===this.stopsStore.count)return void this.stopsStore.storeInitialized$.next(!0);this.stopsStore.storeInitialized$.next(!1)}this.routesQueries$$.map(e=>e.unsubscribe())})}monitorEntityStoreChange(){this.storeChange$$=this.stopsStore.entities$.pipe((0,w.b)(this.debounce)).subscribe(e=>{this.handleStopDiff(e),Ev(this.stopsStore),this.handleStopsFeature(),this.getRoutes(this.isTranslating)})}handleStopDiff(e){const t=e.map(e=>D.removeUndefined(Object.assign({id:e.id,text:e.text,coordinates:e.coordinates}))),o=q.findChanges(this.previousStops,t,["coordinates"]),i=o.added.concat(o.modified);i&&i.map(e=>{const t=e.newValue;t&&function(e,t,o,i){if(!e)return;const r=e.text;if(!r||0===r.length)return;const s=cc(r,"EPSG:3857");let n,a=!1;s.lonLat&&(a=!0),n=t.search(r,{searchType:"Feature"}),o&&o.unsubscribe();const l=n.map(e=>e.request.pipe((0,x.U)(e=>e.filter(e=>a?"Point"===e.data.geometry.type&&e.data.geometry:e.data.geometry))));o=(0,bn.$R)(...l).pipe((0,x.U)(e=>[].concat.apply([],e)),(0,x.U)(t=>{const o=[];[...new Set(t.map(e=>e.source))].map(e=>{o.push({source:e,meta:t.find(t=>t.source===e).meta,results:t.filter(t=>t.source===e).map(e=>e.data)})}),e.searchProposals=o})).subscribe(()=>i.detectChanges())}(this.stopsStore.get(t.id),this.searchService,this.search$$,this.cdRef)}),this.previousStops=t}handleStopsFeature(){const e=this.stopsStore.all();e.filter(e=>e.coordinates).map(e=>this.addStopOverlay(e)),this.stopsFeatureStore.all().map(e=>{this.stopsStore.get(e.properties.id)||this.stopsFeatureStore.delete(e)}),e.filter(e=>!e.coordinates).map(e=>{const t=this.stopsFeatureStore.get(e.id);t&&this.stopsFeatureStore.delete(t)})}getRoutes(e=!1){const t=this.stopsStore.view.all().filter(e=>e.coordinates);if(t.length<2)return void this.routesFeatureStore.deleteMany(this.routesFeatureStore.all());const o=t.map(e=>gc(e.coordinates,this.coordRoundedDecimals));this.routesQueries$$.map(e=>e.unsubscribe());const i=this.directionsService.route(o,e?{overview:!0,steps:!1,alternatives:!1}:void 0);i&&i.map(e=>this.routesQueries$$.push(e.subscribe(e=>{this.routesFeatureStore.deleteMany(this.routesFeatureStore.all()),e.map(t=>function(e,t,o,i=!1,r=!1){const s=new Wn.Z(t.geometry.coordinates).transform(o,e.map.projection),n=(new Xn.Z).writeGeometryObject(s,{featureProjection:e.map.projection,dataProjection:e.map.projection}),a=e.get(t.id),l={type:Zl,geometry:n,projection:e.map.projection,properties:{id:t.id,type:qv.Route,active:i,direction:t},meta:{id:t.id,revision:(a?a.meta.revision:0)+1},ol:new Fn.Z({geometry:s})};e.update(l)}(this.routesFeatureStore,t,this.projection,t===e[0]))})))}addStopOverlay(e){!function(e,t,o,i,r){let s,n;switch(e.relativePosition){case Dv.Start:s="#008000",n=r.translate.instant("igo.geo.directionsForm.start");break;case Dv.End:s="#f64139",n=r.translate.instant("igo.geo.directionsForm.end");break;default:s="#ffd700",n=r.translate.instant("igo.geo.directionsForm.intermediate")+" #"+e.position}const a=new _n.Z(kn.vs(e.coordinates,i,o.map.projection)),l=(new Xn.Z).writeGeometryObject(a,{featureProjection:o.map.projection,dataProjection:o.map.projection}),c=o.get(e.id),u={type:Zl,geometry:l,projection:o.map.projection,properties:{id:e.id,type:qv.Stop,stopText:n,stopColor:s,stopOpacity:1,stop:e},meta:{id:e.id,revision:(c?c.meta.revision:0)+1},ol:new Fn.Z({geometry:a})};o.update(u)}(e,0,this.stopsFeatureStore,this.projection,this.languageService)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.sBO),r.Y36(ue),r.Y36(Kv),r.Y36(nb))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-directions"]],inputs:{stopsStore:"stopsStore",stopsFeatureStore:"stopsFeatureStore",routesFeatureStore:"routesFeatureStore",stepFeatureStore:"stepFeatureStore",debounce:"debounce",length:"length",coordRoundedDecimals:"coordRoundedDecimals",zoomToActiveRoute$:"zoomToActiveRoute$"},decls:4,vars:11,consts:[[3,"zoomToActiveRoute$","routesFeatureStore","stopsStore"],[3,"coordRoundedDecimals","projection","stopsFeatureStore","stopsStore","debounce","length","stopInputHasFocus"],[3,"stepFeatureStore","routesFeatureStore"]],template:function(e,t){1&e&&(r._UZ(0,"igo-directions-buttons",0),r.TgZ(1,"igo-directions-inputs",1),r.NdJ("stopInputHasFocus",function(e){return t.onStopInputHasFocusChange(e)}),r.qZA(),r._UZ(2,"br"),r._UZ(3,"igo-directions-results",2)),2&e&&(r.Q6J("zoomToActiveRoute$",t.zoomToActiveRoute$)("routesFeatureStore",t.routesFeatureStore)("stopsStore",t.stopsStore),r.xp6(1),r.Q6J("coordRoundedDecimals",t.coordRoundedDecimals)("projection",t.projection)("stopsFeatureStore",t.stopsFeatureStore)("stopsStore",t.stopsStore)("debounce",t.debounce)("length",t.length),r.xp6(2),r.Q6J("stepFeatureStore",t.stepFeatureStore)("routesFeatureStore",t.routesFeatureStore))},directives:[pb,Xv,yb],styles:[""]}),e})(),bb=(()=>{class e{static forRoot(){return{ngModule:e}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[{provide:kv,useFactory:Pv,deps:[Iv]}],imports:[[h.ez,bl._t,We.u5,We.UX,a.Ps,n.ot,l.ie,Ha.t,De.lN,Ve.c,Re.Ng,Ee.LD,p.AV,Xa.Bb,ne]]}),e})();function xb(e){return new sb(e)}let wb=(()=>{class e{constructor(e){this.languageService=e}formatResult(e){return e}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(ue))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})();class Sb{encodeKey(e){return encodeURIComponent(e)}encodeValue(e){return encodeURIComponent(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}let Cb=(()=>{class e extends ju{constructor(e,t,o,i,r,s){super(i,o),this.http=e,this.languageService=t,this.formatter=r,this.title$=new C.X(""),this.hashtagsLieuxToKeep=[],this.languageService.translate.get(this.options.title).subscribe(e=>this.title$.next(e));const n=s.get(Rs);this.settings.length&&(n?n.authenticate$.subscribe(()=>{this.getAllowedTypes()}):this.getAllowedTypes())}get title(){return this.title$.getValue()}getId(){return e.id}getType(){return e.type}getDefaultOptions(){var e;const t=this.options.params&&this.options.params.limit?Number(this.options.params.limit):void 0,o=this.options.params&&this.options.params.ecmax?Number(this.options.params.ecmax):void 0,i=(null===(e=this.options.params)||void 0===e?void 0:e.type)?this.options.params.type.replace(/\s/g,"").toLowerCase().split(","):["adresses","codes-postaux","routes","intersections","municipalites","mrc","regadmin","lieux"];return{title:"igo.geo.search.icherche.name",searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/icherche",settings:[{type:"checkbox",title:"results type",name:"type",values:[{title:"igo.geo.search.icherche.type.address",value:"adresses",enabled:-1!==i.indexOf("adresses"),hashtags:["adresse"]},{title:"igo.geo.search.icherche.type.oldAddress",value:"anciennes-adresses",enabled:-1!==i.indexOf("anciennes-adresses"),hashtags:["anciennes-adresses"]},{title:"igo.geo.search.icherche.type.postalCode",value:"codes-postaux",enabled:-1!==i.indexOf("codes-postaux"),hashtags:["code-postal"]},{title:"igo.geo.search.icherche.type.road",value:"routes",enabled:-1!==i.indexOf("routes"),hashtags:["route"]},{title:"igo.geo.search.icherche.type.intersection",value:"intersections",enabled:-1!==i.indexOf("intersections"),hashtags:["intersection","+"]},{title:"igo.geo.search.icherche.type.city",value:"municipalites",enabled:-1!==i.indexOf("municipalites"),hashtags:["municipalit\xe9","mun"]},{title:"igo.geo.search.icherche.type.oldCity",value:"anciennes-municipalites",enabled:-1!==i.indexOf("anciennes-municipalites"),hashtags:["anciennes-municipalites"]},{title:"igo.geo.search.icherche.type.mrc",value:"mrc",enabled:-1!==i.indexOf("mrc"),hashtags:["mrc"]},{title:"igo.geo.search.icherche.type.regadmin",value:"regadmin",enabled:-1!==i.indexOf("regadmin"),hashtags:["r\xe9gion-administrative","regadmin"]},{title:"igo.geo.search.icherche.type.entreprise",value:"entreprises",enabled:-1!==i.indexOf("entreprises"),available:!1,hashtags:["entreprise"]},{title:"igo.geo.search.icherche.type.place",value:"lieux",enabled:-1!==i.indexOf("lieux"),hashtags:["lieu"]},{title:"igo.geo.search.icherche.type.exit",value:"sorties-autoroute",enabled:-1!==i.indexOf("sorties-autoroute"),hashtags:["sortie","sorties","exit"]},{title:"igo.geo.search.icherche.type.km",value:"bornes-km",enabled:-1!==i.indexOf("bornes-km"),hashtags:["borne","bornes","rep\xe8re","km"]},{title:"igo.geo.search.icherche.type.gcc",value:"bornes-gcc",enabled:-1!==i.indexOf("bornes-gcc"),hashtags:["borne","bornes","rep\xe8re","gcc","ccg"]},{title:"igo.geo.search.icherche.type.cn",value:"bornes-cn",enabled:-1!==i.indexOf("bornes-cn"),hashtags:["borne","bornes","cn"]},{title:"igo.geo.search.icherche.type.sumi",value:"bornes-sumi",enabled:-1!==i.indexOf("bornes-sumi"),hashtags:["borne","bornes","sumi"]},{title:"igo.geo.search.icherche.type.hq",value:"hq",enabled:-1!==i.indexOf("hq"),hashtags:["hq"]},{title:"igo.geo.search.icherche.type.cadastre",value:"cadastre",enabled:-1!==i.indexOf("cadastre"),hashtags:["cadastre"]}]},{type:"radiobutton",title:"results limit",name:"limit",values:[{title:"1",value:1,enabled:1===t},{title:"5",value:5,enabled:5===t||!t},{title:"10",value:10,enabled:10===t},{title:"25",value:25,enabled:25===t},{title:"50",value:50,enabled:50===t}]},{type:"radiobutton",title:"ecmax",name:"ecmax",values:[{title:"10 %",value:10,enabled:10===o},{title:"30 %",value:30,enabled:30===o||!o},{title:"50 %",value:50,enabled:50===o},{title:"75 %",value:75,enabled:75===o},{title:"100 %",value:100,enabled:100===o}]},{type:"radiobutton",title:"restrictExtent",name:"loc",values:[{title:"igo.geo.search.icherche.restrictExtent.map",value:"true",enabled:!1},{title:"igo.geo.search.icherche.restrictExtent.quebec",value:"false",enabled:!0}]}]}}search(e,t){const o=this.computeRequestParams(e,t||{});return o.get("type").length?(this.options.params.page=o.get("page")||"1",this.http.get(`${this.searchUrl}/geocode`,{params:o}).pipe((0,x.U)(t=>this.extractResults(t,e)),(0,b.K)(e=>{throw e.error.toDisplay=!0,e.error.title=this.languageService.translate.instant(this.getDefaultOptions().title),e}))):(0,A.of)([])}getAllowedTypes(){return this.http.get(`${this.searchUrl}/types`).subscribe(e=>{const t=this.settings.find(e=>"type"===e.name);t.values.forEach(t=>{const o=new RegExp(`^${t.value}(\\.|$)`),i=e.filter(e=>o.test(e));t.available=i.length>0,"lieux"===t.value&&(this.hashtagsLieuxToKeep=[...new Set(i.map(e=>e.split(".")).reduce((e,t)=>e.concat(t)).filter(e=>"lieux"!==e))])}),this.setParamFromSetting(t,!1)})}computeRequestParams(e,t){const o=Object.assign({geometry:!0,bbox:!0,icon:!0,type:"adresses,codes-postaux,municipalites,mrc,regadmin,lieux,entreprises,bornes-sumi"},this.params,this.computeOptionsParam(e,t||{}).params,{q:this.computeTerm(e),page:t.page});if("true"===o.loc){const[e,i,r,s]=t.extent;o.loc=`${e},${i};${r},${i};${r},${s};${e},${s};${e},${i}`}else"false"===o.loc&&delete o.loc;return/#[A-Za-z]+/.test(o.q)&&(o.type="lieux"),new y.LE({fromObject:D.removeUndefined(o),encoder:new Sb})}extractResults(e,t){return e.features.map(o=>this.formatter.formatResult(this.dataToResult(o,t,e)))}dataToResult(e,t,o){const i=this.computeProperties(e),r=[this.getId(),i.type,i.code].join(".");return{source:this,data:{type:Zl,projection:"EPSG:4326",geometry:e.geometry,extent:e.bbox,properties:i,meta:{id:r,title:e.properties.nom}},meta:{dataType:Zl,id:r,title:e.properties.nom,titleHtml:(e.highlight.title||e.properties.nom)+(e.highlight.title2?" <small> "+e.highlight.title2+"</small>":"")+(e.highlight.title3?"<br><small> "+e.highlight.title3+"</small>":""),icon:e.icon||"map-marker",score:e.score||rb(t.trim(),e.properties.nom),nextPage:o.features.length%+this.options.params.limit==0&&+this.options.params.page<10}}}computeProperties(t){const o=D.removeKeys(t.properties,e.propertiesBlacklist);if(!t.geometry)return Object.assign({type:t.index},o);const i={GoogleMaps:""};let r,s;if("Point"===t.geometry.type)r=Gu.getGoogleMapsCoordLink(t.geometry.coordinates[0],t.geometry.coordinates[1]);else{const e=(0,nl.Z)(t.geometry);r=Gu.getGoogleMapsCoordLink(e.geometry.coordinates[0],e.geometry.coordinates[1])}s=Gu.getGoogleMapsNameLink("routes"===t.index?t.properties.nom+", "+t.properties.municipalite:"municipalites"===t.index?t.properties.nom+", ville":"mrc"===t.index?"mrc+"+t.properties.nom:"regadmin"===t.index?t.properties.nom+",+QC":t.properties.nom||t.highlight.title),i.GoogleMaps="<a href="+r+' target="_blank">'+this.languageService.translate.instant("igo.geo.searchByCoord")+"</a> <br /> <a href="+s+' target="_blank">'+this.languageService.translate.instant("igo.geo.searchByName")+"</a>","Point"===t.geometry.type&&(i.GoogleStreetView=Gu.getGoogleStreetViewLink(t.geometry.coordinates[0],t.geometry.coordinates[1]));const n={Route:'<span class="routing"> <u>'+this.languageService.translate.instant("igo.geo.seeRouting")+"</u> </span>"};return Object.assign({type:t.index},o,i,n)}computeTerm(e){let t=!1;return t=(e.match(/(#[A-Za-z]+)/g)||[]).some(e=>{const t=e.substring(1);return this.hashtagsLieuxToKeep.some(e=>e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")===t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""))}),t||(e=e.replace(/(#[A-Za-z]+)/g,"")),e.replace(/[^\w\xc0-\xff !\-\+\(\)\.\/\xbd\xbc\xbe,'#]+/g,"")}computeOptionsParam(e,t){const o=super.getHashtagsValid(e,"type");return o&&(t.params=Object.assign(t.params||{},{type:o.join(",")})),t}}return e.id="icherche",e.type=Zl,e.propertiesBlacklist=[],e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(ue),r.LFG(Se),r.LFG("options"),r.LFG(wb),r.LFG(r.zs3))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),(0,je.gn)([(0,Qe.q)({maxCacheCount:20})],e.prototype,"search",null),e})(),Tb=(()=>{class e extends ju{constructor(e,t,o,i,r){super(i,o),this.http=e,this.languageService=t,this.title$=new C.X(""),this.languageService.translate.get(this.options.title).subscribe(e=>this.title$.next(e));const s=r.get(Rs);this.settings.length&&(s?s.authenticate$.subscribe(()=>{this.getAllowedTypes()}):this.getAllowedTypes())}get title(){return this.title$.getValue()}getId(){return e.id}getType(){return e.type}getDefaultOptions(){const e=this.options.params&&this.options.params.type?this.options.params.type.replace(/\s/g,"").toLowerCase().split(","):["adresses","municipalites","mrc","regadmin"];return{title:"igo.geo.search.ichercheReverse.name",searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/terrapi",settings:[{type:"checkbox",title:"results type",name:"type",values:[{title:"igo.geo.search.icherche.type.address",value:"adresses",enabled:-1!==e.indexOf("adresses")},{title:"igo.geo.search.icherche.type.road",value:"routes",enabled:-1!==e.indexOf("routes"),available:!1},{title:"igo.geo.search.icherche.type.district",value:"arrondissements",enabled:-1!==e.indexOf("arrondissements")},{title:"igo.geo.search.icherche.type.city",value:"municipalites",enabled:-1!==e.indexOf("municipalites")},{title:"igo.geo.search.icherche.type.mrc",value:"mrc",enabled:-1!==e.indexOf("mrc")},{title:"igo.geo.search.icherche.type.regadmin",value:"regadmin",enabled:-1!==e.indexOf("regadmin")}]},{type:"radiobutton",title:"radius",name:"bufferInput",values:[{title:"100 m",value:100,enabled:!this.options.distance||100===this.options.distance},{title:"500 m",value:500,enabled:500===this.options.distance},{title:"1 km",value:1e3,enabled:1e3===this.options.distance},{title:"2 km",value:2e3,enabled:2e3===this.options.distance},{title:"5 km",value:5e3,enabled:5e3===this.options.distance}]}]}}reverseSearch(e,t){const o=this.computeRequestParams(e,t||{});return o.get("type").length?this.http.get(`${this.searchUrl}/locate`,{params:o}).pipe((0,x.U)(e=>this.extractResults(e))):(0,A.of)([])}getAllowedTypes(){return this.http.get(`${this.searchUrl}/types`).subscribe(e=>{const t=this.settings.find(e=>"type"===e.name);t.values.forEach(t=>{t.available=e.indexOf(t.value)>-1}),this.setParamFromSetting(t,!1)})}computeRequestParams(e,t){return(t.distance||this.options.distance)&&(t.params=Object.assign(t.params||{},{bufferInput:t.distance||this.options.distance})),new y.LE({fromObject:Object.assign({loc:e.join(","),sort:"distance",geometry:!0,icon:!0},t.params||{},this.params)})}extractResults(e){return e.features.map(e=>this.dataToResult(e))}getSubtitle(e){if(!this.settings.length)return"";let t="";switch(e.properties.type){case"arrondissements":t=e.properties.municipalite+" (Arrondissement)";break;default:const o=this.settings.find(e=>"type"===e.name).values.find(t=>t.value===e.properties.type);o&&(t=this.languageService.translate.instant(o.title))}return t}dataToResult(e){const t=this.computeProperties(e),o=this.computeExtent(e),i=[this.getId(),t.type,t.code].join("."),r=e.properties.nom,s=" <small> "+this.getSubtitle(e)+"</small>";return{source:this,data:{type:Zl,projection:"EPSG:4326",geometry:e.geometry,extent:o,properties:t,meta:{id:i,title:e.properties.nom}},meta:{dataType:Zl,id:i,title:e.properties.nom,titleHtml:r+s,icon:e.icon||"map-marker"}}}computeProperties(t){const o=D.removeKeys(t.properties,e.propertiesBlacklist),i={Route:'<span class="routing"> <u>'+this.languageService.translate.instant("igo.geo.seeRouting")+"</u> </span>"};return Object.assign(o,i)}computeExtent(e){return e.bbox?[e.bbox[0],e.bbox[2],e.bbox[1],e.bbox[3]]:void 0}}return e.id="icherchereverse",e.type=Zl,e.propertiesBlacklist=[],e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(ue),r.LFG(Se),r.LFG("options"),r.LFG(r.zs3))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),(0,je.gn)([(0,Qe.q)({maxCacheCount:20})],e.prototype,"reverseSearch",null),e})();function Ab(e){return new wb(e)}function Lb(e,t,o,i,r,s){return new Cb(e,t,o,i.getConfig(`searchSources.${Cb.id}`),r,s)}function Zb(e,t,o,i,r){return new Tb(e,t,o,i.getConfig(`searchSources.${Tb.id}`),r)}let Fb=(()=>{class e{constructor(e){this.languageService=e}formatResult(e){return e}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(ue))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})(),Ob=(()=>{class e extends ju{constructor(e,t,o,i){super(e,o),this.languageService=t,this.title$=new C.X(""),this.projections=i,this.languageService.translate.get(this.options.title).subscribe(e=>this.title$.next(e))}get title(){return this.title$.getValue()}getId(){return e.id}getType(){return e.type}getDefaultOptions(){return{title:"igo.geo.search.coordinates.name",order:1,showInSettings:!1}}reverseSearch(e,t){return(0,A.of)([this.dataToResult(e,t)])}dataToResult(e,t){const o=function(e,t=3){const o=[];return e.forEach(e=>{const i=e<0?Math.ceil(e):Math.floor(e),r=e<0?60*(i-e):60*(e-i),s=Math.floor(r),n=(60*(r-s)).toFixed(t);o.push(`${i}\xb0 ${s}' ${n}"`)}),o}(e),i=function(e,t){const o=kn.vs(e,"EPSG:4326","EPSG:3857"),i=[{code:"EPSG:3857",alias:"Web Mercator",coord:o,igo2CoordFormat:`${gc(o).join(", ")} ; 3857`}],r=function(e){return Math.ceil((e[0]+180)/6)}(e),s=r<10?`EPSG:3260${r}`:`EPSG:326${r}`,n=`UTM-${r}`,a=kn.vs(e,"EPSG:4326",s);i.push({code:s,alias:"UTM",coord:a,igo2CoordFormat:`${n} ${gc(a).join(", ")}`});const l=function(e){const t=e[0];let o;return t<-51&&t>-54&&(o=1),t<-54&&t>-57&&(o=2),t<-57&&t>-60&&(o=3),t<-60&&t>-63&&(o=4),t<-63&&t>-66&&(o=5),t<-66&&t>-69&&(o=6),t<-69&&t>-72&&(o=7),t<-72&&t>-75&&(o=8),t<-75&&t>-78&&(o=9),t<-78&&t>-81&&(o=10),o}(e);if(l){const t=l<10?`EPSG:3218${l}`:`EPSG:321${80+l}`,o=`MTM-${l}`,r=kn.vs(e,"EPSG:4326",t);i.push({code:t,alias:"MTM",coord:r,igo2CoordFormat:`${o} ${gc(r).join(", ")}`})}return t.forEach(t=>{const o=kn.vs(e,"EPSG:4326",t.code),r=t.code.split(":")[1];i.push({code:t.code,alias:t.alias||t.code,coord:o,igo2CoordFormat:`${gc(o).join(", ")} ; ${r}`})}),i}(e,this.projections).reduce((e,t)=>(e[t.alias]=t.igo2CoordFormat,e),{}),r=gc(e,6).join(", "),s=o.join(", ");let n={type:"Point",coordinates:[e[0],e[1]]};const a={};let l="";if(t.distance){a[this.languageService.translate.instant("igo.geo.search.coordinates.radius")]=t.distance,l="<br><small>Rayon: "+t.distance+" m</small>";const o=kn.vs([e[0],e[1]],"EPSG:4326","EPSG:3857"),i=new En.Z(o,t.distance),r=(0,Vn.Bb)(i),s=new Xn.Z;n=JSON.parse(s.writeGeometry(r.transform("EPSG:3857","EPSG:4326")))}return t.conf&&(a[this.languageService.translate.instant("igo.geo.search.coordinates.conf")]=t.conf,l+=""===l?"<br>":"<small> - </small>",l+="<small>Confiance: "+t.conf+"%</small>"),a[this.languageService.translate.instant("igo.geo.search.coordinates.coord")]=r,a[this.languageService.translate.instant("igo.geo.search.coordinates.coordDMS")]=s,{source:this,data:{type:Zl,projection:"EPSG:4326",geometry:n,extent:void 0,properties:Object.assign(a,i,{GoogleMaps:Gu.getGoogleMapsCoordLink(e[0],e[1]),GoogleStreetView:Gu.getGoogleStreetViewLink(e[0],e[1]),OpenStreetMap:Yu.getOpenStreetMapLink(e[0],e[1],14),Route:'<span class="routing"> <u>'+this.languageService.translate.instant("igo.geo.seeRouting")+"</u> </span>"}),meta:{id:e[0].toString()+","+e[1].toString(),title:r}},meta:{dataType:Zl,id:e[0].toString()+","+e[1].toString(),title:r,titleHtml:r+l,icon:"map-marker",score:100}}}}return e.id="coordinatesreverse",e.type=Zl,e.\u0275fac=function(t){return new(t||e)(r.LFG("options"),r.LFG(ue),r.LFG(Se),r.LFG("projections"))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),(0,je.gn)([(0,Qe.q)({maxCacheCount:20})],e.prototype,"reverseSearch",null),e})();function Mb(e){return new Fb(e)}function Ib(e,t,o,i){return new Ob(e.getConfig(`searchSources.${Ob.id}`),t,o,e.getConfig("projections")||[])}let kb=(()=>{class e{constructor(e){this.languageService=e}formatResult(e){const t=["title","abstract","groupTitle","metadataUrl","downloadUrl","urlInfo","name"],o=Object.entries(e.properties).filter(([e])=>-1!==t.indexOf(e)).reduce((e,t)=>{const[o,i]=t;let r;try{r=this.languageService.translate.instant("igo.geo.search.ilayer.properties."+o)}catch(s){r=o}return e[r]=i||"",e},{}),i=Object.assign({},e);return i.properties=o,i}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(ue))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})(),Pb=(()=>{class e extends ju{constructor(e,t,o,i,r){super(i,o),this.http=e,this.languageService=t,this.formatter=r,this.title$=new C.X(""),this.languageService.translate.get(this.options.title).subscribe(e=>this.title$.next(e))}get title(){return this.title$.getValue()}getId(){return e.id}getType(){return e.type}getDefaultOptions(){const e=this.options.params&&this.options.params.limit?Number(this.options.params.limit):void 0,t=this.options.params&&this.options.params.ecmax?Number(this.options.params.ecmax):void 0;return{title:"igo.geo.search.ilayer.name",searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/layers/search",settings:[{type:"checkbox",title:"results type",name:"type",values:[{title:"igo.geo.search.ilayer.type.layer",value:"layer",enabled:!0,hashtags:["layer","layers","couche","couches"]},{title:"igo.geo.search.ilayer.type.groupLayer",value:"group",enabled:!1,hashtags:["gr-layer","gr-layers","gr-couche","gr-couches"]}]},{type:"radiobutton",title:"results limit",name:"limit",values:[{title:"1",value:1,enabled:1===e},{title:"5",value:5,enabled:5===e||!e},{title:"10",value:10,enabled:10===e},{title:"25",value:25,enabled:25===e},{title:"50",value:50,enabled:50===e}]},{type:"radiobutton",title:"ecmax",name:"ecmax",values:[{title:"10 %",value:10,enabled:10===t},{title:"30 %",value:30,enabled:30===t},{title:"50 %",value:50,enabled:50===t||!t},{title:"75 %",value:75,enabled:75===t},{title:"100 %",value:100,enabled:100===t}]}]}}search(e,t){const o=this.computeSearchRequestParams(e,t||{});return o.get("q")&&o.get("type")?(this.options.params.page=o.get("page")||"1",this.http.get(this.searchUrl,{params:o}).pipe((0,x.U)(t=>this.extractResults(t,e)))):(0,A.of)([])}computeSearchRequestParams(e,t){return new y.LE({fromObject:D.removeUndefined(Object.assign({q:this.computeTerm(e)},this.params,this.computeOptionsParam(e,t||{}).params,{page:t.page}))})}computeTerm(e){return e.replace(/(#[^\s]*)/g,"").replace(/[^\w\xc0-\xff !\-\(\),'#]+/g,"")}computeOptionsParam(e,t){const o=super.getHashtagsValid(e,"type");return o&&(t.params=Object.assign(t.params||{},{type:o.join(",")})),t}extractResults(e,t){return e.items.map(o=>this.dataToResult(o,t,e))}dataToResult(e,t,o){const i=this.computeLayerOptions(e),r=e.highlight.title||e.properties.title,s=e.highlight.groupTitle||e.properties.groupTitle,n=s?' <small style="color: #6f6969"> '+s+"</small>":"";return{source:this,meta:{dataType:Qh,id:[this.getId(),e.properties.id].join("."),title:e.properties.title,titleHtml:r+n,icon:"Layer"===e.properties.type?"layers":"map",score:e.score||rb(t.trim(),e.properties.name),nextPage:o.items.length%+this.options.params.limit==0&&+this.options.params.page<10},data:i}}computeLayerOptions(e){const t=e.properties.url,o=this.extractQueryParamsFromSourceUrl(t);return D.removeUndefined({sourceOptions:{id:e.properties.id,type:e.properties.format,url:t,queryFormat:o.queryFormat,queryHtmlTarget:o.queryHtmlTarget,params:"wms"===e.properties.format?{LAYERS:e.properties.name}:void 0,layer:"wms"===e.properties.format?void 0:e.properties.name,optionsFromCapabilities:!0,crossOrigin:"anonymous"},title:e.properties.title,maxResolution:dc(Number(e.properties.maxScaleDenom)),minResolution:dc(Number(e.properties.minScaleDenom)),metadata:{url:e.properties.metadataUrl,extern:!!e.properties.metadataUrl||void 0,abstract:e.properties.abstract||void 0},properties:this.formatter.formatResult(e).properties})}extractQueryParamsFromSourceUrl(e){let t,o;const i=this.options.queryFormat;if(i){for(const o of Object.keys(i)){const r=i[o];if("*"===r){t=Gl[o.toUpperCase()];break}const s=r.urls;if(Array.isArray(s)){s.forEach(i=>{-1!==e.indexOf(i)&&(t=Gl[o.toUpperCase()])});break}}(t===Gl.HTML||t===Gl.HTMLGML2)&&(o="iframe")}return{queryFormat:t,queryHtmlTarget:o}}}return e.id="ilayer",e.type=Qh,e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(ue),r.LFG(Se),r.LFG("options"),r.LFG(kb))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),(0,je.gn)([(0,Qe.q)({maxCacheCount:20})],e.prototype,"search",null),e})();function _b(e){return new kb(e)}function $b(e,t,o,i,r){return new Pb(e,t,o,i.getConfig(`searchSources.${Pb.id}`),r)}const qb=[Zl,Qh];function Db(e,t){if(1&e&&(r.TgZ(0,"mat-radio-button",7),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e){const e=t.$implicit,o=r.oxw();r.Q6J("value",e),r.xp6(1),r.hij(" ",r.lcZ(2,2,o.getSearchTypeTitle(e))," ")}}let Eb=(()=>{class e{constructor(e){this.searchSourceService=e,this.searchType$=new C.X(void 0),this.searchTypes=qb,this.searchTypeChange=new r.vpe}set searchType(e){this.setSearchType(e)}get searchType(){return this.searchType$.value}ngOnInit(){this.searchType$$=this.searchType$.pipe((0,M.x)()).subscribe(e=>this.onSetSearchType(e))}ngOnDestroy(){this.searchType$$.unsubscribe()}onSearchTypeChange(e){this.setSearchType(e)}getSearchTypeTitle(e){return`igo.geo.search.${e.toLowerCase()}.title`}setSearchType(e){this.searchType$.next(e)}onSetSearchType(e){null!=e&&(this.searchSourceService.enableSourcesByType(e),this.searchTypeChange.emit(e))}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(sb))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-search-selector"]],inputs:{searchTypes:"searchTypes",searchType:"searchType"},outputs:{searchTypeChange:"searchTypeChange"},decls:9,vars:8,consts:[[1,"igo-search-selector"],["mat-icon-button","","color","primary","tooltip-position","below","matTooltipShowDelay","500",1,"igo-search-selector-button",3,"matTooltip","matMenuTriggerFor"],["svgIcon","menu-down"],["xPosition","before","yPosition","above",1,"no-border-radius"],["searchSelectorMenu","matMenu"],[1,"igo-search-selector-radio-group",3,"value","change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){if(1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"button",1),r.ALo(2,"translate"),r._UZ(3,"mat-icon",2),r.qZA(),r.TgZ(4,"mat-menu",3,4),r.TgZ(6,"mat-radio-group",5),r.NdJ("change",function(e){return t.onSearchTypeChange(e.value)}),r.ALo(7,"async"),r.YNc(8,Db,3,4,"mat-radio-button",6),r.qZA(),r.qZA(),r.qZA()),2&e){const e=r.MAs(5);r.xp6(1),r.Q6J("matTooltip",r.lcZ(2,4,"igo.geo.search.menu.tooltip"))("matMenuTriggerFor",e),r.xp6(5),r.Q6J("value",r.lcZ(7,6,t.searchType$)),r.xp6(2),r.Q6J("ngForOf",t.searchTypes)}},directives:[n.lW,p.gM,f.p6,a.Hw,f.VK,ll.VQ,h.sg,ll.U0],pipes:[j.X$,h.Ov],styles:[".igo-search-selector-button[_ngcontent-%COMP%]     div.mat-button-ripple-round{border-radius:0}.igo-search-selector-radio-group[_ngcontent-%COMP%]{display:inline-flex;flex-direction:column}.igo-search-selector-radio-group[_ngcontent-%COMP%]   mat-radio-button[_ngcontent-%COMP%]{margin:5px}"],changeDetection:0}),e})(),Rb=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,p.AV,a.Ps,n.ot,f.Tx,ll.Fk,cl.Nh,m.p9,ne]]}),e})();function Ub(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",8),r.TgZ(1,"button",9),r.NdJ("click",function(t){return r.CHM(e),r.oxw().checkUncheckAllSources(t)}),r._uU(2),r.ALo(3,"translate"),r.ALo(4,"translate"),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(2),r.Oqu(e.searchSourcesAllEnabled?r.lcZ(4,3,"igo.geo.search.searchSources.selectAll"):r.lcZ(3,1,"igo.geo.search.searchSources.unselectAll"))}}function Nb(e,t){if(1&e&&(r.TgZ(0,"button",15),r._uU(1),r.qZA()),2&e){const e=r.oxw().$implicit,t=r.MAs(6);r.Q6J("matMenuTriggerFor",t),r.xp6(1),r.hij("",e.title," ")}}function Jb(e,t){if(1&e&&(r.TgZ(0,"button",16),r._uU(1),r.qZA()),2&e){const e=r.oxw().$implicit;r.xp6(1),r.hij(" ",e.title," ")}}function Bb(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-radio-button",22),r.NdJ("click",function(e){return e.stopPropagation()})("change",function(t){const o=r.CHM(e).$implicit,i=r.oxw(2).$implicit,s=r.oxw().$implicit;return r.oxw().settingsValueCheckedRadioButton(t,s,i,o)}),r._uU(1),r.ALo(2,"translate"),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(4);r.Q6J("value",e)("matTooltip",o.getAvailableHashtagsValues(e))("checked",e.enabled),r.xp6(1),r.hij(" ",r.lcZ(2,4,e.title)," ")}}function jb(e,t){if(1&e&&(r.TgZ(0,"span"),r.TgZ(1,"mat-radio-group",20),r.YNc(2,Bb,3,6,"mat-radio-button",21),r.qZA(),r.qZA()),2&e){const e=r.oxw().$implicit;r.xp6(1),r.Q6J("value",e),r.xp6(1),r.Q6J("ngForOf",e.values)}}function Qb(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",8),r.TgZ(1,"button",9),r.NdJ("click",function(t){r.CHM(e);const o=r.oxw(2).$implicit,i=r.oxw().$implicit;return r.oxw().checkUncheckAll(t,i,o)}),r._uU(2),r.ALo(3,"translate"),r.ALo(4,"translate"),r.qZA(),r.qZA()}if(2&e){const e=r.oxw(2).$implicit;r.xp6(2),r.Oqu(e.allEnabled||void 0===e.allEnabled?r.lcZ(3,1,"igo.geo.search.searchSources.settings.unselectAll"):r.lcZ(4,3,"igo.geo.search.searchSources.settings.selectAll"))}}function Gb(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-checkbox",24),r.NdJ("click",function(e){return e.stopPropagation()})("change",function(t){const o=r.CHM(e).$implicit,i=r.oxw(2).$implicit,s=r.oxw().$implicit;return r.oxw().settingsValueCheckedCheckbox(t,s,i,o)}),r._uU(1),r.ALo(2,"translate"),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(2).$implicit,i=r.oxw(2);r.Udp("display",i.displayBlock),r.Q6J("checked",e.enabled)("value",o)("matTooltip",i.getAvailableHashtagsValues(e)),r.xp6(1),r.hij(" ",r.lcZ(2,6,e.title)," ")}}function Yb(e,t){if(1&e&&(r.TgZ(0,"span"),r.YNc(1,Qb,5,5,"div",5),r.YNc(2,Gb,3,8,"mat-checkbox",23),r.qZA()),2&e){const e=r.oxw().$implicit,t=r.oxw(2);r.xp6(1),r.Q6J("ngIf",e.values.length>3),r.xp6(1),r.Q6J("ngForOf",t.getAvailableValues(e))}}function zb(e,t){if(1&e&&(r.ynx(0),r.TgZ(1,"button",15),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"mat-menu",17,18),r.YNc(6,jb,3,2,"span",19),r.YNc(7,Yb,3,2,"span",19),r.qZA(),r.BQk()),2&e){const e=t.$implicit,o=r.MAs(5);r.xp6(1),r.Q6J("matMenuTriggerFor",o),r.xp6(1),r.hij(" ",r.lcZ(3,5,"igo.geo.search.searchSources.settings."+e.title)," "),r.xp6(2),r.Q6J("ngSwitch",e.type),r.xp6(2),r.Q6J("ngSwitchCase","radiobutton"),r.xp6(1),r.Q6J("ngSwitchCase","checkbox")}}function Hb(e,t){if(1&e){const e=r.EpF();r.ynx(0),r.TgZ(1,"span",10),r.TgZ(2,"mat-checkbox",11),r.NdJ("click",function(e){return e.stopPropagation()})("change",function(t){const o=r.CHM(e).$implicit;return r.oxw().onCheckSearchSource(t,o)}),r.qZA(),r.YNc(3,Nb,2,2,"button",12),r.YNc(4,Jb,2,1,"button",13),r.qZA(),r.TgZ(5,"mat-menu",null,14),r.YNc(7,zb,8,7,"ng-container",6),r.qZA(),r.BQk()}if(2&e){const e=t.$implicit;r.xp6(2),r.Q6J("checked",e.enabled)("value",e),r.xp6(1),r.Q6J("ngIf",e.settings.length>0),r.xp6(1),r.Q6J("ngIf",0===e.settings.length),r.xp6(3),r.Q6J("ngForOf",e.settings)}}function Vb(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"span"),r._UZ(1,"mat-divider"),r.TgZ(2,"span",25),r.TgZ(3,"mat-slide-toggle",26),r.NdJ("change",function(t){return r.CHM(e),r.oxw().changePointerReverseSearch(t)})("click",function(e){return e.stopPropagation()}),r.ALo(4,"translate"),r._uU(5),r.ALo(6,"translate"),r.qZA(),r.TgZ(7,"mat-slide-toggle",26),r.NdJ("change",function(t){return r.CHM(e),r.oxw().changeSearchResultsGeometry(t)})("click",function(e){return e.stopPropagation()}),r.ALo(8,"translate"),r._uU(9),r.ALo(10,"translate"),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(3),r.Q6J("matTooltip",r.lcZ(4,8,"igo.geo.search.pointerSearchSummary.tooltip"))("checked",e.pointerSummaryEnabled)("labelPosition","after"),r.xp6(2),r.hij(" ",r.lcZ(6,10,"igo.geo.search.pointerSearchSummary.title")," "),r.xp6(2),r.Q6J("matTooltip",r.lcZ(8,12,"igo.geo.search.searchResultsGeometry.tooltip"))("checked",e.searchResultsGeometryEnabled)("labelPosition","after"),r.xp6(2),r.hij(" ",r.lcZ(10,14,"igo.geo.search.searchResultsGeometry.title")," ")}}let Wb=(()=>{class e{constructor(e,t,o){this.searchSourceService=e,this.mediaService=t,this.storageService=o,this.hasPointerReverseSearchSource=!1,this.searchSourcesAllEnabled=!1,this.buffer=[],this.lastKeyTime=Date.now(),this.displayBlock="block",this.pointerSummaryEnabled=!1,this.searchResultsGeometryEnabled=!1,this.searchSourceChange=new r.vpe,this.pointerSummaryStatus=new r.vpe,this.searchResultsGeometryStatus=new r.vpe}get isTouchScreen(){return this.mediaService.isTouchScreen()}handleKeyboardEvent(e){"F2"===e.key&&(this.pointerSummaryEnabled=!this.pointerSummaryEnabled,this.pointerSummaryStatus.emit(this.pointerSummaryEnabled))}ngOnInit(){this.hasPointerReverseSearchSource=this.hasReverseSearchSourcesForPointerSummary()}getSearchSources(){const e=this.searchSourceService.getSources().filter(eb).filter(e=>e.available&&"map"!==e.getId()&&e.showInSettings),t=this.searchSourceService.getSources().filter(tb).filter(e=>e.available&&"map"!==e.getId()&&e.showInSettings),o=e.concat(t);return this.computeSourcesCheckAllBehavior(o),o}hasReverseSearchSourcesForPointerSummary(){return!!this.searchSourceService.getEnabledSources().filter(ob).length}settingsValueCheckedCheckbox(e,t,o,i){i.enabled=e.checked,t.setParamFromSetting(o),this.searchSourceChange.emit(t)}computeSettingCheckAllBehavior(e){e.allEnabled=void 0===e.allEnabled?!e.values.find(e=>e.enabled):!e.allEnabled}computeSourcesCheckAllBehavior(e){const t=e.filter(e=>e.enabled).length,o=e.filter(e=>!e.enabled).length;this.searchSourcesAllEnabled=!(t>=o)}checkUncheckAll(e,t,o){e.stopPropagation(),this.computeSettingCheckAllBehavior(o),o.values.forEach(e=>{e.enabled=o.allEnabled}),t.setParamFromSetting(o),this.searchSourceChange.emit(t)}checkUncheckAllSources(e){e.stopPropagation(),this.getSearchSources().map(e=>{e.enabled=this.searchSourcesAllEnabled,this.searchSourceChange.emit(e)})}settingsValueCheckedRadioButton(e,t,o,i){o.values.forEach(t=>{t.enabled=t.value!==i.value?!e.source.checked:e.source.checked}),t.setParamFromSetting(o),this.searchSourceChange.emit(t)}onCheckSearchSource(e,t){t.enabled=e.checked;const o=this.storageService.get(t.getId()+".options")||{};o.enabled=t.enabled,this.storageService.set(t.getId()+".options",o),this.searchSourceChange.emit(t)}getAvailableValues(e){return e.values.filter(e=>!1!==e.available)}getAvailableHashtagsValues(e){if(e.hashtags)return e.hashtags.map(e=>"#"+e).join(", ")}stopPropagation(e){e.stopPropagation()}changePointerReverseSearch(e){this.pointerSummaryEnabled=e.checked,this.pointerSummaryStatus.emit(this.pointerSummaryEnabled)}changeSearchResultsGeometry(e){this.searchResultsGeometryEnabled=e.checked,this.searchResultsGeometryStatus.emit(this.searchResultsGeometryEnabled)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(sb),r.Y36(be),r.Y36(Se))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-search-settings"]],hostBindings:function(e,t){1&e&&r.NdJ("keydown",function(e){return t.handleKeyboardEvent(e)},!1,r.evT)},inputs:{pointerSummaryEnabled:"pointerSummaryEnabled",searchResultsGeometryEnabled:"searchResultsGeometryEnabled"},outputs:{searchSourceChange:"searchSourceChange",pointerSummaryStatus:"pointerSummaryStatus",searchResultsGeometryStatus:"searchResultsGeometryStatus"},decls:9,vars:7,consts:[[1,"igo-search-settings"],["mat-icon-button","","color","primary","tooltip-position","below","matTooltipShowDelay","500",1,"igo-search-settings-button",3,"matTooltip","matMenuTriggerFor"],["svgIcon","chevron-down"],[1,"no-border-radius"],["searchSettingsMenu","matMenu"],["class","checkAllButton",4,"ngIf"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"checkAllButton"],["mat-raised-button","",3,"click"],[1,"igo-search-settings-search-source"],[1,"igo-search-settings-checkbox",3,"checked","value","click","change"],["mat-menu-item","",3,"matMenuTriggerFor",4,"ngIf"],["mat-menu-item","",4,"ngIf"],["sub_menu","matMenu"],["mat-menu-item","",3,"matMenuTriggerFor"],["mat-menu-item",""],["yPosition","above",3,"ngSwitch"],["test_sub_menu","matMenu"],[4,"ngSwitchCase"],[1,"igo-search-settings-radio-group",3,"value"],["class","mat-typography",3,"value","matTooltip","checked","click","change",4,"ngFor","ngForOf"],[1,"mat-typography",3,"value","matTooltip","checked","click","change"],["class","mat-menu-item",3,"display","checked","value","matTooltip","click","change",4,"ngFor","ngForOf"],[1,"mat-menu-item",3,"checked","value","matTooltip","click","change"],[1,"pointer-summary-slide-toggle-container","mat-typography"],["tooltip-position","below","matTooltipShowDelay","500",1,"pointer-summary-option",3,"matTooltip","checked","labelPosition","change","click"]],template:function(e,t){if(1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"button",1),r.ALo(2,"translate"),r._UZ(3,"mat-icon",2),r.qZA(),r.TgZ(4,"mat-menu",3,4),r.YNc(6,Ub,5,5,"div",5),r.YNc(7,Hb,8,5,"ng-container",6),r.YNc(8,Vb,11,16,"span",7),r.qZA(),r.qZA()),2&e){const e=r.MAs(5);r.xp6(1),r.Q6J("matTooltip",r.lcZ(2,5,"igo.geo.search.menu.tooltip"))("matMenuTriggerFor",e),r.xp6(5),r.Q6J("ngIf",t.getSearchSources().length>4),r.xp6(1),r.Q6J("ngForOf",t.getSearchSources()),r.xp6(1),r.Q6J("ngIf",t.hasPointerReverseSearchSource&&!t.isTouchScreen)}},directives:[n.lW,p.gM,f.p6,a.Hw,f.VK,h.O5,h.sg,m.oG,f.OP,h.RF,h.n9,ll.VQ,ll.U0,Ha.d,Va.Rr],pipes:[j.X$],styles:[".checkAllButton[_ngcontent-%COMP%]{text-align:center;padding:0 5px}.igo-search-settings-button[_ngcontent-%COMP%]     div.mat-button-ripple-round{border-radius:0}.igo-search-settings-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.igo-search-settings-radio-group[_ngcontent-%COMP%]   mat-radio-button[_ngcontent-%COMP%]{margin:5px}.igo-search-settings-checkbox[_ngcontent-%COMP%]   mat-radio-button[_ngcontent-%COMP%]{display:flex}.igo-search-settings-search-source[_ngcontent-%COMP%]{display:flex;width:100%}.igo-search-settings-search-source[_ngcontent-%COMP%]   mat-checkbox[_ngcontent-%COMP%]{display:flex;margin-left:5px;margin-right:5px}.pointer-summary-option[_ngcontent-%COMP%]{display:block;margin-right:10px;margin-bottom:15px}.pointer-summary-slide-toggle-container[_ngcontent-%COMP%]{overflow-x:hidden}.pointer-summary-slide-toggle-container[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{margin:10px}"],changeDetection:0}),e})(),Xb=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,p.AV,a.Ps,n.ot,f.Tx,ll.Fk,m.p9,Ha.t,Va.rP,ne]]}),e})();const Kb=["input"];function ex(e,t){if(1&e&&(r.TgZ(0,"mat-label"),r._uU(1),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Oqu(e.label)}}function tx(e,t){if(1&e&&(r.TgZ(0,"button",10),r._UZ(1,"mat-icon",11),r.qZA()),2&e){const e=r.oxw();r.Q6J("color",e.color),r.xp6(1),r.s9C("svgIcon",e.searchIcon)}}function ox(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",12),r.NdJ("click",function(){return r.CHM(e),r.oxw().onClearButtonClick()}),r._UZ(1,"mat-icon",13),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("color",e.color)}}function ix(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-search-selector",14),r.NdJ("searchTypeChange",function(t){return r.CHM(e),r.oxw().onSearchTypeChange(t)}),r.ALo(1,"async"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("searchTypes",e.searchTypes)("searchType",r.lcZ(1,2,e.searchType$))}}function rx(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-search-settings",15),r.NdJ("pointerSummaryStatus",function(t){return r.CHM(e),r.oxw().pointerSummaryStatus.emit(t)})("searchResultsGeometryStatus",function(t){return r.CHM(e),r.oxw().searchResultsGeometryStatus.emit(t)})("searchSourceChange",function(){return r.CHM(e),r.oxw().onSearchSettingsChange()}),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("pointerSummaryEnabled",e.pointerSummaryEnabled)("searchResultsGeometryEnabled",e.searchResultsGeometryEnabled)}}const sx=function(e){return{empty:e}},nx=function(e){return{hasSearchIcon:e}};let ax=(()=>{class e{constructor(e,t,o){this.languageService=e,this.searchService=t,this.searchSourceService=o,this.placeholder$=new C.X("igo.geo.search.placeholder"),this.empty$=new C.X(!0),this.stream$=new C.X(""),this.searchTypes=qb,this.searchType$=new C.X(void 0),this.pointerSummaryStatus=new r.vpe,this.searchResultsGeometryStatus=new r.vpe,this.term$=new C.X(""),this.disabled$=new C.X(!1),this.pointerSummaryEnabled=!1,this.searchResultsGeometryEnabled=!1,this.floatLabel="never",this.appearance="legacy",this.color="primary",this.termSplitter="|",this.debounce=200,this.minLength=2,this.searchSelector=!1,this.searchSettings=!1,this.forceNA=!1,this.searchTermChange=new r.vpe,this.search=new r.vpe,this.searchTypeChange=new r.vpe,this.clearFeature=new r.vpe,this.searchSettingsChange=new r.vpe}set searchType(e){this.setSearchType(e)}get searchType(){return this.searchType$.value}set term(e){this.setTerm(e)}get term(){return this.term$.value}set disabled(e){this.disabled$.next(e)}get disabled(){return this.disabled$.value}get empty(){return 0===this.term.length}ngOnInit(){this.term$$=this.term$.subscribe(e=>{this.empty$.next(void 0===e||0===e.length)}),this.stream$$=this.stream$.pipe((0,An.D)(e=>""===e?xn.E:(0,wn.H)(this.debounce))).subscribe(e=>this.onSetTerm(e)),this.handlePlaceholder(),this.searchType$$=this.searchType$.pipe((0,M.x)()).subscribe(e=>this.onSetSearchType(e))}ngOnDestroy(){this.term$$.unsubscribe(),this.stream$$.unsubscribe(),this.searchType$$.unsubscribe()}onKeyup(e){this.keyIsValid(e.key)&&this.setTerm(e.target.value)}onClearButtonClick(){this.clear(),this.clearFeature.emit()}onSearchTypeChange(e){this.setSearchType(e)}setSearchType(e){this.searchType$.next(e)}onSearchSettingsChange(){this.doSearch(this.term),this.searchSettingsChange.emit(),this.handlePlaceholder()}setTerm(e){if(this.disabled)return;(e=e||"")!==this.term&&this.term$.next(e);const t=e.replace(/(#[^\s]*)/g,"").trim();(t.length>=this.minLength||0===t.length)&&this.stream$.next(e)}clear(){this.term$.next(""),this.stream$.next(""),this.input.nativeElement.focus()}keyIsValid(t){return-1===e.invalidKeys.indexOf(t)}onSetTerm(e){this.searchTermChange.emit(e),this.doSearch(e)}handlePlaceholder(){const e=[...new Set(this.searchSourceService.getEnabledSources().filter(e=>!["map","coordinatesreverse"].includes(e.getId())).map(e=>e.getType()))];let t="igo.geo.search.placeholder";1===e.length?t=`igo.geo.search.${e[0].toLowerCase()}.placeholder`:0===e.length&&(t="igo.geo.search.emptyType.placeholder"),this.placeholder$.next(t)}onSetSearchType(e){if(null==e)return;this.searchTypeChange.emit(e);const t=`igo.geo.search.${e.toLowerCase()}.placeholder`;this.placeholder$.next(t),this.setTerm(this.term)}doSearch(e){let t;this.researches$$&&(this.researches$$.map(e=>e.unsubscribe()),this.researches$$=void 0),this.termSplitter&&e.match(new RegExp(this.termSplitter,"g"))?(t=e.split(this.termSplitter).filter(e=>e.length>=this.minLength),this.store.clear()):t=[e];let o=[];t.map(e=>{""!==(e?e.replace(/(#[^\s]*)/g,"").trim():"")?o=o.concat(this.searchService.search(e,{forceNA:this.forceNA})):void 0!==this.store&&this.store.clear()}),this.researches$$=o.map(e=>e.request.subscribe(t=>{this.onResearchCompleted(e,t)}))}onResearchCompleted(e,t){if(this.search.emit({research:e,results:t}),void 0!==this.store){const o=this.store.all().filter(t=>t.source!==e.source).concat(t);this.store.updateMany(o)}}}return e.invalidKeys=["Control","Shift","Alt","ArrowDown","ArrowUp","ArrowRight","ArrowLeft"],e.\u0275fac=function(t){return new(t||e)(r.Y36(ue),r.Y36(nb),r.Y36(sb))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-search-bar"]],viewQuery:function(e,t){if(1&e&&r.Gf(Kb,7),2&e){let e;r.iGM(e=r.CRH())&&(t.input=e.first)}},inputs:{searchTypes:"searchTypes",searchType:"searchType",term:"term",disabled:"disabled",pointerSummaryEnabled:"pointerSummaryEnabled",searchResultsGeometryEnabled:"searchResultsGeometryEnabled",floatLabel:"floatLabel",appearance:"appearance",placeholder:"placeholder",label:"label",color:"color",termSplitter:"termSplitter",debounce:"debounce",minLength:"minLength",searchIcon:"searchIcon",searchSelector:"searchSelector",searchSettings:"searchSettings",forceNA:"forceNA",store:"store"},outputs:{pointerSummaryStatus:"pointerSummaryStatus",searchResultsGeometryStatus:"searchResultsGeometryStatus",searchTermChange:"searchTermChange",search:"search",searchTypeChange:"searchTypeChange",clearFeature:"clearFeature",searchSettingsChange:"searchSettingsChange"},decls:16,vars:28,consts:[[1,"igo-search-bar-container",3,"ngClass"],[3,"floatLabel","appearance"],[4,"ngIf"],["matInput","","autocomplete","off",3,"ngClass","disabled","placeholder","value","keyup","touchend"],["input",""],[1,"search-bar-buttons"],["mat-icon-button","",3,"color",4,"ngIf"],["mat-icon-button","",3,"color","click",4,"ngIf"],[3,"searchTypes","searchType","searchTypeChange",4,"ngIf"],[3,"pointerSummaryEnabled","searchResultsGeometryEnabled","pointerSummaryStatus","searchResultsGeometryStatus","searchSourceChange",4,"ngIf"],["mat-icon-button","",3,"color"],[3,"svgIcon"],["mat-icon-button","",3,"color","click"],["svgIcon","close"],[3,"searchTypes","searchType","searchTypeChange"],[3,"pointerSummaryEnabled","searchResultsGeometryEnabled","pointerSummaryStatus","searchResultsGeometryStatus","searchSourceChange"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.ALo(1,"async"),r.TgZ(2,"mat-form-field",1),r.YNc(3,ex,2,1,"mat-label",2),r.TgZ(4,"input",3,4),r.NdJ("keyup",function(e){return t.onKeyup(e)})("touchend",function(e){return t.onKeyup(e)}),r.ALo(6,"async"),r.ALo(7,"async"),r.ALo(8,"translate"),r.ALo(9,"async"),r.qZA(),r.qZA(),r.TgZ(10,"div",5),r.YNc(11,tx,2,2,"button",6),r.YNc(12,ox,2,1,"button",7),r.ALo(13,"async"),r.YNc(14,ix,2,4,"igo-search-selector",8),r.YNc(15,rx,1,2,"igo-search-settings",9),r.qZA(),r.qZA()),2&e&&(r.Q6J("ngClass",r.VKq(24,sx,r.lcZ(1,12,t.empty$))),r.xp6(2),r.Q6J("floatLabel",t.floatLabel)("appearance",t.appearance),r.xp6(1),r.Q6J("ngIf",t.label),r.xp6(1),r.Q6J("ngClass",r.VKq(26,nx,t.searchIcon))("disabled",r.lcZ(6,14,t.disabled$))("placeholder",t.placeholder?t.placeholder:r.lcZ(7,16,t.placeholder$)?r.lcZ(8,18,t.placeholder$.value):void 0)("value",r.lcZ(9,20,t.term$)),r.xp6(7),r.Q6J("ngIf",void 0!==t.searchIcon),r.xp6(1),r.Q6J("ngIf",!1===r.lcZ(13,22,t.empty$)),r.xp6(2),r.Q6J("ngIf",t.searchSelector),r.xp6(1),r.Q6J("ngIf",t.searchSettings))},directives:[h.mk,De.KE,h.O5,Ve.Nt,De.hX,n.lW,a.Hw,Eb,Wb],pipes:[h.Ov,j.X$],styles:['[_nghost-%COMP%]     .mat-form-field{padding:0 5px}[_nghost-%COMP%]     .mat-form-field-wrapper{margin-bottom:-1.5em}[_nghost-%COMP%]     span.mat-form-field-label-wrapper{top:-20px}[_nghost-%COMP%]     div.mat-form-field-infix{left:5px;right:5px;padding:0 0 12px!important}[_nghost-%COMP%]     div.mat-form-field-underline{display:none}.igo-search-bar-container[_ngcontent-%COMP%]{position:relative;width:100%;display:inline-flex;overflow:hidden}.igo-search-bar-container[_ngcontent-%COMP%] > mat-form-field[_ngcontent-%COMP%]{width:calc(100% - (2 * 40px))}.igo-search-bar-container.empty[_ngcontent-%COMP%] > mat-form-field[_ngcontent-%COMP%]{width:calc(100% - 40px)}.search-bar-buttons[_ngcontent-%COMP%]{position:relative;right:0px;display:inline-flex;top:0}.search-bar-buttons[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]:nth-child(2):before{content:"";left:0px;top:5px;border-right:1px solid #ddd;height:28px}igo-search-selector[_ngcontent-%COMP%]{background-color:#fff;top:0;border-radius:0}igo-search-settings[_ngcontent-%COMP%]{background-color:#fff;top:0;border-radius:0}'],changeDetection:0}),e})(),lx=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,We.u5,p.AV,a.Ps,n.ot,f.Tx,ll.Fk,De.lN,Ve.c,ne,Rb,Xb]]}),e})();function cx(e,t){if(1&e&&r._UZ(0,"mat-icon",4),2&e){const e=r.oxw();r.s9C("svgIcon",e.showIcons?e.icon:"blank")}}function ux(e,t){if(1&e&&r._UZ(0,"h4",5),2&e){const e=r.oxw();r.Q6J("innerHtml",e.titleHtml,r.oJD)("matTooltip",e.tooltipHtml)}}function px(e,t){if(1&e&&(r.TgZ(0,"h4",6),r._uU(1),r.qZA()),2&e){const e=r.oxw();r.Q6J("matTooltip",e.title),r.xp6(1),r.Oqu(e.title)}}function dx(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",7),r.NdJ("click",function(){return r.CHM(e),r.oxw().onZoomHandler()}),r._UZ(1,"mat-icon",8),r.qZA()}}const hx=[[["","igoSearchItemToolbar",""]]],gx=["[igoSearchItemToolbar]"];let mx=(()=>{class e{constructor(){this.withZoomButton=!1,this.zoomEvent=new r.vpe,this.format=new Xn.Z}get title(){return lt(this.result)}get titleHtml(){return function(e){const t=e.meta||{};return t.titleHtml?t.titleHtml:nt(e,t.titleHtmlProperty||"titleHtml")}(this.result)}get tooltipHtml(){return this.titleHtml.replace(/<small?[^>]+(>|$)/g,"\n").replace(/<\/?[^>]+(>|$)/g,"")}get icon(){return ct(this.result)}onZoomHandler(){const e=this.format.readFeature(this.result.data,{dataProjection:this.result.data.projection,featureProjection:this.map.projection});Jc(this.map,[e],Fl.Default)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-search-results-item"]],inputs:{result:"result",map:"map",showIcons:"showIcons",withZoomButton:"withZoomButton"},outputs:{zoomEvent:"zoomEvent"},ngContentSelectors:gx,decls:6,vars:4,consts:[["mat-list-avatar","",3,"svgIcon",4,"ngIf"],["matLine","","matTooltipShowDelay","500","matTooltipClass","search-result-tooltip",3,"innerHtml","matTooltip",4,"ngIf"],["matLine","","matTooltipShowDelay","500",3,"matTooltip",4,"ngIf"],["igoStopPropagation","","mat-icon-button","",3,"click",4,"ngIf"],["mat-list-avatar","",3,"svgIcon"],["matLine","","matTooltipShowDelay","500","matTooltipClass","search-result-tooltip",3,"innerHtml","matTooltip"],["matLine","","matTooltipShowDelay","500",3,"matTooltip"],["igoStopPropagation","","mat-icon-button","",3,"click"],["svgIcon","magnify"]],template:function(e,t){1&e&&(r.F$t(hx),r.TgZ(0,"mat-list-item"),r.YNc(1,cx,1,1,"mat-icon",0),r.YNc(2,ux,1,2,"h4",1),r.YNc(3,px,2,2,"h4",2),r.YNc(4,dx,2,0,"button",3),r.Hsn(5),r.qZA()),2&e&&(r.xp6(1),r.Q6J("ngIf",t.icon),r.xp6(1),r.Q6J("ngIf",t.titleHtml),r.xp6(1),r.Q6J("ngIf",!t.titleHtml),r.xp6(1),r.Q6J("ngIf",t.withZoomButton))},directives:[l.Tg,h.O5,a.Hw,l.eA,Re.X2,p.gM,n.lW,wt],styles:["[_nghost-%COMP%]     small{color:#8c8c8c}  .search-result-tooltip{white-space:pre-line}"],changeDetection:0}),e})();const fx=["igoSearchItemToolbar"];function yx(e,t){1&e&&r.GkF(0)}const vx=function(e){return{results:e}};function bx(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-collapsible",6),r.NdJ("toggle",function(t){r.CHM(e);const o=r.oxw().$implicit;return r.oxw().collapsed[o.source.title]=t}),r.YNc(1,yx,1,0,"ng-container",7),r.qZA()}if(2&e){const e=r.oxw().$implicit,t=r.MAs(4),o=r.oxw();r.Tol(e.source.getId()),r.Q6J("title",o.computeGroupTitle(e))("collapsed",o.collapsed[e.source.title]),r.xp6(1),r.Q6J("ngTemplateOutlet",t)("ngTemplateOutletContext",r.VKq(6,vx,e.results))}}function xx(e,t){1&e&&r.GkF(0)}function wx(e,t){if(1&e&&r.YNc(0,xx,1,0,"ng-container",7),2&e){const e=r.oxw().$implicit,t=r.MAs(4);r.Q6J("ngTemplateOutlet",t)("ngTemplateOutletContext",r.VKq(2,vx,e.results))}}const Sx=function(e){return{result:e}};function Cx(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-search-results-item",9),r.NdJ("focus",function(){const t=r.CHM(e).$implicit;return r.oxw(3).resultFocus.emit(t)})("unfocus",function(){const t=r.CHM(e).$implicit;return r.oxw(3).resultUnfocus.emit(t)})("select",function(){const t=r.CHM(e).$implicit;return r.oxw(3).onResultSelect(t)})("mouseenter",function(){const t=r.CHM(e).$implicit;return r.oxw(3).resultFocus.emit(t)})("mouseleave",function(){const t=r.CHM(e).$implicit;return r.oxw(3).resultUnfocus.emit(t)}),r.GkF(1,10),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(3);r.Q6J("map",o.map)("result",e)("showIcons",o.showIcons)("withZoomButton",o.withZoomButton)("focused",o.store.state.get(e).focused)("selected",o.store.state.get(e).selected),r.xp6(1),r.Q6J("ngTemplateOutlet",o.templateSearchToolbar)("ngTemplateOutletContext",r.VKq(8,Sx,e))}}function Tx(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"span",11),r.NdJ("click",function(){r.CHM(e);const t=r.oxw(2).$implicit;return r.oxw().displayMoreResults(t)}),r.TgZ(1,"u"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.qZA()}2&e&&(r.xp6(2),r.Oqu(r.lcZ(3,1,"igo.geo.search.displayMoreResults")))}function Ax(e,t){if(1&e&&(r.YNc(0,Cx,2,10,"ng-template",1),r.YNc(1,Tx,4,3,"span",8)),2&e){const e=t.results,o=r.oxw().$implicit,i=r.oxw();r.Q6J("ngForOf",e),r.xp6(1),r.Q6J("ngIf",i.isMoreResults(o))}}function Lx(e,t){if(1&e&&(r.YNc(0,bx,2,8,"igo-collapsible",3),r.YNc(1,wx,1,4,"ng-template",null,4,r.W1O),r.YNc(3,Ax,2,2,"ng-template",null,5,r.W1O)),2&e){const e=r.MAs(2),t=r.oxw();r.Q6J("ngIf",t.mode===t.searchResultMode.Grouped)("ngIfElse",e)}}var Zx=(()=>{return(e=Zx||(Zx={})).Grouped="grouped",e.Flat="flat",Zx;var e})();let Fx=(()=>{class e{constructor(e,t){this.cdRef=e,this.searchService=t,this.searchResultMode=Zx,this.pageIterator=[],this.collapsed=[],this.mode=Zx.Grouped,this.withZoomButton=!1,this.settingsChange$=new C.X(void 0),this.termSplitter="|",this.resultFocus=new r.vpe,this.resultUnfocus=new r.vpe,this.resultSelect=new r.vpe,this.moreResults=new r.vpe,this.resultMouseenter=new r.vpe,this.resultMouseleave=new r.vpe}get term(){return this._term}set term(e){this._term=e,this.pageIterator=[]}get results$(){return void 0===this._results$&&(this._results$=this.liftResults()),this._results$}ngOnInit(){this.watcher=new ht(this.store,this.cdRef),this.settingsChange$$=this.settingsChange$.subscribe(()=>{this.pageIterator=[]})}ngOnDestroy(){this.watcher.destroy(),this.settingsChange$$.unsubscribe()}computeGroupTitle(e){const t=[e.source.title],o=e.results.length;return o>1&&t.push(`(${o})`),t.join(" ")}onResultSelect(e){this.store.state.get(e)&&!0===this.store.state.get(e).selected||(this.store.state.update(e,{focused:!0,selected:!0},!0),this.resultSelect.emit(e))}liftResults(){return this.store.stateView.all$().pipe((0,An.D)(e=>0===e.length?xn.E:(0,wn.H)(200)),(0,x.U)(e=>this.groupResults(e.map(e=>e.entity).sort(this.sortByOrder))))}sortByOrder(e,t){return e.source.displayOrder-t.source.displayOrder}groupResults(e){const t=new Map;return e.forEach(e=>{const o=e.source;let i=t.get(o);void 0===i&&(i=[],t.set(o,i)),i.push(e)}),Array.from(t.keys()).map(e=>(void 0===this.pageIterator[e.getId()]&&(this.pageIterator[e.getId()]=1),{source:e,results:t.get(e)}))}isMoreResults(e){const t=this.store.getStrategyOfType(mt);return!(null==t?void 0:t.active)&&e.results&&!0===e.results[e.results.length-1].meta.nextPage}displayMoreResults(e){const t={sourceId:e.source.getId(),page:++this.pageIterator[e.source.getId()]};let o;o=this.termSplitter&&this.term.match(new RegExp(this.termSplitter,"g"))?this.term.split(this.termSplitter):[this.term];let i=[];o.map(e=>{i=i.concat(this.searchService.search(e,t))}),i.map(t=>{t.request.subscribe(o=>{const i=e.results.concat(o);o.length||(i[i.length-1].meta.nextPage=!1),this.moreResults.emit({research:t,results:i})})})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.sBO),r.Y36(nb))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-search-results"]],contentQueries:function(e,t,o){if(1&e&&r.Suo(o,fx,5),2&e){let e;r.iGM(e=r.CRH())&&(t.templateSearchToolbar=e.first)}},inputs:{map:"map",store:"store",showIcons:"showIcons",mode:"mode",withZoomButton:"withZoomButton",term:"term",settingsChange$:"settingsChange$",termSplitter:"termSplitter"},outputs:{resultFocus:"resultFocus",resultUnfocus:"resultUnfocus",resultSelect:"resultSelect",moreResults:"moreResults",resultMouseenter:"resultMouseenter",resultMouseleave:"resultMouseleave"},decls:4,vars:4,consts:[[3,"navigation"],["ngFor","",3,"ngForOf"],["groupTemplate",""],[3,"class","title","collapsed","toggle",4,"ngIf","ngIfElse"],["flatTemplate",""],["storeItemTemplate",""],[3,"title","collapsed","toggle"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["class","moreResults mat-typography",3,"click",4,"ngIf"],["igoListItem","","color","accent",3,"map","result","showIcons","withZoomButton","focused","selected","focus","unfocus","select","mouseenter","mouseleave"],["igoSearchItemToolbar","",3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"moreResults","mat-typography",3,"click"]],template:function(e,t){1&e&&(r.TgZ(0,"igo-list",0),r.YNc(1,Lx,5,2,"ng-template",1,2,r.W1O),r.ALo(3,"async"),r.qZA()),2&e&&(r.Q6J("navigation",!0),r.xp6(1),r.Q6J("ngForOf",r.lcZ(3,2,t.results$)))},directives:[Ei,h.sg,h.O5,Ro,h.tP,mx,$i],pipes:[h.Ov,j.X$],styles:[".moreResults[_ngcontent-%COMP%]{cursor:pointer;color:#00f;float:right;margin-right:10px;margin-top:5px}igo-list[_ngcontent-%COMP%]     mat-list{height:100%}"],changeDetection:0}),e})();function Ox(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",1),r.NdJ("mouseenter",function(t){return r.CHM(e),r.oxw().onMouseEvent(t)})("mouseleave",function(t){return r.CHM(e),r.oxw().onMouseEvent(t)})("click",function(t){return r.CHM(e),r.oxw().onToggleClick(t)}),r.ALo(1,"translate"),r.ALo(2,"async"),r.ALo(3,"async"),r._UZ(4,"mat-icon",2),r.ALo(5,"async"),r.ALo(6,"async"),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("matTooltip",r.lcZ(1,4,r.lcZ(2,6,e.tooltip$)))("color",r.lcZ(3,8,e.isPreview$)?"":e.added?"warn":""),r.xp6(4),r.Q6J("matBadgeHidden",r.lcZ(5,10,e.inRange$))("svgIcon",r.lcZ(6,12,e.isPreview$)?"plus":e.added?"delete":"plus")}}let Mx=(()=>{class e{constructor(e){this.layerService=e,this.tooltip$=new C.X("igo.geo.catalog.layer.addToMap"),this.inRange$=new C.X(!0),this.isPreview$=new C.X(!1),this.layersSubcriptions=[],this.mouseInsideAdd=!1,this._color="primary"}get color(){return this._color}set color(e){this._color=e}ngOnInit(){"Layer"===this.layer.meta.dataType&&(this.added=-1!==this.map.layers.findIndex(e=>e.id===this.layer.data.sourceOptions.id)),this.resolution$$=this.map.viewController.resolution$.subscribe(e=>{this.isInResolutionsRange(e),this.tooltip$.next(this.computeTooltip())})}ngOnDestroy(){this.resolution$$.unsubscribe()}onMouseEvent(e){this.onToggleClick(e)}onToggleClick(e){if(void 0!==this.lastTimeoutRequest&&clearTimeout(this.lastTimeoutRequest),"mouseenter"!==e.type||!this.mouseInsideAdd)switch(e.type){case"click":this.isPreview$.value||(this.added?this.remove():this.add()),this.isPreview$.next(!1);break;case"mouseenter":!this.isPreview$.value&&!this.added&&(this.lastTimeoutRequest=setTimeout(()=>{this.add(),this.isPreview$.next(!0)},500)),this.mouseInsideAdd=!0;break;case"mouseleave":this.isPreview$.value&&(this.remove(),this.isPreview$.next(!1)),this.mouseInsideAdd=!1}}add(){this.added||(this.added=!0,this.addLayerToMap())}remove(){this.added&&(this.added=!1,this.removeLayerFromMap(),this.layersSubcriptions.map(e=>e.unsubscribe()),this.layersSubcriptions=[])}addLayerToMap(){if(void 0===this.map||this.layer.meta.dataType!==Qh)return;const e=this.layer.data;void 0===e.sourceOptions.optionsFromApi&&(e.sourceOptions.optionsFromApi=!0),this.layersSubcriptions.push(this.layerService.createAsyncLayer(e).subscribe(e=>this.map.addLayer(e)))}removeLayerFromMap(){if(void 0===this.map||this.layer.meta.dataType!==Qh)return;const e=this.map.getLayerById(this.layer.data.sourceOptions.id);this.map.removeLayer(e)}isInResolutionsRange(e){this.inRange$.next(e>=(this.layer.data.minResolution||0)&&e<=(this.layer.data.maxResolution||1/0))}computeTooltip(){return this.added?this.inRange$.value?"igo.geo.catalog.layer.removeFromMap":"igo.geo.catalog.layer.removeFromMapOutRange":this.inRange$.value?"igo.geo.catalog.layer.addToMap":"igo.geo.catalog.layer.addToMapOutRange"}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Cu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-search-add-button"]],inputs:{layer:"layer",added:"added",map:"map",color:"color"},decls:1,vars:1,consts:[["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","mouseenter","mouseleave","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","mouseenter","mouseleave","click"],["matBadge","icon","igoMatBadgeIcon","eye-off","igoMatBadgeInverseColor","true","matBadgeDisabled","true","matBadgeSize","small","matBadgePosition","after",3,"matBadgeHidden","svgIcon"]],template:function(e,t){1&e&&r.YNc(0,Ox,7,14,"button",0),2&e&&r.Q6J("ngIf","Layer"===t.layer.meta.dataType)},directives:[h.O5,n.lW,p.gM,a.Hw,Ye.k,Po],pipes:[j.X$,h.Ov],styles:[""],changeDetection:0}),e})(),Ix=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,Ye.g,p.AV,a.Ps,l.ie,n.ot,Uo,Ri,wi,ne,_o,Ll]]}),e})(),kx=(()=>{class e{constructor(e,t,o,i){this.component=e,this.searchService=t,this.searchSourceService=o,this.mediaService=i,this.pointerSearchStore=new dt([]),this.reverseSearch$$=[],this.hasPointerReverseSearchSource=!1,this.searchPointerSummaryFeatureId="searchPointerSummaryFeatureId",this.igoSearchPointerSummaryDelay=1e3,this.igoSearchPointerSummaryEnabled=!1}get map(){return this.component.map}get mapProjection(){return this.component.map.projection}ngOnInit(){this.listenToMapPointerMove(),this.subscribeToPointerStore(),this.map.status$.pipe((0,qe.q)(1)).subscribe(()=>{this.store=new jc([],{map:this.map}),this.initStore()}),this.layers$$=this.map.layers$.subscribe(e=>{this.store&&!e.find(e=>"searchPointerSummaryId"===e.id)&&this.initStore()})}initStore(){Bc(this.store,new fc({id:"searchPointerSummaryId",title:"searchPointerSummary",zIndex:900,source:new nc,showInLayerList:!1,exportable:!1,browsable:!1,style:Px}))}ngAfterContentChecked(){this.hasPointerReverseSearchSource=!!this.searchSourceService.getEnabledSources().filter(ob).length}ngOnDestroy(){this.unlistenToMapPointerMove(),this.unsubscribeToPointerStore(),this.unsubscribeReverseSearch(),this.layers$$.unsubscribe()}subscribeToPointerStore(){this.store$$=this.pointerSearchStore.entities$.subscribe(e=>{this.entitiesToPointerOverlay(e)})}computeSummaryClosestFeature(e){const t={};return e.map(e=>{e.data.properties.type&&e.data.properties.distance>=0&&(t.hasOwnProperty(e.data.properties.type)?e.data.properties.distance<t[e.data.properties.type].distance&&(t[e.data.properties.type]={distance:e.data.properties.distance,title:e.meta.title}):t[e.data.properties.type]={distance:e.data.properties.distance,title:e.meta.title})}),t}entitiesToPointerOverlay(e){const t=this.computeSummaryClosestFeature(e),o=Object.keys(t),i=[],r=[];e.map(e=>{const s=o.indexOf(e.data.properties.type);-1!==s?(r.push(t[e.data.properties.type].title),o.splice(s,1),i.push(e.data.properties.type)):-1===i.indexOf(e.data.properties.type)&&r.push(e.meta.title)}),r.length&&this.addPointerOverlay(r.join("\n"))}listenToMapPointerMove(){this.pointerMoveListener=this.map.ol.on("pointermove",e=>this.onMapEvent(e))}unsubscribeToPointerStore(){this.store$$.unsubscribe()}unsubscribeReverseSearch(){this.reverseSearch$$.map(e=>e.unsubscribe()),this.reverseSearch$$=[]}unlistenToMapPointerMove(){(0,ea.B)(this.pointerMoveListener),this.pointerMoveListener=void 0}onMapEvent(e){!e.dragging&&this.igoSearchPointerSummaryEnabled&&this.hasPointerReverseSearchSource&&!this.mediaService.isTouchScreen()?(void 0!==this.lastTimeoutRequest&&(clearTimeout(this.lastTimeoutRequest),this.clearLayer(),this.unsubscribeReverseSearch()),this.lonLat=(0,kn.vs)(e.coordinate,this.mapProjection,"EPSG:4326"),this.lastTimeoutRequest=setTimeout(()=>{this.onSearchCoordinate()},this.igoSearchPointerSummaryDelay)):this.clearLayer()}onSearchCoordinate(){this.pointerSearchStore.clear();const e=this.searchService.reverseSearch(this.lonLat,{params:{geometry:"false",icon:"false"}},!0);for(const t in e)e.length>0&&this.reverseSearch$$.push(e[t].request.subscribe(o=>{this.onSearch({research:e[t],results:o})}))}onSearch(e){const t=e.results,o=this.pointerSearchStore.all().filter(t=>t.source!==e.research.source).concat(t);this.pointerSearchStore.load(o)}addPointerOverlay(e){this.clearLayer();const t=new _n.Z((0,kn.vs)(this.lonLat,"EPSG:4326",this.mapProjection)),o=new Fn.Z({geometry:t}),i=(new Xn.Z).writeGeometryObject(t,{featureProjection:this.mapProjection,dataProjection:this.mapProjection});this.store.setLayerFeatures([{type:Zl,geometry:i,projection:this.mapProjection,properties:{id:this.searchPointerSummaryFeatureId,pointerSummary:e},meta:{id:this.searchPointerSummaryFeatureId},ol:o}],Fl.None)}clearLayer(){this.store&&this.store.clearLayer()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(lu,2),r.Y36(nb),r.Y36(sb),r.Y36(be))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoSearchPointerSummary",""]],inputs:{igoSearchPointerSummaryDelay:"igoSearchPointerSummaryDelay",igoSearchPointerSummaryEnabled:"igoSearchPointerSummaryEnabled"}}),e})();function Px(e,t){return new Un.ZP({image:new Bn.Z({src:"./assets/igo2/geo/icons/cross_black_18px.svg",imgSize:[18,18]}),text:new Nn.Z({text:e.get("pointerSummary"),textAlign:"left",textBaseline:"bottom",font:"12px Calibri,sans-serif",fill:new Jn.Z({color:"#000"}),backgroundFill:new Jn.Z({color:"rgba(255, 255, 255, 0.5)"}),backgroundStroke:new jn.Z({color:"rgba(200, 200, 200, 0.75)",width:2}),stroke:new jn.Z({color:"#fff",width:3}),overflow:!0,offsetX:10,offsetY:-10,padding:[2.5,2.5,2.5,2.5]})})}let _x=(()=>{class e{static forRoot(){return{ngModule:e,providers:[nb,{provide:sb,useFactory:xb,deps:[ju]},{provide:wb,useFactory:Ab,deps:[ue]},{provide:Fb,useFactory:Mb,deps:[ue]},{provide:kb,useFactory:_b,deps:[ue]}]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,lx,Rb,Ix,Xb],lx,Rb,Ix,Xb]}),e})(),$x=(()=>{class e{constructor(e){this.cdRef=e,this.complete=new r.vpe,this.cancel=new r.vpe}onUpdateInputs(){this.cdRef.detectChanges()}onClose(){this.cancel.emit()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.sBO))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-ogc-filter"]],inputs:{layer:"layer",map:"map"},outputs:{complete:"complete",cancel:"cancel"},decls:1,vars:3,consts:[["igoListItem","",3,"layer","header","map"]],template:function(e,t){1&e&&r._UZ(0,"igo-ogc-filterable-item",0),2&e&&r.Q6J("layer",t.layer)("header",!1)("map",t.map)},directives:[Am],styles:[""],changeDetection:0}),e})();const qx=new r.OlP("OgcFilterWidget");function Dx(e){return e.create($x)}let Ex=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,n.ot,ne,ly]]}),e})();class Rx extends Nr{constructor(e){super(e),this.options=e,this.inResolutionRange$=new C.X(!0),this.map.viewController.resolution$.subscribe(e=>{this.inResolutionRange$.next(e>this.layer.minResolution&&e<this.layer.maxResolution)})}get layer(){return this.options.layer}get map(){return this.options.map}}let Ux=(()=>{class e{constructor(e){this.storageService=e}get zoomAuto(){return this.storageService.get("zoomAuto")}createWorkspace(e,t){var o;if(!1===(null===(o=e.options.workspace)||void 0===o?void 0:o.enabled))return;e.options.workspace=Object.assign({},e.options.workspace,{enabled:!0,srcId:e.id,workspaceId:e.id});const i=new Rx({id:e.id,title:e.title,layer:e,map:t,entityStore:this.createFeatureStore(e,t),actionStore:new vr([]),meta:{tableTemplate:void 0}});return this.createTableTemplate(i,e),i}createFeatureStore(e,t){const o=new jc([],{map:t});o.bindLayer(e);const i=new zc({}),r=new Qc({}),s=new Gc({}),n=new ft({}),a=new Vc({layer:new fc({zIndex:300,source:new nc,style:void 0,showInLayerList:!1,exportable:!1,browsable:!1}),map:t,hitTolerance:15,motion:this.zoomAuto?Fl.Default:Fl.None,many:!0,dragBox:!0});return o.addStrategy(i,!0),o.addStrategy(r,!0),o.addStrategy(s,!0),o.addStrategy(a,!0),o.addStrategy(n,!1),o.addStrategy(this.createFilterInMapExtentOrResolutionStrategy(),!0),o}createTableTemplate(e,t){const o=t.dataSource.options.sourceFields||[];if(0===o.length)return void e.entityStore.entities$.pipe((0,Tn.n)(e=>0===e.length),(0,qe.q)(1)).subscribe(t=>{const o=t[0].ol,i=o.getKeys().filter(e=>!e.startsWith("_")&&"geometry"!==e&&e!==o.getGeometryName()&&!e.match(/boundedby/gi)).map(e=>({name:`properties.${e}`,title:e,renderer:it.UnsanitizedHTML}));e.meta.tableTemplate={selection:!0,sort:!0,columns:i}});const i=o.map(e=>({name:`properties.${e.name}`,title:e.alias?e.alias:e.name,renderer:it.UnsanitizedHTML}));e.meta.tableTemplate={selection:!0,sort:!0,columns:i}}createFilterInMapExtentOrResolutionStrategy(){return new mt({filterClauseFunc:e=>!0===e.state.inMapExtent&&!0===e.state.inMapResolution})}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(Se))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Nx=(()=>{class e{constructor(e,t){this.layerService=e,this.storageService=t}get zoomAuto(){return this.storageService.get("zoomAuto")}createWorkspace(e,t){var o,i,r,s,n,a;if(!0!==(null===(o=e.options.workspace)||void 0===o?void 0:o.enabled))return;const l=e.dataSource,c=e.id+".WmsWorkspaceTableSrc",u=e.id+".WfsWorkspaceTableDest";e.options.linkedLayers||(e.options.linkedLayers={linkId:c,links:[]});const p={bidirectionnal:!0,syncedDelete:!0,linkedIds:[u],properties:[Ml.ZINDEX,Ml.VISIBLE]};(null===(i=e.options.workspace)||void 0===i?void 0:i.minResolution)||p.properties.push(Ml.MINRESOLUTION);let d=!1;(null===(r=l.options.ogcFilters)||void 0===r?void 0:r.enabled)&&(p.properties.push(Ml.OGCFILTERS),d=!0),(null===(s=e.options.workspace)||void 0===s?void 0:s.maxResolution)||p.properties.push(Ml.MAXRESOLUTION);let h,g=[];return e.options.linkedLayers.links&&(g=JSON.parse(JSON.stringify(e.options.linkedLayers.links))),g.push(p),e.options.linkedLayers.linkId=e.options.linkedLayers.linkId?e.options.linkedLayers.linkId:c,e.options.linkedLayers.links=g,this.layerService.createAsyncLayer({id:u,linkedLayers:{linkId:u},workspace:{srcId:e.id,workspaceId:void 0,enabled:!1},showInLayerList:!1,opacity:0,title:e.title,minResolution:(null===(n=e.options.workspace)||void 0===n?void 0:n.minResolution)||e.minResolution||0,maxResolution:(null===(a=e.options.workspace)||void 0===a?void 0:a.maxResolution)||e.maxResolution||1/0,sourceOptions:{download:l.options.download,type:"wfs",url:l.options.urlWfs||l.options.url,queryable:!0,queryTitle:l.options.queryTitle,params:l.options.paramsWFS,ogcFilters:Object.assign({},l.ogcFilters$.value,{enabled:d}),sourceFields:l.options.sourceFields||void 0}}).subscribe(o=>(t.addLayer(o),e.ol.setProperties({linkedLayers:{linkId:e.options.linkedLayers.linkId,links:g}},!1),o.dataSource.ol.refresh(),h=new Rx({id:e.id,title:e.title,layer:o,map:t,entityStore:this.createFeatureStore(o,t),actionStore:new vr([]),meta:{tableTemplate:void 0}}),this.createTableTemplate(h,o),o.options.workspace.workspaceId=o.id,e.options.workspace=Object.assign({},e.options.workspace,{enabled:!0,srcId:e.id,workspaceId:o.id}),delete l.options.download,h)),h}createFeatureStore(e,t){const o=new jc([],{map:t});o.bindLayer(e);const i=new zc({}),r=new Qc({}),s=new Gc({}),n=new ft({}),a=new Vc({layer:new fc({zIndex:300,source:new nc,style:void 0,showInLayerList:!1,exportable:!1,browsable:!1}),map:t,hitTolerance:15,motion:this.zoomAuto?Fl.Default:Fl.None,many:!0,dragBox:!0});return o.addStrategy(i,!0),o.addStrategy(r,!0),o.addStrategy(s,!0),o.addStrategy(a,!0),o.addStrategy(n,!1),o.addStrategy(this.createFilterInMapExtentOrResolutionStrategy(),!0),o}createTableTemplate(e,t){const o=t.dataSource.options.sourceFields||[];if(0===o.length)return void e.entityStore.entities$.pipe((0,Tn.n)(e=>0===e.length),(0,qe.q)(1)).subscribe(t=>{const o=t[0].ol,i=o.getKeys().filter(e=>!e.startsWith("_")&&"geometry"!==e&&e!==o.getGeometryName()&&!e.match(/boundedby/gi)).map(e=>({name:`properties.${e}`,title:e,renderer:it.UnsanitizedHTML}));e.meta.tableTemplate={selection:!0,sort:!0,columns:i}});const i=o.map(e=>({name:`properties.${e.name}`,title:e.alias?e.alias:e.name,renderer:it.UnsanitizedHTML}));e.meta.tableTemplate={selection:!0,sort:!0,columns:i}}createFilterInMapExtentOrResolutionStrategy(){return new mt({filterClauseFunc:e=>!0===e.state.inMapExtent&&!0===e.state.inMapResolution})}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(Cu),r.LFG(Se))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class Jx extends Nr{constructor(e){super(e),this.options=e,this.inResolutionRange$=new C.X(!0),this.map.viewController.resolution$.subscribe(e=>{this.inResolutionRange$.next(e>this.layer.minResolution&&e<this.layer.maxResolution)})}get layer(){return this.options.layer}get map(){return this.options.map}}let Bx=(()=>{class e{constructor(e){this.storageService=e}get zoomAuto(){return this.storageService.get("zoomAuto")}createWorkspace(e,t){var o;if(!1===(null===(o=e.options.workspace)||void 0===o?void 0:o.enabled))return;e.options.workspace=Object.assign({},e.options.workspace,{enabled:!0}),e.options.workspace=Object.assign({},e.options.workspace,{enabled:!0,srcId:e.id,workspaceId:e.id});const i=new Jx({id:e.id,title:e.title,layer:e,map:t,entityStore:this.createFeatureStore(e,t),actionStore:new vr([]),meta:{tableTemplate:void 0}});return this.createTableTemplate(i,e),i}createFeatureStore(e,t){const o=new jc([],{map:t});o.bindLayer(e);const i=new zc({}),r=new Qc({}),s=new Gc({}),n=new ft({}),a=new Vc({layer:new fc({zIndex:300,source:new nc,style:void 0,showInLayerList:!1,exportable:!1,browsable:!1}),map:t,hitTolerance:15,motion:this.zoomAuto?Fl.Default:Fl.None,many:!0,dragBox:!0});return o.addStrategy(i,!0),o.addStrategy(r,!0),o.addStrategy(s,!0),o.addStrategy(a,!0),o.addStrategy(n,!1),o.addStrategy(this.createFilterInMapExtentOrResolutionStrategy(),!0),o}createTableTemplate(e,t){const o=t.dataSource.options.sourceFields||[];if(0===o.length)return void e.entityStore.entities$.pipe((0,Tn.n)(e=>0===e.length),(0,qe.q)(1)).subscribe(t=>{const o=t[0].ol,i=o.getKeys().filter(e=>!e.startsWith("_")&&"geometry"!==e&&e!==o.getGeometryName()&&!e.match(/boundedby/gi)).map(e=>({name:`properties.${e}`,title:e,renderer:it.UnsanitizedHTML}));e.meta.tableTemplate={selection:!0,sort:!0,columns:i}});const i=o.map(e=>({name:`properties.${e.name}`,title:e.alias?e.alias:e.name,renderer:it.UnsanitizedHTML}));e.meta.tableTemplate={selection:!0,sort:!0,columns:i}}createFilterInMapExtentOrResolutionStrategy(){return new mt({filterClauseFunc:e=>!0===e.state.inMapExtent&&!0===e.state.inMapResolution})}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(Se))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),jx=(()=>{class e{constructor(e,t,o,i){this.component=e,this.wfsWorkspaceService=t,this.wmsWorkspaceService=o,this.featureWorkspaceService=i,this.entities$$=[]}get workspaceStore(){return this.component.store}ngOnInit(){this.layers$$=this.map.layers$.pipe((0,w.b)(50)).subscribe(e=>this.onLayersChange(e))}ngOnDestroy(){this.layers$$.unsubscribe(),this.entities$$.map(e=>e.unsubscribe())}onLayersChange(e){const t=e.filter(e=>this.layerIsEditable(e)),o=t.map(e=>e.id),i=t.map(e=>this.getOrCreateWorkspace(e)).filter(e=>void 0!==e),r=this.workspaceStore.all().filter(e=>o.indexOf(e.id)<0);r.length>0&&(r.forEach(e=>{e.entityStore.deactivateStrategyOfType(Qc),e.deactivate()}),this.workspaceStore.state.updateMany(r,{active:!1,selected:!1}),this.workspaceStore.deleteMany(r)),i.length>0&&this.workspaceStore.insertMany(i)}getOrCreateWorkspace(e){if(void 0===this.workspaceStore.get(e.id)){if(e.dataSource instanceof bc)return this.wfsWorkspaceService.createWorkspace(e,this.map);if(e.dataSource instanceof ic){if(!e.dataSource.options.paramsWFS)return;const t=this.wmsWorkspaceService.createWorkspace(e,this.map);return null==t||t.inResolutionRange$.subscribe(o=>{e.dataSource.options.queryable=!o,t.layer.dataSource.options.queryable=o}),t}if(e.dataSource instanceof nc&&!0===e.exportable)return this.featureWorkspaceService.createWorkspace(e,this.map)}}layerIsEditable(e){var t,o;const i=e.dataSource;return i instanceof bc||i instanceof nc||i instanceof ic&&((null===(t=(i.options||{}).ogcFilters)||void 0===t?void 0:t.enabled)||void 0!==(null===(o=i.options.paramsWFS)||void 0===o?void 0:o.featureTypes))}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(kr),r.Y36(Ux),r.Y36(Nx),r.Y36(Bx))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoWorkspaceSelector",""]],inputs:{map:"map"}}),e})(),Qx=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez]]}),e})(),Gx=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez]]}),e})(),Yx=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[{provide:qx,useFactory:Dx,deps:[Mr]}],imports:[[h.ez,Ir,Qx,Gx,Ex],Qx,Gx,Ex]}),e})();class zx extends dt{constructor(){super(...arguments),this.storeInitialized$=new C.X(!1)}clearStops(){this.storeInitialized$.next(!1),this.clear()}}class Hx extends jc{}class Vx extends jc{}class Wx extends jc{}let Xx=(()=>{class e extends Iv{constructor(e,t){super(),this.http=e,this.config=t,this.directionsUrl="https://geoegl.msp.gouv.qc.ca/services/itineraire/route/v1/driving/",this.options=this.config.getConfig("directionsSources.osrm")||{},this.directionsUrl=this.options.url||this.directionsUrl}get enabled(){return!1!==this.options.enabled}set enabled(e){this.options.enabled=e}getName(){return e._name}route(e,t={}){const o=this.getRouteParams(t);return this.http.get(this.directionsUrl+e.join(";"),{params:o}).pipe((0,x.U)(e=>this.extractRoutesData(e)))}extractRoutesData(e){const t=[];return e.routes.forEach(o=>{t.push(this.formatRoute(o,e.waypoints))}),t}getRouteParams(e={}){return e.alternatives=void 0===e.alternatives||e.alternatives,e.steps=void 0===e.steps||e.steps,e.geometries=void 0!==e.geometries?e.geometries:"geojson",e.overview=void 0!==e.overview&&e.overview,new y.LE({fromObject:{alternatives:e.alternatives?"true":"false",overview:e.overview?"simplified":"full",steps:e.steps?"true":"false",geometries:e.geometries?e.geometries:"geojson"}})}formatRoute(t,o){const i=[];return t.legs.forEach(e=>{e.steps.forEach(e=>{i.push(e)})}),{id:N(),title:t.legs[0].summary,source:e._name,sourceType:$v.Route,order:1,format:_v.GeoJSON,icon:"directions",projection:"EPSG:4326",waypoints:o,distance:t.distance,duration:t.duration,geometry:t.geometry,legs:t.legs,steps:i,weight:t.weight,weight_name:t.weight_name}}}return e._name="OSRM Qu\xe9bec",e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(W))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),(0,je.gn)([(0,Qe.q)({maxCacheCount:20})],e.prototype,"route",null),e})();function Kx(e,t){return new Xx(e,t)}let ew=(()=>{class e extends ju{constructor(e,t,o,i){super(i,o),this.http=e,this.languageService=t}getId(){return e.id}getType(){return e.type}getDefaultOptions(){return{title:"Cadastre (Qu\xe9bec)",searchUrl:"https://carto.cptaq.gouv.qc.ca/php/find_lot_v1.php?"}}search(e,t){e=(e=(e=e.endsWith(",")?e.slice(0,-1):e).startsWith(",")?e.substr(1):e).replace(/ /g,"");const o=this.computeSearchRequestParams(e,t||{});return o.get("numero")&&o.get("numero").match(/^[0-9,]+$/g)?this.http.get(this.searchUrl,{params:o,responseType:"text"}).pipe((0,x.U)(t=>this.extractResults(t,e))):(0,A.of)([])}computeSearchRequestParams(e,t){return new y.LE({fromObject:Object.assign({numero:e,epsg:"4326"},this.params,t.params||{})})}extractResults(e,t){return e.split("<br />").filter(e=>e.length>0).map(e=>this.dataToResult(e,t))}dataToResult(e,t){const o=e.split(";"),i=o[0],r=this.computeGeometry(o[7]),s={NoLot:i,Route:'<span class="routing"> <u>'+this.languageService.translate.instant("igo.geo.seeRouting")+"</u> </span>"},n=[this.getId(),"cadastre",i].join(".");return{source:this,meta:{dataType:Zl,id:n,title:i,score:rb(t.trim(),i),icon:"map-marker"},data:{type:Zl,projection:"EPSG:4326",geometry:r,properties:s,meta:{id:n,title:i}}}}computeGeometry(e){const t=(new la.Z).readFeature(e,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});return{type:t.getGeometry().getType(),coordinates:t.getGeometry().getCoordinates()}}}return e.id="cadastre",e.type=Zl,e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(ue),r.LFG(Se),r.LFG("options"))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),(0,je.gn)([(0,Qe.q)({maxCacheCount:20})],e.prototype,"search",null),e})();function tw(e,t,o,i){return new ew(e,t,o,i.getConfig(`searchSources.${ew.id}`))}let ow=(()=>{class e extends ju{constructor(e,t,o){super(t,o),this.http=e}getId(){return e.id}getType(){return e.type}getDefaultOptions(){return{title:"Nominatim (OSM)",searchUrl:"https://nominatim.openstreetmap.org/search",settings:[{type:"checkbox",title:"results type",name:"amenity",values:[{title:"igo.geo.search.nominatim.type.food",value:"bar,bbq,biergaten,cafe,drinking_water,fast_food,food_court,ice_cream,pub,restaurant",enabled:!1},{title:"igo.geo.search.nominatim.type.health",value:"baby_hatch,clinic,dentist,doctors,hospital,nursing_home,pharmacy,social_facility,veterinary",enabled:!1},{title:"igo.geo.search.nominatim.type.entertainment",value:"arts_centre,brothel,casino,cinema,community_center_fountain,gambling,nightclub,planetarium                           ,public_bookcase,social_centre,stripclub,studio,swingerclub,theatre,internet_cafe",enabled:!1},{title:"igo.geo.search.nominatim.type.finance",value:"atm,bank,bureau_de_change",enabled:!1}]},{type:"radiobutton",title:"results limit",name:"limit",values:[{title:"10",value:10,enabled:!0},{title:"20",value:20,enabled:!1},{title:"50",value:50,enabled:!1}]},{type:"radiobutton",title:"restrictExtent",name:"countrycodes",values:[{title:"igo.geo.search.nominatim.country.canada",value:"CA",enabled:!0},{title:"igo.geo.search.nominatim.country.all",value:null,enabled:!1}]},{type:"radiobutton",title:"multiple object",name:"dedupe",values:[{title:"igo.geo.search.searchSources.settings.true",value:0,enabled:!1},{title:"igo.geo.search.searchSources.settings.false",value:1,enabled:!0}]}]}}search(e,t){const o=this.computeSearchRequestParams(e,t||{});return o.get("q")?this.http.get(this.searchUrl,{params:o}).pipe((0,x.U)(t=>this.extractResults(t,e))):(0,A.of)([])}computeSearchRequestParams(e,t){return new y.LE({fromObject:Object.assign({q:this.computeTerm(e),format:"json"},this.params,t.params||{})})}extractResults(e,t){return e.map(e=>this.dataToResult(e,t))}dataToResult(e,t){const o=this.computeProperties(e),i=this.computeGeometry(e),r=this.computeExtent(e),s=[this.getId(),"place",e.place_id].join(".");return{source:this,meta:{dataType:Zl,id:s,title:e.display_name,icon:"map-marker",score:rb(t.trim(),e.display_name)},data:{type:Zl,projection:"EPSG:4326",geometry:i,extent:r,properties:o,meta:{id:s,title:e.display_name}}}}computeProperties(e){return{display_name:e.display_name,place_id:e.place_id,osm_type:e.osm_type,class:e.class,type:e.type}}computeGeometry(e){return{type:"Point",coordinates:[parseFloat(e.lon),parseFloat(e.lat)]}}computeExtent(e){return[parseFloat(e.boundingbox[2]),parseFloat(e.boundingbox[0]),parseFloat(e.boundingbox[3]),parseFloat(e.boundingbox[1])]}computeTerm(e){return this.computeTermTags(e)}computeTermTags(e){const t=super.getHashtagsValid(e,"amenity");return t?t.length?(e=e.replace(/(#[^\s]*)/g,""),t.forEach(t=>{e+="+["+t+"]"}),e):null:this.computeTermSettings(e)}computeTermSettings(e){return this.options.settings.forEach(t=>{"amenity"===t.name&&t.values.forEach(t=>{t.enabled&&"string"==typeof t.value&&t.value.split(",").forEach(t=>{e+="+["+t+"]"})})}),e}}return e.id="nominatim",e.type=Zl,e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG("options"),r.LFG(Se))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),(0,je.gn)([(0,Qe.q)({maxCacheCount:20})],e.prototype,"search",null),e})();function iw(e,t,o){return new ow(e,t.getConfig(`searchSources.${ow.id}`),o)}let rw=(()=>{class e extends ju{constructor(e,t,o,i){if(super(i,o),this.http=e,this.languageService=t,this.storedQueriesOptions=i,this.storedQueriesOptions&&!this.storedQueriesOptions.available)return;const r="title";if(this.storedQueriesOptions||(console.log(" No configuration for this search source (storedqueries). You will use the default values"),this.storedQueriesOptions={storedquery_id:"rtss",fields:[{name:"rtss",defaultValue:"-99"},{name:"chainage",defaultValue:"0",splitPrefix:"\\+"}],outputformat:"text/xml; subtype=gml/3.1.1",srsname:"EPSG:4326",resultTitle:r},this.resultTitle=r,console.log("Default values",this.storedQueriesOptions)),!this.storedQueriesOptions.storedquery_id)throw new Error('Stored Queries :You have to set "storedquery_id" into StoredQueries options. ex: storedquery_id: "nameofstoredquerie"');if(!this.storedQueriesOptions.fields)throw new Error('Stored Queries :You have to set "fields" into options. ex: fields: {"name": "rtss", "defaultValue": "-99"}');if(this.storedQueriesOptions.outputformat=this.storedQueriesOptions.outputformat||"text/xml; subtype=gml/3.1.1",this.storedQueriesOptions.srsname=this.storedQueriesOptions.srsname||"EPSG:4326",this.storedQueriesOptions.storedquery_id.toLowerCase().includes("getfeaturebyid")&&this.storedQueriesOptions.outputformat.toLowerCase().includes("getfeaturebyid")){let e="You must set a geojson format for your stored query. This is due to an openlayers issue)";throw e+=" (wfs 1.1.0 & gml 3.1.1 limitation)",new Error(e)}this.storedQueriesOptions.fields instanceof Array||(this.storedQueriesOptions.fields=[this.storedQueriesOptions.fields]),this.multipleFieldsQuery=this.storedQueriesOptions.fields.length>1,this.storedQueriesOptions.fields.forEach((e,t)=>{if(this.multipleFieldsQuery&&!e.splitPrefix&&0!==t)throw new Error("Stored Queries :You must set a field spliter into your field definition (optional for the first one!)");if(!e.defaultValue)throw new Error("Stored Queries :You must set a field default value into your field definition")}),this.storedQueriesOptions.resultTitle=this.storedQueriesOptions.resultTitle||this.resultTitle}getId(){return e.id}getType(){return e.type}getDefaultOptions(){return{title:"Stored Queries",searchUrl:"https://ws.mapserver.transports.gouv.qc.ca/swtq"}}search(e,t){const o=this.termSplitter(e,this.storedQueriesOptions.fields),i=this.computeRequestParams(t||{},o);return null===this.options.params?this.options.params={page:"1"}:this.options.params.page=null!==t.page?String(t.page):"1",new RegExp(".*?gml.*?","i").test(this.storedQueriesOptions.outputformat)?this.http.get(this.searchUrl,{params:i,responseType:"text"}).pipe((0,x.U)(t=>{let o=this.extractResults(this.extractWFSData(t),e);if(o.sort((e,t)=>e.meta.score>t.meta.score||e.meta.score===t.meta.score&&e.meta.titleHtml<t.meta.titleHtml?1:-1),o.reverse(),o.length>Number(this.options.params.limit)){const e=Number(this.options.params.limit)*Number(this.options.params.page),t=o.length;o=o.slice(0,e),o[o.length-1].meta.nextPage=e<t}return o})):this.http.get(this.searchUrl,{params:i}).pipe((0,x.U)(t=>this.extractResults(this.extractWFSData(t),e)))}getFormatFromOptions(){let e;const t=this.storedQueriesOptions.outputformat,o=new RegExp(".*?gml.*?","i");return new RegExp(".*?json.*?","i").test(t)&&(e=Xn.Z),o.test(t)&&(e=ca.Z),new e}extractWFSData(e){const t=this.getFormatFromOptions(),o=Xn.Z,i=t.readFeatures(e);return JSON.parse((new o).writeFeatures(i))}termSplitter(e,t){const o={};let i=e,r=0;return t.forEach(e=>{o[e.name]=e.defaultValue;const t=new RegExp(e.splitPrefix+"(.+)","i");t.test(i)&&(r=e.splitPrefix?r+=1:r,i=i.split(t)[1])}),0===r?(o[t[0].name]=e,o):(i=e,[...t].reverse().forEach(e=>{const t=new RegExp(e.splitPrefix||"(.+)","i");if(i||""!==i){const r=i.split(t);i=r[0],r[1]&&(o[e.name]=r[1].trim())}}),o)}computeRequestParams(e,t){const o=this.storedQueriesOptions.storedquery_id.toLowerCase().includes("getfeaturebyid")?"2.0.0":"1.1.0";return new y.LE({fromObject:Object.assign({service:"wfs",version:o,request:"GetFeature",storedquery_id:this.storedQueriesOptions.storedquery_id,srsname:this.storedQueriesOptions.srsname,outputformat:this.storedQueriesOptions.outputformat},t,this.params,e.params||{})})}extractResults(e,t){return e.features.map(e=>this.dataToResult(e,t))}dataToResult(e,t){const o=this.computeProperties(e),i=[this.getId(),o.type,e.id].join("."),r=e.properties[this.storedQueriesOptions.resultTitle]?this.storedQueriesOptions.resultTitle:this.resultTitle;return{source:this,data:{type:Zl,projection:"EPSG:4326",geometry:e.geometry,properties:o,meta:{id:i,title:e.properties[r]}},meta:{dataType:Zl,id:i,title:e.properties.title,titleHtml:e.properties[r],icon:"map-marker",score:rb(t.trim(),e.properties.title?e.properties.title:e.properties[r])}}}computeProperties(t){return Object.assign({},D.removeKeys(t.properties,e.propertiesBlacklist),{Route:'<span class="routing"> <u>'+this.languageService.translate.instant("igo.geo.seeRouting")+"</u> </span>"})}}return e.id="storedqueries",e.type=Zl,e.propertiesBlacklist=["boundedBy","id","coord_x","coord_y"],e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(ue),r.LFG(Se),r.LFG("options"))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),(0,je.gn)([(0,Qe.q)({maxCacheCount:20})],e.prototype,"search",null),e})(),sw=(()=>{class e extends ju{constructor(e,t,o,i){if(super(i,o),this.http=e,this.languageService=t,this.storedQueriesOptions=i,this.storedQueriesOptions&&(!this.storedQueriesOptions||this.storedQueriesOptions.available)){if(!this.storedQueriesOptions.storedquery_id)throw new Error('Stored Queries :You have to set "storedquery_id" into StoredQueries options. ex: storedquery_id: "nameofstoredquerie"');if(!this.storedQueriesOptions.longField)throw new Error('Stored Queries :You have to set "longField" to map the longitude coordinate to the query params.');if(!this.storedQueriesOptions.latField)throw new Error('Stored Queries :You have to set "latField" to map the latitude coordinate to the query params.');this.storedQueriesOptions.outputformat=this.storedQueriesOptions.outputformat||"text/xml; subtype=gml/3.1.1",this.storedQueriesOptions.srsname=this.storedQueriesOptions.srsname||"EPSG:4326",this.storedQueriesOptions.resultTitle=this.storedQueriesOptions.resultTitle||this.resultTitle}}getId(){return e.id}getType(){return e.type}getDefaultOptions(){return{title:"Stored Queries (reverse)",searchUrl:"https://ws.mapserver.transports.gouv.qc.ca/swtq"}}reverseSearch(e,t){const o=this.computeRequestParams(e,t||{});return new RegExp(".*?gml.*?","i").test(this.storedQueriesOptions.outputformat)?this.http.get(this.searchUrl,{params:o,responseType:"text"}).pipe((0,x.U)(e=>this.extractResults(this.extractWFSData(e)))):this.http.get(this.searchUrl,{params:o}).pipe((0,x.U)(e=>this.extractResults(this.extractWFSData(e))))}getFormatFromOptions(){let e;const t=this.storedQueriesOptions.outputformat,o=new RegExp(".*?gml.*?","i");return new RegExp(".*?json.*?","i").test(t)&&(e=Xn.Z),o.test(t)&&(e=ca.Z),new e}extractWFSData(e){const t=this.getFormatFromOptions(),o=Xn.Z,i=t.readFeatures(e);return JSON.parse((new o).writeFeatures(i))}computeRequestParams(e,t){const o={};return o[this.storedQueriesOptions.longField]=e[0],o[this.storedQueriesOptions.latField]=e[1],new y.LE({fromObject:Object.assign({service:"WFS",version:"1.1.0",request:"GetFeature",storedquery_id:this.storedQueriesOptions.storedquery_id,srsname:this.storedQueriesOptions.srsname,outputformat:this.storedQueriesOptions.outputformat},o,this.params,t.params||{})})}extractResults(e){return e.features.map(e=>this.dataToResult(e))}dataToResult(e){const t=this.computeProperties(e),o=[this.getId(),t.type,e.id].join("."),i=e.properties[this.storedQueriesOptions.resultTitle]?this.storedQueriesOptions.resultTitle:this.resultTitle;return{source:this,data:{type:Zl,projection:"EPSG:4326",geometry:e.geometry,properties:t,meta:{id:o,title:e.properties[i]}},meta:{dataType:Zl,id:o,title:e.properties[i],icon:"map-marker"}}}computeProperties(t){const o=D.removeKeys(t.properties,e.propertiesBlacklist),i={Route:'<span class="routing"> <u>'+this.languageService.translate.instant("igo.geo.seeRouting")+"</u> </span>"};return Object.assign(o,{type:t.properties.doc_type},i)}}return e.id="storedqueriesreverse",e.type=Zl,e.propertiesBlacklist=[],e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(ue),r.LFG(Se),r.LFG("options"))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),(0,je.gn)([(0,Qe.q)({maxCacheCount:20})],e.prototype,"reverseSearch",null),e})();function nw(e,t,o,i){return new rw(e,t,o,i.getConfig(`searchSources.${rw.id}`))}function aw(e,t,o,i){return new sw(e,t,o,i.getConfig(`searchSources.${sw.id}`))}function lw(e){return e.entityStore.getStrategyOfType(mt).active$.pipe((0,x.U)(e=>e?"igo.geo.workspace.inMapExtent.active.tooltip":"igo.geo.workspace.inMapExtent.inactive.tooltip"))}function cw(e){return e.entityStore.stateView.manyBy$(e=>!0===e.state.selected).pipe((0,x.U)(e=>e.length>=1))}function uw(e,t){if(1&e&&(r.TgZ(0,"p"),r._uU(1),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Oqu(e.pointerCoord)}}const pw=d.Bz.forChild([{path:"simple-map",component:(()=>{class e{constructor(e,t,o,i){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.mediaService=i,this.pointerCoordDelay=0,this.map=new nu({controls:{attribution:{collapsed:!0},scaleLine:!0}}),this.view={center:[-73,47.2],zoom:6,rotation:.75},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e}))})}get media(){return this.mediaService.getMedia()}get isTouchScreen(){return this.mediaService.isTouchScreen()}onPointerMove(e){this.pointerCoord=e}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ue),r.Y36(Ec),r.Y36(Cu),r.Y36(be))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-simple-map"]],decls:18,vars:8,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/simple-map"],["igoPointerPosition","",3,"map","view","pointerPositionDelay","pointerPositionCoord"],["color","primary",3,"map"],["color","primary",3,"map","showIfNoRotation"],[4,"ngIf"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Simple Map"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"hr"),r.qZA(),r.TgZ(13,"igo-map-browser",1),r.NdJ("pointerPositionCoord",function(e){return t.onPointerMove(e)}),r._UZ(14,"igo-zoom-button",2),r._UZ(15,"igo-geolocate-button",2),r._UZ(16,"igo-rotation-button",3),r.qZA(),r.qZA(),r.YNc(17,uw,2,1,"p",4)),2&e&&(r.xp6(13),r.Q6J("map",t.map)("view",t.view)("pointerPositionDelay",t.pointerCoordDelay),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("map",t.map)("showIfNoRotation",!0),r.xp6(1),r.Q6J("ngIf",!t.isTouchScreen))},directives:[g.a8,g.$j,g.n5,g.dn,lu,cu,fu,yu,Ou,h.O5],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}"]}),e})()}]);let dw=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,pw,g.QW,n.ot,rv]]}),e})();function hw(e,t){if(1&e&&(r._UZ(0,"igo-metadata-button",6),r._UZ(1,"igo-download-button",6),r._UZ(2,"igo-ogc-filter-button",7),r._UZ(3,"igo-time-filter-button",7),r._UZ(4,"igo-track-feature-button",8)),2&e){const e=t.layer;r.Q6J("layer",e),r.xp6(1),r.Q6J("layer",e),r.xp6(1),r.Q6J("header",!0)("layer",e),r.xp6(1),r.Q6J("header",!0)("layer",e),r.xp6(1),r.Q6J("layer",e)("trackFeature",!0)}}const gw=d.Bz.forChild([{path:"layer",component:(()=>{class e{constructor(e,t,o){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.map=new nu({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],maxLayerZoomExtent:[-11e6,45e5,-45e5,1e7],zoom:7},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",visible:!0,baseLayer:!0,source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"shp"},ogcFilters:{enabled:!0,editable:!0,filters:{operator:"PropertyIsEqualTo",propertyName:"code_municipalite",expression:"10043"}}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"WFS ",visible:!0,source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:"geojson_utf8",srsName:"EPSG:32198",outputFormatDownload:"shp"},ogcFilters:{enabled:!0,editable:!0,filters:{operator:"PropertyIsEqualTo",propertyName:"code_municipalite",expression:"12072"}},formatOptions:{dataProjection:"EPSG:32198"}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"WFS (Custom EPSG)",visible:!0,source:e,removable:!1}))}),this.layerService.createAsyncLayer({sourceOptions:{type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",optionsFromCapabilities:!0,params:{LAYERS:"parc_routier",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"R\xe9seau routier",visible:!1,sourceOptions:{type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",params:{LAYERS:"bgr_v_sous_route_res_sup_act",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"lieu habit\xe9",visible:!1,sourceOptions:{type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",optionsFromCapabilities:!0,params:{LAYERS:"lieuhabite",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"sh_dis_eco",visible:!1,sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/mffpecofor.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"sh_dis_eco",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"nurc:Arc_Sample_Parent",visible:!1,legendOptions:{display:!0,stylesAvailable:[{name:"rain",title:"Pluie"},{name:"raster",title:"D\xe9faut"}]},sourceOptions:{type:"wms",url:"https://demo.geo-solutions.it/geoserver/ows",optionsFromCapabilities:!0,params:{LAYERS:"nurc:Arc_Sample",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"Avertissements routier",visible:!1,sourceOptions:{type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",params:{LAYERS:"evenements",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",refreshIntervalSec:15,params:{LAYERS:"vg_observation_v_inondation_embacle_wmst",VERSION:"1.3.0"}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle",source:e,metadata:{url:"https://www.donneesquebec.ca/recherche/fr/dataset/historique-publique-d-embacles-repertories-au-msp",extern:!0}}))})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ue),r.Y36(Ec),r.Y36(Cu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-layer"]],decls:19,vars:7,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/layer"],[3,"map","view"],["color","primary",3,"map"],["title","Layers"],["floatLabel","never",3,"map","layers","expandLegendOfVisibleLayers","queryBadge"],["igoLayerItemToolbar",""],[3,"layer"],[3,"header","layer"],[3,"layer","trackFeature"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Simple Map"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"hr"),r.qZA(),r.TgZ(13,"igo-map-browser",1),r._UZ(14,"igo-zoom-button",2),r.qZA(),r.TgZ(15,"igo-panel",3),r.TgZ(16,"igo-layer-list",4),r.YNc(17,hw,5,8,"ng-template",null,5,r.W1O),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.xp6(13),r.Q6J("map",t.map)("view",t.view),r.xp6(1),r.Q6J("map",t.map),r.xp6(2),r.Q6J("map",t.map)("layers",t.map.layers)("expandLegendOfVisibleLayers",!1)("queryBadge",!0))},directives:[g.a8,g.$j,g.n5,g.dn,lu,fu,Bi,Kp,Tl,Nd,Im,yg,hd],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),e})()}]);let mw=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[gw,g.QW,n.ot,a.Ps,ji,rv,md,ly,Ll,Jd]]}),e})();const fw=d.Bz.forChild([{path:"legend",component:(()=>{class e{constructor(e,t,o){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.map=new nu({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:7},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",visible:!0,baseLayer:!0,source:e}))}),this.layerService.createAsyncLayer({title:"legend with display:false",visible:!0,legendOptions:{display:!1,html:"test html"},sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/mffpecofor.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"sh_dis_eco",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"legend in html",visible:!0,legendOptions:{display:!0,html:"<h2>HTML l\xe9gende</h2>"},sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/mffpecofor.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"sh_sreg_eco",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"legend with url param",visible:!0,legendOptions:{url:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxASEhUQEBISFRUVFRAQFRUQFRUVFRAPFRUWFhUVFRUYHSggGBolGxUVITEiJSkrLi4uFx8zODMsNygtLisBCgoKDg0OGhAQGy0dHyUtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tKy0tLS0tLS0tLf/AABEIAKgBLAMBIgACEQEDEQH/xAAbAAABBQEBAAAAAAAAAAAAAAACAQMEBQYAB//EADwQAAIBAwEGAwYFAgUEAwAAAAECAAMEESEFEjFBUWETInEGFDKBkaFCscHR8FJyFSNTYoIzQ5LxFqLh/8QAGQEAAwEBAQAAAAAAAAAAAAAAAAECAwQF/8QAJREBAQACAgEFAAEFAAAAAAAAAAECERIhAwQTMUFRYRQiI3Gh/9oADAMBAAIRAxEAPwB0QhAEMTFQhCEEQhACEIQRFEYEIQgiEIAU6IIsAWLEnQAp0KmBqSdFBY+g5D1OBGD4nxYBHQafQzLPzTDLVbYeHLObh2LARwwyD+4PQiFNJZZuMrLLqlnRJ0ZFiTp0A6KEOM4OITuF8q4L8ydVp9sc2+0atrlw/hVGLBw2MnO66gsMdBpjHeYZeoxmXGOjH0+Vx5UsSLEm7ndEM6IYAhgmEYJgCGCYRgmIBMEwjAJgAmAYRgkwAGjTxxjGniBipGo5UjcAthCEAGEIwMQhAEIGAHFEERcxgYiiBmEDADzFgAxcwA50HMXMANh5H/tA+rrJhXy8JDXJDAcSpx6jB/SE18u6uuhGnqeU4vPP8m7+PR9N34tT9V20FZD4ifMcmHSSra5V1DKdD9Qeh7yLd1d4HAOJm7W9q27NlWKE55cOozzleLLTPz4b7bPM7MrbXbC1AFRQGb4d84OemP17Rk7YYsUREJUn8XxhfjI7gzp5xyXGrjMj3l5uYVfjYeX/AGrzb15D5mRau0N0Bt3e3uAVhoO56ympms1Z6lTtgaaDHAdgBiZZ+Tc1G3i8fe60FsN0AZ1iLUzXpDTRifqpHGVh2ioGMP8AIQtm3G9WUdmbX+04nNw3Y7+Wsb/peRJ0Qz0HkOMQzokQcTBM4xCYBxgGKTBJgCEwTFJgEwBCYBMUmCTABaMvHGMacxGZeNw3jUCWwMIGNAwgYwdBhAxoGEDAHAYQMbBigwBzMIGNAwgYA4DFzGwYWYwPMXMbzCBgD1PjxxylRUuEpv4J0PDXPx9BLNDrI17bMtd2PmVgrNngHwNdZzeeTqur02dm4RquAWK4A111yOxme2tXZicaAcuZGf3/ADl7UrFtRwA68x69jM/eVGffZcBkyxA0bdAGZHjna/Jl0pKdJmuFUN8A3ufyA+UGz3jVABIOWBOez5z05fWSrxs0qV2g1DbrY/pJAx35H6yMoxWDjhq2Ou8Dp/5GdDmBYsy7yF87rnGpx/NZfWd4yrg65JGeJHM6SjpjcthUK+apUI7glifyMnUKhV9zPH4vpjT7yMpteF0tL6qwAK6j0zr6x72YY1HLlQNwNnHMnQfrIyVAujHThx0lt7MhQKqjj5W/46iRjO42zyvG6XGYhMSJmdLjdmITOJgkwBSYJMQmITAOJgkziYJMA4mATOJgEwDiYBM4mATAOYxpzCJjTGIG3MbzFcwMwCzBhAxpQekPdPSPVLcOAwgYzgxd6GjPAwsxkNFDQB7MUNGhnpDCGPVLcOAxQY3unpFzA9nQYoMaBhAxBO2bS3qijvk+g1kXbFVqlY0qWAB56jHn0EnbPfw1ZzngeExu3L2qRu0iVNVtWGclQPyyZz+T+7LTfx9Y7XdfaNvRQh2ydFAXBJY6AADhrjjMlW2jRSqCyVFLb2vlO8uobKjQj9oT2lMUmpHILbp8TGSHU6b2OIzIVwtVt1moFmUEK9IhlI7a9esMJB5Ll9L1dnqLUCk29TJJ05KSfuAT9BK/w/PpodBwGdOGny9NInsrfstSpQq+UMDuqdd0jj+hkg4Fbf5Zzj7Qm5bKq9yWHLq1QUEeqd1UffAxx5LpzPDSU9G/pl2dKTnd0YlgCfly4R72huHqV6dKjhgi4wdBvEfY6SOthUGfFZKYbG8KZLVHA5Y5SsZNdoz3vpate0agXdyuQG3X4gH85P8AZ2p4dfdfmCgP+08P0lNcW3jDK090IMIc6jHAd47sWuxanv8AEFR8wZOuul7beoMEiBmFVyTnrGjmdHbmKTBJiZnYgCExCYpWAYg4mAWiEwC0AItAJiFoBaAKTAJiFoJMA5jGnMJjG2gDTmDmKwMHBhomsFsI4trLJLaP07aepxjjtqmNn2jbWA6TRi1gNbCK4Y0TLJnvch0hrZdpc+COkcShJ4YnyyVVOzjwtO0tVoiOCkJWoXalNnANl2l74U4UIaxPtRe59oq2faXvgTnTAJ0+gkZSKm2M9pK2F8NSQeOnT9pQJbFqbVq9ZRpujGm4O2ect/amoynLZ3dfh00PUzMW9AK2uMH4S3mHbAPOeLbvderJrUO+IHXcRqjqOBekx9QGUg4+RjKW1VGyhK9cAjP/ABM0lihGFqPT64Ua/wD1kza9gXVGViMHOFpv59eBMmZ96O4xjaNBxVNTdw7ndXPEA8TIj3JBPE68wdZtKeyvGTB31ZSSrqGTB5EZOT85namyqu97rk+Lx8TAx4e98Weu7p1zNMcti46VtrSZnFRR5hkH04D6ayStlU1YAknJydSPU/WaB9jigoCbxYnLMys28Txzidsy2KKcsxzyKFQO2WzFzK4M8XXIR9/e0KsWA83TdXQQrOo6VlBXy7+8OfHiJZ7QsS2rboA1UhRnI4a6SHswO9dd4g6jkVOnYiPG7icpp6LTtwVB7RDajpBt78DRvvH/AH1ZvPPYxvilR/dlne7iSPGUwHdYf1U/C9j+TDWwgGzzHGrATkuR1mmPqML8xN8GU+Ki1LDtGv8ADzLujWUyQKAM6Zhhe3PblOmaNlBNjNT7oOkZqW4j9vEuVZr3CC1oJoDbxipZw4Q+VULUBGzb9polsIZsBF7cHJmPdD0ie5zTe4RPcu0qeKJudaJbacaMaW9ne9TH3m3tnRTMUWxMKjWllQIMfvUe3FctnFNsZdLTE40BF7lPhFL7tE92ls9CR3oGL3aOEREoR8W8NaZEdEPdo4REa2kPaFLdQky33pA2yM0mHaTl5bqqmE2yF8ErJgg4xxI4ntnjMc9N0yppgINTUYjyjkWc8PQYlvR2luVGSrndUgZ6k8FH3k7aNrTqqoqaLxWmuSSepxr+vpPPn8uxmLFwrb9Niyg6u5O4D0A+Jzrw9Jq7C/p1BuFjjucHeHHOD3GnLnrpMnteg4ICEBVyCyjSmnMKvXlnnnAwDqxb3wUhcYxhDg5wF1K/fB6lm7StS9lu/bf+5Mo8gU548vrxMpG2NW8fxd8cMbpXQjP1kKx2zcAZVsjjg8DrJr+0tXnTXPDOsXU+D+Vi1uxH+YFUDnnOR+kp9pbVpou4nDUZ46+n8/SQ7zaNWpjeY45gcBKa+vV1GBk/U6/nz/8AcJjunbqHql+w1NUlTwHEHtrofQiFb3qrh38nJQOHqU5fKV1FN3LvjH9J4N0P84QqVJqzg/g7jgOhmmmdu2pvr1t1cZ1Gc/hP04SGu2WQ7rR2nWVk3AVwowN7OCZn9s13yKemBqMYixm+itaVdtA8DJ9ttANznm4uWXnLSy2lgZzDLx/gmbZ3lbTIMrqN6d7GZWU9rqeJkb3vLgrFMP1VybaxdidJorJmHGUGwwzAEiX7XAAwY/H5ssPhOfjmS0R1Mbq0hK1nIGQY5bXe8NTOvH1Eyc98OkoUYnu8RLgR9amZtM2dxAtvOahJIEBjK5xPFEqUwJBeprJt3UAEzdzdeY6zPLzaOePbcps9e0L/AA4dJW09o1BxWSKe1+oM5OUdXE89liAodYX+KrOF6hj5wcTyXhHGODaYkZipgG3Uw5jinC/U84a3APOVhsl6wDa9GMXKjiuBVWGMGUPgVOTSXRFQcY5kNLTwRIm0LfyH0MEXbDiI1dbSBUiPotMNtawR8OOKZO7nAL/zny5a6jF3l/cU3L587ZHDRKY00HLJ4dh3mr2lvhjVpkFMtvr1A79ZE8ajcDBAD8xzHQZ+k5rdNpNswdsOiDxBlm1HLGuhx24/MSDUuVxvU9NBkdcgZ/naX+1dj7zDGCNEHYAfw/OUd7sKoDoDz4fQSsbiLMg0L9eRZTofLwJ5nEsVvSQMEHn007zPvs6qOXI4wOcdt7e4A3TqOGvDMu4xPKrK8r1GGE0zrK0lE1Ygtr9ZEqUq+8QoYZ5dPST9mbHz56p0HIx6khbtqRs62asByAz5Tkj+cZZ3VZKaGjTxvt9usgXF+f8Ap0RjGBnkO8C2UJlmbLccnv0zJ190966iws3VFwQGxqe31lZcMu8TjGekds7nVmYZz5cc4l5bEciM8MjEufKag3FvkZWQDvLLClX3TumSXtlaVtOlNTZidJodhW53gWjFCgqydZVSGzIzvS8Me29s75KaY5yBd7Wzw+0qQ5PGMuxBnJa6pjFqu1anDlJFLaeBrKRq2kAVsysUZRa0/aDdfBOk0uydso/AzynajkHIh7P2g9MhgSJ1Y7nbmuq9sN0McZWXe1FHEiZq22m1ZNG+kS22O1U5ZjD3h7azvdrKRoZlbi5JYnM1dD2YTmWPzjh2BRGm4PpJ7vdPUnw0NGgx+IYhtbCW7UpFqWy88iGhtULa68ZKS1XtHfcFJyHM6tZNyePUG3NZ9DGXsao+FozVsq/4XEVLW6/1F+kWv4Dmo3A6GMV2uRwUH5yZv3K8d0wm2qy/HSPy1ho0K2vao+ND8pY09rrzBHqIFLbFBtOB7x2rbpUGVIilB9b6mw4iQ7w02U4xwMYr7PbGglXWsXXJ1Eq5CRQ1qLGk3hnO4xGP9szW6lQgklH+IngSM66GW3+IFC6qMgtu4P4uWgme2xc+bygZGpI7Hh9dJGrs9xOb3mm3HfGOXEAc+8JNsgndIKnkCMcOEpBt5kwTjQa4568B9oR21Tc+dRoQo7aZOvpF7d+4rnPqr1LpSQB3PXGRgfpGGZs4ABGn01IP86SppIh1QkajTPLOknWTMjEE59f6c4+uknjpUy2kJqx0Hy5aZlZtO6GoB04a8AeklOzZYKJQ3jK2jNjtLwxRlkb97J8qDA4EnnOe4Pwrr8v3nF6IGCfl1hU95x/lKFX+o8Zqz2KgAmrnXiB0mh9/NWhlk0XTMzFeg40G8x68pK2O1Viafhs2RoADmFn2UokUE4IkqpSKiC9AqcEFSDqDxEnOuV1itVIrLepvHEuLeljUyBQoYOZNNWZZ1rhE4NOqtI9N51SpMuDbloDVI2z44Rlt5jhQT/aM/lJFLZF2w0oVPmMfnNJGWWSDdJvSFd6LiXjez17/AKLfMr+8hXexrofFRf5YP5TWVjew+z+0igmq2f7UAYXHGU+xvZhviqndHTnLC62Va6qr+YDkRmZZZY29LmOWu24ttpBlGCIFVWJ4mZT2c2dVQ5Z/T0mqLGLnvo+Om4DwWAPKMLCDTfbLTmtUPLEaOzRyJj2/6wg8Ogrq+yHPwuZCqbGuR8NQ/OX+8YYc9fyhqBl22Rd/6sae0vV/Eh9QZqKtZxwUn+3EHxcjJRvprFYcrJVEqf8AdoBu6a/Yxmnof8moyH+ipn9ZsPBzqAV9RKu+2dVbiiOv0Mjirki2ntCVIS4XHLe5H5y2uHpumQRqJm721qoMeE7pzUgkj+085SJfvRPlLGm3JshkPTBi3Z8nqX4RtpWtKmlR6jYPiNu4x5RMlV2Z4qnwgxUebI54zgA8M/vNPV2OtxVFWuc0qYyFzoWJzrJVrWp1AapA8FDu00XgzD8Rx3hy0VxYil7NVCm8FJAIAAGdSAePPlIdXZaqPMCOJJweWh/Oenrf1ar+HTUIAN9ieRI8oA689eEZuEWoDSuAjZ47vlA7b2fN8oTy/o4fjzZaCqcjTHCPVr8annqPUHj+8l7Z2HUouSgLodQVGcfIcJR1mA0PPryM11Kjek6zqkNkNnXnKe8phqrdznEstnWdWq2KSlsfTHrNLsj2URH8W4IJ4hAeJ7mFymI1az+yNg75B0A5F8y7q0UoEK64HBWOCra6AGLta7u97IUIg0AQ4wO3IwrfaAqLuVNQ2hBBAJ7f0kdpF3e1TU6NeDSqkKh3W6/hbtkcD2jaq1u281XXBwFVgQegbGD9Yxf7JqU8VKJ38fhPxYGvz/PSS6hS5okjRlBOD8SkcQecc/4VDWvKdUZyS3VskyOwPIymt3K1N09cazTWNMtooLHoNZVx0UyRKNJzyku12RVqHyAn0ms2T7Lu2GqkAdBrNTQtqNEYAGn84CRdLlrIbO9i3YDxHx2XUy+tfY61p6shc/7tf/yWr7RxooP/AIn8sSK+0UY+YVVPZTg/XSLo7s74NOmMU6aL6LGffQ3lzg+kYN1RByXYf8WB9eOPtHqN5bVPxjPDJGDJCsudpVkbcYadeokG6vqg83FTx04TV07ZOJdHXln9JL8OnjAVT2wBCSj4YY12chcZzoMSds72NtUqeNVyznXU6D5cJqVorn/poMcMYMSuBzXP7R446K3Y1taOBhRpwkKvbrn4BCNUE+Rs9uYjqk8xH0O04Oen3hmQaVxHQ8pKauOs7HeRd4wlJ6wCSSP/AFBL9MxsRcmAPo/Uzt8dzGgIYWMONbtAas3yhPpIdZzHsaSTV7/eMXNJXGHVWHRgD+cbWqOAEcCdY52FTfbCouhRVZAcE+G3T1z9pSXexqlNadOnh0Vt473kxrkZHMCbMiRquDpJuMPahegtOmFGMsxZyPxdsyjvL2lTfKrvMRrnXHp0mpvLEOMA4lDtL2WqMd5GGnUcfpMbhdtJlNKOl7TVN4gBR2lXdWdC8rA1PIx0O7oGMXbOzqlFt90I5EjUGVlglZ6quadUIuSCqnX7TTDH7ic7GztLBLVXRMKgAJJ1Zmmd2rdMy75JGuF5GOUPfXfd3SygkgucEjlkTrzYl61QOyAqOQPOTwvLsTKadTu2NMipwA4HnGNneEy7yjUHjnOnTEtP/itzVQhmCZ+ZxFs/YitSXcVxgnU45RzHorlNoV9cimA3MlcfvHqQtCQ7O9NyDnChlIP9XD85p7T2ctwAKi75HNjmHfez1vU0A3ca+XT6yuPSeW2HX2cUtvU7iiykg+clGHyOn3m02PbW9BQDUTqSGBLH5cpW3fskRqnm7DQ/aV52Qy6MHHqTC205I2F17UUlG7SBbvwEz9z7Q12/Hx5KMYjVts4D8DH6mFb7IqbxCocciREfR+32rWHmZyf1k239oXPHQyPU2DXOuAOgzGDs9wQCsCae020rDDYj1SiG1plfRgCJkLi2qLjcU9TLjZVZ9CYocy0sjQdf+zSz/tHGLb+Lzor8s/vJi3MJLnJ0jvRy7O0Cw/CAPU/vHDUx3iUzn4sQXccBHpBqqik7w0PUfr1jxRzqpGO/WNEQPFxwMVitomHzHkqHrEnQkI5TrmOi4nTpRDW5jouDOnRmIV2jq3ESdFQJ68YJJnToASkLqZFr7S1wonTobBErMRrG3M6dEAKxkynV0nTowi3Qpt8QBi0FpcAonToEbr2VPO9gQhTUjAnTpROWniGyTp0ZK+uwBgb/AEE6dIqofpEwy4X4hn1nToqccbxQMhRH7a7zyAnToYlXVq0ZVA3ETp0mnB1LVcaxilQXOAIk6HxSSjSAEra+8moiTppZuJnRy3vAeJklWXOQZ06R8KO+IesBlnTo7Q//2Q=="},sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/mffpecofor.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"sh_reg_eco",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"shp"},ogcFilters:{enabled:!0,editable:!0,filters:{operator:"PropertyIsEqualTo",propertyName:"code_municipalite",expression:"10043"}}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"WFS ",visible:!0,source:e}))}),this.layerService.createAsyncLayer({sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"MELS_CS_ANGLO_S",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"R\xe9seau routier",visible:!1,sourceOptions:{type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",params:{LAYERS:"bgr_v_sous_route_res_sup_act",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"lieu habit\xe9",visible:!1,sourceOptions:{type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",optionsFromCapabilities:!0,params:{LAYERS:"lieuhabite",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"2 styles nurc:Arc_Sample_Parent",visible:!0,legendOptions:{display:!0,stylesAvailable:[{name:"rain",title:"Pluie"},{name:"raster",title:"D\xe9faut"}]},sourceOptions:{type:"wms",url:"https://demo.geo-solutions.it/geoserver/ows",optionsFromCapabilities:!0,params:{LAYERS:"nurc:Arc_Sample",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"Avertissements routier",visible:!1,sourceOptions:{type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",params:{LAYERS:"evenements",VERSION:"1.3.0"}}}).subscribe(e=>this.map.addLayer(e)),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",refreshIntervalSec:15,params:{LAYERS:"vg_observation_v_inondation_embacle_wmst",VERSION:"1.3.0"}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle",visible:!0,source:e,metadata:{url:"https://www.donneesquebec.ca/recherche/fr/dataset/historique-publique-d-embacles-repertories-au-msp",extern:!0}}))})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ue),r.Y36(Ec),r.Y36(Cu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-legend"]],decls:17,vars:8,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/layer"],[3,"map","view"],["color","primary",3,"map"],["title","Legends"],[3,"layers","excludeBaseLayers","allowShowAllLegends","updateLegendOnResolutionChange","showAllLegendsValue"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Simple Map with a legend list"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"hr"),r.qZA(),r.TgZ(13,"igo-map-browser",1),r._UZ(14,"igo-zoom-button",2),r.qZA(),r.TgZ(15,"igo-panel",3),r._UZ(16,"igo-layer-legend-list",4),r.qZA(),r.qZA()),2&e&&(r.xp6(13),r.Q6J("map",t.map)("view",t.view),r.xp6(1),r.Q6J("map",t.map),r.xp6(2),r.Q6J("layers",t.map.layers)("excludeBaseLayers",!0)("allowShowAllLegends",!0)("updateLegendOnResolutionChange",!1)("showAllLegendsValue",!1))},directives:[g.a8,g.$j,g.n5,g.dn,lu,fu,Bi,pd],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),e})()}]);let yw=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[fw,g.QW,n.ot,a.Ps,ji,rv,md,ly,Ll,Jd]]}),e})();const vw=d.Bz.forChild([{path:"overlay",component:(()=>{class e{constructor(e,t,o){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.map=new nu({overlay:!0,controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:6}}ngOnInit(){this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e}))})}ngAfterViewInit(){this.map.overlay.setFeatures([{type:Zl,projection:"EPSG:4326",meta:{id:1},properties:{},geometry:{type:"Point",coordinates:[-73,46.6]}},{type:Zl,projection:"EPSG:4326",meta:{id:2},properties:{},geometry:{type:"LineString",coordinates:[[-72,47.8],[-73.5,47.4],[-72.4,48.6]]}},{type:Zl,projection:"EPSG:4326",meta:{id:3},properties:{},geometry:{type:"Polygon",coordinates:[[[-71,46.8],[-73,47],[-71.2,46.6]]]}}],Fl.None)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ue),r.Y36(Ec),r.Y36(Cu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-overlay"]],decls:15,vars:3,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/overlay"],[3,"map","view"],["color","primary",3,"map"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Overlay"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"hr"),r.qZA(),r.TgZ(13,"igo-map-browser",1),r._UZ(14,"igo-zoom-button",2),r.qZA(),r.qZA()),2&e&&(r.xp6(13),r.Q6J("map",t.map)("view",t.view),r.xp6(1),r.Q6J("map",t.map))},directives:[g.a8,g.$j,g.n5,g.dn,lu,fu],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}"]}),e})()}]);let bw=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[vw,g.QW,n.ot,rv,dv]]}),e})();function xw(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-form",4),r.NdJ("submitForm",function(t){return r.CHM(e),r.oxw().onSubmit(t)}),r.ALo(1,"async"),r._UZ(2,"igo-form-group",5),r.TgZ(3,"div",6),r.TgZ(4,"button",7),r.NdJ("click",function(){return r.CHM(e),r.oxw().fillForm()}),r._uU(5," Fill Form "),r.qZA(),r.TgZ(6,"button",7),r.NdJ("click",function(){return r.CHM(e),r.oxw().clearForm()}),r._uU(7," Clear Form "),r.qZA(),r.TgZ(8,"button",8),r._uU(9," Submit "),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=t.ngIf,o=r.oxw();r.Q6J("form",e)("formData",r.lcZ(1,4,o.data$)),r.xp6(2),r.Q6J("group",e.groups[0]),r.xp6(6),r.Q6J("disabled",o.submitDisabled)}}const ww=d.Bz.forChild([{path:"geometry",component:(()=>{class e{constructor(e,t,o,i){this.languageService=e,this.formService=t,this.dataSourceService=o,this.layerService=i,this.map=new nu({controls:{attribution:{collapsed:!0},scaleLine:!0}}),this.view={center:[-73,47.2],zoom:15},this.form$=new C.X(void 0),this.data$=new C.X(void 0),this.submitDisabled=!0}ngOnInit(){this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e}))});const e=[{name:"geometry",title:"Geometry",options:{validator:We.kI.required},type:"geometry",inputs:{map:this.map,geometryTypeField:!0,geometryType:"Polygon",drawGuideField:!0,drawGuide:50,drawGuidePlaceholder:"Draw Guide",drawStyle:new Un.ZP({stroke:new jn.Z({color:[255,0,0,1],width:2}),fill:new Jn.Z({color:[255,0,0,.2]}),image:new Qn.Z({radius:8,stroke:new jn.Z({color:[255,0,0,1]}),fill:new Jn.Z({color:[255,0,0,.2]})})})}},{name:"name",title:"Name",options:{validator:We.kI.required}}].map(e=>this.formService.field(e)),t=this.formService.form([],[this.formService.group({name:"info"},e)]);this.valueChanges$$=t.control.valueChanges.subscribe(()=>{this.submitDisabled=!t.control.valid}),this.form$.next(t)}ngOnDestroy(){this.valueChanges$$.unsubscribe()}fillForm(){this.data$.next({name:"Place",geometry:JSON.stringify({type:"Polygon",coordinates:[[[-106,42],[-107,31],[-81,32],[-82,42],[-106,42]]]})})}clearForm(){this.form$.value.control.reset()}onSubmit(e){alert(JSON.stringify(e))}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ue),r.Y36(li),r.Y36(Ec),r.Y36(Cu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-geometry"]],decls:13,vars:6,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/form"],[3,"map","view"],["color","primary",3,"map"],[3,"form","formData","submitForm",4,"ngIf"],[3,"form","formData","submitForm"],[3,"group"],["formButtons",""],["mat-stroked-button","","type","button","color","primary",3,"click"],["mat-flat-button","","type","submit","color","primary",3,"disabled"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Geometry Form"),r.qZA(),r.TgZ(5,"mat-card-content"),r._uU(6," See the "),r.TgZ(7,"a",0),r._uU(8,"code of this example"),r.qZA(),r.qZA(),r.TgZ(9,"igo-map-browser",1),r._UZ(10,"igo-zoom-button",2),r.qZA(),r.YNc(11,xw,10,6,"igo-form",3),r.ALo(12,"async"),r.qZA()),2&e&&(r.xp6(9),r.Q6J("map",t.map)("view",t.view),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("ngIf",r.lcZ(12,4,t.form$)))},directives:[g.a8,g.$j,g.n5,g.dn,lu,fu,h.O5,ni,yi,n.lW],pipes:[h.Ov],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}igo-map-browser[_ngcontent-%COMP%]{width:500px;height:500px}"]}),e})()}]);let Sw=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,ww,n.ot,g.QW,bi,hg,rv]]}),e})();const Cw=d.Bz.forChild([{path:"feature",component:(()=>{class e{constructor(e,t,o){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.map=new nu({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:6},this.tableTemplate={selection:!0,selectMany:!0,sort:!0,columns:[{name:"properties.id",title:"ID"},{name:"properties.name",title:"Name"},{name:"properties.description",title:"Description"}]},this.store=new jc([],{map:this.map})}ngOnInit(){const e=new Yc({});this.store.addStrategy(e);const t=new Vc({map:this.map,motion:Fl.Default});this.store.addStrategy(t),this.store.load([{meta:{id:1},type:"Feature",geometry:{type:"Point",coordinates:[-72,47.8]},projection:"EPSG:4326",properties:{id:1,name:"Name 1",description:"Description 1"}},{meta:{id:2},type:"Feature",geometry:{type:"LineString",coordinates:[[-72,47.8],[-73.5,47.4],[-72.4,48.6]]},projection:"EPSG:4326",properties:{id:2,name:"Name 2",description:"Description 2"}},{meta:{id:3},type:"Feature",geometry:{type:"Polygon",coordinates:[[[-71,46.8],[-73,47],[-71.2,46.6]]]},projection:"EPSG:4326",properties:{id:3,name:"Name 3",description:"Description 3"}}]),this.layerService.createAsyncLayer({title:"MVT test",visible:!0,sourceOptions:{type:"mvt",url:"https://ahocevar.com/geoserver/gwc/service/tms/1.0.0/ne:ne_10m_admin_0_countries@EPSG:900913@pbf/{z}/{x}/{-y}.pbf",queryable:!0},mapboxStyle:{url:"assets/mapboxStyleExample-vectortile.json",source:"ahocevar"}}).subscribe(e=>this.map.addLayer(e)),this.dataSourceService.createAsyncDataSource({type:"vector"}).subscribe(o=>{const i=this.layerService.createLayer({title:"Vector Layer",source:o,animation:{duration:2e3},mapboxStyle:{url:"assets/mapboxStyleExample-feature.json",source:"source_nameX"}});this.map.addLayer(i),this.store.bindLayer(i),e.activate(),t.activate()})}ngOnDestroy(){this.store.destroy()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ue),r.Y36(Ec),r.Y36(Cu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-feature"]],decls:12,vars:5,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geom/feature"],[3,"map","view"],["color","primary",3,"map"],[3,"store","template"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Feature"),r.qZA(),r.TgZ(5,"mat-card-content"),r._uU(6," See the "),r.TgZ(7,"a",0),r._uU(8,"code of this example"),r.qZA(),r.qZA(),r.TgZ(9,"igo-map-browser",1),r._UZ(10,"igo-zoom-button",2),r.qZA(),r._UZ(11,"igo-entity-table",3),r.qZA()),2&e&&(r.xp6(9),r.Q6J("map",t.map)("view",t.view),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("store",t.store)("template",t.tableTemplate))},directives:[g.a8,g.$j,g.n5,g.dn,lu,fu,uo],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),e})()}]);let Tw=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[Cw,h.ez,g.QW,n.ot,a.Ps,ji,Ti,rv,Bh]]}),e})();const Aw=d.Bz.forChild([{path:"hover",component:(()=>{class e{constructor(e,t,o,i){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.mediaService=i,this.pointerCoordDelay=0,this.pointerHoverFeatureDelay=0,this.map=new nu({controls:{attribution:{collapsed:!0},scaleLine:!0}}),this.view={center:[-73,47.2],zoom:8,projection:"EPSG:3857"},this.dataSourceService.createAsyncDataSource({type:"wmts",url:"https://geoegl.msp.gouv.qc.ca/apis/carto/wmts/1.0.0/wmts",layer:"carte_gouv_qc_public",matrixSet:"EPSG_3857",version:"1.3.0"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Quebec",visible:!0,baseLayer:!0,source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"adn_bassin_n1_public_v",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"3.0.0",outputFormat:void 0,outputFormatDownload:"shp"}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"WFS (polygon)",visible:!0,source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"CASERNE",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"3.0.0",outputFormat:void 0,outputFormatDownload:"shp"}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"WFS (point)",visible:!0,source:e,styleByAttribute:{attribute:"en_caserne",data:["true","false"],stroke:["red","blue"],fill:["#ffffff","#ffffff"],radius:[7,7],width:[2,2],hoverStyle:{label:{attribute:"Caserne: ${nom_service_incendie}\xa0\n Mun: ${ville}",style:{textAlign:"left",textBaseline:"bottom",font:"12px Calibri,sans-serif",fill:{color:"#000"},backgroundFill:{color:"rgba(255, 255, 255, 0.5)"},backgroundStroke:{color:"rgba(200, 200, 200, 0.75)",width:2},stroke:{color:"#fff",width:3},overflow:!0,offsetX:10,offsetY:-10,padding:[2.5,2.5,2.5,2.5]}},baseStyle:{circle:{stroke:{color:"orange",width:5},width:[5],radius:15}}}}}))})}get media(){return this.mediaService.getMedia()}get isTouchScreen(){return this.mediaService.isTouchScreen()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ue),r.Y36(Ec),r.Y36(Cu),r.Y36(be))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-hover"]],decls:17,vars:8,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/hover"],["igoHoverFeature","",3,"map","view","igoHoverFeatureDelay","igoHoverFeatureEnabled"],["color","primary",3,"map"],["color","primary",3,"map","showIfNoRotation"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Hover"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"hr"),r.qZA(),r.TgZ(13,"igo-map-browser",1),r._UZ(14,"igo-zoom-button",2),r._UZ(15,"igo-geolocate-button",2),r._UZ(16,"igo-rotation-button",3),r.qZA(),r.qZA()),2&e&&(r.xp6(13),r.Q6J("map",t.map)("view",t.view)("igoHoverFeatureDelay",t.pointerHoverFeatureDelay)("igoHoverFeatureEnabled",!0),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("map",t.map)("showIfNoRotation",!0))},directives:[g.a8,g.$j,g.n5,g.dn,lu,hu,fu,yu,Ou],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:500px}"]}),e})()}]);let Lw=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,Aw,g.QW,n.ot,rv]]}),e})();const Zw=d.Bz.forChild([{path:"measure",component:(()=>{class e{constructor(e,t,o){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.map=new nu({controls:{attribution:{collapsed:!0},scaleLine:!0}}),this.view={center:[-73,47.2],zoom:6,projection:"EPSG:3857"},this.store=new jc([],{map:this.map}),this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e}))})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ue),r.Y36(Ec),r.Y36(Cu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-measure"]],decls:16,vars:5,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/measure"],[3,"map","view"],["color","primary",3,"map"],[3,"store","map"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Simple Map"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"hr"),r.qZA(),r.TgZ(13,"igo-map-browser",1),r._UZ(14,"igo-zoom-button",2),r.qZA(),r._UZ(15,"igo-measurer",3),r.qZA()),2&e&&(r.xp6(13),r.Q6J("map",t.map)("view",t.view),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("store",t.store)("map",t.map))},directives:[g.a8,g.$j,g.n5,g.dn,lu,fu,lg],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-measurer[_ngcontent-%COMP%]     mat-divider{position:inherit!important;left:inherit!important;width:160px!important}"]}),e})()}]);let Fw=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[Zw,g.QW,rv,lv]]}),e})();const Ow=d.Bz.forChild([{path:"draw",component:(()=>{class e{constructor(e,t,o){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.map=new nu({controls:{attribution:{collapsed:!0},scaleLine:!0}}),this.view={center:[-73,47.2],zoom:6,projection:"EPSG:3857"},this.store=new jc([],{map:this.map}),this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e}))})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ue),r.Y36(Ec),r.Y36(Cu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-draw"]],decls:16,vars:5,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/draw"],[3,"map","view"],["color","primary",3,"map"],[3,"store","map"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Simple Map"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"hr"),r.qZA(),r.TgZ(13,"igo-map-browser",1),r._UZ(14,"igo-zoom-button",2),r.qZA(),r._UZ(15,"igo-draw",3),r.qZA()),2&e&&(r.xp6(13),r.Q6J("map",t.map)("view",t.view),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("store",t.store)("map",t.map))},directives:[g.a8,g.$j,g.n5,g.dn,lu,fu,Rh],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-draw[_ngcontent-%COMP%]     mat-divider{position:inherit!important;left:inherit!important;width:160px!important}"]}),e})()}]);let Mw=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[Ow,g.QW,rv,Uh]]}),e})();function Iw(e,t){if(1&e&&(r.ynx(0),r.TgZ(1,"h1"),r._uU(2,"Query Title : "),r.TgZ(3,"span",5),r._uU(4),r.qZA(),r.qZA(),r._UZ(5,"igo-feature-details",6),r.BQk()),2&e){const e=t.ngIf,o=r.oxw();r.xp6(4),r.Oqu(o.getTitle(e)),r.xp6(1),r.Q6J("feature",e)}}const kw=d.Bz.forChild([{path:"query",component:(()=>{class e{constructor(e,t,o,i){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.overlayService=i,this.feature$=new C.X(void 0),this.map=new nu({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:6},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",queryable:!0,queryTitle:"num_rts",params:{layers:"bgr_v_sous_route_res_sup_act",version:"1.3.0"}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"WMS",source:e,sourceOptions:e.options}))}),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",queryable:!0,queryFormat:Gl.HTMLGML2,queryHtmlTarget:zl.IFRAME,params:{layers:"bgr_v_sous_route_res_sup_act",version:"1.3.0"}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"WMS html with a pre call in GML",source:e,sourceOptions:e.options}))}),this.dataSourceService.createAsyncDataSource({type:"vector",queryable:!0,queryTitle:"So beautiful ${name}",sourceFields:[{name:"name",alias:"Alias name"},{name:"description",alias:"Alias description"}]}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Vector Layer",source:e,sourceOptions:e.options})),this.addFeatures(e)})}addFeatures(e){const t=new Fn.Z({name:"feature1",geometry:new Wn.Z([kn.vs([-72,47.8],"EPSG:4326","EPSG:3857"),kn.vs([-73.5,47.4],"EPSG:4326","EPSG:3857"),kn.vs([-72.4,48.6],"EPSG:4326","EPSG:3857")])}),o=new Fn.Z({name:"feature2",geometry:new _n.Z(kn.vs([-73,46.6],"EPSG:4326","EPSG:3857"))}),i=new Fn.Z({name:"feature3",geometry:new Vn.ZP([[kn.vs([-71,46.8],"EPSG:4326","EPSG:3857"),kn.vs([-73,47],"EPSG:4326","EPSG:3857"),kn.vs([-71.2,46.6],"EPSG:4326","EPSG:3857")]])});e.ol.addFeatures([t,o,i])}handleQueryResults(e){const t=e.features;let o;t.length&&(o=t[0]),this.feature$.next(o),this.map.queryResultsOverlay.setFeatures([o],Fl.None)}getTitle(e){return lt(e)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ue),r.Y36(Ec),r.Y36(Cu),r.Y36(uv))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-query"]],decls:18,vars:7,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/query"],["igoOverlay","","igoQuery","",3,"map","view","queryFeatures","query"],["color","primary",3,"map"],["title","Details"],[4,"ngIf"],[2,"background-color","#e0e0e0"],[3,"feature"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Query"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"hr"),r.qZA(),r.TgZ(13,"igo-map-browser",1),r.NdJ("query",function(e){return t.handleQueryResults(e)}),r._UZ(14,"igo-zoom-button",2),r.qZA(),r.TgZ(15,"igo-panel",3),r.YNc(16,Iw,6,2,"ng-container",4),r.ALo(17,"async"),r.qZA(),r.qZA()),2&e&&(r.xp6(13),r.Q6J("map",t.map)("view",t.view)("queryFeatures",!0),r.xp6(1),r.Q6J("map",t.map),r.xp6(2),r.Q6J("ngIf",r.lcZ(17,5,t.feature$)))},directives:[g.a8,g.$j,g.n5,g.dn,lu,pv,Bu,fu,Bi,h.O5,eh],pipes:[h.Ov],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),e})()}]);let Pw=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[kw,h.ez,g.QW,n.ot,a.Ps,ji,rv,dv,Mv,Bh]]}),e})();const _w=d.Bz.forChild([{path:"catalog",component:(()=>{class e{constructor(e,t,o,i,r){this.configService=e,this.languageService=t,this.layerService=o,this.catalogService=i,this.storageService=r,this.map=new nu({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:7},this.catalogStore=new dt([]),this.catalogItemStore=new dt([])}ngOnInit(){this.layerService.createAsyncLayer({title:"OSM",sourceOptions:{type:"osm"}}).subscribe(e=>this.map.addLayer(e)),this.loadCatalogs()}onCatalogSelectChange(e){this.loadCatalogItems(e.catalog)}loadCatalogs(){this.catalogService.loadCatalogs().subscribe(e=>{this.catalogStore.clear(),this.catalogStore.load(e.concat(this.storageService.get("addedCatalogs")||[]))})}loadCatalogItems(e){this.catalogService.loadCatalogItems(e).subscribe(e=>{this.catalogItemStore.clear(),this.catalogItemStore.load(e)})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(W),r.Y36(ue),r.Y36(Cu),r.Y36(zu),r.Y36(Se))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-catalog"]],decls:23,vars:6,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/catalog"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/environments"],[3,"map","view"],["color","primary",3,"map"],["title","Catalog Library"],[3,"store","catalogSelectChange"],["title","Catalog Browser"],[3,"store","map"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Catalog"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: ConfigService, LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"br"),r._uU(13," See catalog section of the "),r.TgZ(14,"a",1),r._uU(15," environment config"),r.qZA(),r._UZ(16,"hr"),r.qZA(),r.TgZ(17,"igo-map-browser",2),r._UZ(18,"igo-zoom-button",3),r.qZA(),r.TgZ(19,"igo-panel",4),r.TgZ(20,"igo-catalog-library",5),r.NdJ("catalogSelectChange",function(e){return t.onCatalogSelectChange(e)}),r.qZA(),r.qZA(),r.TgZ(21,"igo-panel",6),r._UZ(22,"igo-catalog-browser",7),r.qZA(),r.qZA()),2&e&&(r.xp6(17),r.Q6J("map",t.map)("view",t.view),r.xp6(1),r.Q6J("map",t.map),r.xp6(2),r.Q6J("store",t.catalogStore),r.xp6(2),r.Q6J("store",t.catalogItemStore)("map",t.map))},directives:[g.a8,g.$j,g.n5,g.dn,lu,fu,Bi,Ld,Xu],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}"]}),e})()}]);let $w=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[K({default:Gr.igo})],imports:[[h.ez,_w,g.QW,n.ot,a.Ps,p.AV,te,ji,rv,kd]]}),e})();var qw=o(96330);Error,Error;var Dw=(()=>{return(e=Dw||(Dw={}))[e.null=0]="null",e[e.read=1]="read",e[e.write=2]="write",Dw;var e})();let Ew=(()=>{class e{constructor(e,t,o,i,r,s){this.http=e,this.authService=t,this.languageService=o,this.config=i,this.messageService=r,this.route=s,this.context$=new C.X(void 0),this.contexts$=new C.X({ours:[]}),this.defaultContextId$=new C.X(void 0),this.editedContext$=new C.X(void 0),this.importedContext=[],this.toolsChanged$=new O.xQ,this.mapViewFromRoute={},this.options=Object.assign({basePath:"contexts",contextListFile:"_contexts.json",defaultContextUri:"_default"},this.config.getConfig("context")),this.baseUrl=this.options.url,this.readParamsFromRoute(),this.authService.hasAuthService?this.authService.logged$.subscribe(e=>{e&&(this.contexts$.pipe((0,Oe.T)(1),(0,Sn.P)()).subscribe(e=>{this.handleContextsChange()}),this.loadContexts())}):(this.loadContexts(),this.handleContextsChange(!1))}get defaultContextUri(){return this._defaultContextUri||this.options.defaultContextUri}set defaultContextUri(e){this._defaultContextUri=e}get(e,t){let o=this.baseUrl+"/contexts";return e&&this.authService.authenticated&&(o+="?permission="+e.join(),t&&(o+="&hidden=true")),this.http.get(o)}getById(e){return this.http.get(this.baseUrl+"/contexts/"+e)}getDetails(e){return this.http.get(`${this.baseUrl}/contexts/${e}/details`).pipe((0,b.K)(t=>this.handleError(t,e)))}getDefault(){return this.http.get(this.baseUrl+"/contexts/default").pipe((0,Ie.b)(e=>{this.defaultContextId$.next(e.id)}))}getProfilByUser(){return this.baseUrl?this.http.get(this.baseUrl+"/profils?"):(0,A.of)([])}setDefault(e){return this.http.post(this.baseUrl+"/contexts/default",{defaultContextId:e})}hideContext(e){return this.http.post(this.baseUrl+"/contexts/"+e+"/hide",{})}showContext(e){return this.http.post(this.baseUrl+"/contexts/"+e+"/show",{})}delete(e,t=!1){const o={ours:[]};return Object.keys(this.contexts$.value).forEach(t=>o[t]=this.contexts$.value[t].filter(t=>t.id!==e)),t?(this.importedContext=this.importedContext.filter(t=>t.id!==e),(0,A.of)(this.contexts$.next(o))):this.http.delete(this.baseUrl+"/contexts/"+e).pipe((0,Ie.b)(e=>{this.contexts$.next(o)}))}create(e){return this.http.post(this.baseUrl+"/contexts",e).pipe((0,x.U)(e=>(e.permission=this.authService.authenticated?Dw[Dw.write]:Dw[Dw.read],this.contexts$.value.ours.unshift(e),this.contexts$.next(this.contexts$.value),e)))}clone(e,t={}){return this.http.post(this.baseUrl+"/contexts/"+e+"/clone",t).pipe((0,x.U)(e=>(e.permission=Dw[Dw.write],this.contexts$.value.ours.unshift(e),this.contexts$.next(this.contexts$.value),e)))}update(e,t){return this.http.patch(this.baseUrl+"/contexts/"+e,t)}addToolAssociation(e,t){return this.http.post(`${this.baseUrl}/contexts/${e}/tools`,{toolId:t})}deleteToolAssociation(e,t){return this.http.delete(`${this.baseUrl}/contexts/${e}/tools/${t}`)}getPermissions(e){return this.http.get(this.baseUrl+"/contexts/"+e+"/permissions")}addPermissionAssociation(e,t,o){return this.http.post(`${this.baseUrl}/contexts/${e}/permissions`,{profil:t,typePermission:o}).pipe((0,b.K)(e=>[this.handleError(e,void 0,!0)]))}deletePermissionAssociation(e,t){return this.http.delete(`${this.baseUrl}/contexts/${e}/permissions/${t}`)}getLocalContexts(){const e=this.getPath(this.options.contextListFile);return this.http.get(e).pipe((0,x.U)(e=>({ours:e})))}getLocalContext(e){const t=this.getPath(`${e}.json`);return this.http.get(t).pipe((0,ke.zg)(t=>{if(!t.base)return(0,A.of)(t);const o=this.getPath(`${t.base}.json`);return this.http.get(o).pipe((0,x.U)(e=>{const o=t;return o.map=D.mergeDeep(e.map,t.map),o.layers=(e.layers||[]).concat(t.layers||[]).reverse().filter((e,t,o)=>!e.id||o.findIndex(t=>t.id===e.id)===t).reverse(),o.toolbar=t.toolbar||e.toolbar,o.message=t.message||e.message,o.messages=t.messages||e.messages,o.tools=(t.tools||[]).concat(e.tools||[]).filter((e,t,o)=>o.findIndex(t=>t.name===e.name)===t),o}),(0,b.K)(t=>this.handleError(t,e)))}),(0,b.K)(t=>this.handleError(t,e)))}loadContexts(e,t){let o;o=this.baseUrl?this.get(e,t):this.getLocalContexts(),o.subscribe(e=>{e.ours=this.importedContext.concat(e.ours),this.contexts$.next(e)})}loadDefaultContext(){const e=(e=!1)=>{!e&&this.baseUrl&&this.authService.authenticated?this.getDefault().subscribe(e=>{this.defaultContextUri=e.uri,this.addContextToList(e),this.setContext(e)},()=>{this.defaultContextId$.next(void 0),this.loadContext(this.defaultContextUri)}):this.loadContext(this.defaultContextUri)};this.route&&this.route.options.contextKey?this.route.queryParams.pipe((0,w.b)(100)).subscribe(t=>{const o=t[this.route.options.contextKey];let i=!1;o&&(this.defaultContextUri=o,i=!0),e(i)}):e()}loadContext(e){const t=this.context$.value;t&&t.uri===e||this.getContextByUri(e).pipe((0,Sn.P)()).subscribe(e=>{this.addContextToList(e),this.setContext(e)},t=>{e!==this.options.defaultContextUri&&this.loadContext(this.options.defaultContextUri)})}setContext(e){this.handleContextMessage(e);const t=this.context$.value;if(t&&e&&e.id===t.id)return void 0===e.map.view.keepCurrentView&&(e.map.view.keepCurrentView=!0),void this.context$.next(e);e.map||(e.map={view:{}}),Object.assign(e.map.view,this.mapViewFromRoute),this.context$.next(e)}loadEditedContext(e){this.getContextByUri(e).subscribe(e=>{this.setEditedContext(e)})}setEditedContext(e){this.editedContext$.next(e)}getContextFromMap(e,t){const o=e.ol.getView(),i=o.getProjection().getCode(),r=new _n.Z(o.getCenter()).transform(i,"EPSG:4326"),s={uri:N(),title:"",scope:"private",map:{view:{center:r.getCoordinates(),zoom:o.getZoom(),projection:i,maxZoomOnExtent:e.viewController.maxZoomOnExtent}},layers:[],tools:[]};let n=[];n=!0===t?e.layers$.getValue().filter(e=>!0===e.baseLayer||"searchPointerSummaryId"===e.options.id).sort((e,t)=>e.zIndex-t.zIndex):e.layers$.getValue().sort((e,t)=>e.zIndex-t.zIndex);let a=0;for(const l of n){const e=l,t={id:e.options.id?String(e.options.id):void 0,layerOptions:{title:e.options.title,zIndex:++a,visible:e.visible},sourceOptions:{type:e.dataSource.options.type,params:e.dataSource.options.params,url:e.dataSource.options.url,queryable:e.queryable}};t.sourceOptions.type&&s.layers.push(t)}return s.tools=this.tools.map(e=>({id:String(e.id),global:e.global})),s}getContextFromLayers(e,t,o){const i=this.context$.getValue(),r=e.ol.getView(),s=r.getProjection().getCode(),n={uri:o,title:o,map:{view:{center:new _n.Z(r.getCenter()).transform(s,"EPSG:4326").getCoordinates(),zoom:r.getZoom(),projection:s}},layers:[],toolbar:[],tools:[],extraFeatures:[]},a=e.layers$.getValue();return n.layers=a.filter(e=>e.baseLayer).map(e=>({baseLayer:!0,sourceOptions:e.options.sourceOptions,title:e.options.title,visible:e.visible})),t.forEach(e=>{const t=i.layers.find(t=>e.id===t.source.id&&!t.baseLayer);if(t){let o=t.style;t.styleByAttribute?o=void 0:t.clusterBaseStyle&&(o=void 0,delete t.sourceOptions.source,delete t.sourceOptions.format),n.layers.push({baseLayer:t.baseLayer,title:e.options.title,zIndex:e.zIndex,styleByAttribute:t.styleByAttribute,clusterBaseStyle:t.clusterBaseStyle,style:o,clusterParam:t.clusterParam,visible:e.visible,opacity:e.opacity,sourceOptions:t.sourceOptions})}else if(e.ol.getSource()instanceof Aa.Z){let t;const o=new Xn.Z;if(e.ol.getSource()instanceof Ta.Z){const i=e.ol.getSource();t=o.writeFeatures(i.getFeatures(),{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"})}t=JSON.parse(t),t.name=e.options.title,n.extraFeatures.push(t)}else{const t=e.options;t.zIndex=e.zIndex,delete t.source,n.layers.push(t)}}),n.toolbar=this.toolbar,n.tools=this.tools,n}setTools(e){this.tools=e}setToolbar(e){this.toolbar=e}handleContextMessage(e){this.contextMessage&&this.messageService.remove(this.contextMessage.id),this.context$.value&&e.uri&&this.context$.value.uri!==e.uri&&this.messageService.removeAllAreNotError(),e.messages=e.messages?e.messages:[],e.messages.push(e.message),e.messages.map(e=>{e&&(e.title=e.title?this.languageService.translate.instant(e.title):void 0,e.text=e.text?this.languageService.translate.instant(e.text):void 0,this.messageService.message(e))})}getContextByUri(e){if(this.baseUrl){let t;for(const o of Object.keys(this.contexts$.value))if(t=this.contexts$.value[o].find(t=>t.uri===e),t)break;return t&&t.imported?(0,A.of)(t):this.getDetails(t?t.id:e)}const t=this.contexts$.value.ours.find(t=>t.uri===e&&!0===t.imported);return t?(0,A.of)(t):this.getLocalContext(e)}getContextLayers(e){const t=[];return e.layers$.getValue().forEach(e=>{!e.baseLayer&&"searchPointerSummaryId"!==e.options.id&&t.push(e)}),t}readParamsFromRoute(){!this.route||this.route.queryParams.subscribe(e=>{const t=this.route.options.centerKey;t&&e[t]&&(this.mapViewFromRoute.center=e[t].split(",").map(Number),this.mapViewFromRoute.geolocate=!1);const o=this.route.options.projectionKey;o&&e[o]&&(this.mapViewFromRoute.projection=e[o]);const i=this.route.options.zoomKey;i&&e[i]&&(this.mapViewFromRoute.zoom=Number(e[i]))})}getPath(e){return`${this.options.basePath.replace(/\/$/,"")}/${e}`}handleError(e,t,o){const i=this.contexts$.value.ours.find(e=>e.uri===t),r=i?i.title:t;throw e.error.title=this.languageService.translate.instant("igo.context.contextManager.invalid.title"),e.error.message=this.languageService.translate.instant("igo.context.contextManager.invalid.text",{value:r}),e.error.toDisplay=!0,o&&(e.error.title=this.languageService.translate.instant("igo.context.contextManager.errors.addPermissionTitle"),e.error.message=this.languageService.translate.instant("igo.context.contextManager.errors.addPermission")),e}handleContextsChange(e=!0){const t=this.context$.value,o=this.editedContext$.value;(!t||t.uri===this.options.defaultContextUri)&&(e=!1),e&&this.findContext(t)?(this.getContextByUri(t.uri).pipe((0,Sn.P)()).subscribe(e=>{this.toolsChanged$.next(e)}),this.baseUrl&&this.authService.authenticated&&this.getDefault().subscribe()):(this.defaultContextUri=void 0,this.loadDefaultContext());const i=this.findContext(o);(!i||"write"!==i.permission)&&this.setEditedContext(void 0)}addContextToList(e){if(!this.findContext(e)){const t={id:e.id,uri:e.uri,title:e.title,scope:e.scope,permission:Dw[Dw.read]};this.contexts$.value&&this.contexts$.value.public&&(this.contexts$.value.public.push(t),this.contexts$.next(this.contexts$.value))}}findContext(e){if(!e)return!1;const t=this.contexts$.value;let o;for(const i of Object.keys(t))if(o=t[i].find(t=>e.id&&t.id===e.id||e.uri&&t.uri===e.uri),o)break;return o}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(Rs),r.LFG(ue),r.LFG(W),r.LFG(de),r.LFG(fe,8))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Rw=(()=>{class e{static forRoot(){return{ngModule:e}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[We.u5,We.UX,h.ez,n.ot,Ka.vV,Ha.t,cl.Nh,Ee.LD,Re.Ng,De.lN,Ve.c,m.p9,ne,zi,p.AV]]}),e})(),Uw=(()=>{class e{constructor(e,t,o){this.contextService=t,this.mediaService=o,this.component=e}get map(){return this.component.map}ngOnInit(){this.context$$=this.contextService.context$.pipe((0,$e.h)(e=>void 0!==e)).subscribe(e=>this.handleContextChange(e))}ngOnDestroy(){this.context$$.unsubscribe()}handleContextChange(e){if(void 0===e.map)return;const t=e.map.view;(!this.component.view||!0!==t.keepCurrentView)&&(this.component.view=t);const o=e.map.controls;if(!this.component.controls&&o){if(this.mediaService.isMobile()&&"boolean"!=typeof o.scaleLine){const e=o.scaleLine;e.minWidth||(e.minWidth=Math.min(64,e.minWidth),o.scaleLine=e)}this.component.controls=o}}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(lu),r.Y36(Ew),r.Y36(be))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoMapContext",""]]}),e})(),Nw=(()=>{class e{constructor(e,t,o,i,r,s,n){this.component=e,this.contextService=t,this.layerService=o,this.configService=i,this.styleListService=r,this.styleService=s,this.route=n,this.contextLayers=[],this.removeLayersOnContextChange=!0}get map(){return this.component.map}ngOnInit(){if(this.context$$=this.contextService.context$.pipe((0,$e.h)(e=>void 0!==e)).subscribe(e=>this.handleContextChange(e)),this.route&&this.route.options.visibleOnLayersKey&&this.route.options.visibleOffLayersKey&&this.route.options.contextKey){const e=this.route.queryParams.subscribe(t=>{Object.keys(t).length>0&&(this.queryParams=t,e.unsubscribe())})}}ngOnDestroy(){this.context$$.unsubscribe()}handleContextChange(e){if(void 0===e.layers)return;!0===this.removeLayersOnContextChange?this.map.removeAllLayers():this.map.removeLayers(this.contextLayers),this.contextLayers=[];const t=(0,Fe.T)(...e.layers.map((t,o)=>this.layerService.createAsyncLayer(t,e.uri)));t.pipe((0,qw.f)(t.pipe((0,w.b)(500)))).subscribe(t=>{t=t.filter(e=>void 0!==e).map(e=>(e.visible=this.computeLayerVisibilityFromUrl(e),e.zIndex=e.zIndex,e)),this.contextLayers.concat(t),this.map.addLayers(t),e.extraFeatures&&e.extraFeatures.forEach(e=>{const t=new Xn.Z,o=e.name;e=JSON.stringify(e),e=t.readFeatures(e,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"}),this.configService.getConfig("importWithStyle")?function(e,t,o,i,r){let s,n,a;if(i.getStyleList(o.toString()+".styleByAttribute")){const e=i.getStyleList(o.toString()+".styleByAttribute");s=t=>r.createStyleByAttribute(t,e)}else if(i.getStyleList(o.toString()+".clusterStyle")){const e=i.getStyleList(o.toString()+".clusterParam");n=i.getStyleList(o.toString()+".distance");const t=r.createStyle(i.getStyleList(o.toString()+".clusterStyle"));s=o=>r.createClusterStyle(o,e,t)}else s=i.getStyleList(o.toString()+".style")?r.createStyle(i.getStyleList(o.toString()+".style")):r.createStyle(i.getStyleList("default.style"));i.getStyleList(o.toString()+".clusterStyle")?(a=new ac({distance:n,type:"cluster",queryable:!0}),a.ol.source.addFeatures(e)):(a=new nc({type:"vector",queryable:!0}),a.ol.addFeatures(e));const l=new fc({title:o,source:a,style:s});t.addLayer(l)}(e,this.map,o,this.styleListService,this.styleService):function(e,t,o){const i=Math.floor(255*Math.random()),r=Math.floor(255*Math.random()),s=Math.floor(255*Math.random()),n=new jn.Z({color:[i,r,s,1],width:2}),a=new Jn.Z({color:[i,r,s,.4]}),l=new nc({type:"vector",queryable:!0});l.ol.addFeatures(e);const c=new fc({title:o,source:l,style:new Un.ZP({stroke:n,fill:a,image:new Qn.Z({radius:5,stroke:n,fill:a})})});t.addLayer(c)}(e,this.map,o)})})}computeLayerVisibilityFromUrl(e){const t=this.queryParams,o=e.id;let i=e.visible;if(!t||!o)return i;const r=t[this.route.options.contextKey];if(r===this.contextService.context$.value.uri||!r){let e="",r="",s=[],n=[];this.route.options.visibleOnLayersKey&&t[this.route.options.visibleOnLayersKey]&&(e=t[this.route.options.visibleOnLayersKey]),this.route.options.visibleOffLayersKey&&t[this.route.options.visibleOffLayersKey]&&(r=t[this.route.options.visibleOffLayersKey]),"*"===e&&(i=!0),"*"===r&&(i=!1),s=e.split(","),n=r.split(","),(s.indexOf(o)>-1||s.indexOf(o.toString())>-1)&&(i=!0),(n.indexOf(o)>-1||n.indexOf(o.toString())>-1)&&(i=!1)}return i}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(lu),r.Y36(Ew),r.Y36(Cu),r.Y36(W),r.Y36(Iy),r.Y36(eu),r.Y36(fe,8))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoLayerContext",""]],inputs:{removeLayersOnContextChange:"removeLayersOnContextChange"}}),e})();var Jw=(()=>{return(e=Jw||(Jw={})).always="always",e.never="never",e.default="default",Jw;var e})();let Bw=(()=>{class e{constructor(e){this.dialogRef=e}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ze.so))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-bookmark-dialog"]],decls:14,vars:14,consts:[["mat-dialog-title","",1,"mat-typography"],["mat-dialog-content","",1,"mat-typography"],["matInput","","required","","autocomplete","off","maxlength","128",3,"placeholder","ngModel","ngModelChange"],["mat-dialog-actions",""],["mat-button","","color","primary",3,"disabled","click"],["mat-button","",3,"click"]],template:function(e,t){1&e&&(r.TgZ(0,"h1",0),r._uU(1),r.ALo(2,"translate"),r.qZA(),r.TgZ(3,"div",1),r.TgZ(4,"mat-form-field"),r.TgZ(5,"input",2),r.NdJ("ngModelChange",function(e){return t.title=e}),r.ALo(6,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(7,"div",3),r.TgZ(8,"button",4),r.NdJ("click",function(){return t.dialogRef.close(t.title)}),r._uU(9),r.ALo(10,"translate"),r.qZA(),r.TgZ(11,"button",5),r.NdJ("click",function(){return t.dialogRef.close(!1)}),r._uU(12),r.ALo(13,"translate"),r.qZA(),r.qZA()),2&e&&(r.xp6(1),r.Oqu(r.lcZ(2,6,"igo.context.bookmarkButton.dialog.title")),r.xp6(4),r.Q6J("placeholder",r.lcZ(6,8,"igo.context.bookmarkButton.dialog.placeholder"))("ngModel",t.title),r.xp6(3),r.Q6J("disabled",!t.title),r.xp6(1),r.hij(" ",r.lcZ(10,10,"igo.common.confirmDialog.confirmBtn")," "),r.xp6(3),r.hij(" ",r.lcZ(13,12,"igo.common.confirmDialog.cancelBtn")," "))},directives:[ze.uh,ze.xY,De.KE,Ve.Nt,We.Fj,We.Q7,We.nD,We.JJ,We.On,ze.H8,n.lW],pipes:[j.X$],encapsulation:2}),e})();function jw(e,t){if(1&e&&r._UZ(0,"mat-icon",7),2&e){const e=r.oxw(2);r.s9C("svgIcon",e.context.icon?e.context.icon:"public"===e.context.scope?"earth":"star")}}function Qw(e,t){if(1&e&&r._UZ(0,"img",8),2&e){const e=r.oxw(2);r.Q6J("src",e.context.iconImage,r.LSH)}}function Gw(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",4),r.NdJ("click",function(){r.CHM(e);const t=r.oxw();return t.favoriteClick(t.context)}),r.ALo(1,"translate"),r.YNc(2,jw,1,1,"mat-icon",5),r.YNc(3,Qw,1,1,"img",6),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("matTooltip",e.auth.authenticated?r.lcZ(1,4,"igo.context.contextManager.favorite"):"")("color",e.default?"primary":"default"),r.xp6(2),r.Q6J("ngIf",!e.context.iconImage),r.xp6(1),r.Q6J("ngIf",e.context.iconImage)}}function Yw(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",20),r.NdJ("click",function(){r.CHM(e);const t=r.oxw(2);return t.save.emit(t.context)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",21),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("matTooltip",r.lcZ(1,2,"igo.context.contextManager.save"))("color",e.color)}}function zw(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",22),r.NdJ("click",function(){r.CHM(e);const t=r.oxw(2);return t.managePermissions.emit(t.context)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",23),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("matTooltip",r.lcZ(1,2,"igo.context.contextManager.managePermissions"))("color",e.color)}}function Hw(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",24),r.NdJ("click",function(){r.CHM(e);const t=r.oxw(2);return t.clone.emit(t.context)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",25),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("matTooltip",r.lcZ(1,2,"igo.context.contextManager.clone"))("color",e.color)}}function Vw(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",26),r.NdJ("click",function(){r.CHM(e);const t=r.oxw(2);return t.edit.emit(t.context)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",27),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("color",e.color)("matTooltip",r.lcZ(1,2,"igo.context.contextManager.edit"))}}function Ww(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",28),r.NdJ("click",function(){r.CHM(e);const t=r.oxw(2);return t.hide.emit(t.context)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",29),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("color",e.color)("matTooltip",r.lcZ(1,2,"igo.context.contextManager.hide"))}}function Xw(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",28),r.NdJ("click",function(){r.CHM(e);const t=r.oxw(2);return t.show.emit(t.context)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",30),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("color",e.color)("matTooltip",r.lcZ(1,2,"igo.context.contextManager.show"))}}function Kw(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",31),r.NdJ("click",function(){r.CHM(e);const t=r.oxw(2);return t.delete.emit(t.context)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",32),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.context.contextManager.delete"))}function eS(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",9),r.YNc(1,Yw,3,4,"button",10),r.TgZ(2,"div",11,12),r.YNc(4,zw,3,4,"button",13),r.YNc(5,Hw,3,4,"button",14),r.YNc(6,Vw,3,4,"button",15),r.YNc(7,Ww,3,4,"button",16),r.YNc(8,Xw,3,4,"button",16),r.YNc(9,Kw,3,3,"button",17),r.qZA(),r.TgZ(10,"button",18),r.NdJ("click",function(){r.CHM(e);const t=r.oxw();return t.collapsed=!t.collapsed}),r._UZ(11,"mat-icon",19),r.qZA(),r.qZA()}if(2&e){const e=r.MAs(3),t=r.oxw();r.xp6(1),r.Q6J("ngIf",t.collapsed&&t.selected&&(t.context.permission===t.typePermission[t.typePermission.write]||t.context.imported)),r.xp6(3),r.Q6J("ngIf",t.canShare&&!t.context.imported),r.xp6(1),r.Q6J("ngIf",!t.context.imported),r.xp6(1),r.Q6J("ngIf",t.context.permission===t.typePermission[t.typePermission.write]&&!t.context.imported),r.xp6(1),r.Q6J("ngIf",!t.context.hidden&&!t.context.imported),r.xp6(1),r.Q6J("ngIf",t.context.hidden&&!t.context.imported),r.xp6(1),r.Q6J("ngIf",t.context.permission===t.typePermission[t.typePermission.write]||t.context.imported),r.xp6(1),r.Q6J("color",t.color)("target",e)("collapsed",t.collapsed)}}const tS=function(e){return{"mat-list-item-light":e}};let oS=(()=>{class e{constructor(e,t){this.auth=e,this.storageService=t,this.typePermission=Dw,this.color="primary",this.collapsed=!0,this._default=!1,this.edit=new r.vpe,this.delete=new r.vpe,this.save=new r.vpe,this.clone=new r.vpe,this.hide=new r.vpe,this.show=new r.vpe,this.favorite=new r.vpe,this.managePermissions=new r.vpe,this.manageTools=new r.vpe}get context(){return this._context}set context(e){this._context=e}get default(){return this._default}set default(e){this._default=e}get hidden(){return this.context.hidden}get canShare(){return!0===this.storageService.get("canShare")}favoriteClick(e){this.auth.authenticated&&this.favorite.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Rs),r.Y36(Se))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-context-item"]],inputs:{context:"context",default:"default",selected:"selected"},outputs:{edit:"edit",delete:"delete",save:"save",clone:"clone",hide:"hide",show:"show",favorite:"favorite",managePermissions:"managePermissions",manageTools:"manageTools"},decls:5,vars:6,consts:[[1,"mat-list-item",3,"ngClass"],["mat-list-avatar","","mat-icon-button","","igoStopPropagation","","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],["matLine",""],["igoStopPropagation","","class","igo-actions-container",4,"ngIf"],["mat-list-avatar","","mat-icon-button","","igoStopPropagation","","matTooltipShowDelay","500",3,"matTooltip","color","click"],[3,"svgIcon",4,"ngIf"],[3,"src",4,"ngIf"],[3,"svgIcon"],[3,"src"],["igoStopPropagation","",1,"igo-actions-container"],["class","save-button","mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],[1,"igo-actions-expand-container"],["actions",""],["mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],["class","clone-button","mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],["class","edit-button","mat-icon-button","","matTooltipShowDelay","500",3,"color","matTooltip","click",4,"ngIf"],["class","hide-button","mat-icon-button","","matTooltipShowDelay","500",3,"color","matTooltip","click",4,"ngIf"],["class","delete-button","mat-icon-button","","color","warn","matTooltipShowDelay","500",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","igoCollapse","",1,"actions-button",3,"color","target","collapsed","click"],["svgIcon","dots-horizontal"],["mat-icon-button","","matTooltipShowDelay","500",1,"save-button",3,"matTooltip","color","click"],["svgIcon","content-save"],["mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","color","click"],["svgIcon","account-arrow-right"],["mat-icon-button","","matTooltipShowDelay","500",1,"clone-button",3,"matTooltip","color","click"],["svgIcon","content-copy"],["mat-icon-button","","matTooltipShowDelay","500",1,"edit-button",3,"color","matTooltip","click"],["svgIcon","pencil"],["mat-icon-button","","matTooltipShowDelay","500",1,"hide-button",3,"color","matTooltip","click"],["svgIcon","eye"],["svgIcon","eye-off"],["mat-icon-button","","color","warn","matTooltipShowDelay","500",1,"delete-button",3,"matTooltip","click"],["svgIcon","delete"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-list-item",0),r.YNc(1,Gw,4,6,"button",1),r.TgZ(2,"h4",2),r._uU(3),r.qZA(),r.YNc(4,eS,12,10,"div",3),r.qZA()),2&e&&(r.Q6J("ngClass",r.VKq(4,tS,t.hidden)),r.xp6(1),r.Q6J("ngIf",t.auth.authenticated),r.xp6(2),r.Oqu(t.context.title),r.xp6(1),r.Q6J("ngIf",t.auth.authenticated))},directives:[l.Tg,h.mk,h.O5,Re.X2,n.lW,l.eA,wt,p.gM,a.Hw,Do],pipes:[j.X$],styles:["[_nghost-%COMP%]{overflow:hidden}.igo-actions-container[_ngcontent-%COMP%]{flex-shrink:0}.igo-actions-expand-container[_ngcontent-%COMP%]{display:inline-flex}mat-list-item[_ngcontent-%COMP%]     .mat-list-item-content .mat-list-text{padding:0}mat-icon.disabled[_ngcontent-%COMP%]{color:#00000061}mat-list-item.mat-list-item-light[_ngcontent-%COMP%]     .mat-list-item-content{color:#969696}"],changeDetection:0}),e})();function iS(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",14),r.NdJ("click",function(){return r.CHM(e),r.oxw(2).clearFilter()}),r._UZ(1,"mat-icon",15),r.qZA()}}function rS(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-form-field",11),r.TgZ(1,"input",12),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw().term=t}),r.ALo(2,"translate"),r.qZA(),r.YNc(3,iS,2,0,"button",13),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("ngClass",e.auth.authenticated&&e.configService.getConfig("context")?"context-filter-min-width":"context-filter-max-width"),r.xp6(1),r.Q6J("placeholder",r.lcZ(2,4,"igo.context.contextManager.filterPlaceHolder"))("ngModel",e.term),r.xp6(2),r.Q6J("ngIf",e.term.length)}}function sS(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",16),r.NdJ("click",function(){return r.CHM(e),r.oxw().toggleSort(!0)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",17),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.context.contextManager.sortAlphabetically"))}function nS(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",16),r.NdJ("click",function(){return r.CHM(e),r.oxw().toggleSort(!1)}),r.ALo(1,"translate"),r._UZ(2,"mat-icon",18),r.qZA()}2&e&&r.Q6J("matTooltip",r.lcZ(1,1,"igo.context.contextManager.sortContextOrder"))}function aS(e,t){if(1&e&&r._UZ(0,"igo-actionbar",19),2&e){const e=r.oxw();r.Q6J("iconColor",e.color)("store",e.actionStore)("withIcon",!0)("withTitle","overlay"===e.actionbarMode)("horizontal",!1)("mode",e.actionbarMode)}}function lS(e,t){if(1&e&&(r.TgZ(0,"button",20),r.ALo(1,"translate"),r._UZ(2,"mat-icon",21),r.qZA()),2&e){r.oxw();const e=r.MAs(7);r.Q6J("matTooltip",r.lcZ(1,2,"igo.context.contextManager.filterUser"))("matMenuTriggerFor",e)}}function cS(e,t){if(1&e&&(r.TgZ(0,"button",27),r._uU(1),r.qZA()),2&e){const e=r.oxw().$implicit,t=r.MAs(6);r.Q6J("matMenuTriggerFor",t),r.xp6(1),r.hij(" ",e.title," ")}}function uS(e,t){if(1&e&&(r.TgZ(0,"button",9),r._uU(1),r.qZA()),2&e){const e=r.oxw().$implicit;r.xp6(1),r.hij(" ",e.title," ")}}function pS(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"mat-checkbox",8),r.NdJ("click",function(e){return e.stopPropagation()})("change",function(){const t=r.CHM(e).$implicit,o=r.oxw().$implicit;return r.oxw().userSelection(t,o)}),r._uU(1),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(2);r.Q6J("checked",o.getPermission(e).checked),r.xp6(1),r.hij(" ",e.title," ")}}function dS(e,t){if(1&e){const e=r.EpF();r.ynx(0),r.TgZ(1,"span",7),r.TgZ(2,"mat-checkbox",22),r.NdJ("click",function(e){return e.stopPropagation()})("change",function(){const t=r.CHM(e).$implicit;return r.oxw().userSelection(t)}),r.qZA(),r.YNc(3,cS,2,2,"button",23),r.YNc(4,uS,2,1,"button",24),r.qZA(),r.TgZ(5,"mat-menu",null,25),r.YNc(7,pS,2,2,"mat-checkbox",26),r.qZA(),r.BQk()}if(2&e){const e=t.$implicit,o=r.oxw();r.xp6(2),r.Q6J("checked",o.getPermission(e).checked)("indeterminate",o.getPermission(e).indeterminate),r.xp6(1),r.Q6J("ngIf",e.childs),r.xp6(1),r.Q6J("ngIf",!e.childs),r.xp6(3),r.Q6J("ngForOf",e.childs)}}function hS(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-context-item",31),r.NdJ("edit",function(){const t=r.CHM(e).$implicit;return r.oxw(3).edit.emit(t)})("delete",function(){const t=r.CHM(e).$implicit;return r.oxw(3).delete.emit(t)})("clone",function(){const t=r.CHM(e).$implicit;return r.oxw(3).clone.emit(t)})("save",function(){const t=r.CHM(e).$implicit;return r.oxw(3).save.emit(t)})("hide",function(){const t=r.CHM(e).$implicit;return r.oxw(3).hideContext(t)})("show",function(){const t=r.CHM(e).$implicit;return r.oxw(3).showContext(t)})("favorite",function(){const t=r.CHM(e).$implicit;return r.oxw(3).favorite.emit(t)})("manageTools",function(){const t=r.CHM(e).$implicit;return r.oxw(3).manageTools.emit(t)})("managePermissions",function(){const t=r.CHM(e).$implicit;return r.oxw(3).managePermissions.emit(t)})("select",function(){const t=r.CHM(e).$implicit;return r.oxw(3).select.emit(t)})("unselect",function(){const t=r.CHM(e).$implicit;return r.oxw(3).unselect.emit(t)}),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(3);r.Q6J("selected",o.selectedContext&&o.selectedContext.uri===e.uri)("context",e)("default",e.id&&o.defaultContextId&&o.defaultContextId===e.id)}}function gS(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-collapsible",30),r.NdJ("toggle",function(t){r.CHM(e);const o=r.oxw().$implicit,i=r.oxw();return i.collapsed[i.titleMapping[o.key]]=t}),r.ALo(1,"translate"),r.YNc(2,hS,1,3,"ng-template",10),r.qZA()}if(2&e){const e=r.oxw().$implicit,t=r.oxw();r.Q6J("title",r.lcZ(1,3,t.titleMapping[e.key]))("collapsed",t.collapsed[t.titleMapping[e.key]]),r.xp6(2),r.Q6J("ngForOf",e.value)}}function mS(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-context-item",32),r.NdJ("select",function(){const t=r.CHM(e).$implicit;return r.oxw(3).select.emit(t)})("unselect",function(){const t=r.CHM(e).$implicit;return r.oxw(3).unselect.emit(t)}),r.qZA()}if(2&e){const e=t.$implicit,o=r.oxw(3);r.Q6J("selected",o.selectedContext&&o.selectedContext.uri===e.uri)("context",e)("default",o.defaultContextId===e.id)}}function fS(e,t){if(1&e&&r.YNc(0,mS,1,3,"ng-template",10),2&e){const e=r.oxw().$implicit;r.Q6J("ngForOf",e.value)}}function yS(e,t){if(1&e&&(r.YNc(0,gS,3,5,"igo-collapsible",28),r.YNc(1,fS,1,1,void 0,29)),2&e){const e=t.$implicit,o=r.oxw();r.Q6J("ngIf",e.value.length&&o.auth.authenticated),r.xp6(1),r.Q6J("ngIf",e.value.length&&!o.auth.authenticated)}}let vS=(()=>{class e{constructor(e,t,o,i,s,n,a){this.cdRef=e,this.contextService=t,this.configService=o,this.auth=i,this.dialog=s,this.languageService=n,this.storageService=a,this.contextsInitial={ours:[]},this.contexts$=new C.X(this.contextsInitial),this.change$=new Ae.t(1),this._contexts={ours:[]},this.collapsed=[],this.select=new r.vpe,this.unselect=new r.vpe,this.edit=new r.vpe,this.delete=new r.vpe,this.save=new r.vpe,this.clone=new r.vpe,this.create=new r.vpe,this.hide=new r.vpe,this.show=new r.vpe,this.showHiddenContexts=new r.vpe,this.favorite=new r.vpe,this.managePermissions=new r.vpe,this.manageTools=new r.vpe,this.filterPermissionsChanged=new r.vpe,this.titleMapping={ours:"igo.context.contextManager.ourContexts",shared:"igo.context.contextManager.sharedContexts",public:"igo.context.contextManager.publicContexts"},this.permissions=[],this.actionStore=new vr([]),this.actionbarMode=po.Overlay,this.color="primary",this.showHidden=!1,this._term="",this._sortedAlpha=void 0,this.showContextFilter=Jw.always,this.thresholdToFilter=5}get contexts(){return this._contexts}set contexts(e){this._contexts=e,this.cdRef.detectChanges(),this.next()}get selectedContext(){return this._selectedContext}set selectedContext(e){this._selectedContext=e,this.cdRef.detectChanges()}get map(){return this._map}set map(e){this._map=e}get defaultContextId(){return this._defaultContextId}set defaultContextId(e){this._defaultContextId=e}set term(e){this._term=e,this.next()}get term(){return this._term}get sortedAlpha(){return this._sortedAlpha}set sortedAlpha(e){this._sortedAlpha=e,this.next()}ngOnInit(){this.change$$=this.change$.pipe((0,An.D)(()=>0===this.contexts.ours.length?xn.E:(0,wn.H)(50))).subscribe(()=>{this.contexts$.next(this.filterContextsList(this.contexts))}),this.actionStore.load([{id:"emptyContext",title:this.languageService.translate.instant("igo.context.contextManager.emptyContext"),icon:"map-outline",tooltip:this.languageService.translate.instant("igo.context.contextManager.emptyContextTooltip"),handler:()=>{this.createContext(!0)}},{id:"contextFromMap",title:this.languageService.translate.instant("igo.context.contextManager.contextMap"),icon:"map-check",tooltip:this.languageService.translate.instant("igo.context.contextManager.contextMapTooltip"),handler:()=>{this.createContext(!1)}}])}next(){this.change$.next()}filterContextsList(e){if(""===this.term)return this.sortedAlpha&&(e=this.sortContextsList(e)),e;{let t={ours:e.ours.filter(e=>{const t=this.term.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return e.title.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t)})};if(this.contexts.public){const o=e.public.filter(e=>{const t=this.term.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return e.title.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t)});t.public=o}if(this.contexts.shared){const o=e.shared.filter(e=>{const t=this.term.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return e.title.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t)});t.shared=o}return this.sortedAlpha&&(t=this.sortContextsList(t)),t}}ngOnDestroy(){this.change$$.unsubscribe()}showFilter(){switch(this.showContextFilter){case Jw.always:return!0;case Jw.never:return!1;default:let e=this.contexts.ours.length;return e+=this.contexts.public?this.contexts.public.length:0,e+=this.contexts.shared?this.contexts.shared.length:0,e>=this.thresholdToFilter}}sortContextsList(e){if(e){const t=JSON.parse(JSON.stringify(e));return t.ours.sort((e,t)=>this.normalize(e.title)<this.normalize(t.title)?-1:this.normalize(e.title)>this.normalize(t.title)?1:0),t.shared?t.shared.sort((e,t)=>this.normalize(e.title)<this.normalize(t.title)?-1:this.normalize(e.title)>this.normalize(t.title)?1:0):t.public&&t.public.sort((e,t)=>this.normalize(e.title)<this.normalize(t.title)?-1:this.normalize(e.title)>this.normalize(t.title)?1:0),t}}normalize(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}toggleSort(e){this.sortedAlpha=e}clearFilter(){this.term=""}createContext(e){this.dialog.open(Bw,{disableClose:!1}).afterClosed().pipe((0,qe.q)(1)).subscribe(t=>{t&&this.create.emit({title:t,empty:e})})}getPermission(e){if(e)return this.permissions.find(t=>t.name===e.name)}userSelection(e,t){const o=this.getPermission(e);if(o&&(o.checked=!o.checked,this.storageService.set("contexts.permissions."+o.name,o.checked),o.indeterminate=!1),t){let e=!1;for(const r of t.childs)if(this.getPermission(r).checked!==o.checked){e=!0;break}const i=this.getPermission(t);i&&(i.checked=o.checked,this.storageService.set("contexts.permissions."+i.name,o.checked),i.indeterminate=e)}if(e.childs)for(const i of e.childs){const e=this.getPermission(i);e&&e.checked!==o.checked&&(e.checked=o.checked,this.storageService.set("contexts.permissions."+e.name,o.checked))}this.filterPermissionsChanged.emit(this.permissions)}hideContext(e){if(e.hidden=!0,!this.showHidden){const t={ours:[],shared:[],public:[]};t.ours=this.contexts.ours.filter(t=>t.id!==e.id),t.shared=this.contexts.shared.filter(t=>t.id!==e.id),t.public=this.contexts.public.filter(t=>t.id!==e.id),this.contexts=t}this.hide.emit(e)}showContext(e){e.hidden=!1,this.show.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.sBO),r.Y36(Ew),r.Y36(W),r.Y36(Rs),r.Y36(ze.uw),r.Y36(ue),r.Y36(Se))},e.\u0275cmp=r.Xpm({type:e,selectors:[["igo-context-list"]],inputs:{contexts:"contexts",selectedContext:"selectedContext",map:"map",defaultContextId:"defaultContextId",term:"term"},outputs:{select:"select",unselect:"unselect",edit:"edit",delete:"delete",save:"save",clone:"clone",create:"create",hide:"hide",show:"show",showHiddenContexts:"showHiddenContexts",favorite:"favorite",managePermissions:"managePermissions",manageTools:"manageTools",filterPermissionsChanged:"filterPermissionsChanged"},decls:17,vars:16,consts:[[3,"navigation"],[3,"ngClass",4,"ngIf"],["class","sort-alpha","mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","click",4,"ngIf"],["class","add-context-button","icon","plus",3,"iconColor","store","withIcon","withTitle","horizontal","mode",4,"ngIf"],["class","users-filter","mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","matMenuTriggerFor",4,"ngIf"],["accountMenu","matMenu"],[4,"ngFor","ngForOf"],[1,"profilsMenu"],[1,"mat-menu-item",3,"checked","click","change"],["mat-menu-item",""],["ngFor","",3,"ngForOf"],[3,"ngClass"],["matInput","","type","text",3,"placeholder","ngModel","ngModelChange"],["mat-button","","mat-icon-button","","matSuffix","","class","clear-button","aria-label","Clear","color","warn",3,"click",4,"ngIf"],["mat-button","","mat-icon-button","","matSuffix","","aria-label","Clear","color","warn",1,"clear-button",3,"click"],["svgIcon","close"],["mat-icon-button","","matTooltipShowDelay","500",1,"sort-alpha",3,"matTooltip","click"],["color","primary","svgIcon","sort-alphabetical-variant"],["color","warn","svgIcon","sort-variant-remove"],["icon","plus",1,"add-context-button",3,"iconColor","store","withIcon","withTitle","horizontal","mode"],["mat-icon-button","","matTooltipShowDelay","500",1,"users-filter",3,"matTooltip","matMenuTriggerFor"],["color","primary","svgIcon","filter-menu"],[1,"mat-menu-item",3,"checked","indeterminate","click","change"],["mat-menu-item","",3,"matMenuTriggerFor",4,"ngIf"],["mat-menu-item","",4,"ngIf"],["subAccountMenu","matMenu"],["class","mat-menu-item",3,"checked","click","change",4,"ngFor","ngForOf"],["mat-menu-item","",3,"matMenuTriggerFor"],[3,"title","collapsed","toggle",4,"ngIf"],[4,"ngIf"],[3,"title","collapsed","toggle"],["igoListItem","","color","accent",3,"selected","context","default","edit","delete","clone","save","hide","show","favorite","manageTools","managePermissions","select","unselect"],["igoListItem","","color","accent",3,"selected","context","default","select","unselect"]],template:function(e,t){1&e&&(r.TgZ(0,"igo-list",0),r.YNc(1,rS,4,6,"mat-form-field",1),r.YNc(2,sS,3,3,"button",2),r.YNc(3,nS,3,3,"button",2),r.YNc(4,aS,1,6,"igo-actionbar",3),r.YNc(5,lS,3,4,"button",4),r.TgZ(6,"mat-menu",null,5),r.YNc(8,dS,8,5,"ng-container",6),r.TgZ(9,"span",7),r.TgZ(10,"mat-checkbox",8),r.NdJ("click",function(e){return e.stopPropagation()})("change",function(){return t.showHiddenContexts.emit()}),r.qZA(),r.TgZ(11,"button",9),r._uU(12),r.ALo(13,"translate"),r.qZA(),r.qZA(),r.qZA(),r.YNc(14,yS,2,2,"ng-template",10),r.ALo(15,"keyvalue"),r.ALo(16,"async"),r.qZA()),2&e&&(r.Q6J("navigation",!0),r.xp6(1),r.Q6J("ngIf",t.showFilter()),r.xp6(1),r.Q6J("ngIf",!t.sortedAlpha),r.xp6(1),r.Q6J("ngIf",t.sortedAlpha),r.xp6(1),r.Q6J("ngIf",t.auth.authenticated&&t.configService.getConfig("context")),r.xp6(1),r.Q6J("ngIf",t.auth.authenticated&&t.configService.getConfig("context")),r.xp6(3),r.Q6J("ngForOf",t.users),r.xp6(2),r.Q6J("checked",t.showHidden),r.xp6(2),r.hij(" ",r.lcZ(13,10,"igo.context.contextManager.showHidden")," "),r.xp6(2),r.Q6J("ngForOf",r.lcZ(15,12,r.lcZ(16,14,t.contexts$))))},directives:[Ei,h.O5,f.VK,h.sg,m.oG,f.OP,De.KE,h.mk,Ve.Nt,We.Fj,We.JJ,We.On,n.lW,De.R9,a.Hw,p.gM,Mo,f.p6,Ro,oS,$i],pipes:[j.X$,Pi,h.Ov],styles:[".context-filter-max-width[_ngcontent-%COMP%]{width:calc(100% - 100px);margin:5px;padding-left:6px}.context-filter-min-width[_ngcontent-%COMP%]{width:calc(100% - 135px);margin:5px;padding-left:6px}.clear-button[_ngcontent-%COMP%]{padding-right:5px}mat-form-field[_ngcontent-%COMP%]{height:40px}.profilsMenu[_ngcontent-%COMP%]{display:flex}.profilsMenu[_ngcontent-%COMP%] > mat-checkbox[_ngcontent-%COMP%]{width:8px}.add-context-button[_ngcontent-%COMP%]{margin:0;width:40px;display:inline-flex}"],changeDetection:0}),e})(),bS=(()=>{class e{constructor(e,t,o,i,r,s,n,a){this.contextService=t,this.mapService=o,this.languageService=i,this.confirmDialogService=r,this.messageService=s,this.auth=n,this.storageService=a,this.component=e}onSelect(e){this.contextService.loadContext(e.uri)}onEdit(e){this.contextService.loadEditedContext(e.uri)}onSave(e){const t=this.mapService.getMap(),o=this.contextService.getContextFromMap(t),i=()=>{const t=this.languageService.translate,o=t.instant("igo.context.contextManager.dialog.saveMsg",{value:e.title}),i=t.instant("igo.context.contextManager.dialog.saveTitle");this.messageService.success(o,i)};if(e.imported)return o.title=e.title,this.contextService.delete(e.id,!0),void this.contextService.create(o).subscribe(e=>{this.contextService.loadContext(e.uri),i()});this.contextService.update(e.id,{layers:o.layers,map:{view:o.map.view}}).subscribe(()=>{i()})}onFavorite(e){this.contextService.setDefault(e.id).subscribe(()=>{this.contextService.defaultContextId$.next(e.id);const t=this.languageService.translate,o=t.instant("igo.context.contextManager.dialog.favoriteMsg",{value:e.title}),i=t.instant("igo.context.contextManager.dialog.favoriteTitle");this.messageService.success(o,i)})}onManageTools(e){this.contextService.loadEditedContext(e.uri)}onManagePermissions(e){this.contextService.loadEditedContext(e.uri)}onDelete(e){const t=this.languageService.translate;this.confirmDialogService.open(t.instant("igo.context.contextManager.dialog.confirmDelete")).subscribe(o=>{o&&this.contextService.delete(e.id,e.imported).subscribe(()=>{const o=t.instant("igo.context.contextManager.dialog.deleteMsg",{value:e.title}),i=t.instant("igo.context.contextManager.dialog.deleteTitle");this.messageService.info(o,i)})})}onClone(e){this.contextService.clone(e.id,{title:e.title+"-copy",uri:e.uri+"-copy"}).subscribe(()=>{const t=this.languageService.translate,o=t.instant("igo.context.contextManager.dialog.cloneMsg",{value:e.title}),i=t.instant("igo.context.contextManager.dialog.cloneTitle");this.messageService.success(o,i)})}onCreate(e){const{title:t,empty:o}=e,i=this.contextService.getContextFromMap(this.component.map,o);i.title=t,this.contextService.create(i).subscribe(()=>{const e=this.languageService.translate,t=e.instant("igo.context.bookmarkButton.dialog.createTitle"),o=e.instant("igo.context.bookmarkButton.dialog.createMsg",{value:i.title});this.messageService.success(o,t),this.contextService.loadContext(i.uri)})}loadContexts(){const e=["none"];for(const t of this.component.permissions)(!0===t.checked||!0===t.indeterminate)&&e.push(t.name);this.contextService.loadContexts(e,!!this.component.showHidden)}showHiddenContexts(){this.component.showHidden=!this.component.showHidden,this.storageService.set("contexts.showHidden",this.component.showHidden),this.loadContexts()}onShowContext(e){this.contextService.showContext(e.id).subscribe()}onHideContext(e){this.contextService.hideContext(e.id).subscribe()}ngOnInit(){this.component.contexts={ours:[]},this.component.showHidden=this.storageService.get("contexts.showHidden"),this.contexts$$=this.contextService.contexts$.subscribe(e=>this.handleContextsChange(e)),this.defaultContextId$$=this.contextService.defaultContextId$.subscribe(e=>{this.component.defaultContextId=e}),this.selectedContext$$=this.contextService.context$.pipe((0,w.b)(100)).subscribe(e=>this.component.selectedContext=e),this.auth.authenticate$.subscribe(e=>{e&&this.contextService.getProfilByUser().subscribe(e=>{this.component.users=e,this.component.permissions=[];const t=this.component.users.reduce((e,t)=>(e=e.concat(t),t.childs?e.concat(t.childs):e),[]);for(const i of t){const e={name:i.name,checked:this.storageService.get("contexts.permissions."+i.name)};null===e.checked&&(e.checked=!0),this.component.permissions.push(e)}const o=["none"];for(const i of this.component.permissions)(!0===i.checked||!0===i.indeterminate)&&o.push(i.name);this.contextService.loadContexts(o,!!this.component.showHidden)})})}ngOnDestroy(){this.contexts$$.unsubscribe(),this.selectedContext$$.unsubscribe(),this.defaultContextId$$.unsubscribe()}handleContextsChange(e){this.component.contexts=e}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(vS,2),r.Y36(Ew),r.Y36(Pc),r.Y36(ue),r.Y36(Jo),r.Y36(de),r.Y36(Rs),r.Y36(Se))},e.\u0275dir=r.lG2({type:e,selectors:[["","igoContextListBinding",""]],hostBindings:function(e,t){1&e&&r.NdJ("select",function(e){return t.onSelect(e)})("edit",function(e){return t.onEdit(e)})("save",function(e){return t.onSave(e)})("favorite",function(e){return t.onFavorite(e)})("manageTools",function(e){return t.onManageTools(e)})("managePermissions",function(e){return t.onManagePermissions(e)})("delete",function(e){return t.onDelete(e)})("clone",function(e){return t.onClone(e)})("create",function(e){return t.onCreate(e)})("filterPermissionsChanged",function(){return t.loadContexts()})("showHiddenContexts",function(){return t.showHiddenContexts()})("show",function(e){return t.onShowContext(e)})("hide",function(e){return t.onHideContext(e)})}}),e})(),xS=(()=>{class e{constructor(e,t){this.http=e,this.config=t,this.baseUrl=this.config.getConfig("context.url")}get(){return this.baseUrl?this.http.get(this.baseUrl+"/pois"):xn.E}delete(e){return this.http.delete(this.baseUrl+"/pois/"+e)}create(e){return this.http.post(this.baseUrl+"/pois",e)}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(y.eN),r.LFG(W))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})(),wS=(()=>{class e{static forRoot(){return{ngModule:e}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[xS],imports:[[h.ez,ne,Bo,wi,mn,We.u5,a.Ps,n.ot,Ee.LD,Re.Ng,p.AV,De.lN,ze.Is,Ve.c]]}),e})(),SS=(()=>{class e{static forRoot(){return{ngModule:e}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,We.u5,We.UX,De.lN,Ve.c,a.Ps,n.ot,p.AV,l.ie,m.p9,ll.Fk,ze.Is,f.Tx,Re.Ng,Xa.Bb,mn,Ri,_i,Uo,wi,ne,Rw,wS,Io]]}),e})();var CS=(()=>{return(e=CS||(CS={})).layer="layer",e.context="context",CS;var e})(),TS=(()=>{return(e=TS||(TS={})).import="import",e.export="export",TS;var e})();let AS=(()=>{class e{constructor(){this.importExportType$=new C.X(CS.layer),this.selectedMode$=new C.X(TS.import),this.exportOptions$=new C.X(void 0)}setImportExportType(e){this.importExportType$.next(e)}setMode(e){this.selectedMode$.next(e)}setsExportOptions(e){this.exportOptions$.next(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),LS=(()=>{class e{constructor(e,t){this.toolService=e,this.importExportState=t,this.openSidenav$=new C.X(void 0)}get toolbox(){return this.toolService.toolbox}toolToActivateFromOptions(e){if(e){if("importExport"===e.tool){let t=this.importExportState.exportOptions$.value;t?(t.layers=e.options.layers,t.featureInMapExtent=e.options.featureInMapExtent):t={layers:e.options.layers,featureInMapExtent:e.options.featureInMapExtent},this.importExportState.setsExportOptions(t),this.importExportState.setMode(TS.export)}this.toolbox.getTool(e.tool)&&(this.toolbox.activateTool(e.tool),this.openSidenav$.next(!0))}}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(Oi),r.LFG(AS))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function ZS(e,t){e.entityStore.getStrategyOfType(Vc).setMotion(t.get("zoomAuto")?Fl.Default:Fl.None)}let FS=(()=>{class e{constructor(e){this.igoStorageService=e}get storageService(){return this.igoStorageService}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(Se))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),OS=(()=>{class e{constructor(e,t,o,i){this.storageState=e,this.languageService=t,this.toolState=o,this.mediaService=i,this.maximize$=new C.X(this.storageService.get("workspaceMaximize")),this.zoomAuto$=new C.X(!1)}get storageService(){return this.storageState.storageService}get zoomAuto(){return this.storageService.get("zoomAuto")}ngOnDestroy(){this.storageChange$$&&this.storageChange$$.unsubscribe()}loadActions(e,t,o){const i=this.buildActions(e,t,o);e.actionStore.load(i)}buildActions(e,t,o){return this.zoomAuto$.next(this.zoomAuto),this.storageChange$$=this.storageService.storageChange$.pipe((0,Tn.n)(e=>"zoomAuto"!==e.key||e.event===we.CLEARED)).subscribe(()=>{this.zoomAuto$.next(this.zoomAuto),ZS(e,this.storageService)}),[{id:"zoomAuto",checkbox:!0,title:"igo.integration.workspace.zoomAuto.title",tooltip:"igo.integration.workspace.zoomAuto.tooltip",checkCondition:this.zoomAuto$,handler:()=>{ZS(e,this.storageService),this.storageService.set("zoomAuto",!this.storageService.get("zoomAuto"))}},{id:"filterInMapExtent",checkbox:!0,title:"igo.integration.workspace.inMapExtent.title",tooltip:lw(e),checkCondition:t,handler:()=>t.next(!t.value)},{id:"selectedOnly",checkbox:!0,title:"igo.integration.workspace.selected.title",tooltip:"igo.integration.workspace.selected.tooltip",checkCondition:o,handler:()=>o.next(!o.value)},{id:"clearselection",icon:"select-off",title:"igo.integration.workspace.clearSelection.title",tooltip:"igo.integration.workspace.clearSelection.tooltip",handler:e=>{e.entityStore.state.updateMany(e.entityStore.view.all(),{selected:!1})},args:[e],availability:e=>cw(e)},{id:"featureDownload",icon:"file-export",title:"igo.integration.workspace.download.title",tooltip:"igo.integration.workspace.download.tooltip",handler:e=>{const t=e.entityStore.getStrategyOfType(mt),o=e.entityStore.getStrategyOfType(ft).active?[e.layer.id]:[];this.toolState.toolToActivateFromOptions({tool:"importExport",options:{layers:[e.layer.id],featureInMapExtent:t.active,layersWithSelection:o}})},args:[e]},{id:"maximize",title:this.languageService.translate.instant("igo.integration.workspace.maximize"),tooltip:this.languageService.translate.instant("igo.integration.workspace.maximizeTooltip"),icon:"resize",display:()=>this.maximize$.pipe((0,x.U)(e=>!e&&!this.mediaService.isMobile())),handler:()=>{this.mediaService.isMobile()||this.maximize$.next(!0)}},{id:"standardExtent",title:this.languageService.translate.instant("igo.integration.workspace.standardExtent"),tooltip:this.languageService.translate.instant("igo.integration.workspace.standardExtentTooltip"),icon:"resize",display:()=>this.maximize$.pipe((0,x.U)(e=>e&&!this.mediaService.isMobile())),handler:()=>{this.maximize$.next(!1)}}]}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(FS),r.LFG(ue),r.LFG(LS),r.LFG(be))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),MS=(()=>{class e{constructor(e,t,o,i,r){this.ogcFilterWidget=e,this.storageState=t,this.languageService=o,this.mediaService=i,this.toolState=r,this.maximize$=new C.X(this.storageService.get("workspaceMaximize")),this.selectOnlyCheckCondition$=new C.X(!1),this.zoomAuto$=new C.X(!1)}get storageService(){return this.storageState.storageService}get zoomAuto(){return this.storageService.get("zoomAuto")}ngOnDestroy(){this.storageChange$$&&this.storageChange$$.unsubscribe()}loadActions(e,t,o){const i=this.buildActions(e,t,o);e.actionStore.load(i)}buildActions(e,t,o){var i,r;this.zoomAuto$.next(this.zoomAuto),this.storageChange$$=this.storageService.storageChange$.pipe((0,Tn.n)(e=>"zoomAuto"!==e.key||e.event===we.CLEARED)).subscribe(()=>{this.zoomAuto$.next(this.zoomAuto),ZS(e,this.storageService)});const s=[{id:"zoomAuto",checkbox:!0,title:"igo.integration.workspace.zoomAuto.title",tooltip:"igo.integration.workspace.zoomAuto.tooltip",checkCondition:this.zoomAuto$,handler:()=>{ZS(e,this.storageService),this.storageService.set("zoomAuto",!this.storageService.get("zoomAuto"))}},{id:"filterInMapExtent",checkbox:!0,title:"igo.integration.workspace.inMapExtent.title",tooltip:lw(e),checkCondition:t,handler:()=>t.next(!t.value)},{id:"selectedOnly",checkbox:!0,title:"igo.integration.workspace.selected.title",tooltip:"igo.integration.workspace.selected.title",checkCondition:o,handler:()=>o.next(!o.value)},{id:"clearselection",icon:"select-off",title:"igo.integration.workspace.clearSelection.title",tooltip:"igo.integration.workspace.clearSelection.tooltip",handler:e=>{e.entityStore.state.updateMany(e.entityStore.view.all(),{selected:!1})},args:[e],availability:e=>cw(e)},{id:"wfsDownload",icon:"file-export",title:"igo.integration.workspace.download.title",tooltip:"igo.integration.workspace.download.tooltip",handler:e=>{const t=e.entityStore.getStrategyOfType(mt),o=e.entityStore.getStrategyOfType(ft).active?[e.layer.id]:[];this.toolState.toolToActivateFromOptions({tool:"importExport",options:{layers:[e.layer.id],featureInMapExtent:t.active,layersWithSelection:o}})},args:[e]},{id:"ogcFilter",icon:"filter",title:"igo.integration.workspace.ogcFilter.title",tooltip:"igo.integration.workspace.ogcFilter.tooltip",handler:(e,t)=>{t.activateWidget(e,{map:t.map,layer:t.layer})},args:[this.ogcFilterWidget,e]},{id:"maximize",title:this.languageService.translate.instant("igo.integration.workspace.maximize"),tooltip:this.languageService.translate.instant("igo.integration.workspace.maximizeTooltip"),icon:"resize",display:()=>this.maximize$.pipe((0,x.U)(e=>!e&&!this.mediaService.isMobile())),handler:()=>{this.mediaService.isMobile()||this.maximize$.next(!0)}},{id:"standardExtent",title:this.languageService.translate.instant("igo.integration.workspace.standardExtent"),tooltip:this.languageService.translate.instant("igo.integration.workspace.standardExtentTooltip"),icon:"resize",display:()=>this.maximize$.pipe((0,x.U)(e=>e&&!this.mediaService.isMobile())),handler:()=>{this.maximize$.next(!1)}}];return(null===(r=null===(i=e.layer.dataSource.ogcFilters$)||void 0===i?void 0:i.value)||void 0===r?void 0:r.enabled)?s:s.filter(e=>"ogcFilter"!==e.id)}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(qx),r.LFG(FS),r.LFG(ue),r.LFG(be),r.LFG(LS))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),IS=(()=>{class e{constructor(e,t,o){this.featureActionsService=e,this.wfsActionsService=t,this.storageService=o,this.workspacePanelExpanded=!1,this.workspaceEnabled$=new C.X(!1),this.rowsInMapExtentCheckCondition$=new C.X(!0),this.selectOnlyCheckCondition$=new C.X(!1),this.workspaceMaximize$=new C.X(this.storageService.get("workspaceMaximize")),this.actionMaximize$$=[],this.activeWorkspaceWidget$=new C.X(void 0),this.workspace$=new C.X(void 0),this.initWorkspaces()}get store(){return this._store}initWorkspaces(){this._store=new Ur([]),this._store.stateView.firstBy$(e=>!0===e.state.active).subscribe(e=>{this.workspace$.next(e?e.entity:void 0)}),this._store.stateView.all$().subscribe(e=>{e.map(e=>{e.entity.actionStore.empty&&(e.entity instanceof Rx?this.wfsActionsService.loadActions(e.entity,this.rowsInMapExtentCheckCondition$,this.selectOnlyCheckCondition$):e.entity instanceof Jx&&this.featureActionsService.loadActions(e.entity,this.rowsInMapExtentCheckCondition$,this.selectOnlyCheckCondition$))})}),this.actionMaximize$$.push(this.featureActionsService.maximize$.subscribe(e=>{this.setWorkspaceIsMaximized(e)})),this.actionMaximize$$.push(this.wfsActionsService.maximize$.subscribe(e=>{this.setWorkspaceIsMaximized(e)})),this.activeWorkspace$$=this.workspace$.subscribe(e=>{void 0!==this.activeWorkspaceWidget$$&&(this.activeWorkspaceWidget$$.unsubscribe(),this.activeWorkspaceWidget$$=void 0),void 0!==e&&(this.activeWorkspaceWidget$$=e.widget$.subscribe(e=>this.activeWorkspaceWidget$.next(e)))}),this.rowsInMapExtentCheckCondition$$=this.rowsInMapExtentCheckCondition$.subscribe(e=>{this._store.stateView.all().map(t=>{if(!t.entity.actionStore.empty){const o=t.entity.entityStore.getStrategyOfType(mt);o&&(e?o.activate():o.deactivate())}})}),this.selectOnlyCheckCondition$$=this.selectOnlyCheckCondition$.subscribe(e=>{this._store.stateView.all().map(t=>{if(!t.entity.actionStore.empty){const o=t.entity.entityStore.getStrategyOfType(ft);o&&(e?o.activate():o.deactivate())}})})}setWorkspaceIsMaximized(e){this.storageService.set("workspaceMaximize",e),this.workspaceMaximize$.next(e)}setActiveWorkspaceById(e){const t=this.store.all().find(t=>t.id===e);t&&this.store.activateWorkspace(t)}ngOnDestroy(){this.teardownWorkspaces(),this.actionMaximize$$.map(e=>e.unsubscribe()),this.rowsInMapExtentCheckCondition$$&&this.selectOnlyCheckCondition$$.unsubscribe(),this.selectOnlyCheckCondition$$&&this.selectOnlyCheckCondition$$.unsubscribe()}teardownWorkspaces(){this.store.clear(),void 0!==this.activeWorkspaceWidget$$&&this.activeWorkspaceWidget$$.unsubscribe(),void 0!==this.activeWorkspace$$&&this.activeWorkspace$$.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(OS),r.LFG(MS),r.LFG(Se))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),kS=(()=>{class e{constructor(e,t,o){this.searchSourceService=e,this.storageService=t,this.configService=o,this.searchOverlayStyle={},this.searchOverlayStyleSelection={},this.searchOverlayStyleFocus={},this.searchTermSplitter$=new C.X("|"),this.searchTerm$=new C.X(void 0),this.searchType$=new C.X(void 0),this.searchDisabled$=new C.X(!1),this.searchResultsGeometryEnabled$=new C.X(!1),this.searchSettingsChange$=new C.X(void 0),this.selectedResult$=new C.X(void 0),this.store=new dt([]);const i=this.configService.getConfig("searchOverlayStyle");i&&(this.searchOverlayStyle=i.base,this.searchOverlayStyleSelection=i.selection,this.searchOverlayStyleFocus=i.focus);const r=this.storageService.get("searchResultsGeometryEnabled");r&&this.searchResultsGeometryEnabled$.next(r),this.store.addStrategy(this.createCustomFilterTermStrategy(),!1)}get searchTypes(){return this.searchSourceService.getEnabledSources().map(e=>e.constructor.type)}createCustomFilterTermStrategy(){return new mt({filterClauseFunc:e=>100===e.entity.meta.score})}activateCustomFilterTermStrategy(){const e=this.store.getStrategyOfType(mt);void 0!==e&&e.activate()}deactivateCustomFilterTermStrategy(){const e=this.store.getStrategyOfType(mt);void 0!==e&&e.deactivate()}enableSearch(){this.searchDisabled$.next(!1)}disableSearch(){this.searchDisabled$.next(!0)}setSearchTerm(e){this.searchTerm$.next(e)}setSearchType(e){this.searchSourceService.enableSourcesByType(e),this.searchType$.next(e)}setSearchSettingsChange(){this.searchSettingsChange$.next(!0)}setSelectedResult(e){this.selectedResult$.next(e)}setSearchResultsGeometryStatus(e){this.storageService.set("searchResultsGeometryEnabled",e),this.searchResultsGeometryEnabled$.next(e)}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(sb),r.LFG(Se),r.LFG(W))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),PS=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[_x]]}),e})(),_S=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,a.Ps,Ye.g,p.AV,n.ot,ne,Bh,_x,ti,ji,Nh,Go]]}),e})(),$S=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[],PS,_S]}),e})();const qS=["mapBrowser"];function DS(e,t){1&e&&(r.TgZ(0,"span",11),r._uU(1," F2 activate/deactivate the pointer location. "),r.qZA())}function ES(e,t){if(1&e&&r._UZ(0,"igo-search-add-button",12),2&e){const e=t.result,o=r.oxw();r.Q6J("map",o.map)("layer",e)}}function RS(e,t){if(1&e&&(r.TgZ(0,"igo-panel",11),r._UZ(1,"igo-feature-details",13),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("feature",e.selectedFeature)}}function US(e,t){if(1&e&&r._UZ(0,"igo-actionbar",14),2&e){const e=r.oxw();r.Q6J("store",e.store)("withIcon",!1)("horizontal",!0)("mode","context")}}const NS=d.Bz.forChild([{path:"search",component:(()=>{class e{constructor(e,t,o,i,r,s,n){this.languageService=e,this.projectionService=t,this.mapService=o,this.layerService=i,this.searchState=r,this.searchService=s,this.mediaService=n,this.store=new vr([]),this.igoSearchPointerSummaryEnabled=!1,this.termSplitter="|",this.map=new nu({overlay:!0,controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:7},this.settingsChange$=new C.X(void 0),this.mapService.setMap(this.map),this.layerService.createAsyncLayer({title:"OSM",sourceOptions:{type:"osm"}}).subscribe(e=>{this.osmLayer=e,this.map.addLayer(e)})}get searchStore(){return this.searchState.store}get isTouchScreen(){return this.mediaService.isTouchScreen()}onPointerSummaryStatusChange(e){this.igoSearchPointerSummaryEnabled=e}onSearchTermChange(e=""){this.term=e,e.replace(/(#[^\s]*)/g,"").trim().length<2&&(this.searchStore.clear(),this.selectedFeature=void 0)}onSearch(e){const t=e.results;this.searchStore.state.updateAll({focused:!1,selected:!1});const o=this.searchStore.entities$.value.filter(t=>t.source!==e.research.source).concat(t);this.searchStore.updateMany(o)}onSearchSettingsChange(){this.settingsChange$.next(!0)}onResultFocus(e){this.tryAddFeatureToMap(e),this.selectedFeature=e.data}tryAddFeatureToMap(e){e.meta.dataType===Zl&&void 0!==e.data.geometry&&this.map.searchResultsOverlay.setFeatures([e.data],Fl.Default)}ngOnInit(){this.store.load([{id:"coordinates",title:"coordinates",handler:this.onSearchCoordinate.bind(this)},{id:"googleMaps",title:"googleMap",handler:this.onOpenGoogleMaps.bind(this),args:["1"]},{id:"googleStreetView",title:"googleStreetView",handler:this.onOpenGoogleStreetView.bind(this)}])}ngOnDestroy(){this.store.destroy()}removeFeatureFromMap(){this.map.searchResultsOverlay.clear()}onContextMenuOpen(e){const t=this.mapPosition(e),o=this.mapService.getMap().ol.getCoordinateFromPixel(t);this.mapProjection=this.mapService.getMap().projection,this.lonlat=kn.vs(o,this.mapProjection,"EPSG:4326")}mapPosition(e){const t=e;return t.y=t.y-this.mapBrowser.nativeElement.getBoundingClientRect().top+window.scrollY,t.x=t.x-this.mapBrowser.nativeElement.getBoundingClientRect().left+window.scrollX,[t.x,t.y]}onPointerSearch(e){this.lonlat=e,this.onSearchCoordinate()}onSearchCoordinate(){this.searchStore.clear();const e=this.searchService.reverseSearch(this.lonlat);for(const t in e)e.length>0&&e[t].request.subscribe(o=>{this.onSearch({research:e[t],results:o})})}onOpenGoogleMaps(){window.open(Gu.getGoogleMapsCoordLink(this.lonlat[0],this.lonlat[1]))}onOpenGoogleStreetView(){window.open(Gu.getGoogleStreetViewLink(this.lonlat[0],this.lonlat[1]))}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ue),r.Y36(Dc),r.Y36(Pc),r.Y36(Cu),r.Y36(kS),r.Y36(nb),r.Y36(be))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-search"]],viewQuery:function(e,t){if(1&e&&r.Gf(qS,7,r.SBq),2&e){let e;r.iGM(e=r.CRH())&&(t.mapBrowser=e.first)}},decls:31,vars:15,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/search"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/environments"],["title","Details",4,"ngIf"],["igoOverlay","","igoSearchPointerSummary","",3,"map","view","igoContextMenu","igoSearchPointerSummaryDelay","igoSearchPointerSummaryEnabled","menuPosition"],["mapBrowser",""],["color","primary",3,"map"],["title","Search"],[3,"searchSettings","store","termSplitter","pointerSummaryStatus","searchTermChange","search","clearFeature","searchSettingsChange"],["placeholder","false",3,"store","term","termSplitter","settingsChange$","resultFocus","resultSelect","moreResults"],["igoSearchItemToolbar",""],["actionbarMenu",""],["title","Details"],[3,"map","layer"],[3,"feature"],[3,"store","withIcon","horizontal","mode"]],template:function(e,t){if(1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Search"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: ConfigService, LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"br"),r._uU(13," See search section of the "),r.TgZ(14,"a",1),r._uU(15," environment config"),r.qZA(),r._UZ(16,"hr"),r._UZ(17,"br"),r.YNc(18,DS,2,0,"span",2),r.qZA(),r.TgZ(19,"igo-map-browser",3,4),r.NdJ("menuPosition",function(e){return t.onContextMenuOpen(e)}),r._UZ(21,"igo-zoom-button",5),r.qZA(),r.TgZ(22,"igo-panel",6),r.TgZ(23,"igo-search-bar",7),r.NdJ("pointerSummaryStatus",function(e){return t.onPointerSummaryStatusChange(e)})("searchTermChange",function(e){return t.onSearchTermChange(e)})("search",function(e){return t.onSearch(e)})("clearFeature",function(){return t.removeFeatureFromMap()})("searchSettingsChange",function(){return t.onSearchSettingsChange()}),r.qZA(),r.TgZ(24,"igo-search-results",8),r.NdJ("resultFocus",function(e){return t.onResultFocus(e)})("resultSelect",function(e){return t.onResultFocus(e)})("moreResults",function(e){return t.onSearch(e)}),r.YNc(25,ES,1,2,"ng-template",null,9,r.W1O),r.qZA(),r.qZA(),r.YNc(27,RS,2,1,"igo-panel",2),r.qZA(),r.YNc(28,US,1,4,"ng-template",null,10,r.W1O),r._UZ(30,"igo-message-center")),2&e){const e=r.MAs(29);r.xp6(18),r.Q6J("ngIf",!t.isTouchScreen),r.xp6(1),r.Q6J("map",t.map)("view",t.view)("igoContextMenu",e)("igoSearchPointerSummaryDelay",500)("igoSearchPointerSummaryEnabled",t.igoSearchPointerSummaryEnabled),r.xp6(2),r.Q6J("map",t.map),r.xp6(2),r.Q6J("searchSettings",!0)("store",t.searchStore)("termSplitter",t.termSplitter),r.xp6(1),r.Q6J("store",t.searchStore)("term",t.term)("termSplitter",t.termSplitter)("settingsChange$",t.settingsChange$),r.xp6(3),r.Q6J("ngIf",t.selectedFeature)}},directives:[g.a8,g.$j,g.n5,g.dn,h.O5,lu,kx,jo,fu,Bi,ax,Fx,le,Mx,eh,Mo],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{height:100%;width:100%;padding-top:10px}"]}),e})()}]);let JS=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[{provide:ju,useFactory:Ib,multi:!0,deps:[W,ue,Se,Dc]},{provide:ju,useFactory:tw,multi:!0,deps:[y.eN,ue,Se,W]},{provide:ju,useFactory:Lb,multi:!0,deps:[y.eN,ue,Se,W,wb,r.zs3]},{provide:ju,useFactory:$b,multi:!0,deps:[y.eN,ue,Se,W,kb]},{provide:ju,useFactory:iw,multi:!0,deps:[y.eN,W,Se]},{provide:ju,useFactory:Zb,multi:!0,deps:[y.eN,ue,Se,W,r.zs3]},{provide:ju,useFactory:nw,multi:!0,deps:[y.eN,ue,Se,W]},{provide:ju,useFactory:aw,multi:!0,deps:[y.eN,ue,Se,W]}],imports:[[h.ez,NS,g.QW,n.ot,a.Ps,p.AV,ce.forRoot(),ji,rv,_x.forRoot(),$S,Io,Qo,Bh]]}),e})();const BS=d.Bz.forChild([{path:"print",component:(()=>{class e{constructor(e,t){this.languageService=e,this.layerService=t,this.map=new nu({controls:{attribution:{collapsed:!1}}}),this.view={center:[-73,47.2],zoom:9},this.layerService.createAsyncLayer({title:"Quebec Base Map",sourceOptions:{type:"wmts",url:"https://geoegl.msp.gouv.qc.ca/apis/carto/wmts/1.0.0/wmts",layer:"carte_gouv_qc_ro",matrixSet:"EPSG_3857",version:"1.3.0",crossOrigin:"anonymous",attributions:"\xa9 <a href='http://www.droitauteur.gouv.qc.ca/copyright.php' target='_blank'><img src='https://geoegl.msp.gouv.qc.ca/gouvouvert/public/images/quebec/gouv_qc_logo.png' width='64' height='14'>Gouvernement du Qu\xe9bec</a> / <a href='https://www.igouverte.org/' target='_blank'>IGO2</a>"}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"School board",sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{LAYERS:"MELS_CS_ANGLO_S",VERSION:"1.3.0"},crossOrigin:"anonymous"}}).subscribe(e=>this.map.addLayer(e)),this.layerService.createAsyncLayer({title:"Embacle",sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{LAYERS:"vg_observation_v_inondation_embacle_wmst",VERSION:"1.3.0"},crossOrigin:"anonymous"}}).subscribe(e=>this.map.addLayer(e))}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ue),r.Y36(Cu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-print"]],decls:19,vars:7,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/print"],[3,"map","view"],["color","primary",3,"map"],["color","primary",3,"map","showIfNoRotation"],[3,"map"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Print"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"hr"),r.qZA(),r.TgZ(13,"igo-map-browser",1),r._UZ(14,"igo-zoom-button",2),r._UZ(15,"igo-geolocate-button",2),r._UZ(16,"igo-rotation-button",3),r.qZA(),r._UZ(17,"igo-print",4),r.qZA(),r._UZ(18,"igo-message-center")),2&e&&(r.xp6(13),r.Q6J("map",t.map)("view",t.view),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("map",t.map)("showIfNoRotation",!1),r.xp6(1),r.Q6J("map",t.map))},directives:[g.a8,g.$j,g.n5,g.dn,lu,fu,yu,Ou,Zv,le],styles:["igo-map-browser[_ngcontent-%COMP%]{width:900px;height:1000px}"]}),e})()}]);let jS=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[BS,g.QW,n.ot,ce,rv,Fv]]}),e})();const QS=d.Bz.forChild([{path:"import-export",component:(()=>{class e{constructor(e,t){this.languageService=e,this.layerService=t,this.map=new nu({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:9},this.layerService.createAsyncLayer({title:"OSM",sourceOptions:{type:"osm"}}).subscribe(e=>this.map.addLayer(e))}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ue),r.Y36(Cu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-import-export"]],decls:17,vars:4,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/import-export"],[3,"map","view"],["color","primary",3,"map"],[3,"map"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Import / Export"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"hr"),r.qZA(),r.TgZ(13,"igo-map-browser",1),r._UZ(14,"igo-zoom-button",2),r.qZA(),r._UZ(15,"igo-import-export",3),r.qZA(),r._UZ(16,"igo-message-center")),2&e&&(r.xp6(13),r.Q6J("map",t.map)("view",t.view),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("map",t.map))},directives:[g.a8,g.$j,g.n5,g.dn,lu,fu,Xy,le],styles:["igo-map-browser[_ngcontent-%COMP%]{width:900px;height:1000px}"]}),e})()}]);let GS=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[ev({path:"./assets/import-style.json"})],imports:[[QS,g.QW,n.ot,ce,rv,iv]]}),e})();const YS=d.Bz.forChild([{path:"directions",component:(()=>{class e{constructor(e,t,o,i){this.projectionService=e,this.languageService=t,this.layerService=o,this.mapService=i,this.map=new nu({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:9,geolocate:!0},this.stopsStore=new zx([]),this.stopsFeatureStore=new Hx([],{map:this.map}),this.stepFeatureStore=new Wx([],{map:this.map}),this.routesFeatureStore=new Vx([],{map:this.map}),this.zoomToActiveRoute$=new O.xQ,this.mapService.setMap(this.map),this.layerService.createAsyncLayer({title:"OSM",sourceOptions:{type:"osm"}}).subscribe(e=>this.map.addLayer(e))}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Dc),r.Y36(ue),r.Y36(Cu),r.Y36(Pc))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-directions"]],decls:18,vars:11,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/directions"],[3,"map","view"],["color","primary",3,"map"],["color","primary",3,"map","showIfNoRotation"],[3,"stopsStore","stopsFeatureStore","stepFeatureStore","routesFeatureStore","zoomToActiveRoute$"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Directions"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"hr"),r.qZA(),r.TgZ(13,"igo-map-browser",1),r._UZ(14,"igo-zoom-button",2),r._UZ(15,"igo-geolocate-button",2),r._UZ(16,"igo-rotation-button",3),r.qZA(),r._UZ(17,"igo-directions",4),r.qZA()),2&e&&(r.xp6(13),r.Q6J("map",t.map)("view",t.view),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("map",t.map)("showIfNoRotation",!1),r.xp6(1),r.Q6J("stopsStore",t.stopsStore)("stopsFeatureStore",t.stopsFeatureStore)("stepFeatureStore",t.stepFeatureStore)("routesFeatureStore",t.routesFeatureStore)("zoomToActiveRoute$",t.zoomToActiveRoute$))},directives:[g.a8,g.$j,g.n5,g.dn,lu,fu,yu,Ou,vb],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}"]}),e})()}]);let zS=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[{provide:Iv,useFactory:Kx,multi:!0,deps:[y.eN,W]}],imports:[[YS,g.QW,n.ot,ce,rv,bb]]}),e})();const HS=d.Bz.forChild([{path:"time-filter",component:(()=>{class e{constructor(e,t,o){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.map=new nu({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:7},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://geoegl.msp.gouv.qc.ca/ws/igo_gouvouvert.fcgi",params:{LAYERS:"vg_observation_v_inondation_embacle_wmst",VERSION:"1.3.0"},timeFilterable:!0,timeFilter:{min:"2013",max:"2019",range:!1,type:Ic.YEAR,style:kc.SLIDER,step:1,timeInterval:2e3}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle YEAR",visible:!0,source:e}))})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ue),r.Y36(Ec),r.Y36(Cu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-time-filter"]],decls:21,vars:4,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/time-filter"],[3,"map","view"],["color","primary",3,"map"],["title","Layers"],[3,"layers"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Time filter"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"npm install --save moment@2.22.2"),r.qZA(),r.TgZ(8,"li"),r._uU(9,"npm install --save @mat-datetimepicker/core@3.0.0-beta.0"),r.qZA(),r.TgZ(10,"li"),r._uU(11,"Dependencies: LanguageService"),r.qZA(),r._UZ(12,"br"),r._uU(13," See the "),r.TgZ(14,"a",0),r._uU(15,"code of this example"),r.qZA(),r._UZ(16,"hr"),r.qZA(),r.TgZ(17,"igo-map-browser",1),r._UZ(18,"igo-zoom-button",2),r.qZA(),r.TgZ(19,"igo-panel",3),r._UZ(20,"igo-time-filter-list",4),r.qZA(),r.qZA()),2&e&&(r.xp6(17),r.Q6J("map",t.map)("view",t.view),r.xp6(1),r.Q6J("map",t.map),r.xp6(2),r.Q6J("layers",t.map.layers))},directives:[g.a8,g.$j,g.n5,g.dn,lu,fu,Bi,Eg],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),e})()}]);let VS=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[HS,g.QW,n.ot,a.Ps,ji,rv,ly]]}),e})();const WS=d.Bz.forChild([{path:"ogc-filter",component:(()=>{class e{constructor(e,t,o){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.map=new nu({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:7},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"code_municipalite",alias:"# de la municipalit\xe9e"},{name:"date_observation",excludeFromOgcFilters:!0},{name:"urgence",values:["imm\xe9diate","inconnue"]}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:Jl.All,filters:{logical:"Or",filters:[{operator:"PropertyIsEqualTo",propertyName:"code_municipalite",expression:"10043"},{operator:"Intersects",geometryName:"the_geom",wkt_geometry:"MULTIPOLYGON(((\n              -8379441.158019895 5844447.897707146,\n              -8379441.158019895 5936172.331649357,\n              -8134842.66750733 5936172.331649357,\n              -8134842.66750733 5844447.897707146,\n              -8379441.158019895 5844447.897707146\n            ), (\n              -8015003 5942074,\n              -8015003 5780349,\n              -7792364 5780349,\n              -7792364 5942074,\n              -8015003 5942074\n            )))"}]}}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle (PropertyIsEqualTo OR Intersects)",source:e,style:new Un.ZP({image:new Qn.Z({radius:5,fill:new Jn.Z({color:"white"}),stroke:new jn.Z({color:"orange",width:1})})})}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:Jl.All,filters:{operator:"During",propertyName:"date_observation",begin:"2016-01-21T00:00:00-05:00",end:"2016-01-26T00:00:00-05:00"}},minDate:"2016-01-01T00:00:00-05:00",maxDate:"2016-02-10T00:00:00-05:00",stepDate:"P2D"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle (During, Step: P2D)",id:"1",source:e,style:new Un.ZP({image:new Qn.Z({radius:5,fill:new Jn.Z({color:"white"}),stroke:new jn.Z({color:"red",width:1})})})}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:Jl.All,filters:{operator:"During",propertyName:"date_observation",begin:"2016-01-01T04:00:00-05:00",end:"2016-01-12T16:00:00-05:00"}},minDate:"2016-01-01T00:00:00-05:00",maxDate:"2016-02-14T20:00:00-05:00",stepDate:"PT4H"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle (During, Step: PT4H)",id:"2",source:e,style:new Un.ZP({image:new Qn.Z({radius:5,fill:new Jn.Z({color:"white"}),stroke:new jn.Z({color:"blue",width:1})})})}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:Jl.All,filters:{operator:"During",propertyName:"date_observation",begin:"2016-01-01T00:00:00-05:00",end:"2016-03-31T00:00:00-05:00",displayFormat:"MMMM"}},minDate:"2016-01-01T00:00:00-05:00",maxDate:"2018-12-31T00:00:00-05:00",stepDate:"P1M"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle (During, Step: P1M)",id:"3",source:e,style:new Un.ZP({image:new Qn.Z({radius:5,fill:new Jn.Z({color:"white"}),stroke:new jn.Z({color:"yellow",width:1})})})}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:Jl.All,filters:{operator:"During",propertyName:"date_observation",begin:"2014-01-01T00:00:00-05:00",end:"2019-12-31T00:00:00-05:00",sliderOptions:{interval:2e3,displayFormat:"YY"},displayFormat:"YYYY"}},minDate:"2014-01-01T00:00:00-05:00",maxDate:"2019-12-31T00:00:00-05:00",stepDate:"P1Y"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle (During, Step: P1Y)",id:"4",source:e,style:new Un.ZP({image:new Qn.Z({radius:5,fill:new Jn.Z({color:"white"}),stroke:new jn.Z({color:"green",width:1})})})}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:Jl.All,filters:{operator:"During",propertyName:"date_observation",begin:"today - 2 days",end:"today"}},minDate:"2016-01-01T00:00:00-05:00",maxDate:"2025-12-31T00:00:00-05:00",stepDate:"P1D"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle (During, Interval from Now, Step: P1D)",id:"5",source:e,style:new Un.ZP({image:new Qn.Z({radius:5,fill:new Jn.Z({color:"white"}),stroke:new jn.Z({color:"black",width:1})})})}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:Jl.All,filters:{operator:"During",propertyName:"date_observation",begin:"2019-01-01 00:00:00",restrictToStep:!0}},minDate:"2016-01-01T00:00:00-05:00",maxDate:"2025-12-31T00:00:00-05:00",stepDate:"P1M"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Emb\xe2cle (During, RestrictToStep, Step: P1M)",id:"6",source:e,style:new Un.ZP({image:new Qn.Z({radius:5,fill:new Jn.Z({color:"black"}),stroke:new jn.Z({color:"red",width:1})})})}))}),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"vg_observation_v_inondation23avril2017_wmst",VERSION:"1.3.0"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,filters:{operator:"During",propertyName:"date_observation"},allowedOperatorsType:Jl.Time}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Inondation (During, optionsFromCapabilities)",source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",urlWfs:"https://ws.mapserver.transports.gouv.qc.ca/swtq",params:{LAYERS:"radars_photos",VERSION:"1.3.0"},ogcFilters:{enabled:!0,editable:!0,pushButtons:{selectorType:"pushButton",order:2,groups:[{title:"Nom du group1 - push",name:"1 - push",ids:["id1"]}],bundles:[{id:"id1",title:"R\xe9gions",logical:"Or",vertical:!0,selectors:[{title:"Montr\xe9al & Laval",enabled:!1,tooltip:"Here a tooltip explaning ...",filters:{logical:"Or",filters:[{operator:"PropertyIsEqualTo",propertyName:"region",expression:"Montr\xe9al"},{operator:"PropertyIsEqualTo",propertyName:"region",expression:"Laval"}]}},{title:"Outside Montr\xe9al & Laval",enabled:!1,tooltip:"Here a tooltip explaning ...",filters:{logical:"And",filters:[{operator:"PropertyIsNotEqualTo",propertyName:"region",expression:"Montr\xe9al"},{operator:"PropertyIsNotEqualTo",propertyName:"region",expression:"Laval"}]}}]}]},checkboxes:{selectorType:"checkbox",order:1,groups:[{title:"Nom du group1 - checkbox",name:"1 - checkbox",ids:["id1"]}],bundles:[{id:"id1",title:"Type de radar photo",logical:"Or",selectors:[{title:"Radar photo fixe",enabled:!0,tooltip:"Here a tooltip explaning ...",filters:{operator:"PropertyIsEqualTo",propertyName:"typeAppareil",expression:"Radar photo fixe"}},{title:"Radar photo mobile",enabled:!1,tooltip:"Here a tooltip explaning ...",filters:{operator:"PropertyIsEqualTo",propertyName:"typeAppareil",expression:"Radar photo mobile"}},{title:"Radar photo fixe + feu rouge",enabled:!1,color:"0,200,0",tooltip:"Here a tooltip explaning ...",filters:{operator:"PropertyIsEqualTo",propertyName:"typeAppareil",expression:"Radar photo fixe et surveillance au feu rouge"}},{title:"Radar feu rouge",enabled:!1,color:"255,0,0",tooltip:"Here a tooltip explaning ...",filters:{operator:"PropertyIsEqualTo",propertyName:"typeAppareil",expression:"Appareil de surveillance au feu rouge"}}]}]},allowedOperatorsType:Jl.Basic},paramsWFS:{featureTypes:"radars_photos",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"1.1.0",outputFormat:"geojson",outputFormatDownload:"shp"}}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Filterable WMS layers with predefined filters (push buttons)",source:e}))})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ue),r.Y36(Ec),r.Y36(Cu))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-ogc-filter"]],decls:17,vars:5,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/ogc-filter"],[3,"map","view"],["color","primary",3,"map"],["title","Layers"],[3,"map","layers"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Ogc filter"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"Dependencies: LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"hr"),r.qZA(),r.TgZ(13,"igo-map-browser",1),r._UZ(14,"igo-zoom-button",2),r.qZA(),r.TgZ(15,"igo-panel",3),r._UZ(16,"igo-ogc-filterable-list",4),r.qZA(),r.qZA()),2&e&&(r.xp6(13),r.Q6J("map",t.map)("view",t.view),r.xp6(1),r.Q6J("map",t.map),r.xp6(2),r.Q6J("map",t.map)("layers",t.map.layers))},directives:[g.a8,g.$j,g.n5,g.dn,lu,fu,Bi,Zm],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),e})()}]);let XS=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[WS,g.QW,n.ot,a.Ps,ji,rv,ly]]}),e})();function KS(e,t){if(1&e&&(r.ynx(0),r._UZ(1,"igo-feature-details",8),r.BQk()),2&e){const e=t.ngIf;r.xp6(1),r.Q6J("feature",e)}}const eC=d.Bz.forChild([{path:"spatial-filter",component:(()=>{class e{constructor(e,t,o,i,r){this.spatialFilterService=e,this.dataSourceService=t,this.layerService=o,this.messageService=i,this.languageService=r,this.map=new nu({controls:{attribution:{collapsed:!0}}}),this.view={center:[-71.9,46.9],zoom:10},this.itemType=Dd.Address,this.layers=[],this.selectedFeature$=new C.X(void 0),this.format=new Xn.Z,this.store=new dt([]),this.spatialListStore=new dt([]),this.loading=!1,this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e,baseLayer:!0,visible:!0}))})}getOutputType(e){this.type=e,this.queryType=void 0,this.radius=void 0}getOutputQueryType(e){this.queryType=e,this.queryType&&this.loadFilterList()}loadFilterList(){this.spatialFilterService.loadFilterList(this.queryType).subscribe(e=>{e.sort((e,t)=>e.properties.nom<t.properties.nom?-1:e.properties.nom>t.properties.nom?1:0),this.spatialListStore.clear(),this.spatialListStore.load(e)})}getOutputToggleSearch(){this.loadThematics()}getOutputClearSearch(){this.zone=void 0,this.queryType=void 0}loadThematics(){this.loading=!0,this.tryAddFeaturesToMap([this.zone]),this.thematics||(this.thematics=[{name:""}]),this.type===qd.Polygon&&(this.radius=void 0),this.thematics.forEach(e=>{this.spatialFilterService.loadFilterItem(this.zone,this.itemType,this.queryType,e,this.radius).subscribe(e=>{this.store.insertMany(e);const t=[],o=[];let i,r;e.forEach(e=>{"Point"===e.geometry.type?(t.push(e),i=e.meta.id):(o.push(e),r=e.meta.id)}),this.tryAddPointToMap(t,i),this.tryAddLayerToMap(o,r),this.loading=!1,e.length>=1e4&&this.messageService.alert(this.languageService.translate.instant("igo.geo.spatialFilter.maxSizeAlert"),this.languageService.translate.instant("igo.geo.spatialFilter.warning"),{timeOut:1e4}),e.length||this.messageService.alert(this.languageService.translate.instant("igo.geo.spatialFilter.zeroResults"),this.languageService.translate.instant("igo.geo.spatialFilter.warning"),{timeOut:1e4})})})}onZoneChange(e){this.zone=e,e&&(this.tryAddFeaturesToMap([e]),this.zoomToFeatureExtent(e))}tryAddFeaturesToMap(e){let t=1;for(const o of e){if(this.type===qd.Predefined)for(const e of this.map.layers){if(e.options._internal&&e.options._internal.code===o.properties.code)return;e.title.startsWith("Zone")&&this.map.removeLayer(e)}for(const e of this.map.layers)e.title.startsWith("Zone")&&t++;this.dataSourceService.createAsyncDataSource({type:"vector",queryable:!0}).subscribe(i=>{const r=this.layerService.createLayer({title:"Zone "+t,_internal:{code:this.type===qd.Predefined?o.properties.code:void 0},source:i,visible:!0,style:(t,o)=>{const i=e[0].coordinates;return new Un.ZP({image:new Qn.Z({radius:i?this.radius/Math.cos(Math.PI/180*i[1])/o:void 0,fill:new Jn.Z({color:"rgba(200, 200, 20, 0.2)"}),stroke:new jn.Z({width:1,color:"orange"})}),stroke:new jn.Z({width:1,color:"orange"}),fill:new Jn.Z({color:"rgba(200, 200, 20, 0.2)"})})}}),s=e.map(e=>Rc(e,this.map.projection));i.ol.addFeatures(s),this.map.addLayer(r),this.layers.push(r)})}}tryAddPointToMap(e,t){let o=1;if(e.length>=1){if(void 0===this.map)return;for(const t of this.map.layers)t.title.startsWith(e[0].meta.title)&&o++;this.dataSourceService.createAsyncDataSource({type:"cluster",id:t,queryable:!0,distance:120,meta:{title:"Cluster"}}).subscribe(t=>{const i=this.layerService.createLayer({title:e[0].meta.title+" "+o,source:t,visible:!0,clusterParam:{clusterRanges:[{minRadius:1,maxRadius:5,style:{}}]}}),r=e.map(e=>Rc(e,this.map.projection));t.ol.getSource().addFeatures(r),this.map.layers.find(e=>e.id===i.id)&&(this.map.removeLayer(this.map.layers.find(e=>e.id===i.id)),o-=1,i.title=e[0].meta.title+" "+o,i.options.title=i.title),this.map.addLayer(i),this.layers.push(i)})}}tryAddLayerToMap(e,t){let o=1;if(e.length>1){if(void 0===this.map)return;for(const t of this.map.layers)t.title.startsWith(e[0].meta.title)&&o++;this.dataSourceService.createAsyncDataSource({type:"vector",id:t,queryable:!0}).subscribe(t=>{const i=this.layerService.createLayer({title:e[0].meta.title+" "+o,source:t,visible:!0}),r=e.map(e=>Rc(e,this.map.projection));t.ol.addFeatures(r),this.map.layers.find(e=>e.id===i.id)&&(this.map.removeLayer(this.map.layers.find(e=>e.id===i.id)),o-=1,i.title=e[0].meta.title+" "+o,i.options.title=i.title),this.map.addLayer(i),this.layers.push(i)})}}zoomToFeatureExtent(e){if(e){const t=this.format.readFeature(e,{dataProjection:e.projection,featureProjection:this.map.projection});Jc(this.map,[t],Fl.Zoom)}}handleQueryResults(e){const t=e.features;let o;t.length&&(o=t[0]),this.selectedFeature$.next(o)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(Ed),r.Y36(Ec),r.Y36(Cu),r.Y36(de),r.Y36(ue))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-spatial-filter"]],inputs:{type:"type",itemType:"itemType",freehandDrawIsActive:"freehandDrawIsActive"},decls:26,vars:17,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/spatial-filter"],["igoOverlay","","igoQuery","",3,"map","view","queryFeatures","query"],["color","primary",3,"map"],["title","Spatial Filter"],[3,"store","selectedQueryType","zone","eventType","eventQueryType","zoneChange"],[3,"type","queryType","map","zone","loading","store","layers","radiusEvent","freehandControl","drawZoneEvent","itemTypeChange","thematicChange","toggleSearch","clearButtonEvent","clearSearchEvent"],["title","Details"],[4,"ngIf"],[3,"feature"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Spatial filter"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"li"),r._uU(7,"npm install --save moment@2.22.2"),r.qZA(),r.TgZ(8,"li"),r._uU(9,"npm install --save @mat-datetimepicker/core@3.0.0-beta.0"),r.qZA(),r.TgZ(10,"li"),r._uU(11,"Dependencies: LanguageService"),r.qZA(),r._UZ(12,"br"),r._uU(13," See the "),r.TgZ(14,"a",0),r._uU(15,"code of this example"),r.qZA(),r._UZ(16,"hr"),r.qZA(),r.TgZ(17,"igo-map-browser",1),r.NdJ("query",function(e){return t.handleQueryResults(e)}),r._UZ(18,"igo-zoom-button",2),r.qZA(),r.TgZ(19,"igo-panel",3),r.TgZ(20,"igo-spatial-filter-type",4),r.NdJ("eventType",function(e){return t.getOutputType(e)})("eventQueryType",function(e){return t.getOutputQueryType(e)})("zoneChange",function(e){return t.onZoneChange(e)}),r.qZA(),r.TgZ(21,"igo-spatial-filter-item",5),r.NdJ("radiusEvent",function(e){return t.radius=e})("freehandControl",function(e){return t.freehandDrawIsActive=e})("drawZoneEvent",function(e){return t.zone=e})("itemTypeChange",function(e){return t.itemType=e})("thematicChange",function(e){return t.thematics=e})("toggleSearch",function(){return t.getOutputToggleSearch()})("clearButtonEvent",function(e){return t.layers=e})("clearSearchEvent",function(){return t.getOutputClearSearch()}),r.qZA(),r.qZA(),r.TgZ(22,"igo-panel",6),r.YNc(23,KS,2,1,"ng-container",7),r.ALo(24,"async"),r.qZA(),r._UZ(25,"igo-message-center"),r.qZA()),2&e&&(r.xp6(17),r.Q6J("map",t.map)("view",t.view)("queryFeatures",!0),r.xp6(1),r.Q6J("map",t.map),r.xp6(2),r.Q6J("store",t.spatialListStore)("selectedQueryType",t.queryType)("zone",t.zone),r.xp6(1),r.Q6J("type",t.type)("queryType",t.queryType)("map",t.map)("zone",t.zone)("loading",t.loading)("store",t.store)("layers",t.layers),r.xp6(2),r.Q6J("ngIf",r.lcZ(24,15,t.selectedFeature$)))},directives:[g.a8,g.$j,g.n5,g.dn,lu,Bu,fu,Bi,bf,Rf,h.O5,le,eh],pipes:[h.Ov],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}igo-form[_ngcontent-%COMP%]{display:none}igo-spatial-filter-item[_ngcontent-%COMP%]     .thematics-header{max-width:225px}"]}),e})()}]);let tC=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[eC,g.QW,n.ot,a.Ps,ji,rv,ce,Mv,Bh,Nh,ly,bi,h.ez]]}),e})();function oC(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"igo-entity-table-paginator",6),r.NdJ("paginatorChange",function(t){return r.CHM(e),r.oxw(2).paginatorChange(t)}),r.qZA()}if(2&e){const e=r.oxw().ngIf,t=r.oxw();r.Q6J("store",e.entityStore)("paginatorOptions",t.paginatorOptions)("entitySortChange$",t.entitySortChange$)}}function iC(e,t){if(1&e&&(r.ynx(0),r.YNc(1,oC,1,3,"igo-entity-table-paginator",5),r.ALo(2,"async"),r.BQk()),2&e){const e=t.ngIf;r.xp6(1),r.Q6J("ngIf",r.lcZ(2,1,e.inResolutionRange$))}}function rC(e,t){if(1&e&&r._UZ(0,"igo-actionbar",10),2&e){const e=r.oxw().ngIf,t=r.oxw();r.Q6J("store",e.actionStore)("horizontal",!0)("withToggleButton",!0)("withTitle",!0)("mode",t.actionbarMode)}}function sC(e,t){if(1&e&&r._UZ(0,"igo-entity-table",11),2&e){const e=r.oxw().ngIf,t=r.oxw();r.Q6J("paginator",t.workspacePaginator)("scrollBehavior",t.scrollBehavior)("store",e.entityStore)("template",e.meta.tableTemplate)}}function nC(e,t){1&e&&(r.TgZ(0,"mat-card-content"),r._uU(1," No data available at this scale. Please zoom in. "),r.qZA())}function aC(e,t){if(1&e&&(r.ynx(0),r.YNc(1,rC,1,5,"igo-actionbar",7),r.YNc(2,sC,1,4,"igo-entity-table",8),r.ALo(3,"async"),r.YNc(4,nC,2,0,"mat-card-content",4),r.ALo(5,"async"),r._UZ(6,"igo-workspace-widget-outlet",9),r.BQk()),2&e){const e=t.ngIf;r.xp6(1),r.Q6J("ngIf",e.actionStore),r.xp6(1),r.Q6J("ngIf",e.entityStore&&e.meta&&e.meta.tableTemplate&&r.lcZ(3,4,e.inResolutionRange$)),r.xp6(2),r.Q6J("ngIf",!1===r.lcZ(5,6,e.inResolutionRange$)),r.xp6(2),r.Q6J("workspace",e)}}const lC=d.Bz.forChild([{path:"workspace",component:(()=>{class e{constructor(e,t,o,i){this.languageService=e,this.dataSourceService=t,this.layerService=o,this.workspaceState=i,this.entitySortChange$=new C.X(!1),this.paginatorOptions={pageSize:5,pageSizeOptions:[1,5,10,15,30,50,100],showFirstLastButtons:!0},this.map=new nu({controls:{attribution:{collapsed:!0}}}),this.view={center:[-72,47.2],zoom:5},this.actionbarMode=po.Overlay,this.scrollBehavior=rt.Instant}get workspaceStore(){return this.workspaceState.store}ngOnInit(){this.selectedWorkspace$=this.workspaceStore.stateView.firstBy$(e=>!0===e.state.selected).pipe((0,x.U)(e=>{const t=void 0===e?void 0:e.entity;return t&&t.actionStore.view.filter(e=>"wfsDownload"!==e.id),t})),this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"OSM",source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",params:{featureTypes:"etablissement_mtq",fieldNameGeometry:"geometry",version:"2.0.0",outputFormat:"geojson"},sourceFields:[{name:"idetablis",alias:"ID"},{name:"nometablis",alias:"Name"},{name:"typetablis",alias:"Type"}]}).subscribe(e=>{this.map.addLayer(this.layerService.createLayer({title:"Simple WFS ",maxResolution:3e3,visible:!0,source:e}))})}paginatorChange(e){this.workspacePaginator=e}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ue),r.Y36(Ec),r.Y36(Cu),r.Y36(IS))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-workspace"]],decls:16,vars:11,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/workspace"],[3,"map","view"],["color","primary",3,"map"],["igoWorkspaceSelector","",3,"store","map"],[4,"ngIf"],[3,"store","paginatorOptions","entitySortChange$","paginatorChange",4,"ngIf"],[3,"store","paginatorOptions","entitySortChange$","paginatorChange"],[3,"store","horizontal","withToggleButton","withTitle","mode",4,"ngIf"],["class","table-compact table-centered",3,"paginator","scrollBehavior","store","template",4,"ngIf"],[3,"workspace"],[3,"store","horizontal","withToggleButton","withTitle","mode"],[1,"table-compact","table-centered",3,"paginator","scrollBehavior","store","template"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Workspace"),r.qZA(),r.TgZ(5,"mat-card-content"),r._uU(6," See the "),r.TgZ(7,"a",0),r._uU(8,"code of this example"),r.qZA(),r.qZA(),r.TgZ(9,"igo-map-browser",1),r._UZ(10,"igo-zoom-button",2),r.qZA(),r._UZ(11,"igo-workspace-selector",3),r.YNc(12,iC,3,3,"ng-container",4),r.ALo(13,"async"),r.YNc(14,aC,7,8,"ng-container",4),r.ALo(15,"async"),r.qZA()),2&e&&(r.xp6(9),r.Q6J("map",t.map)("view",t.view),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("store",t.workspaceStore)("map",t.map),r.xp6(1),r.Q6J("ngIf",r.lcZ(13,7,t.selectedWorkspace$)),r.xp6(2),r.Q6J("ngIf",r.lcZ(15,9,t.selectedWorkspace$)))},directives:[g.a8,g.$j,g.n5,g.dn,lu,fu,kr,jx,h.O5,Ct,$r,Mo,uo],pipes:[h.Ov],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}igo-entity-table[_ngcontent-%COMP%]{height:400px}igo-actionbar[_ngcontent-%COMP%]{height:48px}"]}),e})()}]);let cC=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[h.ez,lC,g.QW,n.ot,a.Ps,ko,Ai,Dr,ji,rv,Yx]]}),e})();function uC(e,t){1&e&&r._UZ(0,"igo-metadata-button",10),2&e&&r.Q6J("layer",t.layer)}const pC=d.Bz.forChild([{path:"context",component:(()=>{class e{constructor(e,t,o){this.languageService=e,this.mapService=t,this.overlayService=o,this.map=new nu({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:6},this.mapService.setMap(this.map)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(ue),r.Y36(Pc),r.Y36(uv))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-context"]],decls:27,vars:7,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/context/context"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/contexts"],["igoMapContext","","igoLayerContext","",3,"map"],["color","primary",3,"map"],["color","primary",3,"map","showIfNoRotation"],["title","Contexts list"],["igoContextListBinding","",3,"map"],["title","Layers"],["igoLayerListBinding","",3,"map"],["igoLayerItemToolbar",""],[3,"layer"]],template:function(e,t){1&e&&(r.TgZ(0,"mat-card"),r.TgZ(1,"mat-card-subtitle"),r._uU(2,"Geo"),r.qZA(),r.TgZ(3,"mat-card-title"),r._uU(4,"Context"),r.qZA(),r.TgZ(5,"mat-card-content"),r.TgZ(6,"p"),r._uU(7,"* Dependencies: LanguageService"),r.qZA(),r._UZ(8,"br"),r._uU(9," See the "),r.TgZ(10,"a",0),r._uU(11,"code of this example"),r.qZA(),r._UZ(12,"br"),r._uU(13," See "),r.TgZ(14,"a",1),r._uU(15," contexts"),r.qZA(),r._UZ(16,"hr"),r.qZA(),r.TgZ(17,"igo-map-browser",2),r._UZ(18,"igo-zoom-button",3),r._UZ(19,"igo-geolocate-button",3),r._UZ(20,"igo-rotation-button",4),r.qZA(),r.TgZ(21,"igo-panel",5),r._UZ(22,"igo-context-list",6),r.qZA(),r.TgZ(23,"igo-panel",7),r.TgZ(24,"igo-layer-list",8),r.YNc(25,uC,1,1,"ng-template",null,9,r.W1O),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.xp6(17),r.Q6J("map",t.map),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("map",t.map),r.xp6(1),r.Q6J("map",t.map)("showIfNoRotation",!0),r.xp6(2),r.Q6J("map",t.map),r.xp6(2),r.Q6J("map",t.map))},directives:[g.a8,g.$j,g.n5,g.dn,lu,Uw,Nw,fu,yu,Ou,Bi,vS,bS,Kp,od,Tl],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{margin-bottom:5px}"]}),e})()}]);let dC=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[y.Ed,pC,g.QW,n.ot,a.Ps,ji,rv,md,Ll,dv,Mv,Bh,SS]]}),e})();const hC=[{path:"",redirectTo:"/home",pathMatch:"full"},{path:"**",redirectTo:"/home"}];let gC=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[d.Bz.forRoot(hC,{useHash:!0})],d.Bz]}),e})(),mC=(()=>{class e{constructor(e,t,o){this.changeDetectorRef=e,this.media=t,this.renderer=o,this.title="IGO",this.version=V,this.themeClass="deeppurple-theme",this.mobileQuery=t.matchMedia("(max-width: 600px)"),this._mobileQueryListener=()=>e.detectChanges(),this.mobileQuery.addEventListener("change",this._mobileQueryListener),this.renderer.addClass(document.body,this.themeClass),this.detectOldBrowser()}ngOnDestroy(){this.mobileQuery.removeEventListener("change",this._mobileQueryListener)}detectOldBrowser(){k.satisfies({ie:"<11",chrome:"<64",firefox:"<60"})&&console.log("Very old browser ! ",k.getBrowser())}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(r.sBO),r.Y36(G.vx),r.Y36(r.Qsj))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-root"]],decls:91,vars:8,consts:[[1,"example-container"],["color","primary",1,"example-toolbar"],["mat-icon-button","",3,"click"],["svgIcon","menu"],[1,"example-sidenav-container"],["opened","true","fixedTopGap","56",3,"mode","fixedInViewport"],["snav",""],["mat-list-item","","routerLink","."],["mat-list-item","","routerLink","activity"],["mat-list-item","","routerLink","config"],["mat-list-item","","routerLink","language"],["mat-list-item","","routerLink","media"],["mat-list-item","","routerLink","message"],["mat-list-item","","routerLink","request"],["mat-list-item","","routerLink","auth-form"],["mat-list-item","","routerLink","action"],["mat-list-item","","routerLink","dynamic-component"],["mat-list-item","","routerLink","entity-table"],["mat-list-item","","routerLink","entity-selector"],["mat-list-item","","routerLink","form"],["mat-list-item","","routerLink","table"],["mat-list-item","","routerLink","tool"],["mat-list-item","","routerLink","widget"],["mat-list-item","","routerLink","simple-map"],["mat-list-item","","routerLink","layer"],["mat-list-item","","routerLink","legend"],["mat-list-item","","routerLink","overlay"],["mat-list-item","","routerLink","geometry"],["mat-list-item","","routerLink","feature"],["mat-list-item","","routerLink","hover"],["mat-list-item","","routerLink","measure"],["mat-list-item","","routerLink","draw"],["mat-list-item","","routerLink","query"],["mat-list-item","","routerLink","catalog"],["mat-list-item","","routerLink","search"],["mat-list-item","","routerLink","print"],["mat-list-item","","routerLink","import-export"],["mat-list-item","","routerLink","directions"],["mat-list-item","","routerLink","time-filter"],["mat-list-item","","routerLink","ogc-filter"],["mat-list-item","","routerLink","spatial-filter"],["mat-list-item","","routerLink","workspace"],["mat-list-item","","routerLink","context"]],template:function(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",0),r.TgZ(1,"mat-toolbar",1),r.TgZ(2,"button",2),r.NdJ("click",function(){return r.CHM(e),r.MAs(10).toggle()}),r._UZ(3,"mat-icon",3),r.qZA(),r.TgZ(4,"h1"),r._uU(5),r.qZA(),r.TgZ(6,"h5"),r._uU(7),r.qZA(),r.qZA(),r.TgZ(8,"mat-sidenav-container",4),r.TgZ(9,"mat-sidenav",5,6),r.TgZ(11,"mat-nav-list"),r.TgZ(12,"a",7),r._uU(13,"Home"),r.qZA(),r._UZ(14,"hr"),r.TgZ(15,"a",8),r._uU(16,"Activity"),r.qZA(),r.TgZ(17,"a",9),r._uU(18,"Config"),r.qZA(),r.TgZ(19,"a",10),r._uU(20,"Language"),r.qZA(),r.TgZ(21,"a",11),r._uU(22,"Media"),r.qZA(),r.TgZ(23,"a",12),r._uU(24,"Message"),r.qZA(),r.TgZ(25,"a",13),r._uU(26,"Request"),r.qZA(),r._UZ(27,"hr"),r.TgZ(28,"a",14),r._uU(29,"Authentification"),r.qZA(),r._UZ(30,"hr"),r.TgZ(31,"a",15),r._uU(32,"Action"),r.qZA(),r.TgZ(33,"a",16),r._uU(34,"Dynamic Component"),r.qZA(),r.TgZ(35,"a",17),r._uU(36,"Entity Table"),r.qZA(),r.TgZ(37,"a",18),r._uU(38,"Entity Selector"),r.qZA(),r.TgZ(39,"a",19),r._uU(40,"Form"),r.qZA(),r.TgZ(41,"a",20),r._uU(42,"Table"),r.qZA(),r.TgZ(43,"a",21),r._uU(44,"Tool"),r.qZA(),r.TgZ(45,"a",22),r._uU(46,"Widget"),r.qZA(),r._UZ(47,"hr"),r.TgZ(48,"a",23),r._uU(49,"Simple map"),r.qZA(),r.TgZ(50,"a",24),r._uU(51,"Layer"),r.qZA(),r.TgZ(52,"a",25),r._uU(53,"Legend"),r.qZA(),r.TgZ(54,"a",26),r._uU(55,"Overlay"),r.qZA(),r.TgZ(56,"a",27),r._uU(57,"Geometry"),r.qZA(),r.TgZ(58,"a",28),r._uU(59,"Feature"),r.qZA(),r.TgZ(60,"a",29),r._uU(61,"Hover"),r.qZA(),r.TgZ(62,"a",30),r._uU(63,"Measure"),r.qZA(),r.TgZ(64,"a",31),r._uU(65,"Draw"),r.qZA(),r.TgZ(66,"a",32),r._uU(67,"Query"),r.qZA(),r.TgZ(68,"a",33),r._uU(69,"Catalog"),r.qZA(),r.TgZ(70,"a",34),r._uU(71,"Search"),r.qZA(),r.TgZ(72,"a",35),r._uU(73,"Print"),r.qZA(),r.TgZ(74,"a",36),r._uU(75,"Import/Export"),r.qZA(),r.TgZ(76,"a",37),r._uU(77,"Directions"),r.qZA(),r.TgZ(78,"a",38),r._uU(79,"Time filter"),r.qZA(),r.TgZ(80,"a",39),r._uU(81,"OGC filter"),r.qZA(),r.TgZ(82,"a",40),r._uU(83,"Spatial filter"),r.qZA(),r.TgZ(84,"a",41),r._uU(85,"Workspace"),r.qZA(),r._UZ(86,"hr"),r.TgZ(87,"a",42),r._uU(88,"Context"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(89,"mat-sidenav-content"),r._UZ(90,"router-outlet"),r.qZA(),r.qZA(),r.qZA()}2&e&&(r.ekj("example-is-mobile",t.mobileQuery.matches),r.xp6(5),r.Oqu(t.title),r.xp6(2),r.Oqu(t.version.lib),r.xp6(1),r.Udp("margin-top",t.mobileQuery.matches?56:0,"px"),r.xp6(1),r.Q6J("mode",t.mobileQuery.matches?"over":"side")("fixedInViewport",t.mobileQuery.matches))},directives:[u.Ye,n.lW,a.Hw,c.TM,c.JX,l.Hk,l.Tg,d.yS,c.Rh,d.lC],styles:["h1[_ngcontent-%COMP%]{width:100%;text-align:center;font-size:26px}.example-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:absolute;top:0;bottom:0;left:0;right:0}.example-is-mobile[_ngcontent-%COMP%]   .example-toolbar[_ngcontent-%COMP%]{position:fixed;z-index:2}.example-sidenav-container[_ngcontent-%COMP%]{flex:1}.example-is-mobile[_ngcontent-%COMP%]   .example-sidenav-container[_ngcontent-%COMP%]{flex:1 0 auto}mat-sidenav[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.031)}.example-is-mobile[_ngcontent-%COMP%]   mat-sidenav[_ngcontent-%COMP%]{background-color:#fff}mat-sidenav-content[_ngcontent-%COMP%]{padding:10px}"]}),e})(),fC=(()=>{class e{constructor(e,t){e.addSvgIconSet(t.bypassSecurityTrustResourceUrl("./assets/igo2/core/icons/mdi.svg"))}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(a.jv),r.LFG(i.H7))},e.\u0275mod=r.oAB({type:e,bootstrap:[mC]}),e.\u0275inj=r.cJS({imports:[[i.b2,s.PW,c.SJ,u.g0,n.ot,a.Ps,l.ie,Br,Qr,zr,Vr,Xr,es,os,ss,cs,ps,gs,ys,bs,As,Fs,yn,dw,mw,yw,bw,Sw,Tw,Lw,Fw,Mw,Pw,$w,JS,jS,GS,zS,VS,XS,tC,cC,dC,gC,i.t6]]}),e})();o(58256),Gr.production&&(0,r.G48)(),i.q6().bootstrapModule(fC).catch(e=>console.log(e))},46700:function(e,t,o){var i={"./af":62275,"./af.js":62275,"./ar":90857,"./ar-dz":11218,"./ar-dz.js":11218,"./ar-kw":14754,"./ar-kw.js":14754,"./ar-ly":66680,"./ar-ly.js":66680,"./ar-ma":92178,"./ar-ma.js":92178,"./ar-sa":56522,"./ar-sa.js":56522,"./ar-tn":95682,"./ar-tn.js":95682,"./ar.js":90857,"./az":70164,"./az.js":70164,"./be":79774,"./be.js":79774,"./bg":60947,"./bg.js":60947,"./bm":21832,"./bm.js":21832,"./bn":89650,"./bn-bd":74477,"./bn-bd.js":74477,"./bn.js":89650,"./bo":66005,"./bo.js":66005,"./br":98492,"./br.js":98492,"./bs":70534,"./bs.js":70534,"./ca":52061,"./ca.js":52061,"./cs":84737,"./cs.js":84737,"./cv":61167,"./cv.js":61167,"./cy":77996,"./cy.js":77996,"./da":9528,"./da.js":9528,"./de":14540,"./de-at":49430,"./de-at.js":49430,"./de-ch":67978,"./de-ch.js":67978,"./de.js":14540,"./dv":83426,"./dv.js":83426,"./el":6616,"./el.js":6616,"./en-au":63816,"./en-au.js":63816,"./en-ca":32162,"./en-ca.js":32162,"./en-gb":83305,"./en-gb.js":83305,"./en-ie":61954,"./en-ie.js":61954,"./en-il":43060,"./en-il.js":43060,"./en-in":59923,"./en-in.js":59923,"./en-nz":13540,"./en-nz.js":13540,"./en-sg":16505,"./en-sg.js":16505,"./eo":41907,"./eo.js":41907,"./es":86640,"./es-do":41246,"./es-do.js":41246,"./es-mx":56131,"./es-mx.js":56131,"./es-us":36430,"./es-us.js":36430,"./es.js":86640,"./et":62551,"./et.js":62551,"./eu":32711,"./eu.js":32711,"./fa":54572,"./fa.js":54572,"./fi":33390,"./fi.js":33390,"./fil":87860,"./fil.js":87860,"./fo":48216,"./fo.js":48216,"./fr":99291,"./fr-ca":98527,"./fr-ca.js":98527,"./fr-ch":58407,"./fr-ch.js":58407,"./fr.js":99291,"./fy":47054,"./fy.js":47054,"./ga":49540,"./ga.js":49540,"./gd":73917,"./gd.js":73917,"./gl":51486,"./gl.js":51486,"./gom-deva":56245,"./gom-deva.js":56245,"./gom-latn":48868,"./gom-latn.js":48868,"./gu":59652,"./gu.js":59652,"./he":89019,"./he.js":89019,"./hi":42040,"./hi.js":42040,"./hr":63402,"./hr.js":63402,"./hu":79322,"./hu.js":79322,"./hy-am":27609,"./hy-am.js":27609,"./id":57942,"./id.js":57942,"./is":98275,"./is.js":98275,"./it":73053,"./it-ch":4378,"./it-ch.js":4378,"./it.js":73053,"./ja":46176,"./ja.js":46176,"./jv":679,"./jv.js":679,"./ka":92726,"./ka.js":92726,"./kk":72953,"./kk.js":72953,"./km":86957,"./km.js":86957,"./kn":59181,"./kn.js":59181,"./ko":47148,"./ko.js":47148,"./ku":27752,"./ku.js":27752,"./ky":65675,"./ky.js":65675,"./lb":41263,"./lb.js":41263,"./lo":65746,"./lo.js":65746,"./lt":11143,"./lt.js":11143,"./lv":38753,"./lv.js":38753,"./me":44054,"./me.js":44054,"./mi":31573,"./mi.js":31573,"./mk":30202,"./mk.js":30202,"./ml":68523,"./ml.js":68523,"./mn":79794,"./mn.js":79794,"./mr":56681,"./mr.js":56681,"./ms":56975,"./ms-my":39859,"./ms-my.js":39859,"./ms.js":56975,"./mt":3691,"./mt.js":3691,"./my":5152,"./my.js":5152,"./nb":7607,"./nb.js":7607,"./ne":21526,"./ne.js":21526,"./nl":86368,"./nl-be":40076,"./nl-be.js":40076,"./nl.js":86368,"./nn":68420,"./nn.js":68420,"./oc-lnc":51906,"./oc-lnc.js":51906,"./pa-in":94504,"./pa-in.js":94504,"./pl":54721,"./pl.js":54721,"./pt":74645,"./pt-br":54548,"./pt-br.js":54548,"./pt.js":74645,"./ro":71977,"./ro.js":71977,"./ru":26042,"./ru.js":26042,"./sd":78849,"./sd.js":78849,"./se":27739,"./se.js":27739,"./si":50084,"./si.js":50084,"./sk":92449,"./sk.js":92449,"./sl":23086,"./sl.js":23086,"./sq":33139,"./sq.js":33139,"./sr":30607,"./sr-cyrl":30063,"./sr-cyrl.js":30063,"./sr.js":30607,"./ss":40131,"./ss.js":40131,"./sv":21665,"./sv.js":21665,"./sw":5642,"./sw.js":5642,"./ta":33622,"./ta.js":33622,"./te":74825,"./te.js":74825,"./tet":48336,"./tet.js":48336,"./tg":39238,"./tg.js":39238,"./th":99463,"./th.js":99463,"./tk":39986,"./tk.js":39986,"./tl-ph":29672,"./tl-ph.js":29672,"./tlh":40043,"./tlh.js":40043,"./tr":51212,"./tr.js":51212,"./tzl":50110,"./tzl.js":50110,"./tzm":80482,"./tzm-latn":38309,"./tzm-latn.js":38309,"./tzm.js":80482,"./ug-cn":42495,"./ug-cn.js":42495,"./uk":54157,"./uk.js":54157,"./ur":80984,"./ur.js":80984,"./uz":64141,"./uz-latn":43662,"./uz-latn.js":43662,"./uz.js":64141,"./vi":12607,"./vi.js":12607,"./x-pseudo":66460,"./x-pseudo.js":66460,"./yo":92948,"./yo.js":92948,"./zh-cn":62658,"./zh-cn.js":62658,"./zh-hk":39352,"./zh-hk.js":39352,"./zh-mo":38274,"./zh-mo.js":38274,"./zh-tw":98451,"./zh-tw.js":98451};function r(e){var t=s(e);return o(t)}function s(e){if(!o.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}r.keys=function(){return Object.keys(i)},r.resolve=s,e.exports=r,r.id=46700},50257:function(e){"use strict";e.exports=JSON.parse('{"igo":{"auth":{"accessAnonymous":"Access as anonymous","connection":"Connection","login":"Login","password":"Password","signOut":"Sign out","user":"User","welcome":"Welcome {{name}}!","deconnection":"You are logged out.","home":"Return to the home page","error":{"Password expired":"Password expired","Maximun logins exceeded":"Maximum logins exceeded","Login lockout":"Maximum number of attempts exceeded. Your account is locked.","Wrong password":"Wrong password","Invalid username":"Invalid username"},"microsoft":{"login":"Sign in with Azure account"},"microsoftb2c":{"login":"Sign in"}}}}')},35488:function(e){"use strict";e.exports=JSON.parse('{"igo":{"common":{"confirmDialog":{"cancelBtn":"Cancel","confirmBtn":"Confirm","title":"Confirm"},"table":{"filter":"Filter"},"entity-table":{"targetHtmlUrl":"Open the external link"},"form":{"errors":{"required":"This field is required"}},"actionbar":{"scrollUp":"Scroll up","scrollDown":"Scroll down","icon":"Action list"},"interactiveTour":{"tooltipTourToolButton":"Interactive tour of the application","disaledTooltipTourToolButton":"To have access to this tool\'s tour, add contexts or layers","buttonTitle":"Discover","exitButton":"Exit","backButton":"Back","nextButton":"Next"},"paginator":{"firstPageLabel":"First page","itemsPerPageLabel":"Items per page:","lastPageLabel":"Last page","nextPageLabel":"Next page","previousPageLabel":"Previous page","of":"of"}}}}')},88952:function(e){"use strict";e.exports=JSON.parse('{"igo":{"context":{"bookmarkButton":{"create":"Create a new context","dialog":{"createMsg":"The context \'{{value}}\' was created","createTitle":"Context created","placeholder":"Title","title":"New context"}},"contextManager":{"clone":"Clone this context","delete":"Delete this context","dialog":{"cloneMsg":"The context \'{{value}}\' was cloned","cloneTitle":"Context cloned","copyMsg":"Text copied","copyTitle":"Context ID","confirmDelete":"Are you sure you want to delete this context?","deleteMsg":"The context \'{{value}}\' was deleted","deleteTitle":"Context deleted","favoriteMsg":"The context \'{{value}}\' was set as favorite","favoriteTitle":"Favorite saved","saveMsg":"The context \'{{value}}\' was saved","saveTitle":"Context saved"},"edit":"Edit this context","errors":{"uncaught":{"message":"Sorry, service is currently not available. Please try again later","title":"Error server"},"addPermission":"The permission you are trying to add is already in the context.","addPermissionEmpty":"The permission you are trying to add is not valid","addPermissionTitle":"Add permission error"},"favorite":"Set as favorite context","form":{"copy":"Copy the context ID","edit":"Save","title":"Title","titleRequired":"Title required","uri":"ID","uriRequired":"ID required"},"invalid":{"text":"Context \'{{value}}\' is invalid. The default context was loaded.","title":"Invalid context"},"managePermissions":"Manage permissions context","manageTools":"Manage tools context","ourContexts":"Our contexts","publicContexts":"Public contexts","save":"Save this context","sharedContexts":"Shared contexts","filterPlaceHolder":"Filter by name","sortAlphabetically":"Sort alphabetically","sortContextOrder":"Replace according to the creation date","userAccount":"User account","filterUser":"Filter by user group","emptyContext":"Empty context","emptyContextTooltip":"Create a new empty context","contextMap":"Context from map","contextMapTooltip":"Create a new context from map layers","hide":"Hide this context","show":"Show up this context","showHidden":"Show hidden contexts"},"contextImportExport":{"export":{"exportPlaceHolder":"Layers","exportContextName":"Context name","exportSelectAll":"Select all","success":{"text":"Context has been exported.","title":"Context export success"},"nothing":{"text":"No context could be exported.","title":"Nothing to export"},"failed":{"text":"Failed to export","title":"Failed to export context"}},"import":{"success":{"title":"Imported context","text":"The context \'{{value}}\' was added to the map"},"empty":{"text":"The context \'{{value}}\' contained nothing that could be imported.","title":"Nothing to import"},"invalid":{"text":"The context \'{{value}}\' is invalid.","title":"Invalid context"},"unreadable":{"title":"Unreadable context","text":"The context \'{{value}}\' is unreadable"},"tooLarge":{"text":"The context \'{{value}}\' is too large (Max: {{size}} MB)","title":"Context too large"}}},"permission":{"addBtn":"Add","delete":"Remove permission","dialog":{"addMsg":"The permission \'{{value}}\' was added","addTitle":"Permission added","deleteMsg":"The permission \'{{value}}\' was removed","deleteTitle":"Permission removed","scopeChangedMsg":"The scope was changed to {{value}}","scopeChangedTitle":"Scope changed"},"profil":"Profil","user":"User or group","profilRequired":"Profil required","read":"Read only","readOnlyTitle":"Read-only context","readOnlyMsg":"You can only revoke permission if the context is shared directly to your username.","scope":{"private":"Private","protected":"Protected","shared":"Shared","public":"Public"},"write":"Read and Write"},"poiButton":{"create":"Create a new zone of interest","dialog":{"confirmDelete":"Are you sure you want to delete this zone of interest?","createMsg":"The zone of interest \'{{value}}\' was created","createTitle":"Zone of interest created","deleteMsg":"The zone of interest \'{{value}}\' was deleted","deleteTitle":"Zone of interest deleted","placeholder":"Title","title":"New zone of interest"},"placeholder":"Zones of interest"},"sidenav":{"goBack":"Go Back","mainMenu":"Main Menu"},"shareMap":{"button":"Share map","refreshBtn":"Refresh sharing","copy":"Copy to clipboard","shareWithApi":"Share by context","shareWithUrl":"Share by url","dialog":{"copyMsg":"Link copied to clipboard","copyTitle":"Link"},"errorTitle":"Share Map error","placeholderLink":"Link","included":"Included in shared URL :","context":"The context when creating the sharing link.","center":"The coordinates of the center of the map (longitude, latitude).","zoom":"The zoom level of the map.","addedLayers":"The layers added by the catalog or by the search bar.","visibleInvisible":"Visibility status of layers.","excluded":"Excluded in the shared URL :","order":"The order of the layers.","opacity":"Modifications made to the opacity of the layers.","filterOgc":"Additions / modifications made to filters by attribute.","filterTime":"The current value for time filters."},"tool":{"dialog":{"addMsg":"The tool \'{{value}}\' was added","addTitle":"Tool added","deleteMsg":"The tool \'{{value}}\' was removed","deleteTitle":"Tool removed"}},"userButton":{"dialog":{"email":"Email","expiration":"Expiration","user":"User","clearPreferences":"Clear my preferences"},"infoTitle":"User info","logout":"Logout"}}}}')},63154:function(e){"use strict";e.exports=JSON.parse('{"igo":{"core":{"errors":{"uncaught":{"message":"Sorry, service is currently not available. Please try again later","title":"Error server"}},"network":{"online":{"message":"Online","title":"Status:"},"offline":{"message":"Offline","title":"Status:"}}}}}')},10711:function(e){"use strict";e.exports=JSON.parse('{"igo":{"geo":{"catalog":{"layer.addToMap":"Add to map","layer.addToMapOutRange":"Add to map. The layer is not visible at the current scale. Please zoom in/out","layer.removeFromMap":"Remove from map","layer.removeFromMapOutRange":"Remove from map. The layer is not visible at the current scale. Please zoom in/out","group.addToMap":"Add all layers from this group to map","group.removeFromMap":"Remove all layers from this group to map","baseLayers":"Baselayers","unavailableTitle":"Catalog unavailable","unavailable":"The catalog \'{{value}}\' is unavailable at the moment or you don\'t have the required permissions.","someUnavailable":"Some of the layers from the current catalog are unavailable at the moment or you don\'t have the required permissions.","externalProvider":{"catalog":"This catalog comes from an external organization.","group":"This layers comes from an external organization.","layer":"This layer comes from an external organization.","unavailableWithEmail":"The catalog \'{{value}}\' is unavailable at the moment. To add an external service to the predefined list, please contact us at {{emailAddress}}. Delays can apply if problems occurs with the provider."},"library.add":"Add this catalog to the list","library.cancel":"Cancel","library.remove":"Remove this catalog from the list","library.inlist":{"title":"Catalog already contained","message":"The catalog is already contained in the list."},"library.addTitle":"Adding a catalog","library.addBtn":"Add a catalog"},"clickOnMap":{"clickedFeature":"Clicked Feature"},"baselayersSwitcher":{"title":"Basemaps"},"dataSource":{"unavailableTitle":"Layer unavailable","optionsApiUnavailable":"Layer information could not be retrieved. Some layers may not present the correct information.","unavailable":"The layer \'{{value}}\' is unavailable at the moment or you don\'t have the required permissions."},"dropGeoFile":{"invalid":{"text":"The file \'{{value}}\' is invalid ({{mimeType}})","title":"Invalid file"},"empty":{"text":"The file \'{{value}}\' contained nothing that could be imported.","title":"Nothing to import"},"success":{"text":"Imported file","title":"The layer \'{{value}}\' was added to the map"},"unreadable":{"text":"Unreadable file","title":"The file \'{{value}}\' is unreadable"},"tooLarge":{"text":"The file \'{{value}}\' is too large (Max: {{size}} MB)","title":"File too large"},"invalidSRS":{"text":"The projection is valid. It must start with EPSG:","title":"Invalid projection"},"ogreServer":{"title":"Ogre server error 500","text":"Error in convert to geojson. Maybe file is too big, try to import that file in geojson format"}},"export":{"customList":{"text":"Some of the selected layers ( {{value}} ) limit the format\'s list","title":"Restricted list of formats"},"nothing":{"text":"No feature could be exported.","title":"Nothing to export"},"noFormat":{"text":"No export format valid for all selected layers. Please export the layers one at a time.","title":"No valid format"},"failed":{"text":"Failed to export","title":"Failed to export features"},"popupBlocked":{"text":"</br>Enable the popup in your browser. </br>For Chrome and Edge, on the right into the Address Bar.</br>{{extraMessage}}","selectAgain":"Fix it and re-select an output format.","retry":"Please retry to export","title":"Popup blocked by your browser"},"success":{"text":"Features have been exported.","title":"Features export success"},"format":{"GeoJSON":"GeoJSON","GML":"GML","GPX":"GPX","KML":"KML","Shapefile":"Shapefile","CSVcomma":"CSV (comma delimited)","CSVsemicolon":"CSV (Excel compatible)","URL":"External link"},"gpx.error.poly":{"title":"GPX error","text":"GPX format do now allow polygon features"},"encoding":{"LATIN1":"LATIN-1","UTF8":"UTF-8"}},"importExportForm":{"exportButton":"Export","exportButtonLink":"Open the link","exportButtonLinks":"Open the links","exportCircleToPolygon":"Transform Circle entities in polygons","exportFormatPlaceholder":"Format","exportLayerPlaceholder":"Layer","exportFileNamePlaceholder":"Filename","encodingPlaceholder":"Encoding","exportTabTitle":"Export","exportFeatureInExtent":"Export only features in map extent","exportNoLayersExportable":"There is no exportable layer in your map","exportSelectedFeature":"Export only selected features","importButton":"Import","importProjPlaceholder":"Coordinate system of the file to import","importTabTitle":"Import","importClarifications":"Clarifications","importSizeMax":"The file size limit is {{size}} Mb","importFormatAuthorized":"Formats authorized: geojson, kml, gpx, gml, shapefile","importShpZip":"Shapefiles must be zipped AND geometries stored in Latitude Longitude coordinate (EPSG:4326/WGS:84)","other":"other","others":"others","projections":{"mtm":"MTM zone {{zone}} ({{code}})","utm":"UTM zone {{zone}} ({{code}})","webMercator":"Web Mercator ({{code}})","nad83":"Lat-Long NAD83 ({{code}})","wgs84":"Lat-Long WGS84 ({{code}})","choose":"You must choose a projection for your input file."}},"operators":{"caseSensitive":"Case sensitive","And":"And","Or":"Or","PropertyIsEqualTo":"=","PropertyIsNotEqualTo":"!=","PropertyIsLike":"\u2248","PropertyIsGreaterThan":">","PropertyIsGreaterThanOrEqualTo":">=","PropertyIsLessThan":"<","PropertyIsLessThanOrEqualTo":"<=","PropertyIsBetween":"between","During":"during (temporal)","PropertyIsNull":"is null","Intersects":"intersects (spatial)","Within":"within (spatial)","Contains":"contains (spatial)","tooltip":{"And":"Logical operator between filters where both conditions must be true","Or":"Logical operator between filters where at least one (1) condition must be true","PropertyIsEqualTo":"Identical (case sensitive)","PropertyIsNotEqualTo":"Different(case sensitive)","PropertyIsLike":"Like Example: *road* Finds any values that have \'road\' in any position. road* Finds any values that begin by \'road\'. wildCard =\'*\', singleChar = \'.\' escapeChar = \'!\' (case sensitive)","PropertyIsGreaterThan":"Greater than","PropertyIsGreaterThanOrEqualTo":"Greater than or equal to ","PropertyIsLessThan":"Lesser than","PropertyIsLessThanOrEqualTo":"Lesser than or equal to","PropertyIsBetween":"Apply a range check between the lower and upper boundary (values are included)","During":"Apply a range check for time attributes","PropertyIsNull":"Return features where the attribute is null","Intersects":"Return features in geometric intersection with the provided geometry","Within":"Return feature which are completely contained by the provided geometry","Contains":"Return feature completely containing by the provided geometry"}},"sourceFields":{"selectField":"Choose a field"},"filter":{"resetFilters":"(Apply no filters)","addFilter":"Add an empty filter to the current list","removeFilter":"Remove the current filter from the filters\'s list","toggleFilterState":"Enable/disable the current filter","refreshFilters":"Update this datasource with the active filter(s). To enable this button, the layer must be visible (or in the defined scale ranges) or you must modify the current filter.","layerFiltered":"This layer is currently filtered","layerFilterable":"This layer is filterable","filterBy":"Filter by","advancedOgcFilters":"Advanced filters","displayMoreResults":"Display more (+)","displayLessResults":"Display less (-)","placeholder":"Enter a value","placeholderSnrc":"Ex: 21L14","selectOperator":"Select an operator","sliderModeTitle":"Time slider","reportingDate":"Reporting date"},"spatialSelector":{"fixedExtent":"Fixed extent","btnSetExtent":"Define the extent of the spatial filter to the current view","snrc":"SNRC","selectFeature":"","drawFeature":""},"layer":{"hideLayer":"Hide Layer","lowerLayer":"Bring layer backward","hideSelectedLayers":"Hide selected layers","filterLowerLayer":"The backward movement is always done according to the order of the map!","filterPlaceholder":"Filter the layers list","activateSelectionMode":"Activate multiple selection mode","deactivateSelectionMode":"Deactivate multiple selection mode","tools":"Tools","selectAll":"Select all layers","deselectAll":"Deselect all layers","zoomLayer":"Zoom To Layer Extents","zoomLayers":"Zoom To Selected Layers Extents","opacity":"Opacity","raiseLayer":"Bring layer forward","filterRaiseLayer":"The forward movement is always done according to the order of the map!","moreOptions":"Layer\'s tools","removeLayer":"Remove this layer from the map","removeSelectedLayers":"Remove selected layers from the map","removeSelectedLayersRestriction":"Some selected layers cannot be removed","showFeaturesList":"Show features list","showLayer":"Show Layer","showSelectedLayers":"Show selected layers","subsetLayersListKeyword":"Subset the layers\'s list by title or type (wms, wfs,...)","deleteKeyword":"Delete the keyword","subsetLayersListOnlyVisible":"Subset the layers\'s list by visibility","subsetLayersListOnlyInRange":"Subset the layers\'s list by resolution range","sortAlphabetically":"Sort the layers\'s list alphabetically","sortMapOrder":"Sort the layers\'s list based on layer\'s order on the map","resetLayersList":"Remove the current applied filter to layers\'s list","trackFeature":"Track the feature","legend":{"default":"Default","loadingLegendText":"Loading legend","noLegendText":"No legend available for this layer","noLegendScale":"No legend available for this scale","selectStyle":"Select the style of the legend","showAll":"Show all legends (non visible and out of range)","noLayersVisibleWithShowAllButton":"No layer currently visible. Activate the button above to see all the legends.","noLayersVisibleWithShowAllButtonButZoom":"No layer currently visible. If you zoom in the map, some layers will appear OR activate the button above to see all the legends.","noLayersVisible":"No layers currently visible.","noLayersVisibleButZoom":"No layers currently visible. However, if you zoom in the map, some layers will appear."}},"download":{"action":"Download data","title":"Downloading file","start":"Started. Check the download progression in your browser","end":"Completed"},"mapButtons":{"baselayerSwitcher":"Change base layer","geolocate":"Geolocate","offline":"Offline mode","online":"Online mode","zoomIn":"Zoom in ({{zoom}})","zoomOut":"Zoom out ({{zoom}})","resetRotation":"Set map to north","tipRotation":"Hold Alt and SHIFT while dragging on map to rotate the map."},"metadata":{"show":"Show metadata"},"printForm":{"corsErrorMessageBody":"Unable to print due to non-owned access rights","corsErrorMessageHeader":"Print","comment":"Comment","doZipFile":"Zip file","outputFormat":"Output format","paperFormat":"Paper format","paperFormats":{"A0":"33.1 X 46.8\\" (A0)","A1":"23.4 X 33.1\\" (A1)","A2":"16.5 X 23.5\\" (A2)","A3":"11.7 X 16.5\\" (A3)","A4":"8.3 X 11.7\\" (A4)","A5":"5.8 X 8.3\\" (A5)","Letter":"Letter","Legal":"Legal"},"imageFormat":"Image format","orientation":"Orientation","landscape":"Landscape","portrait":"Portrait","projection":"Projection","resolution":"Resolution","saveBtn":"Save","scale":"Scale","showProjection":"Show projection","showScale":"Show scale","title":"Title","subtitle":"Subtitle","legendPosition":"Legend Position","legendPositions":{"none":"No legend","topleft":"Top left corner of the map","topright":"Top right corner of the map","bottomleft":"Bottom left corner of the map","bottomright":"Bottom right corner of the map","newpage":"On a new page"}},"directionsForm":{"stopLayer":"Directions - stops","routeLayer":"Directions - route","start":"Start","intermediate":"Intermediate","end":"End","directionsBtn":"Get route","resetDirectionsBtn":"Reset","zoomRoute":"Zoom on route","null":"","directions":"Directions","raiseStop":"Raise stop\'s priority","lowerStop":"Lower stop\'s priority","addStop":"Add a stop","clearStop":"Clear this stop","moveStop":"Move this stop","removeStop":"Remove this stop","drivingOptions":"Options","summary":"Direction\'s summary","stopsList":"Stops\'s list","instructions":"Instructions","copy":"Copy directions","geolocate":"Use current localisation as stop","link":"Link","dialog":{"copyMsg":"Directions copied to clipboard","copyMsgLink":"Link for directions copied to clipboard","copyTitle":"Directions"}},"directions":{"uturn":"u-turn","sharp right":"sharp right","right":"right","slight right":"slightly on right","sharp left":"sharp left","left":"left","slight left":"slightly on left","straight":"forward","turn":{"straight":"Continue on {{route}}","uturn":"Make u-turn on {{route}}","else":"Turn {{translatedModifier}} onto {{route}}"},"new name":"Head {{translatedDirection}} on {{route}}","depart":"Head {{translatedDirection}} on {{route}}","arrive":{"lastStep":"You have reached your destination {{coma}} {{aggregatedDirection}}","intermediate":"You have reached the intermediate stop onto {{route}}"},"merge":"Continue on {{route}}","on ramp":"Take the ramp {{aggregatedDirection}}","off ramp":"Take exit {{aggregatedDirection}}","fork":{"left":"Merge left onto {{route}}","right":"Merge right onto {{route}}","else":"Continue on {{route}}"},"end of road":"At the end of the road, turn {{translatedModifier}} onto {{route}}","use lane":"Take the lane ...","continue":{"notUturn":"Continue on {{route}}"},"roundabout":"At the roundabout, take the {{exit}}{{cntSuffix}} exit towards {{route}}","rotary":"Roundabout rotary ...","roundabout turn":"Roundabout, take the ...","exit roundabout":"Continue to {{route}}","notification":"notification ...","uturnText":"Make u-turn and head {{translatedDirection}} on {{route}}","unknown":"???","cntSuffix":{"first":"st","secondAndMore":"rd"},"modifier":{"prefix":"on the "}},"cardinalPoints":{"n":"north","ne":"northeast","e":"east","se":"southeast","s":"south","sw":"southwest","w":"west","nw":"northwest"},"search":{"placeholder":"Search for a localisation or a layer","emptyType.placeholder":"Please choose a search type","feature.title":"Localisation","feature.placeholder":"Search for a place localisation","layer.title":"Layer","layer.placeholder":"Search for a layer","ichercheReverse.name":"Search by coordinates","ilayer":{"name":"Layers","properties":{"abstract":"Abstract","groupTitle":"Group","title":"Title","type":"Type","url":"URL","metadataUrl":"Metadata","name":"Layer name","urlInfo":"URL - WMS/WFS","downloadUrl":"Data download"},"type":{"layer":"Layer","groupLayer":"Group of layers"}},"nominatim":{"type":{"food":"Food","health":"Health","entertainment":"Entertainment","finance":"Finance"},"country":{"all":"The world","canada":"Canada"}},"icherche":{"name":"iCherche","type":{"address":"Address","oldAddress":"Old address","district":"District","postalCode":"Postal Code","city":"City","oldCity":"Old city","mrc":"MRC","regadmin":"Administrative Region","road":"Road","intersection":"Intersection","place":"Place","exit":"Highway exit","cn":"CN mark","gcc":"Coast Guard mark (CCG)","sumi":"SUMI mark","km":"Mileage mark","hq":"Hydro-Quebec","entreprise":"Entreprise","cadastre":"Cadastre"},"restrictExtent":{"map":"\xc0 l\'\xe9tendue de la carte","quebec":"Au Qu\xe9bec"}},"coordinates":{"name":"Coordinates","coord":"Geographic (longitude, latitude)","coordDMS":"Geographic (longitude, latitude) (DMS)","radius":"Radius","conf":"Confidence"},"menu.tooltip":"Search Options","settings":{"title":"Settings"},"pointerSearchSummary":{"title":"Pointer position","tooltip":"Based on every search source, show the summary of the pointer location. Use F2 to activate/deactivate."},"searchResultsGeometry":{"title":"Show results geometries","tooltip":"Hide/ show the results geometries "},"searchSources":{"selectAll":"Select All","unselectAll":"Unselect All","settings":{"results type":"Results type","ecmax":"Maximum deviation","radius":"Search radius","results limit":"Number of results","multiple object":"Multiple object","restrictExtent":"Restrict the extent","selectAll":"Select All","unselectAll":"Unselect All","true":"Yes","false":"No"}},"displayMoreResults":"Display more results"},"geometry":{"geometry":"Geometry","point":"Point","line":"Line","polygon":"Polygon"},"targetHtmlUrl":"Open the external link","searchByCoord":"Search by coordinates","searchByName":"Search by name","seeRouting":"See routing","timeFilter":{"date":"Date","endDate":"End Date","startDate":"Start Date","hour":"Hour","minute":"Minute","endYear":"End Year","startYear":"Start Year"},"spatialFilter":{"spatialFilter":"Spatial filter","predefined":"Predefined Zone","draw":"Draw","polygon":"Polygon","point":"Circle","drawPolygon":"Draw a polygon","drawCircle":"Draw a circle","searchLabel":"Search by","buffer":"Buffer","search":"Search","drawControl":"Activate draw control","listLabel":"Zone","layer":"Layer","goSearch":"Launch research","removeLayer":"Remove results","exportLayer":"Export results","clearForm":"Remove draw","clearSearch":"Reset field","Address":"Addresses","Thematics":"Thematics","searchResults":"Search Results","type":"Type","radius":"Radius","radiusAlert":"Radius must be between 0 and 100 kilometers (or 100 000 meters)","bufferAlert":"Buffer must be between 0 and 100 kilometers (or 100 000 meters)","maxSizeAlert":"Search results number exceeds 10000. Some may be missing.","zeroResults":"There are no results for this search.","warning":"Warning","freehandControl":"Freehand","group":{"toponyme":"Toponym","culturel":"Cultural","education":"Education","sante":"Health","securite":"Security","sepaq":"SEPAQ","transport":"Transportation"}},"terrapi":{"AdmRegion":"Administratives region","Mun":"Municipalities","Arrond":"Boroughs","CircFed":"Federals districts","CircProv":"Provincials districts","DirReg":"Regionals directorates","MRC":"RCM","RegTour":"Touristics regions","limites":"Administrative boundaries","bornes":"Landmarks","hydro":"Hydrography","routes":"Roads","bati":"Buildings","batiment":"Buildings","camping":"Camping","equipement":"Equipment","commun":"Public","geographie":"Natural sites","parc":"Parks","secteur":"Sector","immeubles":"Tenement","sites":"Cultural sites","cpe":"Children\'s education center","public":"Public schools","prive":"Private school","gouvernemental":"Government schools","colleges":"Colleges","universites":"University","aine":"Residences for seniors","ambulance":"Ambulance zones","clinique":"Clinics","etabl":"Health institutions","gmf":"Family doctors group","naissance":"Birth house","pharmacie":"Pharmacy","casernes":"Fire stations","correctionnel":"Correctional centres","organisme":"Security organization","palais-justice":"Courthouses","penitencier-fed":"Federal penitentiaries","penitencier-prov":"Provincial penitentiaries","polices":"Police station"},"measure":{"dialog":{"title":"Sum of the selection","length.title":"Length","area.title":"Area","lengthInMeters":"m","lengthInKilometers":"km","lengthInMiles":"mi","lengthInFeet":"ft","areaInSquareMeters":"m\xb2","areaInSquareKilometers":"km\xb2","areaInSquareMiles":"mi\xb2","areaInHectares":"ha","areaInAcres":"ac","perimeterInMeters":"Perimeter in meters"},"layerTitle":"Measure on map","area":"Area","areaHeader":"Area","length":"Length","lengthHeader":"Length / Perimeter","perimeter":"Perimeter","meters":"m","m":"m","kilometers":"km","km":"km","miles":"mi","mi":"mi","feet":"ft","ft":"ft","squareMeters":"m\xb2","m\xb2":"m\xb2","squareKilometers":"km\xb2","km\xb2":"km\xb2","squareMiles":"mi\xb2","mi\xb2":"mi\xb2","squareFeet":"ft\xb2","ft\xb2":"ft\xb2","hectares":"ha","ha":"ha","acres":"ac","ac":"ac","toggleActive":"Activate measures","toggleDisplayLines":"Display distances of lines","toggleDisplayDistance":"Display distances of areas","toggleDisplayAreas":"Display areas","toggleAutoUnits":"Auto Units","actionbar":{"calculate.tooltip":"Totals & Conversions","delete.tooltip":"Delete","modify.tooltip":"Modify"}},"draw":{"abort":"Abort current drawing","cancelColorPicker":"Cancel","Circle":"Circle","colorPicker":"Click to open the color picker","dialogInstruction":"Enter your draw\'s label","dialogTitle":"Label","delete":"Remove Drawings from map","drawing":"Draws","fill":"Fill","finish":"Finish current drawing","icon":"Icons","labels":"Labels","LineString":"Line","move":"Center view on cursor","noIcon":"No icon","noLabel":"No label","Point":"Point","Polygon":"Polygon","radius":"Radius","shortcuts":"Keyboard shortcuts","stroke":"Stroke","styleSelect":"Select style","toggleMapTooltips":"Show map tooltips","undo":"Remove last vertex"},"network":{"online":{"message":"Online","title":"Status:"},"offline":{"message":"Offline","title":"Status:"}},"workspace":{"inMapExtent.active.tooltip":"Ne montrer que les entit\xe9s contenues dans la carte","inMapExtent.inactive.tooltip":"Montrer tous les entit\xe9s"}}}}')},32766:function(e){"use strict";e.exports=JSON.parse('{"igo":{"integration":{"tools":{"catalog":"Catalog","contexts":"Contexts","directions":"Directions","draw":"Draw","importExport":"Import & Export","ogcFilter":"Filter by","map":"Map","layers":"Layers","legend":"Legend","measurer":"Measure","print":"Print","searchResults":"Search Results","shareMap":"Share","timeFilter":"Time Filter","about":"About","spatialFilter":"Spatial Filter","advancedMap":"Advanced map tools"},"searchResultsTool":{"noResults":"No results","doSearch":"Do a search in the search bar.","examples":"<b>Allow to search addresses, location, coordinates and layers</b>.<br><br><u>Adresses</u> research can be done with a combination of : <ul><li>building number</li><li>street name</li><li>city name</li><li>postal code</li></ul> Examples for <u>locations</u>: <ul><li>Lac Poulin</li><li>Mcdo L\xe9vis</li><li>Saint-Isidore</li></ul> You can also use keywords to refine your search. Examples: <ul><li>#mun qu\xe9bec (to search municipalities)</li><li>#sante L\xe9vis (to search health establishments)</li><li>#cpe joyeux (to search nurseries)</li><li>#intersection li\xe9gois + \xe9glise (to search an intersection, the #+ can also be used)</li></ul>*Keywords appear when hovering results type in search settings tab -> iCherche -> Results type.<br><br><u>Coordinates</u> examples :<ul><li>Decimal degree (-68.165547, 48.644546)</li><li>Degrees, minutes, seconds (-68 9 56, 48 38 40)</li><li>Degree, minutes, decimal (-68 9.56, 48 38.40)</li><li>Projected (UTM-19 561466.861, 5388278.862)</li><li>BELL (Lat: 48 38 40N Long: 68 9 56W UNC:100 CONF:90)</li><li>Meter Meter (111594.63, 445854.74;32198)</li></ul>For more informations on coordinate\'s research : <a href=\'https://igo2.readthedocs.io/fr/next/properties.html#coordonnees\' target=\'_blank\'>Consult IGO2\'s documentation</a>","zoomOnFeatureTooltip":"Zoom on selected feature.","zoomOnFeatureTooltipOutOfView":"The feature is out of view. Zoom on selected feature."},"aboutTool":{"headerHtml":"","html":"<style>#about .bold_class{font-weight: bold;}#about .red{color: red;}#about .tool_name{border-top: 1px solid; padding-top: 10px;}#about .titre_outil{font-weight: bold; font-size: 18px; padding-bottom: 8px;}#about .subtitle{font-size: 20px; padding-bottom: 10px;}#about .align_right{text-align: right;}#about .describe{text-align: justify;}#about a img{color: black; text-decoration: none;}</style><body> <div id=\'about\'> <div class=\'bold_class subtitle\'>Features overview</div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z\'> </path> </svg></mat-icon> Search Bar </div><div class=\'describe\'>Located in the upper-left portion of the interface, the <span class=\'bold_class\'>Search Bar</span> allows the user to locate an area of interest using an address, location or GPS coordinates. It can also be used to search for a layer. <br><br> It is also possible to search for a specific element using the hashtag \\"#\\" (for example, #municipalites qu\xe9bec). Accents and capital letters don\'t have any impact on <span class=\'bold_class\'>Search Results</span> when using a hashtag. </div></div><br><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z\'></path> </svg></mat-icon> Contexts </div><div class=\'describe\'> <span class=\'bold_class\'>Contexts</span> are used to visualize groupings of layers related to a specific theme. When a context is selected, all the layers associated with it will be added to the <span class=\'bold_class\'>Map</span>. It is then possible to add other layers to the map by using the <span class=\'bold_class\'>Catalog</span> or the <span class=\'bold_class\'>Search Bar</span>. <br><br><div class=\'red\'> <span class=\'bold_class\'>WARNING :</span> If a new context is selected, all the layers displayed on the <span class=\'bold_class\'>Map</span> will be replaced by the ones associated with the newly selected context. <br><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M15,19L9,16.89V5L15,7.11M20.5,3C20.44,3 20.39,3 20.34,3L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21C3.55,21 3.61,21 3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3Z\'> </path> </svg></mat-icon> Map </div><div class=\'describe\'>It is possible to personalize the <span class=\'bold_class\'>Map</span> by using the <span class=\'bold_class\'>Catalog</span> or the <span class=\'bold_class\'>Search Bar</span>. This space allows the user to add, delete, interrogate, filter and sort the displayed layers. It is also possible to visualize the legends associated with the layers. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M2 4C2 2.89 2.9 2 4 2H7V4H4V7H2V4M22 4V7H20V4H17V2H20C21.1 2 22 2.89 22 4M2 20V17H4V20H7V22H4C2.9 22 2 21.11 2 20M10 2H14V4H10V2M10 20H14V22H10V20M2 10H4V14H2V10M18.5 13C20.4 13 22 14.6 22 16.5C22 19.1 18.5 23 18.5 23C18.5 23 15 19.1 15 16.5C15 14.6 16.6 13 18.5 13M18.5 17.8C19.2 17.8 19.8 17.2 19.7 16.6C19.7 16 19.1 15.4 18.5 15.4C17.9 15.4 17.3 15.9 17.3 16.6C17.3 17.2 17.8 17.8 18.5 17.8M20 10H22V12.34C21.42 11.84 20.74 11.45 20 11.23V10Z\'> </path> </svg></mat-icon> Spatial Filter </div><div class=\'describe\'> The <span class=\'bold_class\'>Spatial Filter</span> can be used to search for adresses or themes by specifying a predefined zone (for example, electoral districts) or by drawing an area on the map. The results can then be exported by using the <span class=\'bold_class\'>Import & Export</span> tool. </div></div><br><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M1.39,18.36L3.16,16.6L4.58,18L5.64,16.95L4.22,15.54L5.64,14.12L8.11,16.6L9.17,15.54L6.7,13.06L8.11,11.65L9.53,13.06L10.59,12L9.17,10.59L10.59,9.17L13.06,11.65L14.12,10.59L11.65,8.11L13.06,6.7L14.47,8.11L15.54,7.05L14.12,5.64L15.54,4.22L18,6.7L19.07,5.64L16.6,3.16L18.36,1.39L22.61,5.64L5.64,22.61L1.39,18.36Z\'> </path> </svg></mat-icon> Measure </div><div class=\'describe\'>This tool gives the option to either <span class=\'bold_class\'>Measure</span> distances or areas on the map.</div><br></div><div class=\'tool_name\'><div class=\'titre_outil\'><mat-icon class=\'mat-icon\'><svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'><path d=\'M9.75 20.85C11.53 20.15 11.14 18.22 10.24 17C9.35 15.75 8.12 14.89 6.88 14.06C6 13.5 5.19 12.8 4.54 12C4.26 11.67 3.69 11.06 4.27 10.94C4.86 10.82 5.88 11.4 6.4 11.62C7.31 12 8.21 12.44 9.05 12.96L10.06 11.26C8.5 10.23 6.5 9.32 4.64 9.05C3.58 8.89 2.46 9.11 2.1 10.26C1.78 11.25 2.29 12.25 2.87 13.03C4.24 14.86 6.37 15.74 7.96 17.32C8.3 17.65 8.71 18.04 8.91 18.5C9.12 18.94 9.07 18.97 8.6 18.97C7.36 18.97 5.81 18 4.8 17.36L3.79 19.06C5.32 20 7.88 21.47 9.75 20.85M20.84 5.25C21.06 5.03 21.06 4.67 20.84 4.46L19.54 3.16C19.33 2.95 18.97 2.95 18.76 3.16L17.74 4.18L19.82 6.26M11 10.92V13H13.08L19.23 6.85L17.15 4.77L11 10.92Z\'></path></svg></mat-icon> Draw </div><div class=\'describe\'> The <span class=\'bold_class\'>Draw</span> tool can be used to draw points, lines, polygons or circles with labels. The color of the fill and the stroke can be set with the given selectors. <br><br> A Drawings layer can be exported by using the <span class=\'bold_class\'>Import & Export</span> tool. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M14,14.5V12H10V15H8V11A1,1 0 0,1 9,10H14V7.5L17.5,11M21.71,11.29L12.71,2.29H12.7C12.31,1.9 11.68,1.9 11.29,2.29L2.29,11.29C1.9,11.68 1.9,12.32 2.29,12.71L11.29,21.71C11.68,22.09 12.31,22.1 12.71,21.71L21.71,12.71C22.1,12.32 22.1,11.68 21.71,11.29Z\'> </path> </svg></mat-icon> Directions </div><div class=\'describe\'> It is possible to build a route and get <span class=\'bold_class\'>Directions</span> between two points by placing them on the map or by searching for addresses. It is also possible to add stops and copy the description or the link of the route to the clipboard.</div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M17,14H19V17H22V19H19V22H17V19H14V17H17V14M11,16L2,9L11,2L20,9L11,16M11,18.54L12,17.75V18C12,18.71 12.12,19.39 12.35,20L11,21.07L2,14.07L3.62,12.81L11,18.54Z\'></path> </svg></mat-icon> Catalog </div><div class=\'describe\'> The <span class=\'bold_class\'>Catalog</span> contains all the layers that can be added to the <span class=\'bold_class\'>Map</span>. Click on the + of desired layer to add it. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M14,17H18V14L23,18.5L18,23V20H14V17M13,9H18.5L13,3.5V9M6,2H14L20,8V12.34C19.37,12.12 18.7,12 18,12A6,6 0 0,0 12,18C12,19.54 12.58,20.94 13.53,22H6C4.89,22 4,21.1 4,20V4A2,2 0 0,1 6,2Z\'></path> </svg></mat-icon> Import & Export </div><div class=\'describe\'> It is possible to <span class=\'bold_class\'>Import</span> vector data by specifying a coordinate system or a projection. <br><br> It is possible to <span class=\'bold_class\'>Export</span> one or many layers in multiple formats. <br><br> It is also possible to <span class=\'bold_class\'>Import</span> or <span class=\'bold_class\'>Export</span> a context locally. This feature is useful to save contexts when the user is not authenticated. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z\'></path> </svg></mat-icon> Print </div><div class=\'describe\'>This tool is used to <span class=\'bold_class\'>Print</span> the map displayed on-screen. Multiple options can be specified like a title, a comment, the output format, the paper size and the orientation. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M18,16.08C17.24,16.08 16.56,16.38 16.04,16.85L8.91,12.7C8.96,12.47 9,12.24 9,12C9,11.76 8.96,11.53 8.91,11.3L15.96,7.19C16.5,7.69 17.21,8 18,8A3,3 0 0,0 21,5A3,3 0 0,0 18,2A3,3 0 0,0 15,5C15,5.24 15.04,5.47 15.09,5.7L8.04,9.81C7.5,9.31 6.79,9 6,9A3,3 0 0,0 3,12A3,3 0 0,0 6,15C6.79,15 7.5,14.69 8.04,14.19L15.16,18.34C15.11,18.55 15.08,18.77 15.08,19C15.08,20.61 16.39,21.91 18,21.91C19.61,21.91 20.92,20.61 20.92,19A2.92,2.92 0 0,0 18,16.08Z\'> </path> </svg></mat-icon> Share</div><div class=\'describe\'> The <span class=\'bold_class\'>Share</span> tool is used to create an URL that redirects to an exact representation of the map. This link can be shared or distributed in a document and allows the user to \\"save\\" the map for later use. </div><br></div><div class=\'tool_name\'> <p> <a href=\'http://igouverte.org/\' target=\'_blank\'><img src=\'./assets/igo2/core/logo.png\' alt=\'IGO\' height=32>IGO2</a> is a open source geospatial solution developed by collaborators and specialists from several departments and agencies of the Government of Quebec. <p> Version: {{version.lib}}</p></div>","trainingGuide":"Training guide","trainingGuideTooltip":"Click here to access IGO2\'s self-training guide"},"mapTool":{"empty":"No layer is currently active on this map. ","customize":"Customize it by adding layer from the : ","search-tool":"Search tool","catalog-tool":"Data catalog","context-tool":"Context manager","noLayersVisible":"There is no visible layers.","noLayersInRange":"There is no visible layers at the current scale. Please zoom in or out to discover theses layers."},"importExportTool":{"importExportData":"Layer","importExportContext":"Context"},"workspace":{"toggleWorkspace":"Open/Close the table view","ogcFilter.close":"Close","ogcFilter.title":"Filters","ogcFilter.tooltip":"Apply filters","download.title":"Download","download.tooltip":"Download","inMapExtent.title":"Show records contained in map","inMapExtent.active.tooltip":"Show records contained in map","inMapExtent.inactive.tooltip":"Show all records","zoomAuto.title":"Zoom auto","zoomAuto.tooltip":"Zoom auto","selected.title":"Show selected records only","selected.tooltip":"Show selected records only","clearSelection.title":"Deselect all","clearSelection.tooltip":"Deselect all records","maximize":"Extend","maximizeTooltip":"Extend panel","standardExtent":"Reduce","standardExtentTooltip":"Reduce panel"},"directions":{"warning":{"title":"Warning","message":"The route proposed in this tool does not take into account current road conditions, road congestion or obstacles present on the network."}},"advanced-map-tool":{"advanced-swipe":{"swipe-select":"select the layers for swiping","selectAll":"Select all","empty":"No layer is currently active on this map. ","customize":"Customize it by adding layer from the : ","search-tool":"Search tool","catalog-tool":"Data catalog","context-tool":"Context manager","swipe":"Swipe","swipe-tool":"Swipe-Tool"},"advanced-coordinates":{"copy":"Copy coordinates","lon":"Longitude","lat":"Latitude","est":"Est","nord":"North","coordinates":"Coordinates","copyMsg":"Coordinates copied to clipboard","copyTitle":"Coordinates of cetre","center":"Center","coordSystem":"Systeme of coordinates","zoom":"Current zoom-level: "}}}}}')},10503:function(e){"use strict";e.exports=JSON.parse('{"igo":{"auth":{"accessAnonymous":"Access as anonymous","connection":"Connection","login":"Login","password":"Password","signOut":"Sign out","user":"User","welcome":"Welcome {{name}}!","deconnection":"You are logged out.","home":"Return to the home page","error":{"Password expired":"Password expired","Maximun logins exceeded":"Maximum logins exceeded","Login lockout":"Maximum number of attempts exceeded. Your account is locked.","Wrong password":"Wrong password","Invalid username":"Invalid username"},"microsoft":{"login":"Sign in with Azure account"},"microsoftb2c":{"login":"Sign in"}},"common":{"confirmDialog":{"cancelBtn":"Cancel","confirmBtn":"Confirm","title":"Confirm"},"table":{"filter":"Filter"},"entity-table":{"targetHtmlUrl":"Open the external link"},"form":{"errors":{"required":"This field is required"}},"actionbar":{"scrollUp":"Scroll up","scrollDown":"Scroll down","icon":"Action list"},"interactiveTour":{"tooltipTourToolButton":"Interactive tour of the application","disaledTooltipTourToolButton":"To have access to this tool\'s tour, add contexts or layers","buttonTitle":"Discover","exitButton":"Exit","backButton":"Back","nextButton":"Next"},"paginator":{"firstPageLabel":"First page","itemsPerPageLabel":"Items per page:","lastPageLabel":"Last page","nextPageLabel":"Next page","previousPageLabel":"Previous page","of":"of"}},"context":{"bookmarkButton":{"create":"Create a new context","dialog":{"createMsg":"The context \'{{value}}\' was created","createTitle":"Context created","placeholder":"Title","title":"New context"}},"contextManager":{"clone":"Clone this context","delete":"Delete this context","dialog":{"cloneMsg":"The context \'{{value}}\' was cloned","cloneTitle":"Context cloned","copyMsg":"Text copied","copyTitle":"Context ID","confirmDelete":"Are you sure you want to delete this context?","deleteMsg":"The context \'{{value}}\' was deleted","deleteTitle":"Context deleted","favoriteMsg":"The context \'{{value}}\' was set as favorite","favoriteTitle":"Favorite saved","saveMsg":"The context \'{{value}}\' was saved","saveTitle":"Context saved"},"edit":"Edit this context","errors":{"uncaught":{"message":"Sorry, service is currently not available. Please try again later","title":"Error server"},"addPermission":"The permission you are trying to add is already in the context.","addPermissionEmpty":"The permission you are trying to add is not valid","addPermissionTitle":"Add permission error"},"favorite":"Set as favorite context","form":{"copy":"Copy the context ID","edit":"Save","title":"Title","titleRequired":"Title required","uri":"ID","uriRequired":"ID required"},"invalid":{"text":"Context \'{{value}}\' is invalid. The default context was loaded.","title":"Invalid context"},"managePermissions":"Manage permissions context","manageTools":"Manage tools context","ourContexts":"Our contexts","publicContexts":"Public contexts","save":"Save this context","sharedContexts":"Shared contexts","filterPlaceHolder":"Filter by name","sortAlphabetically":"Sort alphabetically","sortContextOrder":"Replace according to the creation date","userAccount":"User account","filterUser":"Filter by user group","emptyContext":"Empty context","emptyContextTooltip":"Create a new empty context","contextMap":"Context from map","contextMapTooltip":"Create a new context from map layers","hide":"Hide this context","show":"Show up this context","showHidden":"Show hidden contexts"},"contextImportExport":{"export":{"exportPlaceHolder":"Layers","exportContextName":"Context name","exportSelectAll":"Select all","success":{"text":"Context has been exported.","title":"Context export success"},"nothing":{"text":"No context could be exported.","title":"Nothing to export"},"failed":{"text":"Failed to export","title":"Failed to export context"}},"import":{"success":{"title":"Imported context","text":"The context \'{{value}}\' was added to the map"},"empty":{"text":"The context \'{{value}}\' contained nothing that could be imported.","title":"Nothing to import"},"invalid":{"text":"The context \'{{value}}\' is invalid.","title":"Invalid context"},"unreadable":{"title":"Unreadable context","text":"The context \'{{value}}\' is unreadable"},"tooLarge":{"text":"The context \'{{value}}\' is too large (Max: {{size}} MB)","title":"Context too large"}}},"permission":{"addBtn":"Add","delete":"Remove permission","dialog":{"addMsg":"The permission \'{{value}}\' was added","addTitle":"Permission added","deleteMsg":"The permission \'{{value}}\' was removed","deleteTitle":"Permission removed","scopeChangedMsg":"The scope was changed to {{value}}","scopeChangedTitle":"Scope changed"},"profil":"Profil","user":"User or group","profilRequired":"Profil required","read":"Read only","readOnlyTitle":"Read-only context","readOnlyMsg":"You can only revoke permission if the context is shared directly to your username.","scope":{"private":"Private","protected":"Protected","shared":"Shared","public":"Public"},"write":"Read and Write"},"poiButton":{"create":"Create a new zone of interest","dialog":{"confirmDelete":"Are you sure you want to delete this zone of interest?","createMsg":"The zone of interest \'{{value}}\' was created","createTitle":"Zone of interest created","deleteMsg":"The zone of interest \'{{value}}\' was deleted","deleteTitle":"Zone of interest deleted","placeholder":"Title","title":"New zone of interest"},"placeholder":"Zones of interest"},"sidenav":{"goBack":"Go Back","mainMenu":"Main Menu"},"shareMap":{"button":"Share map","refreshBtn":"Refresh sharing","copy":"Copy to clipboard","shareWithApi":"Share by context","shareWithUrl":"Share by url","dialog":{"copyMsg":"Link copied to clipboard","copyTitle":"Link"},"errorTitle":"Share Map error","placeholderLink":"Link","included":"Included in shared URL :","context":"The context when creating the sharing link.","center":"The coordinates of the center of the map (longitude, latitude).","zoom":"The zoom level of the map.","addedLayers":"The layers added by the catalog or by the search bar.","visibleInvisible":"Visibility status of layers.","excluded":"Excluded in the shared URL :","order":"The order of the layers.","opacity":"Modifications made to the opacity of the layers.","filterOgc":"Additions / modifications made to filters by attribute.","filterTime":"The current value for time filters."},"tool":{"dialog":{"addMsg":"The tool \'{{value}}\' was added","addTitle":"Tool added","deleteMsg":"The tool \'{{value}}\' was removed","deleteTitle":"Tool removed"}},"userButton":{"dialog":{"email":"Email","expiration":"Expiration","user":"User","clearPreferences":"Clear my preferences"},"infoTitle":"User info","logout":"Logout"}},"core":{"errors":{"uncaught":{"message":"Sorry, service is currently not available. Please try again later","title":"Error server"}},"network":{"online":{"message":"Online","title":"Status:"},"offline":{"message":"Offline","title":"Status:"}}},"geo":{"catalog":{"layer.addToMap":"Add to map","layer.addToMapOutRange":"Add to map. The layer is not visible at the current scale. Please zoom in/out","layer.removeFromMap":"Remove from map","layer.removeFromMapOutRange":"Remove from map. The layer is not visible at the current scale. Please zoom in/out","group.addToMap":"Add all layers from this group to map","group.removeFromMap":"Remove all layers from this group to map","baseLayers":"Baselayers","unavailableTitle":"Catalog unavailable","unavailable":"The catalog \'{{value}}\' is unavailable at the moment or you don\'t have the required permissions.","someUnavailable":"Some of the layers from the current catalog are unavailable at the moment or you don\'t have the required permissions.","externalProvider":{"catalog":"This catalog comes from an external organization.","group":"This layers comes from an external organization.","layer":"This layer comes from an external organization.","unavailableWithEmail":"The catalog \'{{value}}\' is unavailable at the moment. To add an external service to the predefined list, please contact us at {{emailAddress}}. Delays can apply if problems occurs with the provider."},"library.add":"Add this catalog to the list","library.cancel":"Cancel","library.remove":"Remove this catalog from the list","library.inlist":{"title":"Catalog already contained","message":"The catalog is already contained in the list."},"library.addTitle":"Adding a catalog","library.addBtn":"Add a catalog"},"clickOnMap":{"clickedFeature":"Clicked Feature"},"baselayersSwitcher":{"title":"Basemaps"},"dataSource":{"unavailableTitle":"Layer unavailable","optionsApiUnavailable":"Layer information could not be retrieved. Some layers may not present the correct information.","unavailable":"The layer \'{{value}}\' is unavailable at the moment or you don\'t have the required permissions."},"dropGeoFile":{"invalid":{"text":"The file \'{{value}}\' is invalid ({{mimeType}})","title":"Invalid file"},"empty":{"text":"The file \'{{value}}\' contained nothing that could be imported.","title":"Nothing to import"},"success":{"text":"Imported file","title":"The layer \'{{value}}\' was added to the map"},"unreadable":{"text":"Unreadable file","title":"The file \'{{value}}\' is unreadable"},"tooLarge":{"text":"The file \'{{value}}\' is too large (Max: {{size}} MB)","title":"File too large"},"invalidSRS":{"text":"The projection is valid. It must start with EPSG:","title":"Invalid projection"},"ogreServer":{"title":"Ogre server error 500","text":"Error in convert to geojson. Maybe file is too big, try to import that file in geojson format"}},"export":{"customList":{"text":"Some of the selected layers ( {{value}} ) limit the format\'s list","title":"Restricted list of formats"},"nothing":{"text":"No feature could be exported.","title":"Nothing to export"},"noFormat":{"text":"No export format valid for all selected layers. Please export the layers one at a time.","title":"No valid format"},"failed":{"text":"Failed to export","title":"Failed to export features"},"popupBlocked":{"text":"</br>Enable the popup in your browser. </br>For Chrome and Edge, on the right into the Address Bar.</br>{{extraMessage}}","selectAgain":"Fix it and re-select an output format.","retry":"Please retry to export","title":"Popup blocked by your browser"},"success":{"text":"Features have been exported.","title":"Features export success"},"format":{"GeoJSON":"GeoJSON","GML":"GML","GPX":"GPX","KML":"KML","Shapefile":"Shapefile","CSVcomma":"CSV (comma delimited)","CSVsemicolon":"CSV (Excel compatible)","URL":"External link"},"gpx.error.poly":{"title":"GPX error","text":"GPX format do now allow polygon features"},"encoding":{"LATIN1":"LATIN-1","UTF8":"UTF-8"}},"importExportForm":{"exportButton":"Export","exportButtonLink":"Open the link","exportButtonLinks":"Open the links","exportCircleToPolygon":"Transform Circle entities in polygons","exportFormatPlaceholder":"Format","exportLayerPlaceholder":"Layer","exportFileNamePlaceholder":"Filename","encodingPlaceholder":"Encoding","exportTabTitle":"Export","exportFeatureInExtent":"Export only features in map extent","exportNoLayersExportable":"There is no exportable layer in your map","exportSelectedFeature":"Export only selected features","importButton":"Import","importProjPlaceholder":"Coordinate system of the file to import","importTabTitle":"Import","importClarifications":"Clarifications","importSizeMax":"The file size limit is {{size}} Mb","importFormatAuthorized":"Formats authorized: geojson, kml, gpx, gml, shapefile","importShpZip":"Shapefiles must be zipped AND geometries stored in Latitude Longitude coordinate (EPSG:4326/WGS:84)","other":"other","others":"others","projections":{"mtm":"MTM zone {{zone}} ({{code}})","utm":"UTM zone {{zone}} ({{code}})","webMercator":"Web Mercator ({{code}})","nad83":"Lat-Long NAD83 ({{code}})","wgs84":"Lat-Long WGS84 ({{code}})","choose":"You must choose a projection for your input file."}},"operators":{"caseSensitive":"Case sensitive","And":"And","Or":"Or","PropertyIsEqualTo":"=","PropertyIsNotEqualTo":"!=","PropertyIsLike":"\u2248","PropertyIsGreaterThan":">","PropertyIsGreaterThanOrEqualTo":">=","PropertyIsLessThan":"<","PropertyIsLessThanOrEqualTo":"<=","PropertyIsBetween":"between","During":"during (temporal)","PropertyIsNull":"is null","Intersects":"intersects (spatial)","Within":"within (spatial)","Contains":"contains (spatial)","tooltip":{"And":"Logical operator between filters where both conditions must be true","Or":"Logical operator between filters where at least one (1) condition must be true","PropertyIsEqualTo":"Identical (case sensitive)","PropertyIsNotEqualTo":"Different(case sensitive)","PropertyIsLike":"Like Example: *road* Finds any values that have \'road\' in any position. road* Finds any values that begin by \'road\'. wildCard =\'*\', singleChar = \'.\' escapeChar = \'!\' (case sensitive)","PropertyIsGreaterThan":"Greater than","PropertyIsGreaterThanOrEqualTo":"Greater than or equal to ","PropertyIsLessThan":"Lesser than","PropertyIsLessThanOrEqualTo":"Lesser than or equal to","PropertyIsBetween":"Apply a range check between the lower and upper boundary (values are included)","During":"Apply a range check for time attributes","PropertyIsNull":"Return features where the attribute is null","Intersects":"Return features in geometric intersection with the provided geometry","Within":"Return feature which are completely contained by the provided geometry","Contains":"Return feature completely containing by the provided geometry"}},"sourceFields":{"selectField":"Choose a field"},"filter":{"resetFilters":"(Apply no filters)","addFilter":"Add an empty filter to the current list","removeFilter":"Remove the current filter from the filters\'s list","toggleFilterState":"Enable/disable the current filter","refreshFilters":"Update this datasource with the active filter(s). To enable this button, the layer must be visible (or in the defined scale ranges) or you must modify the current filter.","layerFiltered":"This layer is currently filtered","layerFilterable":"This layer is filterable","filterBy":"Filter by","advancedOgcFilters":"Advanced filters","displayMoreResults":"Display more (+)","displayLessResults":"Display less (-)","placeholder":"Enter a value","placeholderSnrc":"Ex: 21L14","selectOperator":"Select an operator","sliderModeTitle":"Time slider","reportingDate":"Reporting date"},"spatialSelector":{"fixedExtent":"Fixed extent","btnSetExtent":"Define the extent of the spatial filter to the current view","snrc":"SNRC","selectFeature":"","drawFeature":""},"layer":{"hideLayer":"Hide Layer","lowerLayer":"Bring layer backward","hideSelectedLayers":"Hide selected layers","filterLowerLayer":"The backward movement is always done according to the order of the map!","filterPlaceholder":"Filter the layers list","activateSelectionMode":"Activate multiple selection mode","deactivateSelectionMode":"Deactivate multiple selection mode","tools":"Tools","selectAll":"Select all layers","deselectAll":"Deselect all layers","zoomLayer":"Zoom To Layer Extents","zoomLayers":"Zoom To Selected Layers Extents","opacity":"Opacity","raiseLayer":"Bring layer forward","filterRaiseLayer":"The forward movement is always done according to the order of the map!","moreOptions":"Layer\'s tools","removeLayer":"Remove this layer from the map","removeSelectedLayers":"Remove selected layers from the map","removeSelectedLayersRestriction":"Some selected layers cannot be removed","showFeaturesList":"Show features list","showLayer":"Show Layer","showSelectedLayers":"Show selected layers","subsetLayersListKeyword":"Subset the layers\'s list by title or type (wms, wfs,...)","deleteKeyword":"Delete the keyword","subsetLayersListOnlyVisible":"Subset the layers\'s list by visibility","subsetLayersListOnlyInRange":"Subset the layers\'s list by resolution range","sortAlphabetically":"Sort the layers\'s list alphabetically","sortMapOrder":"Sort the layers\'s list based on layer\'s order on the map","resetLayersList":"Remove the current applied filter to layers\'s list","trackFeature":"Track the feature","legend":{"default":"Default","loadingLegendText":"Loading legend","noLegendText":"No legend available for this layer","noLegendScale":"No legend available for this scale","selectStyle":"Select the style of the legend","showAll":"Show all legends (non visible and out of range)","noLayersVisibleWithShowAllButton":"No layer currently visible. Activate the button above to see all the legends.","noLayersVisibleWithShowAllButtonButZoom":"No layer currently visible. If you zoom in the map, some layers will appear OR activate the button above to see all the legends.","noLayersVisible":"No layers currently visible.","noLayersVisibleButZoom":"No layers currently visible. However, if you zoom in the map, some layers will appear."}},"download":{"action":"Download data","title":"Downloading file","start":"Started. Check the download progression in your browser","end":"Completed"},"mapButtons":{"baselayerSwitcher":"Change base layer","geolocate":"Geolocate","offline":"Offline mode","online":"Online mode","zoomIn":"Zoom in ({{zoom}})","zoomOut":"Zoom out ({{zoom}})","resetRotation":"Set map to north","tipRotation":"Hold Alt and SHIFT while dragging on map to rotate the map."},"metadata":{"show":"Show metadata"},"printForm":{"corsErrorMessageBody":"Unable to print due to non-owned access rights","corsErrorMessageHeader":"Print","comment":"Comment","doZipFile":"Zip file","outputFormat":"Output format","paperFormat":"Paper format","paperFormats":{"A0":"33.1 X 46.8\\" (A0)","A1":"23.4 X 33.1\\" (A1)","A2":"16.5 X 23.5\\" (A2)","A3":"11.7 X 16.5\\" (A3)","A4":"8.3 X 11.7\\" (A4)","A5":"5.8 X 8.3\\" (A5)","Letter":"Letter","Legal":"Legal"},"imageFormat":"Image format","orientation":"Orientation","landscape":"Landscape","portrait":"Portrait","projection":"Projection","resolution":"Resolution","saveBtn":"Save","scale":"Scale","showProjection":"Show projection","showScale":"Show scale","title":"Title","subtitle":"Subtitle","legendPosition":"Legend Position","legendPositions":{"none":"No legend","topleft":"Top left corner of the map","topright":"Top right corner of the map","bottomleft":"Bottom left corner of the map","bottomright":"Bottom right corner of the map","newpage":"On a new page"}},"directionsForm":{"stopLayer":"Directions - stops","routeLayer":"Directions - route","start":"Start","intermediate":"Intermediate","end":"End","directionsBtn":"Get route","resetDirectionsBtn":"Reset","zoomRoute":"Zoom on route","null":"","directions":"Directions","raiseStop":"Raise stop\'s priority","lowerStop":"Lower stop\'s priority","addStop":"Add a stop","clearStop":"Clear this stop","moveStop":"Move this stop","removeStop":"Remove this stop","drivingOptions":"Options","summary":"Direction\'s summary","stopsList":"Stops\'s list","instructions":"Instructions","copy":"Copy directions","geolocate":"Use current localisation as stop","link":"Link","dialog":{"copyMsg":"Directions copied to clipboard","copyMsgLink":"Link for directions copied to clipboard","copyTitle":"Directions"}},"directions":{"uturn":"u-turn","sharp right":"sharp right","right":"right","slight right":"slightly on right","sharp left":"sharp left","left":"left","slight left":"slightly on left","straight":"forward","turn":{"straight":"Continue on {{route}}","uturn":"Make u-turn on {{route}}","else":"Turn {{translatedModifier}} onto {{route}}"},"new name":"Head {{translatedDirection}} on {{route}}","depart":"Head {{translatedDirection}} on {{route}}","arrive":{"lastStep":"You have reached your destination {{coma}} {{aggregatedDirection}}","intermediate":"You have reached the intermediate stop onto {{route}}"},"merge":"Continue on {{route}}","on ramp":"Take the ramp {{aggregatedDirection}}","off ramp":"Take exit {{aggregatedDirection}}","fork":{"left":"Merge left onto {{route}}","right":"Merge right onto {{route}}","else":"Continue on {{route}}"},"end of road":"At the end of the road, turn {{translatedModifier}} onto {{route}}","use lane":"Take the lane ...","continue":{"notUturn":"Continue on {{route}}"},"roundabout":"At the roundabout, take the {{exit}}{{cntSuffix}} exit towards {{route}}","rotary":"Roundabout rotary ...","roundabout turn":"Roundabout, take the ...","exit roundabout":"Continue to {{route}}","notification":"notification ...","uturnText":"Make u-turn and head {{translatedDirection}} on {{route}}","unknown":"???","cntSuffix":{"first":"st","secondAndMore":"rd"},"modifier":{"prefix":"on the "}},"cardinalPoints":{"n":"north","ne":"northeast","e":"east","se":"southeast","s":"south","sw":"southwest","w":"west","nw":"northwest"},"search":{"placeholder":"Search for a localisation or a layer","emptyType.placeholder":"Please choose a search type","feature.title":"Localisation","feature.placeholder":"Search for a place localisation","layer.title":"Layer","layer.placeholder":"Search for a layer","ichercheReverse.name":"Search by coordinates","ilayer":{"name":"Layers","properties":{"abstract":"Abstract","groupTitle":"Group","title":"Title","type":"Type","url":"URL","metadataUrl":"Metadata","name":"Layer name","urlInfo":"URL - WMS/WFS","downloadUrl":"Data download"},"type":{"layer":"Layer","groupLayer":"Group of layers"}},"nominatim":{"type":{"food":"Food","health":"Health","entertainment":"Entertainment","finance":"Finance"},"country":{"all":"The world","canada":"Canada"}},"icherche":{"name":"iCherche","type":{"address":"Address","oldAddress":"Old address","district":"District","postalCode":"Postal Code","city":"City","oldCity":"Old city","mrc":"MRC","regadmin":"Administrative Region","road":"Road","intersection":"Intersection","place":"Place","exit":"Highway exit","cn":"CN mark","gcc":"Coast Guard mark (CCG)","sumi":"SUMI mark","km":"Mileage mark","hq":"Hydro-Quebec","entreprise":"Entreprise","cadastre":"Cadastre"},"restrictExtent":{"map":"\xc0 l\'\xe9tendue de la carte","quebec":"Au Qu\xe9bec"}},"coordinates":{"name":"Coordinates","coord":"Geographic (longitude, latitude)","coordDMS":"Geographic (longitude, latitude) (DMS)","radius":"Radius","conf":"Confidence"},"menu.tooltip":"Search Options","settings":{"title":"Settings"},"pointerSearchSummary":{"title":"Pointer position","tooltip":"Based on every search source, show the summary of the pointer location. Use F2 to activate/deactivate."},"searchResultsGeometry":{"title":"Show results geometries","tooltip":"Hide/ show the results geometries "},"searchSources":{"selectAll":"Select All","unselectAll":"Unselect All","settings":{"results type":"Results type","ecmax":"Maximum deviation","radius":"Search radius","results limit":"Number of results","multiple object":"Multiple object","restrictExtent":"Restrict the extent","selectAll":"Select All","unselectAll":"Unselect All","true":"Yes","false":"No"}},"displayMoreResults":"Display more results"},"geometry":{"geometry":"Geometry","point":"Point","line":"Line","polygon":"Polygon"},"targetHtmlUrl":"Open the external link","searchByCoord":"Search by coordinates","searchByName":"Search by name","seeRouting":"See routing","timeFilter":{"date":"Date","endDate":"End Date","startDate":"Start Date","hour":"Hour","minute":"Minute","endYear":"End Year","startYear":"Start Year"},"spatialFilter":{"spatialFilter":"Spatial filter","predefined":"Predefined Zone","draw":"Draw","polygon":"Polygon","point":"Circle","drawPolygon":"Draw a polygon","drawCircle":"Draw a circle","searchLabel":"Search by","buffer":"Buffer","search":"Search","drawControl":"Activate draw control","listLabel":"Zone","layer":"Layer","goSearch":"Launch research","removeLayer":"Remove results","exportLayer":"Export results","clearForm":"Remove draw","clearSearch":"Reset field","Address":"Addresses","Thematics":"Thematics","searchResults":"Search Results","type":"Type","radius":"Radius","radiusAlert":"Radius must be between 0 and 100 kilometers (or 100 000 meters)","bufferAlert":"Buffer must be between 0 and 100 kilometers (or 100 000 meters)","maxSizeAlert":"Search results number exceeds 10000. Some may be missing.","zeroResults":"There are no results for this search.","warning":"Warning","freehandControl":"Freehand","group":{"toponyme":"Toponym","culturel":"Cultural","education":"Education","sante":"Health","securite":"Security","sepaq":"SEPAQ","transport":"Transportation"}},"terrapi":{"AdmRegion":"Administratives region","Mun":"Municipalities","Arrond":"Boroughs","CircFed":"Federals districts","CircProv":"Provincials districts","DirReg":"Regionals directorates","MRC":"RCM","RegTour":"Touristics regions","limites":"Administrative boundaries","bornes":"Landmarks","hydro":"Hydrography","routes":"Roads","bati":"Buildings","batiment":"Buildings","camping":"Camping","equipement":"Equipment","commun":"Public","geographie":"Natural sites","parc":"Parks","secteur":"Sector","immeubles":"Tenement","sites":"Cultural sites","cpe":"Children\'s education center","public":"Public schools","prive":"Private school","gouvernemental":"Government schools","colleges":"Colleges","universites":"University","aine":"Residences for seniors","ambulance":"Ambulance zones","clinique":"Clinics","etabl":"Health institutions","gmf":"Family doctors group","naissance":"Birth house","pharmacie":"Pharmacy","casernes":"Fire stations","correctionnel":"Correctional centres","organisme":"Security organization","palais-justice":"Courthouses","penitencier-fed":"Federal penitentiaries","penitencier-prov":"Provincial penitentiaries","polices":"Police station"},"measure":{"dialog":{"title":"Sum of the selection","length.title":"Length","area.title":"Area","lengthInMeters":"m","lengthInKilometers":"km","lengthInMiles":"mi","lengthInFeet":"ft","areaInSquareMeters":"m\xb2","areaInSquareKilometers":"km\xb2","areaInSquareMiles":"mi\xb2","areaInHectares":"ha","areaInAcres":"ac","perimeterInMeters":"Perimeter in meters"},"layerTitle":"Measure on map","area":"Area","areaHeader":"Area","length":"Length","lengthHeader":"Length / Perimeter","perimeter":"Perimeter","meters":"m","m":"m","kilometers":"km","km":"km","miles":"mi","mi":"mi","feet":"ft","ft":"ft","squareMeters":"m\xb2","m\xb2":"m\xb2","squareKilometers":"km\xb2","km\xb2":"km\xb2","squareMiles":"mi\xb2","mi\xb2":"mi\xb2","squareFeet":"ft\xb2","ft\xb2":"ft\xb2","hectares":"ha","ha":"ha","acres":"ac","ac":"ac","toggleActive":"Activate measures","toggleDisplayLines":"Display distances of lines","toggleDisplayDistance":"Display distances of areas","toggleDisplayAreas":"Display areas","toggleAutoUnits":"Auto Units","actionbar":{"calculate.tooltip":"Totals & Conversions","delete.tooltip":"Delete","modify.tooltip":"Modify"}},"draw":{"abort":"Abort current drawing","cancelColorPicker":"Cancel","Circle":"Circle","colorPicker":"Click to open the color picker","dialogInstruction":"Enter your draw\'s label","dialogTitle":"Label","delete":"Remove Drawings from map","drawing":"Draws","fill":"Fill","finish":"Finish current drawing","icon":"Icons","labels":"Labels","LineString":"Line","move":"Center view on cursor","noIcon":"No icon","noLabel":"No label","Point":"Point","Polygon":"Polygon","radius":"Radius","shortcuts":"Keyboard shortcuts","stroke":"Stroke","styleSelect":"Select style","toggleMapTooltips":"Show map tooltips","undo":"Remove last vertex"},"network":{"online":{"message":"Online","title":"Status:"},"offline":{"message":"Offline","title":"Status:"}},"workspace":{"inMapExtent.active.tooltip":"Ne montrer que les entit\xe9s contenues dans la carte","inMapExtent.inactive.tooltip":"Montrer tous les entit\xe9s"}},"integration":{"tools":{"catalog":"Catalog","contexts":"Contexts","directions":"Directions","draw":"Draw","importExport":"Import & Export","ogcFilter":"Filter by","map":"Map","layers":"Layers","legend":"Legend","measurer":"Measure","print":"Print","searchResults":"Search Results","shareMap":"Share","timeFilter":"Time Filter","about":"About","spatialFilter":"Spatial Filter","advancedMap":"Advanced map tools"},"searchResultsTool":{"noResults":"No results","doSearch":"Do a search in the search bar.","examples":"<b>Allow to search addresses, location, coordinates and layers</b>.<br><br><u>Adresses</u> research can be done with a combination of : <ul><li>building number</li><li>street name</li><li>city name</li><li>postal code</li></ul> Examples for <u>locations</u>: <ul><li>Lac Poulin</li><li>Mcdo L\xe9vis</li><li>Saint-Isidore</li></ul> You can also use keywords to refine your search. Examples: <ul><li>#mun qu\xe9bec (to search municipalities)</li><li>#sante L\xe9vis (to search health establishments)</li><li>#cpe joyeux (to search nurseries)</li><li>#intersection li\xe9gois + \xe9glise (to search an intersection, the #+ can also be used)</li></ul>*Keywords appear when hovering results type in search settings tab -> iCherche -> Results type.<br><br><u>Coordinates</u> examples :<ul><li>Decimal degree (-68.165547, 48.644546)</li><li>Degrees, minutes, seconds (-68 9 56, 48 38 40)</li><li>Degree, minutes, decimal (-68 9.56, 48 38.40)</li><li>Projected (UTM-19 561466.861, 5388278.862)</li><li>BELL (Lat: 48 38 40N Long: 68 9 56W UNC:100 CONF:90)</li><li>Meter Meter (111594.63, 445854.74;32198)</li></ul>For more informations on coordinate\'s research : <a href=\'https://igo2.readthedocs.io/fr/next/properties.html#coordonnees\' target=\'_blank\'>Consult IGO2\'s documentation</a>","zoomOnFeatureTooltip":"Zoom on selected feature.","zoomOnFeatureTooltipOutOfView":"The feature is out of view. Zoom on selected feature."},"aboutTool":{"headerHtml":"","html":"<style>#about .bold_class{font-weight: bold;}#about .red{color: red;}#about .tool_name{border-top: 1px solid; padding-top: 10px;}#about .titre_outil{font-weight: bold; font-size: 18px; padding-bottom: 8px;}#about .subtitle{font-size: 20px; padding-bottom: 10px;}#about .align_right{text-align: right;}#about .describe{text-align: justify;}#about a img{color: black; text-decoration: none;}</style><body> <div id=\'about\'> <div class=\'bold_class subtitle\'>Features overview</div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z\'> </path> </svg></mat-icon> Search Bar </div><div class=\'describe\'>Located in the upper-left portion of the interface, the <span class=\'bold_class\'>Search Bar</span> allows the user to locate an area of interest using an address, location or GPS coordinates. It can also be used to search for a layer. <br><br> It is also possible to search for a specific element using the hashtag \\"#\\" (for example, #municipalites qu\xe9bec). Accents and capital letters don\'t have any impact on <span class=\'bold_class\'>Search Results</span> when using a hashtag. </div></div><br><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z\'></path> </svg></mat-icon> Contexts </div><div class=\'describe\'> <span class=\'bold_class\'>Contexts</span> are used to visualize groupings of layers related to a specific theme. When a context is selected, all the layers associated with it will be added to the <span class=\'bold_class\'>Map</span>. It is then possible to add other layers to the map by using the <span class=\'bold_class\'>Catalog</span> or the <span class=\'bold_class\'>Search Bar</span>. <br><br><div class=\'red\'> <span class=\'bold_class\'>WARNING :</span> If a new context is selected, all the layers displayed on the <span class=\'bold_class\'>Map</span> will be replaced by the ones associated with the newly selected context. <br><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M15,19L9,16.89V5L15,7.11M20.5,3C20.44,3 20.39,3 20.34,3L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21C3.55,21 3.61,21 3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3Z\'> </path> </svg></mat-icon> Map </div><div class=\'describe\'>It is possible to personalize the <span class=\'bold_class\'>Map</span> by using the <span class=\'bold_class\'>Catalog</span> or the <span class=\'bold_class\'>Search Bar</span>. This space allows the user to add, delete, interrogate, filter and sort the displayed layers. It is also possible to visualize the legends associated with the layers. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M2 4C2 2.89 2.9 2 4 2H7V4H4V7H2V4M22 4V7H20V4H17V2H20C21.1 2 22 2.89 22 4M2 20V17H4V20H7V22H4C2.9 22 2 21.11 2 20M10 2H14V4H10V2M10 20H14V22H10V20M2 10H4V14H2V10M18.5 13C20.4 13 22 14.6 22 16.5C22 19.1 18.5 23 18.5 23C18.5 23 15 19.1 15 16.5C15 14.6 16.6 13 18.5 13M18.5 17.8C19.2 17.8 19.8 17.2 19.7 16.6C19.7 16 19.1 15.4 18.5 15.4C17.9 15.4 17.3 15.9 17.3 16.6C17.3 17.2 17.8 17.8 18.5 17.8M20 10H22V12.34C21.42 11.84 20.74 11.45 20 11.23V10Z\'> </path> </svg></mat-icon> Spatial Filter </div><div class=\'describe\'> The <span class=\'bold_class\'>Spatial Filter</span> can be used to search for adresses or themes by specifying a predefined zone (for example, electoral districts) or by drawing an area on the map. The results can then be exported by using the <span class=\'bold_class\'>Import & Export</span> tool. </div></div><br><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M1.39,18.36L3.16,16.6L4.58,18L5.64,16.95L4.22,15.54L5.64,14.12L8.11,16.6L9.17,15.54L6.7,13.06L8.11,11.65L9.53,13.06L10.59,12L9.17,10.59L10.59,9.17L13.06,11.65L14.12,10.59L11.65,8.11L13.06,6.7L14.47,8.11L15.54,7.05L14.12,5.64L15.54,4.22L18,6.7L19.07,5.64L16.6,3.16L18.36,1.39L22.61,5.64L5.64,22.61L1.39,18.36Z\'> </path> </svg></mat-icon> Measure </div><div class=\'describe\'>This tool gives the option to either <span class=\'bold_class\'>Measure</span> distances or areas on the map.</div><br></div><div class=\'tool_name\'><div class=\'titre_outil\'><mat-icon class=\'mat-icon\'><svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'><path d=\'M9.75 20.85C11.53 20.15 11.14 18.22 10.24 17C9.35 15.75 8.12 14.89 6.88 14.06C6 13.5 5.19 12.8 4.54 12C4.26 11.67 3.69 11.06 4.27 10.94C4.86 10.82 5.88 11.4 6.4 11.62C7.31 12 8.21 12.44 9.05 12.96L10.06 11.26C8.5 10.23 6.5 9.32 4.64 9.05C3.58 8.89 2.46 9.11 2.1 10.26C1.78 11.25 2.29 12.25 2.87 13.03C4.24 14.86 6.37 15.74 7.96 17.32C8.3 17.65 8.71 18.04 8.91 18.5C9.12 18.94 9.07 18.97 8.6 18.97C7.36 18.97 5.81 18 4.8 17.36L3.79 19.06C5.32 20 7.88 21.47 9.75 20.85M20.84 5.25C21.06 5.03 21.06 4.67 20.84 4.46L19.54 3.16C19.33 2.95 18.97 2.95 18.76 3.16L17.74 4.18L19.82 6.26M11 10.92V13H13.08L19.23 6.85L17.15 4.77L11 10.92Z\'></path></svg></mat-icon> Draw </div><div class=\'describe\'> The <span class=\'bold_class\'>Draw</span> tool can be used to draw points, lines, polygons or circles with labels. The color of the fill and the stroke can be set with the given selectors. <br><br> A Drawings layer can be exported by using the <span class=\'bold_class\'>Import & Export</span> tool. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M14,14.5V12H10V15H8V11A1,1 0 0,1 9,10H14V7.5L17.5,11M21.71,11.29L12.71,2.29H12.7C12.31,1.9 11.68,1.9 11.29,2.29L2.29,11.29C1.9,11.68 1.9,12.32 2.29,12.71L11.29,21.71C11.68,22.09 12.31,22.1 12.71,21.71L21.71,12.71C22.1,12.32 22.1,11.68 21.71,11.29Z\'> </path> </svg></mat-icon> Directions </div><div class=\'describe\'> It is possible to build a route and get <span class=\'bold_class\'>Directions</span> between two points by placing them on the map or by searching for addresses. It is also possible to add stops and copy the description or the link of the route to the clipboard.</div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M17,14H19V17H22V19H19V22H17V19H14V17H17V14M11,16L2,9L11,2L20,9L11,16M11,18.54L12,17.75V18C12,18.71 12.12,19.39 12.35,20L11,21.07L2,14.07L3.62,12.81L11,18.54Z\'></path> </svg></mat-icon> Catalog </div><div class=\'describe\'> The <span class=\'bold_class\'>Catalog</span> contains all the layers that can be added to the <span class=\'bold_class\'>Map</span>. Click on the + of desired layer to add it. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M14,17H18V14L23,18.5L18,23V20H14V17M13,9H18.5L13,3.5V9M6,2H14L20,8V12.34C19.37,12.12 18.7,12 18,12A6,6 0 0,0 12,18C12,19.54 12.58,20.94 13.53,22H6C4.89,22 4,21.1 4,20V4A2,2 0 0,1 6,2Z\'></path> </svg></mat-icon> Import & Export </div><div class=\'describe\'> It is possible to <span class=\'bold_class\'>Import</span> vector data by specifying a coordinate system or a projection. <br><br> It is possible to <span class=\'bold_class\'>Export</span> one or many layers in multiple formats. <br><br> It is also possible to <span class=\'bold_class\'>Import</span> or <span class=\'bold_class\'>Export</span> a context locally. This feature is useful to save contexts when the user is not authenticated. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z\'></path> </svg></mat-icon> Print </div><div class=\'describe\'>This tool is used to <span class=\'bold_class\'>Print</span> the map displayed on-screen. Multiple options can be specified like a title, a comment, the output format, the paper size and the orientation. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M18,16.08C17.24,16.08 16.56,16.38 16.04,16.85L8.91,12.7C8.96,12.47 9,12.24 9,12C9,11.76 8.96,11.53 8.91,11.3L15.96,7.19C16.5,7.69 17.21,8 18,8A3,3 0 0,0 21,5A3,3 0 0,0 18,2A3,3 0 0,0 15,5C15,5.24 15.04,5.47 15.09,5.7L8.04,9.81C7.5,9.31 6.79,9 6,9A3,3 0 0,0 3,12A3,3 0 0,0 6,15C6.79,15 7.5,14.69 8.04,14.19L15.16,18.34C15.11,18.55 15.08,18.77 15.08,19C15.08,20.61 16.39,21.91 18,21.91C19.61,21.91 20.92,20.61 20.92,19A2.92,2.92 0 0,0 18,16.08Z\'> </path> </svg></mat-icon> Share</div><div class=\'describe\'> The <span class=\'bold_class\'>Share</span> tool is used to create an URL that redirects to an exact representation of the map. This link can be shared or distributed in a document and allows the user to \\"save\\" the map for later use. </div><br></div><div class=\'tool_name\'> <p> <a href=\'http://igouverte.org/\' target=\'_blank\'><img src=\'./assets/igo2/core/logo.png\' alt=\'IGO\' height=32>IGO2</a> is a open source geospatial solution developed by collaborators and specialists from several departments and agencies of the Government of Quebec. <p> Version: {{version.lib}}</p></div>","trainingGuide":"Training guide","trainingGuideTooltip":"Click here to access IGO2\'s self-training guide"},"mapTool":{"empty":"No layer is currently active on this map. ","customize":"Customize it by adding layer from the : ","search-tool":"Search tool","catalog-tool":"Data catalog","context-tool":"Context manager","noLayersVisible":"There is no visible layers.","noLayersInRange":"There is no visible layers at the current scale. Please zoom in or out to discover theses layers."},"importExportTool":{"importExportData":"Layer","importExportContext":"Context"},"workspace":{"toggleWorkspace":"Open/Close the table view","ogcFilter.close":"Close","ogcFilter.title":"Filters","ogcFilter.tooltip":"Apply filters","download.title":"Download","download.tooltip":"Download","inMapExtent.title":"Show records contained in map","inMapExtent.active.tooltip":"Show records contained in map","inMapExtent.inactive.tooltip":"Show all records","zoomAuto.title":"Zoom auto","zoomAuto.tooltip":"Zoom auto","selected.title":"Show selected records only","selected.tooltip":"Show selected records only","clearSelection.title":"Deselect all","clearSelection.tooltip":"Deselect all records","maximize":"Extend","maximizeTooltip":"Extend panel","standardExtent":"Reduce","standardExtentTooltip":"Reduce panel"},"directions":{"warning":{"title":"Warning","message":"The route proposed in this tool does not take into account current road conditions, road congestion or obstacles present on the network."}},"advanced-map-tool":{"advanced-swipe":{"swipe-select":"select the layers for swiping","selectAll":"Select all","empty":"No layer is currently active on this map. ","customize":"Customize it by adding layer from the : ","search-tool":"Search tool","catalog-tool":"Data catalog","context-tool":"Context manager","swipe":"Swipe","swipe-tool":"Swipe-Tool"},"advanced-coordinates":{"copy":"Copy coordinates","lon":"Longitude","lat":"Latitude","est":"Est","nord":"North","coordinates":"Coordinates","copyMsg":"Coordinates copied to clipboard","copyTitle":"Coordinates of cetre","center":"Center","coordSystem":"Systeme of coordinates","zoom":"Current zoom-level: "}}}}}')},8555:function(e){"use strict";e.exports=JSON.parse('{"igo":{"auth":{"accessAnonymous":"Rester anonyme","connection":"Connexion","login":"Connecter","password":"Mot de passe","signOut":"Se d\xe9connecter","user":"Utilisateur","welcome":"Bienvenue {{name}}!","deconnection":"Vous \xeates d\xe9connect\xe9","home":"Retourner \xe0 la page d\'accueil","error":{"Password expired":"Votre mot de passe est expir\xe9","Maximun logins exceeded":"Nombre maximal de connexions d\xe9pass\xe9","Login lockout":"Nombre maximal d\'essai d\xe9pass\xe9. Votre compte est verrouill\xe9.","Wrong password":"Mot de passe incorrect","Invalid username":"Utilisateur invalide"},"google":{"login":"Se connecter avec Google","logged":"Connect\xe9 avec Google"},"microsoft":{"login":"Se connecter avec compte Azure"},"microsoftb2c":{"login":"Se connecter"}}}}')},20551:function(e){"use strict";e.exports=JSON.parse('{"igo":{"common":{"confirmDialog":{"cancelBtn":"Annuler","confirmBtn":"Confirmer","title":"Confirmation"},"table":{"filter":"Filtre"},"entity-table":{"targetHtmlUrl":"Ouvrir le lien externe"},"form":{"errors":{"required":"Ce champ est requis"}},"actionbar":{"scrollUp":"D\xe9filer vers le haut","scrollDown":"D\xe9filer vers le bas","icon":"Actions suppl\xe9mentaires"},"interactiveTour":{"tooltipTourToolButton":"Aide interactive sur l\'outil","disaledTooltipTourToolButton":"Pour avoir acc\xe8s au tour interactif de cet outil, ajouter des contextes ou des couches","buttonTitle":"D\xe9couvrir","exitButton":"Quitter","backButton":"Pr\xe9c\xe9dent","nextButton":"Suivant"},"paginator":{"firstPageLabel":"Premi\xe8re page","itemsPerPageLabel":"Entit\xe9s par page:","lastPageLabel":"Derni\xe8re page","nextPageLabel":"Page suivante","previousPageLabel":"Page pr\xe9c\xe9dente","of":"de"}}}}')},68079:function(e){"use strict";e.exports=JSON.parse('{"igo":{"context":{"bookmarkButton":{"create":"Cr\xe9er un contexte","dialog":{"createMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 cr\xe9\xe9","createTitle":"Contexte cr\xe9\xe9","placeholder":"Titre","title":"Nouveau contexte"}},"contextManager":{"clone":"Cloner ce contexte","delete":"Supprimer ce contexte","dialog":{"cloneMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 clon\xe9","cloneTitle":"Contexte clon\xe9","copyMsg":"Texte copi\xe9","copyTitle":"Identifiant du contexte","confirmDelete":"\xcates-vous s\xfbr de vouloir supprimer ce contexte ?","deleteMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 supprim\xe9","deleteTitle":"Contexte supprim\xe9","favoriteMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 d\xe9fini comme favori","favoriteTitle":"Favori enregistr\xe9","saveMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 enregistr\xe9","saveTitle":"Contexte enregistr\xe9"},"edit":"\xc9diter ce contexte","errors":{"uncaught":{"message":"D\xe9sol\xe9! Le service que vous voulez utiliser n\u2019est malheureusement pas disponible pour le moment. Essayez plus tard!","title":"Erreur de serveur"},"addPermission":"La permission que vous tentez d\'ajouter est d\xe9j\xe0 pr\xe9sente dans le contexte.","addPermissionEmpty":"La permission que vous tentez d\'ajouter n\'est pas valide","addPermissionTitle":"Erreur d\'ajout de permission"},"favorite":"D\xe9finir comme contexte favori","form":{"copy":"Copier l\'identifiant du contexte","edit":"Enregistrer","title":"Titre","titleRequired":"Le titre est obligatoire","uri":"Identifiant","uriRequired":"L\'identifiant est obligatoire"},"invalid":{"text":"Le contexte \\"{{value}}\\" est invalide. Le contexte par d\xe9faut a \xe9t\xe9 charg\xe9.","title":"Contexte invalide"},"managePermissions":"G\xe9rer les permissions du contexte","manageTools":"G\xe9rer les outils du contexte","ourContexts":"Mes contextes","publicContexts":"Contextes publics","save":"Sauvegarder ce contexte","sharedContexts":"Contextes partag\xe9s","filterPlaceHolder":"Filtrer par nom","sortAlphabetically":"Trier en ordre alphab\xe9tique","sortContextOrder":"Replacer selon la date de cr\xe9ation","userAccount":"Profils utilisateurs","filterUser":"Filtrer par groupe d\'utilisateur","emptyContext":"Contexte vide","emptyContextTooltip":"Cr\xe9er un nouveau contexte vide","contextMap":"Contexte \xe0 partir de la carte","contextMapTooltip":"Cr\xe9er un nouveau contexte \xe0 partir des couches la carte","hide":"Masquer ce contexte","show":"Montrer ce contexte","showHidden":"Montrer les contextes masqu\xe9s"},"contextImportExport":{"export":{"exportPlaceHolder":"Couches","exportContextName":"Nom du contexte","exportSelectAll":"Tout s\xe9lectionner","success":{"text":"Contexte export\xe9 avec succ\xe8s.","title":"Exportation r\xe9ussie"},"nothing":{"text":"Impossible d\u2019exporter, contexte non valide ou aucun contexte s\xe9lectionn\xe9.","title":"Donn\xe9e non valide ou non pr\xe9sente"},"failed":{"text":"Impossible d\u2019exporter, probl\xe8me de contexte rencontr\xe9.","title":"Probl\xe8me d\u2019exportation"}},"import":{"success":{"title":"Contexte import\xe9","text":"Le contexte \'{{value}}\' a \xe9t\xe9 ajout\xe9 \xe0 la carte"},"empty":{"text":"Le contexte \'{{value}}\' est vide, impossible d\'importer","title":"Contexte vide"},"invalid":{"text":"Le contexte \'{{value}}\' est invalide.","title":"Context invalide"},"unreadable":{"text":"Le contexte \'{{value}}\' est impossible \xe0 lire","title":"Context illisible"},"tooLarge":{"text":"Le contexte \'{{value}}\' est trop volumineux (Maximum: {{size}} Mo)","title":"Context trop volumineux"}}},"permission":{"addBtn":"Ajouter","delete":"Retirer la permission","dialog":{"addMsg":"La permission \'{{value}}\' a \xe9t\xe9 ajout\xe9e","addTitle":"Permission ajout\xe9e","deleteMsg":"La permission \'{{value}}\' a \xe9t\xe9 supprim\xe9e","deleteTitle":"Permission retir\xe9e","scopeChangedMsg":"La port\xe9e du contexte a \xe9t\xe9 chang\xe9e pour {{value}}","scopeChangedTitle":"Changement de la port\xe9e"},"profil":"Profil","user":"Utilisateur ou groupe","profilRequired":"Le profil est obligatoire","read":"Lecture seule","readOnlyTitle":"Contexte en lecture seule","readOnlyMsg":"Vous pouvez seulement retirer la permission si le contexte est directement partag\xe9 \xe0 votre nom d\'utilisateur.","scope":{"private":"Priv\xe9","protected":"Prot\xe9g\xe9","shared":"Partag\xe9","public":"Public"},"write":"Lecture et \xe9criture"},"poiButton":{"create":"Cr\xe9er une zone d\'int\xe9r\xeat","dialog":{"confirmDelete":"\xcates-vous s\xfbr de vouloir supprimer cette zone d\'int\xe9r\xeat ?","createMsg":"La zone d\'int\xe9r\xeat \'{{value}}\' a \xe9t\xe9 cr\xe9\xe9e","createTitle":"Zone d\'int\xe9r\xeat cr\xe9\xe9e","deleteMsg":"La zone d\'int\xe9r\xeat \'{{value}}\' a \xe9t\xe9 supprim\xe9e","deleteTitle":"Zone d\'int\xe9r\xeat supprim\xe9e","placeholder":"Titre","title":"Nouvelle zone d\'int\xe9r\xeat"},"placeholder":"Zones d\'int\xe9r\xeat"},"sidenav":{"goBack":"Revenir","mainMenu":"Revenir au menu principal"},"shareMap":{"button":"Partager la carte","refreshBtn":"Actualiser le partage","copy":"Copier le lien","shareWithApi":"Partage par contexte","shareWithUrl":"Partage par url","dialog":{"copyMsg":"Lien copi\xe9","copyTitle":"Lien"},"errorTitle":"Erreur lors du partage","placeholderLink":"Lien","included":"Inclus dans le lien de partage :","context":"Le contexte ouvert lors de la cr\xe9ation du lien de partage.","center":"Les coordonn\xe9es du centre de la carte (longitude, latitude).","zoom":"Le niveau de zoom de la carte.","addedLayers":"Les couches ajout\xe9es via le catalogue ou via la barre de recherche.","visibleInvisible":"Le statut de visibilit\xe9 des couches.","excluded":"Exclus dans le lien de partage :","order":"L\'ordre des couches.","opacity":"Les modifications effectu\xe9es \xe0 l\'opacit\xe9 des couches.","filterOgc":"Les ajouts/modifications faits aux filtres par attribut.","filterTime":"La valeur en cours pour les filtres temporels."},"tool":{"dialog":{"addMsg":"L\'outil a \xe9t\xe9 ajout\xe9","addTitle":"Outil ajout\xe9","deleteMsg":"L\'outil a \xe9t\xe9 supprim\xe9","deleteTitle":"Outil retir\xe9"}},"userButton":{"dialog":{"email":"Courriel","expiration":"Expiration","user":"Utilisateur","clearPreferences":"Supprimer mes pr\xe9f\xe9rences"},"infoTitle":"Info sur l\'utilisateur","logout":"Se d\xe9connecter"}}}}')},5415:function(e){"use strict";e.exports=JSON.parse('{"igo":{"core":{"errors":{"uncaught":{"message":"D\xe9sol\xe9! Le service que vous voulez utiliser n\u2019est malheureusement pas disponible pour le moment. Essayez plus tard!","title":"Erreur serveur"}},"network":{"online":{"message":"En ligne","title":"Statut:"},"offline":{"message":"Hors-Ligne","title":"Statut:"}}}}}')},27268:function(e){"use strict";e.exports=JSON.parse('{"igo":{"geo":{"catalog":{"layer.addToMap":"Ajouter \xe0 la carte","layer.addToMapOutRange":"Ajouter \xe0 la carte. La donn\xe9e est non visible \xe0 l\'\xe9chelle active. Veuillez zoomer +/- si vous voulez l\'apercevoir \xe0 la carte.","layer.removeFromMap":"Retirer de la carte","layer.removeFromMapOutRange":"Retirer de la carte. La donn\xe9e est non visible \xe0 l\'\xe9chelle active. Veuillez zoomer +/- si vous voulez l\'apercevoir \xe0 la carte.","group.addToMap":"Ajouter toutes les couches de ce groupe \xe0 la carte","group.removeFromMap":"Retirer toutes les couches de ce groupe de la carte","baseLayers":"Fonds de carte","unavailableTitle":"Catalogue indisponible","unavailable":"Le catalogue \'{{value}}\' est indisponible pour le moment ou vous n\'avez pas les permissions requises.","someUnavailable":"Certaines couches d\'information du catalogue sont indisponible pour le moment ou vous n\'avez pas les permissions requises.","externalProvider":{"catalog":"Ce catalogue provient d\'une organisation externe.","group":"Ces couches proviennent d\'une organisation externe.","layer":"Cette couche provient d\'une organisation externe.","unavailableWithEmail":"Le catalogue \'{{value}}\' est indisponible pour le moment. Pour ajouter un service externe \xe0 la liste pr\xe9d\xe9finie, veuillez contacter {{email}}. Des d\xe9lais peuvent s\'appliquer si probl\xe8me il y a avec le fournisseur externe."},"library.add":"Ajouter ce catalogue","library.cancel":"Annuler","library.remove":"Retirer ce catalogue de la liste","library.inlist":{"title":"Catalogue d\xe9j\xe0 contenu","message":"Le catalogue \xe0 ajouter est d\xe9j\xe0 dans la liste"},"library.addTitle":"Ajout d\'un catalogue","library.addBtn":"Ajouter un catalogue"},"clickOnMap":{"clickedFeature":"Entit\xe9s cliqu\xe9es"},"baselayersSwitcher":{"title":"Fonds de carte"},"dataSource":{"unavailableTitle":"Couche indisponible","optionsApiUnavailable":"L\'information sur les couches n\'a pas pu \xeatre r\xe9cup\xe9r\xe9e. Certaines couches pourraient ne pas pr\xe9senter la bonne information.","unavailable":"La couche \'{{value}}\' est indisponible pour le moment ou vous n\'avez pas les permissions requises."},"dropGeoFile":{"invalid":{"text":"Le fichier \'{{value}}\' est invalide. ({{mimeType}})","title":"Fichier invalide"},"empty":{"text":"Le fichier \'{{value}}\' est vide, impossible d\'importer","title":"Fichier vide"},"success":{"text":"La couche \'{{value}}\' a \xe9t\xe9 ajout\xe9e \xe0 la carte","title":"Fichier import\xe9"},"unreadable":{"text":"Le fichier \'{{value}}\' est impossible \xe0 lire","title":"Fichier illisible"},"tooLarge":{"text":"Le fichier \'{{value}}\' est trop volumineux (Maximum: {{size}} Mo)","title":"Fichier trop volumineux"},"invalidSRS":{"text":"La projection est valide. Elle doit commencer par EPSG:","title":"Projection invalid"},"ogreServer":{"title":"Erreur 500 du service Ogre","text":"Erreur de la conversion du fichier en geojson. Il est possible que le fichier soit trop volumineux, essayer de l\'importer en format geojson"}},"export":{"customList":{"text":"Certaines couches s\xe9lectionn\xe9es ( {{value}} ) r\xe9duisent la liste des formats possible","title":"Liste restreinte de formats"},"nothing":{"text":"Impossible d\u2019exporter, donn\xe9e non valide ou aucune donn\xe9e s\xe9lectionn\xe9e.","title":"Donn\xe9e non valide ou non pr\xe9sente"},"noFormat":{"text":"Aucun format d\'exportation valide pour toutes les couches s\xe9lectionn\xe9es. Veuillez exporter les couches une \xe0 la fois.","title":"Aucun format disponible"},"failed":{"text":"Impossible d\u2019exporter, probl\xe8me de donn\xe9e rencontr\xe9.","title":"Probl\xe8me d\u2019exportation"},"popupBlocked":{"text":"</br>Veuillez autoriser l\'ouverture des fen\xeatres (popup) dans votre fureteur. </br>Pour Chrome and Edge, \xe0 droite dans la barre d\'adresse).</br>{{extraMessage}}","selectAgain":"Faites le correctif et s\xe9lectionner \xe0 nouveau un format.","retry":"Veuillez recommencer l\'exportation.","title":"Ouverture de fen\xeatre bloqu\xe9e par votre fureteur"},"success":{"text":"Donn\xe9es export\xe9es avec succ\xe8s.","title":"Exportation r\xe9ussie"},"format":{"GeoJSON":"GeoJSON","GML":"GML","GPX":"GPX","KML":"KML","Shapefile":"Shapefile","CSVcomma":"CSV (s\xe9parateur virgule)","CSVsemicolon":"CSV (compatible Excel)","URL":"Lien externe"},"gpx.error.poly":{"title":"GPX en erreur","text":"Le format GPX ne permet pas de stocker les polygones"},"encoding":{"LATIN1":"LATIN-1","UTF8":"UTF-8"}},"importExportForm":{"exportButton":"Exporter","exportButtonLink":"Ouvrir le lien","exportButtonLinks":"Ouvrir les liens","exportCircleToPolygon":"Transformer les entit\xe9s de type Cercle en polygones","exportFormatPlaceholder":"Format","exportLayerPlaceholder":"Couche(s)","exportFileNamePlaceholder":"Nom du fichier","encodingPlaceholder":"Encodage","exportTabTitle":"Exporter","exportFeatureInExtent":"Seulement les entit\xe9s contenues dans la carte","exportNoLayersExportable":"Aucune couche exportable dans la carte courante","exportSelectedFeature":"Seulement les entit\xe9s s\xe9lectionn\xe9es","importButton":"Importer","importProjPlaceholder":"Syst\xe8me de coordonn\xe9es du fichier \xe0 importer","importTabTitle":"Importer","importClarifications":"Pr\xe9cisions","importSizeMax":"La taille limite du fichier est de {{size}} Mo","importFormatAuthorized":"Formats autoris\xe9s: geojson, kml, gpx, gml, shapefile","importShpZip":"Les shapefiles doivent \xeatre compress\xe9s (zipp\xe9s) ET leurs g\xe9om\xe9tries doivent \xeatre en coordonn\xe9es Latitude Longitude (EPSG:4326/WGS84)","other":"autre","others":"autres","projections":{"mtm":"MTM {{zone}} ({{code}})","utm":"UTM {{zone}} ({{code}})","webMercator":"Web Mercator ({{code}})","nad83":"Lat-Long NAD83 ({{code}})","wgs84":"Lat-Long WGS84 ({{code}})","choose":"Vous devez choisir une projection avant d\'importer le fichier."}},"operators":{"caseSensitive":"Sensible \xe0 la case","And":"Et","Or":"Ou","PropertyIsEqualTo":"=","PropertyIsNotEqualTo":"!=","PropertyIsLike":"\u2248","PropertyIsGreaterThan":">","PropertyIsGreaterThanOrEqualTo":">=","PropertyIsLessThan":"<","PropertyIsLessThanOrEqualTo":"<=","PropertyIsBetween":"entre","During":"durant (temporel)","PropertyIsNull":"est nul","Intersects":"intersecte (g\xe9om\xe9trique)","Within":"contenu dans (g\xe9om\xe9trique)","Contains":"contient (g\xe9om\xe9trique)","tooltip":{"And":"Op\xe9rateur logique entre les filtres o\xf9 les deux conditions doivent \xeatre remplies","Or":"Op\xe9rateur logique entre les filtres o\xf9 au moins une (1) condition doit \xeatre vraie","PropertyIsEqualTo":"Identique (sensible \xe0 la case)","PropertyIsNotEqualTo":"Diff\xe9rent (sensible \xe0 la case)","PropertyIsLike":"Comme. Exemple: *route* trouve toutes les valeurs contenent \'route\', peu importe sa position dans l\'attribut. route* trouve toutes les valeurs commencant par \'route\'. Options avanc\xe9es : wildCard =\'*\', singleChar = \'.\' escapeChar = \'!\' (sensible \xe0 la case)","PropertyIsGreaterThan":"Plus grand","PropertyIsGreaterThanOrEqualTo":"Plus grand ou \xe9gal","PropertyIsLessThan":"Plus petit","PropertyIsLessThanOrEqualTo":"Plus petit ou \xe9gal","PropertyIsBetween":"Doit \xeatre contenu entre les limites inf\xe9rieure et sup\xe9rieure (les valeurs sont incluses)","During":"Doit \xeatre contenu entre les p\xe9riodes de temps sp\xe9cifi\xe9es","PropertyIsNull":"Dont l\'attribut est nul","Intersects":"Retourne les entit\xe9s \xe9tant en intersection g\xe9om\xe9trique avec la g\xe9om\xe9trie fournie","Within":"Retourne les entit\xe9s \xe9tant enti\xe8rement contenue par la g\xe9om\xe9trie fournie (Within)","Contains":"Retourne les entit\xe9s compl\xe8tement contenues par la g\xe9om\xe9trie fournie (Contains)"}},"sourceFields":{"selectField":"Choisir un champ"},"filter":{"resetFilters":"(Appliquer aucun filtre)","addFilter":"Ajouter un filtre vide \xe0 la liste courante","removeFilter":"Supprimer le pr\xe9sent filtre \xe0 la liste des filtres","toggleFilterState":"Activer/d\xe9sactiver le pr\xe9sent filtre","refreshFilters":"Mettre \xe0 jour la source de donn\xe9e avec les filtres actifs de la liste. Pour activer ce boutton, la couche doit etre visible (et dans les \xe9chelles permises) ou veillez modifier le pr\xe9sent filtre.","layerFiltered":"Cette couche d\'information est pr\xe9sentement filtr\xe9e.","layerFilterable":"Cette couche d\'information est filtrable","filterBy":"Filtrer par","advancedOgcFilters":"Filtres avanc\xe9s","displayMoreResults":"Afficher plus (+)","displayLessResults":"Afficher moins (-)","placeholder":"Saisir une valeur","placeholderSnrc":"Ex: 21L14","selectOperator":"Choisir un op\xe9rateur","sliderModeTitle":"Curseur temporel","reportingDate":"Date de signalement"},"spatialSelector":{"fixedExtent":"\xc9tendue fixe","btnSetExtent":"D\xe9finir l\'\xe9tendue du filtre selon l\'\xe9tendue courante de la carte","snrc":"SNRC","selectFeature":"","drawFeature":""},"layer":{"hideLayer":"Masquer la couche","hideSelectedLayers":"Masquer les couches s\xe9lectionn\xe9es","lowerLayer":"Mettre en arri\xe8re","filterLowerLayer":"Le d\xe9placement arri\xe8re se fait toujours selon l\'ordre de la carte!","filterPlaceholder":"Filtrer la liste de couches","activateSelectionMode":"Activer le mode de s\xe9lection multiple","deactivateSelectionMode":"D\xe9sactiver le mode de s\xe9lection multiple","tools":"Outils","selectAll":"S\xe9lectionner toutes les couches","deselectAll":"D\xe9s\xe9lectionner toutes les couches","zoomLayer":"Cadrer sur l\'\xe9tendue de la couche","zoomLayers":"Cadrer sur l\'\xe9tendue des couches s\xe9lectionn\xe9es","opacity":"Opacit\xe9","raiseLayer":"Mettre en avant","filterRaiseLayer":"Le d\xe9placement avant se fait toujours selon l\'ordre de la carte!","moreOptions":"Outils de la couche","removeLayer":"Retirer la couche de la carte","removeSelectedLayers":"Retirer les couches s\xe9lectionn\xe9es de la carte","removeSelectedLayersRestriction":"Certaines couches s\xe9lectionn\xe9es ne peuvent \xeatre supprim\xe9es","showFeaturesList":"Afficher la liste des entit\xe9s","showLayer":"Afficher la couche","showSelectedLayers":"Afficher les couches s\xe9lectionn\xe9es","subsetLayersListKeyword":"Limiter l\'affichage de la liste selon le titre ou  par type (wms, wfs,...)","deleteKeyword":"Supprimer le mot-cl\xe9","subsetLayersListOnlyVisible":"Conserver seulement les couches visibles","subsetLayersListOnlyInRange":"Conserver seulement les couches de la plage d\'\xe9chelle active","sortAlphabetically":"Trier la liste des couches en ordre alphab\xe9tique","sortMapOrder":"Replacer les couches selon l\'ordre cartographique","resetLayersList":"R\xe9tablir l\'affichage de l\'ensemble des couches","trackFeature":"Suivre l\'entit\xe9","legend":{"default":"D\xe9faut","loadingLegendText":"Chargement de la l\xe9gende","noLegendText":"Aucune symbologie disponible pour cette couche","noLegendScale":"Aucune symbologie disponible pour cette \xe9chelle","selectStyle":"S\xe9lectionner le style de la l\xe9gende","showAll":"Montrer toutes les couches (non visible et hors \xe9chelle)","noLayersVisibleWithShowAllButton":"Aucune couche actuellement visible. Activez le bouton ci haut pour voir toutes les l\xe9gendes.","noLayersVisibleWithShowAllButtonButZoom":"Aucune couche actuellement visible. Si vous zoomez dans la carte, certaines couches appara\xeetront OU activez le bouton ci haut pour voir toutes les l\xe9gendes.","noLayersVisible":"Aucune couche actuellement visible.","noLayersVisibleButZoom":"Aucune couche actuellement visible. Par contre, si vous zoomez dans la carte, certaines couches appara\xeetront."}},"download":{"action":"T\xe9l\xe9charger les donn\xe9es associ\xe9es","title":"T\xe9l\xe9chargement des donn\xe9es","start":"V\xe9rifiez la progression du t\xe9l\xe9chargement dans votre navigateur","end":"Termin\xe9"},"mapButtons":{"baselayerSwitcher":"Changer le fond de carte","geolocate":"Afficher votre position","offline":"Passer en mode hors-ligne","online":"Passer en mode en ligne","zoomIn":"Zoomer ({{zoom}})","zoomOut":"D\xe9zoomer ({{zoom}})","resetRotation":"R\xe9initialiser la carte vers le nord","tipRotation":"Maintenez les touches Alt et Majuscule (shift) tout en cliquant sur la carte pour faire pivoter la carte"},"metadata":{"show":"Montrer les m\xe9tadonn\xe9es"},"printForm":{"corsErrorMessageBody":"Impossible d\'imprimer d\xfb \xe0 des droits d\'acc\xe8s non d\xe9tenus","corsErrorMessageHeader":"Impression","comment":"Commentaire","doZipFile":"Compresser le fichier","outputFormat":"Format de sortie","paperFormat":"Format du papier","paperFormats":{"A0":"33.1 X 46.8\\" (A0)","A1":"23.4 X 33.1\\" (A1)","A2":"16.5 X 23.5\\" (A2)","A3":"11.7 X 16.5\\" (A3)","A4":"8.3 X 11.7\\" (A4)","A5":"5.8 X 8.3\\" (A5)","Letter":"Lettre","Legal":"L\xe9gal"},"imageFormat":"Format de l\'image","orientation":"Orientation","landscape":"Paysage","portrait":"Portrait","projection":"Projection","resolution":"R\xe9solution","saveBtn":"Sauvegarder","scale":"\xc9chelle","showProjection":"Afficher la projection","showScale":"Afficher l\'\xe9chelle","title":"Titre","subtitle":"Sous-titre","legendPosition":"Position de la l\xe9gende","legendPositions":{"none":"Aucune l\xe9gende","topleft":"Coin haut gauche de la carte","topright":"Coin haut droit de la carte","bottomleft":"Coin bas gauche de la carte","bottomright":"Coin bas droit de la carte","newpage":"Sur une nouvelle page"}},"directionsForm":{"stopLayer":"Itin\xe9raire - Arr\xeats","routeLayer":"Itin\xe9raire - Trac\xe9","start":"D\xe9but","intermediate":"Interm\xe9diaire","end":"Fin","directionsBtn":"Obtenir l\'itin\xe9raire","resetDirectionsBtn":"Supprimer l\'itin\xe9raire","zoomRoute":"Zoomer sur l\'itin\xe9raire","null":"","directions":"Itin\xe9raire","raiseStop":"Prioriser l\'arr\xeat","lowerStop":"Reporter l\'arr\xeat plus loin dans le parcours","addStop":"Ajouter un arr\xeat","clearStop":"R\xe9initialiser cet arr\xeat","moveStop":"D\xe9placer cet arr\xeat","removeStop":"Supprimer l\'arr\xeat","drivingOptions":"Choix d\'itin\xe9raires","summary":"R\xe9sum\xe9 de l\'itin\xe9raire","stopsList":"Liste des lieux d\'arr\xeats","instructions":"Indications","copy":"Copier l\'itin\xe9raire","geolocate":"Utiliser sa localisation comme point d\'arr\xeat","link":"Lien","dialog":{"copyMsg":"Itin\xe9raire copi\xe9 dans le presse-papier","copyMsgLink":"Le lien de l\'itin\xe9raire est copi\xe9 dans le presse-papier","copyTitle":"Itin\xe9raire"}},"directions":{"uturn":"demi-tour","sharp right":"fortement \xe0 droite","right":"droite","slight right":"l\xe9g\xe8rement \xe0 droite","sharp left":"fortement \xe0 gauche","left":"gauche","slight left":"l\xe9g\xe8rement \xe0 gauche","straight":"tout droit","turn":{"straight":"Continuer sur {{route}}","uturn":"Faire demi-tour sur {{route}}","else":"Tourner {{aggregatedDirection}} sur {{route}}"},"new name":"Continuer en direction {{translatedDirection}} sur {{route}}","depart":"Aller en direction {{translatedDirection}} sur {{route}}","arrive":{"lastStep":"Vous \xeates arriv\xe9 {{coma}} {{aggregatedDirection}}","intermediate":"Vous atteignez le point interm\xe9diare sur {{route}}"},"merge":"Continuer sur {{route}}","on ramp":"Prendre l\'entr\xe9e d\'autoroute {{aggregatedDirection}}","off ramp":"Prendre la sortie d\'autoroute {{aggregatedDirection}}","fork":{"left":"Garder la gauche sur {{route}}","right":"Garder la droite sur {{route}}","else":"Continuer sur {{route}}"},"end of road":"\xc0 la fin de la route, tourner {{translatedModifier}} sur {{route}}","use lane":"Prendre la voie de ...","continue":{"notUturn":"Continuer sur {{route}}"},"roundabout":"Au rond-point, prendre la {{exit}}{{cntSuffix}} sortie vers {{route}}","rotary":"Rond-point rotary ...","roundabout turn":"Rond-point, prendre la ...","exit roundabout":"Poursuivre vers {{route}}","notification":"notification ...","uturnText":"Faire demi-tour et continuer en direction {{translatedDirection}} sur {{route}}","unknown":"???","cntSuffix":{"first":"\xe8re","secondAndMore":"e"},"modifier":{"prefix":"\xe0 "}},"cardinalPoints":{"n":"nord","ne":"nord-est","e":"est","se":"sud-est","s":"sud","sw":"sud-ouest","w":"ouest","nw":"nord-ouest"},"search":{"placeholder":"Rechercher une localisation ou une couche de donn\xe9es","emptyType.placeholder":"Veuillez choisir un type de recherche","feature.title":"Localisation","feature.placeholder":"Rechercher une localisation","layer.title":"Couche de donn\xe9es","layer.placeholder":"Rechercher une couche de donn\xe9es.","ichercheReverse.name":"Recherche par coordonn\xe9es","ilayer":{"name":"Couches","properties":{"abstract":"Description","groupTitle":"Groupe","title":"Titre","type":"Type","url":"URL","metadataUrl":"M\xe9tadonn\xe9es","name":"Nom de la couche","urlInfo":"Lien du service web WMS/WFS","downloadUrl":"Lien de t\xe9l\xe9chargement de la donn\xe9es"},"type":{"layer":"Couche","groupLayer":"Groupe de couches"}},"nominatim":{"type":{"food":"Restauration","health":"Sant\xe9","entertainment":"Divertissement","finance":"Finance"},"country":{"all":"Le monde","canada":"Canada"}},"icherche":{"name":"iCherche","type":{"address":"Adresse","oldAddress":"Ancienne adresse","district":"Arrondissement","postalCode":"Code Postal","city":"Municipalit\xe9","oldCity":"Ancienne municipalit\xe9","mrc":"MRC","regadmin":"R\xe9gion administrative","road":"Route","intersection":"Intersection","place":"Lieu","exit":"Sortie d\'autoroute","cn":"Borne du CN","gcc":"Rep\xe8re de la garde coti\xe8re (GCC)","sumi":"Borne SUMI","km":"Rep\xe8re kilom\xe9trique","hq":"Hydro-Qu\xe9bec","entreprise":"Entreprise","cadastre":"Cadastre"},"restrictExtent":{"map":"\xc0 l\'\xe9tendue de la carte","quebec":"Au Qu\xe9bec"}},"coordinates":{"name":"Coordonn\xe9es","coord":"Coordonn\xe9e (longitude, latitude)","coordDMS":"Coordonn\xe9e (longitude, latitude) (DMS)","radius":"Rayon","conf":"Confiance"},"menu.tooltip":"Options de recherche","settings":{"title":"Param\xe8tres"},"pointerSearchSummary":{"title":"Position du curseur","tooltip":"Afficher les coordonn\xe9es du curseur ainsi que d\'autres informations sur sa position en fonction des types de r\xe9sultats activ\xe9es. Utiliser F2 pour activer / d\xe9sactiver."},"searchResultsGeometry":{"title":"Montrer tous les r\xe9sultats","tooltip":"Afficher/cacher la g\xe9om\xe9trie des r\xe9sultats"},"searchSources":{"selectAll":"Tout s\xe9lectionner","unselectAll":"Tout d\xe9s\xe9lectionner","settings":{"results type":"Type de r\xe9sultat","ecmax":"\xc9cart maximal","radius":"Rayon de recherche","results limit":"Nombre de r\xe9sultats","multiple object":"Objet multiple","restrictExtent":"Restreint l\'\xe9tendue","selectAll":"Tout s\xe9lectionner","unselectAll":"Tout d\xe9s\xe9lectionner","true":"Oui","false":"Non"}},"displayMoreResults":"Afficher plus de r\xe9sultats"},"geometry":{"geometry":"Geometrie","point":"Point","line":"Ligne","polygon":"Surface"},"targetHtmlUrl":"Ouvrir le lien externe","searchByCoord":"Rechercher par coordonn\xe9es","searchByName":"Rechercher par nom","seeRouting":"Voir l\'itin\xe9raire","timeFilter":{"date":"Date","endDate":"Date de fin","startDate":"Date de d\xe9but","hour":"Heure","minute":"Minute","endYear":"Ann\xe9e de fin","startYear":"Ann\xe9e de d\xe9but"},"spatialFilter":{"spatialFilter":"Filtre spatial","predefined":"Zone Pr\xe9d\xe9finie","draw":"Dessin","polygon":"Polygone","point":"Cercle","drawPolygon":"Dessiner un polygone","drawCircle":"Dessiner un cercle","searchLabel":"Rechercher par","buffer":"Zone tampon","search":"Recherche","drawControl":"Activer le contr\xf4le de dessin","listLabel":"Zone","entity":"Entit\xe9","layer":"Couche","goSearch":"Lancer la recherche","removeLayer":"Retirer les r\xe9sultats","exportLayer":"Exporter les r\xe9sultats","clearForm":"Retirer le dessin","clearSearch":"R\xe9initialiser les champs","Address":"Adresses","Thematics":"Th\xe9matiques","searchResults":"R\xe9sultats de la recherche","type":"Type","radius":"Rayon","radiusAlert":"Le rayon doit \xeatre compris entre 0 et 100 kilom\xe8tres (ou 100 000 m\xe8tres)","bufferAlert":"La zone tampon doit \xeatre comprise entre 0 et 100 kilom\xe8tres (ou 100 000 m\xe8tres)","maxSizeAlert":"Le nombre de r\xe9sultats exc\xe8de 10000. Certains pourraient \xeatre manquants.","zeroResults":"Aucun r\xe9sultat ne correspond \xe0 cette recherche.","warning":"Avertissement","freehandControl":"\xc0 main lev\xe9e","group":{"toponyme":"Toponyme","culturel":"Culturel","education":"\xc9ducation","sante":"Sant\xe9","securite":"S\xe9curit\xe9","sepaq":"S\xc9PAQ","transport":"Transport"}},"terrapi":{"AdmRegion":"R\xe9gions administratives","Mun":"Municipalit\xe9s","Arrond":"Arrondissements","CircFed":"Circonscriptions f\xe9d\xe9rales","CircProv":"Circonscriptions provinciales","DirReg":"Directions r\xe9gionales","MRC":"MRC","RegTour":"R\xe9gions touristiques","limites":"Limites administratives","bornes":"Bornes sumi","hydro":"Hydrographie","routes":"Routes","bati":"B\xe2timents","batiment":"B\xe2timents","camping":"Camping","equipement":"\xc9quipements","commun":"Commun","geographie":"Lieux naturels","parc":"Parcs","secteur":"Secteurs","immeubles":"Immeubles patrimoniaux","sites":"Sites patrimoniaux","cpe":"Centre de la petite enfance","public":"\xc9coles publiques","prive":"\xc9coles priv\xe9s","gouvernemental":"\xc9coles gouvernementales","colleges":"Coll\xe8ges","universites":"Universit\xe9s","aine":"R\xe9sidences pour a\xeen\xe9s","ambulance":"Zones d\'ambulance","clinique":"Cliniques","etabl":"\xc9tablissements de sant\xe9","gmf":"Groupes de m\xe9decins de famille","naissance":"Maisons de naissances","pharmacie":"Pharmacies","casernes":"Casernes de pompiers","correctionnel":"Centres correctionnels","organisme":"Organismes de s\xe9curit\xe9","palais-justice":"Palais de justice","penitencier-fed":"P\xe9nitenciers f\xe9d\xe9raux","penitencier-prov":"P\xe9nitenciers provinciaux","polices":"Poste de police"},"measure":{"dialog":{"title":"Sommes de la s\xe9lection","length.title":"Distance","area.title":"Superficie","lengthInMeters":"m","lengthInKilometers":"km","lengthInMiles":"mi","lengthInFeet":"pi","areaInSquareMeters":"m\xb2","areaInSquareKilometers":"km\xb2","areaInSquareMiles":"mi\xb2","areaInHectares":"ha","areaInAcres":"ac","perimeterInMeters":"P\xe9rim\xe8tre en m\xe8tres"},"layerTitle":"Mesure \xe0 la carte","area":"Superficie","areaHeader":"Superficie","length":"Distance","lengthHeader":"Distance / P\xe9rim\xe8tre","perimeter":"P\xe9rim\xe8tre","meters":"m","m":"m","kilometers":"km","km":"km","miles":"mi","mi":"mi","feet":"pi","ft":"pi","squareMeters":"m\xb2","m\xb2":"m\xb2","squareKilometers":"km\xb2","km\xb2":"km\xb2","squareMiles":"mi\xb2","mi\xb2":"mi\xb2","squareFeet":"pi\xb2","ft\xb2":"pi\xb2","hectares":"ha","ha":"ha","acres":"ac","ac":"ac","toggleActive":"Activer le contr\xf4le de mesure","toggleDisplayLines":"Afficher les distances pour les lignes","toggleDisplayDistance":"Afficher les distances pour les superficies","toggleDisplayAreas":"Afficher les superficies","toggleAutoUnits":"Unit\xe9s automatiques","actionbar":{"calculate.tooltip":"Totaux et conversions","delete.tooltip":"Supprimer","modify.tooltip":"Modifier"}},"draw":{"abort":"Annuler le dessin en cours","cancelColorPicker":"Annuler","Circle":"Cercle","colorPicker":"Cliquer pour ouvrir le s\xe9lecteur de couleurs","dialogInstruction":"Veuillez entrer l\'\xe9tiquette de votre dessin","dialogTitle":"\xc9tiquette","delete":"Retirer les dessins de la carte","drawing":"Dessins","fill":"Remplissage","finish":"Terminer le dessin en cours","icon":"Ic\xf4nes","labels":"\xc9tiquettes","LineString":"Ligne","move":"Centrer la vue sur le curseur","noIcon":"Aucune ic\xf4ne","noLabel":"Aucune \xe9tiquette","Point":"Point","Polygon":"Polygone","radius":"Rayon","shortcuts":"Raccourcis clavier","stroke":"Contour","styleSelect":"S\xe9lectionner le style","toggleMapTooltips":"Afficher les \xe9tiquettes","undo":"Retirer le dernier sommet"},"network":{"online":{"message":"En ligne","title":"Statut:"},"offline":{"message":"Hors-Ligne","title":"Statut:"}},"workspace":{"inMapExtent.active.tooltip":"Ne montrer que les enregistrements contenus dans la carte","inMapExtent.inactive.tooltip":"Montrer tous les enregistrements"}}}}')},63031:function(e){"use strict";e.exports=JSON.parse("{\"igo\":{\"integration\":{\"tools\":{\"catalog\":\"Catalogue\",\"contexts\":\"Contextes\",\"directions\":\"Itin\xe9raire\",\"draw\":\"Dessin\",\"importExport\":\"Importer et exporter\",\"ogcFilter\":\"Filtrer par\",\"map\":\"Carte\",\"layers\":\"Couches\",\"legend\":\"L\xe9gende\",\"measurer\":\"Mesurer\",\"print\":\"Imprimer\",\"searchResults\":\"R\xe9sultats de recherche\",\"shareMap\":\"Partager\",\"timeFilter\":\"Filtre temporel\",\"about\":\"\xc0 propos\",\"spatialFilter\":\"Filtre spatial\",\"advancedMap\":\"Outils avanc\xe9s\"},\"searchResultsTool\":{\"noResults\":\"Aucun r\xe9sultat\",\"doSearch\":\"Veuillez effectuer une recherche dans la barre de recherche ci-dessus.\",\"examples\":\"<b>Permet de rechercher des adresses, des lieux, des coordonn\xe9es ou des couches</b>.<br><br>Les recherches d'<u>adresses</u> peuvent \xeatre effectu\xe9es selon une combinaison: <ul><li>du no. immeuble</li><li>du nom de la rue</li><li>de la ville</li><li>du code postal</li></ul> Exemples pour les <u>lieux</u>: <ul><li>Lac Poulin</li><li>Mcdo L\xe9vis</li><li>Saint-Isidore</li></ul> Vous pouvez aussi utiliser des mots cl\xe9s pour pr\xe9ciser votre recherche. Exemples: <ul><li>#mun qu\xe9bec (pour rechercher une municipalit\xe9)</li><li>#sante L\xe9vis (pour rechercher un \xe9tablissement de sant\xe9)</li><li>#cpe joyeux (pour rechercher un centre de la petite enfance)</li><li>#intersection li\xe9gois + \xe9glise (pour rechercher une intersection, le #+ peut aussi \xeatre utilis\xe9)</li></ul>*Les mots cl\xe9s apparaissent au survol d'un type dans l'onglet des param\xe8tres de recherche -> iCherche -> Type de r\xe9sultat.<br><br>Exemple pour les <u>coordonn\xe9es</u> :<ul><li>Degr\xe9 d\xe9cimal (-68.165547, 48.644546)</li><li>Degr\xe9 minute seconde (-68 9 56, 48 38 40)</li><li>Degr\xe9 minute d\xe9cimal (-68 9.56, 48 38.40)</li><li>Projet\xe9 (UTM-19 561466.861, 5388278.862)</li><li>BELL (Lat: 48 38 40N Long: 68 9 56W UNC:100 CONF:90)</li><li>Metre Metre (111594.63, 445854.74;32198)</li></ul>Pour plus d'informations sur la recherche par coordonn\xe9es : <a href='https://igo2.readthedocs.io/fr/next/properties.html#coordonnees' target='_blank'>Consulter la documentation d'IGO2</a>\",\"zoomOnFeatureTooltip\":\"Zoomer sur l'entit\xe9 s\xe9lectionn\xe9e.\",\"zoomOnFeatureTooltipOutOfView\":\"L'entit\xe9 est hors de la vue. Zoomer sur l'entit\xe9 s\xe9lectionn\xe9e.\"},\"aboutTool\":{\"headerHtml\":\"\",\"html\":\"<style>#about .bold_class{font-weight: bold;}#about .red{color: red;}#about .tool_name{border-top: 1px solid; padding-top: 10px;}#about .titre_outil{font-weight: bold; font-size: 18px; padding-bottom: 8px;}#about .subtitle{font-size: 20px; padding-bottom: 10px;}#about .align_right{text-align: right;}#about .describe{text-align: justify;}#about a img{color: black; text-decoration: none;}</style><body> <div id='about'> <div class='bold_class subtitle'>Aper\xe7u des fonctionnalit\xe9s</div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z'> </path> </svg></mat-icon> Recherche </div><div class='describe'> Situ\xe9e dans la portion sup\xe9rieure gauche de l\u2019interface, la barre de <span class='bold_class'>Recherche</span> permet de se positionner \xe0 l\u2019aide d\u2019une adresse, d\u2019un lieu ou de coordonn\xe9es GPS et peut \xe9galement servir \xe0 rechercher une couche. <br><br> Il est \xe9galement possible de rechercher un \xe9l\xe9ment par type de r\xe9sultats en utilisant le hashtag \xab # \xbb (par exemple, #municipalites qu\xe9bec). Les accents et les lettres majuscules n'importent pas lors de l'utilisation du hashtag et n'ont pas d'impact sur les <span class='bold_class'>R\xe9sultats de recherche</span>.</div></div><br><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z'></path> </svg></mat-icon> Contextes </div><div class='describe'> Les <span class='bold_class'>Contextes</span> permettent de visualiser des regroupements de couches faits par th\xe8me ou par contexte de travail. Lorsqu'un contexte est s\xe9lectionn\xe9, toutes les couches qu'il contient se retrouvent alors dans la <span class='bold_class'>Carte</span>. Il est possible d'ajouter d\u2019autres couches \xe0 partir du <span class='bold_class'>Catalogue</span> ou de l\u2019outil <span class='bold_class'>Recherche.</span> </div><br><div class='red'> <span class='bold_class'>ATTENTION :</span> Si un nouveau contexte est s\xe9lectionn\xe9, toutes les couches affich\xe9es dans la <span class='bold_class'>Carte</span> seront remplac\xe9es par celles de ce nouveau contexte. </div><br><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M15,19L9,16.89V5L15,7.11M20.5,3C20.44,3 20.39,3 20.34,3L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21C3.55,21 3.61,21 3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3Z'> </path> </svg></mat-icon> Carte </div><div class='describe'> Il est possible de personnaliser la <span class='bold_class'>Carte</span> \xe0 partir du <span class='bold_class'>Catalogue</span> ou de l\u2019outil <span class='bold_class'>Recherche.</span> Cet espace permet entre autres d\u2019ajouter, de supprimer, d\u2019interroger, de filtrer et de trier les couches pr\xe9sent\xe9es. Il est \xe9galement possible d'afficher les l\xe9gendes des couches.</div><br></div><div class='tool_name'><div class='titre_outil'><mat-icon class='mat-icon'><svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'><path d='M2 4C2 2.89 2.9 2 4 2H7V4H4V7H2V4M22 4V7H20V4H17V2H20C21.1 2 22 2.89 22 4M2 20V17H4V20H7V22H4C2.9 22 2 21.11 2 20M10 2H14V4H10V2M10 20H14V22H10V20M2 10H4V14H2V10M18.5 13C20.4 13 22 14.6 22 16.5C22 19.1 18.5 23 18.5 23C18.5 23 15 19.1 15 16.5C15 14.6 16.6 13 18.5 13M18.5 17.8C19.2 17.8 19.8 17.2 19.7 16.6C19.7 16 19.1 15.4 18.5 15.4C17.9 15.4 17.3 15.9 17.3 16.6C17.3 17.2 17.8 17.8 18.5 17.8M20 10H22V12.34C21.42 11.84 20.74 11.45 20 11.23V10Z'></path></svg></mat-icon> Filtre spatial </div><div class='describe'> Le <span class='bold_class'>Filtre spatial</span> permet de rechercher des adresses ou des th\xe9matiques selon des zones pr\xe9d\xe9finies (par exemple, par arrondissement ou par MRC) ou selon un dessin r\xe9alis\xe9 par l'utilisateur. Les r\xe9sultats du filtre peuvent \xeatre export\xe9s \xe0 l'aide de l'outil <span class='bold_class'>Importer et exporter</span>. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M1.39,18.36L3.16,16.6L4.58,18L5.64,16.95L4.22,15.54L5.64,14.12L8.11,16.6L9.17,15.54L6.7,13.06L8.11,11.65L9.53,13.06L10.59,12L9.17,10.59L10.59,9.17L13.06,11.65L14.12,10.59L11.65,8.11L13.06,6.7L14.47,8.11L15.54,7.05L14.12,5.64L15.54,4.22L18,6.7L19.07,5.64L16.6,3.16L18.36,1.39L22.61,5.64L5.64,22.61L1.39,18.36Z'> </path> </svg></mat-icon> Mesurer </div><div class='describe'> Cet outil permet de <span class='bold_class'>Mesurer</span> des distances ou des superficies directement sur la carte. </div><br></div><div class='tool_name'><div class='titre_outil'><mat-icon class='mat-icon'><svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'><path d='M9.75 20.85C11.53 20.15 11.14 18.22 10.24 17C9.35 15.75 8.12 14.89 6.88 14.06C6 13.5 5.19 12.8 4.54 12C4.26 11.67 3.69 11.06 4.27 10.94C4.86 10.82 5.88 11.4 6.4 11.62C7.31 12 8.21 12.44 9.05 12.96L10.06 11.26C8.5 10.23 6.5 9.32 4.64 9.05C3.58 8.89 2.46 9.11 2.1 10.26C1.78 11.25 2.29 12.25 2.87 13.03C4.24 14.86 6.37 15.74 7.96 17.32C8.3 17.65 8.71 18.04 8.91 18.5C9.12 18.94 9.07 18.97 8.6 18.97C7.36 18.97 5.81 18 4.8 17.36L3.79 19.06C5.32 20 7.88 21.47 9.75 20.85M20.84 5.25C21.06 5.03 21.06 4.67 20.84 4.46L19.54 3.16C19.33 2.95 18.97 2.95 18.76 3.16L17.74 4.18L19.82 6.26M11 10.92V13H13.08L19.23 6.85L17.15 4.77L11 10.92Z'></path></svg></mat-icon> Dessin </div><div class='describe'> L'outil <span class='bold_class'>Dessin</span> permet de dessiner des entit\xe9s ponctuelles, lin\xe9aires, polygonales ou circulaires accompagn\xe9es ou non d'\xe9tiquettes. La couleur de remplissage et du contour des entit\xe9s peuvent \xeatre choisies \xe0 l'aide des s\xe9lecteurs correspondants. <br><br> Une couche Dessins peut \xeatre export\xe9e \xe0 l'aide de l'outil <span class='bold_class'>Importer et exporter</span>. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M14,14.5V12H10V15H8V11A1,1 0 0,1 9,10H14V7.5L17.5,11M21.71,11.29L12.71,2.29H12.7C12.31,1.9 11.68,1.9 11.29,2.29L2.29,11.29C1.9,11.68 1.9,12.32 2.29,12.71L11.29,21.71C11.68,22.09 12.31,22.1 12.71,21.71L21.71,12.71C22.1,12.32 22.1,11.68 21.71,11.29Z'> </path> </svg></mat-icon> Itin\xe9raire </div><div class='describe'> Il est possible de construire un <span class='bold_class'>Itin\xe9raire</span> entre deux points en s\xe9lectionnant un point de d\xe9part et un point d'arriv\xe9e dans la carte ou en recherchant des adresses. Il est ensuite possible d'ajouter des points d'arr\xeat interm\xe9diaires et de copier la description ou le lien de l'itin\xe9raire dans le presse-papier. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M17,14H19V17H22V19H19V22H17V19H14V17H17V14M11,16L2,9L11,2L20,9L11,16M11,18.54L12,17.75V18C12,18.71 12.12,19.39 12.35,20L11,21.07L2,14.07L3.62,12.81L11,18.54Z'></path> </svg></mat-icon> Catalogue </div><div class='describe'> Le <span class='bold_class'>Catalogue</span> contient toutes les couches qui peuvent \xeatre ajout\xe9es \xe0 la <span class='bold_class'>Carte</span>. L'utilisateur doit cliquer sur + de la couche d\xe9sir\xe9e afin de l\u2019ajouter \xe0 la <span class='bold_class'>Carte</span>. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M14,17H18V14L23,18.5L18,23V20H14V17M13,9H18.5L13,3.5V9M6,2H14L20,8V12.34C19.37,12.12 18.7,12 18,12A6,6 0 0,0 12,18C12,19.54 12.58,20.94 13.53,22H6C4.89,22 4,21.1 4,20V4A2,2 0 0,1 6,2Z'></path> </svg></mat-icon> Importer et exporter </div><div class='describe'> Il est possible d'<span class='bold_class'>Importer</span> un fichier vectoriel tout en sp\xe9cifiant un syst\xe8me de coordonn\xe9es ou une projection. <br><br> Il est possible d'<span class='bold_class'>Exporter</span> une ou plusieurs couches dans plusieurs formats courants. <br><br> Il est \xe9galement possible d'<span class='bold_class'>Importer</span> ou d'<span class='bold_class'>Exporter</span> un contexte localement. Cette derni\xe8re fonctionnalit\xe9 permet ainsi de sauvegarder des contextes en mode non-authentifi\xe9 ou anonyme. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z'></path> </svg></mat-icon> Imprimer </div><div class='describe'> Cet outil permet d'<span class='bold_class'>Imprimer</span> la carte affich\xe9e \xe0 l\u2019\xe9cran en sp\xe9cifiant plusieurs options telles qu'un titre, un commentaire, le format de sortie, le format du papier et l'orientation de l'impression. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M18,16.08C17.24,16.08 16.56,16.38 16.04,16.85L8.91,12.7C8.96,12.47 9,12.24 9,12C9,11.76 8.96,11.53 8.91,11.3L15.96,7.19C16.5,7.69 17.21,8 18,8A3,3 0 0,0 21,5A3,3 0 0,0 18,2A3,3 0 0,0 15,5C15,5.24 15.04,5.47 15.09,5.7L8.04,9.81C7.5,9.31 6.79,9 6,9A3,3 0 0,0 3,12A3,3 0 0,0 6,15C6.79,15 7.5,14.69 8.04,14.19L15.16,18.34C15.11,18.55 15.08,18.77 15.08,19C15.08,20.61 16.39,21.91 18,21.91C19.61,21.91 20.92,20.61 20.92,19A2.92,2.92 0 0,0 18,16.08Z'> </path> </svg></mat-icon> Partager </div><div class='describe'> L'outil <span class='bold_class'>Partager</span> permet de cr\xe9er une adresse URL qui redirige vers une repr\xe9sentation exacte de la <span class='bold_class'>Carte</span> affich\xe9e \xe0 l\u2019\xe9cran. Ce lien peut, par exemple, \xeatre partag\xe9 ou diffus\xe9 dans un document, permettant ainsi de \xab&nbspsauvegarder \xbb la carte pour une utilisation ult\xe9rieure. </div><br></div><div class='tool_name'> <p> <a href='http://igouverte.org/' target='_blank'><img src='./assets/igo2/core/logo.png' alt='IGO' height=32>IGO2</a> est une solution Web libre g\xe9omatique d\xe9velopp\xe9e en mode collaboratif par des sp\xe9cialistes provenant de plusieurs minist\xe8res et organismes du gouvernement du Qu\xe9bec.</p><p>Version: {{version.lib}}</p></div>\",\"trainingGuide\":\"Guide de formation\",\"trainingGuideTooltip\":\"Cliquez ici pour acc\xe9der au guide d'autoformation de IGO2\"},\"mapTool\":{\"empty\":\"La carte ne contient aucune couche de donn\xe9es.\",\"customize\":\"Personnalisez-l\xe0 en ajoutant des couches \xe0 partir des outils suivants : \",\"search-tool\":\"Recherche\",\"catalog-tool\":\"Catalogue de donn\xe9es\",\"context-tool\":\"Gestionnaire de contextes\",\"noLayersVisible\":\"Aucune couche visible.\",\"noLayersInRange\":\"Aucune couche visible dans la plage d'\xe9chelle active. Veuillez zoomer ou d\xe9zoomer pour d\xe9couvrir ces couches.\"},\"importExportTool\":{\"importExportData\":\"Couche\",\"importExportContext\":\"Contexte\"},\"workspace\":{\"toggleWorkspace\":\"Ouvrir/fermer la vue tabulaire\",\"ogcFilter.close\":\"Fermer\",\"ogcFilter.title\":\"Filtres\",\"ogcFilter.tooltip\":\"Appliquer des filtres sur la couche\",\"download.title\":\"T\xe9l\xe9charger les donn\xe9es associ\xe9es\",\"download.tooltip\":\"T\xe9l\xe9charger les donn\xe9es associ\xe9es\",\"inMapExtent.title\":\"Montrer les entit\xe9s contenues dans la carte\",\"inMapExtent.active.tooltip\":\"Montrer les entit\xe9s contenues dans la carte\",\"inMapExtent.inactive.tooltip\":\"Montrer toutes les entit\xe9s\",\"zoomAuto.title\":\"Zoom auto\",\"zoomAuto.tooltip\":\"Zoom auto\",\"selected.title\":\"Montrer les entit\xe9s s\xe9lectionn\xe9es\",\"selected.tooltip\":\"Montrer les entit\xe9s s\xe9lectionn\xe9es\",\"clearSelection.title\":\"Tout d\xe9s\xe9lectionner\",\"clearSelection.tooltip\":\"D\xe9s\xe9lectionner les enregistrements s\xe9lectionn\xe9s\",\"maximize\":\"Agrandir\",\"maximizeTooltip\":\"Agrandir la fen\xeatre\",\"standardExtent\":\"R\xe9duire\",\"standardExtentTooltip\":\"R\xe9duire la fen\xeatre\"},\"directions\":{\"warning\":{\"title\":\"Avertissement\",\"message\":\"L'itin\xe9raire propos\xe9 dans cet outil ne tient pas compte des conditions routi\xe8res actuelles, de la congestion routi\xe8re ou des entraves pr\xe9sentes sur le r\xe9seau.\"}},\"advanced-map-tool\":{\"advanced-swipe\":{\"swipe-select\":\"Choisir les couches \xe0 comparer\",\"selectAll\":\"Tout s\xe9lectionner\",\"empty\":\"La carte ne contient aucune couche de donn\xe9es.\",\"customize\":\"Personnalisez-l\xe0 en ajoutant des couches \xe0 partir des outils suivants : \",\"search-tool\":\"Recherche\",\"catalog-tool\":\"Catalogue de donn\xe9es\",\"context-tool\":\"Gestionnaire de contextes\",\"swipe\":\"Activer\",\"swipe-tool\":\"Outil de comparaison\"},\"advanced-coordinates\":{\"copy\":\"Copier\",\"lon\":\"Longitude\",\"lat\":\"Latitude\",\"nord\":\"Nord\",\"est\":\"Est\",\"coordinates\":\"Coordonn\xe9es du centre de la carte\",\"copyMsg\":\"Coordonn\xe9es copi\xe9s\",\"copyTitle\":\"Coordonn\xe9es du centre\",\"center\":\"Centre\",\"coordSystem\":\"Syst\xe8me de coordonn\xe9es\",\"zoom\":\"Niveau de zoom courant: \"}}}}}")},65962:function(e){"use strict";e.exports=JSON.parse('{"igo":{"auth":{"accessAnonymous":"Rester anonyme","connection":"Connexion","login":"Connecter","password":"Mot de passe","signOut":"Se d\xe9connecter","user":"Utilisateur","welcome":"Bienvenue {{name}}!","deconnection":"Vous \xeates d\xe9connect\xe9","home":"Retourner \xe0 la page d\'accueil","error":{"Password expired":"Votre mot de passe est expir\xe9","Maximun logins exceeded":"Nombre maximal de connexions d\xe9pass\xe9","Login lockout":"Nombre maximal d\'essai d\xe9pass\xe9. Votre compte est verrouill\xe9.","Wrong password":"Mot de passe incorrect","Invalid username":"Utilisateur invalide"},"google":{"login":"Se connecter avec Google","logged":"Connect\xe9 avec Google"},"microsoft":{"login":"Se connecter avec compte Azure"},"microsoftb2c":{"login":"Se connecter"}},"common":{"confirmDialog":{"cancelBtn":"Annuler","confirmBtn":"Confirmer","title":"Confirmation"},"table":{"filter":"Filtre"},"entity-table":{"targetHtmlUrl":"Ouvrir le lien externe"},"form":{"errors":{"required":"Ce champ est requis"}},"actionbar":{"scrollUp":"D\xe9filer vers le haut","scrollDown":"D\xe9filer vers le bas","icon":"Actions suppl\xe9mentaires"},"interactiveTour":{"tooltipTourToolButton":"Aide interactive sur l\'outil","disaledTooltipTourToolButton":"Pour avoir acc\xe8s au tour interactif de cet outil, ajouter des contextes ou des couches","buttonTitle":"D\xe9couvrir","exitButton":"Quitter","backButton":"Pr\xe9c\xe9dent","nextButton":"Suivant"},"paginator":{"firstPageLabel":"Premi\xe8re page","itemsPerPageLabel":"Entit\xe9s par page:","lastPageLabel":"Derni\xe8re page","nextPageLabel":"Page suivante","previousPageLabel":"Page pr\xe9c\xe9dente","of":"de"}},"context":{"bookmarkButton":{"create":"Cr\xe9er un contexte","dialog":{"createMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 cr\xe9\xe9","createTitle":"Contexte cr\xe9\xe9","placeholder":"Titre","title":"Nouveau contexte"}},"contextManager":{"clone":"Cloner ce contexte","delete":"Supprimer ce contexte","dialog":{"cloneMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 clon\xe9","cloneTitle":"Contexte clon\xe9","copyMsg":"Texte copi\xe9","copyTitle":"Identifiant du contexte","confirmDelete":"\xcates-vous s\xfbr de vouloir supprimer ce contexte ?","deleteMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 supprim\xe9","deleteTitle":"Contexte supprim\xe9","favoriteMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 d\xe9fini comme favori","favoriteTitle":"Favori enregistr\xe9","saveMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 enregistr\xe9","saveTitle":"Contexte enregistr\xe9"},"edit":"\xc9diter ce contexte","errors":{"uncaught":{"message":"D\xe9sol\xe9! Le service que vous voulez utiliser n\u2019est malheureusement pas disponible pour le moment. Essayez plus tard!","title":"Erreur de serveur"},"addPermission":"La permission que vous tentez d\'ajouter est d\xe9j\xe0 pr\xe9sente dans le contexte.","addPermissionEmpty":"La permission que vous tentez d\'ajouter n\'est pas valide","addPermissionTitle":"Erreur d\'ajout de permission"},"favorite":"D\xe9finir comme contexte favori","form":{"copy":"Copier l\'identifiant du contexte","edit":"Enregistrer","title":"Titre","titleRequired":"Le titre est obligatoire","uri":"Identifiant","uriRequired":"L\'identifiant est obligatoire"},"invalid":{"text":"Le contexte \\"{{value}}\\" est invalide. Le contexte par d\xe9faut a \xe9t\xe9 charg\xe9.","title":"Contexte invalide"},"managePermissions":"G\xe9rer les permissions du contexte","manageTools":"G\xe9rer les outils du contexte","ourContexts":"Mes contextes","publicContexts":"Contextes publics","save":"Sauvegarder ce contexte","sharedContexts":"Contextes partag\xe9s","filterPlaceHolder":"Filtrer par nom","sortAlphabetically":"Trier en ordre alphab\xe9tique","sortContextOrder":"Replacer selon la date de cr\xe9ation","userAccount":"Profils utilisateurs","filterUser":"Filtrer par groupe d\'utilisateur","emptyContext":"Contexte vide","emptyContextTooltip":"Cr\xe9er un nouveau contexte vide","contextMap":"Contexte \xe0 partir de la carte","contextMapTooltip":"Cr\xe9er un nouveau contexte \xe0 partir des couches la carte","hide":"Masquer ce contexte","show":"Montrer ce contexte","showHidden":"Montrer les contextes masqu\xe9s"},"contextImportExport":{"export":{"exportPlaceHolder":"Couches","exportContextName":"Nom du contexte","exportSelectAll":"Tout s\xe9lectionner","success":{"text":"Contexte export\xe9 avec succ\xe8s.","title":"Exportation r\xe9ussie"},"nothing":{"text":"Impossible d\u2019exporter, contexte non valide ou aucun contexte s\xe9lectionn\xe9.","title":"Donn\xe9e non valide ou non pr\xe9sente"},"failed":{"text":"Impossible d\u2019exporter, probl\xe8me de contexte rencontr\xe9.","title":"Probl\xe8me d\u2019exportation"}},"import":{"success":{"title":"Contexte import\xe9","text":"Le contexte \'{{value}}\' a \xe9t\xe9 ajout\xe9 \xe0 la carte"},"empty":{"text":"Le contexte \'{{value}}\' est vide, impossible d\'importer","title":"Contexte vide"},"invalid":{"text":"Le contexte \'{{value}}\' est invalide.","title":"Context invalide"},"unreadable":{"text":"Le contexte \'{{value}}\' est impossible \xe0 lire","title":"Context illisible"},"tooLarge":{"text":"Le contexte \'{{value}}\' est trop volumineux (Maximum: {{size}} Mo)","title":"Context trop volumineux"}}},"permission":{"addBtn":"Ajouter","delete":"Retirer la permission","dialog":{"addMsg":"La permission \'{{value}}\' a \xe9t\xe9 ajout\xe9e","addTitle":"Permission ajout\xe9e","deleteMsg":"La permission \'{{value}}\' a \xe9t\xe9 supprim\xe9e","deleteTitle":"Permission retir\xe9e","scopeChangedMsg":"La port\xe9e du contexte a \xe9t\xe9 chang\xe9e pour {{value}}","scopeChangedTitle":"Changement de la port\xe9e"},"profil":"Profil","user":"Utilisateur ou groupe","profilRequired":"Le profil est obligatoire","read":"Lecture seule","readOnlyTitle":"Contexte en lecture seule","readOnlyMsg":"Vous pouvez seulement retirer la permission si le contexte est directement partag\xe9 \xe0 votre nom d\'utilisateur.","scope":{"private":"Priv\xe9","protected":"Prot\xe9g\xe9","shared":"Partag\xe9","public":"Public"},"write":"Lecture et \xe9criture"},"poiButton":{"create":"Cr\xe9er une zone d\'int\xe9r\xeat","dialog":{"confirmDelete":"\xcates-vous s\xfbr de vouloir supprimer cette zone d\'int\xe9r\xeat ?","createMsg":"La zone d\'int\xe9r\xeat \'{{value}}\' a \xe9t\xe9 cr\xe9\xe9e","createTitle":"Zone d\'int\xe9r\xeat cr\xe9\xe9e","deleteMsg":"La zone d\'int\xe9r\xeat \'{{value}}\' a \xe9t\xe9 supprim\xe9e","deleteTitle":"Zone d\'int\xe9r\xeat supprim\xe9e","placeholder":"Titre","title":"Nouvelle zone d\'int\xe9r\xeat"},"placeholder":"Zones d\'int\xe9r\xeat"},"sidenav":{"goBack":"Revenir","mainMenu":"Revenir au menu principal"},"shareMap":{"button":"Partager la carte","refreshBtn":"Actualiser le partage","copy":"Copier le lien","shareWithApi":"Partage par contexte","shareWithUrl":"Partage par url","dialog":{"copyMsg":"Lien copi\xe9","copyTitle":"Lien"},"errorTitle":"Erreur lors du partage","placeholderLink":"Lien","included":"Inclus dans le lien de partage :","context":"Le contexte ouvert lors de la cr\xe9ation du lien de partage.","center":"Les coordonn\xe9es du centre de la carte (longitude, latitude).","zoom":"Le niveau de zoom de la carte.","addedLayers":"Les couches ajout\xe9es via le catalogue ou via la barre de recherche.","visibleInvisible":"Le statut de visibilit\xe9 des couches.","excluded":"Exclus dans le lien de partage :","order":"L\'ordre des couches.","opacity":"Les modifications effectu\xe9es \xe0 l\'opacit\xe9 des couches.","filterOgc":"Les ajouts/modifications faits aux filtres par attribut.","filterTime":"La valeur en cours pour les filtres temporels."},"tool":{"dialog":{"addMsg":"L\'outil a \xe9t\xe9 ajout\xe9","addTitle":"Outil ajout\xe9","deleteMsg":"L\'outil a \xe9t\xe9 supprim\xe9","deleteTitle":"Outil retir\xe9"}},"userButton":{"dialog":{"email":"Courriel","expiration":"Expiration","user":"Utilisateur","clearPreferences":"Supprimer mes pr\xe9f\xe9rences"},"infoTitle":"Info sur l\'utilisateur","logout":"Se d\xe9connecter"}},"core":{"errors":{"uncaught":{"message":"D\xe9sol\xe9! Le service que vous voulez utiliser n\u2019est malheureusement pas disponible pour le moment. Essayez plus tard!","title":"Erreur serveur"}},"network":{"online":{"message":"En ligne","title":"Statut:"},"offline":{"message":"Hors-Ligne","title":"Statut:"}}},"geo":{"catalog":{"layer.addToMap":"Ajouter \xe0 la carte","layer.addToMapOutRange":"Ajouter \xe0 la carte. La donn\xe9e est non visible \xe0 l\'\xe9chelle active. Veuillez zoomer +/- si vous voulez l\'apercevoir \xe0 la carte.","layer.removeFromMap":"Retirer de la carte","layer.removeFromMapOutRange":"Retirer de la carte. La donn\xe9e est non visible \xe0 l\'\xe9chelle active. Veuillez zoomer +/- si vous voulez l\'apercevoir \xe0 la carte.","group.addToMap":"Ajouter toutes les couches de ce groupe \xe0 la carte","group.removeFromMap":"Retirer toutes les couches de ce groupe de la carte","baseLayers":"Fonds de carte","unavailableTitle":"Catalogue indisponible","unavailable":"Le catalogue \'{{value}}\' est indisponible pour le moment ou vous n\'avez pas les permissions requises.","someUnavailable":"Certaines couches d\'information du catalogue sont indisponible pour le moment ou vous n\'avez pas les permissions requises.","externalProvider":{"catalog":"Ce catalogue provient d\'une organisation externe.","group":"Ces couches proviennent d\'une organisation externe.","layer":"Cette couche provient d\'une organisation externe.","unavailableWithEmail":"Le catalogue \'{{value}}\' est indisponible pour le moment. Pour ajouter un service externe \xe0 la liste pr\xe9d\xe9finie, veuillez contacter {{email}}. Des d\xe9lais peuvent s\'appliquer si probl\xe8me il y a avec le fournisseur externe."},"library.add":"Ajouter ce catalogue","library.cancel":"Annuler","library.remove":"Retirer ce catalogue de la liste","library.inlist":{"title":"Catalogue d\xe9j\xe0 contenu","message":"Le catalogue \xe0 ajouter est d\xe9j\xe0 dans la liste"},"library.addTitle":"Ajout d\'un catalogue","library.addBtn":"Ajouter un catalogue"},"clickOnMap":{"clickedFeature":"Entit\xe9s cliqu\xe9es"},"baselayersSwitcher":{"title":"Fonds de carte"},"dataSource":{"unavailableTitle":"Couche indisponible","optionsApiUnavailable":"L\'information sur les couches n\'a pas pu \xeatre r\xe9cup\xe9r\xe9e. Certaines couches pourraient ne pas pr\xe9senter la bonne information.","unavailable":"La couche \'{{value}}\' est indisponible pour le moment ou vous n\'avez pas les permissions requises."},"dropGeoFile":{"invalid":{"text":"Le fichier \'{{value}}\' est invalide. ({{mimeType}})","title":"Fichier invalide"},"empty":{"text":"Le fichier \'{{value}}\' est vide, impossible d\'importer","title":"Fichier vide"},"success":{"text":"La couche \'{{value}}\' a \xe9t\xe9 ajout\xe9e \xe0 la carte","title":"Fichier import\xe9"},"unreadable":{"text":"Le fichier \'{{value}}\' est impossible \xe0 lire","title":"Fichier illisible"},"tooLarge":{"text":"Le fichier \'{{value}}\' est trop volumineux (Maximum: {{size}} Mo)","title":"Fichier trop volumineux"},"invalidSRS":{"text":"La projection est valide. Elle doit commencer par EPSG:","title":"Projection invalid"},"ogreServer":{"title":"Erreur 500 du service Ogre","text":"Erreur de la conversion du fichier en geojson. Il est possible que le fichier soit trop volumineux, essayer de l\'importer en format geojson"}},"export":{"customList":{"text":"Certaines couches s\xe9lectionn\xe9es ( {{value}} ) r\xe9duisent la liste des formats possible","title":"Liste restreinte de formats"},"nothing":{"text":"Impossible d\u2019exporter, donn\xe9e non valide ou aucune donn\xe9e s\xe9lectionn\xe9e.","title":"Donn\xe9e non valide ou non pr\xe9sente"},"noFormat":{"text":"Aucun format d\'exportation valide pour toutes les couches s\xe9lectionn\xe9es. Veuillez exporter les couches une \xe0 la fois.","title":"Aucun format disponible"},"failed":{"text":"Impossible d\u2019exporter, probl\xe8me de donn\xe9e rencontr\xe9.","title":"Probl\xe8me d\u2019exportation"},"popupBlocked":{"text":"</br>Veuillez autoriser l\'ouverture des fen\xeatres (popup) dans votre fureteur. </br>Pour Chrome and Edge, \xe0 droite dans la barre d\'adresse).</br>{{extraMessage}}","selectAgain":"Faites le correctif et s\xe9lectionner \xe0 nouveau un format.","retry":"Veuillez recommencer l\'exportation.","title":"Ouverture de fen\xeatre bloqu\xe9e par votre fureteur"},"success":{"text":"Donn\xe9es export\xe9es avec succ\xe8s.","title":"Exportation r\xe9ussie"},"format":{"GeoJSON":"GeoJSON","GML":"GML","GPX":"GPX","KML":"KML","Shapefile":"Shapefile","CSVcomma":"CSV (s\xe9parateur virgule)","CSVsemicolon":"CSV (compatible Excel)","URL":"Lien externe"},"gpx.error.poly":{"title":"GPX en erreur","text":"Le format GPX ne permet pas de stocker les polygones"},"encoding":{"LATIN1":"LATIN-1","UTF8":"UTF-8"}},"importExportForm":{"exportButton":"Exporter","exportButtonLink":"Ouvrir le lien","exportButtonLinks":"Ouvrir les liens","exportCircleToPolygon":"Transformer les entit\xe9s de type Cercle en polygones","exportFormatPlaceholder":"Format","exportLayerPlaceholder":"Couche(s)","exportFileNamePlaceholder":"Nom du fichier","encodingPlaceholder":"Encodage","exportTabTitle":"Exporter","exportFeatureInExtent":"Seulement les entit\xe9s contenues dans la carte","exportNoLayersExportable":"Aucune couche exportable dans la carte courante","exportSelectedFeature":"Seulement les entit\xe9s s\xe9lectionn\xe9es","importButton":"Importer","importProjPlaceholder":"Syst\xe8me de coordonn\xe9es du fichier \xe0 importer","importTabTitle":"Importer","importClarifications":"Pr\xe9cisions","importSizeMax":"La taille limite du fichier est de {{size}} Mo","importFormatAuthorized":"Formats autoris\xe9s: geojson, kml, gpx, gml, shapefile","importShpZip":"Les shapefiles doivent \xeatre compress\xe9s (zipp\xe9s) ET leurs g\xe9om\xe9tries doivent \xeatre en coordonn\xe9es Latitude Longitude (EPSG:4326/WGS84)","other":"autre","others":"autres","projections":{"mtm":"MTM {{zone}} ({{code}})","utm":"UTM {{zone}} ({{code}})","webMercator":"Web Mercator ({{code}})","nad83":"Lat-Long NAD83 ({{code}})","wgs84":"Lat-Long WGS84 ({{code}})","choose":"Vous devez choisir une projection avant d\'importer le fichier."}},"operators":{"caseSensitive":"Sensible \xe0 la case","And":"Et","Or":"Ou","PropertyIsEqualTo":"=","PropertyIsNotEqualTo":"!=","PropertyIsLike":"\u2248","PropertyIsGreaterThan":">","PropertyIsGreaterThanOrEqualTo":">=","PropertyIsLessThan":"<","PropertyIsLessThanOrEqualTo":"<=","PropertyIsBetween":"entre","During":"durant (temporel)","PropertyIsNull":"est nul","Intersects":"intersecte (g\xe9om\xe9trique)","Within":"contenu dans (g\xe9om\xe9trique)","Contains":"contient (g\xe9om\xe9trique)","tooltip":{"And":"Op\xe9rateur logique entre les filtres o\xf9 les deux conditions doivent \xeatre remplies","Or":"Op\xe9rateur logique entre les filtres o\xf9 au moins une (1) condition doit \xeatre vraie","PropertyIsEqualTo":"Identique (sensible \xe0 la case)","PropertyIsNotEqualTo":"Diff\xe9rent (sensible \xe0 la case)","PropertyIsLike":"Comme. Exemple: *route* trouve toutes les valeurs contenent \'route\', peu importe sa position dans l\'attribut. route* trouve toutes les valeurs commencant par \'route\'. Options avanc\xe9es : wildCard =\'*\', singleChar = \'.\' escapeChar = \'!\' (sensible \xe0 la case)","PropertyIsGreaterThan":"Plus grand","PropertyIsGreaterThanOrEqualTo":"Plus grand ou \xe9gal","PropertyIsLessThan":"Plus petit","PropertyIsLessThanOrEqualTo":"Plus petit ou \xe9gal","PropertyIsBetween":"Doit \xeatre contenu entre les limites inf\xe9rieure et sup\xe9rieure (les valeurs sont incluses)","During":"Doit \xeatre contenu entre les p\xe9riodes de temps sp\xe9cifi\xe9es","PropertyIsNull":"Dont l\'attribut est nul","Intersects":"Retourne les entit\xe9s \xe9tant en intersection g\xe9om\xe9trique avec la g\xe9om\xe9trie fournie","Within":"Retourne les entit\xe9s \xe9tant enti\xe8rement contenue par la g\xe9om\xe9trie fournie (Within)","Contains":"Retourne les entit\xe9s compl\xe8tement contenues par la g\xe9om\xe9trie fournie (Contains)"}},"sourceFields":{"selectField":"Choisir un champ"},"filter":{"resetFilters":"(Appliquer aucun filtre)","addFilter":"Ajouter un filtre vide \xe0 la liste courante","removeFilter":"Supprimer le pr\xe9sent filtre \xe0 la liste des filtres","toggleFilterState":"Activer/d\xe9sactiver le pr\xe9sent filtre","refreshFilters":"Mettre \xe0 jour la source de donn\xe9e avec les filtres actifs de la liste. Pour activer ce boutton, la couche doit etre visible (et dans les \xe9chelles permises) ou veillez modifier le pr\xe9sent filtre.","layerFiltered":"Cette couche d\'information est pr\xe9sentement filtr\xe9e.","layerFilterable":"Cette couche d\'information est filtrable","filterBy":"Filtrer par","advancedOgcFilters":"Filtres avanc\xe9s","displayMoreResults":"Afficher plus (+)","displayLessResults":"Afficher moins (-)","placeholder":"Saisir une valeur","placeholderSnrc":"Ex: 21L14","selectOperator":"Choisir un op\xe9rateur","sliderModeTitle":"Curseur temporel","reportingDate":"Date de signalement"},"spatialSelector":{"fixedExtent":"\xc9tendue fixe","btnSetExtent":"D\xe9finir l\'\xe9tendue du filtre selon l\'\xe9tendue courante de la carte","snrc":"SNRC","selectFeature":"","drawFeature":""},"layer":{"hideLayer":"Masquer la couche","hideSelectedLayers":"Masquer les couches s\xe9lectionn\xe9es","lowerLayer":"Mettre en arri\xe8re","filterLowerLayer":"Le d\xe9placement arri\xe8re se fait toujours selon l\'ordre de la carte!","filterPlaceholder":"Filtrer la liste de couches","activateSelectionMode":"Activer le mode de s\xe9lection multiple","deactivateSelectionMode":"D\xe9sactiver le mode de s\xe9lection multiple","tools":"Outils","selectAll":"S\xe9lectionner toutes les couches","deselectAll":"D\xe9s\xe9lectionner toutes les couches","zoomLayer":"Cadrer sur l\'\xe9tendue de la couche","zoomLayers":"Cadrer sur l\'\xe9tendue des couches s\xe9lectionn\xe9es","opacity":"Opacit\xe9","raiseLayer":"Mettre en avant","filterRaiseLayer":"Le d\xe9placement avant se fait toujours selon l\'ordre de la carte!","moreOptions":"Outils de la couche","removeLayer":"Retirer la couche de la carte","removeSelectedLayers":"Retirer les couches s\xe9lectionn\xe9es de la carte","removeSelectedLayersRestriction":"Certaines couches s\xe9lectionn\xe9es ne peuvent \xeatre supprim\xe9es","showFeaturesList":"Afficher la liste des entit\xe9s","showLayer":"Afficher la couche","showSelectedLayers":"Afficher les couches s\xe9lectionn\xe9es","subsetLayersListKeyword":"Limiter l\'affichage de la liste selon le titre ou  par type (wms, wfs,...)","deleteKeyword":"Supprimer le mot-cl\xe9","subsetLayersListOnlyVisible":"Conserver seulement les couches visibles","subsetLayersListOnlyInRange":"Conserver seulement les couches de la plage d\'\xe9chelle active","sortAlphabetically":"Trier la liste des couches en ordre alphab\xe9tique","sortMapOrder":"Replacer les couches selon l\'ordre cartographique","resetLayersList":"R\xe9tablir l\'affichage de l\'ensemble des couches","trackFeature":"Suivre l\'entit\xe9","legend":{"default":"D\xe9faut","loadingLegendText":"Chargement de la l\xe9gende","noLegendText":"Aucune symbologie disponible pour cette couche","noLegendScale":"Aucune symbologie disponible pour cette \xe9chelle","selectStyle":"S\xe9lectionner le style de la l\xe9gende","showAll":"Montrer toutes les couches (non visible et hors \xe9chelle)","noLayersVisibleWithShowAllButton":"Aucune couche actuellement visible. Activez le bouton ci haut pour voir toutes les l\xe9gendes.","noLayersVisibleWithShowAllButtonButZoom":"Aucune couche actuellement visible. Si vous zoomez dans la carte, certaines couches appara\xeetront OU activez le bouton ci haut pour voir toutes les l\xe9gendes.","noLayersVisible":"Aucune couche actuellement visible.","noLayersVisibleButZoom":"Aucune couche actuellement visible. Par contre, si vous zoomez dans la carte, certaines couches appara\xeetront."}},"download":{"action":"T\xe9l\xe9charger les donn\xe9es associ\xe9es","title":"T\xe9l\xe9chargement des donn\xe9es","start":"V\xe9rifiez la progression du t\xe9l\xe9chargement dans votre navigateur","end":"Termin\xe9"},"mapButtons":{"baselayerSwitcher":"Changer le fond de carte","geolocate":"Afficher votre position","offline":"Passer en mode hors-ligne","online":"Passer en mode en ligne","zoomIn":"Zoomer ({{zoom}})","zoomOut":"D\xe9zoomer ({{zoom}})","resetRotation":"R\xe9initialiser la carte vers le nord","tipRotation":"Maintenez les touches Alt et Majuscule (shift) tout en cliquant sur la carte pour faire pivoter la carte"},"metadata":{"show":"Montrer les m\xe9tadonn\xe9es"},"printForm":{"corsErrorMessageBody":"Impossible d\'imprimer d\xfb \xe0 des droits d\'acc\xe8s non d\xe9tenus","corsErrorMessageHeader":"Impression","comment":"Commentaire","doZipFile":"Compresser le fichier","outputFormat":"Format de sortie","paperFormat":"Format du papier","paperFormats":{"A0":"33.1 X 46.8\\" (A0)","A1":"23.4 X 33.1\\" (A1)","A2":"16.5 X 23.5\\" (A2)","A3":"11.7 X 16.5\\" (A3)","A4":"8.3 X 11.7\\" (A4)","A5":"5.8 X 8.3\\" (A5)","Letter":"Lettre","Legal":"L\xe9gal"},"imageFormat":"Format de l\'image","orientation":"Orientation","landscape":"Paysage","portrait":"Portrait","projection":"Projection","resolution":"R\xe9solution","saveBtn":"Sauvegarder","scale":"\xc9chelle","showProjection":"Afficher la projection","showScale":"Afficher l\'\xe9chelle","title":"Titre","subtitle":"Sous-titre","legendPosition":"Position de la l\xe9gende","legendPositions":{"none":"Aucune l\xe9gende","topleft":"Coin haut gauche de la carte","topright":"Coin haut droit de la carte","bottomleft":"Coin bas gauche de la carte","bottomright":"Coin bas droit de la carte","newpage":"Sur une nouvelle page"}},"directionsForm":{"stopLayer":"Itin\xe9raire - Arr\xeats","routeLayer":"Itin\xe9raire - Trac\xe9","start":"D\xe9but","intermediate":"Interm\xe9diaire","end":"Fin","directionsBtn":"Obtenir l\'itin\xe9raire","resetDirectionsBtn":"Supprimer l\'itin\xe9raire","zoomRoute":"Zoomer sur l\'itin\xe9raire","null":"","directions":"Itin\xe9raire","raiseStop":"Prioriser l\'arr\xeat","lowerStop":"Reporter l\'arr\xeat plus loin dans le parcours","addStop":"Ajouter un arr\xeat","clearStop":"R\xe9initialiser cet arr\xeat","moveStop":"D\xe9placer cet arr\xeat","removeStop":"Supprimer l\'arr\xeat","drivingOptions":"Choix d\'itin\xe9raires","summary":"R\xe9sum\xe9 de l\'itin\xe9raire","stopsList":"Liste des lieux d\'arr\xeats","instructions":"Indications","copy":"Copier l\'itin\xe9raire","geolocate":"Utiliser sa localisation comme point d\'arr\xeat","link":"Lien","dialog":{"copyMsg":"Itin\xe9raire copi\xe9 dans le presse-papier","copyMsgLink":"Le lien de l\'itin\xe9raire est copi\xe9 dans le presse-papier","copyTitle":"Itin\xe9raire"}},"directions":{"uturn":"demi-tour","sharp right":"fortement \xe0 droite","right":"droite","slight right":"l\xe9g\xe8rement \xe0 droite","sharp left":"fortement \xe0 gauche","left":"gauche","slight left":"l\xe9g\xe8rement \xe0 gauche","straight":"tout droit","turn":{"straight":"Continuer sur {{route}}","uturn":"Faire demi-tour sur {{route}}","else":"Tourner {{aggregatedDirection}} sur {{route}}"},"new name":"Continuer en direction {{translatedDirection}} sur {{route}}","depart":"Aller en direction {{translatedDirection}} sur {{route}}","arrive":{"lastStep":"Vous \xeates arriv\xe9 {{coma}} {{aggregatedDirection}}","intermediate":"Vous atteignez le point interm\xe9diare sur {{route}}"},"merge":"Continuer sur {{route}}","on ramp":"Prendre l\'entr\xe9e d\'autoroute {{aggregatedDirection}}","off ramp":"Prendre la sortie d\'autoroute {{aggregatedDirection}}","fork":{"left":"Garder la gauche sur {{route}}","right":"Garder la droite sur {{route}}","else":"Continuer sur {{route}}"},"end of road":"\xc0 la fin de la route, tourner {{translatedModifier}} sur {{route}}","use lane":"Prendre la voie de ...","continue":{"notUturn":"Continuer sur {{route}}"},"roundabout":"Au rond-point, prendre la {{exit}}{{cntSuffix}} sortie vers {{route}}","rotary":"Rond-point rotary ...","roundabout turn":"Rond-point, prendre la ...","exit roundabout":"Poursuivre vers {{route}}","notification":"notification ...","uturnText":"Faire demi-tour et continuer en direction {{translatedDirection}} sur {{route}}","unknown":"???","cntSuffix":{"first":"\xe8re","secondAndMore":"e"},"modifier":{"prefix":"\xe0 "}},"cardinalPoints":{"n":"nord","ne":"nord-est","e":"est","se":"sud-est","s":"sud","sw":"sud-ouest","w":"ouest","nw":"nord-ouest"},"search":{"placeholder":"Rechercher une localisation ou une couche de donn\xe9es","emptyType.placeholder":"Veuillez choisir un type de recherche","feature.title":"Localisation","feature.placeholder":"Rechercher une localisation","layer.title":"Couche de donn\xe9es","layer.placeholder":"Rechercher une couche de donn\xe9es.","ichercheReverse.name":"Recherche par coordonn\xe9es","ilayer":{"name":"Couches","properties":{"abstract":"Description","groupTitle":"Groupe","title":"Titre","type":"Type","url":"URL","metadataUrl":"M\xe9tadonn\xe9es","name":"Nom de la couche","urlInfo":"Lien du service web WMS/WFS","downloadUrl":"Lien de t\xe9l\xe9chargement de la donn\xe9es"},"type":{"layer":"Couche","groupLayer":"Groupe de couches"}},"nominatim":{"type":{"food":"Restauration","health":"Sant\xe9","entertainment":"Divertissement","finance":"Finance"},"country":{"all":"Le monde","canada":"Canada"}},"icherche":{"name":"iCherche","type":{"address":"Adresse","oldAddress":"Ancienne adresse","district":"Arrondissement","postalCode":"Code Postal","city":"Municipalit\xe9","oldCity":"Ancienne municipalit\xe9","mrc":"MRC","regadmin":"R\xe9gion administrative","road":"Route","intersection":"Intersection","place":"Lieu","exit":"Sortie d\'autoroute","cn":"Borne du CN","gcc":"Rep\xe8re de la garde coti\xe8re (GCC)","sumi":"Borne SUMI","km":"Rep\xe8re kilom\xe9trique","hq":"Hydro-Qu\xe9bec","entreprise":"Entreprise","cadastre":"Cadastre"},"restrictExtent":{"map":"\xc0 l\'\xe9tendue de la carte","quebec":"Au Qu\xe9bec"}},"coordinates":{"name":"Coordonn\xe9es","coord":"Coordonn\xe9e (longitude, latitude)","coordDMS":"Coordonn\xe9e (longitude, latitude) (DMS)","radius":"Rayon","conf":"Confiance"},"menu.tooltip":"Options de recherche","settings":{"title":"Param\xe8tres"},"pointerSearchSummary":{"title":"Position du curseur","tooltip":"Afficher les coordonn\xe9es du curseur ainsi que d\'autres informations sur sa position en fonction des types de r\xe9sultats activ\xe9es. Utiliser F2 pour activer / d\xe9sactiver."},"searchResultsGeometry":{"title":"Montrer tous les r\xe9sultats","tooltip":"Afficher/cacher la g\xe9om\xe9trie des r\xe9sultats"},"searchSources":{"selectAll":"Tout s\xe9lectionner","unselectAll":"Tout d\xe9s\xe9lectionner","settings":{"results type":"Type de r\xe9sultat","ecmax":"\xc9cart maximal","radius":"Rayon de recherche","results limit":"Nombre de r\xe9sultats","multiple object":"Objet multiple","restrictExtent":"Restreint l\'\xe9tendue","selectAll":"Tout s\xe9lectionner","unselectAll":"Tout d\xe9s\xe9lectionner","true":"Oui","false":"Non"}},"displayMoreResults":"Afficher plus de r\xe9sultats"},"geometry":{"geometry":"Geometrie","point":"Point","line":"Ligne","polygon":"Surface"},"targetHtmlUrl":"Ouvrir le lien externe","searchByCoord":"Rechercher par coordonn\xe9es","searchByName":"Rechercher par nom","seeRouting":"Voir l\'itin\xe9raire","timeFilter":{"date":"Date","endDate":"Date de fin","startDate":"Date de d\xe9but","hour":"Heure","minute":"Minute","endYear":"Ann\xe9e de fin","startYear":"Ann\xe9e de d\xe9but"},"spatialFilter":{"spatialFilter":"Filtre spatial","predefined":"Zone Pr\xe9d\xe9finie","draw":"Dessin","polygon":"Polygone","point":"Cercle","drawPolygon":"Dessiner un polygone","drawCircle":"Dessiner un cercle","searchLabel":"Rechercher par","buffer":"Zone tampon","search":"Recherche","drawControl":"Activer le contr\xf4le de dessin","listLabel":"Zone","entity":"Entit\xe9","layer":"Couche","goSearch":"Lancer la recherche","removeLayer":"Retirer les r\xe9sultats","exportLayer":"Exporter les r\xe9sultats","clearForm":"Retirer le dessin","clearSearch":"R\xe9initialiser les champs","Address":"Adresses","Thematics":"Th\xe9matiques","searchResults":"R\xe9sultats de la recherche","type":"Type","radius":"Rayon","radiusAlert":"Le rayon doit \xeatre compris entre 0 et 100 kilom\xe8tres (ou 100 000 m\xe8tres)","bufferAlert":"La zone tampon doit \xeatre comprise entre 0 et 100 kilom\xe8tres (ou 100 000 m\xe8tres)","maxSizeAlert":"Le nombre de r\xe9sultats exc\xe8de 10000. Certains pourraient \xeatre manquants.","zeroResults":"Aucun r\xe9sultat ne correspond \xe0 cette recherche.","warning":"Avertissement","freehandControl":"\xc0 main lev\xe9e","group":{"toponyme":"Toponyme","culturel":"Culturel","education":"\xc9ducation","sante":"Sant\xe9","securite":"S\xe9curit\xe9","sepaq":"S\xc9PAQ","transport":"Transport"}},"terrapi":{"AdmRegion":"R\xe9gions administratives","Mun":"Municipalit\xe9s","Arrond":"Arrondissements","CircFed":"Circonscriptions f\xe9d\xe9rales","CircProv":"Circonscriptions provinciales","DirReg":"Directions r\xe9gionales","MRC":"MRC","RegTour":"R\xe9gions touristiques","limites":"Limites administratives","bornes":"Bornes sumi","hydro":"Hydrographie","routes":"Routes","bati":"B\xe2timents","batiment":"B\xe2timents","camping":"Camping","equipement":"\xc9quipements","commun":"Commun","geographie":"Lieux naturels","parc":"Parcs","secteur":"Secteurs","immeubles":"Immeubles patrimoniaux","sites":"Sites patrimoniaux","cpe":"Centre de la petite enfance","public":"\xc9coles publiques","prive":"\xc9coles priv\xe9s","gouvernemental":"\xc9coles gouvernementales","colleges":"Coll\xe8ges","universites":"Universit\xe9s","aine":"R\xe9sidences pour a\xeen\xe9s","ambulance":"Zones d\'ambulance","clinique":"Cliniques","etabl":"\xc9tablissements de sant\xe9","gmf":"Groupes de m\xe9decins de famille","naissance":"Maisons de naissances","pharmacie":"Pharmacies","casernes":"Casernes de pompiers","correctionnel":"Centres correctionnels","organisme":"Organismes de s\xe9curit\xe9","palais-justice":"Palais de justice","penitencier-fed":"P\xe9nitenciers f\xe9d\xe9raux","penitencier-prov":"P\xe9nitenciers provinciaux","polices":"Poste de police"},"measure":{"dialog":{"title":"Sommes de la s\xe9lection","length.title":"Distance","area.title":"Superficie","lengthInMeters":"m","lengthInKilometers":"km","lengthInMiles":"mi","lengthInFeet":"pi","areaInSquareMeters":"m\xb2","areaInSquareKilometers":"km\xb2","areaInSquareMiles":"mi\xb2","areaInHectares":"ha","areaInAcres":"ac","perimeterInMeters":"P\xe9rim\xe8tre en m\xe8tres"},"layerTitle":"Mesure \xe0 la carte","area":"Superficie","areaHeader":"Superficie","length":"Distance","lengthHeader":"Distance / P\xe9rim\xe8tre","perimeter":"P\xe9rim\xe8tre","meters":"m","m":"m","kilometers":"km","km":"km","miles":"mi","mi":"mi","feet":"pi","ft":"pi","squareMeters":"m\xb2","m\xb2":"m\xb2","squareKilometers":"km\xb2","km\xb2":"km\xb2","squareMiles":"mi\xb2","mi\xb2":"mi\xb2","squareFeet":"pi\xb2","ft\xb2":"pi\xb2","hectares":"ha","ha":"ha","acres":"ac","ac":"ac","toggleActive":"Activer le contr\xf4le de mesure","toggleDisplayLines":"Afficher les distances pour les lignes","toggleDisplayDistance":"Afficher les distances pour les superficies","toggleDisplayAreas":"Afficher les superficies","toggleAutoUnits":"Unit\xe9s automatiques","actionbar":{"calculate.tooltip":"Totaux et conversions","delete.tooltip":"Supprimer","modify.tooltip":"Modifier"}},"draw":{"abort":"Annuler le dessin en cours","cancelColorPicker":"Annuler","Circle":"Cercle","colorPicker":"Cliquer pour ouvrir le s\xe9lecteur de couleurs","dialogInstruction":"Veuillez entrer l\'\xe9tiquette de votre dessin","dialogTitle":"\xc9tiquette","delete":"Retirer les dessins de la carte","drawing":"Dessins","fill":"Remplissage","finish":"Terminer le dessin en cours","icon":"Ic\xf4nes","labels":"\xc9tiquettes","LineString":"Ligne","move":"Centrer la vue sur le curseur","noIcon":"Aucune ic\xf4ne","noLabel":"Aucune \xe9tiquette","Point":"Point","Polygon":"Polygone","radius":"Rayon","shortcuts":"Raccourcis clavier","stroke":"Contour","styleSelect":"S\xe9lectionner le style","toggleMapTooltips":"Afficher les \xe9tiquettes","undo":"Retirer le dernier sommet"},"network":{"online":{"message":"En ligne","title":"Statut:"},"offline":{"message":"Hors-Ligne","title":"Statut:"}},"workspace":{"inMapExtent.active.tooltip":"Ne montrer que les enregistrements contenus dans la carte","inMapExtent.inactive.tooltip":"Montrer tous les enregistrements"}},"integration":{"tools":{"catalog":"Catalogue","contexts":"Contextes","directions":"Itin\xe9raire","draw":"Dessin","importExport":"Importer et exporter","ogcFilter":"Filtrer par","map":"Carte","layers":"Couches","legend":"L\xe9gende","measurer":"Mesurer","print":"Imprimer","searchResults":"R\xe9sultats de recherche","shareMap":"Partager","timeFilter":"Filtre temporel","about":"\xc0 propos","spatialFilter":"Filtre spatial","advancedMap":"Outils avanc\xe9s"},"searchResultsTool":{"noResults":"Aucun r\xe9sultat","doSearch":"Veuillez effectuer une recherche dans la barre de recherche ci-dessus.","examples":"<b>Permet de rechercher des adresses, des lieux, des coordonn\xe9es ou des couches</b>.<br><br>Les recherches d\'<u>adresses</u> peuvent \xeatre effectu\xe9es selon une combinaison: <ul><li>du no. immeuble</li><li>du nom de la rue</li><li>de la ville</li><li>du code postal</li></ul> Exemples pour les <u>lieux</u>: <ul><li>Lac Poulin</li><li>Mcdo L\xe9vis</li><li>Saint-Isidore</li></ul> Vous pouvez aussi utiliser des mots cl\xe9s pour pr\xe9ciser votre recherche. Exemples: <ul><li>#mun qu\xe9bec (pour rechercher une municipalit\xe9)</li><li>#sante L\xe9vis (pour rechercher un \xe9tablissement de sant\xe9)</li><li>#cpe joyeux (pour rechercher un centre de la petite enfance)</li><li>#intersection li\xe9gois + \xe9glise (pour rechercher une intersection, le #+ peut aussi \xeatre utilis\xe9)</li></ul>*Les mots cl\xe9s apparaissent au survol d\'un type dans l\'onglet des param\xe8tres de recherche -> iCherche -> Type de r\xe9sultat.<br><br>Exemple pour les <u>coordonn\xe9es</u> :<ul><li>Degr\xe9 d\xe9cimal (-68.165547, 48.644546)</li><li>Degr\xe9 minute seconde (-68 9 56, 48 38 40)</li><li>Degr\xe9 minute d\xe9cimal (-68 9.56, 48 38.40)</li><li>Projet\xe9 (UTM-19 561466.861, 5388278.862)</li><li>BELL (Lat: 48 38 40N Long: 68 9 56W UNC:100 CONF:90)</li><li>Metre Metre (111594.63, 445854.74;32198)</li></ul>Pour plus d\'informations sur la recherche par coordonn\xe9es : <a href=\'https://igo2.readthedocs.io/fr/next/properties.html#coordonnees\' target=\'_blank\'>Consulter la documentation d\'IGO2</a>","zoomOnFeatureTooltip":"Zoomer sur l\'entit\xe9 s\xe9lectionn\xe9e.","zoomOnFeatureTooltipOutOfView":"L\'entit\xe9 est hors de la vue. Zoomer sur l\'entit\xe9 s\xe9lectionn\xe9e."},"aboutTool":{"headerHtml":"","html":"<style>#about .bold_class{font-weight: bold;}#about .red{color: red;}#about .tool_name{border-top: 1px solid; padding-top: 10px;}#about .titre_outil{font-weight: bold; font-size: 18px; padding-bottom: 8px;}#about .subtitle{font-size: 20px; padding-bottom: 10px;}#about .align_right{text-align: right;}#about .describe{text-align: justify;}#about a img{color: black; text-decoration: none;}</style><body> <div id=\'about\'> <div class=\'bold_class subtitle\'>Aper\xe7u des fonctionnalit\xe9s</div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z\'> </path> </svg></mat-icon> Recherche </div><div class=\'describe\'> Situ\xe9e dans la portion sup\xe9rieure gauche de l\u2019interface, la barre de <span class=\'bold_class\'>Recherche</span> permet de se positionner \xe0 l\u2019aide d\u2019une adresse, d\u2019un lieu ou de coordonn\xe9es GPS et peut \xe9galement servir \xe0 rechercher une couche. <br><br> Il est \xe9galement possible de rechercher un \xe9l\xe9ment par type de r\xe9sultats en utilisant le hashtag \xab # \xbb (par exemple, #municipalites qu\xe9bec). Les accents et les lettres majuscules n\'importent pas lors de l\'utilisation du hashtag et n\'ont pas d\'impact sur les <span class=\'bold_class\'>R\xe9sultats de recherche</span>.</div></div><br><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z\'></path> </svg></mat-icon> Contextes </div><div class=\'describe\'> Les <span class=\'bold_class\'>Contextes</span> permettent de visualiser des regroupements de couches faits par th\xe8me ou par contexte de travail. Lorsqu\'un contexte est s\xe9lectionn\xe9, toutes les couches qu\'il contient se retrouvent alors dans la <span class=\'bold_class\'>Carte</span>. Il est possible d\'ajouter d\u2019autres couches \xe0 partir du <span class=\'bold_class\'>Catalogue</span> ou de l\u2019outil <span class=\'bold_class\'>Recherche.</span> </div><br><div class=\'red\'> <span class=\'bold_class\'>ATTENTION :</span> Si un nouveau contexte est s\xe9lectionn\xe9, toutes les couches affich\xe9es dans la <span class=\'bold_class\'>Carte</span> seront remplac\xe9es par celles de ce nouveau contexte. </div><br><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M15,19L9,16.89V5L15,7.11M20.5,3C20.44,3 20.39,3 20.34,3L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21C3.55,21 3.61,21 3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3Z\'> </path> </svg></mat-icon> Carte </div><div class=\'describe\'> Il est possible de personnaliser la <span class=\'bold_class\'>Carte</span> \xe0 partir du <span class=\'bold_class\'>Catalogue</span> ou de l\u2019outil <span class=\'bold_class\'>Recherche.</span> Cet espace permet entre autres d\u2019ajouter, de supprimer, d\u2019interroger, de filtrer et de trier les couches pr\xe9sent\xe9es. Il est \xe9galement possible d\'afficher les l\xe9gendes des couches.</div><br></div><div class=\'tool_name\'><div class=\'titre_outil\'><mat-icon class=\'mat-icon\'><svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'><path d=\'M2 4C2 2.89 2.9 2 4 2H7V4H4V7H2V4M22 4V7H20V4H17V2H20C21.1 2 22 2.89 22 4M2 20V17H4V20H7V22H4C2.9 22 2 21.11 2 20M10 2H14V4H10V2M10 20H14V22H10V20M2 10H4V14H2V10M18.5 13C20.4 13 22 14.6 22 16.5C22 19.1 18.5 23 18.5 23C18.5 23 15 19.1 15 16.5C15 14.6 16.6 13 18.5 13M18.5 17.8C19.2 17.8 19.8 17.2 19.7 16.6C19.7 16 19.1 15.4 18.5 15.4C17.9 15.4 17.3 15.9 17.3 16.6C17.3 17.2 17.8 17.8 18.5 17.8M20 10H22V12.34C21.42 11.84 20.74 11.45 20 11.23V10Z\'></path></svg></mat-icon> Filtre spatial </div><div class=\'describe\'> Le <span class=\'bold_class\'>Filtre spatial</span> permet de rechercher des adresses ou des th\xe9matiques selon des zones pr\xe9d\xe9finies (par exemple, par arrondissement ou par MRC) ou selon un dessin r\xe9alis\xe9 par l\'utilisateur. Les r\xe9sultats du filtre peuvent \xeatre export\xe9s \xe0 l\'aide de l\'outil <span class=\'bold_class\'>Importer et exporter</span>. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M1.39,18.36L3.16,16.6L4.58,18L5.64,16.95L4.22,15.54L5.64,14.12L8.11,16.6L9.17,15.54L6.7,13.06L8.11,11.65L9.53,13.06L10.59,12L9.17,10.59L10.59,9.17L13.06,11.65L14.12,10.59L11.65,8.11L13.06,6.7L14.47,8.11L15.54,7.05L14.12,5.64L15.54,4.22L18,6.7L19.07,5.64L16.6,3.16L18.36,1.39L22.61,5.64L5.64,22.61L1.39,18.36Z\'> </path> </svg></mat-icon> Mesurer </div><div class=\'describe\'> Cet outil permet de <span class=\'bold_class\'>Mesurer</span> des distances ou des superficies directement sur la carte. </div><br></div><div class=\'tool_name\'><div class=\'titre_outil\'><mat-icon class=\'mat-icon\'><svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'><path d=\'M9.75 20.85C11.53 20.15 11.14 18.22 10.24 17C9.35 15.75 8.12 14.89 6.88 14.06C6 13.5 5.19 12.8 4.54 12C4.26 11.67 3.69 11.06 4.27 10.94C4.86 10.82 5.88 11.4 6.4 11.62C7.31 12 8.21 12.44 9.05 12.96L10.06 11.26C8.5 10.23 6.5 9.32 4.64 9.05C3.58 8.89 2.46 9.11 2.1 10.26C1.78 11.25 2.29 12.25 2.87 13.03C4.24 14.86 6.37 15.74 7.96 17.32C8.3 17.65 8.71 18.04 8.91 18.5C9.12 18.94 9.07 18.97 8.6 18.97C7.36 18.97 5.81 18 4.8 17.36L3.79 19.06C5.32 20 7.88 21.47 9.75 20.85M20.84 5.25C21.06 5.03 21.06 4.67 20.84 4.46L19.54 3.16C19.33 2.95 18.97 2.95 18.76 3.16L17.74 4.18L19.82 6.26M11 10.92V13H13.08L19.23 6.85L17.15 4.77L11 10.92Z\'></path></svg></mat-icon> Dessin </div><div class=\'describe\'> L\'outil <span class=\'bold_class\'>Dessin</span> permet de dessiner des entit\xe9s ponctuelles, lin\xe9aires, polygonales ou circulaires accompagn\xe9es ou non d\'\xe9tiquettes. La couleur de remplissage et du contour des entit\xe9s peuvent \xeatre choisies \xe0 l\'aide des s\xe9lecteurs correspondants. <br><br> Une couche Dessins peut \xeatre export\xe9e \xe0 l\'aide de l\'outil <span class=\'bold_class\'>Importer et exporter</span>. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M14,14.5V12H10V15H8V11A1,1 0 0,1 9,10H14V7.5L17.5,11M21.71,11.29L12.71,2.29H12.7C12.31,1.9 11.68,1.9 11.29,2.29L2.29,11.29C1.9,11.68 1.9,12.32 2.29,12.71L11.29,21.71C11.68,22.09 12.31,22.1 12.71,21.71L21.71,12.71C22.1,12.32 22.1,11.68 21.71,11.29Z\'> </path> </svg></mat-icon> Itin\xe9raire </div><div class=\'describe\'> Il est possible de construire un <span class=\'bold_class\'>Itin\xe9raire</span> entre deux points en s\xe9lectionnant un point de d\xe9part et un point d\'arriv\xe9e dans la carte ou en recherchant des adresses. Il est ensuite possible d\'ajouter des points d\'arr\xeat interm\xe9diaires et de copier la description ou le lien de l\'itin\xe9raire dans le presse-papier. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M17,14H19V17H22V19H19V22H17V19H14V17H17V14M11,16L2,9L11,2L20,9L11,16M11,18.54L12,17.75V18C12,18.71 12.12,19.39 12.35,20L11,21.07L2,14.07L3.62,12.81L11,18.54Z\'></path> </svg></mat-icon> Catalogue </div><div class=\'describe\'> Le <span class=\'bold_class\'>Catalogue</span> contient toutes les couches qui peuvent \xeatre ajout\xe9es \xe0 la <span class=\'bold_class\'>Carte</span>. L\'utilisateur doit cliquer sur + de la couche d\xe9sir\xe9e afin de l\u2019ajouter \xe0 la <span class=\'bold_class\'>Carte</span>. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M14,17H18V14L23,18.5L18,23V20H14V17M13,9H18.5L13,3.5V9M6,2H14L20,8V12.34C19.37,12.12 18.7,12 18,12A6,6 0 0,0 12,18C12,19.54 12.58,20.94 13.53,22H6C4.89,22 4,21.1 4,20V4A2,2 0 0,1 6,2Z\'></path> </svg></mat-icon> Importer et exporter </div><div class=\'describe\'> Il est possible d\'<span class=\'bold_class\'>Importer</span> un fichier vectoriel tout en sp\xe9cifiant un syst\xe8me de coordonn\xe9es ou une projection. <br><br> Il est possible d\'<span class=\'bold_class\'>Exporter</span> une ou plusieurs couches dans plusieurs formats courants. <br><br> Il est \xe9galement possible d\'<span class=\'bold_class\'>Importer</span> ou d\'<span class=\'bold_class\'>Exporter</span> un contexte localement. Cette derni\xe8re fonctionnalit\xe9 permet ainsi de sauvegarder des contextes en mode non-authentifi\xe9 ou anonyme. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z\'></path> </svg></mat-icon> Imprimer </div><div class=\'describe\'> Cet outil permet d\'<span class=\'bold_class\'>Imprimer</span> la carte affich\xe9e \xe0 l\u2019\xe9cran en sp\xe9cifiant plusieurs options telles qu\'un titre, un commentaire, le format de sortie, le format du papier et l\'orientation de l\'impression. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M18,16.08C17.24,16.08 16.56,16.38 16.04,16.85L8.91,12.7C8.96,12.47 9,12.24 9,12C9,11.76 8.96,11.53 8.91,11.3L15.96,7.19C16.5,7.69 17.21,8 18,8A3,3 0 0,0 21,5A3,3 0 0,0 18,2A3,3 0 0,0 15,5C15,5.24 15.04,5.47 15.09,5.7L8.04,9.81C7.5,9.31 6.79,9 6,9A3,3 0 0,0 3,12A3,3 0 0,0 6,15C6.79,15 7.5,14.69 8.04,14.19L15.16,18.34C15.11,18.55 15.08,18.77 15.08,19C15.08,20.61 16.39,21.91 18,21.91C19.61,21.91 20.92,20.61 20.92,19A2.92,2.92 0 0,0 18,16.08Z\'> </path> </svg></mat-icon> Partager </div><div class=\'describe\'> L\'outil <span class=\'bold_class\'>Partager</span> permet de cr\xe9er une adresse URL qui redirige vers une repr\xe9sentation exacte de la <span class=\'bold_class\'>Carte</span> affich\xe9e \xe0 l\u2019\xe9cran. Ce lien peut, par exemple, \xeatre partag\xe9 ou diffus\xe9 dans un document, permettant ainsi de \xab&nbspsauvegarder \xbb la carte pour une utilisation ult\xe9rieure. </div><br></div><div class=\'tool_name\'> <p> <a href=\'http://igouverte.org/\' target=\'_blank\'><img src=\'./assets/igo2/core/logo.png\' alt=\'IGO\' height=32>IGO2</a> est une solution Web libre g\xe9omatique d\xe9velopp\xe9e en mode collaboratif par des sp\xe9cialistes provenant de plusieurs minist\xe8res et organismes du gouvernement du Qu\xe9bec.</p><p>Version: {{version.lib}}</p></div>","trainingGuide":"Guide de formation","trainingGuideTooltip":"Cliquez ici pour acc\xe9der au guide d\'autoformation de IGO2"},"mapTool":{"empty":"La carte ne contient aucune couche de donn\xe9es.","customize":"Personnalisez-l\xe0 en ajoutant des couches \xe0 partir des outils suivants : ","search-tool":"Recherche","catalog-tool":"Catalogue de donn\xe9es","context-tool":"Gestionnaire de contextes","noLayersVisible":"Aucune couche visible.","noLayersInRange":"Aucune couche visible dans la plage d\'\xe9chelle active. Veuillez zoomer ou d\xe9zoomer pour d\xe9couvrir ces couches."},"importExportTool":{"importExportData":"Couche","importExportContext":"Contexte"},"workspace":{"toggleWorkspace":"Ouvrir/fermer la vue tabulaire","ogcFilter.close":"Fermer","ogcFilter.title":"Filtres","ogcFilter.tooltip":"Appliquer des filtres sur la couche","download.title":"T\xe9l\xe9charger les donn\xe9es associ\xe9es","download.tooltip":"T\xe9l\xe9charger les donn\xe9es associ\xe9es","inMapExtent.title":"Montrer les entit\xe9s contenues dans la carte","inMapExtent.active.tooltip":"Montrer les entit\xe9s contenues dans la carte","inMapExtent.inactive.tooltip":"Montrer toutes les entit\xe9s","zoomAuto.title":"Zoom auto","zoomAuto.tooltip":"Zoom auto","selected.title":"Montrer les entit\xe9s s\xe9lectionn\xe9es","selected.tooltip":"Montrer les entit\xe9s s\xe9lectionn\xe9es","clearSelection.title":"Tout d\xe9s\xe9lectionner","clearSelection.tooltip":"D\xe9s\xe9lectionner les enregistrements s\xe9lectionn\xe9s","maximize":"Agrandir","maximizeTooltip":"Agrandir la fen\xeatre","standardExtent":"R\xe9duire","standardExtentTooltip":"R\xe9duire la fen\xeatre"},"directions":{"warning":{"title":"Avertissement","message":"L\'itin\xe9raire propos\xe9 dans cet outil ne tient pas compte des conditions routi\xe8res actuelles, de la congestion routi\xe8re ou des entraves pr\xe9sentes sur le r\xe9seau."}},"advanced-map-tool":{"advanced-swipe":{"swipe-select":"Choisir les couches \xe0 comparer","selectAll":"Tout s\xe9lectionner","empty":"La carte ne contient aucune couche de donn\xe9es.","customize":"Personnalisez-l\xe0 en ajoutant des couches \xe0 partir des outils suivants : ","search-tool":"Recherche","catalog-tool":"Catalogue de donn\xe9es","context-tool":"Gestionnaire de contextes","swipe":"Activer","swipe-tool":"Outil de comparaison"},"advanced-coordinates":{"copy":"Copier","lon":"Longitude","lat":"Latitude","nord":"Nord","est":"Est","coordinates":"Coordonn\xe9es du centre de la carte","copyMsg":"Coordonn\xe9es copi\xe9s","copyTitle":"Coordonn\xe9es du centre","center":"Centre","coordSystem":"Syst\xe8me de coordonn\xe9es","zoom":"Niveau de zoom courant: "}}}}}')}},function(e){e.O(0,[736],function(){return e(e.s=88214)}),e.O()}]);
//# sourceMappingURL=main-es2015.9a28bfb141ecee264f5e.js.map