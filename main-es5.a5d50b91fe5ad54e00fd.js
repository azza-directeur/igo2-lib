!function(){function e(i){var o="function"==typeof Map?new Map:void 0;return(e=function(e){if(null===e||(i=e,-1===Function.toString.call(i).indexOf("[native code]")))return e;var i;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==o){if(o.has(e))return o.get(e);o.set(e,r)}function r(){return t(e,arguments,c(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),n(r,e)})(i)}function t(e,i,o){return(t=l()?Reflect.construct:function(e,t,i){var o=[null];o.push.apply(o,t);var r=new(Function.bind.apply(e,o));return i&&n(r,i.prototype),r}).apply(null,arguments)}function i(e,t,o){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(i):n.value}})(e,t,o||e)}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function r(e){var t=l();return function(){var i,o=c(e);if(t){var n=c(this).constructor;i=Reflect.construct(o,arguments,n)}else i=o.apply(this,arguments);return a(this,i)}}function a(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return s(e)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function p(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=g(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,s=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return a=e.done,e},e:function(e){s=!0,r=e},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw r}}}}function d(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||g(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==i)return;var o,n,r=[],a=!0,s=!1;try{for(i=i.call(e);!(a=(o=i.next()).done)&&(r.push(o.value),!t||r.length!==t);a=!0);}catch(l){s=!0,n=l}finally{try{a||null==i.return||i.return()}finally{if(s)throw n}}return r}(e,t)||g(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){if(e){if("string"==typeof e)return f(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,o=new Array(t);i<t;i++)o[i]=e[i];return o}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function y(e,t,i){return t&&v(e.prototype,t),i&&v(e,i),e}(self.webpackChunk_igo_demo=self.webpackChunk_igo_demo||[]).push([[179],{98255:function(e){function t(e){return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}t.keys=function(){return[]},t.resolve=t,t.id=98255,e.exports=t},36438:function(e,t,i){var o={"./en.auth.json":50257,"./en.common.json":35488,"./en.context.json":88952,"./en.core.json":63154,"./en.geo.json":10711,"./en.integration.json":32766,"./en.json":10503,"./fr.auth.json":8555,"./fr.common.json":20551,"./fr.context.json":68079,"./fr.core.json":5415,"./fr.geo.json":27268,"./fr.integration.json":63031,"./fr.json":65962};function n(e){var t=r(e);return i(t)}function r(e){if(!i.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}n.keys=function(){return Object.keys(o)},n.resolve=r,e.exports=n,n.id=36438},88214:function(t,n,l){"use strict";var g,f,v,b=l(4919),w=l(91477),x=l(99613),S=l(45159),k=l(3323),C=l(43635),T=l(80902),A=l(63266),L=l(30620),Z=l(3259),F=l(40093),O=l(74354),M=l(73393),I=l(87227),P=l(34301),_=l(71435),q=l(18293),D=l(33927),E=l(80639),$=l(1143),R=l(76491),N=l(45871),U=l(81134),J=l(79097),B=l(82516),j=l(13492),Q=l(79441),G=l(83720),Y=((v=function(){function e(){m(this,e)}return y(e,null,[{key:"getByte",value:function(e,t){return e.charCodeAt(t)}},{key:"getByte64",value:function(e,t){return this.ALPHA.indexOf(e.charAt(t))}},{key:"decode",value:function(e){var t,i,o=0,n=e.length,r=[];if(e=String(e),0===n)return e;for(e.charAt(n-1)===this.PADCHAR&&(o=1,e.charAt(n-2)===this.PADCHAR&&(o=2),n-=4),t=0;t<n;t+=4)i=this.getByte64(e,t)<<18|this.getByte64(e,t+1)<<12|this.getByte64(e,t+2)<<6|this.getByte64(e,t+3),r.push(String.fromCharCode(i>>16,i>>8&255,255&i));switch(o){case 1:i=this.getByte64(e,t)<<18|this.getByte64(e,t+1)<<12|this.getByte64(e,t+2)<<6,r.push(String.fromCharCode(i>>16,i>>8&255));break;case 2:i=this.getByte64(e,t)<<18|this.getByte64(e,t+1)<<12,r.push(String.fromCharCode(i>>16))}return r.join("")}},{key:"encode",value:function(e){var t,i,o=[],n=(e=String(e)).length-e.length%3;if(0===e.length)return e;for(t=0;t<n;t+=3)i=this.getByte(e,t)<<16|this.getByte(e,t+1)<<8|this.getByte(e,t+2),o.push(this.ALPHA.charAt(i>>18)),o.push(this.ALPHA.charAt(i>>12&63)),o.push(this.ALPHA.charAt(i>>6&63)),o.push(this.ALPHA.charAt(63&i));switch(e.length-n){case 1:i=this.getByte(e,t)<<16,o.push(this.ALPHA.charAt(i>>18)+this.ALPHA.charAt(i>>12&63)+this.PADCHAR+this.PADCHAR);break;case 2:i=this.getByte(e,t)<<16|this.getByte(e,t+1)<<8,o.push(this.ALPHA.charAt(i>>18)+this.ALPHA.charAt(i>>12&63)+this.ALPHA.charAt(i>>6&63)+this.PADCHAR)}return o.join("")}}]),e}()).PADCHAR="=",v.ALPHA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",v),z=j.getParser(window.navigator.userAgent),V=function(){function e(){m(this,e)}return y(e,null,[{key:"copy",value:function(t){var i=!1;if("string"==typeof t){var o=e.createTextArea(t);e.selectText(o),i=e.copyTextToClipboard(),e.destroyTextArea(o)}else e.selectText(t),i=e.copyTextToClipboard();return i}},{key:"createTextArea",value:function(e){var t=document.createElement("textArea");return t.value=e,document.body.appendChild(t),t}},{key:"destroyTextArea",value:function(e){document.body.removeChild(e)}},{key:"selectText",value:function(e){if("iOS"===z.getOSName()){var t=e.contentEditable,i=e.readOnly,o=document.createRange(),n=window.getSelection();e.contenteditable=!0,e.readonly=!1,o.selectNodeContents(e),n.removeAllRanges(),n.addRange(o),e.setSelectionRange(0,999999),e.contentEditable=t,e.readOnly=i}else e.select()}},{key:"copyTextToClipboard",value:function(){return("iOS"!==z.getOSName()||!z.compareVersion("<10"))&&document.execCommand("copy")}}]),e}(),H=function(){function e(){m(this,e)}return y(e,null,[{key:"diff",value:function(t,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4;if(!t&&!i)return"";if(!t)return'<span class="inserted">'+i+"</span>";if(!i)return'<span class="deleted">'+t+"</span>";t=t.toString(),i=i.toString();var n=e.getChanges(t,i,"",o),r=i.slice(n.mtc.length+n.ins.length+n.sbs.length),a=t.slice(n.mtc.length+n.del.length+n.sbs.length),s="";return n.del.length>0&&(n.del='<span class="deleted">'+n.del+"</span>"),n.ins.length>0&&(n.ins='<span class="inserted">'+n.ins+"</span>"),s=n.mtc+n.del+n.ins+n.sbs,s+=""!==a||""!==r?e.diff(a,r,o):""}},{key:"getMatchingSubstring",value:function(e,t,i){for(var o=0,n=!1,r=e.length,a={fis:r,mtc:i,sbs:""};o<r;)t[o]===e[o]?n?a.sbs+=e[o]:(n=!0,a.fis=o,a.sbs=e[o]):o=n?r:o,++o;return a}},{key:"getChanges",value:function(t,i,o,n){for(var r,a=t.length>=t.length,s=h(a?[t,i]:[i,t],2),l=s[0],c=s[1],u=0;c[u]===l[u]&&u<c.length;)++u;l=l.split("").slice(u),c=c.slice(u);var p=l.length,d={fis:c.length,fil:p,sbs:"",mtc:o+i.slice(0,u)},g={sbs:""};if(""!==c)for(var f=0;f<p&&g.sbs.length<n;f++)(g=e.getMatchingSubstring(c,e.rotateArray(l,f),d.mtc)).fil=f<p-g.fis?g.fis+f:g.fis-p+f,g.sbs.length>d.sbs.length&&(d=g);return r=h(a?[l.slice(0,d.fil).join(""),c.slice(0,d.fis)]:[c.slice(0,d.fis),l.slice(0,d.fil).join("")],2),d.del=r[0],d.ins=r[1],-1===d.del.indexOf(" ")||-1===d.ins.indexOf(" ")||""===d.del||""===d.ins||""===d.sbs?d:e.getChanges(d.del,d.ins,d.mtc,n)}},{key:"rotateArray",value:function(e,t){var i=e.length,o=new Array(e.length);if(t%i==0)return e.slice();for(var n=0;n<i;n++)o[n]=e[(n+(i+t%i))%i];return o}}]),e}(),W=function(){return(e=W||(W={})).ADDED="added",e.DELETED="deleted",e.MODIFIED="modified",W;var e}(),X=function(){function e(){m(this,e)}return y(e,null,[{key:"findChanges",value:function(t,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n={added:[],deleted:[],modified:[]};if(!t||!i)return n;var r,a=d(t),s=d(i),l=p(a);try{var c=function(){var t=r.value,i=s.findIndex(function(e){return e.id===t.id});if(-1===i)return n.deleted.push({change:{type:W.DELETED},value:t}),"continue";var a=s.splice(i,1)[0],l=JSON.parse(JSON.stringify(t)),c=JSON.parse(JSON.stringify(a)),u=e.compareObject(l,c,void 0,o);u.length&&n.modified.push({change:{type:W.MODIFIED,keysChanged:u},value:l,oldValue:t,newValue:a})};for(l.s();!(r=l.n()).done;)c()}catch(u){l.e(u)}finally{l.f()}return n.added=s.map(function(e){return{change:{type:W.ADDED},value:e}}),n}},{key:"compareObject",value:function(e,t,i){var o=this,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=JSON.parse(JSON.stringify(e)),a=JSON.parse(JSON.stringify(t)),s=new Set([].concat(d(Object.keys(e)),d(Object.keys(t)))),l=[];return s.forEach(function(s){var c=i?"".concat(i,".").concat(s):s;-1===n.indexOf(c)&&(Array.isArray(e[s])&&(e[s]=e[s].join(",<br>")),Array.isArray(t[s])&&(t[s]=t[s].join(",<br>")),"object"==typeof e[s]&&"object"==typeof t[s]&&null!==e[s]&&null!==t[s]?l=l.concat(o.compareObject(e[s],t[s],c)):e[s]!==t[s]&&(l.push({key:c,oldValue:r[s],newValue:a[s]}),e[s]=H.diff(e[s],t[s])))}),l}}]),e}(),K=function(){function e(){m(this,e)}return y(e,null,[{key:"resolve",value:function(e,t){for(var i=t.replace(/\[/g,".").replace(/\]/g,"").split("."),o=e;i.length;){if("object"!=typeof o)return;o=o[i.shift()]}return o}},{key:"isObject",value:function(e){return e&&"object"==typeof e&&!Array.isArray(e)&&null!==e&&!(e instanceof Date)}},{key:"mergeDeep",value:function(t,i){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=Object.assign({},t);return e.isObject(t)&&e.isObject(i)&&Object.keys(i).filter(function(e){return!o||void 0!==i[e]}).forEach(function(r){e.isObject(i[r])&&r in t?n[r]=e.mergeDeep(t[r],i[r],o):Object.assign(n,u({},r,i[r]))}),n}},{key:"copyDeep",value:function(e){var t=Array.isArray(e)?[]:{};for(var i in e)if(e.hasOwnProperty(i)){var o=e[i];t[i]=o&&"object"==typeof o?this.copyDeep(o):o}return t}},{key:"removeDuplicateCaseInsensitive",value:function(e){var t={},i={},o=[];for(var n in e)if(e.hasOwnProperty(n)){var r=n.toUpperCase();t.hasOwnProperty(r)?t[r].push(u({},n,e[n])):t[r]=[u({},n,e[n])],o.push({key:n,count:n.replace(/[^A-Z]/g,"").length})}var a=function(n){if(t.hasOwnProperty(n)&&t.hasOwnProperty(n)){var r=t[n];if(1===r.length){var a=r[0];i[n]=a[Object.keys(a)[0]]}else if(r.length>1){var s=o.filter(function(e){return e.key.toLowerCase()===n.toLowerCase()}).reduce(function(e,t){return e.y<t.y?e:t});i[s.key.toUpperCase()]=e[s.key]}}};for(var s in t)a(s);for(var l in e)e.hasOwnProperty(l)&&delete e[l];for(var c in i)i.hasOwnProperty(c)&&(e[c]=i[c])}},{key:"removeUndefined",value:function(t){var i={};return e.isObject(t)?(Object.keys(t).filter(function(e){return void 0!==t[e]}).forEach(function(o){i[o]=e.isObject(t[o])||Array.isArray(t[o])?e.removeUndefined(t[o]):t[o]}),i):Array.isArray(t)?t.map(function(t){return e.removeUndefined(t)}):t}},{key:"removeNull",value:function(t){var i={};return e.isObject(t)?(Object.keys(t).filter(function(e){return null!==t[e]}).forEach(function(o){i[o]=e.isObject(t[o])||Array.isArray(t[o])?e.removeNull(t[o]):t[o]}),i):Array.isArray(t)?t.map(function(t){return e.removeNull(t)}):t}},{key:"naturalCompare",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"asc",o=arguments.length>3?arguments[3]:void 0;if("desc"===i&&(t=[e,e=t][0]),null===e||""===e||void 0===e||null===t||""===t||void 0===t){var n=e===t?0:void 0===e?3:void 0===t?-3:null===e?2:null===t?-2:""===e?1:-1;return"desc"===i?!1!==o?n:-1*n:!0===o?-1*n:n}var r=[],a=[];for(t=""+t,(e=""+e).replace(/(\d+)|(\D+)/g,function(e,t,i){r.push([t||1/0,i||""])}),t.replace(/(\d+)|(\D+)/g,function(e,t,i){a.push([t||1/0,i||""])});r.length&&a.length;){var s=r.shift(),l=a.shift(),c=s[0]-l[0]||s[1].localeCompare(l[1]);if(c)return c}return r.length-a.length}},{key:"objectsAreEquivalent",value:function(e,t){if(e===t)return!0;var i=Object.getOwnPropertyNames(e),o=Object.getOwnPropertyNames(t);if(i.length!==o.length)return!1;var n,r=p(i);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(e[a]!==t[a])return!1}}catch(s){r.e(s)}finally{r.f()}return!0}},{key:"removeKeys",value:function(e,t){return Object.keys(e).filter(function(e){return t.indexOf(e)<0}).reduce(function(t,i){return t[i]=e[i],t},{})}}]),e}(),ee=function(){function e(){m(this,e)}return y(e,null,[{key:"roundToNDecimal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,i=Math.pow(10,t);return Math.round(e*i)/i}}]),e}();function te(e){return e.reduce(function(e,t){return e[t]=t,e},Object.create(null))}function ie(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function oe(){return"".concat(ie()).concat(ie(),"-").concat(ie(),"-").concat(ie(),"-").concat(ie(),"-").concat(ie()).concat(ie()).concat(ie()).toLowerCase()}var ne=function(){return(e=ne||(ne={}))[e.Error=0]="Error",e[e.Done=1]="Done",e[e.Working=2]="Working",e[e.Waiting=3]="Waiting",ne;var e}(),re=function(){function e(){m(this,e),this.status$=new Q.xQ}return y(e,[{key:"status",get:function(){return this._status},set:function(e){this._status=e,this.status$.next(e)}},{key:"subscribe",value:function(e,t){var i=this;this.watch(),this.status$$=this.status$.pipe((0,G.x)()).subscribe(function(o){i.handleStatusChange(o),e.call(t,i)})}},{key:"unsubscribe",value:function(){this.unwatch(),void 0!==this.status$$&&(this.status$$.unsubscribe(),this.status$$=void 0),this.status=ne.Waiting}},{key:"handleStatusChange",value:function(e){}}]),e}(),ae=l(13828),se=l(74448),le=l(13216),ce=function(){var e=function(){function e(){m(this,e),this.counter$=new R.X(0),this.ids=[]}return y(e,[{key:"register",value:function(){var e=oe();return this.ids.push(e),this.counter$.next(this.ids.length),e}},{key:"unregister",value:function(e){var t=this.ids.indexOf(e);-1!==t&&(this.ids.splice(t,1),this.counter$.next(this.ids.length))}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),ue=function(){var e=function(){function e(t){m(this,e),this.activityService=t}return y(e,[{key:"intercept",value:function(e,t){var i=this,o=e.headers.get("activityInterceptor");if(o){var n=e.clone({headers:e.headers.delete("activityInterceptor")});if("false"===o)return t.handle(n)}var r=this.activityService.register();return t.handle(e).pipe((0,_.x)(function(){i.activityService.unregister(r)}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(ce))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac}),e}(),pe=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[{provide:P.TP,useClass:ue,multi:!0}]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[]]}),e}(),de={lib:"1.11.1",releaseDate:1649355043171},he=function(){var e=function(){function e(t){m(this,e),this.injector=t,this.config={}}return y(e,[{key:"getConfig",value:function(e){return K.resolve(this.config,e)}},{key:"load",value:function(e){var t=this,i=e.default||{};if(!e.path)return this.config=i,!0;var o=this.injector.get(P.eN);return new Promise(function(n,r){o.get(e.path).pipe((0,q.K)(function(t){return console.log("Configuration file ".concat(e.path," could not be read")),n(!0),(0,N._)(t.error||"Server error")})).subscribe(function(e){t.config=K.mergeDeep(K.mergeDeep({version:de},i),e),n(!0)})})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(w.zs3))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),ge=new w.OlP("configOptions");function fe(e){return{provide:ge,useValue:e}}function me(e,t){return function(){return e.load(t)}}var ve=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[fe({}),{provide:w.ip1,useFactory:me,multi:!0,deps:[he,ge]}]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[]]}),e}(),ye=function(){function e(t,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".json",n=arguments.length>3?arguments[3]:void 0;m(this,e),this.http=t,this.prefix=i,this.suffix=o,this.config=n}return y(e,[{key:"getTranslation",value:function(e){var t=this,i=l(36438)("./".concat(e,".json")),o=(0,U.of)(i);if(this.config&&!this.prefix){var n=this.config.getConfig("language.prefix");this.prefix=!n||Array.isArray(n)?n:[n]}if(!this.prefix||0===this.prefix.length)return o;var r=this.prefix.map(function(i){return t.http.get("".concat(i).concat(e).concat(t.suffix))});return(0,J.aj)([o].concat(d(r))).pipe((0,D.U)(function(e){return e.reduce(function(e,t){return K.mergeDeep(e,t)},{})}))}}]),e}();function be(e,t){return new ye(e,void 0,void 0,t)}function we(e){return{provide:ae.Zw,useFactory:e||be,deps:[P.eN,he]}}var xe=function(){function e(){m(this,e)}return y(e,[{key:"handle",value:function(e){if(!e.translateService.langs.length)throw new Error("Translations are not yet loaded.          Check that the LanguageService is injected.");if("igo."===e.key.substr(0,4))throw new Error('The Key "'.concat(e.key,'" is missing in locale file.'));return e.key}}]),e}(),Se=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[we()]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[ae.aw.forRoot({missingTranslationHandler:{provide:ae.gC,useClass:xe}})],ae.aw]}),e}(),ke=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,se.Rh.forRoot({positionClass:"toast-bottom-right",timeOut:1e4,extendedTimeOut:1e4,messageClass:"toast-message mat-typography",closeButton:!0,progressBar:!0,enableHtml:!0,tapToDismiss:!0,maxOpened:4,preventDuplicates:!0,resetTimeoutOnDuplicate:!0,countDuplicates:!1,includeTitleDuplicates:!0})]]}),e}(),Ce=function(){var e=function(){function e(t){m(this,e),this.translate=t,this.language=this.translate.getBrowserLang();var i=this.getLanguage();this.translate.setDefaultLang(i)}return y(e,[{key:"getLanguage",value:function(){return this.language.match(/en|fr/)?this.language:"en"}},{key:"setLanguage",value:function(e){this.language=e.match(/en|fr/)?e:"en",this.translate.use(this.language),this.translate.reloadLang(this.language)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(ae.sK))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Te=function(){return(e=Te||(Te={})).ERROR="error",e.ALERT="warning",e.WARNING="warning",e.INFO="info",e.SUCCESS="success",Te;var e}(),Ae=function(){var e=function(){function e(t,i,o){m(this,e),this.injector=t,this.configService=i,this.languageService=o,this.messages$=new R.X([]),this.options=this.configService.getConfig("message")||{}}return y(e,[{key:"toastr",get:function(){return this.injector.get(se._W)}},{key:"showError",value:function(e){return e.error.caught=!0,this.error(e.error.message,e.error.title)}},{key:"message",value:function(e){this.messages$.next(this.messages$.value.concat([e])),e.options=e.options||{};var t=new Date;if(e.options.from=e.options.from?e.options.from:new Date("1 jan 1900"),e.options.to=e.options.to?e.options.to:new Date("1 jan 3000"),"string"==typeof e.options.from&&(e.options.from=new Date(Date.parse(e.options.from.replace(/-/g," ")))),"string"==typeof e.options.to&&(e.options.to=new Date(Date.parse(e.options.to.replace(/-/g," ")))),t>e.options.from&&t<e.options.to&&(e=this.handleTemplate(e)).text){var i;switch(e.type){case Te.SUCCESS:i=this.success(e.text,e.title,e.options);break;case Te.ERROR:i=this.error(e.text,e.title,e.options);break;case Te.INFO:i=this.info(e.text,e.title,e.options);break;case Te.ALERT:case Te.WARNING:i=this.alert(e.text,e.title,e.options);break;default:i=this.info(e.text,e.title,e.options)}e.options.id=i.toastId}}},{key:"success",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"igo.core.message.success",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=this.languageService.translate.instant(e),n=this.languageService.translate.instant(t);return this.toastr.success(o,n,i)}},{key:"error",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"igo.core.message.error",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=this.languageService.translate.instant(e),n=this.languageService.translate.instant(t);return this.toastr.error(o,n,i)}},{key:"info",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"igo.core.message.info",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=this.languageService.translate.instant(e),n=this.languageService.translate.instant(t);return this.toastr.info(o,n,i)}},{key:"alert",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"igo.core.message.alert",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=this.languageService.translate.instant(e),n=this.languageService.translate.instant(t);return this.toastr.warning(o,n,i)}},{key:"remove",value:function(e){this.toastr.remove(e)}},{key:"removeAllAreNotError",value:function(){var e,t=p(this.messages$.value);try{for(t.s();!(e=t.n()).done;){var i=e.value;i.type!==Te.ERROR&&this.remove(i.options.id)}}catch(o){t.e(o)}finally{t.f()}}},{key:"handleTemplate",value:function(e){if(!this.options.template||e.html)return e;var t=this.options.template;return t=(t=t.replace("${text}",e.text)).replace("${title}",e.title),e.html=void 0,e.text=t,e.title=void 0,e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(w.zs3),w.LFG(he),w.LFG(Ce))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Le=function(){var e=function(){function e(t,i){m(this,e),this.messageService=t,this.injector=i}return y(e,[{key:"intercept",value:function(e,t){var i=this,o={httpError:void 0};return t.handle(e).pipe((0,q.K)(function(e){return i.handleError(e,o)}),(0,_.x)(function(){i.handleCaughtError(o),i.handleUncaughtError(o)}))}},{key:"handleError",value:function(e,t){if(e instanceof P.UA){var i="object"===e.error?e.error:{};i.message=e.error.message||e.statusText,i.caught=!1,e=new P.UA({error:i,headers:e.headers,status:e.status,statusText:e.statusText,url:e.url})}return t.httpError=e,(0,N._)(e)}},{key:"handleCaughtError",value:function(e){var t=e.httpError;t&&t.error.toDisplay&&(t.error.caught=!0,this.messageService.error(t.error.message,t.error.title))}},{key:"handleUncaughtError",value:function(e){var t=e.httpError;if(t&&!t.error.caught){var i=this.injector.get(Ce).translate,o=i.instant("igo.core.errors.uncaught.message"),n=i.instant("igo.core.errors.uncaught.title");t.error.caught=!0,this.messageService.error(o,n)}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(Ae),w.LFG(w.zs3))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Ze=function(){var e=function(){function e(t){if(m(this,e),t)throw new Error("IgoErrorModule is already loaded. Import it in the AppModule only")}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[{provide:P.TP,useClass:Le,multi:!0}]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(e,12))},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[]]}),e}(),Fe=new w.OlP("routeServiceOptions"),Oe=function(){var e=function(){function e(t,i,o){m(this,e),this.router=t,this.route=i,this.options=Object.assign({},{centerKey:"center",zoomKey:"zoom",projectionKey:"projection",contextKey:"context",searchKey:"search",visibleOnLayersKey:"visiblelayers",visibleOffLayersKey:"invisiblelayers",directionsCoordKey:"routing",directionsOptionsKey:"routingOptions",toolKey:"tool",wmsUrlKey:"wmsUrl",wmsLayersKey:"wmsLayers",wmtsUrlKey:"wmtsUrl",wmtsLayersKey:"wmtsLayers",arcgisUrlKey:"arcgisUrl",arcgisLayersKey:"arcgisLayers",iarcgisUrlKey:"iarcgisUrl",iarcgisLayersKey:"iarcgisLayers",tarcgisUrlKey:"tarcgisUrl",tarcgisLayersKey:"tarcgisLayers",vectorKey:"vector"},o)}return y(e,[{key:"queryParams",get:function(){var e=decodeURIComponent(location.search);if(e.includes("\xa2er=")){var t=(e=e.replace("\xa2er","&center")).slice(1).split("&").map(function(e){return e.split("=")}).reduce(function(e,t){var i=h(t.map(decodeURIComponent),2),o=i[0],n=i[1];return e[o]=n,e},{});this.router.navigate([],{queryParams:t})}return this.route.queryParams}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(Z.F0),w.LFG(Z.gz),w.LFG(Fe,8))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Me=function(){return(e=Me||(Me={})).Mobile="mobile",e.Tablet="tablet",e.Desktop="desktop",Me;var e}(),Ie=function(){return(e=Ie||(Ie={})).Portrait="portrait",e.Landscape="landscape",Ie;var e}(),Pe=function(){var e=function(){function e(t){var i=this;m(this,e),this.media$=new R.X(void 0),this.orientation$=new R.X(void 0),t.observe([le.u3.HandsetLandscape]).subscribe(function(e){e.matches&&(i.media$.next(Me.Mobile),i.orientation$.next(Ie.Landscape))}),t.observe([le.u3.HandsetPortrait]).subscribe(function(e){e.matches&&(i.media$.next(Me.Mobile),i.orientation$.next(Ie.Portrait))}),t.observe([le.u3.TabletLandscape]).subscribe(function(e){e.matches&&(i.media$.next(Me.Tablet),i.orientation$.next(Ie.Landscape))}),t.observe([le.u3.TabletPortrait]).subscribe(function(e){e.matches&&(i.media$.next(Me.Tablet),i.orientation$.next(Ie.Portrait))}),t.observe([le.u3.WebLandscape]).subscribe(function(e){e.matches&&(i.media$.next(Me.Desktop),i.orientation$.next(Ie.Landscape))}),t.observe([le.u3.WebPortrait]).subscribe(function(e){e.matches&&(i.media$.next(Me.Desktop),i.orientation$.next(Ie.Portrait))})}return y(e,[{key:"getMedia",value:function(){return this.media$.value}},{key:"getOrientation",value:function(){return this.orientation$.value}},{key:"isTouchScreen",value:function(){return"ontouchstart"in document.documentElement}},{key:"isMobile",value:function(){return"mobile"===this.getMedia()}},{key:"isDesktop",value:function(){return"desktop"===this.getMedia()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(le.Yg))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),_e=function(){return(e=_e||(_e={})).SESSION="Session",e.LOCAL="Local",_e;var e}(),qe=function(){return(e=qe||(qe={})).ADDED="Added",e.MODIFIED="Modified",e.REMOVED="Removed",e.CLEARED="Cleared",qe;var e}(),De=function(){var e=function(){function e(t){m(this,e),this.config=t,this.storageChange$=new R.X(void 0),this.options=this.config.getConfig("storage")||{key:"igo"}}return y(e,[{key:"get",value:function(e,t){var i;if((!t||t===_e.SESSION)&&(i=sessionStorage.getItem("".concat(this.options.key,".").concat(e))),(t===_e.LOCAL||!i&&!t)&&(i=localStorage.getItem("".concat(this.options.key,".").concat(e))),i)try{i=JSON.parse(i)}catch(o){i=i}return i}},{key:"set",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_e.LOCAL,o=this.get(e,i);i===_e.SESSION?sessionStorage.setItem("".concat(this.options.key,".").concat(e),JSON.stringify(t)):localStorage.setItem("".concat(this.options.key,".").concat(e),JSON.stringify(t));var n=this.get(e,i);n!==o&&this.storageChange$.next({key:e,scope:i,event:void 0!==o?qe.MODIFIED:qe.ADDED,previousValue:o,currentValue:n})}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_e.LOCAL,i=this.get(e,t);t===_e.SESSION?sessionStorage.removeItem("".concat(this.options.key,".").concat(e)):localStorage.removeItem("".concat(this.options.key,".").concat(e)),this.storageChange$.next({key:e,scope:t,event:qe.REMOVED,previousValue:i})}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_e.LOCAL;e===_e.SESSION?sessionStorage.clear():localStorage.clear(),this.storageChange$.next({scope:e,event:qe.CLEARED})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(he))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Ee=function(){var e=function(){function e(t,i){m(this,e),this.messageService=t,this.injector=i,this.stateChangeEventEmitter=new w.vpe,this.state={connection:window.navigator.onLine},this.checkNetworkState()}return y(e,[{key:"checkNetworkState",value:function(){var e=this;this.onlineSubscription=(0,B.R)(window,"online").subscribe(function(){e.previousMessageId&&e.messageService.remove(e.previousMessageId);var t=e.injector.get(Ce).translate,i=t.instant("igo.core.network.online.message"),o=t.instant("igo.core.network.online.title"),n=e.messageService.info(i,o);e.previousMessageId=n.toastId,e.state.connection=!0,e.emitEvent()}),this.offlineSubscription=(0,B.R)(window,"offline").subscribe(function(){e.previousMessageId&&e.messageService.remove(e.previousMessageId);var t=e.injector.get(Ce).translate,i=t.instant("igo.core.network.offline.message"),o=t.instant("igo.core.network.offline.title"),n=e.messageService.info(i,o);e.previousMessageId=n.toastId,e.state.connection=!1,e.emitEvent()})}},{key:"emitEvent",value:function(){this.stateChangeEventEmitter.emit(this.state)}},{key:"ngOnDestroy",value:function(){try{this.offlineSubscription.unsubscribe(),this.onlineSubscription.unsubscribe()}catch(e){}}},{key:"currentState",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e?this.stateChangeEventEmitter.pipe((0,E.b)(300),(0,$.O)(this.state)):this.stateChangeEventEmitter.pipe((0,E.b)(300))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(Ae),w.LFG(w.zs3))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),$e=l(24411),Re=l(84224),Ne=l(89544),Ue=l(64674),Je=l(89919),Be=l(84515),je=l(79902),Qe=l(9170),Ge=l(53466),Ye=l(63176),ze=l(77820),Ve=l(66360),He=l(33579),We=l(59298),Xe=l(2281),Ke=l(84534),et=l(40062),tt=l(99034),it=l(65877),ot=l(74813),nt=l(836),rt=l(9636),at=l(3786),st=l(94757),lt=l(22297),ct=l(72012),ut=l(18931),pt=l(16529),dt=l(87013),ht=l(91039),gt=l(14613),ft=l(80198),mt=l(82458),vt=function(){return(e=vt||(vt={})).Default="Default",e.HTML="HTML",e.UnsanitizedHTML="UnsanitizedHTML",e.Editable="Editable",e.Icon="Icon",e.ButtonGroup="ButtonGroup",vt;var e}(),yt=function(){return(e=yt||(yt={})).Auto="auto",e.Instant="instant",e.Smooth="smooth",yt;var e}(),bt=function(){return(e=bt||(bt={})).None="None",e.All="All",e.Some="Some",bt;var e}();function wt(e,t){return(0,$e.ZP)(e,t).safeObject}function xt(e){var t=e.meta||{};return t.id?t.id:wt(e,t.idProperty||"id")}function St(e){var t=e.meta||{};return t.title?t.title:wt(e,t.titleProperty||"title")}function kt(e){var t=e.meta||{};return t.icon?t.icon:wt(e,t.iconProperty||"icon")}var Ct=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m(this,e),this.index=new Map,this.change$=new Re.t(1),this.store=t.store?t.store:void 0,this.getKey=t.getKey?t.getKey:this.store?this.store.getKey:xt,this.next()}return y(e,[{key:"clear",value:function(){this.index.size>0&&(this.index.clear(),this.next())}},{key:"get",value:function(e){return this.index.get(this.getKey(e))||{}}},{key:"set",value:function(e,t){this.setMany([e],t)}},{key:"setMany",value:function(e,t){var i=this;e.forEach(function(e){i.index.set(i.getKey(e),Object.assign({},t))}),this.next()}},{key:"setAll",value:function(e){var t=this;Array.from(this.index.keys()).forEach(function(i){t.index.set(i,Object.assign({},e))}),this.next()}},{key:"update",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.updateMany([e],t,i)}},{key:"updateMany",value:function(e,t){var i=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!0===o)return this.updateManyExclusive(e,t);e.forEach(function(e){var o=Object.assign({},i.get(e),t);i.index.set(i.getKey(e),o)}),this.next()}},{key:"reverse",value:function(e,t){this.reverseMany([e],t)}},{key:"reverseMany",value:function(e,t){var i=this;e.forEach(function(e){var o=i.get(e),n=t.reduce(function(e,t){return e[t]=o[t]||!1,e},{}),r=i.reverseChanges(n),a=Object.assign({},o,r);i.index.set(i.getKey(e),a)}),this.next()}},{key:"updateAll",value:function(e){var t=this,i=this.getAllKeys();Array.from(i).forEach(function(i){var o=Object.assign({},t.index.get(i),e);t.index.set(i,o)}),this.next()}},{key:"updateManyExclusive",value:function(e,t){var i=this,o=this.reverseChanges(t),n=e.map(function(e){return i.getKey(e)});new Set(n.concat(Array.from(this.getAllKeys()))).forEach(function(e){var r=i.index.get(e)||{};n.indexOf(e)>=0?i.index.set(e,Object.assign({},r,t)):!0===Object.keys(o).some(function(e){return void 0!==r[e]&&r[e]!==o[e]})&&i.index.set(e,Object.assign({},r,o))}),this.next()}},{key:"reverseChanges",value:function(e){return Object.entries(e).reduce(function(e,t){var i=h(t,2),o=i[0],n=i[1];return"boolean"==typeof n&&(e[o]=!n),e},{})}},{key:"getAllKeys",value:function(){var e=this.store?Array.from(this.store.index.keys()):[];return new Set(Array.from(this.index.keys()).concat(e))}},{key:"next",value:function(){this.change$.next()}}]),e}(),Tt=function(){function e(t){m(this,e),this.source$=t,this.values$=new R.X([]),this.lifted=!1,this.joins=[],this.filter$=new R.X(void 0),this.filters$=new R.X([]),this.filterIndex=new Map,this.sort$=new R.X(void 0),this.getKey$=new R.X(void 0),this.count$=new R.X(0),this.empty$=new R.X(!0)}return y(e,[{key:"getKey",get:function(){return this.getKey$.value}},{key:"count",get:function(){return this.count$.value}},{key:"empty",get:function(){return this.empty$.value}},{key:"index",get:function(){return this._index}},{key:"get",value:function(e){if(void 0===this._index)throw new Error("This view has no index, therefore, this method is unavailable.");return this.index.get(e)}},{key:"all",value:function(){return this.values$.value}},{key:"all$",value:function(){return this.values$}},{key:"firstBy",value:function(e){return this.values$.value.find(e)}},{key:"firstBy$",value:function(e){return this.values$.pipe((0,D.U)(function(t){return t.find(e)}))}},{key:"manyBy",value:function(e){return this.values$.value.filter(e)}},{key:"manyBy$",value:function(e){return this.values$.pipe((0,D.U)(function(t){return t.filter(e)}))}},{key:"clear",value:function(){this.filter(void 0),this.sort(void 0)}},{key:"destroy",value:function(){void 0!==this.values$$&&this.values$$.unsubscribe(),this.clear()}},{key:"createIndex",value:function(e){return this._index=new Map,this.getKey$.next(e),this}},{key:"join",value:function(e){if(!0===this.lifted)throw new Error("This view has already been lifted, therefore, no join is allowed.");return this.joins.push(e),this}},{key:"filter",value:function(e){return this.filter$.next(e),this}},{key:"addFilter",value:function(e){var t=oe();return this.filterIndex.set(t,e),this.filters$.next(Array.from(this.filterIndex.values())),t}},{key:"removeFilter",value:function(e){this.filterIndex.delete(e),this.filters$.next(Array.from(this.filterIndex.values()))}},{key:"sort",value:function(e){return this.sort$.next(e),this}},{key:"lift",value:function(){var e=this;this.lifted=!0;var t=[this.joins.length>0?this.liftJoinedSource():this.liftSource(),this.filters$,this.filter$,this.sort$,this.getKey$];this.values$$=(0,J.aj)(t).pipe((0,Be.T)(1),(0,E.b)(5)).subscribe(function(t){var i=h(t,5),o=i[0],n=i[1],r=i[2],a=i[3],s=i[4],l=e.processValues(o,n,r,a);e.setValues(l,void 0!==s)})}},{key:"liftSource",value:function(){return this.source$}},{key:"liftJoinedSource",value:function(){var e=this,t=[this.source$,(0,J.aj)(this.joins.map(function(e){return e.source}))];return(0,J.aj)(t).pipe((0,D.U)(function(t){var i=h(t,2),o=i[0],n=i[1];return o.reduce(function(t,i){var o=e.computeJoinedValue(i,n);return void 0!==o&&t.push(o),t},[])}))}},{key:"computeJoinedValue",value:function(e,t){for(var i=e,o=0;void 0!==i&&o<this.joins.length;)i=this.joins[o].reduce(i,t[o]),o+=1;return i}},{key:"processValues",value:function(e,t,i,o){return e=e.slice(0),e=this.filterValues(e,t.concat([i])),this.sortValues(e,o)}},{key:"filterValues",value:function(e,t){return 0===t.length?e:e.filter(function(e){return t.filter(function(e){return void 0!==e}).every(function(t){return t(e)})})}},{key:"sortValues",value:function(e,t){return void 0===t?e:e.sort(function(e,i){return K.naturalCompare(t.valueAccessor(e),t.valueAccessor(i),t.direction,t.nullsFirst)})}},{key:"setValues",value:function(e,t){!0===t&&(this._index=this.generateIndex(e)),this.values$.next(e);var i=e.length,o=0===i;this.count$.next(i),this.empty$.next(o)}},{key:"generateIndex",value:function(e){var t=this,i=e.map(function(e){return[t.getKey(e),e]});return new Map(i)}}]),e}(),At=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};m(this,e),this.entities$=new R.X([]),this.count$=new R.X(0),this.empty$=new R.X(!0),this._pristine=!0,this.strategies=[],this.getKey=i.getKey?i.getKey:xt,this.getProperty=i.getProperty?i.getProperty:wt,this.state=this.createStateManager(),this.view=this.createDataView(),this.stateView=this.createStateView(),this.view.lift(),this.stateView.lift(),t.length>0?this.load(t):this._index=this.generateIndex(t)}return y(e,[{key:"count",get:function(){return this.count$.value}},{key:"empty",get:function(){return this.empty$.value}},{key:"index",get:function(){return this._index}},{key:"pristine",get:function(){return this._pristine}},{key:"get",value:function(e){return this.index.get(e)}},{key:"all",value:function(){return this.entities$.value}},{key:"load",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._index=this.generateIndex(e),this._pristine=t,this.next()}},{key:"softClear",value:function(){this.index&&this.index.size>0?(this.index.clear(),this._pristine=!0,this.next()):this.index&&this.updateCount()}},{key:"clear",value:function(){this.stateView.clear(),this.view.clear(),this.state.clear(),this.softClear()}},{key:"destroy",value:function(){this.stateView.destroy(),this.view.destroy(),this.clear()}},{key:"insert",value:function(e){this.insertMany([e])}},{key:"insertMany",value:function(e){var t=this;e.forEach(function(e){return t.index.set(t.getKey(e),e)}),this._pristine=!1,this.next()}},{key:"update",value:function(e){this.updateMany([e])}},{key:"updateMany",value:function(e){var t=this;e.forEach(function(e){return t.index.set(t.getKey(e),e)}),this._pristine=!1,this.next()}},{key:"delete",value:function(e){this.deleteMany([e])}},{key:"deleteMany",value:function(e){var t=this;e.forEach(function(e){return t.index.delete(t.getKey(e))}),this._pristine=!1,this.next()}},{key:"addStrategy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(void 0!==this.strategies.find(function(t){return e.constructor===t.constructor}))throw new Error("A strategy of this type already exists on that EntityStore.");return this.strategies.push(e),e.bindStore(this),!0===t&&e.activate(),this}},{key:"removeStrategy",value:function(e){var t=this.strategies.indexOf(e);return t>=0&&(this.strategies.splice(t,1),e.unbindStore(this)),this}},{key:"getStrategyOfType",value:function(e){return this.strategies.find(function(t){return t instanceof e})}},{key:"activateStrategyOfType",value:function(e){var t=this.getStrategyOfType(e);void 0!==t&&t.activate()}},{key:"deactivateStrategyOfType",value:function(e){var t=this.getStrategyOfType(e);void 0!==t&&t.deactivate()}},{key:"generateIndex",value:function(e){var t=this,i=e.map(function(e){return[t.getKey(e),e]});return new Map(i)}},{key:"next",value:function(){this.entities$.next(Array.from(this.index.values())),this.updateCount()}},{key:"updateCount",value:function(){var e=this.index.size,t=0===e;this.count$.next(e),this.empty$.next(t)}},{key:"createStateManager",value:function(){return new Ct({store:this})}},{key:"createDataView",value:function(){return new Tt(this.entities$)}},{key:"createStateView",value:function(){var e=this;return new Tt(this.view.all$()).join({source:this.state.change$,reduce:function(t){var i=e.getKey(t),o=e.state.get(t),n=e.stateView.get(i);if(void 0!==n&&n.entity===t&&e.statesAreTheSame(n.state,o))return n;var r=n?n.revision+1:1;return{entity:t,state:o,revision:r,ref:"".concat(i,"-").concat(r)}}}).createIndex(function(t){return e.getKey(t.entity)})}},{key:"statesAreTheSame",value:function(e,t){if(e===t)return!0;var i=0===Object.keys(e).length,o=0===Object.keys(t).length;return i&&o}}]),e}(),Lt=function(){function e(t,i){m(this,e),this.innerStateIndex=new Map,this.setChangeDetector(i),this.setStore(t)}return y(e,[{key:"destroy",value:function(){this.setChangeDetector(void 0),this.setStore(void 0)}},{key:"setStore",value:function(e){if(void 0===e)return this.teardownObservers(),this.innerStateIndex.clear(),void(this.store=void 0);this.setStore(void 0),this.store=e,this.setupObservers(),this.detectChanges()}},{key:"setChangeDetector",value:function(e){this.cdRef=e}},{key:"setupObservers",value:function(){var e=this;this.teardownObservers(),this.entities$$=this.store.entities$.subscribe(function(t){return e.onEntitiesChange(t)}),this.state$$=this.store.state.change$.pipe((0,Be.T)(1)).subscribe(function(){return e.onStateChange()})}},{key:"teardownObservers",value:function(){void 0!==this.entities$$&&this.entities$$.unsubscribe(),void 0!==this.state$$&&this.state$$.unsubscribe(),this.entities$$=void 0,this.state$$=void 0}},{key:"onEntitiesChange",value:function(e){this.detectChanges()}},{key:"onStateChange",value:function(){var e=!1,t=this.store.state.index,i=this.innerStateIndex;t.size!==i.size&&(e=this.detectChanges());for(var o=0,n=Array.from(t.keys());o<n.length;o++){var r=n[o],a=t.get(r),s=i.get(r);!1===e&&(void 0===s?e=this.detectChanges():K.objectsAreEquivalent(a,s)||(e=this.detectChanges())),this.innerStateIndex.set(r,Object.assign({},a))}}},{key:"detectChanges",value:function(){return void 0!==this.cdRef&&this.cdRef.detectChanges(),!0}}]),e}(),Zt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m(this,e),this.options=t,this.stores=[],this.active$=new R.X(!1),this.options=t}return y(e,[{key:"active",get:function(){return this.active$.value}},{key:"activate",value:function(){!0===this.active&&this.doDeactivate(),this.active$.next(!0),this.doActivate()}},{key:"deactivate",value:function(){this.active$.next(!1),this.doDeactivate()}},{key:"bindStore",value:function(e){this.stores.indexOf(e)<0&&this.stores.push(e)}},{key:"unbindStore",value:function(e){var t=this.stores.indexOf(e);t>=0&&this.stores.splice(t,1)}},{key:"doActivate",value:function(){}},{key:"doDeactivate",value:function(){}}]),e}(),Ft=function(e){o(n,e);var t=r(n);function n(e){var i;return m(this,n),(i=t.call(this,e)).options=e,i.filters=new Map,i}return y(n,[{key:"bindStore",value:function(e){i(c(n.prototype),"bindStore",this).call(this,e),!0===this.active&&this.filterStore(e)}},{key:"unbindStore",value:function(e){i(c(n.prototype),"unbindStore",this).call(this,e),!0===this.active&&this.unfilterStore(e)}},{key:"doActivate",value:function(){this.filterAll()}},{key:"doDeactivate",value:function(){this.unfilterAll()}},{key:"filterAll",value:function(){var e=this;this.stores.forEach(function(t){return e.filterStore(t)})}},{key:"unfilterAll",value:function(){var e=this;this.stores.forEach(function(t){return e.unfilterStore(t)})}},{key:"filterStore",value:function(e){this.filters.set(e,e.stateView.addFilter(this.options.filterClauseFunc))}},{key:"unfilterStore",value:function(e){var t=this.filters.get(e);void 0!==t&&(e.stateView.removeFilter(t),this.filters.delete(e))}}]),n}(Zt),Ot=function(e){o(n,e);var t=r(n);function n(){var e;return m(this,n),(e=t.apply(this,arguments)).filters=new Map,e}return y(n,[{key:"bindStore",value:function(e){i(c(n.prototype),"bindStore",this).call(this,e),!0===this.active&&this.filterStore(e)}},{key:"unbindStore",value:function(e){i(c(n.prototype),"unbindStore",this).call(this,e),!0===this.active&&this.unfilterStore(e)}},{key:"doActivate",value:function(){this.filterAll()}},{key:"doDeactivate",value:function(){this.unfilterAll()}},{key:"filterAll",value:function(){var e=this;this.stores.forEach(function(t){return e.filterStore(t)})}},{key:"unfilterAll",value:function(){var e=this;this.stores.forEach(function(t){return e.unfilterStore(t)})}},{key:"filterStore",value:function(e){this.filters.has(e)||this.filters.set(e,e.stateView.addFilter(function(e){return!0===e.state.selected}))}},{key:"unfilterStore",value:function(e){var t=this.filters.get(e);void 0!==t&&(e.stateView.removeFilter(t),this.filters.delete(e))}}]),n}(Zt);function Mt(e,t){if(1&e&&(w.TgZ(0,"mat-option",4),w._uU(1),w.qZA()),2&e){var i=w.oxw();w.Q6J("value",i.emptyValue),w.xp6(1),w.Oqu(i.emptyText)}}function It(e,t){if(1&e&&(w.TgZ(0,"mat-option",4),w._uU(1),w.ALo(2,"async"),w.qZA()),2&e){var i=w.oxw();w.Q6J("value",i.multiSelectValue),w.xp6(1),w.Oqu(w.lcZ(2,2,i.multiText$))}}function Pt(e,t){if(1&e&&(w.TgZ(0,"mat-option",4),w._uU(1),w.qZA()),2&e){var i=t.$implicit,o=w.oxw();w.Q6J("value",i.entity),w.xp6(1),w.hij(" ",o.titleAccessor(i.entity)," ")}}var _t=function(){var e=function(){function e(t){m(this,e),this.cdRef=t,this.selected$=new R.X(void 0),this.multiText$=new R.X(void 0),this.multiSelectValue={id:"IGO_MULTI_SELECT"},this.emptyValue={id:"IGO_EMPTY_SELECT"},this.titleAccessor=St,this.emptyText=void 0,this.multi=!1,this.multiAllText="All",this.multiNoneText="None",this.disabled=!1,this.selectedChange=new w.vpe}return y(e,[{key:"ngOnInit",value:function(){var e=this;this.watcher=new Lt(this.store,this.cdRef),this.selected$$=this.store.stateView.manyBy$(function(e){return!0===e.state.selected}).subscribe(function(t){var i=t.map(function(e){return e.entity});e.onSelectFromStore(i)})}},{key:"ngOnDestroy",value:function(){this.watcher.destroy(),this.selected$$.unsubscribe()}},{key:"onSelectionChange",value:function(e){var t=this,i=e.value instanceof Array?e.value:[e.value],o=i.find(function(e){return e===t.multiSelectValue}),n=i.filter(function(e){return e!==t.multiSelectValue});void 0!==o&&(n.length===this.store.count?n=[]:n.length<this.store.count&&(n=this.store.all())),0===(n=n.filter(function(e){return e!==t.emptyValue})).length?this.store.state.updateAll({selected:!1}):this.store.state.updateMany(n,{selected:!0},!0),this.selectedChange.emit({selected:!0,value:this.multi?n:e.value})}},{key:"onSelectFromStore",value:function(e){this.selected$.next(!0===this.multi?e:e.length>0?e[0]:void 0),this.updateMultiToggleWithEntities(e)}},{key:"updateMultiToggleWithEntities",value:function(e){e.length===this.store.count&&this.multiText$.value!==this.multiNoneText?this.multiText$.next(this.multiNoneText):e.length<this.store.count&&this.multiText$.value!==this.multiAllText&&this.multiText$.next(this.multiAllText)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(w.sBO))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-entity-selector"]],inputs:{store:"store",titleAccessor:"titleAccessor",emptyText:"emptyText",multi:"multi",multiAllText:"multiAllText",multiNoneText:"multiNoneText",placeholder:"placeholder",disabled:"disabled"},outputs:{selectedChange:"selectedChange"},decls:7,vars:11,consts:[[1,"igo-entity-selector"],[3,"disabled","value","multiple","placeholder","selectionChange"],[3,"value",4,"ngIf"],["ngFor","",3,"ngForOf"],[3,"value"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-form-field",0),w.TgZ(1,"mat-select",1),w.NdJ("selectionChange",function(e){return t.onSelectionChange(e)}),w.ALo(2,"async"),w.YNc(3,Mt,2,2,"mat-option",2),w.YNc(4,It,3,4,"mat-option",2),w.YNc(5,Pt,2,2,"ng-template",3),w.ALo(6,"async"),w.qZA(),w.qZA()),2&e&&(w.xp6(1),w.Q6J("disabled",t.disabled)("value",w.lcZ(2,7,t.selected$))("multiple",t.multi)("placeholder",t.placeholder),w.xp6(2),w.Q6J("ngIf",void 0!==t.emptyText&&!1===t.multi),w.xp6(1),w.Q6J("ngIf",!0===t.multi),w.xp6(1),w.Q6J("ngForOf",w.lcZ(6,9,t.store.stateView.all$())))},directives:[Ye.KE,ze.gD,F.O5,F.sg,Ve.ey],pipes:[F.Ov],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}"],changeDetection:0}),e}(),qt=function(){var e=function(){function e(){m(this,e)}return y(e,[{key:"onClick",value:function(e){e.stopPropagation()}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=w.lG2({type:e,selectors:[["","igoStopPropagation",""]],hostBindings:function(e,t){1&e&&w.NdJ("click",function(e){return t.onClick(e)})}}),e}(),Dt=function(){var e=function(){function e(t,i){m(this,e),this.renderer=t,this.el=i,this.selection=!1,this.selectOnClick=!0,this.highlightSelection=!0,this._selected=!1,this.scrollBehavior=yt.Auto,this.select=new w.vpe}return y(e,[{key:"selected",get:function(){return this._selected},set:function(e){!1!==this.selection&&e!==this._selected&&(this.toggleSelected(e),this.scroll())}},{key:"onClick",value:function(){!1===this.selection||!1===this.selectOnClick||(this.toggleSelected(!0),this.select.emit(this))}},{key:"toggleSelected",value:function(t){this._selected=t,!0===t?(this.addCls(e.selectedCls),!0===this.highlightSelection&&this.addCls(e.highlightedCls)):(this.removeCls(e.selectedCls),this.removeCls(e.highlightedCls))}},{key:"scroll",value:function(){!0===this._selected&&(0,nt.Z)(this.el.nativeElement,{scrollMode:"if-needed",behavior:"smooth",block:"end",inline:"nearest"})}},{key:"addCls",value:function(e){this.renderer.addClass(this.el.nativeElement,e)}},{key:"removeCls",value:function(e){this.renderer.removeClass(this.el.nativeElement,e)}}]),e}();return e.selectedCls="igo-entity-table-row-selected",e.highlightedCls="igo-entity-table-row-highlighted",e.\u0275fac=function(t){return new(t||e)(w.Y36(w.Qsj),w.Y36(w.SBq))},e.\u0275dir=w.lG2({type:e,selectors:[["","igoEntityTableRow",""]],hostBindings:function(e,t){1&e&&w.NdJ("click",function(){return t.onClick()})},inputs:{selection:"selection",selectOnClick:"selectOnClick",highlightSelection:"highlightSelection",selected:"selected",scrollBehavior:"scrollBehavior"},outputs:{select:"select"}}),e}(),Et=function(){var e=function(){function e(t,i){var o=this;m(this,e),this.languageService=t,this.mediaService=i,this.disabled=!1,this.hidePageSize=!1,this.pageIndex=0,this.pageSize=50,this.pageSizeOptions=[5,10,20,50,100,200],this.showFirstLastButtons=!0,this.paginationLabelTranslation$$=[],this.entitySortChange$=new R.X(!1),this.length=0,this.paginatorChange=new w.vpe,this.rangeLabel=function(e,t,i){var n=new R.X("");if(o.paginationLabelTranslation$$.push(o.languageService.translate.get("igo.common.paginator.of").subscribe(function(e){n.next(e)})),0===i||0===t)return"0 ".concat(n.value," ").concat(i);var r=e*t;return"".concat(r+1," - ").concat(r<(i=Math.max(i,0))?Math.min(r+t,i):r+t," ").concat(n.value," ").concat(i)}}return y(e,[{key:"ngOnChanges",value:function(){var e=this;this.unsubscribeAll(),this.count$$=this.store.stateView.count$.subscribe(function(t){e.length=t,e.emitPaginator()}),this.entitySortChange$$=this.entitySortChange$.subscribe(function(){e.paginator&&e.paginator.firstPage()}),this.initPaginatorOptions(),this.translateLabels()}},{key:"initPaginatorOptions",value:function(){var e,t,i,o,n,r;this.disabled=(null===(e=this.paginatorOptions)||void 0===e?void 0:e.disabled)||this.disabled,this.pageIndex=(null===(t=this.paginatorOptions)||void 0===t?void 0:t.pageIndex)||this.pageIndex,this.pageSize=(null===(i=this.paginatorOptions)||void 0===i?void 0:i.pageSize)||this.pageSize,this.pageSizeOptions=(null===(o=this.paginatorOptions)||void 0===o?void 0:o.pageSizeOptions)||this.pageSizeOptions,this.mediaService.isMobile()?(this.showFirstLastButtons=!1,this.hidePageSize=!0):(this.showFirstLastButtons=(null===(n=this.paginatorOptions)||void 0===n?void 0:n.showFirstLastButtons)||this.showFirstLastButtons,this.hidePageSize=(null===(r=this.paginatorOptions)||void 0===r?void 0:r.hidePageSize)||this.hidePageSize)}},{key:"translateLabels",value:function(){var e=this;this.paginationLabelTranslation$$.push(this.languageService.translate.get("igo.common.paginator.firstPageLabel").subscribe(function(t){e.paginator._intl.firstPageLabel=t})),this.paginator._intl.getRangeLabel=this.rangeLabel,this.paginationLabelTranslation$$.push(this.languageService.translate.get("igo.common.paginator.itemsPerPageLabel").subscribe(function(t){e.paginator._intl.itemsPerPageLabel=t})),this.paginationLabelTranslation$$.push(this.languageService.translate.get("igo.common.paginator.lastPageLabel").subscribe(function(t){e.paginator._intl.lastPageLabel=t})),this.paginationLabelTranslation$$.push(this.languageService.translate.get("igo.common.paginator.nextPageLabel").subscribe(function(t){e.paginator._intl.nextPageLabel=t})),this.paginationLabelTranslation$$.push(this.languageService.translate.get("igo.common.paginator.previousPageLabel").subscribe(function(t){e.paginator._intl.previousPageLabel=t}))}},{key:"unsubscribeAll",value:function(){this.paginationLabelTranslation$$.map(function(e){return e.unsubscribe()}),this.count$$&&this.count$$.unsubscribe(),this.entitySortChange$$&&this.entitySortChange$$.unsubscribe()}},{key:"ngOnDestroy",value:function(){this.unsubscribeAll()}},{key:"emitPaginator",value:function(){this.paginatorChange.emit(this.paginator)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ce),w.Y36(Pe))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-entity-table-paginator"]],viewQuery:function(e,t){var i;(1&e&&w.Gf(rt.NW,7),2&e)&&(w.iGM(i=w.CRH())&&(t.paginator=i.first))},inputs:{entitySortChange$:"entitySortChange$",store:"store",paginatorOptions:"paginatorOptions"},outputs:{page:"page",paginatorChange:"paginatorChange"},features:[w.TTD],decls:1,vars:7,consts:[[3,"disabled","hidePageSize","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons","page"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-paginator",0),w.NdJ("page",function(){return t.emitPaginator()}),w.qZA()),2&e&&w.Q6J("disabled",t.disabled)("hidePageSize",t.hidePageSize)("length",t.length)("pageIndex",t.pageIndex)("pageSize",t.pageSize)("pageSizeOptions",t.pageSizeOptions)("showFirstLastButtons",t.showFirstLastButtons)},directives:[rt.NW],styles:["[_nghost-%COMP%]{margin-top:-10px;padding-right:15px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){[_nghost-%COMP%]{margin-top:0;padding-right:5px}}"],changeDetection:0}),e}(),$t=function(){var e=function(){function e(t){m(this,e),this.http=t}return y(e,[{key:"transform",value:function(e){var t=new P.WM({"Content-Type":"text/plain",activityInterceptor:"false"});return this.http.get(e,{headers:t,responseType:"blob"}).pipe((0,je.w)(function(e){return new Ne.y(function(t){var i=new FileReader;i.readAsDataURL(e),i.onloadend=function(){t.next(i.result),t.complete()}})}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(P.eN,16))},e.\u0275pipe=w.Yjl({name:"secureImage",type:e,pure:!0}),(0,at.gn)([(0,st.q)({maxCacheCount:20})],e.prototype,"transform",null),e}(),Rt=function(){var e=function(){function e(t){m(this,e),this._sanitizer=t}return y(e,[{key:"transform",value:function(e){return this._sanitizer.bypassSecurityTrustHtml(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(b.H7,16))},e.\u0275pipe=w.Yjl({name:"sanitizeHtml",type:e,pure:!0}),e}();function Nt(e,t){if(1&e){var i=w.EpF();w.ynx(0),w.TgZ(1,"mat-checkbox",11),w.NdJ("change",function(e){return w.CHM(i),w.oxw(3).onToggleRows(e.checked)}),w.qZA(),w.BQk()}if(2&e){var o=t.ngIf,n=w.oxw(3);w.xp6(1),w.Q6J("checked",o===n.entityTableSelectionState.All)("indeterminate",o===n.entityTableSelectionState.Some)}}function Ut(e,t){if(1&e&&(w.ynx(0),w.YNc(1,Nt,2,2,"ng-container",10),w.ALo(2,"async"),w.BQk()),2&e){var i=w.oxw(2);w.xp6(1),w.Q6J("ngIf",w.lcZ(2,1,i.selectionState$))}}function Jt(e,t){if(1&e&&(w.TgZ(0,"th",9),w.YNc(1,Ut,3,3,"ng-container",10),w.qZA()),2&e){var i=w.oxw();w.xp6(1),w.Q6J("ngIf",i.selectMany)}}function Bt(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"td",12),w.TgZ(1,"mat-checkbox",13),w.NdJ("mousedown",function(e){return e.shiftKey?e.preventDefault():null})("click",function(e){var t=w.CHM(i).$implicit,o=w.oxw();return e.shiftKey?o.onShiftToggleRow(!o.rowIsSelected(t),t,e):e.stopPropagation()})("change",function(e){var t=w.CHM(i).$implicit;return w.oxw().onToggleRow(e.checked,t)}),w.qZA(),w.qZA()}if(2&e){var o=t.$implicit,n=w.oxw();w.xp6(1),w.Q6J("checked",n.rowIsSelected(o))}}function jt(e,t){if(1&e&&(w.TgZ(0,"th",16),w._uU(1),w.qZA()),2&e){var i=w.oxw(2).$implicit;w.Q6J("matTooltip",i.tooltip?i.tooltip:void 0),w.xp6(1),w.hij(" ",i.title," ")}}function Qt(e,t){1&e&&(w.ynx(0),w.YNc(1,jt,2,2,"th",15),w.BQk())}function Gt(e,t){if(1&e&&(w.TgZ(0,"th",18),w._uU(1),w.qZA()),2&e){var i=w.oxw(2).$implicit;w.Q6J("matTooltip",i.tooltip?i.tooltip:void 0),w.xp6(1),w.hij(" ",i.title," ")}}function Yt(e,t){1&e&&(w.ynx(0),w.YNc(1,Gt,2,2,"th",17),w.BQk())}function zt(e,t){if(1&e&&(w.TgZ(0,"td",22),w._uU(1),w.qZA()),2&e){var i=w.oxw().$implicit,o=w.oxw(3).$implicit,n=w.oxw();w.Q6J("ngClass",n.getCellClass(i,o)),w.xp6(1),w.hij(" ",n.getValue(i,o)," ")}}function Vt(e,t){if(1&e&&(w._UZ(0,"img",26),w.ALo(1,"async"),w.ALo(2,"secureImage")),2&e){var i=w.oxw(2).$implicit,o=w.oxw(3).$implicit,n=w.oxw();w.s9C("src",w.lcZ(1,1,w.lcZ(2,3,n.getValue(i,o))),w.LSH)}}function Ht(e,t){1&e&&(w.TgZ(0,"span"),w._uU(1),w.ALo(2,"translate"),w.qZA()),2&e&&(w.xp6(1),w.hij("",w.lcZ(2,1,"igo.common.entity-table.targetHtmlUrl")," "))}function Wt(e,t){if(1&e&&(w.TgZ(0,"td",22),w.TgZ(1,"a",23),w.NdJ("click",function(e){return e.stopPropagation()}),w.YNc(2,Vt,3,5,"img",24),w.YNc(3,Ht,3,3,"ng-template",null,25,w.W1O),w.qZA(),w.qZA()),2&e){var i=w.MAs(4),o=w.oxw().$implicit,n=w.oxw(3).$implicit,r=w.oxw();w.Q6J("ngClass",r.getCellClass(o,n)),w.xp6(1),w.s9C("href",r.getValue(o,n),w.LSH),w.xp6(1),w.Q6J("ngIf",r.isImg(r.getValue(o,n)))("ngIfElse",i)}}function Xt(e,t){if(1&e&&(w.ynx(0),w.YNc(1,zt,2,2,"td",20),w.YNc(2,Wt,5,4,"ng-template",null,21,w.W1O),w.BQk()),2&e){var i=t.$implicit,o=w.MAs(3),n=w.oxw(3).$implicit,r=w.oxw();w.xp6(1),w.Q6J("ngIf",!r.isUrl(r.getValue(i,n)))("ngIfElse",o)}}function Kt(e,t){1&e&&(w.ynx(0),w.YNc(1,Xt,4,2,"ng-container",19),w.BQk())}function ei(e,t){if(1&e&&w._UZ(0,"td",29),2&e){var i=w.oxw().$implicit,o=w.oxw(3).$implicit,n=w.oxw();w.Q6J("ngClass",n.getCellClass(i,o))("innerHTML",n.getValue(i,o),w.oJD)}}function ti(e,t){if(1&e&&(w._UZ(0,"img",26),w.ALo(1,"async"),w.ALo(2,"secureImage")),2&e){var i=w.oxw(2).$implicit,o=w.oxw(3).$implicit,n=w.oxw();w.s9C("src",w.lcZ(1,1,w.lcZ(2,3,n.getValue(i,o))),w.LSH)}}function ii(e,t){1&e&&(w.TgZ(0,"span"),w._uU(1),w.ALo(2,"translate"),w.qZA()),2&e&&(w.xp6(1),w.hij("",w.lcZ(2,1,"igo.geo.targetHtmlUrl")," "))}function oi(e,t){if(1&e&&(w.TgZ(0,"td",22),w.TgZ(1,"a",23),w.NdJ("click",function(e){return e.stopPropagation()}),w.YNc(2,ti,3,5,"img",24),w.YNc(3,ii,3,3,"ng-template",null,25,w.W1O),w.qZA(),w.qZA()),2&e){var i=w.MAs(4),o=w.oxw().$implicit,n=w.oxw(3).$implicit,r=w.oxw();w.Q6J("ngClass",r.getCellClass(o,n)),w.xp6(1),w.s9C("href",r.getValue(o,n),w.LSH),w.xp6(1),w.Q6J("ngIf",r.isImg(r.getValue(o,n)))("ngIfElse",i)}}function ni(e,t){if(1&e&&(w.ynx(0),w.YNc(1,ei,1,2,"td",27),w.YNc(2,oi,5,4,"ng-template",null,28,w.W1O),w.BQk()),2&e){var i=t.$implicit,o=w.MAs(3),n=w.oxw(3).$implicit,r=w.oxw();w.xp6(1),w.Q6J("ngIf",!r.isUrl(r.getValue(i,n)))("ngIfElse",o)}}function ri(e,t){1&e&&(w.ynx(0),w.YNc(1,ni,4,2,"ng-container",19),w.BQk())}function ai(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",43),w._UZ(1,"mat-datepicker-toggle",44),w.TgZ(2,"input",45),w.NdJ("dateChange",function(e){w.CHM(i);var t=w.oxw(2).$implicit,o=w.oxw(3).$implicit;return w.oxw().onDateChange(o.name,t,e)}),w.qZA(),w._UZ(3,"mat-datepicker",null,46),w.qZA()}if(2&e){var o=w.MAs(4),n=w.oxw(2).$implicit,r=w.oxw(3).$implicit,a=w.oxw();w.xp6(1),w.Q6J("for",o),w.xp6(1),w.s9C("value",a.getValue(n,r)),w.Q6J("matDatepicker",o)("formControlName",r.name)}}function si(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"input",47),w.NdJ("focus",function(e){return w.CHM(i),w.oxw(5).$implicit.onFocus(e)})("keypress",function(e){return w.CHM(i),w.oxw(5).$implicit.onChange(e)})("blur",function(e){return w.CHM(i),w.oxw(5).$implicit.onBlur(e)}),w.qZA()}if(2&e){var o=w.oxw(5).$implicit;w.Q6J("formControlName",o.name)}}function li(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"input",48),w.NdJ("input",function(e){w.CHM(i);var t=w.oxw(2).$implicit,o=w.oxw(3).$implicit;return w.oxw().onValueChange(o.name,t,e)}),w.qZA()}if(2&e){var o=w.oxw(2).$implicit,n=w.oxw(3).$implicit,r=w.oxw();w.s9C("step",n.step),w.s9C("value",r.getValue(o,n)),w.s9C("readonly",r.getValidationAttributeValue(n,"readonly")),w.s9C("required",r.getValidationAttributeValue(n,"mandatory")),w.s9C("min",r.getValidationAttributeValue(n,"minValue")),w.s9C("max",r.getValidationAttributeValue(n,"maxValue")),w.Q6J("formControlName",n.name)}}function ci(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"input",49),w.NdJ("input",function(e){w.CHM(i);var t=w.oxw(2).$implicit,o=w.oxw(3).$implicit;return w.oxw().onValueChange(o.name,t,e)}),w.qZA()}if(2&e){var o=w.oxw(2).$implicit,n=w.oxw(3).$implicit,r=w.oxw();w.s9C("value",r.getValue(o,n)),w.s9C("readonly",r.getValidationAttributeValue(n,"readonly")),w.s9C("required",r.getValidationAttributeValue(n,"mandatory")),w.Q6J("formControlName",n.name)}}function ui(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-checkbox",50),w.NdJ("change",function(e){w.CHM(i);var t=w.oxw(2).$implicit,o=w.oxw(3).$implicit;return w.oxw().onBooleanValueChange(o.name,t,e)}),w.qZA()}if(2&e){var o=w.oxw(2).$implicit,n=w.oxw(3).$implicit,r=w.oxw();w.Q6J("formControlName",n.name)("checked",r.getValue(o,n))}}function pi(e,t){if(1&e&&(w.TgZ(0,"mat-option",53),w._uU(1),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i.id)("disabled",i.disabled),w.xp6(1),w.hij(" ",i.value," ")}}function di(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-select",51),w.NdJ("selectionChange",function(e){w.CHM(i);var t=w.oxw(2).$implicit,o=w.oxw(3).$implicit;return w.oxw().onSelectValueChange(o.name,t,e)}),w.YNc(1,pi,2,3,"mat-option",52),w.qZA()}if(2&e){var o=w.oxw(2).$implicit,n=w.oxw(3).$implicit,r=w.oxw();w.s9C("required",r.getValidationAttributeValue(n,"mandatory")),w.Q6J("formControlName",n.name)("multiple",n.multiple)("value",r.getValue(o,n)),w.xp6(1),w.Q6J("ngForOf",n.domainValues)}}function hi(e,t){if(1&e&&w._UZ(0,"input",54),2&e){w.oxw();var i=w.MAs(9),o=w.oxw().$implicit,n=w.oxw(3).$implicit,r=w.oxw();w.s9C("required",r.getValidationAttributeValue(n,"mandatory")),w.s9C("value",r.getValue(o,n)),w.Q6J("formControlName",n.name)("matAutocomplete",i)}}function gi(e,t){if(1&e&&(w.TgZ(0,"mat-option",55),w._uU(1),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i.id),w.xp6(1),w.hij(" ",i.value," ")}}function fi(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"td",32),w.YNc(1,ai,5,4,"div",33),w.YNc(2,si,1,1,"input",34),w.YNc(3,li,1,7,"input",35),w.YNc(4,ci,1,4,"input",36),w.YNc(5,ui,1,2,"mat-checkbox",37),w.YNc(6,di,2,5,"mat-select",38),w.YNc(7,hi,1,4,"input",39),w.TgZ(8,"mat-autocomplete",40,41),w.NdJ("optionSelected",function(e){w.CHM(i);var t=w.oxw().$implicit,o=w.oxw(3).$implicit;return w.oxw().onAutocompleteValueChange(o.name,t,e)}),w.YNc(10,gi,2,2,"mat-option",42),w.ALo(11,"async"),w.qZA(),w.qZA()}if(2&e){var o=w.oxw().$implicit,n=w.oxw(3).$implicit,r=w.oxw();w.Q6J("formGroup",r.formGroup)("ngClass",r.getCellClass(o,n)),w.xp6(1),w.Q6J("ngIf","date"===n.type),w.xp6(1),w.Q6J("ngIf","time"===n.type),w.xp6(1),w.Q6J("ngIf","number"===n.type),w.xp6(1),w.Q6J("ngIf",!n.type||"string"===n.type),w.xp6(1),w.Q6J("ngIf","boolean"===n.type),w.xp6(1),w.Q6J("ngIf","list"===n.type),w.xp6(1),w.Q6J("ngIf","autocomplete"===n.type),w.xp6(3),w.Q6J("ngForOf",w.lcZ(11,10,r.filteredOptions))}}function mi(e,t){if(1&e&&(w._UZ(0,"td",29),w.ALo(1,"sanitizeHtml")),2&e){var i=w.oxw(2).$implicit,o=w.oxw(3).$implicit,n=w.oxw();w.Q6J("ngClass",n.getCellClass(i,o))("innerHTML",w.lcZ(1,2,n.getValue(i,o)),w.oJD)}}function vi(e,t){if(1&e&&(w._UZ(0,"img",26),w.ALo(1,"async"),w.ALo(2,"secureImage")),2&e){var i=w.oxw(3).$implicit,o=w.oxw(3).$implicit,n=w.oxw();w.s9C("src",w.lcZ(1,1,w.lcZ(2,3,n.getValue(i,o))),w.LSH)}}function yi(e,t){1&e&&(w.TgZ(0,"span"),w._uU(1),w.ALo(2,"translate"),w.qZA()),2&e&&(w.xp6(1),w.hij("",w.lcZ(2,1,"igo.geo.targetHtmlUrl")," "))}function bi(e,t){if(1&e&&(w.TgZ(0,"td",22),w.TgZ(1,"a",23),w.NdJ("click",function(e){return e.stopPropagation()}),w.YNc(2,vi,3,5,"img",24),w.YNc(3,yi,3,3,"ng-template",null,25,w.W1O),w.qZA(),w.qZA()),2&e){var i=w.MAs(4),o=w.oxw(2).$implicit,n=w.oxw(3).$implicit,r=w.oxw();w.Q6J("ngClass",r.getCellClass(o,n)),w.xp6(1),w.s9C("href",r.getValue(o,n),w.LSH),w.xp6(1),w.Q6J("ngIf",r.isImg(r.getValue(o,n)))("ngIfElse",i)}}function wi(e,t){if(1&e&&(w.YNc(0,mi,2,4,"td",27),w.YNc(1,bi,5,4,"ng-template",null,56,w.W1O)),2&e){var i=w.MAs(2),o=w.oxw().$implicit,n=w.oxw(3).$implicit,r=w.oxw();w.Q6J("ngIf",!r.isUrl(r.getValue(o,n)))("ngIfElse",i)}}function xi(e,t){if(1&e&&(w.ynx(0),w.YNc(1,fi,12,12,"td",30),w.YNc(2,wi,3,2,"ng-template",null,31,w.W1O),w.BQk()),2&e){var i=t.$implicit,o=w.MAs(3),n=w.oxw(4);w.xp6(1),w.Q6J("ngIf",n.isEdition(i))("ngIfElse",o)}}function Si(e,t){1&e&&(w.ynx(0),w.YNc(1,xi,4,2,"ng-container",19),w.BQk())}function ki(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"td",22),w.TgZ(1,"mat-icon",58),w.NdJ("click",function(e){return w.CHM(i),w.oxw(3).$implicit.onClick(e)}),w.qZA(),w.qZA()}if(2&e){var o=t.$implicit,n=w.oxw(3).$implicit,r=w.oxw();w.Q6J("ngClass",r.getCellClass(o,n)),w.xp6(1),w.s9C("svgIcon",r.getValue(o,n)||n.icon)}}function Ci(e,t){1&e&&(w.ynx(0),w.YNc(1,ki,2,2,"td",57),w.BQk())}function Ti(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",62),w.NdJ("mousedown",function(){w.CHM(i);var e=w.oxw(2).$implicit,t=w.oxw().$implicit;return w.oxw(4).onButtonClick(e.click,t)}),w._UZ(1,"mat-icon",63),w.qZA()}if(2&e){var o=w.oxw(2).$implicit;w.Q6J("color",o.color)("disabled",o.disabled),w.xp6(1),w.s9C("svgIcon",o.icon)}}function Ai(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",64),w.NdJ("mousedown",function(){w.CHM(i);var e=w.oxw(2).$implicit,t=w.oxw().$implicit;return w.oxw(4).onButtonClick(e.click,t)}),w._UZ(1,"mat-icon",63),w.qZA()}if(2&e){var o=w.oxw(2).$implicit;w.Q6J("color",o.color)("disabled",o.disabled),w.xp6(1),w.s9C("svgIcon",o.icon)}}function Li(e,t){if(1&e&&(w.ynx(0),w.YNc(1,Ti,2,3,"button",60),w.YNc(2,Ai,2,3,"button",61),w.BQk()),2&e){var i=w.oxw().$implicit;w.xp6(1),w.Q6J("ngIf","mat-icon-button"===i.style),w.xp6(1),w.Q6J("ngIf","mat-icon-button"!==i.style)}}function Zi(e,t){if(1&e&&(w.TgZ(0,"span"),w.YNc(1,Li,3,2,"ng-container",10),w.qZA()),2&e){var i=t.$implicit,o=w.oxw().$implicit,n=w.oxw(4);w.xp6(1),w.Q6J("ngIf",n.isEdition(o)===i.editMode)}}function Fi(e,t){if(1&e&&(w.ynx(0),w.TgZ(1,"td",22),w.YNc(2,Zi,2,1,"span",59),w.qZA(),w.BQk()),2&e){var i=t.$implicit,o=w.oxw(3).$implicit,n=w.oxw();w.xp6(1),w.Q6J("ngClass",n.getCellClass(i,o)),w.xp6(1),w.Q6J("ngForOf",n.getValue(i,o))}}function Oi(e,t){1&e&&(w.ynx(0),w.YNc(1,Fi,3,2,"ng-container",19),w.BQk())}function Mi(e,t){if(1&e&&(w.ynx(0),w.YNc(1,Kt,2,0,"ng-container",10),w.YNc(2,ri,2,0,"ng-container",10),w.YNc(3,Si,2,0,"ng-container",10),w.YNc(4,Ci,2,0,"ng-container",10),w.YNc(5,Oi,2,0,"ng-container",10),w.BQk()),2&e){var i=t.ngIf,o=w.oxw(2);w.xp6(1),w.Q6J("ngIf",i===o.entityTableColumnRenderer.Default),w.xp6(1),w.Q6J("ngIf",i===o.entityTableColumnRenderer.HTML),w.xp6(1),w.Q6J("ngIf",i===o.entityTableColumnRenderer.UnsanitizedHTML),w.xp6(1),w.Q6J("ngIf",i===o.entityTableColumnRenderer.Icon),w.xp6(1),w.Q6J("ngIf",i===o.entityTableColumnRenderer.ButtonGroup)}}function Ii(e,t){if(1&e&&(w.ynx(0,14),w.YNc(1,Qt,2,0,"ng-container",10),w.YNc(2,Yt,2,0,"ng-container",10),w.YNc(3,Mi,6,5,"ng-container",10),w.BQk()),2&e){var i=t.$implicit,o=w.oxw();w.Q6J("matColumnDef",i.name),w.xp6(1),w.Q6J("ngIf",o.columnIsSortable(i)),w.xp6(1),w.Q6J("ngIf",!o.columnIsSortable(i)),w.xp6(1),w.Q6J("ngIf",o.getColumnRenderer(i))}}function Pi(e,t){if(1&e&&w._UZ(0,"tr",65),2&e){var i=w.oxw();w.Q6J("ngClass",i.getHeaderClass())}}function _i(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"tr",66),w.NdJ("select",function(){var e=w.CHM(i).$implicit;return w.oxw().onRowSelect(e)})("click",function(){var e=w.CHM(i).$implicit;return w.oxw().onRowClick(e)}),w.qZA()}if(2&e){var o=t.$implicit,n=w.oxw();w.Q6J("scrollBehavior",n.scrollBehavior)("ngClass",n.getRowClass(o))("selection",n.selection)("selected",n.rowIsSelected(o))}}function qi(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"igo-entity-table-paginator",67),w.NdJ("paginatorChange",function(e){return w.CHM(i),w.oxw().paginatorChange(e)}),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("store",o.store)("paginatorOptions",o.paginatorOptions)("entitySortChange$",o.entitySortChange$)}}var Di=Xe,Ei=function(){var e=function(){function e(t,i,o,n,r,a,s,l,c){m(this,e),this.cdRef=t,this.formBuilder=i,this._focusMonitor=o,this._elementRef=n,this.ngControl=r,this._parentForm=a,this._controlName=s,this._defaultErrorStateMatcher=l,this.dateAdapter=c,this.entitySortChange$=new R.X(!1),this.formGroup=new We.cw({}),this.entityTableColumnRenderer=vt,this.entityTableSelectionState=bt,this.selectionState$=new R.X(void 0),this.scrollBehavior=yt.Auto,this.sortNullsFirst=!1,this.withPaginator=!1,this.entityClick=new w.vpe,this.entitySelectChange=new w.vpe,this.entitySortChange=new w.vpe(void 0),this.dataSource=new He.by,this.dateAdapter.setLocale("fr-CA")}return y(e,[{key:"paginator",get:function(){return this._paginator},set:function(e){this._paginator=e,this.dataSource.paginator=e}},{key:"headers",get:function(){var e=this.template.columns.filter(function(e){return!1!==e.visible}).map(function(e){return e.name});return!0===this.selectionCheckbox&&(e=["selectionCheckbox"].concat(e)),e}},{key:"selection",get:function(){return this.template.selection||!1}},{key:"selectionCheckbox",get:function(){return this.template.selectionCheckbox||!1}},{key:"selectMany",get:function(){return this.template.selectMany||!1}},{key:"fixedHeader",get:function(){return void 0===this.template.fixedHeader||this.template.fixedHeader}},{key:"ngOnInit",value:function(){this.handleDatasource(),this.dataSource.paginator=this.paginator}},{key:"ngOnChanges",value:function(e){var t=e.store;t&&t.currentValue!==t.previousValue&&this.handleDatasource()}},{key:"onValueChange",value:function(e,t,i){var o=this.getColumnKeyWithoutPropertiesTag(e);t.entity.properties[o]=i.target.value}},{key:"onBooleanValueChange",value:function(e,t,i){var o=this.getColumnKeyWithoutPropertiesTag(e);t.entity.properties[o]=i.checked}},{key:"onSelectValueChange",value:function(e,t,i){var o=this.getColumnKeyWithoutPropertiesTag(e);t.entity.properties[o]=i.value}},{key:"onAutocompleteValueChange",value:function(e,t,i){this.formGroup.controls[e].setValue(i.option.viewValue);var o=this.getColumnKeyWithoutPropertiesTag(e);t.entity.properties[o]=i.option.value}},{key:"onDateChange",value:function(e,t,i){var o=Di(i.value).format("YYYY-MM-DD"),n=this.getColumnKeyWithoutPropertiesTag(e);t.entity.properties[n]=o}},{key:"enableEdit",value:function(e){var t=this,i=e.entity.properties||e.entity;this.template.columns.forEach(function(o){var n;o.title=(null===(n=o.validation)||void 0===n?void 0:n.mandatory)&&!o.title.includes("*")?o.title+" *":o.title;var r=t.getColumnKeyWithoutPropertiesTag(o.name);if("boolean"===o.type)i[r]&&null!==i[r]?"string"==typeof i[r]&&(i[r]=JSON.parse(i[r].toLowerCase())):i[r]=!1,t.formGroup.setControl(o.name,t.formBuilder.control(i[r]));else if("list"===o.type)o.multiple?t.formGroup.setControl(o.name,t.formBuilder.control([i[r]])):(t.formGroup.setControl(o.name,t.formBuilder.control(i[r])),t.formGroup.controls[o.name].setValue("string"==typeof i[r]?parseInt(i[r]):i[r]));else if("autocomplete"===o.type){t.formGroup.setControl(o.name,t.formBuilder.control(i[r])),t.filteredOptions=t.formGroup.controls[o.name].valueChanges.pipe((0,D.U)(function(e){if(e.length)return o.domainValues.filter(function(t){var i=e?e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""):"";return t.value.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(i)})}));var a=i[r];o.domainValues.forEach(function(e){"string"==typeof a&&/^\d+$/.test(a)&&(a=parseInt(a)),(e.value===a||e.id===a)&&(a=e.value)}),t.formGroup.controls[o.name].setValue(a)}else if("date"===o.type){if(o.visible)if(i[r]){var s=Di(i[r]);i[r]=s.utc().format("YYYY-MM-DD"),t.formGroup.setControl(o.name,t.formBuilder.control(i[r]))}else{var l=t.getColumnKeyWithoutPropertiesTag(o.name);e.entity.properties[l]=null,t.formGroup.setControl(o.name,t.formBuilder.control(null))}}else t.formGroup.setControl(o.name,t.formBuilder.control(i[r]));t.formGroup.controls[o.name]&&t.getValidationAttributeValue(o,"readonly")&&t.formGroup.controls[o.name].disable()})}},{key:"handleDatasource",value:function(){var e=this;this.unsubscribeStore(),this.selection$$=this.store.stateView.manyBy$(function(e){return!0===e.state.selected}).subscribe(function(t){var i=t[0],o=e.store.stateView.all().indexOf(i),n=e.paginator?e.paginator.pageSize*(e.paginator.pageIndex+1):0;if(e.paginator&&(o<(e.paginator?n-e.paginator.pageSize:0)||o>=n)){var r=Math.floor(o/e.paginator.pageSize);e.dataSource.paginator.pageIndex=r}e.selectionState$.next(e.computeSelectionState(t))}),this.dataSource$$=this.store.stateView.all$().subscribe(function(t){t[0]&&e.enableEdit(t[0]),e.dataSource.data=t})}},{key:"ngOnDestroy",value:function(){this.unsubscribeStore()}},{key:"unsubscribeStore",value:function(){this.selection$$&&this.selection$$.unsubscribe(),this.dataSource$$&&this.dataSource$$.unsubscribe()}},{key:"getTrackByFunction",value:function(){return function(e,t){return t.ref}}},{key:"refresh",value:function(){this.cdRef.detectChanges()}},{key:"paginatorChange",value:function(e){this.paginator=e}},{key:"onSort",value:function(e){var t=this,i=e.direction,o=this.template.columns.find(function(t){return t.name===e.active});"asc"===i||"desc"===i?(this.store.stateView.sort({valueAccessor:function(e){return t.getValue(e,o)},direction:i,nullsFirst:this.sortNullsFirst}),this.entitySortChange.emit({column:o,direction:i}),this.entitySortChange$.next(!0)):this.store.stateView.sort(void 0)}},{key:"onRowClick",value:function(e){this.lastRecordCheckedKey=this.store.stateView.getKey(e),this.entityClick.emit(e.entity)}},{key:"onRowSelect",value:function(e){if(!1!==this.selection){var t=e.entity;this.store.state.update(t,{selected:!0},!0),this.entitySelectChange.emit({added:[t]})}}},{key:"onToggleRows",value:function(e){if(!1!==this.selection&&(this.store.state.updateAll({selected:e}),!0===e)){var t=this.store.stateView.all().map(function(e){return e.entity});this.entitySelectChange.emit({added:[t]})}}},{key:"onToggleRow",value:function(e,t){if(!1!==this.selection){var i=t.entity;this.store.state.update(i,{selected:e},!0===e&&!this.selectMany),!0===e&&this.entitySelectChange.emit({added:[i]}),this.lastRecordCheckedKey=this.store.stateView.getKey(t)}}},{key:"onShiftToggleRow",value:function(e,t,i){if(!1!==this.selection)if(!1!==this.selectMany&&void 0!==this.lastRecordCheckedKey){var o=window.document.createRange();o.selectNode(i.target),window.getSelection().removeAllRanges(),window.getSelection().addRange(o),i.stopImmediatePropagation();var n=this.store.stateView.all(),r=n.indexOf(t),a=this.store.stateView.get(this.lastRecordCheckedKey),s=[r,n.indexOf(a)],l=n.slice(Math.min.apply(Math,s),Math.max.apply(Math,s)+1).map(function(e){return e.entity});this.store.state.updateMany(l,{selected:e}),!0===e&&this.entitySelectChange.emit({added:l}),this.lastRecordCheckedKey=this.store.stateView.getKey(t)}else this.onToggleRow(e,t)}},{key:"computeSelectionState",value:function(e){var t=e.length;return 0===t?bt.None:t===this.store.stateView.count?bt.All:bt.Some}},{key:"columnIsSortable",value:function(e){var t=e.sort;return void 0===t&&(t=void 0!==this.template.sort&&this.template.sort),t}},{key:"rowIsSelected",value:function(e){var t=e.state;return!!t.selected&&t.selected}},{key:"isImg",value:function(e){return!!this.isUrl(e)&&-1!==["jpg","png","gif"].indexOf(e.split(".").pop().toLowerCase())}},{key:"isUrl",value:function(e){return"string"==typeof e&&("https://"===e.slice(0,8)||"http://"===e.slice(0,7))}},{key:"getValue",value:function(e,t){var i,o=this,n=e.entity;if(void 0!==t.valueAccessor)return t.valueAccessor(n,e);if(void 0!==this.template.valueAccessor)return this.template.valueAccessor(n,t.name,e);if(i=this.store.getProperty(n,t.name),"boolean"===t.type)null==i||""===i?i=!1:"boolean"!=typeof i&&void 0!==i&&(i="number"==typeof i?Boolean(i):JSON.parse(i.toLowerCase())),this.isEdition(e)||(i=i?"&#10003;":"");else if("list"===t.type&&i&&t.domainValues)if(t.multiple){var r;r="string"==typeof i?i.match(/[\w.-]+/g).map(Number):i;var a=[];t.domainValues.forEach(function(t){r.includes(t.id)&&a.push(e.edition?t.id:t.value)}),i=this.isEdition(e)?r:a}else t.domainValues.forEach(function(t){"string"==typeof i&&/^\d+$/.test(i)&&(i=parseInt(i)),(t.value===i||t.id===i)&&(i=o.isEdition(e)?t.id:t.value)});else"autocomplete"===t.type&&i&&t.domainValues?t.domainValues.forEach(function(e){"string"==typeof i&&/^\d+$/.test(i)&&(i=parseInt(i)),(e.value===i||e.id===i)&&(i=e.value)}):"date"===t.type&&(this.isEdition(e)?i&&(i=Di(i).format(),this.formGroup.controls[t.name].setValue(i)):!this.isEdition(e)&&null===i&&(i=""));return void 0===i&&(i=""),i}},{key:"getValidationAttributeValue",value:function(e,t){return void 0!==e.validation&&void 0!==e.validation[t]&&e.validation[t]}},{key:"isEdition",value:function(e){return!!e.entity.edition}},{key:"getColumnRenderer",value:function(e){return void 0!==e.renderer?e.renderer:vt.Default}},{key:"getTableClass",value:function(){return{"igo-entity-table-with-selection":this.selection}}},{key:"getHeaderClass",value:function(){var e=this.template.headerClassFunc;return e instanceof Function?e():{}}},{key:"getRowClass",value:function(e){var t=this.template.rowClassFunc;return t instanceof Function?t(e.entity,e):{}}},{key:"getCellClass",value:function(e,t){var i=e.entity,o={},n=this.template.cellClassFunc;n instanceof Function&&Object.assign(o,n(i,t,e));var r=t.cellClassFunc;return r instanceof Function&&Object.assign(o,r(i,e)),o}},{key:"onButtonClick",value:function(e,t){this.enableEdit(t),"function"==typeof e&&e(t.entity,t)}},{key:"getColumnKeyWithoutPropertiesTag",value:function(e){return e.includes("properties.")?e.split(".")[1]:e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(w.sBO),w.Y36(We.qu),w.Y36(Ke.tE),w.Y36(w.SBq),w.Y36(We.a5,10),w.Y36(We.F,8),w.Y36(We.u,8),w.Y36(Ve.rD),w.Y36(Ve._A))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-entity-table"]],inputs:{store:"store",paginator:"paginator",template:"template",scrollBehavior:"scrollBehavior",sortNullsFirst:"sortNullsFirst",withPaginator:"withPaginator",paginatorOptions:"paginatorOptions"},outputs:{entityClick:"entityClick",entitySelectChange:"entitySelectChange",entitySortChange:"entitySortChange"},features:[w._Bn([{provide:Ye.Eo,useExisting:e}]),w.TTD],decls:9,vars:8,consts:[[1,"table-container"],["mat-table","","matSort","",3,"ngClass","dataSource","trackBy","matSortChange"],["matColumnDef","selectionCheckbox",1,"mat-cell-checkbox"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],[3,"matColumnDef",4,"ngFor","ngForOf"],["mat-header-row","",3,"ngClass",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","igoEntityTableRow","",3,"scrollBehavior","ngClass","selection","selected","select","click",4,"matRowDef","matRowDefColumns"],[3,"store","paginatorOptions","entitySortChange$","paginatorChange",4,"ngIf"],["mat-header-cell",""],[4,"ngIf"],[3,"checked","indeterminate","change"],["mat-cell",""],[3,"checked","mousedown","click","change"],[3,"matColumnDef"],["mat-header-cell","","mat-sort-header","",3,"matTooltip",4,"matHeaderCellDef"],["mat-header-cell","","mat-sort-header","",3,"matTooltip"],["mat-header-cell","",3,"matTooltip",4,"matHeaderCellDef"],["mat-header-cell","",3,"matTooltip"],[4,"matCellDef"],["mat-cell","","class","mat-cell-text",3,"ngClass",4,"ngIf","ngIfElse"],["isAnUrlDefault",""],["mat-cell","",1,"mat-cell-text",3,"ngClass"],["target","_blank","rel","noopener noreferrer",3,"href","click"],["width","50","heigth","auto",3,"src",4,"ngIf","ngIfElse"],["notImg",""],["width","50","heigth","auto",3,"src"],["mat-cell","","class","mat-cell-text",3,"ngClass","innerHTML",4,"ngIf","ngIfElse"],["isAnUrlHTML",""],["mat-cell","",1,"mat-cell-text",3,"ngClass","innerHTML"],["mat-cell","","class","mat-cell-text edition",3,"formGroup","ngClass",4,"ngIf","ngIfElse"],["isUnsanitizedHTML",""],["mat-cell","",1,"mat-cell-text","edition",3,"formGroup","ngClass"],["class","date-picker",4,"ngIf"],["matInput","","type","time","step","900",3,"formControlName","focus","keypress","blur",4,"ngIf"],["matInput","","type","number","class","class_number_edition",3,"formControlName","step","value","readonly","required","min","max","input",4,"ngIf"],["matInput","","type","text",3,"formControlName","value","readonly","required","input",4,"ngIf"],[3,"formControlName","checked","change",4,"ngIf"],[3,"required","formControlName","multiple","value","selectionChange",4,"ngIf"],["matInput","","type","text",3,"formControlName","matAutocomplete","required","value",4,"ngIf"],["panelWidth","430px",3,"optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[1,"date-picker"],["matSuffix","",3,"for"],["matInput","",3,"matDatepicker","formControlName","value","dateChange"],["picker",""],["matInput","","type","time","step","900",3,"formControlName","focus","keypress","blur"],["matInput","","type","number",1,"class_number_edition",3,"formControlName","step","value","readonly","required","min","max","input"],["matInput","","type","text",3,"formControlName","value","readonly","required","input"],[3,"formControlName","checked","change"],[3,"required","formControlName","multiple","value","selectionChange"],[3,"value","disabled",4,"ngFor","ngForOf"],[3,"value","disabled"],["matInput","","type","text",3,"formControlName","matAutocomplete","required","value"],[3,"value"],["isAnUrlUnsanitizedHTML",""],["mat-cell","","class","mat-cell-text",3,"ngClass",4,"matCellDef"],[3,"svgIcon","click"],[4,"ngFor","ngForOf"],["igoStopPropagation","","mat-icon-button","",3,"color","disabled","mousedown",4,"ngIf"],["igoStopPropagation","","mat-mini-fab","",3,"color","disabled","mousedown",4,"ngIf"],["igoStopPropagation","","mat-icon-button","",3,"color","disabled","mousedown"],[3,"svgIcon"],["igoStopPropagation","","mat-mini-fab","",3,"color","disabled","mousedown"],["mat-header-row","",3,"ngClass"],["mat-row","","igoEntityTableRow","",3,"scrollBehavior","ngClass","selection","selected","select","click"],[3,"store","paginatorOptions","entitySortChange$","paginatorChange"]],template:function(e,t){1&e&&(w.TgZ(0,"div",0),w.TgZ(1,"table",1),w.NdJ("matSortChange",function(e){return t.onSort(e)}),w.ynx(2,2),w.YNc(3,Jt,2,1,"th",3),w.YNc(4,Bt,2,1,"td",4),w.BQk(),w.YNc(5,Ii,4,4,"ng-container",5),w.YNc(6,Pi,1,1,"tr",6),w.YNc(7,_i,1,4,"tr",7),w.qZA(),w.YNc(8,qi,1,3,"igo-entity-table-paginator",8),w.qZA()),2&e&&(w.xp6(1),w.Q6J("ngClass",t.getTableClass())("dataSource",t.dataSource)("trackBy",t.getTrackByFunction()),w.xp6(4),w.Q6J("ngForOf",t.template.columns),w.xp6(1),w.Q6J("matHeaderRowDef",t.headers)("matHeaderRowDefSticky",t.fixedHeader),w.xp6(1),w.Q6J("matRowDefColumns",t.headers),w.xp6(1),w.Q6J("ngIf",t.withPaginator))},directives:[He.BZ,et.YE,F.mk,He.w1,He.fO,He.Dz,F.sg,He.as,He.nj,F.O5,He.ge,M.oG,He.ev,et.nU,L.gM,We.JL,We.sg,tt.XC,it.nW,Ye.R9,ot.Nt,it.hl,We.Fj,We.JJ,We.u,it.Mq,We.wV,We.qQ,We.Fd,We.Q7,ze.gD,Ve.ey,tt.ZL,k.Hw,S.lW,qt,He.XQ,He.Gk,Dt,Et],pipes:[F.Ov,$t,ae.X$,Rt],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:block}.table-compact[_nghost-%COMP%]   tr.mat-header-row[_ngcontent-%COMP%], .table-compact[_nghost-%COMP%]     .mat-checkbox .mat-checkbox-ripple{height:36px}.table-compact[_nghost-%COMP%]   tr.mat-row[_ngcontent-%COMP%], .table-compact[_nghost-%COMP%]     .mat-checkbox .mat-checkbox-ripple{height:28px}.table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;overflow:auto;flex:1 1 auto}.mat-cell-text[_ngcontent-%COMP%]{overflow:hidden;word-wrap:break-word}th.mat-header-cell[_ngcontent-%COMP%], td.mat-cell[_ngcontent-%COMP%], td.mat-footer-cell[_ngcontent-%COMP%]{padding:0 3px}entity-table[_ngcontent-%COMP%]   table.igo-entity-table-with-selection[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{-o-box-shadow:2px 0px 2px 0px #dddddd;box-shadow:2px 0 2px #ddd;cursor:pointer}table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:7px}.class_boolean[_ngcontent-%COMP%], .class_icon[_ngcontent-%COMP%], .class_number[_ngcontent-%COMP%]{text-align:center;padding-right:35px!important}.class_sting[_ngcontent-%COMP%], .class_text[_ngcontent-%COMP%], .class_number_edition[_ngcontent-%COMP%]{text-align:left}td.edition[_ngcontent-%COMP%]{background:rgba(166,166,166,.2)}input[_ngcontent-%COMP%]{border-bottom:1px solid darkgrey}"],changeDetection:0}),e}(),$i=function(){return(e=$i||($i={})).Dock="dock",e.Overlay="overlay",e.Context="context",$i;var e}();function Ri(e,t){if(1&e&&(w._UZ(0,"mat-icon",7),w.ALo(1,"async")),2&e){var i=w.oxw(3);w.s9C("svgIcon",w.lcZ(1,1,i.icon$))}}function Ni(e,t){if(1&e&&(w.TgZ(0,"button",5),w.ALo(1,"async"),w.YNc(2,Ri,2,3,"mat-icon",6),w.qZA()),2&e){var i=w.oxw(2);w.Q6J("color",i.color)("disabled",w.lcZ(1,3,i.disabled$)),w.xp6(2),w.Q6J("ngIf",i.withIcon)}}function Ui(e,t){if(1&e&&(w.TgZ(0,"h4",8),w._uU(1),w.ALo(2,"translate"),w.qZA()),2&e){var i=w.oxw(2);w.xp6(1),w.Oqu(w.lcZ(2,1,i.title))}}function Ji(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-list-item",2),w.NdJ("click",function(){return w.CHM(i),w.oxw().onClick()}),w.ALo(1,"translate"),w.ALo(2,"async"),w.ALo(3,"async"),w.YNc(4,Ni,3,5,"button",3),w.YNc(5,Ui,3,3,"h4",4),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("matTooltip",o.withTooltip?w.lcZ(1,4,w.lcZ(2,6,o.tooltip$)||o.title):"")("ngClass",w.lcZ(3,8,o.ngClass$)),w.xp6(4),w.Q6J("ngIf",o.withIcon),w.xp6(1),w.Q6J("ngIf",o.withTitle)}}function Bi(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-checkbox",11),w.NdJ("change",function(){return w.CHM(i),w.oxw(2).action.handler()}),w.ALo(1,"async"),w._uU(2),w.ALo(3,"translate"),w.qZA()}if(2&e){var o=w.oxw(2);w.Q6J("checked",w.lcZ(1,2,o.checkCondition$)),w.xp6(2),w.hij(" ",w.lcZ(3,4,o.title)," ")}}function ji(e,t){if(1&e&&(w.TgZ(0,"mat-list-item",9),w.ALo(1,"translate"),w.ALo(2,"async"),w.ALo(3,"async"),w.YNc(4,Bi,4,6,"mat-checkbox",10),w.qZA()),2&e){var i=w.oxw();w.Q6J("matTooltip",i.withTooltip?w.lcZ(1,3,w.lcZ(2,5,i.tooltip$)||i.title):"")("ngClass",w.lcZ(3,7,i.ngClass$)),w.xp6(4),w.Q6J("ngIf",i.withTitle)}}var Qi=function(){var e=function(){function e(){m(this,e),this.disabled$=new R.X(!1),this.checkCondition$=new R.X(void 0),this.icon$=new R.X(void 0),this.tooltip$=new R.X(void 0),this.noDisplay$=new R.X(!1),this.ngClass$=new R.X({}),this.color="default",this.withTitle=!0,this.withIcon=!0,this.withTooltip=!0,this.trigger=new w.vpe}return y(e,[{key:"disabled",get:function(){return this.disabled$.value},set:function(e){this.disabled$.next(e)}},{key:"noDisplay",get:function(){return this.noDisplay$.value},set:function(e){this.noDisplay$.next(e)}},{key:"title",get:function(){return this.action.title}},{key:"ngOnInit",value:function(){var e,t,i,o=this,n=this.action.args||[];void 0!==this.action.ngClass&&(this.ngClass$$=(e=this.action).ngClass.apply(e,d(n)).subscribe(function(e){return o.updateNgClass(e)})),(0,Ue.b)(this.action.icon)?this.icon$$=this.action.icon.subscribe(function(e){return o.updateIcon(e)}):this.updateIcon(this.action.icon),(0,Ue.b)(this.action.checkCondition)?this.checkCondition$$=this.action.checkCondition.subscribe(function(e){return o.updateCheckCondition(e)}):this.updateCheckCondition(this.action.checkCondition),(0,Ue.b)(this.action.tooltip)?this.tooltip$$=this.action.tooltip.subscribe(function(e){return o.updateTooltip(e)}):this.updateTooltip(this.action.tooltip),void 0!==this.action.availability&&(this.availability$$=(t=this.action).availability.apply(t,d(n)).subscribe(function(e){return o.disabled=!e})),this.disabled$$=this.disabled$.subscribe(function(e){return o.updateNgClass({"igo-actionbar-item-disabled":e})}),void 0!==this.action.display&&(this.display$$=(i=this.action).display.apply(i,d(n)).subscribe(function(e){return o.noDisplay=!e})),this.noDisplay$$=this.noDisplay$.subscribe(function(e){return o.updateNgClass({"igo-actionbar-item-no-display":e})})}},{key:"ngOnDestroy",value:function(){void 0!==this.ngClass$$&&(this.ngClass$$.unsubscribe(),this.ngClass$$=void 0),void 0!==this.availability$$&&(this.availability$$.unsubscribe(),this.availability$$=void 0),void 0!==this.display$$&&(this.display$$.unsubscribe(),this.display$$=void 0),void 0!==this.checkCondition$$&&(this.checkCondition$$.unsubscribe(),this.checkCondition$$=void 0),void 0!==this.icon$$&&(this.icon$$.unsubscribe(),this.icon$$=void 0),void 0!==this.tooltip$$&&(this.tooltip$$.unsubscribe(),this.tooltip$$=void 0),this.disabled$$.unsubscribe(),this.noDisplay$$.unsubscribe()}},{key:"onClick",value:function(){!0!==this.disabled&&this.trigger.emit(this.action)}},{key:"updateNgClass",value:function(e){this.ngClass$.next(Object.assign({},this.ngClass$.value,e))}},{key:"updateTooltip",value:function(e){this.tooltip$.next(e)}},{key:"updateCheckCondition",value:function(e){this.checkCondition$.next(e)}},{key:"updateIcon",value:function(e){this.icon$.next(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-actionbar-item"]],inputs:{action:"action",color:"color",withTitle:"withTitle",withIcon:"withIcon",withTooltip:"withTooltip",disabled:"disabled",noDisplay:"noDisplay"},outputs:{trigger:"trigger"},decls:2,vars:2,consts:[["matTooltipClass","actionbarItemTooltip","matTooltipShowDelay","500",3,"matTooltip","ngClass","click",4,"ngIf"],["class","item-checkbox","matTooltipClass","actionbarItemTooltip","matTooltipShowDelay","500",3,"matTooltip","ngClass",4,"ngIf"],["matTooltipClass","actionbarItemTooltip","matTooltipShowDelay","500",3,"matTooltip","ngClass","click"],["mat-list-avatar","","mat-icon-button","",3,"color","disabled",4,"ngIf"],["matLine","",4,"ngIf"],["mat-list-avatar","","mat-icon-button","",3,"color","disabled"],[3,"svgIcon",4,"ngIf"],[3,"svgIcon"],["matLine",""],["matTooltipClass","actionbarItemTooltip","matTooltipShowDelay","500",1,"item-checkbox",3,"matTooltip","ngClass"],[3,"checked","change",4,"ngIf"],[3,"checked","change"]],template:function(e,t){1&e&&(w.YNc(0,Ji,6,10,"mat-list-item",0),w.YNc(1,ji,5,9,"mat-list-item",1)),2&e&&(w.Q6J("ngIf",!t.action.checkbox),w.xp6(1),w.Q6J("ngIf",t.action.checkbox))},directives:[F.O5,C.Tg,L.gM,F.mk,S.lW,C.eA,k.Hw,Ve.X2,M.oG],pipes:[ae.X$,F.Ov],styles:["mat-list-item.igo-actionbar-item-disabled[_ngcontent-%COMP%]{color:#00000042;cursor:default!important}mat-list-item.igo-actionbar-item-no-display[_ngcontent-%COMP%]{display:none}mat-checkbox[_ngcontent-%COMP%]{padding:12px}.item-checkbox[_ngcontent-%COMP%]{height:56px}.item-checkbox[_ngcontent-%COMP%]     .mat-checkbox-label{margin-left:20px}"],changeDetection:0}),e}();function Gi(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",5),w.TgZ(1,"button",6),w.NdJ("click",function(){return w.CHM(i),w.oxw(2).scrollUp()}),w.ALo(2,"translate"),w._UZ(3,"mat-icon",7),w.qZA(),w.qZA()}2&e&&(w.xp6(1),w.Q6J("matTooltip",w.lcZ(2,1,"igo.common.actionbar.scrollUp")))}function Yi(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"igo-actionbar-item",8),w.NdJ("trigger",function(){w.CHM(i);var e=w.oxw(2);return e.onTriggerAction(e.toggleCollapseAction)}),w.qZA()}if(2&e){var o=w.oxw(2);w.Q6J("withTitle",!1)("withIcon",!0)("color",o.color)("disabled",o.store.view.empty)("action",o.toggleCollapseAction)}}function zi(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"igo-actionbar-item",11),w.NdJ("trigger",function(){var e=w.CHM(i).$implicit;return w.oxw(3).onTriggerAction(e)}),w.qZA()}if(2&e){var o=t.$implicit,n=w.oxw(3);w.Q6J("withTitle",n.withTitle)("withIcon",n.withIcon)("withTooltip",n.withTooltip)("color",n.color)("disabled",n.store.state.get(o).disabled)("action",o)}}function Vi(e,t){if(1&e&&(w.YNc(0,zi,1,6,"ng-template",9,10,w.W1O),w.ALo(2,"async")),2&e){var i=w.oxw(2);w.Q6J("ngForOf",w.lcZ(2,1,i.store.view.all$()))}}function Hi(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",12),w.TgZ(1,"button",6),w.NdJ("click",function(){return w.CHM(i),w.oxw(2).scrollDown()}),w.ALo(2,"translate"),w._UZ(3,"mat-icon",13),w.qZA(),w.qZA()}2&e&&(w.xp6(1),w.Q6J("matTooltip",w.lcZ(2,1,"igo.common.actionbar.scrollDown")))}function Wi(e,t){if(1&e&&(w.TgZ(0,"mat-list"),w.YNc(1,Gi,4,3,"div",2),w.YNc(2,Yi,1,5,"igo-actionbar-item",3),w.YNc(3,Vi,3,3,void 0,0),w.YNc(4,Hi,4,3,"div",4),w.qZA()),2&e){var i=w.oxw();w.xp6(1),w.Q6J("ngIf",i.heightCondition&&i.positionConditionTop&&i.isDesktop),w.xp6(1),w.Q6J("ngIf",i.withToggleButton),w.xp6(1),w.Q6J("ngIf",!i.collapsed),w.xp6(1),w.Q6J("ngIf",i.heightCondition&&i.positionConditionLow&&i.isDesktop)}}function Xi(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"igo-actionbar-item",18),w.NdJ("trigger",function(){var e=w.CHM(i).$implicit;return w.oxw(2).onTriggerAction(e)}),w.qZA()}if(2&e){var o=t.$implicit,n=w.oxw(2);w.Q6J("withTitle",n.withTitle)("withIcon",n.withIcon)("color",n.color)("action",o)}}function Ki(e,t){if(1&e&&(w.TgZ(0,"div"),w.TgZ(1,"button",14),w.ALo(2,"translate"),w._UZ(3,"mat-icon",15),w.qZA(),w.TgZ(4,"mat-menu",16,17),w.TgZ(6,"mat-list"),w.YNc(7,Xi,1,4,"ng-template",9),w.ALo(8,"async"),w.qZA(),w.qZA(),w.qZA()),2&e){var i=w.MAs(5),o=w.oxw();w.xp6(1),w.Q6J("matTooltip",w.lcZ(2,10,"igo.common.actionbar.icon"))("matMenuTriggerFor",i)("disabled",o.store.view.empty)("color",o.iconColor),w.xp6(2),w.Q6J("svgIcon",o.icon),w.xp6(1),w.Tol(o.overlayClass),w.Q6J("xPosition",o.xPosition)("yPosition",o.yPosition),w.xp6(3),w.Q6J("ngForOf",w.lcZ(8,12,o.store.view.all$()))}}function eo(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"igo-actionbar-item",18),w.NdJ("trigger",function(){var e=w.CHM(i).$implicit;return w.oxw(2).onTriggerAction(e)}),w.qZA(),w._UZ(1,"br")}if(2&e){var o=t.$implicit,n=w.oxw(2);w.Q6J("withTitle",n.withTitle)("withIcon",n.withIcon)("color",n.color)("action",o)}}function to(e,t){if(1&e&&(w.TgZ(0,"mat-card",19),w.TgZ(1,"mat-list"),w.YNc(2,eo,2,4,"ng-template",9),w.ALo(3,"async"),w.qZA(),w.qZA()),2&e){var i=w.oxw();w.xp6(2),w.Q6J("ngForOf",w.lcZ(3,1,i.store.view.all$()))}}var io=function(){var e=function(){function e(t,i,o,n){var r=this;m(this,e),this.overlay=t,this.elRef=i,this.cdRef=o,this.mediaService=n,this.actionbarMode=$i,this.collapsed=!1,this.toggleCollapseAction={id:"actionbar_toggle",icon:"dots-vertical",handler:function(){r.collapsed=!r.collapsed}},this.heightCondition$=new R.X(!1),this.positionConditionTop$=new R.X(!0),this.positionConditionLow$=new R.X(!0),this.mode=$i.Dock,this.withToggleButton=!1,this.horizontal=!1,this.color="default",this.iconColor="default",this.withTitle=!0,this.withTooltip=!0,this.scrollActive=!0,this.withIcon=!0,this.icon="dots-horizontal",this.xPosition="before",this.yPosition="above",this._overlayClass=""}return y(e,[{key:"overlayClass",get:function(){return[this._overlayClass,"igo-actionbar-overlay"].join(" ")},set:function(e){this._overlayClass=e}},{key:"withTitleClass",get:function(){return this.withTitle}},{key:"withIconClass",get:function(){return this.withIcon}},{key:"horizontalClass",get:function(){return this.horizontal}},{key:"heightCondition",get:function(){var e=this.elRef.nativeElement;return!1===this.scrollActive&&e.clientHeight<e.scrollHeight}},{key:"positionConditionTop",get:function(){return 0!==this.elRef.nativeElement.scrollTop}},{key:"positionConditionLow",get:function(){var e=this.elRef.nativeElement;return!(e.scrollTop>=e.scrollHeight-e.clientHeight)}},{key:"isDesktop",get:function(){return this.mediaService.getMedia()===Me.Desktop}},{key:"ngOnChanges",value:function(e){var t=e.store;t&&t.currentValue!==t.previousValue&&(void 0!==this.watcher&&this.watcher.destroy(),this.watcher=new Lt(this.store,this.cdRef))}},{key:"ngOnDestroy",value:function(){this.watcher.destroy()}},{key:"onTriggerAction",value:function(e){e.handler.apply(e,d(e.args||[]))}},{key:"scrollDown",value:function(){this.elRef.nativeElement.scrollBy(0,52)}},{key:"scrollUp",value:function(){this.elRef.nativeElement.scrollBy(0,-52)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(lt.aV),w.Y36(w.SBq),w.Y36(w.sBO),w.Y36(Pe))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-actionbar"]],hostVars:6,hostBindings:function(e,t){2&e&&w.ekj("with-title",t.withTitleClass)("with-icon",t.withIconClass)("horizontal",t.horizontalClass)},inputs:{store:"store",mode:"mode",withToggleButton:"withToggleButton",horizontal:"horizontal",color:"color",iconColor:"iconColor",withTitle:"withTitle",withTooltip:"withTooltip",scrollActive:"scrollActive",withIcon:"withIcon",icon:"icon",xPosition:"xPosition",yPosition:"yPosition",overlayClass:"overlayClass"},features:[w.TTD],decls:3,vars:3,consts:[[4,"ngIf"],["class","context-menu-card mat-elevation-z4",4,"ngIf"],["id","topChevron",4,"ngIf"],["color","accent",3,"withTitle","withIcon","color","disabled","action","trigger",4,"ngIf"],["id","lowChevron",4,"ngIf"],["id","topChevron"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","click"],["svgIcon","chevron-up"],["color","accent",3,"withTitle","withIcon","color","disabled","action","trigger"],["ngFor","",3,"ngForOf"],["buttonContent",""],["color","accent",3,"withTitle","withIcon","withTooltip","color","disabled","action","trigger"],["id","lowChevron"],["svgIcon","chevron-down"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",1,"buttonOverlay",3,"matTooltip","matMenuTriggerFor","disabled","color"],[3,"svgIcon"],["overlapTrigger","true",1,"igo-compact-menu","igo-no-min-width-menu",3,"xPosition","yPosition"],["actionbarMenu","matMenu"],["color","accent",3,"withTitle","withIcon","color","action","trigger"],[1,"context-menu-card","mat-elevation-z4"]],template:function(e,t){1&e&&(w.YNc(0,Wi,5,4,"mat-list",0),w.YNc(1,Ki,9,14,"div",0),w.YNc(2,to,4,3,"mat-card",1)),2&e&&(w.Q6J("ngIf",t.mode===t.actionbarMode.Dock),w.xp6(1),w.Q6J("ngIf",t.mode===t.actionbarMode.Overlay),w.xp6(1),w.Q6J("ngIf",t.mode===t.actionbarMode.Context))},directives:[F.O5,C.i$,S.lW,L.gM,k.Hw,Qi,F.sg,I.p6,I.VK,O.a8],pipes:[ae.X$,F.Ov],styles:["[_nghost-%COMP%]{display:block;height:100%;overflow:auto;position:relative}button[_ngcontent-%COMP%]{margin:4px}.buttonOverlay[_ngcontent-%COMP%]{margin:0}mat-list[_ngcontent-%COMP%]{padding-top:0}.horizontal[_nghost-%COMP%]{max-width:100%;overflow:unset}.horizontal[_nghost-%COMP%]   mat-list[_ngcontent-%COMP%]{width:auto;white-space:nowrap}.horizontal[_nghost-%COMP%]   igo-actionbar-item[_ngcontent-%COMP%]{display:inline-block}[_nghost-%COMP%]     .mat-list .mat-list-item .mat-list-text>*{white-space:normal;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;max-height:36px;line-height:18px;-webkit-box-orient:vertical;-webkit-line-clamp:2}[_nghost-%COMP%]     .mat-list-base .mat-list-item.mat-list-item-with-avatar{height:46px}[_nghost-%COMP%]     .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content{display:-webkit-flex;height:46px;padding:3px}[_nghost-%COMP%]     .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content>mat-icon{padding:8px}igo-actionbar-item[_ngcontent-%COMP%]     mat-list-item [mat-list-avatar]{height:auto;width:40px}igo-actionbar-item[_ngcontent-%COMP%]     mat-list-item:hover{cursor:pointer}.context-menu-card[_ngcontent-%COMP%]{padding:8px 3px;margin:10px}#topChevron[_ngcontent-%COMP%]{position:sticky;top:0;background-color:#fff;z-index:3}@media all and (-ms-high-contrast: none),(-ms-high-contrast: active){#topChevron[_ngcontent-%COMP%]{position:fixed;top:unset}}@supports (-ms-accelerator: true){#topChevron[_ngcontent-%COMP%]{position:fixed;top:unset}}#lowChevron[_ngcontent-%COMP%]{position:fixed;position:sticky;bottom:0;background-color:#fff;z-index:3}"],changeDetection:0}),e}(),oo=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,Se,S.ot,k.Ps,L.AV,I.Tx,C.ie,O.QW,M.p9]]}),e}(),no=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({providers:[],imports:[[F.ez,oo],oo]}),e}(),ro=function(){var e=function(){function e(t,i){m(this,e),this.el=t,this.matIconRegistry=i,this.hidden=!1,this.disabled=!1,this.inverseColor=!1,this.inheritColor=!1}return y(e,[{key:"igoMatBadgeIcon",set:function(e){var t=this;this.matIconRegistry.getNamedSvgIcon(e).subscribe(function(e){t.svg=e,t.updateSvg()})}},{key:"matBadgeHidden",set:function(e){this.hidden=e,this.updateHidden()}},{key:"matBadgeDisabled",set:function(e){this.disabled=e,this.updateDisabled()}},{key:"igoMatBadgeInverseColor",set:function(e){this.inverseColor=e,this.updateColor()}},{key:"igoMatBadgeInheritColor",set:function(e){this.inheritColor=e,this.updateColor()}},{key:"badge",get:function(){return this.el.nativeElement.querySelector(".mat-badge-content")}},{key:"ngOnInit",value:function(){this.badge.style.alignItems="center",this.badge.style.justifyContent="center",this.updateHidden(),this.updateColor(),this.updateSvg()}},{key:"updateSvg",value:function(){!this.badge||(this.badge.innerHTML="",this.svg&&this.badge.appendChild(this.svg))}},{key:"updateColor",value:function(){!this.badge||(this.inheritColor?this.inverseColor?(this.badge.style.color="currentColor",this.badge.style.background="none"):(this.badge.style.color="",this.badge.style.background="currentColor"):this.inverseColor?(this.badge.style.color=window.getComputedStyle(this.badge,null).getPropertyValue("background-color"),this.badge.style.background="none"):(this.badge.style.color="",this.badge.style.background=""),this.originalColor=this.badge.style.color,this.updateDisabled())}},{key:"updateHidden",value:function(){!this.badge||(this.badge.style.display=this.hidden?"none":"flex")}},{key:"updateDisabled",value:function(){!this.badge||!this.inverseColor||(this.disabled?(this.originalColor=this.badge.style.color,this.badge.style.color="#b9b9b9"):this.badge.style.color=this.originalColor)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(w.SBq),w.Y36(k.jv))},e.\u0275dir=w.lG2({type:e,selectors:[["","igoMatBadgeIcon",""]],inputs:{igoMatBadgeIcon:"igoMatBadgeIcon",matBadgeHidden:"matBadgeHidden",matBadgeDisabled:"matBadgeDisabled",igoMatBadgeInverseColor:"igoMatBadgeInverseColor",igoMatBadgeInheritColor:"igoMatBadgeInheritColor"}}),e}(),ao=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[ct.g,k.Ps],ct.g]}),e}(),so=function(){var e=function(){function e(t){m(this,e),this.el=t,this.clickout=new w.vpe}return y(e,[{key:"handleMouseClick",value:function(e,t){!t||this.el.nativeElement.contains(t)||this.clickout.emit(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(w.SBq))},e.\u0275dir=w.lG2({type:e,selectors:[["","igoClickout",""]],hostBindings:function(e,t){1&e&&w.NdJ("click",function(e){return t.handleMouseClick(e,e.target)},!1,w.evT)},outputs:{clickout:"clickout"}}),e}(),lo=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[]]}),e}(),co=function(){var e=function(){function e(t,i){m(this,e),this.renderer=t,this.el=i,this._collapsed=!1,this.toggle=new w.vpe}return y(e,[{key:"target",get:function(){return this._target},set:function(e){this._target=e}},{key:"collapsed",get:function(){return this._collapsed},set:function(e){e?this.collapseTarget():this.expandTarget(),this._collapsed=e,this.toggle.emit(e)}},{key:"click",value:function(){this.collapsed=!this.collapsed}},{key:"collapseTarget",value:function(){this.renderer.addClass(this.target,"igo-collapsed"),this.renderer.addClass(this.el.nativeElement,"collapsed")}},{key:"expandTarget",value:function(){this.renderer.removeClass(this.target,"igo-collapsed"),this.renderer.removeClass(this.el.nativeElement,"collapsed")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(w.Qsj),w.Y36(w.SBq))},e.\u0275dir=w.lG2({type:e,selectors:[["","igoCollapse",""]],hostBindings:function(e,t){1&e&&w.NdJ("click",function(){return t.click()})},inputs:{target:"target",collapsed:"collapsed"},outputs:{toggle:"toggle"}}),e}(),uo=["*"],po=function(){var e=function(){function e(){m(this,e),this._title="",this._collapsed=!1,this.toggle=new w.vpe}return y(e,[{key:"title",get:function(){return this._title},set:function(e){this._title=e}},{key:"collapsed",get:function(){return this._collapsed},set:function(e){this._collapsed=e,this.toggle.emit(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-collapsible"]],inputs:{title:"title",collapsed:"collapsed"},outputs:{toggle:"toggle"},ngContentSelectors:uo,decls:7,vars:3,consts:[["svgIcon","chevron-up","mat-list-avatar","","igoCollapse","",1,"igo-chevron",3,"target","collapsed","toggle"],["matLine",""],["content",""]],template:function(e,t){if(1&e&&(w.F$t(),w.TgZ(0,"mat-list-item"),w.TgZ(1,"mat-icon",0),w.NdJ("toggle",function(e){return t.collapsed=e}),w.qZA(),w.TgZ(2,"h4",1),w._uU(3),w.qZA(),w.qZA(),w.TgZ(4,"div",null,2),w.Hsn(6),w.qZA()),2&e){var i=w.MAs(5);w.xp6(1),w.Q6J("target",i)("collapsed",t.collapsed),w.xp6(2),w.Oqu(t.title)}},directives:[C.Tg,k.Hw,C.eA,co,Ve.X2],styles:["[_nghost-%COMP%]     .mat-list .mat-list-item.mat-list-avatar{height:auto;width:auto;padding:0}mat-list-item[_ngcontent-%COMP%]{overflow:hidden}"]}),e}(),ho=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[k.Ps,C.ie]]}),e}(),go=function(){var e=function e(t){m(this,e),this.dialogRef=t};return e.\u0275fac=function(t){return new(t||e)(w.Y36(ut.so))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-confirm-dialog"]],decls:12,vars:10,consts:[["mat-dialog-title","",1,"mat-typography"],["mat-dialog-content","",1,"mat-typography"],["mat-dialog-actions",""],["mat-button","","color","primary",3,"click"],["mat-button","",3,"click"]],template:function(e,t){1&e&&(w.TgZ(0,"h2",0),w._uU(1),w.ALo(2,"translate"),w.qZA(),w.TgZ(3,"div",1),w._uU(4),w.qZA(),w.TgZ(5,"div",2),w.TgZ(6,"button",3),w.NdJ("click",function(){return t.dialogRef.close(!0)}),w._uU(7),w.ALo(8,"translate"),w.qZA(),w.TgZ(9,"button",4),w.NdJ("click",function(){return t.dialogRef.close(!1)}),w._uU(10),w.ALo(11,"translate"),w.qZA(),w.qZA()),2&e&&(w.xp6(1),w.Oqu(w.lcZ(2,4,"igo.common.confirmDialog.title")),w.xp6(3),w.Oqu(t.confirmMessage),w.xp6(3),w.Oqu(w.lcZ(8,6,"igo.common.confirmDialog.confirmBtn")),w.xp6(3),w.Oqu(w.lcZ(11,8,"igo.common.confirmDialog.cancelBtn")))},directives:[ut.uh,ut.xY,ut.H8,S.lW],pipes:[ae.X$],styles:["h2[_ngcontent-%COMP%]{margin:5px 0 10px}div[mat-dialog-content][_ngcontent-%COMP%]{max-width:200px}div[mat-dialog-actions][_ngcontent-%COMP%]{margin:10px 0 0}"]}),e}(),fo=function(){var e=function(){function e(t){m(this,e),this.dialog=t}return y(e,[{key:"open",value:function(e){var t=this.dialog.open(go,{disableClose:!1});return t.componentInstance.confirmMessage=e,t.afterClosed()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(ut.uw))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac}),e}(),mo=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({providers:[fo],imports:[[S.ot,ut.Is,Se]]}),e}(),vo=function(){var e=function(){function e(t,i,o){m(this,e),this.overlay=t,this.viewContainerRef=i,this.elementRef=o,this.menuPosition=new w.vpe}return y(e,[{key:"onContextMenu",value:function(e){var t=this,i=e.x,o=e.y;this.close(),e.preventDefault(),this.menuPosition.emit({x:i,y:o}),this.overlayRef=null;var n=this.overlay.position().flexibleConnectedTo({x:i,y:o}).withPositions([{originX:"end",originY:"bottom",overlayX:"start",overlayY:"top"}]);this.overlayRef=this.overlay.create({positionStrategy:n,scrollStrategy:this.overlay.scrollStrategies.close()}),this.overlayRef.attach(new pt.UE(this.menuContext,this.viewContainerRef,{$implicit:void 0})),this.sub=(0,B.R)(document,"click").pipe((0,Qe.h)(function(e){var i=e.target;return t.close(),!!t.overlayRef&&!t.overlayRef.overlayElement.contains(i)}),(0,Ge.q)(1)).subscribe(function(){return t.close()}),this.sub=(0,B.R)(document,"contextmenu").pipe((0,Qe.h)(function(e){var i=e.target;if(i&&!t.elementRef.nativeElement.contains(i)&&!t.overlayRef.overlayElement.contains(i))return!0;e.preventDefault()}),(0,Ge.q)(1)).subscribe(function(){return t.close()})}},{key:"close",value:function(){this.overlayRef&&(this.overlayRef.dispose(),this.overlayRef=null),this.sub&&this.sub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(lt.aV),w.Y36(w.s_b),w.Y36(w.SBq))},e.\u0275dir=w.lG2({type:e,selectors:[["","igoContextMenu",""]],hostBindings:function(e,t){1&e&&w.NdJ("contextmenu",function(e){return t.onContextMenu(e)})},inputs:{menuContext:["igoContextMenu","menuContext"]},outputs:{menuPosition:"menuPosition"}}),e}(),yo=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[]]}),e}(),bo=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,k.Ps,L.AV,ot.c,S.ot,Se]]}),e}(),wo=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[]]}),e}(),xo=function(){function e(t){m(this,e),this.componentFactory=t,this.subscriptions=[],this.inputs={},this.inputs$$={},this.subscribers={}}return y(e,[{key:"setTarget",value:function(e){this.target=e,this.componentRef=e.createComponent(this.componentFactory),this.updateInputs(this.inputs),this.updateSubscribers(this.subscribers)}},{key:"destroy",value:function(){void 0!==this.target&&this.target.clear(),void 0!==this.componentRef&&(this.componentRef.destroy(),this.componentRef=void 0),this.unobserveAllInputs(),this.unsubscribeAll()}},{key:"updateInputs",value:function(e){var t=this;if(this.inputs=e,void 0!==this.componentRef){var i=this.componentRef.instance;this.componentFactory.inputs.forEach(function(o){var n=o.propName;t.unobserveInput(n);var r=e[n];e.hasOwnProperty(n)&&(r instanceof Ne.y?t.observeInput(n,r):t.setInputValue(i,n,r))}),"function"==typeof i.onUpdateInputs&&i.onUpdateInputs()}}},{key:"setInputValue",value:function(e,t,i){if(i!==e[t]){var o=Object.getPrototypeOf(e),n=Object.getOwnPropertyDescriptor(o,t);void 0!==n&&void 0!==n.set?n.set.call(e,i):e[t]=i}}},{key:"updateSubscribers",value:function(e){var t=this;if(this.subscribers=e,void 0!==this.componentRef){var i=this.componentRef.instance;this.componentFactory.outputs.forEach(function(o){var n=o.propName;if(e.hasOwnProperty(n)){var r=i[n],a=e[n];Array.isArray(a)?a.forEach(function(e){t.subscriptions.push(r.subscribe(e))}):t.subscriptions.push(r.subscribe(a))}})}}},{key:"observeInput",value:function(e,t){var i=this;this.inputs$$[e]=t.subscribe(function(t){var o=i.componentRef.instance;i.setInputValue(o,e,t),"function"==typeof o.onUpdateInputs&&o.onUpdateInputs()})}},{key:"unobserveInput",value:function(e){void 0!==this.inputs$$[e]&&(this.inputs$$[e].unsubscribe(),this.inputs$$[e]=void 0)}},{key:"unobserveAllInputs",value:function(){Object.values(this.inputs$$).forEach(function(e){void 0!==e&&e.unsubscribe()}),this.inputs$$={}}},{key:"unsubscribeAll",value:function(){this.subscriptions.forEach(function(e){return e.unsubscribe()}),this.subscriptions=[]}}]),e}(),So=function(){var e=function(){function e(t){m(this,e),this.resolver=t}return y(e,[{key:"create",value:function(e){var t=this.resolver.resolveComponentFactory(e);return new xo(t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(w._Vd))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),ko=["target"];function Co(e,t){}var To=function(){var e=function(){function e(t,i){m(this,e),this.dynamicComponentService=t,this.cdRef=i,this.inputs={},this.subscribers={}}return y(e,[{key:"ngOnChanges",value:function(e){var t=e.component,i=e.inputs,o=e.subscribers,n=K.objectsAreEquivalent;if(t&&t.currentValue){if(t.currentValue!==t.previousValue)this.createComponent(t.currentValue);else{var r=i&&n(i.currentValue||{},i.previousValue||{}),a=o&&n(o.currentValue||{},o.previousValue||{});!1===r&&this.updateInputs(),!1===a&&this.updateSubscribers()}this.cdRef.detectChanges()}}},{key:"ngOnDestroy",value:function(){this.dynamicComponent&&this.dynamicComponent.destroy()}},{key:"createComponent",value:function(e){void 0!==this.dynamicComponent&&this.dynamicComponent.destroy(),this.dynamicComponent=e instanceof xo?e:this.dynamicComponentService.create(e),this.renderComponent()}},{key:"renderComponent",value:function(){this.updateInputs(),this.updateSubscribers(),this.dynamicComponent.setTarget(this.target)}},{key:"updateInputs",value:function(){this.dynamicComponent.updateInputs(this.inputs)}},{key:"updateSubscribers",value:function(){this.dynamicComponent.updateSubscribers(this.subscribers)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(So),w.Y36(w.sBO))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-dynamic-outlet"]],viewQuery:function(e,t){var i;(1&e&&w.Gf(ko,7,w.s_b),2&e)&&(w.iGM(i=w.CRH())&&(t.target=i.first))},inputs:{component:"component",inputs:"inputs",subscribers:"subscribers"},features:[w.TTD],decls:2,vars:0,consts:[["target",""]],template:function(e,t){1&e&&w.YNc(0,Co,0,0,"ng-template",null,0,w.W1O)},styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}"],changeDetection:0}),e}(),Ao=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez]]}),e}(),Lo=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({providers:[So],imports:[[F.ez,Ao],Ao]}),e}(),Zo=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[]]}),e}(),Fo=["buttons"],Oo=["*",[["","formButtons",""]]],Mo=function(e){return{"igo-form-body-with-buttons":e}},Io=["*","[formButtons]"],Po=function(){var e=function(){function e(){m(this,e),this.autocomplete="off",this.submitForm=new w.vpe}return y(e,[{key:"hasButtons",get:function(){return 0!==this.buttons.nativeElement.children.length}},{key:"ngOnChanges",value:function(e){var t=e.formData;t&&t.currentValue!==t.previousValue&&(void 0===t.currentValue?this.clear():this.setData(t.currentValue))}},{key:"onSubmit",value:function(){this.submitForm.emit(this.getData())}},{key:"getData",value:function(){var e=this,t={};return function(e){return e.groups.reduce(function(e,t){return e.concat(t.fields)},[].concat(e.fields))}(this.form).forEach(function(i){e.updateDataWithFormField(t,i)}),t}},{key:"setData",value:function(e){this.form.fields.forEach(function(t){t.control.setValue((0,$e.ZP)(e,t.name).safeObject)}),this.form.groups.forEach(function(t){t.fields.forEach(function(t){t.control.setValue((0,$e.ZP)(e,t.name).safeObject)})})}},{key:"updateDataWithFormField",value:function(e,t){var i=t.control;i.disabled||(e[t.name]=i.value)}},{key:"clear",value:function(){this.form.control.reset()}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-form"]],viewQuery:function(e,t){var i;(1&e&&w.Gf(Fo,7),2&e)&&(w.iGM(i=w.CRH())&&(t.buttons=i.first))},inputs:{form:"form",formData:"formData",autocomplete:"autocomplete"},outputs:{submitForm:"submitForm"},features:[w.TTD],ngContentSelectors:Io,decls:7,vars:5,consts:[[3,"autocomplete","formGroup","ngSubmit"],[1,"igo-form-body",3,"ngClass"],[1,"igo-form-content"],[1,"igo-form-buttons"],["buttons",""]],template:function(e,t){1&e&&(w.F$t(Oo),w.TgZ(0,"form",0),w.NdJ("ngSubmit",function(){return t.onSubmit()}),w.TgZ(1,"div",1),w.TgZ(2,"div",2),w.Hsn(3),w.qZA(),w.TgZ(4,"div",3,4),w.Hsn(6,1),w.qZA(),w.qZA(),w.qZA()),2&e&&(w.Q6J("autocomplete",t.autocomplete)("formGroup",t.form.control),w.xp6(1),w.Q6J("ngClass",w.VKq(3,Mo,t.hasButtons)))},directives:[We._Y,We.JL,We.sg,F.mk],styles:["[_nghost-%COMP%]{display:block}form[_ngcontent-%COMP%]{width:100%;height:100%}.igo-form-body[_ngcontent-%COMP%], .igo-form-content[_ngcontent-%COMP%]{height:100%}.igo-form-body-with-buttons[_ngcontent-%COMP%]   .igo-form-content[_ngcontent-%COMP%]{height:calc(100% - 56px)}.igo-form-content[_ngcontent-%COMP%]{display:flex}"],changeDetection:0}),e}(),_o=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,We.u5,We.UX],We.u5,We.UX]}),e}(),qo=function(){var e=function(){function e(t){m(this,e),this.formBuilder=t}return y(e,[{key:"form",value:function(e,t){var i=this.formBuilder.group({});return e.forEach(function(e){i.addControl(e.name,e.control)}),t.forEach(function(e){i.addControl(e.name,e.control)}),{fields:e,groups:t,control:i}}},{key:"group",value:function(e,t){var i=e.options||{},o=this.formBuilder.group({});if(t.forEach(function(e){o.addControl(e.name,e.control)}),i.validator){var n=this.getValidators(i.validator);o.setValidators(n)}return Object.assign({},e,{fields:t,control:o})}},{key:"field",value:function(e){var t=e.options||{},i=this.formBuilder.control({value:"",disabled:t.disabled});if(t.validator){var o=this.getValidators(t.validator);i.setValidators(o)}return Object.assign({type:"text"},e,{control:i})}},{key:"extendFieldConfig",value:function(e,t){var i=Object.assign({},e.options||{},t.options||{}),o=Object.assign({},e.inputs||{},t.inputs||{}),n=Object.assign({},e.subscribers||{},t.subscribers||{});return Object.assign({},e,{options:i,inputs:o,subscribers:n})}},{key:"getValidators",value:function(e){var t=this;return Array.isArray(e)?e.map(function(e){return t.getValidator(e)}):this.getValidator(e)}},{key:"getValidator",value:function(e){if("string"!=typeof e)return e;var t=e.match(/^([a-zA-Z]{3,15})\((.{0,20})\)$/);return t?We.kI[t[1]](t[2]):We.kI[e]}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(We.qu))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Do=function(){var e=function(){function e(){m(this,e)}return y(e,[{key:"getFieldByType",value:function(t){return e.fields[t]}}],[{key:"register",value:function(t,i){e.fields[t]=i}}]),e}();return e.fields={},e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function Eo(e,t){if(1&e&&(w.ynx(0),w._UZ(1,"igo-dynamic-outlet",1),w.BQk()),2&e){var i=w.oxw();w.xp6(1),w.Q6J("component",i.getFieldComponent())("inputs",i.getFieldInputs())("subscribers",i.getFieldSubscribers())}}var $o=function(){var e=function(){function e(t){m(this,e),this.formFieldService=t,this.fieldInputs=void 0,this.fieldSubscribers=void 0}return y(e,[{key:"fieldOptions",get:function(){return this.field.options||{}}},{key:"getFieldComponent",value:function(){return this.formFieldService.getFieldByType(this.field.type||"text")}},{key:"getFieldInputs",value:function(){if(void 0!==this.fieldInputs)return this.fieldInputs;var e=this.fieldOptions.errors||{};return this.fieldInputs=Object.assign({placeholder:this.field.title,disableSwitch:this.fieldOptions.disableSwitch||!1},Object.assign({},this.field.inputs||{}),{formControl:this.field.control,errors:Object.assign({},{required:"igo.common.form.errors.required"},e)}),this.fieldInputs}},{key:"getFieldSubscribers",value:function(){return void 0!==this.fieldSubscribers||(this.fieldSubscribers=Object.assign({},this.field.subscribers||{})),this.fieldSubscribers}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Do))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-form-field"]],inputs:{field:"field"},decls:1,vars:1,consts:[[4,"ngIf"],[3,"component","inputs","subscribers"]],template:function(e,t){1&e&&w.YNc(0,Eo,2,3,"ng-container",0),2&e&&w.Q6J("ngIf",void 0!==t.field)},directives:[F.O5,To],styles:["mat-form-field{width:100%}  .igo-form-disable-switch{margin-right:8px}"],changeDetection:0}),e}(),Ro=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,We.u5,We.UX,k.Ps,Ye.lN,ot.c,ze.LD,Se,Ao]]}),e}();function No(e,t){if(1&e&&(w.TgZ(0,"div",5),w._UZ(1,"igo-form-field",6),w.qZA()),2&e){var i=t.$implicit,o=w.oxw(2);w.Q6J("ngClass",o.getFieldNgClass(i)),w.xp6(1),w.Q6J("field",i)}}function Uo(e,t){if(1&e&&(w.TgZ(0,"div",3),w.YNc(1,No,2,2,"div",4),w.qZA()),2&e){var i=w.oxw();w.xp6(1),w.Q6J("ngForOf",i.group.fields)}}function Jo(e,t){if(1&e&&(w.TgZ(0,"mat-error"),w._uU(1),w.ALo(2,"translate"),w.qZA()),2&e){var i=w.oxw();w.xp6(1),w.Oqu(w.lcZ(2,1,i.getErrorMessage()))}}var Bo=["*"],jo=function(){var e=function(){function e(){m(this,e)}return y(e,[{key:"formControl",get:function(){return this.group.control}},{key:"getFieldColSpan",value:function(e){var t=2,i=e.options||{};return i.cols&&i.cols>0&&(t=Math.min(i.cols,2)),t}},{key:"getFieldNgClass",value:function(e){return u({},"igo-form-field-colspan-".concat(this.getFieldColSpan(e)),!0)}},{key:"getErrorMessage",value:function(){return function(e,t){var i=Object.keys(e.errors||{}).map(function(e){return t[e]}).filter(function(e){return void 0!==e});return i.length>0?i[0]:""}(this.formControl,(this.group.options||{}).errors||{})}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-form-group"]],inputs:{group:"group",errors:"errors"},ngContentSelectors:Bo,decls:4,vars:2,consts:[["class","igo-form-group-fields",4,"ngIf"],[1,"igo-form-group-extra-content"],[4,"ngIf"],[1,"igo-form-group-fields"],["class","igo-form-field-wrapper",3,"ngClass",4,"ngFor","ngForOf"],[1,"igo-form-field-wrapper",3,"ngClass"],[3,"field"]],template:function(e,t){1&e&&(w.F$t(),w.YNc(0,Uo,2,1,"div",0),w.TgZ(1,"div",1),w.Hsn(2),w.qZA(),w.YNc(3,Jo,3,3,"mat-error",2)),2&e&&(w.Q6J("ngIf",t.group&&t.group.fields.length>0),w.xp6(3),w.Q6J("ngIf",t.formControl.errors))},directives:[F.O5,F.sg,F.mk,$o,Ye.TO],pipes:[ae.X$],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:block;overflow:auto;padding:10px 5px}.igo-form-field-wrapper[_ngcontent-%COMP%]{display:inline-block;padding:0 5px}.igo-form-field-colspan-2[_ngcontent-%COMP%]{width:100%}.igo-form-field-colspan-1[_ngcontent-%COMP%]{width:50%}"],changeDetection:0}),e}(),Qo=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,Ye.lN,Se,Ro]]}),e}(),Go=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({providers:[qo,Do],imports:[[F.ez,Qo,Ro],_o,Qo,Ro]}),e}(),Yo=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,We.u5,ze.LD]]}),e}(),zo=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[]]}),e}(),Vo=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[rt.TU]]}),e}(),Ho=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[]]}),e}(),Wo=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,He.p0,tt.Bb,et.JX,k.Ps,S.ot,M.p9,rt.TU,ze.LD,zo,bo,Vo,Ho,Se,We.u5,We.UX,ot.c,it.FA,L.AV]]}),e}(),Xo=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez],Yo,Wo,Vo]}),e}(),Ko=function(){var e=function(){function e(t,i){m(this,e),this.http=t,this.configService=i,this.jsonURL=this.getPathToConfigFile()}return y(e,[{key:"loadConfigTour",value:function(){var e=this;this.getJSON().subscribe(function(t){e.allToursOptions=t},function(e){throw new Error("Problem with Interactive tour configuration file: interactiveTour.json not find. Check if the file and is path is set correctly.")})}},{key:"getPathToConfigFile",value:function(){return this.configService.getConfig("interactiveTour.pathToConfigFile")||"./config/interactiveTour.json"}},{key:"getJSON",value:function(){return this.http.get(this.jsonURL).pipe((0,q.K)(function(e){throw e.error.caught=!0,e}))}},{key:"getTourOptionData",value:function(e){if(void 0!==this.allToursOptions){var t=e;return t=t.replace(/\s/g,""),this.allToursOptions[t]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(P.eN),w.LFG(he))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac}),e}(),en=function(){var e=function(){function e(t,i,o,n,r){m(this,e),this.configService=t,this.mediaService=i,this.languageService=o,this.interactiveTourLoader=n,this.shepherdService=r,this.nextIndex=1,this.isAppHaveTour()&&this.interactiveTourLoader.loadConfigTour()}return y(e,[{key:"isAppHaveTour",value:function(){var e=this.configService.getConfig("interactiveTour.activateInteractiveTour");return void 0===e||e}},{key:"isToolHaveTourConfig",value:function(e){return void 0!==this.interactiveTourLoader.getTourOptionData(e)}},{key:"disabledTourButton",value:function(e){var t=this.interactiveTourLoader.getTourOptionData(e);if(null==t?void 0:t.conditions){var i,o=p(null==t?void 0:t.conditions);try{for(o.s();!(i=o.n()).done;){var n=i.value;if(null===document.querySelector(n))return!0}}catch(r){o.e(r)}finally{o.f()}}return!1}},{key:"isMobile",value:function(){return this.mediaService.isMobile()}},{key:"isTourDisplayInMobile",value:function(){return void 0===this.configService.getConfig("interactiveTour.tourInMobile")||this.configService.getConfig("interactiveTour.tourInMobile")}},{key:"getButtons",value:function(e){return"noBackButton"===e?[{classes:"shepherd-button-primary",text:this.languageService.translate.instant("igo.common.interactiveTour.nextButton"),type:"next"}]:"first"===e?[{classes:"shepherd-button-secondary",text:this.languageService.translate.instant("igo.common.interactiveTour.exitButton"),type:"cancel"},{classes:"shepherd-button-primary",text:this.languageService.translate.instant("igo.common.interactiveTour.nextButton"),type:"next"}]:"last"===e?[{classes:"shepherd-button-secondary",text:this.languageService.translate.instant("igo.common.interactiveTour.backButton"),type:"back"},{classes:"shepherd-button-primary",text:this.languageService.translate.instant("igo.common.interactiveTour.exitButton"),type:"cancel"}]:[{classes:"shepherd-button-secondary",text:this.languageService.translate.instant("igo.common.interactiveTour.backButton"),type:"back"},{classes:"shepherd-button-primary",text:this.languageService.translate.instant("igo.common.interactiveTour.nextButton"),type:"next"}]}},{key:"getAction",value:function(e){return{click:"click"}[e.toLowerCase()]}},{key:"addProgress",value:function(){var e=this,t=0,i=setInterval(function(){if(e.getCurrentStep()){if(e.getCurrentStep().options.attachTo.element&&!document.querySelector(e.getCurrentStep().options.attachTo.element))return e.cancel(),void clearInterval(i);var o=e.getCurrentStep().getElement();o&&o.querySelectorAll(".shepherd-content, .shepherd-text").forEach(function(e){e.classList.add("mat-typography")});var n=o?o.querySelector(".shepherd-header"):void 0;if(t++,(n||t>21)&&clearInterval(i),n){var r=e.steps,a=document.createElement("span");a.className="shepherd-progress",a.innerText="".concat(r.indexOf(e.getCurrentStep())+1,"/").concat(r.length),n.insertBefore(a,o.querySelector(".shepherd-cancel-icon"))}}},100)}},{key:"checkNext",value:function(e,t,i){if(t.getCurrentStep()){if(t.getCurrentStep().options.attachTo.element&&document.querySelector(t.getCurrentStep().options.attachTo.element))return void t.complete();if(e.index===t.steps.length-1)return void t.complete();t.steps.splice(e.index,1);var o=t.steps[e.index];o.options.attachTo.element&&!document.querySelector(o.options.attachTo.element)?i.checkNext(e,t,i):(t._setupModal(),t.show(o.id))}}},{key:"executeAction",value:function(e,t){if(!(!t||t.condition&&("!"===t.condition.charAt(0)&&document.querySelector(t.condition.slice(1))||"!"!==t.condition.charAt(0)&&!document.querySelector(t.condition)))){var i=document.querySelector(t.element||e.element),o=this.getAction(t.action);i&&o&&i[o]()}}},{key:"executeActionPromise",value:function(e,t){var i=this;return new Promise(function(o){if(i.executeAction(e,t),t&&t.waitFor)var n=0,r=t.maxWait?t.maxWait/100:20,a=setInterval(function(){(++n>r||document.querySelector(t.waitFor))&&(clearInterval(a),o())},100);else o()})}},{key:"getShepherdSteps",value:function(e){var t,i=this,o=[],n=0,r=p(e.steps);try{var a=function(){var r=t.value;o.push({attachTo:{element:r.element,on:r.position||e.position},popperOptions:{modifiers:[{name:"offset",options:{offset:[0,15]}}]},beforeShowPromise:function(){return Promise.all([i.executeActionPromise(i.previousStep,i.previousStep?i.previousStep.beforeChange:void 0),i.executeActionPromise(r,r.beforeShow)])},buttons:i.getButtons(0===n?"first":n+1===e.steps.length?"last":e.steps[n].noBackButton?"noBackButton":void 0),classes:r.class,highlightClass:r.highlightClass,scrollTo:r.scrollToElement||e.scrollToElement||!0,canClickTarget:r.disableInteraction?!r.disableInteraction:void 0,title:i.languageService.translate.instant(r.title||e.title),text:[i.languageService.translate.instant(r.text)],when:{show:function(){i.executeAction(r,r.onShow)},hide:function(){i.previousStep=r,i.executeAction(r,r.onHide)}}}),n++};for(r.s();!(t=r.n()).done;)a()}catch(s){r.e(s)}finally{r.f()}return o}},{key:"startTour",value:function(e){var t=this,i=this.interactiveTourLoader.getTourOptionData(e);this.shepherdService.defaultStepOptions={classes:i.class,highlightClass:i.highlightClass,canClickTarget:!i.disableInteraction||!i.disableInteraction,cancelIcon:{enabled:!0}};var o=this.getShepherdSteps(i);this.shepherdService.modal=!0,this.shepherdService.confirmCancel=!1,this.shepherdService.addSteps(o),this.shepherdService.tourObject.on("show",this.addProgress),this.shepherdService.tourObject.on("cancel",function(e){t.checkNext(e,t.shepherdService.tourObject,t)}),this.shepherdService.start()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(he),w.LFG(Pe),w.LFG(Ce),w.LFG(Ko),w.LFG(dt.a))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),tn=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m(this,e),this.options=t,this.activeTool$=new R.X(void 0),this.toolbar$=new R.X([]),this.activeToolHistory=[],this.store=new At([],{getKey:function(e){return e.name}}),this.setToolbar(t.toolbar),this.initStore()}return y(e,[{key:"tools$",get:function(){return this.store.entities$}},{key:"destroy",value:function(){this.activeTool$$.unsubscribe(),this.store.destroy()}},{key:"getTool",value:function(e){return this.store.get(e)}},{key:"getTools",value:function(){return this.store.all()}},{key:"setTools",value:function(e){this.store.load(e)}},{key:"getToolbar",value:function(){return this.toolbar$.getValue()}},{key:"setToolbar",value:function(e){this.toolbar$.next(e||[])}},{key:"activateTool",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.getTool(e);void 0!==i&&this.store.state.update(i,{active:!0,options:t},!0)}},{key:"activatePreviousTool",value:function(){if(this.activeToolHistory.length<=1)this.deactivateTool();else{var e=h(this.activeToolHistory.splice(-2,2),2),t=e[0];e[1];this.activateTool(t)}}},{key:"deactivateTool",value:function(){this.clearActiveToolHistory(),this.store.state.updateAll({active:!1})}},{key:"initStore",value:function(){var e=this;this.store=new At([],{getKey:function(e){return e.name}}),this.activeTool$$=this.store.stateView.firstBy$(function(e){return!0===e.state.active}).subscribe(function(t){if(void 0!==t){var i=t.entity,o=Object.assign({},i.options||{},t.state.options||{});e.setActiveTool(Object.assign({},i,{options:o}))}else e.setActiveTool(void 0)})}},{key:"setActiveTool",value:function(e){this.activeTool$.next(e),void 0===e?this.clearActiveToolHistory():this.activeToolHistory=this.activeToolHistory.filter(function(t){return t!==e.name}).concat([e.name])}},{key:"clearActiveToolHistory",value:function(){this.activeToolHistory=[]}}]),e}(),on=function(){var e=function(){function e(){m(this,e),this.toolbox=new tn,this.toolbox.setTools(this.getTools())}return y(e,[{key:"getTool",value:function(t){return e.tools[t]}},{key:"getTools",value:function(){return Object.values(e.tools)}}],[{key:"register",value:function(t){e.tools[t.name]=t}}]),e}();return e.tools={},e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function nn(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",1),w.NdJ("click",function(){return w.CHM(i),w.oxw().startInteractiveTour()}),w.TgZ(1,"span",2),w._uU(2),w.ALo(3,"translate"),w.ALo(4,"translate"),w.ALo(5,"async"),w.qZA(),w._UZ(6,"mat-icon",3),w.ALo(7,"translate"),w.ALo(8,"translate"),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("ngClass",o.getClass())("disabled",o.disabledTourButton),w.xp6(2),w.AsE("",w.lcZ(3,5,"igo.common.interactiveTour.buttonTitle")," ",w.lcZ(4,7,w.lcZ(5,9,o.discoverTitleInLocale$)),""),w.xp6(4),w.Q6J("matTooltip",o.disabledTourButton?w.lcZ(7,11,"igo.common.interactiveTour.disaledTooltipTourToolButton"):w.lcZ(8,13,"igo.common.interactiveTour.tooltipTourToolButton"))}}var rn=function(){var e=function(){function e(t,i){m(this,e),this.interactiveTourService=t,this.toolService=i,this.tourToStart="",this.discoverTitleInLocale$=(0,U.of)("IGO")}return y(e,[{key:"getClass",value:function(){return{"tour-button-tool-icon":"icon"===this.styleButton,"tour-button-tool":"raised"===this.styleButton}}},{key:"toolbox",get:function(){return this.toolService.toolbox}},{key:"getTourToStart",value:function(){return this.tourToStart?this.tourToStart:this.activeToolName}},{key:"activeToolName",get:function(){if(this.toolbox)return this.isActiveTool?this.toolbox.activeTool$.getValue().name:"global"}},{key:"isActiveTool",get:function(){if(this.toolbox)return void 0!==this.toolbox.activeTool$.getValue()}},{key:"isToolHaveTour",get:function(){return!("about"===this.activeToolName&&!this.tourToStart)&&this.interactiveTourService.isToolHaveTourConfig(this.getTourToStart())}},{key:"showTourButton",get:function(){var e;return!1!==this.isToolHaveTour&&!(this.interactiveTourService.isMobile()&&(e=this.isTourDisplayInMobile,!1===e))}},{key:"isTourDisplayInMobile",get:function(){return this.interactiveTourService.isTourDisplayInMobile()}},{key:"disabledTourButton",get:function(){return this.interactiveTourService.disabledTourButton(this.activeToolName)}},{key:"startInteractiveTour",value:function(){var e=this.getTourToStart();e&&this.interactiveTourService.startTour(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(en),w.Y36(on))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-interactive-tour"]],inputs:{tourToStart:"tourToStart",styleButton:"styleButton",discoverTitleInLocale$:"discoverTitleInLocale$"},decls:1,vars:1,consts:[["mat-raised-button","","tooltip-position","below","matTooltipShowDelay","500",3,"ngClass","disabled","click",4,"ngIf"],["mat-raised-button","","tooltip-position","below","matTooltipShowDelay","500",3,"ngClass","disabled","click"],[1,"interactive-tour-button-title"],["svgIcon","presentation-play",3,"matTooltip"]],template:function(e,t){1&e&&w.YNc(0,nn,9,15,"button",0),2&e&&w.Q6J("ngIf",t.showTourButton)},directives:[F.O5,S.lW,F.mk,k.Hw,L.gM],pipes:[ae.X$,F.Ov],styles:[".shepherd-has-title .shepherd-content .shepherd-header{padding:.5em .75em}.shepherd-title{margin:0!important;font-weight:revert!important}.shepherd-progress{margin-right:15px;color:#737373}.shepherd-text{font-size:14px!important}.shepherd-element{border:1px solid;border-color:#474747;box-shadow:4px 5px #65656599}\n"],encapsulation:2}),e}(),an=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({providers:[en,Ko],imports:[[F.ez,k.Ps,S.ot,L.AV,Se]]}),e}(),sn=function(){var e=function(){function e(){m(this,e)}return y(e,[{key:"transform",value:function(e,t){var i=[];return Object.getOwnPropertyNames(e).forEach(function(t){return i.push({key:t,value:e[t]})}),i}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=w.Yjl({name:"keyvalue",type:e,pure:!0}),e}(),ln=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[]]}),e}(),cn=function(){var e=function(){function e(t,i){m(this,e),this.renderer=t,this.el=i,this._color="primary",this._focused=!1,this._selected=!1,this._disabled=!1,this.beforeSelect=new w.vpe,this.beforeFocus=new w.vpe,this.beforeUnselect=new w.vpe,this.beforeUnfocus=new w.vpe,this.beforeDisable=new w.vpe,this.beforeEnable=new w.vpe,this.focus=new w.vpe,this.unfocus=new w.vpe,this.select=new w.vpe,this.unselect=new w.vpe,this.disable=new w.vpe,this.enable=new w.vpe}return y(e,[{key:"color",get:function(){return this._color},set:function(e){this._color=e}},{key:"focused",get:function(){return this._focused},set:function(e){e!==this._focused&&(this.disabled||(e?this.beforeFocus.emit(this):this.beforeUnfocus.emit(this),this._focused=e,!0!==this.selected&&this.toggleFocusedClass(),e?this.focus.emit(this):this.unfocus.emit(this)))}},{key:"selected",get:function(){return this._selected},set:function(e){e!==this._selected&&(this.disabled||(e?this.beforeSelect.emit(this):this.beforeUnselect.emit(this),this._selected=e,this._focused=e,this.toggleSelectedClass(),e?this.select.emit(this):this.unselect.emit(this)))}},{key:"disabled",get:function(){return this._disabled},set:function(e){e!==this._disabled&&(!0===e&&(this.selected=!1),e?this.beforeDisable.emit(this):this.beforeEnable.emit(this),this._disabled=e,this.toggleDisabledClass(),e?this.disable.emit(this):this.enable.emit(this))}},{key:"onClick",value:function(){this.selected=!0}},{key:"getOffsetTop",value:function(){return this.el.nativeElement.offsetTop-5}},{key:"toggleFocusedClass",value:function(){this.focused?this.addCls(e.focusedCls):this.removeCls(e.focusedCls)}},{key:"toggleSelectedClass",value:function(){this.selected?(this.addCls(e.selectedCls),this.removeCls(e.focusedCls)):this.removeCls(e.selectedCls)}},{key:"toggleDisabledClass",value:function(){this.disabled?this.addCls(e.disabledCls):this.removeCls(e.disabledCls)}},{key:"addCls",value:function(e){this.renderer.addClass(this.el.nativeElement,e)}},{key:"removeCls",value:function(e){this.renderer.removeClass(this.el.nativeElement,e)}}]),e}();return e.focusedCls="igo-list-item-focused",e.selectedCls="igo-list-item-selected",e.disabledCls="igo-list-item-disabled",e.\u0275fac=function(t){return new(t||e)(w.Y36(w.Qsj),w.Y36(w.SBq))},e.\u0275dir=w.lG2({type:e,selectors:[["","igoListItem",""]],hostBindings:function(e,t){1&e&&w.NdJ("click",function(){return t.onClick()})},inputs:{color:"color",focused:"focused",selected:"selected",disabled:"disabled"},outputs:{beforeSelect:"beforeSelect",beforeFocus:"beforeFocus",beforeUnselect:"beforeUnselect",beforeUnfocus:"beforeUnfocus",beforeDisable:"beforeDisable",beforeEnable:"beforeEnable",focus:"focus",unfocus:"unfocus",select:"select",unselect:"unselect",disable:"disable",enable:"enable"}}),e}(),un=function(e){return{selectable:e}},pn=["*"],dn=function(){var e=function(){function e(t){m(this,e),this.el=t,this._navigation=!0,this._selection=!0,this.subscriptions=[]}return y(e,[{key:"navigation",get:function(){return this._navigation},set:function(e){this._navigation=e}},{key:"selection",get:function(){return this._selection},set:function(e){this._selection=e}},{key:"selectedItem",get:function(){return this._selectedItem},set:function(e){this.focusedItem=e,this._selectedItem=e}},{key:"focusedItem",get:function(){return this._focusedItem},set:function(e){this._focusedItem=e}},{key:"handleKeyboardEvent",value:function(e){this.navigationEnabled&&("ArrowUp"===e.key||"ArrowDown"===e.key?(e.preventDefault(),this.navigate(e.key)):"Enter"===e.key&&this.select(this.focusedItem))}},{key:"ngOnInit",value:function(){this.enableNavigation()}},{key:"ngAfterViewInit",value:function(){var e=this;this.listItems.length&&this.init(),this.listItems$$=this.listItems.changes.subscribe(function(t){return e.init()})}},{key:"ngOnDestroy",value:function(){this.listItems$$.unsubscribe()}},{key:"focus",value:function(e){!this.selection||(this.unfocus(),void 0!==e&&(e.focused=!0))}},{key:"unfocus",value:function(){void 0!==this.focusedItem&&(this.focusedItem.focused=!1),this.focusedItem=void 0}},{key:"focusNext",value:function(){var e,t=this.listItems.toArray(),i=this.el.nativeElement,o=!0,n=this.getFocusedIndex();for(void 0===n&&(n=-1);o&&n<t.length-1;)o=(e=t[n+=1]).disabled;void 0!==e&&this.focus(e),t[n+1]?void 0!==e&&!this.isScrolledIntoView(e.el.nativeElement)&&(i.scrollTop=e.el.nativeElement.offsetTop+e.el.nativeElement.children[0].offsetHeight-i.clientHeight):i.scrollTop=i.scrollHeight-i.clientHeight}},{key:"focusPrevious",value:function(){for(var e,t=this.listItems.toArray(),i=this.el.nativeElement,o=!0,n=this.getFocusedIndex();o&&n>0;)o=(e=t[n-=1]).disabled;void 0!==e&&this.focus(e),t[n-1]?void 0===e||this.isScrolledIntoView(e.el.nativeElement)||(i.scrollTop=e.el.nativeElement.offsetTop-3):i.scrollTop=0}},{key:"select",value:function(e){!this.selection||(this.unselect(),void 0!==e&&(e.selected=!0))}},{key:"unselect",value:function(){this.unfocus(),void 0!==this.selectedItem&&(this.selectedItem.selected=!1),this.selectedItem=void 0}},{key:"enableNavigation",value:function(){this.navigation&&(this.navigationEnabled=!0)}},{key:"disableNavigation",value:function(){this.navigationEnabled=!1}},{key:"scrollToItem",value:function(e){this.el.nativeElement.scrollTop=e.getOffsetTop()}},{key:"isScrolledIntoView",value:function(e){var t=this.el.nativeElement.scrollTop+this.el.nativeElement.offsetTop,i=e.offsetTop;return i+e.children[0].offsetHeight<=t+this.el.nativeElement.clientHeight&&i>=t}},{key:"init",value:function(){this.subscribe(),this.selectedItem=this.findSelectedItem(),this.focusedItem=this.findFocusedItem(),this.enableNavigation()}},{key:"subscribe",value:function(){var e=this;this.unsubscribe(),this.listItems.toArray().forEach(function(t){e.subscriptions.push(t.beforeSelect.subscribe(function(t){return e.handleItemBeforeSelect(t)})),e.subscriptions.push(t.select.subscribe(function(t){return e.handleItemSelect(t)})),e.subscriptions.push(t.beforeFocus.subscribe(function(t){return e.handleItemBeforeFocus(t)})),e.subscriptions.push(t.focus.subscribe(function(t){return e.handleItemFocus(t)}))},this)}},{key:"unsubscribe",value:function(){this.subscriptions.forEach(function(e){return e.unsubscribe()}),this.subscriptions=[]}},{key:"handleItemBeforeFocus",value:function(e){e!==this.focusedItem&&this.unfocus()}},{key:"handleItemFocus",value:function(e){this.focusedItem=e}},{key:"handleItemBeforeSelect",value:function(e){e!==this.focusedItem&&this.unselect()}},{key:"handleItemSelect",value:function(e){this.selectedItem=e}},{key:"findSelectedItem",value:function(){return this.listItems.toArray().find(function(e){return e.selected})}},{key:"findFocusedItem",value:function(){return this.listItems.toArray().find(function(e){return e.focused})}},{key:"getFocusedIndex",value:function(){var e=this;return this.listItems.toArray().findIndex(function(t){return t===e.focusedItem})}},{key:"navigate",value:function(e){switch(e){case"ArrowUp":this.focusPrevious();break;case"ArrowDown":this.focusNext()}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(w.SBq))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-list"]],contentQueries:function(e,t,i){var o;(1&e&&w.Suo(i,cn,5),2&e)&&(w.iGM(o=w.CRH())&&(t.listItems=o))},hostBindings:function(e,t){1&e&&w.NdJ("keydown",function(e){return t.handleKeyboardEvent(e)},!1,w.evT)("enter",function(e){return t.handleKeyboardEvent(e)},!1,w.evT)},inputs:{navigation:"navigation",selection:"selection"},ngContentSelectors:pn,decls:2,vars:3,consts:[["igoClickout","",3,"ngClass","clickout","click"]],template:function(e,t){1&e&&(w.F$t(),w.TgZ(0,"mat-list",0),w.NdJ("clickout",function(){return t.disableNavigation()})("click",function(){return t.enableNavigation()}),w.Hsn(1),w.qZA()),2&e&&w.Q6J("ngClass",w.VKq(1,un,t.selection))},directives:[C.i$,so,F.mk],styles:["[_nghost-%COMP%]{display:block;height:100%;overflow:auto;position:relative}mat-list[_ngcontent-%COMP%]{padding-top:0}[_nghost-%COMP%]{position:static}[_nghost-%COMP%]     .mat-list .mat-list-item .mat-list-text>*{white-space:normal;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;max-height:36px;line-height:18px;-webkit-box-orient:vertical;-webkit-line-clamp:2}[_nghost-%COMP%]     .mat-list .mat-list-item.mat-list-item-avatar .mat-list-item-content{display:-webkit-flex;height:46px;padding:3px}[_nghost-%COMP%]     .mat-list .mat-list-item.mat-list-item-avatar{height:46px}[_nghost-%COMP%]     .mat-list   igo-collapsible>.mat-list-item>.mat-list-item-content>.mat-list-text>.mat-line{font-weight:bold;opacity:.9}[_nghost-%COMP%]     .mat-list .mat-list-item.mat-list-item-avatar .mat-list-item-content>mat-icon{padding:8px}[_nghost-%COMP%]     [igolistitem] mat-list-item [mat-list-avatar]{height:auto;width:40px}[_nghost-%COMP%]   mat-list.selectable[_ngcontent-%COMP%]     [igolistitem]:not(.igo-list-item-disabled) mat-list-item:hover{cursor:pointer}[_nghost-%COMP%]     [igolistitem]:focus{outline:none}"]}),e}(),hn=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,k.Ps,C.ie,lo]]}),e}();function gn(e,t){if(1&e&&(w.TgZ(0,"div",2),w.TgZ(1,"h3"),w.Hsn(2,1),w.TgZ(3,"div",3),w._uU(4),w.Hsn(5,2),w.qZA(),w.Hsn(6,3),w.qZA(),w.qZA()),2&e){var i=w.oxw();w.xp6(4),w.hij(" ",i.title," ")}}var fn=["*",[["","panelLeftButton",""]],[["","panelHeader",""]],[["","panelRightButton",""]]],mn=["*","[panelLeftButton]","[panelHeader]","[panelRightButton]"],vn=function(){var e=function(){function e(){m(this,e),this._withHeader=!0}return y(e,[{key:"title",get:function(){return this._title},set:function(e){this._title=e}},{key:"withHeader",get:function(){return this._withHeader},set:function(e){this._withHeader=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-panel"]],hostVars:2,hostBindings:function(e,t){2&e&&w.ekj("igo-panel-with-header",t.withHeader)},inputs:{title:"title",withHeader:"withHeader"},ngContentSelectors:mn,decls:3,vars:1,consts:[["class","igo-panel-header mat-typography","title","",4,"ngIf"],["title","",1,"igo-panel-content"],["title","",1,"igo-panel-header","mat-typography"],[1,"igo-panel-title"]],template:function(e,t){1&e&&(w.F$t(fn),w.YNc(0,gn,7,1,"div",0),w.TgZ(1,"div",1),w.Hsn(2),w.qZA()),2&e&&w.Q6J("ngIf",t.withHeader)},directives:[F.O5],styles:["[_nghost-%COMP%]{display:block}.igo-panel-header[_ngcontent-%COMP%]{height:46px;padding:3px;text-align:center}.igo-panel-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;height:40px}.igo-panel-header[_ngcontent-%COMP%]     [panelleftbutton]{float:left;margin-right:-40px}.igo-panel-header[_ngcontent-%COMP%]     [panelrightbutton]{float:right}.igo-panel-content[_ngcontent-%COMP%]{overflow:auto}.igo-panel-with-header[_nghost-%COMP%]   .igo-panel-content[_ngcontent-%COMP%]{height:calc(100% - 46px)}[_nghost-%COMP%]:not(.igo-panel-with-header)   .igo-panel-content[_ngcontent-%COMP%]{height:100%}.igo-panel-title[_ngcontent-%COMP%]{display:block;width:calc(100% - 80px);margin-left:40px;height:100%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;line-height:40px;float:left;font-weight:bold;font-size:1.17em}"],changeDetection:0}),e}(),yn=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez]]}),e}(),bn=function(e){return{"igo-spinner-container":!0,"igo-spinner-shown":e}},wn=function(){var e=function(){function e(){m(this,e),this.shown$=new R.X(!1)}return y(e,[{key:"shown",get:function(){return this.shown$.value},set:function(e){this.shown$.next(e)}},{key:"show",value:function(){this.shown=!0}},{key:"hide",value:function(){this.shown=!1}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-spinner"]],inputs:{shown:"shown"},decls:4,vars:5,consts:[[3,"ngClass"],[1,"igo-spinner-background"],["diameter","40","mode","indeterminate"]],template:function(e,t){1&e&&(w.TgZ(0,"div",0),w.ALo(1,"async"),w._UZ(2,"div",1),w._UZ(3,"mat-progress-spinner",2),w.qZA()),2&e&&w.Q6J("ngClass",w.VKq(3,bn,w.lcZ(1,1,t.shown$)))},directives:[F.mk,ht.Ou],pipes:[F.Ov],styles:[".igo-spinner-container[_ngcontent-%COMP%]{display:none;pointer-events:none}.igo-spinner-container.igo-spinner-shown[_ngcontent-%COMP%]{display:block}mat-progress-spinner[_ngcontent-%COMP%]{height:40px;width:40px;border-radius:50%}.igo-spinner-background[_ngcontent-%COMP%]{height:36px;width:36px;border-radius:50%;border:4px solid #ffffff;position:absolute;top:2px;left:2px}"]}),e}(),xn=function(){var e=function(){function e(t,i){m(this,e),this.spinner=t,this.activityService=i}return y(e,[{key:"ngOnInit",value:function(){var e=this;this.counter$$=this.activityService.counter$.pipe((0,E.b)(50)).subscribe(function(t){t>0?e.spinner.show():e.spinner.hide()})}},{key:"ngOnDestroy",value:function(){this.counter$$.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(wn,2),w.Y36(ce))},e.\u0275dir=w.lG2({type:e,selectors:[["","igoSpinnerActivity",""]]}),e}(),Sn=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,ht.Cq]]}),e}(),kn=function(e){o(i,e);var t=r(i);function i(e,o,n){var r;return m(this,i),(r=t.call(this))._database=e,r._model=o,r._sort=n,r._filterChange=new R.X(""),r}return y(i,[{key:"filter",get:function(){return this._filterChange.value},set:function(e){this._filterChange.next(e)}},{key:"connect",value:function(){var e=this;return this._database?(0,Je.T)(this._database.dataChange,this._filterChange,this._sort.sortChange).pipe((0,D.U)(function(){return e.getFilteredData(e._database.data)}),(0,D.U)(function(t){return e.getSortedData(t)})):(0,Je.T)([])}},{key:"disconnect",value:function(){}},{key:"getFilteredData",value:function(e){var t=this;return this.filter?e.slice().filter(function(e){return-1!==t._model.columns.filter(function(e){return e.filterable}).map(function(t){return K.resolve(e,t.name)}).join(" ").toLowerCase().indexOf(t.filter.toLowerCase())}):e}},{key:"getSortedData",value:function(e){var t=this;return this._sort.active&&""!==this._sort.direction?e.sort(function(e,i){var o=K.resolve(e,t._sort.active),n=K.resolve(i,t._sort.active);return K.naturalCompare(n,o,t._sort.direction)}):e}}]),i}(ft.o2),Cn=function(){return(e=Cn||(Cn={}))[e.primary=0]="primary",e[e.accent=1]="accent",e[e.warn=2]="warn",Cn;var e}(),Tn=["filter"];function An(e,t){1&e&&(w.TgZ(0,"div",12),w.TgZ(1,"mat-form-field",13),w._UZ(2,"input",14,15),w.ALo(4,"translate"),w.qZA(),w.qZA()),2&e&&(w.xp6(2),w.Q6J("placeholder",w.lcZ(4,1,"igo.common.table.filter")))}function Ln(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"th",16),w.TgZ(1,"mat-checkbox",17),w.NdJ("change",function(e){w.CHM(i);var t=w.oxw();return e?t.masterToggle():null}),w.qZA(),w.qZA()}if(2&e){var o=w.oxw();w.xp6(1),w.Q6J("checked",o.selection.hasValue()&&o.isAllSelected())("indeterminate",o.selection.hasValue()&&!o.isAllSelected())}}function Zn(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"td",18),w.TgZ(1,"mat-checkbox",19),w.NdJ("click",function(e){return e.stopPropagation()})("change",function(e){var t=w.CHM(i).$implicit,o=w.oxw();return e?o.selection.toggle(t):null}),w.qZA(),w.qZA()}if(2&e){var o=t.$implicit,n=w.oxw();w.xp6(1),w.Q6J("checked",n.selection.isSelected(o))}}function Fn(e,t){if(1&e&&(w.TgZ(0,"th",25),w._uU(1),w.qZA()),2&e){var i=w.oxw(2).$implicit;w.xp6(1),w.hij(" ",i.title," ")}}function On(e,t){1&e&&(w.ynx(0),w.YNc(1,Fn,2,1,"th",24),w.BQk())}function Mn(e,t){if(1&e&&(w.TgZ(0,"th",16),w._uU(1),w.qZA()),2&e){var i=w.oxw(2).$implicit;w.xp6(1),w.hij(" ",i.title," ")}}function In(e,t){1&e&&(w.ynx(0),w.YNc(1,Mn,2,1,"th",6),w.BQk())}var Pn=function(){return{}};function _n(e,t){if(1&e&&(w.TgZ(0,"td",27),w._uU(1),w.qZA()),2&e){var i=t.$implicit,o=w.oxw(2).$implicit,n=w.oxw();w.Q6J("ngClass",n.model.cellClassFunc?n.model.cellClassFunc(i,o):w.DdM(2,Pn)),w.xp6(1),w.hij(" ",n.getValue(i,o.name)," ")}}function qn(e,t){1&e&&(w.ynx(0),w.YNc(1,_n,2,3,"td",26),w.BQk())}function Dn(e,t){if(1&e&&w._UZ(0,"td",29),2&e){var i=t.$implicit,o=w.oxw(2).$implicit,n=w.oxw();w.Q6J("ngClass",n.model.cellClassFunc?n.model.cellClassFunc(i,o):w.DdM(2,Pn))("innerHTML",n.getValue(i,o.name),w.oJD)}}function En(e,t){1&e&&w.YNc(0,Dn,1,3,"td",28)}function $n(e,t){if(1&e&&(w.ynx(0,20),w.YNc(1,On,2,0,"ng-container",21),w.YNc(2,In,2,0,"ng-container",21),w.YNc(3,qn,2,0,"ng-container",22),w.YNc(4,En,1,0,"ng-template",null,23,w.W1O),w.BQk()),2&e){var i=t.$implicit,o=w.MAs(5);w.Q6J("matColumnDef",i.name),w.xp6(1),w.Q6J("ngIf",i.sortable),w.xp6(1),w.Q6J("ngIf",!i.sortable),w.xp6(1),w.Q6J("ngIf",!i.html)("ngIfElse",o)}}function Rn(e,t){1&e&&w._UZ(0,"th",16)}function Nn(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",31),w.NdJ("click",function(e){var t=w.CHM(i).$implicit,o=w.oxw().$implicit;return w.oxw().handleClickAction(e,t,o)}),w._UZ(1,"mat-icon",32),w.qZA()}if(2&e){var o=t.$implicit,n=w.oxw(2);w.Q6J("color",n.getActionColor(o.color)),w.xp6(1),w.s9C("svgIcon",o.icon)}}function Un(e,t){if(1&e&&(w.TgZ(0,"td",18),w.YNc(1,Nn,2,2,"button",30),w.qZA()),2&e){var i=w.oxw();w.xp6(1),w.Q6J("ngForOf",i.model.actions)}}function Jn(e,t){1&e&&w._UZ(0,"tr",33)}function Bn(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"tr",34),w.NdJ("click",function(){var e=w.CHM(i).$implicit;return w.oxw().selection.toggle(e)}),w.qZA()}if(2&e){var o=t.$implicit,n=w.oxw();w.Q6J("ngClass",n.model.rowClassFunc?n.model.rowClassFunc(o):w.DdM(1,Pn))}}var jn=function(){var e=function(){function e(){m(this,e),this._hasFIlterInput=!0,this.selection=new ft.Ov(!0,[]),this.select=new w.vpe}return y(e,[{key:"database",get:function(){return this._database},set:function(e){this._database=e}},{key:"model",get:function(){return this._model},set:function(e){this._model=e}},{key:"hasFilterInput",get:function(){return this._hasFIlterInput},set:function(e){this._hasFIlterInput=e}},{key:"ngOnInit",value:function(){var e=this;this.dataSource=new kn(this.database,this.model,this.sort),this.model&&(this.displayedColumns=this.model.columns.filter(function(e){return!1!==e.displayed}).map(function(e){return e.name}),this.model.selectionCheckbox&&this.displayedColumns.unshift("selectionCheckbox"),this.model.actions&&this.model.actions.length&&this.displayedColumns.push("action")),this.selection.changed.subscribe(function(t){return e.select.emit(t)})}},{key:"ngAfterViewInit",value:function(){var e=this;this.filter&&(0,B.R)(this.filter.nativeElement,"keyup").pipe((0,E.b)(150),(0,G.x)()).subscribe(function(){!e.dataSource||(e.dataSource.filter=e.filter.nativeElement.value)})}},{key:"ngOnChanges",value:function(e){e.database&&(this.dataSource=new kn(this.database,this.model,this.sort),this.selection.clear())}},{key:"getActionColor",value:function(e){return Cn[e]}},{key:"getValue",value:function(e,t){return K.resolve(e,t)}},{key:"isAllSelected",value:function(){return this.selection.selected.length===this.database.data.length}},{key:"masterToggle",value:function(){var e=this;this.isAllSelected()?this.selection.clear():this.database.data.forEach(function(t){return e.selection.select(t)})}},{key:"handleClickAction",value:function(e,t,i){e.stopPropagation(),t.click(i)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-table"]],viewQuery:function(e,t){var i;(1&e&&(w.Gf(Tn,5),w.Gf(et.YE,7)),2&e)&&(w.iGM(i=w.CRH())&&(t.filter=i.first),w.iGM(i=w.CRH())&&(t.sort=i.first))},inputs:{database:"database",model:"model",hasFilterInput:"hasFilterInput"},outputs:{select:"select"},features:[w.TTD],decls:14,vars:5,consts:[[1,"table-box"],["class","table-header",4,"ngIf"],[1,"table-container"],["mat-table","","matSort","",3,"dataSource"],["table",""],["matColumnDef","selectionCheckbox"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"ngClass","click",4,"matRowDef","matRowDefColumns"],[1,"table-header"],["floatPlaceholder","never"],["matInput","",3,"placeholder"],["filter",""],["mat-header-cell",""],[3,"checked","indeterminate","change"],["mat-cell",""],[3,"checked","click","change"],[3,"matColumnDef"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["cellHTML",""],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell","","class","mat-cell-text",3,"ngClass",4,"matCellDef"],["mat-cell","",1,"mat-cell-text",3,"ngClass"],["mat-cell","","class","mat-cell-text",3,"ngClass","innerHTML",4,"matCellDef"],["mat-cell","",1,"mat-cell-text",3,"ngClass","innerHTML"],["mat-mini-fab","",3,"color","click",4,"ngFor","ngForOf"],["mat-mini-fab","",3,"color","click"],[3,"svgIcon"],["mat-header-row",""],["mat-row","",3,"ngClass","click"]],template:function(e,t){1&e&&(w.TgZ(0,"div",0),w.YNc(1,An,5,3,"div",1),w.TgZ(2,"div",2),w.TgZ(3,"table",3,4),w.ynx(5,5),w.YNc(6,Ln,2,2,"th",6),w.YNc(7,Zn,2,1,"td",7),w.BQk(),w.YNc(8,$n,6,5,"ng-container",8),w.ynx(9,9),w.YNc(10,Rn,1,0,"th",6),w.YNc(11,Un,2,1,"td",7),w.BQk(),w.YNc(12,Jn,1,0,"tr",10),w.YNc(13,Bn,1,2,"tr",11),w.qZA(),w.qZA(),w.qZA()),2&e&&(w.xp6(1),w.Q6J("ngIf",t.hasFilterInput),w.xp6(2),w.Q6J("dataSource",t.dataSource),w.xp6(5),w.Q6J("ngForOf",t.model.columns),w.xp6(4),w.Q6J("matHeaderRowDef",t.displayedColumns),w.xp6(1),w.Q6J("matRowDefColumns",t.displayedColumns))},directives:[F.O5,He.BZ,et.YE,He.w1,He.fO,He.Dz,F.sg,He.as,He.nj,Ye.KE,ot.Nt,He.ge,M.oG,He.ev,et.nU,F.mk,S.lW,k.Hw,He.XQ,He.Gk],pipes:[ae.X$],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:block}.table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;overflow:auto;flex:1 1 auto}.table-box[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}.table-header[_ngcontent-%COMP%]{min-height:64px;max-width:500px;display:flex;flex:0 1 auto;align-items:baseline;padding:8px 24px 0;font-size:20px;justify-content:space-between}tr[mat-header-row][_ngcontent-%COMP%], tr[mat-row][_ngcontent-%COMP%]{height:60px}.mat-cell-text[_ngcontent-%COMP%]{overflow:hidden;word-wrap:break-word}td[mat-cell][_ngcontent-%COMP%]{padding-right:15px}th.mat-header-cell[_ngcontent-%COMP%]{padding-right:5px}button[_ngcontent-%COMP%]{margin-right:10px}"]}),e}(),Qn=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,We.u5,gt.HT,k.Ps,S.ot,He.p0,Ye.lN,ot.c,et.JX,M.p9,Se]]}),e}(),Gn=function(e){o(i,e);var t=r(i);function i(){return m(this,i),t.apply(this,arguments)}return i}(At),Yn=function(){return(e=Yn||(Yn={})).White="white",e.Grey="grey",e.Primary="primary",Yn;var e}();function zn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"300ms",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ease-in-out";return(0,mt.X$)("toolSlideInOut",[(0,mt.SB)("enter",(0,mt.oB)({transform:"translate3d(0, 0, 0)"})),(0,mt.eR)("void => enter",(0,mt.jt)(e+" "+t))])}function Vn(e,t){if(1&e&&(w._UZ(0,"igo-actionbar",2),w.ALo(1,"async"),w.ALo(2,"async"),w.ALo(3,"async")),2&e){var i=w.oxw();w.Q6J("store",i.actionStore)("withIcon",!0)("withTitle",w.lcZ(1,6,i.toolbarWithTitle$))("withTooltip",!1===w.lcZ(2,8,i.toolbarWithTitle$))("scrollActive",w.lcZ(3,10,i.toolbarWithTitle$))("horizontal",!1)}}var Hn=function(e,t){return{"igo-tool-container-with-toolbar":e,"igo-tool-container-with-animation":t}};function Wn(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",3),w.NdJ("@toolSlideInOut.start",function(){return w.CHM(i),w.oxw().onAnimationStart()})("@toolSlideInOut.done",function(){return w.CHM(i),w.oxw().onAnimationComplete()}),w.ALo(1,"async"),w._UZ(2,"igo-dynamic-outlet",4),w.qZA()}if(2&e){var o=t.ngIf,n=w.oxw();w.Q6J("ngClass",w.WLB(6,Hn,!n.actionStore.empty,n.animate))("@toolSlideInOut",w.lcZ(1,4,n.animation$)),w.xp6(2),w.Q6J("component",o.component)("inputs",n.getToolInputs(o))}}var Xn=function(){var e=function(){function e(){m(this,e),this.activeTool$=new R.X(void 0),this.actionStore=new Gn([]),this.animation$=new R.X("none"),this.toolbar$=new R.X([]),this.toolbarWithTitle$=this.activeTool$.pipe((0,D.U)(function(e){return void 0===e})),this.animating$=new R.X(!1),this.animate=!1,this.color=Yn.White}return y(e,[{key:"classColorGrey",get:function(){return this.color===Yn.Grey}},{key:"classColorPrimary",get:function(){return this.color===Yn.Primary}},{key:"ngOnInit",value:function(){var e=this;this.toolbar$$=this.toolbox.toolbar$.subscribe(function(t){return e.onToolbarChange(t)}),this.activeTool$$=this.toolbox.activeTool$.subscribe(function(t){return e.onActiveToolChange(t)})}},{key:"ngOnDestroy",value:function(){this.toolbar$$.unsubscribe(),this.activeTool$$.unsubscribe(),this.actionStore.destroy()}},{key:"onAnimationStart",value:function(){this.animating$.next(!0)}},{key:"onAnimationComplete",value:function(){this.animating$.next(!1)}},{key:"getToolInputs",value:function(e){return e.options||{}}},{key:"onToolbarChange",value:function(e){this.setToolbar(e)}},{key:"onActiveToolChange",value:function(e){var t=this;this.animate?this.onAnimate(function(){return t.setActiveTool(e)}):this.setActiveTool(e)}},{key:"setActiveTool",value:function(e){if(void 0===e)this.actionStore.state.updateAll({active:!1});else{var t=this.actionStore.get(e.name);void 0!==t&&this.actionStore.state.update(t,{active:!0},!0)}this.activeTool$.next(e),this.animate&&this.animation$.next("enter")}},{key:"setToolbar",value:function(e){var t=this,i=e.reduce(function(e,i){var o=t.toolbox.getTool(i);return void 0===o||e.push({id:o.name,title:o.title,icon:o.icon,tooltip:o.tooltip,args:[o,t.toolbox],handler:function(e,t){t.activateTool(e.name)},ngClass:function(e,i){return t.toolbox.activeTool$.pipe((0,D.U)(function(t){var i=!1;void 0!==t&&e.name===t.name&&(i=!0);var o=!1;return void 0!==t&&e.name===t.parent&&(o=!0),{"tool-activated":i,"children-tool-activated":o}}))}}),e},[]);this.actionStore.load(i),this.toolbar$.next(e)}},{key:"onAnimate",value:function(e){var t=this;this.unAnimate(),this.animating$$=this.animating$.subscribe(function(i){i||(e.call(t),t.unAnimate())})}},{key:"unAnimate",value:function(){this.animating$$&&this.animating$$.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-toolbox"]],hostVars:4,hostBindings:function(e,t){2&e&&w.ekj("color-grey",t.classColorGrey)("color-primary",t.classColorPrimary)},inputs:{toolbox:"toolbox",animate:"animate",color:"color"},decls:4,vars:6,consts:[[3,"store","withIcon","withTitle","withTooltip","scrollActive","horizontal",4,"ngIf"],["class","igo-tool-container",3,"ngClass",4,"ngIf"],[3,"store","withIcon","withTitle","withTooltip","scrollActive","horizontal"],[1,"igo-tool-container",3,"ngClass"],[3,"component","inputs"]],template:function(e,t){1&e&&(w.YNc(0,Vn,4,12,"igo-actionbar",0),w.ALo(1,"async"),w.YNc(2,Wn,3,9,"div",1),w.ALo(3,"async")),2&e&&(w.Q6J("ngIf",w.lcZ(1,2,t.toolbar$).length>0),w.xp6(2),w.Q6J("ngIf",w.lcZ(3,4,t.activeTool$)))},directives:[F.O5,io,F.mk,To],pipes:[F.Ov],styles:["[_nghost-%COMP%]{display:block;position:relative;overflow:hidden;width:100%;height:100%}.igo-tool-container[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0}.igo-tool-container-with-animation[_ngcontent-%COMP%]{transform:translate(100%)}.igo-tool-container-with-toolbar[_ngcontent-%COMP%]{left:50px}igo-actionbar[_ngcontent-%COMP%]{height:100%}igo-actionbar.with-title[_ngcontent-%COMP%]{width:100%;overflow:auto}igo-actionbar[_ngcontent-%COMP%]:not(.with-title){width:48px;overflow:hidden;-o-box-shadow:2px 0px 2px 0px #dddddd;box-shadow:2px 0 2px #ddd}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){igo-actionbar[_ngcontent-%COMP%]:not(.with-title){overflow:auto}}igo-dynamic-outlet[_ngcontent-%COMP%]{overflow:auto}"],data:{animation:[zn()]},changeDetection:0}),e}(),Kn=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,no,Lo]]}),e}(),er=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[on]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez],Kn]}),e}();function tr(e,t){if(1&e&&w._UZ(0,"igo-dynamic-outlet",1),2&e){var i=w.oxw();w.Q6J("component",i.widget)("inputs",i.inputs)("subscribers",i.getEffectiveSubscribers())}}var ir=function(){var e=function(){function e(){var t=this;m(this,e),this.baseSubscribers={cancel:function(e){return t.onCancel(e)},complete:function(e){return t.onComplete(e)}},this.subscribers={},this.complete=new w.vpe,this.cancel=new w.vpe}return y(e,[{key:"ngOnDestroy",value:function(){this.destroyWidget()}},{key:"getEffectiveSubscribers",value:function(){var e=this,t=Object.assign({},this.subscribers);return Object.keys(this.baseSubscribers).forEach(function(i){var o=t[i],n=e.baseSubscribers[i];t[i]=void 0!==o?function(e){o(e),n(e)}:n}),t}},{key:"onCancel",value:function(e){this.cancel.emit(e),this.destroyWidget()}},{key:"onComplete",value:function(e){this.complete.emit(e),this.destroyWidget()}},{key:"destroyWidget",value:function(){void 0!==this.widget&&this.widget.destroy(),this.widget=void 0}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-widget-outlet"]],inputs:{widget:"widget",inputs:"inputs",subscribers:"subscribers"},outputs:{complete:"complete",cancel:"cancel"},decls:1,vars:1,consts:[[3,"component","inputs","subscribers",4,"ngIf"],[3,"component","inputs","subscribers"]],template:function(e,t){1&e&&w.YNc(0,tr,1,3,"igo-dynamic-outlet",0),2&e&&w.Q6J("ngIf",t.widget)},directives:[F.O5,To],styles:["igo-dynamic-outlet[_ngcontent-%COMP%]{height:100%}"],changeDetection:0}),e}(),or=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,Lo]]}),e}(),nr=function(){var e=function(){function e(t){m(this,e),this.dynamicComponentService=t}return y(e,[{key:"create",value:function(e){return this.dynamicComponentService.create(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(So))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),rr=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({providers:[nr],imports:[[F.ez,or],or]}),e}(),ar=function(){var e=function(){function e(){m(this,e),this.selectedChange=new w.vpe}return y(e,[{key:"getWorkspaceTitle",value:function(e){return St(e)}},{key:"onSelectedChange",value:function(e){var t=e.value;this.store.activateWorkspace(t),this.selectedChange.emit({selected:!0,value:t})}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-workspace-selector"]],inputs:{store:"store",disabled:"disabled"},outputs:{selectedChange:"selectedChange"},decls:1,vars:4,consts:[[3,"store","multi","titleAccessor","disabled","selectedChange"]],template:function(e,t){1&e&&(w.TgZ(0,"igo-entity-selector",0),w.NdJ("selectedChange",function(e){return t.onSelectedChange(e)}),w.qZA()),2&e&&w.Q6J("store",t.store)("multi",!1)("titleAccessor",t.getWorkspaceTitle)("disabled",t.disabled)},directives:[_t],styles:["igo-entity-selector[_ngcontent-%COMP%]     mat-form-field .mat-form-field-infix{padding:0}igo-entity-selector[_ngcontent-%COMP%]     mat-form-field .mat-form-field-wrapper{padding-bottom:1.75em}"],changeDetection:0}),e}(),sr=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,Yo]]}),e}();function lr(e,t){if(1&e){var i=w.EpF();w.ynx(0),w.TgZ(1,"igo-widget-outlet",1),w.NdJ("cancel",function(){var e=w.CHM(i).ngIf;return w.oxw().onWidgetCancel(e)})("complete",function(){var e=w.CHM(i).ngIf;return w.oxw().onWidgetComplete(e)}),w.ALo(2,"async"),w.ALo(3,"async"),w.qZA(),w.BQk()}if(2&e){var o=t.ngIf,n=w.oxw();w.xp6(1),w.Q6J("widget",o)("inputs",w.lcZ(2,3,n.widgetInputs$))("subscribers",w.lcZ(3,5,n.widgetSubscribers$))}}var cr=function(){var e=function(){function e(){m(this,e),this.deactivateWidget=new w.vpe}return y(e,[{key:"widget$",get:function(){return this.workspace.widget$}},{key:"widgetInputs$",get:function(){return this.workspace.widgetInputs$}},{key:"widgetSubscribers$",get:function(){return this.workspace.widgetSubscribers$}},{key:"onWidgetCancel",value:function(e){this.workspace.deactivateWidget(),this.deactivateWidget.emit(e)}},{key:"onWidgetComplete",value:function(e){this.workspace.deactivateWidget(),this.deactivateWidget.emit(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-workspace-widget-outlet"]],inputs:{workspace:"workspace"},outputs:{deactivateWidget:"deactivateWidget"},decls:2,vars:3,consts:[[4,"ngIf"],[3,"widget","inputs","subscribers","cancel","complete"]],template:function(e,t){1&e&&(w.YNc(0,lr,4,7,"ng-container",0),w.ALo(1,"async")),2&e&&w.Q6J("ngIf",w.lcZ(1,1,t.widget$))},directives:[F.O5,ir],pipes:[F.Ov],styles:["igo-widget-outlet[_ngcontent-%COMP%]{height:100%}"],changeDetection:0}),e}(),ur=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,or]]}),e}(),pr=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez],sr,ur]}),e}(),dr=function(){function e(t){m(this,e),this.dataChange=new R.X([]),t&&this.dataChange.next(t)}return y(e,[{key:"data",get:function(){return this.dataChange.value}},{key:"set",value:function(e){this.dataChange.next(e)}},{key:"add",value:function(e){var t=this.data.slice();t.push(e),this.set(t)}},{key:"remove",value:function(e){var t=this.data.slice(),i=t.indexOf(e);t.splice(i,1),this.set(t)}}]),e}();function hr(e){return function(t){on.register(Object.assign({},e,{component:t}))}}var gr=function(e){o(i,e);var t=r(i);function i(){var e;return m(this,i),(e=t.apply(this,arguments)).activeWorkspace$=new R.X(void 0),e}return y(i,[{key:"activateWorkspace",value:function(e){var t=this.activeWorkspace$.value;void 0!==t&&t.deactivate(),this.deactivateWorkspace(),void 0!==e&&(this.state.update(e,{active:!0,selected:!0},!0),this.activeWorkspace$.next(e),e.activate())}},{key:"deactivateWorkspace",value:function(){var e=this.activeWorkspace$.value;void 0!==e&&(e.deactivate(),this.activeWorkspace$.next(void 0))}}]),i}(At),fr=function(){function e(t){m(this,e),this.options=t,this.widget$=new R.X(void 0),this.widgetInputs$=new R.X({}),this.widgetSubscribers$=new R.X({}),this.change=new Q.xQ,this.active$=new R.X(!1)}return y(e,[{key:"id",get:function(){return this.options.id}},{key:"title",get:function(){return this.options.title}},{key:"meta",get:function(){return this.options.meta||{}}},{key:"entityStore",get:function(){return this.options.entityStore}},{key:"actionStore",get:function(){return this.options.actionStore}},{key:"widget",get:function(){return this.widget$.value}},{key:"hasWidget",get:function(){return void 0!==this.widget}},{key:"active",get:function(){return this.active$.value}},{key:"activate",value:function(){var e=this;!0===this.active&&this.deactivate(),this.active$.next(!0),void 0!==this.entityStore&&(this.entities$$=this.entityStore.stateView.all$().subscribe(function(){return e.onStateChange()})),this.change.next()}},{key:"deactivate",value:function(){this.active$.next(!1),this.deactivateWidget(),void 0!==this.entities$$&&this.entities$$.unsubscribe(),void 0!==this.change$&&this.change$.unsubscribe()}},{key:"activateWidget",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.widget$.next(e),this.widgetInputs$.next(t),this.widgetSubscribers$.next(i),this.change.next()}},{key:"deactivateWidget",value:function(){this.widget$.next(void 0),this.change.next()}},{key:"onStateChange",value:function(){this.change.next()}}]),e}(),mr=Z.Bz.forChild([{path:"home",component:function(){var e=function(){function e(t){m(this,e),this.interactiveTourService=t}return y(e,[{key:"startTour",value:function(){this.interactiveTourService.startTour("global")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(en))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-home"]],decls:56,vars:0,consts:[[2,"text-align","center"],["id","igo-title"],["width","180","src","assets/igo2/core/logo.png",1,"igo-logo"],["tourToStart","global","menuIsOpen","true","styleButton","raised"],["target","_blank","rel","noopener","href","https://github.com/infra-geo-ouverte/igo2-lib/blob/master/README.md#user-installation"],["target","_blank","rel","noopener","href","https://angular.io/docs"]],template:function(e,t){1&e&&(w.TgZ(0,"div",0),w.TgZ(1,"h1",1),w._uU(2," Welcome to IGO "),w.qZA(),w._UZ(3,"img",2),w.qZA(),w.TgZ(4,"p"),w._UZ(5,"igo-interactive-tour",3),w.qZA(),w.TgZ(6,"p"),w._uU(7," IGO2 library contains many components and services that may benefit any web application. "),w._UZ(8,"br"),w._uU(9," IGO2 library is open source project using Angular, Angular Material and OpenLayers.\n"),w.qZA(),w.TgZ(10,"h3"),w._uU(11,"IGO2 library is divided into several elements: "),w.qZA(),w.TgZ(12,"ul"),w.TgZ(13,"li"),w.TgZ(14,"b"),w._uU(15,"@igo2/utils"),w.qZA(),w._uU(16," : Basic utilies without dependency (ex: base64, clipboard, uuid)"),w.qZA(),w.TgZ(17,"li"),w.TgZ(18,"b"),w._uU(19,"@igo2/core"),w.qZA(),w._uU(20," : Element affecting the core of the application (ex: config, language, message, media, request)"),w.qZA(),w.TgZ(21,"li"),w.TgZ(22,"b"),w._uU(23,"@igo2/common"),w.qZA(),w._uU(24," : Library containing reusable components (ex: clickout, drag-drop, list, panel, spinner, table)"),w.qZA(),w.TgZ(25,"li"),w.TgZ(26,"b"),w._uU(27,"@igo2/auth"),w.qZA(),w._uU(28," : Library grouping the authentication and security module"),w.qZA(),w.TgZ(29,"li"),w.TgZ(30,"b"),w._uU(31,"@igo2/geo"),w.qZA(),w._uU(32," : Library containing the geomatic components. Depends on Openlayers."),w.qZA(),w.TgZ(33,"li"),w.TgZ(34,"b"),w._uU(35,"@igo2/context"),w.qZA(),w._uU(36," : Library of components uniting @igo2/geo and @igo2/auth"),w.qZA(),w.TgZ(37,"li"),w.TgZ(38,"b"),w._uU(39,"@igo2/integration"),w.qZA(),w._uU(40," : Library integrate basic components"),w.qZA(),w.qZA(),w.TgZ(41,"h2"),w._uU(42,"Here are some links to help you start: "),w.qZA(),w.TgZ(43,"ul"),w.TgZ(44,"li"),w.TgZ(45,"h2"),w.TgZ(46,"a",4),w._uU(47,"Installation"),w.qZA(),w.qZA(),w.qZA(),w.TgZ(48,"li"),w.TgZ(49,"h2"),w.TgZ(50,"a",5),w._uU(51,"Angular Documentation"),w.qZA(),w.qZA(),w.qZA(),w.qZA(),w._uU(52," *** Modules in "),w.TgZ(53,"code"),w._uU(54,"@igo2/core"),w.qZA(),w._uU(55," must be imported only once\n"))},directives:[rn],styles:[""]}),e}()}]),vr=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[mr,an,L.AV,k.Ps,S.ot]]}),e}(),yr=Z.Bz.forChild([{path:"activity",component:function(){var e=function(){function e(t){m(this,e),this.activityService=t,this.idsActivity=[]}return y(e,[{key:"register",value:function(){this.idsActivity.push(this.activityService.register())}},{key:"unregister",value:function(){this.activityService.unregister(this.idsActivity.pop())}},{key:"counter",get:function(){return this.activityService.counter$.value}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(ce))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-activity"]],decls:31,vars:1,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/activity"],["mat-raised-button","",3,"click"],["igoSpinnerActivity",""]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Core"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Activity"),w.qZA(),w.TgZ(5,"mat-card-content"),w.TgZ(6,"p"),w._uU(7,"Register activities in service. Use to display a loading icon"),w.qZA(),w.TgZ(8,"li"),w._uU(9,"Import "),w.TgZ(10,"code"),w._uU(11,"IgoActivityModule"),w.qZA(),w._uU(12," only if you want register http calls"),w.qZA(),w.TgZ(13,"li"),w._uU(14,"Import "),w.TgZ(15,"code"),w._uU(16,"IgoActivityModule"),w.qZA(),w._uU(17," only once"),w.qZA(),w._UZ(18,"br"),w._uU(19," See the "),w.TgZ(20,"a",0),w._uU(21," code of this example"),w.qZA(),w._UZ(22,"hr"),w.qZA(),w.TgZ(23,"mat-card-actions"),w.TgZ(24,"button",1),w.NdJ("click",function(){return t.register()}),w._uU(25,"Register"),w.qZA(),w.TgZ(26,"button",1),w.NdJ("click",function(){return t.unregister()}),w._uU(27,"Unregister"),w.qZA(),w.qZA(),w.TgZ(28,"p"),w._uU(29),w.qZA(),w._UZ(30,"igo-spinner",2),w.qZA()),2&e&&(w.xp6(29),w.hij("Counter: ",t.counter,""))},directives:[O.a8,O.$j,O.n5,O.dn,O.hq,S.lW,wn,xn],styles:[""]}),e}()}]),br=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[yr,O.QW,S.ot,pe.forRoot(),Sn]]}),e}(),wr={production:!0,igo:{projections:[{code:"EPSG:32198",alias:"Quebec Lambert",def:"+proj=lcc +lat_1=60 +lat_2=46 +lat_0=44 +lon_0=-68.5 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs",extent:[-886251.0296,180252.9126,897177.3418,2106143.8139]}],auth:{intern:{enabled:!0},allowAnonymous:!0},interactiveTour:{tourInMobile:!0},importExport:{url:"https://geoegl.msp.gouv.qc.ca/apis/ogre"},language:{prefix:"./locale/"},catalog:{sources:[{id:"Gououvert",title:"Gouvouvert",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi"},{id:"DefiningInfoFormat",title:"Defining info_format",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",queryFormat:{html:"*","application/json":["stations_meteoroutieres","histo_stations_meteoroutieres"]},queryHtmlTarget:"iframe",count:30},{id:"catalogwithregex",title:"Filtered catalog by regex",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",regFilters:["zpegt"]},{id:"catalogwithtooltipcontrol",title:"Controling tooltip format",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",tooltipType:"abstract"}]},searchSources:{nominatim:{enabled:!1},icherche:{searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/icherche",order:2,enabled:!0,params:{limit:"8"}},coordinatesreverse:{showInPointerSummary:!0},icherchereverse:{showInPointerSummary:!0,searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/terrapi",order:3,enabled:!0},ilayer:{searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/layers/search",order:4,enabled:!0,params:{limit:"5"}}}}},xr=Z.Bz.forChild([{path:"config",component:function(){var e=function e(t){m(this,e),this.configService=t,this.configLanguage=this.configService.getConfig("language")};return e.\u0275fac=function(t){return new(t||e)(w.Y36(he))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-config"]],decls:26,vars:3,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/config"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/environments"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Core"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"config"),w.qZA(),w.TgZ(5,"mat-card-content"),w.TgZ(6,"p"),w._uU(7,"Load config in your angular application"),w.qZA(),w.TgZ(8,"li"),w._uU(9,"Import "),w.TgZ(10,"code"),w._uU(11,"IgoConfigModule"),w.qZA(),w._uU(12," only once"),w.qZA(),w._UZ(13,"br"),w._uU(14," See the "),w.TgZ(15,"a",0),w._uU(16," code of this example"),w.qZA(),w._UZ(17,"br"),w._uU(18," See the "),w.TgZ(19,"a",1),w._uU(20," environment config"),w.qZA(),w._UZ(21,"hr"),w.qZA(),w.TgZ(22,"p"),w._uU(23),w.ALo(24,"json"),w.qZA(),w._UZ(25,"p"),w.qZA()),2&e&&(w.xp6(23),w.hij("Config language: ",w.lcZ(24,1,t.configLanguage),""))},directives:[O.a8,O.$j,O.n5,O.dn],pipes:[F.Ts],styles:[""]}),e}()}]),Sr=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({providers:[fe({default:wr.igo})],imports:[[xr,F.ez,O.QW,S.ot,ve.forRoot()]]}),e}(),kr=Z.Bz.forChild([{path:"language",component:function(){var e=function(){function e(t){m(this,e),this.languageService=t,this.app={title:"IGO"}}return y(e,[{key:"changeLanguage",value:function(e){this.languageService.setLanguage(e),console.log(this.languageService)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ce))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-language"]],decls:35,vars:4,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/language"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/environments"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/locale"],["mat-raised-button","",3,"click"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Core"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"language"),w.qZA(),w.TgZ(5,"mat-card-content"),w.TgZ(6,"p"),w._uU(7,"Translate your angular application"),w.qZA(),w.TgZ(8,"li"),w._uU(9,"Import "),w.TgZ(10,"code"),w._uU(11,"IgoLanguageModule"),w.qZA(),w._uU(12," only once"),w.qZA(),w._UZ(13,"br"),w._uU(14," See the "),w.TgZ(15,"a",0),w._uU(16,"code of this example"),w.qZA(),w._UZ(17,"br"),w._uU(18," See language section of the "),w.TgZ(19,"a",1),w._uU(20," environment config"),w.qZA(),w._UZ(21,"br"),w._uU(22," See "),w.TgZ(23,"a",2),w._uU(24,"locale files"),w.qZA(),w._UZ(25,"hr"),w.qZA(),w.TgZ(26,"mat-card-actions"),w.TgZ(27,"button",3),w.NdJ("click",function(){return t.changeLanguage("en")}),w._uU(28,"English"),w.qZA(),w.TgZ(29,"button",3),w.NdJ("click",function(){return t.changeLanguage("fr")}),w._uU(30,"Fran\xe7ais"),w.qZA(),w.qZA(),w.TgZ(31,"p"),w._uU(32),w.ALo(33,"translate"),w.qZA(),w._UZ(34,"p"),w.qZA()),2&e&&(w.xp6(32),w.Oqu(w.xi3(33,1,"welcome",t.app)))},directives:[O.a8,O.$j,O.n5,O.dn,O.hq,S.lW],pipes:[ae.X$],styles:[""]}),e}()}]),Cr=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[kr,O.QW,S.ot,Se.forRoot()]]}),e}(),Tr=Z.Bz.forChild([{path:"media",component:function(){var e=function(){function e(t){m(this,e),this.mediaService=t}return y(e,[{key:"media",get:function(){return this.mediaService.getMedia()}},{key:"orientation",get:function(){return this.mediaService.getOrientation()}},{key:"isTouchScreen",get:function(){return this.mediaService.isTouchScreen()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Pe))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-media"]],decls:19,vars:3,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/media"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Core"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Media"),w.qZA(),w.TgZ(5,"mat-card-content"),w.TgZ(6,"p"),w._uU(7,"Detect type of media (mobile, tablet, desktop)"),w.qZA(),w._UZ(8,"br"),w._uU(9," See the "),w.TgZ(10,"a",0),w._uU(11,"code of this example"),w.qZA(),w._UZ(12,"hr"),w.qZA(),w.TgZ(13,"p"),w._uU(14),w.qZA(),w.TgZ(15,"p"),w._uU(16),w.qZA(),w.TgZ(17,"p"),w._uU(18),w.qZA(),w.qZA()),2&e&&(w.xp6(14),w.hij("Current media: ",t.media,""),w.xp6(2),w.hij("Current orientation: ",t.orientation,""),w.xp6(2),w.hij("Device mode: ",t.isTouchScreen?"Touch device":"Not a touch device ",""))},directives:[O.a8,O.$j,O.n5,O.dn],styles:[""]}),e}()}]),Ar=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[Tr,O.QW]]}),e}(),Lr=Z.Bz.forChild([{path:"message",component:function(){var e=function(){function e(t){m(this,e),this.messageService=t}return y(e,[{key:"success",value:function(){this.messageService.success("Congratulations","Success")}},{key:"info",value:function(){this.messageService.info("Welcome to IGO","Info")}},{key:"alert",value:function(){this.messageService.alert("Warning","Alert")}},{key:"error",value:function(){this.messageService.error("There is a bug","Error")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ae))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-message"]],decls:29,vars:0,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/message"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","accent",3,"click"],["mat-raised-button","","color","warn",3,"click"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Core"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Message"),w.qZA(),w.TgZ(5,"mat-card-content"),w.TgZ(6,"p"),w._uU(7,"Show message to user."),w.qZA(),w.TgZ(8,"li"),w._uU(9,"Import "),w.TgZ(10,"code"),w._uU(11,"IgoMessageModule"),w.qZA(),w._uU(12," only once"),w.qZA(),w.TgZ(13,"li"),w._uU(14,"Dependencies: BrowserAnimationsModule "),w.qZA(),w._UZ(15,"br"),w._uU(16," See the "),w.TgZ(17,"a",0),w._uU(18,"code of this example"),w.qZA(),w._UZ(19,"hr"),w.qZA(),w.TgZ(20,"mat-card-actions"),w.TgZ(21,"button",1),w.NdJ("click",function(){return t.success()}),w._uU(22,"Success message"),w.qZA(),w.TgZ(23,"button",2),w.NdJ("click",function(){return t.info()}),w._uU(24,"Info message"),w.qZA(),w.TgZ(25,"button",3),w.NdJ("click",function(){return t.alert()}),w._uU(26,"Alert message"),w.qZA(),w.TgZ(27,"button",4),w.NdJ("click",function(){return t.error()}),w._uU(28,"Error message"),w.qZA(),w.qZA(),w.qZA())},directives:[O.a8,O.$j,O.n5,O.dn,O.hq,S.lW],styles:[""]}),e}()}]),Zr=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[Lr,O.QW,S.ot,ke.forRoot()]]}),e}(),Fr=Z.Bz.forChild([{path:"request",component:function(){var e=function(){function e(t,i){m(this,e),this.http=t,this.languageService=i}return y(e,[{key:"callHttp",value:function(){this.http.get("https://geoegl.msp.gouv.qc.ca/apis/icherche/info").subscribe(function(e){console.log(e)})}},{key:"callHttpError",value:function(){this.http.get("404").subscribe(function(e){console.log(e)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(P.eN),w.Y36(Ce))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-request"]],decls:30,vars:0,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/core/request"],["mat-raised-button","",3,"click"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Core"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Request"),w.qZA(),w.TgZ(5,"mat-card-content"),w.TgZ(6,"p"),w._uU(7,"Register http calls in console"),w.qZA(),w.TgZ(8,"li"),w._uU(9,"Import "),w.TgZ(10,"code"),w._uU(11,"IgoLoggingModule"),w.qZA(),w._uU(12," only if you want register http calls in console"),w.qZA(),w.TgZ(13,"li"),w._uU(14,"Import "),w.TgZ(15,"code"),w._uU(16,"IgoErrorModule"),w.qZA(),w._uU(17," only if you want register errors from http call in console"),w.qZA(),w.TgZ(18,"li"),w._uU(19,"Import modules only once"),w.qZA(),w._UZ(20,"br"),w._uU(21," See the "),w.TgZ(22,"a",0),w._uU(23,"code of this example"),w.qZA(),w._UZ(24,"hr"),w.qZA(),w.TgZ(25,"mat-card-actions"),w.TgZ(26,"button",1),w.NdJ("click",function(){return t.callHttp()}),w._uU(27,"Log"),w.qZA(),w.TgZ(28,"button",1),w.NdJ("click",function(){return t.callHttpError()}),w._uU(29,"Error"),w.qZA(),w.qZA(),w.qZA())},directives:[O.a8,O.$j,O.n5,O.dn,O.hq,S.lW],styles:[""]}),e}()}]),Or=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[Fr,O.QW,S.ot,P.JF,Se.forRoot(),Ze.forRoot()]]}),e}();function Mr(e,t){if(1&e&&w._UZ(0,"igo-actionbar",4),2&e){var i=w.oxw();w.Q6J("store",i.store)("withIcon",!0)("horizontal",!0)("mode","context")}}var Ir=Z.Bz.forChild([{path:"action",component:function(){var e=function(){function e(t,i,o){m(this,e),this.overlay=t,this.mediaService=i,this.languageService=o,this.store=new Gn([]),this.added$=new R.X(!1)}return y(e,[{key:"actionbarMode",get:function(){return this.mediaService.media$.value===Me.Desktop&&this.mediaService.orientation$.value===Ie.Landscape?$i.Dock:$i.Overlay}},{key:"ngOnInit",value:function(){var e=this;this.store.load([{id:"add",title:"Add",icon:"plus",tooltip:"Add Tooltip",handler:function(){alert("Add!"),e.added$.next(!0)}},{id:"edit",title:"Edit",icon:"pencil",tooltip:"Edit Tooltip",args:["1"],handler:function(e){alert("Edit item ".concat(e,"!"))},availability:function(){return e.added$}},{id:"delete",title:"Delete",tooltip:"Delete Tooltip",icon:"delete",handler:function(){alert("Delete!"),e.added$.next(!1)},availability:function(){return e.added$}}])}},{key:"ngOnDestroy",value:function(){this.store.destroy()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(lt.aV),w.Y36(Pe),w.Y36(Ce))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-action"]],decls:19,vars:6,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/action"],[3,"store","withIcon","withTitle","horizontal","mode"],[3,"igoContextMenu"],["actionbarMenu",""],[3,"store","withIcon","horizontal","mode"]],template:function(e,t){if(1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Common"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Action"),w.qZA(),w.TgZ(5,"mat-card-content"),w._uU(6," See the "),w.TgZ(7,"a",0),w._uU(8,"code of this example"),w.qZA(),w.qZA(),w._UZ(9,"igo-actionbar",1),w.qZA(),w._UZ(10,"p"),w.TgZ(11,"mat-card",2),w.TgZ(12,"mat-card-subtitle"),w._uU(13,"Common"),w.qZA(),w.TgZ(14,"mat-card-title"),w._uU(15,"Action context-menu"),w.qZA(),w._UZ(16,"div"),w.qZA(),w.YNc(17,Mr,1,4,"ng-template",null,3,w.W1O)),2&e){var i=w.MAs(18);w.xp6(9),w.Q6J("store",t.store)("withIcon",!0)("withTitle","overlay"===t.actionbarMode)("horizontal",!0)("mode",t.actionbarMode),w.xp6(2),w.Q6J("igoContextMenu",i)}},directives:[O.a8,O.$j,O.n5,O.dn,io,vo],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e}()}]),Pr=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[Ir,S.ot,O.QW,no,yo]]}),e}(),_r=function(){var e=function(){function e(t){m(this,e),this.cdRef=t}return y(e,[{key:"onUpdateInputs",value:function(){this.cdRef.detectChanges()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(w.sBO))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-salutation-component"]],inputs:{name:"name"},decls:2,vars:1,template:function(e,t){1&e&&(w.TgZ(0,"p"),w._uU(1),w.qZA()),2&e&&(w.xp6(1),w.hij("Hello, my name is ",t.name,"."))},encapsulation:2,changeDetection:0}),e}(),qr=function(){var e=function(){function e(t){m(this,e),this.cdRef=t}return y(e,[{key:"onUpdateInputs",value:function(){this.cdRef.detectChanges()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(w.sBO))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-explanation-component"]],decls:2,vars:0,template:function(e,t){1&e&&(w.TgZ(0,"p"),w._uU(1,"I am a dynamic component, rendered into an IgoDynamicOutlet."),w.qZA())},encapsulation:2,changeDetection:0}),e}(),Dr=Z.Bz.forChild([{path:"dynamic-component",component:function(){var e=function(){function e(){m(this,e),this.component=_r,this.inputs={name:"Bob"}}return y(e,[{key:"toggleComponent",value:function(){this.component=this.component===_r?qr:_r}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-dynamic-component"]],decls:12,vars:2,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/dynamic-component"],[3,"component","inputs"],["mat-flat-button","","color","primary",3,"click"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Common"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Dynamic Component"),w.qZA(),w.TgZ(5,"mat-card-content"),w._uU(6," See the "),w.TgZ(7,"a",0),w._uU(8,"code of this example"),w.qZA(),w.qZA(),w._UZ(9,"igo-dynamic-outlet",1),w.TgZ(10,"button",2),w.NdJ("click",function(){return t.toggleComponent()}),w._uU(11,"Toggle Component"),w.qZA(),w.qZA()),2&e&&(w.xp6(9),w.Q6J("component",t.component)("inputs",t.inputs))},directives:[O.a8,O.$j,O.n5,O.dn,To,S.lW],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e}()}]),Er=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[Dr,S.ot,O.QW,Lo]]}),e}(),$r=Z.Bz.forChild([{path:"entity-table",component:function(){var e=function(){function e(t){var i=this;m(this,e),this.languageService=t,this.store=new At([]),this.entitySortChange$=new R.X(!1),this.paginatorOptions={pageSize:10},this.template={selection:!0,selectionCheckbox:!0,selectMany:!0,sort:!0,valueAccessor:function(e,t){return wt(e,t)},columns:[{name:"selected",title:"Selected",valueAccessor:function(e){return i.store.state.get(e).selected?"radiobox-marked":"radiobox-blank"},renderer:vt.Icon},{name:"id",title:"ID"},{name:"name",title:"Name"},{name:"description",title:"Description",renderer:vt.HTML},{name:"url",title:"Hyperlink"},{name:"image",title:"Image"},{name:"action",title:"",valueAccessor:function(e){return[{icon:"home",color:"warn",click:function(e){console.log(e)}}]},renderer:vt.ButtonGroup}]}}return y(e,[{key:"ngOnInit",value:function(){var e=[2,1,3,4,5,6,7,8,9,10,11,12,13].map(function(e){return{id:e,name:"Name ".concat(e),description:"<b>Description ".concat(e,"</b>"),url:"https://igouverte.org",image:"https://www.igouverte.org/assets/img/Igo_logoavec.png"}});this.store.load(e)}},{key:"entitySortChange",value:function(){this.entitySortChange$.next(!0)}},{key:"paginatorChange",value:function(e){this.paginator=e}},{key:"ngOnDestroy",value:function(){this.store.destroy()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ce))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-entity-table"]],decls:10,vars:4,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/entity-table"],[3,"store","withPaginator","paginatorOptions","template","entitySortChange"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Common"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Entity Table"),w.qZA(),w.TgZ(5,"mat-card-content"),w._uU(6," See the "),w.TgZ(7,"a",0),w._uU(8,"code of this example"),w.qZA(),w.qZA(),w.TgZ(9,"igo-entity-table",1),w.NdJ("entitySortChange",function(){return t.entitySortChange()}),w.qZA(),w.qZA()),2&e&&(w.xp6(9),w.Q6J("store",t.store)("withPaginator",!0)("paginatorOptions",t.paginatorOptions)("template",t.template))},directives:[O.a8,O.$j,O.n5,O.dn,Ei],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e}()}]),Rr=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[$r,O.QW,Wo,Vo]]}),e}();function Nr(e,t){if(1&e&&(w.TgZ(0,"div"),w.TgZ(1,"p"),w._uU(2),w.qZA(),w.TgZ(3,"p"),w._uU(4),w.qZA(),w.TgZ(5,"p"),w._uU(6,"Description: "),w._UZ(7,"span",3),w.qZA(),w.qZA()),2&e){var i=t.ngIf;w.xp6(2),w.hij("ID: ",i.id,""),w.xp6(2),w.hij("Name: ",i.name,""),w.xp6(3),w.Q6J("innerHtml",i.description,w.oJD)}}var Ur=Z.Bz.forChild([{path:"entity-selector",component:function(){var e=function(){function e(t){m(this,e),this.languageService=t,this.store=new At([]),this.selected$=new R.X(void 0)}return y(e,[{key:"ngOnInit",value:function(){this.store.load([{id:"2",name:"Name 2",description:"<b>Description 2</b>"},{id:"1",name:"Name 1",description:"<b>Description 1</b>"},{id:"3",name:"Name 3",description:"<b>Description 3</b>"}])}},{key:"ngOnDestroy",value:function(){this.store.destroy()}},{key:"getTitle",value:function(e){return e.name}},{key:"onSelectedChange",value:function(e){this.selected$.next(e.entity)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ce))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-entity-selector"]],decls:12,vars:7,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/entity-selector"],[3,"store","titleAccessor","emptyText","placeholder","selectedChange"],[4,"ngIf"],[3,"innerHtml"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Common"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Entity Selector"),w.qZA(),w.TgZ(5,"mat-card-content"),w._uU(6," See the "),w.TgZ(7,"a",0),w._uU(8,"code of this example"),w.qZA(),w.qZA(),w.TgZ(9,"igo-entity-selector",1),w.NdJ("selectedChange",function(e){return t.onSelectedChange(e)}),w.qZA(),w.YNc(10,Nr,8,3,"div",2),w.ALo(11,"async"),w.qZA()),2&e&&(w.xp6(9),w.Q6J("store",t.store)("titleAccessor",t.getTitle)("emptyText","")("placeholder","Select an entity"),w.xp6(1),w.Q6J("ngIf",w.lcZ(11,5,t.selected$)))},directives:[O.a8,O.$j,O.n5,O.dn,_t,F.O5],pipes:[F.Ov],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e}()}]),Jr=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,Ur,O.QW,Yo]]}),e}();function Br(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"igo-form",2),w.NdJ("submitForm",function(e){return w.CHM(i),w.oxw().onSubmit(e)}),w.ALo(1,"async"),w._UZ(2,"igo-form-group",3),w.TgZ(3,"div",4),w.TgZ(4,"button",5),w.NdJ("click",function(){return w.CHM(i),w.oxw().fillForm()}),w._uU(5," Fill Form "),w.qZA(),w.TgZ(6,"button",5),w.NdJ("click",function(){return w.CHM(i),w.oxw().clearForm()}),w._uU(7," Clear Form "),w.qZA(),w.TgZ(8,"button",6),w._uU(9," Submit "),w.qZA(),w.qZA(),w.qZA()}if(2&e){var o=t.ngIf,n=w.oxw();w.Q6J("form",o)("formData",w.lcZ(1,4,n.data$)),w.xp6(2),w.Q6J("group",o.groups[0]),w.xp6(6),w.Q6J("disabled",n.submitDisabled)}}var jr=Z.Bz.forChild([{path:"form",component:function(){var e=function(){function e(t,i){m(this,e),this.formService=t,this.languageService=i,this.form$=new R.X(void 0),this.data$=new R.X(void 0),this.submitDisabled=!0}return y(e,[{key:"ngOnInit",value:function(){var e=this,t=[{name:"id",title:"ID",options:{cols:1,validator:We.kI.required}},{name:"name",title:"Name",options:{cols:1,validator:We.kI.required}},{name:"status",title:"Status",type:"select",options:{cols:2},inputs:{choices:[{value:1,title:"Single"},{value:2,title:"Married"}]}}].map(function(t){return e.formService.field(t)}),i=this.formService.form([],[this.formService.group({name:"info"},t)]);this.valueChanges$$=i.control.valueChanges.subscribe(function(){e.submitDisabled=!i.control.valid}),this.form$.next(i)}},{key:"ngOnDestroy",value:function(){this.valueChanges$$.unsubscribe()}},{key:"fillForm",value:function(){this.data$.next({id:1,name:"Bob",status:2})}},{key:"clearForm",value:function(){this.form$.value.control.reset()}},{key:"onSubmit",value:function(e){alert(JSON.stringify(e))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(qo),w.Y36(Ce))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-form"]],decls:11,vars:3,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/form"],[3,"form","formData","submitForm",4,"ngIf"],[3,"form","formData","submitForm"],[3,"group"],["formButtons",""],["mat-stroked-button","","type","button","color","primary",3,"click"],["mat-flat-button","","type","submit","color","primary",3,"disabled"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Common"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Form"),w.qZA(),w.TgZ(5,"mat-card-content"),w._uU(6," See the "),w.TgZ(7,"a",0),w._uU(8,"code of this example"),w.qZA(),w.qZA(),w.YNc(9,Br,10,6,"igo-form",1),w.ALo(10,"async"),w.qZA()),2&e&&(w.xp6(9),w.Q6J("ngIf",w.lcZ(10,1,t.form$)))},directives:[O.a8,O.$j,O.n5,O.dn,F.O5,Po,jo,S.lW],pipes:[F.Ov],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e}()}]),Qr=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,jr,S.ot,O.QW,Go]]}),e}(),Gr=Z.Bz.forChild([{path:"table",component:function(){var e=function(){function e(t){var i=this;m(this,e),this.languageService=t,this.model={columns:[{name:"id",title:"ID",sortable:!1,filterable:!0},{name:"name",title:"Name",sortable:!0,filterable:!0},{name:"description",title:"Description",sortable:!0,filterable:!0}],actions:[{icon:"file-document",color:Cn.primary,click:function(e){return i.showName(e.name)}}],selectionCheckbox:!0}}return y(e,[{key:"ngOnInit",value:function(){this.database=new dr([{id:"2",name:"Name 2",description:"Hello 2"},{id:"1",name:"Name 1",description:"Bonjour 1"},{id:"3",name:"Name 3",description:"Hola 3"}])}},{key:"showName",value:function(e){alert(e)}},{key:"handleSelect",value:function(e){console.log(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ce))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-table"]],decls:10,vars:3,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/table"],[3,"database","model","hasFilterInput","select"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Common"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Table"),w.qZA(),w.TgZ(5,"mat-card-content"),w._uU(6," See the "),w.TgZ(7,"a",0),w._uU(8,"code of this example"),w.qZA(),w.qZA(),w.TgZ(9,"igo-table",1),w.NdJ("select",function(e){return t.handleSelect(e)}),w.qZA(),w.qZA()),2&e&&(w.xp6(9),w.Q6J("database",t.database)("model",t.model)("hasFilterInput",!0))},directives:[O.a8,O.$j,O.n5,O.dn,jn],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e}()}]),Yr=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[Gr,O.QW,Qn]]}),e}();function zr(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",6),w.NdJ("click",function(){return w.CHM(i),w.oxw().toolbox.activatePreviousTool()}),w._UZ(1,"mat-icon",7),w.qZA()}}function Vr(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",8),w.NdJ("click",function(){return w.CHM(i),w.oxw().toolbox.deactivateTool()}),w._UZ(1,"mat-icon",9),w.qZA()}}var Hr=function(){function e(t){m(this,e),this.cdRef=t}return y(e,[{key:"onUpdateInputs",value:function(){this.cdRef.detectChanges()}}]),e}();Hr.\u0275fac=function(e){return new(e||Hr)(w.Y36(w.sBO))},Hr.\u0275cmp=w.Xpm({type:Hr,selectors:[["app-salutation-tool"]],inputs:{name:"name"},decls:2,vars:1,template:function(e,t){1&e&&(w.TgZ(0,"p"),w._uU(1),w.qZA()),2&e&&(w.xp6(1),w.hij("Hello, my name is ",t.name,"."))},encapsulation:2,changeDetection:0}),Hr=(0,at.gn)([hr({name:"demo-salutation",title:"Salutation",icon:"account",options:{name:"Jack"}}),(0,at.w6)("design:paramtypes",[w.sBO])],Hr);var Wr=function e(){m(this,e)};Wr.\u0275fac=function(e){return new(e||Wr)},Wr.\u0275cmp=w.Xpm({type:Wr,selectors:[["app-about-tool"]],decls:2,vars:0,template:function(e,t){1&e&&(w.TgZ(0,"p"),w._uU(1,"I'm a tool inside a toolbox."),w.qZA())},encapsulation:2,changeDetection:0}),Wr=(0,at.gn)([hr({name:"demo-about",title:"About",icon:"information"})],Wr);var Xr=Z.Bz.forChild([{path:"tool",component:function(){var e=function(){function e(t,i){m(this,e),this.toolService=t,this.languageService=i,this.toolbox=new tn}return y(e,[{key:"activeTool$",get:function(){return this.toolbox.activeTool$}},{key:"panelTitle",get:function(){return this.activeTool$.value?this.activeTool$.value.title:"Toolbox"}},{key:"ngOnInit",value:function(){this.toolbox.setToolbar(["demo-salutation","demo-about"]),this.toolbox.setTools(this.toolService.getTools())}},{key:"ngOnDestroy",value:function(){this.toolbox.destroy()}},{key:"activateSalutationTool",value:function(){this.toolbox.activateTool("demo-salutation",{name:"Bob"})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(on),w.Y36(Ce))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-tool"]],decls:17,vars:9,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/tool"],[3,"title"],["mat-icon-button","","panelLeftButton","",3,"click",4,"ngIf"],["mat-icon-button","","panelRightButton","",3,"click",4,"ngIf"],[3,"toolbox","animate"],["mat-flat-button","","type","button","color","primary",3,"click"],["mat-icon-button","","panelLeftButton","",3,"click"],["svgIcon","arrow-back"],["mat-icon-button","","panelRightButton","",3,"click"],["svgIcon","menu"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Common"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Tool"),w.qZA(),w.TgZ(5,"mat-card-content"),w._uU(6," See the "),w.TgZ(7,"a",0),w._uU(8,"code of this example"),w.qZA(),w.qZA(),w.TgZ(9,"igo-panel",1),w.YNc(10,zr,2,0,"button",2),w.ALo(11,"async"),w.YNc(12,Vr,2,0,"button",3),w.ALo(13,"async"),w._UZ(14,"igo-toolbox",4),w.qZA(),w.TgZ(15,"button",5),w.NdJ("click",function(){return t.activateSalutationTool()}),w._uU(16," Activate Salutation Tool "),w.qZA(),w.qZA()),2&e&&(w.xp6(9),w.Q6J("title",t.panelTitle),w.xp6(1),w.Q6J("ngIf",w.lcZ(11,5,t.activeTool$)),w.xp6(2),w.Q6J("ngIf",w.lcZ(13,7,t.activeTool$)),w.xp6(2),w.Q6J("toolbox",t.toolbox)("animate",!0))},directives:[O.a8,O.$j,O.n5,O.dn,vn,F.O5,Xn,S.lW,k.Hw],pipes:[F.Ov],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e}()}]),Kr=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,Xr,S.ot,k.Ps,O.QW,Se,yn,er.forRoot()]]}),e}(),ea=function(){var e=function(){function e(t){m(this,e),this.cdRef=t,this.complete=new w.vpe,this.cancel=new w.vpe}return y(e,[{key:"onUpdateInputs",value:function(){this.cdRef.detectChanges()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(w.sBO))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-salutation-widget"]],inputs:{name:"name"},outputs:{complete:"complete",cancel:"cancel"},decls:6,vars:1,consts:[["mat-flat-button","",3,"click"]],template:function(e,t){1&e&&(w.TgZ(0,"p"),w._uU(1),w.qZA(),w.TgZ(2,"button",0),w.NdJ("click",function(){return t.complete.emit(t.name)}),w._uU(3,"Nice to meet you"),w.qZA(),w.TgZ(4,"button",0),w.NdJ("click",function(){return t.cancel.emit(t.name)}),w._uU(5,"Dismiss"),w.qZA()),2&e&&(w.xp6(1),w.hij("Hello, my name is ",t.name,"."))},directives:[S.lW],encapsulation:2,changeDetection:0}),e}(),ta=Z.Bz.forChild([{path:"widget",component:function(){var e=function(){function e(t){m(this,e),this.widgetService=t,this.widget=this.widgetService.create(ea),this.inputs={name:"Bob"}}return y(e,[{key:"onWidgetComplete",value:function(e){alert("".concat(e," emitted event 'complete' then got automatically destroyed."))}},{key:"onWidgetCancel",value:function(){alert("Widget emitted event 'cancel' then got automatically destroyed.")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(nr))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-widget"]],decls:10,vars:2,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/widget"],[3,"widget","inputs","complete","cancel"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Common"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Widget"),w.qZA(),w.TgZ(5,"mat-card-content"),w._uU(6," See the "),w.TgZ(7,"a",0),w._uU(8,"code of this example"),w.qZA(),w.qZA(),w.TgZ(9,"igo-widget-outlet",1),w.NdJ("complete",function(e){return t.onWidgetComplete(e)})("cancel",function(){return t.onWidgetCancel()}),w.qZA(),w.qZA()),2&e&&(w.xp6(9),w.Q6J("widget",t.widget)("inputs",t.inputs))},directives:[O.a8,O.$j,O.n5,O.dn,ir],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e}()}]),ia=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[ta,S.ot,O.QW,rr]]}),e}(),oa=l(14921),na=l(22663),ra=l(30400),aa=l(74192),sa=l.n(aa),la=l(50836),ca=l(41389),ua=l(55347),pa=l(1754),da=l(37822),ha=l(30999),ga=function(){var e=function(){function e(t){m(this,e),this.injector=t}return y(e,[{key:"set",value:function(e){localStorage.setItem(this.tokenKey,e)}},{key:"remove",value:function(){localStorage.removeItem(this.tokenKey)}},{key:"get",value:function(){return localStorage.getItem(this.tokenKey)}},{key:"decode",value:function(){var e=this.get();if(e)return sa()(e)}},{key:"isExpired",value:function(){var e=this.decode(),t=(new Date).getTime()/1e3;return!(e&&t<e.exp)}},{key:"tokenKey",get:function(){var e=this.injector.get(he);return this.options=e.getConfig("auth")||{},this.options.tokenKey}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(w.zs3))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),fa=function(){var e=function(){function e(t,i,o,n,r,a){var s=this;m(this,e),this.http=t,this.tokenService=i,this.config=o,this.languageService=n,this.messageService=r,this.router=a,this.authenticate$=new R.X(void 0),this.logged$=new R.X(void 0),this.anonymous=!1,this.authenticate$.next(this.authenticated),this.authenticate$.subscribe(function(e){s.logged$.next(e),st.h.next()})}return y(e,[{key:"hasAuthService",get:function(){return void 0!==this.config.getConfig("auth.url")}},{key:"login",value:function(e,t){var i=new P.WM({"Content-Type":"application/json"}),o={username:e,password:this.encodePassword(t)};return this.loginCall(o,i)}},{key:"loginWithToken",value:function(e,t,i){var o=new P.WM({"Content-Type":"application/json"});return this.loginCall({token:e,typeConnection:t,infosUser:i},o)}},{key:"loginAnonymous",value:function(){return this.anonymous=!0,this.logged$.next(!0),(0,U.of)(!0)}},{key:"refresh",value:function(){var e=this,t=this.config.getConfig("auth.url");return this.http.post("".concat(t,"/refresh"),{}).pipe((0,oa.b)(function(t){e.tokenService.set(t.token)}),(0,q.K)(function(e){throw e.error.caught=!0,e}))}},{key:"logout",value:function(){return this.anonymous=!1,this.tokenService.remove(),this.authenticate$.next(!1),(0,U.of)(!0)}},{key:"isAuthenticated",value:function(){return!this.tokenService.isExpired()}},{key:"getToken",value:function(){return this.tokenService.get()}},{key:"decodeToken",value:function(){return!!this.isAuthenticated()&&this.tokenService.decode()}},{key:"goToRedirectUrl",value:function(){if(this.router){var e=this.redirectUrl||this.router.url,t=this.config.getConfig("auth")||{};e===t.loginRoute?this.router.navigateByUrl(t.homeRoute||"/"):e&&this.router.navigateByUrl(e)}}},{key:"getUserInfo",value:function(){var e=this.config.getConfig("auth.url")+"/info";return this.http.get(e)}},{key:"getProfils",value:function(){var e=this.config.getConfig("auth.url");return this.http.get("".concat(e,"/profils"))}},{key:"updateUser",value:function(e){var t=this.config.getConfig("auth.url");return this.http.patch(t,e)}},{key:"encodePassword",value:function(e){return Y.encode(e)}},{key:"logged",get:function(){return this.authenticated||this.isAnonymous}},{key:"isAnonymous",get:function(){return this.anonymous}},{key:"authenticated",get:function(){return this.isAuthenticated()}},{key:"isAdmin",get:function(){var e=this.decodeToken();return!!(e&&e.user&&e.user.isAdmin)}},{key:"loginCall",value:function(e,t){var i=this,o=this.config.getConfig("auth.url");return this.http.post("".concat(o,"/login"),e,{headers:t}).pipe((0,oa.b)(function(e){i.tokenService.set(e.token);var t=i.decodeToken();t&&t.user&&(t.user.locale&&i.languageService.setLanguage(t.user.locale),t.user.isExpired&&i.languageService.translate.get("igo.auth.error.Password expired").subscribe(function(e){return i.messageService.alert(e)})),i.authenticate$.next(!0)}),(0,q.K)(function(e){throw e.error.caught=!0,e}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(P.eN),w.LFG(ga),w.LFG(he),w.LFG(Ce),w.LFG(Ae),w.LFG(Z.F0,8))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),ma=function(){var e=function(){function e(t,i,o,n){m(this,e),this.authService=t,this.config=i,this.languageService=o,this.appRef=n,this.login=new w.vpe,this.options=this.config.getConfig("auth.google")||{},this.options.apiKey&&this.options.clientId?(this.loadSDKGoogle(),this.loadPlatform()):console.warn('Google authentification needs "apiKey" and "clientId" options')}return y(e,[{key:"handleSignInClick",value:function(){window.gapi.auth2.getAuthInstance().signIn()}},{key:"handleSignOutClick",value:function(){window.gapi.auth2.getAuthInstance().signOut()}},{key:"handleClientLoad",value:function(){var e=this;window.gapi.load("client:auth2",function(){return e.initClient()})}},{key:"initClient",value:function(){var e=this;window.gapi.client.init({apiKey:this.options.apiKey,clientId:this.options.clientId,discoveryDocs:["https://people.googleapis.com/$discovery/rest?version=v1"],scope:"profile"}).then(function(){e.handleSignOutClick(),e.updateTextButton(),window.gapi.auth2.getAuthInstance().isSignedIn.listen(function(t){e.updateSigninStatus(t)})})}},{key:"updateSigninStatus",value:function(e){this.updateTextButton(),e&&this.loginGoogle(window.gapi.client.getToken().access_token)}},{key:"updateTextButton",value:function(){var e=document.querySelector('span[id^="not_signed_"]');e&&"en"!==this.languageService.getLanguage()&&("Sign in with Google"===e.innerHTML?e.innerHTML=this.languageService.translate.instant("igo.auth.google.login"):"Signed in with Google"===e.innerHTML&&(e.innerHTML=this.languageService.translate.instant("igo.auth.google.logged")))}},{key:"loginGoogle",value:function(e){var t=this;this.authService.loginWithToken(e,"google").subscribe(function(){t.appRef.tick(),t.login.emit(!0)})}},{key:"loadSDKGoogle",value:function(){var e=this,t=document.getElementsByTagName("script")[0],i=document.createElement("script");i.id="google-jssdk",i.src="https://apis.google.com/js/api.js",i.onload=function(){e.handleClientLoad()},t.parentNode.insertBefore(i,t)}},{key:"loadPlatform",value:function(){var e=document.getElementsByTagName("script")[0],t=document.createElement("script");t.id="google-platform",t.src="https://apis.google.com/js/platform.js",e.parentNode.insertBefore(t,e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(fa),w.Y36(he),w.Y36(Ce),w.Y36(w.z2F))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-auth-google"]],outputs:{login:"login"},decls:1,vars:0,consts:[["data-height","40","data-width","265","data-longtitle","true",1,"g-signin2","google-login-button"]],template:function(e,t){1&e&&w._UZ(0,"div",0)},styles:["[_nghost-%COMP%]{padding:10px 10px 10px 0;display:inline-block}.google-login-button[_ngcontent-%COMP%]     .abcRioButton{color:#000000de}"],changeDetection:0}),e}(),va=function(){var e=function(){function e(t,i,o,n,r){var a=this;m(this,e),this.authService=t,this.config=i,this.appRef=o,this.msalService=n,this.msalGuardConfig=r,this._destroying$=new Q.xQ,this.login=new w.vpe,this.options=this.config.getConfig("auth.microsoft")||{},this.msalService.instance=new ca.L({auth:this.options,cache:{cacheLocation:"sessionStorage"}}),this.broadcastService=new la.J$(this.msalService.instance,this.msalService),this.options.clientId?this.broadcastService.inProgress$.pipe((0,Qe.h)(function(e){return e===ua.$H.None}),(0,na.R)(this._destroying$)).subscribe(function(){a.checkAccount()}):console.warn('Microsoft authentification needs "clientId" option')}return y(e,[{key:"loginMicrosoft",value:function(){var e=this;this.msalService.loginPopup(Object.assign({},this.getConf().authRequest)).subscribe(function(t){e.msalService.instance.setActiveAccount(t.account),e.checkAccount()})}},{key:"checkAccount",value:function(){var e=this;this.msalService.instance.acquireTokenSilent(this.getConf().authRequest).then(function(t){e.authService.loginWithToken(t.accessToken,"microsoft",{tokenId:t.idToken}).subscribe(function(){e.appRef.tick(),e.login.emit(!0)})}).catch(function(t){return(0,at.mG)(e,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t instanceof pa.Yo)){e.next=2;break}return e.abrupt("return",this.msalService.acquireTokenPopup(this.getConf().authRequest));case 2:console.log(t);case 3:case"end":return e.stop()}},e,this)}))}).catch(function(e){console.log("Silent token fails")})}},{key:"getConf",value:function(){return this.msalGuardConfig.filter(function(e){return"add"===e.type})[0]}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(fa),w.Y36(he),w.Y36(w.z2F),w.Y36(la.W2),w.Y36(la.S9))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-auth-microsoft"]],outputs:{login:"login"},decls:4,vars:3,consts:[["mat-raised-button","",1,"microsoft-login-button",3,"click"],["svgIcon","microsoft"]],template:function(e,t){1&e&&(w.TgZ(0,"button",0),w.NdJ("click",function(){return t.loginMicrosoft()}),w._UZ(1,"mat-icon",1),w._uU(2),w.ALo(3,"translate"),w.qZA()),2&e&&(w.xp6(2),w.hij(" ",w.lcZ(3,1,"igo.auth.microsoft.login"),"\n"))},directives:[S.lW,k.Hw],pipes:[ae.X$],styles:["[_nghost-%COMP%]{padding:10px 10px 10px 0;display:inline-block;position:relative;top:-15px}[_nghost-%COMP%] > button[_ngcontent-%COMP%]{font-size:15px;height:40px;width:265px}mat-icon[_ngcontent-%COMP%]{margin-right:10px}"],changeDetection:0}),e}(),ya=function(){var e=function(){function e(t,i){m(this,e),this.instance=t,this.location=i,this.name="@azure/msal-angular",this.version="2.0.0-beta.2";var o=this.location.path(!0).split("#").pop();o&&(this.redirectHash="#".concat(o)),this.instance.initializeWrapperLibrary(ua.lA.Angular,this.version)}return y(e,[{key:"acquireTokenPopup",value:function(e){return(0,ra.D)(this.instance.acquireTokenPopup(e))}},{key:"acquireTokenRedirect",value:function(e){return(0,ra.D)(this.instance.acquireTokenRedirect(e))}},{key:"acquireTokenSilent",value:function(e){return(0,ra.D)(this.instance.acquireTokenSilent(e))}},{key:"handleRedirectObservable",value:function(e){return(0,ra.D)(this.instance.handleRedirectPromise(e||this.redirectHash))}},{key:"loginPopup",value:function(e){return(0,ra.D)(this.instance.loginPopup(e))}},{key:"loginRedirect",value:function(e){return(0,ra.D)(this.instance.loginRedirect(e))}},{key:"logout",value:function(e){return(0,ra.D)(this.instance.logout(e))}},{key:"logoutRedirect",value:function(e){return(0,ra.D)(this.instance.logoutRedirect(e))}},{key:"logoutPopup",value:function(e){return(0,ra.D)(this.instance.logoutPopup(e))}},{key:"ssoSilent",value:function(e){return(0,ra.D)(this.instance.ssoSilent(e))}},{key:"getLogger",value:function(){return this.logger||(this.logger=this.instance.getLogger().clone(this.name,this.version)),this.logger}},{key:"setLogger",value:function(e){this.logger=e.clone(this.name,this.version),this.instance.setLogger(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(la.sK),w.LFG(F.Ye))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac}),e}(),ba=function(){var e=function e(t,i){var o=this;m(this,e),this.msalInstance=t,this.authService=i,this._msalSubject=new Q.xQ,this.msalSubject$=this._msalSubject.asObservable(),this._inProgress=new R.X(ua.$H.Startup),this.inProgress$=this._inProgress.asObservable(),this.msalInstance.addEventCallback(function(e){o._msalSubject.next(e);var t=da.w.getInteractionStatusFromEvent(e);null!==t&&(o.authService.getLogger().verbose("BroadcastService - ".concat(e.eventType," results in setting inProgress to ").concat(t)),o._inProgress.next(t))})};return e.\u0275fac=function(t){return new(t||e)(w.LFG(la.sK),w.LFG(ya))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac}),e}(),wa=function(){var e=function(){function e(t,i,o,n,r){var a=this;m(this,e),this.authService=t,this.config=i,this.appRef=o,this.msalService=n,this.msalGuardConfig=r,this._destroying$=new Q.xQ,this.login=new w.vpe,this.options=this.config.getConfig("auth.microsoftb2c")||{},this.msalService.instance=new ca.L({auth:this.options.browserAuthOptions,cache:{cacheLocation:"sessionStorage"}}),this.broadcastService=new ba(this.msalService.instance,this.msalService),this.options.browserAuthOptions.clientId?this.broadcastService.inProgress$.pipe((0,Qe.h)(function(e){return e===ua.$H.None}),(0,na.R)(this._destroying$)).subscribe(function(){a.checkAccount()}):console.warn('Microsoft authentification needs "clientId" option')}return y(e,[{key:"loginMicrosoftb2c",value:function(){var e=this;this.msalService.loginPopup(Object.assign({},this.getConf().authRequest)).subscribe(function(t){e.msalService.instance.setActiveAccount(t.account),e.checkAccount()})}},{key:"checkAccount",value:function(){var e=this;this.msalService.instance.acquireTokenSilent(this.getConf().authRequest).then(function(t){e.authService.loginWithToken(t.idToken,"microsoftb2c").subscribe(function(){e.appRef.tick(),e.login.emit(!0)})}).catch(function(t){return(0,at.mG)(e,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t instanceof pa.Yo)){e.next=2;break}return e.abrupt("return",this.msalService.acquireTokenPopup(this.getConf().authRequest));case 2:case"end":return e.stop()}},e,this)}))}).catch(function(e){console.log("Silent token fails")})}},{key:"getConf",value:function(){return this.msalGuardConfig.filter(function(e){return"b2c"===e.type})[0]}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(fa),w.Y36(he),w.Y36(w.z2F),w.Y36(ya),w.Y36(la.S9))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-auth-microsoftb2c"]],outputs:{login:"login"},decls:4,vars:3,consts:[["mat-raised-button","",1,"microsoft-login-button",3,"click"],["svgIcon","microsoft"]],template:function(e,t){1&e&&(w.TgZ(0,"button",0),w.NdJ("click",function(){return t.loginMicrosoftb2c()}),w._UZ(1,"mat-icon",1),w._uU(2),w.ALo(3,"translate"),w.qZA()),2&e&&(w.xp6(2),w.hij(" ",w.lcZ(3,1,"igo.auth.microsoftb2c.login"),"\n"))},directives:[S.lW,k.Hw],pipes:[ae.X$],styles:["[_nghost-%COMP%]{padding:10px 10px 10px 0;display:inline-block;position:relative;top:-15px}[_nghost-%COMP%] > button[_ngcontent-%COMP%]{font-size:15px;height:40px;width:265px}mat-icon[_ngcontent-%COMP%]{margin-right:10px}"],changeDetection:0}),e}(),xa=function(){var e=function(){function e(t,i,o){m(this,e),this.authService=t,this.config=i,this.appRef=o,this.login=new w.vpe,this.options=this.config.getConfig("auth.facebook")||{},this.options.appId?this.loadSDKFacebook():console.warn('Facebook authentification needs "appId" option')}return y(e,[{key:"subscribeEvents",value:function(){var e=this;window.FB.Event.subscribe("auth.statusChange",function(t){e.statusChangeCallback(t)})}},{key:"statusChangeCallback",value:function(e){"connected"===e.status&&this.loginFacebook(e.authResponse.accessToken)}},{key:"loginFacebook",value:function(e){var t=this;this.authService.loginWithToken(e,"facebook").subscribe(function(){t.appRef.tick(),t.login.emit(!0)})}},{key:"loadSDKFacebook",value:function(){var e=this;if(!document.getElementById("facebook-jssdk")){var t=document.getElementsByTagName("script")[0],i=document.createElement("script");i.id="facebook-jssdk",i.src="https://connect.facebook.net/fr_CA/sdk.js#xfbml=1&version=v2.9&appId=".concat(this.options.appId),i.onload=function(){e.subscribeEvents()},t.parentNode.insertBefore(i,t)}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(fa),w.Y36(he),w.Y36(w.z2F))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-auth-facebook"]],outputs:{login:"login"},decls:1,vars:0,consts:[["scope","public_profile,email","data-max-rows","1","data-size","large","data-button-type","login_with","data-show-faces","false","data-auto-logout-link","false","data-use-continue-as","false",1,"fb-login-button"]],template:function(e,t){1&e&&w._UZ(0,"div",0)},styles:["[_nghost-%COMP%]{padding:10px 10px 10px 0;display:inline-block;position:relative;top:-3px}"],changeDetection:0}),e}();function Sa(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",7),w.NdJ("click",function(){return w.CHM(i),w.oxw().loginAnonymous()}),w._uU(1),w.ALo(2,"translate"),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("disabled",o.loading),w.xp6(1),w.hij(" ",w.lcZ(2,2,"igo.auth.accessAnonymous")," ")}}function ka(e,t){if(1&e&&(w.TgZ(0,"div"),w._UZ(1,"br"),w.TgZ(2,"font",8),w._uU(3),w.qZA(),w.qZA()),2&e){var i=w.oxw();w.xp6(3),w.Oqu(i.error)}}var Ca=function(){var e=function(){function e(t,i,o){m(this,e),this.auth=t,this.languageService=i,this._allowAnonymous=!0,this.error="",this.loading=!1,this.login=new w.vpe,this.form=o.group({username:["",We.kI.required],password:["",We.kI.required]})}return y(e,[{key:"allowAnonymous",get:function(){return this._allowAnonymous},set:function(e){this._allowAnonymous=e}},{key:"loginUser",value:function(e){var t=this;return this.loading=!0,this.auth.login(e.username,e.password).subscribe(function(){t.login.emit(!0),t.loading=!1},function(e){try{t.languageService.translate.get("igo.auth.error."+e.error.message).subscribe(function(e){return t.error=e})}catch(i){t.error=e.error.message}t.loading=!1}),!1}},{key:"loginAnonymous",value:function(){var e=this;this.auth.loginAnonymous().subscribe(function(){e.login.emit(!0)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(fa),w.Y36(Ce),w.Y36(We.qu))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-auth-intern"]],inputs:{allowAnonymous:"allowAnonymous"},outputs:{login:"login"},decls:14,vars:12,consts:[["role","form",3,"formGroup","ngSubmit"],[1,"full-width"],["matInput","","required","","formControlName","username",3,"placeholder"],["matInput","","required","","type","password","formControlName","password",3,"placeholder"],["mat-raised-button","","type","submit"],["mat-raised-button","","class","anonymous","type","button",3,"disabled","click",4,"ngIf"],[4,"ngIf"],["mat-raised-button","","type","button",1,"anonymous",3,"disabled","click"],["size","3","color","red"]],template:function(e,t){1&e&&(w.TgZ(0,"form",0),w.NdJ("ngSubmit",function(){return t.loginUser(t.form.value)}),w.TgZ(1,"div"),w.TgZ(2,"mat-form-field",1),w._UZ(3,"input",2),w.ALo(4,"translate"),w.qZA(),w.qZA(),w.TgZ(5,"div"),w.TgZ(6,"mat-form-field",1),w._UZ(7,"input",3),w.ALo(8,"translate"),w.qZA(),w.qZA(),w.TgZ(9,"button",4),w._uU(10),w.ALo(11,"translate"),w.qZA(),w.YNc(12,Sa,3,4,"button",5),w.YNc(13,ka,4,1,"div",6),w.qZA()),2&e&&(w.Q6J("formGroup",t.form),w.xp6(3),w.s9C("placeholder",w.lcZ(4,6,"igo.auth.user")),w.xp6(4),w.s9C("placeholder",w.lcZ(8,8,"igo.auth.password")),w.xp6(3),w.Oqu(w.lcZ(11,10,"igo.auth.login")),w.xp6(2),w.Q6J("ngIf",t.allowAnonymous),w.xp6(1),w.Q6J("ngIf",t.error))},directives:[We._Y,We.JL,We.sg,Ye.KE,ot.Nt,We.Fj,We.Q7,We.JJ,We.u,S.lW,F.O5],pipes:[ae.X$],styles:[".full-width[_ngcontent-%COMP%]{width:100%}.anonymous[_ngcontent-%COMP%]{margin-left:10px}"]}),e}();function Ta(e,t){1&e&&w._UZ(0,"div",3)}function Aa(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"igo-auth-google",7),w.NdJ("login",function(){return w.CHM(i),w.oxw(3).onLogin()}),w.qZA()}}function La(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"igo-auth-microsoft",7),w.NdJ("login",function(){return w.CHM(i),w.oxw(3).onLogin()}),w.qZA()}}function Za(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"igo-auth-microsoftb2c",7),w.NdJ("login",function(){return w.CHM(i),w.oxw(3).onLogin()}),w.qZA()}}function Fa(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"igo-auth-facebook",7),w.NdJ("login",function(){return w.CHM(i),w.oxw(3).onLogin()}),w.qZA()}}function Oa(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"igo-auth-intern",8),w.NdJ("login",function(){return w.CHM(i),w.oxw(3).onLogin()}),w.qZA()}if(2&e){var o=w.oxw(3);w.Q6J("allowAnonymous",o.options.allowAnonymous)}}function Ma(e,t){if(1&e&&(w.TgZ(0,"div",4),w.TgZ(1,"h1"),w._uU(2),w.ALo(3,"translate"),w.qZA(),w.YNc(4,Aa,1,0,"igo-auth-google",5),w.YNc(5,La,1,0,"igo-auth-microsoft",5),w.YNc(6,Za,1,0,"igo-auth-microsoftb2c",5),w.YNc(7,Fa,1,0,"igo-auth-facebook",5),w.YNc(8,Oa,1,1,"igo-auth-intern",6),w.qZA()),2&e){var i=w.oxw(2);w.xp6(2),w.Oqu(w.lcZ(3,6,"igo.auth.connection")),w.xp6(2),w.Q6J("ngIf",i.options.google&&!1!==i.options.google.enabled),w.xp6(1),w.Q6J("ngIf",i.options.microsoft&&!1!==i.options.microsoft.enabled),w.xp6(1),w.Q6J("ngIf",i.options.microsoftb2c&&!1!==i.options.microsoftb2c.enabled),w.xp6(1),w.Q6J("ngIf",i.options.facebook&&!1!==i.options.facebook.enabled),w.xp6(1),w.Q6J("ngIf",!i.options.intern||!1!==i.options.intern.enabled)}}function Ia(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",4),w.TgZ(1,"p"),w._uU(2),w.ALo(3,"translate"),w.qZA(),w.TgZ(4,"button",9),w.NdJ("click",function(){return w.CHM(i),w.oxw(2).logout()}),w._uU(5),w.ALo(6,"translate"),w.qZA(),w.qZA()}if(2&e){var o=w.oxw(2);w.xp6(2),w.Oqu(w.xi3(3,2,"igo.auth.welcome",o.user)),w.xp6(3),w.Oqu(w.lcZ(6,5,"igo.auth.signOut"))}}function Pa(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",9),w.NdJ("click",function(){return w.CHM(i),w.oxw(3).home()}),w._uU(1),w.ALo(2,"translate"),w.qZA()}2&e&&(w.xp6(1),w.Oqu(w.lcZ(2,1,"igo.auth.home")))}function _a(e,t){if(1&e&&(w.TgZ(0,"div",4),w.TgZ(1,"p"),w._uU(2),w.ALo(3,"translate"),w.qZA(),w.YNc(4,Pa,3,3,"button",10),w.qZA()),2&e){var i=w.oxw(2);w.xp6(2),w.Oqu(w.lcZ(3,2,"igo.auth.deconnection")),w.xp6(2),w.Q6J("ngIf",i.options.homeRoute)}}function qa(e,t){if(1&e&&(w.TgZ(0,"div"),w.YNc(1,Ta,1,0,"div",1),w.YNc(2,Ma,9,8,"div",2),w.YNc(3,Ia,7,7,"div",2),w.YNc(4,_a,5,4,"div",2),w.qZA()),2&e){var i=w.oxw();w.xp6(1),w.Q6J("ngIf",!i.auth.logged&&i.backgroundDisable),w.xp6(1),w.Q6J("ngIf",!i.auth.logged&&i.showLoginDiv),w.xp6(1),w.Q6J("ngIf",i.auth.logged&&i.showAlreadyConnectedDiv),w.xp6(1),w.Q6J("ngIf",i.showLogoutDiv)}}var Da=function(){var e=function(){function e(t,i,o){m(this,e),this.auth=t,this.config=i,this.router=o,this._backgroundDisable=!0,this._hasAlreadyConnectedDiv=!0,this._hasLogoutDiv=!0,this._showAlreadyConnectedDiv=!1,this._showLogoutDiv=!1,this.login=new w.vpe,this.visible=!0,this.options=this.config.getConfig("auth")||{},this.visible=0!==Object.getOwnPropertyNames(this.options).length}return y(e,[{key:"backgroundDisable",get:function(){return!this.isLogoutRoute&&!this.isLogoutRoute&&this._backgroundDisable},set:function(e){this._backgroundDisable="true"===e.toString()}},{key:"hasAlreadyConnectedDiv",get:function(){return this._hasAlreadyConnectedDiv},set:function(e){this._hasAlreadyConnectedDiv="true"===e.toString()}},{key:"hasLogoutDiv",get:function(){return this._hasLogoutDiv},set:function(e){this._hasLogoutDiv="true"===e.toString()}},{key:"showAlreadyConnectedDiv",get:function(){return this.isLogoutRoute?this.hasAlreadyConnectedDiv:this._showAlreadyConnectedDiv},set:function(e){this._showAlreadyConnectedDiv="true"===e.toString()}},{key:"showLogoutDiv",get:function(){return this.isLogoutRoute?this.hasLogoutDiv:this._showLogoutDiv},set:function(e){this._showLogoutDiv="true"===e.toString()}},{key:"showLoginDiv",get:function(){if(!this.isLogoutRoute)return!0}},{key:"ngOnInit",value:function(){this.analyzeRoute(),this.getName()}},{key:"onLogin",value:function(){this.auth.goToRedirectUrl(),this.getName(),this.login.emit(!0)}},{key:"logout",value:function(){var e=this;this.auth.logout().subscribe(function(){e.user=void 0,e.router&&(e.options.logoutRoute?e.router.navigate([e.options.logoutRoute]):e.options.homeRoute&&e.router.navigate([e.options.homeRoute]))})}},{key:"home",value:function(){this.router&&this.options.homeRoute&&this.router.navigate([this.options.homeRoute])}},{key:"getName",value:function(){var e=this.auth.decodeToken();e&&(this.user={name:e.user.firstName||e.user.sourceId})}},{key:"analyzeRoute",value:function(){var e=this;!this.router||this.router.events.pipe((0,Qe.h)(function(e){return e instanceof Z.OD})).subscribe(function(t){if(t.url){var i=t.url,o=e.options.loginRoute;e.isLogoutRoute=i===e.options.logoutRoute,e.isLoginRoute=i===o,e.isLogoutRoute&&e.auth.logout()}})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(fa),w.Y36(he),w.Y36(Z.F0,8))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-auth-form"]],inputs:{backgroundDisable:"backgroundDisable",hasAlreadyConnectedDiv:"hasAlreadyConnectedDiv",hasLogoutDiv:"hasLogoutDiv",showAlreadyConnectedDiv:"showAlreadyConnectedDiv",showLogoutDiv:"showLogoutDiv"},outputs:{login:"login"},decls:1,vars:1,consts:[[4,"ngIf"],["class","backgroundDisable",4,"ngIf"],["class","login center-block",4,"ngIf"],[1,"backgroundDisable"],[1,"login","center-block"],[3,"login",4,"ngIf"],[3,"allowAnonymous","login",4,"ngIf"],[3,"login"],[3,"allowAnonymous","login"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","type","button",3,"click",4,"ngIf"]],template:function(e,t){1&e&&w.YNc(0,qa,5,4,"div",0),2&e&&w.Q6J("ngIf",t.visible)},directives:[F.O5,ma,va,wa,xa,Ca,S.lW],pipes:[ae.X$],styles:["[_nghost-%COMP%]{z-index:999}div.login[_ngcontent-%COMP%]{z-index:200;width:90%;min-width:360px;max-width:600px;padding:25px 50px;border:1px solid;background-color:#fff;border-color:#888}.center-block[_ngcontent-%COMP%]{position:fixed;top:20%;left:50%;transform:translate(-50%)}.backgroundDisable[_ngcontent-%COMP%]{position:fixed;top:0;left:0;background:#000;opacity:.8;z-index:100;height:100%;width:100%}"]}),e}(),Ea=function(){var e=function(){function e(t,i,o){m(this,e),this.config=t,this.tokenService=i,this.http=o,this.refreshInProgress=!1}return y(e,[{key:"trustHosts",get:function(){var e=this.config.getConfig("auth.trustHosts")||[];return e.push(window.location.hostname),e}},{key:"hostsWithCredentials",get:function(){return this.config.getConfig("auth.hostsWithCredentials")||[]}},{key:"hostsWithAuthByKey",get:function(){return this.config.getConfig("auth.hostsByKey")||[]}},{key:"intercept",value:function(e,t){var i=this.handleHostsWithCredentials(e.url),o=e.clone(),n=this.handleHostsAuthByKey(e.url);n&&(o=o.clone({params:o.params.set(n.key,n.value)})),i&&(o=e.clone({withCredentials:i})),this.refreshToken();var r=this.tokenService.get(),a=document.createElement("a");if(a.href=o.url,""===a.host&&(a.href=a.href),!r||-1===this.trustHosts.indexOf(a.hostname))return t.handle(o);var s=o.clone({headers:o.headers.set("Authorization","Bearer ".concat(r))}),l=this.tokenService.decode();if("true"===s.params.get("_i")&&l&&l.user&&l.user.sourceId){var c=ha.V.hashStr(l.user.sourceId);s=s.clone({params:s.params.set("_i",c)})}else"true"===s.params.get("_i")&&(s=s.clone({params:s.params.delete("_i")}));return t.handle(s)}},{key:"interceptXhr",value:function(e,t){var i=this.handleHostsWithCredentials(t);if(i)return e.withCredentials=i,!0;this.refreshToken();var o=document.createElement("a");o.href=t;var n=this.tokenService.get();return!(!n||-1===this.trustHosts.indexOf(o.hostname)||(e.setRequestHeader("Authorization","Bearer "+n),0))}},{key:"alterUrlWithKeyAuth",value:function(e){var t=this.handleHostsAuthByKey(e);if(t){var i=e.split(/[?&]/),o=i.shift(),n=i.filter(function(e){return 0!==e.length});return n.push("".concat(t.key,"=").concat(t.value)),n.length&&(o+="?"+n.join("&")),o}}},{key:"handleHostsWithCredentials",value:function(e){var t,i=!1,o=p(this.hostsWithCredentials);try{for(o.s();!(t=o.n()).done;){var n=t.value;if(new RegExp(n.domainRegFilters).test(e)){i=void 0!==n.withCredentials?n.withCredentials:void 0;break}}}catch(r){o.e(r)}finally{o.f()}return i}},{key:"handleHostsAuthByKey",value:function(e){var t,i,o=p(this.hostsWithAuthByKey);try{for(o.s();!(i=o.n()).done;){var n=i.value;if(new RegExp(n.domainRegFilters).test(e)&&!new RegExp("".concat(n.keyProperty,"=").concat(n.keyValue),"gm").test(e)){t={key:n.keyProperty,value:n.keyValue};break}}}catch(r){o.e(r)}finally{o.f()}return t}},{key:"refreshToken",value:function(){var e=this,t=this.tokenService.decode(),i=(new Date).getTime()/1e3;if(!this.refreshInProgress&&t&&i<t.exp&&i>t.exp-1800){this.refreshInProgress=!0;var o=this.config.getConfig("auth.url");return this.http.post("".concat(o,"/refresh"),{}).subscribe(function(t){e.tokenService.set(t.token),e.refreshInProgress=!1},function(e){return e.error.caught=!0,e})}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(he),w.LFG(ga),w.LFG(P.eN))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function $a(e){var t=e.getConfig("auth.microsoft")||{};return t.redirectUri=t.redirectUri||window.location.href,t.authority=t.authority||"https://login.microsoftonline.com/organizations",new ca.L({auth:t,cache:{cacheLocation:"sessionStorage"}})}function Ra(e){var t=e.getConfig("auth.microsoftb2c.browserAuthOptions")||{};return t.redirectUri=t.redirectUri||window.location.href,t.authority=t.authority||"https://login.microsoftonline.com/organizations",new ca.L({auth:t,cache:{cacheLocation:"sessionStorage"}})}function Na(e){return e.getConfig("auth.microsoft"),{interactionType:ua.s_.Popup,authRequest:{scopes:["user.read"],loginHint:"todo"},type:"add"}}function Ua(e){var t=e.getConfig("auth.microsoftb2c.browserAuthOptions")||{};return{interactionType:ua.s_.Popup,authRequest:{scopes:[t.clientId]},type:"b2c"}}function Ja(e){return"b2c"===e?[{provide:la.sK,useFactory:Ra,deps:[he]},{provide:la.S9,useFactory:Ua,deps:[he],multi:!0},ya]:[{provide:la.sK,useFactory:$a,deps:[he]},{provide:la.S9,useFactory:Na,deps:[he],multi:!0},la.W2]}var Ba=function(){var e=function(e){o(n,e);var t=r(n);function n(e,o,r,a){var l,u;return m(this,n),(u=t.call(this,e)).http=o,u.authService=r,u.tokenService=a,u.authService.authenticate$.subscribe(function(e){e&&u.options.url&&u.http.get(u.options.url).subscribe(function(e){if(e&&e.preference)for(var t=0,o=Object.keys(e.preference);t<o.length;t++){var r=o[t];i((l=s(u),c(n.prototype)),"set",l).call(l,r,e.preference[r])}})}),u}return y(n,[{key:"set",value:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_e.LOCAL;if(o===_e.LOCAL&&this.authService.authenticated&&this.options.url){var r={};r[e]=t,this.http.patch(this.options.url,{preference:r}).subscribe()}i(c(n.prototype),"set",this).call(this,e,t,o)}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_e.LOCAL;if(t===_e.LOCAL&&this.authService.authenticated&&this.options.url){var o={};o[e]=void 0,this.http.patch(this.options.url,{preference:o}).subscribe()}i(c(n.prototype),"remove",this).call(this,e,t)}},{key:"clear",value:function(){var e,t=this,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_e.LOCAL;o===_e.LOCAL&&this.authService.authenticated&&this.options.url&&this.http.patch(this.options.url,{preference:{}},{params:{mergePreference:"false"}}).subscribe(),o===_e.LOCAL&&(e=this.tokenService.get()),i(c(n.prototype),"clear",this).call(this,o),e&&this.tokenService.set(e),o===_e.LOCAL&&this.authService.authenticated&&this.options.url&&this.http.get(this.options.url).subscribe(function(e){if(e&&e.preference)for(var o=0,r=Object.keys(e.preference);o<r.length;o++){var a=r[o];i(c(n.prototype),"set",t).call(t,a,e.preference[a])}})}}]),n}(De);return e.\u0275fac=function(t){return new(t||e)(w.LFG(he),w.LFG(P.eN),w.LFG(fa),w.LFG(ga))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),ja=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[{provide:P.TP,useClass:Ea,multi:!0},{provide:De,useClass:Ba}].concat(d(Ja("add")),d(Ja("b2c")))}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,We.UX,Ye.lN,ot.c,k.Ps,S.ot,Se,la.up]]}),e}(),Qa=Z.Bz.forChild([{path:"auth-form",component:function(){var e=function e(t){m(this,e),this.languageService=t,this.idsActivity=[]};return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ce))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-auth-form"]],decls:17,vars:0,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/auth/auth-form"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/environments"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Auth"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Authentification"),w.qZA(),w.TgZ(5,"mat-card-content"),w.TgZ(6,"li"),w._uU(7,"Dependencies: ConfigService, LanguageService"),w.qZA(),w._UZ(8,"br"),w._uU(9," See the "),w.TgZ(10,"a",0),w._uU(11,"code of this example"),w.qZA(),w._UZ(12,"br"),w._uU(13," See auth section of the "),w.TgZ(14,"a",1),w._uU(15," environment config"),w.qZA(),w.qZA(),w.qZA(),w._UZ(16,"igo-auth-form"))},directives:[O.a8,O.$j,O.n5,O.dn,Da],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}"]}),e}()}]),Ga=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[Qa,O.QW,ja.forRoot()]]}),e}(),Ya=l(42720),za=l(90490),Va=l(8117),Ha=l(12702),Wa=l(20088),Xa=l(56816),Ka=l(78767),es=l(85816),ts=l(85105),is=l(60246),os=l(19091),ns=l(33697),rs=l(57969),as=l(13966),ss=l(83136),ls=l(21432),cs=l(38549),us=l(32475),ps=l(32565),ds=l(53809),hs=l(31391),gs=l(56274),fs=l(20737),ms=l(16274),vs=l(6888),ys=l(49040),bs=l(16212),ws=l(21049),xs=l(94770),Ss=l(64330),ks=l(51819),Cs=l(88257),Ts=l(88176),As=l(22798),Ls=l(18570),Zs=l(5883),Fs=l(18830),Os=l(82146),Ms=l(70032),Is=l(95403),Ps=l(6037),_s=l(82424),qs=l(39968),Ds=l(74882),Es=l(13104),$s=l(74154),Rs=l(40113),Ns=l(64213),Us=l(95567),Js=l(73951),Bs=l(75529),js=l(33809),Qs=l(44280),Gs=l(68190),Ys=l(40866),zs=l(47976),Vs=l(62346),Hs=l(70690),Ws=l(6203),Xs=l(56384),Ks=l(61273),el=l(49010),tl=l(21119),il=l(72966),ol=l(95361),nl=l(83437),rl=l(53515),al=l(3421),sl=l(14426),ll=l(26101),cl=l(12891),ul=l(43219),pl=l(92804),dl=l(41698),hl=l(52162),gl=l(53895),fl=l(55224),ml=l(37202),vl=l(3096),yl=l(64039),bl=l(18418),wl=l(98431),xl=l(57424),Sl=l(62294),kl=l(16176),Cl=l(19031),Tl=l(60186),Al=l(70764),Ll=l(62738),Zl=l(45552),Fl=l(87730),Ol=l(73277),Ml=(l(61112),l(24492),l(28519)),Il=l(74656),Pl=l(44962),_l=l(99673),ql=l(10757),Dl=l(42127),El=l(3023),$l=l(70509),Rl=l(74749),Nl=l(97797),Ul=l(46674),Jl=l(52195),Bl=l.n(Jl),jl=l(17284),Ql=l(37254),Gl=l(59144),Yl=function(){var e=function(){function e(){m(this,e)}return y(e,[{key:"open",value:function(e){e.extern&&window.open(e.url,"_blank")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function zl(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",1),w.NdJ("click",function(){w.CHM(i);var e=w.oxw();return e.openMetadata(e.options.metadata)}),w.ALo(1,"translate"),w._UZ(2,"mat-icon",2),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("matTooltip",w.lcZ(1,2,"igo.geo.metadata.show"))("color",o.color)}}function Vl(e,t){if(1&e&&(w.TgZ(0,"mat-dialog-content",3),w.TgZ(1,"h3"),w._uU(2),w.qZA(),w.qZA()),2&e){var i=w.oxw();w.xp6(2),w.Oqu(i.data.abstract)}}function Hl(e,t){if(1&e&&(w.TgZ(0,"mat-dialog-content",3),w._UZ(1,"h3",4),w.qZA()),2&e){var i=w.oxw();w.xp6(1),w.Q6J("innerHTML",i.data.abstract,w.oJD)}}var Wl=function(){var e=function(){function e(t,i){m(this,e),this.metadataService=t,this.dialog=i,this._color="primary"}return y(e,[{key:"layer",get:function(){return this._layer},set:function(e){this._layer=e}},{key:"color",get:function(){return this._color},set:function(e){this._color=e}},{key:"openMetadata",value:function(e){e.extern?this.metadataService.open(e):!e.extern&&e.abstract&&this.dialog.open(Xl,{data:{layerTitle:this.layer.title,abstract:e.abstract,type:e.type}})}},{key:"options",get:function(){if(this.layer)return this.layer.options}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Yl),w.Y36(ut.uw))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-metadata-button"]],inputs:{layer:"layer",color:"color"},decls:1,vars:1,consts:[["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click"],["svgIcon","information-outline"]],template:function(e,t){1&e&&w.YNc(0,zl,3,4,"button",0),2&e&&w.Q6J("ngIf",t.options&&t.options.metadata&&t.options.metadata.url||t.options&&t.options.metadata&&t.options.metadata.abstract)},directives:[F.O5,S.lW,L.gM,k.Hw],pipes:[ae.X$],styles:[""],changeDetection:0}),e}(),Xl=function(){var e=function e(t){m(this,e),this.data=t};return e.\u0275fac=function(t){return new(t||e)(w.Y36(ut.WI))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-metadata-abstract"]],decls:6,vars:3,consts:[["mat-dialog-title",""],["mat-button","","mat-dialog-close","",1,"close-button"],["class","mat-typography",4,"ngIf"],[1,"mat-typography"],[3,"innerHTML"]],template:function(e,t){1&e&&(w.TgZ(0,"h2",0),w._uU(1),w.qZA(),w.TgZ(2,"button",1),w._uU(3,"X"),w.qZA(),w.YNc(4,Vl,3,1,"mat-dialog-content",2),w.YNc(5,Hl,2,1,"mat-dialog-content",2)),2&e&&(w.xp6(1),w.Oqu(t.data.layerTitle),w.xp6(3),w.Q6J("ngIf","arcgisrest"!==t.data.type),w.xp6(1),w.Q6J("ngIf","arcgisrest"===t.data.type))},directives:[ut.uh,S.lW,ut.ZT,F.O5,ut.xY],styles:[".close-button{top:5px;right:5px;padding:7px;line-height:10px;position:absolute!important;min-width:auto}mat-dialog-container{position:relative}\n"],encapsulation:2}),e}(),Kl=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,k.Ps,S.ot,L.AV,Se,ut.Is]]}),e}(),ec="Feature",tc=function(){return(e=tc||(tc={}))[e.None=0]="None",e[e.Move=1]="Move",e[e.Zoom=2]="Zoom",e[e.Default=3]="Default",tc;var e}(),ic=function(e){o(i,e);var t=r(i);function i(e,o,n){var r;return m(this,i),(r=t.call(this)).loaded=0,r.loading=0,r.source=e.options.source.ol,r.id=oe(),r.messageService=o,r.languageService=n,r}return y(i,[{key:"watch",value:function(){var e=this;this.source.on("imageloadstart",function(t){return e.handleLoadStart(t)}),this.source.on("imageloadend",function(t){return e.handleLoadEnd(t)}),this.source.on("imageloaderror",function(t){return e.handleLoadEnd(t)}),this.source.on("imageloaderror",function(t){return e.handleLoadError(t)})}},{key:"unwatch",value:function(){var e=this;this.source.un("imageloadstart",function(t){return e.handleLoadStart(t)}),this.source.un("imageloadend",function(t){return e.handleLoadEnd(t)}),this.source.un("imageloaderror",function(t){return e.handleLoadEnd(t)}),this.source.un("imageloaderror",function(t){return e.handleLoadError(t)})}},{key:"handleLoadStart",value:function(e){e.image.__watchers__||(e.image.__watchers__=[]),e.image.__watchers__.push(this.id),this.loading+=1,this.status=ne.Working}},{key:"handleLoadEnd",value:function(e){if(e.image.__watchers__){var t=e.image.__watchers__.indexOf(this.id);if(!(t<0)){e.image.__watchers__.splice(t,1),this.loaded+=1;var i=this.loading;this.loaded>=i&&i===this.loading&&(this.status=ne.Done,this.loaded=this.loading=0)}}}},{key:"handleLoadError",value:function(e){if(e.image.__watchers__){var t=this.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),i=this.languageService.translate.instant("igo.geo.dataSource.unavailable",{value:e.target.params_.LAYERS});this.messageService.error(i,t),this.loaded=-1,this.loading=0,this.status=ne.Error}}}]),i}(re);function oc(e){var t,i;return"mvt"===(null===(t=e.sourceOptions)||void 0===t?void 0:t.type)&&((null===(i=e.styleByAttribute)||void 0===i?void 0:i.hoverStyle)||e.hoverStyle)&&(e.sourceOptions.featureClass=e.sourceOptions.featureClass||"feature"),e}var nc=function(){return(e=nc||(nc={})).OPACITY="opacity",e.VISIBLE="visible",e.OGCFILTERS="ogcFilters",e.MINRESOLUTION="minResolution",e.MAXRESOLUTION="maxResolution",e.ZINDEX="zIndex",e.TIMEFILTER="timeFilter",nc;var e}(),rc=function(){return(e=rc||(rc={})).TITLE="title",e.ABSTRACT="abstract",e.CUSTOM="custom",rc;var e}();function ac(e){return({wms:sc,wmts:lc,xyz:cc,feature:uc,wfs:pc,arcgisrest:dc,imagearcgisrest:dc,tilearcgisrest:dc,osm:function(e){return"OSM"},tiledebug:function(e){return"tiledebug"}}[e.type]||hc)(e)}function sc(e){var t=e.params.LAYERS,i=gc(e.url);return ha.V.hashStr("wms"+i+t)}function lc(e){var t=e.layer,i=gc(e.url);return ha.V.hashStr("wmts"+i+t)}function cc(e){var t=gc(e.url);return ha.V.hashStr("xyz"+t)}function uc(e){if(!e.url)return hc();var t=gc(e.url);return ha.V.hashStr("feature"+t)}function pc(e){if(!e.url||!e.params)return hc();var t=gc(e.url);return ha.V.hashStr("wfs"+t+e.params.featureTypes)}function dc(e){var t=e.layer,i=gc(e.url);return ha.V.hashStr((e.type||"arcgis")+i+t)}function hc(e){return oe()}function gc(e){var t=("/"===e.charAt(0)?window.location.origin+e:e).split(/[?&]/),i=t.shift(),o=t.filter(function(e){return 0!==e.length&&"_"!==e.charAt(0)});return o.length&&(i+="?"+o.join("&")),i}var fc=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;m(this,e),this.options=t,this.dataService=i,this.options=t,this.id=this.options.id||this.generateId(),this.ol=this.createOlSource()}return y(e,[{key:"generateId",value:function(){return ac(this.options)}},{key:"getLegend",value:function(e,t){return this.legend?this.legend:[]}},{key:"setLegend",value:function(e){return this.legend=e.url?[{url:e.url}]:e.html?[{html:e.html}]:[],this.legend}}]),e}(),mc=function(){return(e=mc||(mc={})).BasicNumericOperator="basicnumericoperator",e.Basic="basic",e.BasicAndSpatial="basicandspatial",e.Spatial="spatial",e.All="all",e.Time="time",mc;var e}(),vc=function(){return(e=vc||(vc={})).BBOX="BBox",e.PropertyIsBetween="PropertyIsBetween",e.Contains="Contains",e.During="During",e.PropertyIsEqualTo="PropertyIsEqualTo",e.PropertyIsGreaterThan="PropertyIsGreaterThan",e.PropertyIsGreaterThanOrEqualTo="PropertyIsGreaterThanOrEqualTo",e.Intersects="Intersects",e.PropertyIsNull="PropertyIsNull",e.PropertyIsLessThan="PropertyIsLessThan",e.PropertyIsLessThanOrEqualTo="PropertyIsLessThanOrEqualTo",e.PropertyIsLike="PropertyIsLike",e.PropertyIsNotEqualTo="PropertyIsNotEqualTo",e.Within="Within",e.And="And",e.Or="Or",e.Not="Not",vc;var e}(),yc=Xe,bc=function(){function e(){var t;m(this,e),this.filterSequence=[],this.operators=(u(t={},vc.PropertyIsEqualTo,{spatial:!1,fieldRestrict:[]}),u(t,vc.PropertyIsNotEqualTo,{spatial:!1,fieldRestrict:[]}),u(t,vc.PropertyIsLike,{spatial:!1,fieldRestrict:["string"]}),u(t,vc.PropertyIsGreaterThan,{spatial:!1,fieldRestrict:["number"]}),u(t,vc.PropertyIsGreaterThanOrEqualTo,{spatial:!1,fieldRestrict:["number"]}),u(t,vc.PropertyIsLessThan,{spatial:!1,fieldRestrict:["number"]}),u(t,vc.PropertyIsLessThanOrEqualTo,{spatial:!1,fieldRestrict:["number"]}),u(t,vc.PropertyIsBetween,{spatial:!1,fieldRestrict:["number"]}),u(t,vc.During,{spatial:!1,fieldRestrict:[]}),u(t,vc.PropertyIsNull,{spatial:!1,fieldRestrict:[]}),u(t,vc.Intersects,{spatial:!0,fieldRestrict:[]}),u(t,vc.Within,{spatial:!0,fieldRestrict:[]}),u(t,vc.Contains,{spatial:!0,fieldRestrict:[]}),t)}return y(e,[{key:"defineOgcFiltersDefaultOptions",value:function(e,t,i){var o=!0;return i&&"wms"===i&&(o=!1),(e=e||{}).enabled=void 0===e.enabled?o:e.enabled,e.editable=void 0===e.editable?o:e.editable,e.geometryName=t,e.advancedOgcFilters=!0,e.enabled&&(e.pushButtons||e.checkboxes||e.radioButtons||e.select)&&(e.advancedOgcFilters=!1),e}},{key:"buildFilter",value:function(e,t,i,o,n){var r,a;if(a=!/intersects|contains|within/gi.test(JSON.stringify(e)),e&&(o=void 0!==e.geometryName?e.geometryName:o),t&&e&&(r=Es.VW(o,t,i.getCode())),!e)return"bbox="+t.join(",")+","+i.getCode();e=this.checkIgoFiltersProperties(e,o,i);var s={srsName:"",featureNS:"",featurePrefix:"",featureTypes:["featureTypes"],filter:t&&a?Es.xD(r,this.bundleFilter(e,n)):this.bundleFilter(e,n),outputFormat:"",geometryName:o},l=(new Rs.Z).writeGetFeature(s);return"filter="+(new XMLSerializer).serializeToString(l).split(/typenames *=|typename *=\"featureTypes\" *>/gi)[1].split(/<\/Query><\/GetFeature>/gi)[0]}},{key:"bundleFilter",value:function(e,t){var i=this;if(e instanceof Array){var o=[];return e.forEach(function(e){o.push(i.bundleFilter(e,t))}),o}return e.hasOwnProperty("logical")?this.createFilter({operator:e.logical,logicalArray:this.bundleFilter(e.filters,t)},t):e.hasOwnProperty("operator")?this.createFilter(e,t):void 0}},{key:"createFilter",value:function(e,t){var i,o=e.operator,n=e.logicalArray,r=e.propertyName,a=e.pattern,s=!e.matchCase||e.matchCase,l=e.wildCard?e.wildCard:"*",c=e.singleChar?e.singleChar:".",u=e.escapeChar?e.escapeChar:"!",p=e.lowerBoundary,d=e.upperBoundary,h=e.geometryName,g=e.extent,f=e.wkt_geometry,m=e.srsName?e.srsName:"EPSG:3857",v=this.parseFilterOptionDate(e.begin,t?t.minDate:void 0),y=this.parseFilterOptionDate(e.end,t?t.maxDate:void 0),b=e.expression;switch(f&&(i=(new $s.Z).readGeometry(f,{dataProjection:m,featureProjection:m||"EPSG:3857"})),o.toLowerCase()){case vc.BBOX.toLowerCase():return Es.VW(h,g,m);case vc.PropertyIsBetween.toLowerCase():return Es.vX(r,p,d);case vc.Contains.toLowerCase():return Es.r3(h,i,m);case vc.During.toLowerCase():return Es.Q9(r,v,y);case vc.PropertyIsEqualTo.toLowerCase():return Es.EW(r,b,s);case vc.PropertyIsGreaterThan.toLowerCase():return Es.tS(r,b);case vc.PropertyIsGreaterThanOrEqualTo.toLowerCase():return Es.wZ(r,b);case vc.Intersects.toLowerCase():return Es.kK(h,i,m);case vc.PropertyIsNull.toLowerCase():return Es.Ft(r);case vc.PropertyIsLessThan.toLowerCase():return Es.Qj(r,b);case vc.PropertyIsLessThanOrEqualTo.toLowerCase():return Es.MK(r,b);case vc.PropertyIsLike.toLowerCase():return Es.vL(r,a.replace(/[()_]/gi,c),l,c,u,s);case vc.PropertyIsNotEqualTo.toLowerCase():return Es.eI(r,b,s);case vc.Within.toLowerCase():return Es.uh(h,i,m);case vc.And.toLowerCase():return Es.xD.apply(null,n);case vc.Or.toLowerCase():return Es.or.apply(null,n);case vc.Not.toLowerCase():return Es.ff.apply(null,n);default:return}}},{key:"defineInterfaceFilterSequence",value:function(e,t){var i=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;return e instanceof Array?e.forEach(function(e){i.filterSequence.concat(i.defineInterfaceFilterSequence(e,t,o,n))}):e.hasOwnProperty("logical")?this.filterSequence.concat(this.defineInterfaceFilterSequence(e.filters,t,e.logical,n+=1)):e.hasOwnProperty("operator")&&this.filterSequence.push(this.addInterfaceFilter(e,t,n,o)),this.filterSequence}},{key:"computeAllowedOperators",value:function(e,t,i){var o,n,r,a,s,l,c,p,d={};if(e&&t){var h=e.find(function(e){return e.name===t});l=h&&h.allowedOperatorsType?h.allowedOperatorsType:i}switch(e&&e.map(function(e){if(e.allowedOperatorsType){var t=e.allowedOperatorsType.toLowerCase();(t===mc.All.toLowerCase()||t===mc.Spatial.toLowerCase()||t===mc.BasicAndSpatial.toLowerCase())&&(c=!0,t===mc.All.toLowerCase()&&(p=!0))}}),(l=l||mc.BasicAndSpatial).toLowerCase()){case mc.All:d=this.operators;break;case mc.Spatial:u(o={},vc.Intersects,{spatial:!0,fieldRestrict:[]}),u(o,vc.Within,{spatial:!0,fieldRestrict:[]}),d=o;break;case mc.BasicAndSpatial:u(n={},vc.PropertyIsEqualTo,{spatial:!1,fieldRestrict:[]}),u(n,vc.PropertyIsNotEqualTo,{spatial:!1,fieldRestrict:[]}),u(n,vc.Intersects,{spatial:!0,fieldRestrict:[]}),u(n,vc.Within,{spatial:!0,fieldRestrict:[]}),d=n;break;case mc.Basic:u(r={},vc.PropertyIsEqualTo,{spatial:!1,fieldRestrict:[]}),u(r,vc.PropertyIsNotEqualTo,{spatial:!1,fieldRestrict:[]}),d=r;break;case mc.Time:d=u({},vc.During,{spatial:!1,fieldRestrict:[]});break;case mc.BasicNumericOperator:u(a={},vc.PropertyIsEqualTo,{spatial:!1,fieldRestrict:[]}),u(a,vc.PropertyIsNotEqualTo,{spatial:!1,fieldRestrict:[]}),u(a,vc.PropertyIsGreaterThan,{spatial:!1,fieldRestrict:["number"]}),u(a,vc.PropertyIsGreaterThanOrEqualTo,{spatial:!1,fieldRestrict:["number"]}),u(a,vc.PropertyIsLessThan,{spatial:!1,fieldRestrict:["number"]}),u(a,vc.PropertyIsLessThanOrEqualTo,{spatial:!1,fieldRestrict:["number"]}),d=a;break;default:u(s={},vc.PropertyIsEqualTo,{spatial:!1,fieldRestrict:[]}),u(s,vc.PropertyIsNotEqualTo,{spatial:!1,fieldRestrict:[]}),u(s,vc.Intersects,{spatial:!0,fieldRestrict:[]}),u(s,vc.Within,{spatial:!0,fieldRestrict:[]}),d=s}return c&&(d.Intersects={spatial:!0,fieldRestrict:[]},d.Within={spatial:!0,fieldRestrict:[]},p&&(d.Contains={spatial:!0,fieldRestrict:[]})),d}},{key:"addInterfaceFilter",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Or";e||(e={operator:"PropertyIsEqualTo"});var n={propertyName:"",operator:"",active:"",filterid:oe(),step:"",begin:"",end:"",sliderOptions:{},lowerBoundary:"",upperBoundary:"",expression:"",pattern:"",wildCard:"*",singleChar:".",escapeChar:"!",matchCase:!0,igoSpatialSelector:"",igoSNRC:"",geometryName:"",geometry:"",wkt_geometry:"",extent:"",srsName:"",parentLogical:"",level:0};return Object.assign(n,{parentLogical:o,level:i,geometryName:t},e)}},{key:"checkIgoFiltersProperties",value:function(e,t,i){var o=this,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=[];return e instanceof Array?(e.forEach(function(e){r.push(o.checkIgoFiltersProperties(e,t,i,n))}),r):e.hasOwnProperty("logical")?Object.assign({},{logical:e.logical,filters:this.checkIgoFiltersProperties(e.filters,t,i,n)}):e.hasOwnProperty("operator")?this.addFilterProperties(e,t,i,n):void 0}},{key:"addFilterProperties",value:function(e,t,i){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=e.hasOwnProperty("filterid")?e.filterid:oe(),r=e.hasOwnProperty("active")?e.active:o,a=e.hasOwnProperty("srsName")?e.srsName:i?i.getCode():"EPSG:3857";return Object.assign({},{filterid:n,active:r,igoSpatialSelector:"fixedExtent",srsName:a},e,{geometryName:t})}},{key:"rebuiltIgoOgcFilterObjectFromSequence",value:function(e){if(e instanceof Array&&e.length>=1){var t,i,o=e[0].parentLogical,n=[];return e.forEach(function(r){var a=Object.assign({},r),s=e.indexOf(r);t=s>=0&&s<e.length-1?e[s+1]:a,delete a.active,delete a.filterid,delete a.parentLogical,n.push(a),1===e.length?i=a:o!==t.parentLogical&&(1===n.length?console.log("You must set at least two operator in a logical ("+o+")"):(i=Object.assign({},{logical:o,filters:n}),n=[i],o=t.parentLogical))}),i}}},{key:"computeIgoSelector",value:function(e){if(e.groups.every(function(e){return void 0!==e.computedSelectors}))return e;var t;if(e.groups&&e.bundles){if(!e.bundles.every(function(e){return void 0!==e.id}))throw new Error("You must set an id for each of your bundles");(t=K.copyDeep(e)).groups.forEach(function(e){e.title=e.title?e.title:e.name,e.enabled=!!e.enabled&&e.enabled,e.computedSelectors=K.copyDeep(t.bundles.filter(function(t){return e.ids.includes(t.id)}))})}else!e.groups&&e.bundles?(t=K.copyDeep(e)).groups=[{title:"group1",name:"group1",computedSelectors:K.copyDeep(t.bundles)}]:t={bundles:e,groups:[{title:"group1",name:"group1",computedSelectors:K.copyDeep(e)}],selectorType:t.selectorType};return t.groups.find(function(e){return e.enabled})||(t.groups[0].enabled=!0),t}},{key:"handleOgcFiltersAppliedValue",value:function(e,t,i,o){var n=e.ogcFilters;if(n){var r=[],a="",s="";if(n.enabled&&(n.pushButtons||n.checkboxes||n.radioButtons||n.select)){var l;if(n.pushButtons){l=n.pushButtons;var c,u=p(this.formatGroupAndFilter(n,l));try{for(u.s();!(c=u.n()).done;){var d=c.value;r.push(d)}}catch(T){u.e(T)}finally{u.f()}}if(n.checkboxes){l=n.checkboxes;var h,g=p(this.formatGroupAndFilter(n,l));try{for(g.s();!(h=g.n()).done;){var f=h.value;r.push(f)}}catch(T){g.e(T)}finally{g.f()}}if(n.radioButtons){l=n.radioButtons;var m,v=this.verifyMultipleEnableds(l),y=p(this.formatGroupAndFilter(n,v));try{for(y.s();!(m=y.n()).done;){var b=m.value;r.push(b)}}catch(T){y.e(T)}finally{y.f()}}if(n.select){l=n.select;var w,x=this.verifyMultipleEnableds(l),S=p(this.formatGroupAndFilter(n,x));try{for(S.s();!(w=S.n()).done;){var k=w.value;r.push(k)}}catch(T){S.e(T)}finally{S.f()}}r.length>=1&&(a=this.buildFilter(1===r.length?r[0]:{logical:"And",filters:r},i,o,n.geometryName))}n.enabled&&n.filters&&(n.geometryName=n.geometryName||t,s=this.buildFilter(n.filters,i,o,n.geometryName,e));var C=n.advancedOgcFilters?s:a;return"wms"===e.type&&(C=this.formatProcessedOgcFilter(C,e.params.LAYERS)),"wfs"===e.type&&(C=this.formatProcessedOgcFilter(C,e.params.featureTypes)),C}}},{key:"verifyMultipleEnableds",value:function(e){return e.bundles.forEach(function(e){if(!e.multiple){var t=e.selectors.reduce(function(e,t,i){return!0===t.enabled?e.concat(i):e},[]);t.length>1&&(t.splice(0,1),t.forEach(function(t){e.selectors[t].enabled=!1}))}}),e}},{key:"formatGroupAndFilter",value:function(e,t){var i=(t=this.computeIgoSelector(t)).groups.find(function(e){return e.enabled}).computedSelectors,o=[];return i.map(function(e){var t=[],i=e.selectors;!i||(i.filter(function(e){return!0===e.enabled}).forEach(function(e){return t.push(e.filters)}),1===t.length?o.push(t[0]):t.length>1&&o.push({logical:e.logical,filters:t}))}),"pushButton"===t.selectorType?e.pushButtons=t:"checkbox"===t.selectorType?e.checkboxes=t:"radioButton"===t.selectorType?e.radioButtons=t:"select"===t.selectorType&&(e.select=t),o}},{key:"formatProcessedOgcFilter",value:function(e,t){if(e){var i="";return 0===e.length&&-1===t.indexOf(",")?i=e:t.split(",").forEach(function(t){i="".concat(i,"(").concat(e.replace("filter=",""),")")}),(i=i.replace(/\(\)/g,"")).length>0?i.replace("filter=",""):void 0}}},{key:"parseFilterOptionDate",value:function(e,t){return e?"today"===e?void 0:yc(e).isValid()?e:void 0:t}}]),e}(),wc=function(){return(e=wc||(wc={})).GML2="gml2",e.GML3="gml3",e.JSON="json",e.GEOJSON="geojson",e.GEOJSON2="geojson2",e.ESRIJSON="esrijson",e.TEXT="text",e.HTML="html",e.HTMLGML2="htmlgml2",wc;var e}(),xc=function(){return(e=xc||(xc={})).GML2="application/vnd.ogc.gml",e.GML3="application/vnd.ogc.gml/3.1.1",e.JSON="application/json",e.GEOJSON="application/geojson",e.GEOJSON2="geojson",e.ESRIJSON="application/json",e.TEXT="text/plain",e.HTML="text/html",e.HTMLGML2="text/html",xc;var e}(),Sc=function(){return(e=Sc||(Sc={})).IFRAME="iframe",e.BLANK="_blank",Sc;var e}(),kc="EPSG:3857",Cc=5e3,Tc="geometry",Ac=new RegExp(/(.*)?gml(.*)?/gi);function Lc(e,t,i,o,n){var r,a=e.paramsWFS,s=Zc(e,void 0,e.paramsWFS.srsName);o&&o.enabled&&(r=o.filters);var l=new bc,c=l.buildFilter(r,t,i,o.geometryName,e),u=l.handleOgcFiltersAppliedValue(e,o.geometryName,t,i),p="filter";u||(p="bbox",u=t.join(",")+","+i.getCode()),a.xmlFilter=o.advancedOgcFilters?c:"".concat(p,"=").concat(u);var d=s.find(function(e){return"getfeature"===e.name}).value;return d=/(filter|bbox)=.*/gi.test(a.xmlFilter)?"".concat(d,"&").concat(a.xmlFilter):d,e.download=Object.assign({},e.download,{dynamicUrl:d}),n&&(d+="$&_t".concat((new Date).getTime())),d.replace(/&&/g,"&")}function Zc(e,t,i,o){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a="2.0.0",s=e.urlWfs,l=e.paramsWFS,c=t||Cc,u=l.version===a?"startIndex=".concat(n):"",p=i||kc,d=l.outputFormat?"outputFormat=".concat(l.outputFormat):"",h=l.version?"version=".concat(l.version):"version=2.0.0",g="".concat(l.version===a?"typenames":"typename","=").concat(l.featureTypes),f=l.version===a?"count":"maxFeatures",m=t?"".concat(f,"=").concat(c):l.maxFeatures?"".concat(f,"=").concat(l.maxFeatures):"".concat(f,"=").concat(c);r&&(d="",h="version=1.1.0",m=m.replace("count","maxFeatures"));var v=i?"srsname=".concat(p):l.srsName?"srsname="+l.srsName:"srsname=".concat(p),y="",b="";o&&(y="propertyName=".concat(o),b="valueReference=".concat(o));var w=e.sourceFields;if(!y&&w&&w.length>0){var x=[];e.sourceFields.forEach(function(e){x.push(e.name)}),y="propertyName=".concat(x.join(","),",").concat(l.fieldNameGeometry)}var S=-1===s.indexOf("?")?"?":"&",k="".concat(s).concat(S,"service=WFS&request=GetFeature&").concat(h,"&").concat(g,"&");k+="".concat(d,"&").concat(v,"&").concat(m,"&").concat(y,"&").concat(u);var C="".concat(s,"?service=WFS&request=GetPropertyValue&version=").concat(a,"&").concat(g,"&");return C+="&".concat(m,"&").concat(b),[{name:"outputformat",value:d},{name:"version",value:h},{name:"typename",value:g},{name:"count",value:m},{name:"srsname",value:v},{name:"propertyname",value:y},{name:"valuereference",value:b},{name:"getcapabilities",value:"".concat(s).concat(S,"service=WFS&request=GetCapabilities&").concat(h).replace(/&&/g,"&")},{name:"getfeature",value:k.replace(/&&/g,"&")},{name:"getpropertyvalue",value:C.replace(/&&/g,"&")}]}function Fc(e,t){t&&"wfs"===t&&(e.paramsWFS=e.params);var i,o=e.paramsWFS;return e.urlWfs=e.urlWfs||e.url,o.version=o.version||"2.0.0",o.fieldNameGeometry=o.fieldNameGeometry||Tc,o.maxFeatures=o.maxFeatures||Cc,o.outputFormat&&(i=o.outputFormat),(Ac.test(i)||!i)&&(o.version="1.1.0"),Object.assign({},e)}function Oc(e){var t,i=e,o=i.paramsWFS.outputFormat?i.paramsWFS.outputFormat:void 0;return o?Ns[o]?new(t=Ns[o])(i.formatOptions):o.toLowerCase().match("gml2")?new(t=Rs.Z)(Object.assign(Object.assign({},i.formatOptions),{gmlFormat:Vs.Z})):o.toLowerCase().match("gml32")?new(t=Rs.Z)(Object.assign(Object.assign({},i.formatOptions),{gmlFormat:Ws.Z})):o.toLowerCase().match("gml3")?new(t=Rs.Z)(Object.assign(Object.assign({},i.formatOptions),{gmlFormat:Hs.Z})):o.toLowerCase().match("topojson")?new(t=Us.Z)(i.formatOptions):o.toLowerCase().match("geojson")?new(t=Zs.Z)(i.formatOptions):o.toLowerCase().match("esrijson")?new(t=Js.Z)(i.formatOptions):o.toLowerCase().match("json")?new(t=Zs.Z)(i.formatOptions):o.toLowerCase().match("gpx")?new(t=Bs.Z)(i.formatOptions):o.toLowerCase().match("WKT")?new(t=$s.Z)(i.formatOptions):o.toLowerCase().match("osmxml")?new(t=Xs.Z)(i.formatOptions):o.toLowerCase().match("kml")?new(t=js.ZP)(i.formatOptions):new t:new(t=Rs.Z)(i.formatOptions)}var Mc=function(e){o(n,e);var t=r(n);function n(e,i){var o;m(this,n),(o=t.call(this,e)).options=e,o.wfsService=i,o.ogcFilters$=new R.X(void 0),o.timeFilter$=new R.X(void 0);var r=e.params,a=r.DPI||96;r.DPI=a,r.MAP_RESOLUTION=a,r.FORMAT_OPTIONS="dpi:"+a,e.refreshIntervalSec&&e.refreshIntervalSec>0&&setInterval(function(){o.refresh()},1e3*e.refreshIntervalSec);var s=Tc;if(e.paramsWFS){var l=Fc(e,"wms");K.mergeDeep(e.paramsWFS,l.paramsWFS),s=e.paramsWFS.fieldNameGeometry||s,e.download=Object.assign({},e.download,{dynamicUrl:o.buildDynamicDownloadUrlFromParamsWFS(e)})}e.sourceFields&&0!==e.sourceFields.length?e.sourceFields.forEach(function(e){e.alias=e.alias?e.alias:e.name}):e.sourceFields=[];var c=e.ogcFilters,u=new bc;c?(c.advancedOgcFilters=!(c.pushButtons||c.checkboxes||c.radioButtons||c.select),c.advancedOgcFilters&&c.filters&&c.filters.calendarModeYear&&(c.advancedOgcFilters=!1),c.pushButtons&&(c.pushButtons.selectorType="pushButton"),c.checkboxes&&(c.checkboxes.selectorType="checkbox"),c.radioButtons&&(c.radioButtons.selectorType="radioButton"),c.select&&(c.select.selectorType="select")):e.ogcFilters=u.defineOgcFiltersDefaultOptions(c,s,"wms"),r.LAYERS.split(",").length>1&&c&&c.enabled&&(console.log("*******************************"),console.log("BE CAREFULL, YOUR WMS LAYERS ("+r.LAYERS+") MUST SHARE THE SAME FIELDS TO ALLOW ogcFilters TO WORK !! "),console.log("*******************************")),e.paramsWFS&&c&&c.enabled&&c.editable&&(e.sourceFields||[]).filter(function(e){return!e.values}).length>0&&o.wfsService.getSourceFieldsFromWFS(e);var p=u.handleOgcFiltersAppliedValue(e,s);return r.FILTER=p,o.setOgcFilters(c,!0),(null==e?void 0:e.timeFilterable)&&(null==e?void 0:e.timeFilter)&&o.setTimeFilter(e.timeFilter,!0),o}return y(n,[{key:"params",get:function(){return this.options.params}},{key:"queryTitle",get:function(){return this.options.queryTitle?this.options.queryTitle:"title"}},{key:"mapLabel",get:function(){return this.options.mapLabel}},{key:"queryHtmlTarget",get:function(){return this.options.queryHtmlTarget?this.options.queryHtmlTarget:Sc.BLANK}},{key:"ogcFilters",get:function(){return this.options.ogcFilters},set:function(e){this.options.ogcFilters=e}},{key:"timeFilter",get:function(){return this.options.timeFilter},set:function(e){this.options.timeFilter=e}},{key:"refresh",value:function(){this.ol.updateParams({igoRefresh:Math.random()})}},{key:"buildDynamicDownloadUrlFromParamsWFS",value:function(e){return Zc(e).find(function(e){return"getfeature"===e.name}).value}},{key:"createOlSource",value:function(){return new Ds.Z(Object.assign({ratio:1},this.options))}},{key:"setOgcFilters",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.ogcFilters=e,t&&this.ogcFilters$.next(this.ogcFilters)}},{key:"setTimeFilter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.timeFilter=e,t&&this.timeFilter$.next(this.timeFilter)}},{key:"getLegend",value:function(e,t){var o=i(c(n.prototype),"getLegend",this).call(this);if(o.length>0&&void 0===e&&!(null==t?void 0:t.scale))return o;var r,a=!1;(null==t?void 0:t.size)&&(null==t?void 0:t.extent)&&(null==t?void 0:t.projection)&&this.options.contentDependentLegend&&(r="1.3.0"===this.params.VERSION||void 0===this.params.VERSION?"CRS":"SRS",a=!0);var s=this.params,l=[];void 0!==s.LAYERS&&(l=s.LAYERS.split(","));var u=this.options.url.replace(/\?$/,""),p=["REQUEST=GetLegendGraphic","SERVICE=WMS","FORMAT=image/png","SLD_VERSION=1.1.0","VERSION=".concat(s.VERSION||"1.3.0")];return void 0!==e&&p.push("STYLE=".concat(e)),void 0!==(null==t?void 0:t.scale)&&p.push("SCALE=".concat(t.scale)),a&&(p.push("WIDTH=".concat(t.size[0])),p.push("HEIGHT=".concat(t.size[1])),p.push("BBOX=".concat(t.extent.join(","))),p.push("".concat(r,"=").concat(t.projection))),o=l.map(function(t){var i=u.match(/\?/)?"&":"?";return{url:"".concat(u).concat(i).concat(p.join("&"),"&LAYER=").concat(t),title:l.length>1?t:void 0,currentStyle:void 0===e?void 0:e}})}},{key:"onUnwatch",value:function(){}}]),n}(fc),Ic=function(e){o(i,e);var t=r(i);function i(e,o){var n;return m(this,i),(n=t.call(this)).ol=e.ol,n.layer=e,n.dataSource=e.options.source,n.map=o,n.ogcFilterWriter=new bc,n}return y(i,[{key:"watch",value:function(){var e=this;this.ol.on("propertychange",function(t){return e.transferCommonProperties(t)}),this.dataSource.ogcFilters$&&(this.ogcFilters$$=this.dataSource.ogcFilters$.subscribe(function(t){return e.transferOgcFiltersProperties(t)})),this.dataSource.timeFilter$&&(this.timeFilter$$=this.dataSource.timeFilter$.subscribe(function(t){return e.transferTimeFilterProperties(t)})),this.syncChildLayers()}},{key:"unwatch",value:function(){var e=this;this.ol.un("propertychange",function(t){return e.transferCommonProperties(t)}),this.ogcFilters$$&&this.ogcFilters$$.unsubscribe(),this.timeFilter$$&&this.timeFilter$$.unsubscribe()}},{key:"syncChildLayers",value:function(){var e=this;!this.map||this.map.status$.pipe((0,Wa.P)()).subscribe(function(){e.map.layers.filter(function(e){var t;return null===(t=e.options.linkedLayers)||void 0===t?void 0:t.links}).map(function(e){e.options.linkedLayers.links.map(function(t){var i,o,n,r,a,s;if(-1!==(null===(i=t.properties)||void 0===i?void 0:i.indexOf(nc.VISIBLE))&&(e.ol.set("visible",!e.visible,!1),e.ol.set("visible",!e.visible,!1),e.visible=e.visible),-1!==(null===(o=t.properties)||void 0===o?void 0:o.indexOf(nc.OPACITY))){var l=e.ol.get("opacity");e.ol.set("opacity",0,!1),e.ol.set("opacity",l,!1),e.opacity=e.opacity}if(-1!==(null===(n=t.properties)||void 0===n?void 0:n.indexOf(nc.MINRESOLUTION))){var c=e.ol.get("minResolution");e.ol.set("minResolution",0,!1),e.ol.set("minResolution",c,!1),e.minResolution=e.minResolution}if(-1!==(null===(r=t.properties)||void 0===r?void 0:r.indexOf(nc.MAXRESOLUTION))){var u=e.ol.get("maxResolution");e.ol.set("maxResolution",0,!1),e.ol.set("maxResolution",u,!1),e.minResolution=e.minResolution}if(-1!==(null===(a=t.properties)||void 0===a?void 0:a.indexOf(nc.OGCFILTERS))){var p=e.dataSource.ogcFilters$;p.next(p.value)}if(-1!==(null===(s=t.properties)||void 0===s?void 0:s.indexOf(nc.TIMEFILTER))){var d=e.dataSource.timeFilter$;d.next(d.value)}})})})}},{key:"transferCommonProperties",value:function(e){var t=this,i=e.key,o=e.target.getProperties(),n=o[i];if(-1!==["visible","opacity","minResolution","maxResolution"].indexOf(i)){var r=o.linkedLayers;if(r){var a=r.linkId,s=r.links;if(s){s.map(function(e){!e.properties||-1===e.properties.indexOf(i)||e.linkedIds.map(function(e){var o=t.map.layers.find(function(t){var i;return(null===(i=t.options.linkedLayers)||void 0===i?void 0:i.linkId)===e});o&&(o.ol.set(i,n,true),"visible"===i&&o.visible$.next(n))})})}else{this.map.layers.map(function(e){var t;(null===(t=e.options.linkedLayers)||void 0===t?void 0:t.links)&&e.options.linkedLayers.links.map(function(t){t.properties&&-1!==t.properties.indexOf(i)&&!1!==t.bidirectionnal&&-1!==t.linkedIds.indexOf(a)&&(e.ol.set(i,n,false),"visible"===i&&e.visible$.next(n))})})}}}}},{key:"transferOgcFiltersProperties",value:function(e){var t=this,i=this.ol.getProperties().linkedLayers;if(i){var o=i.linkId,n=i.links;n?n.map(function(i){!i.properties||-1===i.properties.indexOf(nc.OGCFILTERS)||i.linkedIds.map(function(i){var o=t.map.layers.find(function(e){var t;return(null===(t=e.options.linkedLayers)||void 0===t?void 0:t.linkId)===i});if(o){var n,r=o.ol.getProperties().sourceOptions.type;if(o.dataSource.setOgcFilters(e,!1),"wfs"===r&&o.ol.getSource().refresh(),"wms"===r)"wfs"===t.ol.getProperties().sourceOptions.type?n=t.ogcFilterWriter.handleOgcFiltersAppliedValue(t.layer.dataSource.options,t.dataSource.options.fieldNameGeometry,void 0,t.map.viewController.getOlProjection()):"wms"===t.ol.getProperties().sourceOptions.type&&(n=t.dataSource.ol.getParams().FILTER),o.dataSource.ol.updateParams({FILTER:n})}})}):this.map.layers.map(function(i){var n;(null===(n=i.options.linkedLayers)||void 0===n?void 0:n.links)&&i.options.linkedLayers.links.map(function(n){if(n.properties&&-1!==n.properties.indexOf(nc.OGCFILTERS)&&!1!==n.bidirectionnal&&-1!==n.linkedIds.indexOf(o)){var r,a=i.ol.getProperties().sourceOptions.type;if("wfs"===a&&(i.dataSource.setOgcFilters(e,!0),i.ol.getSource().refresh()),"wms"===a)"wfs"===t.ol.getProperties().sourceOptions.type?r=t.ogcFilterWriter.handleOgcFiltersAppliedValue(i.dataSource.options,t.dataSource.options.fieldNameGeometry,void 0,t.map.viewController.getOlProjection()):"wms"===t.ol.getProperties().sourceOptions.type&&(r=t.dataSource.ol.getParams().FILTER),i.dataSource.ol.updateParams({FILTER:r}),i.dataSource.setOgcFilters(e,!0)}})})}}},{key:"transferTimeFilterProperties",value:function(e){var t=this,i=this.ol.getProperties().linkedLayers;if(i){var o=i.linkId,n=i.links;n?n.map(function(i){!i.properties||-1===i.properties.indexOf(nc.TIMEFILTER)||i.linkedIds.map(function(i){var o=t.map.layers.find(function(e){var t;return e.dataSource instanceof Mc&&(null===(t=e.options.linkedLayers)||void 0===t?void 0:t.linkId)===i});if(o){o.dataSource.setTimeFilter(e,!1);var n=t.ol.getSource().getParams().TIME;o.dataSource.ol.updateParams({TIME:n})}})}):this.map.layers.filter(function(e){return e.dataSource instanceof Mc}).map(function(i){var n;(null===(n=i.options.linkedLayers)||void 0===n?void 0:n.links)&&i.options.linkedLayers.links.map(function(n){if(n.properties&&-1!==n.properties.indexOf(nc.TIMEFILTER)&&!1!==n.bidirectionnal&&-1!==n.linkedIds.indexOf(o)){var r=t.ol.getSource().getParams().TIME;i.dataSource.ol.updateParams({TIME:r}),i.dataSource.setTimeFilter(e,!0)}})})}}}]),i}(re),Pc=function(e){o(i,e);var t=r(i);function i(e){var o;return m(this,i),(o=t.call(this)).loaded=0,o.loading=0,o.source=e.options.source.ol,o.id=oe(),o}return y(i,[{key:"watch",value:function(){var e=this;this.source.on("tileloadstart",function(t){return e.handleLoadStart(t)}),this.source.on("tileloadend",function(t){return e.handleLoadEnd(t)}),this.source.on("tileloaderror",function(t){return e.handleLoadEnd(t)})}},{key:"unwatch",value:function(){var e=this;this.source.un("tileloadstart",function(t){return e.handleLoadStart(t)}),this.source.un("tileloadend",function(t){return e.handleLoadEnd(t)}),this.source.un("tileloaderror",function(t){return e.handleLoadEnd(t)})}},{key:"handleLoadStart",value:function(e){e.tile.__watchers__||(e.tile.__watchers__=[]),e.tile.__watchers__.push(this.id),this.loading+=1,this.status=ne.Working}},{key:"handleLoadEnd",value:function(e){if(e.tile.__watchers__){var t=e.tile.__watchers__.indexOf(this.id);if(!(t<0)){e.tile.__watchers__.splice(t,1),this.loaded+=1;var i=this.loading;this.loaded>=i&&i===this.loading&&(this.status=ne.Done,this.loaded=this.loading=0)}}}}]),i}(re),_c=function(e){o(i,e);var t=r(i);function i(){return m(this,i),t.apply(this,arguments)}return y(i,[{key:"createOlSource",value:function(){var e={format:this.getSourceFormatFromOptions(this.options)};return new el.Z(Object.assign(e,this.options))}},{key:"getSourceFormatFromOptions",value:function(e){if(e.format)return e.format;var t,i=e.formatType;if(i){if(void 0===(t=Ns[i]))throw new Error("Invalid vector source format ${formatType}.")}else t=Zs.Z;var o=e.formatOptions;return o?new t(o):new t}},{key:"onUnwatch",value:function(){}},{key:"queryTitle",get:function(){return this.options.queryTitle?this.options.queryTitle:"title"}}]),i}(fc),qc=function(e){o(n,e);var t=r(n);function n(){return m(this,n),t.apply(this,arguments)}return y(n,[{key:"createOlSource",value:function(){return this.options.format=this.getSourceFormatFromOptions(this.options),this.options.source=i(c(n.prototype),"createOlSource",this).call(this),new Ks.Z(this.options)}},{key:"generateId",value:function(){return oe()}},{key:"onUnwatch",value:function(){}}]),n}(_c),Dc=function(e){o(i,e);var t=r(i);function i(e){var o;return m(this,i),(o=t.call(this)).loaded=0,o.loading=0,o.layer=e,o.id=oe(),o}return y(i,[{key:"watch",value:function(){var e=this,t=this.layer.options.source.ol;this.layer.dataSource instanceof qc&&(t=this.layer.options.source.options.source),t.getUrl()&&(t.on("featuresloadstart",function(t){return e.handleLoadStart(t)}),t.on("featuresloadend",function(t){return e.handleLoadEnd(t)}),t.on("featuresloaderror",function(t){return e.handleLoadEnd(t)}))}},{key:"unwatch",value:function(){var e=this,t=this.layer.options.source.ol;this.layer.dataSource instanceof qc&&(t=this.layer.options.source.options.source),t.getUrl()&&(t.un("featuresloadstart",function(t){return e.handleLoadStart(t)}),t.un("featuresloadend",function(t){return e.handleLoadEnd(t)}),t.un("featuresloaderror",function(t){return e.handleLoadEnd(t)}))}},{key:"handleLoadStart",value:function(e){this.loading+=1,this.status=ne.Working}},{key:"handleLoadEnd",value:function(e){this.loaded+=1;var t=this.loading;this.loaded>=t&&t===this.loading&&(this.status=ne.Done,this.loaded=this.loading=0)}}]),i}(re);function Ec(e,t){var i,o,n,r,a,s,l,c,u,p,d,g,f,m,v,y,b,w,x,S,k,C,T,A,L,Z,F=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},O="4326",M=new RegExp("(\\s*;\\s*[\\d]{4,6})","g"),I="([-+])?([\\d]{1,3})([,.](\\d+))?",P="".concat(I,"[\\s,]+").concat(I),_=new RegExp("^".concat(P,"$"),"g"),q="([0-9]{1,2})[:|\xb0]?\\s*([0-9]{1,2})?[:|'|\u2032|\u2019]?\\s*([0-9]{1,2}(?:.[0-9]+){0,1})?\\s*[\"|\u2033|\u201d]?\\s*",D="".concat(q,"([N|S|E|W|O]),?\\s*").concat(q,"([N|S|E|W|O])"),E=new RegExp("^".concat(D,"$"),"gi"),$="(UTM)-?(\\d{1,2})[\\s,]*(\\d+[.,]?\\d+)[\\s,]+(\\d+[.,]?\\d+)",R=new RegExp("^".concat($),"gi"),N="(MTM)-?(\\d{1,2})[\\s,]*(\\d+[.,]?\\d+)[\\s,]+(\\d+[.,]?\\d+)",U=new RegExp("^".concat(N),"gi"),J="([-+])?(\\d{1,3})[,.](\\d+)",B="".concat(J,"\\s*[,]?\\s*").concat(J),j=new RegExp("^".concat(B),"g"),Q="([-+])?(\\d{1,3})[\\s,.]{1}(\\d{1,2})[\\s,.]{1}(\\d{1,2})[.,]?(\\d{1,5})?",G="".concat(Q,"\\s*[,.]?\\s*").concat(Q),Y=new RegExp("^".concat(G),"g"),z="LAT\\s*[\\s:]*\\s*([-+])?(\\d{1,2})[\\s.,]?(\\d+)?[\\s.,]?\\s*(\\d{1,2}([.,]\\d+)?)?\\s*(N|S|E|W)?\\s*LONG\\s*[\\s:]*\\s*([-+])?(\\d{1,3})[\\s.,]?(\\d+)?[\\s.,]?\\s*(\\d{1,2}([.,]\\d+)?)?\\s*(N|S|E|W)?\\s*UNC\\s*[\\s:]?\\s*(\\d+)\\s*CONF\\s*[\\s:]?\\s*(\\d{1,3})",V=new RegExp("^".concat(z,"?"),"gi"),H="([-+]?\\d+)[,.]?(\\d+)?",W="".concat(H,"[\\s,]+").concat(H),X=new RegExp("^".concat(W,"$"),"g"),K=!1;if(e=e.toLocaleUpperCase().trim(),M.test(e)?(c=(i=h(e.split(";").map(function(e){return e.trim()}),2))[0],Z=i[1]):c=e,_.test(c))u=(o=h(c.match(P),9))[1],A=o[2],m=o[4],v=o[5],L=o[6],S=o[8],A=parseFloat((u||"")+A+"."+m),L=parseFloat((v||"")+L+"."+S);else if(E.test(c))p=(n=h(c.match(D),9))[1],d=n[2],g=n[3],f=n[4],y=n[5],b=n[6],w=n[7],x=n[8],("S"===f||"N"===f)&&(p=[y,y=p][0],d=[b,b=d][0],g=[w,w=g][0],f=[x,x=f][0]),A=$c(parseFloat(p),parseFloat(d),parseFloat(g),f),L=$c(parseFloat(y),parseFloat(b),parseFloat(w),x);else if(R.test(c)){var ee;K=!0,k=(ee=h(c.match($),5))[2],A=ee[3],L=ee[4];var te=Number(k)<10?"EPSG:3260".concat(k):"EPSG:326".concat(k),ie=ls.vs([parseFloat(A),parseFloat(L)],te,"EPSG:4326"),oe=h(ie,2);A=oe[0],L=oe[1]}else if(U.test(c)){var ne;K=!0,k=(ne=h(c.match(N),5))[2],A=ne[3],L=ne[4];var re=Number(k)<10?"EPSG:3218".concat(k):"EPSG:321".concat(80+Number(k)),ae=ls.vs([parseFloat(A),parseFloat(L)],re,"EPSG:4326"),se=h(ae,2);A=se[0],L=se[1]}else if(Y.test(c))u=(r=h(c.match(G),11))[1],p=r[2],d=r[3],g=r[4],m=r[5],v=r[6],y=r[7],b=r[8],w=r[9],S=r[10],A=$c(parseFloat((u||"")+p),parseFloat(d),parseFloat(g),f),L=$c(parseFloat((v||"")+y),parseFloat(b),parseFloat(w),x);else if(j.test(c))u=(a=h(c.match(B),7))[1],p=a[2],m=a[3],v=a[4],y=a[5],S=a[6],A=$c(parseFloat((u||"")+p),parseFloat(d),parseFloat(g),f),L=$c(parseFloat((v||"")+y),parseFloat(b),parseFloat(w),x);else if(V.test(c))v=(s=h(c.match(z),15))[1],y=s[2],b=s[3],w=s[4],x=s[6],u=s[7],p=s[8],d=s[9],g=s[10],f=s[12],C=s[13],T=s[14],f||(f="W"),A=d&&d.length>2?parseFloat((u||"")+p+"."+d):$c(parseFloat(p),parseFloat(d),parseFloat(g),f),L=b&&b.length>2?parseFloat((v||"")+y+"."+b):$c(parseFloat(y),parseFloat(b),parseFloat(w),x);else{var le;if(!X.test(c))return{lonLat:void 0,message:"",radius:void 0,conf:void 0};K=!0,A=(le=h(c.match(W),5))[1],m=le[2],L=le[3],S=le[4],m&&(A=parseFloat(A+"."+m)),S&&(L=parseFloat(L+"."+S))}if(F.forceNA&&!K&&(A>0&&L>0&&(A>L?A=-A:L=-L),A>L&&(A=[L,L=A][0])),l=[Number(A),Number(L)],void 0!==Z&&Z!==O||l[0]>180||l[0]<-180||l[1]>90||l[1]<-90){te=Z?"EPSG:"+Z:t;var ce="EPSG:"+O;try{l=ls.vs(l,te,ce)}catch(ue){return{lonLat:void 0,message:"Projection "+te+" not supported",radius:void 0,conf:void 0}}}return Math.abs(l[0])<=180&&Math.abs(l[1])<=90?{lonLat:l,message:"",radius:C?parseInt(C,10):void 0,conf:T?parseInt(T,10):void 0}:{lonLat:void 0,message:"Coordinate out of Longitude/Latitude bounds",radius:void 0,conf:void 0}}function $c(e,t,i,o){t=t||0,i=i||0;var n=e<0,r=Math.abs(e)+t/60+i/3600;return(n||"S"===o||"W"===o)&&(r=-r),r}function Rc(e){return(e=Math.round(e))<1e4?e+"":(e=Math.round(e/1e3))<1e3?e+"K":(e=Math.round(e/1e3))+"M"}function Nc(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:96;return e/(39.3701*t)}function Uc(e){var t=e.originalEvent;return!t.altKey&&(tl.tK?t.metaKey:t.ctrlKey)&&!t.shiftKey}function Jc(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;return[ee.roundToNDecimal(e[0],t),ee.roundToNDecimal(e[1],t)]}var Bc=function(){function e(t,i,o){m(this,e),this.options=t,this.messageService=i,this.authInterceptor=o,this.legendCollapsed=!0,this.firstLoadComponent=!0,this.olLoadingProblem=!1,this.hasBeenVisible$=new R.X(void 0),this.isInResolutionsRange$=new R.X(!1),this.visible$=new R.X(void 0),this.displayed$=(0,J.aj)([this.isInResolutionsRange$,this.visible$]).pipe((0,D.U)(function(e){return e[0]&&e[1]})),this.dataSource=t.source,this.ol=this.createOlLayer(),void 0!==t.zIndex&&(this.zIndex=t.zIndex),t.baseLayer&&void 0===t.visible&&(t.visible=!1),this.maxResolution=t.maxResolution||Nc(Number(t.maxScaleDenom)),this.minResolution=t.minResolution||Nc(Number(t.minScaleDenom)),this.visible=void 0===t.visible||t.visible,this.opacity=void 0===t.opacity?1:t.opacity,t.legendOptions&&(t.legendOptions.url||t.legendOptions.html)&&(this.legend=this.dataSource.setLegend(t.legendOptions)),this.legendCollapsed=!t.legendOptions||!t.legendOptions.collapsed||t.legendOptions.collapsed,this.ol.set("_layer",this,!0)}return y(e,[{key:"isIgoInternalLayer",get:function(){return this.options.isIgoInternalLayer||!1}},{key:"id",get:function(){return this.options.id||this.dataSource.id}},{key:"alias",get:function(){return this.options.alias}},{key:"title",get:function(){return this.options.title},set:function(e){this.options.title=e}},{key:"zIndex",get:function(){return this.ol.getZIndex()},set:function(e){this.ol.setZIndex(e)}},{key:"baseLayer",get:function(){return this.options.baseLayer},set:function(e){this.options.baseLayer=e}},{key:"opacity",get:function(){return this.ol.get("opacity")},set:function(e){this.ol.setOpacity(e)}},{key:"isInResolutionsRange",get:function(){return this.isInResolutionsRange$.value},set:function(e){this.isInResolutionsRange$.next(e)}},{key:"maxResolution",get:function(){return this.ol.getMaxResolution()},set:function(e){this.ol.setMaxResolution(e||1/0),this.updateInResolutionsRange()}},{key:"minResolution",get:function(){return this.ol.getMinResolution()},set:function(e){this.ol.setMinResolution(e||0),this.updateInResolutionsRange()}},{key:"visible",get:function(){return this.visible$.value},set:function(e){var t,i,o=this;this.ol.setVisible(e),this.visible$.next(e),!this.hasBeenVisible$.value&&e&&this.hasBeenVisible$.next(e),(null===(t=this.options)||void 0===t?void 0:t.messages)&&e&&(null===(i=this.options)||void 0===i||i.messages.filter(function(e){var t;return null===(t=e.options)||void 0===t?void 0:t.showOnEachLayerVisibility}).map(function(e){return o.showMessage(e)}))}},{key:"displayed",get:function(){return this.visible&&this.isInResolutionsRange}},{key:"showInLayerList",get:function(){return!1!==this.options.showInLayerList}},{key:"setMap",value:function(e){var t=this;this.map=e,this.unobserveResolution(),void 0!==e?(this.observeResolution(),this.layerSyncWatcher=new Ic(this,this.map),this.layerSyncWatcher.subscribe(function(){}),this.hasBeenVisible$$=this.hasBeenVisible$.subscribe(function(){t.options.messages&&t.visible&&t.options.messages.map(function(e){t.showMessage(e)})})):this.layerSyncWatcher.unsubscribe()}},{key:"showMessage",value:function(e){!this.messageService||(e.title=e.title,e.text=e.text,this.messageService.message(e))}},{key:"observeResolution",value:function(){var e=this;this.resolution$$=this.map.viewController.resolution$.subscribe(function(){return e.updateInResolutionsRange()})}},{key:"unobserveResolution",value:function(){void 0!==this.resolution$$&&(this.resolution$$.unsubscribe(),this.resolution$$=void 0)}},{key:"updateInResolutionsRange",value:function(){if(void 0!==this.map){var e=this.map.viewController.getResolution(),t=void 0===this.maxResolution?1/0:this.maxResolution;this.isInResolutionsRange=e>=this.minResolution&&e<=t}else this.isInResolutionsRange=!1}}]),e}(),jc=function(e){o(n,e);var t=r(n);function n(e,i,o){var r;return m(this,n),(r=t.call(this,e,i,o)).messageService=i,r.authInterceptor=o,r.watcher=new Dc(s(r)),r.status$=r.watcher.status$,r}return y(n,[{key:"browsable",get:function(){return!1!==this.options.browsable}},{key:"exportable",get:function(){return!1!==this.options.exportable}},{key:"createOlLayer",value:function(){var e=this,t=Object.assign({},this.options,{source:this.options.source.ol});this.options.animation&&this.dataSource.ol.on("addfeature",(function(e){this.flash(e.feature)}).bind(this)),this.options.trackFeature&&this.enableTrackFeature(this.options.trackFeature);var i=new Fs.Z(t),o=i.getSource(),n=o.getUrl();if(n){var r,a=t.sourceOptions;(r="wfs"===(null==a?void 0:a.type)&&(a.params||a.paramsWFS)?function(t,i,n,r,s){e.customWFSLoader(o,a,e.authInterceptor,t,i,n,r,s)}:function(t,i,r,a,s){e.customLoader(o,n,e.authInterceptor,t,i,r,a,s)})&&o.setLoader(r)}return i}},{key:"flash",value:function(e){var t=(new Date).getTime(),i=this.ol.on("postrender",(function(o){var n=(0,Ps.u3)(o),r=o.frameState,a=e.getGeometry().clone(),s=r.time-t,l=s/this.options.animation.duration,c=(0,Ms.Vv)(1-l),u=(0,Is._2)(this.options.animation.color||"red");u[3]=c;var p=this.ol.getStyleFunction().call(this,e).find(function(e){return e.getImage()});p||(p=this.ol.getStyleFunction().call(this,e)[0]);var d=p.clone();switch(e.getGeometry().getType()){case"Point":var h=(0,Ms.Vv)(l)*(3*d.getImage().getRadius());d.getImage().setRadius(h),d.getImage().setOpacity(c);break;case"LineString":d.getImage()&&(d.getImage().getStroke().setColor(u),d.getImage().getStroke().setWidth((0,Ms.Vv)(l)*(3*d.getImage().getStroke().getWidth()))),d.getStroke()&&(d.getStroke().setColor(u),d.getStroke().setWidth((0,Ms.Vv)(l)*(3*d.getStroke().getWidth())));break;case"Polygon":d.getImage()&&d.getImage().getFill().setColor(u),d.getFill()&&d.getFill().setColor(u)}if(d.setText(""),n.setStyle(d),n.drawGeometry(a),s>this.options.animation.duration)return(0,Os.B)(i),void this.map.ol.render();this.map.ol.render()}).bind(this))}},{key:"setMap",value:function(e){void 0===e?this.watcher.unsubscribe():this.watcher.subscribe(function(){}),i(c(n.prototype),"setMap",this).call(this,e)}},{key:"onUnwatch",value:function(){this.dataSource.onUnwatch(),this.stopAnimation()}},{key:"stopAnimation",value:function(){this.dataSource.ol.un("addfeature",(function(e){this.visible&&this.flash(e.feature)}).bind(this))}},{key:"enableTrackFeature",value:function(e){this.trackFeatureListenerId=this.dataSource.ol.on("addfeature",this.trackFeature.bind(this,e))}},{key:"centerMapOnFeature",value:function(e){var t=this.dataSource.ol.getFeatureById(e);t&&this.map.ol.getView().setCenter(t.getGeometry().getCoordinates())}},{key:"trackFeature",value:function(e,t){t.feature.getId()===e&&this.visible&&this.centerMapOnFeature(e)}},{key:"disableTrackFeature",value:function(e){(0,Os.B)(this.trackFeatureListenerId)}},{key:"customWFSLoader",value:function(e,t,i,o,n,r,a,s,l){var c=t.paramsWFS,u=c.srsName?new qs.Z({code:c.srsName}):r,p=ls.$A(o,r,u);c.srsName=c.srsName||r.getCode();var d=Lc(t,p,u,t.ogcFilters,l),h=0;if("2.0.0"===c.version&&c.maxFeatures>Cc)for(var g=1e3;h<c.maxFeatures;){var f=d.replace("count="+c.maxFeatures,"count="+g);f=f.replace("startIndex=0","0"),(f+="&startIndex="+h).replace(/&&/g,"&"),this.getFeatures(e,i,p,u,r,f,g,a,s),h+=g}else this.getFeatures(e,i,p,u,r,d,c.maxFeatures,a,s)}},{key:"getFeatures",value:function(e,t,i,o,n,r,a,s,l){var c=this,u=this.dataSource.mostRecentIdCallOGCFilter,p=new XMLHttpRequest,d=t.alterUrlWithKeyAuth(r),h=r;d&&(h=d),p.open("GET",h),t&&t.interceptXhr(p,h);var g=function(){e.removeLoadedExtent(i),l()};p.onerror=g,p.onload=function(){if(200===p.status&&p.responseText.length>0){var t=e.getFormat().readFeatures(p.responseText,{dataProjection:o,featureProjection:n});u===c.dataSource.mostRecentIdCallOGCFilter?(e.addFeatures(t),s(t)):s([])}else g()},p.send()}},{key:"customLoader",value:function(e,t,i,o,n,r,a,s){var l=new XMLHttpRequest,c=t;if("function"!=typeof t){var u=i.alterUrlWithKeyAuth(t);u&&(c=u)}else c=t(o,n,r);l.open("GET",c);var p=e.getFormat();p.getType()===_s.Z.ARRAY_BUFFER&&(l.responseType="arraybuffer"),i&&i.interceptXhr(l,c);var d=function(){e.removeLoadedExtent(o),s()};l.onerror=d,l.onload=function(){if(!l.status||l.status>=200&&l.status<300){var t,i=p.getType();if(i===_s.Z.JSON||i===_s.Z.TEXT?t=l.responseText:i===_s.Z.XML?(t=l.responseXML)||(t=(new DOMParser).parseFromString(l.responseText,"application/xml")):i===_s.Z.ARRAY_BUFFER&&(t=l.response),t){var n=p.readFeatures(t,{extent:o,featureProjection:r});e.addFeatures(n,p.readProjection(t)),a(n)}else d()}else d()},l.send()}}]),n}(Bc),Qc=function(e){o(i,e);var t=r(i);function i(){return m(this,i),t.apply(this,arguments)}return y(i,[{key:"createOlSource",value:function(){return this.options.url||(this.options.url="https://tile.openstreetmap.org/{z}/{x}/{y}.png"),new il.Z(this.options)}},{key:"onUnwatch",value:function(){}}]),i}(fc),Gc=function(e){o(i,e);var t=r(i);function i(){return m(this,i),t.apply(this,arguments)}return y(i,[{key:"createOlSource",value:function(){return new ol.Z(this.options)}},{key:"onUnwatch",value:function(){}}]),i}(fc),Yc=function(e){o(i,e);var t=r(i);function i(e,o,n){var r;m(this,i),(r=t.call(this,Fc(e,"wfs"))).options=e,r.wfsService=o,r.authInterceptor=n,r.mostRecentIdCallOGCFilter=0,r.ogcFilters$=new R.X(void 0);var a=r.options.ogcFilters,s=r.options.paramsWFS.fieldNameGeometry||Tc,l=new bc;return r.options.ogcFilters=l.defineOgcFiltersDefaultOptions(a,s),r.options.ogcFilters.enabled&&r.options.ogcFilters.editable&&(e.sourceFields||[]).filter(function(e){return!e.values}).length>0&&r.wfsService.getSourceFieldsFromWFS(r.options),(null==a?void 0:a.pushButtons)&&(a.pushButtons.selectorType="pushButton"),(null==a?void 0:a.checkboxes)&&(a.checkboxes.selectorType="checkbox"),(null==a?void 0:a.radioButtons)&&(a.radioButtons.selectorType="radioButton"),(null==a?void 0:a.select)&&(a.select.selectorType="select"),r.setOgcFilters(r.options.ogcFilters,!0),r}return y(i,[{key:"ogcFilters",get:function(){return this.options.ogcFilters},set:function(e){this.options.ogcFilters=e}},{key:"createOlSource",value:function(){var e=this;return new el.Z({format:Oc(this.options),url:function(t,i,o){var n=e.options.paramsWFS,r=n.srsName?new qs.Z({code:n.srsName}):o,a=e.options.ogcFilters,s=ls.$A(t,o,r);return n.srsName=n.srsName||o.getCode(),Lc(e.options,s,r,a)},strategy:nl.VW})}},{key:"setOgcFilters",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.ogcFilters=e,this.mostRecentIdCallOGCFilter+=1,t&&this.ogcFilters$.next(this.ogcFilters)}},{key:"onUnwatch",value:function(){}}]),i}(fc),zc=function(){var e=function(e){o(i,e);var t=r(i);function i(e){var o;return m(this,i),(o=t.call(this)).http=e,o}return y(i,[{key:"getData",value:function(){return console.log("This is defining a data service."),"This is defining a data service."}},{key:"getSourceFieldsFromWFS",value:function(e){e.sourceFields&&0!==e.sourceFields.length?this.defineFieldAndValuefromWFS(e).subscribe(function(t){e.sourceFields.forEach(function(e){void 0===e.alias&&(e.alias=e.name),(void 0===e.values||0===e.values.length)&&(e.values=t.find(function(t){return t.name===e.name}).values)})}):(e.sourceFields=[],this.defineFieldAndValuefromWFS(e).subscribe(function(t){e.sourceFields=t}))}},{key:"wfsGetFeature",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Cc,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:kc,o=arguments.length>3?arguments[3]:void 0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=Zc(e,t,i,o,n,r).find(function(e){return"getfeature"===e.name}).value,s=e.paramsWFS.outputFormat;return r||Ac.test(s)||!s?this.http.get(a,{responseType:"text"}):this.http.get(a)}},{key:"defineFieldAndValuefromWFS",value:function(e){var t=this;return new Ne.y(function(i){var o,n,r,a,s,l,c=[];s=Oc(e);var u=JSON.parse(JSON.stringify(e));delete u.paramsWFS.outputFormat,delete u.formatOptions,l=Oc(u);var p=null===(o=e.sourceFields)||void 0===o?void 0:o.filter(function(e){return!e.values}).map(function(e){return e.name});t.wfsGetFeature(e,1,void 0,void 0,0,!0).pipe((0,Xa.b)(function(e){return String(e).toLowerCase().includes("exception")?(0,U.of)(!1):(0,U.of)(!0)}),(0,Xa.b)(function(i){return t.wfsGetFeature(e,1).pipe((0,Xa.b)(function(o){var c=s.readFeatures(o);n=c[0].getKeys(),(e.sourceFields||0===e.sourceFields.length)&&(p=n),r=n.filter(function(e){return p.includes(e)&&e!==c[0].getGeometryName()&&!e.match(/boundedby/gi)}),a=r.join(",");var u=[],d=0;if(!i&&"2.0.0"===e.paramsWFS.version&&e.paramsWFS.maxFeatures>Cc){for(;d<e.paramsWFS.maxFeatures;)u.push(t.wfsGetFeature(e,1e3,e.paramsWFS.srsName,a,d)),d+=1e3;l=s}else u.push(t.wfsGetFeature(e,e.paramsWFS.maxFeatures||Cc,e.paramsWFS.srsName,a,0,!0));return(0,J.aj)(u)}))})).subscribe(function(e){var o=[];e.map(function(e){var t=l.readFeatures(e);o=o.concat(t)}),t.built_properties_value(o).forEach(function(e){c.push(e)}),i.next(c),i.complete()})})}},{key:"built_properties_value",value:function(e){if(0===e.length)return[];var t=Object.assign({},e[0].getProperties());delete t[e[0].getGeometryName()],delete t.boundedBy;var i=[];for(var o in t)if(t.hasOwnProperty(o)){var n="object"==typeof e[0].get(o)?void 0:typeof e[0].get(o);i.push({name:o,alias:o,type:n,values:[t[o]]})}return e.every(function(e){var o=e.getProperties(),n=function(e){o.hasOwnProperty(e)&&e in t&&i.filter(function(t){return t.name===e}).forEach(function(t){-1===t.values.indexOf(o[e])&&t.values.push(o[e])})};for(var r in o)n(r);return!0}),i}}]),i}(function(){return function e(){m(this,e)}}());return e.\u0275fac=function(t){return new(t||e)(w.LFG(P.eN))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function Vc(e){for(var t=ls.U2(e||"EPSG:3857").getExtent(),i=(0,Cs.dz)(t)/256,o=new Array(20),n=new Array(20),r=0;r<20;++r)o[r]=i/Math.pow(2,r),n[r]=r;return new al.Z({origin:(0,Cs.rL)(t),resolutions:o,matrixIds:n})}var Hc=function(e){o(i,e);var t=r(i);function i(e){return m(this,i),t.call(this,e)}return y(i,[{key:"createOlSource",value:function(){var e=Object.assign({tileGrid:Vc(this.options.projection)},this.options);return new rl.Z(e)}},{key:"onUnwatch",value:function(){}}]),i}(fc),Wc=function(e){o(n,e);var t=r(n);function n(){return m(this,n),t.apply(this,arguments)}return y(n,[{key:"params",get:function(){return this.options.params}},{key:"queryTitle",get:function(){return this.options.queryTitle?this.options.queryTitle:"title"}},{key:"mapLabel",get:function(){return this.options.mapLabel}},{key:"queryHtmlTarget",get:function(){return this.options.queryHtmlTarget?this.options.queryHtmlTarget:Sc.BLANK}},{key:"createOlSource",value:function(){var e=Object.assign({crossOrigin:this.options.crossOrigin?this.options.crossOrigin:"anonymous"},this.options);return new sl.Z(e)}},{key:"getLegend",value:function(){var e=i(c(n.prototype),"getLegend",this).call(this);if(e.length>0)return e;var t="<table>";if(null!==this.options.config.layers[0].legend)return this.options.config.layers[0].legend.items.forEach(function(e){!0===e.visible&&(t+='<tr><td><p><font size="5" color="'+e.value+'"> &#9679</font></p></td><td>'+e.name+"</td></tr>")}),[{html:t+="</table>"}];for(var o=this.options.config.layers[0].options,r=0,a=["polygon-fill:","marker-fill:","shield-fill:","building-fill:","line-color:"];r<a.length;r++){var s=a[r];if(o.cartocss.includes(s)){var l=o.cartocss.split(s).pop(),u=l.substr(0,l.indexOf(";"));if(u.includes("ramp")){for(var p=u.split(", (")[1].split(","),d=u.split(", (")[2].split(","),h=0;h<p.length;h++)p[h]=p[h].replace(/("|\))/g,""),d[h]=d[h].replace(/("|\))/g,""),"="===d[h].replace(/\s+/g,"")&&(d[h]="Autres"),t+='<tr><td><p><font size="5" color="'+p[h]+'"> &#9679</font></p></td><td>'+d[h]+"</td></tr>";break}t+='<tr><td><p><font size="5" color="'+u+'"> &#9679</font></p></td><td>'+(o.layer_name?o.layer_name:"")+"</td></tr>";break}}return[{html:t+="</table>"}]}},{key:"onUnwatch",value:function(){}}]),n}(fc),Xc=function(e){o(n,e);var t=r(n);function n(){return m(this,n),t.apply(this,arguments)}return y(n,[{key:"createOlSource",value:function(){var e=new Js.Z;return new el.Z({attributions:this.options.params.attributions,overlaps:!1,format:e,url:(function(e,t,i){var o=this.options.url+"/"+this.options.layer+"/query/",n=["f=json","geometry=".concat(encodeURIComponent('{"xmin":'+e[0]+',"ymin":'+e[1]+',"xmax":'+e[2]+',"ymax":'+e[3]+',"spatialReference":{"wkid":102100}}')),"geometryType=esriGeometryEnvelope","inSR=102100","spatialRel=esriSpatialRelIntersects","outFields=*","returnGeometry=true","outSR=102100"];return this.options.params.time&&n.push("time=".concat(this.options.params.time)),this.options.params.customParams&&this.options.params.customParams.forEach(function(e){n.push(e)}),"".concat(o,"?").concat(n.join("&"))}).bind(this),strategy:nl.VW})}},{key:"getLegend",value:function(){var e=this.options.legendInfo,t=i(c(n.prototype),"getLegend",this).call(this);if(void 0===e||t.length>0)return t;if(e){var o,r="<table>";if(e.legend){var a,s=p(e.legend);try{for(s.s();!(a=s.n()).done;){var l=a.value;r+="<tr><td align='left'><img src=\""+this.htmlImgSrc(l.contentType,l.imageData)+'" alt =\'\' /></td><td class="mat-typography">'+(o=l.label?l.label.replace("<Null>","Null"):"")+"</td></tr>"}}catch(g){s.e(g)}finally{s.f()}}else if("uniqueValue"===e.type){var u,d=p(e.uniqueValueInfos);try{for(d.s();!(u=d.n()).done;){var h=u.value;o=h.label.replace("<Null>","Null"),"esriPMS"===h.symbol.type?r+="<tr><td align='left'><img src=\""+this.htmlImgSrc(h.symbol.contentType,h.symbol.imageData)+'" alt =\'\' /></td><td class="mat-typography">'+o+"</td></tr>":"esriPMS"!==h.symbol.type&&(r+="<tr><td align='left'>"+this.createSVG(h.symbol)+'</td><td class="mat-typography">'+o+"</td></tr>")}}catch(g){d.e(g)}finally{d.f()}}else"simple"===e.type&&(o=e.label?e.label.replace("<Null>","Null"):"","esriPMS"===e.symbol.type?r+="<tr><td align='left'><img src=\""+this.htmlImgSrc(e.symbol.contentType,e.symbol.imageData)+'" alt =\'\' /></td><td class="mat-typography">'+o+"</td></tr>":"esriPMS"!==e.symbol.type&&(r+="<tr><td align='left'>"+this.createSVG(e.symbol)+'</td><td class="mat-typography">'+o+"</td></tr>"));return[{html:r+="</table>"}]}}},{key:"htmlImgSrc",value:function(e,t){return"data:".concat(e,";base64,").concat(t)}},{key:"createSVG",value:function(e){var t="",i=e.color?e.color:[0,0,0,0];if("esriSLS"===e.type){var o="stroke:rgba("+i[0]+","+i[1]+","+i[2]+","+i[3]+")",n="stroke-width:"+(e.width?e.width:0);"esriSLSSolid"===e.style?t='<svg height="30" width="30"><line x1="0" y1="15" x2="30" y2="15" style="'+o+";"+n+'"/></svg>':"esriSLSDash"===e.style&&(t='<svg height="30" width="30"><line x1="0" y1="15" x2="30" y2="15" style="'+o+";"+n+'" stroke-dasharray="5,5"/></svg>')}else if("esriSMSCircle"===e.style||"esriSFSSolid"===e.style){var r=e.outline.color,a=e.size,s="stroke:rgba("+r[0]+","+r[1]+","+r[2]+","+r[3]+")",l="stroke-width:"+e.outline.width,c="fill:rgba("+i[0]+","+i[1]+","+i[2]+","+i[3]+")";t="esriSMSCircle"===e.style?'<svg height="30" width="30"><circle cx="15" cy="15" r="'+a/2+'" style="'+s+";"+l+";"+c+'"/></svg>':'<svg height="30" width="30"><rect x="5" y="5" width="20" height="20" style ="'+s+";"+l+";"+c+'"/></svg>'}return t}},{key:"onUnwatch",value:function(){}}]),n}(fc),Kc=function(e){o(n,e);var t=r(n);function n(){return m(this,n),t.apply(this,arguments)}return y(n,[{key:"params",get:function(){return this.options.params}},{key:"queryTitle",get:function(){return this.options.queryTitle?this.options.queryTitle:"title"}},{key:"mapLabel",get:function(){return this.options.mapLabel}},{key:"queryHtmlTarget",get:function(){return this.options.queryHtmlTarget?this.options.queryHtmlTarget:Sc.BLANK}},{key:"createOlSource",value:function(){var e=void 0===this.options.layer?this.options.params:Object.assign({LAYERS:"show:".concat(this.options.layer)},this.options.params);return"object"==typeof e.renderingRule&&(e.renderingRule=JSON.stringify(e.renderingRule)),new ll.Z({ratio:1,params:e,url:this.options.url})}},{key:"getLegend",value:function(){var e=this.options.legendInfo,t=i(c(n.prototype),"getLegend",this).call(this);if(void 0===e||void 0===this.options.layer||t.length>0)return t;if(e){var o,r="<table>",a=p(e.legend);try{for(a.s();!(o=a.n()).done;){var s=o.value;r+="<tr><td align='left'><img src=\"".concat(this.options.url,"/").concat(e.layerId,"/images/").concat(s.url,'" alt =\'\' /></td><td class="mat-typography">')+s.label.replace("<Null>","Null")+"</td></tr>"}}catch(l){a.e(l)}finally{a.f()}return[{html:r+="</table>"}]}}},{key:"onUnwatch",value:function(){}}]),n}(fc),eu=function(e){o(n,e);var t=r(n);function n(){return m(this,n),t.apply(this,arguments)}return y(n,[{key:"params",get:function(){return this.options.params}},{key:"queryTitle",get:function(){return this.options.queryTitle?this.options.queryTitle:"title"}},{key:"mapLabel",get:function(){return this.options.mapLabel}},{key:"queryHtmlTarget",get:function(){return this.options.queryHtmlTarget?this.options.queryHtmlTarget:Sc.BLANK}},{key:"createOlSource",value:function(){return new cl.Z(this.options)}},{key:"getLegend",value:function(){var e=this.options.legendInfo,t=i(c(n.prototype),"getLegend",this).call(this);if(void 0===e||void 0===this.options.layer||t.length>0)return t;if(e){var o,r="<table>",a=p(e.legend);try{for(a.s();!(o=a.n()).done;){var s=o.value;r+="<tr><td align='left'><img src=\"".concat(this.options.url,"/").concat(e.layerId,"/images/").concat(s.url,'" alt =\'\' /></td><td class="mat-typography">')+s.label.replace("<Null>","Null")+"</td></tr>"}}catch(l){a.e(l)}finally{a.f()}return[{html:r+="</table>"}]}}},{key:"onUnwatch",value:function(){}}]),n}(fc),tu=function(e){o(i,e);var t=r(i);function i(){return m(this,i),t.apply(this,arguments)}return y(i,[{key:"createOlSource",value:function(){var e=JSON.parse(JSON.stringify(this.options));return this.options.tileGrid&&(delete e.tileGrid,e.tileGrid=new pl.Z(this.options.tileGrid)),new ul.Z(e)}},{key:"onUnwatch",value:function(){}}]),i}(fc),iu=function(e){o(n,e);var t=r(n);function n(){return m(this,n),t.apply(this,arguments)}return y(n,[{key:"createOlSource",value:function(){return this.createWebSocket(),this.options.format=this.getSourceFormatFromOptions(this.options),i(c(n.prototype),"createOlSource",this).call(this)}},{key:"createWebSocket",value:function(){this.ws=new WebSocket(this.options.url),this.ws.onmessage=this.onMessage.bind(this),this.options.onclose&&(this.ws.onclose=this.onClose.bind(this)),this.options.onerror&&(this.ws.onerror=this.onError.bind(this)),this.options.onopen&&(this.ws.onopen=this.onOpen.bind(this))}},{key:"onMessage",value:function(e){var t=this.options.format.readFeature(e.data);switch(this.options.onmessage){case"update":var i=this.ol.getFeatureById(t.getId());i&&this.ol.removeFeature(i),this.ol.addFeature(t);break;case"delete":this.ol.clear(!0),this.ol.addFeature(t);break;case"add":default:this.ol.addFeature(t)}}},{key:"onClose",value:function(e){}},{key:"onError",value:function(e){}},{key:"onOpen",value:function(e){}},{key:"onUnwatch",value:function(){this.ws.close()}}]),n}(_c),ou=function(e){o(i,e);var t=r(i);function i(){return m(this,i),t.apply(this,arguments)}return y(i,[{key:"createOlSource",value:function(){var e;return e="feature"===this.options.featureClass?new hl.Z({featureClass:ns.Z}):new hl.Z,this.options.format=e,new dl.Z(this.options)}},{key:"generateId",value:function(){return this.options.url?ha.V.hashStr("mvt"+this.options.url):oe()}},{key:"onUnwatch",value:function(){}}]),i}(fc),nu=function(){function e(){m(this,e),this._converters={},this._converters.esriPMS=e._convertEsriPMS,this._converters.esriSFS=e._convertEsriSFS,this._converters.esriSLS=e._convertEsriSLS,this._converters.esriSMS=e._convertEsriSMS,this._converters.esriTS=e._convertEsriTS,this._renderers={},this._renderers.uniqueValue=this._renderUniqueValue,this._renderers.simple=this._renderSimple,this._renderers.classBreaks=this._renderClassBreaks}return y(e,[{key:"_convertLabelingInfo",value:function(t,i){for(var o=[],n=0,r=t.length;n<r;++n){var a=t[n].labelExpression,s=a.substr(a.indexOf("[")+1,a.indexOf("]")-1),l=t[n].symbol,c=t[n].maxScale,u=t[n].minScale,p=null;0!==c&&(p=e._getResolutionForScale(c,i));var d=null;0!==u&&(d=e._getResolutionForScale(u,i));var h=this._converters[l.type].call(this,l);o.push((function(e,t){var i=!0;if(null!==this.minResolution&&null!==this.maxResolution?i=t<this.maxResolution&&t>=this.minResolution:null!==this.minResolution?i=t>=this.minResolution:null!==this.maxResolution&&(i=t<this.maxResolution),i){var o=e.get(this.field);return this.style.getText().setText(o),[this.style]}}).bind({minResolution:p,maxResolution:d,field:s,style:h}))}return o}},{key:"_renderSimple",value:function(e){var t=this._converters[e.symbol.type].call(this,e.symbol);return function(){return[t]}}},{key:"_renderClassBreaks",value:function(e){for(var t=e.defaultSymbol,i=this._converters[t.type].call(this,t),o=e.field,n=[],r=0,a=e.classBreakInfos.length;r<a;++r){var s,l=e.classBreakInfos[r];s=null==l.classMinValue?0===r?e.minValue:e.classBreakInfos[r-1].classMaxValue:l.classMinValue;var c=l.classMaxValue,u=l.symbol,p=this._converters[u.type].call(this,u);n.push({min:s,max:c,style:p})}return function(e){for(var t=e.get(o),r=0,a=n.length;r<a;++r){if(0===r?t>=n[r].min&&t<=n[r].max:t>n[r].min&&t<=n[r].max)return[n[r].style]}return[i]}}},{key:"_renderUniqueValue",value:function(e){var t=e.defaultSymbol,i=[];t&&(i=[this._converters[t.type].call(this,t)]);var o=e.field1,n=e.uniqueValueInfos,r=this;return function(){for(var e={},t=0,a=n.length;t<a;++t){var s=n[t],l=s.symbol;e[s.value]=[r._converters[l.type].call(r,l)]}return function(t){return e[t.get(o)]||i}}()}},{key:"generateStyle",value:function(e,t){var i=e.drawingInfo,o=[],n=this._renderers[i.renderer.type].call(this,i.renderer);if(void 0!==n&&o.push(n),e.labelingInfo){var r=this._convertLabelingInfo(e.labelingInfo,t);o=o.concat(r)}return 1===o.length?o[0]:function(e,t){for(var i=[],n=0,r=o.length;n<r;++n){var a=o[n].call(null,e,t);a&&(i=i.concat(a))}return i}}}],[{key:"_convertPointToPixel",value:function(e){return e/.75}},{key:"_transformColor",value:function(e){return[e[0],e[1],e[2],e[3]/255]}},{key:"_getResolutionForScale",value:function(e,t){var i=ls.Wm[t];return parseFloat(e)/(39.3701*i*96)}},{key:"_convertEsriTS",value:function(t){var i=e._transformAngle(t.angle),o=void 0!==t.text?t.text:void 0;return new ms.ZP({text:new vs.Z({fill:new ys.Z({color:e._transformColor(t.color)}),font:t.font.style+" "+t.font.weight+" "+t.font.size+" px "+t.font.family,textBaseline:t.verticalAlignment,textAlign:t.horizontalAlignment,offsetX:e._convertPointToPixel(t.xoffset),offsetY:e._convertPointToPixel(t.yoffset),rotation:i,text:o})})}},{key:"_convertEsriPMS",value:function(t){var i="data:"+t.contentType+";base64, "+t.imageData,o=e._transformAngle(t.angle);return new ms.ZP({image:new bs.Z({src:i,rotation:o})})}},{key:"_convertEsriSFS",value:function(t){var i=new ys.Z({color:e._transformColor(t.color)}),o=t.outline?e._convertOutline(t.outline):void 0;return new ms.ZP({fill:i,stroke:o})}},{key:"_convertOutline",value:function(t){var i,o=e._transformColor(t.color);return"esriSLSDash"===t.style?i=[5]:"esriSLSDashDot"===t.style?i=[5,5,1,2]:"esriSLSDashDotDot"===t.style?i=[5,5,1,2,1,2]:"esriSLSDot"===t.style?i=[1,2]:"esriSLSNull"===t.style&&(o[3]=0),new ws.Z({color:o,lineDash:i,width:e._convertPointToPixel(t.width)})}},{key:"_convertEsriSLS",value:function(t){return new ms.ZP({stroke:e._convertOutline(t)})}},{key:"_transformAngle",value:function(e){if(0!==e&&void 0!==e){var t=-e*Math.PI/180+Math.PI/2;return t<0?2*Math.PI+t:t}}},{key:"_convertEsriSMS",value:function(t){var i=new ys.Z({color:e._transformColor(t.color)}),o=t.outline?e._convertOutline(t.outline):void 0,n=e._convertPointToPixel(t.size)/2,r=e._transformAngle(t.angle);return"esriSMSCircle"===t.style?new ms.ZP({image:new xs.Z({radius:n,fill:i,stroke:o})}):"esriSMSCross"===t.style?new ms.ZP({image:new Ss.Z({fill:i,stroke:o,points:4,radius:n,radius2:0,angle:0,rotation:r})}):"esriSMSDiamond"===t.style?new ms.ZP({image:new Ss.Z({fill:i,stroke:o,points:4,radius:n,rotation:r})}):"esriSMSSquare"===t.style?new ms.ZP({image:new Ss.Z({fill:i,stroke:o,points:4,radius:n,angle:Math.PI/4,rotation:r})}):"esriSMSX"===t.style?new ms.ZP({image:new Ss.Z({fill:i,stroke:o,points:4,radius:n,radius2:0,angle:Math.PI/4,rotation:r})}):"esriSMSTriangle"===t.style?new ms.ZP({image:new Ss.Z({fill:i,stroke:o,points:3,radius:n,angle:0,rotation:r})}):void 0}}]),e}(),ru=function(){return(e=ru||(ru={})).DATE="date",e.TIME="time",e.DATETIME="datetime",e.YEAR="year",ru;var e}(),au=function(){return(e=au||(au={})).CALENDAR="calendar",e.SLIDER="slider",au;var e}(),su=function(){var e=function(){function e(){m(this,e)}return y(e,[{key:"getMap",value:function(){return this.map}},{key:"setMap",value:function(e){this.map=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),lu=function(){return(e=lu||(lu={})).wms="wms",e.wmts="wmts",e.arcgisrest="esriJSON",e.imagearcgisrest="esriJSON",e.tilearcgisrest="esriJSON",lu;var e}(),cu=function(){var e=function(){function e(t,i){m(this,e),this.http=t,this.mapService=i,this.parsers={wms:new Ys.Z,wmts:new zs.Z,esriJSON:new Js.Z}}return y(e,[{key:"getWMSOptions",value:function(e){var t=this;return this.getCapabilities("wms",e.url,e.params.VERSION).pipe((0,D.U)(function(i){return i?t.parseWMSOptions(e,i):void 0}))}},{key:"getWMTSOptions",value:function(e){var t=this;return this.getCapabilities("wmts",e.url,e.version).pipe((0,D.U)(function(i){return i?t.parseWMTSOptions(e,i):void 0}))}},{key:"getCartoOptions",value:function(e){var t=this;return this.http.jsonp("https://"+e.account+".carto.com/api/v2/viz/"+e.mapId+"/viz.json","callback").pipe((0,D.U)(function(i){return t.parseCartoOptions(e,i)}))}},{key:"getArcgisOptions",value:function(e){var t=this,i=e.url+"/"+e.layer+"?f=json",o=e.url.replace("FeatureServer","MapServer")+"/legend?f=json",n=this.getCapabilities("arcgisrest",e.url),r=this.http.get(i),a=this.http.get(o).pipe((0,D.U)(function(e){return e}),(0,q.K)(function(e){return console.log("No legend associated with this Feature Service"),(0,U.of)(e)}));return(0,Ya.D)([r,a,n]).pipe((0,D.U)(function(i){return t.parseArcgisOptions(e,i[0],i[1],i[2])}))}},{key:"getImageArcgisOptions",value:function(e){var t=this,i=e.url+"/"+e.layer+"?f=json",o=e.url.replace("FeatureServer","MapServer")+"/legend?f=json",n=this.getCapabilities("imagearcgisrest",e.url),r=this.http.get(i),a=this.http.get(o).pipe((0,D.U)(function(e){return e}),(0,q.K)(function(e){return console.log("No legend associated with this Image Service"),(0,U.of)(e)}));return(0,Ya.D)([r,a,n]).pipe((0,D.U)(function(i){return t.parseTileOrImageArcgisOptions(e,i[0],i[1],i[2])}))}},{key:"getTileArcgisOptions",value:function(e){var t=this,i=e.url+"/"+e.layer+"?f=json",o=e.url+"/legend?f=json",n=this.getCapabilities("tilearcgisrest",e.url),r=this.http.get(i),a=this.http.get(o).pipe((0,D.U)(function(e){return e}),(0,q.K)(function(e){return console.log("No legend associated with this Tile Service"),(0,U.of)(e)}));return(0,Ya.D)([r,a,n]).pipe((0,D.U)(function(i){return t.parseTileOrImageArcgisOptions(e,i[0],i[1],i[2])}))}},{key:"getCapabilities",value:function(e,t,i){var o=this,n=new P.LE({fromObject:{request:"GetCapabilities",service:e.toUpperCase(),version:i||"1.3.0",_i:"true"}});return("esriJSON"===lu[e]?this.http.get(t+"?f=json"):this.http.get(t,{params:n,responseType:"text"})).pipe((0,D.U)(function(t){if("esriJSON"===lu[e])return t;if(String(t).toLowerCase().includes("serviceexception")&&String(t).toLowerCase().includes("access denied"))throw{error:{message:"Service error getCapabilities: Access is denied"}};return o.parsers[e].read(t)}),(0,q.K)(function(e){throw void 0!==e.error&&(e.error.caught=!0),e}))}},{key:"parseWMSOptions",value:function(e,t){var i=this.findDataSourceInCapabilities(t.Capability.Layer,e.params.LAYERS);if(!i)throw{error:{message:"Layer not found"}};var o=i.DataURL?i.DataURL[0]:void 0,n=i.Abstract?i.Abstract:void 0,r=i.KeywordList?i.KeywordList:void 0,a=i.queryable,s=this.getTimeFilter(i),l=s&&Object.keys(s).length>0,c=i.Style?this.getStyle(i.Style):void 0,u=!0;i.EX_GeographicBoundingBox?i.EX_GeographicBoundingBox.forEach(function(e,t){t<2&&(e>180||e<-180)&&(u=!1),t>=2&&(e>90||e<-90)&&(u=!1)}):u=!1;for(var p,d=u?ls.$A(i.EX_GeographicBoundingBox,"EPSG:4326",this.mapService.getMap().projection):void 0,h=[xc.GEOJSON,xc.GEOJSON2,xc.GML3,xc.GML2,xc.JSON,xc.HTML],g=function(){var e=m[f];if(-1!==t.Capability.Request.GetFeatureInfo.Format.indexOf(e)){var i=Object.keys(xc).find(function(t){return xc[t]===e});return p=wc[i],"break"}},f=0,m=h;f<m.length;f++){if("break"===g())break}p||(a=!1);var v=K.removeUndefined({_layerOptionsFromSource:{title:i.Title,maxResolution:Nc(i.MaxScaleDenominator),minResolution:Nc(i.MinScaleDenominator),extent:d,metadata:{url:o?o.OnlineResource:void 0,extern:!!o||void 0,abstract:n,keywordList:r},legendOptions:c},queryable:a,queryFormat:p,timeFilter:l?s:void 0,timeFilterable:!!l||void 0,minDate:l?s.min:void 0,maxDate:l?s.max:void 0,stepDate:l?s.step:void 0});return K.mergeDeep(v,e)}},{key:"parseWMTSOptions",value:function(e,t){var i=t.Contents.Layer.find(function(t){return t.Identifier===e.layer}),o=(0,rl.B)(t,e),n=Object.assign(o,e),r=K.removeUndefined({_layerOptionsFromSource:{title:i.Title}});return K.mergeDeep(r,n)}},{key:"parseCartoOptions",value:function(e,t){var i=[],o=t.layers[1].options.layer_definition;o.layers.forEach(function(e){i.push({type:e.type.toLowerCase(),options:e.options,legend:e.legend})});var n=K.removeUndefined({config:{version:o.version,layers:i}});return K.mergeDeep(n,e)}},{key:"parseArcgisOptions",value:function(e,t,i,o){var n,r,a,s=t.name;r=i.layers?i.layers.find(function(e){return e.layerName===s}):(null===(n=t.drawingInfo)||void 0===n?void 0:n.renderer)?t.drawingInfo.renderer:void 0,t.drawingInfo&&(a=(new nu).generateStyle(t,"esriMeters"===t.units?"m":"degrees"));var l,c,u=new as.Z({target:t.copyrightText});if(t.timeInfo){var p=t.timeInfo.timeExtent;l=p[0]+","+p[1];var d=new Date;d.setTime(p[0]);var h=new Date;h.setTime(p[1]),c={min:d.toUTCString(),max:h.toUTCString(),range:!0,type:ru.DATETIME,style:au.CALENDAR}}var g=Object.assign({},{style:a,LAYERS:e.layer?"show:"+e.layer:void 0,time:l}),f=K.removeUndefined({params:g,_layerOptionsFromSource:{title:s,minResolution:Nc(t.maxScale),maxResolution:Nc(t.minScale),metadata:{extern:!1,abstract:t.description||o.serviceDescription}},legendInfo:r,timeFilter:c,sourceFields:t.fields,queryTitle:t.displayField});return f.attributions=u,K.mergeDeep(f,e)}},{key:"parseTileOrImageArcgisOptions",value:function(e,t,i,o){var n,r,a=t.name,s=i.layers?i.layers.find(function(e){return e.layerName===a}):void 0,l=new as.Z({target:t.copyrightText});if(t.timeInfo){var c=t.timeInfo.timeExtent;n=c[0]+","+c[1];var u=new Date;u.setTime(c[0]);var p=new Date;p.setTime(c[1]),r={min:u.toUTCString(),max:p.toUTCString(),range:!0,type:ru.DATETIME,style:au.CALENDAR}}var d=Object.assign({},{LAYERS:e.layer?"show:"+e.layer:void 0,time:n}),h=K.removeUndefined({params:d,_layerOptionsFromSource:{title:a,minResolution:Nc(t.maxScale),maxResolution:Nc(t.minScale),metadata:{extern:!1,abstract:t.description||o.serviceDescription}},legendInfo:s,timeFilter:r,sourceFields:t.fields,queryTitle:t.displayField});return h.attributions=l,K.mergeDeep(h,e)}},{key:"findDataSourceInCapabilities",value:function(e,t){var i,o=this;return Array.isArray(e)?(e.find(function(e){return void 0!==(i=o.findDataSourceInCapabilities(e,t))},this),i):e.Layer?this.findDataSourceInCapabilities(e.Layer,t):e.Name&&e.Name===t?e:void 0}},{key:"getTimeFilter",value:function(e){var t;if(e.Dimension){var i={};if((t=e.Dimension[0]).values){var o=t.values.split("/");i.min=void 0!==o[0]?o[0]:void 0,i.max=void 0!==o[1]?o[1]:void 0,i.step=void 0!==o[2]?o[2]:void 0}return t.default&&(i.value=t.default),i}}},{key:"getStyle",value:function(e){return{stylesAvailable:e.map(function(e){return{name:e.Name,title:e.Title}}).filter(function(e,t,i){return i.findIndex(function(t){return t.name===e.name})===t})}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(P.eN),w.LFG(su))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),(0,at.gn)([(0,st.q)({maxCacheCount:20})],e.prototype,"getCapabilities",null),e}(),uu=function e(){m(this,e)},pu=function(){var e=function(){function e(t){var i=this;m(this,e),this.config=t,(this.config.getConfig("projections")||[]).forEach(function(e){e.alias=e.alias?e.alias:e.code,i.registerProjection(e)});for(var o=1;o<61;o++)this.registerProjection({code:o<10?"EPSG:3260".concat(o):"EPSG:326".concat(o),def:"+proj=utm +zone=".concat(o," +datum=WGS84 +units=m +no_defs"),extent:void 0});for(var n=1;n<11;n++){var r,a=n<10?"EPSG:3218".concat(n):"EPSG:321".concat(80+n);r=Number(n)<=2?-50-3*Number(n):Number(n)>=12?-81-3*(Number(n)-12):-49.5-3*Number(n),this.registerProjection({code:a,def:"+proj=tmerc +lat_0=0 +lon_0=".concat(r,' +k=0.9999 +x_0=304800 +y_0=0 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"'),extent:void 0})}}return y(e,[{key:"registerProjection",value:function(e){ks.Z.defs(e.code,e.def),cs.z(ks.Z),e.extent&&ls.U2(e.code).setExtent(e.extent)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(he))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),du=function(){var e=function(){function e(t,i,o,n,r,a,s){m(this,e),this.capabilitiesService=t,this.optionsService=i,this.wfsDataSourceService=o,this.languageService=n,this.messageService=r,this.projectionService=a,this.authInterceptor=s,this.datasources$=new R.X([])}return y(e,[{key:"createAsyncDataSource",value:function(e,t){if(!e.type)throw console.error(e),new Error("Datasource needs a type");var i;switch(e.type.toLowerCase()){case"osm":i=this.createOSMDataSource(e);break;case"vector":i=this.createFeatureDataSource(e);break;case"wfs":i=this.createWFSDataSource(e);break;case"wms":var o=e;K.removeDuplicateCaseInsensitive(o.params),i=this.createWMSDataSource(o,t);break;case"wmts":i=this.createWMTSDataSource(e);break;case"xyz":i=this.createXYZDataSource(e);break;case"tiledebug":i=this.createTileDebugDataSource(e);break;case"carto":i=this.createCartoDataSource(e);break;case"arcgisrest":i=this.createArcGISRestDataSource(e,t);break;case"imagearcgisrest":i=this.createArcGISRestImageDataSource(e,t);break;case"websocket":i=this.createWebSocketDataSource(e);break;case"mvt":i=this.createMVTDataSource(e);break;case"tilearcgisrest":i=this.createTileArcGISRestDataSource(e,t);break;case"cluster":i=this.createClusterDataSource(e);break;default:throw console.error(e),new Error("Invalid datasource type")}return this.datasources$.next(this.datasources$.value.concat([i])),i}},{key:"createOSMDataSource",value:function(e){return new Ne.y(function(t){return t.next(new Qc(e))})}},{key:"createFeatureDataSource",value:function(e){return new Ne.y(function(t){return t.next(new _c(e))})}},{key:"createWebSocketDataSource",value:function(e){return new Ne.y(function(t){return t.next(new iu(e))})}},{key:"createWFSDataSource",value:function(e){var t=this;return new Ne.y(function(i){return i.next(new Yc(e,t.wfsDataSourceService,t.authInterceptor))})}},{key:"createWMSDataSource",value:function(e,t){var i=this,o=[];return e.optionsFromCapabilities&&o.push(this.capabilitiesService.getWMSOptions(e).pipe((0,q.K)(function(t){var o=i.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),n=i.languageService.translate.instant("igo.geo.dataSource.unavailable",{value:e.params.LAYERS});throw i.messageService.error(n,o),t}))),this.optionsService&&!0===e.optionsFromApi&&o.push(this.optionsService.getWMSOptions(e,t).pipe((0,q.K)(function(e){return e.error.toDisplay=!0,e.error.title=i.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),e.error.message=i.languageService.translate.instant("igo.geo.dataSource.optionsApiUnavailable"),(0,U.of)({})}))),o.push((0,U.of)(e)),(0,Ya.D)(o).pipe((0,D.U)(function(e){var t=e.reduce(function(e,t){return K.mergeDeep(e,t)});return new Mc(t,i.wfsDataSourceService)}),(0,q.K)(function(){return(0,U.of)(void 0)}))}},{key:"createWMTSDataSource",value:function(e){var t=this;return e.optionsFromCapabilities?this.capabilitiesService.getWMTSOptions(e).pipe((0,D.U)(function(e){return e?new Hc(e):void 0}),(0,q.K)(function(){var i=t.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),o=t.languageService.translate.instant("igo.geo.dataSource.unavailable",{value:e.layer});return t.messageService.error(o,i),(0,U.of)(void 0)})):new Ne.y(function(t){return t.next(new Hc(e))})}},{key:"createXYZDataSource",value:function(e){return new Ne.y(function(t){return t.next(new Gc(e))})}},{key:"createTileDebugDataSource",value:function(e){return new Ne.y(function(t){return t.next(new tu(e))})}},{key:"createCartoDataSource",value:function(e){return e.mapId?this.capabilitiesService.getCartoOptions(e).pipe((0,D.U)(function(e){return new Wc(e)})):new Ne.y(function(t){return t.next(new Wc(e))})}},{key:"createArcGISRestDataSource",value:function(e,t){var i=this,o=[];return o.push(this.capabilitiesService.getArcgisOptions(e).pipe((0,q.K)(function(t){var o=i.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),n=i.languageService.translate.instant("igo.geo.dataSource.unavailable",{value:e.layer});throw i.messageService.error(n,o),t}))),this.optionsService&&!0===e.optionsFromApi&&o.push(this.optionsService.getArcgisRestOptions(e,t).pipe((0,q.K)(function(e){return e.error.toDisplay=!0,e.error.title=i.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),e.error.message=i.languageService.translate.instant("igo.geo.dataSource.optionsApiUnavailable"),(0,U.of)({})}))),o.push((0,U.of)(e)),(0,Ya.D)(o).pipe((0,D.U)(function(e){var t=e.reduce(function(e,t){return K.mergeDeep(e,t)});return new Xc(t)}),(0,q.K)(function(){return(0,U.of)(void 0)}))}},{key:"createArcGISRestImageDataSource",value:function(e,t){var i=this,o=[];return o.push(this.capabilitiesService.getImageArcgisOptions(e).pipe((0,q.K)(function(t){var o=i.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),n=i.languageService.translate.instant("igo.geo.dataSource.unavailable",{value:e.params.LAYERS});throw i.messageService.error(n,o),t}))),this.optionsService&&!0===e.optionsFromApi&&o.push(this.optionsService.getArcgisRestOptions(e,t).pipe((0,q.K)(function(e){return e.error.toDisplay=!0,e.error.title=i.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),e.error.message=i.languageService.translate.instant("igo.geo.dataSource.optionsApiUnavailable"),(0,U.of)({})}))),o.push((0,U.of)(e)),(0,Ya.D)(o).pipe((0,D.U)(function(e){var t=e.reduce(function(e,t){return K.mergeDeep(e,t)});return new Kc(t)}),(0,q.K)(function(){return(0,U.of)(void 0)}))}},{key:"createTileArcGISRestDataSource",value:function(e,t){var i=this,o=[];return o.push(this.capabilitiesService.getImageArcgisOptions(e).pipe((0,q.K)(function(t){var o=i.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),n=i.languageService.translate.instant("igo.geo.dataSource.unavailable",{value:e.params.LAYERS});throw i.messageService.error(n,o),t}))),this.optionsService&&!0===e.optionsFromApi&&o.push(this.optionsService.getArcgisRestOptions(e,t).pipe((0,q.K)(function(e){return e.error.toDisplay=!0,e.error.title=i.languageService.translate.instant("igo.geo.dataSource.unavailableTitle"),e.error.message=i.languageService.translate.instant("igo.geo.dataSource.optionsApiUnavailable"),(0,U.of)({})}))),o.push((0,U.of)(e)),(0,Ya.D)(o).pipe((0,D.U)(function(e){var t=e.reduce(function(e,t){return K.mergeDeep(e,t)});return new eu(t)}),(0,q.K)(function(){return(0,U.of)(void 0)}))}},{key:"createMVTDataSource",value:function(e){return new Ne.y(function(t){return t.next(new ou(e))})}},{key:"createClusterDataSource",value:function(e){return new Ne.y(function(t){return t.next(new qc(e))})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(cu),w.LFG(uu,8),w.LFG(zc),w.LFG(Ce),w.LFG(Ae),w.LFG(pu),w.LFG(Ea))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function hu(e,t,i){i=i||xt;var o=(new Zs.Z).readFeature(e,{dataProjection:e.projection,featureProjection:t});o.setId(i(e));var n=St(e);void 0!==n&&o.set("_title",n,!0),void 0!==e.extent&&o.set("_extent",e.extent,!0),void 0!==e.projection&&o.set("_projection",e.projection,!0);var r=wt(e,"meta.mapTitle");void 0!==r&&o.set("_mapTitle",r,!0),o.set("_entityRevision",function(e){return(e.meta||{}).revision||0}(e),!0);var a=kt(e);return void 0!==a&&o.set("_icon",a,!0),e.meta&&e.meta.style&&o.set("_style",e.meta.style,!0),e.sourceId&&o.set("_sourceId",e.sourceId,!0),o}function gu(e,t,i){var o,n,r,a,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"EPSG:4326",l=new Zs.Z,c=e.getKeys().filter(function(e){return!e.startsWith("_")&&"geometry"!==e}).reduce(function(t,i){return t[i]=e.get(i),t},{}),u=l.writeGeometryObject(e.getGeometry(),{dataProjection:s,featureProjection:t});if(i){o=i.get("title");var p=i.get("sourceOptions");p&&(n=p.excludeAttribute,r=p.excludeAttributeOffline,a=p.idColumn||("arcgisrest"===p.type||"tilearcgisrest"===p.type?"OBJECTID":void 0))}else o=e.get("_title");var d=e.get("_mapTitle"),h=e.getId()?e.getId():e.get(a)?e.get(a):oe();return e.get("_newFeature"),{type:ec,projection:s,extent:e.get("_extent"),meta:{id:h,title:o||d||h,mapTitle:d,revision:e.getRevision(),style:e.get("_style"),excludeAttribute:n,excludeAttributeOffline:r},properties:c,geometry:u,ol:e}}function fu(e,t){var i=h(Cs.ap(e),2),o=i[0],n=i[1];return[t[3]?e[0]-o*t[3]:e[0],t[2]?e[1]-n*t[2]:e[1],t[1]?e[2]+o*t[1]:e[2],t[0]?e[3]+n*t[0]:e[3]]}function mu(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:tc.Default,o=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,r=function(e,t){var i=Cs.lJ();return t.forEach(function(t){var o=function(e,t){var i=Cs.lJ(),o=t.get("_extent"),n=t.get("_projection");if(void 0!==o&&void 0!==n)i=ls.$A(o,n,e.projection);else{var r=t.getGeometry();null!==r&&(i=r.getExtent())}return i}(e,t);Cs.l7(i,o)}),i}(e,t),a=r;void 0!==o&&(a=fu(a,o)),i===tc.Zoom?e.viewController.zoomToExtent(a):i===tc.Move?e.viewController.moveToExtent(a):i===tc.Default&&(function(e,t){var i=fu(e.viewController.getExtent(),[-1,-1,-1,-1].map(function(e){return.05*e}));return!Cs.r4(i,t)}(e,r)||function(e,t,i){i=i||.004;var o=e.viewController.getExtent(),n=Cs.bg(o),r=Cs.bg(t);return!(0===r&&e.viewController.getZoom()>13)&&r/n<i}(e,r,n))&&e.viewController.zoomToExtent(a)}function vu(e,t){void 0===e.layer?(t=t||new jc({source:new _c}),e.bindLayer(t),void 0===e.layer.map&&e.map.addLayer(e.layer)):void 0===e.layer.map&&e.map.addLayer(e.layer)}var yu=function(e){o(i,e);var t=r(i);function i(e,o){var n;return m(this,i),(n=t.call(this,e,o)).map=o.map,n}return y(i,[{key:"source",get:function(){return this.layer?this.layer.dataSource:void 0}},{key:"bindLayer",value:function(e){return this.layer=e,this}},{key:"setLayerFeatures",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tc.Default,o=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;r=r||xt,this.checkLayer();var a=e.map(function(e){return hu(e,t.map.projection,r)});this.setLayerOlFeatures(a,i,o,n)}},{key:"setStoreOlFeatures",value:function(e){var t=this;this.checkLayer();var i=e.map(function(e){return e.set("_featureStore",t,!0),gu(e,t.layer.map.projection)});this.load(i)}},{key:"clearLayer",value:function(){this.checkLayer(),this.source.ol.clear()}},{key:"checkLayer",value:function(){if(void 0===this.layer)throw new Error("This FeatureStore is not bound to a layer.")}},{key:"setLayerOlFeatures",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tc.Default,i=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,n=function(e,t){var i=new Map;t.forEach(function(e){i.set(e.getId(),e)});var o=[];e.forEach(function(e){var t=i.get(e.getId());void 0===t||t.get("_entityRevision")!==e.get("_entityRevision")?o.push(e):i.delete(t.getId())});var n=Array.from(i.keys());return{add:t.filter(function(e){return n.indexOf(e.getId())>=0}),remove:o}}(this.layer.ol.getSource().getFeatures(),e);n.remove.length>0&&this.removeOlFeaturesFromLayer(n.remove),n.add.length>0&&this.addOlFeaturesToLayer(n.add),n.add.length>0?mu(this.map,n.add,t,i,o):n.remove.length>0&&mu(this.map,e,t,i,o)}},{key:"addOlFeaturesToLayer",value:function(e){var t=this;e.forEach(function(e){e.set("_featureStore",t,!0)}),this.source.ol.addFeatures(e)}},{key:"removeOlFeaturesFromLayer",value:function(e){var t=this;e.forEach(function(e){t.source.ol.removeFeature(e)})}}]),i}(At),bu=function(e){o(n,e);var t=r(n);function n(e){var i;return m(this,n),(i=t.call(this,e)).options=e,i.stores$$=new Map,i.states$$=[],i}return y(n,[{key:"bindStore",value:function(e){var t=this;i(c(n.prototype),"bindStore",this).call(this,e),!0===this.active&&this.watchStore(e),this.empty$$=e.empty$.pipe((0,Ka.n)(function(e){return!e})).subscribe(function(){return t.updateEntitiesInExtent(e)})}},{key:"unbindStore",value:function(e){i(c(n.prototype),"unbindStore",this).call(this,e),!0===this.active&&this.unwatchStore(e)}},{key:"doActivate",value:function(){var e=this;this.stores.forEach(function(t){return e.watchStore(t)})}},{key:"doDeactivate",value:function(){this.unwatchAll()}},{key:"watchStore",value:function(e){var t=this;this.stores$$.has(e)||(this.updateEntitiesInExtent(e),this.states$$.push(e.layer.map.viewController.state$.subscribe(function(){t.updateEntitiesInExtent(e)})))}},{key:"updateEntitiesInExtent",value:function(e){var t,i;if(null===(i=null===(t=null==e?void 0:e.layer)||void 0===t?void 0:t.map)||void 0===i?void 0:i.viewController){e.state.updateAll({inMapExtent:!1});var o,n=e.layer.map.viewController.getExtent(),r=[],a=[],s=p(e.entities$.value);try{for(s.s();!(o=s.n()).done;){var l=o.value;l.ol?Cs.kK(l.ol.getGeometry().getExtent(),n)&&r.push(l):a.push(l)}}catch(c){s.e(c)}finally{s.f()}r.length>0&&e.state.updateMany(r,{inMapExtent:!0},!1),a.length>0&&e.state.updateMany(a,{inMapExtent:!0},!1)}}},{key:"unwatchStore",value:function(e){void 0!==this.stores$$.get(e)&&this.stores$$.delete(e)}},{key:"unwatchAll",value:function(){this.stores$$.clear(),this.states$$.map(function(e){return e.unsubscribe()}),this.empty$$&&this.empty$$.unsubscribe()}}]),n}(Zt),wu=function(e){o(n,e);var t=r(n);function n(e){var i;return m(this,n),(i=t.call(this,e)).options=e,i.stores$$=new Map,i.resolution$$=[],i}return y(n,[{key:"bindStore",value:function(e){var t=this;i(c(n.prototype),"bindStore",this).call(this,e),!0===this.active&&this.watchStore(e),this.empty$$=e.empty$.subscribe(function(){return t.updateEntitiesInResolution(e,e.layer.map.viewController.getResolution())})}},{key:"unbindStore",value:function(e){i(c(n.prototype),"unbindStore",this).call(this,e),!0===this.active&&this.unwatchStore(e)}},{key:"doActivate",value:function(){var e=this;this.stores.forEach(function(t){return e.watchStore(t)})}},{key:"doDeactivate",value:function(){this.unwatchAll()}},{key:"watchStore",value:function(e){var t=this;this.stores$$.has(e)||(this.updateEntitiesInResolution(e,e.layer.map.viewController.getResolution()),this.resolution$$.push(e.layer.map.viewController.resolution$.subscribe(function(i){t.updateEntitiesInResolution(e,i)})))}},{key:"updateEntitiesInResolution",value:function(e,t){e.state.updateAll(t>e.layer.minResolution&&t<e.layer.maxResolution?{inMapResolution:!0}:{inMapResolution:!1})}},{key:"unwatchStore",value:function(e){void 0!==this.stores$$.get(e)&&this.stores$$.delete(e)}},{key:"unwatchAll",value:function(){this.stores$$.clear(),this.resolution$$.map(function(e){return e.unsubscribe()}),this.empty$$&&this.empty$$.unsubscribe()}}]),n}(Zt),xu=function(e){o(n,e);var t=r(n);function n(e){var i;return m(this,n),(i=t.call(this,e)).options=e,i.stores$$=new Map,i.setMotion(e.motion),i}return y(n,[{key:"bindStore",value:function(e){i(c(n.prototype),"bindStore",this).call(this,e),!0===this.active&&this.watchStore(e)}},{key:"unbindStore",value:function(e){i(c(n.prototype),"unbindStore",this).call(this,e),!0===this.active&&this.unwatchStore(e)}},{key:"setMotion",value:function(e){this.motion=e}},{key:"doActivate",value:function(){var e=this;this.stores.forEach(function(t){return e.watchStore(t)})}},{key:"doDeactivate",value:function(){this.unwatchAll()}},{key:"watchStore",value:function(e){var t=this;if(!this.stores$$.has(e)){var i=e.view.all$().subscribe(function(i){return t.onFeaturesChange(i,e)});this.stores$$.set(e,i)}}},{key:"unwatchStore",value:function(e){var t=this.stores$$.get(e);void 0!==t&&(t.unsubscribe(),this.stores$$.delete(e))}},{key:"unwatchAll",value:function(){Array.from(this.stores$$.entries()).forEach(function(e){e[1].unsubscribe()}),this.stores$$.clear()}},{key:"onFeaturesChange",value:function(e,t){0===e.length?t.clearLayer():t.setLayerFeatures(e,this.selectMotion(t),this.options.viewScale,this.options.areaRatio,this.options.getFeatureId)}},{key:"selectMotion",value:function(e){return void 0!==this.motion?this.motion:!0===e.pristine||e.count>e.view.count?tc.Default:tc.None}}]),n}(Zt),Su=function(e){o(n,e);var t=r(n);function n(e){var i;return m(this,n),(i=t.call(this,e)).options=e,i.stores$$=new Map,i}return y(n,[{key:"bindStore",value:function(e){i(c(n.prototype),"bindStore",this).call(this,e),!0===this.active&&this.watchStore(e)}},{key:"unbindStore",value:function(e){i(c(n.prototype),"unbindStore",this).call(this,e),!0===this.active&&this.unwatchStore(e)}},{key:"doActivate",value:function(){var e=this;this.stores.forEach(function(t){return e.watchStore(t)})}},{key:"doDeactivate",value:function(){this.unwatchAll()}},{key:"watchStore",value:function(e){var t=this;this.stores$$.has(e)||(this.onSourceChanges(e),e.layer.ol.getSource().on("change",function(i){t.onSourceChanges(e)}))}},{key:"unwatchStore",value:function(e){void 0!==this.stores$$.get(e)&&this.stores$$.delete(e)}},{key:"unwatchAll",value:function(){Array.from(this.stores$$.entries()).forEach(function(e){}),this.stores$$.clear()}},{key:"onSourceChanges",value:function(e){var t=e.layer.ol.getSource().getFeatures();e.layer.dataSource instanceof qc&&(t=t.flatMap(function(e){return e.get("features")})),0===t.length?e.clear():e.setStoreOlFeatures(t)}}]),n}(Zt),ku=function(e){o(i,e);var t=r(i);function i(e){return m(this,i),t.call(this,e)}return i}(gl.Z),Cu=function(e){o(n,e);var t=r(n);function n(e){var i;return m(this,n),(i=t.call(this,e)).options=e,i.setMotion(e.motion),i._overlayStore=i.createOverlayStore(),i}return y(n,[{key:"map",get:function(){return this.options.map}},{key:"overlayStore",get:function(){return this._overlayStore}},{key:"bindStore",value:function(e){i(c(n.prototype),"bindStore",this).call(this,e),!0===this.active&&this.activate()}},{key:"unbindStore",value:function(e){i(c(n.prototype),"unbindStore",this).call(this,e),!0===this.active&&this.activate()}},{key:"setMotion",value:function(e){this.motion=e}},{key:"unselectAll",value:function(){this.stores.forEach(function(e){e.state.updateAll({selected:!1})})}},{key:"clear",value:function(){this.overlayStore.source.ol.clear(),this.overlayStore.clear()}},{key:"deactivateSelection",value:function(){this.unlistenToMapClick(),this.removeDragBoxInteraction(),this.unwatchAll()}},{key:"doActivate",value:function(){this.addOverlayLayer(),this.listenToMapClick(),!0===this.options.dragBox&&this.addDragBoxInteraction(),this.watchAll()}},{key:"doDeactivate",value:function(){this.deactivateSelection(),this.removeOverlayLayer()}},{key:"watchAll",value:function(){var e=this;this.unwatchAll();var t=this.stores.map(function(e){return e.stateView.manyBy$(function(e){return!0===e.state.selected}).pipe((0,D.U)(function(e){return e.map(function(e){return e.entity})}))});this.stores$$=(0,J.aj)(t).pipe((0,E.b)(5),(0,Be.T)(1),(0,D.U)(function(e){return e.reduce(function(e,t){return e.concat(t)})})).subscribe(function(t){return e.onSelectFromStore(t)})}},{key:"unwatchAll",value:function(){void 0!==this.stores$$&&this.stores$$.unsubscribe()}},{key:"listenToMapClick",value:function(){var e=this;this.mapClickListener=this.map.ol.on("singleclick",function(t){e.onMapClick(t)})}},{key:"unlistenToMapClick",value:function(){(0,Os.B)(this.mapClickListener)}},{key:"onMapClick",value:function(e){var t=this,i=!Uc(e),o=!i,n=e.map.getFeaturesAtPixel(e.pixel,{hitTolerance:this.options.hitTolerance||0,layerFilter:function(e){return void 0!==t.stores.find(function(t){return t.layer.ol===e})}});this.onSelectFromMap(n,i,o)}},{key:"addDragBoxInteraction",value:function(){var e,t,i=this,o=p(this.map.ol.getInteractions().getArray());try{for(o.s();!(t=o.n()).done;){var n=t.value;if(n instanceof ku){e=n;break}}}catch(r){o.e(r)}finally{o.f()}void 0===e&&(e=new ku({condition:Uc}),this.map.ol.addInteraction(e),this.olDragSelectInteraction=e),this.olDragSelectInteractionEndKey=e.on("boxend",function(e){return i.onDragBoxEnd(e)})}},{key:"removeDragBoxInteraction",value:function(){void 0!==this.olDragSelectInteractionEndKey&&(0,Os.B)(this.olDragSelectInteractionEndKey),void 0!==this.olDragSelectInteraction&&this.map.ol.removeInteraction(this.olDragSelectInteraction),this.olDragSelectInteraction=void 0}},{key:"onDragBoxEnd",value:function(e){var t=!Uc(e.mapBrowserEvent),i=e.target.getGeometry().getExtent(),o=this.stores.reduce(function(e,t){var o=t.layer.ol.getSource();return e.push.apply(e,d(o.getFeaturesInExtent(i))),e},[]);this.onSelectFromMap(o,t,!1)}},{key:"onSelectFromStore",value:function(e){var t,i=this.motion,o=this.overlayStore.layer.ol.getSource().getFeatures().map(function(e){return e.getId()}),n=e.map(this.overlayStore.getKey);t=0!==e.length&&(o.length!==n.length||!o.every(function(e){return n.indexOf(e)>=0})),this.overlayStore.setLayerFeatures(e,t?i:tc.None,this.options.viewScale,this.options.areaRatio,this.options.getFeatureId)}},{key:"onSelectFromMap",value:function(e,t,i){var o=this,n=this.groupFeaturesByStore(e);this.stores.forEach(function(e){var r=n.get(e);void 0===r&&!0===t?o.unselectAllFeaturesFromStore(e):void 0===r&&!1===t||o.selectFeaturesFromStore(e,r,t,i)})}},{key:"selectFeaturesFromStore",value:function(e,t,i,o){!0===o?e.state.reverseMany(t,["selected"]):e.state.updateMany(t,{selected:!0},i)}},{key:"unselectAllFeaturesFromStore",value:function(e){e.state.updateAll({selected:!1})}},{key:"groupFeaturesByStore",value:function(e){var t=new Map;return null==e||e.forEach(function(e){var i=e.get("_featureStore");if(void 0!==i){var o=t.get(i);void 0===o&&(o=[],t.set(i,o));var n=i.get(e.getId());void 0!==n&&o.push(n)}}),t}},{key:"createOverlayStore",value:function(){var e=this.options.layer?this.options.layer:this.createOverlayLayer();return new yu([],{map:this.map}).bindLayer(e)}},{key:"createOverlayLayer",value:function(){return new jc({zIndex:300,source:new _c,style:void 0,showInLayerList:!1,exportable:!1,browsable:!1})}},{key:"addOverlayLayer",value:function(){void 0===this.overlayStore.layer.map&&this.map.addLayer(this.overlayStore.layer)}},{key:"removeOverlayLayer",value:function(){this.overlayStore.source.ol.clear(),this.map.removeLayer(this.overlayStore.layer)}}]),n}(Zt);function Tu(e,t){void 0===e.getStrategyOfType(xu)?(t=t||new xu({}),e.addStrategy(t),t.activate()):e.activateStrategyOfType(xu)}function Au(e,t){void 0===e.getStrategyOfType(Cu)?(t=t||new Cu({map:e.map}),e.addStrategy(t),t.activate()):e.activateStrategyOfType(Cu)}function Lu(){var e,t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=i.text,n=i.opacity,r=void 0===n?1:n,a=i.markerColor,s=void 0===a?[0,161,222]:a,l=i.markerOutlineColor,c=void 0===l?[255,255,255]:l,u=/msie\s|trident\/|edge\//i.test(window.navigator.userAgent),p=(0,Is._2)(s).slice(0),d=(0,Is._2)(c).slice(0);if(4===p.length&&("string"!=typeof s||/^#[0-9A-F]{8}$/i.test(s))&&(r=p[3]),e=s,t='data:image/svg+xml;utf8,<svg version="1.1" xmlns="http://www.w3.org/2000/svg" height="36" width="36" viewBox="0 0 36 36"><path fill='+'"rgba('.concat(p[0],",").concat(p[1],",").concat(p[2],",").concat(r,')"')+" stroke="+'"rgb('.concat(d[0],",").concat(d[1],",").concat(d[2],')"')+' stroke-width="2" d="M 17.692635,32.565644 C 15.71852,30.330584 13.290925,27.058065 11.6766,24.455732 9.3398623,20.688851 7.8905694,17.205334 7.6297492,14.728733 7.5616025,14.081649 7.5739557,12.528552 7.6513363,12.014724 8.1013861,9.0262716 9.8047068,6.3655569 12.310675,4.7364878 c 1.113691,-0.7239832 2.508083,-1.2834131 3.776687,-1.5152052 0.242945,-0.044389 0.451656,-0.09393 0.463804,-0.1100911 0.01215,-0.016161 0.638282,-0.025502 1.391411,-0.02076 1.088235,0.00685 1.450932,0.024316 1.766871,0.085071 2.650763,0.5097353 4.947142,1.8701891 6.498786,3.8501033 0.628018,0.8013587 1.297046,2.0200608 1.640967,2.9891872 0.191065,0.538399 0.427644,1.447408 0.477391,1.834287 0.0164,0.127546 0.0434,0.231902 0.06,0.231902 0.0166,0 0.03122,0.626135 0.03249,1.391411 0.0013,0.765276 -0.011,1.391411 -0.02726,1.391411 -0.01626,0 -0.05449,0.154049 -0.08495,0.342331 -0.08815,0.544879 -0.387235,1.721449 -0.604837,2.379406 -1.209421,3.656888 -4.014463,8.349762 -7.849521,13.132357 -0.790496,0.985807 -1.795217,2.167992 -1.842543,2.167992 -0.01896,0 -0.161766,-0.144111 -0.317336,-0.320246 z m 1.066937,-15.36525 c 0.133519,-0.02121 0.248766,-0.05657 0.256105,-0.07859 0.0073,-0.02202 0.04918,-0.03066 0.09298,-0.0192 0.0438,0.01145 0.107628,-0.0072 0.141834,-0.04137 0.03421,-0.03421 0.08456,-0.05474 0.111888,-0.04563 0.02733,0.0091 0.07703,-0.01077 0.110429,-0.04417 0.03341,-0.03341 0.08416,-0.05293 0.112796,-0.04338 0.02863,0.0095 0.08974,-0.01867 0.135802,-0.06271 0.04606,-0.04403 0.111902,-0.08625 0.146319,-0.09381 0.204084,-0.04483 0.762371,-0.519108 1.079463,-0.917027 0.26749,-0.335672 0.570987,-0.878795 0.529019,-0.946701 -0.01496,-0.0242 -0.0067,-0.044 0.01835,-0.044 0.05645,0 0.196809,-0.467982 0.158801,-0.529481 -0.01521,-0.02461 -0.0043,-0.04475 0.02427,-0.04475 0.03157,0 0.04365,-0.04329 0.03082,-0.11043 -0.01161,-0.06074 -0.0066,-0.110429 0.01124,-0.110429 0.01779,0 0.03235,-0.258405 0.03235,-0.574233 0,-0.315829 -0.01545,-0.574234 -0.03434,-0.574234 -0.01889,0 -0.02437,-0.03811 -0.01219,-0.08469 0.04412,-0.168712 -0.336329,-1.152668 -0.481536,-1.245401 -0.02327,-0.01486 -0.04022,-0.03992 -0.03765,-0.05568 0.01222,-0.07498 -0.156557,-0.318365 -0.406379,-0.586027 -0.295921,-0.317054 -0.773059,-0.690104 -0.83427,-0.652274 -0.0206,0.01273 -0.03745,0.0024 -0.03745,-0.02289 0,-0.06107 -0.433076,-0.2789369 -0.487546,-0.245273 -0.02338,0.01445 -0.04251,0.0068 -0.04251,-0.01695 0,-0.056281 -0.393995,-0.1865457 -0.613804,-0.2029397 -0.0943,-0.00703 -0.188579,-0.023183 -0.209503,-0.035888 -0.02092,-0.012705 -0.276571,-0.023337 -0.568105,-0.023627 -0.534044,-5.301e-4 -1.12638,0.091025 -1.12638,0.1741017 0,0.023781 -0.01713,0.032648 -0.03808,0.019705 -0.05054,-0.031232 -0.403641,0.1088602 -0.403641,0.1601422 0,0.02204 -0.01988,0.02779 -0.04417,0.01278 -0.0243,-0.01501 -0.04417,-0.0051 -0.04417,0.02209 0,0.02716 -0.01988,0.0371 -0.04417,0.02209 -0.0243,-0.01501 -0.04417,-0.0051 -0.04417,0.02209 0,0.02716 -0.01915,0.03755 -0.04256,0.02308 -0.02341,-0.01447 -0.08138,0.01252 -0.128834,0.05997 -0.04745,0.04745 -0.0974,0.07515 -0.111001,0.06155 -0.0136,-0.0136 -0.03722,0.0078 -0.05248,0.0476 -0.01526,0.03978 -0.0411,0.06408 -0.0574,0.054 -0.03277,-0.02025 -0.462299,0.323995 -0.491977,0.394291 -0.01026,0.02429 -0.07454,0.0912 -0.142856,0.148686 -0.248033,0.208705 -0.730279,0.974169 -0.672565,1.067553 0.0145,0.02346 0.0059,0.04266 -0.01914,0.04266 -0.05907,0 -0.241471,0.599428 -0.208527,0.685278 0.01385,0.0361 0.0044,0.06564 -0.02098,0.06564 -0.02539,0 -0.04169,0.0646 -0.03622,0.143558 0.0055,0.07896 -0.0042,0.213129 -0.02144,0.29816 -0.04741,0.233576 0.0511,1.055502 0.167516,1.397721 0.126048,0.370516 0.310099,0.740163 0.426484,0.856548 0.04776,0.04776 0.07554,0.08684 0.06174,0.08684 -0.0138,0 0.01516,0.05653 0.06436,0.125632 0.131301,0.184396 0.499365,0.587266 0.518785,0.567846 0.0092,-0.0092 0.09821,0.06081 0.197812,0.155562 0.09961,0.09475 0.190589,0.162786 0.202187,0.151188 0.0116,-0.0116 0.05991,0.01774 0.107361,0.06519 0.04745,0.04745 0.105426,0.07444 0.128834,0.05997 0.02341,-0.01447 0.04256,-0.0057 0.04256,0.01958 0,0.06106 0.344664,0.23496 0.399061,0.201341 0.02346,-0.0145 0.04266,-0.0059 0.04266,0.01914 0,0.05907 0.599429,0.241471 0.685279,0.208527 0.0361,-0.01385 0.06564,-0.0065 0.06564,0.01645 0,0.05196 1.079115,0.04833 1.413314,-0.0048 z"></path></svg>',u){switch(s){case"blue":e="blue";break;case"red":e="red";break;case"yellow":e="yellow";break;case"green":e="green";break;default:e="blue"}"./assets/igo2/geo/icons/place_"+e+"_36px.svg"}else t;return new ms.ZP({image:new bs.Z({src:t,opacity:r,imgSize:[36,36],anchor:[.5,.92]}),text:new vs.Z({text:o,font:"12px Calibri,sans-serif",fill:new ys.Z({color:"#000"}),stroke:new ws.Z({color:"#fff",width:3}),overflow:!0})})}var Zu=function(){var e=function(){function e(){m(this,e)}return y(e,[{key:"createStyle",value:function(e){return e?"function"==typeof e||e instanceof ms.ZP?e:this.parseStyle("style",e):Lu()}},{key:"parseStyle",value:function(e,t){var i=this,o={},n=this.getOlCls(e);return n&&t instanceof Object?(Object.keys(t).forEach(function(e){var n=i.getOlKey(e);o[n]=i.parseStyle(e,t[e])}),new n(o)):t}},{key:"getOlKey",value:function(e){var t;switch(e.toLowerCase()){case"circle":case"regularshape":case"icon":t="image"}return t||e}},{key:"getOlCls",value:function(e){var t=fs[e.charAt(0).toUpperCase()+e.slice(1)];return"regularshape"===e&&(t=Ss.Z),"backgroundFill"===e&&(t=ys.Z),"backgroundStroke"===e&&(t=ws.Z),t}},{key:"createStyleByAttribute",value:function(e,t){var i,o,n=t.type?t.type:this.guessTypeFeature(e),r=t.attribute,a=t.data,s=t.stroke,l=t.width,c=t.fill,u=t.anchor,p=t.radius,d=t.icon,h=t.scale,g=a?a.length:0,f=t.label?t.label.attribute:void 0,m=(null===(i=t.label)||void 0===i?void 0:i.style)?this.parseStyle("text",t.label.style):void 0;!m&&f&&(m=new vs.Z);var v=t.baseStyle;if(m&&m.setText(this.getLabel(e,f)),"circle"===n){for(var y=0;y<g;y++){var b=void 0!==e.get(r)&&null!==e.get(r)?e.get(r):"";if(b===a[y]||b.toString().match(new RegExp(a[y],"gmi")))return d?o=[new ms.ZP({image:new bs.Z({color:c?c[y]:void 0,src:d[y],scale:h?h[y]:1,anchor:u?u[y]:[.5,.5]}),text:m instanceof vs.Z?m:void 0})]:o=[new ms.ZP({image:new xs.Z({radius:p?p[y]:4,stroke:new ws.Z({color:s?s[y]:"black",width:l?l[y]:1}),fill:new ys.Z({color:c?c[y]:"black"})}),text:m instanceof vs.Z?m:void 0})]}if(!e.getStyle())return v?(o=this.createStyle(v),m&&o.setText(m),o):o=[new ms.ZP({image:new xs.Z({radius:4,stroke:new ws.Z({color:"black"}),fill:new ys.Z({color:"#bbbbf2"})})})]}else if("regular"===n){for(var w=0;w<g;w++){var x=void 0!==e.get(r)&&null!==e.get(r)?e.get(r):"";if(x===a[w]||x.toString().match(new RegExp(a[w],"gmi")))return o=[new ms.ZP({stroke:new ws.Z({color:s?s[w]:"black",width:l?l[w]:1}),fill:new ys.Z({color:c?c[w]:"rgba(255,255,255,0.4)"}),text:m instanceof vs.Z?m:void 0})]}if(e instanceof ns.Z&&!e.getStyle())return v?(o=this.createStyle(v),m&&o.setText(m),o):o=[new ms.ZP({stroke:new ws.Z({color:"black"}),fill:new ys.Z({color:"#bbbbf2"})})]}}},{key:"createClusterStyle",value:function(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0,n=e.get("features").length;if(1!==n){if(i.clusterRanges){var r,a=p(i.clusterRanges);try{for(a.s();!(r=a.n()).done;){var s=r.value;if((!s.minRadius||s.minRadius<=n)&&(!s.maxRadius||s.maxRadius>=n)){if(t=this.createStyle(s.style),s.showRange){var l=new vs.Z({text:n.toString(),fill:new ys.Z({color:"#fff"})});t.setText(l)}if(s.dynamicRadius){var c=void 0,u=t.getRadius();(c=5*Math.log(n))<u&&(c=u),t.image_.setRadius(c)}break}}}catch(g){a.e(g)}finally{a.f()}}if(!t){var d;if(i.radiusCalc)d=i.radiusCalc(n);else{var h=6;(d=5*Math.log(n))<h&&(d=h)}t=[new ms.ZP({image:new xs.Z({radius:d,stroke:new ws.Z({color:"black"}),fill:new ys.Z({color:"rgba(24, 134, 45, 0.5)"})}),text:new vs.Z({text:n.toString(),fill:new ys.Z({color:"#fff"})})})]}}else t=this.createStyle(o);return t}},{key:"getLabel",value:function(e,t){var i=t;if(i){var o=Array.from(t.matchAll(/\$\{([^\{\}]+)\}/g));return o.forEach(function(t){i=i.replace(t[0],e.get(t[1]))}),0===o.length&&i===t&&(i=e.get(t)||t),i}}},{key:"guessTypeFeature",value:function(e){switch(e.getGeometry().getType()){case"Point":case"MultiPoint":case"Circle":return"circle";default:return"regular"}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function Fu(){var e,t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.text,i=e.strokeWidth,o=void 0===i?2:i,n=e.fillColor,r=void 0===n?[0,161,222,.3]:n,a=e.strokeColor,s=void 0===a?[0,161,222,.9]:a,l=(0,Is._2)(r).slice(0),c=(0,Is._2)(s).slice(0),u=new ws.Z({width:o,color:c}),p=new ys.Z({color:l});return new ms.ZP({stroke:u,fill:p,image:new xs.Z({radius:5,stroke:u,fill:p}),text:new vs.Z({text:t,font:"12px Calibri,sans-serif",fill:new ys.Z({color:"#000"}),stroke:new ws.Z({color:"#fff",width:3}),overflow:!0})})}(),i=Lu();return function(o){if("bufferFeature"===o.getId())return e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,161,222,1],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,161,222,.15],o=arguments.length>3?arguments[3]:void 0,n=new ws.Z({width:t,color:e}),r=new ys.Z({color:i});return new ms.ZP({stroke:n,fill:r,image:new xs.Z({radius:5,stroke:n,fill:r}),text:new vs.Z({font:"12px Calibri,sans-serif",text:o,fill:new ys.Z({color:"#000"}),stroke:new ws.Z({color:"#fff",width:3}),overflow:!0})})}(o.get("bufferStroke"),2,o.get("bufferFill"),o.get("bufferText"));var n=o.get("_style");return n?(new Zu).createStyle(n):((e="Point"===o.getGeometry().getType()?i:t).getText().setText(o.get("_mapTitle")),e)}}var Ou=function(){function e(t){m(this,e),this.layer=function(){var e=new _c;return new jc({title:"Overlay",zIndex:300,source:e,style:Fu()})}(),this.setMap(t)}return y(e,[{key:"dataSource",get:function(){return this.layer.dataSource}},{key:"setMap",value:function(e){void 0===e?void 0!==this.map&&this.map.ol.removeLayer(this.layer.ol):e.ol.addLayer(this.layer.ol),this.map=e}},{key:"setFeatures",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tc.Default,i=arguments.length>2?arguments[2]:void 0;if(i){var o,n=p(this.dataSource.ol.getFeatures());try{for(n.s();!(o=n.n()).done;){var r=o.value;r.get("_sourceId")===i&&this.removeOlFeature(r)}}catch(a){n.e(a)}finally{n.f()}}else this.clear();this.addFeatures(e,t)}},{key:"addFeature",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tc.Default;this.addFeatures([e],t)}},{key:"addFeatures",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tc.Default,o=[];e.forEach(function(e){var i=hu(e,t.map.projection);null!==i.getGeometry()&&o.push(i)}),this.addOlFeatures(o,i)}},{key:"addOlFeature",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tc.Default;this.addOlFeatures([e],t)}},{key:"addOlFeatures",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tc.Default;this.dataSource.ol.addFeatures(e),mu(this.map,e,t)}},{key:"removeFeature",value:function(e){this.removeFeatures([e])}},{key:"removeFeatures",value:function(e){var t=this;e.forEach(function(e){e.meta&&t.dataSource.ol.getFeatureById(e.meta.id)&&t.removeOlFeature(t.dataSource.ol.getFeatureById(e.meta.id))})}},{key:"removeOlFeature",value:function(e){this.dataSource.ol.removeFeature(e)}},{key:"clear",value:function(){this.dataSource.ol.clear()}}]),e}(),Mu=function(e){o(i,e);var t=r(i);function i(){var e;return m(this,i),(e=t.call(this)).loaded=0,e.loading=0,e.layers=[],e.subscriptions=[],e}return y(i,[{key:"watch",value:function(){}},{key:"unwatch",value:function(){var e=this;this.layers.forEach(function(t){return e.unwatchLayer(t)},this)}},{key:"watchLayer",value:function(e){var t=this;if(void 0!==e.status$){this.layers.push(e);var i=e.status$.pipe((0,G.x)()).subscribe(function(e){e===ne.Error&&(t.loading=0,t.loaded=-1),e===ne.Working?t.loading+=1:e===ne.Done&&(t.loaded+=1),t.loaded>=t.loading?(t.loading=t.loaded=0,t.status=ne.Done):t.loading>0&&(t.status=ne.Working)});this.subscriptions.push(i)}}},{key:"unwatchLayer",value:function(e){e.status$.next(ne.Done);var t=this.layers.indexOf(e);t>=0&&(-1!==[ne.Working,ne.Waiting].indexOf(e.watcher.status)&&(this.loaded+=1),this.subscriptions[t].unsubscribe(),this.subscriptions.splice(t,1),this.layers.splice(t,1),e.watcher.unwatch())}}]),i}(re),Iu=function(){return(e=Iu||(Iu={}))[e.Move=0]="Move",e[e.Zoom=1]="Zoom",Iu;var e}(),Pu=function(e){o(n,e);var t=r(n);function n(e){var i;return m(this,n),(i=t.call(this)).options=e,i.resolution$=new R.X(void 0),i.state$=new R.X(void 0),i.padding=[0,0,0,0],i.maxZoomOnExtent=19,i.extent$=new Q.xQ,i.states=[],i.stateIndex=0,i}return y(n,[{key:"stateHistory",get:function(){return!!this.options&&!0===this.options.stateHistory}},{key:"olView",get:function(){return this.olMap.getView()}},{key:"setOlMap",value:function(e){i(c(n.prototype),"setOlMap",this).call(this,e),this.setupObservers()}},{key:"setupObservers",value:function(){var e=this;!0===this.stateHistory&&this.observerKeys.push(this.olMap.on("moveend",function(t){return e.onMoveEnd(t)})),this.extent$$=this.extent$.pipe((0,E.b)(25)).subscribe(function(t){e.setExtent(t.extent,t.action)})}},{key:"teardownObservers",value:function(){i(c(n.prototype),"teardownObservers",this).call(this),void 0!==this.extent$$&&(this.extent$$.unsubscribe(),this.extent$$=void 0)}},{key:"getOlProjection",value:function(){return this.olView.getProjection()}},{key:"getCenter",value:function(e){var t=this.olView.getCenter();return e&&t&&(t=ls.vs(t,this.getOlProjection(),e)),t}},{key:"getExtent",value:function(e){var t=this.olView.calculateExtent(this.olMap.getSize());return e&&t&&(t=ls.$A(t,this.getOlProjection(),e)),t}},{key:"getScale",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:96;return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"m",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:96;return e*ls.Wm[t]*39.3701*i}(this.getResolution(),this.getOlProjection().getUnits(),e)}},{key:"getResolution",value:function(){return this.olView.getResolution()}},{key:"getZoom",value:function(){return Math.round(this.olView.getZoom())}},{key:"zoomIn",value:function(){this.zoomTo(this.olView.getZoom()+1)}},{key:"zoomOut",value:function(){this.zoomTo(this.olView.getZoom()-1)}},{key:"zoomTo",value:function(e){this.olView.cancelAnimations(),this.olView.animate({zoom:e,duration:250,easing:Ms.Vv})}},{key:"moveToExtent",value:function(e){this.extent$.next({extent:e,action:Iu.Move})}},{key:"zoomToExtent",value:function(e){this.extent$.next({extent:e,action:Iu.Zoom})}},{key:"getRotation",value:function(){return this.olView.getRotation()}},{key:"resetRotation",value:function(){this.olView.animate({rotation:0})}},{key:"hasPreviousState",value:function(){return this.states.length>1&&this.stateIndex>0}},{key:"hasNextState",value:function(){return this.states.length>1&&this.stateIndex<this.states.length-1}},{key:"previousState",value:function(){this.hasPreviousState()&&this.setStateIndex(this.stateIndex-1)}},{key:"nextState",value:function(){this.hasNextState()&&this.setStateIndex(this.stateIndex+1)}},{key:"clearStateHistory",value:function(){this.states=[],this.stateIndex=0}},{key:"setInitialState",value:function(){this.states.length>0&&this.setStateIndex(0)}},{key:"setExtent",value:function(e,t){var i=this,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.olView;n.cancelAnimations();var r=o?500:0,a=n.getZoom(),s=n.getCenter(),l=[e[0]+(e[2]-e[0])/2,e[1]+(e[3]-e[1])/2],c=Math.sqrt(Math.pow(s[0]-l[0],2)+Math.pow(s[1]-l[1],2)),u=n.calculateExtent(),p=Math.sqrt(Math.pow(u[2]-u[0],2)+Math.pow(u[3]-u[1],2)),d=c/((Math.sqrt(Math.pow(e[2]-e[0],2)+Math.pow(e[3]-e[1],2))+p)/2),h=t===Iu.Move||a>this.maxZoomOnExtent?a:this.maxZoomOnExtent;n.fit(e,{size:this.olMap.getSize(),maxZoom:h,padding:this.padding,duration:d>4?0:r,callback:function(t){t||n.fit(e,{size:i.olMap.getSize(),maxZoom:h,padding:i.padding,duration:d>4?0:r})}})}},{key:"setStateIndex",value:function(e){this.stateIndex=e,this.setState(this.states[e])}},{key:"setState",value:function(e){this.olView.animate({resolution:e.resolution,center:e.center,duration:0})}},{key:"onMoveEnd",value:function(e){var t=this.getResolution();this.resolution$.value!==t&&this.resolution$.next(t);var i={resolution:t,center:this.getCenter(),zoom:this.getZoom()};if(!0===this.stateHistory){var o=this.stateIndex;(function(e,t){if(void 0===e||void 0===t)return!1;var i=1e-4;return e.zoom===t.zoom&&Math.trunc(e.center[0]/i)===Math.trunc(t.center[0]/i)&&Math.trunc(e.center[1]/i)===Math.trunc(t.center[1]/i)})(i,0===this.states.length?void 0:this.states[o])||(this.states=this.states.slice(0,o+1).concat([i]),this.stateIndex=this.states.length-1)}this.state$.next(i)}}]),n}(function(){function e(){m(this,e),this.observerKeys=[]}return y(e,[{key:"getOlMap",value:function(){return this.olMap}},{key:"setOlMap",value:function(e){if(void 0!==e&&void 0!==this.getOlMap())throw new Error("This controller is already bound to a map.");if(void 0===e)return this.teardownObservers(),void(this.olMap=e);this.olMap=e}},{key:"teardownObservers",value:function(){this.observerKeys.forEach(function(e){return(0,Os.B)(e)}),this.observerKeys=[]}}]),e}()),_u=function(){function e(t){m(this,e),this.offlineButtonToggle$=new R.X(!1),this.layers$=new R.X([]),this.positionFollower=!0,this.geolocation$=new R.X(void 0),this.swipeEnabled$=new R.X(!1),this.mapCenter$=new R.X(!1),this.selectedFeatures$=new R.X(null),this.defaultOptions={controls:{attribution:!1}},this.options=Object.assign({},this.defaultOptions,t),this.layerWatcher=new Mu,this.status$=this.layerWatcher.status$,cs.z(ks.Z),this.init()}return y(e,[{key:"layers",get:function(){return this.layers$.value}},{key:"projection",get:function(){return this.viewController.getOlProjection().getCode()}},{key:"init",value:function(){var e=[];this.options.controls&&(this.options.controls.attribution&&e.push(new as.Z(!0===this.options.controls.attribution?{}:this.options.controls.attribution)),this.options.controls.scaleLine&&e.push(new ss.Z(!0===this.options.controls.scaleLine?{}:this.options.controls.scaleLine)));var t={};!1===this.options.interactions&&(t={altShiftDragRotate:!1,doubleClickZoom:!1,keyboard:!1,mouseWheelZoom:!1,shiftDragZoom:!1,dragPan:!1,pinchRotate:!1,pinchZoom:!1}),this.ol=new is.Z({interactions:ps.ce(t),controls:e}),this.setView(this.options.view||{}),this.viewController=new Pu({stateHistory:!0}),this.viewController.setOlMap(this.ol),this.overlay=new Ou(this),this.queryResultsOverlay=new Ou(this),this.searchResultsOverlay=new Ou(this),this.buffer=new Ou(this)}},{key:"setTarget",value:function(e){this.ol.setTarget(e),void 0!==e?this.layerWatcher.subscribe(function(){},null):this.layerWatcher.unsubscribe()}},{key:"updateView",value:function(e){var t=this.ol.getView(),i=Object.assign({zoom:t.getZoom()},t.getProperties());this.setView(Object.assign(i,e)),e.maxZoomOnExtent&&(this.viewController.maxZoomOnExtent=e.maxZoomOnExtent)}},{key:"setView",value:function(e){void 0!==this.viewController&&this.viewController.clearStateHistory(),e=Object.assign({constrainResolution:!0},e);var t=new os.ZP(e);if(this.ol.setView(t),this.unsubscribeGeolocate(),e){if(e.maxLayerZoomExtent&&(this.viewController.maxLayerZoomExtent=e.maxLayerZoomExtent),e.center){var i=t.getProjection().getCode(),o=ls.mi(e.center,i);t.setCenter(o)}e.geolocate&&this.geolocate(!0),e.alwaysTracking&&(this.alwaysTracking=!0)}}},{key:"updateControls",value:function(e){var t=this;if(void 0!==e){var i=[];e.attribution&&i.push(new as.Z(!0===e.attribution?{}:e.attribution)),e.scaleLine&&i.push(new ss.Z(!0===e.scaleLine?{}:e.scaleLine)),Object.assign([],this.ol.getControls().getArray()).forEach(function(e){t.ol.removeControl(e)}),i.forEach(function(e){t.ol.addControl(e)})}}},{key:"getCenter",value:function(e){return this.viewController.getCenter(e)}},{key:"getExtent",value:function(e){return this.viewController.getExtent(e)}},{key:"getZoom",value:function(){return this.viewController.getZoom()}},{key:"changeBaseLayer",value:function(e){if(e){var t,i=p(this.getBaseLayers());try{for(i.s();!(t=i.n()).done;){t.value.visible=!1}}catch(o){i.e(o)}finally{i.f()}e.visible=!0,this.viewController.olView.setMinZoom(e.dataSource.options.minZoom||(this.options.view||{}).minZoom),this.viewController.olView.setMaxZoom(e.dataSource.options.maxZoom||(this.options.view||{}).maxZoom)}}},{key:"getBaseLayers",value:function(){return this.layers.filter(function(e){return!0===e.baseLayer})}},{key:"getLayerById",value:function(e){return this.layers.find(function(t){return t.id&&t.id===e})}},{key:"getLayerByAlias",value:function(e){return this.layers.find(function(t){return t.alias&&t.alias===e})}},{key:"getLayerByOlUId",value:function(e){return this.layers.find(function(t){return t.ol.ol_uid&&t.ol.ol_uid===e})}},{key:"addLayer",value:function(e){this.addLayers([e])}},{key:"addLayers",value:function(e){var t=this,i=0,o=0,n=e.map(function(e){if(e){var n=e.zIndex?0:e.baseLayer?o++:i++;return t.doAddLayer(e,n)}}).filter(function(e){return void 0!==e});this.setLayers([].concat(this.layers,n))}},{key:"removeLayer",value:function(e){this.removeLayers([e])}},{key:"removeLayers",value:function(e){var t=this,i=this.layers$.value.slice(0),o=[];e.forEach(function(e){var n=i.indexOf(e);n>=0&&(o.push(e),i.splice(n,1),t.handleLinkedLayersDeletion(e,o),o.map(function(e){o.push(e);var t=i.indexOf(e);t>=0&&i.splice(t,1)}))}),o.forEach(function(e){return t.doRemoveLayer(e)}),this.setLayers(i)}},{key:"handleLinkedLayersDeletion",value:function(e,t){var i=this,o=e.options.linkedLayers;if(o){var n=o.linkId,r=o.links;r?r.map(function(e){!e.syncedDelete||e.linkedIds.map(function(e){var o=i.layers.find(function(t){var i;return(null===(i=t.options.linkedLayers)||void 0===i?void 0:i.linkId)===e});o&&t.push(o)})}):this.layers.map(function(e){var o;(null===(o=e.options.linkedLayers)||void 0===o?void 0:o.links)&&e.options.linkedLayers.links.map(function(o){o.syncedDelete&&!1!==o.bidirectionnal&&-1!==o.linkedIds.indexOf(n)&&(t.push(e),i.handleLinkedLayersDeletion(e,t))})})}}},{key:"removeAllLayers",value:function(){var e=this;this.layers.forEach(function(t){return e.doRemoveLayer(t)}),this.layers$.next([])}},{key:"raiseLayer",value:function(e){var t=this.getLayerIndex(e);t>1&&this.moveLayer(e,t,t-1)}},{key:"raiseLayers",value:function(e){var t,i=p(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;this.raiseLayer(o)}}catch(n){i.e(n)}finally{i.f()}}},{key:"lowerLayer",value:function(e){var t=this.getLayerIndex(e);t<this.layers.length-1&&this.moveLayer(e,t,t+1)}},{key:"lowerLayers",value:function(e){var t,i=p(e.reverse());try{for(i.s();!(t=i.n()).done;){var o=t.value;this.lowerLayer(o)}}catch(n){i.e(n)}finally{i.f()}}},{key:"moveLayer",value:function(e,t,i){var o=this.layers[i],n=e.zIndex;o.baseLayer||e.baseLayer||(e.zIndex=o.zIndex,o.zIndex=n,this.layers[i]=e,this.layers[t]=o,this.layers$.next(this.layers.slice(0)))}},{key:"doAddLayer",value:function(e,t){e.baseLayer&&e.visible&&this.changeBaseLayer(e);var i=this.getLayerById(e.id);if(void 0===i){if(!e.baseLayer&&e.zIndex&&(e.zIndex+=10),void 0===e.zIndex||0===e.zIndex){var o=Math.max.apply(Math,[e.baseLayer?0:10].concat(d(this.layers.filter(function(t){return t.baseLayer===e.baseLayer&&t.zIndex<200}).map(function(e){return e.zIndex}))));e.zIndex=o+1+t}return e.baseLayer&&e.zIndex>9&&(e.zIndex=10),e.setMap(this),this.layerWatcher.watchLayer(e),this.ol.addLayer(e.ol),e}i.visible=!0}},{key:"doRemoveLayer",value:function(e){this.layerWatcher.unwatchLayer(e),this.ol.removeLayer(e.ol),e.setMap(void 0)}},{key:"setLayers",value:function(e){this.layers$.next(this.sortLayersByZIndex(e).slice(0))}},{key:"sortLayersByZIndex",value:function(e){return e.sort(function(e,t){return t.zIndex-e.zIndex})}},{key:"getLayerIndex",value:function(e){return this.layers.findIndex(function(t){return t===e})}},{key:"geolocate",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=!0;this.geolocation$$&&(t=this.geolocation.getTracking(),this.unsubscribeGeolocate()),this.startGeolocation(),this.geolocation$$=this.geolocation$.subscribe(function(o){var n;if(o){var r=o.getAccuracy(),a=o.getPosition();if(r<1e4){var s=a?new us.Z(a):null,l=o.getAccuracyGeometry(),c=l.getExtent();if([e.geolocationPositionFeature,e.geolocationAccuracyFeature].map(function(t){t&&e.overlay.dataSource.ol.getFeatureById(t.getId())&&e.overlay.dataSource.ol.removeFeature(t)}),e.bufferFeature&&e.buffer.dataSource.ol.removeFeature(e.bufferFeature),e.geolocationPositionFeature=new ns.Z({geometry:s}),e.geolocationPositionFeature.setId("geolocationPositionFeature"),e.geolocationPositionFeature.setStyle(new ms.ZP({image:new xs.Z({radius:6,fill:new ys.Z({color:"#3399CC"}),stroke:new ws.Z({color:"#fff",width:2})})})),e.geolocationAccuracyFeature=new ns.Z({geometry:l}),e.geolocationAccuracyFeature.setId("geolocationAccuracyFeature"),[e.geolocationPositionFeature,e.geolocationAccuracyFeature].map(e.alwaysTracking?function(t){e.overlay.addOlFeature(t,e.positionFollower?tc.Move:tc.None)}:function(t){e.overlay.addOlFeature(t)}),null===(n=e.ol.getView().get("options_"))||void 0===n?void 0:n.buffer){var u=e.ol.getView().get("options_").buffer.bufferRadius;e.bufferGeom=new gs.Z(a,u);var p,d=e.ol.getView().get("options_").buffer.bufferStroke,h=e.ol.getView().get("options_").buffer.bufferFill;p=e.ol.getView().get("options_").buffer.showBufferRadius?u.toString()+"m":"",e.bufferFeature=new ns.Z(e.bufferGeom),e.bufferFeature.setId("bufferFeature"),e.bufferFeature.set("bufferStroke",d),e.bufferFeature.set("bufferFill",h),e.bufferFeature.set("bufferText",p),e.buffer.addOlFeature(e.bufferFeature,tc.None)}i&&(e.viewController.zoomToExtent(c),e.positionFollower=!e.positionFollower)}else if(i){var g=e.ol.getView();g.setCenter(a),g.setZoom(14)}!0!==t&&!0!==e.alwaysTracking&&e.unsubscribeGeolocate(),i=!1}})}},{key:"unsubscribeGeolocate",value:function(){this.stopGeolocation(),this.geolocation$$&&(this.geolocation$$.unsubscribe(),this.geolocation$$=void 0)}},{key:"startGeolocation",value:function(){var e=this;this.geolocation?this.geolocation.setTracking(!0):(this.geolocation=new rs.Z({trackingOptions:{enableHighAccuracy:!0},projection:this.projection,tracking:!0}),this.geolocation.on("change",function(t){e.geolocation$.next(e.geolocation)}))}},{key:"stopGeolocation",value:function(){this.geolocation&&this.geolocation.setTracking(!1)}},{key:"onOfflineToggle",value:function(e){this.offlineButtonToggle$.next(e)}}]),e}(),qu=["*"],Du=function(){var e=function(){function e(t){m(this,e),this.activityService=t,this.id="igo-map-target-".concat((new Date).getTime())}return y(e,[{key:"view",get:function(){return this._view},set:function(e){this._view=e,void 0!==this.map&&this.map.updateView(e)}},{key:"controls",get:function(){return this._controls},set:function(e){this._controls=e,void 0!==this.map&&this.map.updateControls(e)}},{key:"ngOnInit",value:function(){var e=this;this.status$$=this.map.status$.subscribe(function(t){return e.handleStatusChange(t)})}},{key:"ngAfterViewInit",value:function(){this.map.setTarget(this.id)}},{key:"ngOnDestroy",value:function(){this.map.setTarget(void 0),this.activityService.unregister(this.activityId),this.status$$.unsubscribe()}},{key:"handleStatusChange",value:function(e){e===ne.Working&&void 0===this.activityId?this.activityId=this.activityService.register():e===ne.Done&&void 0!==this.activityId&&(this.activityService.unregister(this.activityId),this.activityId=void 0)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(ce))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-map-browser"]],inputs:{map:"map",view:"view"},ngContentSelectors:qu,decls:2,vars:1,consts:[[1,"igo-map-browser-target",3,"id"]],template:function(e,t){1&e&&(w.F$t(),w._UZ(0,"div",0),w.Hsn(1)),2&e&&w.Q6J("id",t.id)},styles:["[_nghost-%COMP%]{position:relative;display:block}[_nghost-%COMP%], .igo-map-browser-target[_ngcontent-%COMP%]{width:100%;height:100%}[_nghost-%COMP%]     igo-zoom-button{position:absolute;bottom:calc(40px + 5px + 5px);right:5px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){[_nghost-%COMP%]     igo-zoom-button{display:none}}[_nghost-%COMP%]     igo-offline-button{position:absolute;bottom:15px;right:5px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){[_nghost-%COMP%]     igo-offline-button{bottom:5px}}[_nghost-%COMP%]     igo-geolocate-button{position:absolute;bottom:5px;right:5px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){[_nghost-%COMP%]     igo-geolocate-button{bottom:5px}}[_nghost-%COMP%]     igo-rotation-button{position:absolute;top:calc(40px + 5px + 5px);right:5px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){[_nghost-%COMP%]     igo-rotation-button{bottom:calc(40px + 5px + 5px)}}[_nghost-%COMP%]     igo-home-extent-button{position:absolute;bottom:calc((3 * 40px) + 5px + (2 * 5px));right:5px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){[_nghost-%COMP%]     igo-home-extent-button{bottom:5px;right:calc((2 * 40px) + (3 * 5px))}}[_nghost-%COMP%]     igo-user-button{position:absolute;bottom:5px;right:calc(5px + 50px)}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){[_nghost-%COMP%]     igo-user-button{right:calc((2 * 40px) + (2 * 5px))}}[_nghost-%COMP%]     igo-baselayers-switcher{position:absolute;bottom:5px;left:5px}[_nghost-%COMP%]     .ol-attribution{flex-flow:row;left:calc(40px + 5px + 5px);bottom:5px;text-align:left;padding:0;margin-right:90px;background-color:#fff0;width:calc(100% - 100px)}[_nghost-%COMP%]     .ol-attribution.ol-logo-only{height:inherit}[_nghost-%COMP%]     .ol-attribution.ol-collapsed{background:none}[_nghost-%COMP%]     .ol-attribution.ol-collapsed button{transform:none}[_nghost-%COMP%]     .ol-attribution button{transform:rotate(180deg);background-color:#fff;cursor:pointer;outline:none}[_nghost-%COMP%]     .ol-scale-line-inner{color:#000;border-color:#000;text-shadow:white -1px -1px 3px,white 1px -1px 3px,white -1px 1px 3px,white 1px 1px 4px;box-shadow:0 1px 0 1px #fff9}[_nghost-%COMP%]     .ol-scale-line{background-color:#fff0;bottom:4px;transform:translate(-50%);left:50%}[_nghost-%COMP%]     .ol-scale-bar{background-color:#fff0;bottom:4px;transform:translate(-50%);left:50%}[_nghost-%COMP%]     .ol-scale-text{text-shadow:white -1px -1px 3px,white 1px -1px 3px,white -1px 1px 3px,white 1px 1px 4px}[_nghost-%COMP%]     .ol-scale-step-text{text-shadow:white -1px -1px 3px,white 1px -1px 3px,white -1px 1px 3px,white 1px 1px 4px}[_nghost-%COMP%]     canvas{display:block}"]}),e}(),Eu=function(){var e=function(){function e(t,i){m(this,e),this.component=t,this.mediaService=i,this.pointerPositionDelay=1e3,this.pointerPositionCoord=new w.vpe}return y(e,[{key:"map",get:function(){return this.component.map}},{key:"mapProjection",get:function(){return this.component.map.projection}},{key:"ngOnInit",value:function(){this.listenToMapPointerMove(),this.listenToMapClick()}},{key:"ngOnDestroy",value:function(){this.unlistenToMapPointerMove(),this.unlistenToMapClick()}},{key:"listenToMapPointerMove",value:function(){var e=this;this.pointerMoveListener=this.map.ol.on("pointermove",function(t){return e.onPointerEvent(t,e.pointerPositionDelay)})}},{key:"listenToMapClick",value:function(){var e=this;this.mapClickListener=this.map.ol.on("singleclick",function(t){return e.onPointerEvent(t,0)})}},{key:"unlistenToMapPointerMove",value:function(){(0,Os.B)(this.pointerMoveListener),this.pointerMoveListener=void 0}},{key:"unlistenToMapClick",value:function(){this.mapClickListener=void 0}},{key:"onPointerEvent",value:function(e,t){var i=this;if(!e.dragging&&!this.mediaService.isTouchScreen()){void 0!==this.lastTimeoutRequest&&clearTimeout(this.lastTimeoutRequest);var o=(0,ls.vs)(e.coordinate,this.mapProjection,"EPSG:4326");this.lastTimeoutRequest=setTimeout(function(){i.pointerPositionCoord.emit(o)},t)}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Du,2),w.Y36(Pe))},e.\u0275dir=w.lG2({type:e,selectors:[["","igoPointerPosition",""]],inputs:{pointerPositionDelay:"pointerPositionDelay"},outputs:{pointerPositionCoord:"pointerPositionCoord"}}),e}(),$u=function(e){o(n,e);var t=r(n);function n(e,i,o,r){var a;return m(this,n),(a=t.call(this,e,i,r)).messageService=i,a.languageService=o,a.authInterceptor=r,a.watcher=new ic(s(a),a.messageService,a.languageService),a.status$=a.watcher.status$,a.status$.subscribe(function(e){0===e&&(a.olLoadingProblem=!0)}),a}return y(n,[{key:"createOlLayer",value:function(){var e=this,t=Object.assign({},this.options,{source:this.options.source.ol}),i=new yl.Z(t);return this.authInterceptor&&i.getSource().setImageLoadFunction(function(t,i){e.customLoader(t,i,e.authInterceptor,e.messageService,e.languageService)}),i}},{key:"setMap",value:function(e){void 0===e?this.watcher.unsubscribe():this.watcher.subscribe(function(){}),i(c(n.prototype),"setMap",this).call(this,e)}},{key:"customLoader",value:function(e,t,i,o,n){var r=new XMLHttpRequest,a=i.alterUrlWithKeyAuth(t),s=t;if(a&&(s=a),r.open("GET",s),!i.interceptXhr(r,s))return r.abort(),void(e.getImage().src=s);r.responseType="arraybuffer",r.onload=function(){var t=new Uint8Array(this.response);(new TextDecoder).decode(t).includes("ServiceExceptionReport")&&o.error(n.translate.instant("igo.geo.dataSource.optionsApiUnavailable"),n.translate.instant("igo.geo.dataSource.unavailableTitle"));var i=new Blob([t],{type:"image/png"}),r=window.URL.createObjectURL(i);e.getImage().src=r},r.send()}}]),n}(Bc),Ru=function(e){o(n,e);var t=r(n);function n(e,i,o){var r;return m(this,n),(r=t.call(this,e,i)).messageService=i,r.authInterceptor=o,r.watcher=new Pc(s(r)),r.status$=r.watcher.status$,r}return y(n,[{key:"createOlLayer",value:function(){var e=this,t=Object.assign({},this.options,{source:this.options.source.ol}),i=new bl.Z(t);return i.getSource().setTileLoadFunction(function(t,i){e.customLoader(t,i,e.authInterceptor)}),i}},{key:"customLoader",value:function(e,t,i){var o=i.alterUrlWithKeyAuth(t),n=t;o&&(n=o),e.getImage().src=n}},{key:"setMap",value:function(e){void 0===e?this.watcher.unsubscribe():this.watcher.subscribe(function(){}),i(c(n.prototype),"setMap",this).call(this,e)}}]),n}(Bc),Nu=function(e){o(n,e);var t=r(n);function n(e,i,o){var r;return m(this,n),(r=t.call(this,e,i,o)).messageService=i,r.authInterceptor=o,r.watcher=new Pc(s(r)),r.status$=r.watcher.status$,r}return y(n,[{key:"createOlLayer",value:function(){var e=this,t=Object.assign({},this.options,{source:this.options.source.ol}),i=new fl.Z(t);return i.getSource().setTileLoadFunction(function(t,i){var o=e.customLoader(i,t.getFormat(),e.authInterceptor,t.onLoad.bind(t));o&&t.setLoader(o)}),i}},{key:"customLoader",value:function(e,t,i,o,n){var r=this;return function(a,s,l){var c=new XMLHttpRequest,u=e;if("function"!=typeof e){var p=i.alterUrlWithKeyAuth(e);p&&(u=p)}else u=e(a,s,l);c.open("GET",u),i&&i.interceptXhr(c,u),"arraybuffer"===t.getType()&&(c.responseType="arraybuffer"),c.onload=function(e){if(!c.status||c.status>=200&&c.status<300){var i,s=t.getType();"json"===s||"text"===s?i=c.responseText:"xml"===s?(i=c.responseXML)||(i=(new DOMParser).parseFromString(c.responseText,"application/xml")):"arraybuffer"===s&&(i=c.response),i?o.call(r,t.readFeatures(i,{extent:a,featureProjection:l}),t.readProjection(i)):n.call(r)}else n.call(r)},c.onerror=function(){n.call(r)},c.send()}}},{key:"setMap",value:function(e){void 0===e?this.watcher.unsubscribe():this.watcher.subscribe(function(){}),i(c(n.prototype),"setMap",this).call(this,e)}}]),n}(Bc),Uu=function(){var e=function(){function e(t,i,o){m(this,e),this.component=t,this.mediaService=i,this.styleService=o,this.pointerHoverFeatureStore=new At([]),this.selectionMVT={},this.hoverFeatureId="hoverFeatureId",this.igoHoverFeatureDelay=1e3,this.igoHoverFeatureEnabled=!1}return y(e,[{key:"mouseout",value:function(){clearTimeout(this.lastTimeoutRequest),this.clearLayer()}},{key:"map",get:function(){return this.component.map}},{key:"mapProjection",get:function(){return this.component.map.projection}},{key:"ngOnInit",value:function(){var e=this;this.listenToMapPointerMove(),this.subscribeToPointerStore(),this.listenToMapClick(),this.map.status$.pipe((0,Ge.q)(1)).subscribe(function(){e.store=new yu([],{map:e.map}),e.initStore()}),this.layers$$=this.map.layers$.subscribe(function(t){e.store&&!t.find(function(e){return"hoverFeatureId"===e.id})&&e.initStore()})}},{key:"initStore",value:function(){var e=this;vu(this.store,new jc({isIgoInternalLayer:!0,id:"hoverFeatureId",title:"hoverFeature",zIndex:900,source:new _c,showInLayerList:!1,exportable:!1,browsable:!1,style:Ju})),this.selectionLayer=new fl.Z({map:this.map.ol,zIndex:901,renderMode:"vector",declutter:!0,source:new dl.Z({}),style:function(t){if(e.mvtStyleOptions&&t.getId()in e.selectionMVT)return e.createHoverStyle(t,e.mvtStyleOptions)}})}},{key:"createHoverStyle",value:function(e,t){var i,o=Object.assign({},t),n=t.label?t.label.attribute:void 0,r=!!(null===(i=t.label)||void 0===i?void 0:i.style);if(e.get("_isLabel")){for(var a=o.data?o.data.length:0,s=[],l=[],c=[],u=[],p=0;p<a;p++)s.push(0),l.push("rgba(255, 255, 255, 0)"),c.push(0),u.push("rgba(255, 255, 255, 0)");o.radius=s,o.stroke=l,o.width=c,o.fill=u}else o.label=void 0,r=!1,n=void 0;return!r&&n&&(o.label.style={textAlign:"left",textBaseline:"top",font:"12px Calibri,sans-serif",fill:{color:"#000"},backgroundFill:{color:"rgba(255, 255, 255, 0.5)"},backgroundStroke:{color:"rgba(200, 200, 200, 0.75)",width:2},stroke:{color:"#fff",width:3},overflow:!0,offsetX:10,offsetY:20,padding:[2.5,2.5,2.5,2.5]}),this.styleService.createStyleByAttribute(e,o)}},{key:"ngOnDestroy",value:function(){this.unlistenToMapPointerMove(),this.unsubscribeToPointerStore(),this.unlistenToMapSingleClick(),this.layers$$.unsubscribe()}},{key:"subscribeToPointerStore",value:function(){var e=this;this.store$$=this.pointerHoverFeatureStore.entities$.subscribe(function(t){e.entitiesToPointerOverlay(t)})}},{key:"entitiesToPointerOverlay",value:function(e){this.addFeatureOverlay(e)}},{key:"listenToMapPointerMove",value:function(){var e=this;this.pointerMoveListener=this.map.ol.on("pointermove",function(t){return e.onMapEvent(t)})}},{key:"listenToMapClick",value:function(){var e=this;this.singleClickMapListener=this.map.ol.on("singleclick",function(t){return e.onMapSingleClickEvent(t)})}},{key:"unsubscribeToPointerStore",value:function(){this.store$$.unsubscribe()}},{key:"unlistenToMapPointerMove",value:function(){(0,Os.B)(this.pointerMoveListener),this.pointerMoveListener=void 0}},{key:"unlistenToMapSingleClick",value:function(){(0,Os.B)(this.singleClickMapListener),this.singleClickMapListener=void 0}},{key:"onMapSingleClickEvent",value:function(e){this.clearLayer()}},{key:"onMapEvent",value:function(e){var t=this;if(e.dragging||!this.igoHoverFeatureEnabled||this.mediaService.isTouchScreen())this.clearLayer();else{void 0!==this.lastTimeoutRequest&&clearTimeout(this.lastTimeoutRequest),this.clearLayer();var i,o=-1/0,n=this.map.ol.getPixelFromCoordinate(e.coordinate);this.lastTimeoutRequest=setTimeout(function(){t.map.ol.forEachFeatureAtPixel(n,function(e,n){if(n){var r=t.map.getLayerByOlUId(n.ol_uid);!t.canProcessHover(r)||r.zIndex<=o||(o=r.zIndex,i=n)}},{hitTolerance:10,layerFilter:function(e){return e instanceof Fs.Z||e instanceof fl.Z}}),i&&(t.clearLayer(),t.map.ol.forEachFeatureAtPixel(n,function(i,o){var n,r,a;if(void 0===i.get("hoverSummary")){var s;if(o instanceof Fs.Z){if(s=t.map.getLayerByOlUId(o.ol_uid),!t.canProcessHover(s))return;var l=t.handleRenderFeature(i);t.setLayerStyleFromOptions(s,l);var c=[l];l.set("_isLabel",!1);var u=new ns.Z;u.setProperties(l.getProperties());var p="Point"===l.getGeometry().getType()?l.getGeometry():new us.Z(e.coordinate);return u.setGeometry(p),u.setId(l.getId()),u.set("_isLabel",!0),t.setLayerStyleFromOptions(s,u),c.push(u),t.pointerHoverFeatureStore.load(c),!0}if(o instanceof fl.Z){if(s=t.map.getLayerByOlUId(o.ol_uid),!t.canProcessHover(s))return;(null===(r=null===(n=null==s?void 0:s.options)||void 0===n?void 0:n.styleByAttribute)||void 0===r?void 0:r.hoverStyle)?t.mvtStyleOptions=s.options.styleByAttribute.hoverStyle:(null===(a=null==s?void 0:s.options)||void 0===a?void 0:a.hoverStyle)&&(t.mvtStyleOptions=s.options.hoverStyle),t.selectionLayer.setSource(o.getSource()),o.getFeatures(e.pixel).then(function(i){if(!i.length)return t.selectionMVT={},t.selectionLayer.changed(),void t.clearLayer();var o=i[0];if(o){var n=t.handleRenderFeature(o);n.set("_isLabel",!1);var r=new ns.Z;r.setProperties(n.getProperties());var a="Point"===n.getGeometry().getType()?n.getGeometry():new us.Z(e.coordinate);r.setGeometry(a),r.setId(n.getId()),r.set("_isLabel",!0),t.setLayerStyleFromOptions(s,r),t.pointerHoverFeatureStore.load([r]),t.selectionMVT[o.getId()]=n,t.selectionLayer.changed()}else t.clearLayer()})}}return!0},{hitTolerance:10,layerFilter:function(e){return e===i}}))},this.igoHoverFeatureDelay)}}},{key:"canProcessHover",value:function(e){return!(!e||!e.visible||!e.options||!e.options.styleByAttribute&&!e.options.hoverStyle||e.options.styleByAttribute&&!e.options.styleByAttribute.hoverStyle&&!e.options.hoverStyle)}},{key:"handleRenderFeature",value:function(e){var t;return e instanceof wl.Z?(t=new ns.Z({geometry:this.getGeometry(e)})).setId(e.getId()):e instanceof ns.Z&&(t=e),t}},{key:"addFeatureOverlay",value:function(e){if(e.length>0){var t=e[0];this.clearLayer();var i=new ns.Z({geometry:t.getGeometry(),meta:{id:this.hoverFeatureId},hoverSummary:this.getHoverSummary(t.getProperties())});this.store.setLayerOlFeatures([i],tc.None)}}},{key:"setLayerStyleFromOptions",value:function(e,t){var i,o,n;(null===(o=null===(i=null==e?void 0:e.options)||void 0===i?void 0:i.styleByAttribute)||void 0===o?void 0:o.hoverStyle)?this.store.layer.ol.setStyle(this.createHoverStyle(t,e.options.styleByAttribute.hoverStyle)):(null===(n=null==e?void 0:e.options)||void 0===n?void 0:n.hoverStyle)&&this.store.layer.ol.setStyle(this.createHoverStyle(t,e.options.hoverStyle))}},{key:"getHoverSummary",value:function(e){for(var t="",i=0,o=Object.entries(e);i<o.length;i++){var n=h(o[i],2),r=n[0],a=n[1];!r.startsWith("_")&&"geometry"!==r&&(t+="".concat(r,": ").concat(a,"\n"))}return t.length>=2?t.slice(0,-2):t}},{key:"getGeometry",value:function(e){var t;if(e.getOrientedFlatCoordinates){var i=e.getOrientedFlatCoordinates(),o=[];switch(i.forEach(function(e,t){t%2==0&&o.push([parseFloat(i[t]),parseFloat(i[t+1])])}),e.getType()){case"Point":t=new us.Z(o);break;case"Polygon":t=new As.ZP([o]);break;case"LineString":t=new Ls.Z([o])}}else t=e.getGeometry();return t}},{key:"clearLayer",value:function(){this.selectionMVT={},this.selectionLayer&&this.selectionLayer.changed(),this.store&&this.store.clearLayer()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Du,2),w.Y36(Pe),w.Y36(Zu))},e.\u0275dir=w.lG2({type:e,selectors:[["","igoHoverFeature",""]],hostBindings:function(e,t){1&e&&w.NdJ("mouseout",function(){return t.mouseout()})},inputs:{igoHoverFeatureDelay:"igoHoverFeatureDelay",igoHoverFeatureEnabled:"igoHoverFeatureEnabled"}}),e}();function Ju(e,t){var i=[new ms.ZP({text:new vs.Z({text:e.get("hoverSummary"),textAlign:"left",textBaseline:"top",font:"12px Calibri,sans-serif",fill:new ys.Z({color:"#000"}),backgroundFill:new ys.Z({color:"rgba(255, 255, 255, 0.5)"}),backgroundStroke:new ws.Z({color:"rgba(200, 200, 200, 0.75)",width:2}),stroke:new ws.Z({color:"#fff",width:3}),overflow:!0,offsetX:10,offsetY:20,padding:[2.5,2.5,2.5,2.5]})})];switch(e.getGeometry().getType()){case"Point":i.push(new ms.ZP({image:new xs.Z({radius:10,stroke:new ws.Z({color:"blue",width:3})})}));break;default:i.push(new ms.ZP({stroke:new ws.Z({color:"white",width:5})})),i.push(new ms.ZP({stroke:new ws.Z({color:"blue",width:3})}))}return i}var Bu=function(e){return{zoom:e}},ju=function(){var e=function(){function e(){m(this,e)}return y(e,[{key:"zoom",get:function(){return this.map.viewController.getZoom()}},{key:"minZoom",get:function(){return this.map.viewController.olView.getMinZoom()||1}},{key:"maxZoom",get:function(){return this.map.viewController.olView.getMaxZoom()}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-zoom-button"]],inputs:{map:"map",color:"color"},decls:7,vars:16,consts:[[1,"igo-zoom-button-container"],["mat-icon-button","","matTooltipPosition","left",3,"matTooltip","color","disabled","click"],["svgIcon","plus"],["svgIcon","minus"]],template:function(e,t){1&e&&(w.TgZ(0,"div",0),w.TgZ(1,"button",1),w.NdJ("click",function(){return t.map.viewController.zoomIn()}),w.ALo(2,"translate"),w._UZ(3,"mat-icon",2),w.qZA(),w.TgZ(4,"button",1),w.NdJ("click",function(){return t.map.viewController.zoomOut()}),w.ALo(5,"translate"),w._UZ(6,"mat-icon",3),w.qZA(),w.qZA()),2&e&&(w.xp6(1),w.Q6J("matTooltip",w.xi3(2,6,"igo.geo.mapButtons.zoomIn",w.VKq(12,Bu,t.zoom+1)))("color",t.color)("disabled",t.zoom>=t.maxZoom),w.xp6(3),w.Q6J("matTooltip",w.xi3(5,9,"igo.geo.mapButtons.zoomOut",w.VKq(14,Bu,t.zoom-1)))("color",t.color)("disabled",t.zoom<=t.minZoom))},directives:[S.lW,L.gM,k.Hw],pipes:[ae.X$],styles:[".igo-zoom-button-container[_ngcontent-%COMP%]{width:40px}.igo-zoom-button-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#fff}.igo-zoom-button-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#efefef}.igo-zoom-button-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child{margin-bottom:2px}button[_ngcontent-%COMP%], [_nghost-%COMP%]     button .mat-button-ripple-round{border-radius:0}"]}),e}(),Qu=function(){var e=function(){function e(){m(this,e)}return y(e,[{key:"map",get:function(){return this._map},set:function(e){this._map=e}},{key:"color",get:function(){return this._color},set:function(e){this._color=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-geolocate-button"]],inputs:{map:"map",color:"color"},decls:4,vars:4,consts:[[1,"igo-geolocate-button-container"],["mat-icon-button","","matTooltipPosition","left",3,"matTooltip","color","click"],["svgIcon","crosshairs-gps"]],template:function(e,t){1&e&&(w.TgZ(0,"div",0),w.TgZ(1,"button",1),w.NdJ("click",function(){return t.map.geolocate()}),w.ALo(2,"translate"),w._UZ(3,"mat-icon",2),w.qZA(),w.qZA()),2&e&&(w.xp6(1),w.Q6J("matTooltip",w.lcZ(2,2,"igo.geo.mapButtons.geolocate"))("color",t.color))},directives:[S.lW,L.gM,k.Hw],pipes:[ae.X$],styles:[".igo-geolocate-button-container[_ngcontent-%COMP%]{width:40px;background-color:#fff}.igo-geolocate-button-container[_ngcontent-%COMP%]:hover{background-color:#efefef}button[_ngcontent-%COMP%], [_nghost-%COMP%]     button .mat-button-ripple-round{border-radius:0}"]}),e}(),Gu=function(){var e=function(){function e(t){m(this,e),this.configService=t,this.computeHomeExtent()}return y(e,[{key:"computeHomeExtent",value:function(){this.homeExtentButtonExtent=this.extentOverride||this.configService.getConfig("homeExtentButton.homeExtButtonExtent"),this.homeExtentButtonCenter=this.centerOverride||this.configService.getConfig("homeExtentButton.homeExtButtonCenter"),this.homeExtentButtonZoom=this.zoomOverride||this.configService.getConfig("homeExtentButton.homeExtButtonZoom"),this.centerOverride&&this.zoomOverride&&(this.homeExtentButtonExtent=void 0)}},{key:"onToggleClick",value:function(){if(this.computeHomeExtent(),this.homeExtentButtonExtent)this.map.viewController.zoomToExtent(this.homeExtentButtonExtent);else if(this.homeExtentButtonCenter&&this.homeExtentButtonZoom){var e=ls.mi(this.homeExtentButtonCenter,this.map.viewController.olView.getProjection().getCode());this.map.viewController.olView.setCenter(e),this.map.viewController.zoomTo(this.homeExtentButtonZoom)}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(he))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-home-extent-button"]],inputs:{map:"map",color:"color",extentOverride:"extentOverride",centerOverride:"centerOverride",zoomOverride:"zoomOverride"},decls:4,vars:4,consts:[[1,"igo-home-extent-button-container"],["mat-icon-button","","matTooltipPosition","left",3,"matTooltip","color","click"],["svgIcon","home-map-marker"]],template:function(e,t){1&e&&(w.TgZ(0,"div",0),w.TgZ(1,"button",1),w.NdJ("click",function(){return t.onToggleClick()}),w.ALo(2,"translate"),w._UZ(3,"mat-icon",2),w.qZA(),w.qZA()),2&e&&(w.xp6(1),w.Q6J("matTooltip",w.lcZ(2,2,"igo.geo.mapButtons.home-extent"))("color",t.color))},directives:[S.lW,L.gM,k.Hw],pipes:[ae.X$],styles:['@charset "UTF-8";.igo-home-extent-button-container[_ngcontent-%COMP%]{width:40px;background-color:#fff}\\a0[_ngcontent-%COMP%]   .igo-home-extent-button-container[_ngcontent-%COMP%]:hover{background-color:#efefef}button[_ngcontent-%COMP%], [_nghost-%COMP%]     button .mat-button-ripple-round{border-radius:0}']}),e}();function Yu(e,t){1&e&&(w.TgZ(0,"div",6),w.TgZ(1,"button",7),w.ALo(2,"translate"),w._UZ(3,"mat-icon",8),w.qZA(),w.qZA()),2&e&&(w.xp6(1),w.Q6J("matTooltip",w.lcZ(2,1,"igo.geo.mapButtons.baselayerSwitcher")))}function zu(e,t){if(1&e&&(w._UZ(0,"igo-mini-basemap",9),w.ALo(1,"translate")),2&e){var i=t.$implicit,o=t.index,n=w.oxw(2);w.Q6J("map",n.map)("baseLayer",i)("title",n.baseLayers.length>2&&!n.expand?w.lcZ(1,5,"igo.geo.baselayersSwitcher.title"):i.title)("display",n.expand||0===o&&!n.useStaticIcon)("disabled",!n.expand&&n.baseLayers.length>1)}}var Vu=function(e){return{"container-expand":e}};function Hu(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",1),w.NdJ("@baseLayerSwitcherState.start",function(){return w.CHM(i),w.oxw().showButton=!1})("@baseLayerSwitcherState.done",function(){return w.CHM(i),w.oxw().showButton=!0})("click",function(){return w.CHM(i),w.oxw().collapseOrExpand()}),w.YNc(1,Yu,4,3,"div",2),w.YNc(2,zu,2,7,"igo-mini-basemap",3),w.TgZ(3,"div",4),w._UZ(4,"mat-icon",5),w.qZA(),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("ngClass",w.VKq(4,Vu,o.expand))("@baseLayerSwitcherState",o.expand?"expand":o.useStaticIcon?"collapseIcon":"collapseMap"),w.xp6(1),w.Q6J("ngIf",o.useStaticIcon&&!o.expand&&o.showButton),w.xp6(1),w.Q6J("ngForOf",o.baseLayers)}}var Wu=function(){var e=function(){function e(t){m(this,e),this.mediaService=t,this._baseLayers=[],this.expand=!1,this.showButton=!0,this.mediaService.media$.value===Me.Mobile&&void 0===this.useStaticIcon&&(this.useStaticIcon=!0)}return y(e,[{key:"ngAfterViewInit",value:function(){var e=this;this.layers$$=this.map.layers$.subscribe(function(t){e._baseLayers=t.filter(function(e){return e.baseLayer})})}},{key:"ngOnDestroy",value:function(){this.layers$$.unsubscribe()}},{key:"collapseOrExpand",value:function(){this.expand=!!(this.baseLayers.length>1||this.useStaticIcon)&&!this.expand}},{key:"baseLayers",get:function(){var e=this.map.viewController.getResolution(),t=this.map.viewController.getZoom(),i=this._baseLayers.filter(function(i){return(!i.options.maxResolution||e<=i.options.maxResolution)&&(!i.options.minResolution||e>=i.options.minResolution)&&(!i.options.source.options.maxZoom||t<=i.options.source.options.maxZoom)&&(!i.options.source.options.minZoom||t>=i.options.source.options.minZoom)}),o=i.filter(function(e){return!e.visible});return o.length+1===i.length?o:i}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Pe))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-baselayers-switcher"]],inputs:{map:"map",useStaticIcon:"useStaticIcon"},decls:1,vars:1,consts:[["class","igo-baselayers-switcher-container",3,"ngClass","click",4,"ngIf"],[1,"igo-baselayers-switcher-container",3,"ngClass","click"],["class","igo-baselayers-switcher-button-container",4,"ngIf"],["class","mat-typography",3,"map","baseLayer","title","display","disabled",4,"ngFor","ngForOf"],[1,"more-baselayers"],["color","primary","svgIcon","menu-down",1,"material-icons","mat-icon","mat-list-avatar"],[1,"igo-baselayers-switcher-button-container"],["mat-icon-button","","matTooltipPosition","right","color","primary",3,"matTooltip"],["svgIcon","image-multiple"],[1,"mat-typography",3,"map","baseLayer","title","display","disabled"]],template:function(e,t){1&e&&w.YNc(0,Hu,5,6,"div",0),2&e&&w.Q6J("ngIf",t.baseLayers.length>0)},styles:[".igo-baselayers-switcher-container[_ngcontent-%COMP%]{height:auto;position:relative}.container-expand[_ngcontent-%COMP%]{overflow:hidden;border-width:0}.more-baselayers[_ngcontent-%COMP%]{width:80px;height:20px;background-color:#fff;text-align:center;cursor:pointer}.more-baselayers[_ngcontent-%COMP%]:hover{background-color:#efefef}.igo-baselayers-switcher-button-container[_ngcontent-%COMP%]{width:40px;background-color:#fff}.igo-baselayers-switcher-button-container[_ngcontent-%COMP%]:hover{background-color:#efefef}button[_ngcontent-%COMP%], [_nghost-%COMP%]     button .mat-button-ripple-round{border-radius:0}"],data:{animation:[(0,mt.X$)("baseLayerSwitcherState",[(0,mt.SB)("collapseIcon",(0,mt.oB)({height:"40px",width:"40px",overflow:"hidden"})),(0,mt.SB)("collapseMap",(0,mt.oB)({height:"85px",overflow:"hidden"})),(0,mt.SB)("expand",(0,mt.oB)({overflow:"hidden"})),(0,mt.eR)("collapse => expand",(0,mt.jt)("200ms")),(0,mt.eR)("expand => collapse",(0,mt.jt)("200ms"))])]}}),e}(),Xu=function(){var e=function(){function e(t,i,o,n,r,a){m(this,e),this.http=t,this.styleService=i,this.dataSourceService=o,this.messageService=n,this.languageService=r,this.authInterceptor=a}return y(e,[{key:"createLayer",value:function(e){if(e.source){var t;switch(e.source.options&&e.source.options._layerOptionsFromSource&&(e=K.mergeDeep(e.source.options._layerOptionsFromSource,e||{})),e.source.constructor){case Qc:case Hc:case Gc:case tu:case Wc:case eu:t=this.createTileLayer(e);break;case _c:case Yc:case Xc:case iu:case qc:t=this.createVectorLayer(e);break;case Kc:case Mc:t=this.createImageLayer(e);break;case ou:var i=oc(e);t=this.createVectorTileLayer(i)}return t}}},{key:"createAsyncLayer",value:function(e,t){var i=this,o=oc(e);return o.source?new Ne.y(function(e){return e.next(i.createLayer(o))}):this.dataSourceService.createAsyncDataSource(o.sourceOptions,t).pipe((0,D.U)(function(e){if(void 0!==e)return i.createLayer(Object.assign(o,{source:e}))}))}},{key:"createImageLayer",value:function(e){return new $u(e,this.messageService,this.languageService,this.authInterceptor)}},{key:"createTileLayer",value:function(e){return new Ru(e,this.messageService,this.authInterceptor)}},{key:"createVectorLayer",value:function(e){var t,i;if(void 0!==e.style&&(t=this.styleService.createStyle(e.style)),e.source instanceof Xc)t=e.source.options.params.style;else if(e.styleByAttribute){var o=this.styleService;e.style=function(t){return o.createStyleByAttribute(t,e.styleByAttribute)},i=new jc(e,this.messageService,this.authInterceptor)}if(e.source instanceof qc){var n=this.styleService,r=e.clusterBaseStyle;e.style=function(t){return n.createClusterStyle(t,e.clusterParam,r)},i=new jc(e,this.messageService,this.authInterceptor)}var a=Object.assign({},e,{style:t});return i||(i=new jc(a,this.messageService,this.authInterceptor)),this.applyMapboxStyle(i,a),i}},{key:"createVectorTileLayer",value:function(e){var t,i;if(void 0!==e.style&&(t=this.styleService.createStyle(e.style)),e.styleByAttribute){var o=this.styleService;e.style=function(t){return o.createStyleByAttribute(t,e.styleByAttribute)},i=new Nu(e,this.messageService,this.authInterceptor)}var n=Object.assign({},e,{style:t});return i||(i=new Nu(n,this.messageService,this.authInterceptor)),this.applyMapboxStyle(i,n),i}},{key:"applyMapboxStyle",value:function(e,t){t.mapboxStyle&&this.getMapboxGlStyle(t.mapboxStyle.url).subscribe(function(i){(0,xl.ZP)(e.ol,i,t.mapboxStyle.source)})}},{key:"getMapboxGlStyle",value:function(e){return this.http.get(e).pipe((0,D.U)(function(e){return e}),(0,q.K)(function(e){return console.log("No style was found"),(0,U.of)(e)}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(P.eN),w.LFG(Zu),w.LFG(du),w.LFG(Ae),w.LFG(Ce),w.LFG(Ea,8))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function Ku(e,t){if(1&e&&(w.TgZ(0,"div",5),w._uU(1),w.qZA()),2&e){var i=w.oxw(2);w.xp6(1),w.hij(" ",i.title," ")}}function ep(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",2),w.NdJ("click",function(){w.CHM(i);var e=w.oxw();return e.changeBaseLayer(e.baseLayer)}),w._UZ(1,"igo-map-browser",3),w.YNc(2,Ku,2,1,"div",4),w.qZA()}if(2&e){var o=w.oxw();w.xp6(1),w.Q6J("map",o.basemap),w.xp6(1),w.Q6J("ngIf",o.title)}}var tp=function(){var e=function(){function e(t,i){m(this,e),this.layerService=t,this.appRef=i,this.basemap=new _u({controls:{},interactions:!1})}return y(e,[{key:"baseLayer",get:function(){return this._baseLayer},set:function(e){this._baseLayer=e,this.handleBaseLayerChanged(e)}},{key:"ngAfterViewInit",value:function(){var e=this;this.handleMainMapViewChange(this.map.ol.getView()),this.map.viewController.olView.on("change",function(t){e.handleMainMapViewChange(t.target)}),this.map.ol.on("pointerdrag",function(t){e.handleMainMapViewChange(t.target.getView())})}},{key:"ngOnDestroy",value:function(){var e=this;this.map.viewController.olView.un("change",function(t){e.handleMainMapViewChange(t.target)}),this.map.ol.un("pointerdrag",function(t){e.handleMainMapViewChange(t.target.getView())})}},{key:"changeBaseLayer",value:function(e){this.disabled||(this.map.changeBaseLayer(e),this.appRef.tick())}},{key:"handleMainMapViewChange",value:function(e){var t=e.getProperties();this.basemap.viewController.olView.setResolution(t.resolution),this.basemap.viewController.olView.setRotation(t.rotation),this.basemap.viewController.olView.setCenter(this.map.viewController.getCenter())}},{key:"handleBaseLayerChanged",value:function(e){this.basemap.removeAllLayers();var t=Object.assign(Object.create(e.options),e.options,{visible:!0,baseLayer:!1}),i=this.layerService.createLayer(t);this.basemap.addLayer(i),this.handleLinkedBaseLayer(i)}},{key:"handleLinkedBaseLayer",value:function(e){var t=this,i=e.options.linkedLayers;if(i){var o=i.links;o&&i.linkId===e.options.linkedLayers.linkId&&o.map(function(e){e.linkedIds.map(function(e){var i=t.map.layers.find(function(t){var i;return(null===(i=t.options.linkedLayers)||void 0===i?void 0:i.linkId)===e});if(i){var o=Object.assign(Object.create(i.options),i.options,{zIndex:9e3,visible:!0,baseLayer:!1});t.basemap.addLayer(t.layerService.createLayer(o))}})})}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Xu),w.Y36(w.z2F))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-mini-basemap"]],inputs:{map:"map",disabled:"disabled",display:"display",title:"title",baseLayer:"baseLayer"},decls:2,vars:1,consts:[[1,"igo-mini-basemap-container"],[3,"click",4,"ngIf"],[3,"click"],[3,"map"],["class","igo-mini-basemap-title",4,"ngIf"],[1,"igo-mini-basemap-title"]],template:function(e,t){1&e&&(w.TgZ(0,"div",0),w.YNc(1,ep,3,2,"div",1),w.qZA()),2&e&&(w.xp6(1),w.Q6J("ngIf",t.display))},styles:[".igo-mini-basemap-container[_ngcontent-%COMP%]{width:calc(40px * 2);height:calc(40px * 2);background-color:#ffffff03;border:2px solid white;box-shadow:0 1px 4px #0000004d;cursor:pointer;margin-top:5px}.igo-mini-basemap-container[_ngcontent-%COMP%]:hover   .igo-mini-basemap-title[_ngcontent-%COMP%]{color:#000;text-shadow:0 0 5px white}.igo-mini-basemap-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%;height:100%}.igo-mini-basemap-title[_ngcontent-%COMP%]{position:relative;top:-76px;height:76px;width:76px;text-align:center;vertical-align:bottom;color:#fff;text-shadow:0 0 5px black;white-space:normal;display:flex;align-items:flex-end;justify-content:center}"]}),e}();function ip(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",1),w.ALo(1,"translate"),w.ALo(2,"translate"),w.TgZ(3,"button",2),w.NdJ("click",function(){return w.CHM(i),w.oxw().map.viewController.resetRotation()}),w._UZ(4,"mat-icon",3),w.qZA(),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("matTooltip",o.rotated?w.lcZ(1,4,"igo.geo.mapButtons.resetRotation"):w.lcZ(2,6,"igo.geo.mapButtons.tipRotation")),w.xp6(3),w.Q6J("color",o.color)("disabled",!o.rotated),w.xp6(1),w.Q6J("ngStyle",o.rotationStyle(o.map.viewController.getRotation()))}}function op(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",1),w.ALo(1,"translate"),w.ALo(2,"translate"),w.TgZ(3,"button",2),w.NdJ("click",function(){return w.CHM(i),w.oxw().map.viewController.resetRotation()}),w._UZ(4,"mat-icon",3),w.qZA(),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("matTooltip",o.rotated?w.lcZ(1,4,"igo.geo.mapButtons.resetRotation"):w.lcZ(2,6,"igo.geo.mapButtons.tipRotation")),w.xp6(3),w.Q6J("color",o.color)("disabled",!o.rotated),w.xp6(1),w.Q6J("ngStyle",o.rotationStyle(o.map.viewController.getRotation()))}}var np=function(){var e=function(){function e(){m(this,e)}return y(e,[{key:"map",get:function(){return this._map},set:function(e){this._map=e}},{key:"showIfNoRotation",get:function(){return this._showIfNoRotation},set:function(e){this._showIfNoRotation=e}},{key:"color",get:function(){return this._color},set:function(e){this._color=e}},{key:"rotated",get:function(){return 0!==this.map.viewController.getRotation()}},{key:"rotationStyle",value:function(e){return{transform:"rotate("+e+"rad)"}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-rotation-button"]],inputs:{map:"map",showIfNoRotation:"showIfNoRotation",color:"color"},decls:2,vars:2,consts:[["class","igo-rotation-button-container","matTooltipPosition","left",3,"matTooltip",4,"ngIf"],["matTooltipPosition","left",1,"igo-rotation-button-container",3,"matTooltip"],["mat-icon-button","","matTooltipPosition","left",3,"color","disabled","click"],["svgIcon","navigation",3,"ngStyle"]],template:function(e,t){1&e&&(w.YNc(0,ip,5,8,"div",0),w.YNc(1,op,5,8,"div",0)),2&e&&(w.Q6J("ngIf",t.rotated&&!t.showIfNoRotation),w.xp6(1),w.Q6J("ngIf",t.showIfNoRotation))},directives:[F.O5,L.gM,S.lW,k.Hw,F.PC],pipes:[ae.X$],styles:[".igo-rotation-button-container[_ngcontent-%COMP%]{width:40px;background-color:#fff}.igo-rotation-button-container[_ngcontent-%COMP%]:hover{background-color:#efefef}button[_ngcontent-%COMP%], [_nghost-%COMP%]     button .mat-button-ripple-round{border-radius:0}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){button[_ngcontent-%COMP%]:disabled, [_nghost-%COMP%]     button .mat-button-ripple-round:disabled{display:none}}"]}),e}();function rp(e,t){if(1&e&&(w.TgZ(0,"div",1),w.TgZ(1,"pre"),w._uU(2),w.qZA(),w.qZA()),2&e){var i=w.oxw();w.xp6(2),w.Oqu(i.infoContent)}}var ap=function(){var e=function e(){m(this,e),this.infoContent=""};return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-info-section"]],inputs:{infoContent:"infoContent"},decls:1,vars:1,consts:[["class","infoSection",4,"ngIf"],[1,"infoSection"]],template:function(e,t){1&e&&w.YNc(0,rp,3,1,"div",0),2&e&&w.Q6J("ngIf",t.infoContent&&t.infoContent.length)},directives:[F.O5],styles:[".infoSection[_ngcontent-%COMP%]{border-radius:10px;background-color:#6e6e6e66;padding:calc(5px / 2);position:absolute;text-align:center;top:5px;left:50%;text-shadow:0 0 5px white,0 0 10px white,0 0 15px white}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){.infoSection[_ngcontent-%COMP%]{top:calc(40px + 5px + 5px);left:10%}}"]}),e}(),sp=function(){return(e=sp||(sp={})).Layer="layer",e.Group="group",sp;var e}(),lp=function(){return(e=lp||(lp={}))[e.wms=0]="wms",e[e.wmts=1]="wmts",e[e.baselayers=2]="baselayers",e[e.arcgisrest=3]="arcgisrest",e[e.tilearcgisrest=4]="tilearcgisrest",e[e.imagearcgisrest=5]="imagearcgisrest",e[e.composite=6]="composite",lp;var e}(),cp=function e(t,i){m(this,e),Object.assign(this,t),this.catalogService=i},up=function(e){o(i,e);var t=r(i);function i(e,o){var n;return m(this,i),(n=t.call(this,e,o)).type=lp[lp[lp.wms]],n}return y(i,[{key:"collectCatalogItems",value:function(){return this.catalogService.loadCatalogWMSLayerItems(this)}}]),i}(cp),pp=function(e){o(i,e);var t=r(i);function i(e,o){var n;return m(this,i),(n=t.call(this,e,o)).type=lp[lp[lp.wmts]],n}return y(i,[{key:"collectCatalogItems",value:function(){return this.catalogService.loadCatalogWMTSLayerItems(this)}}]),i}(cp),dp=function(e){o(i,e);var t=r(i);function i(e,o){var n;return m(this,i),(n=t.call(this,e,o)).type=lp[lp[lp.baselayers]],n}return y(i,[{key:"collectCatalogItems",value:function(){return this.catalogService.loadCatalogBaseLayerItems(this)}}]),i}(cp),hp=function(e){o(i,e);var t=r(i);function i(e,o){var n;return m(this,i),(n=t.call(this,e,o)).type=lp[lp[lp.arcgisrest]],n}return y(i,[{key:"collectCatalogItems",value:function(){return this.catalogService.loadCatalogArcGISRestItems(this)}}]),i}(cp),gp=function(e){o(i,e);var t=r(i);function i(e,o,n){var r;return m(this,i),(r=t.call(this,e,o)).type=lp[lp[n]],r}return y(i,[{key:"collectCatalogItems",value:function(){return this.catalogService.loadCatalogArcGISRestItems(this)}}]),i}(cp),fp=function(e){o(i,e);var t=r(i);function i(e,o){var n;return m(this,i),(n=t.call(this,e,o)).type=lp[lp[lp.composite]],n.url=null,n}return y(i,[{key:"collectCatalogItems",value:function(){return this.catalogService.loadCatalogCompositeLayerItems(this)}}]),i}(cp),mp=function(){function e(){m(this,e)}return y(e,null,[{key:"createInstanceCatalog",value:function(e,t){return e.hasOwnProperty("composite")?new fp(e,t):e.type===lp[lp.baselayers]?new dp(e,t):e.type===lp[lp.arcgisrest]?new hp(e,t):e.type===lp[lp.tilearcgisrest]?new gp(e,t,lp.tilearcgisrest):e.type===lp[lp.imagearcgisrest]?new gp(e,t,lp.imagearcgisrest):e.type===lp[lp.wmts]?new pp(e,t):new up(e,t)}}]),e}(),vp=function(){var e=function(){function e(t){m(this,e),this.http=t,this.queryEnabled=!0}return y(e,[{key:"query",value:function(e,t){var i=this;return e.filter(function(e){return e.visible&&e.isInResolutionsRange}).map(function(e){return i.queryLayer(e,t)})}},{key:"queryLayer",value:function(e,t){var i=this,o=this.getQueryUrl(e.dataSource,t,!1,e.map.viewController.getExtent());if(!o)return(0,U.of)([]);if(e.dataSource.options.queryFormat===wc.HTMLGML2){var n=this.getQueryUrl(e.dataSource,t,!0);return this.http.get(n,{responseType:"text"}).pipe((0,es.zg)(function(n){var r=i.mergeGML(n,o,e),a=r[0],s=r[1];return i.http.get(o,{responseType:"text"}).pipe((0,D.U)(function(n){return i.extractData(n,e,t,o,a,s)}))}))}return this.http.get(o,{responseType:"text"}).pipe((0,D.U)(function(n){return i.extractData(n,e,t,o)}))}},{key:"mergeGML",value:function(e,t,i){var o,n,r=(new Vs.Z).readFeatures(e);0===r.length&&(r=(new Qs.Z).readFeatures(e));var a,s,l,c,u,p,d=new ml.Z([]),h=[],g=new vl.Z([]),f=r.length,m=this.getQueryParams(t.toLowerCase()).bbox.split(","),v=Cs.lJ();if(Cs.l7(v,m),null===(n=null===(o=i.options)||void 0===o?void 0:o.source)||void 0===n?void 0:n.options){var y=i.options.source.options;y.queryTitle&&(c=y.queryTitle)}switch(r.map(function(e){if(c){var t=e.getProperties()[c];t&&(l=l?"".concat(l,",").concat(t):t)}var i=e.getGeometry().getCoordinates(),o=e.getGeometry().getType();switch(!s&&(s=o),o){case"Point":1===f?a=new us.Z(i,"XY"):h.push(i);break;case"LineString":d.appendLineString(new Ls.Z(i,"XY"));break;case"Polygon":g.appendPolygon(new As.ZP(i,"XY"));break;case"MultiPolygon":g=new vl.Z(i,"XY");break;default:return}}),u=0===h.length&&a?{type:a.getType(),coordinates:a.getCoordinates()}:{type:"Polygon",coordinates:[this.convexHull(h)]},s){case"LineString":p={type:d.getType(),coordinates:d.getCoordinates()};case"Point":return u;case"Polygon":p={type:g.getType(),coordinates:g.getCoordinates()};case"MultiPolygon":p={type:g.getType(),coordinates:g.getCoordinates()}}var b={};return c&&(b[c]=l),[p,b]}},{key:"cross",value:function(e,t,i){return(e[0]-i[0])*(t[1]-i[1])-(e[1]-i[1])*(t[0]-i[0])}},{key:"convexHull",value:function(e){e.sort(function(e,t){return e[0]===t[0]?e[1]-t[1]:e[0]-t[0]});var t,i=[],o=p(e);try{for(o.s();!(t=o.n()).done;){for(var n=t.value;i.length>=2&&this.cross(i[i.length-2],i[i.length-1],n)<=0;)i.pop();i.push(n)}}catch(s){o.e(s)}finally{o.f()}for(var r=[],a=e.length-1;a>=0;a--){for(;r.length>=2&&this.cross(r[r.length-2],r[r.length-1],e[a])<=0;)r.pop();r.push(e[a])}return r.pop(),i.pop(),i.concat(r)}},{key:"extractData",value:function(e,t,i,o,n,r){var a=this,s=t.dataSource,l=this.getAllowedFieldsAndAlias(t),c=[];switch(s.options.queryFormat){case wc.GML3:c=this.extractGML3Data(e,t.zIndex,l);break;case wc.JSON:case wc.GEOJSON:case wc.GEOJSON2:c=this.extractGeoJSONData(e,t.zIndex,l);break;case wc.ESRIJSON:c=this.extractEsriJSONData(e,t.zIndex,l);break;case wc.TEXT:c=this.extractTextData(e);break;case wc.HTML:c=this.extractHtmlData(e,s.queryHtmlTarget,o);break;case wc.HTMLGML2:c=this.extractHtmlData(e,s.queryHtmlTarget,o,n,r);break;case wc.GML2:default:c=this.extractGML2Data(e,t,l)}if(c.length>0&&null===c[0].geometry){var u,d=this.createGeometryFromUrlClick(o),h=p(c);try{for(h.s();!(u=h.n()).done;){u.value.geometry=d}}catch(g){h.e(g)}finally{h.f()}}return c.map(function(e,o){var n,r,l=e.properties[s.mapLabel];if("wms"===(null===(n=t.options.sourceOptions)||void 0===n?void 0:n.type)){var u=t.options.sourceOptions;r=u?u.excludeAttribute:void 0}var p=a.getQueryTitle(e,t);!p&&c.length>1?p="".concat(t.title," (").concat(o+1,")"):p||(p=t.title);var d=Object.assign({},e.meta||{},{id:oe(),title:p,mapTitle:l,sourceTitle:t.title,order:1e3-t.zIndex,excludeAttribute:r});return Object.assign(e,{meta:d,projection:"carto"===s.options.type?"EPSG:4326":i.projection})})}},{key:"createGeometryFromUrlClick",value:function(e){var t=this.getQueryParams(e.toLowerCase()),i=t.bbox,o=parseInt(t.width,10),n=parseInt(t.height,10),r=parseInt(t.i||t.x,10),a=parseInt(t.j||t.y,10),s=i.split(","),l=.05*(Math.abs(parseFloat(s[0]))-Math.abs(parseFloat(s[2])));Math.abs(parseFloat(s[0]))<180&&(l=.045);var c=parseFloat(s[0])+Math.abs(parseFloat(s[0])-parseFloat(s[2]))*r/o-l,u=parseFloat(s[1])+Math.abs(parseFloat(s[1])-parseFloat(s[3]))*a/n-l,p=c+2*l,d=u+2*l,h="POLYGON(("+c+" "+u+", "+c+" "+d+", "+p+" "+d+", "+p+" "+u+", "+c+" "+u+"))",g=(new $s.Z).readFeature(h).getGeometry();return{type:g.getType(),coordinates:g.getCoordinates()}}},{key:"extractGML2Data",value:function(e,t,i){var o=this,n=(new Vs.Z).readFeatures(e);if(0===n.length){var r=new Qs.Z;try{n=r.readFeatures(e)}catch(a){console.warn("query.service: Multipolygons are badly managed in mapserver in GML2. Use another format.")}}return n.map(function(e){return o.featureToResult(e,t,i)})}},{key:"extractGML3Data",value:function(e,t,i){var o=this,n=new Hs.Z,r=[];try{r=n.readFeatures(e)}catch(a){console.warn("query.service: GML3 is not well supported")}return r.map(function(e){return o.featureToResult(e,t,i)})}},{key:"extractGeoJSONData",value:function(e,t,i){var o=[];try{o=JSON.parse(e.replace(/(\r|\n)/g," ")).features}catch(n){console.warn("query.service: Unable to parse geojson","\n",e)}return o.map(function(e){return e.meta={id:oe(),order:1e3-t,alias:i}}),o}},{key:"extractEsriJSONData",value:function(e,t,i){var o=this;if(e)try{if(JSON.parse(e).error)return[]}catch(n){}return(new Js.Z).readFeatures(e).map(function(e){return o.featureToResult(e,t,i)})}},{key:"extractTextData",value:function(e){return[]}},{key:"extractHtmlData",value:function(e,t,i,o,n){var r=this.getQueryParams(i.toLowerCase()),a=r.crs||r.srs||"EPSG:3857",s=this.createGeometryFromUrlClick(i);t!==Sc.BLANK&&t!==Sc.IFRAME&&(t=Sc.IFRAME);var l=e.toLowerCase().indexOf("<body>"),c=e.toLowerCase().lastIndexOf("</body>")+7;return""===Sl(e.slice(l,c).replace(/(\r|\n|\s)/g,""))||""===e?[]:[{type:ec,projection:a,properties:Object.assign({target:t,body:e,url:i},n),geometry:o||s}]}},{key:"getQueryParams",value:function(e){var t=e.split("?");if(t[1]){var i=t[1].split("&"),o={};return i.forEach(function(e){e=e.split("="),o[e[0]]=decodeURIComponent(e[1]||"")}),o}}},{key:"featureToResult",value:function(e,t,i){var o,n=e.getGeometry(),r=Object.assign({},e.getProperties());return delete r.geometry,delete r.GEOMETRIE,delete r.boundedBy,delete r.shape,delete r.SHAPE,delete r.the_geom,delete r.geom,n&&(o={type:n.getType(),coordinates:n.getCoordinates()}),{type:ec,projection:void 0,properties:r,geometry:o,meta:{id:oe(),order:1e3-t,alias:i}}}},{key:"getQueryUrl",value:function(e,t){var i,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0;if(e.options.queryUrl)return this.getCustomQueryUrl(e,t,n);switch(e.constructor){case Mc:var r=e,a={INFO_FORMAT:r.params.INFO_FORMAT||this.getMimeInfoFormat(e.options.queryFormat),QUERY_LAYERS:r.params.LAYERS,FEATURE_COUNT:r.params.FEATURE_COUNT||"5"};o&&(a.INFO_FORMAT=this.getMimeInfoFormat(wc.GML2)),i=r.ol.getFeatureInfoUrl(t.coordinates,t.resolution,t.projection,a);break;case Wc:var s=e;i="".concat("https://"+s.options.account+".carto.com/api/v2/sql?","format=GeoJSON").concat("&q="+s.options.config.layers[0].options.sql," WHERE ST_Intersects(the_geom_webmercator,ST_BUFFER(ST_SetSRID(ST_POINT(").concat(t.coordinates[0]+","+t.coordinates[1]+"),3857),"+(s.options.queryPrecision?s.options.queryPrecision:"1000")+"))");break;case Kc:case eu:var l=e,c=Math.abs(n[0]-n[2]),u=Math.abs(n[1]-n[3]),p=.005*(c>u?c:u),d=l.options.queryPrecision?l.options.queryPrecision:p,h=Cs.f3(Cs.hI([t.coordinates]),d);i="".concat(l.options.url+"/"+l.options.layer+"/query/","?").concat(["f=json","geometry=".concat(encodeURIComponent('{"xmin":'+h[0]+',"ymin":'+h[1]+',"xmax":'+h[2]+',"ymax":'+h[3]+',"spatialReference":{"wkid":102100}}')),"geometryType=esriGeometryEnvelope","inSR=102100","spatialRel=esriSpatialRelIntersects","outFields=*","returnGeometry=true","outSR=102100"].join("&"))}return i}},{key:"getMimeInfoFormat",value:function(e){var t="application/vnd.ogc.gml",i=Object.keys(wc).find(function(t){return wc[t]===e});return i&&(t=xc[i]),t}},{key:"getAllowedFieldsAndAlias",value:function(e){var t,i,o,n;return(null===(o=null===(i=null===(t=e.options)||void 0===t?void 0:t.source)||void 0===i?void 0:i.options)||void 0===o?void 0:o.sourceFields)&&e.options.source.options.sourceFields.length>=1&&(n={},e.options.source.options.sourceFields.forEach(function(e){n[e.name]=e.alias?e.alias:e.name})),n}},{key:"getQueryTitle",value:function(e,t){var i,o,n;if(null===(o=null===(i=t.options)||void 0===i?void 0:i.source)||void 0===o?void 0:o.options){var r=t.options.source.options;r.queryTitle&&(n=this.getLabelMatch(e,r.queryTitle))}return n}},{key:"getLabelMatch",value:function(e,t){var i=t,o=Array.from(t.matchAll(/\$\{([^\{\}]+)\}/g));return o.forEach(function(t){i=i.replace(t[0],e.properties[t[1]])}),0===o.length&&i===t&&(i=e.properties[t]||t),i}},{key:"getCustomQueryUrl",value:function(e,t,i){return e.options.queryUrl.replace(/\{xmin\}/g,i[0].toString()).replace(/\{ymin\}/g,i[1].toString()).replace(/\{xmax\}/g,i[2].toString()).replace(/\{ymax\}/g,i[3].toString()).replace(/\{x\}/g,t.coordinates[0].toString()).replace(/\{y\}/g,t.coordinates[1].toString()).replace(/\{resolution\}/g,t.resolution.toString()).replace(/\{srid\}/g,t.projection.replace("EPSG:",""))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(P.eN))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function yp(e){return!0===e.dataSource.options.queryable}function bp(e){var t=e.get("_layer");return void 0!==t&&yp(t)&&function(e){var t=e.dataSource;return void 0===t.options.queryLayerFeatures||!0===t.options.queryLayerFeatures}(t)}var wp=function(){var e=function(){function e(t,i){m(this,e),this.component=t,this.queryService=i,this.queries$$=[],this.queryFeatures=!1,this.queryFeaturesHitTolerance=0,this.waitForAllQueries=!0,this.query=new w.vpe}return y(e,[{key:"map",get:function(){return this.component.map}},{key:"ngAfterViewInit",value:function(){this.listenToMapClick(),this.addDragBoxInteraction()}},{key:"ngOnDestroy",value:function(){this.cancelOngoingQueries(),this.unlistenToMapClick(),this.removeDragBoxInteraction()}},{key:"listenToMapClick",value:function(){var e=this;this.mapClickListener=this.map.ol.on("singleclick",function(t){return e.onMapEvent(t)})}},{key:"unlistenToMapClick",value:function(){(0,Os.B)(this.mapClickListener),this.mapClickListener=void 0}},{key:"onMapEvent",value:function(e){var t=this;if(this.cancelOngoingQueries(),this.queryService.queryEnabled){var i=[];this.queryFeatures&&i.push(this.doQueryFeatures(e));var o=this.map.ol.getView().getResolution(),n=this.map.layers.filter(yp);i.push.apply(i,d(this.queryService.query(n,{coordinates:e.coordinate,projection:this.map.projection,resolution:o}))),0!==i.length&&(this.waitForAllQueries?this.queries$$.push(za.$R.apply(void 0,i).subscribe(function(i){var o,n=(o=[]).concat.apply(o,d(i));t.query.emit({features:n,event:e})})):this.queries$$=i.map(function(i){return i.subscribe(function(i){t.query.emit({features:i,event:e})})}))}}},{key:"doQueryFeatures",value:function(e){var t=this,i=[];if("singleclick"===e.type)this.map.ol.forEachFeatureAtPixel(e.pixel,function(e,o){var n=t.map.getLayerById(o.values_._layer.id);if(!n.dataSource.options.queryFormatAsWms&&e)if(e.get("features")){var r,a=p(e.get("features"));try{for(a.s();!(r=a.n()).done;){var s=r.value,l=gu(s,t.map.projection);l.meta={title:s.values_.nom,id:o.values_._layer.id+"."+s.id_,icon:s.values_._icon,sourceTitle:o.values_.title,alias:t.queryService.getAllowedFieldsAndAlias(n)},i.push(l)}}catch(d){a.e(d)}finally{a.f()}}else if(e instanceof wl.Z){var c=function(e,t,i){var o,n,r,a,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"EPSG:4326";i?(n=i.get("title"),i.get("sourceOptions")&&(r=i.get("sourceOptions").excludeAttribute,a=i.get("sourceOptions").excludeAttributeOffline)):n=e.get("_title");var l=new Zs.Z,c=e.getProperties(),u=e.getType();if("Polygon"===u){var p=e.getEnds();o=new As.ZP(e.getFlatCoordinates(),Ts.Z.XY,p)}else"Point"===u?o=new us.Z(e.getFlatCoordinates(),Ts.Z.XY):"LineString"===u&&(o=new Ls.Z(e.getFlatCoordinates(),Ts.Z.XY));var d=l.writeGeometryObject(o,{dataProjection:s,featureProjection:t}),h=e.getId()?e.getId():oe(),g=e.get("_mapTitle"),f=ls.$A(e.getExtent(),t,s);return{type:ec,projection:s,extent:f,meta:{id:h,title:n||g||h,mapTitle:g,excludeAttribute:r,excludeAttributeOffline:a},properties:c,geometry:d,ol:e}}(e,t.map.projection,o);c.meta={id:o.values_._layer.id+"."+c.meta.id,sourceTitle:o.values_.title,alias:t.queryService.getAllowedFieldsAndAlias(n),title:t.queryService.getQueryTitle(c,n)||c.meta.title},i.push(c)}else{var u=gu(e,t.map.projection,o);u.meta={id:o.values_._layer.id+"."+u.meta.id,sourceTitle:o.values_.title,alias:t.queryService.getAllowedFieldsAndAlias(n),title:t.queryService.getQueryTitle(u,n)||u.meta.title},i.push(u)}},{hitTolerance:this.queryFeaturesHitTolerance||0,layerFilter:this.queryFeaturesCondition?this.queryFeaturesCondition:bp});else if("boxend"===e.type){var o=e.target.getGeometry().getExtent();this.map.layers.filter(yp).filter(function(e){return e instanceof jc&&e.visible}).map(function(e){e.dataSource.ol.forEachFeatureIntersectingExtent(o,function(o){var n=gu(o,t.map.projection,e.ol);n.meta={id:e.id+"."+o.getId(),icon:o.values_._icon,sourceTitle:e.title,alias:t.queryService.getAllowedFieldsAndAlias(e),title:t.queryService.getQueryTitle(n,e)||n.meta.title},i.push(n)})})}return(0,U.of)(i)}},{key:"cancelOngoingQueries",value:function(){this.queries$$.forEach(function(e){return e.unsubscribe()}),this.queries$$=[]}},{key:"addDragBoxInteraction",value:function(){var e,t,i=this,o=p(this.map.ol.getInteractions().getArray());try{for(o.s();!(t=o.n()).done;){var n=t.value;if(n instanceof ku){e=n;break}}}catch(r){o.e(r)}finally{o.f()}void 0===e&&(e=new ku({condition:Uc}),this.map.ol.addInteraction(e),this.olDragSelectInteraction=e),this.olDragSelectInteractionEndKey=e.on("boxend",function(e){return i.onMapEvent(e)})}},{key:"removeDragBoxInteraction",value:function(){void 0!==this.olDragSelectInteractionEndKey&&(0,Os.B)(this.olDragSelectInteractionEndKey),void 0!==this.olDragSelectInteraction&&this.map.ol.removeInteraction(this.olDragSelectInteraction),this.olDragSelectInteraction=void 0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Du,2),w.Y36(vp))},e.\u0275dir=w.lG2({type:e,selectors:[["","igoQuery",""]],inputs:{queryFeatures:"queryFeatures",queryFeaturesHitTolerance:"queryFeaturesHitTolerance",queryFeaturesCondition:"queryFeaturesCondition",waitForAllQueries:"waitForAllQueries"},outputs:{query:"query"}}),e}(),xp=function(){var e=function(){function e(t,i){var o=this;if(m(this,e),this.storageService=i,this.options=t,this.storageService){var n=this.storageService.get(this.getId()+".options");n&&(this.options=K.mergeDeep(this.options,n))}this.options=K.mergeDeep(this.getDefaultOptions(),this.options),this.settings.forEach(function(e){o.setParamFromSetting(e,!1)})}return y(e,[{key:"getId",value:function(){throw new Error('You have to implement the method "getId".')}},{key:"getType",value:function(){throw new Error('You have to implement the method "getType".')}},{key:"getDefaultOptions",value:function(){throw new Error('You have to implement the method "getDefaultOptions".')}},{key:"title",get:function(){return this.options.title}},{key:"available",get:function(){return!1!==this.options.available}},{key:"enabled",get:function(){return this.available&&!1!==this.options.enabled},set:function(e){this.options.enabled=e}},{key:"showInPointerSummary",get:function(){return this.options.showInPointerSummary||!1}},{key:"showInSettings",get:function(){var e=this.options.showInSettings;return void 0===e||e}},{key:"searchUrl",get:function(){return this.options.searchUrl}},{key:"params",get:function(){return void 0===this.options.params?{}:this.options.params}},{key:"settings",get:function(){return void 0===this.options.settings?[]:this.options.settings}},{key:"setParamFromSetting",value:function(e){var t=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];switch(e.type){case"radiobutton":e.values.forEach(function(i){i.enabled&&(t.options.params=Object.assign(t.options.params||{},u({},e.name,i.value)))});break;case"checkbox":var o="";e.values.filter(function(e){return!1!==e.available}).forEach(function(e){e.enabled&&(o+=e.value+",")}),o=o.slice(0,-1),this.options.params=Object.assign(this.options.params||{},u({},e.name,o))}i&&this.storageService&&this.storageService.set(this.getId()+".options",{params:this.options.params})}},{key:"displayOrder",get:function(){return void 0===this.options.order?99:this.options.order}},{key:"getHashtagsValid",value:function(e,t){var i=e.match(/(#[A-Za-z]+)/g);if(i){var o=this.getSettingsValues(t),n=[];return i.forEach(function(e){o.values.forEach(function(t){var i=e.substring(1);if("string"==typeof t.value){var o=t.value.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").split(","),r=o.indexOf(i.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""));-1!==r&&n.push(o[r])}t.hashtags&&-1!==t.hashtags.indexOf(i.toLowerCase())&&n.push(t.value)})}),n.filter(function(e,t){return n.indexOf(e)===t})}}},{key:"getSettingsValues",value:function(e){return this.getDefaultOptions().settings.find(function(t){return t.name===e})}}]),e}();return e.id="",e.type="",e}(),Sp=function(){var e=function(e){o(i,e);var t=r(i);function i(e){return m(this,i),t.call(this,e)}return y(i,[{key:"getId",value:function(){return i.id}},{key:"getType",value:function(){return i.type}},{key:"getDefaultOptions",value:function(){return{title:"Carte"}}}]),i}(xp);return e.id="map",e.type=ec,e.\u0275fac=function(t){return new(t||e)(w.LFG("options"))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac}),e}(),kp=function(){function e(){m(this,e)}return y(e,null,[{key:"getGoogleMapsCoordLink",value:function(e,t){return"https://www.google.com/maps?q="+t+","+e}},{key:"getGoogleStreetViewLink",value:function(e,t){return"https://www.google.com/maps?q=&layer=c&cbll="+t+","+e}},{key:"getGoogleMapsNameLink",value:function(e){return"https://www.google.com/maps?q="+encodeURI(e)}}]),e}(),Cp=function(){function e(){m(this,e)}return y(e,null,[{key:"getOpenStreetMapLink",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:17;return"https://www.openstreetmap.org/?mlat=".concat(t,"&mlon=").concat(e,"#map=").concat(i,"/").concat(t,"/").concat(e)}},{key:"getOpenStreetCamLink",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:17;return"https://openstreetcam.org/map/@".concat(t,",").concat(e,",").concat(i,"z")}}]),e}(),Tp=function(){var e=function(){function e(t,i,o,n,r){m(this,e),this.http=t,this.config=i,this.languageService=o,this.messageService=n,this.capabilitiesService=r}return y(e,[{key:"loadCatalogs",value:function(){var e=this.config.getConfig("context")||{},t=this.config.getConfig("catalog")||{},i=t.url||e.url,o=t.sources||[],n=[];if(i){if(t.baseLayers){var r=this.languageService.translate.instant("igo.geo.catalog.baseLayers");n.push((0,U.of)([{id:"catalog.baselayers",title:r,url:"".concat(i,"/baselayers"),type:"baselayers"}]))}var a=this.http.get("".concat(i,"/catalogs")).pipe((0,D.U)(function(e){return e.map(function(e){return Object.assign(e,e.options)})}),(0,q.K)(function(e){return Va.E}));n.push(a)}return o.length>0&&n.push((0,U.of)(o).pipe((0,D.U)(function(e){return e.map(function(e){return e.id||(e.id=oe()),e})}))),za.$R.apply(void 0,n).pipe((0,D.U)(function(e){return[].concat.apply([],e)}))}},{key:"loadCatalogItems",value:function(e){return mp.createInstanceCatalog(e,this).collectCatalogItems()}},{key:"loadCatalogBaseLayerItems",value:function(e){return this.getCatalogBaseLayersOptions(e).pipe((0,D.U)(function(t){var i=t.map(function(t){return{id:ac(t.sourceOptions),title:t.title,type:sp.Layer,externalProvider:e.externalProvider,options:t}});return[{id:"catalog.group.baselayers",type:sp.Group,externalProvider:e.externalProvider,title:e.title,items:i}]}))}},{key:"getCatalogBaseLayersOptions",value:function(e){return this.http.get(e.url)}},{key:"loadCatalogWMSLayerItems",value:function(e){var t=this;return this.getCatalogCapabilities(e).pipe((0,D.U)(function(i){var o=[];if(!i)return o;i.Service&&i.Service.Abstract&&i.Service.Abstract.length&&(e.abstract=i.Service.Abstract);var n=[];t.flattenWmsCapabilities(i.Capability.Layer,0,n,e.groupSeparator);var r=Object.assign({},i.Capability.Layer);return r.Layer=n.filter(function(e){return 0!==e.Layer.length}),t.includeRecursiveItems(e,r,o),o}))}},{key:"flattenWmsCapabilities",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:" / ";if(!i.includes(e.Title)){var n=Object.assign({},e);n.Layer=[],i.push(n)}var r,a=p(e.Layer);try{for(a.s();!(r=a.n()).done;){var s=r.value,l=Object.assign({},s);t>0&&(l.Title=e.Title+o+s.Title),s.Layer?this.flattenWmsCapabilities(l,t+1,i,o):i.find(function(t){return t.Title===e.Title}).Layer.push(s)}}catch(c){a.e(c)}finally{a.f()}}},{key:"loadCatalogWMTSLayerItems",value:function(e){var t=this;return this.getCatalogCapabilities(e).pipe((0,D.U)(function(i){return t.getWMTSItems(e,i)}))}},{key:"loadCatalogArcGISRestItems",value:function(e){var t=this;return this.getCatalogCapabilities(e).pipe((0,D.U)(function(i){return t.getArcGISRESTItems(e,i)}))}},{key:"loadCatalogCompositeLayerItems",value:function(e){var t=this,i=e.composite,o=[];i.map(function(i){i.sortDirection=e.sortDirection,o.push(mp.createInstanceCatalog(i,t))});var n=[];o.map(function(e){return n.push(e.collectCatalogItems())});var r=[];function a(e){return e.reduce(function(e,t){return e.concat(t.type===sp.Group?a(t.items):t)},[])}if(Object.keys(i).find(function(e){return i[e].groupImpose})){var s=function(e,t){var i=o[t],n=Object.assign({},i.groupImpose);n.address=i.id,n.type=sp.Group,n.externalProvider=i.externalProvider,void 0===n.sortDirection&&(n.sortDirection=i.sortDirection),n.items=[];var r=a(e);return r.map(function(e){return e.address="".concat(n.address,".").concat(n.id)}),n.items=r,n};r=n.map(function(e,t){return e.pipe((0,D.U)(function(e){return i[t].groupImpose?s(e,t):e}))})}else r=n;var l=za.$R.apply(void 0,d(r)).pipe((0,D.U)(function(e){var t;return(t=[]).concat.apply(t,d(e))})),c=function e(t,i){return t.reduce(function(t,o,n,r){var a=i(o),s=Object.assign({},o);if(o.type===sp.Layer){var l=[];if(r.filter(function(e,t){var i=!1;return e.title===a&&e.type===sp.Layer&&(t!==n&&e.address!==o.address&&(i=!0),l.push(t)),i}).length>0){var c=l.findIndex(function(e){return e===n})+1;s.title="".concat(o.title," (").concat(c,")")}t.find(function(e){return e.title===s.title&&e.type===sp.Layer})||(t[t.length]=s)}else o.type===sp.Group&&(s.items=e(o.items,function(e){return e.title}),t[t.length]=s);return t},[])};return l.pipe((0,D.U)(function(e){return function(e,t){return e.reduce(function(e,t){var i=function(e){return e.id}(t),o=e.find(function(e){return e.id===i});if(o){var n,r=e.indexOf(o);-1===e[r].address.split("|").indexOf(t.address)&&(e[r].address="".concat(e[r].address,"|").concat(t.address)),(n=e[r].items).push.apply(n,d(t.items))}else e[e.length]=t;return e},[])}(e)}),(0,D.U)(function(e){var t;return(t=[]).concat.apply(t,d(e))}),(0,D.U)(function(e){return c(e,function(e){return e.title})}))}},{key:"getCatalogCapabilities",value:function(e){var t=this;return this.capabilitiesService.getCapabilities(lp[e.type],e.url,e.version).pipe((0,q.K)(function(i){var o=t.languageService.translate.instant("igo.geo.catalog.unavailableTitle"),n=e.title?t.languageService.translate.instant("igo.geo.catalog.unavailable",{value:e.title}):t.languageService.translate.instant("igo.geo.catalog.someUnavailable");return t.messageService.error(n,o),console.error(i),(0,U.of)(void 0)}))}},{key:"prepareCatalogItemLayer",value:function(e,t,i,o){var n,r,a=this.retrieveLayerInfoFormat(e.Name,i),s=e.DataURL?e.DataURL[0]:void 0,l=o.showLegend&&e.Style?this.capabilitiesService.getStyle(e.Style):void 0,c=Object.assign({},o.queryParams,{LAYERS:e.Name,VERSION:o.version}),u={type:"wms",url:o.url,crossOrigin:o.setCrossOriginAnonymous?"anonymous":void 0,queryFormat:a,queryHtmlTarget:a===wc.HTML||a===wc.HTMLGML2?"iframe":void 0,optionsFromCapabilities:!0},d=Object.assign({},u,o.sourceOptions,{params:c});if(o.forcedProperties){var h,g=p(o.forcedProperties);try{for(g.s();!(h=g.n()).done;){var f=h.value;e.Name===f.layerName&&f.title&&(n=f.title)}}catch(v){g.e(v)}finally{g.f()}}e.Abstract?r=e.Abstract:!e.Abstract&&o.abstract&&(r=o.abstract);var m={id:ac(d),type:sp.Layer,title:void 0!==n?n:e.Title,address:t,externalProvider:o.externalProvider||!1,options:{maxResolution:Nc(e.MaxScaleDenominator),minResolution:Nc(e.MinScaleDenominator),metadata:{url:s?s.OnlineResource:void 0,extern:!!s||void 0,abstract:r,type:u.type},legendOptions:l,tooltip:{type:o.tooltipType},sourceOptions:d}};return K.removeUndefined(m)}},{key:"prepareCatalogItemGroup",value:function(e,t,i,o,n){var r=this;return{id:i,type:sp.Group,title:e.Title,address:n.id,externalProvider:n.externalProvider||!1,sortDirection:n.sortDirection,items:e.Layer.reduce(function(e,a){if(void 0!==a.Layer){var s=r.prepareCatalogItemGroup(a,t,i+".group.".concat(a.Name||a.Layer[0].Name),o,n);e.push(s)}else{if(!1===r.testLayerRegexes(a.Name,t))return e;var l=r.prepareCatalogItemLayer(a,i,o,n);e.push(l)}return e},[])}}},{key:"includeRecursiveItems",value:function(e,t,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=(e.regFilters||[]).map(function(e){return new RegExp(e)});if(t.Layer){var r,a=p(t.Layer);try{for(a.s();!(r=a.n()).done;){var s=r.value;if(void 0===s.Layer){var l=this.findCatalogInfoFormat(e);if(0!==o){var c=this.prepareCatalogItemGroup(t,n,"catalog.group.".concat(t.Name||s.Name),l,e);0!==c.items.length&&i.push(c);break}if(!1!==this.testLayerRegexes(s.Name,n)){var u=this.prepareCatalogItemLayer(s,e.id,l,e);i.push(u)}}else this.includeRecursiveItems(e,s,i,o+1)}}catch(d){a.e(d)}finally{a.f()}}}},{key:"getWMTSItems",value:function(e,t){var i=this;if(!t)return[];var o=t.Contents.Layer,n=(e.regFilters||[]).map(function(e){return new RegExp(e)});return t.ServiceIdentification&&t.ServiceIdentification.Abstract&&t.ServiceIdentification.Abstract.length&&(e.abstract=t.ServiceIdentification.Abstract),o.map(function(t){var o;if(e.forcedProperties){var r,a=p(e.forcedProperties);try{for(a.s();!(r=a.n()).done;){var s=r.value;t.Title===s.layerName&&s.title&&(o=s.title)}}catch(d){a.e(d)}finally{a.f()}}if(!1!==i.testLayerRegexes(t.Identifier,n)){var l=Object.assign({},e.queryParams,{version:"1.0.0"}),c={type:"wmts",url:e.url,crossOrigin:e.setCrossOriginAnonymous?"anonymous":void 0,layer:t.Identifier,matrixSet:e.matrixSet,optionsFromCapabilities:!0,requestEncoding:e.requestEncoding||"KVP",style:"default"},u=Object.assign({},c,e.sourceOptions,{params:l});return K.removeUndefined({id:ac(u),type:sp.Layer,title:void 0!==o?o:t.Title,address:e.id,externalProvider:e.externalProvider,options:{sourceOptions:u,metadata:{url:void 0,extern:void 0,abstract:e.abstract,type:c.type}}})}}).filter(function(e){return void 0!==e})}},{key:"getArcGISRESTItems",value:function(e,t){var i=this;if(!t)return[];var o=t.layers?t.layers.filter(function(e){return!e.type||"Feature Layer"===e.type}):[];t.layers||this.messageService.error(this.languageService.translate.instant("igo.geo.catalog.someUnavailable"),this.languageService.translate.instant("igo.geo.catalog.unavailableTitle"));var n,r=(e.regFilters||[]).map(function(e){return new RegExp(e)});return t.serviceDescription&&t.serviceDescription.length&&(n=t.serviceDescription.replace(/(<([^>]+)>)/gi,"")),o.map(function(t){var o;if(e.forcedProperties){var a,s=p(e.forcedProperties);try{for(s.s();!(a=s.n()).done;){var l=a.value;t.name===l.layerName&&l.title&&(o=l.title)}}catch(d){s.e(d)}finally{s.f()}}if(!1!==i.testLayerRegexes(t.id,r)){var c={type:lp[e.type],url:e.url,crossOrigin:e.setCrossOriginAnonymous?"anonymous":void 0,layer:t.id,queryable:!0,queryFormat:"esrijson",matrixSet:e.matrixSet,optionsFromCapabilities:!0,style:"default"},u=Object.assign({},c,e.sourceOptions);return K.removeUndefined({id:ac(u),type:sp.Layer,title:void 0!==o?o:t.name,externalProvider:e.externalProvider,address:e.id,options:{sourceOptions:u,minResolution:Nc(t.maxScale),maxResolution:Nc(t.minScale),metadata:{url:void 0,extern:void 0,abstract:n,type:c.type},title:void 0!==o?o:t.name}})}}).filter(function(e){return void 0!==e})}},{key:"testLayerRegexes",value:function(e,t){return 0===t.length||void 0!==t.find(function(t){return t.test(e)})}},{key:"retrieveLayerInfoFormat",value:function(e,t){var i,o=t.find(function(t){return t.layer===e}),n=t.find(function(e){return"*"===e.layer});return o?i=o.queryFormat:n&&(i=n.queryFormat),i}},{key:"findCatalogInfoFormat",value:function(e){var t=[];return e.queryFormat&&Object.keys(e.queryFormat).forEach(function(i){e.queryFormat[i]instanceof Array?e.queryFormat[i].forEach(function(e){t.find(function(t){return t.layer===e})||t.push({layer:e,queryFormat:i})}):t.find(function(t){return t.layer===e.queryFormat[i]})||t.push({layer:e.queryFormat[i],queryFormat:i})}),t}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(P.eN),w.LFG(he),w.LFG(Ce),w.LFG(Ae),w.LFG(cu))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function Ap(e,t){if(1&e){var i=w.EpF();w.ynx(0),w.TgZ(1,"igo-catalog-browser-group",3),w.NdJ("addedChange",function(e){return w.CHM(i),w.oxw(2).onGroupAddedChange(e)})("layerAddedChange",function(e){return w.CHM(i),w.oxw(2).onLayerAddedChange(e)}),w.ALo(2,"async"),w.qZA(),w.BQk()}if(2&e){var o=w.oxw().$implicit,n=w.oxw();w.xp6(1),w.Q6J("catalog",n.catalog)("group",o)("state",n.store.state)("resolution",w.lcZ(2,7,n.resolution$))("catalogAllowLegend",n.catalogAllowLegend)("collapsed",1!==n.store.count)("toggleCollapsed",n.toggleCollapsedGroup)}}function Lp(e,t){if(1&e){var i=w.EpF();w.ynx(0),w.TgZ(1,"igo-catalog-browser-layer",4),w.NdJ("addedChange",function(e){return w.CHM(i),w.oxw(2).onLayerAddedChange(e)}),w.ALo(2,"async"),w.qZA(),w.BQk()}if(2&e){var o=w.oxw().$implicit,n=w.oxw();w.xp6(1),w.Q6J("layer",o)("resolution",w.lcZ(2,4,n.resolution$))("catalogAllowLegend",n.catalogAllowLegend)("added",n.store.state.get(o).added)}}function Zp(e,t){if(1&e&&(w.YNc(0,Ap,3,9,"ng-container",2),w.YNc(1,Lp,3,6,"ng-container",2)),2&e){var i=t.$implicit,o=w.oxw();w.Q6J("ngIf",o.isGroup(i)),w.xp6(1),w.Q6J("ngIf",o.isLayer(i))}}var Fp=function(){var e=function(){function e(t,i){m(this,e),this.layerService=t,this.cdRef=i,this.catalogAllowLegend=!1,this.toggleCollapsedGroup=!0}return y(e,[{key:"resolution$",get:function(){return this.map.viewController.resolution$}},{key:"ngOnInit",value:function(){var e=this.map.layers.map(function(e){return{id:e.options.source.id,title:e.title,type:sp.Layer}});this.store.state.updateMany(e,{added:!0},!0),this.catalog&&void 0!==this.catalog.sortDirection&&this.store.view.sort({direction:this.catalog.sortDirection,valueAccessor:function(e){return e.title}}),this.catalogAllowLegend=!!this.catalog&&this.catalog.showLegend||this.catalogAllowLegend,this.watcher=new Lt(this.store,this.cdRef)}},{key:"ngOnDestroy",value:function(){this.watcher.destroy()}},{key:"isGroup",value:function(e){return e.type===sp.Group}},{key:"isLayer",value:function(e){return e.type===sp.Layer}},{key:"onLayerAddedChange",value:function(e){var t=e.layer;this.store.state.update(t,{added:e.added},!1),e.added?this.addLayerToMap(t):this.removeLayerFromMap(t)}},{key:"onGroupAddedChange",value:function(e){var t=e.group;this.store.state.update(t,{added:e.added},!1),e.added?this.addGroupToMap(t):this.removeGroupFromMap(t)}},{key:"addLayerToMap",value:function(e){this.addLayersToMap([e])}},{key:"removeLayerFromMap",value:function(e){this.removeLayersFromMap([e])}},{key:"addLayersToMap",value:function(e){var t=this,i=e.map(function(e){return e.options.sourceOptions.optionsFromApi||(e.options.sourceOptions.optionsFromApi=!0),t.layerService.createAsyncLayer(e.options)});za.$R.apply(void 0,d(i)).subscribe(function(i){t.store.state.updateMany(e,{added:!0}),t.map.addLayers(i)})}},{key:"removeLayersFromMap",value:function(e){var t=this;e.forEach(function(e){if(t.store.state.update(e,{added:!1}),!0===e.options.baseLayer){var i=t.map.getLayerById(e.options.id);void 0!==i&&t.map.removeLayer(i)}else{var o=t.map.getLayerById(e.id);void 0!==o&&t.map.removeLayer(o)}})}},{key:"sortCatalogItemsByTitle",value:function(e,t){var i=e.sort(function(e,t){var i=e.title.normalize("NFD").replace(/[\u0300-\u036f]/g,""),o=t.title.normalize("NFD").replace(/[\u0300-\u036f]/g,"");return i<o?-1:i>o?1:0});switch(t){case"asc":return i;case"desc":return i.reverse();default:return e}}},{key:"addGroupToMap",value:function(e){var t=this,i=e.items.filter(function(e){var i=t.store.state.get(e).added||!1;return t.isLayer(e)&&!1===i});void 0!==e.sortDirection&&(i=this.sortCatalogItemsByTitle(i,e.sortDirection)),this.addLayersToMap(i.reverse())}},{key:"removeGroupFromMap",value:function(e){var t=this,i=e.items.filter(function(e){var i=t.store.state.get(e).added||!1;return t.isLayer(e)&&!0===i});this.removeLayersFromMap(i)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Xu),w.Y36(w.sBO))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-catalog-browser"]],inputs:{catalogAllowLegend:"catalogAllowLegend",catalog:"catalog",store:"store",map:"map",toggleCollapsedGroup:"toggleCollapsedGroup"},decls:3,vars:5,consts:[[3,"navigation","selection"],["ngFor","",3,"ngForOf"],[4,"ngIf"],[3,"catalog","group","state","resolution","catalogAllowLegend","collapsed","toggleCollapsed","addedChange","layerAddedChange"],["igoListItem","",3,"layer","resolution","catalogAllowLegend","added","addedChange"]],template:function(e,t){1&e&&(w.TgZ(0,"igo-list",0),w.YNc(1,Zp,2,2,"ng-template",1),w.ALo(2,"async"),w.qZA()),2&e&&(w.Q6J("navigation",!1)("selection",!1),w.xp6(1),w.Q6J("ngForOf",w.lcZ(2,3,t.store.view.all$())))},encapsulation:2,changeDetection:0}),e}(),Op=["renderedLegend"];function Mp(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-list-item"),w.TgZ(1,"mat-icon",7),w.NdJ("toggle",function(e){w.CHM(i);var t=w.oxw(2).$implicit;return w.oxw(3).toggleLegendItem(e,t)}),w.qZA(),w.TgZ(2,"h4",8),w._uU(3),w.ALo(4,"async"),w.qZA(),w.qZA()}if(2&e){w.oxw();var o=w.MAs(3),n=w.oxw().$implicit,r=w.oxw(3);w.xp6(1),w.Q6J("target",o)("collapsed",n.collapsed),w.xp6(2),w.hij("",w.lcZ(4,3,r.computeItemTitle(n))," ")}}function Ip(e,t){if(1&e&&(w.TgZ(0,"mat-option",11),w._uU(1),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i.name),w.xp6(1),w.Oqu(i.title)}}function Pp(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div"),w.TgZ(1,"mat-form-field"),w.TgZ(2,"mat-select",9),w.NdJ("ngModelChange",function(e){return w.CHM(i),w.oxw(5).currentStyle=e})("selectionChange",function(){return w.CHM(i),w.oxw(5).onChangeStyle()}),w.ALo(3,"translate"),w.YNc(4,Ip,2,2,"mat-option",10),w.qZA(),w.qZA(),w.qZA()}if(2&e){var o=w.oxw(5);w.xp6(2),w.Q6J("matTooltip",w.lcZ(3,3,"igo.geo.layer.legend.selectStyle"))("ngModel",o.currentStyle),w.xp6(2),w.Q6J("ngForOf",o.styles)}}function _p(e,t){1&e&&(w.TgZ(0,"small"),w._uU(1),w.ALo(2,"translate"),w.qZA()),2&e&&(w.xp6(1),w.hij(" ",w.lcZ(2,1,"igo.geo.layer.legend.noLegendScale")," "))}var qp=function(e){return[e]};function Dp(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div"),w.TgZ(1,"img",13,14),w.NdJ("load",function(){w.CHM(i);var e=w.oxw(3).$implicit;return w.oxw(3).onLoadImage(e.title)}),w.ALo(3,"translate"),w.qZA(),w.YNc(4,_p,3,3,"small",0),w.qZA()}if(2&e){var o=w.oxw(3).$implicit,n=w.oxw(3);w.xp6(1),w.s9C("id",o.title),w.s9C("src",w.VKq(6,qp,o.imgGraphValue),w.LSH),w.s9C("alt",w.lcZ(3,4,"igo.geo.layer.legend.loadingLegendText")),w.xp6(3),w.Q6J("ngIf",n.imagesHeight[o.title]<16)}}function Ep(e,t){if(1&e&&(w._UZ(0,"div",15),w.ALo(1,"sanitizeHtml")),2&e){var i=w.oxw(3).$implicit;w.Q6J("ngStyle",i.style)("innerHTML",w.lcZ(1,2,i.html),w.oJD)}}function $p(e,t){if(1&e&&(w.TgZ(0,"div"),w.YNc(1,Dp,5,8,"div",0),w.YNc(2,Ep,2,4,"div",12),w.qZA()),2&e){var i=w.oxw(2).$implicit;w.xp6(1),w.Q6J("ngIf",i.url),w.xp6(1),w.Q6J("ngIf",i.html)}}var Rp=function(e){return{"with-title":e}};function Np(e,t){if(1&e&&(w.TgZ(0,"div"),w.YNc(1,Mp,5,5,"mat-list-item",0),w.TgZ(2,"div",5,6),w.YNc(4,Pp,5,5,"div",0),w.YNc(5,$p,3,2,"div",0),w.qZA(),w.qZA()),2&e){var i=w.oxw().$implicit,o=w.oxw(3);w.xp6(1),w.Q6J("ngIf",i.title),w.xp6(1),w.Q6J("ngClass",w.VKq(4,Rp,i.title)),w.xp6(2),w.Q6J("ngIf",void 0!==o.currentStyle),w.xp6(1),w.Q6J("ngIf",!i.collapsed)}}function Up(e,t){if(1&e&&(w.ynx(0,null,4),w.YNc(2,Np,6,6,"div",1),w.BQk()),2&e){w.oxw(2);var i=w.MAs(3),o=w.oxw();w.xp6(2),w.Q6J("ngIf",o.getLegend)("ngIfElse",i)}}function Jp(e,t){if(1&e&&(w.ynx(0),w.YNc(1,Up,3,2,"ng-container",3),w.BQk()),2&e){var i=w.oxw().ngIf;w.xp6(1),w.Q6J("ngForOf",i.slice().reverse())}}function Bp(e,t){1&e&&(w.TgZ(0,"small"),w._uU(1),w.ALo(2,"translate"),w.qZA()),2&e&&(w.xp6(1),w.hij(" ",w.lcZ(2,1,"igo.geo.layer.legend.noLegendText")," "))}function jp(e,t){if(1&e&&(w.ynx(0),w.YNc(1,Jp,2,1,"ng-container",1),w.YNc(2,Bp,3,3,"ng-template",null,2,w.W1O),w.BQk()),2&e){var i=t.ngIf,o=w.MAs(3);w.xp6(1),w.Q6J("ngIf",i.length)("ngIfElse",o)}}var Qp=function(){var e=function(){function e(t,i,o,n){m(this,e),this.capabilitiesService=t,this.languageService=i,this.http=o,this.cdRef=n,this.updateLegendOnResolutionChange=!1,this.legendItems$=new R.X([]),this.scale=void 0,this.view=void 0,this.imagesHeight={},this.getLegend=!0}return y(e,[{key:"ngOnInit",value:function(){var e=this,t=this.layer.legend;this.styles=this.listStyles();var i=this.layer.options.source.options;if(i&&i.params&&i.params.STYLES?this.currentStyle=this.styles.find(function(e){return e.name===i.params.STYLES}).name:t?this.styles&&this.styles.length>1&&(this.currentStyle=t[0].currentStyle):this.styles&&this.styles.length>1&&(this.currentStyle=this.styles[0].name),t=void 0!==this.layer.options.legendOptions&&!1===this.layer.options.legendOptions.display?[]:this.layer.dataSource.getLegend(this.currentStyle,this.view),this.updateLegendOnResolutionChange||i.contentDependentLegend)this.state$$=this.layer.map.viewController.state$.subscribe(function(){return e.onViewControllerStateChange()});else if(t&&0!==t.length){this.legendItems$.next(t);var o,n=p(t);try{for(n.s();!(o=n.n()).done;){var r=o.value;this.getLegendGraphic(r)}}catch(a){n.e(a)}finally{n.f()}}}},{key:"ngOnDestroy",value:function(){void 0!==this.state$$&&this.state$$.unsubscribe()}},{key:"getLegendGraphic",value:function(e){var t=this;e.url&&new $t(this.http).transform(e.url).pipe((0,q.K)(function(e){if(e.error)return e.error.caught=!0,t.getLegend=!1,t.cdRef.detectChanges(),e})).subscribe(function(i){var o=t.legendItems$.value.findIndex(function(t){return t.title===e.title});t.legendItems$.value[o].imgGraphValue=i,t.cdRef.detectChanges()})}},{key:"toggleLegendItem",value:function(e,t){t.collapsed=e}},{key:"transfertToggleLegendItem",value:function(e){for(var t=e,i=this.layer.legend,o=0;o<i.length;o++)t[o].collapsed=i[o].collapsed;return t}},{key:"computeItemTitle",value:function(e){var t=this.layer.dataSource.options;if("wms"!==t.type)return(0,U.of)(e.title);var i=t.params.LAYERS.split(","),o=JSON.parse(JSON.stringify(t));return o.params.LAYERS=i.find(function(t){return t===e.title}),this.capabilitiesService.getWMSOptions(o).pipe((0,D.U)(function(e){return e._layerOptionsFromSource.title}))}},{key:"onViewControllerStateChange",value:function(){this.view={resolution:this.layer.map.viewController.getResolution(),extent:this.layer.map.viewController.getExtent(),projection:this.layer.map.viewController.getOlProjection().getCode(),scale:this.layer.map.viewController.getScale(),size:this.layer.map.ol.getSize()},this.updateLegend()}},{key:"updateLegend",value:function(){var e=this.layer.dataSource.getLegend(this.currentStyle,this.view);if(this.layer.legend&&this.layer.legend.length>1&&(e=this.transfertToggleLegendItem(e)),this.layer.legend=e,0!==e.length||0!==this.legendItems$.value.length){this.legendItems$.next(e);var t,i=p(this.legendItems$.value);try{for(i.s();!(t=i.n()).done;){var o=t.value;this.getLegendGraphic(o)}}catch(n){i.e(n)}finally{i.f()}}}},{key:"listStyles",value:function(){var e=this.layer.options;if(e&&e.legendOptions){var t=[{name:"",title:this.languageService.translate.instant("igo.geo.layer.legend.default")}];return e.legendOptions.stylesAvailable&&(t=t.concat(e.legendOptions.stylesAvailable.filter(function(e){return"default"!==e.name.normalize("NFD").replace(/[\u0300-\u036f]/gi,"")&&"defaut"!==e.name.normalize("NFD").replace(/[\u0300-\u036f]/gi,"")}))),t.filter(function(e){return!e.title}).map(function(e){return e.title=e.name}),t.map(function(e){return e.title=e.title.charAt(0).toUpperCase()+e.title.slice(1).replace(/_/g," ")}),t}}},{key:"onChangeStyle",value:function(){var e=this;this.updateLegend();var t="";this.layer.dataSource instanceof Mc&&(this.layer.dataSource.ol.getParams().LAYERS.split(",").map(function(i){return t+=e.currentStyle+","}),t=t.slice(0,-1),this.layer.dataSource.ol.updateParams({STYLES:t}))}},{key:"onLoadImage",value:function(e){var t;t=1===this.renderedLegends.length?this.renderedLegends.first.nativeElement:this.renderedLegends.find(function(t){return t.nativeElement.id===e}).nativeElement,this.imagesHeight[e]=t.height}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(cu),w.Y36(Ce),w.Y36(P.eN),w.Y36(w.sBO))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-layer-legend"]],viewQuery:function(e,t){var i;(1&e&&w.Gf(Op,5),2&e)&&(w.iGM(i=w.CRH())&&(t.renderedLegends=i))},inputs:{updateLegendOnResolutionChange:"updateLegendOnResolutionChange",layer:"layer"},decls:2,vars:3,consts:[[4,"ngIf"],[4,"ngIf","ngIfElse"],["noItems",""],[4,"ngFor","ngForOf"],["renderedLegends",""],[1,"igo-layer-legend",3,"ngClass"],["legend",""],["id","legend-toggle","mat-list-avatar","","igoCollapse","","svgIcon","chevron-up",1,"igo-chevron",3,"target","collapsed","toggle"],["matLine",""],["tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[3,"ngStyle","innerHTML",4,"ngIf"],[3,"id","src","alt","load"],["renderedLegend",""],[3,"ngStyle","innerHTML"]],template:function(e,t){1&e&&(w.YNc(0,jp,4,2,"ng-container",0),w.ALo(1,"async")),2&e&&w.Q6J("ngIf",w.lcZ(1,1,t.legendItems$))},directives:[F.O5,F.sg,F.mk,C.Tg,k.Hw,C.eA,co,Ve.X2,Ye.KE,ze.gD,L.gM,We.JJ,We.On,Ve.ey,F.PC],pipes:[F.Ov,ae.X$,Rt],styles:['.igo-layer-legend.with-title[_ngcontent-%COMP%]{padding-left:18px}img[_ngcontent-%COMP%]:after{content:" ";position:relative;height:17px;float:left;width:17px;top:-3px;right:19px;background-color:#fff;border:3px solid #f3f3f3;border-radius:50%;-webkit-animation:2s linear infinite spin;animation:2s linear infinite spin}@-moz-document url-prefix(){img:after{margin-left:19px}}@-webkit-keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}'],changeDetection:0}),e}();function Gp(e,t){1&e&&w._UZ(0,"mat-icon",9)}function Yp(e,t){1&e&&(w.TgZ(0,"mat-icon",12),w.NdJ("click",function(e){return e.stopPropagation()}),w.ALo(1,"translate"),w.qZA()),2&e&&w.Q6J("matTooltip",w.lcZ(1,1,"igo.geo.catalog.externalProvider.layer"))}function zp(e,t){if(1&e&&(w.TgZ(0,"button",10),w.YNc(1,Yp,2,3,"mat-icon",11),w.qZA()),2&e){var i=w.oxw();w.xp6(1),w.Q6J("ngIf",i.layer.externalProvider)}}function Vp(e,t){if(1&e&&(w._UZ(0,"igo-layer-legend",3),w.ALo(1,"async")),2&e){var i=w.oxw();w.Q6J("layer",w.lcZ(1,1,i.igoLayer$))}}var Hp=function(){var e=function(){function e(t){m(this,e),this.layerService=t,this.inRange$=new R.X(!0),this.isPreview$=new R.X(!1),this.layerLegendShown$=new R.X(!1),this.igoLayer$=new R.X(void 0),this.mouseInsideAdd=!1,this.catalogAllowLegend=!1,this.added=!1,this.addedChange=new w.vpe,this.addedLayerIsPreview=new w.vpe}return y(e,[{key:"title",get:function(){return St(this.layer)}},{key:"icon",get:function(){return kt(this.layer)||"layers"}},{key:"ngOnInit",value:function(){var e=this;this.isInResolutionsRange(),this.isPreview$$=this.isPreview$.subscribe(function(t){return e.addedLayerIsPreview.emit(t)})}},{key:"ngOnDestroy",value:function(){this.isPreview$$.unsubscribe()}},{key:"computeTitleTooltip",value:function(){var e=this.layer.options;if(!e.tooltip)return St(this.layer);var t=e.tooltip,i=e.metadata;switch(e.tooltip.type){case rc.TITLE:return this.layer.title;case rc.ABSTRACT:return i&&i.abstract?i.abstract:this.layer.title;case rc.CUSTOM:return t&&t.text?t.text:this.layer.title;default:return this.layer.title}}},{key:"onMouseEvent",value:function(e){this.onToggleClick(e)}},{key:"askForLegend",value:function(e){var t=this;this.layerLegendShown$.next(!this.layerLegendShown$.value),this.layerService.createAsyncLayer(this.layer.options).pipe((0,Wa.P)()).subscribe(function(e){return t.igoLayer$.next(e)})}},{key:"onToggleClick",value:function(e){var t=this;if(void 0!==this.lastTimeoutRequest&&clearTimeout(this.lastTimeoutRequest),"mouseenter"!==e.type||!this.mouseInsideAdd)switch(e.type){case"click":this.isPreview$.value||(this.added?this.remove():this.add()),this.isPreview$.next(!1);break;case"mouseenter":!this.isPreview$.value&&!this.added&&(this.lastTimeoutRequest=setTimeout(function(){t.add(),t.isPreview$.next(!0)},500)),this.mouseInsideAdd=!0;break;case"mouseleave":this.isPreview$.value&&(this.remove(),this.isPreview$.next(!1)),this.mouseInsideAdd=!1}}},{key:"add",value:function(){this.added||(this.added=!0,this.addedChange.emit({added:!0,layer:this.layer}))}},{key:"remove",value:function(){this.added&&(this.added=!1,this.addedChange.emit({added:!1,layer:this.layer}))}},{key:"haveGroup",value:function(){return!(!this.layer.address||1===this.layer.address.split(".").length)}},{key:"isInResolutionsRange",value:function(){return this.inRange$.next(this.resolution>=(this.layer.options.minResolution||0)&&this.resolution<=(this.layer.options.maxResolution||1/0)),this.inRange$.value}},{key:"computeTooltip",value:function(){return this.added?this.isPreview$.value?"igo.geo.catalog.layer.addToMap":this.inRange$.value?"igo.geo.catalog.layer.removeFromMap":"igo.geo.catalog.layer.removeFromMapOutRange":this.inRange$.value?"igo.geo.catalog.layer.addToMap":"igo.geo.catalog.layer.addToMapOutRange"}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Xu))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-catalog-browser-layer"]],inputs:{resolution:"resolution",catalogAllowLegend:"catalogAllowLegend",layer:"layer",added:"added"},outputs:{addedChange:"addedChange",addedLayerIsPreview:"addedLayerIsPreview"},decls:16,vars:21,consts:[["mat-list-avatar","","svgIcon","blank",4,"ngIf"],["mat-line","","matTooltipShowDelay","500",3,"ngClass","matTooltip","click"],["disabled","true","mat-icon-button","",4,"ngIf"],[3,"layer"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","mouseenter","mouseleave","click"],["matBadge","icon","igoMatBadgeIcon","eye-off","igoMatBadgeInverseColor","true","matBadgeDisabled","true","matBadgeSize","small","matBadgePosition","after",3,"matBadgeHidden","svgIcon"],[1,"igo-cataloglayer-legend-container"],["legend",""],[3,"layer",4,"ngIf"],["mat-list-avatar","","svgIcon","blank"],["disabled","true","mat-icon-button",""],["class","igo-cataloglayer-external-icon","tooltip-position","below","matTooltipShowDelay","500","color","primary","svgIcon","earth-arrow-right",3,"matTooltip","click",4,"ngIf"],["tooltip-position","below","matTooltipShowDelay","500","color","primary","svgIcon","earth-arrow-right",1,"igo-cataloglayer-external-icon",3,"matTooltip","click"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-list-item"),w.YNc(1,Gp,1,0,"mat-icon",0),w.TgZ(2,"h4",1),w.NdJ("click",function(e){return t.askForLegend(e)}),w._uU(3),w.qZA(),w.YNc(4,zp,2,1,"button",2),w._UZ(5,"igo-metadata-button",3),w.TgZ(6,"button",4),w.NdJ("mouseenter",function(e){return t.onMouseEvent(e)})("mouseleave",function(e){return t.onMouseEvent(e)})("click",function(e){return t.onToggleClick(e)}),w.ALo(7,"translate"),w.ALo(8,"async"),w._UZ(9,"mat-icon",5),w.ALo(10,"async"),w.qZA(),w.qZA(),w.TgZ(11,"div",6,7),w.YNc(13,Vp,2,3,"igo-layer-legend",8),w.ALo(14,"async"),w.ALo(15,"async"),w.qZA()),2&e&&(w.xp6(1),w.Q6J("ngIf",t.haveGroup()),w.xp6(1),w.Q6J("ngClass",t.catalogAllowLegend?"igo-cataloglayer-title":"")("matTooltip",t.computeTitleTooltip()),w.xp6(1),w.Oqu(t.title),w.xp6(1),w.Q6J("ngIf",t.layer.externalProvider),w.xp6(1),w.Q6J("layer",t.layer),w.xp6(1),w.Q6J("matTooltip",w.lcZ(7,11,t.computeTooltip()))("color",w.lcZ(8,13,t.isPreview$)?"":t.added?"warn":""),w.xp6(3),w.Q6J("matBadgeHidden",t.isInResolutionsRange())("svgIcon",w.lcZ(10,15,t.isPreview$)?"plus":t.added?"delete":"plus"),w.xp6(4),w.Q6J("ngIf",w.lcZ(14,17,t.layerLegendShown$)&&w.lcZ(15,19,t.igoLayer$)&&t.catalogAllowLegend))},directives:[C.Tg,F.O5,Ve.X2,F.mk,L.gM,Wl,S.lW,k.Hw,ct.k,ro,C.eA,Qp],pipes:[ae.X$,F.Ov],styles:[".igo-cataloglayer-title[_ngcontent-%COMP%]{cursor:pointer}.igo-cataloglayer-legend-container[_ngcontent-%COMP%]{padding-left:18px;width:calc(100% - 18px);margin-left:40px}.igo-cataloglayer-external-icon[_ngcontent-%COMP%]{cursor:help}"],changeDetection:0}),e}();function Wp(e,t){1&e&&(w.TgZ(0,"mat-icon",9),w.NdJ("click",function(e){return e.stopPropagation()}),w.ALo(1,"translate"),w.qZA()),2&e&&w.Q6J("matTooltip",w.lcZ(1,1,"igo.geo.catalog.externalProvider.group"))}function Xp(e,t){if(1&e&&(w.TgZ(0,"button",7),w.YNc(1,Wp,2,3,"mat-icon",8),w.qZA()),2&e){var i=w.oxw();w.xp6(1),w.Q6J("ngIf",i.group.externalProvider)}}function Kp(e,t){if(1&e){var i=w.EpF();w.ynx(0),w.TgZ(1,"button",10),w.NdJ("click",function(){return w.CHM(i),w.oxw().onToggleClick()}),w.ALo(2,"translate"),w.ALo(3,"async"),w._UZ(4,"mat-icon",11),w.qZA(),w.BQk()}if(2&e){var o=w.oxw();w.xp6(1),w.Q6J("matTooltip",w.lcZ(2,2,"igo.geo.catalog.group.removeFromMap"))("disabled",w.lcZ(3,4,o.disabled$))}}function ed(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",12),w.NdJ("click",function(){return w.CHM(i),w.oxw().onToggleClick()}),w.ALo(1,"translate"),w.ALo(2,"async"),w._UZ(3,"mat-icon",13),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("matTooltip",w.lcZ(1,2,"igo.geo.catalog.group.addToMap"))("disabled",w.lcZ(2,4,o.disabled$))}}function td(e,t){1&e&&w.GkF(0)}function id(e,t){if(1&e){var i=w.EpF();w.ynx(0),w.TgZ(1,"igo-catalog-browser-layer",15),w.NdJ("addedLayerIsPreview",function(e){return w.CHM(i),w.oxw(2).onLayerPreview(e)})("addedChange",function(e){return w.CHM(i),w.oxw(2).onLayerAddedChange(e)}),w.qZA(),w.BQk()}if(2&e){var o=w.oxw().$implicit,n=w.oxw();w.xp6(1),w.Q6J("layer",o)("resolution",n.resolution)("catalogAllowLegend",n.catalogAllowLegend)("added",n.state.get(o).added)}}function od(e,t){if(1&e&&(w.YNc(0,td,1,0,"ng-container",14),w.YNc(1,id,2,4,"ng-container",14)),2&e){var i=t.$implicit,o=w.oxw();w.Q6J("ngIf",o.isGroup(i)),w.xp6(1),w.Q6J("ngIf",o.isLayer(i))}}var nd=function(){var e=function(){function e(){m(this,e),this.store=new At([]),this.added$=new R.X(!1),this.preview$=new R.X(!1),this.disabled$=new R.X(!1),this.collapsed=!0,this.catalogAllowLegend=!1,this.toggleCollapsed=!0,this.addedChange=new w.vpe,this.layerAddedChange=new w.vpe}return y(e,[{key:"title",get:function(){return this.group.title}},{key:"ngOnInit",value:function(){this.store.load(this.group.items),this.evaluateAdded(),this.evaluateDisabled(this.collapsed),void 0!==this.group.sortDirection&&this.store.view.sort({direction:this.group.sortDirection,valueAccessor:function(e){return e.title}})}},{key:"ngOnDestroy",value:function(){this.store.destroy()}},{key:"isGroup",value:function(e){return e.type===sp.Group}},{key:"isLayer",value:function(e){return e.type===sp.Layer}},{key:"onToggleClick",value:function(){this.added$.value?this.remove():this.add()}},{key:"onToggleCollapsed",value:function(e){this.evaluateDisabled(e)}},{key:"onLayerAddedChange",value:function(e){this.layerAddedChange.emit(e),this.tryToggleGroup(e)}},{key:"add",value:function(){this.added$.next(!0),this.addedChange.emit({added:!0,group:this.group})}},{key:"remove",value:function(){this.added$.next(!1),this.addedChange.emit({added:!1,group:this.group})}},{key:"onLayerPreview",value:function(e){this.preview$.next(e)}},{key:"tryToggleGroup",value:function(e){var t=this,i=e.added,o=e.layer;this.store.view.all().filter(function(e){return e.id!==o.id}).map(function(e){return t.state.get(e).added||!1}).every(function(e){return e===i})?i?this.add():this.remove():!0===this.added$.value&&this.added$.next(!1)}},{key:"evaluateAdded",value:function(){var e=this,t=this.store.all().every(function(t){return!0===(e.state.get(t).added||!1)});this.added$.next(t)}},{key:"evaluateDisabled",value:function(e){var t=!1;!1===this.toggleCollapsed&&(t=e),this.disabled$.next(t)}},{key:"onTitleClick",value:function(){this.collapsed=!this.collapsed}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-catalog-browser-group"]],inputs:{catalog:"catalog",group:"group",collapsed:"collapsed",resolution:"resolution",catalogAllowLegend:"catalogAllowLegend",toggleCollapsed:"toggleCollapsed",state:"state"},outputs:{addedChange:"addedChange",layerAddedChange:"layerAddedChange"},decls:14,vars:14,consts:[["mat-list-avatar","","svgIcon","chevron-up","igoCollapse","",1,"igo-chevron",3,"target","collapsed","toggle"],["id","catalog-group-title","mat-line","","matTooltipShowDelay","500",1,"igo-catalog-group-title",3,"matTooltip","click"],["disabled","true","mat-icon-button","",4,"ngIf"],[4,"ngIf","ngIfElse"],["notadded",""],["items",""],["ngFor","",3,"ngForOf"],["disabled","true","mat-icon-button",""],["class","igo-cataloggroup-external-icon","tooltip-position","below","matTooltipShowDelay","500","color","primary","svgIcon","earth-arrow-right",3,"matTooltip","click",4,"ngIf"],["tooltip-position","below","matTooltipShowDelay","500","color","primary","svgIcon","earth-arrow-right",1,"igo-cataloggroup-external-icon",3,"matTooltip","click"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip","disabled","click"],["svgIcon","delete"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","disabled","click"],["svgIcon","plus"],[4,"ngIf"],["igoListItem","",3,"layer","resolution","catalogAllowLegend","added","addedLayerIsPreview","addedChange"]],template:function(e,t){if(1&e&&(w.TgZ(0,"mat-list-item"),w.TgZ(1,"mat-icon",0),w.NdJ("toggle",function(e){return t.onToggleCollapsed(e)}),w.qZA(),w.TgZ(2,"h4",1),w.NdJ("click",function(){return t.onTitleClick()}),w._uU(3),w.qZA(),w.YNc(4,Xp,2,1,"button",2),w.YNc(5,Kp,5,6,"ng-container",3),w.ALo(6,"async"),w.ALo(7,"async"),w.YNc(8,ed,4,6,"ng-template",null,4,w.W1O),w.qZA(),w.TgZ(10,"div",null,5),w.YNc(12,od,2,2,"ng-template",6),w.ALo(13,"async"),w.qZA()),2&e){var i=w.MAs(9),o=w.MAs(11);w.xp6(1),w.Q6J("target",o)("collapsed",t.collapsed),w.xp6(1),w.Q6J("matTooltip",t.title),w.xp6(1),w.Oqu(t.title),w.xp6(1),w.Q6J("ngIf",t.group.externalProvider),w.xp6(1),w.Q6J("ngIf",w.lcZ(6,8,t.added$)&&!1===w.lcZ(7,10,t.preview$))("ngIfElse",i),w.xp6(7),w.Q6J("ngForOf",w.lcZ(13,12,t.store.view.all$()))}},directives:[C.Tg,k.Hw,C.eA,co,Ve.X2,L.gM,F.O5,F.sg,S.lW,Hp,cn],pipes:[F.Ov,ae.X$],styles:[".igo-catalog-group-title[_ngcontent-%COMP%]{cursor:pointer;opacity:.9}#catalog-group-title[_ngcontent-%COMP%]{font-weight:bold}.igo-cataloggroup-external-icon[_ngcontent-%COMP%]{cursor:help}"],changeDetection:0}),e}(),rd=function(){var e=function e(){m(this,e),this.sortAlpha=!1,this.onlyVisible=!1,this.onlyInRange=!1,this.keywordInitialized=!1,this.sortedAlphaInitialized=!1,this.onlyVisibleInitialized=!1,this.onlyInRangeInitialized=!1};return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function ad(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-checkbox",9),w.NdJ("change",function(){return w.CHM(i),w.oxw().check()}),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("checked",o.layerCheck)}}var sd=function(e){return{disabled:e}};function ld(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",10),w.NdJ("click",function(){return w.CHM(i),w.oxw().toggleVisibility()}),w.ALo(1,"translate"),w.ALo(2,"translate"),w._UZ(3,"mat-icon",11),w.ALo(4,"async"),w.ALo(5,"async"),w.ALo(6,"async"),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("color",o.layer.visible?"primary":"default")("matTooltip",o.layer.visible?w.lcZ(1,5,"igo.geo.layer.hideLayer"):w.lcZ(2,7,"igo.geo.layer.showLayer")),w.xp6(3),w.Q6J("matBadgeHidden",w.lcZ(4,9,o.queryBadgeHidden$))("ngClass",w.VKq(15,sd,!1===w.lcZ(5,11,o.inResolutionRange$)))("svgIcon",w.lcZ(6,13,o.layer.visible$)?"eye":"eye-off")}}function cd(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",12),w.NdJ("click",function(){return w.CHM(i),w.oxw().toggleVisibility()}),w.ALo(1,"translate"),w.ALo(2,"translate"),w._UZ(3,"mat-icon",11),w.ALo(4,"async"),w.ALo(5,"async"),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("color",o.layer.visible?"primary":"default")("matTooltip",o.layer.visible?w.lcZ(1,5,"igo.geo.layer.hideLayer"):w.lcZ(2,7,"igo.geo.layer.showLayer")),w.xp6(3),w.Q6J("matBadgeHidden",w.lcZ(4,9,o.queryBadgeHidden$))("ngClass",w.VKq(13,sd,!1===w.lcZ(5,11,o.inResolutionRange$)))("svgIcon",o.layer.visible?"eye":"eye-off")}}function ud(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",13),w.NdJ("click",function(){return w.CHM(i),w.oxw().toggleLayerTool()}),w.ALo(1,"translate"),w._UZ(2,"mat-icon",14),w.qZA()}2&e&&w.Q6J("matTooltip",w.lcZ(1,1,"igo.geo.layer.moreOptions"))}function pd(e,t){if(1&e&&w._UZ(0,"igo-layer-legend",15),2&e){var i=w.oxw();w.Q6J("layer",i.layer)("updateLegendOnResolutionChange",i.updateLegendOnResolutionChange)}}var dd=function(){var e=function(){function e(t,i,o,n){m(this,e),this.networkService=t,this.renderer=i,this.elRef=o,this.cdRef=n,this.focusedCls="igo-layer-item-focused",this.layerTool$=new R.X(!1),this.showLegend$=new R.X(!0),this.inResolutionRange$=new R.X(!0),this.queryBadgeHidden$=new R.X(!0),this._selectAll=!1,this.layers$=new R.X(void 0),this.toggleLegendOnVisibilityChange=!1,this.expandLegendIfVisible=!1,this.updateLegendOnResolutionChange=!1,this.orderable=!0,this.lowerDisabled=!1,this.raiseDisabled=!1,this.queryBadge=!1,this.action=new w.vpe(void 0),this.checkbox=new w.vpe}return y(e,[{key:"activeLayer",get:function(){return this._activeLayer},set:function(e){e&&this.layer&&e.id===this.layer.id&&!this.selectionMode?(this.layerTool$.next(!0),this.renderer.addClass(this.elRef.nativeElement,this.focusedCls)):this.renderer.removeClass(this.elRef.nativeElement,this.focusedCls)}},{key:"selectAll",get:function(){return this._selectAll},set:function(e){this._selectAll=e,!0===e&&(this.layerCheck=!0)}},{key:"layer",get:function(){return this._layer},set:function(e){this._layer=e,this.layers$.next(e)}},{key:"opacity",get:function(){return 100*this.layer.opacity},set:function(e){this.layer.opacity=e/100}},{key:"ngOnInit",value:function(){var e=this;this.layer.visible&&this.expandLegendIfVisible&&!0===this.layer.firstLoadComponent&&(this.layer.firstLoadComponent=!1,this.layer.legendCollapsed=!1),this.toggleLegend(this.layer.legendCollapsed),this.updateQueryBadge(),this.resolution$$=this.layer.map.viewController.resolution$.subscribe(function(){e.onResolutionChange()}),this.tooltipText=this.computeTooltip(),this.network$$=this.networkService.currentState().subscribe(function(t){e.state=t,e.onResolutionChange()}),this.layers$$=this.layers$.subscribe(function(){e.layer&&e.layer.options.active&&(e.layerTool$.next(!0),e.renderer.addClass(e.elRef.nativeElement,e.focusedCls))}),this.changeDetection&&this.changeDetection.subscribe(function(){return e.cdRef.detectChanges()})}},{key:"ngOnDestroy",value:function(){this.resolution$$.unsubscribe(),this.network$$.unsubscribe(),this.layers$$.unsubscribe()}},{key:"toggleLegend",value:function(e){this.layer.legendCollapsed=e,this.showLegend$.next(!e)}},{key:"toggleLegendOnClick",value:function(){this.toggleLegend(this.showLegend$.value)}},{key:"toggleVisibility",value:function(){this.layer.visible=!this.layer.visible,this.toggleLegendOnVisibilityChange&&this.toggleLegend(!this.layer.visible),this.updateQueryBadge()}},{key:"computeTooltip",value:function(){var e=this.layer.options;if(!e.tooltip)return this.layer.title;var t=e.tooltip,i=e.metadata;switch(e.tooltip.type){case rc.TITLE:return this.layer.title;case rc.ABSTRACT:return i&&i.abstract?i.abstract:this.layer.title;case rc.CUSTOM:return t&&t.text?t.text:this.layer.title;default:return this.layer.title}}},{key:"onResolutionChange",value:function(){var e=this.layer.isInResolutionsRange;!1===e&&!0===this.updateLegendOnResolutionChange&&this.toggleLegend(!0),this.inResolutionRange$.next(e)}},{key:"updateQueryBadge",value:function(){var e=!1===this.queryBadge||!1===this.layer.visible||!yp(this.layer);this.queryBadgeHidden$.next(e)}},{key:"toggleLayerTool",value:function(){this.layerTool$.next(!this.layerTool$.getValue()),!0===this.layerTool$.getValue()?this.renderer.addClass(this.elRef.nativeElement,this.focusedCls):this.renderer.removeClass(this.elRef.nativeElement,this.focusedCls),this.action.emit(this.layer)}},{key:"check",value:function(){this.layerCheck=!this.layerCheck,this.checkbox.emit({layer:this.layer,check:this.layerCheck})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ee),w.Y36(w.Qsj),w.Y36(w.SBq),w.Y36(w.sBO))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-layer-item"]],inputs:{activeLayer:"activeLayer",selectAll:"selectAll",layerCheck:"layerCheck",layer:"layer",toggleLegendOnVisibilityChange:"toggleLegendOnVisibilityChange",expandLegendIfVisible:"expandLegendIfVisible",updateLegendOnResolutionChange:"updateLegendOnResolutionChange",orderable:"orderable",lowerDisabled:"lowerDisabled",raiseDisabled:"raiseDisabled",queryBadge:"queryBadge",selectionMode:"selectionMode",changeDetection:"changeDetection"},outputs:{action:"action",checkbox:"checkbox"},decls:11,vars:9,consts:[[1,"igo-layer-list-item"],["class","layerCheck","mat-list-icon","",3,"checked","change",4,"ngIf"],["matLine","","matTooltipShowDelay","500",1,"igo-layer-title",3,"matTooltip","click"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"color","matTooltip","click",4,"ngIf"],["class","selection-eye","mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"color","matTooltip","click",4,"ngIf"],["class","actions-button","tooltip-position","below","matTooltipShowDelay","500","mat-icon-button","","color","primary",3,"matTooltip","click",4,"ngIf"],[1,"igo-layer-legend-container"],["legend",""],[3,"layer","updateLegendOnResolutionChange",4,"ngIf"],["mat-list-icon","",1,"layerCheck",3,"checked","change"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"color","matTooltip","click"],["matBadge","?","matBadgeColor","accent","matBadgeSize","small","matBadgePosition","after",3,"matBadgeHidden","ngClass","svgIcon"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",1,"selection-eye",3,"color","matTooltip","click"],["tooltip-position","below","matTooltipShowDelay","500","mat-icon-button","","color","primary",1,"actions-button",3,"matTooltip","click"],["svgIcon","dots-horizontal"],[3,"layer","updateLegendOnResolutionChange"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-list-item",0),w.YNc(1,ad,1,1,"mat-checkbox",1),w.TgZ(2,"h4",2),w.NdJ("click",function(){return t.toggleLegendOnClick()}),w._uU(3),w.qZA(),w.YNc(4,ld,7,17,"button",3),w.YNc(5,cd,6,15,"button",4),w.YNc(6,ud,3,3,"button",5),w.qZA(),w.TgZ(7,"div",6,7),w.YNc(9,pd,1,2,"igo-layer-legend",8),w.ALo(10,"async"),w.qZA()),2&e&&(w.xp6(1),w.Q6J("ngIf",t.selectionMode),w.xp6(1),w.Q6J("matTooltip",t.tooltipText),w.xp6(1),w.Oqu(t.layer.title),w.xp6(1),w.Q6J("ngIf",!t.selectionMode),w.xp6(1),w.Q6J("ngIf",t.selectionMode),w.xp6(1),w.Q6J("ngIf",!t.selectionMode),w.xp6(3),w.Q6J("ngIf",w.lcZ(10,7,t.showLegend$)))},styles:["[_nghost-%COMP%]{overflow:hidden}mat-list-item[_ngcontent-%COMP%]     .mat-list-item-content .layerCheck{align-self:baseline;width:16px;padding-right:0}.igo-layer-list-item[_ngcontent-%COMP%]{height:46px;clear:both}.igo-layer-title[_ngcontent-%COMP%]{cursor:pointer}.igo-layer-legend-container[_ngcontent-%COMP%]{padding-left:18px;width:calc(100% - 18px)}mat-icon.disabled[_ngcontent-%COMP%]{color:#00000061}mat-icon[matBadge][_ngcontent-%COMP%]     .mat-badge-content{font-size:12px}.selection-eye[_ngcontent-%COMP%]{padding-right:45px}"],changeDetection:0}),e}(),hd=function(){return(e=hd||(hd={})).always="always",e.never="never",e.default="default",hd;var e}(),gd=function(){return(e=gd||(gd={})).ALL_VISIBLE="ALL_VISIBLE",e.ALL_HIDDEN="ALL_HIDDEN",e.MIXED="MIXED",e.NULL="NULL",gd;var e}(),fd=function(){return(e=fd||(fd={})).Raise="raise",e.Lower="lower",fd;var e}(),md=["igoLayerItemToolbar"];function vd(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"igo-layer-list-tool",6),w.NdJ("appliedFilterAndSort",function(e){return w.CHM(i),w.oxw().onAppliedFilterAndSortChange(e)})("selection",function(e){return w.CHM(i),w.oxw().toggleSelectionMode(e)}),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("layersAreAllVisible",o.layersAreAllVisible)("term",o.layerFilterAndSortOptions.keyword)("onlyVisible",o.layerFilterAndSortOptions.onlyVisible)("sortAlpha",o.layerFilterAndSortOptions.sortAlpha)}}function yd(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-list-item",7),w.TgZ(1,"mat-checkbox",8),w.NdJ("change",function(){return w.CHM(i),w.oxw().selectAll()}),w._uU(2),w.ALo(3,"translate"),w.ALo(4,"translate"),w.qZA(),w.qZA()}if(2&e){var o=w.oxw();w.xp6(1),w.Q6J("color",!o.selectAllCheck&&o.layersChecked.length>0?"accent":"primary")("checked",o.selectAllCheck)("indeterminate",!o.selectAllCheck&&o.layersChecked.length>0),w.xp6(1),w.hij(" ",o.selectAllCheck?w.lcZ(3,4,"igo.geo.layer.deselectAll"):w.lcZ(4,6,"igo.geo.layer.selectAll")," ")}}function bd(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"igo-layer-item",10),w.NdJ("action",function(e){return w.CHM(i),w.oxw(2).toggleLayerTool(e)})("checkbox",function(e){return w.CHM(i),w.oxw(2).layersCheck(e)}),w.qZA()}if(2&e){var o=w.oxw().$implicit,n=w.oxw();w.Q6J("layer",o)("activeLayer",n.activeLayer)("orderable",n.orderable&&!o.baseLayer)("lowerDisabled",n.getLowerLayer().id===o.id)("raiseDisabled",n.getUpperLayer().id===o.id)("queryBadge",n.queryBadge)("expandLegendIfVisible",n.expandLegendOfVisibleLayers)("updateLegendOnResolutionChange",n.updateLegendOnResolutionChange)("toggleLegendOnVisibilityChange",n.toggleLegendOnVisibilityChange)("selectionMode",n.selection)("selectAll",n.selectAllCheck)("layerCheck",o.options.check)("changeDetection",n.layerItemChangeDetection$)}}function wd(e,t){if(1&e&&w.YNc(0,bd,1,13,"igo-layer-item",9),2&e){var i=t.$implicit,o=w.oxw();w.Q6J("ngIf",!(o.excludeBaseLayers&&i.baseLayer))}}function xd(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",26),w.NdJ("click",function(){return w.CHM(i),w.oxw(2).removeLayers()}),w.ALo(1,"translate"),w._UZ(2,"mat-icon",27),w.qZA()}2&e&&w.Q6J("matTooltip",w.lcZ(1,1,"igo.geo.layer.removeLayer"))}function Sd(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",28),w.NdJ("click",function(){w.CHM(i);var e=w.oxw(2);return e.zoomLayerExtents(e.activeLayer)}),w.ALo(1,"translate"),w._UZ(2,"mat-icon",29),w.qZA()}2&e&&w.Q6J("matTooltip",w.lcZ(1,1,"igo.geo.layer.zoomLayer"))}var kd=function(e){return{layer:e}};function Cd(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"igo-panel",11),w.TgZ(1,"div",12),w.YNc(2,xd,3,3,"button",13),w.TgZ(3,"button",14),w.NdJ("click",function(){w.CHM(i);var e=w.oxw();return e.moveActiveLayer(e.activeLayer,e.layerListDisplacement.Lower)}),w.ALo(4,"translate"),w.ALo(5,"translate"),w._UZ(6,"mat-icon",15),w.qZA(),w.TgZ(7,"button",16),w.NdJ("click",function(){w.CHM(i);var e=w.oxw();return e.moveActiveLayer(e.activeLayer,e.layerListDisplacement.Raise)}),w.ALo(8,"translate"),w.ALo(9,"translate"),w._UZ(10,"mat-icon",17),w.qZA(),w.TgZ(11,"button",18),w.ALo(12,"translate"),w._UZ(13,"mat-icon",19),w.qZA(),w.TgZ(14,"mat-menu",20,21),w.TgZ(16,"div",22),w.TgZ(17,"mat-slider",23),w.NdJ("input",function(e){return w.CHM(i),w.oxw().changeOpacity(e)})("click",function(e){return e.stopPropagation()}),w.ALo(18,"translate"),w.qZA(),w.qZA(),w.qZA(),w.YNc(19,Sd,3,3,"button",24),w.GkF(20,25),w.Hsn(21),w.qZA(),w.qZA()}if(2&e){var o=w.MAs(15),n=w.oxw();w.Q6J("title",n.activeLayer.title),w.xp6(2),w.Q6J("ngIf",n.isLayerRemovable(n.activeLayer)),w.xp6(1),w.Q6J("matTooltip",n.sortAlpha||n.onlyVisible||n.keyword?w.lcZ(4,20,"igo.geo.layer.filterLowerLayer"):w.lcZ(5,22,"igo.geo.layer.lowerLayer"))("disabled",n.lowerDisabled),w.xp6(3),w.Q6J("matBadge",n.sortAlpha||n.onlyVisible||n.keyword?"!":"")("matBadgeHidden",n.lowerDisabled),w.xp6(1),w.Q6J("matTooltip",n.sortAlpha||n.onlyVisible||n.keyword?w.lcZ(8,24,"igo.geo.layer.filterRaiseLayer"):w.lcZ(9,26,"igo.geo.layer.raiseLayer"))("disabled",n.raiseDisabled),w.xp6(3),w.Q6J("matBadge",n.sortAlpha||n.onlyVisible||n.keyword?"!":"")("matBadgeHidden",n.raiseDisabled),w.xp6(1),w.Q6J("matMenuTriggerFor",o)("matTooltip",w.lcZ(12,28,"igo.geo.layer.opacity")),w.xp6(2),w.Q6J("matBadge",n.badgeOpacity),w.xp6(4),w.Q6J("min",0)("max",100)("value",n.opacity)("matTooltip",w.lcZ(18,30,"igo.geo.layer.opacity")),w.xp6(2),w.Q6J("ngIf",n.activeLayerIsValid(n.activeLayer)),w.xp6(1),w.Q6J("ngTemplateOutlet",n.templateLayerToolbar)("ngTemplateOutletContext",w.VKq(32,kd,n.activeLayer))}}function Td(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-slider",38),w.NdJ("ngModelChange",function(e){return w.CHM(i),w.oxw(2).checkOpacity=e})("click",function(e){return e.stopPropagation()}),w.ALo(1,"translate"),w.qZA()}if(2&e){var o=w.oxw(2);w.Q6J("min",0)("max",100)("ngModel",o.checkOpacity)("matTooltip",w.lcZ(1,4,"igo.geo.layer.opacity"))}}function Ad(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",28),w.NdJ("click",function(){w.CHM(i);var e=w.oxw(2);return e.zoomLayersExtents(e.layersChecked)}),w.ALo(1,"translate"),w._UZ(2,"mat-icon",39),w.qZA()}2&e&&w.Q6J("matTooltip",w.lcZ(1,1,"igo.geo.layer.zoomLayers"))}function Ld(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"igo-panel",11),w.ALo(1,"translate"),w.TgZ(2,"div",30),w.TgZ(3,"button",31),w.NdJ("click",function(){w.CHM(i);var e=w.oxw();return e.removeLayers(e.layersChecked)}),w.ALo(4,"translate"),w.ALo(5,"translate"),w._UZ(6,"mat-icon",32),w.qZA(),w.TgZ(7,"button",33),w.NdJ("click",function(){w.CHM(i);var e=w.oxw();return e.toggleVisibility(e.layersChecked)}),w.ALo(8,"translate"),w.ALo(9,"translate"),w._UZ(10,"mat-icon",34),w.qZA(),w.TgZ(11,"button",14),w.NdJ("click",function(){w.CHM(i);var e=w.oxw();return e.lowerLayers(e.layersChecked)}),w.ALo(12,"translate"),w.ALo(13,"translate"),w._UZ(14,"mat-icon",15),w.qZA(),w.TgZ(15,"button",16),w.NdJ("click",function(){w.CHM(i);var e=w.oxw();return e.raiseLayers(e.layersChecked)}),w.ALo(16,"translate"),w.ALo(17,"translate"),w._UZ(18,"mat-icon",17),w.qZA(),w.TgZ(19,"button",35),w.ALo(20,"translate"),w._UZ(21,"mat-icon",36),w.qZA(),w.TgZ(22,"mat-menu",20,21),w.TgZ(24,"div",22),w.YNc(25,Td,2,6,"mat-slider",37),w.qZA(),w.qZA(),w.YNc(26,Ad,3,3,"button",24),w.qZA(),w.qZA()}if(2&e){var o=w.MAs(23),n=w.oxw();w.Q6J("title",w.lcZ(1,21,"igo.geo.layer.tools")),w.xp6(3),w.Q6J("disabled",0===n.layersChecked.length)("matTooltip",n.isAllLayersRemovable(n.layersChecked)?w.lcZ(4,23,"igo.geo.layer.removeSelectedLayers"):w.lcZ(5,25,"igo.geo.layer.removeSelectedLayersRestriction")),w.xp6(3),w.Q6J("matBadge","!")("matBadgeHidden",n.isAllLayersRemovable(n.layersChecked)),w.xp6(1),w.Q6J("disabled",0===n.layersChecked.length)("matTooltip","ALL_HIDDEN"===n.statusSelectedLayersCheck?w.lcZ(8,27,"igo.geo.layer.showSelectedLayers"):w.lcZ(9,29,"igo.geo.layer.hideSelectedLayers")),w.xp6(3),w.Q6J("svgIcon","ALL_HIDDEN"===n.statusSelectedLayersCheck?"eye-off":"eye"),w.xp6(1),w.Q6J("matTooltip",n.sortAlpha||n.onlyVisible||n.keyword?w.lcZ(12,31,"igo.geo.layer.filterLowerLayer"):w.lcZ(13,33,"igo.geo.layer.lowerLayer"))("disabled",n.lowerDisabledSelection),w.xp6(3),w.Q6J("matBadge",n.sortAlpha||n.onlyVisible||n.keyword?"!":"")("matBadgeHidden",n.lowerDisabledSelection),w.xp6(1),w.Q6J("matTooltip",n.sortAlpha||n.onlyVisible||n.keyword?w.lcZ(16,35,"igo.geo.layer.filterRaiseLayer"):w.lcZ(17,37,"igo.geo.layer.raiseLayer"))("disabled",n.raiseDisabledSelection),w.xp6(3),w.Q6J("matBadge",n.sortAlpha||n.onlyVisible||n.keyword?"!":"")("matBadgeHidden",n.raiseDisabledSelection),w.xp6(1),w.Q6J("disabled",0===n.layersChecked.length)("matMenuTriggerFor",o)("matTooltip",w.lcZ(20,39,"igo.geo.layer.opacity")),w.xp6(6),w.Q6J("ngIf",n.layersChecked.length),w.xp6(1),w.Q6J("ngIf",0!==n.layersChecked.length&&n.activeLayersAreValid(n.layersChecked))}}var Zd=[[["","igoLayerItemToolbar",""]]],Fd=function(e,t,i){return{"igo-list-tools-multi":e,"igo-list-tools-single":t,"igo-list-no-tools":i}},Od=["[igoLayerItemToolbar]"],Md=function(){var e=function(){function e(t){m(this,e),this.elRef=t,this.orderable=!0,this.thresholdToFilterAndSort=5,this.layers$=new R.X([]),this.change$=new Re.t(1),this.showToolbar$=new R.X(!1),this.hideSelectedLayers=!0,this.activeLayer$=new R.X(void 0),this.layersChecked=[],this.layerItemChangeDetection$=new R.X(void 0),this.layersAreAllVisible=!0,this.ogcButton=!0,this.timeButton=!0,this.floatLabel="auto",this.layerFilterAndSortOptions={},this.excludeBaseLayers=!1,this.toggleLegendOnVisibilityChange=!1,this.expandLegendOfVisibleLayers=!1,this.updateLegendOnResolutionChange=!1,this.queryBadge=!1,this.appliedFilterAndSort=new w.vpe,this._keyword=void 0,this._onlyVisible=!1,this._sortedAlpha=!1,this.toggleOpacity=!1,this.selectAllCheck$=new R.X(void 0)}return y(e,[{key:"map",get:function(){return this._map},set:function(e){this._map=e}},{key:"layers",get:function(){return this._layers},set:function(e){this._layers=this.removeProblemLayerInList(e),this.next()}},{key:"activeLayer",get:function(){return this._activeLayer},set:function(e){this._activeLayer=e,this.activeLayer$.next(e)}},{key:"keyword",get:function(){return this._keyword},set:function(e){this._keyword=e,this.next()}},{key:"onlyVisible",get:function(){return this._onlyVisible},set:function(e){this._onlyVisible=e,this.next()}},{key:"sortAlpha",get:function(){return this._sortedAlpha},set:function(e){this._sortedAlpha=e,this.next()}},{key:"opacity",get:function(){return Math.round(100*this.activeLayer$.getValue().opacity)},set:function(e){this.activeLayer$.getValue().opacity=e/100}},{key:"badgeOpacity",get:function(){if(100!==this.opacity)return this.opacity}},{key:"raiseDisabled",get:function(){return!(this.orderable&&!this.activeLayer.baseLayer&&this.getUpperLayer().id!==this.activeLayer.id&&!this.isUpperBaselayer(this.activeLayer))}},{key:"lowerDisabled",get:function(){return!(this.orderable&&!this.activeLayer.baseLayer&&this.getLowerLayer().id!==this.activeLayer.id&&!this.isLowerBaselayer(this.activeLayer))}},{key:"raiseDisabledSelection",get:function(){return 0===this.layersChecked.length||!this.orderable||!this.raisableLayers(this.layersChecked)||!0===this.selectAllCheck}},{key:"lowerDisabledSelection",get:function(){return 0===this.layersChecked.length||!this.orderable||!this.lowerableLayers(this.layersChecked)||!0===this.selectAllCheck}},{key:"checkOpacity",get:function(){return 100*this.layersCheckedOpacity()},set:function(e){var t,i=p(this.layersChecked);try{for(i.s();!(t=i.n()).done;){t.value.opacity=e/100}}catch(o){i.e(o)}finally{i.f()}}},{key:"layerListDisplacement",get:function(){return fd}},{key:"ngOnInit",value:function(){var e=this;this.change$$=this.change$.pipe((0,ts.D)(function(){return 0===e.layers.length?Va.E:(0,Ha.H)(50)})).subscribe(function(){e.showToolbar$.next(e.computeShowToolbar()),e.layers$.next(e.computeLayers(e.layers.slice(0))),e.appliedFilterAndSort.emit({keyword:e.keyword,sortAlpha:e.sortAlpha,onlyVisible:e.onlyVisible})}),this.selectAllCheck$$=this.selectAllCheck$.subscribe(function(t){e.selectAllCheck=t}),this.layers$$=this.layers$.subscribe(function(){if(e.layers){var t,i=0,o=p(e.layers);try{var n=function(){var o=t.value;o.status$.subscribe(function(t){0===t&&e.map.removeLayer(o)}),o.options.active&&(e.activeLayer=o,e.layerTool=!0),o.options.check&&(i+=1)};for(o.s();!(t=o.n()).done;)n()}catch(r){o.e(r)}finally{o.f()}e.selectAllCheck=e.excludeBaseLayers?i===e.layers.filter(function(e){return!0!==e.baseLayer&&e.showInLayerList}).length:i===e.layers.filter(function(e){return e.showInLayerList}).length}})}},{key:"ngOnDestroy",value:function(){this.change$$.unsubscribe(),this.selectAllCheck$$.unsubscribe(),this.layers$$.unsubscribe()}},{key:"activeLayerIsValid",value:function(e){var t=!1,i=e.options.extent,o=this.map.viewController.maxLayerZoomExtent;return i&&(t=!o||Cs.r4(o,i)),t}},{key:"activeLayersAreValid",value:function(e){var t,i=!1,o=Cs.lJ(),n=this.map.viewController.maxLayerZoomExtent,r=p(e);try{for(r.s();!(t=r.n()).done;){var a=t.value.options.extent;a&&!a.includes(1/0)&&Cs.l7(o,a)}}catch(s){r.e(s)}finally{r.f()}return Cs.xb(o)||(i=!n||Cs.r4(n,o)),i}},{key:"zoomLayerExtents",value:function(e){this.map.viewController.zoomToExtent(e.options.extent)}},{key:"zoomLayersExtents",value:function(e){var t,i=Cs.lJ(),o=p(e);try{for(o.s();!(t=o.n()).done;){var n=t.value.options.extent;n&&Cs.l7(i,n)}}catch(r){o.e(r)}finally{o.f()}this.map.viewController.zoomToExtent(i)}},{key:"changeOpacity",value:function(e){this.opacity=e.value}},{key:"clearKeyword",value:function(){this.keyword=void 0}},{key:"getLowerLayer",value:function(){return this.layers.filter(function(e){return!e.baseLayer}).reduce(function(e,t){return e.zIndex<t.zIndex?e:t},{zIndex:void 0,id:void 0})}},{key:"isLowerBaselayer",value:function(e){var t=this.layers.findIndex(function(t){return e.id===t.id});return!(!this.layers||!this.layers[t+1]||!0!==this.layers[t+1].baseLayer)}},{key:"getUpperLayer",value:function(){return this.layers.filter(function(e){return!e.baseLayer}).reduce(function(e,t){return e.zIndex>t.zIndex?e:t},{zIndex:void 0,id:void 0})}},{key:"isUpperBaselayer",value:function(e){var t=this.layers.findIndex(function(t){return e.id===t.id});return!(!this.layers||!this.layers[t-1]||!0!==this.layers[t-1].baseLayer)}},{key:"moveActiveLayer",value:function(e,t){var i=[e],o=[];this.getLinkedLayers(e,i),this.layers.map(function(e){-1!==i.indexOf(e)&&o.push(e)}),t===fd.Raise?this.raiseLayers(o,!1):t===fd.Lower&&this.lowerLayers(o,!1)}},{key:"getLinkedLayers",value:function(e,t){var i=this,o=e.options.linkedLayers;if(o){var n=o.linkId,r=o.links;r?r.map(function(e){!e.properties||-1===e.properties.indexOf(nc.ZINDEX)||e.linkedIds.map(function(e){var o=i.layers.find(function(t){var i;return(null===(i=t.options.linkedLayers)||void 0===i?void 0:i.linkId)===e});o&&(t.includes(o)||t.push(o))})}):this.layers.map(function(e){var o;(null===(o=e.options.linkedLayers)||void 0===o?void 0:o.links)&&e.options.linkedLayers.links.map(function(o){var r;-1!==(null===(r=o.properties)||void 0===r?void 0:r.indexOf(nc.ZINDEX))&&!1!==o.bidirectionnal&&-1!==o.linkedIds.indexOf(n)&&(t.push(e),i.getLinkedLayers(e,t))})})}}},{key:"raisableLayers",value:function(e){var t,i=this,o=!1,n=0,r=p(e);try{var a=function(){var r=t.value,a=i.layers.findIndex(function(e){return r.id===e.id}),s=i.layers[a];s.baseLayer&&(n+=1);var l=i.layers[a-1];l&&!0!==l.baseLayer&&!e.find(function(e){return l.id===e.id})&&!0!==s.baseLayer&&(o=!0)};for(r.s();!(t=r.n()).done;)a()}catch(s){r.e(s)}finally{r.f()}return(1===this.layersChecked.length&&this.layersChecked[0].baseLayer||n===this.layersChecked.length)&&(o=!1),o}},{key:"raisableLayer",value:function(e){return!(e<1)&&(!this.layers[e-1].options.check||this.raisableLayer(e-1))}},{key:"raiseLayers",value:function(e){var t,i=this,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=[],r=p(e);try{var a=function(){var e=t.value,o=i.layers.findIndex(function(t){return t.id===e.id});i.raisableLayer(o)&&n.push(e)};for(r.s();!(t=r.n()).done;)a()}catch(s){r.e(s)}finally{r.f()}this.map.raiseLayers(n),o&&setTimeout(function(){var e=i.computeElementRef();i.isScrolledIntoView(e[0],e[1].offsetParent)||(e[0].scrollTop=e[1].offsetParent.offsetTop)},100)}},{key:"lowerableLayers",value:function(e){var t,i=this,o=!1,n=0,r=p(e);try{var a=function(){var r=t.value,a=i.layers.findIndex(function(e){return r.id===e.id});i.layers[a].baseLayer&&(n+=1);var s=i.layers[a+1];s&&!0!==s.baseLayer&&!e.find(function(e){return s.id===e.id})&&(o=!0)};for(r.s();!(t=r.n()).done;)a()}catch(s){r.e(s)}finally{r.f()}return(1===this.layersChecked.length&&this.layersChecked[0].baseLayer||n===this.layersChecked.length)&&(o=!1),o}},{key:"lowerableLayer",value:function(e){return!(e>this.layers.filter(function(e){return!0!==e.baseLayer}).length-2)&&(!this.layers[e+1].options.check||this.lowerableLayer(e+1))}},{key:"lowerLayers",value:function(e){var t,i=this,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=[],r=p(e);try{var a=function(){var e=t.value,o=i.layers.findIndex(function(t){return t.id===e.id});i.lowerableLayer(o)&&n.push(e)};for(r.s();!(t=r.n()).done;)a()}catch(s){r.e(s)}finally{r.f()}this.map.lowerLayers(n),o&&setTimeout(function(){var e=i.computeElementRef("lower");i.isScrolledIntoView(e[0],e[1].offsetParent)||(e[0].scrollTop=e[1].offsetParent.offsetTop+e[1].offsetParent.offsetHeight-e[0].clientHeight)},100)}},{key:"next",value:function(){this.change$.next()}},{key:"computeLayers",value:function(e){var t=this.filterLayers(e);return t=this.sortAlpha?this.sortLayersByTitle(t):this.sortLayersByZindex(t)}},{key:"onKeywordChange",value:function(e){this.keyword=e}},{key:"onAppliedFilterAndSortChange",value:function(e){this.keyword=e.keyword,this.onlyVisible=e.onlyVisible,this.sortAlpha=e.sortAlpha}},{key:"filterLayers",value:function(e){var t=this;if(this.layerFilterAndSortOptions.showToolbar===hd.never||!this.keyword&&!this.onlyVisible)return e;var i=e.map(function(e){return e.id});return e.forEach(function(e){var o=e.dataSource.options||{},n=(((e.options||{}).metadata||{}).keywordList||[]).map(function(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")});if(t.keyword&&e.title){var r=t.keyword.normalize("NFD").replace(/[\u0300-\u036f]/g,""),a=e.title.normalize("NFD").replace(/[\u0300-\u036f]/g,""),s=o.type||"",l=new RegExp(r,"gi"),c=void 0!==n.find(function(e){return l.test(e)});if(!l.test(a)&&t.keyword.toLowerCase()!==s.toLowerCase()&&!c){var u=i.indexOf(e.id);u>-1&&i.splice(u,1)}}if(t.onlyVisible&&!1===e.visible){var p=i.indexOf(e.id);p>-1&&i.splice(p,1)}}),e.filter(function(e){return-1!==i.indexOf(e.id)})}},{key:"sortLayersByZindex",value:function(e){return e.sort(function(e,t){return t.zIndex-e.zIndex})}},{key:"sortLayersByTitle",value:function(e){var t=this;return e.sort(function(e,i){return t.normalize(e.title)<t.normalize(i.title)?-1:t.normalize(e.title)>t.normalize(i.title)?1:0})}},{key:"normalize",value:function(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}},{key:"computeShowToolbar",value:function(){switch(this.layerFilterAndSortOptions.showToolbar){case hd.always:return!0;case hd.never:return!1;default:return!!(this.layers.length>=this.thresholdToFilterAndSort||this.keyword||this.onlyVisible)}}},{key:"toggleLayerTool",value:function(e){this.toggleOpacity=!1,this.layerTool=!this.layerTool||e!==this.activeLayer;var t,i=p(this.layers);try{for(i.s();!(t=i.n()).done;){t.value.options.active=!1}}catch(o){i.e(o)}finally{i.f()}e.options.active=!0,this.activeLayer=e}},{key:"removeLayers",value:function(e){if(e&&e.length>0){this.layersChecked=[];var t,i=p(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;!1!==o.options.removable?o.map.removeLayer(o):this.layersChecked.push(o)}}catch(n){i.e(n)}finally{i.f()}}else!e&&!1!==this.activeLayer.options.removable&&(this.activeLayer.map.removeLayer(this.activeLayer),this.layerTool=!1)}},{key:"toggleVisibility",value:function(e){if(e&&e.length>0){var t,i=p(e);try{for(i.s();!(t=i.n()).done;){t.value.visible=this.hideSelectedLayers}}catch(o){i.e(o)}finally{i.f()}}this.layerItemChangeDetection$.next(!0)}},{key:"isLayerRemovable",value:function(e){return!1!==e.options.removable}},{key:"isAllLayersRemovable",value:function(e){var t=this;return e.every(function(e){return t.isLayerRemovable(e)})}},{key:"statusSelectedLayersCheck",get:function(){var e=gd.NULL,t=!1,i=!1;if(0===this.layersChecked.length)e=gd.NULL;else{e=gd.MIXED,this.hideSelectedLayers=!1;var o,n=p(this.layersChecked);try{for(n.s();!(o=n.n()).done;){var r=o.value;!0===r.visible&&(t=!0),!1===r.visible&&(i=!0)}}catch(a){n.e(a)}finally{n.f()}!0===t&&!1===i&&(e=gd.ALL_VISIBLE),!1===t&&!0===i&&(e=gd.ALL_HIDDEN,this.hideSelectedLayers=!0)}return e}},{key:"layersCheck",value:function(e){var t=this;if(e.layer.options.check=e.check,!0===e.check){var i,o=this.layers.findIndex(function(t){return e.layer.id===t.id}),n=p(this.layersChecked);try{var r=function(){var n=i.value;if(o<t.layers.findIndex(function(e){return n.id===e.id}))return{v:(t.layersChecked.splice(t.layersChecked.findIndex(function(e){return n.id===e.id}),0,e.layer),void(t.excludeBaseLayers?t.selectAllCheck=t.layersChecked.length===t.layers.filter(function(e){return!0!==e.baseLayer&&e.showInLayerList}).length:t.excludeBaseLayers||(t.selectAllCheck=t.layersChecked.length===t.layers.filter(function(e){return e.showInLayerList}).length)))}};for(n.s();!(i=n.n()).done;){var a=r();if("object"==typeof a)return a.v}}catch(l){n.e(l)}finally{n.f()}this.layersChecked.push(e.layer)}else{var s=this.layersChecked.findIndex(function(t){return e.layer.id===t.id});this.layersChecked.splice(s,1)}this.excludeBaseLayers?this.selectAllCheck=this.layersChecked.length===this.layers.filter(function(e){return!0!==e.baseLayer&&e.showInLayerList}).length:this.excludeBaseLayers||(this.selectAllCheck=this.layersChecked.length===this.layers.filter(function(e){return e.showInLayerList}).length)}},{key:"toggleSelectionMode",value:function(e){if(this.selection=e,this.activeLayer=void 0,!0===e){this.layerTool=!1;var t,i=p(this.layers);try{for(i.s();!(t=i.n()).done;){var o=t.value;o.options.check&&this.layersChecked.push(o)}}catch(n){i.e(n)}finally{i.f()}}}},{key:"layersCheckedOpacity",value:function(){if(this.layersChecked.length>1)return 1;var e,t=[],i=p(this.layersChecked);try{for(i.s();!(e=i.n()).done;){var o=e.value;t.push(o.opacity)}}catch(n){i.e(n)}finally{i.f()}return t}},{key:"selectAll",value:function(){if(this.selectAllCheck){var e,t=p(this.layers);try{for(t.s();!(e=t.n()).done;){e.value.options.check=!1}}catch(r){t.e(r)}finally{t.f()}this.layersChecked=[],this.selectAllCheck$.next(!1)}else{var i,o=p(this.layers);try{for(o.s();!(i=o.n()).done;){var n=i.value;(this.excludeBaseLayers&&!0!==n.baseLayer&&n.showInLayerList||!this.excludeBaseLayers&&n.showInLayerList)&&(n.options.check=!0,this.layersChecked.push(n))}}catch(r){o.e(r)}finally{o.f()}this.selectAllCheck$.next(!0)}}},{key:"isScrolledIntoView",value:function(e,t){var i=e.scrollTop,o=t.offsetTop;return o+t.clientHeight<=i+e.clientHeight&&o>=i}},{key:"computeElementRef",value:function(e){var t=this.elRef.nativeElement.getElementsByClassName("mat-checkbox-checked"),i="lower"===e?this.elRef.nativeElement.getElementsByClassName("mat-checkbox-checked")[t.length-1]:this.elRef.nativeElement.getElementsByClassName("mat-checkbox-checked")[0];return[this.elRef.nativeElement.getElementsByTagName("igo-list")[0],i]}},{key:"removeProblemLayerInList",value:function(e){var t,i=p(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;!0===o.olLoadingProblem&&this.map.removeLayer(o)}}catch(n){i.e(n)}finally{i.f()}return e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(w.SBq))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-layer-list"]],contentQueries:function(e,t,i){var o;(1&e&&w.Suo(i,md,5),2&e)&&(w.iGM(o=w.CRH())&&(t.templateLayerToolbar=o.first))},inputs:{layersAreAllVisible:"layersAreAllVisible",ogcButton:"ogcButton",timeButton:"timeButton",map:"map",layers:"layers",floatLabel:"floatLabel",layerFilterAndSortOptions:"layerFilterAndSortOptions",excludeBaseLayers:"excludeBaseLayers",toggleLegendOnVisibilityChange:"toggleLegendOnVisibilityChange",expandLegendOfVisibleLayers:"expandLegendOfVisibleLayers",updateLegendOnResolutionChange:"updateLegendOnResolutionChange",queryBadge:"queryBadge"},outputs:{appliedFilterAndSort:"appliedFilterAndSort"},ngContentSelectors:Od,decls:11,vars:16,consts:[["floatLabel","auto",3,"layersAreAllVisible","term","onlyVisible","sortAlpha","appliedFilterAndSort","selection",4,"ngIf"],["class","select-all",4,"ngIf"],[3,"ngClass","navigation","selection"],["igoList",""],["ngFor","",3,"ngForOf"],["class","igo-layer-actions-container",3,"title",4,"ngIf"],["floatLabel","auto",3,"layersAreAllVisible","term","onlyVisible","sortAlpha","appliedFilterAndSort","selection"],[1,"select-all"],[1,"select-all-checkbox","mat-subheading-2",3,"color","checked","indeterminate","change"],["igoListItem","",3,"layer","activeLayer","orderable","lowerDisabled","raiseDisabled","queryBadge","expandLegendIfVisible","updateLegendOnResolutionChange","toggleLegendOnVisibilityChange","selectionMode","selectAll","layerCheck","changeDetection","action","checkbox",4,"ngIf"],["igoListItem","",3,"layer","activeLayer","orderable","lowerDisabled","raiseDisabled","queryBadge","expandLegendIfVisible","updateLegendOnResolutionChange","toggleLegendOnVisibilityChange","selectionMode","selectAll","layerCheck","changeDetection","action","checkbox"],[1,"igo-layer-actions-container",3,"title"],[1,"igo-layer-button-group"],["class","delete-button","mat-icon-button","","color","warn","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","color","primary","tooltip-position","below","matTooltipShowDelay","500",1,"down-button",3,"matTooltip","disabled","click"],["matBadgeColor","warn","matBadgeSize","medium","svgIcon","arrow-down",3,"matBadge","matBadgeHidden"],["color","primary","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",1,"up-button",3,"matTooltip","disabled","click"],["matBadgeColor","warn","matBadgeSize","medium","svgIcon","arrow-up",3,"matBadge","matBadgeHidden"],["color","primary","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",1,"opacity-button",3,"matMenuTriggerFor","matTooltip"],["matBadgeColor","primary","matBadgeSize","medium","svgIcon","opacity",3,"matBadge"],[1,"mat-menu-opacity-slider"],["opacityMenu","matMenu"],["id","opacity-menu"],["id","opacity-slider","color","primary","thumbLabel","","tickInterval","5","step","5","matTooltipShowDelay","500","tooltip-position","below",3,"min","max","value","matTooltip","input","click"],["class","zoomLayer-button","color","primary","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","click",4,"ngIf"],["igoLayerItemToolbar","",3,"ngTemplateOutlet","ngTemplateOutletContext"],["mat-icon-button","","color","warn","tooltip-position","below","matTooltipShowDelay","500",1,"delete-button",3,"matTooltip","click"],["svgIcon","delete"],["color","primary","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",1,"zoomLayer-button",3,"matTooltip","click"],["matBadgeColor","primary","matBadgeSize","medium","svgIcon","magnify-scan"],[1,"actions-buttons-multi"],["mat-icon-button","","color","warn","tooltip-position","below","matTooltipShowDelay","500",1,"delete-button",3,"disabled","matTooltip","click"],["matBadgeColor","warn","matBadgeSize","medium","svgIcon","delete",3,"matBadge","matBadgeHidden"],["mat-icon-button","","color","primary","tooltip-position","below","matTooltipShowDelay","500",1,"eye-button",3,"disabled","matTooltip","click"],[3,"svgIcon"],["color","primary","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",1,"opacity-button",3,"disabled","matMenuTriggerFor","matTooltip"],["svgIcon","opacity"],["id","opacity-slider","color","primary","thumbLabel","","tickInterval","5","step","5","matTooltipShowDelay","500","tooltip-position","below",3,"min","max","ngModel","matTooltip","ngModelChange","click",4,"ngIf"],["id","opacity-slider","color","primary","thumbLabel","","tickInterval","5","step","5","matTooltipShowDelay","500","tooltip-position","below",3,"min","max","ngModel","matTooltip","ngModelChange","click"],["svgIcon","magnify-scan"]],template:function(e,t){1&e&&(w.F$t(Zd),w.TgZ(0,"mat-list"),w.YNc(1,vd,1,4,"igo-layer-list-tool",0),w.ALo(2,"async"),w.qZA(),w.YNc(3,yd,5,8,"mat-list-item",1),w._UZ(4,"mat-divider"),w.TgZ(5,"igo-list",2,3),w.YNc(7,wd,1,1,"ng-template",4),w.ALo(8,"async"),w.qZA(),w.YNc(9,Cd,22,34,"igo-panel",5),w.YNc(10,Ld,27,41,"igo-panel",5)),2&e&&(w.xp6(1),w.Q6J("ngIf",w.lcZ(2,8,t.showToolbar$)),w.xp6(2),w.Q6J("ngIf",t.selection),w.xp6(2),w.Q6J("ngClass",w.kEZ(12,Fd,t.selection,t.layerTool&&!t.selection,!t.layerTool&&!t.selection))("navigation",!1)("selection",!1),w.xp6(2),w.Q6J("ngForOf",w.lcZ(8,10,t.layers$)),w.xp6(2),w.Q6J("ngIf",!t.selection&&t.layerTool&&t.activeLayer),w.xp6(1),w.Q6J("ngIf",t.selection&&t.layers.length>0))},styles:["[_nghost-%COMP%]   .igo-list-no-tools[_ngcontent-%COMP%]{height:calc(100% - 57px);padding-top:8px}[_nghost-%COMP%]   .igo-list-tools-single[_ngcontent-%COMP%]{height:calc(100% - 153px);padding-top:8px}[_nghost-%COMP%]   .igo-list-tools-multi[_ngcontent-%COMP%]{height:calc(100% - 191px);padding-top:8px}mat-form-field.inputFilter[_ngcontent-%COMP%]{width:calc(100% - 100px);max-width:200px}.igo-layer-actions-container[_ngcontent-%COMP%]{width:calc(100% - 5px);padding-left:4px}.igo-layer-actions-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{text-align:center}mat-list-item[_ngcontent-%COMP%]     .mat-list-item-content{margin-bottom:10px}mat-checkbox[_ngcontent-%COMP%]     .mat-checkbox-inner-container{margin-left:8px;margin-right:16px}#opacity-slider[_ngcontent-%COMP%]{float:left;min-width:unset;width:110px;left:10px;top:10px}.igo-layer-button-group[_ngcontent-%COMP%], .actions-buttons-multi[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:row-reverse;overflow-x:auto;overflow-y:hidden}.igo-layer-button-group[_ngcontent-%COMP%]::-webkit-scrollbar, .actions-buttons-multi[_ngcontent-%COMP%]::-webkit-scrollbar{height:4px}.igo-layer-button-group[_ngcontent-%COMP%]::-webkit-scrollbar-track, .actions-buttons-multi[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1}.igo-layer-button-group[_ngcontent-%COMP%]::-webkit-scrollbar-thumb, .actions-buttons-multi[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#888}.igo-layer-button-group[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover, .actions-buttons-multi[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#555}.igo-layer-button-group[_ngcontent-%COMP%]{padding-top:5px}[_nghost-%COMP%]   igo-panel[_ngcontent-%COMP%]{height:unset}#opacity-menu[_ngcontent-%COMP%]{max-width:unset;width:132px;height:50px}#opacity-menu[_ngcontent-%COMP%]   .mat-menu-content[_ngcontent-%COMP%]:not(:empty){padding-top:20px}.select-all[_ngcontent-%COMP%]     .mat-list-item-content{margin:0}"],changeDetection:0}),e}();function Id(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",9),w.NdJ("click",function(){return w.CHM(i),w.oxw().clearTerm()}),w._UZ(1,"mat-icon",10),w.qZA()}}var Pd=function(){var e=function(){function e(){m(this,e),this.onlyVisible$=new R.X(!1),this.sortAlpha$=new R.X(!1),this.term$=new R.X(void 0),this.layersAreAllVisible=!0,this.floatLabel="auto",this.selectionMode=!1,this.appliedFilterAndSort=new w.vpe,this.selection=new w.vpe}return y(e,[{key:"onlyVisible",get:function(){return this.onlyVisible$.value},set:function(e){this.onlyVisible$.next(e)}},{key:"sortAlpha",get:function(){return this.sortAlpha$.value},set:function(e){this.sortAlpha$.next(e)}},{key:"term",get:function(){return this.term$.value},set:function(e){this.term$.next(e)}},{key:"ngOnInit",value:function(){var e=this;this.term$$=this.term$.subscribe(function(t){e.appliedFilterAndSort.emit({keyword:t,onlyVisible:e.onlyVisible,sortAlpha:e.sortAlpha})}),this.onlyVisible$$=this.onlyVisible$.subscribe(function(t){e.appliedFilterAndSort.emit({keyword:e.term,onlyVisible:t,sortAlpha:e.sortAlpha})}),this.sortAlpha$$=this.sortAlpha$.subscribe(function(t){e.appliedFilterAndSort.emit({keyword:e.term,onlyVisible:e.onlyVisible,sortAlpha:t})})}},{key:"ngOnDestroy",value:function(){this.onlyVisible$$.unsubscribe(),this.sortAlpha$$.unsubscribe(),this.term$$.unsubscribe()}},{key:"clearTerm",value:function(){this.term=void 0}},{key:"toggleSortAlpha",value:function(){this.sortAlpha=!this.sortAlpha}},{key:"toggleOnlyVisible",value:function(){this.onlyVisible=!this.onlyVisible}},{key:"toggleSelectionMode",value:function(){this.selectionMode=!this.selectionMode,this.selection.emit(this.selectionMode)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-layer-list-tool"]],inputs:{layersAreAllVisible:"layersAreAllVisible",floatLabel:"floatLabel",onlyVisible:"onlyVisible",sortAlpha:"sortAlpha",term:"term"},outputs:{appliedFilterAndSort:"appliedFilterAndSort",selection:"selection"},decls:21,vars:30,consts:[[1,"inputFilter",3,"floatLabel"],["matInput","","matTooltipShowDelay","500","type","text",3,"placeholder","matTooltip","ngModel","ngModelChange"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear","color","warn",3,"click",4,"ngIf"],["matTooltipShowDelay","500",3,"matTooltip"],["mat-icon-button","",1,"sort-alpha",3,"color","click"],[3,"svgIcon"],["mat-icon-button","",1,"only-visible",3,"disabled","color","click"],["matBadge","icon","igoMatBadgeIcon","eye","igoMatBadgeInverseColor","true","igoMatBadgeInheritColor","true",3,"svgIcon"],["mat-icon-button","","color","primary",1,"selection-mode",3,"click"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear","color","warn",3,"click"],["svgIcon","close"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-list-item"),w.TgZ(1,"mat-form-field",0),w.TgZ(2,"input",1),w.NdJ("ngModelChange",function(e){return t.term=e}),w.ALo(3,"translate"),w.ALo(4,"translate"),w.qZA(),w.YNc(5,Id,2,0,"button",2),w.qZA(),w.TgZ(6,"div",3),w.ALo(7,"translate"),w.ALo(8,"translate"),w.TgZ(9,"button",4),w.NdJ("click",function(){return t.toggleSortAlpha()}),w._UZ(10,"mat-icon",5),w.qZA(),w.qZA(),w.TgZ(11,"div",3),w.ALo(12,"translate"),w.ALo(13,"translate"),w.TgZ(14,"button",6),w.NdJ("click",function(){return t.toggleOnlyVisible()}),w._UZ(15,"mat-icon",7),w.qZA(),w.qZA(),w.TgZ(16,"div",3),w.ALo(17,"translate"),w.ALo(18,"translate"),w.TgZ(19,"button",8),w.NdJ("click",function(){return t.toggleSelectionMode()}),w._UZ(20,"mat-icon",5),w.qZA(),w.qZA(),w.qZA()),2&e&&(w.xp6(1),w.Q6J("floatLabel",t.floatLabel),w.xp6(1),w.Q6J("placeholder",w.lcZ(3,14,"igo.geo.layer.filterPlaceholder"))("matTooltip",w.lcZ(4,16,"igo.geo.layer.subsetLayersListKeyword"))("ngModel",t.term),w.xp6(3),w.Q6J("ngIf",t.term),w.xp6(1),w.Q6J("matTooltip",t.sortAlpha?w.lcZ(7,18,"igo.geo.layer.sortMapOrder"):w.lcZ(8,20,"igo.geo.layer.sortAlphabetically")),w.xp6(3),w.Q6J("color",t.sortAlpha?"warn":"primary"),w.xp6(1),w.Q6J("svgIcon",t.sortAlpha?"sort-ascending":"sort-alphabetical-ascending"),w.xp6(1),w.Q6J("matTooltip",t.onlyVisible?w.lcZ(12,22,"igo.geo.layer.resetLayersList"):w.lcZ(13,24,"igo.geo.layer.subsetLayersListOnlyVisible")),w.xp6(3),w.Q6J("disabled",t.layersAreAllVisible&&!t.onlyVisible)("color",t.onlyVisible?"warn":"primary"),w.xp6(1),w.Q6J("svgIcon",t.onlyVisible?"filter-remove":"filter"),w.xp6(1),w.Q6J("matTooltip",t.selectionMode?w.lcZ(17,26,"igo.geo.layer.deactivateSelectionMode"):w.lcZ(18,28,"igo.geo.layer.activateSelectionMode")),w.xp6(4),w.Q6J("svgIcon",t.selectionMode?"checkbox-multiple-marked-outline":"checkbox-multiple-blank-outline"))},directives:[C.Tg,Ye.KE,ot.Nt,We.Fj,L.gM,We.JJ,We.On,F.O5,S.lW,k.Hw,ct.k,ro,Ye.R9],pipes:[ae.X$],styles:["mat-form-field.inputFilter[_ngcontent-%COMP%]{width:calc(100% - 100px);max-width:200px}.selection-mode[_ngcontent-%COMP%]{margin-left:5px}"],changeDetection:0}),e}(),_d=function(){var e=function(){function e(t,i,o){m(this,e),this.mapService=i,this.route=o,this.component=t}return y(e,[{key:"ngOnInit",value:function(){var e=this;this.layersOrResolutionChange$$=(0,J.aj)([this.mapService.getMap().layers$,this.mapService.getMap().viewController.resolution$]).pipe((0,E.b)(10)).subscribe(function(t){var i=t[0].filter(function(e){return!0===e.showInLayerList});e.component.layers=i,e.setLayersVisibilityStatus(i,e.component.excludeBaseLayers)})}},{key:"setLayersVisibilityStatus",value:function(e,t){var i=this;void 0!==this.layersVisibility$$&&(this.layersVisibility$$.unsubscribe(),this.layersVisibility$$=void 0),this.layersVisibility$$=(0,J.aj)(e.filter(function(e){return e.baseLayer!==t}).map(function(e){return e.visible$})).pipe((0,D.U)(function(e){return e.every(Boolean)})).subscribe(function(e){return i.component.layersAreAllVisible=e})}},{key:"ngOnDestroy",value:function(){this.layersOrResolutionChange$$.unsubscribe(),void 0!==this.layersVisibility$$&&(this.layersVisibility$$.unsubscribe(),this.layersVisibility$$=void 0)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Md,2),w.Y36(su),w.Y36(Oe,8))},e.\u0275dir=w.lG2({type:e,selectors:[["","igoLayerListBinding",""]]}),e}();function qd(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-slide-toggle",6),w.NdJ("change",function(e){return w.CHM(i),w.oxw().toggleShowAllLegends(e.checked)}),w.ALo(1,"translate"),w._uU(2),w.ALo(3,"translate"),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("matTooltip",w.lcZ(1,4,"igo.geo.layer.legend.showAll"))("checked",o.showAllLegendsValue)("labelPosition","before"),w.xp6(2),w.hij(" ",w.lcZ(3,6,"igo.geo.layer.legend.showAll")," ")}}function Dd(e,t){1&e&&w._UZ(0,"mat-divider")}function Ed(e,t){if(1&e&&w._UZ(0,"igo-layer-legend-item",8),2&e){var i=w.oxw().$implicit,o=w.oxw();w.Q6J("layer",i)("updateLegendOnResolutionChange",o.updateLegendOnResolutionChange)}}function $d(e,t){if(1&e&&w.YNc(0,Ed,1,2,"igo-layer-legend-item",7),2&e){var i=t.$implicit,o=w.oxw();w.Q6J("ngIf",!(o.excludeBaseLayers&&i.baseLayer))}}function Rd(e,t){1&e&&(w.TgZ(0,"p",9),w._uU(1),w.ALo(2,"translate"),w.qZA()),2&e&&(w.xp6(1),w.hij(" ",w.lcZ(2,1,"igo.geo.layer.legend.noLayersVisibleWithShowAllButton")," "))}function Nd(e,t){1&e&&(w.TgZ(0,"p",9),w._uU(1),w.ALo(2,"translate"),w.qZA()),2&e&&(w.xp6(1),w.hij(" ",w.lcZ(2,1,"igo.geo.layer.legend.noLayersVisibleWithShowAllButtonButZoom")," "))}function Ud(e,t){1&e&&(w.TgZ(0,"p",9),w._uU(1),w.ALo(2,"translate"),w.qZA()),2&e&&(w.xp6(1),w.hij(" ",w.lcZ(2,1,"igo.geo.layer.legend.noLayersVisible")," "))}function Jd(e,t){1&e&&(w.TgZ(0,"p",9),w._uU(1),w.ALo(2,"translate"),w.qZA()),2&e&&(w.xp6(1),w.hij(" ",w.lcZ(2,1,"igo.geo.layer.legend.noLayersVisibleButZoom")," "))}var Bd=function(){var e=function(){function e(){m(this,e),this.orderable=!0,this.hasVisibleOrInRangeLayers$=new R.X(!0),this.hasVisibleAndNotInRangeLayers$=new R.X(!0),this.layersInUi$=new R.X([]),this.layers$=new R.X([]),this.showAllLegend=!1,this.change$=new Re.t(1),this.excludeBaseLayers=!1,this.updateLegendOnResolutionChange=!1,this.allowShowAllLegends=!1,this.showAllLegendsValue=!1,this.allLegendsShown=new w.vpe(!1)}return y(e,[{key:"layers",get:function(){return this._layers},set:function(e){this._layers=e,this.next()}},{key:"ngOnInit",value:function(){var e=this;this.change$$=this.change$.pipe((0,ts.D)(function(){return 0===e.layers.length?Va.E:(0,Ha.H)(50)})).subscribe(function(){var t=e.computeShownLayers(e.layers.slice(0));e.layers$.next(t),e.hasVisibleOrInRangeLayers$.next(e.layers.slice(0).filter(function(e){return!0!==e.baseLayer}).filter(function(e){return e.visible$.value&&e.isInResolutionsRange$.value}).length>0),e.hasVisibleAndNotInRangeLayers$.next(e.layers.slice(0).filter(function(e){return!0!==e.baseLayer}).filter(function(e){return e.visible$.value&&!e.isInResolutionsRange$.value}).length>0),e.layersInUi$.next(e.layers.slice(0).filter(function(t){return!(!1===t.showInLayerList||e.excludeBaseLayers&&t.baseLayer)}))})}},{key:"ngOnDestroy",value:function(){this.change$$.unsubscribe()}},{key:"next",value:function(){this.change$.next()}},{key:"computeShownLayers",value:function(e){var t=e.filter(function(e){return e.visible&&e.isInResolutionsRange});return this.showAllLegendsValue&&(t=e),this.sortLayersByZindex(t)}},{key:"sortLayersByZindex",value:function(e){return e.sort(function(e,t){return t.zIndex-e.zIndex})}},{key:"toggleShowAllLegends",value:function(e){this.showAllLegendsValue=e,this.next(),this.allLegendsShown.emit(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-layer-legend-list"]],inputs:{layers:"layers",excludeBaseLayers:"excludeBaseLayers",updateLegendOnResolutionChange:"updateLegendOnResolutionChange",allowShowAllLegends:"allowShowAllLegends",showAllLegendsValue:"showAllLegendsValue"},outputs:{allLegendsShown:"allLegendsShown"},decls:24,vars:39,consts:[[1,"layer-legend-list-container"],["tooltip-position","above","matTooltipShowDelay","500","class","mat-typography",3,"matTooltip","checked","labelPosition","change",4,"ngIf"],[4,"ngIf"],[3,"navigation","selection"],["ngFor","",3,"ngForOf"],["class","layers-empty mat-typography",4,"ngIf"],["tooltip-position","above","matTooltipShowDelay","500",1,"mat-typography",3,"matTooltip","checked","labelPosition","change"],["igoListItem","",3,"layer","updateLegendOnResolutionChange",4,"ngIf"],["igoListItem","",3,"layer","updateLegendOnResolutionChange"],[1,"layers-empty","mat-typography"]],template:function(e,t){1&e&&(w.TgZ(0,"div",0),w.YNc(1,qd,4,8,"mat-slide-toggle",1),w.ALo(2,"async"),w.YNc(3,Dd,1,0,"mat-divider",2),w.ALo(4,"async"),w.TgZ(5,"igo-list",3),w.YNc(6,$d,1,1,"ng-template",4),w.ALo(7,"async"),w.qZA(),w.YNc(8,Rd,3,3,"p",5),w.ALo(9,"async"),w.ALo(10,"async"),w.ALo(11,"async"),w.YNc(12,Nd,3,3,"p",5),w.ALo(13,"async"),w.ALo(14,"async"),w.ALo(15,"async"),w.YNc(16,Ud,3,3,"p",5),w.ALo(17,"async"),w.ALo(18,"async"),w.ALo(19,"async"),w.YNc(20,Jd,3,3,"p",5),w.ALo(21,"async"),w.ALo(22,"async"),w.ALo(23,"async"),w.qZA()),2&e&&(w.xp6(1),w.Q6J("ngIf",w.lcZ(2,9,t.layersInUi$).length&&t.allowShowAllLegends),w.xp6(2),w.Q6J("ngIf",w.lcZ(4,11,t.layersInUi$).length&&t.allowShowAllLegends),w.xp6(2),w.Q6J("navigation",!1)("selection",!1),w.xp6(1),w.Q6J("ngForOf",w.lcZ(7,13,t.layers$)),w.xp6(2),w.Q6J("ngIf",!t.showAllLegendsValue&&w.lcZ(9,15,t.layersInUi$).length&&!1===w.lcZ(10,17,t.hasVisibleOrInRangeLayers$)&&!1===w.lcZ(11,19,t.hasVisibleAndNotInRangeLayers$)&&t.allowShowAllLegends),w.xp6(4),w.Q6J("ngIf",!t.showAllLegendsValue&&w.lcZ(13,21,t.layersInUi$).length&&!1===w.lcZ(14,23,t.hasVisibleOrInRangeLayers$)&&w.lcZ(15,25,t.hasVisibleAndNotInRangeLayers$)&&t.allowShowAllLegends),w.xp6(4),w.Q6J("ngIf",w.lcZ(17,27,t.layersInUi$).length&&!1===w.lcZ(18,29,t.hasVisibleOrInRangeLayers$)&&!1===w.lcZ(19,31,t.hasVisibleAndNotInRangeLayers$)&&!t.allowShowAllLegends),w.xp6(4),w.Q6J("ngIf",w.lcZ(21,33,t.layersInUi$).length&&!1===w.lcZ(22,35,t.hasVisibleOrInRangeLayers$)&&w.lcZ(23,37,t.hasVisibleAndNotInRangeLayers$)&&!t.allowShowAllLegends))},styles:["mat-slide-toggle[_ngcontent-%COMP%]{width:100%;margin:10px}mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content{width:calc(100% - 60px)}igo-list[_ngcontent-%COMP%]{display:contents}.layers-empty[_ngcontent-%COMP%]{text-align:justify;margin:10px}.layer-legend-list-container[_ngcontent-%COMP%]{max-height:100%;overflow:auto}"],changeDetection:0}),e}();function jd(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",1),w.NdJ("click",function(){return w.CHM(i),w.oxw().toggleTrackFeature()}),w.ALo(1,"translate"),w._UZ(2,"mat-icon",2),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("matTooltip",w.lcZ(1,2,"igo.geo.layer.trackFeature"))("color",o.color)}}var Qd=function(){var e=function(){function e(){m(this,e),this.trackFeature=!1,this.color="primary"}return y(e,[{key:"options",get:function(){if(this.layer)return this.layer.options}},{key:"ngOnInit",value:function(){this.color=this.trackFeature?"primary":"basic"}},{key:"toggleTrackFeature",value:function(){this.trackFeature?(this.layer.disableTrackFeature(this.layer.options.trackFeature),this.color="basic"):(this.layer.enableTrackFeature(this.layer.options.trackFeature),this.color="primary"),this.trackFeature=!this.trackFeature}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-track-feature-button"]],inputs:{layer:"layer",trackFeature:"trackFeature"},decls:1,vars:1,consts:[["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click"],["svgIcon","crosshairs-gps"]],template:function(e,t){1&e&&w.YNc(0,jd,3,4,"button",0),2&e&&w.Q6J("ngIf",t.options.trackFeature)},directives:[F.O5,S.lW,L.gM,k.Hw],pipes:[ae.X$],styles:[""],changeDetection:0}),e}(),Gd=function(){var e=function(){function e(t){m(this,e),this.networkService=t,this.inResolutionRange$=new R.X(!0),this.updateLegendOnResolutionChange=!1}return y(e,[{key:"ngOnInit",value:function(){var e=this;this.resolution$$=this.layer.map.viewController.resolution$.subscribe(function(){e.onResolutionChange()}),this.tooltipText=this.computeTooltip(),this.network$$=this.networkService.currentState().subscribe(function(t){e.state=t,e.onResolutionChange()})}},{key:"ngOnDestroy",value:function(){this.resolution$$.unsubscribe(),this.network$$.unsubscribe()}},{key:"computeTooltip",value:function(){var e=this.layer.options;if(!e.tooltip)return this.layer.title;var t=e.tooltip,i=e.metadata;switch(e.tooltip.type){case rc.TITLE:return this.layer.title;case rc.ABSTRACT:return i&&i.abstract?i.abstract:this.layer.title;case rc.CUSTOM:return t&&t.text?t.text:this.layer.title;default:return this.layer.title}}},{key:"onResolutionChange",value:function(){this.inResolutionRange$.next(this.layer.isInResolutionsRange)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ee))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-layer-legend-item"]],inputs:{layer:"layer",updateLegendOnResolutionChange:"updateLegendOnResolutionChange"},decls:6,vars:4,consts:[[1,"igo-layer-list-item"],["matLine","","matTooltipShowDelay","500",1,"igo-layer-title",3,"matTooltip"],[1,"igo-layer-legend-container"],["legend",""],[3,"layer","updateLegendOnResolutionChange"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-list-item",0),w.TgZ(1,"h4",1),w._uU(2),w.qZA(),w.qZA(),w.TgZ(3,"div",2,3),w._UZ(5,"igo-layer-legend",4),w.qZA()),2&e&&(w.xp6(1),w.Q6J("matTooltip",t.tooltipText),w.xp6(1),w.Oqu(t.layer.title),w.xp6(3),w.Q6J("layer",t.layer)("updateLegendOnResolutionChange",t.updateLegendOnResolutionChange))},styles:["[_nghost-%COMP%]{overflow:hidden}.igo-layer-list-item[_ngcontent-%COMP%]{height:46px;clear:both}.igo-layer-legend-container[_ngcontent-%COMP%]{padding-left:18px;width:calc(100% - 18px)}"],changeDetection:0}),e}(),Yd=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[Xu,Zu,rd]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[ot.c,Ye.lN,F.ez,We.u5,kl.t,I.Tx,k.Ps,S.ot,Cl.rP,ze.LD,L.AV,C.ie,Tl.KP,ct.g,M.p9,Se,hn,ho,Ho,yn,ao,bo]]}),e}();w.B6R(dd,[C.Tg,F.O5,M.oG,C.Nh,Ve.X2,L.gM,S.lW,k.Hw,ct.k,F.mk,Qp],[ae.X$,F.Ov]),w.B6R(Gd,[C.Tg,Ve.X2,L.gM,Qp],[]),w.B6R(Md,[C.i$,F.O5,Pd,C.Tg,M.oG,kl.d,dn,F.mk,F.sg,dd,cn,vn,S.lW,L.gM,k.Hw,ct.k,I.p6,I.VK,Tl.pH,F.tP,We.JJ,We.On],[F.Ov,ae.X$]),w.B6R(Bd,[F.O5,Cl.Rr,L.gM,kl.d,dn,F.sg,Gd,cn],[ae.X$,F.Ov]);var zd=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,ct.g,S.ot,k.Ps,C.ie,L.AV,ao,Se,hn,ho,Kl,Yd]]}),e}();function Vd(e,t){if(1&e&&(w.TgZ(0,"mat-option",17),w._uU(1),w.qZA()),2&e){var i=t.$implicit;w.Q6J("matTooltip",i.title)("value",i),w.xp6(1),w.hij(" ",i.title," ")}}function Hd(e,t){if(1&e&&(w.TgZ(0,"mat-option",17),w._uU(1),w.qZA()),2&e){var i=t.$implicit;w.Q6J("matTooltip",i.url)("value",i),w.xp6(1),w.hij(" ",i.url," ")}}function Wd(e,t){if(1&e&&(w.TgZ(0,"mat-option",18),w.NdJ("click",function(e){return e.stopPropagation()}),w.TgZ(1,"p",19),w._uU(2),w.qZA(),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i),w.xp6(2),w.Oqu(i)}}w.B6R(Fp,[dn,F.sg,F.O5,nd,Hp,cn],[F.Ov]);var Xd=function(e,t){return{value:e,email:t}};function Kd(e,t){if(1&e&&(w.TgZ(0,"span"),w.TgZ(1,"p",20),w._uU(2),w.qZA(),w.qZA()),2&e){var i=w.oxw();w.xp6(2),w.Oqu(i.languageService.translate.instant("igo.geo.catalog.externalProvider.unavailableWithEmail",w.WLB(1,Xd,i.addedCatalog.url,i.emailAddress)))}}var eh=function(e){return{value:e}};function th(e,t){if(1&e&&(w.TgZ(0,"span"),w.TgZ(1,"p",20),w._uU(2),w.qZA(),w.qZA()),2&e){var i=w.oxw();w.xp6(2),w.Oqu(i.languageService.translate.instant("igo.geo.catalog.unavailable",w.VKq(1,eh,i.addedCatalog.url)))}}var ih=function(){var e=function(){function e(t,i,o,n,r){m(this,e),this.formBuilder=t,this.languageService=i,this.configService=o,this.dialogRef=n,this.data=r,this.defaultAddedCatalogType="wms",this.predefinedCatalogsList$=new R.X([]),this.predefinedCatalogs=[],this.error=!1,this.store=r.store,this.predefinedCatalogs=r.predefinedCatalogs,this.error=r.error,this.addedCatalog=r.addedCatalog,this.form=this.formBuilder.group({id:["",[]],title:["",[]],url:["",[We.kI.required]],type:[this.defaultAddedCatalogType,[We.kI.required]]})}return y(e,[{key:"ngOnInit",value:function(){var e=this;this.store.state.clear(),this.typeCapabilities=Object.keys(lu),this.addedCatalogType$$=this.form.get("type").valueChanges.subscribe(function(t){"wmts"===t?e.form.get("title").setValidators(We.kI.required):e.form.get("title").setValidators([]),e.form.get("title").updateValueAndValidity()}),this.computePredefinedCatalogList(),this.storeViewAll$$=this.store.view.all$().subscribe(function(){return e.computePredefinedCatalogList()}),this.emailAddress=this.configService.getConfig("emailAddress")}},{key:"ngOnDestroy",value:function(){this.addedCatalogType$$.unsubscribe(),this.storeViewAll$$.unsubscribe()}},{key:"changeUrlOrTitle",value:function(e){this.form.patchValue(e),this.error=!1,this.computePredefinedCatalogList()}},{key:"computePredefinedCatalogList",value:function(){var e=this;this.predefinedCatalogsList$.next(this.predefinedCatalogs.filter(function(t){return!e.store.get(t.id)}))}},{key:"addCatalog",value:function(e){this.error=!1,this.dialogRef.close(e)}},{key:"cancel",value:function(){this.error=!1,this.dialogRef.close()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(We.qu),w.Y36(Ce),w.Y36(he),w.Y36(ut.so),w.Y36(ut.WI,8))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-add-catalog-dialog"]],decls:34,vars:25,consts:[["mat-dialog-title","",1,"mat-typography"],["mat-dialog-content","",1,"mat-typography"],[1,"igo-form",3,"formGroup"],[1,"igo-input-container"],["type","text","formControlName","title","matInput","",3,"placeholder","matAutocomplete"],[3,"optionSelected"],["auto2","matAutocomplete"],["matTooltipShowDelay","500",3,"matTooltip","value",4,"ngFor","ngForOf"],["type","text","formControlName","url","placeholder","URL","matInput","",3,"matAutocomplete"],["auto","matAutocomplete"],["formControlName","type","placeholder","Type"],[3,"value","click",4,"ngFor","ngForOf"],[4,"ngIf"],["mat-dialog-actions","",2,"justify-content","center"],[1,"igo-form-button-group","add-catalog-button-top-padding"],["mat-raised-button","","type","button",3,"click"],["id","addCatalogBtnDialog","mat-raised-button","","type","button","color","primary",3,"disabled","click"],["matTooltipShowDelay","500",3,"matTooltip","value"],[3,"value","click"],["mat-line",""],[1,"error"]],template:function(e,t){if(1&e&&(w.TgZ(0,"h1",0),w._uU(1),w.ALo(2,"translate"),w.qZA(),w.TgZ(3,"div",1),w.TgZ(4,"form",2),w.TgZ(5,"div",3),w.TgZ(6,"mat-form-field"),w._UZ(7,"input",4),w.ALo(8,"translate"),w.TgZ(9,"mat-autocomplete",5,6),w.NdJ("optionSelected",function(e){return t.changeUrlOrTitle(e.option.value)}),w.YNc(11,Vd,2,3,"mat-option",7),w.ALo(12,"async"),w.qZA(),w.qZA(),w.qZA(),w.TgZ(13,"div",3),w.TgZ(14,"mat-form-field"),w._UZ(15,"input",8),w.TgZ(16,"mat-autocomplete",5,9),w.NdJ("optionSelected",function(e){return t.changeUrlOrTitle(e.option.value)}),w.YNc(18,Hd,2,3,"mat-option",7),w.ALo(19,"async"),w.qZA(),w.qZA(),w.qZA(),w.TgZ(20,"div",3),w.TgZ(21,"mat-form-field"),w.TgZ(22,"mat-select",10),w.YNc(23,Wd,3,2,"mat-option",11),w.qZA(),w.qZA(),w.qZA(),w.qZA(),w.YNc(24,Kd,3,4,"span",12),w.YNc(25,th,3,3,"span",12),w.qZA(),w.TgZ(26,"div",13),w.TgZ(27,"div",14),w.TgZ(28,"button",15),w.NdJ("click",function(){return t.cancel()}),w._uU(29),w.ALo(30,"translate"),w.qZA(),w.TgZ(31,"button",16),w.NdJ("click",function(){return t.addCatalog(t.form.value)}),w._uU(32),w.ALo(33,"translate"),w.qZA(),w.qZA(),w.qZA()),2&e){var i=w.MAs(10),o=w.MAs(17);w.xp6(1),w.Oqu(w.lcZ(2,13,"igo.geo.catalog.library.addTitle")),w.xp6(3),w.Q6J("formGroup",t.form),w.xp6(3),w.s9C("placeholder",w.lcZ(8,15,"igo.geo.printForm.title")),w.Q6J("matAutocomplete",i),w.xp6(4),w.Q6J("ngForOf",w.lcZ(12,17,t.predefinedCatalogsList$)),w.xp6(4),w.Q6J("matAutocomplete",o),w.xp6(3),w.Q6J("ngForOf",w.lcZ(19,19,t.predefinedCatalogsList$)),w.xp6(5),w.Q6J("ngForOf",t.typeCapabilities),w.xp6(1),w.Q6J("ngIf",t.error&&t.addedCatalog&&t.emailAddress),w.xp6(1),w.Q6J("ngIf",t.error&&t.addedCatalog&&!t.emailAddress),w.xp6(4),w.hij(" ",w.lcZ(30,21,"igo.geo.catalog.library.cancel")," "),w.xp6(2),w.Q6J("disabled",!t.form.valid),w.xp6(1),w.hij(" ",w.lcZ(33,23,"igo.geo.catalog.library.add")," ")}},directives:[ut.uh,ut.xY,We._Y,We.JL,We.sg,Ye.KE,We.Fj,ot.Nt,tt.ZL,We.JJ,We.u,tt.XC,F.sg,ze.gD,F.O5,ut.H8,S.lW,Ve.ey,L.gM,Ve.X2],pipes:[ae.X$,F.Ov],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}.add-catalog-button-top-padding[_ngcontent-%COMP%]{padding-top:25px}.igo-form[_ngcontent-%COMP%]{padding:10px 5px 5px}.igo-form-button-group[_ngcontent-%COMP%]{text-align:center}button[_ngcontent-%COMP%]{cursor:pointer}button#addCatalogBtnDialog[disabled=true][_ngcontent-%COMP%]{cursor:default;background-color:#0000001f;color:#00000042}.error[_ngcontent-%COMP%]{color:red}"]}),e}();function oh(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"igo-catalog-library-item",3),w.NdJ("catalogRemove",function(){var e=w.CHM(i).$implicit;return w.oxw().onCatalogRemove(e)})("select",function(){var e=w.CHM(i).$implicit;return w.oxw().onCatalogSelect(e)}),w.qZA()}if(2&e){var o=t.$implicit,n=w.oxw();w.Q6J("map",n.map)("catalog",o)}}function nh(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",4),w.TgZ(1,"button",5),w.NdJ("click",function(){return w.CHM(i),w.oxw().addCatalogDialog()}),w.ALo(2,"translate"),w._uU(3),w.ALo(4,"translate"),w._UZ(5,"mat-icon",6),w.qZA(),w.qZA()}2&e&&(w.xp6(1),w.Q6J("matTooltip",w.lcZ(2,2,"igo.geo.catalog.library.addBtn")),w.xp6(2),w.hij(" ",w.lcZ(4,4,"igo.geo.catalog.library.addBtn")," "))}var rh=function(){var e=function(){function e(t,i,o,n,r){m(this,e),this.capabilitiesService=t,this.messageService=i,this.languageService=o,this.storageService=n,this.dialog=r,this.addCatalogAllowed=!1,this.predefinedCatalogs=[],this.catalogSelectChange=new w.vpe,this.submitDisabled=!0}return y(e,[{key:"addedCatalogs",get:function(){return this.storageService.get("addedCatalogs")||[]},set:function(e){this.storageService.set("addedCatalogs",e)}},{key:"ngOnInit",value:function(){this.store.state.clear(),this.predefinedCatalogs=this.predefinedCatalogs.map(function(e){return e.id=ha.V.hashStr((e.type||"wms")+gc(e.url)),e.title=""!==e.title&&e.title?e.title:e.url,e})}},{key:"getCatalogs",value:function(){return this.store.view.all$()}},{key:"onCatalogSelect",value:function(e){this.store.state.update(e,{selected:!0,focused:!0},!0),this.catalogSelectChange.emit({selected:!0,catalog:e})}},{key:"unsubscribeAddingCatalog",value:function(){this.addingCatalog$$&&this.addingCatalog$$.unsubscribe()}},{key:"addCatalog",value:function(e){var t=this;if(e){var i=ha.V.hashStr(e.type+gc(e.url)),o=this.predefinedCatalogs.find(function(t){return t.id===e.id});if(o&&(e.version=o.version,e.externalProvider=o.externalProvider,i=o.id),this.store.get(i)){var n=this.languageService.translate.instant("igo.geo.catalog.library.inlist.title"),r=this.languageService.translate.instant("igo.geo.catalog.library.inlist.message");this.messageService.alert(r,n)}else this.unsubscribeAddingCatalog(),this.addingCatalog$$=this.capabilitiesService.getCapabilities(e.type,e.url,e.version).pipe((0,q.K)(function(i){var o=t.languageService.translate.instant("igo.geo.catalog.unavailableTitle");if(i.error)return t.addCatalogDialog(!0,e),i.error.caught=!0,i;var n=t.languageService.translate.instant("igo.geo.catalog.unavailable",{value:e.url});throw t.messageService.error(n,o),i})).subscribe(function(n){var r,a;switch(e.type){case"wms":r=e.title||n.Service.Title,a=e.version||n.version;break;case"arcgisrest":case"imagearcgisrest":case"tilearcgisrest":r=e.title||n.mapName;break;case"wmts":r=e.title||n.ServiceIdentification.ServiceType;break;default:r=e.title}var s=K.removeUndefined(Object.assign({},o,K.removeUndefined({id:i,title:r,url:e.url,type:e.type||"wms",externalProvider:e.externalProvider||!1,removable:!0,version:a})));t.store.insert(s);var l=t.addedCatalogs.slice(0);l.push(s),t.addedCatalogs=l,t.unsubscribeAddingCatalog()})}}},{key:"ngOnDestroy",value:function(){this.unsubscribeAddingCatalog()}},{key:"onCatalogRemove",value:function(e){this.store.delete(e),this.addedCatalogs=this.addedCatalogs.slice(0).filter(function(t){return t.id!==e.id})}},{key:"addCatalogDialog",value:function(e,t){var i=this;this.dialog.open(ih,{width:"700px",data:{predefinedCatalogs:this.predefinedCatalogs,store:this.store,error:e,addedCatalog:t}}).afterClosed().subscribe(function(e){i.addCatalog(e)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(cu),w.Y36(Ae),w.Y36(Ce),w.Y36(De),w.Y36(ut.uw))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-catalog-library"]],inputs:{store:"store",map:"map",addCatalogAllowed:"addCatalogAllowed",predefinedCatalogs:"predefinedCatalogs"},outputs:{catalogSelectChange:"catalogSelectChange"},decls:4,vars:5,consts:[[3,"navigation"],["ngFor","",3,"ngForOf"],["class","btnAddCatalog",4,"ngIf"],["igoListItem","","color","accent",3,"map","catalog","catalogRemove","select"],[1,"btnAddCatalog"],["mat-raised-button","","matTooltipPosition","above","color","primary",3,"matTooltip","click"],["svgIcon","earth-plus"]],template:function(e,t){1&e&&(w.TgZ(0,"igo-list",0),w.YNc(1,oh,1,2,"ng-template",1),w.ALo(2,"async"),w.qZA(),w.YNc(3,nh,6,6,"div",2)),2&e&&(w.Q6J("navigation",!1),w.xp6(1),w.Q6J("ngForOf",w.lcZ(2,3,t.getCatalogs())),w.xp6(2),w.Q6J("ngIf",t.addCatalogAllowed))},styles:["igo-list[_ngcontent-%COMP%]{height:auto}.btnAddCatalog[_ngcontent-%COMP%]{justify-content:center;display:flex;margin:30px 0}"],changeDetection:0}),e}();function ah(e,t){1&e&&(w.TgZ(0,"mat-icon",4),w.NdJ("click",function(e){return e.stopPropagation()}),w.ALo(1,"translate"),w.qZA()),2&e&&w.Q6J("matTooltip",w.lcZ(1,1,"igo.geo.catalog.externalProvider.catalog"))}function sh(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",5),w.NdJ("click",function(e){return w.CHM(i),w.oxw().removeCatalogFromLibrary(e)}),w.ALo(1,"translate"),w._UZ(2,"mat-icon",6),w.qZA()}2&e&&w.Q6J("matTooltip",w.lcZ(1,1,"igo.geo.catalog.library.remove"))}function lh(e,t){1&e&&(w.TgZ(0,"button",7),w._UZ(1,"mat-icon",8),w.qZA())}var ch=function(){var e=function(){function e(){m(this,e),this.catalogRemove=new w.vpe}return y(e,[{key:"title",get:function(){return St(this.catalog)}},{key:"removeCatalogFromLibrary",value:function(e){e.stopPropagation(),this.catalogRemove.emit()}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-catalog-library-item"]],inputs:{catalog:"catalog",map:"map"},outputs:{catalogRemove:"catalogRemove"},decls:6,vars:4,consts:[["mat-line",""],["class","igo-external-provider","tooltip-position","below","matTooltipShowDelay","500","color","primary","svgIcon","earth-arrow-right",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip","click",4,"ngIf"],["class","igo-blank","disabled","true","mat-icon-button","",4,"ngIf"],["tooltip-position","below","matTooltipShowDelay","500","color","primary","svgIcon","earth-arrow-right",1,"igo-external-provider",3,"matTooltip","click"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip","click"],["svgIcon","delete"],["disabled","true","mat-icon-button","",1,"igo-blank"],["svgIcon","blank"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-list-item"),w.TgZ(1,"h4",0),w._uU(2),w.qZA(),w.YNc(3,ah,2,3,"mat-icon",1),w.YNc(4,sh,3,3,"button",2),w.YNc(5,lh,2,0,"button",3),w.qZA()),2&e&&(w.xp6(2),w.hij(" ",t.title," "),w.xp6(1),w.Q6J("ngIf",t.catalog.externalProvider),w.xp6(1),w.Q6J("ngIf",t.catalog.removable),w.xp6(1),w.Q6J("ngIf",!t.catalog.removable))},directives:[C.Tg,Ve.X2,F.O5,k.Hw,L.gM,S.lW],pipes:[ae.X$],styles:[".igo-blank[_ngcontent-%COMP%]{cursor:pointer}.igo-external-provider[_ngcontent-%COMP%]{cursor:help}"],changeDetection:0}),e}(),uh=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,k.Ps,ct.g,C.ie,L.AV,hn,Se,S.ot,Ye.lN,We.UX,ot.c,ze.LD,tt.Bb,ut.Is]]}),e}();w.B6R(rh,[dn,F.sg,ch,cn,F.O5,S.lW,L.gM,k.Hw],[F.Ov,ae.X$]);var ph=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,ct.g,k.Ps,C.ie,L.AV,ao,hn,ho],zd,uh]}),e}(),dh=function(){var e=function(){function e(){m(this,e)}return y(e,[{key:"transform",value:function(e,t){var i,o=this;return"time"===t&&(i=e.filter(function(e){var t=e.dataSource;return o.isTimeFilterable(t)&&void 0!==t.options.timeFilter&&Object.keys(t.options.timeFilter).length})),"ogc"===t&&(i=e.filter(function(e){return o.isOgcFilterable(e.dataSource)})),i}},{key:"isTimeFilterable",value:function(e){return"wms"===e.options.type&&e.options.timeFilterable}},{key:"isOgcFilterable",value:function(e){var t=!1;return e.options.ogcFilters&&e.options.ogcFilters.enabled&&e.options.ogcFilters.editable&&(t=!0),e.options.ogcFilters&&e.options.ogcFilters.enabled&&(e.options.ogcFilters.pushButtons||e.options.ogcFilters.checkboxes||e.options.ogcFilters.radioButtons||e.options.ogcFilters.select)&&(t=!0),t}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=w.Yjl({name:"filterableDataSource",type:e,pure:!0}),e}(),hh=function(){var e=function(){function e(){m(this,e)}return y(e,[{key:"filterByDate",value:function(e,t){var i,o,n;if(Array.isArray(t)){var r=[];t[0]&&(o=this.reformatDateTime(t[0]),r.push(t[0])),t[1]&&(n=this.reformatDateTime(t[1]),r.push(t[1])),2===r.length&&o!==n&&(i=e instanceof eu?o+","+n:o+"/"+n),o===n&&(i=o)}else t&&(i=this.reformatDateTime(t));e.ol.updateParams({TIME:i}),e instanceof Mc&&e.setTimeFilter(e.timeFilter,!0)}},{key:"filterByYear",value:function(e,t){var i,o,n;if(Array.isArray(t)){var r=[];t[0]&&(o=t[0],r.push(t[0])),t[1]&&(n=t[1],r.push(t[1])),2===r.length&&o!==n&&(i=e instanceof eu?o+","+n:o+"/"+n),o===n&&(i=o)}else i=t;e.ol.updateParams({TIME:i}),e instanceof Mc&&e.setTimeFilter(e.timeFilter,!0)}},{key:"reformatDateTime",value:function(e){var t=e.getFullYear(),i=e.getMonth()+1,o=e.getUTCDate(),n=e.getUTCHours(),r=e.getUTCMinutes();return Number(i)<10&&(i="0"+i),Number(o)<10&&(o="0"+o),Number(n)<10&&(n="0"+n),Number(r)<10&&(r="0"+r),t+"-"+i+"-"+o+"T"+n+":"+r+":00Z"}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac}),e}(),gh=function(){var e=function(){function e(){m(this,e)}return y(e,[{key:"filterByOgc",value:function(e,t){var i=(new bc).formatProcessedOgcFilter(t,e.options.params.LAYERS);e.ol.updateParams({FILTER:i})}},{key:"setOgcWFSFiltersOptions",value:function(e){var t=e.options,i=new bc;t.ogcFilters.enabled&&t.ogcFilters.filters&&(t.ogcFilters.filters=i.checkIgoFiltersProperties(t.ogcFilters.filters,t.paramsWFS.fieldNameGeometry,new qs.Z({code:t.paramsWFS.srsName}),!0),t.ogcFilters.interfaceOgcFilters||(t.ogcFilters.interfaceOgcFilters=i.defineInterfaceFilterSequence(t.ogcFilters.filters,t.paramsWFS.fieldNameGeometry)))}},{key:"setOgcWMSFiltersOptions",value:function(e){var t=e.options,i=new bc;t.ogcFilters.enabled&&t.ogcFilters.filters?(t.ogcFilters.filters=i.checkIgoFiltersProperties(t.ogcFilters.filters,t.fieldNameGeometry,void 0,!0),t.ogcFilters.interfaceOgcFilters||(t.ogcFilters.interfaceOgcFilters=i.defineInterfaceFilterSequence(t.ogcFilters.filters,t.fieldNameGeometry)),this.filterByOgc(e,i.buildFilter(t.ogcFilters.filters,void 0,void 0,void 0,e.options)),t.filtered=!0):(t.ogcFilters.filters=void 0,t.ogcFilters.interfaceOgcFilters=[],t.filtered=!1)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac}),e}(),fh=function(){return(e=fh||(fh={})).Predefined="Predefined",e.Polygon="Polygon",e.Point="Point",fh;var e}(),mh=function(){return(e=mh||(mh={})).Address="Address",e.Thematics="Thematics",mh;var e}(),vh=function(){var e=function(){function e(t,i,o){m(this,e),this.http=t,this.languageService=i,this.configService=o,this.baseUrl="https://geoegl.msp.gouv.qc.ca/apis/terrapi/",this.urlFilterList={AdmRegion:"regadmin",Arrond:"arrondissements",CircFed:"circ-fed",CircProv:"circ-prov",DirReg:"dir-reg",MRC:"mrc",Mun:"municipalites",RegTour:"tourisme",bornes:"bornes-sumi",hydro:"hydro",routes:"routes"},this.baseUrl=this.configService.getConfig("spatialFilter.url")||this.baseUrl}return y(e,[{key:"getKeyByValue",value:function(e,t){return Object.keys(e).find(function(i){return e[i]===t})}},{key:"loadFilterList",value:function(e){if(e)return this.http.get(this.baseUrl+this.urlFilterList[e]).pipe((0,D.U)(function(e){return e.features.map(function(e){return e.meta={id:e.properties.code},e})}))}},{key:"loadThematicsList",value:function(){var e=this,t=[];return this.http.get(this.baseUrl+"types").pipe((0,D.U)(function(i){return i.forEach(function(i){if(i.startsWith("lieux")){var o={name:void 0,source:i},n=i.substring(6,i.length),r=n;if(n.includes(".")){var a=n.indexOf(".");r=n.substring(a+1,n.length),n=n.substring(0,a)}try{o.name=e.languageService.translate.instant("igo.geo.terrapi."+r)}catch(a){o.name=r.substring(0,1).toUpperCase()+r.substring(1,r.length-1)}try{o.group=e.languageService.translate.instant("igo.geo.spatialFilter.group."+n)}catch(a){o.group=n.substring(0,1).toUpperCase()+n.substring(1,r.length-1)}t.push(o)}else if(e.getKeyByValue(e.urlFilterList,i)){var s={name:void 0,source:i},l=e.getKeyByValue(e.urlFilterList,i);try{s.name=e.languageService.translate.instant("igo.geo.terrapi."+l)}catch(r){s.name=l.substring(0,1).toUpperCase()+l.substring(1,l.length-1)}s.source=i,t.push(s)}}),t}))}},{key:"loadFilterItem",value:function(e,t,i,o,n){var r=this;if(i){var a=this.baseUrl+this.urlFilterList[i],s="";return t===mh.Address?(s="adresses",this.http.get(a+"/"+e.properties.code+"/"+s,{params:{geometry:"true",icon:"true",bufferInput:n.toString(),simplified:"100"}}).pipe((0,D.U)(function(e){return e.features.map(function(e){return e.meta={id:e.properties.code,title:r.languageService.translate.instant("igo.geo.spatialFilter.Address"),icon:e.icon},e})}))):(s=o.source,this.http.get(a+"/"+e.properties.code+"/"+s,{params:{geometry:"true",icon:"true",bufferInput:n.toString(),simplified:"100"}}).pipe((0,D.U)(function(e){return e.features.map(function(e){return e.meta={id:e.properties.code,title:o.name,icon:e.icon},e})})))}var l=this.baseUrl+"locate";return t===mh.Address?this.http.post(l+"?type=adresses",{geometry:"true",icon:"true",loc:JSON.stringify(e),bufferInput:n.toString(),simplified:"100"}).pipe((0,D.U)(function(e){return e.features.map(function(e){return e.meta={id:e.properties.code,title:r.languageService.translate.instant("igo.geo.spatialFilter.Address"),icon:e.icon},e})})):this.http.post(l+"?type="+o.source,{geometry:"true",icon:"true",loc:JSON.stringify(e),bufferInput:n.toString(),simplified:"100"}).pipe((0,D.U)(function(e){return e.features.map(function(e){return e.meta={id:e.properties.code,title:o.name,icon:e.icon},e})}))}},{key:"loadItemById",value:function(e,t){var i=this.urlFilterList[t],o="/"+e.properties.code;if(i&&o)return this.http.get(this.baseUrl+i+o,{params:{geometry:"true"}}).pipe((0,D.U)(function(e){return e.meta={id:e.properties.code,alias:e.properties.nom,title:e.properties.nom},e}))}},{key:"loadBufferGeometry",value:function(e,t,i,o){if(t!==fh.Predefined)return this.http.post(this.baseUrl+"geospatial/buffer?",{buffer:i,loc:JSON.stringify(e)}).pipe((0,D.U)(function(e){return e}));var n=this.urlFilterList[o],r="/"+e.properties.code;return n&&r?this.http.get(this.baseUrl+n+r,{params:{geometry:"100",bufferOutput:i.toString()}}).pipe((0,D.U)(function(e){return e.meta={id:e.properties.code,alias:e.properties.nom,title:e.properties.nom},e})):void 0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(P.eN),w.LFG(Ce),w.LFG(he))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),yh=function(){var e=function(){function e(t,i){m(this,e),this.messageService=t,this.languageService=i}return y(e,[{key:"open",value:function(e){var t=this.languageService.translate,i=t.instant("igo.geo.download.title");this.messageService.success(t.instant("igo.geo.download.start"),i);var o=e.dataSource.options;if(Object.keys(o.download).length>0)if(o.download.dynamicUrl&&void 0===o.download.url){var n,r=new qs.Z({code:e.map.projection}),a=e.dataSource.options.paramsWFS;a&&Object.keys(a).length>0?(r=a.srsName?new qs.Z({code:a.srsName}):r,n=e.dataSource.options.paramsWFS):n=e.dataSource.options.params;var s,l=ls.$A(e.map.viewController.getExtent(),new qs.Z({code:e.map.projection}),r),c=void 0===n.outputFormatDownload?void 0===n.outputFormat?"":"outputformat="+n.outputFormat:"outputformat="+n.outputFormatDownload,u=o.download.dynamicUrl.replace(/&?outputformat=[^&]*/gi,"").replace(/&?filter=[^&]*/gi,"").replace(/&?bbox=[^&]*/gi,""),p=e.dataSource.options.ogcFilters;s=(s=(new bc).handleOgcFiltersAppliedValue(e.dataSource.options,p.geometryName,l,r))?"filter="+encodeURIComponent(s):(new bc).buildFilter(void 0,l,r,p.geometryName),window.open("".concat(u,"&").concat(s,"&").concat(c),"_blank")}else o.download&&window.open(o.download.url,"_blank")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(Ae),w.LFG(Ce))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function bh(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",1),w.NdJ("click",function(){w.CHM(i);var e=w.oxw();return e.openDownload(e.layer)}),w.ALo(1,"translate"),w._UZ(2,"mat-icon",2),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("matTooltip",w.lcZ(1,2,"igo.geo.download.action"))("color",o.color)}}var wh=function(){var e=function(){function e(t){m(this,e),this.downloadService=t,this._color="primary"}return y(e,[{key:"layer",get:function(){return this._layer},set:function(e){this._layer=e}},{key:"color",get:function(){return this._color},set:function(e){this._color=e}},{key:"openDownload",value:function(e){this.downloadService.open(e)}},{key:"options",get:function(){if(this.layer)return this.layer.dataSource.options}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(yh))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-download-button"]],inputs:{layer:"layer",color:"color"},decls:1,vars:1,consts:[["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","click"],["svgIcon","download"]],template:function(e,t){1&e&&w.YNc(0,bh,3,4,"button",0),2&e&&w.Q6J("ngIf",t.options&&t.options.download&&(t.options.download.dynamicUrl||t.options.download.url))},directives:[F.O5,S.lW,L.gM,k.Hw],pipes:[ae.X$],styles:[""],changeDetection:0}),e}(),xh=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,k.Ps,S.ot,L.AV,Se]]}),e}();function Sh(e,t){if(1&e&&(w.TgZ(0,"td"),w._UZ(1,"mat-icon",7),w.qZA()),2&e){var i=w.oxw(3);w.xp6(1),w.s9C("svgIcon",i.icon)}}function kh(e,t){if(1&e&&(w.TgZ(0,"td"),w.TgZ(1,"a",8),w._uU(2),w.ALo(3,"translate"),w.qZA(),w.qZA()),2&e){var i=w.oxw().$implicit,o=w.oxw(2);w.xp6(1),w.s9C("href",i.value,w.LSH),w.xp6(1),w.AsE(" ",w.lcZ(3,3,"igo.geo.targetHtmlUrl")," ",o.title,"")}}function Ch(e,t){if(1&e&&(w.TgZ(0,"td",9),w._uU(1),w.qZA()),2&e){var i=w.oxw().$implicit;w.xp6(1),w.hij(" ",i.key," ")}}function Th(e,t){if(1&e&&w._UZ(0,"td",10),2&e){var i=w.oxw().$implicit;w.Q6J("innerHTML",i.value,w.oJD)}}function Ah(e,t){if(1&e&&(w._UZ(0,"img",13),w.ALo(1,"async"),w.ALo(2,"secureImage")),2&e){var i=w.oxw(2).$implicit;w.s9C("src",w.lcZ(1,1,w.lcZ(2,3,i.value)),w.LSH)}}function Lh(e,t){1&e&&(w.TgZ(0,"span"),w._uU(1),w.ALo(2,"translate"),w.qZA()),2&e&&(w.xp6(1),w.hij("",w.lcZ(2,1,"igo.geo.targetHtmlUrl")," "))}function Zh(e,t){if(1&e&&(w.TgZ(0,"td"),w.TgZ(1,"a",8),w.YNc(2,Ah,3,5,"img",11),w.YNc(3,Lh,3,3,"ng-template",null,12,w.W1O),w.qZA(),w.qZA()),2&e){var i=w.MAs(4),o=w.oxw().$implicit,n=w.oxw(2);w.xp6(1),w.s9C("href",o.value,w.LSH),w.xp6(1),w.Q6J("ngIf",n.isImg(o.value))("ngIfElse",i)}}function Fh(e,t){if(1&e&&(w._UZ(0,"td",10),w.ALo(1,"json")),2&e){var i=w.oxw().$implicit;w.Q6J("innerHTML",w.lcZ(1,1,i.value),w.oJD)}}function Oh(e,t){if(1&e&&(w.TgZ(0,"tr"),w.YNc(1,Sh,2,1,"td",4),w.YNc(2,kh,4,5,"td",4),w.YNc(3,Ch,2,1,"td",5),w.YNc(4,Th,1,1,"td",6),w.YNc(5,Zh,5,3,"td",4),w.YNc(6,Fh,2,3,"td",6),w.qZA()),2&e){var i=t.$implicit,o=w.oxw(2);w.xp6(1),w.Q6J("ngIf","_blank"===o.feature.properties.target&&"url"===i.key),w.xp6(1),w.Q6J("ngIf","_blank"===o.feature.properties.target&&"url"===i.key),w.xp6(1),w.Q6J("ngIf",void 0===o.feature.properties.target),w.xp6(1),w.Q6J("ngIf",void 0===o.feature.properties.target&&!o.isObject(i.value)&&!o.isUrl(i.value)),w.xp6(1),w.Q6J("ngIf",void 0===o.feature.properties.target&&!o.isObject(i.value)&&o.isUrl(i.value)),w.xp6(1),w.Q6J("ngIf",void 0===o.feature.properties.target&&o.isObject(i.value))}}function Mh(e,t){if(1&e&&(w.TgZ(0,"table",2),w.TgZ(1,"tbody"),w.YNc(2,Oh,7,6,"tr",3),w.ALo(3,"keyvalue"),w.qZA(),w.qZA()),2&e){var i=w.oxw();w.xp6(2),w.Q6J("ngForOf",w.lcZ(3,1,i.filterFeatureProperties(i.feature)))}}function Ih(e,t){if(1&e&&w._UZ(0,"iframe",14),2&e){var i=w.oxw();w.Q6J("srcdoc",i.htmlSanitizer(i.feature.properties),w.oJD)("src",i.urlSanitizer(i.feature.properties.url),w.uOi)}}var Ph=function(){var e=function(){function e(t,i,o){var n=this;m(this,e),this.cdRef=t,this.sanitizer=i,this.networkService=o,this.unsubscribe$=new Q.xQ,this.ready=!1,this.routeEvent=new w.vpe,this.selectFeature=new w.vpe,this.htmlDisplayEvent=new w.vpe,this.networkService.currentState().pipe((0,na.R)(this.unsubscribe$)).subscribe(function(e){n.state=e})}return y(e,[{key:"source",get:function(){return this._source},set:function(e){this._source=e,this.cdRef.detectChanges()}},{key:"feature",get:function(){return this._feature},set:function(e){this._feature=e,this.cdRef.detectChanges(),this.selectFeature.emit()}},{key:"title",get:function(){return St(this.feature)}},{key:"icon",get:function(){return kt(this.feature)||"link"}},{key:"ngOnInit",value:function(){this.ready=!0}},{key:"ngOnDestroy",value:function(){this.unsubscribe$.next(),this.unsubscribe$.complete()}},{key:"urlSanitizer",value:function(e){return this.sanitizer.bypassSecurityTrustResourceUrl(e)}},{key:"isHtmlDisplay",value:function(){return this.feature&&this.isObject(this.feature.properties)&&"iframe"===this.feature.properties.target?(this.htmlDisplayEvent.emit(!0),!0):(this.htmlDisplayEvent.emit(!1),!1)}},{key:"htmlSanitizer",value:function(e){if(e.body&&"Internet Explorer"!==z.getBrowserName()){if(!/<base href="[\w:\/\.]+">/.test(e.body)){var t=new URL(e.url,window.location.origin);e.body=e.body.replace("<head>",'<head><base href="'.concat(t.origin,'">'))}return this.sanitizer.bypassSecurityTrustHtml(e.body)}}},{key:"isObject",value:function(e){return"object"==typeof e}},{key:"isUrl",value:function(e){return"string"==typeof e&&("https://"===e.slice(0,8)||"http://"===e.slice(0,7))}},{key:"isImg",value:function(e){return!!this.isUrl(e)&&["jpg","png","gif"].includes(e.split(".").pop().toLowerCase())}},{key:"filterFeatureProperties",value:function(e){var t,i=e.meta?e.meta.alias:void 0,o={};return this.map&&this.map.offlineButtonToggle$.pipe((0,na.R)(this.unsubscribe$)).subscribe(function(e){t=e}),e.properties&&e.properties.Route&&this.toolbox&&!this.toolbox.getTool("directions")&&delete e.properties.Route,i?(Object.keys(i).forEach(function(t){o[i[t]]=e.properties[t]}),o):(void 0!==t&&t?e.meta&&e.meta.excludeAttributeOffline&&e.meta.excludeAttributeOffline.forEach(function(t){delete e.properties[t]}):this.state.connection&&e.meta&&e.meta.excludeAttribute?e.meta.excludeAttribute.forEach(function(t){delete e.properties[t]}):!this.state.connection&&e.meta&&e.meta.excludeAttributeOffline&&e.meta.excludeAttributeOffline.forEach(function(t){delete e.properties[t]}),e.properties)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(w.sBO),w.Y36(b.H7),w.Y36(Ee))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-feature-details"]],inputs:{source:"source",map:"map",toolbox:"toolbox",feature:"feature"},outputs:{routeEvent:"routeEvent",selectFeature:"selectFeature",htmlDisplayEvent:"htmlDisplayEvent"},decls:2,vars:2,consts:[["class","igo-striped mat-typography",4,"ngIf"],[3,"srcdoc","src",4,"ngIf"],[1,"igo-striped","mat-typography"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","keyValue",4,"ngIf"],[3,"innerHTML",4,"ngIf"],["mat-list-avatar","",3,"svgIcon"],["target","_blank","rel","noopener noreferrer",3,"href"],["id","keyValue"],[3,"innerHTML"],["width","225","heigth","auto",3,"src",4,"ngIf","ngIfElse"],["notImg",""],["width","225","heigth","auto",3,"src"],[3,"srcdoc","src"]],template:function(e,t){1&e&&(w.YNc(0,Mh,4,3,"table",0),w.YNc(1,Ih,1,2,"iframe",1)),2&e&&(w.Q6J("ngIf",t.ready&&t.feature&&t.isObject(t.feature.properties)&&"iframe"!==t.feature.properties.target),w.xp6(1),w.Q6J("ngIf",t.isHtmlDisplay()))},directives:[F.O5,F.sg,k.Hw],pipes:[sn,ae.X$,F.Ov,$t,F.Ts],styles:["table[_ngcontent-%COMP%]{width:100%}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px}#keyValue[_ngcontent-%COMP%]{width:30%}table[_ngcontent-%COMP%]     .routing{cursor:pointer}iframe[_ngcontent-%COMP%]{height:calc(100% - 4px);width:100%;border:0}"],changeDetection:0}),e}(),_h=function(){return(e=_h||(_h={})).Point="Point",e.LineString="LineString",e.Polygon="Polygon",e.Circle="Circle",_h;var e}();function qh(e){return new xs.Z({stroke:new ws.Z({color:(e=e||[0,153,255]).concat([1]),width:2}),fill:new ys.Z({color:e.concat([.2])}),radius:8})}function Dh(){return new ms.ZP({stroke:new ws.Z({color:[0,153,255,1],width:2})})}function Eh(e){var t=e.target;return t instanceof As.ZP?t.getFlatCoordinates().slice(-4,-2):t.getFlatCoordinates().slice(-2)}Error;var $h=function(){function e(t){m(this,e),this.options=t,this.start$=new Q.xQ,this.end$=new Q.xQ,this.changes$=new Q.xQ,this.modify$=new Q.xQ,this.select$=new Q.xQ,this.abort$=new Q.xQ,this.freehand$=new R.X(!1),this.olDrawingLayer=t.drawingLayer?t.drawingLayer:this.createOlInnerOverlayLayer(),this.olGeometryType=this.options.geometryType}return y(e,[{key:"active",get:function(){return void 0!==this.olMap}},{key:"olDrawingLayerSource",get:function(){return this.olDrawingLayer.getSource()}},{key:"setOlMap",value:function(e,t){if(!e)return this.clearOlInnerOverlaySource(),this.removeOlInnerOverlayLayer(),this.removeOlInteractions(),void(this.olMap=e);this.olMap=e,this.addOlInnerOverlayLayer(),this.addOlInteractions(t)}},{key:"getSource",value:function(){return this.olDrawingLayerSource}},{key:"setGeometryType",value:function(e){this.olGeometryType=e}},{key:"createOlInnerOverlayLayer",value:function(){return new Fs.Z({source:this.options.drawingLayerSource?this.options.drawingLayerSource:new el.Z,style:this.options.drawingLayerStyle,zIndex:500})}},{key:"removeOlInnerOverlayLayer",value:function(){!this.options.drawingLayer&&this.olMap&&this.olMap.removeLayer(this.olDrawingLayer)}},{key:"addOlInnerOverlayLayer",value:function(){this.options.drawingLayer||this.olMap.addLayer(this.olDrawingLayer)}},{key:"clearOlInnerOverlaySource",value:function(){!this.options.drawingLayer&&!this.options.drawingLayerSource&&this.olDrawingLayerSource.clear(!0)}},{key:"addOlInteractions",value:function(e){var t,i=this;if(t=this.freehand$.getValue()?new Zl.ZP("Point"===this.olGeometryType?{type:"Circle",source:this.getSource(),maxPoints:this.options.maxPoints,freehand:!0}:{type:this.olGeometryType,source:this.getSource(),maxPoints:this.options.maxPoints,freehand:!0}):new Zl.ZP({type:this.olGeometryType,source:this.getSource(),stopClick:!0,style:this.options.interactionStyle,maxPoints:this.options.maxPoints,freehand:!1,freehandCondition:function(){return!1}}),this.olMap.addInteraction(t),this.olDrawInteraction=t,this.onDrawStartKey=t.on("drawstart",function(e){return i.onDrawStart(e)}),this.onDrawEndKey=t.on("drawend",function(e){return i.onDrawEnd(e)}),this.onDrawAbortKey=t.on("drawabort",function(e){return i.abort$.next(e.feature.getGeometry())}),e){var o=new Fl.Z({source:this.getSource()});if(this.olMap.addInteraction(o),this.olModifyInteraction=o,!this.olSelectInteraction){var n=new ds.Z({condition:Ol.OK,style:void 0});this.olMap.addInteraction(n),this.olSelectInteraction=n,this.olSelectInteraction.on("select",function(e){return i.onSelect(e)})}}}},{key:"removeOlInteractions",value:function(){this.unsubscribeKeyDown(),(0,Os.B)([this.onDrawStartKey,this.onDrawEndKey,this.onDrawKey,this.onDrawAbortKey]),this.olMap&&(this.olMap.removeInteraction(this.olDrawInteraction),this.olMap.removeInteraction(this.olModifyInteraction)),this.olDrawInteraction=void 0,this.olModifyInteraction=void 0}},{key:"onDrawStart",value:function(e){var t=this,i=e.feature.getGeometry();this.start$.next(i),this.clearOlInnerOverlaySource(),this.onDrawKey=i.on("change",function(e){t.mousePosition=Eh(e),t.changes$.next(e.target)}),this.subscribeKeyDown()}},{key:"onDrawEnd",value:function(e){var t=this;this.unsubscribeKeyDown(),(0,Os.B)(this.onDrawKey);var i=e.feature.getGeometry();i.on("change",function(){t.modify$.next(i)}),this.end$.next(i)}},{key:"onSelect",value:function(e){1===e.selected.length&&this.select$.next(e.selected[0])}},{key:"subscribeKeyDown",value:function(){var e=this;this.unsubscribeKeyDown(),this.keyDown$$=(0,B.R)(document,"keydown").subscribe(function(t){"Escape"!==t.key?("Backspace"===t.key&&e.olDrawInteraction.removeLastPoint(),"Enter"===t.key&&e.olDrawInteraction.finishDrawing()," "!==t.key||e.olMap.getView().animate({center:e.mousePosition,duration:100})):e.olDrawInteraction.abortDrawing()})}},{key:"unsubscribeKeyDown",value:function(){this.keyDown$$&&(this.keyDown$$.unsubscribe(),this.keyDown$$=void 0)}}]),e}(),Rh=function(){var e=function(){function e(t,i){m(this,e),this.dialogRef=t,this.data=i}return y(e,[{key:"noLabel",value:function(){this.dialogRef.close()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(ut.so),w.Y36(ut.WI))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-draw-popup-component"]],decls:14,vars:11,consts:[["mat-dialog-content",""],[1,"mat-typography"],[1,"example-full-width"],["matInput","",3,"placeholder","value"],["input",""],["mat-dialog-actions",""],["mat-raised-button","",3,"click"],["mat-raised-button","","color","primary",3,"mat-dialog-close"]],template:function(e,t){if(1&e&&(w.TgZ(0,"div",0),w.TgZ(1,"p",1),w._uU(2),w.ALo(3,"translate"),w.qZA(),w.TgZ(4,"mat-form-field",2),w._UZ(5,"input",3,4),w.ALo(7,"translate"),w.qZA(),w.qZA(),w.TgZ(8,"div",5),w.TgZ(9,"button",6),w.NdJ("click",function(){return t.noLabel()}),w._uU(10),w.ALo(11,"translate"),w.qZA(),w.TgZ(12,"button",7),w._uU(13,"OK "),w.qZA(),w.qZA()),2&e){var i=w.MAs(6);w.xp6(2),w.Oqu(w.lcZ(3,5,"igo.geo.draw.dialogInstruction")),w.xp6(3),w.s9C("placeholder",w.lcZ(7,7,"igo.geo.draw.dialogTitle")),w.s9C("value",t.data.currentLabel),w.xp6(5),w.hij("",w.lcZ(11,9,"igo.geo.draw.noLabel")," "),w.xp6(2),w.Q6J("mat-dialog-close",i.value)}},directives:[ut.xY,Ye.KE,ot.Nt,ut.H8,S.lW,ut.ZT],pipes:[ae.X$],styles:[""]}),e}(),Nh=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-draw-shorcuts"]],decls:24,vars:12,consts:[[1,"shortcut","mat-typography"],["svgIcon","keyboard-return",1,"shortcut-icon"],["svgIcon","backspace-outline",1,"shortcut-icon"],["svgIcon","keyboard-esc",1,"shortcut-icon"],["svgIcon","keyboard-space",1,"shortcut-icon"],[1,"shortcuts-close"],["mat-raised-button","","mat-dialog-close","","color","primary"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-dialog-content"),w.TgZ(1,"div"),w.TgZ(2,"span",0),w._UZ(3,"mat-icon",1),w._uU(4),w.ALo(5,"translate"),w.qZA(),w.qZA(),w.TgZ(6,"div"),w.TgZ(7,"span",0),w._UZ(8,"mat-icon",2),w._uU(9),w.ALo(10,"translate"),w.qZA(),w.qZA(),w.TgZ(11,"div"),w.TgZ(12,"span",0),w._UZ(13,"mat-icon",3),w._uU(14),w.ALo(15,"translate"),w.qZA(),w.qZA(),w.TgZ(16,"div"),w.TgZ(17,"span",0),w._UZ(18,"mat-icon",4),w._uU(19),w.ALo(20,"translate"),w.qZA(),w.qZA(),w.qZA(),w.TgZ(21,"mat-dialog-actions",5),w.TgZ(22,"button",6),w._uU(23,"OK"),w.qZA(),w.qZA()),2&e&&(w.xp6(4),w.Oqu(w.lcZ(5,4,"igo.geo.draw.finish")),w.xp6(5),w.Oqu(w.lcZ(10,6,"igo.geo.draw.undo")),w.xp6(5),w.Oqu(w.lcZ(15,8,"igo.geo.draw.abort")),w.xp6(5),w.Oqu(w.lcZ(20,10,"igo.geo.draw.move")))},directives:[ut.xY,k.Hw,ut.H8,S.lW,ut.ZT],pipes:[ae.X$],styles:[".shortcut[_ngcontent-%COMP%]{display:flex;align-items:center}.shortcut-icon[_ngcontent-%COMP%]{margin-right:10px}.shortcuts-close[_ngcontent-%COMP%]{display:flex;justify-content:center}"]}),e}(),Uh=function(){return(e=Uh||(Uh={})).Length="length",e.Area="area",Uh;var e}(),Jh=function(){return(e=Jh||(Jh={})).Meters="meters",e.Kilometers="kilometers",e.Miles="miles",e.Feet="feet",Jh;var e}(),Bh=(u(g={},Jh.Meters,"m"),u(g,Jh.Kilometers,"km"),u(g,Jh.Miles,"mi"),u(g,Jh.Feet,"ft"),g),jh=function(){return(e=jh||(jh={})).SquareMeters="squareMeters",e.SquareKilometers="squareKilometers",e.SquareMiles="squareMiles",e.SquareFeet="squareFeet",e.Hectares="hectares",e.Acres="acres",jh;var e}(),Qh=(u(f={},jh.SquareMeters,"m\xb2"),u(f,jh.SquareKilometers,"km\xb2"),u(f,jh.SquareMiles,"mi\xb2"),u(f,jh.SquareFeet,"ft\xb2"),u(f,jh.Hectares,"ha"),u(f,jh.Acres,"ac"),f);function Gh(e){return.001*e}function Yh(e){return 3.2808*e}function zh(e){return 621e-6*e}function Vh(e){return 1e-6*e}function Hh(e){return 3.861e-7*e}function Wh(e){return 10.764*e}function Xh(e){return 1e-4*e}function Kh(e){return 24711e-8*e}function eg(e,t){var i=new Map([[Jh.Meters,function(e){return e}],[Jh.Kilometers,Gh],[Jh.Miles,zh],[Jh.Feet,Yh]]).get(t);return i?i(e):void 0}function tg(e,t){var i=new Map([[jh.SquareMeters,function(e){return e}],[jh.SquareKilometers,Vh],[jh.SquareMiles,Hh],[jh.SquareFeet,Wh],[jh.Hectares,Xh],[jh.Acres,Kh]]).get(t);return i?i(e):void 0}function ig(e,t,i){var o=t.decimal;(void 0===o||o<0)&&(o=1);var n=[];return n.push(void 0!==t.locale?e.toLocaleString(t.locale,{minimumFractionDigits:o,maximumFractionDigits:o}):e.toFixed(o).toString()),void 0!==t.unit&&!0===t.unitAbbr&&n.push(i?i.translate.instant(Bh[t.unit]?"igo.geo.measure."+Bh[t.unit]:"igo.geo.measure."+Qh[t.unit]):Bh[t.unit]||Qh[t.unit]),n.filter(function(e){return void 0!==e}).join(" ")}function og(){return new ms.ZP({stroke:new ws.Z({color:"#ffcc33",lineDash:[10,10],width:2}),fill:new ys.Z({color:"rgba(255, 255, 255, 0.2)"}),image:new xs.Z({radius:5,stroke:new ws.Z({color:"#ffcc33"}),fill:new ys.Z({color:"rgba(255, 255, 255, 0.2)"})})})}function ng(e,t){if(!(e instanceof us.Z)&&0!==e.getFlatCoordinates().length)return(0,Ml.xA)(e,{projection:t})}function rg(e,t){for(var i=ng(e,t),o=function(e,t){if(!(e instanceof us.Z||e instanceof Ls.Z)&&0!==e.getFlatCoordinates().length)return(0,Ml.bg)(e,{projection:t})}(e,t),n=[],r=e.getFlatCoordinates(),a=r.length,s=0;s<=a-4;s+=2){var l=new Ls.Z([[r[s],r[s+1]],[r[s+2],r[s+3]]]);n.push(ng(l,t))}return{area:o,length:i,lengths:n}}function ag(e){var t;if(e instanceof us.Z){var i=new us.Z(e.getFlatCoordinates());(t=new Array(1))[0]=i}else{t=sg(e);for(var o=e.getFlatCoordinates(),n=t.length,r=0;r<n;r++){var a=2*r,s=new Ls.Z([[o[a],o[a+1]],[o[a+2],o[a+3]]]).getCoordinateAt(.5),l=t[r];void 0!==l?l.setCoordinates(s):t[r]=new us.Z(s)}}return t}function sg(e){var t,i;i=e instanceof gs.Z?0:Math.max(e.getFlatCoordinates().length/2-1,0);var o=e.get("_midpoints");if(void 0===o)return o=new Array(e instanceof us.Z?1:i),e.set("_midpoints",o,!0),o;if(0===i||i===o.length)return o;if(i>o.length)return(t=o).push.apply(t,d(new Array(i-o.length))),o;for(var n=i;n<o.length;n++){var r=o[i];void 0!==r&&lg(r)}return o.splice(i),o}function lg(e){var t=e.get("_tooltip");if(void 0!==t){var i=t.getMap();void 0!==i&&i.removeOverlay(t)}}function cg(e){var t=[].concat(function(e){return sg(e).map(function(e){return e?e.get("_tooltip"):void 0})}(e)||[]),i=function(e){var t=e.get("_center");return t?t.get("_tooltip"):void 0}(e);return void 0!==i&&t.push(i),t}function ug(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=new Il.Z({element:document.createElement("div"),offset:[-30,-10],className:(t?["igo-map-tooltip","igo-map-tooltip-measure","igo-map-tooltip-measure-area"]:["igo-map-tooltip","igo-map-tooltip-measure","igo-map-tooltip-measure-".concat(i,"segments")]).join(" "),stopEvent:!1});return o.setPosition(e.getFlatCoordinates()),e.set("_tooltip",o),o}function pg(e,t,i,o){return new ms.ZP({stroke:new ws.Z({color:t||"rgba(143,7,7,1)",width:i||1}),fill:new ys.Z({color:e||"rgba(255,255,255,0.4)"}),image:new xs.Z({radius:5,stroke:new ws.Z({color:t||"rgba(143,7,7,1)",width:i||1}),fill:new ys.Z({color:e||"rgba(255,255,255,0.4)"})})})}var dg=function(){var e=function(){function e(t){m(this,e),this.mapService=t,this.fillColor="rgba(255,255,255,0.4)",this.strokeColor="rgba(143,7,7,1)",this.strokeWidth=1,this.labelsAreShown=!0}return y(e,[{key:"getFillColor",value:function(){return this.fillColor}},{key:"setFillColor",value:function(e){this.fillColor=e}},{key:"getStrokeColor",value:function(){return this.strokeColor}},{key:"setStrokeColor",value:function(e){this.strokeColor=e}},{key:"getStrokeWidth",value:function(){return this.strokeWidth}},{key:"getLabelsAreShown",value:function(){return this.labelsAreShown}},{key:"toggleLabelsAreShown",value:function(){this.labelsAreShown=!this.labelsAreShown}},{key:"setIcon",value:function(e){this.icon=e}},{key:"getIcon",value:function(){return this.icon}},{key:"createDrawingLayerStyle",value:function(e,t,i,o){var n=!1,r=this.mapService.getMap().projection;if(e.getGeometry()instanceof us.Z&&(n=!n),e.get("rad")){var a=(0,ls.vs)(e.getGeometry().flatCoordinates,r,"EPSG:4326");return new ms.ZP({text:new vs.Z({text:i?e.get("draw"):"",stroke:new ws.Z({color:"white",width:.75}),fill:new ys.Z({color:"black"}),font:"20px sans-serif",overflow:!0}),image:new xs.Z({radius:e.get("rad")/Math.cos(Math.PI/180*a[1])/t,stroke:new ws.Z({color:this.strokeColor,width:this.strokeWidth}),fill:new ys.Z({color:this.fillColor})})})}return o?new ms.ZP({text:new vs.Z({text:i?e.get("draw"):"",offsetY:-26,stroke:new ws.Z({color:"white",width:.75}),fill:new ys.Z({color:"black"}),font:"20px sans-serif",overflow:!0}),stroke:new ws.Z({color:this.strokeColor,width:this.strokeWidth}),fill:new ys.Z({color:this.fillColor}),image:new bs.Z({src:o})}):new ms.ZP({text:new vs.Z({text:i?e.get("draw"):"",stroke:new ws.Z({color:"white",width:.75}),fill:new ys.Z({color:"black"}),font:"20px sans-serif",overflow:!0,offsetY:n?-15:0}),stroke:new ws.Z({color:this.strokeColor,width:this.strokeWidth}),fill:new ys.Z({color:this.fillColor}),image:new xs.Z({radius:5,stroke:new ws.Z({color:this.strokeColor,width:this.strokeWidth}),fill:new ys.Z({color:this.fillColor})})})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(su))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),hg=function(){var e=function(){function e(t){m(this,e),this.config=t,this.getIconsList()}return y(e,[{key:"getIcons",value:function(){return this.icons}},{key:"getPath",value:function(){return this.config.getConfig("drawingTool.icons")||[]}},{key:"getIconsList",value:function(){this.icons=this.getPath()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(he))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function gg(e,t){if(1&e&&(w.TgZ(0,"div",24),w._UZ(1,"img",25),w.qZA()),2&e){var i=w.oxw(2);w.xp6(1),w.s9C("src",i.icon,w.LSH)}}function fg(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-option",26),w.NdJ("click",function(){var e=w.CHM(i).$implicit;return w.oxw(2).onIconChange(e)}),w.TgZ(1,"div",24),w._UZ(2,"img",25),w.qZA(),w.qZA()}if(2&e){var o=t.$implicit;w.Q6J("value",o),w.xp6(2),w.s9C("src",o,w.LSH)}}function mg(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-form-field"),w.TgZ(1,"mat-label"),w._uU(2),w.ALo(3,"translate"),w.qZA(),w.TgZ(4,"mat-select"),w.TgZ(5,"mat-select-trigger"),w.YNc(6,gg,2,1,"div",21),w.qZA(),w.TgZ(7,"mat-option",22),w.NdJ("click",function(){return w.CHM(i),w.oxw().onIconChange()}),w._uU(8),w.ALo(9,"translate"),w.qZA(),w.YNc(10,fg,3,2,"mat-option",23),w.qZA(),w.qZA()}if(2&e){var o=w.oxw();w.xp6(2),w.Oqu(w.lcZ(3,4,"igo.geo.draw.icon")),w.xp6(4),w.Q6J("ngIf",o.icon),w.xp6(2),w.Oqu(w.lcZ(9,6,"igo.geo.draw.noIcon")),w.xp6(2),w.Q6J("ngForOf",o.icons)}}function vg(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",27),w.NdJ("click",function(){return w.CHM(i),w.oxw().deleteDrawings()}),w.ALo(1,"translate"),w.ALo(2,"async"),w._UZ(3,"mat-icon",28),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("matTooltip",w.lcZ(1,2,"igo.geo.draw.delete"))("disabled",0===w.lcZ(2,4,o.selectedFeatures$).length)}}var yg=function(){var e=function(){function e(t,i,o,n,r){m(this,e),this.languageService=t,this.formBuilder=i,this.drawStyleService=o,this.dialog=n,this.drawIconService=r,this.tableTemplate={selection:!0,selectMany:!0,selectionCheckbox:!0,sort:!0,columns:[{name:"Drawing",title:this.languageService.translate.instant("igo.geo.draw.labels"),valueAccessor:function(e){return e.properties.draw}}]},this.geometryType=_h,this.draw$=new R.X({}),this.olDrawingLayerSource=new el.Z,this.selectedFeatures$=new R.X([]),this.drawControlIsDisabled=!0,this.drawControlIsActive=!1,this.subscriptions$$=[],this.position="bottom",this.buildForm(),this.fillColor=this.drawStyleService.getFillColor(),this.strokeColor=this.drawStyleService.getStrokeColor(),this.strokeWidth=this.drawStyleService.getStrokeWidth(),this.labelsAreShown=this.drawStyleService.getLabelsAreShown(),this.icons=this.drawIconService.getIcons(),this.icon=this.drawStyleService.getIcon()}return y(e,[{key:"ngOnInit",value:function(){this.initStore(),this.drawControl=this.createDrawControl(this.fillColor,this.strokeColor,this.strokeWidth),this.drawControl.setGeometryType(this.geometryType.Point),this.toggleDrawControl()}},{key:"ngOnDestroy",value:function(){this.drawControl.setOlMap(void 0),this.subscriptions$$.map(function(e){return e.unsubscribe()})}},{key:"createDrawControl",value:function(e,t,i){return new $h({geometryType:void 0,drawingLayerSource:this.olDrawingLayerSource,drawingLayerStyle:new ms.ZP({}),interactionStyle:pg(e,t,i)})}},{key:"onGeometryTypeChange",value:function(e){this.drawControl.setGeometryType(e),this.toggleDrawControl()}},{key:"initStore",value:function(){var e=this;this.map.removeLayer(this.olDrawingLayer),this.olDrawingLayer=new jc({isIgoInternalLayer:!0,id:"igo-draw-layer",title:this.languageService.translate.instant("igo.geo.draw.drawing"),zIndex:200,source:new _c,style:function(t,i){return e.drawStyleService.createDrawingLayerStyle(t,i,e.labelsAreShown,e.icon)},showInLayerList:!0,exportable:!0,browsable:!1,workspace:{enabled:!1}}),vu(this.store,this.olDrawingLayer),Tu(this.store,new xu({motion:tc.None})),Au(this.store,new Cu({map:this.map,motion:tc.None,many:!0})),this.store.layer.visible=!0,this.store.source.ol.on("removefeature",function(t){var i=t.feature.getGeometry();e.clearLabelsOfOlGeometry(i)}),this.subscriptions$$.push(this.store.stateView.manyBy$(function(e){return!0===e.state.selected}).pipe((0,Be.T)(1)).subscribe(function(t){e.selectedFeatures$.next(t.map(function(e){return e.entity}))})),this.subscriptions$$.push(this.store.count$.subscribe(function(t){e.store.layer.options.showInLayerList=t>=1}))}},{key:"onColorChange",value:function(e,t){var i=this;this.fillForm=this.fillColor,this.strokeForm=this.strokeColor,this.drawStyleService.setFillColor(this.fillColor),this.drawStyleService.setStrokeColor(this.strokeColor),t?(this.store.layer.ol.setStyle(function(t,o){return i.drawStyleService.createDrawingLayerStyle(t,o,e,i.icon)}),this.icon=void 0):this.store.layer.ol.setStyle(function(t,o){return i.drawStyleService.createDrawingLayerStyle(t,o,e)}),this.createDrawControl()}},{key:"onToggleDrawControl",value:function(e){e?this.toggleDrawControl():this.deactivateDrawControl()}},{key:"toggleDrawControl",value:function(){this.deactivateDrawControl(),this.activateDrawControl()}},{key:"openDialog",value:function(e,t){var i=this;setTimeout(function(){i.dialog.open(Rh,{disableClose:!1,data:{currentLabel:e.get("draw")}}).afterClosed().subscribe(function(o){i.updateLabelOfOlGeometry(e,o),t?i.onDrawEnd(e):i.onSelectDraw(e,o)})},250)}},{key:"activateDrawControl",value:function(){var e=this;this.drawControlIsDisabled=!1,this.drawControlIsActive=!0,this.drawEnd$$=this.drawControl.end$.subscribe(function(t){e.openDialog(t,!0)}),this.drawControl.modify$.subscribe(function(t){e.onModifyDraw(t)}),this.drawSelect$$||(this.drawSelect$$=this.drawControl.select$.subscribe(function(t){e.openDialog(t,!1)})),this.drawControl.setOlMap(this.map.ol,!0)}},{key:"deactivateDrawControl",value:function(){!this.drawControl||(this.drawEnd$$&&this.drawEnd$$.unsubscribe(),this.drawControl.setOlMap(void 0),this.drawControlIsActive=!1)}},{key:"onDrawEnd",value:function(e,t){this.addFeatureToStore(e,t),this.clearLabelsOfOlGeometry(e),this.store.layer.ol.getSource().refresh()}},{key:"onModifyDraw",value:function(e){var t=this;this.store.all().forEach(function(i){i.properties.id===e.ol_uid&&(t.updateLabelOfOlGeometry(e,i.properties.draw),t.replaceFeatureInStore(i,e))})}},{key:"onSelectDraw",value:function(e,t){var i=this,o=this.store.all(),n=e.getGeometry();n.ol_uid=e.get("id");var r=JSON.stringify(n.getCoordinates()[0]);o.forEach(function(e){var o=JSON.stringify(e.geometry.coordinates[0]);if(r===o){var a=e.properties.rad?e.properties.rad:void 0;i.updateLabelOfOlGeometry(n,t),i.replaceFeatureInStore(e,n,a)}})}},{key:"addFeatureToStore",value:function(e,t,i){var o,n,r,a,s,l=i?i.properties.id:e.ol_uid,c=this.map.ol.getView().getProjection(),u=(new Zs.Z).writeGeometryObject(e,{featureProjection:c,dataProjection:c});if(e instanceof gs.Z||t)if(t)o=t;else{u.type="Point",u.coordinates=e.getCenter();var p=(0,ls.vs)([e.getFlatCoordinates()[2],e.getFlatCoordinates()[3]],c,"EPSG:4326");a=(n=(0,ls.vs)([e.getFlatCoordinates()[0],e.getFlatCoordinates()[1]],c,"EPSG:4326"))[0],s=n[1],o=(0,Ml.Sp)(n,p)}e instanceof us.Z&&(a=(r=(0,ls.vs)(e.getFlatCoordinates(),c,"EPSG:4326"))[0],s=r[1]),this.store.update({type:ec,geometry:u,projection:c.getCode(),properties:{id:l,draw:e.get("_label"),longitude:a||null,latitude:s||null,rad:o||null},meta:{id:l}})}},{key:"replaceFeatureInStore",value:function(e,t,i){this.store.delete(e),this.onDrawEnd(t,i)}},{key:"buildForm",value:function(){this.form=this.formBuilder.group({fill:[""],stroke:[""]})}},{key:"deleteDrawings",value:function(){var e=this;this.store.deleteMany(this.selectedFeatures$.value),this.selectedFeatures$.value.forEach(function(t){e.olDrawingLayerSource.getFeatures().forEach(function(i){var o=i.getGeometry();t.properties.id===o.ol_uid&&e.olDrawingLayerSource.removeFeature(i)})})}},{key:"clearLabelsOfOlGeometry",value:function(e){var t=this;cg(e).forEach(function(e){e&&e.getMap()&&t.map.ol.removeOverlay(e)})}},{key:"onToggleLabels",value:function(){this.drawStyleService.toggleLabelsAreShown(),this.labelsAreShown=!this.labelsAreShown,this.onColorChange(this.labelsAreShown,!!this.icon)}},{key:"updateLabelOfOlGeometry",value:function(e,t){e.setProperties({_label:t},!0)}},{key:"onIconChange",value:function(e){var t=this;this.icon=e,this.drawStyleService.setIcon(this.icon),this.store.layer.ol.setStyle(function(e,i){return t.drawStyleService.createDrawingLayerStyle(e,i,!0,t.icon)})}},{key:"openShorcutsDialog",value:function(){this.dialog.open(Nh)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ce),w.Y36(We.qu),w.Y36(dg),w.Y36(ut.uw),w.Y36(hg))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-draw"]],inputs:{map:"map",store:"store"},outputs:{fillColor:"fillColor",strokeColor:"strokeColor",strokeWidth:"strokeWidth"},decls:55,vars:78,consts:[[1,"geometry-type-toggle","mat-typography"],[3,"value","change"],[3,"value"],[1,"draw-options","mat-typography"],[3,"disabled","checked","labelPosition","change"],[3,"checked","labelPosition","change"],[1,"igo-form",3,"formGroup"],[1,"fill-color-picker","mat-typography"],["svgIcon","square",1,"stroke-palette-icon"],["appearance","outline","floatLabel","always","tooltip-position","below","matTooltipShowDelay","500",1,"fill-field",3,"matTooltip"],["formControlName","fill","matInput","","type","text",3,"colorPicker","readonly","cpWidth","cpOutputFormat","cpPosition","cpPositionOffset","cpCancelButton","cpCancelButtonText","cpOKButton","colorPickerChange"],[1,"stroke-color-picker","mat-typography"],["svgIcon","square-outline",1,"stroke-palette-icon"],["appearance","outline","floatLabel","always","tooltip-position","below","matTooltipShowDelay","500",1,"stroke-field",3,"matTooltip"],["formControlName","stroke","matInput","","type","text",3,"colorPicker","readonly","cpWidth","cpPosition","cpPositionOffset","cpOutputFormat","cpCancelButton","cpCancelButtonText","cpOKButton","colorPickerChange"],[4,"ngIf"],["class","deleteBtn","mat-icon-button","","color","warn","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","disabled","click",4,"ngIf"],[1,"table-compact",3,"store","template"],["table",""],["mat-icon-button","","color","accent","disableRipple","true",3,"click"],["svgIcon","keyboard-outline","tooltip-position","below","matTooltipShowDelay","500",1,"shortcuts-icon",3,"matTooltip"],["class","box",4,"ngIf"],["value","",3,"click"],[3,"value","click",4,"ngFor","ngForOf"],[1,"box"],[3,"src"],[3,"value","click"],["mat-icon-button","","color","warn","tooltip-position","below","matTooltipShowDelay","500",1,"deleteBtn",3,"matTooltip","disabled","click"],["svgIcon","delete"]],template:function(e,t){1&e&&(w.TgZ(0,"div"),w.TgZ(1,"div",0),w.TgZ(2,"mat-button-toggle-group",1),w.NdJ("change",function(e){return t.onGeometryTypeChange(e.value)}),w.TgZ(3,"mat-button-toggle",2),w._uU(4),w.ALo(5,"translate"),w.qZA(),w.TgZ(6,"mat-button-toggle",2),w._uU(7),w.ALo(8,"translate"),w.qZA(),w.TgZ(9,"mat-button-toggle",2),w._uU(10),w.ALo(11,"translate"),w.qZA(),w.TgZ(12,"mat-button-toggle",2),w._uU(13),w.ALo(14,"translate"),w.qZA(),w.qZA(),w.qZA(),w.TgZ(15,"div",3),w.TgZ(16,"mat-slide-toggle",4),w.NdJ("change",function(e){return t.onToggleDrawControl(e.checked)}),w._uU(17),w.ALo(18,"translate"),w.qZA(),w.TgZ(19,"mat-slide-toggle",5),w.NdJ("change",function(){return t.onToggleLabels()}),w._uU(20),w.ALo(21,"translate"),w.qZA(),w.qZA(),w.TgZ(22,"form",6),w.TgZ(23,"div",7),w.TgZ(24,"span"),w._UZ(25,"mat-icon",8),w._uU(26),w.ALo(27,"translate"),w.qZA(),w.TgZ(28,"mat-form-field",9),w.ALo(29,"translate"),w.TgZ(30,"mat-label"),w._uU(31),w.qZA(),w.TgZ(32,"input",10),w.NdJ("colorPickerChange",function(e){return t.fillColor=e})("colorPickerChange",function(){return t.onColorChange(t.labelsAreShown,!1)}),w.ALo(33,"translate"),w.qZA(),w.qZA(),w.qZA(),w.TgZ(34,"div",11),w.TgZ(35,"span"),w._UZ(36,"mat-icon",12),w._uU(37),w.ALo(38,"translate"),w.qZA(),w.TgZ(39,"mat-form-field",13),w.ALo(40,"translate"),w.TgZ(41,"mat-label"),w._uU(42),w.qZA(),w.TgZ(43,"input",14),w.NdJ("colorPickerChange",function(e){return t.strokeColor=e})("colorPickerChange",function(){return t.onColorChange(t.labelsAreShown,!1)}),w.ALo(44,"translate"),w.qZA(),w.qZA(),w.qZA(),w.TgZ(45,"div"),w.YNc(46,mg,11,8,"mat-form-field",15),w.qZA(),w.qZA(),w._UZ(47,"mat-divider"),w.TgZ(48,"div"),w.YNc(49,vg,4,6,"button",16),w._UZ(50,"igo-entity-table",17,18),w.qZA(),w.TgZ(52,"button",19),w.NdJ("click",function(){return t.openShorcutsDialog()}),w._UZ(53,"mat-icon",20),w.ALo(54,"translate"),w.qZA(),w.qZA()),2&e&&(w.xp6(2),w.Q6J("value",t.geometryType.Point),w.xp6(1),w.Q6J("value",t.geometryType.Point),w.xp6(1),w.hij(" ",w.lcZ(5,52,"igo.geo.draw."+t.geometryType.Point)," "),w.xp6(2),w.Q6J("value",t.geometryType.LineString),w.xp6(1),w.hij(" ",w.lcZ(8,54,"igo.geo.draw."+t.geometryType.LineString)," "),w.xp6(2),w.Q6J("value",t.geometryType.Polygon),w.xp6(1),w.hij(" ",w.lcZ(11,56,"igo.geo.draw."+t.geometryType.Polygon)," "),w.xp6(2),w.Q6J("value",t.geometryType.Circle),w.xp6(1),w.hij(" ",w.lcZ(14,58,"igo.geo.draw."+t.geometryType.Circle)," "),w.xp6(3),w.Q6J("disabled",t.drawControlIsDisabled)("checked",t.drawControlIsActive)("labelPosition","before"),w.xp6(1),w.hij(" ",w.lcZ(18,60,"igo.geo.spatialFilter.drawControl")," "),w.xp6(2),w.Q6J("checked",t.labelsAreShown)("labelPosition","before"),w.xp6(1),w.hij(" ",w.lcZ(21,62,"igo.geo.draw.toggleMapTooltips")," "),w.xp6(2),w.Q6J("formGroup",t.form),w.xp6(4),w.hij(" ",w.lcZ(27,64,"igo.geo.draw.fill")," "),w.xp6(2),w.Q6J("matTooltip",w.lcZ(29,66,"igo.geo.draw.colorPicker")),w.xp6(3),w.Oqu(t.fillColor),w.xp6(1),w.Udp("background",t.fillColor),w.Q6J("colorPicker",t.fillColor)("readonly",!0)("colorPicker",t.fillColor)("cpWidth","200px")("cpOutputFormat","rgba")("cpPosition","bottom")("cpPositionOffset","-75%")("cpCancelButton",!0)("cpCancelButtonText",w.lcZ(33,68,"igo.geo.draw.cancelColorPicker"))("cpOKButton",!0),w.xp6(5),w.hij(" ",w.lcZ(38,70,"igo.geo.draw.stroke")," "),w.xp6(2),w.Q6J("matTooltip",w.lcZ(40,72,"igo.geo.draw.colorPicker")),w.xp6(3),w.Oqu(t.strokeColor),w.xp6(1),w.Udp("background",t.strokeColor),w.Q6J("colorPicker",t.strokeColor)("readonly",!0)("colorPicker",t.strokeColor)("cpWidth","200px")("cpPosition","bottom")("cpPositionOffset","-75%")("cpOutputFormat","rgba")("cpCancelButton",!0)("cpCancelButtonText",w.lcZ(44,74,"igo.geo.draw.cancelColorPicker"))("cpOKButton",!0),w.xp6(3),w.Q6J("ngIf",t.icons.length>=1),w.xp6(3),w.Q6J("ngIf",t.store.count$.getValue()>0),w.xp6(1),w.Q6J("store",t.store)("template",t.tableTemplate),w.xp6(3),w.Q6J("matTooltip",w.lcZ(54,76,"igo.geo.draw.shortcuts")))},directives:[Al.A9,Al.Yi,Cl.Rr,We._Y,We.JL,We.sg,k.Hw,Ye.KE,L.gM,Ye.hX,We.Fj,ot.Nt,We.JJ,We.u,Ll.Kk,F.O5,kl.d,Ei,S.lW,ze.gD,ze.$L,Ve.ey,F.sg],pipes:[ae.X$,F.Ov],styles:[".geometry-type-toggle[_ngcontent-%COMP%]{padding:10px;text-align:center}.geometry-type-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]{width:100%}.geometry-type-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]{width:25%}.draw-options[_ngcontent-%COMP%]{overflow-x:hidden}.draw-options[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{width:100%;margin:10px}.draw-options[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content{width:calc(100% - 60px)}.igo-form[_ngcontent-%COMP%]{padding:10px}.fill-field[_ngcontent-%COMP%], .stroke-field[_ngcontent-%COMP%]{width:130px}.fill-color-picker[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{position:relative;top:7px}.fill-color-picker[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{left:8px}.stroke-color-picker[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{position:relative;top:7px}.stroke-color-picker[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{left:35px}.box[_ngcontent-%COMP%]{width:25px;height:25px}img[_ngcontent-%COMP%]{width:100%;height:100%}.deleteBtn[_ngcontent-%COMP%]{margin-left:12px}"],changeDetection:0}),e}(),bg=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[We.u5,We.UX,F.ez,S.ot,Al.vV,kl.t,Ye.lN,k.Ps,L.AV,Ye.lN,ot.c,C.ie,ze.LD,Cl.rP,ut.Is,Se,Wo,Ll.e4]]}),e}(),wg=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,k.Ps,Se,ln,Ho]]}),e}(),xg=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,Go],Go]}),e}(),Sg=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({providers:[],imports:[[F.ez],wg,xg]}),e}(),kg=function(){function e(t){m(this,e),this.options=t,this.start$=new Q.xQ,this.end$=new Q.xQ,this.changes$=new Q.xQ,this.olModifyInteractionIsActive=!1,this.olTranslateInteractionIsActive=!1,this.olDrawInteractionIsActive=!1,this.removedOlInteractions=[],this.modify=!0,this.translate=!0,void 0!==t.modify&&(this.modify=t.modify),void 0!==t.translate&&(this.translate=t.translate),this.olOverlayLayer=void 0!==t.layer?t.layer:this.createOlInnerOverlayLayer(),this.olLinearRingsLayer=this.createOlLinearRingsLayer()}return y(e,[{key:"active",get:function(){return void 0!==this.olMap}},{key:"olOverlaySource",get:function(){return this.olOverlayLayer.getSource()}},{key:"olLinearRingsSource",get:function(){return this.olLinearRingsLayer.getSource()}},{key:"setOlMap",value:function(e){if(void 0===e)return this.clearOlInnerOverlaySource(),this.removeOlInnerOverlayLayer(),this.removeOlModifyInteraction(),this.removeOlTranslateInteraction(),this.removeOlDrawInteraction(),void(this.olMap=e);this.olMap=e,this.addOlInnerOverlayLayer(),!0===this.modify&&this.addOlDrawInteraction(),!0===this.translate&&(this.addOlTranslateInteraction(),this.activateTranslateInteraction()),!0===this.modify&&(this.addOlModifyInteraction(),this.activateModifyInteraction())}},{key:"getSource",value:function(){return this.olOverlaySource}},{key:"setOlGeometry",value:function(e){var t=new ns.Z({geometry:e});this.olOverlaySource.clear(),this.olOverlaySource.addFeature(t)}},{key:"createOlInnerOverlayLayer",value:function(){return new Fs.Z({source:this.options.source?this.options.source:new el.Z,style:this.options.layerStyle,zIndex:500})}},{key:"addOlInnerOverlayLayer",value:function(){void 0===this.options.layer&&this.olMap.addLayer(this.olOverlayLayer)}},{key:"removeOlInnerOverlayLayer",value:function(){void 0===this.options.layer&&void 0!==this.olMap&&this.olMap.removeLayer(this.olOverlayLayer)}},{key:"clearOlInnerOverlaySource",value:function(){void 0===this.options.layer&&void 0===this.options.source&&this.olOverlaySource.clear(!0)}},{key:"createOlLinearRingsLayer",value:function(){return new Fs.Z({source:new el.Z,style:Dh(),zIndex:500})}},{key:"addOlLinearRingsLayer",value:function(){this.olMap.addLayer(this.olLinearRingsLayer)}},{key:"removeOlLinearRingsLayer",value:function(){this.olMap.removeLayer(this.olLinearRingsLayer)}},{key:"clearOlLinearRingsSource",value:function(){this.olLinearRingsSource.clear(!0)}},{key:"addOlModifyInteraction",value:function(){var e=new Fl.Z({source:this.olOverlaySource,style:this.options.drawStyle});this.olModifyInteraction=e}},{key:"removeOlModifyInteraction",value:function(){void 0!==this.olModifyInteraction&&(this.deactivateModifyInteraction(),this.olModifyInteraction=void 0)}},{key:"activateModifyInteraction",value:function(){var e=this;!0!==this.olModifyInteractionIsActive&&(this.olModifyInteractionIsActive=!0,this.onModifyStartKey=this.olModifyInteraction.on("modifystart",function(t){return e.onModifyStart(t)}),this.onModifyEndKey=this.olModifyInteraction.on("modifyend",function(t){return e.onModifyEnd(t)}),this.olMap.addInteraction(this.olModifyInteraction))}},{key:"deactivateModifyInteraction",value:function(){!1!==this.olModifyInteractionIsActive&&(this.olModifyInteractionIsActive=!1,(0,Os.B)([this.onModifyStartKey,this.onModifyEndKey,this.onModifyKey]),void 0!==this.olMap&&this.olMap.removeInteraction(this.olModifyInteraction))}},{key:"onModifyStart",value:function(e){var t=this,i=e.features.item(0).getGeometry();this.start$.next(i),this.onModifyKey=i.on("change",function(e){t.mousePosition=Eh(e),t.changes$.next(e.target)}),this.subscribeToKeyDown()}},{key:"onModifyEnd",value:function(e){(0,Os.B)(this.onModifyKey),this.end$.next(e.features.item(0).getGeometry()),this.unsubscribeToKeyDown()}},{key:"subscribeToKeyDown",value:function(){var e=this;this.keyDown$$=(0,B.R)(document,"keydown").subscribe(function(t){" "!==t.key||e.olMap.getView().animate({center:e.mousePosition,duration:0})})}},{key:"unsubscribeToKeyDown",value:function(){void 0!==this.keyDown$$&&this.keyDown$$.unsubscribe()}},{key:"addOlTranslateInteraction",value:function(){var e=new hs.Z({layers:[this.olOverlayLayer]});this.olTranslateInteraction=e}},{key:"removeOlTranslateInteraction",value:function(){void 0!==this.olTranslateInteraction&&(this.deactivateTranslateInteraction(),this.olTranslateInteraction=void 0)}},{key:"activateTranslateInteraction",value:function(){var e=this;!0!==this.olTranslateInteractionIsActive&&(this.olTranslateInteractionIsActive=!0,this.onTranslateStartKey=this.olTranslateInteraction.on("translatestart",function(t){return e.onTranslateStart(t)}),this.onTranslateEndKey=this.olTranslateInteraction.on("translateend",function(t){return e.onTranslateEnd(t)}),this.olMap.addInteraction(this.olTranslateInteraction))}},{key:"deactivateTranslateInteraction",value:function(){!1!==this.olTranslateInteractionIsActive&&(this.olTranslateInteractionIsActive=!1,(0,Os.B)([this.onTranslateStartKey,this.onTranslateEndKey,this.onTranslateKey]),void 0!==this.olMap&&this.olMap.removeInteraction(this.olTranslateInteraction))}},{key:"onTranslateStart",value:function(e){var t=e.features.item(0).getGeometry();this.start$.next(t),this.onTranslateKey=t.on("change",function(e){})}},{key:"onTranslateEnd",value:function(e){(0,Os.B)(this.onTranslateKey),this.end$.next(e.features.item(0).getGeometry())}},{key:"addOlDrawInteraction",value:function(){var e=this,t=new Zl.ZP({type:"Polygon",source:this.olLinearRingsSource,stopClick:!0,style:Dh(),condition:function(t){return(e.olOuterGeometry||e.getOlGeometry()).intersectsCoordinate(t.coordinate)}});this.olDrawInteraction=t,this.subscribeToDrawKeyDown()}},{key:"subscribeToDrawKeyDown",value:function(){var e=this;this.drawKeyDown$$=(0,B.R)(document,"keydown").subscribe(function(t){if("Control"===t.key){e.unsubscribeToDrawKeyDown();var i=e.getOlGeometry();!i||!(i instanceof As.ZP)||(e.subscribeToDrawKeyUp(),e.deactivateModifyInteraction(),e.deactivateTranslateInteraction(),e.activateDrawInteraction())}})}},{key:"subscribeToDrawKeyUp",value:function(){var e=this;this.drawKeyUp$$=(0,B.R)(document,"keyup").subscribe(function(t){"Control"===t.key&&(e.unsubscribeToDrawKeyUp(),e.unsubscribeToKeyDown(),e.deactivateDrawInteraction(),e.activateModifyInteraction(),!0===e.translate&&e.activateTranslateInteraction(),e.subscribeToDrawKeyDown(),e.olOuterGeometry=void 0,e.clearOlLinearRingsSource(),e.end$.next(e.getOlGeometry()))})}},{key:"unsubscribeToDrawKeyDown",value:function(){void 0!==this.drawKeyDown$$&&this.drawKeyDown$$.unsubscribe()}},{key:"unsubscribeToDrawKeyUp",value:function(){void 0!==this.drawKeyUp$$&&this.drawKeyUp$$.unsubscribe()}},{key:"removeOlDrawInteraction",value:function(){void 0!==this.olDrawInteraction&&(this.unsubscribeToKeyDown(),this.unsubscribeToDrawKeyUp(),this.unsubscribeToDrawKeyDown(),this.deactivateDrawInteraction(),this.clearOlLinearRingsSource(),this.olDrawInteraction=void 0)}},{key:"activateDrawInteraction",value:function(){var e=this;!0!==this.olDrawInteractionIsActive&&(this.clearOlLinearRingsSource(),this.addOlLinearRingsLayer(),this.olMap.getInteractions().forEach(function(t){t instanceof gl.Z&&(e.olMap.removeInteraction(t),e.removedOlInteractions.push(t))}),this.olDrawInteractionIsActive=!0,this.onDrawStartKey=this.olDrawInteraction.on("drawstart",function(t){return e.onDrawStart(t)}),this.onDrawEndKey=this.olDrawInteraction.on("drawend",function(t){return e.onDrawEnd(t)}),this.olMap.addInteraction(this.olDrawInteraction))}},{key:"deactivateDrawInteraction",value:function(){var e=this;!1!==this.olDrawInteractionIsActive&&(this.removeOlLinearRingsLayer(),this.removedOlInteractions.forEach(function(t){e.olMap.addInteraction(t)}),this.removedOlInteractions=[],this.olDrawInteractionIsActive=!1,(0,Os.B)([this.onDrawStartKey,this.onDrawEndKey,this.onDrawKey]),void 0!==this.olMap&&this.olMap.removeInteraction(this.olDrawInteraction))}},{key:"onDrawStart",value:function(e){var t=this,i=e.feature.getGeometry();this.olOuterGeometry=this.getOlGeometry().clone();var o=i.getLinearRing().getCoordinates();this.addLinearRingToOlGeometry(o),this.start$.next(this.getOlGeometry()),this.onDrawKey=i.on("change",function(e){t.mousePosition=Eh(e);var i=e.target.getLinearRing(0).getCoordinates();t.updateLinearRingOfOlGeometry(i),t.changes$.next(t.getOlGeometry())}),this.subscribeToKeyDown()}},{key:"onDrawEnd",value:function(e){(0,Os.B)(this.onDrawKey),this.olOuterGeometry=void 0;var t=e.feature.getGeometry().getLinearRing().getCoordinates();this.updateLinearRingOfOlGeometry(t),this.clearOlLinearRingsSource(),this.end$.next(this.getOlGeometry()),this.unsubscribeToKeyDown()}},{key:"addLinearRingToOlGeometry",value:function(e){!function(e,t){e.appendLinearRing(t)}(this.getOlGeometry(),new $l.Z(e))}},{key:"updateLinearRingOfOlGeometry",value:function(e){var t=this.getOlGeometry(),i=t.getLinearRings().slice(0,-1).map(function(e){return e.getCoordinates()});i.push(e),t.setCoordinates(i)}},{key:"getOlGeometry",value:function(){var e=this.olOverlaySource.getFeatures();return e.length>0?e[0].getGeometry():void 0}}]),e}(),Cg="Layer";function Tg(e,t){if(1&e&&(w.TgZ(0,"table",2),w.TgZ(1,"thead"),w.TgZ(2,"tr"),w.TgZ(3,"th",3),w._uU(4),w.ALo(5,"translate"),w.qZA(),w.qZA(),w.qZA(),w.TgZ(6,"tbody"),w.TgZ(7,"tr"),w.TgZ(8,"td"),w._uU(9),w.ALo(10,"measureFormat"),w.qZA(),w.TgZ(11,"td"),w._uU(12),w.ALo(13,"translate"),w.qZA(),w.qZA(),w.TgZ(14,"tr"),w.TgZ(15,"td"),w._uU(16),w.ALo(17,"measureFormat"),w.qZA(),w.TgZ(18,"td"),w._uU(19),w.ALo(20,"translate"),w.qZA(),w.qZA(),w.TgZ(21,"tr"),w.TgZ(22,"td"),w._uU(23),w.ALo(24,"measureFormat"),w.qZA(),w.TgZ(25,"td"),w._uU(26),w.ALo(27,"translate"),w.qZA(),w.qZA(),w.TgZ(28,"tr"),w.TgZ(29,"td"),w._uU(30),w.ALo(31,"measureFormat"),w.qZA(),w.TgZ(32,"td"),w._uU(33),w.ALo(34,"translate"),w.qZA(),w.qZA(),w.qZA(),w.qZA()),2&e){var i=w.oxw();w.xp6(4),w.Oqu(w.lcZ(5,9,"igo.geo.measure.dialog.length.title")),w.xp6(5),w.Oqu(w.xi3(10,11,i.data.length,i.measureLengthUnit.Meters)),w.xp6(3),w.Oqu(w.lcZ(13,14,"igo.geo.measure.dialog.lengthInMeters")),w.xp6(4),w.Oqu(w.xi3(17,16,i.data.length,i.measureLengthUnit.Kilometers)),w.xp6(3),w.Oqu(w.lcZ(20,19,"igo.geo.measure.dialog.lengthInKilometers")),w.xp6(4),w.Oqu(w.xi3(24,21,i.data.length,i.measureLengthUnit.Miles)),w.xp6(3),w.Oqu(w.lcZ(27,24,"igo.geo.measure.dialog.lengthInMiles")),w.xp6(4),w.Oqu(w.xi3(31,26,i.data.length,i.measureLengthUnit.Feet)),w.xp6(3),w.Oqu(w.lcZ(34,29,"igo.geo.measure.dialog.lengthInFeet"))}}function Ag(e,t){if(1&e&&(w.TgZ(0,"table",2),w.TgZ(1,"thead"),w.TgZ(2,"tr"),w.TgZ(3,"th",3),w._uU(4),w.ALo(5,"translate"),w.qZA(),w.qZA(),w.qZA(),w.TgZ(6,"tbody"),w.TgZ(7,"tr"),w.TgZ(8,"td"),w._uU(9),w.ALo(10,"measureFormat"),w.qZA(),w.TgZ(11,"td"),w._uU(12),w.ALo(13,"translate"),w.qZA(),w.qZA(),w.TgZ(14,"tr"),w.TgZ(15,"td"),w._uU(16),w.ALo(17,"measureFormat"),w.qZA(),w.TgZ(18,"td"),w._uU(19),w.ALo(20,"translate"),w.qZA(),w.qZA(),w.TgZ(21,"tr"),w.TgZ(22,"td"),w._uU(23),w.ALo(24,"measureFormat"),w.qZA(),w.TgZ(25,"td"),w._uU(26),w.ALo(27,"translate"),w.qZA(),w.qZA(),w.TgZ(28,"tr"),w.TgZ(29,"td"),w._uU(30),w.ALo(31,"measureFormat"),w.qZA(),w.TgZ(32,"td"),w._uU(33),w.ALo(34,"translate"),w.qZA(),w.qZA(),w.TgZ(35,"tr"),w.TgZ(36,"td"),w._uU(37),w.ALo(38,"measureFormat"),w.qZA(),w.TgZ(39,"td"),w._uU(40),w.ALo(41,"translate"),w.qZA(),w.qZA(),w.TgZ(42,"tr"),w.TgZ(43,"td"),w._uU(44),w.ALo(45,"translate"),w.qZA(),w.TgZ(46,"td"),w._uU(47),w.ALo(48,"measureFormat"),w.qZA(),w.qZA(),w.qZA(),w.qZA()),2&e){var i=w.oxw();w.xp6(4),w.Oqu(w.lcZ(5,13,"igo.geo.measure.dialog.area.title")),w.xp6(5),w.Oqu(w.xi3(10,15,i.data.area,i.measureAreaUnit.SquareMeters)),w.xp6(3),w.Oqu(w.lcZ(13,18,"igo.geo.measure.dialog.areaInSquareMeters")),w.xp6(4),w.Oqu(w.xi3(17,20,i.data.area,i.measureAreaUnit.SquareKilometers)),w.xp6(3),w.Oqu(w.lcZ(20,23,"igo.geo.measure.dialog.areaInSquareKilometers")),w.xp6(4),w.Oqu(w.xi3(24,25,i.data.area,i.measureAreaUnit.SquareMiles)),w.xp6(3),w.Oqu(w.lcZ(27,28,"igo.geo.measure.dialog.areaInSquareMiles")),w.xp6(4),w.Oqu(w.xi3(31,30,i.data.area,i.measureAreaUnit.Acres)),w.xp6(3),w.Oqu(w.lcZ(34,33,"igo.geo.measure.dialog.areaInAcres")),w.xp6(4),w.Oqu(w.xi3(38,35,i.data.area,i.measureAreaUnit.Hectares)),w.xp6(3),w.Oqu(w.lcZ(41,38,"igo.geo.measure.dialog.areaInHectares")),w.xp6(4),w.Oqu(w.lcZ(45,40,"igo.geo.measure.dialog.perimeterInMeters")),w.xp6(3),w.Oqu(w.xi3(48,42,i.data.perimeter,i.measureLengthUnit.Meters))}}var Lg=function(){var e=function(){function e(t,i){m(this,e),this.dialogRef=t,this.data=i,this.measureAreaUnit=jh,this.measureLengthUnit=Jh}return y(e,[{key:"onNoClick",value:function(){this.dialogRef.close()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(ut.so),w.Y36(ut.WI))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-measurer-dialog"]],decls:5,vars:5,consts:[["mat-dialog-title",""],["class","mat-typography",4,"ngIf"],[1,"mat-typography"],["colspan","2"]],template:function(e,t){1&e&&(w.TgZ(0,"h3",0),w._uU(1),w.ALo(2,"translate"),w.qZA(),w.YNc(3,Tg,35,31,"table",1),w.YNc(4,Ag,49,45,"table",1)),2&e&&(w.xp6(1),w.Oqu(w.lcZ(2,3,"igo.geo.measure.dialog.title")),w.xp6(2),w.Q6J("ngIf",t.data.length>0),w.xp6(1),w.Q6J("ngIf",t.data.area>0))},styles:['[_nghost-%COMP%]{font-family:Roboto,"Helvetica Neue",sans-serif}h3[_ngcontent-%COMP%]{text-align:center;margin:0}table[_ngcontent-%COMP%]{width:100%;padding:10px}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{padding-left:10px}']}),e}(),Zg=["table"];function Fg(e,t){1&e&&w._UZ(0,"mat-divider")}function Og(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-slide-toggle",7),w.NdJ("change",function(e){return w.CHM(i),w.oxw().onToggleDisplayLines(e.checked)}),w._uU(1),w.ALo(2,"translate"),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("checked",o.displayLines)("labelPosition","before"),w.xp6(1),w.hij(" ",w.lcZ(2,3,"igo.geo.measure.toggleDisplayLines")," ")}}function Mg(e,t){1&e&&w._UZ(0,"mat-divider")}function Ig(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-slide-toggle",7),w.NdJ("change",function(e){return w.CHM(i),w.oxw().onToggleDisplayDistance(e.checked)}),w._uU(1),w.ALo(2,"translate"),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("checked",o.displayDistance)("labelPosition","before"),w.xp6(1),w.hij(" ",w.lcZ(2,3,"igo.geo.measure.toggleDisplayDistance")," ")}}function Pg(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-slide-toggle",7),w.NdJ("change",function(e){return w.CHM(i),w.oxw().onToggleDisplayAreas(e.checked)}),w._uU(1),w.ALo(2,"translate"),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("checked",o.displayAreas)("labelPosition","before"),w.xp6(1),w.hij(" ",w.lcZ(2,3,"igo.geo.measure.toggleDisplayAreas")," ")}}function _g(e,t){1&e&&w._UZ(0,"mat-divider")}function qg(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"igo-measurer-item",14),w.NdJ("measureUnitChange",function(e){return w.CHM(i),w.oxw(2).onLengthUnitChange(e)}),w.ALo(1,"translate"),w.qZA()}if(2&e){var o=w.oxw().ngIf,n=w.oxw();w.Q6J("measureType",n.measureType.Length)("measureUnit",n.measureLengthUnit.Meters)("measure",o.length)("auto",n.measureUnitsAuto)("placeholder",w.lcZ(1,5,n.activeMeasureType===n.measureType.Area?"igo.geo.measure.perimeter":"igo.geo.measure.length"))}}function Dg(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"igo-measurer-item",14),w.NdJ("measureUnitChange",function(e){return w.CHM(i),w.oxw(2).onAreaUnitChange(e)}),w.ALo(1,"translate"),w.qZA()}if(2&e){var o=w.oxw().ngIf,n=w.oxw();w.Q6J("measureType",n.measureType.Area)("measureUnit",n.measureAreaUnit.SquareMeters)("measure",o.area)("auto",n.measureUnitsAuto)("placeholder",w.lcZ(1,5,"igo.geo.measure.area"))}}function Eg(e,t){if(1&e&&(w.ynx(0),w.YNc(1,qg,2,7,"igo-measurer-item",13),w.YNc(2,Dg,2,7,"igo-measurer-item",13),w.BQk()),2&e){var i=w.oxw();w.xp6(1),w.Q6J("ngIf",i.activeMeasureType===i.measureType.Length||i.activeMeasureType===i.measureType.Area),w.xp6(1),w.Q6J("ngIf",i.activeMeasureType===i.measureType.Area)}}function $g(e,t){1&e&&w._UZ(0,"mat-divider")}function Rg(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",15),w.NdJ("click",function(){return w.CHM(i),w.oxw().onCalculateClick()}),w.ALo(1,"translate"),w.ALo(2,"async"),w._UZ(3,"mat-icon",16),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("matTooltip",w.lcZ(1,2,"igo.geo.measure.actionbar.calculate.tooltip"))("disabled",0===w.lcZ(2,4,o.selectedFeatures$).length)}}function Ng(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",17),w.NdJ("click",function(){return w.CHM(i),w.oxw().onDeleteClick()}),w.ALo(1,"translate"),w.ALo(2,"async"),w._UZ(3,"mat-icon",18),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("matTooltip",w.lcZ(1,2,"igo.geo.measure.actionbar.delete.tooltip"))("disabled",0===w.lcZ(2,4,o.selectedFeatures$).length)}}var Ug=function(){var e=function(){function e(t,i,o){var n=this;m(this,e),this.languageService=t,this.dialog=i,this.storageService=o,this.tableTemplate={selection:!0,selectMany:!0,selectionCheckbox:!0,sort:!0,columns:[{name:"length",title:this.languageService.translate.instant("igo.geo.measure.lengthHeader"),valueAccessor:function(e){var t=n.activeLengthUnit;return ig(eg(e.properties.measure.length,t),{decimal:1,unit:t,unitAbbr:!1,locale:"fr"})}},{name:"area",title:this.languageService.translate.instant("igo.geo.measure.areaHeader"),valueAccessor:function(e){var t=n.activeAreaUnit,i=tg(e.properties.measure.area,t);return i?ig(i,{decimal:1,unit:t,unitAbbr:!1,locale:"fr"}):""}}]},this.subscriptions$$=[],this.measureType=Uh,this.measureAreaUnit=jh,this.measureLengthUnit=Jh,this.measureUnitsAuto=!1,this.displayDistance=!0,this.displayLines=!0,this.displayAreas=!0,this.hasLine$=new R.X(!1),this.hasArea$=new R.X(!1),this.measure$=new R.X({}),this.selectedFeatures$=new R.X([]),this.showTooltips=!0,this.drawControlIsDisabled=!0,this.activeLengthUnit=Jh.Meters,this.activeAreaUnit=jh.SquareMeters,this.olDrawSource=new el.Z,this.minSegmentLength=10}return y(e,[{key:"activeMeasureType",get:function(){return this._activeMeasureType},set:function(e){this.setActiveMeasureType(e)}},{key:"drawControlIsActive",get:function(){return void 0!==this.activeDrawControl}},{key:"projection",get:function(){return this.map.ol.getView().getProjection().getCode()}},{key:"ngOnInit",value:function(){this.initStore(),this.createDrawLineControl(),this.createDrawPolygonControl(),this.createModifyControl(),this.toggleDrawControl(),this.updateTooltipsOfOlSource(this.store.source.ol),this.checkDistanceAreaToggle(),this.setActiveMeasureType(Uh.Length)}},{key:"ngOnDestroy",value:function(){this.setActiveMeasureType(void 0),this.deactivateModifyControl(),this.freezeStore(),this.subscriptions$$.map(function(e){return e.unsubscribe()})}},{key:"onMeasureTypeChange",value:function(e){this.activeMeasureType=e}},{key:"onToggleDrawControl",value:function(e){!0===e?this.toggleDrawControl():this.deactivateDrawControl()}},{key:"onToggleMeasureUnitsAuto",value:function(e){this.measureUnitsAuto=e}},{key:"onToggleDisplayDistance",value:function(e){this.displayDistance=e,this.onDisplayDistance(),this.storageService.set("distanceToggle",!!e,_e.SESSION)}},{key:"onToggleDisplayLines",value:function(e){this.displayLines=e,this.onDisplayLines(),this.storageService.set("linesToggle",!!e,_e.SESSION)}},{key:"onToggleDisplayAreas",value:function(e){this.displayAreas=e,this.onDisplayAreas(),this.storageService.set("areasToggle",!!e,_e.SESSION)}},{key:"checkDistanceAreaToggle",value:function(){!1===this.storageService.get("distanceToggle")&&(this.displayDistance=!1),!1===this.storageService.get("linesToggle")&&(this.displayLines=!1),!1===this.storageService.get("areasToggle")&&(this.displayAreas=!1)}},{key:"onDisplayDistance",value:function(){this.displayDistance?Array.from(document.getElementsByClassName("igo-map-tooltip-measure-polygone-segments")).map(function(e){return e.classList.remove("igo-map-tooltip-hidden")}):Array.from(document.getElementsByClassName("igo-map-tooltip-measure-polygone-segments")).map(function(e){return e.classList.add("igo-map-tooltip-hidden")})}},{key:"onDisplayLines",value:function(){this.displayLines?Array.from(document.getElementsByClassName("igo-map-tooltip-measure-line-segments")).map(function(e){return e.classList.remove("igo-map-tooltip-hidden")}):Array.from(document.getElementsByClassName("igo-map-tooltip-measure-line-segments")).map(function(e){return e.classList.add("igo-map-tooltip-hidden")})}},{key:"onDisplayAreas",value:function(){this.displayAreas?Array.from(document.getElementsByClassName("igo-map-tooltip-measure-area")).map(function(e){return e.classList.remove("igo-map-tooltip-hidden")}):Array.from(document.getElementsByClassName("igo-map-tooltip-measure-area")).map(function(e){return e.classList.add("igo-map-tooltip-hidden")})}},{key:"onLengthUnitChange",value:function(e){this.activeLengthUnit=e,this.table.refresh(),this.updateTooltipsOfOlSource(this.store.source.ol),void 0!==this.activeOlGeometry&&this.updateTooltipsOfOlGeometry(this.activeOlGeometry)}},{key:"onAreaUnitChange",value:function(e){this.activeAreaUnit=e,this.table.refresh(),this.updateTooltipsOfOlSource(this.store.source.ol),void 0!==this.activeOlGeometry&&this.updateTooltipsOfOlGeometry(this.activeOlGeometry)}},{key:"onCalculateClick",value:function(){var e=this.selectedFeatures$.value,t=e.reduce(function(e,t){return e+t.properties.measure.area||0},0),i=e.reduce(function(e,t){return"Polygon"===t.geometry.type?e:e+t.properties.measure.length||0},0),o=e.reduce(function(e,t){return"LineString"===t.geometry.type?e:e+t.properties.measure.length||0},0);this.openDialog({area:t,length:i,perimeter:o})}},{key:"onDeleteClick",value:function(){var e=this;this.store.deleteMany(this.selectedFeatures$.value),this.selectedFeatures$.value.forEach(function(t){e.olDrawSource.getFeatures().forEach(function(i){var o=i.getGeometry();t.properties.id===o.ol_uid&&e.olDrawSource.removeFeature(i)})})}},{key:"onModifyClick",value:function(){if(1===this.selectedFeatures$.value.length)if(!0===this.modifyControl.active)this.deactivateModifyControl(),this.toggleDrawControl();else{var e=this.selectedFeatures$.value[0],t=this.store.layer.ol.getSource().getFeatures().find(function(t){return t.get("id")===e.properties.id});if(void 0!==t){this.deactivateDrawControl(),this.activateModifyControl();var i=t.getGeometry();this.clearTooltipsOfOlGeometry(i),this.modifyControl.setOlGeometry(i)}}}},{key:"openDialog",value:function(e){this.dialog.open(Lg,{data:e})}},{key:"initStore",value:function(){var e=this,t=this.store,i=new jc({title:this.languageService.translate.instant("igo.geo.measure.layerTitle"),isIgoInternalLayer:!0,id:"igo-measures-".concat(oe()),zIndex:200,source:new _c,style:new ms.ZP({stroke:new ws.Z({color:"#ffcc33",width:2}),fill:new ys.Z({color:"rgba(255, 255, 255, 0.2)"})}),showInLayerList:!0,exportable:!0,browsable:!1,workspace:{enabled:!1}});vu(t,i),t.layer.visible=!0,i.visible$.subscribe(function(e){e?Array.from(document.getElementsByClassName("igo-map-tooltip-measure")).map(function(e){return e.classList.remove("igo-map-tooltip-measure-by-display")}):Array.from(document.getElementsByClassName("igo-map-tooltip-measure")).map(function(e){return e.classList.add("igo-map-tooltip-measure-by-display")})}),Tu(t),Au(t,new Cu({map:this.map,many:!0})),this.onFeatureAddedKey=t.source.ol.on("addfeature",function(t){var i=t.feature,o=i.getGeometry();e.updateMeasureOfOlGeometry(o,i.get("measure")),e.onDisplayDistance()}),this.onFeatureRemovedKey=t.source.ol.on("removefeature",function(t){var i=t.feature.getGeometry();e.clearTooltipsOfOlGeometry(i)}),this.selectedFeatures$$=t.stateView.manyBy$(function(e){return!0===e.state.selected}).pipe((0,Be.T)(1)).subscribe(function(t){!0===e.modifyControl.active&&e.deactivateModifyControl(),e.selectedFeatures$.next(t.map(function(e){return e.entity}))}),this.subscriptions$$.push(this.store.entities$.subscribe(function(t){t.find(function(e){return"Polygon"===e.geometry.type})?e.hasArea$.next(!0):e.hasArea$.next(!1),t.find(function(e){return"LineString"===e.geometry.type})?e.hasLine$.next(!0):e.hasLine$.next(!1)})),this.subscriptions$$.push(this.store.count$.subscribe(function(t){e.store.layer.options.showInLayerList=t>=1}))}},{key:"freezeStore",value:function(){var e=this.store;this.selectedFeatures$$.unsubscribe(),(0,Os.B)(this.onFeatureAddedKey),(0,Os.B)(this.onFeatureRemovedKey),e.deactivateStrategyOfType(xu),e.deactivateStrategyOfType(Cu)}},{key:"createDrawLineControl",value:function(){this.drawLineControl=new $h({geometryType:"LineString",drawingLayerSource:this.olDrawSource,interactionStyle:og(),drawingLayerStyle:new ms.ZP({})})}},{key:"createDrawPolygonControl",value:function(){this.drawPolygonControl=new $h({geometryType:"Polygon",drawingLayerSource:this.olDrawSource,interactionStyle:og(),drawingLayerStyle:new ms.ZP({})})}},{key:"createModifyControl",value:function(){this.modifyControl=new kg({source:this.olDrawSource,drawStyle:og(),layerStyle:new ms.ZP({})})}},{key:"toggleDrawControl",value:function(){this.deactivateDrawControl(),this.activeMeasureType===Uh.Length?this.activateDrawControl(this.drawLineControl):this.activeMeasureType===Uh.Area&&this.activateDrawControl(this.drawPolygonControl)}},{key:"activateDrawControl",value:function(e){var t=this;this.drawControlIsDisabled=!1,this.activeDrawControl=e,this.drawStart$$=e.start$.subscribe(function(e){return t.onDrawStart(e)}),this.drawEnd$$=e.end$.subscribe(function(e){return t.onDrawEnd(e)}),this.drawChanges$$=e.changes$.subscribe(function(e){return t.onDrawChanges(e)}),this.drawChanges$$=e.abort$.subscribe(function(e){t.clearTooltipsOfOlGeometry(e),t.clearMeasures()}),e.setOlMap(this.map.ol,!1)}},{key:"deactivateDrawControl",value:function(){void 0!==this.activeDrawControl&&(this.olDrawSource.clear(),void 0!==this.drawStart$$&&this.drawStart$$.unsubscribe(),void 0!==this.drawEnd$$&&this.drawEnd$$.unsubscribe(),void 0!==this.drawChanges$$&&this.drawChanges$$.unsubscribe(),this.clearTooltipsOfOlSource(this.olDrawSource),void 0!==this.activeOlGeometry&&this.clearTooltipsOfOlGeometry(this.activeOlGeometry),this.activeDrawControl.setOlMap(void 0),this.activeDrawControl=void 0,this.activeOlGeometry=void 0)}},{key:"setActiveMeasureType",value:function(e){this._activeMeasureType=e,this.clearMeasures(),this.toggleDrawControl()}},{key:"onDrawStart",value:function(e){this.activeOlGeometry=e}},{key:"onDrawEnd",value:function(e){this.activeOlGeometry=void 0,this.finalizeMeasureOfOlGeometry(e),this.addFeatureToStore(e),this.clearTooltipsOfOlGeometry(e),this.olDrawSource.clear(!0)}},{key:"onDrawChanges",value:function(e){var t=rg(e,this.projection);this.updateMeasureOfOlGeometry(e,Object.assign({},t,{area:void 0})),this.measure$.next(t)}},{key:"activateModifyControl",value:function(){var e=this,t=this.store.getStrategyOfType(Cu);t.deactivate(),t.clear(),this.modifyStart$$=this.modifyControl.start$.subscribe(function(t){return e.onModifyStart(t)}),this.modifyEnd$$=this.modifyControl.end$.subscribe(function(t){return e.onModifyEnd(t)}),this.modifyChanges$$=this.modifyControl.changes$.subscribe(function(t){return e.onModifyChanges(t)}),this.modifyControl.setOlMap(this.map.ol)}},{key:"deactivateModifyControl",value:function(){void 0!==this.modifyStart$$&&this.modifyStart$$.unsubscribe(),void 0!==this.modifyEnd$$&&this.modifyEnd$$.unsubscribe(),void 0!==this.modifyChanges$$&&this.modifyChanges$$.unsubscribe(),void 0!==this.activeOlGeometry&&(1===this.selectedFeatures$.value.length&&this.addFeatureToStore(this.activeOlGeometry,this.selectedFeatures$.value[0]),this.finalizeMeasureOfOlGeometry(this.activeOlGeometry)),this.olDrawSource.clear(),this.store.activateStrategyOfType(Cu),this.activeOlGeometry=void 0,this.modifyControl.setOlMap(void 0)}},{key:"onModifyStart",value:function(e){this.onDrawStart(e)}},{key:"onModifyChanges",value:function(e){this.onDrawChanges(e)}},{key:"onModifyEnd",value:function(e){this.finalizeMeasureOfOlGeometry(e)}},{key:"finalizeMeasureOfOlGeometry",value:function(e){var t=rg(e,this.projection);this.updateMeasureOfOlGeometry(e,t)}},{key:"updateMeasureOfOlGeometry",value:function(e,t){e.setProperties({_measure:t},!0),this.updateTooltipsOfOlGeometry(e)}},{key:"clearMeasures",value:function(){this.measure$.next({})}},{key:"addFeatureToStore",value:function(e,t){var i=t?t.properties.id:e.ol_uid,o=this.map.ol.getView().getProjection(),n=(new Zs.Z).writeGeometryObject(e,{featureProjection:o,dataProjection:o});this.store.update({type:ec,geometry:n,projection:o.getCode(),properties:{id:i,measure:e.get("_measure")},meta:{id:i}})}},{key:"updateTooltipsOfOlGeometry",value:function(e){var t=e.get("_measure"),i=t.lengths,o=t.area,n=function(e){var t=ag(e),i="";return e instanceof Ls.Z?i="line-":e instanceof As.ZP&&(i="polygone-"),t.map(function(e){var t=e.get("_tooltip");return void 0===t?t=ug(e,!1,i):t.setPosition(e.getFlatCoordinates()),t})}(e);if(i.length===n.length)for(var r=0;r<n.length;r++){var a=i[r];void 0!==a&&this.updateOlTooltip(n[r],eg(a,this.activeLengthUnit),this.activeLengthUnit,Uh.Length)}void 0!==o&&this.updateOlTooltip(function(e){var t=function(e){var t=e.get("_center"),i=(0,Cs.qg)(e.getExtent());return void 0!==t?t.setCoordinates(i):(t=new us.Z(i),e.set("_center",t)),t}(e),i=t.get("_tooltip");return void 0===i?i=ug(t,!0):i.setPosition(t.getFlatCoordinates()),i}(e),tg(o,this.activeAreaUnit),this.activeAreaUnit,Uh.Area)}},{key:"showTooltipsOfOlGeometry",value:function(e){var t=this;cg(e).forEach(function(e){t.shouldShowTooltip(e)&&t.map.ol.addOverlay(e)})}},{key:"clearTooltipsOfOlGeometry",value:function(e){var t=this;cg(e).forEach(function(e){void 0!==e&&void 0!==e.getMap()&&t.map.ol.removeOverlay(e)})}},{key:"updateTooltipsOfOlSource",value:function(e){var t=this;e.forEachFeature(function(e){t.updateTooltipsOfOlGeometry(e.getGeometry())})}},{key:"showTooltipsOfOlSource",value:function(e){var t=this;e.forEachFeature(function(e){t.showTooltipsOfOlGeometry(e.getGeometry())})}},{key:"clearTooltipsOfOlSource",value:function(e){var t=this;e.forEachFeature(function(e){void 0!==e.getGeometry()&&t.clearTooltipsOfOlGeometry(e.getGeometry())})}},{key:"updateOlTooltip",value:function(e,t,i,o){e.setProperties({_measure:t,_unit:i,_type:o},!0),e.getElement().innerHTML=this.computeTooltipInnerHTML(e),this.shouldShowTooltip(e)&&this.map.ol.addOverlay(e)}},{key:"computeTooltipInnerHTML",value:function(e){var t=e.getProperties();return ig(t._measure,{decimal:1,unit:t._unit,unitAbbr:!0,locale:"fr"},this.languageService)}},{key:"shouldShowTooltip",value:function(e){if(!1===this.showTooltips)return!1;var t=e.getProperties(),i=t._measure;if(void 0===i)return!1;if(t._unit===Uh.Length){var o=eg(this.minSegmentLength,t._unit)||0;return i>Math.max(o,0)}return!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ce),w.Y36(ut.uw),w.Y36(De))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-measurer"]],viewQuery:function(e,t){var i;(1&e&&w.Gf(Zg,7),2&e)&&(w.iGM(i=w.CRH())&&(t.table=i.first))},inputs:{map:"map",store:"store",activeMeasureType:"activeMeasureType",minSegmentLength:"minSegmentLength"},decls:43,vars:60,consts:[[1,"measure-type-toggle","mat-typography"],[3,"value","change"],[3,"value"],[1,"measure-options","mat-typography"],[3,"disabled","checked","labelPosition","change"],[4,"ngIf"],[3,"checked","labelPosition","change",4,"ngIf"],[3,"checked","labelPosition","change"],[1,"measure-store-buttons"],["mat-icon-button","","color","accent",3,"matTooltip","disabled","click",4,"ngIf"],["mat-icon-button","","color","warn",3,"matTooltip","disabled","click",4,"ngIf"],[1,"table-compact",3,"store","template"],["table",""],[3,"measureType","measureUnit","measure","auto","placeholder","measureUnitChange",4,"ngIf"],[3,"measureType","measureUnit","measure","auto","placeholder","measureUnitChange"],["mat-icon-button","","color","accent",3,"matTooltip","disabled","click"],["svgIcon","calculator"],["mat-icon-button","","color","warn",3,"matTooltip","disabled","click"],["svgIcon","delete"]],template:function(e,t){1&e&&(w.TgZ(0,"div"),w.TgZ(1,"div",0),w.TgZ(2,"mat-button-toggle-group",1),w.NdJ("change",function(e){return t.onMeasureTypeChange(e.value)}),w.TgZ(3,"mat-button-toggle",2),w._uU(4),w.ALo(5,"translate"),w.qZA(),w.TgZ(6,"mat-button-toggle",2),w._uU(7),w.ALo(8,"translate"),w.qZA(),w.qZA(),w.qZA(),w.TgZ(9,"div",3),w.TgZ(10,"mat-slide-toggle",4),w.NdJ("change",function(e){return t.onToggleDrawControl(e.checked)}),w._uU(11),w.ALo(12,"translate"),w.qZA(),w.YNc(13,Fg,1,0,"mat-divider",5),w.ALo(14,"async"),w.YNc(15,Og,3,5,"mat-slide-toggle",6),w.ALo(16,"async"),w.YNc(17,Mg,1,0,"mat-divider",5),w.ALo(18,"async"),w.ALo(19,"async"),w.YNc(20,Ig,3,5,"mat-slide-toggle",6),w.ALo(21,"async"),w.YNc(22,Pg,3,5,"mat-slide-toggle",6),w.ALo(23,"async"),w.YNc(24,_g,1,0,"mat-divider",5),w.ALo(25,"async"),w.TgZ(26,"mat-slide-toggle",7),w.NdJ("change",function(e){return t.onToggleMeasureUnitsAuto(e.checked)}),w._uU(27),w.ALo(28,"translate"),w.qZA(),w.qZA(),w.YNc(29,Eg,3,2,"ng-container",5),w.ALo(30,"async"),w.YNc(31,$g,1,0,"mat-divider",5),w.ALo(32,"async"),w.ALo(33,"async"),w.TgZ(34,"div",8),w.YNc(35,Rg,4,6,"button",9),w.ALo(36,"async"),w.ALo(37,"async"),w.YNc(38,Ng,4,6,"button",10),w.ALo(39,"async"),w.ALo(40,"async"),w.qZA(),w._UZ(41,"igo-entity-table",11,12),w.qZA()),2&e&&(w.xp6(2),w.Q6J("value",t.activeMeasureType),w.xp6(1),w.Q6J("value",t.measureType.Length),w.xp6(1),w.hij(" ",w.lcZ(5,24,"igo.geo.measure."+t.measureType.Length)," "),w.xp6(2),w.Q6J("value",t.measureType.Area),w.xp6(1),w.hij(" ",w.lcZ(8,26,"igo.geo.measure."+t.measureType.Area)," "),w.xp6(3),w.Q6J("disabled",t.drawControlIsDisabled)("checked",t.drawControlIsActive)("labelPosition","before"),w.xp6(1),w.hij(" ",w.lcZ(12,28,"igo.geo.measure.toggleActive")," "),w.xp6(2),w.Q6J("ngIf",w.lcZ(14,30,t.hasLine$)),w.xp6(2),w.Q6J("ngIf",w.lcZ(16,32,t.hasLine$)),w.xp6(2),w.Q6J("ngIf",w.lcZ(18,34,t.hasLine$)||w.lcZ(19,36,t.hasArea$)),w.xp6(3),w.Q6J("ngIf",w.lcZ(21,38,t.hasArea$)),w.xp6(2),w.Q6J("ngIf",w.lcZ(23,40,t.hasArea$)),w.xp6(2),w.Q6J("ngIf",w.lcZ(25,42,t.hasArea$)),w.xp6(2),w.Q6J("checked",t.measureUnitsAuto)("labelPosition","before"),w.xp6(1),w.hij(" ",w.lcZ(28,44,"igo.geo.measure.toggleAutoUnits")," "),w.xp6(2),w.Q6J("ngIf",w.lcZ(30,46,t.measure$)),w.xp6(2),w.Q6J("ngIf",w.lcZ(32,48,t.hasLine$)||w.lcZ(33,50,t.hasArea$)),w.xp6(4),w.Q6J("ngIf",w.lcZ(36,52,t.hasLine$)||w.lcZ(37,54,t.hasArea$)),w.xp6(3),w.Q6J("ngIf",w.lcZ(39,56,t.hasLine$)||w.lcZ(40,58,t.hasArea$)),w.xp6(3),w.Q6J("store",t.store)("template",t.tableTemplate))},styles:[".measure-type-toggle[_ngcontent-%COMP%]{padding:10px;text-align:center}.measure-type-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]{width:100%}.measure-type-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]{width:50%}.measure-options[_ngcontent-%COMP%]{overflow-x:hidden}.measure-options[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{width:100%;margin:10px}.measure-options[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content{width:calc(100% - 60px)}.measure-store-buttons[_ngcontent-%COMP%]{margin-left:-2px}.measure-store-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-of-type{margin-left:14px}.table-compact[_ngcontent-%COMP%]     .mat-header-cell.mat-column-selectionCheckbox{width:52px}"],changeDetection:0}),e}(),Jg=function(){var e=function(){function e(){m(this,e)}return y(e,[{key:"transform",value:function(e,t){var i,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object.values(jh).indexOf(t)>=0?i=tg(e,t):Object.values(Jh).indexOf(t)>=0&&(i=eg(e,t)),i&&ig(i,{decimal:1,unit:t,unitAbbr:o,locale:"fr"})}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=w.Yjl({name:"measureFormat",type:e,pure:!0}),e}();function Bg(e,t){}var jg=function(){var e=function(){function e(t,i){m(this,e),this.cdRef=t,this.ngControl=i,this.olGeoJSON=new Zs.Z,this.ready=!1,this.olTooltip=this.createMeasureTooltip(),this.drawGuide=null,this.measure=!1,this._drawControlIsActive=!0,this.controlOptions={},this.onChange=function(){},this.onTouched=function(){},void 0!==this.ngControl&&(this.ngControl.valueAccessor=this)}return y(e,[{key:"geometryType",get:function(){return this._geometryType},set:function(e){this._geometryType=e,!1!==this.ready&&(this.deactivateControl(),this.createDrawControl(),this.drawControl.freehand$.next(this.freehandDrawIsActive),this.toggleControl())}},{key:"drawControlIsActive",get:function(){return this._drawControlIsActive},set:function(e){if(this._drawControlIsActive=e,!1!==this.ready){if(this.deactivateControl(),!this._drawControlIsActive)return;this.toggleControl()}}},{key:"freehandDrawIsActive",get:function(){return this._freehandDrawIsActive},set:function(e){this._freehandDrawIsActive=e,this.deactivateControl(),this.createDrawControl(),this.createModifyControl(),this.drawControl.freehand$.next(this.freehandDrawIsActive),!1!==this.ready&&(!this.drawControlIsActive||this.toggleControl())}},{key:"drawStyle",get:function(){return this._drawStyle},set:function(e){void 0===e&&(e=qh()),this._drawStyle=e;var t=this.getGuideStyleFromDrawStyle(e);this.defaultDrawStyleRadius=void 0!==t?t.getRadius():null,!1!==this.ready&&(this.deactivateControl(),this.createDrawControl(),this.createModifyControl(),this.drawControl.freehand$.next(this.freehandDrawIsActive),this.toggleControl())}},{key:"overlayStyle",get:function(){return this._overlayStyle},set:function(e){this._overlayStyle=e}},{key:"value",get:function(){return this._value},set:function(e){this._value=e,!1!==this.ready&&(e?this.addGeoJSONToOverlay(e):this.olOverlaySource.clear(!0),this.onChange(e),this.toggleControl(),this.cdRef.detectChanges())}},{key:"olOverlaySource",get:function(){return this.olOverlayLayer.getSource()}},{key:"radius",set:function(e){var t,i=this;!1!==this.ready&&(this.modifyControl.getSource()&&this.modifyControl.getSource().refresh(),this.freehandDrawIsActive)&&setTimeout(function(){(t=i.modifyControl.olModifyInteraction)&&t.features_&&(t.features_.clear(),i.addGeoJSONToOverlay(i.value))},0)}},{key:"ngOnInit",value:function(){void 0===this.drawStyle&&(this.drawStyle=qh()),void 0===this.overlayStyle&&(this.overlayStyle=this.drawStyle),this.addOlOverlayLayer(),this.createDrawControl(),this.createModifyControl(),this.value&&this.addGeoJSONToOverlay(this.value),this.toggleControl(),this.ready=!0}},{key:"ngOnDestroy",value:function(){this.ready=!1,this.deactivateControl(),this.olOverlaySource.clear(),this.map.ol.removeLayer(this.olOverlayLayer)}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"writeValue",value:function(e){this.value=e}},{key:"addOlOverlayLayer",value:function(){this.olOverlayLayer=new Fs.Z({source:new el.Z,zIndex:500,style:null}),this.map.ol.addLayer(this.olOverlayLayer)}},{key:"createDrawControl",value:function(){var e=this,t=Object.assign({},this.controlOptions,{geometryType:this.geometryType||"Point",drawingLayer:this.olOverlayLayer,interactionStyle:"function"==typeof this.drawStyle?this.drawStyle:function(t,i){var o=e.drawStyle;return e.updateDrawStyleWithDrawGuide(o,i),o}});this.drawControl=new $h(t)}},{key:"createModifyControl",value:function(){var e=this,t=Object.assign({},this.controlOptions,{layer:this.olOverlayLayer,drawStyle:"function"==typeof this.drawStyle?this.drawStyle:function(t,i){var o=e.drawStyle;return e.updateDrawStyleWithDrawGuide(o,i),o}});this.modifyControl=new kg(t)}},{key:"toggleControl",value:function(){var e;(e=!this.value&&this.geometryType?this.drawControl:this.modifyControl)!==this.activeControl&&(this.deactivateControl(),this.activateControl(e))}},{key:"activateControl",value:function(e){var t=this;this.activeControl=e,this.olGeometryEnds$$=e.end$.subscribe(function(e){return t.onOlGeometryEnds(e)}),!0===this.measure&&e===this.drawControl&&(this.olGeometryChanges$$=e.changes$.subscribe(function(e){return t.onOlGeometryChanges(e)})),e.setOlMap(this.map.ol,!1)}},{key:"deactivateControl",value:function(){this.removeMeasureTooltip(),void 0!==this.activeControl&&this.activeControl.setOlMap(void 0),void 0!==this.olGeometryEnds$$&&this.olGeometryEnds$$.unsubscribe(),void 0!==this.olGeometryChanges$$&&this.olGeometryChanges$$.unsubscribe(),this.activeControl=void 0}},{key:"onOlGeometryEnds",value:function(e){this.removeMeasureTooltip(),this.setOlGeometry(e)}},{key:"onOlGeometryChanges",value:function(e){"Point"!==e.getType()&&this.updateMeasureTooltip(e)}},{key:"setOlGeometry",value:function(e){var t;void 0!==e&&("Circle"===e.getType()&&(e=this.circleToPoint(e)),t=this.olGeoJSON.writeGeometryObject(e,{featureProjection:this.map.projection,dataProjection:"EPSG:4326"}),e.get("radius")&&(t.radius=e.get("radius"),e.set("radius",t.radius)),this.writeValue(t))}},{key:"circleToPoint",value:function(e){var t=e.getCenter(),i=ls.vs(t,this.map.projection,"EPSG:4326"),o=Math.round(e.getRadius()*Math.cos(Math.PI/180*i[1]));return(e=new us.Z(t)).set("radius",o,!0),e}},{key:"addGeoJSONToOverlay",value:function(e){var t=this.olGeoJSON.readGeometry(e,{dataProjection:"EPSG:4326",featureProjection:this.map.projection}),i=new ns.Z({geometry:t});i.setStyle(this.overlayStyle),this.olOverlaySource.clear(),this.olOverlaySource.addFeature(i)}},{key:"createMeasureTooltip",value:function(){return new Il.Z({element:document.createElement("div"),offset:[-30,-10],className:["igo-map-tooltip","igo-map-tooltip-measure"].join(" "),stopEvent:!1})}},{key:"updateMeasureTooltip",value:function(e){var t=rg(e,this.map.projection).lengths,i="Polygon"===e.getType()?t.length-2:t.length-1,o=t[i],n=ag(e),r=n[i];if(0!==n.length&&void 0!==r){this.olTooltip.setPosition(r.getFlatCoordinates());var a=ig(o,{decimal:1,unit:Jh.Meters,unitAbbr:!0,locale:"fr"});this.olTooltip.getElement().innerHTML=a,void 0===this.olTooltip.getMap()&&this.map.ol.addOverlay(this.olTooltip)}else this.removeMeasureTooltip()}},{key:"removeMeasureTooltip",value:function(){this.olTooltip.getMap&&void 0!==this.olTooltip.getMap()&&(this.map.ol.removeOverlay(this.olTooltip),this.olTooltip.setMap(void 0))}},{key:"updateDrawStyleWithDrawGuide",value:function(e,t){var i=this.getGuideStyleFromDrawStyle(e);if(void 0!==i){var o,n=this.drawGuide;o=!n||n<0?this.defaultDrawStyleRadius:n>0?n/t:n,i.setRadius(o)}}},{key:"isStyleWithRadius",value:function(e){return"function"!=typeof e&&e.setRadius}},{key:"getGuideStyleFromDrawStyle",value:function(e){if(Array.isArray(e)&&(e=e[0]),this.isStyleWithRadius(e))return e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(w.sBO),w.Y36(We.a5,10))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-geometry-form-field-input"]],inputs:{map:"map",geometryType:"geometryType",drawGuide:"drawGuide",measure:"measure",drawControlIsActive:"drawControlIsActive",freehandDrawIsActive:"freehandDrawIsActive",controlOptions:"controlOptions",drawStyle:"drawStyle",overlayStyle:"overlayStyle",value:"value",radius:"radius"},decls:1,vars:0,template:function(e,t){1&e&&w.YNc(0,Bg,0,0,"ng-template")},encapsulation:2,changeDetection:0}),e}(),Qg=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,We.u5,We.UX,k.Ps,Ye.lN,ot.c,S.ot,Al.vV,Se]]}),e}(),Gg=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({providers:[],imports:[[F.ez,Qg],Qg]}),e}();function Yg(e,t){if(1&e&&(w.TgZ(0,"button",2),w.ALo(1,"translate"),w._UZ(2,"mat-icon",3),w.qZA()),2&e){var i=w.oxw();w.Q6J("matTooltip",w.lcZ(1,3,"igo.geo.filter.filterBy"))("color",i.color),w.xp6(2),w.Q6J("matBadge",i.badge)}}function zg(e,t){if(1&e&&w._UZ(0,"igo-time-filter-item",7),2&e){var i=w.oxw(2);w.Q6J("header",!1)("layer",i.layer)}}function Vg(e,t){if(1&e&&(w.TgZ(0,"div",4,5),w.YNc(2,zg,1,2,"igo-time-filter-item",6),w.qZA()),2&e){var i=w.oxw();w.xp6(2),w.Q6J("ngIf",i.timeFilterCollapse&&i.options.timeFilter)}}var Hg=function(){var e=function(){function e(){m(this,e),this.color="primary",this.header=!0,this.timeFilterCollapse=!1}return y(e,[{key:"badge",get:function(){var e=this.options.timeFilter;if(e&&e.enabled)return 1}},{key:"layer",get:function(){return this._layer},set:function(e){this._layer=e,e&&(this.options=this.layer.dataSource.options)}},{key:"ngOnInit",value:function(){this.options=this.layer.dataSource.options}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-time-filter-button"]],inputs:{layer:"layer",map:"map",color:"color",header:"header"},decls:2,vars:2,consts:[["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color",4,"ngIf"],["class","igo-layer-actions-container",4,"ngIf"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color"],["matBadgeColor","warn","matBadgeSize","medium","svgIcon","history",3,"matBadge"],[1,"igo-layer-actions-container"],["ogcFilter",""],["igoListItem","",3,"header","layer",4,"ngIf"],["igoListItem","",3,"header","layer"]],template:function(e,t){1&e&&(w.YNc(0,Yg,3,5,"button",0),w.YNc(1,Vg,3,1,"div",1)),2&e&&(w.Q6J("ngIf",t.header&&t.options.timeFilterable&&t.options.timeFilter),w.xp6(1),w.Q6J("ngIf",t.header&&t.options.timeFilterable&&t.options.timeFilter))},styles:[""],changeDetection:0}),e}();function Wg(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",3),w.TgZ(1,"mat-form-field"),w._UZ(2,"mat-datetimepicker-toggle",4),w._UZ(3,"mat-datetimepicker",5,6),w.TgZ(5,"input",7),w.NdJ("ngModelChange",function(e){return w.CHM(i),w.oxw(2).date=e})("dateChange",function(e){return w.CHM(i),w.oxw(2).handleDateChange(e)}),w.ALo(6,"translate"),w.qZA(),w.qZA(),w.qZA()}if(2&e){var o=w.MAs(4),n=w.oxw(2);w.xp6(2),w.Q6J("for",o),w.xp6(1),w.s9C("type",n.type),w.xp6(2),w.s9C("placeholder",w.lcZ(6,7,"igo.geo.timeFilter.date")),w.Q6J("matDatetimepicker",o)("ngModel",n.date)("min",n.min)("max",n.max)}}function Xg(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div"),w.TgZ(1,"div",8),w.TgZ(2,"mat-form-field"),w._UZ(3,"mat-datetimepicker-toggle",4),w._UZ(4,"mat-datetimepicker",5,9),w.TgZ(6,"input",10),w.NdJ("ngModelChange",function(e){return w.CHM(i),w.oxw(2).startDate=e})("input",function(){return w.CHM(i),w.oxw(2).startDate})("dateChange",function(e){return w.CHM(i),w.oxw(2).handleDateChange(e)}),w.ALo(7,"translate"),w.qZA(),w.qZA(),w.qZA(),w.TgZ(8,"div",8),w.TgZ(9,"mat-form-field"),w._UZ(10,"mat-datetimepicker-toggle",4),w._UZ(11,"mat-datetimepicker",5,11),w.TgZ(13,"input",7),w.NdJ("ngModelChange",function(e){return w.CHM(i),w.oxw(2).endDate=e})("dateChange",function(e){return w.CHM(i),w.oxw(2).handleDateChange(e)}),w.ALo(14,"translate"),w.qZA(),w.qZA(),w.qZA(),w.qZA()}if(2&e){var o=w.MAs(5),n=w.MAs(12),r=w.oxw(2);w.xp6(3),w.Q6J("for",o),w.xp6(1),w.s9C("type",r.type),w.xp6(2),w.s9C("placeholder",w.lcZ(7,14,"igo.geo.timeFilter.startDate")),w.Q6J("matDatetimepicker",o)("ngModel",r.startDate)("min",r.min)("max",r.getRangeMaxDate()),w.xp6(4),w.Q6J("for",n),w.xp6(1),w.s9C("type",r.type),w.xp6(2),w.s9C("placeholder",w.lcZ(14,16,"igo.geo.timeFilter.endDate")),w.Q6J("matDatetimepicker",n)("ngModel",r.endDate)("min",r.getRangeMinDate())("max",r.max)}}function Kg(e,t){if(1&e&&(w.TgZ(0,"div"),w.YNc(1,Wg,7,9,"div",2),w.YNc(2,Xg,15,18,"div",0),w.qZA()),2&e){var i=w.oxw();w.xp6(1),w.Q6J("ngIf",!i.isRange),w.xp6(1),w.Q6J("ngIf",i.isRange)}}function ef(e,t){if(1&e&&(w.TgZ(0,"mat-option",14),w._uU(1),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i),w.xp6(1),w.Oqu(i)}}function tf(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",3),w.TgZ(1,"mat-form-field"),w.TgZ(2,"mat-select",12),w.NdJ("ngModelChange",function(e){return w.CHM(i),w.oxw(2).year=e})("selectionChange",function(e){return w.CHM(i),w.oxw(2).handleYearChange(e)}),w.ALo(3,"translate"),w.YNc(4,ef,2,2,"mat-option",13),w.qZA(),w.qZA(),w.qZA()}if(2&e){var o=w.oxw(2);w.xp6(2),w.s9C("placeholder",w.lcZ(3,3,"igo.geo.timeFilter.date")),w.Q6J("ngModel",o.year),w.xp6(2),w.Q6J("ngForOf",o.listYears)}}function of(e,t){if(1&e&&(w.TgZ(0,"mat-option",14),w._uU(1),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i),w.xp6(1),w.Oqu(i)}}function nf(e,t){if(1&e&&(w.TgZ(0,"mat-option",14),w._uU(1),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i),w.xp6(1),w.Oqu(i)}}function rf(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div"),w.TgZ(1,"div",8),w.TgZ(2,"mat-form-field"),w.TgZ(3,"mat-select",12),w.NdJ("ngModelChange",function(e){return w.CHM(i),w.oxw(2).startYear=e})("selectionChange",function(e){return w.CHM(i),w.oxw(2).handleYearChange(e)}),w.ALo(4,"translate"),w.YNc(5,of,2,2,"mat-option",13),w.qZA(),w.qZA(),w.qZA(),w.TgZ(6,"div",8),w.TgZ(7,"mat-form-field"),w.TgZ(8,"mat-select",12),w.NdJ("ngModelChange",function(e){return w.CHM(i),w.oxw(2).endYear=e})("selectionChange",function(e){return w.CHM(i),w.oxw(2).handleYearChange(e)}),w.ALo(9,"translate"),w.YNc(10,nf,2,2,"mat-option",13),w.qZA(),w.qZA(),w.qZA(),w.qZA()}if(2&e){var o=w.oxw(2);w.xp6(3),w.s9C("placeholder",w.lcZ(4,6,"igo.geo.timeFilter.startDate")),w.Q6J("ngModel",o.startYear),w.xp6(2),w.Q6J("ngForOf",o.startListYears),w.xp6(3),w.s9C("placeholder",w.lcZ(9,8,"igo.geo.timeFilter.endDate")),w.Q6J("ngModel",o.endYear),w.xp6(2),w.Q6J("ngForOf",o.endListYears)}}function af(e,t){if(1&e&&(w.TgZ(0,"div"),w.YNc(1,tf,5,5,"div",2),w.YNc(2,rf,11,10,"div",0),w.qZA()),2&e){var i=w.oxw();w.xp6(1),w.Q6J("ngIf",!i.isRange),w.xp6(1),w.Q6J("ngIf",i.isRange)}}function sf(e,t){if(1&e&&(w.TgZ(0,"p",23),w._uU(1),w.qZA()),2&e){var i=w.oxw(2);w.xp6(1),w.Oqu(i.year)}}function lf(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",15),w.TgZ(1,"span"),w._uU(2),w.qZA(),w.TgZ(3,"mat-slider",16),w.NdJ("input",function(e){return w.CHM(i),w.oxw().handleSliderYearChange(e)})("change",function(e){return w.CHM(i),w.oxw().handleSliderYearChange(e)}),w.qZA(),w.TgZ(4,"span"),w._uU(5),w.qZA(),w.YNc(6,sf,2,1,"p",17),w.TgZ(7,"div",18,19),w.TgZ(9,"mat-slide-toggle",20),w.NdJ("change",function(){return w.CHM(i),w.oxw().toggleFilterState()}),w.ALo(10,"translate"),w.qZA(),w.TgZ(11,"button",21),w.NdJ("click",function(e){return w.CHM(i),w.oxw().playYear(e)}),w._UZ(12,"mat-icon",22),w.qZA(),w.TgZ(13,"button",21),w.NdJ("click",function(e){return w.CHM(i),w.oxw().resetFilter(e)}),w._UZ(14,"mat-icon",22),w.qZA(),w.qZA(),w.qZA()}if(2&e){var o=w.oxw();w.xp6(2),w.Oqu(o.startYear),w.xp6(1),w.s9C("step",o.step),w.Q6J("min",o.startYear)("max",o.endYear)("value",o.handleSliderValue())("color",o.color)("disabled",!o.options.enabled||!o.layer.visible),w.xp6(2),w.Oqu(o.endYear),w.xp6(1),w.Q6J("ngIf",o.options.enabled),w.xp6(3),w.Q6J("matTooltip",w.lcZ(10,17,"igo.geo.filter.toggleFilterState"))("color",o.color)("checked",o.options.enabled)("disabled",!o.layer.visible),w.xp6(2),w.Q6J("disabled",!o.options.enabled||!o.layer.visible),w.xp6(1),w.s9C("svgIcon",o.playIcon),w.xp6(1),w.Q6J("disabled",!o.options.enabled||!o.layer.visible),w.xp6(1),w.s9C("svgIcon",o.resetIcon)}}function cf(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",3),w.TgZ(1,"mat-slider",24),w.NdJ("input",function(e){return w.CHM(i),w.oxw().handleSliderDateChange(e)})("selectionChange",function(e){return w.CHM(i),w.oxw().handleSliderDateChange(e)}),w.qZA(),w.TgZ(2,"p",23),w._uU(3),w.qZA(),w.TgZ(4,"button",25),w.NdJ("click",function(e){return w.CHM(i),w.oxw().playFilter(e)}),w._UZ(5,"mat-icon",22),w.qZA(),w.qZA()}if(2&e){var o=w.oxw();w.xp6(1),w.s9C("step",o.step),w.Q6J("min",o.dateToNumber(o.min))("max",o.dateToNumber(o.max))("value",o.handleSliderValue()),w.xp6(2),w.Oqu(o.handleSliderTooltip()),w.xp6(2),w.s9C("svgIcon",o.playIcon)}}var uf=function(){var e=function(){function e(t){m(this,e),this.dateAdapter=t,this.color="primary",this.listYears=[],this.startListYears=[],this.endListYears=[],this.playIcon="play-circle",this.resetIcon="replay",this.change=new w.vpe,this.yearChange=new w.vpe,this.dateAdapter.setLocale("fr")}return y(e,[{key:"currentValue",set:function(e){if(e&&this.type!==ru.YEAR){var t=e.split("/");if(t.length>0){var i=new Date(t[0]),o=new Date(t[1]);isNaN(i.valueOf())||(this.startDate=i),isNaN(o.valueOf())||(this.endDate=o)}}}},{key:"type",get:function(){return void 0===this.options.type?ru.DATE:this.options.type}},{key:"isRange",get:function(){return void 0!==this.options.range&&this.options.style!==au.SLIDER&&this.options.range}},{key:"style",get:function(){return void 0===this.options.style?au.SLIDER:this.options.style}},{key:"step",get:function(){var e=108e5;if(void 0===this.options.step)switch(this.type){case ru.DATE:case ru.DATETIME:e=108e5;break;case ru.TIME:e=36e5;break;case ru.YEAR:e=31536e6;break;default:e=108e5}else e=this.getStepDefinition(this.options.step);return e}},{key:"timeInterval",get:function(){return void 0===this.options.timeInterval?2e3:this.options.timeInterval}},{key:"min",get:function(){if(this.options.min){var e=new Date(this.options.min);return new Date(e.getTime()+6e4*e.getTimezoneOffset())}}},{key:"max",get:function(){if(this.options.max){var e=new Date(this.options.max);return new Date(e.getTime()+6e4*e.getTimezoneOffset())}}},{key:"is",get:function(){return void 0!==this.options.range&&this.options.range}},{key:"ngOnInit",value:function(){if(void 0===this.startDate&&(this.startDate=new Date(this.min)),void 0===this.endDate&&(this.endDate=new Date(this.max)),void 0===this.startYear&&(this.startYear=new Date(this.startDate).getFullYear(),this.initStartYear=this.startYear),void 0===this.endYear&&(this.endYear=new Date(this.endDate).getFullYear(),this.initEndYear=this.endYear),this.isRange){for(var e=this.startYear;e<this.endYear;e++)this.startListYears.push(e);for(var t=this.startYear+1;t<=this.endYear;t++)this.endListYears.push(t)}else for(var i=this.startYear;i<=this.endYear+1;i++)this.listYears.push(i);this.options.enabled=void 0===this.options.enabled||this.options.enabled,this.checkFilterValue(),this.options.enabled?!this.isRange&&"slider"===this.style&&"year"===this.type&&this.yearChange.emit(this.year):(this.storeCurrentFilterValue(),this.yearChange.emit(void 0))}},{key:"storeCurrentFilterValue",value:function(){!this.isRange&&this.style===au.SLIDER&&this.type===ru.YEAR&&(this.options.value=this.year.toString())}},{key:"checkFilterValue",value:function(){var e=this.layer.dataSource.ol.getParams().TIME;if(this.isRange||this.style!==au.SLIDER||this.type!==ru.YEAR){if(this.isRange&&this.style===au.CALENDAR&&this.type===ru.YEAR&&e){this.startYear=parseInt(e.substr(0,4),10),this.endYear=parseInt(e.substr(5,4),10);for(var t=[],i=[],o=this.initStartYear;o<this.endYear;o++)t.push(o);for(var n=this.startYear+1;n<=this.initEndYear;n++)i.push(n);this.startListYears=t,this.endListYears=i}}else this.year=e?new Date(e.toString()).getFullYear()+1:this.options.value?new Date(this.options.value.toString()).getFullYear()+1:new Date(this.min).getFullYear()+1}},{key:"handleDateChange",value:function(e){this.setupDateOutput(),this.applyTypeChange(),this.change.emit(this.isRange?[this.startDate,this.endDate]:this.startDate)}},{key:"handleYearChange",value:function(e){if(this.isRange){this.endListYears=[];for(var t=this.startYear+1;t<=this.initEndYear;t++)this.endListYears.push(t);this.startListYears=[];for(var i=this.initStartYear+1;i<this.endYear;i++)this.startListYears.push(i);this.yearChange.emit([this.startYear,this.endYear])}else this.yearChange.emit(this.year)}},{key:"handleListYearChange",value:function(e){this.handleYearChange([this.startYear,this.endYear])}},{key:"handleListYearStartChange",value:function(e){this.change.emit([this.startDate,this.endDate])}},{key:"dateToNumber",value:function(e){return(e?new Date(e):new Date(this.min)).getTime()}},{key:"setSliderThumbLabel",value:function(e){var t=this.findThumbLabel(this.mySlider._elementRef.nativeElement.childNodes);t&&(t.textContent=e)}},{key:"findThumbLabel",value:function(e){var t,i=this;return e.forEach(function(e){"mat-slider-thumb-label-text"===e.className&&(t=e),e.children.length>0&&!t&&(t=i.findThumbLabel(e.childNodes))},this),t}},{key:"toggleFilterState",value:function(){this.options.enabled=!this.options.enabled,this.options.enabled?!this.isRange&&au.SLIDER&&this.type===ru.YEAR&&this.yearChange.emit(this.year):(this.stopFilter(),this.storeCurrentFilterValue(),this.change.emit(void 0))}},{key:"resetFilter",value:function(e){this.date=new Date(this.min),this.year=this.date.getFullYear(),!this.isRange&&au.SLIDER&&this.type===ru.YEAR?this.yearChange.emit(this.year):(this.setupDateOutput(),this.change.emit(void 0))}},{key:"playFilter",value:function(e){this.interval?this.stopFilter():(this.playIcon="pause-circle",this.interval=setInterval(function(e){var t,i=new Date(e.max);t=void 0===e.date?e.min.getTime():e.date.getTime(),t+=e.mySlider.step,e.date=new Date(t),t>i.getTime()&&e.stopFilter(),e.handleDateChange({value:e.date,date:e.date})},this.timeInterval,this))}},{key:"playYear",value:function(e){var t=this;this.year+this.mySlider.step>this.max.getFullYear()+this.mySlider.step&&(this.stopFilter(),this.resetFilter(e)),this.interval?this.stopFilter():(this.playIcon="pause-circle",this.interval=setInterval(function(){t.year+t.mySlider.step>t.max.getFullYear()?t.stopFilter():t.year=t.year+t.mySlider.step,t.yearChange.emit(t.year)},this.timeInterval,this))}},{key:"stopFilter",value:function(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.playIcon="play-circle"}},{key:"handleSliderDateChange",value:function(e){this.date=new Date(e.value),this.setSliderThumbLabel(this.handleSliderTooltip()),this.handleDateChange(e)}},{key:"handleSliderYearChange",value:function(e){this.year=e.value,this.yearChange.emit(this.year)}},{key:"handleSliderValue",value:function(){if(!0===this.options.current||!this.min){var e=new Date;this.date=this.getRoundedDate(e)}return this.type===ru.YEAR?this.year:void 0===this.date?this.min.getTime():this.date.getTime()}},{key:"handleSliderTooltip",value:function(){var e;switch(this.type){case ru.DATE:e=void 0===this.date?this.min.toDateString():this.date.toDateString();break;case ru.TIME:e=void 0===this.date?this.min.toTimeString():this.date.toTimeString();break;default:e=void 0===this.date?this.min.toUTCString():this.date.toUTCString()}return e}},{key:"setupDateOutput",value:function(){this.style===au.SLIDER?(this.startDate=new Date(this.date),this.startDate.setSeconds(-this.step/1e3),this.endDate=new Date(this.startDate),this.endDate.setSeconds(this.step/1e3)):!this.isRange&&this.date?(this.endDate=new Date(this.date),this.startDate=new Date(this.date)):(!this.isRange||!this.date&&this.date)&&this.date||(this.startDate=void 0===this.startDate?new Date(this.min):this.startDate,this.endDate=void 0===this.endDate?new Date(this.max):this.endDate)}},{key:"applyTypeChange",value:function(){switch(this.type){case ru.DATE:(void 0!==this.startDate||void 0!==this.endDate)&&(this.startDate.setHours(0),this.startDate.setMinutes(0),this.startDate.setSeconds(0),this.endDate.setHours(23),this.endDate.setMinutes(59),this.endDate.setSeconds(59));break;case ru.TIME:if(this.style===au.CALENDAR){if(this.startDate.getDay()!==this.min.getDay()){var e=this.startDate.getHours(),t=this.startDate.getMinutes();this.startDate=this.min,this.startDate.setHours(e),this.startDate.setMinutes(t)}if(this.endDate.getDay()!==this.min.getDay()){var i=this.endDate.getHours(),o=this.endDate.getMinutes();this.endDate=this.min,this.endDate.setHours(i),this.endDate.setMinutes(o)}}!this.isRange&&this.step>36e5&&(this.startDate.setMinutes(0),this.startDate.setSeconds(0),this.endDate.setMinutes(59),this.endDate.setSeconds(59))}}},{key:"getRangeMinDate",value:function(){return void 0===this.startDate?this.min:this.startDate}},{key:"getRangeMaxDate",value:function(){return void 0===this.endDate?this.max:this.endDate}},{key:"getRoundedDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,i=6e4*t;return new Date(Math.round(e.getTime()/i)*i)}},{key:"getStepDefinition",value:function(e){return Xe.duration(e).asMilliseconds()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ve._A))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-time-filter-form"]],viewQuery:function(e,t){var i;(1&e&&w.Gf(Tl.pH,5),2&e)&&(w.iGM(i=w.CRH())&&(t.mySlider=i.first))},inputs:{layer:"layer",options:"options",currentValue:"currentValue"},outputs:{change:"change",yearChange:"yearChange"},decls:5,vars:4,consts:[[4,"ngIf"],["class","igo-col igo-col-100 igo-col-100-m mat-typography",4,"ngIf"],["class","igo-col igo-col-100 igo-col-100-m",4,"ngIf"],[1,"igo-col","igo-col-100","igo-col-100-m"],["matSuffix","",3,"for"],["openOnFocus","true","timeInterval","5",3,"type"],["datetimePicker",""],["matInput","","autocomplete","false","readonly","readonly",3,"placeholder","matDatetimepicker","ngModel","min","max","ngModelChange","dateChange"],[1,"igo-col","igo-col-100"],["minDatetimePicker",""],["matInput","","autocomplete","false","readonly","readonly",3,"placeholder","matDatetimepicker","ngModel","min","max","ngModelChange","input","dateChange"],["maxDatetimePicker",""],[3,"placeholder","ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"igo-col","igo-col-100","igo-col-100-m","mat-typography"],["id","time-slider","tickInterval","auto","thumbLabel","",3,"step","min","max","value","color","disabled","input","change"],["class","date-below",4,"ngIf"],[1,"igo-layer-actions-container"],["actions",""],["tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","checked","disabled","change"],["mat-icon-button","","color","primary",3,"disabled","click"],[3,"svgIcon"],[1,"date-below"],["id","time-slider","tickInterval","auto","thumbLabel","",3,"step","min","max","value","input","selectionChange"],["mat-icon-button","","color","primary",3,"click"]],template:function(e,t){1&e&&(w.YNc(0,Kg,3,2,"div",0),w.YNc(1,af,3,2,"div",0),w._UZ(2,"br"),w.YNc(3,lf,15,19,"div",1),w.YNc(4,cf,6,6,"div",2)),2&e&&(w.Q6J("ngIf","calendar"===t.style&&"year"!==t.type),w.xp6(1),w.Q6J("ngIf","calendar"===t.style&&"year"===t.type),w.xp6(2),w.Q6J("ngIf",!t.isRange&&"slider"===t.style&&"year"===t.type),w.xp6(1),w.Q6J("ngIf","slider"===t.style&&"year"!==t.type))},directives:[F.O5,Ye.KE,El.KA,Ye.R9,El.k1,ot.Nt,El.Ry,We.Fj,We.JJ,We.On,ze.gD,F.sg,Ve.ey,Tl.pH,Cl.Rr,L.gM,S.lW,k.Hw],pipes:[ae.X$],styles:[".igo-layer-filters-container[_ngcontent-%COMP%]{padding-left:5px}mat-slider[_ngcontent-%COMP%]     div.mat-slider-thumb-label{width:32px;height:32px;margin:0 auto}mat-slider[_ngcontent-%COMP%]     span.mat-slider-thumb-label-text{font-size:10px}#time-slider[_ngcontent-%COMP%]{width:70%;margin:0 auto}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){#time-slider[_ngcontent-%COMP%]{width:60%;margin:0 auto}}.date-below[_ngcontent-%COMP%]{margin:0}mat-form-field[_ngcontent-%COMP%]{text-align:center}mat-datetimepicker-toggle[_ngcontent-%COMP%]     .mat-icon{padding-bottom:30px}.igo-layer-actions-container[_ngcontent-%COMP%] > .mat-slide-toggle[_ngcontent-%COMP%]{vertical-align:middle}"]}),e}(),pf=function(e){return{disabled:e}};function df(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",10),w.NdJ("click",function(){w.CHM(i);var e=w.oxw(2);return e.layer.visible=!e.layer.visible}),w.ALo(1,"translate"),w.ALo(2,"translate"),w._UZ(3,"mat-icon",11),w.ALo(4,"async"),w.qZA()}if(2&e){var o=w.oxw(2);w.Q6J("color",o.layer.visible?"primary":"default")("matTooltip",o.layer.visible?w.lcZ(1,4,"igo.geo.layer.hideLayer"):w.lcZ(2,6,"igo.geo.layer.showLayer")),w.xp6(3),w.Q6J("ngClass",w.VKq(10,pf,!1===w.lcZ(4,8,o.inResolutionRange$)))("svgIcon",o.layer.visible?"eye":"eye-off")}}var hf=function(e){return{cursor:e}};function gf(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-list-item"),w.TgZ(1,"mat-icon",7),w.NdJ("click",function(){return w.CHM(i),w.oxw().toggleFiltersCollapsed()}),w.qZA(),w.TgZ(2,"h4",8),w.NdJ("click",function(){return w.CHM(i),w.oxw().toggleLegendOnClick()}),w._uU(3),w.qZA(),w.YNc(4,df,5,12,"button",9),w.qZA()}if(2&e){var o=w.oxw(),n=w.MAs(2);w.xp6(1),w.Q6J("target",n)("collapsed",o.filtersCollapsed),w.xp6(1),w.Q6J("ngStyle",w.VKq(5,hf,o.filtersCollapsed?"default":"pointer")),w.xp6(1),w.Oqu(o.layer.title),w.xp6(1),w.Q6J("ngIf",o.header)}}function ff(e,t){if(1&e&&w._UZ(0,"igo-layer-legend",12),2&e){var i=w.oxw();w.Q6J("layer",i.layer)}}var mf=function(){var e=function(){function e(t){m(this,e),this.timeFilterService=t,this.color="primary",this.showLegend$=new R.X(!1),this.inResolutionRange$=new R.X(!0),this.filtersCollapsed=!1,this.header=!0}return y(e,[{key:"datasource",get:function(){return this.layer.dataSource}},{key:"ngOnInit",value:function(){var e=this;this.resolution$$=this.layer.map.viewController.resolution$.subscribe(function(){e.inResolutionRange$.next(e.layer.isInResolutionsRange)})}},{key:"ngOnDestroy",value:function(){this.resolution$$.unsubscribe()}},{key:"handleYearChange",value:function(e){this.timeFilterService.filterByYear(this.datasource,e)}},{key:"handleDateChange",value:function(e){this.timeFilterService.filterByDate(this.datasource,e)}},{key:"toggleLegend",value:function(e){this.layer.legendCollapsed=e,this.showLegend$.next(!e)}},{key:"toggleLegendOnClick",value:function(){this.filtersCollapsed||this.toggleLegend(this.showLegend$.value)}},{key:"setVisible",value:function(){this.layer.visible=!0}},{key:"toggleFiltersCollapsed",value:function(){this.filtersCollapsed=!this.filtersCollapsed}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(hh))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-time-filter-item"]],inputs:{header:"header",layer:"layer"},decls:8,vars:7,consts:[[4,"ngIf"],[1,"igo-datasource-filters-container"],["filters",""],[1,"igo-layer-legend-container"],["legend",""],[3,"layer",4,"ngIf"],[3,"layer","options","currentValue","change","yearChange"],["mat-list-avatar","","igoCollapse","","svgIcon","chevron-up",1,"igo-chevron",3,"target","collapsed","click"],["matLine","",3,"ngStyle","click"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"color","matTooltip","click",4,"ngIf"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"color","matTooltip","click"],[3,"ngClass","svgIcon"],[3,"layer"]],template:function(e,t){1&e&&(w.YNc(0,gf,5,7,"mat-list-item",0),w.TgZ(1,"div",1,2),w.TgZ(3,"div",3,4),w.YNc(5,ff,1,1,"igo-layer-legend",5),w.ALo(6,"async"),w.qZA(),w.TgZ(7,"igo-time-filter-form",6),w.NdJ("change",function(e){return t.handleDateChange(e)})("yearChange",function(e){return t.handleYearChange(e)}),w.qZA(),w.qZA()),2&e&&(w.Q6J("ngIf",t.header),w.xp6(5),w.Q6J("ngIf",w.lcZ(6,5,t.showLegend$)),w.xp6(2),w.Q6J("layer",t.layer)("options",t.datasource.options.timeFilter)("currentValue",t.datasource.options.params.TIME))},styles:["[_nghost-%COMP%]{overflow:hidden}.igo-datasource-filters-container[_ngcontent-%COMP%]{text-align:center;width:100%;display:inline-block;padding-top:5px}.igo-layer-legend-container[_ngcontent-%COMP%]{padding-left:1.125em;width:calc(100% - 18px)}"]}),e}();function vf(e,t){if(1&e&&w._UZ(0,"igo-time-filter-item",2),2&e){var i=t.$implicit;w.Q6J("header",!0)("layer",i)}}var yf=function(){var e=function(){function e(t){m(this,e),this.cdRef=t,this._layers=[]}return y(e,[{key:"layers",get:function(){return this._layers},set:function(e){this._layers=e,this.cdRef.detectChanges()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(w.sBO))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-time-filter-list"]],inputs:{layers:"layers"},decls:3,vars:6,consts:[[3,"navigation","selection"],["ngFor","",3,"ngForOf"],["igoListItem","",3,"header","layer"]],template:function(e,t){1&e&&(w.TgZ(0,"igo-list",0),w.YNc(1,vf,1,2,"ng-template",1),w.ALo(2,"filterableDataSource"),w.qZA()),2&e&&(w.Q6J("navigation",!1)("selection",!1),w.xp6(1),w.Q6J("ngForOf",w.xi3(2,3,t.layers,"time")))},encapsulation:2,changeDetection:0}),e}(),bf=function(){var e=function(){function e(){m(this,e)}return y(e,[{key:"wktToFeature",value:function(e,t,i){return(new $s.Z).readFeature(e,{dataProjection:t,featureProjection:i})}},{key:"extentToWkt",value:function(e,t,i){var o=ls.$A(t,i,e);return o=this.roundCoordinateArray(o,e,0),{wktPoly:"POLYGON((\n      ".concat(t[0]," ").concat(t[1],",\n      ").concat(t[0]," ").concat(t[3],",\n      ").concat(t[2]," ").concat(t[3],",\n      ").concat(t[2]," ").concat(t[1],",\n      ").concat(t[0]," ").concat(t[1],"))"),wktLine:"LINESTRING(\n      ".concat(t[0]," ").concat(t[1],",\n      ").concat(t[0]," ").concat(t[3],",\n      ").concat(t[2]," ").concat(t[3],",\n      ").concat(t[2]," ").concat(t[1],",\n      ").concat(t[0]," ").concat(t[1],")"),wktMultiPoints:"MULTIPOINT(\n        ".concat(t[0]," ").concat(t[1],",\n        ").concat(t[0]," ").concat(t[3],",\n        ").concat(t[2]," ").concat(t[3],",\n        ").concat(t[2]," ").concat(t[1],")")}}},{key:"roundCoordinateArray",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=ls.U2(t).getUnits();return-1!==["ft","m","us-ft"].indexOf(o)&&(e=this.roundArray(e,i)),e}},{key:"roundArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=0;i<e.length;)e[i]=e[i].toFixed(t),i++;return e}},{key:"snrcToWkt",value:function(e,t){e=e.toLowerCase();var i=[["m","n","o","p"],["l","k","j","i"],["e","f","g","h"],["d","c","b","a"]],o=[["13","14","15","16"],["12","11","10","09"],["05","06","07","08"],["04","03","02","01"]],n=!1,r=!1,a=!1;if(/\d{2,3}[a-p][0,1][0-9]/gi.test(e)?a=!0:/\d{2,3}[a-p]/gi.test(e)?r=!0:/\d{2,3}/gi.test(e)&&(n=!0),n?e+="a01":r&&(e+="01"),/\d{2,3}[a-p][0,1][0-9]/gi.test(e)){var s=e.split(/(?=[a-p])/gi),l=s[0],c=s[1][0],u=s[1].split(c)[1],p=1;3===l.length&&(p=2);var d=l.substring(0,p),h=l.substring(p),g=0,f=0,m=0,v=0;i.forEach(function(e){-1!==e.indexOf(c)&&(f=i.indexOf(e),g=e.indexOf(c))}),o.forEach(function(e){-1!==e.indexOf(u)&&(v=o.indexOf(e),m=e.indexOf(u))});var y=0,b=0,w=0,x=0,S=8,k=4;r?(y=2*g,b=1*f,w=0,x=0,S=2,k=1):a&&(y=2*g,b=1*f,w=.5*m,x=.25*v,S=.5,k=.25);var C={ul:[{1:{from:-56,to:-64},2:{from:-64,to:-72},3:{from:-72,to:-80},4:{from:-80,to:-88},5:{from:-88,to:-96},6:{from:-96,to:-104},7:{from:-104,to:-112},8:{from:-112,to:-120},9:{from:-120,to:-128},10:{from:-128,to:-136}}[d].to+y+w,{1:{from:44,to:48},2:{from:48,to:52},3:{from:52,to:56},4:{from:56,to:60},5:{from:60,to:64},6:{from:64,to:68},7:{from:68,to:72},8:{from:72,to:76},9:{from:76,to:-128}}[h].to-b-x]};return C.lr=[C.ul[0]+S,C.ul[1]-k],C.ur=[C.ul[0],C.ul[1]-k],C.ll=[C.ul[0]+S,C.ul[1]],C.ul=ls.vs([C.ul[0],C.ul[1]],"EPSG:4326",t),C.lr=ls.vs([C.lr[0],C.lr[1]],"EPSG:4326",t),C.ur=ls.vs([C.ur[0],C.ur[1]],"EPSG:4326",t),C.ll=ls.vs([C.ll[0],C.ll[1]],"EPSG:4326",t),C.ul=this.roundCoordinateArray(C.ul,t,0),C.lr=this.roundCoordinateArray(C.lr,t,0),C.ur=this.roundCoordinateArray(C.ur,t,0),C.ll=this.roundCoordinateArray(C.ll,t,0),{wktPoly:"POLYGON(("+[C.ul.join(" "),C.ur.join(" "),C.lr.join(" "),C.ll.join(" "),C.ul.join(" ")].join(",")+"))",wktLine:"LINESTRING("+[C.ul.join(" "),C.ur.join(" "),C.lr.join(" "),C.ll.join(" "),C.ul.join(" ")].join(",")+")",wktMultiPoints:"MULTIPOINT("+[C.ul.join(" "),C.ur.join(" "),C.lr.join(" "),C.ll.join(" ")].join(",")+")"}}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function wf(e,t){if(1&e&&(w.TgZ(0,"mat-option",23),w._uU(1),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i.alias)("id",i.name)("matTooltip",i.alias),w.xp6(1),w.hij(" ",i.alias," ")}}function xf(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",24),w.NdJ("click",function(){return w.CHM(i),w.oxw(2).clearSelectedField()}),w._UZ(1,"mat-icon",25),w.qZA()}if(2&e){var o=w.oxw(2);w.Q6J("disabled",!o.currentFilter.active)}}function Sf(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-form-field",17),w.NdJ("mouseenter",function(){return w.CHM(i),w.oxw().inputClearable="selectField"})("mouseleave",function(){return w.CHM(i),w.oxw().inputClearable=void 0}),w.TgZ(1,"input",18),w.NdJ("input",function(e){return w.CHM(i),w.oxw().updateFieldsList(e.target.value)}),w.ALo(2,"translate"),w.ALo(3,"async"),w.ALo(4,"async"),w.ALo(5,"async"),w.ALo(6,"async"),w.ALo(7,"translate"),w.qZA(),w.TgZ(8,"mat-autocomplete",19,20),w.NdJ("optionSelected",function(e){return w.CHM(i),w.oxw().changeField(e.option.id)}),w.YNc(10,wf,2,4,"mat-option",21),w.ALo(11,"async"),w.qZA(),w.YNc(12,xf,2,1,"button",22),w.qZA()}if(2&e){var o=w.MAs(9),n=w.oxw();w.Q6J("floatLabel",n.floatLabel),w.xp6(1),w.Q6J("placeholder",w.lcZ(2,8,"igo.geo.sourceFields.selectField"))("disabled",!n.currentFilter.active)("matAutocomplete",o)("value",w.lcZ(3,10,n.selectedField$)?w.lcZ(4,12,n.selectedField$).alias:"")("matTooltip",w.lcZ(5,14,n.selectedField$)?w.lcZ(6,16,n.selectedField$).alias:w.lcZ(7,18,"igo.geo.sourceFields.selectField")),w.xp6(9),w.Q6J("ngForOf",w.lcZ(11,20,n.filteredFields$)),w.xp6(2),w.Q6J("ngIf",n.currentFilter.propertyName&&"selectField"===n.inputClearable&&n.currentFilter.active)}}function kf(e,t){if(1&e&&(w.TgZ(0,"mat-option",3),w.ALo(1,"translate"),w._uU(2),w.ALo(3,"translate"),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i.key)("matTooltip",w.lcZ(1,3,"igo.geo.operators.tooltip."+i.key)),w.xp6(2),w.hij(" ",w.lcZ(3,5,"igo.geo.operators."+i.key)," ")}}function Cf(e,t){if(1&e&&(w.TgZ(0,"mat-option",29),w._uU(1),w.ALo(2,"translate"),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i.type),w.xp6(1),w.hij(" ",w.lcZ(2,2,"igo.geo.spatialSelector."+i.type)," ")}}function Tf(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-form-field",26),w.TgZ(1,"mat-select",27),w.NdJ("selectionChange",function(e){return w.CHM(i),w.oxw().changeSpatialSelector(e.value)}),w.YNc(2,Cf,3,4,"mat-option",28),w.qZA(),w.qZA()}if(2&e){var o=w.oxw();w.xp6(1),w.Q6J("disabled",!o.currentFilter.active)("value",o.currentFilter.igoSpatialSelector),w.xp6(1),w.Q6J("ngForOf",o.igoSpatialSelectors)}}function Af(e,t){if(1&e&&(w.TgZ(0,"mat-option",33),w._uU(1),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i)("matTooltip",i),w.xp6(1),w.hij(" ",i," ")}}function Lf(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",24),w.NdJ("click",function(){return w.CHM(i),w.oxw(2).clearProperty()}),w._UZ(1,"mat-icon",25),w.qZA()}if(2&e){var o=w.oxw(2);w.Q6J("disabled",!o.currentFilter.active)}}function Zf(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-form-field",30),w.NdJ("mouseenter",function(){return w.CHM(i),w.oxw().inputClearable="selectProperty"})("mouseleave",function(){return w.CHM(i),w.oxw().inputClearable=void 0}),w.TgZ(1,"input",18),w.NdJ("input",function(e){return w.CHM(i),w.oxw().updateValuesList(e.target.value)}),w.ALo(2,"translate"),w.qZA(),w.TgZ(3,"mat-autocomplete",19,31),w.NdJ("optionSelected",function(e){return w.CHM(i),w.oxw().changeProperty(e.option.value)}),w.YNc(5,Af,2,3,"mat-option",32),w.ALo(6,"async"),w.qZA(),w.YNc(7,Lf,2,1,"button",22),w.qZA()}if(2&e){var o=w.MAs(4),n=w.oxw();w.Q6J("floatLabel",n.floatLabel),w.xp6(1),w.Q6J("placeholder",w.lcZ(2,8,"igo.geo.filter.placeholder"))("disabled",!n.currentFilter.active)("matAutocomplete",o)("value","expression"===n.detectProperty()?n.currentFilter.expression:n.currentFilter.pattern)("matTooltip","expression"===n.detectProperty()?n.currentFilter.expression||"":n.currentFilter.pattern||""),w.xp6(4),w.Q6J("ngForOf",w.lcZ(6,10,n.filteredValues$)),w.xp6(2),w.Q6J("ngIf",n.isClearable()&&"selectProperty"===n.inputClearable&&n.currentFilter.active)}}function Ff(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",24),w.NdJ("click",function(){return w.CHM(i),w.oxw(2).currentFilter.igoSNRC=""}),w._UZ(1,"mat-icon",25),w.qZA()}if(2&e){var o=w.oxw(2);w.Q6J("disabled",!o.currentFilter.active&&"selectSNRC"===o.inputClearable&&o.currentFilter.active)}}function Of(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-form-field",34),w.NdJ("mouseenter",function(){return w.CHM(i),w.oxw().inputClearable="selectSNRC"})("mouseleave",function(){return w.CHM(i),w.oxw().inputClearable=void 0}),w.TgZ(1,"input",35),w.NdJ("input",function(e){return w.CHM(i),w.oxw().changeSNRC(e.target.value)}),w.ALo(2,"translate"),w.qZA(),w.YNc(3,Ff,2,1,"button",22),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("floatLabel",o.floatLabel),w.xp6(1),w.Q6J("placeholder",w.lcZ(2,5,"igo.geo.filter.placeholderSnrc"))("value",o.currentFilter.igoSNRC)("matTooltip",o.currentFilter.igoSNRC?o.currentFilter.igoSNRC:""),w.xp6(2),w.Q6J("ngIf",o.currentFilter.igoSNRC)}}function Mf(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",37),w.NdJ("click",function(){return w.CHM(i),w.oxw(2).changeMapExtentGeometry()}),w.ALo(1,"translate"),w._UZ(2,"mat-icon",38),w.qZA()}if(2&e){var o=w.oxw(2);w.Q6J("disabled",!o.currentFilter.active)("disabled",!o.currentFilter.active)("matTooltip",w.lcZ(1,3,"igo.geo.spatialSelector.btnSetExtent"))}}function If(e,t){if(1&e&&(w.ynx(0),w.YNc(1,Mf,3,5,"button",36),w.BQk()),2&e){var i=w.oxw();w.xp6(1),w.Q6J("ngIf","fixedExtent"===i.currentFilter.igoSpatialSelector)}}function Pf(e,t){if(1&e&&(w.TgZ(0,"mat-option",33),w._uU(1),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i)("matTooltip",i),w.xp6(1),w.hij(" ",i," ")}}function _f(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",24),w.NdJ("click",function(){return w.CHM(i),w.oxw(2).clearProperty(1)}),w._UZ(1,"mat-icon",25),w.qZA()}if(2&e){var o=w.oxw(2);w.Q6J("disabled",!o.currentFilter.active)}}function qf(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-form-field",39),w.NdJ("mouseenter",function(){return w.CHM(i),w.oxw().inputClearable="selectProperty1"})("mouseleave",function(){return w.CHM(i),w.oxw().inputClearable=void 0}),w.TgZ(1,"input",40),w.NdJ("input",function(e){return w.CHM(i),w.oxw().updateValuesList(e.target.value,1)}),w.ALo(2,"translate"),w.qZA(),w.TgZ(3,"mat-autocomplete",19,41),w.NdJ("optionSelected",function(e){return w.CHM(i),w.oxw().changeNumericProperty(e.option.value,1)}),w.YNc(5,Pf,2,3,"mat-option",32),w.ALo(6,"async"),w.qZA(),w.YNc(7,_f,2,1,"button",22),w.qZA()}if(2&e){var o=w.MAs(4),n=w.oxw();w.Q6J("floatLabel",n.floatLabel),w.xp6(1),w.Q6J("placeholder",w.lcZ(2,7,"igo.geo.filter.placeholder"))("disabled",!n.currentFilter.active)("matAutocomplete",o)("value","lowerBoundary"===n.detectProperty(1)?n.currentFilter.lowerBoundary:n.currentFilter.begin),w.xp6(4),w.Q6J("ngForOf",w.lcZ(6,9,n.filteredValues$)),w.xp6(2),w.Q6J("ngIf",n.isClearable(1)&&"selectProperty1"===n.inputClearable&&n.currentFilter.active)}}function Df(e,t){if(1&e&&(w.TgZ(0,"mat-option",33),w._uU(1),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i)("matTooltip",i),w.xp6(1),w.hij(" ",i," ")}}function Ef(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",24),w.NdJ("click",function(){return w.CHM(i),w.oxw(2).clearProperty(2)}),w._UZ(1,"mat-icon",25),w.qZA()}if(2&e){var o=w.oxw(2);w.Q6J("disabled",!o.currentFilter.active)}}function $f(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-form-field",39),w.NdJ("mouseenter",function(){return w.CHM(i),w.oxw().inputClearable="selectProperty2"})("mouseleave",function(){return w.CHM(i),w.oxw().inputClearable=void 0}),w.TgZ(1,"input",40),w.NdJ("input",function(e){return w.CHM(i),w.oxw().updateValuesList(e.target.value,2)}),w.ALo(2,"translate"),w.qZA(),w.TgZ(3,"mat-autocomplete",19,42),w.NdJ("optionSelected",function(e){return w.CHM(i),w.oxw().changeNumericProperty(e.option.value,2)}),w.YNc(5,Df,2,3,"mat-option",32),w.ALo(6,"async"),w.qZA(),w.YNc(7,Ef,2,1,"button",22),w.qZA()}if(2&e){var o=w.MAs(4),n=w.oxw();w.Q6J("floatLabel",n.floatLabel),w.xp6(1),w.Q6J("placeholder",w.lcZ(2,7,"igo.geo.filter.placeholder"))("disabled",!n.currentFilter.active)("matAutocomplete",o)("value","upperBoundary"===n.detectProperty(2)?n.currentFilter.upperBoundary:n.currentFilter.end),w.xp6(4),w.Q6J("ngForOf",w.lcZ(6,9,n.filteredValues$)),w.xp6(2),w.Q6J("ngIf",n.isClearable(2)&&"selectProperty2"===n.inputClearable&&n.currentFilter.active)}}function Rf(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"igo-ogc-filter-time",43),w.NdJ("datasourceChange",function(e){return w.CHM(i),w.oxw().datasource=e})("currentFilterChange",function(e){return w.CHM(i),w.oxw().currentFilter=e})("changeProperty",function(e){return w.CHM(i),w.oxw().changeProperty(e.value,e.pos)}),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("datasource",o.datasource)("currentFilter",o.currentFilter)}}var Nf=function(e,t){return{logical:e,logicalHidden:t}},Uf=function(e,t){return{operator:e,dualInput:t}},Jf=function(){return["expression","pattern"]},Bf=function(){return["lowerBoundary","begin"]},jf=function(){return["upperBoundary","end"]},Qf=function(){var e=function(){function e(t){m(this,e),this.wktService=t,this.ogcFilterOperator=vc,this.ogcFilterOperators$=new R.X(void 0),this.value="",this.selectedField$=new R.X(void 0),this.fields$=new R.X([]),this.color="primary",this.currentFilterIsSpatial$=new R.X(!1),this.defaultStepMillisecond=6e3,this._snrc="",this.floatLabel="never",this.allOgcFilterOperators=(new bc).operators,this.ogcFilterOperators$.next(this.allOgcFilterOperators),this.igoSpatialSelectors=[{type:"fixedExtent"},{type:"snrc"}]}return y(e,[{key:"snrc",get:function(){return this._snrc},set:function(e){(/^\d{2}$/gi.test(e)||/^\d{2}[a-p]$/gi.test(e)||/^\d{2}[a-l][0,1][0-9]$/gi.test(e))&&(this._snrc=e,this.currentFilter.igoSNRC=e)}},{key:"activeFilters",get:function(){return this.datasource.options.ogcFilters.interfaceOgcFilters.filter(function(e){return!0===e.active})}},{key:"allowedOperators",get:function(){return(new bc).computeAllowedOperators(this.fields$.value,this.currentFilter.propertyName,this.datasource.options.ogcFilters.allowedOperatorsType)}},{key:"ngOnInit",value:function(){var e=this;if(this.datasource.options.sourceFields){var t=this.datasource.options.sourceFields.filter(function(e){return void 0===e.excludeFromOgcFilters||!e.excludeFromOgcFilters});t.map(function(e){e.values&&e.values.sort()}),this.fields$.next(t)}this.updateFieldsList(),this.selectedField$.next(this.fields$.value.find(function(t){return t.name===e.currentFilter.propertyName})),this.updateValuesList(),this.selectedField$.subscribe(function(t){e.ogcFilterOperators$.next(e.allowedOperators),-1===Object.keys(e.allowedOperators).indexOf(e.currentFilter.operator)&&(e.currentFilter.operator=Object.keys(e.allowedOperators)[0],e.currentFilter.operator=Object.keys(e.allowedOperators)[0]),e.updateValuesList()}),this.currentFilterIsSpatial()}},{key:"updateFieldsList",value:function(e){this.filteredFields$=e&&e.length>0?(0,U.of)(this._filterFields(e)):this.fields$,this.fields$.value.find(function(t){return t.name===e})&&this.changeField(e)}},{key:"updateValuesList",value:function(e,t){this.filteredValues$=(0,U.of)(e&&e.length>0?this._filterValues(e):this.selectedField$.value?this.selectedField$.value.values:[]),e&&e.length>=1&&this.changeProperty(e,t)}},{key:"_filterFields",value:function(e){var t=new RegExp(e.normalize("NFD").replace(/[\u0300-\u036f]/g,""),"gi");return this.fields$.value.filter(function(e){return t.test(e.alias.normalize("NFD").replace(/[\u0300-\u036f]/g,""))})}},{key:"_filterValues",value:function(e){var t=new RegExp(e.toString().normalize("NFD").replace(/[\u0300-\u036f]/g,""),"gi");return this.selectedField$.value.values.filter(function(e){return e&&t.test(e.toString().normalize("NFD").replace(/[\u0300-\u036f]/g,""))})}},{key:"clearSelectedField",value:function(){this.currentFilter.propertyName="",this.selectedField$.next(void 0),this.clearProperty()}},{key:"isClearable",value:function(e){var t=this.detectProperty(e);if(t)return this.currentFilter[t]}},{key:"clearProperty",value:function(e){var t=this.detectProperty(e);if(t)return this.currentFilter[t]=""}},{key:"toggleFilterState",value:function(e){var t=this;this.datasource.options.ogcFilters.interfaceOgcFilters.find(function(e){return e.filterid===t.currentFilter.filterid}).active=e.checked,this.refreshFilters()}},{key:"deleteFilter",value:function(){var e=this,t=this.datasource.options.ogcFilters;t.interfaceOgcFilters=t.interfaceOgcFilters.filter(function(t){return t.filterid!==e.currentFilter.filterid}),this.refreshFilters()}},{key:"changeLogical",value:function(e){this.currentFilter.parentLogical=e,this.refreshFilters()}},{key:"changeOperator",value:function(e){this.currentFilter.operator=e,this.currentFilterIsSpatial(),this.currentFilterIsSpatial$.value&&0===this.currentFilter.wkt_geometry.length?this.changeSpatialSelector(this.currentFilter.igoSpatialSelector):this.refreshFilters()}},{key:"changeField",value:function(e){var t=this;this.currentFilter.propertyName=e,this.selectedField$.next(this.fields$.value.find(function(e){return e.name===t.currentFilter.propertyName})),this.refreshFilters()}},{key:"changeCaseSensitive",value:function(e){this.currentFilter.matchCase=e.checked,this.refreshFilters()}},{key:"changeProperty",value:function(e,t){var i=this,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.detectProperty(t);n&&(this.datasource.options.ogcFilters.interfaceOgcFilters.find(function(e){return e.filterid===i.currentFilter.filterid})[n]=e,o&&this.refreshFilters())}},{key:"changeNumericProperty",value:function(e,t){this.changeProperty(parseFloat(e),t)}},{key:"changeSpatialSelector",value:function(e){this.currentFilter.igoSpatialSelector=e,"fixedExtent"===e&&this.changeMapExtentGeometry(!1),this.currentFilterIsSpatial(),this.refreshFilters()}},{key:"changeSNRC",value:function(e){this.snrc=e,this.changeSNRCGeometry()}},{key:"changeSNRCGeometry",value:function(){var e=this;!this.datasource.options.ogcFilters.interfaceOgcFilters.find(function(t){return t.filterid===e.currentFilter.filterid})||(this.snrc&&"snrc"===this.currentFilter.igoSpatialSelector&&(this.currentFilter.wkt_geometry=this.wktService.snrcToWkt(this.snrc,this.map.projection).wktPoly),this.refreshFilters())}},{key:"changeMapExtentGeometry",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];!this.datasource.options.ogcFilters.interfaceOgcFilters.find(function(t){return t.filterid===e.currentFilter.filterid})||("fixedExtent"===this.currentFilter.igoSpatialSelector&&(this.currentFilter.wkt_geometry=this.wktService.extentToWkt(this.map.projection,this.map.viewController.getExtent(),this.map.projection).wktPoly),t&&this.refreshFilters())}},{key:"detectProperty",value:function(e){switch(this.currentFilter.operator){case vc.PropertyIsNotEqualTo:case vc.PropertyIsEqualTo:case vc.PropertyIsGreaterThan:case vc.PropertyIsGreaterThanOrEqualTo:case vc.PropertyIsLessThan:case vc.PropertyIsLessThanOrEqualTo:return"expression";case vc.PropertyIsLike:return"pattern";case vc.PropertyIsBetween:return e&&1===e?"lowerBoundary":e&&2===e?"upperBoundary":void 0;case vc.During:return e&&1===e?"begin":e&&2===e?"end":void 0;default:return}}},{key:"currentFilterIsSpatial",value:function(){var e=!1;this.currentFilter&&(e=-1!==[vc.Contains,vc.Intersects,vc.Within].indexOf(this.currentFilter.operator)),this.currentFilterIsSpatial$.next(e)}},{key:"isTemporalOperator",value:function(){return this.currentFilter.operator.toLowerCase()===this.ogcFilterOperator.During.toLowerCase()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(bf))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-ogc-filter-form"]],inputs:{refreshFilters:"refreshFilters",datasource:"datasource",map:"map",currentFilter:"currentFilter",floatLabel:"floatLabel"},decls:42,vars:76,consts:[["tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","checked","click","change"],[3,"ngClass"],["tooltip-position","above","matTooltipShowDelay","500",3,"disabled","value","matTooltip","selectionChange"],["tooltip-position","above","matTooltipShowDelay","500",3,"value","matTooltip"],["class","field",3,"floatLabel","mouseenter","mouseleave",4,"ngIf"],[3,"ngClass","floatLabel"],["tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","disabled","value","selectionChange"],["tooltip-position","above","matTooltipShowDelay","500",3,"value","matTooltip",4,"ngFor","ngForOf"],["class","spatialSelector",4,"ngIf"],["class","singleInput",3,"floatLabel","mouseenter","mouseleave",4,"ngIf"],[1,"igo-layer-button-group"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip","click"],["svgIcon","delete"],["class","snrc",3,"floatLabel","mouseenter","mouseleave",4,"ngIf"],[4,"ngIf"],["class","dualInput",3,"floatLabel","mouseenter","mouseleave",4,"ngIf"],[3,"datasource","currentFilter","datasourceChange","currentFilterChange","changeProperty",4,"ngIf"],[1,"field",3,"floatLabel","mouseenter","mouseleave"],["matInput","","tooltip-position","above","matTooltipShowDelay","500",3,"placeholder","disabled","matAutocomplete","value","matTooltip","input"],[3,"optionSelected"],["autoCompleteField","matAutocomplete"],["matTooltipShowDelay","500",3,"value","id","matTooltip",4,"ngFor","ngForOf"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"disabled","click",4,"ngIf"],["matTooltipShowDelay","500",3,"value","id","matTooltip"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"disabled","click"],["svgIcon","close"],[1,"spatialSelector"],[3,"disabled","value","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"singleInput",3,"floatLabel","mouseenter","mouseleave"],["autoCompleteValues","matAutocomplete"],["matTooltipShowDelay","500",3,"value","matTooltip",4,"ngFor","ngForOf"],["matTooltipShowDelay","500",3,"value","matTooltip"],[1,"snrc",3,"floatLabel","mouseenter","mouseleave"],["matInput","","tooltip-position","above","matTooltipShowDelay","500",3,"placeholder","value","matTooltip","input"],["mat-button","","matSuffix","","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"disabled","matTooltip","click",4,"ngIf"],["mat-button","","matSuffix","","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"disabled","matTooltip","click"],["svgIcon","arrow-expand-all"],[1,"dualInput",3,"floatLabel","mouseenter","mouseleave"],["matInput","","type","number",3,"placeholder","disabled","matAutocomplete","value","input"],["autoDualValueOperator1","matAutocomplete"],["autoDualValueOperator2","matAutocomplete"],[3,"datasource","currentFilter","datasourceChange","currentFilterChange","changeProperty"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-checkbox",0),w.NdJ("click",function(e){return e.stopPropagation()})("change",function(e){return t.toggleFilterState(e)}),w.ALo(1,"translate"),w.qZA(),w.TgZ(2,"mat-form-field",1),w.TgZ(3,"mat-select",2),w.NdJ("selectionChange",function(e){return t.changeLogical(e.value)}),w.ALo(4,"translate"),w.TgZ(5,"mat-option",3),w.ALo(6,"translate"),w._uU(7),w.ALo(8,"translate"),w.qZA(),w.TgZ(9,"mat-option",3),w.ALo(10,"translate"),w._uU(11),w.ALo(12,"translate"),w.qZA(),w.qZA(),w.qZA(),w.YNc(13,Sf,13,22,"mat-form-field",4),w.ALo(14,"async"),w.ALo(15,"async"),w.ALo(16,"async"),w.ALo(17,"async"),w.TgZ(18,"mat-form-field",5),w.ALo(19,"async"),w.ALo(20,"async"),w.TgZ(21,"mat-select",6),w.NdJ("selectionChange",function(e){return t.changeOperator(e.value)}),w.ALo(22,"translate"),w.ALo(23,"translate"),w.YNc(24,kf,4,7,"mat-option",7),w.ALo(25,"keyvalue"),w.ALo(26,"async"),w.qZA(),w.qZA(),w.YNc(27,Tf,3,3,"mat-form-field",8),w.ALo(28,"async"),w.YNc(29,Zf,8,12,"mat-form-field",9),w.TgZ(30,"div",10),w.TgZ(31,"button",11),w.NdJ("click",function(){return t.deleteFilter()}),w.ALo(32,"translate"),w._UZ(33,"mat-icon",12),w.qZA(),w.qZA(),w.YNc(34,Of,4,7,"mat-form-field",13),w.ALo(35,"async"),w.YNc(36,If,2,1,"ng-container",14),w.ALo(37,"async"),w._UZ(38,"br"),w.YNc(39,qf,8,11,"mat-form-field",15),w.YNc(40,$f,8,11,"mat-form-field",15),w.YNc(41,Rf,1,2,"igo-ogc-filter-time",16)),2&e&&(w.Q6J("matTooltip",w.lcZ(1,27,"igo.geo.filter.toggleFilterState"))("checked",t.currentFilter.active),w.xp6(2),w.Q6J("ngClass",w.WLB(67,Nf,0!==t.activeFilters.indexOf(t.currentFilter)&&!0===t.currentFilter.active,0===t.activeFilters.indexOf(t.currentFilter)||!0!==t.currentFilter.active)),w.xp6(1),w.Q6J("disabled",!t.currentFilter.active)("value",t.currentFilter.parentLogical)("matTooltip",t.currentFilter.parentLogical?w.lcZ(4,29,"igo.geo.operators.tooltip."+t.currentFilter.parentLogical):""),w.xp6(2),w.Q6J("value",t.ogcFilterOperator.And)("matTooltip",w.lcZ(6,31,"igo.geo.operators.tooltip.And")),w.xp6(2),w.hij(" ",w.lcZ(8,33,"igo.geo.operators.And")," "),w.xp6(2),w.Q6J("value",t.ogcFilterOperator.Or)("matTooltip",w.lcZ(10,35,"igo.geo.operators.tooltip.Or")),w.xp6(2),w.hij(" ",w.lcZ(12,37,"igo.geo.operators.Or")," "),w.xp6(2),w.Q6J("ngIf",!1===w.lcZ(14,39,t.currentFilterIsSpatial$)&&w.lcZ(15,41,t.fields$)&&w.lcZ(16,43,t.fields$).length>0&&""!==w.lcZ(17,45,t.fields$)[0].name),w.xp6(5),w.Q6J("ngClass",w.WLB(70,Uf,!1===w.lcZ(19,47,t.currentFilterIsSpatial$),w.lcZ(20,49,t.currentFilterIsSpatial$)))("floatLabel",t.floatLabel),w.xp6(3),w.Q6J("matTooltip",t.currentFilter.operator?w.lcZ(22,51,"igo.geo.operators.tooltip."+t.currentFilter.operator):w.lcZ(23,53,"igo.geo.filter.selectOperator"))("disabled",!t.currentFilter.active)("value",t.currentFilter.operator),w.xp6(3),w.Q6J("ngForOf",w.lcZ(25,55,w.lcZ(26,57,t.ogcFilterOperators$))),w.xp6(3),w.Q6J("ngIf",w.lcZ(28,59,t.currentFilterIsSpatial$)),w.xp6(2),w.Q6J("ngIf",-1!==w.DdM(73,Jf).indexOf(t.detectProperty())),w.xp6(2),w.Q6J("matTooltip",w.lcZ(32,61,"igo.geo.filter.removeFilter")),w.xp6(3),w.Q6J("ngIf",w.lcZ(35,63,t.currentFilterIsSpatial$)&&"snrc"===t.currentFilter.igoSpatialSelector),w.xp6(2),w.Q6J("ngIf",w.lcZ(37,65,t.currentFilterIsSpatial$)&&"fixedExtent"===t.currentFilter.igoSpatialSelector),w.xp6(3),w.Q6J("ngIf",!t.isTemporalOperator()&&-1!==w.DdM(74,Bf).indexOf(t.detectProperty(1))),w.xp6(1),w.Q6J("ngIf",!t.isTemporalOperator()&&-1!==w.DdM(75,jf).indexOf(t.detectProperty(2))),w.xp6(1),w.Q6J("ngIf",t.isTemporalOperator()))},styles:["[_nghost-%COMP%]{width:100%;padding:5px 10px}  .mat-form-field .mat-icon svg{width:1em;height:1em;color:#d3d3d3}.mat-form-field[_ngcontent-%COMP%]{width:100%}.mat-select-arrow[_ngcontent-%COMP%]{visibility:hidden}.mat-slide-toggle[_ngcontent-%COMP%]{margin-top:10px}.logical[_ngcontent-%COMP%]{flex-flow:column nowrap;width:10%;max-width:45px;margin-left:5px}.logicalHidden[_ngcontent-%COMP%]{flex-flow:column nowrap;width:10%;visibility:hidden;max-width:45px;margin-left:5px}  .logical .mat-select-arrow{visibility:hidden}  .logicalHidden .mat-select-arrow{visibility:hidden}.field[_ngcontent-%COMP%]{width:20%;margin-left:5px}  .field .mat-select-arrow{visibility:hidden}.operator[_ngcontent-%COMP%]{width:12%;margin-left:10px;text-align:center}  .operator .mat-select-arrow{visibility:hidden}.spatialSelector[_ngcontent-%COMP%]{width:15%;margin-left:5px}  .spatialSelector .mat-select-arrow{visibility:hidden}.singleInput[_ngcontent-%COMP%]{width:30%;margin-left:5px}.snrc[_ngcontent-%COMP%]{width:20%;margin-left:5px}  .singleInput .mat-select-arrow{visibility:hidden}.dualInput[_ngcontent-%COMP%]{width:20%;margin-left:5px}  .dualInput .mat-select-arrow{visibility:hidden}.igo-layer-button-group[_ngcontent-%COMP%]{display:flex;float:right;padding-top:5px}.container[_ngcontent-%COMP%]{display:flex}"]}),e}();function Gf(e,t){if(1&e&&w._UZ(0,"igo-ogc-filter-selection",2),2&e){var i=w.oxw();w.Q6J("refreshFilters",i.refreshFunc)("datasource",i.datasource)("map",i.map)("currentFilter",i.currentFilter)}}function Yf(e,t){if(1&e&&w._UZ(0,"igo-ogc-filter-form",4),2&e){var i=t.$implicit,o=w.oxw(2);w.Q6J("currentFilter",i)("refreshFilters",o.refreshFunc)("datasource",o.datasource)("map",o.map)}}function zf(e,t){if(1&e&&w.YNc(0,Yf,1,4,"ng-template",3),2&e){var i=w.oxw();w.Q6J("ngForOf",i.datasource.options.ogcFilters.interfaceOgcFilters)}}var Vf=function(){var e=function(){function e(){m(this,e),this.color="primary"}return y(e,[{key:"refreshFunc",get:function(){return this.refreshFilters}},{key:"advancedOgcFilters",get:function(){if(this.datasource.options.ogcFilters)return this.datasource.options.ogcFilters.advancedOgcFilters}},{key:"currentFilter",get:function(){return this.datasource.options.ogcFilters.interfaceOgcFilters?this.datasource.options.ogcFilters.interfaceOgcFilters[0]:void 0}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-ogc-filterable-form"]],inputs:{datasource:"datasource",map:"map",refreshFilters:"refreshFilters"},decls:2,vars:2,consts:[["igoListItem","",3,"refreshFilters","datasource","map","currentFilter",4,"ngIf"],[4,"ngIf"],["igoListItem","",3,"refreshFilters","datasource","map","currentFilter"],["ngFor","",3,"ngForOf"],[3,"currentFilter","refreshFilters","datasource","map"]],template:function(e,t){1&e&&(w.YNc(0,Gf,1,4,"igo-ogc-filter-selection",0),w.YNc(1,zf,1,1,void 0,1)),2&e&&(w.Q6J("ngIf",!t.advancedOgcFilters),w.xp6(1),w.Q6J("ngIf",t.advancedOgcFilters&&t.datasource.options.ogcFilters.editable))},encapsulation:2}),e}();function Hf(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-icon",8),w.NdJ("click",function(){return w.CHM(i),w.oxw().toggleFiltersCollapsed()}),w.qZA()}if(2&e){var o=w.oxw(),n=w.MAs(6);w.Q6J("target",n)("collapsed",o.filtersCollapsed)}}var Wf=function(e){return{cursor:e}};function Xf(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"h4",9),w.NdJ("click",function(){return w.CHM(i),w.oxw().toggleLegendOnClick()}),w._uU(1),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("ngStyle",w.VKq(3,Wf,o.filtersCollapsed?"default":"pointer"))("matTooltip",o.layer.title),w.xp6(1),w.Oqu(o.layer.title)}}function Kf(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",10),w.NdJ("click",function(){return w.CHM(i),w.oxw().addFilterToSequence()}),w.ALo(1,"translate"),w._UZ(2,"mat-icon",11),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("disabled",o.addFilterDisabled())("matTooltip",w.lcZ(1,3,"igo.geo.filter.addFilter"))("color",o.color)}}var em=function(e){return{disabled:e}};function tm(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",12),w.NdJ("click",function(){w.CHM(i);var e=w.oxw();return e.layer.visible=!e.layer.visible}),w.ALo(1,"translate"),w.ALo(2,"translate"),w._UZ(3,"mat-icon",13),w.ALo(4,"async"),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("color",o.layer.visible?"primary":"default")("matTooltip",o.layer.visible?w.lcZ(1,4,"igo.geo.layer.hideLayer"):w.lcZ(2,6,"igo.geo.layer.showLayer")),w.xp6(3),w.Q6J("ngClass",w.VKq(10,em,!1===w.lcZ(4,8,o.inResolutionRange$)))("svgIcon",o.layer.visible?"eye":"eye-off")}}function im(e,t){if(1&e&&w._UZ(0,"igo-layer-legend",17),2&e){var i=w.oxw(2);w.Q6J("layer",i.layer)}}function om(e,t){if(1&e&&(w.TgZ(0,"div",14,15),w.YNc(2,im,1,1,"igo-layer-legend",16),w.ALo(3,"async"),w.qZA()),2&e){var i=w.oxw();w.xp6(2),w.Q6J("ngIf",w.lcZ(3,1,i.showLegend$))}}function nm(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"section",18),w._UZ(1,"mat-divider"),w.TgZ(2,"mat-checkbox",19),w.NdJ("change",function(e){return w.CHM(i),w.oxw().changeOgcFilterType(e)})("ngModelChange",function(e){return w.CHM(i),w.oxw().datasource.options.ogcFilters.advancedOgcFilters=e}),w._uU(3),w.ALo(4,"translate"),w.qZA(),w.qZA()}if(2&e){var o=w.oxw();w.xp6(2),w.Q6J("ngModel",o.datasource.options.ogcFilters.advancedOgcFilters),w.xp6(1),w.hij(" ",w.lcZ(4,2,"igo.geo.filter.advancedOgcFilters")," ")}}var rm=function(){var e=function(){function e(t){m(this,e),this.ogcFilterService=t,this.color="primary",this.defaultLogicalParent=vc.And,this.hasActiveSpatialFilter=!1,this.filtersAreEditable=!0,this.filtersCollapsed=!0,this.hasSelector=!1,this.showLegend$=new R.X(!1),this.inResolutionRange$=new R.X(!0),this.header=!0,this.ogcFilterWriter=new bc}return y(e,[{key:"refreshFunc",get:function(){return this.refreshFilters.bind(this)}},{key:"datasource",get:function(){return this.layer.dataSource}},{key:"ngOnInit",value:function(){var e=this,t=this.datasource.options.ogcFilters;switch((t.pushButtons&&t.pushButtons.bundles.length>0||t.checkboxes&&t.checkboxes.bundles.length>0||t.radioButtons&&t.radioButtons.bundles.length>0||t.select&&t.select.bundles.length>0)&&(void 0===t.advancedOgcFilters&&(t.advancedOgcFilters=!1),this.hasSelector=!0),this.datasource.options.type){case"wms":this.ogcFilterService.setOgcWMSFiltersOptions(this.datasource);break;case"wfs":this.ogcFilterService.setOgcWFSFiltersOptions(this.datasource)}t&&(t.interfaceOgcFilters&&(this.lastRunOgcFilter=JSON.parse(JSON.stringify(t.interfaceOgcFilters)),t.interfaceOgcFilters.filter(function(e){return e.wkt_geometry}).length>=1&&(this.hasActiveSpatialFilter=!0)),this.filtersAreEditable=!!t.editable&&t.editable),this.resolution$$=this.layer.map.viewController.resolution$.subscribe(function(){e.inResolutionRange$.next(e.layer.isInResolutionsRange)})}},{key:"ngOnDestroy",value:function(){this.resolution$$.unsubscribe()}},{key:"addFilterToSequence",value:function(){this.filtersCollapsed=!1;var e,t=this.datasource.options.ogcFilters.interfaceOgcFilters||[],i=0===t.length?0:t[t.length-1].level,o="",n=this.datasource.options.sourceFields.filter(function(e){return!e.excludeFromOgcFilters});n.length>0&&(o=void 0===n[0].name?"":n[0].name);var r=this.datasource.options;r.fieldNameGeometry?e=r.fieldNameGeometry:this.datasource.options.paramsWFS&&this.datasource.options.paramsWFS.fieldNameGeometry&&(e=this.datasource.options.paramsWFS.fieldNameGeometry);var a=this.ogcFilterWriter.computeAllowedOperators(this.datasource.options.sourceFields,o,this.datasource.options.ogcFilters.allowedOperatorsType),s=Object.keys(a)[0];t.push(this.ogcFilterWriter.addInterfaceFilter({propertyName:o,operator:s,active:!0,igoSpatialSelector:"fixedExtent",srsName:this.map.projection},e,i,this.defaultLogicalParent)),this.datasource.options.ogcFilters.interfaceOgcFilters=t}},{key:"refreshFilters",value:function(e){!0===e&&(this.lastRunOgcFilter=void 0);var t=this.datasource.options.ogcFilters,i=t.interfaceOgcFilters?t.interfaceOgcFilters.filter(function(e){return!0===e.active}):[];if(0===i.length&&(t.filters=void 0,t.filtered=!1),i.length>1&&(i[0].parentLogical=i[1].parentLogical),this.hasActiveSpatialFilter=0!==i.filter(function(e){return-1!==["Contains","Intersects","Within"].indexOf(e.operator)}).length,JSON.stringify(this.lastRunOgcFilter)!==JSON.stringify(i)){if("wfs"===this.layer.dataSource.options.type)this.layer.dataSource.options.ogcFilters.filters=this.ogcFilterWriter.rebuiltIgoOgcFilterObjectFromSequence(i),this.layer.dataSource.ol.refresh();else if("wms"===this.layer.dataSource.options.type&&t.enabled){var o="";if(i.length>=1){var n=this.layer.dataSource,r=n.options.ogcFilters;r.filters=this.ogcFilterWriter.rebuiltIgoOgcFilterObjectFromSequence(i),o=this.ogcFilterWriter.buildFilter(r.filters,void 0,void 0,this.layer.dataSource.options.fieldNameGeometry,n.options)}this.ogcFilterService.filterByOgc(this.datasource,o),this.datasource.options.ogcFilters.filtered=0!==i.length}this.lastRunOgcFilter=JSON.parse(JSON.stringify(i))}this.layer.dataSource.setOgcFilters(t,!0)}},{key:"setVisible",value:function(){this.layer.visible=!0}},{key:"isAdvancedOgcFilters",value:function(){return this.datasource.options.ogcFilters.advancedOgcFilters}},{key:"addFilterDisabled",value:function(){return!this.datasource.options.sourceFields||0===this.datasource.options.sourceFields.length}},{key:"changeOgcFiltersAdvancedOgcFilters",value:function(e){this.datasource.options.ogcFilters.advancedOgcFilters=e}},{key:"changeOgcFilterType",value:function(e){this.changeOgcFiltersAdvancedOgcFilters(e.checked),e.checked&&this.refreshFilters(!0)}},{key:"toggleLegend",value:function(e){this.layer.legendCollapsed=e,this.showLegend$.next(!e)}},{key:"toggleLegendOnClick",value:function(){this.filtersCollapsed||this.toggleLegend(this.showLegend$.value)}},{key:"toggleFiltersCollapsed",value:function(){this.filtersCollapsed=!this.filtersCollapsed}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(gh))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-ogc-filterable-item"]],inputs:{layer:"layer",map:"map",header:"header"},decls:10,vars:9,consts:[["class","igo-chevron","mat-list-avatar","","igoCollapse","","svgIcon","chevron-up",3,"target","collapsed","click",4,"ngIf"],["matLine","","matTooltipShowDelay","500",3,"ngStyle","matTooltip","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"disabled","matTooltip","color","click",4,"ngIf"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"color","matTooltip","click",4,"ngIf"],["ogcFilters",""],["class","igo-layer-legend-container",4,"ngIf"],[3,"datasource","map","refreshFilters"],["class","mat-typography advancedOgcFilters",4,"ngIf"],["mat-list-avatar","","igoCollapse","","svgIcon","chevron-up",1,"igo-chevron",3,"target","collapsed","click"],["matLine","","matTooltipShowDelay","500",3,"ngStyle","matTooltip","click"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"disabled","matTooltip","color","click"],["svgIcon","plus"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"color","matTooltip","click"],[3,"ngClass","svgIcon"],[1,"igo-layer-legend-container"],["legend",""],[3,"layer",4,"ngIf"],[3,"layer"],[1,"mat-typography","advancedOgcFilters"],["labelPosition","before",3,"ngModel","change","ngModelChange"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-list-item"),w.YNc(1,Hf,1,2,"mat-icon",0),w.YNc(2,Xf,2,5,"h4",1),w.YNc(3,Kf,3,5,"button",2),w.YNc(4,tm,5,12,"button",3),w.qZA(),w.TgZ(5,"div",null,4),w.YNc(7,om,4,3,"div",5),w._UZ(8,"igo-ogc-filterable-form",6),w.YNc(9,nm,5,4,"section",7),w.qZA()),2&e&&(w.xp6(1),w.Q6J("ngIf",t.header),w.xp6(1),w.Q6J("ngIf",t.header),w.xp6(1),w.Q6J("ngIf",t.isAdvancedOgcFilters()&&t.filtersAreEditable),w.xp6(1),w.Q6J("ngIf",t.header),w.xp6(3),w.Q6J("ngIf",t.header),w.xp6(1),w.Q6J("datasource",t.datasource)("map",t.map)("refreshFilters",t.refreshFunc),w.xp6(1),w.Q6J("ngIf",t.hasSelector&&t.filtersAreEditable))},styles:["[_nghost-%COMP%]{overflow:hidden}.advancedOgcFilters[_ngcontent-%COMP%]{text-align:center;width:100%;display:inline-block}.mat-list-item[_ngcontent-%COMP%]{height:auto}.igo-layer-legend-container[_ngcontent-%COMP%]{padding-left:1.125em;width:calc(100% - 18px)}mat-icon.disabled[_ngcontent-%COMP%]{color:#00000061}"]}),e}();function am(e,t){if(1&e&&w._UZ(0,"igo-ogc-filterable-item",2),2&e){var i=t.$implicit;w.Q6J("header",!0)("layer",i)("map",i.map)}}var sm=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-ogc-filterable-list"]],inputs:{layers:"layers",map:"map"},decls:3,vars:6,consts:[[3,"navigation","selection"],["ngFor","",3,"ngForOf"],["igoListItem","",3,"header","layer","map"]],template:function(e,t){1&e&&(w.TgZ(0,"igo-list",0),w.YNc(1,am,1,3,"ng-template",1),w.ALo(2,"filterableDataSource"),w.qZA()),2&e&&(w.Q6J("navigation",!1)("selection",!1),w.xp6(1),w.Q6J("ngForOf",w.xi3(2,3,t.layers,"ogc")))},encapsulation:2,changeDetection:0}),e}();function lm(e,t){if(1&e&&(w.TgZ(0,"button",2),w.ALo(1,"translate"),w._UZ(2,"mat-icon",3),w.qZA()),2&e){var i=w.oxw();w.Q6J("matTooltip",w.lcZ(1,3,"igo.geo.filter.filterBy"))("color",i.color),w.xp6(2),w.Q6J("matBadge",i.badge)}}function cm(e,t){if(1&e&&w._UZ(0,"igo-ogc-filterable-item",7),2&e){var i=w.oxw(2);w.Q6J("header",!1)("map",i.layer.map)("layer",i.layer)}}function um(e,t){if(1&e&&(w.TgZ(0,"div",4,5),w.YNc(2,cm,1,3,"igo-ogc-filterable-item",6),w.qZA()),2&e){var i=w.oxw();w.xp6(2),w.Q6J("ngIf",i.ogcFilterCollapse&&i.options.ogcFilters.enabled)}}var pm=function(){var e=function(){function e(){m(this,e),this.color="primary",this.ogcFilterCollapse=!1}return y(e,[{key:"badge",get:function(){var e=this.options.ogcFilters,t=0;if(e&&!e.advancedOgcFilters){if(e.pushButtons){var i=e.pushButtons.groups.find(function(e){return e.enabled}),o=0;i&&i.computedSelectors.map(function(e){return o+=e.selectors.filter(function(e){return e.enabled}).length}),t+=o}if(e.checkboxes){var n=e.checkboxes.groups.find(function(e){return e.enabled}),r=0;n&&n.computedSelectors.map(function(e){return r+=e.selectors.filter(function(e){return e.enabled}).length}),t+=r}if(e.radioButtons){var a=e.radioButtons.groups.find(function(e){return e.enabled}),s=0;a&&a.computedSelectors.map(function(e){return s+=e.selectors.filter(function(e){return e.enabled}).length}),t+=s}if(e.select){var l=e.select.groups.find(function(e){return e.enabled}),c=0;l&&l.computedSelectors.map(function(e){return c+=e.selectors.filter(function(e){return e.enabled}).length}),t+=c}}else{if(e&&e.filters&&!e.filters.filters)return 1;if(e&&e.filters&&e.filters.filters)return e.filters.filters.length}if(e.filters&&"During"===e.filters.operator&&e.filters.active&&e.interfaceOgcFilters&&e.interfaceOgcFilters[0].active){var u=e.interfaceOgcFilters[0];e.filters.calendarModeYear?(u.begin.substring(0,4)!==this.options.minDate.substring(0,4)||u.end.substring(0,4)!==this.options.maxDate.substring(0,4))&&(t+=1):(u.begin!==this.options.minDate||u.end!==this.options.maxDate)&&(t+=1)}return t>0?t:void 0}},{key:"layer",get:function(){return this._layer},set:function(e){this._layer=e,e&&(this.options=this.layer.dataSource.options)}},{key:"ngOnInit",value:function(){this.options=this.layer.dataSource.options}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-ogc-filter-button"]],inputs:{layer:"layer",map:"map",color:"color",header:"header"},decls:2,vars:2,consts:[["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color",4,"ngIf"],["class","igo-layer-actions-container",4,"ngIf"],["mat-icon-button","","collapsibleButton","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color"],["matBadgeColor","warn","matBadgeSize","medium","svgIcon","filter",3,"matBadge"],[1,"igo-layer-actions-container"],["ogcFilter",""],["igoListItem","",3,"header","map","layer",4,"ngIf"],["igoListItem","",3,"header","map","layer"]],template:function(e,t){1&e&&(w.YNc(0,lm,3,5,"button",0),w.YNc(1,um,3,1,"div",1)),2&e&&(w.Q6J("ngIf",t.header&&t.options.ogcFilters&&t.options.ogcFilters.enabled&&(t.options.ogcFilters.pushButtons||t.options.ogcFilters.checkboxes||t.options.ogcFilters.radioButtons||t.options.ogcFilters.select||t.options.ogcFilters.editable)),w.xp6(1),w.Q6J("ngIf",t.options.ogcFilters&&t.options.ogcFilters.enabled&&(t.options.ogcFilters.pushButtons||t.options.ogcFilters.checkboxes||t.options.ogcFilters.radioButtons||t.options.ogcFilters.select||t.options.ogcFilters.editable)))},styles:[""],changeDetection:0}),e}(),dm=Xe,hm=function(){var e=function(){function e(){m(this,e),this.defaultStepMillisecond=6e4}return y(e,[{key:"step",value:function(e,t){return e.options.stepDate?e.options.stepDate:t.step}},{key:"stepMillisecond",value:function(e,t){var i=dm.duration(this.step(e,t)).asMilliseconds();return 0===i?this.defaultStepMillisecond:i}},{key:"stepIsYearDuration",value:function(e){var t=dm.duration(e);return 0!==t.years()&&0===t.months()&&0===t.weeks()&&0===t.days()&&0===t.hours()&&0===t.minutes()}},{key:"stepIsMonthDuration",value:function(e){var t=dm.duration(e);return 0!==t.months()&&0===t.weeks()&&0===t.days()&&0===t.hours()&&0===t.minutes()}},{key:"stepIsWeekDuration",value:function(e){var t=dm.duration(e);return 0!==t.weeks()&&7===t.days()&&0===t.hours()&&0===t.minutes()}},{key:"stepIsDayDuration",value:function(e){var t=dm.duration(e);return 0!==t.days()&&0===t.hours()&&0===t.minutes()}},{key:"stepIsHourDuration",value:function(e){var t=dm.duration(e);return 0!==t.hours()&&0===t.minutes()}},{key:"stepIsMinuteDuration",value:function(e){return 0!==dm.duration(e).minutes()}},{key:"dateToNumber",value:function(e){var t=new Date;return e&&(t=new Date(e)),t.getTime()}},{key:"addStep",value:function(e,t){return dm(e).add(t,"milliseconds").toDate()}},{key:"subtractStep",value:function(e,t){return dm(e).subtract(t,"milliseconds").toDate()}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac}),e}(),gm=["selection"];function fm(e,t){if(1&e&&(w.TgZ(0,"mat-option",12),w._uU(1),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i),w.xp6(1),w.hij("",i.title," ")}}function mm(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",9),w.TgZ(1,"mat-form-field"),w.TgZ(2,"mat-select",10),w.NdJ("valueChange",function(e){return w.CHM(i),w.oxw(3).currentPushButtonsGroup=e}),w.ALo(3,"translate"),w.YNc(4,fm,2,2,"mat-option",11),w.qZA(),w.qZA(),w.qZA()}if(2&e){var o=w.oxw(3);w.xp6(2),w.Q6J("matTooltip",w.lcZ(3,3,"igo.geo.layer.legend.selectStyle"))("value",o.currentPushButtonsGroup),w.xp6(2),w.Q6J("ngForOf",o.getPushButtonsGroups())}}function vm(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-button-toggle",15),w.NdJ("change",function(){var e=w.CHM(i).$implicit,t=w.oxw(3).$implicit;return w.oxw().onSelectionChange(e,t.selectorType)}),w._uU(1),w.qZA()}if(2&e){var o=t.$implicit,n=w.oxw(4);w.Q6J("matTooltip",n.getToolTip(o))("ngStyle",n.getButtonColor(o))("checked",o.enabled)("value",o),w.xp6(1),w.hij("",o.title," ")}}function ym(e,t){if(1&e&&(w.ynx(0),w.TgZ(1,"h4"),w._uU(2),w.qZA(),w.TgZ(3,"mat-button-toggle-group",13),w.YNc(4,vm,2,5,"mat-button-toggle",14),w.qZA(),w.BQk()),2&e){var i=t.$implicit,o=w.oxw(3);w.xp6(2),w.Oqu(i.title),w.xp6(1),w.s9C("vertical",o.bundleIsVertical(i)),w.xp6(1),w.Q6J("ngForOf",i.selectors)}}function bm(e,t){if(1&e&&(w.TgZ(0,"div",7),w._UZ(1,"mat-divider"),w.YNc(2,mm,5,5,"div",8),w.YNc(3,ym,5,3,"ng-container",1),w.qZA()),2&e){var i=w.oxw(2);w.xp6(2),w.Q6J("ngIf",i.getPushButtonsGroups().length>1),w.xp6(1),w.Q6J("ngForOf",i.currentPushButtonsGroup.computedSelectors)}}function wm(e,t){if(1&e&&(w.TgZ(0,"mat-option",12),w._uU(1),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i),w.xp6(1),w.hij("",i.title," ")}}function xm(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",9),w.TgZ(1,"mat-form-field"),w.TgZ(2,"mat-select",17),w.NdJ("valueChange",function(e){return w.CHM(i),w.oxw(3).currentCheckboxesGroup=e}),w.ALo(3,"translate"),w.YNc(4,wm,2,2,"mat-option",11),w.qZA(),w.qZA(),w.qZA()}if(2&e){var o=w.oxw(3);w.xp6(2),w.Q6J("matTooltip",w.lcZ(3,3,"igo.geo.layer.legend.selectStyle"))("value",o.currentCheckboxesGroup),w.xp6(2),w.Q6J("ngForOf",o.getCheckboxesGroups())}}function Sm(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-checkbox",20),w.NdJ("change",function(){var e=w.CHM(i).$implicit,t=w.oxw(3).$implicit;return w.oxw().onSelectionChange(e,t.selectorType)}),w._uU(1),w.qZA()}if(2&e){var o=t.$implicit,n=w.oxw(4);w.Q6J("matTooltip",n.getToolTip(o))("checked",o.enabled)("value",o),w.xp6(1),w.hij("",o.title," ")}}function km(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"u",23),w.NdJ("click",function(){return w.CHM(i),w.oxw(5).displayLessResults("checkbox")}),w._uU(1),w.ALo(2,"translate"),w.qZA()}2&e&&(w.xp6(1),w.hij("",w.lcZ(2,1,"igo.geo.filter.displayLessResults")," "))}function Cm(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"u",24),w.NdJ("click",function(){return w.CHM(i),w.oxw(5).displayMoreResults("checkbox")}),w._uU(1),w.ALo(2,"translate"),w.qZA()}2&e&&(w.xp6(1),w.hij("",w.lcZ(2,1,"igo.geo.filter.displayMoreResults")," "))}function Tm(e,t){if(1&e&&(w.TgZ(0,"p"),w.YNc(1,km,3,3,"u",21),w.YNc(2,Cm,3,3,"u",22),w.qZA()),2&e){var i=w.oxw().$implicit,o=w.oxw(3);w.xp6(1),w.Q6J("ngIf",o.isLessResults(i,"checkbox")),w.xp6(1),w.Q6J("ngIf",o.isMoreResults(i,"checkbox"))}}function Am(e,t){if(1&e&&(w.ynx(0),w.TgZ(1,"h4"),w._uU(2),w.qZA(),w.TgZ(3,"div",18),w.YNc(4,Sm,2,4,"mat-checkbox",19),w.qZA(),w.YNc(5,Tm,3,2,"p",2),w.BQk()),2&e){var i=t.$implicit,o=w.oxw(3);w.xp6(2),w.Oqu(i.title),w.xp6(2),w.Q6J("ngForOf",i.selectors),w.xp6(1),w.Q6J("ngIf",o.isLessResults(i,"checkbox")||o.isMoreResults(i,"checkbox"))}}function Lm(e,t){if(1&e&&(w.TgZ(0,"div",16),w._UZ(1,"mat-divider"),w.YNc(2,xm,5,5,"div",8),w.YNc(3,Am,6,3,"ng-container",1),w.qZA()),2&e){var i=w.oxw(2);w.xp6(2),w.Q6J("ngIf",i.getCheckboxesGroups().length>1),w.xp6(1),w.Q6J("ngForOf",i.currentCheckboxesGroup.computedSelectors)}}function Zm(e,t){if(1&e&&(w.TgZ(0,"mat-option",12),w._uU(1),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i),w.xp6(1),w.hij("",i.title," ")}}function Fm(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",9),w.TgZ(1,"mat-form-field"),w.TgZ(2,"mat-select",26),w.NdJ("valueChange",function(e){return w.CHM(i),w.oxw(3).currentRadioButtonsGroup=e}),w.ALo(3,"translate"),w.YNc(4,Zm,2,2,"mat-option",11),w.qZA(),w.qZA(),w.qZA()}if(2&e){var o=w.oxw(3);w.xp6(2),w.Q6J("matTooltip",w.lcZ(3,3,"igo.geo.layer.legend.selectStyle"))("value",o.currentRadioButtonsGroup),w.xp6(2),w.Q6J("ngForOf",o.getRadioButtonsGroups())}}function Om(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-radio-button",29),w.NdJ("change",function(){return w.CHM(i),w.oxw(4).emptyRadioButtons()}),w.ALo(1,"translate"),w._uU(2),w.ALo(3,"translate"),w.qZA()}2&e&&(w.Q6J("matTooltip",w.lcZ(1,2,"igo.geo.filter.resetFilters")),w.xp6(2),w.hij("",w.lcZ(3,4,"igo.geo.filter.resetFilters")," "))}function Mm(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-radio-button",20),w.NdJ("change",function(){var e=w.CHM(i).$implicit,t=w.oxw(3).$implicit;return w.oxw().onSelectionChange(e,t.selectorType)}),w._uU(1),w.qZA()}if(2&e){var o=t.$implicit,n=w.oxw(4);w.Q6J("matTooltip",n.getToolTip(o))("checked",o.enabled)("value",o),w.xp6(1),w.hij("",o.title," ")}}function Im(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"u",23),w.NdJ("click",function(){return w.CHM(i),w.oxw(5).displayLessResults("radio")}),w._uU(1),w.ALo(2,"translate"),w.qZA()}2&e&&(w.xp6(1),w.hij("",w.lcZ(2,1,"igo.geo.filter.displayLessResults")," "))}function Pm(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"u",24),w.NdJ("click",function(){return w.CHM(i),w.oxw(5).displayMoreResults("radio")}),w._uU(1),w.ALo(2,"translate"),w.qZA()}2&e&&(w.xp6(1),w.hij("",w.lcZ(2,1,"igo.geo.filter.displayMoreResults")," "))}function _m(e,t){if(1&e&&(w.TgZ(0,"p"),w.YNc(1,Im,3,3,"u",21),w.YNc(2,Pm,3,3,"u",22),w.qZA()),2&e){var i=w.oxw().$implicit,o=w.oxw(3);w.xp6(1),w.Q6J("ngIf",o.isLessResults(i,"radio")),w.xp6(1),w.Q6J("ngIf",o.isMoreResults(i,"radio"))}}function qm(e,t){if(1&e&&(w.ynx(0),w.TgZ(1,"h4"),w._uU(2),w.qZA(),w.TgZ(3,"mat-radio-group",27),w.YNc(4,Om,4,6,"mat-radio-button",28),w.YNc(5,Mm,2,4,"mat-radio-button",19),w.YNc(6,_m,3,2,"p",2),w.qZA(),w.BQk()),2&e){var i=t.$implicit,o=w.oxw(3);w.xp6(2),w.Oqu(i.title),w.xp6(2),w.Q6J("ngIf",i.unfiltered),w.xp6(1),w.Q6J("ngForOf",i.selectors),w.xp6(1),w.Q6J("ngIf",o.isLessResults(i,"radio")||o.isMoreResults(i,"radio"))}}function Dm(e,t){if(1&e&&(w.TgZ(0,"div",25),w._UZ(1,"mat-divider"),w.YNc(2,Fm,5,5,"div",8),w.YNc(3,qm,7,4,"ng-container",1),w.qZA()),2&e){var i=w.oxw(2);w.xp6(2),w.Q6J("ngIf",i.getRadioButtonsGroups().length>1),w.xp6(1),w.Q6J("ngForOf",i.currentRadioButtonsGroup.computedSelectors)}}function Em(e,t){if(1&e&&(w.TgZ(0,"mat-option",12),w._uU(1),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i),w.xp6(1),w.hij("",i.title," ")}}function $m(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",9),w.TgZ(1,"mat-form-field"),w.TgZ(2,"mat-select",31),w.NdJ("valueChange",function(e){return w.CHM(i),w.oxw(3).currentSelectGroup=e}),w.ALo(3,"translate"),w.YNc(4,Em,2,2,"mat-option",11),w.qZA(),w.qZA(),w.qZA()}if(2&e){var o=w.oxw(3);w.xp6(2),w.Q6J("matTooltip",w.lcZ(3,3,"igo.geo.layer.legend.selectStyle"))("value",o.currentSelectGroup),w.xp6(2),w.Q6J("ngForOf",o.getSelectGroups())}}function Rm(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-button",35),w.NdJ("click",function(){return w.CHM(i),w.oxw(4).emptySelect()}),w.ALo(1,"translate"),w._UZ(2,"mat-icon",36),w.qZA()}2&e&&w.Q6J("matTooltip",w.lcZ(1,1,"igo.geo.filter.resetFilters"))}var Nm=function(){return{standalone:!0}};function Um(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-checkbox",41),w.NdJ("ngModelChange",function(e){return w.CHM(i),w.oxw(5).allSelected=e})("change",function(){return w.CHM(i),w.oxw(5).toggleAllSelection()}),w._uU(1,"Tous "),w.qZA()}if(2&e){var o=w.oxw(5);w.Q6J("ngModel",o.allSelected)("ngModelOptions",w.DdM(2,Nm))}}function Jm(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-option",42),w.NdJ("onSelectionChange",function(){return w.CHM(i),w.oxw(5).optionClick()}),w._uU(1),w.qZA()}if(2&e){var o=t.$implicit,n=w.oxw(5);w.Q6J("matTooltip",n.getToolTip(o))("value",o),w.xp6(1),w.hij("",o.title," ")}}function Bm(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div"),w.TgZ(1,"mat-select",37,38),w.NdJ("ngModelChange",function(e){return w.CHM(i),w.oxw(4).enableds=e}),w.TgZ(3,"div",18),w.YNc(4,Um,2,3,"mat-checkbox",39),w.qZA(),w.YNc(5,Jm,2,3,"mat-option",40),w.qZA(),w.qZA()}if(2&e){var o=w.oxw().$implicit,n=w.oxw(3);w.xp6(1),w.Q6J("multiple",o.multiple)("placeholder",o.title)("formControl",n.select)("ngModel",n.enableds),w.xp6(3),w.Q6J("ngIf",o.multiple),w.xp6(1),w.Q6J("ngForOf",o.selectors)}}function jm(e,t){if(1&e&&(w.TgZ(0,"mat-option",45),w._uU(1),w.qZA()),2&e){var i=t.$implicit,o=w.oxw(5);w.Q6J("matTooltip",o.getToolTip(i))("value",i),w.xp6(1),w.hij("",i.title," ")}}function Qm(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-select",43),w.NdJ("ngModelChange",function(e){return w.CHM(i),w.oxw(4).enabled=e}),w.YNc(1,jm,2,3,"mat-option",44),w.qZA()}if(2&e){var o=w.oxw().$implicit,n=w.oxw(3);w.Q6J("placeholder",o.title)("formControl",n.select)("ngModel",n.enabled),w.xp6(1),w.Q6J("ngForOf",o.selectors)}}function Gm(e,t){if(1&e&&(w.ynx(0),w.TgZ(1,"h4"),w._uU(2),w.qZA(),w.TgZ(3,"div",9),w.YNc(4,Rm,3,3,"mat-button",32),w.TgZ(5,"mat-form-field"),w.YNc(6,Bm,6,6,"div",33),w.YNc(7,Qm,2,4,"ng-template",null,34,w.W1O),w.qZA(),w.qZA(),w.BQk()),2&e){var i=t.$implicit,o=w.MAs(8);w.xp6(2),w.Oqu(i.title),w.xp6(2),w.Q6J("ngIf",i.unfiltered&&!i.multiple),w.xp6(2),w.Q6J("ngIf",i.multiple)("ngIfElse",o)}}function Ym(e,t){if(1&e&&(w.TgZ(0,"div",30),w._UZ(1,"mat-divider"),w.YNc(2,$m,5,5,"div",8),w.YNc(3,Gm,9,4,"ng-container",1),w.qZA()),2&e){var i=w.oxw(2);w.xp6(2),w.Q6J("ngIf",i.getSelectGroups().length>1),w.xp6(1),w.Q6J("ngForOf",i.currentSelectGroup.computedSelectors)}}function zm(e,t){if(1&e&&(w.TgZ(0,"div"),w.YNc(1,bm,4,2,"div",3),w.YNc(2,Lm,4,2,"div",4),w.YNc(3,Dm,4,2,"div",5),w.YNc(4,Ym,4,2,"div",6),w.qZA()),2&e){var i=t.$implicit;w.xp6(1),w.Q6J("ngIf","pushButton"===i.selectorType),w.xp6(1),w.Q6J("ngIf","checkbox"===i.selectorType),w.xp6(1),w.Q6J("ngIf","radioButton"===i.selectorType),w.xp6(1),w.Q6J("ngIf","select"===i.selectorType)}}function Vm(e,t){1&e&&(w.TgZ(0,"h4"),w._uU(1),w.ALo(2,"translate"),w.qZA()),2&e&&(w.xp6(1),w.Oqu(w.lcZ(2,1,"igo.geo.filter.reportingDate")))}function Hm(e,t){if(1&e&&(w.TgZ(0,"h4"),w._uU(1),w.qZA()),2&e){var i=w.oxw(2);w.xp6(1),w.Oqu(i.currentFilter.title)}}function Wm(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div"),w._UZ(1,"mat-divider"),w.YNc(2,Vm,3,3,"h4",2),w.YNc(3,Hm,2,1,"h4",2),w.TgZ(4,"igo-ogc-filter-time",46),w.NdJ("datasourceChange",function(e){return w.CHM(i),w.oxw().datasource=e})("currentFilterChange",function(e){return w.CHM(i),w.oxw().currentFilter=e})("changeProperty",function(e){return w.CHM(i),w.oxw().changeProperty(e.value,e.pos)}),w.qZA(),w.qZA()}if(2&e){var o=w.oxw();w.xp6(2),w.Q6J("ngIf",!o.currentFilter.title),w.xp6(1),w.Q6J("ngIf",o.currentFilter.title),w.xp6(1),w.Q6J("datasource",o.datasource)("currentFilter",o.currentFilter)}}var Xm=function(){var e=function(){function e(t,i){m(this,e),this.ogcFilterService=t,this.formBuilder=i,this.checkboxesIndex=5,this.radioButtonsIndex=5,this.baseIndex=5,this.ogcFilterOperator=vc,this.color="primary",this.allSelected=!1,this.select=new We.NI,this.enabled$=new R.X(void 0),this.enableds$=new R.X([]),this.ogcFilterWriter=new bc,this.buildForm()}return y(e,[{key:"currentFilter",get:function(){return this._currentFilter},set:function(e){var t;this._currentFilter=e,(null===(t=this._currentFilter)||void 0===t?void 0:t.sliderOptions)&&(this._currentFilter.sliderOptions.enabled=!1)}},{key:"ogcFiltersSelectors",get:function(){var e,t,i,o,n,r,a,s,l,c,u,p,d,h,g,f,m,v,y,b,w,x,S,k,C=[];return(null===(i=null===(t=null===(e=this.datasource)||void 0===e?void 0:e.options)||void 0===t?void 0:t.ogcFilters)||void 0===i?void 0:i.pushButtons)&&C.push(null===(r=null===(n=null===(o=this.datasource)||void 0===o?void 0:o.options)||void 0===n?void 0:n.ogcFilters)||void 0===r?void 0:r.pushButtons),(null===(l=null===(s=null===(a=this.datasource)||void 0===a?void 0:a.options)||void 0===s?void 0:s.ogcFilters)||void 0===l?void 0:l.checkboxes)&&C.push(null===(p=null===(u=null===(c=this.datasource)||void 0===c?void 0:c.options)||void 0===u?void 0:u.ogcFilters)||void 0===p?void 0:p.checkboxes),(null===(g=null===(h=null===(d=this.datasource)||void 0===d?void 0:d.options)||void 0===h?void 0:h.ogcFilters)||void 0===g?void 0:g.radioButtons)&&C.push(null===(v=null===(m=null===(f=this.datasource)||void 0===f?void 0:f.options)||void 0===m?void 0:m.ogcFilters)||void 0===v?void 0:v.radioButtons),(null===(w=null===(b=null===(y=this.datasource)||void 0===y?void 0:y.options)||void 0===b?void 0:b.ogcFilters)||void 0===w?void 0:w.select)&&C.push(null===(k=null===(S=null===(x=this.datasource)||void 0===x?void 0:x.options)||void 0===S?void 0:S.ogcFilters)||void 0===k?void 0:k.select),C.sort(function(e,t){return e.order<t.order?-1:e.order>t.order?1:0}),C}},{key:"currentPushButtonsGroup",get:function(){return this.form.get("pushButtonsGroup").value},set:function(e){this.form.patchValue({pushButtonsGroup:e})}},{key:"currentCheckboxesGroup",get:function(){return this.form.get("checkboxesGroup").value},set:function(e){this.form.patchValue({checkboxesGroup:e})}},{key:"currentRadioButtonsGroup",get:function(){return this.form.get("radioButtonsGroup").value},set:function(e){this.form.patchValue({radioButtonsGroup:e})}},{key:"currentSelectGroup",get:function(){return this.form.get("selectGroup").value},set:function(e){this.form.patchValue({selectGroup:e})}},{key:"enabled",get:function(){return this.enabled$.value},set:function(e){var t=this;this.enabled$.next(e),clearTimeout(this.applyFiltersTimeout),this.currentSelectGroup.computedSelectors.forEach(function(t){t.selectors.forEach(function(t){t.enabled=e===t})}),this.applyFiltersTimeout=setTimeout(function(){t.applyFilters()},750)}},{key:"enableds",get:function(){return this.enableds$.value},set:function(e){var t=this;this.enableds$.next(e),clearTimeout(this.applyFiltersTimeout),this.currentSelectGroup.computedSelectors.forEach(function(t){t.selectors.forEach(function(t){t.enabled=!!e.includes(t)})}),this.applyFiltersTimeout=setTimeout(function(){t.applyFilters()},750)}},{key:"buildForm",value:function(){this.form=this.formBuilder.group({pushButtons:["",[We.kI.required]],radioButtons:["",[We.kI.required]],pushButtonsGroup:["",[We.kI.required]],checkboxesGroup:["",[We.kI.required]],radioButtonsGroup:["",[We.kI.required]],selectGroup:["",[We.kI.required]]})}},{key:"getPushButtonsGroups",value:function(){var e,t,i;if(null===(i=null===(t=null===(e=this.datasource)||void 0===e?void 0:e.options)||void 0===t?void 0:t.ogcFilters)||void 0===i?void 0:i.pushButtons)return this.datasource.options.ogcFilters.pushButtons.groups}},{key:"getCheckboxesGroups",value:function(){var e,t,i;if(null===(i=null===(t=null===(e=this.datasource)||void 0===e?void 0:e.options)||void 0===t?void 0:t.ogcFilters)||void 0===i?void 0:i.checkboxes)return this.datasource.options.ogcFilters.checkboxes.groups}},{key:"getRadioButtonsGroups",value:function(){var e,t,i;if(null===(i=null===(t=null===(e=this.datasource)||void 0===e?void 0:e.options)||void 0===t?void 0:t.ogcFilters)||void 0===i?void 0:i.radioButtons)return this.datasource.options.ogcFilters.radioButtons.groups}},{key:"getSelectGroups",value:function(){var e,t,i;if(null===(i=null===(t=null===(e=this.datasource)||void 0===e?void 0:e.options)||void 0===t?void 0:t.ogcFilters)||void 0===i?void 0:i.select)return this.datasource.options.ogcFilters.select.groups}},{key:"ngOnInit",value:function(){var e=this;this.datasource.options.ogcFilters&&(this.datasource.options.ogcFilters.pushButtons&&(this.currentPushButtonsGroup=this.datasource.options.ogcFilters.pushButtons.groups.find(function(e){return e.enabled})||this.datasource.options.ogcFilters.pushButtons.groups[0]),this.datasource.options.ogcFilters.checkboxes&&(this.currentCheckboxesGroup=this.datasource.options.ogcFilters.checkboxes.groups.find(function(e){return e.enabled})||this.datasource.options.ogcFilters.checkboxes.groups[0]),this.datasource.options.ogcFilters.radioButtons&&(this.currentRadioButtonsGroup=this.datasource.options.ogcFilters.radioButtons.groups.find(function(e){return e.enabled})||this.datasource.options.ogcFilters.radioButtons.groups[0]),this.datasource.options.ogcFilters.select&&(this.currentSelectGroup=this.datasource.options.ogcFilters.select.groups.find(function(e){return e.enabled})||this.datasource.options.ogcFilters.select.groups[0],this.getSelectEnabled()),this.applyFilters()),this.form.get("pushButtonsGroup").valueChanges.pipe((0,E.b)(750)).subscribe(function(){e.onPushButtonsChangeGroup(),e.applyFilters()}),this.form.get("checkboxesGroup").valueChanges.pipe((0,E.b)(750)).subscribe(function(){e.onCheckboxesChangeGroup(),e.applyFilters()}),this.form.get("radioButtonsGroup").valueChanges.pipe((0,E.b)(750)).subscribe(function(){e.onRadioButtonsChangeGroup(),e.applyFilters()}),this.form.get("selectGroup").valueChanges.pipe((0,E.b)(750)).subscribe(function(){e.onSelectChangeGroup(),e.applyFilters()}),this.form.get("pushButtons").valueChanges.pipe((0,E.b)(750)).subscribe(function(){e.applyFilters()}),this.form.get("radioButtons").valueChanges.pipe((0,E.b)(750)).subscribe(function(){e.applyFilters()})}},{key:"getSelectEnabled",value:function(){var e,t=this,i=[];this.currentSelectGroup.computedSelectors.forEach(function(o){o.multiple?(o.selectors.forEach(function(e){e.enabled&&i.push(e)}),t.enableds=i):(o.selectors.forEach(function(t){t.enabled&&(e=t)}),t.enabled=e)})}},{key:"getToolTip",value:function(e){var t;return e.tooltip&&(t=Array.isArray(e.tooltip)?e.tooltip.join("\n"):e.tooltip),t||""}},{key:"getButtonColor",value:function(e){var t;return e.color&&e.enabled&&(t={"background-color":"rgba(".concat(e.color,")")}),t}},{key:"bundleIsVertical",value:function(e){return!!e.vertical&&e.vertical}},{key:"onPushButtonsChangeGroup",value:function(){var e=this;this.getPushButtonsGroups().map(function(e){return e.enabled=!1}),this.getPushButtonsGroups().find(function(t){return t===e.currentPushButtonsGroup}).enabled=!0}},{key:"onCheckboxesChangeGroup",value:function(){var e=this;this.getCheckboxesGroups().map(function(e){return e.enabled=!1}),this.getCheckboxesGroups().find(function(t){return t===e.currentCheckboxesGroup}).enabled=!0}},{key:"onRadioButtonsChangeGroup",value:function(){var e=this;this.getRadioButtonsGroups().map(function(e){return e.enabled=!1}),this.getRadioButtonsGroups().find(function(t){return t===e.currentRadioButtonsGroup}).enabled=!0}},{key:"onSelectChangeGroup",value:function(){var e=this;this.getSelectGroups().map(function(e){return e.enabled=!1}),this.getSelectGroups().find(function(t){return t===e.currentSelectGroup}).enabled=!0}},{key:"onSelectionChange",value:function(e,t){var i=this;clearTimeout(this.applyFiltersTimeout),"radioButton"===t&&this.emptyRadioButtons(),e&&(e.enabled=!e.enabled),this.applyFiltersTimeout=setTimeout(function(){i.applyFilters()},750)}},{key:"emptyRadioButtons",value:function(){var e=this;this.currentRadioButtonsGroup.computedSelectors.forEach(function(t){t.selectors.map(function(e){return e.enabled=!1}),e.applyFiltersTimeout=setTimeout(function(){e.applyFilters()},750)})}},{key:"emptySelect",value:function(){this.enabled=[]}},{key:"toggleAllSelection",value:function(){this.sel.options.forEach(this.allSelected?function(e){return e.select()}:function(e){return e.deselect()})}},{key:"optionClick",value:function(){var e=!0;this.sel.options.forEach(function(t){t.selected||(e=!1)}),this.allSelected=e}},{key:"applyFilters",value:function(){for(var e="",t=[],i=0,o=[this.currentPushButtonsGroup,this.currentCheckboxesGroup,this.currentRadioButtonsGroup,this.currentSelectGroup];i<o.length;i++){var n=o[i];n.computedSelectors&&n.computedSelectors.map(function(e){var i=[];e.selectors.filter(function(e){return!0===e.enabled}).forEach(function(e){return i.push(e.filters)}),i.length>=1&&t.push(1===i.length?i[0]:{logical:e.logical,filters:i})})}this.isTemporalOperator()&&this._currentFilter.active&&t.push(this.datasource.options.ogcFilters.interfaceOgcFilters[0]),t.length>=1&&(e=this.ogcFilterWriter.buildFilter(1===t.length?t[0]:{logical:"And",filters:t})),"wms"===this.datasource.options.type&&this.ogcFilterService.filterByOgc(this.datasource,e),"wfs"===this.datasource.options.type&&this.datasource.ol.refresh(),this.datasource.setOgcFilters(this.datasource.options.ogcFilters,!0)}},{key:"isMoreResults",value:function(e,t){var i,o=0,n=p(e.selectors);try{for(n.s();!(i=n.n()).done;){i.value;o++}}catch(r){n.e(r)}finally{n.f()}return o>("radio"===t?this.radioButtonsIndex:this.checkboxesIndex)}},{key:"displayMoreResults",value:function(e){"radio"===e?this.radioButtonsIndex+=5:this.checkboxesIndex+=5}},{key:"isLessResults",value:function(e,t){var i,o=0,n=p(e.selectors);try{for(n.s();!(i=n.n()).done;){i.value;o++}}catch(r){n.e(r)}finally{n.f()}return this.baseIndex!==("radio"===t?this.radioButtonsIndex:this.checkboxesIndex)&&o>this.baseIndex}},{key:"displayLessResults",value:function(e){"radio"===e?this.radioButtonsIndex=this.baseIndex:this.checkboxesIndex=this.baseIndex}},{key:"isTemporalOperator",value:function(){var e,t;return(null===(t=null===(e=this.currentFilter)||void 0===e?void 0:e.operator)||void 0===t?void 0:t.toLowerCase())===this.ogcFilterOperator.During.toLowerCase()}},{key:"changeProperty",value:function(e,t){var i=this,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.detectProperty(t);n&&(this.datasource.options.ogcFilters.interfaceOgcFilters.find(function(e){return e.filterid===i.currentFilter.filterid})[n]=e,o&&this.applyFilters())}},{key:"detectProperty",value:function(e){switch(this.currentFilter.operator){case vc.PropertyIsNotEqualTo:case vc.PropertyIsEqualTo:case vc.PropertyIsGreaterThan:case vc.PropertyIsGreaterThanOrEqualTo:case vc.PropertyIsLessThan:case vc.PropertyIsLessThanOrEqualTo:return"expression";case vc.PropertyIsLike:return"pattern";case vc.PropertyIsBetween:return e&&1===e?"lowerBoundary":e&&2===e?"upperBoundary":void 0;case vc.During:return e&&1===e?"begin":e&&2===e?"end":void 0;default:return}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(gh),w.Y36(We.qu))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-ogc-filter-selection"]],viewQuery:function(e,t){var i;(1&e&&w.Gf(gm,5),2&e)&&(w.iGM(i=w.CRH())&&(t.sel=i.first))},inputs:{refreshFilters:"refreshFilters",datasource:"datasource",map:"map",checkboxesIndex:"checkboxesIndex",radioButtonsIndex:"radioButtonsIndex",baseIndex:"baseIndex",currentFilter:"currentFilter"},decls:3,vars:3,consts:[[3,"formGroup"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","pushButtonGroups",4,"ngIf"],["class","checkboxGroups",4,"ngIf"],["class","radioButtonGroups",4,"ngIf"],["class","selectGroups",4,"ngIf"],[1,"pushButtonGroups"],["class","groupsSelector",4,"ngIf"],[1,"groupsSelector"],["formControlName","pushButtonsGroup","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","value","valueChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["formControlName","pushButtons","appearance","legacy","multiple","true",1,"mat-typography",3,"vertical"],["tooltip-position","below","matTooltipShowDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","ngStyle","checked","value","change",4,"ngFor","ngForOf"],["tooltip-position","below","matTooltipShowDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","ngStyle","checked","value","change"],[1,"checkboxGroups"],["formControlName","checkboxesGroup","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","value","valueChange"],[1,"checkboxes","mat-typography"],["tooltip-position","below","matTooltipShowDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","checked","value","change",4,"ngFor","ngForOf"],["tooltip-position","below","matTooltipShowDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","checked","value","change"],["class","lessResults mat-typography",3,"click",4,"ngIf"],["class","moreResults mat-typography",3,"click",4,"ngIf"],[1,"lessResults","mat-typography",3,"click"],[1,"moreResults","mat-typography",3,"click"],[1,"radioButtonGroups"],["formControlName","radioButtonsGroup","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","value","valueChange"],["formControlName","radioButtons",1,"mat-typography"],["tooltip-position","below","matTooltipShowDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","change",4,"ngIf"],["tooltip-position","below","matTooltipShowDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","change"],[1,"selectGroups"],["formControlName","selectGroup","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","value","valueChange"],["mat-icon-button","","color","warn","tooltip-position","below","matTooltipShowDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","click",4,"ngIf"],[4,"ngIf","ngIfElse"],["notMulti",""],["mat-icon-button","","color","warn","tooltip-position","below","matTooltipShowDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","click"],["svgIcon","filter-remove"],[3,"multiple","placeholder","formControl","ngModel","ngModelChange"],["selection",""],[3,"ngModel","ngModelOptions","ngModelChange","change",4,"ngIf"],["tooltip-position","below","matTooltipDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","value","onSelectionChange",4,"ngFor","ngForOf"],[3,"ngModel","ngModelOptions","ngModelChange","change"],["tooltip-position","below","matTooltipDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","value","onSelectionChange"],[3,"placeholder","formControl","ngModel","ngModelChange"],["tooltip-position","below","matTooltipDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","value",4,"ngFor","ngForOf"],["tooltip-position","below","matTooltipDelay","500","matTooltipClass","material-tooltip",3,"matTooltip","value"],[3,"datasource","currentFilter","datasourceChange","currentFilterChange","changeProperty"]],template:function(e,t){1&e&&(w.TgZ(0,"form",0),w.YNc(1,zm,5,4,"div",1),w.qZA(),w.YNc(2,Wm,5,4,"div",2)),2&e&&(w.Q6J("formGroup",t.form),w.xp6(1),w.Q6J("ngForOf",t.ogcFiltersSelectors),w.xp6(1),w.Q6J("ngIf",t.isTemporalOperator()))},styles:[".mat-button-toggle-group[_ngcontent-%COMP%]{margin:5px;flex-wrap:wrap;box-shadow:none}.checkboxes[_ngcontent-%COMP%]{flex-wrap:wrap;box-shadow:none}.groupsSelector[_ngcontent-%COMP%]{text-align:center}mat-button-toggle[_ngcontent-%COMP%]{display:inline-flex;border:1.5px solid black;border-radius:5px;margin:5px;white-space:normal;min-height:40px;height:auto;width:150px}mat-button-toggle[_ngcontent-%COMP%]     .mat-button-toggle-label-content{line-height:unset;font-size:small;display:block}  .material-tooltip{white-space:pre-wrap}mat-checkbox[_ngcontent-%COMP%], mat-radio-button[_ngcontent-%COMP%]{margin:7px;width:95%;display:inline-flex;font-size:larger}mat-checkbox[_ngcontent-%COMP%]     label, mat-radio-button[_ngcontent-%COMP%]     label{white-space:normal}mat-checkbox[_ngcontent-%COMP%]{vertical-align:middle}mat-button[_ngcontent-%COMP%]{padding-right:10px}h4[_ngcontent-%COMP%]{margin:7px;text-align:left}u[_ngcontent-%COMP%]{cursor:pointer;color:#00f;margin:5px}p[_ngcontent-%COMP%]{margin:unset}"]}),e}();function Km(e,t){if(1&e&&(w.TgZ(0,"mat-option",10),w._uU(1),w.ALo(2,"translate"),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i),w.xp6(1),w.hij(" ",w.lcZ(2,2,"igo.geo.terrapi."+i)," ")}}var ev=function(){var e=function(){function e(){m(this,e),this.queryType=["Arrond","CircFed","CircProv","DirReg","Mun","MRC","AdmRegion","RegTour"],this.selectedTypeIndex=new We.NI(0),this.spatialType=fh,this.activeDrawType=this.spatialType.Polygon,this.layers=[],this.eventType=new w.vpe,this.eventQueryType=new w.vpe,this.zoneChange=new w.vpe,this.zoneWithBufferChange=new w.vpe,this.bufferChange=new w.vpe,this.measureUnitChange=new w.vpe}return y(e,[{key:"store",get:function(){return this._store},set:function(e){this._store=e}},{key:"ngOnInit",value:function(){0===this.selectedTypeIndex.value&&(this.type=this.spatialType.Predefined),1===this.selectedTypeIndex.value&&(this.type=this.activeDrawType),this.eventType.emit(this.type)}},{key:"onTypeChange",value:function(e){0===this.selectedTypeIndex.value&&(this.type=fh.Predefined),1===this.selectedTypeIndex.value&&(this.type=this.activeDrawType),this.eventType.emit(this.type)}},{key:"onDrawTypeChange",value:function(e){this.activeDrawType=e,this.eventType.emit(this.activeDrawType)}},{key:"onSelectionChange",value:function(){this.eventQueryType.emit(this.selectedQueryType),this.zoneChange.emit(void 0)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-spatial-filter-type"]],inputs:{store:"store",selectedQueryType:"selectedQueryType",zone:"zone",layers:"layers"},outputs:{eventType:"eventType",eventQueryType:"eventQueryType",zoneChange:"zoneChange",zoneWithBufferChange:"zoneWithBufferChange",bufferChange:"bufferChange",measureUnitChange:"measureUnitChange"},decls:20,vars:25,consts:[[3,"selectedIndex","selectedIndexChange","selectedTabChange"],[3,"label"],[3,"value","selectionChange","valueChange"],[3,"value",4,"ngFor","ngForOf"],[3,"store","queryType","zone","layers","zoneChange","zoneWithBufferChange","bufferChange","measureUnitChange"],[1,"spatial-type-toggle"],[3,"value","change"],[3,"value","matTooltip"],["svgIcon","pentagon-outline"],["svgIcon","record-circle-outline"],[3,"value"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-tab-group",0),w.NdJ("selectedIndexChange",function(e){return t.selectedTypeIndex.setValue(e)})("selectedTabChange",function(e){return t.onTypeChange(e)}),w.TgZ(1,"mat-tab",1),w.ALo(2,"translate"),w.TgZ(3,"mat-form-field"),w.TgZ(4,"mat-label"),w._uU(5),w.ALo(6,"translate"),w.qZA(),w.TgZ(7,"mat-select",2),w.NdJ("selectionChange",function(){return t.onSelectionChange()})("valueChange",function(e){return t.selectedQueryType=e}),w.YNc(8,Km,3,4,"mat-option",3),w.qZA(),w.qZA(),w.TgZ(9,"igo-spatial-filter-list",4),w.NdJ("zoneChange",function(e){return t.zoneChange.emit(e)})("zoneWithBufferChange",function(e){return t.zoneWithBufferChange.emit(e)})("bufferChange",function(e){return t.bufferChange.emit(e)})("measureUnitChange",function(e){return t.measureUnitChange.emit(e)}),w.qZA(),w.qZA(),w.TgZ(10,"mat-tab",1),w.ALo(11,"translate"),w.TgZ(12,"div",5),w.TgZ(13,"mat-button-toggle-group",6),w.NdJ("change",function(e){return t.onDrawTypeChange(e.value)}),w.TgZ(14,"mat-button-toggle",7),w.ALo(15,"translate"),w._UZ(16,"mat-icon",8),w.qZA(),w.TgZ(17,"mat-button-toggle",7),w.ALo(18,"translate"),w._UZ(19,"mat-icon",9),w.qZA(),w.qZA(),w.qZA(),w.qZA(),w.qZA()),2&e&&(w.Q6J("selectedIndex",t.selectedTypeIndex.value),w.xp6(1),w.Q6J("label",w.lcZ(2,15,"igo.geo.spatialFilter.predefined")),w.xp6(4),w.Oqu(w.lcZ(6,17,"igo.geo.spatialFilter.searchLabel")),w.xp6(2),w.Q6J("value",t.selectedQueryType),w.xp6(1),w.Q6J("ngForOf",t.queryType),w.xp6(1),w.Q6J("store",t.store)("queryType",t.selectedQueryType)("zone",t.zone)("layers",t.layers),w.xp6(1),w.Q6J("label",w.lcZ(11,19,"igo.geo.spatialFilter.draw")),w.xp6(3),w.Q6J("value",t.activeDrawType),w.xp6(1),w.Q6J("value",t.spatialType.Polygon)("matTooltip",w.lcZ(15,21,"igo.geo.spatialFilter.drawPolygon")),w.xp6(3),w.Q6J("value",t.spatialType.Point)("matTooltip",w.lcZ(18,23,"igo.geo.spatialFilter.drawCircle")))},styles:[".mat-form-field[_ngcontent-%COMP%]{padding:5px;width:95%;margin-left:2px}.mat-tab-group[_ngcontent-%COMP%]     .mat-tab-body-content{overflow:hidden}.mat-tab-group[_ngcontent-%COMP%]     .mat-tab-label{padding:10px}.mat-tab-group[_ngcontent-%COMP%]     .mat-tab-body-wrapper{margin-top:5px}.spatial-type-toggle[_ngcontent-%COMP%]{padding:10px;text-align:center}.spatial-type-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]{width:50%}.spatial-type-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]{width:50%}"],changeDetection:0}),e}();function tv(e,t){if(1&e&&(w.TgZ(0,"mat-option",13),w._uU(1),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i),w.xp6(1),w.hij(" ",i.properties.nom," ")}}function iv(e,t){if(1&e&&(w.TgZ(0,"mat-option",13),w._uU(1),w.ALo(2,"translate"),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i),w.xp6(1),w.hij(" ",w.lcZ(2,2,"igo.geo.measure."+i)," ")}}var ov=function(){var e=function(){function e(t,i,o){m(this,e),this.spatialFilterService=t,this.messageService=i,this.languageService=o,this.layers=[],this.measureUnit=Jh.Meters,this.formControl=new We.NI,this.bufferFormControl=new We.NI,this.zoneChange=new w.vpe,this.zoneWithBufferChange=new w.vpe,this.bufferChange=new w.vpe,this.measureUnitChange=new w.vpe}return y(e,[{key:"store",get:function(){return this._store},set:function(e){this._store=e}},{key:"queryType",get:function(){return this._queryType},set:function(e){this.formControl.setValue(""),this._queryType=e}},{key:"zone",get:function(){return this._zone},set:function(e){this._zone=e,e||(this.zoneWithBuffer=void 0,this.bufferFormControl.setValue(0))}},{key:"measureUnits",get:function(){return[Jh.Meters,Jh.Kilometers]}},{key:"ngOnInit",value:function(){var e=this;this.formValueChanges$$=this.formControl.valueChanges.subscribe(function(t){t.length&&e.store.view.filter(function(e){var i=t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return e.properties.nom.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(i)})}),this.bufferValueChanges$$=this.bufferFormControl.valueChanges.pipe((0,E.b)(500),(0,G.x)()).subscribe(function(t){e.measureUnit===Jh.Meters&&t>0&&t<=1e5?(e.bufferChange.emit(t),e.spatialFilterService.loadBufferGeometry(e.selectedZone,fh.Predefined,t,e.queryType).subscribe(function(t){e.zoneWithBuffer=t,e.zoneWithBufferChange.emit(e.zoneWithBuffer)})):e.measureUnit===Jh.Kilometers&&t>0&&t<=100?(e.bufferChange.emit(t),e.spatialFilterService.loadBufferGeometry(e.selectedZone,fh.Predefined,1e3*t,e.queryType).subscribe(function(t){e.zoneWithBuffer=t,e.zoneWithBufferChange.emit(e.zoneWithBuffer)})):0===t&&e.layers.length>0?(e.bufferChange.emit(t),e.zoneWithBufferChange.emit(e.selectedZone)):(t<0||e.measureUnit===Jh.Meters&&t>1e5||e.measureUnit===Jh.Kilometers&&t>100)&&(e.bufferFormControl.setValue(0),e.messageService.alert(e.languageService.translate.instant("igo.geo.spatialFilter.bufferAlert"),e.languageService.translate.instant("igo.geo.spatialFilter.warning")))})}},{key:"ngOnDestroy",value:function(){this.formValueChanges$$.unsubscribe()}},{key:"displayFn",value:function(e){return e?e.properties.nom:void 0}},{key:"onZoneChange",value:function(e){var t=this;e&&this.queryType&&this.spatialFilterService.loadItemById(e,this.queryType).subscribe(function(e){t.selectedZone=e,t.zoneChange.emit(e)})}},{key:"onMeasureUnitChange",value:function(e){e!==this.measureUnit&&(this.measureUnit=e,this.measureUnitChange.emit(this.measureUnit),this.bufferFormControl.setValue(this.measureUnit===Jh.Meters?1e3*this.bufferFormControl.value:this.bufferFormControl.value/1e3))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(vh),w.Y36(Ae),w.Y36(Ce))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-spatial-filter-list"]],inputs:{store:"store",queryType:"queryType",zone:"zone",layers:"layers"},outputs:{zoneChange:"zoneChange",zoneWithBufferChange:"zoneWithBufferChange",bufferChange:"bufferChange",measureUnitChange:"measureUnitChange"},decls:18,vars:17,consts:[[1,"form-list"],[1,"zone-list"],["type","text","matInput","",3,"placeholder","formControl","matAutocomplete"],["input",""],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[1,"buffer-div"],[1,"buffer-form"],[1,"buffer"],["type","number","matInput","",3,"placeholder","formControl","value","readonly"],[1,"unit-field"],[3,"value","selectionChange"],[3,"value"]],template:function(e,t){if(1&e&&(w.TgZ(0,"form",0),w.TgZ(1,"mat-form-field",1),w._UZ(2,"input",2,3),w.ALo(4,"translate"),w.TgZ(5,"mat-autocomplete",4,5),w.NdJ("optionSelected",function(e){return t.onZoneChange(e.option.value)}),w.YNc(7,tv,2,2,"mat-option",6),w.ALo(8,"async"),w.qZA(),w.qZA(),w.TgZ(9,"form"),w.TgZ(10,"div",7),w.TgZ(11,"form",8),w.TgZ(12,"mat-form-field",9),w._UZ(13,"input",10),w.ALo(14,"translate"),w.qZA(),w.qZA(),w.TgZ(15,"mat-form-field",11),w.TgZ(16,"mat-select",12),w.NdJ("selectionChange",function(e){return t.onMeasureUnitChange(e.value)}),w.YNc(17,iv,3,4,"mat-option",6),w.qZA(),w.qZA(),w.qZA(),w.qZA(),w.qZA()),2&e){var i=w.MAs(6);w.xp6(2),w.s9C("placeholder",w.lcZ(4,11,"igo.geo.spatialFilter.listLabel")),w.Q6J("formControl",t.formControl)("matAutocomplete",i),w.xp6(3),w.Q6J("displayWith",t.displayFn),w.xp6(2),w.Q6J("ngForOf",w.lcZ(8,13,t.store.view.all$())),w.xp6(6),w.s9C("placeholder",w.lcZ(14,15,"igo.geo.spatialFilter.buffer")),w.Q6J("formControl",t.bufferFormControl)("value",0)("readonly",!t.zone),w.xp6(3),w.Q6J("value",t.measureUnit),w.xp6(1),w.Q6J("ngForOf",t.measureUnits)}},directives:[We._Y,We.JL,We.F,Ye.KE,ot.Nt,We.Fj,tt.ZL,We.JJ,We.oH,tt.XC,F.sg,We.wV,ze.gD,Ve.ey],pipes:[ae.X$,F.Ov],styles:[".buffer-div[_ngcontent-%COMP%]{display:flex;width:100%;margin-left:2px;padding:5px}.zone-list[_ngcontent-%COMP%]{padding:5px;width:95%;margin-left:2px}.buffer[_ngcontent-%COMP%]{display:flex;flex-flow:column nowrap;width:110%}.unit-field[_ngcontent-%COMP%]{width:110px;margin-left:30px}"],changeDetection:0}),e}();function nv(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-slide-toggle",17),w.NdJ("change",function(){return w.CHM(i),w.oxw().onDrawControlChange()}),w._uU(1),w.ALo(2,"translate"),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("checked",o.drawControlIsActive)("labelPosition","before"),w.xp6(1),w.hij(" ",w.lcZ(2,3,"igo.geo.spatialFilter.drawControl")," ")}}function rv(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-slide-toggle",17),w.NdJ("change",function(){return w.CHM(i),w.oxw().onfreehandControlChange()}),w._uU(1),w.ALo(2,"translate"),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("checked",o.freehandDrawIsActive)("labelPosition","before"),w.xp6(1),w.hij(" ",w.lcZ(2,3,"igo.geo.spatialFilter.freehandControl")," ")}}function av(e,t){if(1&e&&(w.TgZ(0,"mat-option",6),w._uU(1),w.ALo(2,"translate"),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i),w.xp6(1),w.hij(" ",w.lcZ(2,2,"igo.geo.measure."+i)," ")}}function sv(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",18),w.TgZ(1,"form",19),w.TgZ(2,"mat-form-field",20),w._UZ(3,"input",21),w.ALo(4,"translate"),w.qZA(),w.qZA(),w.TgZ(5,"mat-form-field",22),w.TgZ(6,"mat-select",23),w.NdJ("selectionChange",function(e){return w.CHM(i),w.oxw().onMeasureUnitChange(e.value)}),w.YNc(7,av,3,4,"mat-option",24),w.qZA(),w.qZA(),w.qZA()}if(2&e){var o=w.oxw();w.xp6(3),w.s9C("placeholder",w.lcZ(4,6,"igo.geo.spatialFilter.buffer")),w.Q6J("formControl",o.bufferFormControl)("value",0)("readonly",null===o.formControl.value),w.xp6(3),w.Q6J("value",o.measureUnit),w.xp6(1),w.Q6J("ngForOf",o.measureUnits)}}function lv(e,t){if(1&e&&(w.TgZ(0,"mat-option",6),w._uU(1),w.ALo(2,"translate"),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i),w.xp6(1),w.hij(" ",w.lcZ(2,2,"igo.geo.measure."+i)," ")}}function cv(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",25),w.TgZ(1,"form",26),w.TgZ(2,"mat-form-field",27),w.TgZ(3,"input",28),w.NdJ("input",function(){return w.CHM(i),w.oxw().getRadius()}),w.ALo(4,"translate"),w.qZA(),w.qZA(),w.qZA(),w.TgZ(5,"mat-form-field",22),w.TgZ(6,"mat-select",23),w.NdJ("selectionChange",function(e){return w.CHM(i),w.oxw().onMeasureUnitChange(e.value)}),w.YNc(7,lv,3,4,"mat-option",24),w.qZA(),w.qZA(),w.qZA()}if(2&e){var o=w.oxw();w.xp6(3),w.s9C("placeholder",w.lcZ(4,6,"igo.geo.spatialFilter.radius")),w.Q6J("formControl",o.radiusFormControl)("value",1e3)("readonly",o.freehandDrawIsActive&&null===o.formControl.value),w.xp6(3),w.Q6J("value",o.measureUnit),w.xp6(1),w.Q6J("ngForOf",o.measureUnits)}}function uv(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-radio-button",29),w.NdJ("change",function(e){return w.CHM(i),w.oxw().onItemTypeChange(e)}),w._uU(1),w.ALo(2,"translate"),w.qZA()}if(2&e){var o=t.$implicit;w.Q6J("value",o),w.xp6(1),w.hij(" ",w.lcZ(2,2,"igo.geo.spatialFilter."+o)," ")}}function pv(e,t){1&e&&(w.TgZ(0,"mat-header-cell",40),w._uU(1),w.ALo(2,"translate"),w.qZA()),2&e&&(w.xp6(1),w.Oqu(w.lcZ(2,1,"igo.geo.spatialFilter.Thematics")))}function dv(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-header-cell",41),w.TgZ(1,"mat-checkbox",42),w.NdJ("change",function(e){w.CHM(i);var t=w.oxw(2);return e?t.masterToggle():null}),w.qZA(),w.qZA()}if(2&e){var o=w.oxw(2);w.xp6(1),w.Q6J("checked",o.isAllSelected())("indeterminate",o.selectedThematics.hasValue()&&!o.isAllSelected())}}function hv(e,t){1&e&&w._UZ(0,"mat-header-row")}function gv(e,t){1&e&&w._UZ(0,"mat-row")}function fv(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-tree-node",43),w.TgZ(1,"li",44),w._UZ(2,"button",45),w._uU(3),w.TgZ(4,"mat-checkbox",46),w.NdJ("click",function(e){return e.stopPropagation()})("change",function(e){var t=w.CHM(i).$implicit,o=w.oxw(2);return e?o.onToggleChange(t):null}),w.qZA(),w.qZA(),w.qZA()}if(2&e){var o=t.$implicit,n=w.oxw(2);w.xp6(3),w.hij(" ",o.name," "),w.xp6(1),w.Q6J("checked",n.selectedThematics.isSelected(o))}}function mv(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-nested-tree-node"),w.TgZ(1,"div",44),w.TgZ(2,"button",47),w.NdJ("click",function(){var e=w.CHM(i).$implicit;return w.oxw(2).onToggleClick(e)}),w._UZ(3,"mat-icon",48),w.qZA(),w._uU(4),w.TgZ(5,"mat-checkbox",49),w.NdJ("change",function(e){var t=w.CHM(i).$implicit,o=w.oxw(2);return e?o.childrensToggle(t):null}),w.qZA(),w.qZA(),w.TgZ(6,"ul",50),w.GkF(7,51),w.qZA(),w.qZA()}if(2&e){var o=t.$implicit,n=w.oxw(2);w.xp6(3),w.Q6J("svgIcon",n.treeControl.isExpanded(o)?"chevron-down":"chevron-right"),w.xp6(1),w.hij(" ",o.name," "),w.xp6(1),w.Q6J("checked",n.isAllSelected(o))("indeterminate",n.hasChildrenSelected(o)&&!n.isAllSelected(o)),w.xp6(1),w.ekj("example-tree-invisible",!n.treeControl.isExpanded(o))}}function vv(e,t){if(1&e&&(w.TgZ(0,"div",30),w.TgZ(1,"mat-table"),w.ynx(2,31),w.YNc(3,pv,3,3,"mat-header-cell",32),w.BQk(),w.ynx(4,33),w.YNc(5,dv,2,2,"mat-header-cell",34),w.BQk(),w.YNc(6,hv,1,0,"mat-header-row",35),w.YNc(7,gv,1,0,"mat-row",36),w.qZA(),w.TgZ(8,"mat-tree",37),w.YNc(9,fv,5,2,"mat-tree-node",38),w.YNc(10,mv,8,6,"mat-nested-tree-node",39),w.qZA(),w.qZA()),2&e){var i=w.oxw();w.xp6(6),w.Q6J("matHeaderRowDef",i.displayedColumns),w.xp6(1),w.Q6J("matRowDefColumns",i.displayedColumns),w.xp6(1),w.Q6J("dataSource",i.dataSource)("treeControl",i.treeControl),w.xp6(2),w.Q6J("matTreeNodeDefWhen",i.hasChild)}}function yv(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",52),w.NdJ("click",function(){return w.CHM(i),w.oxw().clearSearch()}),w._uU(1),w.ALo(2,"translate"),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("disabled",o.disabledClearSearch()),w.xp6(1),w.hij(" ",w.lcZ(2,2,"igo.geo.spatialFilter.clearSearch")," ")}}function bv(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",53),w.NdJ("click",function(){return w.CHM(i),w.oxw().clearDrawZone()}),w._uU(1),w.ALo(2,"translate"),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("disabled",null===o.formControl.value),w.xp6(1),w.hij(" ",w.lcZ(2,2,"igo.geo.spatialFilter.clearForm")," ")}}function wv(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",54),w.NdJ("click",function(){return w.CHM(i),w.oxw().toggleVisibleList()}),w.ALo(1,"translate"),w._UZ(2,"mat-icon",55),w.qZA()}2&e&&w.Q6J("matTooltip",w.lcZ(1,1,"igo.geo.spatialFilter.showSearchResults"))}function xv(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",59),w.NdJ("click",function(){return w.CHM(i),w.oxw(2).toggleVisibleList()}),w.ALo(1,"translate"),w._UZ(2,"mat-icon",60),w.qZA()}2&e&&w.Q6J("matTooltip",w.lcZ(1,1,"igo.geo.spatialFilter.hideSearchResults"))}function Sv(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",56),w.YNc(1,xv,3,3,"button",57),w.TgZ(2,"igo-entity-table",58),w.NdJ("entitySelectChange",function(e){return w.CHM(i),w.oxw().entityChange.emit(e)}),w.qZA(),w.qZA()}if(2&e){var o=w.oxw();w.xp6(1),w.Q6J("ngIf",o.listIsVisible),w.xp6(1),w.Q6J("template",o.tableTemplate)("store",o.store)}}var kv=function(){var e=function(){function e(t,i,o,n){m(this,e),this.cdRef=t,this.spatialFilterService=i,this.messageService=o,this.languageService=n,this.layers=[],this.allLayers=[],this.toggleSearch=new w.vpe,this.itemTypeChange=new w.vpe,this.thematicChange=new w.vpe,this.drawZoneEvent=new w.vpe,this.bufferEvent=new w.vpe,this.zoneWithBufferChange=new w.vpe,this.measureUnitChange=new w.vpe,this.radiusEvent=new w.vpe,this.freehandControl=new w.vpe,this.clearButtonEvent=new w.vpe,this.clearSearchEvent=new w.vpe,this.export=new w.vpe,this.openWorkspace=new w.vpe,this.entityChange=new w.vpe,this.itemType=[mh.Address,mh.Thematics],this.selectedItemType=mh.Address,this.treeControl=new Rl.VY(function(e){return e.children}),this.displayedColumns=["name","select"],this.childrens=[],this.groups=[],this.thematics=[],this.dataSource=new Dl.WX,this.selectedThematics=new ft.Ov(!0,[]),this.value$=new R.X(void 0),this.drawGuide$=new R.X(null),this.overlayStyle$=new R.X(void 0),this.drawStyle$=new R.X(void 0),this.formControl=new We.NI,this.geometryTypeField=!1,this.geometryTypes=["Point","Polygon"],this.drawGuideField=!1,this.drawGuide=null,this.drawGuidePlaceholder="",this.measure=!1,this.drawControlIsActive=!0,this.freehandDrawIsActive=!1,this.buffer=0,this.radiusFormControl=new We.NI,this.bufferFormControl=new We.NI,this.measureUnit=Jh.Meters,this.listIsVisible=!0}return y(e,[{key:"type",get:function(){return this._type},set:function(e){var t=this;this._type=e;var i=this.geometryTypes.findIndex(function(e){return e===t.type});if(this.geometryType=this.geometryTypes[i],this.formControl.reset(),this.radius=void 0,this.drawGuide$.next(null),this.drawStyle$.next(void 0),this.type===fh.Predefined&&this.formControl.setValue({type:"Point",coordinates:""}),this.type===fh.Point)this.radius=1e3,this.radiusFormControl.setValue(this.radius),this.PointStyle=function(e,i){var o=e.getGeometry(),n=ls.vs(o.getCoordinates(),t.map.projection,"EPSG:4326");return new ms.ZP({image:new xs.Z({radius:t.radius/Math.cos(Math.PI/180*n[1])/i,stroke:new ws.Z({width:2,color:"rgba(0, 153, 255)"}),fill:new ys.Z({color:"rgba(0, 153, 255, 0.2)"})})})},this.overlayStyle=this.PointStyle,this.drawStyle$.next(this.overlayStyle);else{this.radius=void 0,this.PolyStyle=function(){return new ms.ZP({stroke:new ws.Z({width:2,color:"rgba(0, 153, 255)"}),fill:new ys.Z({color:"rgba(0, 153, 255, 0.2)"})})};var o=[0,153,255];this.overlayStyle=this.PolyStyle,this.drawStyle$.next(function(){return new ms.ZP({image:new xs.Z({radius:8,stroke:new ws.Z({width:2,color:"rgba(0, 153, 255)"}),fill:new ys.Z({color:"rgba(0, 153, 255, 0.2)"})}),stroke:new ws.Z({color:o.concat([1]),width:2}),fill:new ys.Z({color:o.concat([.2])})})})}this.overlayStyle$.next(this.overlayStyle)}},{key:"store",get:function(){return this._store},set:function(e){var t=this;this._store=e,this._store.entities$.subscribe(function(){t.cdRef.detectChanges()})}},{key:"measureUnits",get:function(){return[Jh.Meters,Jh.Kilometers]}},{key:"thematicLength",get:function(){return this._thematicLength},set:function(e){this._thematicLength=e}},{key:"ngOnInit",value:function(){var e=this;this.spatialFilterService.loadThematicsList().subscribe(function(t){var i,o=p(t);try{for(o.s();!(i=o.n()).done;){var n=i.value;e.childrens.push(n),e.childrens.sort(function(e,t){return e.name.localeCompare(t.name)})}}catch(a){o.e(a)}finally{o.f()}e.groups.push(e.languageService.translate.instant("igo.geo.terrapi.limites"));var r={name:e.groups[0],children:[]};e.thematics.push(r),e.childrens.forEach(function(t){t.group&&-1===e.groups.indexOf(t.group)&&(e.groups.push(t.group),e.thematics.push({name:t.group,children:[]})),t.group||(t.name===e.languageService.translate.instant("igo.geo.terrapi.AdmRegion")||t.name===e.languageService.translate.instant("igo.geo.terrapi.Mun")||t.name===e.languageService.translate.instant("igo.geo.terrapi.Arrond")||t.name===e.languageService.translate.instant("igo.geo.terrapi.CircFed")||t.name===e.languageService.translate.instant("igo.geo.terrapi.CircProv")||t.name===e.languageService.translate.instant("igo.geo.terrapi.DirReg")||t.name===e.languageService.translate.instant("igo.geo.terrapi.MRC")||t.name===e.languageService.translate.instant("igo.geo.terrapi.RegTour")?t.group=r.name:t.name===e.languageService.translate.instant("igo.geo.terrapi.routes")?t.group=e.languageService.translate.instant("igo.geo.spatialFilter.group.transport"):e.thematics.push({name:t.name,children:[],source:t.source})),e.thematics.sort(function(e,t){return e.name.localeCompare(t.name)})}),e.thematics.forEach(function(t){var i,o=p(e.childrens);try{for(o.s();!(i=o.n()).done;){var n=i.value;n.group===t.name&&t.children.push(n)}}catch(a){o.e(a)}finally{o.f()}})}),this.dataSource.data=this.thematics,this.drawGuide$.next(null),this.value$.next(this.formControl.value?this.formControl.value:void 0),this.value$$=this.formControl.valueChanges.subscribe(function(t){t?(e.value$.next(t),e.drawZone=e.formControl.value,0!==e.buffer&&(e.drawZoneEvent.emit(e.drawZone),e.bufferFormControl.setValue(e.buffer))):(e.value$.next(void 0),e.drawZone=void 0)}),this.value$.subscribe(function(){e.getRadius(),e.cdRef.detectChanges()}),this.radiusChanges$$=this.radiusFormControl.valueChanges.subscribe(function(){e.getRadius(),e.cdRef.detectChanges()}),this.bufferChanges$$=this.bufferFormControl.valueChanges.pipe((0,E.b)(500)).subscribe(function(t){e.measureUnit===Jh.Meters&&t>0&&t<=1e5?(e.buffer=t,e.bufferEvent.emit(t),e.spatialFilterService.loadBufferGeometry(e.drawZone,fh.Polygon,t).subscribe(function(t){e.zoneWithBuffer=t,e.zoneWithBufferChange.emit(e.zoneWithBuffer)})):e.measureUnit===Jh.Kilometers&&t>0&&t<=100?(e.buffer=t,e.bufferEvent.emit(t),e.spatialFilterService.loadBufferGeometry(e.drawZone,fh.Polygon,1e3*t).subscribe(function(t){e.zoneWithBuffer=t,e.zoneWithBufferChange.emit(e.zoneWithBuffer)})):0===t?(e.buffer=t,e.bufferEvent.emit(t),e.drawZoneEvent.emit(e.drawZone)):(t<0||e.measureUnit===Jh.Meters&&t>1e5||e.measureUnit===Jh.Kilometers&&t>100)&&(e.bufferFormControl.setValue(0),e.buffer=0,e.messageService.alert(e.languageService.translate.instant("igo.geo.spatialFilter.bufferAlert"),e.languageService.translate.instant("igo.geo.spatialFilter.warning")))});var t=new Ot({}),i=new Cu({layer:new jc({zIndex:300,source:new _c,style:void 0,showInLayerList:!1,exportable:!1,browsable:!1}),map:this.map,hitTolerance:15,motion:tc.Default,many:!0,dragBox:!0});this.store.addStrategy(i,!0),this.store.addStrategy(t,!1)}},{key:"ngOnDestroy",value:function(){this.value$$.unsubscribe(),this.radiusChanges$$.unsubscribe(),this.bufferChanges$$.unsubscribe(),this.cdRef.detach(),this.radiusChanges$$&&this.radiusChanges$$.unsubscribe(),this.value$$&&this.value$$.unsubscribe()}},{key:"onItemTypeChange",value:function(e){this.selectedItemType=e.value,this.itemTypeChange.emit(this.selectedItemType)}},{key:"onMeasureUnitChange",value:function(e){e!==this.measureUnit&&(this.measureUnit=e,this.measureUnitChange.emit(this.measureUnit),this.isPolygon()?this.bufferFormControl.setValue(this.measureUnit===Jh.Meters?1e3*this.bufferFormControl.value:this.bufferFormControl.value/1e3):this.isPoint()&&this.radiusFormControl.setValue(this.measureUnit===Jh.Meters?1e3*this.radiusFormControl.value:this.radiusFormControl.value/1e3))}},{key:"isPredefined",value:function(){return this.type===fh.Predefined}},{key:"isPolygon",value:function(){return this.type===fh.Polygon}},{key:"isPoint",value:function(){return this.type===fh.Point}},{key:"hasChild",value:function(e,t){return!!t.children&&t.children.length}},{key:"onToggleClick",value:function(e){this.treeControl.isExpanded(e)?this.treeControl.collapse(e):this.treeControl.expand(e)}},{key:"isAllSelected",value:function(e){var t,i=this,o=0;return e?(t=e.children.length,e.children.forEach(function(e){i.selectedThematics.selected.find(function(t){return t===e})&&o++})):(t=this.selectedThematics.selected.length,this.thematics.forEach(function(e){-1===i.groups.indexOf(e.name)&&o++}),this.childrens.forEach(function(e){i.thematics.find(function(t){return t.source===e.source})||o++})),o>=1&&t===o}},{key:"hasChildrenSelected",value:function(e){var t=this,i=!1;return e.children.forEach(function(e){t.selectedThematics.selected.find(function(t){return t.source===e.source})&&(i=!0)}),i}},{key:"masterToggle",value:function(){var e=this;this.isAllSelected()?this.selectedThematics.clear():this.selectAll();var t,i=[],o=p(this.selectedThematics.selected);try{for(o.s();!(t=o.n()).done;){var n=t.value;i.push(n)}}catch(r){o.e(r)}finally{o.f()}this.isAllSelected()?this.thematics.forEach(function(t){e.hasChild(0,t)&&e.treeControl.expand(t)}):this.thematics.forEach(function(t){e.hasChild(0,t)&&e.treeControl.collapse(t)}),this.thematicChange.emit(i)}},{key:"selectAll",value:function(e){var t=this;e?this.hasChild(0,e)&&e.children.forEach(function(e){return t.selectedThematics.select(e)}):(this.thematics.forEach(function(e){-1===t.groups.indexOf(e.name)&&t.selectedThematics.select(e)}),this.childrens.forEach(function(e){t.selectedThematics.selected.find(function(t){return t.source===e.source})||t.selectedThematics.select(e)}))}},{key:"childrensToggle",value:function(e){var t=this;this.isAllSelected(e)?e.children.forEach(function(e){return t.selectedThematics.deselect(e)}):this.selectAll(e);var i,o=[],n=p(this.selectedThematics.selected);try{for(n.s();!(i=n.n()).done;){var r=i.value;o.push(r)}}catch(a){n.e(a)}finally{n.f()}this.treeControl.expand(e),this.thematicChange.emit(o)}},{key:"onToggleChange",value:function(e){var t=this,i=!1;void 0!==this.selectedThematics.selected.find(function(t){return t.source===e.source})&&(i=!0),this.childrens.forEach(function(o){o===e&&!1===i&&t.selectedThematics.select(o),o===e&&!0===i&&t.selectedThematics.deselect(o)}),this.thematics.forEach(function(o){o===e&&!1===i&&t.selectedThematics.select(o),o===e&&!0===i&&t.selectedThematics.deselect(o)});var o,n=[],r=p(this.selectedThematics.selected);try{for(r.s();!(o=r.n()).done;){var a=o.value;n.push(a)}}catch(s){r.e(s)}finally{r.f()}this.thematicChange.emit(n)}},{key:"onDrawControlChange",value:function(){this.drawControlIsActive=!this.drawControlIsActive}},{key:"onfreehandControlChange",value:function(){this.freehandDrawIsActive=!this.freehandDrawIsActive,this.freehandControl.emit(this.freehandDrawIsActive)}},{key:"toggleSearchButton",value:function(){var e=this;this.isPredefined()||(this.buffer>0?(this.zoneWithBuffer.meta={id:void 0,title:"Zone"},this.zoneWithBuffer.properties={nom:"Zone",type:this.type},this.drawZoneEvent.emit(this.zoneWithBuffer)):(this.drawZone.meta={id:void 0,title:"Zone"},this.drawZone.properties={nom:"Zone",type:this.type},this.drawZoneEvent.emit(this.drawZone))),this.isPoint()?this.radiusEvent.emit(this.radius):this.isPolygon()&&this.bufferEvent.emit(this.buffer),this.toggleSearch.emit(),this.store.entities$.pipe((0,E.b)(500)).subscribe(function(t){t.length&&e.layers.length===e.thematicLength+1&&(e.openWorkspace.emit(),e.createTableTemplate())})}},{key:"clearButton",value:function(){this.loading=!0,this.store&&this.store.clear(),(this.isPoint()||this.isPolygon())&&(this.drawZone=void 0,this.formControl.reset()),this.bufferFormControl.setValue(0),this.buffer=0,this.bufferEvent.emit(0),this.clearButtonEvent.emit(),this.loading=!1,this.tableTemplate=void 0}},{key:"clearDrawZone",value:function(){this.formControl.reset(),this.bufferFormControl.setValue(0),this.buffer=0}},{key:"clearSearch",value:function(){this.selectedThematics.clear(),this.bufferFormControl.setValue(0),this.buffer=0,this.bufferEvent.emit(0),this.thematicChange.emit([]),this.clearSearchEvent.emit()}},{key:"disableSearchButton",value:function(){if(this.type===fh.Predefined){if(this.selectedItemType===mh.Address&&void 0!==this.queryType&&void 0!==this.zone)return this.loading;if(this.selectedItemType===mh.Thematics&&void 0!==this.queryType&&void 0!==this.zone&&this.selectedThematics.selected.length>0)return this.loading}if(this.type===fh.Polygon||this.type===fh.Point){if(this.selectedItemType===mh.Address&&null!==this.formControl.value)return this.loading;if(this.selectedItemType===mh.Thematics&&this.selectedThematics.selected.length>0&&null!==this.formControl.value)return this.loading}return!0}},{key:"disabledClearSearch",value:function(){return this.selectedItemType===mh.Address?void 0===this.queryType:void 0===this.queryType&&0===this.selectedThematics.selected.length}},{key:"getRadius",value:function(){var e;if(e=null!==this.formControl.value?this.measureUnit===Jh.Meters?this.formControl.value.radius:this.formControl.value.radius/1e3:void 0,this.type===fh.Point){if(this.freehandDrawIsActive){if(e){if(e>=1e5)return this.messageService.alert(this.languageService.translate.instant("igo.geo.spatialFilter.radiusAlert"),this.languageService.translate.instant("igo.geo.spatialFilter.warning")),void this.formControl.reset();if(e!==this.radiusFormControl.value)return void this.radiusFormControl.setValue(e)}}else if(this.radiusFormControl.value<0||this.measureUnit===Jh.Meters&&this.radiusFormControl.value>=1e5||this.measureUnit===Jh.Kilometers&&this.radiusFormControl.value>=100)return this.messageService.alert(this.languageService.translate.instant("igo.geo.spatialFilter.radiusAlert"),this.languageService.translate.instant("igo.geo.spatialFilter.warning")),this.radius=1e3,this.radiusFormControl.setValue(this.measureUnit===Jh.Meters?this.radius:this.radius/1e3),void this.drawGuide$.next(this.radius);this.measureUnit===Jh.Meters?(this.radius=this.radiusFormControl.value,this.drawGuide$.next(this.radius)):(this.radius=1e3*this.radiusFormControl.value,this.drawGuide$.next(1e3*this.radius)),this.overlayStyle$.next(this.PointStyle),this.drawStyle$.next(this.PointStyle)}}},{key:"toggleVisibleList",value:function(){this.listIsVisible=!this.listIsVisible}},{key:"createTableTemplate",value:function(){var e={name:"meta.title",title:this.languageService.translate.instant("igo.geo.spatialFilter.type"),renderer:vt.UnsanitizedHTML},t={name:"properties.nom",title:this.languageService.translate.instant("igo.geo.spatialFilter.searchResults"),renderer:vt.UnsanitizedHTML};this.tableTemplate={selection:!0,sort:!0,columns:[e,t]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(w.sBO),w.Y36(vh),w.Y36(Ae),w.Y36(Ce))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-spatial-filter-item"]],inputs:{map:"map",type:"type",queryType:"queryType",zone:"zone",loading:"loading",store:"store",layers:"layers",allLayers:"allLayers",thematicLength:"thematicLength"},outputs:{toggleSearch:"toggleSearch",itemTypeChange:"itemTypeChange",thematicChange:"thematicChange",drawZoneEvent:"drawZoneEvent",bufferEvent:"bufferEvent",zoneWithBufferChange:"zoneWithBufferChange",measureUnitChange:"measureUnitChange",radiusEvent:"radiusEvent",freehandControl:"freehandControl",clearButtonEvent:"clearButtonEvent",clearSearchEvent:"clearSearchEvent",export:"export",openWorkspace:"openWorkspace",entityChange:"entityChange"},decls:29,vars:42,consts:[[3,"formControl","map","geometryType","drawGuide","measure","drawControlIsActive","freehandDrawIsActive","drawStyle","overlayStyle","radius"],[1,"header"],[3,"checked","labelPosition","change",4,"ngIf"],["class","buffer-unit",4,"ngIf"],["class","radius-unit",4,"ngIf"],[1,"title","mat-typography"],[3,"value"],[3,"value","change",4,"ngFor","ngForOf"],["class","thematics",4,"ngIf"],[1,"buttons"],["mat-raised-button","","class","clear-search-button",3,"disabled","click",4,"ngIf"],["mat-raised-button","","class","clear-form-button",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","primary",1,"search-button",3,"disabled","click"],["mat-raised-button","",1,"remove-button",3,"disabled","click"],["mat-raised-button","",1,"export-button",3,"disabled","click"],["class","chevron-down","mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","click",4,"ngIf"],["class","results",4,"ngIf"],[3,"checked","labelPosition","change"],[1,"buffer-unit"],[1,"buffer-form"],[1,"buffer"],["type","number","matInput","",3,"placeholder","formControl","value","readonly"],[1,"unit-field"],[3,"value","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"radius-unit"],[1,"radius-form"],[1,"radius"],["type","number","matInput","",3,"placeholder","formControl","value","readonly","input"],[3,"value","change"],[1,"thematics"],["matColumnDef","name"],["class","thematics-header",4,"matHeaderCellDef"],["matColumnDef","select"],["class","checks-header",4,"matHeaderCellDef"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[3,"dataSource","treeControl"],["matTreeNodeToggle","",4,"matTreeNodeDef"],[4,"matTreeNodeDef","matTreeNodeDefWhen"],[1,"thematics-header"],[1,"checks-header"],[3,"checked","indeterminate","change"],["matTreeNodeToggle",""],[1,"mat-tree-node"],["mat-icon-button","","disabled",""],[1,"tree-check",3,"checked","click","change"],["mat-icon-button","",3,"click"],[3,"svgIcon"],[1,"tree-check-2",3,"checked","indeterminate","change"],[1,"tree-ul"],["matTreeNodeOutlet",""],["mat-raised-button","",1,"clear-search-button",3,"disabled","click"],["mat-raised-button","",1,"clear-form-button",3,"disabled","click"],["mat-icon-button","","matTooltipShowDelay","500",1,"chevron-down",3,"matTooltip","click"],["svgIcon","chevron-down"],[1,"results"],["mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","click",4,"ngIf"],[1,"results-list",3,"template","store","entitySelectChange"],["mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","click"],["svgIcon","chevron-up"]],template:function(e,t){1&e&&(w._UZ(0,"igo-geometry-form-field-input",0),w.ALo(1,"async"),w.ALo(2,"async"),w.ALo(3,"async"),w.TgZ(4,"div",1),w.YNc(5,nv,3,5,"mat-slide-toggle",2),w.YNc(6,rv,3,5,"mat-slide-toggle",2),w.qZA(),w.YNc(7,sv,8,8,"div",3),w.YNc(8,cv,8,8,"div",4),w.TgZ(9,"mat-label",5),w._uU(10),w.ALo(11,"translate"),w.qZA(),w.TgZ(12,"mat-radio-group",6),w.YNc(13,uv,3,4,"mat-radio-button",7),w.qZA(),w.YNc(14,vv,11,5,"div",8),w.TgZ(15,"div",9),w.YNc(16,yv,3,4,"button",10),w.YNc(17,bv,3,4,"button",11),w.TgZ(18,"button",12),w.NdJ("click",function(){return t.toggleSearchButton()}),w._uU(19),w.ALo(20,"translate"),w.qZA(),w.TgZ(21,"button",13),w.NdJ("click",function(){return t.clearButton()}),w._uU(22),w.ALo(23,"translate"),w.qZA(),w.TgZ(24,"button",14),w.NdJ("click",function(){return t.export.emit()}),w._uU(25),w.ALo(26,"translate"),w.qZA(),w.qZA(),w.YNc(27,wv,3,3,"button",15),w.YNc(28,Sv,3,3,"div",16)),2&e&&(w.Q6J("formControl",t.formControl)("map",t.map)("geometryType",t.geometryType)("drawGuide",w.lcZ(1,28,t.drawGuide$))("measure",t.measure)("drawControlIsActive",t.drawControlIsActive)("freehandDrawIsActive",t.freehandDrawIsActive)("drawStyle",w.lcZ(2,30,t.drawStyle$))("overlayStyle",w.lcZ(3,32,t.overlayStyle$))("radius",t.radius),w.xp6(5),w.Q6J("ngIf",!t.isPredefined()),w.xp6(1),w.Q6J("ngIf",!t.isPredefined()),w.xp6(1),w.Q6J("ngIf",t.isPolygon()),w.xp6(1),w.Q6J("ngIf",t.isPoint()),w.xp6(2),w.hij("",w.lcZ(11,34,"igo.geo.spatialFilter.search")," : "),w.xp6(2),w.Q6J("value",t.selectedItemType),w.xp6(1),w.Q6J("ngForOf",t.itemType),w.xp6(1),w.Q6J("ngIf","Thematics"===t.selectedItemType&&!t.tableTemplate||"Thematics"===t.selectedItemType&&t.tableTemplate&&!t.listIsVisible),w.xp6(2),w.Q6J("ngIf",t.isPredefined()),w.xp6(1),w.Q6J("ngIf",t.isPolygon()||t.isPoint()),w.xp6(1),w.Q6J("disabled",t.disableSearchButton()),w.xp6(1),w.hij(" ",w.lcZ(20,36,"igo.geo.spatialFilter.goSearch")," "),w.xp6(2),w.Q6J("disabled",0===t.allLayers.length),w.xp6(1),w.hij(" ",w.lcZ(23,38,"igo.geo.spatialFilter.removeLayer")," "),w.xp6(2),w.Q6J("disabled",!t.store.entities$.getValue().length),w.xp6(1),w.hij(" ",w.lcZ(26,40,"igo.geo.spatialFilter.exportLayer")," "),w.xp6(2),w.Q6J("ngIf",t.store.all().length&&t.tableTemplate&&!t.listIsVisible),w.xp6(1),w.Q6J("ngIf",t.store.all().length&&t.tableTemplate&&t.listIsVisible))},styles:[".header[_ngcontent-%COMP%]{margin-top:5px;width:100%}.mat-slide-toggle[_ngcontent-%COMP%]{padding:5px;margin-bottom:15px;width:98%}.mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content{width:calc(100% - 20px)}.title[_ngcontent-%COMP%]{margin-left:5px;font-size:medium;font-size:initial}.mat-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-top:10px}.mat-radio-button[_ngcontent-%COMP%]{display:inline-flex;position:relative;margin-left:16px;margin-top:10px}.mat-form-field[_ngcontent-%COMP%]{margin-top:5px}.mat-column-select[_ngcontent-%COMP%]{overflow:auto}.buttons[_ngcontent-%COMP%]{margin-top:15px}.search-button[_ngcontent-%COMP%]{left:15px;width:46%}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){.search-button[_ngcontent-%COMP%]{left:10px;width:45%;min-height:35px;white-space:normal;line-height:normal}}.export-button[_ngcontent-%COMP%]{left:15px;width:46%;margin-bottom:5px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){.export-button[_ngcontent-%COMP%]{left:10px;margin-top:10px;width:45%;min-height:35px;white-space:normal;line-height:normal}}.remove-button[_ngcontent-%COMP%]{margin-top:12px;left:5px;width:46%}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){.remove-button[_ngcontent-%COMP%]{margin:0;width:45%;min-height:35px;white-space:normal;line-height:normal}}.clear-form-button[_ngcontent-%COMP%]{left:5px;width:46%}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){.clear-form-button[_ngcontent-%COMP%]{width:45%;min-height:35px;white-space:normal;line-height:normal}}.clear-search-button[_ngcontent-%COMP%]{left:5px;width:46%}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){.clear-search-button[_ngcontent-%COMP%]{width:45%;min-height:35px;white-space:normal;line-height:normal}}.thematics[_ngcontent-%COMP%]{max-height:35%;overflow:auto;margin-top:5px;width:98%}.results[_ngcontent-%COMP%]{overflow:auto;max-height:250px;width:98%}.mat-column-typeResults[_ngcontent-%COMP%]{max-width:100px;margin-right:5px}.buffer-unit[_ngcontent-%COMP%], .radius-unit[_ngcontent-%COMP%]{display:flex;width:100%;margin-left:2px;padding:5px}.radius[_ngcontent-%COMP%], .buffer[_ngcontent-%COMP%]{display:flex;flex-flow:column nowrap;width:110%}.unit-field[_ngcontent-%COMP%]{width:110px;margin-left:30px}.example-tree-invisible[_ngcontent-%COMP%]{display:none}.tree-ul[_ngcontent-%COMP%]{margin:0;padding:0 0 0 20px;list-style-type:none}.tree-check[_ngcontent-%COMP%], .tree-check-2[_ngcontent-%COMP%]{position:relative;margin-left:auto;margin-right:5px}.thematics-header[_ngcontent-%COMP%]{max-width:250px}.checks-header[_ngcontent-%COMP%]{padding:none;max-width:calc(100% - 316px);overflow:hidden}.mat-checkbox[_ngcontent-%COMP%]{padding:5px}.mat-tree-node[_ngcontent-%COMP%]{position:relative;min-height:42px;width:280px}.mat-header-cell[_ngcontent-%COMP%]{height:56px}.results[_ngcontent-%COMP%]{max-height:45%;width:98%}.results[_ngcontent-%COMP%]   igo-entity-table[_ngcontent-%COMP%]     div.table-container{overflow:unset}"],changeDetection:0}),e}(),Cv=["endDatepickerTime"],Tv=["beginDatepickerTime"],Av=["beginTime"],Lv=["endTime"];function Zv(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-slide-toggle",4),w.NdJ("ngModelChange",function(e){return w.CHM(i),w.oxw().sliderMode=e})("change",function(e){return w.CHM(i),w.oxw().modeChange(e)}),w._uU(1),w.ALo(2,"translate"),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("ngModel",o.sliderMode),w.xp6(1),w.hij(" ",w.lcZ(2,2,"igo.geo.filter.sliderModeTitle")," ")}}function Fv(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",5),w.TgZ(1,"igo-ogc-filter-time-slider",6),w.NdJ("changeProperty",function(e){return w.CHM(i),w.oxw().changePropertyByPass(e)}),w.qZA(),w.qZA()}if(2&e){var o=w.oxw();w.xp6(1),w.Q6J("begin",o.beginValue)("max",o.restrictedToStep()?o.maxDate:o.endValue)("currentFilter",o.currentFilter)("datasource",o.datasource)}}function Ov(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",9),w.TgZ(1,"mat-form-field",10),w.TgZ(2,"mat-label"),w._uU(3),w.ALo(4,"translate"),w.qZA(),w.TgZ(5,"input",11),w.NdJ("change",function(e){w.CHM(i);var t=w.MAs(8);return w.oxw(2).yearOnlyInputChange(e,t,"begin")}),w.qZA(),w._UZ(6,"mat-datepicker-toggle",12),w.TgZ(7,"mat-datepicker",13,14),w.NdJ("yearSelected",function(e){w.CHM(i);var t=w.MAs(8);return w.oxw(2).yearSelected(e,t,"begin")}),w.qZA(),w._UZ(9,"input",15,16),w.qZA(),w.TgZ(11,"mat-form-field",10),w.TgZ(12,"mat-label"),w._uU(13),w.ALo(14,"translate"),w.qZA(),w.TgZ(15,"input",11),w.NdJ("change",function(e){w.CHM(i);var t=w.MAs(18);return w.oxw(2).yearOnlyInputChange(e,t,"end")}),w.qZA(),w._UZ(16,"mat-datepicker-toggle",12),w.TgZ(17,"mat-datepicker",13,17),w.NdJ("yearSelected",function(e){w.CHM(i);var t=w.MAs(18);return w.oxw(2).yearSelected(e,t,"end")}),w.qZA(),w._UZ(19,"input",15,18),w.qZA(),w.TgZ(21,"button",19),w.NdJ("click",function(){return w.CHM(i),w.oxw(2).resetFilter()}),w.ALo(22,"translate"),w._UZ(23,"mat-icon",20),w.qZA(),w.TgZ(24,"mat-slide-toggle",21),w.NdJ("change",function(){return w.CHM(i),w.oxw(2).toggleFilterState()}),w.ALo(25,"translate"),w.qZA(),w.qZA()}if(2&e){var o=w.MAs(8),n=w.MAs(18),r=w.oxw(2);w.xp6(3),w.Oqu(w.lcZ(4,27,"igo.geo.timeFilter.startYear")),w.xp6(2),w.s9C("value",r.onlyYearBegin),w.Q6J("disabled",r.filterStateDisable),w.xp6(1),w.Q6J("for",o)("disabled",r.filterStateDisable),w.xp6(1),w.Q6J("startView",r.calendarView())("startAt",r.beginValue),w.xp6(2),w.Q6J("matDatepicker",o)("value",r.beginValue?r.beginValue:r.handleDate(r.datasource.options.minDate))("min",r.handleDate(r.datasource.options.minDate))("max",r.endValue&&!r.restrictedToStep()?r.endValue:r.handleDate(r.datasource.options.maxDate)),w.xp6(4),w.Oqu(w.lcZ(14,29,"igo.geo.timeFilter.endYear")),w.xp6(2),w.s9C("value",r.onlyYearEnd),w.Q6J("disabled",r.filterStateDisable),w.xp6(1),w.Q6J("for",n)("disabled",r.filterStateDisable),w.xp6(1),w.Q6J("startView",r.calendarView())("startAt",r.endValue),w.xp6(2),w.Q6J("matDatepicker",n)("value",r.endValue?r.endValue:r.handleDate(r.datasource.options.maxDate))("min",r.beginValue?r.beginValue:r.handleDate(r.datasource.options.minDate))("max",r.handleDate(r.datasource.options.maxDate)),w.xp6(2),w.Q6J("matTooltip",w.lcZ(22,31,"igo.geo.filter.resetFilters"))("disabled",r.filterStateDisable),w.xp6(2),w.s9C("svgIcon",r.resetIcon),w.xp6(1),w.Q6J("matTooltip",w.lcZ(25,33,"igo.geo.filter.toggleFilterState"))("checked",!r.filterStateDisable)}}function Mv(e,t){if(1&e&&(w.TgZ(0,"mat-option",36),w._uU(1),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i),w.xp6(1),w.Oqu(i)}}function Iv(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-form-field",33),w.TgZ(1,"mat-label"),w._uU(2),w.ALo(3,"translate"),w.qZA(),w.TgZ(4,"mat-select",34),w.NdJ("selectionChange",function(){w.CHM(i),w.oxw();var e=w.MAs(5);return w.oxw(2).changeTemporalProperty(e.value,1)}),w.YNc(5,Mv,2,2,"mat-option",35),w.qZA(),w.qZA()}if(2&e){var o=w.oxw(3);w.xp6(2),w.Oqu(w.lcZ(3,4,"igo.geo.timeFilter.hour")),w.xp6(2),w.Q6J("formControl",o.beginHourFormControl),w.uIk("disabled",!o.currentFilter.active),w.xp6(1),w.Q6J("ngForOf",o.beginHours)}}function Pv(e,t){if(1&e&&(w.TgZ(0,"mat-option",36),w._uU(1),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i),w.xp6(1),w.Oqu(i)}}function _v(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-form-field",37),w.TgZ(1,"mat-label"),w._uU(2),w.ALo(3,"translate"),w.qZA(),w.TgZ(4,"mat-select",34),w.NdJ("selectionChange",function(){w.CHM(i),w.oxw();var e=w.MAs(5);return w.oxw(2).changeTemporalProperty(e.value,1)}),w.YNc(5,Pv,2,2,"mat-option",35),w.qZA(),w.qZA()}if(2&e){var o=w.oxw(3);w.xp6(2),w.Oqu(w.lcZ(3,4,"igo.geo.timeFilter.minute")),w.xp6(2),w.Q6J("formControl",o.beginMinuteFormControl),w.uIk("disabled",!o.currentFilter.active),w.xp6(1),w.Q6J("ngForOf",o.beginMinutes)}}function qv(e,t){if(1&e&&(w.TgZ(0,"mat-option",36),w._uU(1),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i),w.xp6(1),w.Oqu(i)}}function Dv(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-form-field",33),w.TgZ(1,"mat-label"),w._uU(2),w.ALo(3,"translate"),w.qZA(),w.TgZ(4,"mat-select",34),w.NdJ("selectionChange",function(){w.CHM(i),w.oxw();var e=w.MAs(4);return w.oxw(3).changeTemporalProperty(e.value,2)}),w.YNc(5,qv,2,2,"mat-option",35),w.qZA(),w.qZA()}if(2&e){var o=w.oxw(4);w.xp6(2),w.Oqu(w.lcZ(3,4,"igo.geo.timeFilter.hour")),w.xp6(2),w.Q6J("formControl",o.endHourFormControl),w.uIk("disabled",!o.currentFilter.active),w.xp6(1),w.Q6J("ngForOf",o.endHours)}}function Ev(e,t){if(1&e&&(w.TgZ(0,"mat-option",36),w._uU(1),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i),w.xp6(1),w.Oqu(i)}}function $v(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-form-field",37),w.TgZ(1,"mat-label"),w._uU(2),w.ALo(3,"translate"),w.qZA(),w.TgZ(4,"mat-select",34),w.NdJ("selectionChange",function(){w.CHM(i),w.oxw();var e=w.MAs(4);return w.oxw(3).changeTemporalProperty(e.value,2)}),w.YNc(5,Ev,2,2,"mat-option",35),w.qZA(),w.qZA()}if(2&e){var o=w.oxw(4);w.xp6(2),w.Oqu(w.lcZ(3,4,"igo.geo.timeFilter.minute")),w.xp6(2),w.Q6J("formControl",o.endMinuteFormControl),w.uIk("disabled",!o.currentFilter.active),w.xp6(1),w.Q6J("ngForOf",o.endMinutes)}}function Rv(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",23),w.TgZ(1,"mat-form-field",24),w._UZ(2,"mat-datepicker-toggle",12),w.TgZ(3,"input",25,38),w.NdJ("dateChange",function(){w.CHM(i);var e=w.MAs(4);return w.oxw(3).changeTemporalProperty(e.value,2)}),w.ALo(5,"translate"),w.qZA(),w._UZ(6,"span",27),w.TgZ(7,"mat-datepicker",28,17),w.NdJ("yearSelected",function(e){w.CHM(i);var t=w.MAs(8);return w.oxw(3).yearSelected(e,t,"end")})("monthSelected",function(e){w.CHM(i);var t=w.MAs(8);return w.oxw(3).monthSelected(e,t,"end")}),w.qZA(),w.qZA(),w.TgZ(9,"div",29),w.YNc(10,Dv,6,6,"mat-form-field",30),w.YNc(11,$v,6,6,"mat-form-field",31),w.qZA(),w.qZA()}if(2&e){var o=w.MAs(8),n=w.oxw(3);w.xp6(2),w.Q6J("for",o)("disabled",n.filterStateDisable),w.xp6(1),w.Q6J("matDatepicker",o)("placeholder",w.lcZ(5,14,"igo.geo.timeFilter.endDate"))("matDatepickerFilter",n.dateFilter.bind(n,"end"))("value",n.endValue?n.endValue:n.handleDate(n.datasource.options.maxDate))("min",n.beginValue?n.beginValue:n.handleDate(n.datasource.options.minDate))("max",n.handleDate(n.datasource.options.maxDate))("disabled",n.filterStateDisable),w.uIk("disabled",!n.currentFilter.active),w.xp6(4),w.Q6J("startView",n.calendarView())("startAt",n.endValue),w.xp6(3),w.Q6J("ngIf","datetime"===n.calendarType()),w.xp6(1),w.Q6J("ngIf","datetime"===n.calendarType())}}function Nv(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",22),w.TgZ(1,"div",23),w.TgZ(2,"mat-form-field",24),w._UZ(3,"mat-datepicker-toggle",12),w.TgZ(4,"input",25,26),w.NdJ("dateChange",function(){w.CHM(i);var e=w.MAs(5);return w.oxw(2).changeTemporalProperty(e.value,1)}),w.ALo(6,"translate"),w.qZA(),w._UZ(7,"span",27),w.TgZ(8,"mat-datepicker",28,14),w.NdJ("yearSelected",function(e){w.CHM(i);var t=w.MAs(9);return w.oxw(2).yearSelected(e,t,"begin")})("monthSelected",function(e){w.CHM(i);var t=w.MAs(9);return w.oxw(2).monthSelected(e,t,"begin")}),w.qZA(),w.qZA(),w.TgZ(10,"div",29),w.YNc(11,Iv,6,6,"mat-form-field",30),w.YNc(12,_v,6,6,"mat-form-field",31),w.qZA(),w.qZA(),w.YNc(13,Rv,12,16,"div",32),w.TgZ(14,"button",19),w.NdJ("click",function(){return w.CHM(i),w.oxw(2).resetFilter()}),w.ALo(15,"translate"),w._UZ(16,"mat-icon",20),w.qZA(),w.TgZ(17,"mat-slide-toggle",21),w.NdJ("change",function(){return w.CHM(i),w.oxw(2).toggleFilterState()}),w.ALo(18,"translate"),w.qZA(),w.qZA()}if(2&e){var o=w.MAs(9),n=w.oxw(2);w.xp6(3),w.Q6J("for",o)("disabled",n.filterStateDisable),w.xp6(1),w.Q6J("matDatepicker",o)("placeholder",w.lcZ(6,20,"igo.geo.timeFilter.startDate"))("matDatepickerFilter",n.dateFilter.bind(n,"begin"))("value",n.beginValue?n.beginValue:n.handleDate(n.datasource.options.minDate))("min",n.handleDate(n.datasource.options.minDate))("max",n.endValue&&!n.restrictedToStep()?n.endValue:n.handleDate(n.datasource.options.maxDate))("disabled",n.filterStateDisable),w.uIk("disabled",!n.currentFilter.active),w.xp6(4),w.Q6J("startView",n.calendarView())("startAt",n.beginValue),w.xp6(3),w.Q6J("ngIf","datetime"===n.calendarType()),w.xp6(1),w.Q6J("ngIf","datetime"===n.calendarType()),w.xp6(1),w.Q6J("ngIf",!n.restrictedToStep()),w.xp6(1),w.Q6J("matTooltip",w.lcZ(15,22,"igo.geo.filter.resetFilters"))("disabled",n.filterStateDisable),w.xp6(2),w.s9C("svgIcon",n.resetIcon),w.xp6(1),w.Q6J("matTooltip",w.lcZ(18,24,"igo.geo.filter.toggleFilterState"))("checked",!n.filterStateDisable)}}function Uv(e,t){if(1&e&&(w.TgZ(0,"div"),w.YNc(1,Ov,26,35,"div",7),w.YNc(2,Nv,19,26,"div",8),w.qZA()),2&e){var i=w.oxw();w.xp6(1),w.Q6J("ngIf",i.calendarTypeYear),w.xp6(1),w.Q6J("ngIf","year"!==i.calendarType())}}var Jv=Xe,Bv=function(){var e=function(){function e(t){m(this,e),this.ogcFilterTimeService=t,this.changeProperty=new w.vpe,this.beginHourFormControl=new We.NI,this.beginMinuteFormControl=new We.NI,this.endHourFormControl=new We.NI,this.endMinuteFormControl=new We.NI,this._defaultMin="1900-01-01",this._defaultMax="2052-01-06",this._defaultDisplayFormat="DD/MM/YYYY HH:mm A",this._defaultSliderModeEnabled=!0,this.ogcFilterOperator=vc,this.sliderMode=!1,this.defaultStepMillisecond=6e4,this.calendarTypeYear=!1,this.resetIcon="replay"}return y(e,[{key:"step",get:function(){return this.datasource.options.stepDate?this.datasource.options.stepDate:this.currentFilter.step}},{key:"stepMilliseconds",get:function(){var e=Jv.duration(this.step).asMilliseconds();return 0===e?this.defaultStepMillisecond:e}},{key:"beginValue",get:function(){return this._beginValue},set:function(e){this._beginValue=e}},{key:"endValue",get:function(){return this._endValue},set:function(e){this._endValue=e}},{key:"sliderInterval",get:function(){return void 0===this.currentFilter.sliderInterval?2e3:this.currentFilter.sliderInterval}},{key:"maxDate",get:function(){return this.datasource.options.maxDate?this.datasource.options.maxDate:this._defaultMax}},{key:"displayFormat",get:function(){return this.currentFilter.displayFormat?this.currentFilter.displayFormat:this._defaultDisplayFormat}},{key:"ngOnInit",value:function(){this.currentFilter.sliderOptions&&(this.currentFilter.sliderOptions.enabled=void 0!==this.currentFilter.sliderOptions.enabled?this.currentFilter.sliderOptions.enabled:this._defaultSliderModeEnabled),this.beginValue=this.parseFilter(this.handleMin()),this.endValue=this.parseFilter(this.handleMax()),this.onlyYearBegin=this.beginValue.getUTCFullYear(),this.onlyYearEnd=this.endValue.getUTCFullYear(),this.calendarTypeYear=this.isCalendarYearMode(),this.setFilterStateDisable(),this.updateHoursMinutesArray(),this.updateValues()}},{key:"parseFilter",value:function(e){if(!e)return new Date;if(isNaN(new Date(e).getTime())){if(e.search("now")>=0){var t=e.match(/years|months|weeks|days|hours|seconds/);if(e.match(/\+/)){var i=parseInt(e.substring(e.search("+")+1,t.index),10);return Jv().add(i,t[0]).toDate()}if(e.match(/\-/)){var o=parseInt(e.substring(e.search("-")+1,t.index),10);return Jv().subtract(o,t[0]).toDate()}return new Date}if(e.search("today")>=0){var n=Jv().endOf("day").toDate(),r=e.match(/years|months|weeks|days|hours|seconds/);if(e.match(/\+/)){var a=parseInt(e.substring(e.search("+")+1,r.index),10);return Jv(n).add(a,r[0]).toDate()}if(e.match(/\-/)){var s=parseInt(e.substring(e.search("-")+1,r.index),10);return Jv(n).subtract(s,r[0]).toDate()}return n}return new Date}return this.currentFilter.calendarModeYear?this.getDateFromStringWithoutTime(e):e?new Date(e):new Date}},{key:"changeTemporalProperty",value:function(e,t){var i,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.getDateTime(e,t);if(this.isCalendarYearMode())return 1===t?(this.beginValue=e,this.onlyYearBegin=this.beginValue.getFullYear(),i="".concat(this.onlyYearBegin,"-01-01")):(this.endValue=e,this.onlyYearEnd=this.endValue.getFullYear(),i="".concat(this.onlyYearEnd,"-01-01")),void this.changeProperty.next({value:i,pos:t,refreshFilter:o});2===t&&"date"===this.calendarType()&&!this.sliderMode&&(n=Jv(n).endOf("day").toDate()),1===t?(this.beginValue=n,this.restrictedToStep()&&this.changeTemporalProperty(this.ogcFilterTimeService.addStep(n,this.stepMilliseconds),2,o)):this.endValue=n,this.updateHoursMinutesArray(),this.changeProperty.next({value:n.toISOString(),pos:t,refreshFilter:o})}},{key:"handleDate",value:function(e){if(e&&""!==e)return"string"==typeof e&&this.currentFilter.calendarModeYear?this.getDateFromStringWithoutTime(e):new Date(e)}},{key:"calendarType",value:function(){return this.currentFilter.calendarModeYear?"year":this.stepMilliseconds<864e5?"datetime":"date"}},{key:"isCalendarYearMode",value:function(){return"year"===this.calendarType()}},{key:"yearOnlyInputChange",value:function(e,t,i){var o=this.getDateFromStringWithoutTime(e.target.value);this.yearSelected(o,t,i)}},{key:"yearSelected",value:function(e,t,i){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.ogcFilterTimeService.stepIsYearDuration(this.step)&&(t&&t.close(),"end"===i?e=Jv(e).endOf("year").toDate():"begin"===i&&this.restrictedToStep()&&!this.calendarTypeYear&&this.yearSelected(e,void 0,"end"),this.changeTemporalProperty(e,"begin"===i?1:2,o))}},{key:"monthSelected",value:function(e,t,i){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.ogcFilterTimeService.stepIsMonthDuration(this.step)&&(t&&t.close(),"end"===i?e=Jv(e).endOf("month").toDate():"begin"===i&&this.restrictedToStep()&&this.monthSelected(e,void 0,"end"),this.changeTemporalProperty(e,"begin"===i?1:2,o))}},{key:"calendarView",value:function(){var e=this.stepMilliseconds,t=Math.abs(this.parseFilter(this.currentFilter.end).getTime()-this.parseFilter(this.currentFilter.begin).getTime());return this.ogcFilterTimeService.stepIsYearDuration(this.step)?"multi-year":this.ogcFilterTimeService.stepIsMonthDuration(this.step)?"year":e<864e5&&t<864e5?"clock":"month"}},{key:"dateFilter",value:function(e,t){var i=new Date(t),o=i.getTime()-new Date(this.handleMin()).getTime();if(this.ogcFilterTimeService.stepIsYearDuration(this.step)){var n=Jv(i).diff(Jv(this.handleMin()),"years",!0);if("end"===e){var r=Jv(i).add(1,"d");return Jv(r).diff(Jv(this.handleMin()),"years",!0)%Jv.duration(this.step).asYears()==0}if("begin"===e)return n%Jv.duration(this.step).asYears()==0}else if(this.ogcFilterTimeService.stepIsMonthDuration(this.step)){var a=Jv(i).diff(Jv(this.handleMin()),"months",!0);if("end"===e){var s=Jv(i).add(1,"d");return Jv(s).diff(Jv(this.handleMin()),"months",!0)%Jv.duration(this.step).asMonths()==0}if("begin"===e)return a%Jv.duration(this.step).asMonths()==0}else if(this.ogcFilterTimeService.stepIsWeekDuration(this.step)){var l=Jv(i).diff(Jv(this.handleMin()),"weeks",!0);if("end"===e){var c=Jv(i).add(1,"d");return Jv(c).diff(Jv(this.handleMin()),"weeks",!0)%Jv.duration(this.step).asWeeks()==0}if("begin"===e)return l%Jv.duration(this.step).asWeeks()==0}else if(this.ogcFilterTimeService.stepIsDayDuration(this.step)){var u=Jv(i).diff(Jv(this.handleMin()),"days",!0);if("end"===e){var p=Jv(i).add(1,"d"),d=Jv(p).diff(Jv(this.handleMin()),"days",!0)%Jv.duration(this.step).asDays();return d<1e-7&&d>-1e-7||0===d}if("begin"===e){var h=u%Jv.duration(this.step).asDays()+1;return h<1e-7&&h>-1e-7&&0!==h||1===h}}else{if(this.ogcFilterTimeService.stepIsHourDuration(this.step))return Jv(i).diff(Jv(this.handleMin()),"hours",!0)%Jv.duration(this.step).asHours()==0;if(this.ogcFilterTimeService.stepIsMinuteDuration(this.step))return!0}return o%this.stepMilliseconds==0}},{key:"getDateTime",value:function(e,t){var i,o=new Date(e);if(!this.sliderMode)switch(t){case 1:if(this.currentFilter.calendarModeYear){i=o.setHours(0,0);break}i=o.setHours(this.beginHourFormControl.value,this.beginMinuteFormControl.value);break;case 2:if(this.currentFilter.calendarModeYear){i=o.setHours(0,0);break}i=o.setHours(this.endHourFormControl.value,this.endMinuteFormControl.value)}return new Date(i||o)}},{key:"handleMinuteIncrement",value:function(){return this.ogcFilterTimeService.stepIsMinuteDuration(this.step)?this.stepMilliseconds<36e5?this.stepMilliseconds/1e3==60?1:this.stepMilliseconds/1e3:this.stepMilliseconds%36e5/60:this.ogcFilterTimeService.stepIsHourDuration(this.step)?60:1}},{key:"handleHourIncrement",value:function(){return this.ogcFilterTimeService.stepIsHourDuration(this.step)?this.stepMilliseconds/1e3/60/60:1}},{key:"fullBeginHoursArray",value:function(e){var t=this;this.beginHours=Array.from(e?{length:(this.endHourFormControl.value-0)/this.handleHourIncrement()+1}:{length:23/this.handleHourIncrement()+1},function(e,i){return 0+i*t.handleHourIncrement()}),this.beginHourFormControl.setValue(this.beginValue.getHours())}},{key:"fullEndHoursArray",value:function(e){var t=this;this.endHours=e?Array.from({length:(23-this.beginHourFormControl.value)/this.handleHourIncrement()+1},function(e,i){return t.beginHourFormControl.value+i*t.handleHourIncrement()}):Array.from({length:23/this.handleHourIncrement()+1},function(e,i){return 0+i*t.handleHourIncrement()}),this.endHourFormControl.setValue(this.endValue.getHours())}},{key:"fullBeginMinutesArray",value:function(e){var t=this;this.beginMinutes=Array.from(e?{length:(this.endMinuteFormControl.value-0)/this.handleMinuteIncrement()+1}:{length:59/this.handleMinuteIncrement()+1},function(e,i){return 0+i*t.handleMinuteIncrement()}),this.beginMinuteFormControl.setValue(this.beginValue.getMinutes())}},{key:"fullEndMinutesArray",value:function(e){var t=this;this.endMinutes=e?Array.from({length:(59-this.beginMinuteFormControl.value)/this.handleMinuteIncrement()+1},function(e,i){return t.beginMinuteFormControl.value+i*t.handleMinuteIncrement()}):Array.from({length:59/this.handleMinuteIncrement()+1},function(e,i){return 0+i*t.handleMinuteIncrement()}),this.endMinuteFormControl.setValue(this.endValue.getMinutes())}},{key:"updateHoursMinutesArray",value:function(){var e=new Date(this.beginValue),t=new Date(this.endValue);e.setHours(0,0)===t.setHours(0,0)?(this.fullBeginHoursArray(!0),this.fullEndHoursArray(!0),this.beginValue.getHours()===this.endValue.getHours()&&(this.fullBeginMinutesArray(!0),this.fullEndMinutesArray(!0))):(this.fullBeginHoursArray(),this.fullEndHoursArray(),this.fullBeginMinutesArray(),this.fullEndMinutesArray())}},{key:"updateValues",value:function(){this.changeTemporalProperty(this.beginValue,1,!1),this.changeTemporalProperty(this.endValue,2,!0)}},{key:"restrictedToStep",value:function(){return!!this.currentFilter.restrictToStep&&this.currentFilter.restrictToStep}},{key:"handleMin",value:function(){return this.currentFilter.begin?this.currentFilter.begin:this.datasource.options.minDate?this.datasource.options.minDate:this._defaultMin}},{key:"handleMax",value:function(){return this.currentFilter.end?this.currentFilter.end:this.datasource.options.maxDate?this.datasource.options.maxDate:this._defaultMax}},{key:"changePropertyByPass",value:function(e){this.changeProperty.next(e)}},{key:"modeChange",value:function(e){e.checked||this.updateValues()}},{key:"setFilterStateDisable",value:function(){this.filterStateDisable=!!this.currentFilter&&!this.currentFilter.active,"datetime"===this.calendarType()&&(!0===this.filterStateDisable?(this.beginHourFormControl.disable(),this.beginMinuteFormControl.disable(),this.endHourFormControl.disable(),this.endMinuteFormControl.disable()):(this.beginHourFormControl.enable(),this.beginMinuteFormControl.enable(),this.endHourFormControl.enable(),this.endMinuteFormControl.enable()))}},{key:"getDateFromStringWithoutTime",value:function(e){var t,i="01",o="01";if(10===e.length){var n=e.split("-");if(3!==n.length)throw new Error("Error in config date begin-end for ogcFilter: Date without time format need to be YYYY-MM-DD or YYYY");t=n[0],i=n[1],o=n[2]}else{if(4!==e.length)return new Date(e);t=e}return new Date("".concat(t,"-").concat(i,"-").concat(o," 00:00:00"))}},{key:"resetFilter",value:function(){var e,t,i,o,n=this.datasource.options.ogcFilters.filters;this.calendarTypeYear?(o="today"===n.end?"".concat((new Date).toLocaleDateString("en-CA").substring(0,4),"-01-01"):"".concat(n.end.substring(0,4),"-01-01"),i="".concat(n.begin.substring(0,4),"-01-01"),e=this.getDateFromStringWithoutTime(i),t=this.getDateFromStringWithoutTime(o)):(e=this.parseFilter(n.begin),t=this.parseFilter(n.end),i=e.toISOString(),o=t.toISOString()),(this.currentFilter.begin!==i||this.currentFilter.end!==o)&&(this.beginValue=e,this.endValue=t,this.updateValues())}},{key:"toggleFilterState",value:function(){this.currentFilter.active=!0!==this.currentFilter.active,this.setFilterStateDisable(),this.updateValues()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(hm))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-ogc-filter-time"]],viewQuery:function(e,t){var i;(1&e&&(w.Gf(Cv,5),w.Gf(Tv,5),w.Gf(Av,5),w.Gf(Lv,5)),2&e)&&(w.iGM(i=w.CRH())&&(t.endDatepickerTime=i.first),w.iGM(i=w.CRH())&&(t.beginDatepickerTime=i.first),w.iGM(i=w.CRH())&&(t.beginTime=i.first),w.iGM(i=w.CRH())&&(t.endTime=i.first))},inputs:{datasource:"datasource",currentFilter:"currentFilter"},outputs:{changeProperty:"changeProperty"},decls:4,vars:3,consts:[[1,"datetime-container"],[3,"ngModel","ngModelChange","change",4,"ngIf"],["class","slider-container",4,"ngIf"],[4,"ngIf"],[3,"ngModel","ngModelChange","change"],[1,"slider-container"],[3,"begin","max","currentFilter","datasource","changeProperty"],["class","year-input-container",4,"ngIf"],["class","datetime-input-container",4,"ngIf"],[1,"year-input-container"],[1,"year-input"],["matInput","",1,"year-input-only-year",3,"value","disabled","change"],["matSuffix","",3,"for","disabled"],["panelClass","datepicker-year",3,"startView","startAt","yearSelected"],["beginDatepicker",""],["matInput","","enabled","false","readonly","true",1,"year-input-hide",3,"matDatepicker","value","min","max"],["beginYear",""],["endDatepicker",""],["endYear",""],["mat-icon-button","","color","primary",1,"reset-button",3,"matTooltip","disabled","click"],[3,"svgIcon"],["tooltip-position","below","matTooltipShowDelay","500",1,"toggle-filter-state",3,"matTooltip","checked","change"],[1,"datetime-input-container"],[1,"datetime-input"],[1,"date-input"],["matInput","",3,"matDatepicker","placeholder","matDatepickerFilter","value","min","max","disabled","dateChange"],["begin",""],[1,"filler"],[3,"startView","startAt","yearSelected","monthSelected"],[1,"time-input"],["class","hour-input",4,"ngIf"],["class","minute-input",4,"ngIf"],["class","datetime-input",4,"ngIf"],[1,"hour-input"],[3,"formControl","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"minute-input"],["end",""]],template:function(e,t){1&e&&(w.TgZ(0,"div",0),w.YNc(1,Zv,3,4,"mat-slide-toggle",1),w.YNc(2,Fv,2,4,"div",2),w.YNc(3,Uv,3,2,"div",3),w.qZA()),2&e&&(w.xp6(1),w.Q6J("ngIf",null==t.currentFilter.sliderOptions?null:t.currentFilter.sliderOptions.enabled),w.xp6(1),w.Q6J("ngIf",t.sliderMode),w.xp6(1),w.Q6J("ngIf",!t.sliderMode))},styles:["input{text-align:center!important;margin:auto 5px!important}.slider-container[_ngcontent-%COMP%]{text-align:center}.datetime-input[_ngcontent-%COMP%]{display:inline-block;width:117px;margin:10px 0 5px 10px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){.datetime-input[_ngcontent-%COMP%]{width:36%;margin:0}}.date-input[_ngcontent-%COMP%]{width:100px;margin-right:25px}.time-input[_ngcontent-%COMP%]{margin-right:25px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){.time-input[_ngcontent-%COMP%]{margin-right:5px}}.hour-input[_ngcontent-%COMP%], .minute-input[_ngcontent-%COMP%]{width:35px;margin-left:7px}.year-input[_ngcontent-%COMP%]{width:98px;margin:10px 18px 5px 12px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){.year-input[_ngcontent-%COMP%]{width:33%;margin:0 0 0 10px}}.year-input-hide[_ngcontent-%COMP%]{width:120px;margin-right:25px;display:none}.year-input-only-year[_ngcontent-%COMP%]{width:120px;margin-right:25px}.reset-button[_ngcontent-%COMP%]{width:25px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){.reset-button[_ngcontent-%COMP%]{padding-left:6px}}.toggle-filter-state[_ngcontent-%COMP%]{padding-left:15px}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){.toggle-filter-state[_ngcontent-%COMP%]{padding-left:7px}}  .datepicker-year   .mat-calendar-arrow{display:none}  .datepicker-year   .mat-calendar-period-button{pointer-events:none}  .datepicker-year   .mat-calendar-body-cell:not(.mat-calendar-body-disabled):hover{background-color:#0000001f;border-radius:999px}"]}),e}(),jv=Xe,Qv=function(){var e=function(){function e(t){m(this,e),this.ogcFilterTimeService=t,this.changeProperty=new w.vpe,this.sliderValue=1,this.calculatedStep=0,this._defaultDisplayFormat="DD/MM/YYYY HH:mm A",this._defaultSliderInterval=2e3,this.playIcon="play-circle",this.resetIcon="replay",this.sliderDisplayWith=this.sliderDisplayWith.bind(this)}return y(e,[{key:"sliderInterval",get:function(){return void 0===this.currentFilter.sliderInterval?this._defaultSliderInterval:this.currentFilter.sliderInterval}},{key:"displayFormat",get:function(){var e;return(null===(e=this.currentFilter.sliderOptions)||void 0===e?void 0:e.displayFormat)?this.currentFilter.sliderOptions.displayFormat:this.currentFilter.displayFormat?this.currentFilter.displayFormat:this._defaultDisplayFormat}},{key:"beginMillisecond",get:function(){return this.ogcFilterTimeService.dateToNumber(this.begin)}},{key:"maxMillisecond",get:function(){return this.ogcFilterTimeService.dateToNumber(this.max)}},{key:"stepMillisecond",get:function(){return this.ogcFilterTimeService.stepMillisecond(this.datasource,this.currentFilter)}},{key:"ngOnInit",value:function(){this.calculateStep(),this.handleSliderInput({value:1})}},{key:"sliderDisplayWith",value:function(e){var t=new Date(this.beginMillisecond+(e-1)*this.stepMillisecond);if(this.ogcFilterTimeService.stepIsYearDuration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter))){var i=jv.duration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter)).years();t=jv(this.beginMillisecond).add((e-1)*i,"year").toDate()}else if(this.ogcFilterTimeService.stepIsMonthDuration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter))){var o=jv.duration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter)).months();t=jv(this.beginMillisecond).add((e-1)*o,"month").toDate()}return jv(t).format(this.displayFormat)}},{key:"playFilter",value:function(e){var t=this;this.interval?this.stopFilter():(this.playIcon="pause-circle",this.interval=setInterval(function(e){if(t.slider.value<t.calculatedStep){t.slider._increment(1),t.slider._emitInputEvent()}else t.stopFilter()},this.sliderInterval,this))}},{key:"stopFilter",value:function(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.playIcon="play-circle"}},{key:"resetFilter",value:function(e){this.interval&&clearInterval(this.interval),this.interval=void 0,this.playIcon="play-circle",this.slider.value=1,this.slider._emitInputEvent()}},{key:"handleSliderInput",value:function(e){if(e)if(this.ogcFilterTimeService.stepIsYearDuration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter))){var t=jv.duration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter)).years(),i=jv(this.beginMillisecond).add((e.value-1)*t,"year").toDate(),o=jv(i).add(t,"year").toDate();this.changeProperty.next({value:jv(i).toDate().toISOString(),pos:1,refreshFilter:!1}),this.changeProperty.next({value:jv(o).toDate().toISOString(),pos:2,refreshFilter:!0})}else if(this.ogcFilterTimeService.stepIsMonthDuration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter))){var n=jv.duration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter)).months(),r=jv(this.beginMillisecond).add((e.value-1)*n,"month").toDate(),a=jv(r).add(n,"month").toDate();this.changeProperty.next({value:jv(r).startOf("month").toDate().toISOString(),pos:1,refreshFilter:!1}),this.changeProperty.next({value:jv(a).toDate().toISOString(),pos:2,refreshFilter:!0})}else if(this.ogcFilterTimeService.stepIsDayDuration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter))||this.ogcFilterTimeService.stepIsHourDuration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter))||this.ogcFilterTimeService.stepIsMinuteDuration(this.ogcFilterTimeService.step(this.datasource,this.currentFilter))){var s=new Date(this.beginMillisecond+this.stepMillisecond*(e.value-1));this.changeProperty.next({value:s.toISOString(),pos:1,refreshFilter:!1}),this.changeProperty.next({value:new Date(this.ogcFilterTimeService.addStep(s.toISOString(),this.stepMillisecond)).toISOString(),pos:2,refreshFilter:!0})}}},{key:"calculateStep",value:function(){for(var e=1;this.maxMillisecond-(this.beginMillisecond+e*this.stepMillisecond)>=-1;e++)this.calculatedStep=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(hm))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-ogc-filter-time-slider"]],viewQuery:function(e,t){var i;(1&e&&w.Gf(Tl.pH,5),2&e)&&(w.iGM(i=w.CRH())&&(t.slider=i.first))},inputs:{currentFilter:"currentFilter",begin:"begin",max:"max",datasource:"datasource"},outputs:{changeProperty:"changeProperty"},decls:6,vars:7,consts:[[1,"slider-container"],["id","time-slider","thumbLabel","",3,"step","min","max","ngModel","displayWith","ngModelChange","input"],["mat-icon-button","","color","primary",3,"click"],[3,"svgIcon"]],template:function(e,t){1&e&&(w.TgZ(0,"div",0),w.TgZ(1,"mat-slider",1),w.NdJ("ngModelChange",function(e){return t.sliderValue=e})("input",function(e){return t.handleSliderInput(e)}),w.qZA(),w.TgZ(2,"button",2),w.NdJ("click",function(e){return t.playFilter(e)}),w._UZ(3,"mat-icon",3),w.qZA(),w.TgZ(4,"button",2),w.NdJ("click",function(e){return t.resetFilter(e)}),w._UZ(5,"mat-icon",3),w.qZA(),w.qZA()),2&e&&(w.xp6(1),w.Q6J("step",1)("min",1)("max",t.calculatedStep)("ngModel",t.sliderValue)("displayWith",t.sliderDisplayWith),w.xp6(2),w.Q6J("svgIcon",t.playIcon),w.xp6(2),w.s9C("svgIcon",t.resetIcon))},directives:[Tl.pH,We.JJ,We.On,S.lW,k.Hw],styles:["input{text-align:center!important;margin:auto 5px!important}  .mat-slider-thumb{transform:scale(0)!important}  .mat-slider-thumb-label{transform:rotate(45deg)!important;border-radius:50% 50% 0!important;background-color:#ffd740!important}  .mat-slider-thumb-label-text{opacity:1!important;transform:rotate(135deg)!important}  .mat-slider-horizontal .mat-slider-thumb-label{top:10px!important;transform:rotate(225deg)!important}  .mat-slider-horizontal.cdk-focused .mat-slider-thumb-label{transform:rotate(225deg)!important}.datetime-container[_ngcontent-%COMP%]{text-align:center}.slider-container[_ngcontent-%COMP%]{text-align:center}.datetime-input[_ngcontent-%COMP%]{display:inline-block;margin:5px 25px}.date-input[_ngcontent-%COMP%]{width:120px;margin-right:25px}.time-input[_ngcontent-%COMP%]{display:inherit;margin-right:25px}.hour-input[_ngcontent-%COMP%], .minute-input[_ngcontent-%COMP%]{width:40px}.minute-input[_ngcontent-%COMP%]{margin-left:10px}"]}),e}(),Gv=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[{provide:Ve.Ad,useValue:"fr-FR"}]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({providers:[hh,gh,hm,vh],imports:[[F.ez,We.u5,We.UX,tt.Bb,k.Ps,S.ot,ql.Nh,_l.Fk,I.Tx,He.p0,Dl.dp,Al.vV,M.p9,Tl.KP,Cl.rP,Ye.lN,ot.c,Ve.Ng,ze.LD,C.ie,L.AV,it.FA,Ve.XK,El.ni,El.IZ,Se,Yd,ho,hn,Xo,ln,Gg,ct.g]]}),e}();w.B6R(Hg,[F.O5,S.lW,L.gM,k.Hw,ct.k,mf,cn],[ae.X$]),w.B6R(mf,[F.O5,C.Tg,k.Hw,C.eA,co,Ve.X2,F.PC,S.lW,L.gM,F.mk,Qp,uf],[ae.X$,F.Ov]),w.B6R(yf,[dn,F.sg,mf,cn],[dh]),w.B6R(Qf,[M.oG,L.gM,Ye.KE,F.mk,ze.gD,Ve.ey,F.O5,ot.Nt,tt.ZL,tt.XC,F.sg,S.lW,Ye.R9,k.Hw,Bv],[ae.X$,F.Ov,sn]),w.B6R(pm,[F.O5,S.lW,L.gM,k.Hw,ct.k,rm,cn],[ae.X$]),w.B6R(Xm,[We._Y,We.JL,We.sg,F.sg,F.O5,kl.d,Ye.KE,ze.gD,We.JJ,We.u,L.gM,Ve.ey,Al.A9,Al.Yi,F.PC,M.oG,_l.VQ,_l.U0,k.Hw,We.oH,We.On,Bv],[ae.X$]),w.B6R(Vf,[F.O5,Xm,cn,F.sg,Qf],[]),w.B6R(rm,[C.Tg,F.O5,k.Hw,C.eA,co,Ve.X2,F.PC,L.gM,S.lW,F.mk,Qp,Vf,kl.d,M.oG,We.JJ,We.On],[ae.X$,F.Ov]),w.B6R(sm,[dn,F.sg,rm,cn],[dh]),w.B6R(ev,[ql.SP,ql.uX,Ye.KE,Ye.hX,ze.gD,F.sg,Ve.ey,ov,Al.A9,Al.Yi,L.gM,k.Hw],[ae.X$]),w.B6R(kv,[jg,We.JJ,We.oH,F.O5,Cl.Rr,We._Y,We.JL,We.F,Ye.KE,We.wV,ot.Nt,We.Fj,ze.gD,F.sg,Ve.ey,Ye.hX,_l.VQ,_l.U0,He.BZ,He.w1,He.fO,He.ge,M.oG,He.as,He.XQ,He.nj,He.Gk,Dl.gi,Dl.fQ,Dl.uo,Dl.eu,S.lW,Dl.GZ,k.Hw,Dl.Ar,L.gM,Ei],[F.Ov,ae.X$]),w.B6R(Bv,[F.O5,Cl.Rr,We.JJ,We.On,Qv,Ye.KE,Ye.hX,ot.Nt,it.nW,Ye.R9,it.Mq,it.hl,S.lW,L.gM,k.Hw,ze.gD,We.oH,F.sg,Ve.ey],[ae.X$]);var Yv=function(e){o(i,e);var t=r(i);function i(){return m(this,i),t.apply(this,arguments)}return i}(e(Error)),zv=function(e){o(i,e);var t=r(i);function i(){var e;return m(this,i),e=t.call(this,"Invalid file"),Object.setPrototypeOf(s(e),i.prototype),e}return i}(Yv),Vv=function(e){o(i,e);var t=r(i);function i(){var e;return m(this,i),e=t.call(this,"Nothing to export"),Object.setPrototypeOf(s(e),i.prototype),e}return i}(Yv),Hv=te(["URL","GeoJSON","GML","GPX","KML","Shapefile","CSVcomma","CSVsemicolon"]),Wv=te(["UTF8","LATIN1"]),Xv=function(){var e=function(){function e(t){m(this,e),this.config=t,this.aggregateInComment=!0,this.ogreUrl=this.config.getConfig("importExport.url");var i=this.config.getConfig("importExport.gpxAggregateInComment");void 0!==i&&(this.aggregateInComment=i)}return y(e,[{key:"export",value:function(e,t,i,o){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"EPSG:4326",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"EPSG:4326",a=this.generateFeature(e,t);return this.exportAsync(a,t,i,o,n,r)}},{key:"generateFeature",value:function(e,t){return t===Hv.GPX&&this.aggregateInComment?this.generateAggregatedFeature(e):e.map(function(e){var t=e.getKeys().filter(function(e){return!e.startsWith("_")}).reduce(function(t,i){return t[i]=e.get(i),t},{geometry:e.getGeometry()});return new ns.Z(t)})}},{key:"generateAggregatedFeature",value:function(e){return e.map(function(e){var t=e.getKeys().filter(function(e){return!e.startsWith("_")}),i="",o=t.reduce(function(t,o){return o&&"geometry"!==o&&("id"===o&&e.get("draw")?i+=o+":"+e.get("draw")+"   \r\n":i+=o+":"+e.get(o)+"   \r\n"),t[o]=e.get(o),t},{geometry:e.getGeometry()}),n=new ns.Z(o);return n.set("name",e.getId()),n.set("cmt",i),n})}},{key:"exportAsync",value:function(t,i,o,n,r,a){var s=this;return new Ne.y(function(l){if(s.nothingToExport(t,i))l.error(new Vv);else if(Object.keys(e.ogreFormats).indexOf(i)>=0){if(!s.ogreUrl)return void(e.noOgreFallbacks.indexOf(i)>=0?s.exportToFile(t,l,i,o,r,a):l.error(new zv));s.exportWithOgre(t,l,i,o,n,r,a)}else s.exportToFile(t,l,i,o,r,a)})}},{key:"exportToFile",value:function(e,t,i,o,n,r){(function(e,t,i){!function(e,t){var i=document.createElement("a");i.setAttribute("href",e),i.setAttribute("download",t),i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i)}("data:".concat("text/plain;charset=utf-8",",").concat(encodeURIComponent(e)),i)})((new Ns[i]).writeFeatures(e,{dataProjection:r,featureProjection:n,featureType:"feature",featureNS:"http://example.com/feature"}),0,"".concat(o,".").concat(i.toLowerCase())),t.complete()}},{key:"exportWithOgre",value:function(t,i,o,n,r,a,s){var l=(new Zs.Z).writeFeatures(t,{dataProjection:s,featureProjection:a}),c="".concat(this.ogreUrl,"/convertJson"),u=document.createElement("form");if(u.style.display="none",document.body.appendChild(u),u.setAttribute("method","post"),u.setAttribute("target","_blank"),u.setAttribute("action",c),r===Wv.UTF8)u.acceptCharset="UTF-8",u.enctype="application/x-www-form-urlencoded; charset=utf-8;";else if(r===Wv.LATIN1){var p=document.createElement("input");p.setAttribute("type","hidden"),p.setAttribute("name","encoding"),p.setAttribute("value","ISO-8859-1"),u.appendChild(p)}if("CSVsemicolon"===o){var d=document.createElement("input");d.setAttribute("type","hidden"),d.setAttribute("name","lco"),d.setAttribute("value","SEPARATOR=SEMICOLON"),u.appendChild(d)}var h=document.createElement("input");h.setAttribute("type","hidden"),h.setAttribute("name","json"),h.setAttribute("value",l),u.appendChild(h);var g=document.createElement("input"),f="Shapefile"===o?"".concat(n,".zip"):"".concat(n,".").concat(o.toLowerCase());("CSVcomma"===o||"CSVsemicolon"===o)&&(f="".concat(n,".csv")),f=(f=f.replace(" ","_")).normalize("NFD").replace(/[\u0300-\u036f]/g,""),g.setAttribute("type","hidden"),g.setAttribute("name","outputName"),g.setAttribute("value",f),u.appendChild(g);var m=e.ogreFormats[o];("CSVcomma"===o||"CSVsemicolon"===o)&&(m="CSV");var v=document.createElement("input");v.setAttribute("type","hidden"),v.setAttribute("name","format"),v.setAttribute("value",m),u.appendChild(v),u.submit(),document.body.removeChild(u),i.complete()}},{key:"nothingToExport",value:function(e,t){return 0===e.length||"GPX"===t&&void 0===e.find(function(e){return["Point","LineString","MultiLineString"].indexOf(e.getGeometry().getType())>=0})}}]),e}();return e.ogreFormats={GML:"gml",GPX:"gpx",KML:"kml",Shapefile:"ESRI Shapefile",CSVcomma:"CSVcomma",CSVsemicolon:"CSVsemicolon"},e.noOgreFallbacks=["GML","GPX","KML"],e.\u0275fac=function(t){return new(t||e)(w.LFG(he))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function Kv(e,t,i,o,n,r,a){if(0!==t.length){var s=ay(e);r?function(e,t,i,o,n){var r,a,s,l=e.map(function(e){return hu(e,t.projection)});if(o.getStyleList(i.toString()+".styleByAttribute")){var c=o.getStyleList(i.toString()+".styleByAttribute");r=function(e){return n.createStyleByAttribute(e,c)}}else if(o.getStyleList(i.toString()+".clusterStyle")){var u=o.getStyleList(i.toString()+".clusterParam");a=o.getStyleList(i.toString()+".distance");var p=n.createStyle(o.getStyleList(i.toString()+".clusterStyle"));r=function(e){return n.createClusterStyle(e,u,p)}}else if(o.getStyleList(i.toString()+".style"))r=n.createStyle(o.getStyleList(i.toString()+".style"));else if(o.getStyleList("default.clusterStyle")&&"Point"===e[0].geometry.type){var d=o.getStyleList("default.clusterParam");a=o.getStyleList("default.distance");var h=n.createStyle(o.getStyleList("default.clusterStyle"));r=function(e){return n.createClusterStyle(e,d,h)}}else r=n.createStyle(o.getStyleList("default.style"));o.getStyleList(i.toString()+".clusterStyle")?(s=new qc({distance:a,type:"cluster",queryable:!0})).ol.source.addFeatures(l):o.getStyleList(i.toString())?(s=new _c({type:"vector",queryable:!0})).ol.addFeatures(l):o.getStyleList("default.clusterStyle")&&"Point"===e[0].geometry.type?(s=new qc({distance:a,type:"cluster",queryable:!0})).ol.source.addFeatures(l):(s=new _c({type:"vector",queryable:!0})).ol.addFeatures(l);var g=new jc({title:i,source:s,style:r});t.addLayer(g),mu(t,l)}(t,i,s,r,a):function(e,t,i){var o=e.map(function(e){return hu(e,t.projection)}),n=Math.floor(255*Math.random()),r=Math.floor(255*Math.random()),a=Math.floor(255*Math.random()),s=new ws.Z({color:[n,r,a,1],width:2}),l=new ys.Z({color:[n,r,a,.4]}),c=new _c({type:"vector",queryable:!0});c.ol.addFeatures(o);var u=new jc({title:i,source:c,style:new ms.ZP({stroke:s,fill:l,image:new xs.Z({radius:5,stroke:s,fill:l})})});t.addLayer(u),mu(t,o)}(t,i,s);var l=n.translate,c=l.instant("igo.geo.dropGeoFile.success.title"),u=l.instant("igo.geo.dropGeoFile.success.text",{value:s});o.success(u,c)}else!function(e,t,i){var o=i.translate,n=o.instant("igo.geo.dropGeoFile.empty.title"),r=o.instant("igo.geo.dropGeoFile.empty.text",{value:e.name,mimeType:e.type});t.error(r,n)}(e,o,n)}function ey(e,t,i,o){var n=o.translate,r=n.instant("igo.geo.dropGeoFile.invalid.title"),a=n.instant("igo.geo.dropGeoFile.invalid.text",{value:e.name,mimeType:e.type});i.error(a,r)}function ty(e,t,i,o){var n=o.translate,r=n.instant("igo.geo.dropGeoFile.unreadable.title"),a=n.instant("igo.geo.dropGeoFile.unreadable.text",{value:e.name});i.error(a,r)}function iy(e,t,i,o,n){var r=o.translate,a=r.instant("igo.geo.dropGeoFile.tooLarge.title"),s=r.instant("igo.geo.dropGeoFile.tooLarge.text",{value:e.name,size:n});i.error(s,a)}function oy(e,t,i){var o=i.translate,n=o.instant("igo.geo.dropGeoFile.invalidSRS.title"),r=o.instant("igo.geo.dropGeoFile.invalidSRS.text",{value:e.name,mimeType:e.type});t.error(r,n)}function ny(e,t,i,o){var n=o.translate.instant("igo.geo.dropGeoFile.ogreServer.title"),r=o.translate.instant("igo.geo.dropGeoFile.ogreServer.text");i.error(r,n)}function ry(e){return e.name.split(".").pop().toLowerCase()}function ay(e){return e.name.substr(0,e.name.lastIndexOf("."))}var sy=function(e){o(i,e);var t=r(i);function i(){return m(this,i),t.apply(this,arguments)}return i}(e(Error)),ly=function(e){o(i,e);var t=r(i);function i(){var e;return m(this,i),e=t.call(this,"Invalid file"),Object.setPrototypeOf(s(e),i.prototype),e}return i}(sy),cy=function(e){o(i,e);var t=r(i);function i(){var e;return m(this,i),e=t.call(this,"Failed to read file"),Object.setPrototypeOf(s(e),i.prototype),e}return i}(sy),uy=function(e){o(i,e);var t=r(i);function i(){var e;return m(this,i),e=t.call(this,"Nothing to import"),Object.setPrototypeOf(s(e),i.prototype),e}return i}(sy),py=function(e){o(i,e);var t=r(i);function i(){var e;return m(this,i),e=t.call(this,"File is too large"),Object.setPrototypeOf(s(e),uy.prototype),e}return i}(sy),dy=function(e){o(i,e);var t=r(i);function i(){var e;return m(this,i),e=t.call(this,"Invalid SRS definition"),Object.setPrototypeOf(s(e),uy.prototype),e}return i}(sy),hy=function(e){o(i,e);var t=r(i);function i(){var e;return m(this,i),e=t.call(this,"Error 500 with OGRE"),Object.setPrototypeOf(s(e),i.prototype),e}return i}(sy),gy=function(){var e=function(){function e(t,i){m(this,e),this.http=t,this.config=i,this.ogreUrl=this.config.getConfig("importExport.url");var o=this.config.getConfig("importExport.clientSideFileSizeMaxMb");this.clientSideFileSizeMax=(o||30)*Math.pow(1024,2)}return y(e,[{key:"import",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"EPSG:4326",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"EPSG:4326";return this.importAsync(e,t,i)}},{key:"getFileImporter",value:function(t){var i=ry(t),o=t.type,n=[].concat(d(e.allowedMimeTypes),d(e.allowedZipMimeTypes)),r=e.allowedExtensions;if(!(n.indexOf(o)<0&&r.indexOf(i)<0)){if("application/json"===o||["json","geojson","kml","gpx"].indexOf(i)>=0)return this.importFile;if(void 0!==this.ogreUrl)return this.importFileWithOgre}}},{key:"importAsync",value:function(e,t,i){var o=this;return new Ne.y(function(n){if(e.size>=o.clientSideFileSizeMax)n.error(new py);else{var r=o.getFileImporter(e);void 0!==r?r.call(o,e,n,t,i):n.error(new ly)}})}},{key:"importFile",value:function(e,t,i,o){var n=this,r=new FileReader;r.onload=function(r){try{var a=n.parseFeaturesFromFile(e,r.target.result,i,o);t.next(a)}catch(a){t.error(new cy)}t.complete()},r.onerror=function(e){t.error(new cy)},r.readAsText(e,"UTF-8")}},{key:"importFileWithOgre",value:function(e,t,i,o){var n=this,r="".concat(this.ogreUrl,"/convert"),a=new FormData;a.append("upload",e),a.append("sourceSrs",i),a.append("targetSrs",o),a.append("formatOutput","GEOJSON"),a.append("skipFailures",""),this.http.post(r,a,{headers:new P.WM}).subscribe(function(i){if(null!==i)if((i.errors||[]).length>0)t.error(new cy);else{var r=n.parseFeaturesFromGeoJSON(e,i,o);t.next(r),t.complete()}else t.error(new cy)},function(e){e.error.caught=!0;var i=e.error.msg||"";"No valid files found"===i?t.error(new ly):i&&i.startWith("ERROR 1: Failed to process SRS definition")?t.error(new dy):t.error(500===e.status?new hy:new cy)})}},{key:"parseFeaturesFromFile",value:function(e,t,i,o){var n,r=ry(e),a=e.type,s=new Zs.Z;if("application/vnd.google-earth.kml+xml"===a)n=new js.ZP;else if("application/gml+xml"===a)n=new Gs.Z;else if("application/gpx+xml"===a)n=new Bs.Z;else switch(r){case"kml":n=new js.ZP;break;case"gpx":n=new Bs.Z;break;case"gml":n=new Gs.Z;break;default:n=s}return n.readFeatures(t,{dataProjection:i,featureProjection:o}).map(function(t){return Object.assign(s.writeFeatureObject(t),{projection:o,meta:{id:oe(),title:ay(e)}})})}},{key:"parseFeaturesFromGeoJSON",value:function(e,t,i){var o=new Zs.Z;return o.readFeatures(t).map(function(t){return Object.assign(o.writeFeatureObject(t),{projection:i,meta:{id:oe(),title:ay(e)}})})}}]),e}();return e.allowedMimeTypes=["application/gml+xml","application/vnd.google-earth.kml+xml","application/gpx+xml","application/json"],e.allowedZipMimeTypes=["application/zip","application/x-zip-compressed","application/x-zip"],e.allowedExtensions=["geojson","kml","gpx","json","gml"],e.\u0275fac=function(t){return new(t||e)(w.LFG(P.eN),w.LFG(he))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),fy=function(){var e=function(){function e(t){m(this,e),this.injector=t,this.styleList={}}return y(e,[{key:"getStyleList",value:function(e){return K.resolve(this.styleList,e)}},{key:"load",value:function(e){var t=this,i=e.default||{};if(!e.path)return this.styleList=i,!0;var o=this.injector.get(P.eN);return new Promise(function(n,r){o.get(e.path).pipe((0,q.K)(function(t){return console.log("StyleList file ".concat(e.path," could not be read")),n(!0),(0,N._)(t.error||"Server error")})).subscribe(function(e){t.styleList=K.mergeDeep(i,e),n(!0)})})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(w.zs3))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function my(e,t){if(1&e&&(w.TgZ(0,"p",16),w._uU(1),w.ALo(2,"translate"),w.qZA()),2&e){var i=w.oxw().$implicit;w.xp6(1),w.Oqu(w.xi3(2,1,"igo.geo.importExportForm.projections."+i.translateKey,i))}}function vy(e,t){if(1&e&&(w.TgZ(0,"p",16),w._uU(1),w.qZA()),2&e){var i=w.oxw().$implicit;w.xp6(1),w.Oqu(i.alias)}}function yy(e,t){if(1&e&&(w.TgZ(0,"mat-option",14),w.NdJ("click",function(e){return e.stopPropagation()}),w.YNc(1,my,3,4,"p",15),w.YNc(2,vy,2,1,"p",15),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i),w.xp6(1),w.Q6J("ngIf",i.translateKey),w.xp6(1),w.Q6J("ngIf",!i.translateKey)}}function by(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"form",5),w.TgZ(1,"div",6),w.TgZ(2,"mat-form-field"),w.TgZ(3,"mat-label"),w._uU(4),w.ALo(5,"translate"),w.qZA(),w.TgZ(6,"mat-select",7),w.NdJ("valueChange",function(e){return w.CHM(i),w.oxw().inputProj=e}),w.YNc(7,yy,3,3,"mat-option",8),w.ALo(8,"async"),w.qZA(),w.qZA(),w.qZA(),w.TgZ(9,"div",9),w.ALo(10,"translate"),w.ALo(11,"translate"),w.TgZ(12,"button",10),w.NdJ("click",function(){return w.CHM(i),w.MAs(19).click()}),w.ALo(13,"async"),w._uU(14),w.ALo(15,"translate"),w.qZA(),w._UZ(16,"igo-spinner",11),w.ALo(17,"async"),w.TgZ(18,"input",12,13),w.NdJ("click",function(){return w.CHM(i),w.MAs(19).value=null})("change",function(e){return w.CHM(i),w.oxw().importFiles(e.target.files)}),w.qZA(),w.qZA(),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("formGroup",o.importForm),w.xp6(4),w.Oqu(w.lcZ(5,10,"igo.geo.importExportForm.importProjPlaceholder")),w.xp6(2),w.Q6J("value",o.inputProj),w.xp6(1),w.Q6J("ngForOf",w.lcZ(8,12,o.projections$)),w.xp6(2),w.Q6J("matTooltip",o.importForm.invalid?w.lcZ(10,14,"igo.geo.importExportForm.projections.choose"):w.lcZ(11,16,"igo.geo.importExportForm.importButton")),w.xp6(3),w.Q6J("disabled",o.importForm.invalid||w.lcZ(13,18,o.loading$)),w.xp6(2),w.hij(" ",w.lcZ(15,20,"igo.geo.importExportForm.importButton")," "),w.xp6(2),w.Q6J("shown",w.lcZ(17,22,o.loading$)),w.xp6(2),w.Udp("display","none")}}var wy=function(e){return{size:e}};function xy(e,t){if(1&e&&(w.TgZ(0,"section",17),w.TgZ(1,"h4"),w._uU(2),w.ALo(3,"translate"),w.qZA(),w.TgZ(4,"ul"),w.TgZ(5,"li"),w._uU(6),w.ALo(7,"translate"),w.qZA(),w.TgZ(8,"li"),w._uU(9),w.ALo(10,"translate"),w.qZA(),w.TgZ(11,"li"),w._uU(12),w.ALo(13,"translate"),w.qZA(),w.qZA(),w.qZA()),2&e){var i=w.oxw();w.xp6(2),w.Oqu(w.lcZ(3,4,"igo.geo.importExportForm.importClarifications")),w.xp6(4),w.Oqu(w.xi3(7,6,"igo.geo.importExportForm.importSizeMax",w.VKq(13,wy,i.fileSizeMb))),w.xp6(3),w.Oqu(w.lcZ(10,9,"igo.geo.importExportForm.importFormatAuthorized")),w.xp6(3),w.Oqu(w.lcZ(13,11,"igo.geo.importExportForm.importShpZip"))}}function Sy(e,t){1&e&&(w.TgZ(0,"section",17),w.TgZ(1,"h4"),w._uU(2),w.ALo(3,"translate"),w.qZA(),w.qZA()),2&e&&(w.xp6(2),w.Oqu(w.lcZ(3,1,"igo.geo.importExportForm.exportNoLayersExportable")))}function ky(e,t){if(1&e&&(w.TgZ(0,"span",29),w._uU(1),w.ALo(2,"translate"),w.qZA()),2&e){var i=w.oxw(2);w.xp6(1),w.AsE(" (+",i.layers.length-1," ",w.lcZ(2,2,2===(null==i.layers?null:i.layers.length)?"igo.geo.importExportForm.other":"igo.geo.importExportForm.others"),") ")}}function Cy(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-slide-toggle",32),w.NdJ("click",function(e){w.CHM(i);var t=w.oxw().$implicit;return w.oxw(2).onlySelectedClick(e,t.id)})("checked",function(){w.CHM(i);var e=w.oxw().$implicit;return w.oxw(2).inLayersIdToExportSelectionOnly(e)})("change",function(e){w.CHM(i);var t=w.oxw().$implicit;return w.oxw(2).onlySelected(e,t.id)}),w.TgZ(1,"small"),w._uU(2),w.ALo(3,"translate"),w.qZA(),w.qZA()}2&e&&(w.Q6J("labelPosition","after"),w.xp6(2),w.Oqu(w.lcZ(3,2,"igo.geo.importExportForm.exportSelectedFeature")))}var Ty=function(e){return{"igo-export-layer-mat-option":e}};function Ay(e,t){if(1&e&&(w.TgZ(0,"mat-option",30),w.NdJ("click",function(e){return e.stopPropagation()}),w.TgZ(1,"p",16),w._uU(2),w.qZA(),w.TgZ(3,"p",16),w.YNc(4,Cy,4,4,"mat-slide-toggle",31),w.qZA(),w.qZA()),2&e){var i=t.$implicit,o=w.oxw(2);w.Q6J("ngClass",w.VKq(4,Ty,o.layerHasSelectedFeatures(i)))("value",i.id),w.xp6(2),w.Oqu(i.title),w.xp6(2),w.Q6J("ngIf",o.layerHasSelectedFeatures(i))}}function Ly(e,t){if(1&e&&(w.TgZ(0,"mat-option",2),w._uU(1),w.ALo(2,"translate"),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i.key),w.xp6(1),w.hij(" ",w.lcZ(2,2,"igo.geo.export.format."+i.value)," ")}}function Zy(e,t){if(1&e&&(w.ynx(0),w.YNc(1,Ly,3,4,"mat-option",33),w.ALo(2,"keyvalue"),w.ALo(3,"async"),w.BQk()),2&e){var i=w.oxw(2);w.xp6(1),w.Q6J("ngForOf",w.lcZ(2,1,w.lcZ(3,3,i.formats$)))}}function Fy(e,t){1&e&&(w.TgZ(0,"mat-option",34),w._uU(1),w.ALo(2,"translate"),w.qZA()),2&e&&(w.xp6(1),w.hij(" ",w.lcZ(2,1,"igo.geo.export.noFormat.title")," "))}function Oy(e,t){1&e&&(w.TgZ(0,"div",6),w.TgZ(1,"mat-form-field"),w._UZ(2,"input",35),w.ALo(3,"translate"),w.qZA(),w.qZA()),2&e&&(w.xp6(2),w.s9C("placeholder",w.lcZ(3,1,"igo.geo.importExportForm.exportFileNamePlaceholder")))}function My(e,t){if(1&e&&(w.TgZ(0,"mat-option",2),w._uU(1),w.ALo(2,"translate"),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i.key),w.xp6(1),w.hij(" ",w.lcZ(2,2,"igo.geo.export.encoding."+i.value)," ")}}function Iy(e,t){if(1&e&&(w.ynx(0),w.YNc(1,My,3,4,"mat-option",33),w.ALo(2,"keyvalue"),w.ALo(3,"async"),w.BQk()),2&e){var i=w.oxw(3);w.xp6(1),w.Q6J("ngForOf",w.lcZ(2,1,w.lcZ(3,3,i.encodings$)))}}function Py(e,t){if(1&e&&(w.TgZ(0,"div",6),w.TgZ(1,"mat-form-field"),w.TgZ(2,"mat-label"),w._uU(3),w.ALo(4,"translate"),w.qZA(),w.TgZ(5,"mat-select",36),w.YNc(6,Iy,4,5,"ng-container",22),w.ALo(7,"async"),w.qZA(),w.qZA(),w.qZA()),2&e){var i=w.oxw(2);w.xp6(3),w.Oqu(w.lcZ(4,2,"igo.geo.importExportForm.encodingPlaceholder")),w.xp6(3),w.Q6J("ngIf",0!==w.lcZ(7,4,i.encodings$).length)}}function _y(e,t){1&e&&(w.TgZ(0,"div",37),w.TgZ(1,"mat-slide-toggle",38),w._uU(2),w.ALo(3,"translate"),w.qZA(),w.qZA()),2&e&&(w.xp6(1),w.Q6J("labelPosition","before"),w.xp6(1),w.hij(" ",w.lcZ(3,2,"igo.geo.importExportForm.exportCombineResults")," "))}function qy(e,t){1&e&&(w.TgZ(0,"div",39),w.TgZ(1,"mat-slide-toggle",40),w._uU(2),w.ALo(3,"translate"),w.qZA(),w.qZA()),2&e&&(w.xp6(1),w.Q6J("labelPosition","before"),w.xp6(1),w.hij(" ",w.lcZ(3,2,"igo.geo.importExportForm.exportSeparator")," "))}function Dy(e,t){1&e&&(w.TgZ(0,"div",41),w.TgZ(1,"mat-slide-toggle",42),w._uU(2),w.ALo(3,"translate"),w.qZA(),w.qZA()),2&e&&(w.xp6(1),w.Q6J("labelPosition","before"),w.xp6(1),w.hij(" ",w.lcZ(3,2,"igo.geo.importExportForm.exportFeatureInExtent")," "))}function Ey(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"form",5),w.TgZ(1,"div",6),w.TgZ(2,"mat-form-field"),w.TgZ(3,"mat-label"),w._uU(4),w.ALo(5,"translate"),w.qZA(),w.TgZ(6,"mat-select",18),w.NdJ("valueChange",function(e){return w.CHM(i),w.oxw().layers=e}),w.TgZ(7,"mat-select-trigger"),w._uU(8),w.YNc(9,ky,3,4,"span",19),w.qZA(),w.YNc(10,Ay,5,6,"mat-option",20),w.ALo(11,"async"),w.qZA(),w.qZA(),w.qZA(),w.TgZ(12,"div",6),w.TgZ(13,"mat-form-field"),w.TgZ(14,"mat-label"),w._uU(15),w.ALo(16,"translate"),w.qZA(),w.TgZ(17,"mat-select",21),w.YNc(18,Zy,4,5,"ng-container",22),w.ALo(19,"async"),w.YNc(20,Fy,3,3,"mat-option",23),w.ALo(21,"async"),w.qZA(),w.qZA(),w.qZA(),w.YNc(22,Oy,4,3,"div",24),w.YNc(23,Py,8,6,"div",24),w.YNc(24,_y,4,4,"div",25),w.YNc(25,qy,4,4,"div",26),w.YNc(26,Dy,4,4,"div",27),w.TgZ(27,"div",28),w.TgZ(28,"button",10),w.NdJ("click",function(){w.CHM(i);var e=w.oxw();return e.handleExportFormSubmit(e.form.value)}),w.ALo(29,"async"),w._uU(30),w.ALo(31,"translate"),w.ALo(32,"translate"),w.ALo(33,"translate"),w.qZA(),w._UZ(34,"igo-spinner",11),w.ALo(35,"async"),w.qZA(),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("formGroup",o.form),w.xp6(4),w.Oqu(w.lcZ(5,17,"igo.geo.importExportForm.exportLayerPlaceholder")),w.xp6(2),w.Q6J("value",o.layers),w.xp6(2),w.hij(" ",o.layers.length?o.getLayerTitleById(o.layers[0]):""," "),w.xp6(1),w.Q6J("ngIf",o.layers.length>1),w.xp6(1),w.Q6J("ngForOf",w.lcZ(11,19,o.exportableLayers$)),w.xp6(5),w.Oqu(w.lcZ(16,21,"igo.geo.importExportForm.exportFormatPlaceholder")),w.xp6(3),w.Q6J("ngIf",0!==w.lcZ(19,23,o.formats$).length),w.xp6(2),w.Q6J("ngIf",0===w.lcZ(21,25,o.formats$).length),w.xp6(2),w.Q6J("ngIf",o.forceNaming&&"URL"!==o.form.value.format),w.xp6(1),w.Q6J("ngIf","CSVcomma"===o.form.value.format||"CSVsemicolon"===o.form.value.format),w.xp6(1),w.Q6J("ngIf",o.layers.length>1&&("CSVcomma"===o.form.value.format||"CSVsemicolon"===o.form.value.format)),w.xp6(1),w.Q6J("ngIf",o.layers.length>1&&("CSVcomma"===o.form.value.format||"CSVsemicolon"===o.form.value.format)&&o.form.value.combineLayers),w.xp6(1),w.Q6J("ngIf","URL"!==o.form.value.format),w.xp6(2),w.Q6J("disabled",!o.form.valid||w.lcZ(29,27,o.loading$)),w.xp6(2),w.hij(" ","URL"!==o.form.value.format?w.lcZ(31,29,"igo.geo.importExportForm.exportButton"):o.form.value.layers.length>1?w.lcZ(32,31,"igo.geo.importExportForm.exportButtonLinks"):w.lcZ(33,33,"igo.geo.importExportForm.exportButtonLink")," "),w.xp6(4),w.Q6J("shown",w.lcZ(35,35,o.loading$))}}var $y=function(){var e=function(){function e(t,i,o,n,r,a,s,l,c,u,p){m(this,e),this.importService=t,this.exportService=i,this.languageService=o,this.messageService=n,this.styleListService=r,this.styleService=a,this.formBuilder=s,this.config=l,this.cdRef=c,this.storageService=u,this.downloadService=p,this.formats$=new R.X(void 0),this.encodings$=new R.X(void 0),this.exportableLayers$=new R.X([]),this.loading$=new R.X(!1),this.forceNaming=!1,this.controlFormat="format",this.espgCodeRegex=new RegExp("^\\d{4,6}"),this.projections$=new R.X([]),this.popupChecked=!1,this.previousLayerSpecs$=new R.X(void 0),this.selectFirstProj=!1,this._projectionsLimitations={},this.selectedMode="import",this.selectMode=new w.vpe,this.exportOptions$=new R.X(void 0),this.exportOptionsChange=new w.vpe,this.loadConfig(),this.buildForm(),this.computeProjections()}return y(e,[{key:"projectionsLimitations",get:function(){return this._projectionsLimitations||{}},set:function(e){this._projectionsLimitations=e,this.computeProjections()}},{key:"layers",get:function(){return this.form.get("layers").value},set:function(e){this.form.patchValue({layers:e})}},{key:"inputProj",get:function(){return this.importForm.get("inputProj").value},set:function(e){this.importForm.patchValue({inputProj:e})}},{key:"popupAllowed",get:function(){return this.storageService.get("importExportPopupAllowed")||!1},set:function(e){this.storageService.set("importExportPopupAllowed",e)}},{key:"ngOnInit",value:function(){var e=this;this.layers$$=this.map.layers$.subscribe(function(t){e.exportableLayers$.next(t.filter(function(e){return e instanceof jc&&!0===e.exportable||e.dataSource.options.download&&e.dataSource.options.download.url}))});var t=this.config.getConfig("importExport.clientSideFileSizeMaxMb");this.clientSideFileSizeMax=(t||30)*Math.pow(1024,2),this.fileSizeMb=this.clientSideFileSizeMax/Math.pow(1024,2),this.exportOptions$$=this.exportOptions$.pipe((0,Ka.n)(function(e){return!e})).subscribe(function(t){e.form.patchValue(t,{emitEvent:!0}),t.layers&&e.computeFormats(t.layers.map(function(t){return e.map.getLayerById(t)}))}),this.formLayer$$=this.form.get("format").valueChanges.subscribe(function(t){var i,o=Object.keys(Xv.ogreFormats);!e.popupChecked&&(null===(i=e.form.get("layers").value)||void 0===i?void 0:i.length)>1&&(o.indexOf(t)>=0||t===Hv.URL)&&(e.handlePopup(!0)||e.form.patchValue({format:void 0},{emitEvent:!1}))}),this.formLayer$$=this.form.get("layers").valueChanges.subscribe(function(t){e.handlePreviousLayerSpecs();var i=t instanceof Array?t:[t];e.form.patchValue({layers:i},{emitEvent:!1});var o=i.map(function(t){return e.map.getLayerById(t)});e.computeFormats(o),-1===Object.keys(e.formats$.value).indexOf(e.form.value.format)&&e.form.patchValue({format:void 0}),e.loading$.next(!0);var n=[];o.forEach(function(e){e instanceof jc&&0===e.dataSource.ol.getFeatures().length&&(n.push({id:e.id,visible:e.visible,opacity:e.opacity,queryable:e.queryable}),e.opacity=0,e.visible=!0)}),e.previousLayerSpecs$.next(n),setTimeout(function(){e.loading$.next(!1)},500)}),this.formats$$=this.formats$.pipe((0,Ka.n)(function(e){return!e})).subscribe(function(t){1===Object.keys(t).length&&e.form.patchValue({format:t[Object.keys(t)[0]]})}),this.encodings$$=this.encodings$.pipe((0,Ka.n)(function(e){return!e})).subscribe(function(t){1===Object.keys(t).length&&e.form.patchValue({encoding:t[Object.keys(t)[0]]})}),this.exportableLayers$$=this.exportableLayers$.pipe((0,Ka.n)(function(e){return!e})).subscribe(function(t){1===t.length&&e.form.patchValue({layers:t[0].id})}),this.form.controls[this.controlFormat].valueChanges.subscribe(function(t){e.form.patchValue(t===Hv.CSVcomma||t===Hv.CSVsemicolon?{encoding:Wv.LATIN1}:{encoding:Wv.UTF8}),e.cdRef.detectChanges()}),this.importForm.patchValue(this.selectFirstProj?0===this.projections$.value.length?{inputProj:{translateKey:"nad83",alias:"NAD83",code:"EPSG:4326",zone:""}}:{inputProj:this.projections$.value[0]}:{inputProj:void 0})}},{key:"computeProjections",value:function(){this.projectionsConstraints=function(e){var t=e.mtmZone,i=e.utmZone;return{projFromConfig:!1!==e.projFromConfig,nad83:!1!==e.nad83,wgs84:!1!==e.wgs84,webMercator:!1!==e.webMercator,utm:!1!==e.utm,mtm:!1!==e.mtm,utmZone:{minZone:i&&i.minZone?i.minZone:17,maxZone:i&&i.maxZone?i.maxZone:21},mtmZone:{minZone:t&&t.minZone?t.minZone:2,maxZone:t&&t.maxZone?t.maxZone:10}}}(this.projectionsLimitations);var e=[];if(this.projectionsConstraints.nad83&&e.push({translateKey:"nad83",alias:"NAD83",code:"EPSG:4269",zone:""}),this.projectionsConstraints.wgs84&&e.push({translateKey:"wgs84",alias:"WGS84",code:"EPSG:4326",zone:""}),this.projectionsConstraints.webMercator&&e.push({translateKey:"webMercator",alias:"Web Mercator",code:"EPSG:3857",zone:""}),this.projectionsConstraints.mtm)for(var t=this.projectionsConstraints.mtmZone.maxZone,i=this.projectionsConstraints.mtmZone.minZone;i<=t;i++)e.push({translateKey:"mtm",alias:"MTM ".concat(i),code:i<10?"EPSG:3218".concat(i):"EPSG:321".concat(80+i),zone:"".concat(i)});if(this.projectionsConstraints.utm)for(var o=this.projectionsConstraints.utmZone.maxZone,n=this.projectionsConstraints.utmZone.minZone;n<=o;n++)e.push({translateKey:"utm",alias:"UTM ".concat(n),code:n<10?"EPSG:3260".concat(n):"EPSG:326".concat(n),zone:"".concat(n)});var r=[];this.projectionsConstraints.projFromConfig&&(r=this.config.getConfig("projections")||[]),this.projections$.next(r.concat(e))}},{key:"getWorkspaceByLayerId",value:function(e){var t=this.store.all().find(function(t){return t.layer.id===e});if(t)return t}},{key:"getLayerTitleById",value:function(e){var t;return null===(t=this.map.getLayerById(e))||void 0===t?void 0:t.title}},{key:"layerHasSelectedFeatures",value:function(e){var t=this.getWorkspaceByLayerId(e.id);if(t)return!!t.entityStore.stateView.firstBy(function(e){return!0===e.state.selected})}},{key:"onlySelected",value:function(e,t){var i=this.form.value.layersWithSelection;e.checked?i.push(t):i=i.filter(function(e){return e!==t}),this.form.patchValue({layersWithSelection:i})}},{key:"onlySelectedClick",value:function(e,t){this.form.value.layers.find(function(e){return e===t})&&e.stopPropagation()}},{key:"inLayersIdToExportSelectionOnly",value:function(e){return!!this.form.value.layersWithSelection.find(function(t){return t===e.id})}},{key:"ngOnDestroy",value:function(){this.layers$$.unsubscribe(),this.exportableLayers$$.unsubscribe(),this.formats$$.unsubscribe(),this.encodings$$.unsubscribe(),this.formLayer$$.unsubscribe(),this.exportOptions$$&&this.exportOptions$$.unsubscribe(),this.exportOptionsChange.emit(this.form.value),this.handlePreviousLayerSpecs()}},{key:"handlePreviousLayerSpecs",value:function(){var e=this,t=this.previousLayerSpecs$.value;t&&t.length&&t.forEach(function(t){var i=e.map.getLayerById(t.id);i.visible=t.visible,i.opacity=t.opacity,i.queryable=t.queryable}),this.previousLayerSpecs$.next(void 0)}},{key:"importFiles",value:function(e){var t=this,i=this.inputProj.code;this.espgCodeRegex.test(i)&&(i="EPSG:".concat(i)),this.loading$.next(!0);var o,n=p(e);try{var r=function(){var e=o.value;t.importService.import(e,i).subscribe(function(i){return t.onFileImportSuccess(e,i)},function(i){return t.onFileImportError(e,i)},function(){t.loading$.next(!1)})};for(n.s();!(o=n.n()).done;)r()}catch(a){n.e(a)}finally{n.f()}}},{key:"handlePopup",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];window.open("","popup","width=1, height=1").close();var t=window.open("","popup","width=1, height=1");return!t||t.closed||void 0===t.closed||null===t?(this.onPopupBlockedError(e),this.popupAllowed=!1):(t.close(),this.popupAllowed=!0,this.popupChecked=!0),this.popupAllowed}},{key:"handleExportFormSubmit",value:function(e){var t=this;this.loading$.next(!0);var i=Object.keys(Xv.ogreFormats);!this.popupChecked&&e.layers.length>1&&(i.indexOf(e.format)>=0||e.format===Hv.URL)&&!this.popupAllowed&&this.handlePopup();var o,n=[],r=[],a="",s=p(e.layers.entries());try{var l=function(){var i=h(o.value,2),s=i[0],l=i[1],c=t.map.getLayerById(l);e.format!==Hv.CSVsemicolon&&e.format!==Hv.CSVcomma||!e.combineLayers||1===e.layers.length?(a=c.title,e.name&&(a=e.name)):a=t.languageService.translate.instant("igo.geo.export.combinedLayers");var u=c.dataSource.options;if(e.format===Hv.URL&&u.download&&(u.download.url||u.download.dynamicUrl))return{v:void setTimeout(function(){var e=u.download.url||u.download.dynamicUrl;e.match(/service=wfs/gi)?t.downloadService.open(c):window.open(e,"_blank"),t.loading$.next(!1)},500)};var p=t.getWorkspaceByLayerId(l),d=void 0;if(p&&p.entityStore&&p.entityStore.stateView.all().length)d=-1!==e.layersWithSelection.indexOf(l)&&e.featureInMapExtent?p.entityStore.stateView.all().filter(function(e){return e.state.inMapExtent&&e.state.selected}).map(function(e){return e.entity.ol}):-1===e.layersWithSelection.indexOf(l)||e.featureInMapExtent?e.featureInMapExtent?p.entityStore.stateView.all().filter(function(e){return e.state.inMapExtent}).map(function(e){return e.entity.ol}):p.entityStore.stateView.all().map(function(e){return e.entity.ol}):p.entityStore.stateView.all().filter(function(e){return e.state.selected}).map(function(e){return e.entity.ol});else{var g=c.dataSource.ol;d=e.featureInMapExtent?g.getFeaturesInExtent(c.map.viewController.getExtent()):g.getFeatures(),c.dataSource instanceof qc&&(d=d.flatMap(function(e){return e.get("features")}))}var f=t.languageService.translate,m=[];if(e.format===Hv.Shapefile||e.format===Hv.GPX?d.forEach(function(e){var t=e.getGeometry().getType(),i=m.find(function(e){return e.geometryType===t});i?i.features.push(e):m.push({geometryType:t,features:[e]})}):m=[{geometryType:"",features:d}],m.forEach(function(e){e.features.forEach(function(e){var t=e.get("rad");if(t){var i=[e.get("longitude"),e.get("latitude")],o=(0,As.iu)(i,t,500);o.transform("EPSG:4326",e.get("_projection")),e.setGeometry(o)}})}),e.format===Hv.GPX){if(m.length>(m=m.filter(function(e){return["LineString","Point"].includes(e.geometryType)})).length){var v=f.instant("igo.geo.export.gpx.error.poly.title"),y=f.instant("igo.geo.export.gpx.error.poly.text");t.messageService.error(y,v,{timeOut:2e4})}}else if((e.format===Hv.CSVsemicolon||e.format===Hv.CSVcomma)&&e.combineLayers){if(m.forEach(function(e){return n.push(e)}),s!==e.layers.length-1)return"continue";var b;n.forEach(function(i){i.features.forEach(function(i){if(e.separator)if(b){if(i.get("_featureStore").layer.options.title!==b.get("_featureStore").layer.options.title){var o=t.createTitleEmptyRows(b,i);r.push(o[2]),r.push(o[0]),r.push(o[1])}}else{var n=t.createTitleEmptyRows(i,i);r.push(n[0])}r.push(i),b=i})})}if(0===m.length){t.loading$.next(!1);var w=f.instant("igo.geo.export.nothing.title"),x=f.instant("igo.geo.export.nothing.text");t.messageService.error(x,w,{timeOut:2e4})}else(e.format!==Hv.CSVsemicolon&&e.format!==Hv.CSVcomma||!e.combineLayers)&&m.map(function(i){return t.exportService.export(i.features,e.format,a+i.geometryType,e.encoding,t.map.projection).subscribe(function(){},function(e){return t.onFileExportError(e)},function(){t.onFileExportSuccess(),i.features.forEach(function(e){t.circleToPoint(e)}),t.loading$.next(!1)})})};for(s.s();!(o=s.n()).done;){var c=l();if("continue"!==c&&"object"==typeof c)return c.v}}catch(u){s.e(u)}finally{s.f()}(e.format===Hv.CSVsemicolon||e.format===Hv.CSVcomma)&&e.combineLayers&&this.exportService.export(r,e.format,a,e.encoding,this.map.projection).subscribe(function(){},function(e){return t.onFileExportError(e)},function(){t.onFileExportSuccess(),r.forEach(function(e){t.circleToPoint(e)}),t.loading$.next(!1)})}},{key:"createTitleEmptyRows",value:function(e,t){var i=t.clone(),o=t.clone(),n=t.clone(),r=e.getKeys(),a="";for(var s in r)if("geometry"!==r[s]){a=r[s];break}var l=t.getKeys(),c="";for(var u in l)if("geometry"!==l[u]){c=l[u];break}var p=t.getKeys();r.forEach(function(e){p.includes(e)&&e!==a&&p.push(e)}),p.unshift(a);var d="";for(var h in p)if("geometry"!==p[h]){d=p[h];break}return p.forEach(function(e){var a=r.length===l.length&&r.every(function(e,t){return e===l[t]});e!==d||a?e===d&&a||e===c?(i.set(e,t.get("_featureStore").layer.options.title,!0),o.set(e,e,!0),n.unset(e,!0)):"geometry"!==e?(i.unset(e,!0),o.set(e,e,!0),n.unset(e,!0)):(i.unset(e,!0),n.unset(e,!0)):(i.set(e,t.get("_featureStore").layer.options.title+" ===============>",!0),o.set(e,e,!0),n.unset(e,!0)),l.includes(e)||o.unset(e,!0)}),[i,o,n]}},{key:"circleToPoint",value:function(e){if(e.get("rad")){var t=new us.Z([e.get("longitude"),e.get("latitude")]);t.transform("EPSG:4326",e.get("_projection")),e.setGeometry(t)}}},{key:"buildForm",value:function(){this.importForm=this.formBuilder.group({inputProj:["",[We.kI.required]]}),this.form=this.formBuilder.group(this.forceNaming?{format:["",[We.kI.required]],layers:[[],[We.kI.required]],layersWithSelection:[[]],encoding:[Wv.UTF8,[We.kI.required]],combineLayers:[!0,[We.kI.required]],separator:[!1,[We.kI.required]],featureInMapExtent:[!1,[We.kI.required]],name:["",[We.kI.required]]}:{format:["",[We.kI.required]],layers:[[],[We.kI.required]],layersWithSelection:[[]],encoding:[Wv.UTF8,[We.kI.required]],combineLayers:[!0,[We.kI.required]],separator:[!1,[We.kI.required]],featureInMapExtent:[!1,[We.kI.required]]})}},{key:"onFileImportSuccess",value:function(e,t){this.config.getConfig("importWithStyle")?Kv(e,t,this.map,this.messageService,this.languageService,this.styleListService,this.styleService):Kv(e,t,this.map,this.messageService,this.languageService)}},{key:"onFileImportError",value:function(e,t){this.loading$.next(!1),function(e,t,i,o,n){({"Invalid file":ey,"File is too large":iy,"Failed to read file":ty,"Invalid SRS definition":oy,"Error 500 with OGRE":ny})[t.message](e,t,i,o,n=n||30)}(e,t,this.messageService,this.languageService,this.fileSizeMb)}},{key:"onPopupBlockedError",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.loading$.next(!1);var t=this.languageService.translate,i=t.instant("igo.geo.export.popupBlocked.title"),o=t.instant(e?"igo.geo.export.popupBlocked.selectAgain":"igo.geo.export.popupBlocked.retry"),n=t.instant("igo.geo.export.popupBlocked.text",{extraMessage:o});this.messageService.error(n,i,{timeOut:2e4})}},{key:"onFileExportError",value:function(e){this.loading$.next(!1),function(e,t,i){if(e instanceof Vv)!function(e,t){var i=t.translate,o=i.instant("igo.geo.export.nothing.title"),n=i.instant("igo.geo.export.nothing.text");e.error(n,o)}(t,i);else{var o=i.translate,n=o.instant("igo.geo.export.failed.title"),r=o.instant("igo.geo.export.failed.text");t.error(r,n)}}(e,this.messageService,this.languageService)}},{key:"loadConfig",value:function(){void 0!==this.config.getConfig("importExport.forceNaming")&&(this.forceNaming=this.config.getConfig("importExport.forceNaming")),this.computeFormats(),this.loadEncodings()}},{key:"encodingDefaultValue",value:function(e){return e===Hv.CSVcomma||e===Hv.CSVsemicolon?(this.form.patchValue({encoding:Wv.LATIN1}),Wv.LATIN1):(this.form.patchValue({encoding:Wv.UTF8}),Wv.UTF8)}},{key:"loadEncodings",value:function(){this.encodings$.next(Wv)}},{key:"computeFormats",value:function(e){var t=this,i=Object.keys(Hv),o={onlyUrl:!1,onlyVector:!1,vectorAndUrl:!1,customList:!1},n=[];if(e&&e.length)if(e.forEach(function(e){var i;!e||((null===(i=e.dataSource.options.download)||void 0===i?void 0:i.allowedFormats)?(o.customList=!0,n.push({layer:e.title,formats:t.validateListFormat(e.dataSource.options.download.allowedFormats)})):e instanceof jc||!e.dataSource.options.download||!e.dataSource.options.download.url?e.dataSource.options.download&&(e.dataSource.options.download.url||e.dataSource.options.download.dynamicUrl)?o.vectorAndUrl=!0:e instanceof jc&&(o.onlyVector=!0):o.onlyUrl=!0)}),!0===o.onlyUrl&&!1===o.onlyVector)i=["URL"];else if(!0===o.onlyVector&&!1===o.onlyUrl)this.computeFormats(),Hv.URL in this.formats$.value&&(i=Object.keys(this.formats$.value).filter(function(e){return"URL"!==e}));else if(!0===o.vectorAndUrl&&!1===o.onlyUrl&&!1===o.onlyVector&&(this.computeFormats(),!(Hv.URL in this.formats$.value))){var r=Object.keys(this.formats$.value);r.push("URL"),i=r}if(void 0!==this.config.getConfig("importExport.formats")&&(i=this.validateListFormat(this.config.getConfig("importExport.formats"))),o.customList){var a,s=[],l=n[0].formats;n.map(function(e){s.push(e.layer),a=e.formats.filter(function(e){return l.includes(e)}),l=e.formats});var c=a.filter(function(e){return i.includes(e)});c.length>0?(this.formats$.next(te(c)),e&&e.length&&e.length>1&&this.messageService.alert(this.languageService.translate.instant("igo.geo.export.customList.text",{value:s.join()}),this.languageService.translate.instant("igo.geo.export.customList.title"))):(this.formats$.next([]),this.messageService.alert(this.languageService.translate.instant("igo.geo.export.noFormat.text"),this.languageService.translate.instant("igo.geo.export.noFormat.title")))}else this.formats$.next(te(i))}},{key:"validateListFormat",value:function(e){return e.filter(function(e){if(e.toUpperCase()===Hv.CSVcomma.toUpperCase()||e.toUpperCase()===Hv.CSVsemicolon.toUpperCase()||e.toUpperCase()===Hv.GML.toUpperCase()||e.toUpperCase()===Hv.GPX.toUpperCase()||e.toUpperCase()===Hv.GeoJSON.toUpperCase()||e.toUpperCase()===Hv.KML.toUpperCase()||e.toUpperCase()===Hv.Shapefile.toUpperCase()||e.toUpperCase()===Hv.URL.toUpperCase())return e}).map(function(e){return e.toUpperCase()===Hv.CSVcomma.toUpperCase()?e=Hv.CSVcomma:e.toUpperCase()===Hv.CSVsemicolon.toUpperCase()?e=Hv.CSVsemicolon:e.toUpperCase()===Hv.GML.toUpperCase()?e=Hv.GML:e.toUpperCase()===Hv.GPX.toUpperCase()?e=Hv.GPX:e.toUpperCase()===Hv.GeoJSON.toUpperCase()?e=Hv.GeoJSON:e.toUpperCase()===Hv.KML.toUpperCase()?e=Hv.KML:e.toUpperCase()===Hv.Shapefile.toUpperCase()?e=Hv.Shapefile:e.toUpperCase()===Hv.URL.toUpperCase()?e=Hv.URL:void 0})}},{key:"modeChanged",value:function(e){this.selectMode.emit(e)}},{key:"onFileExportSuccess",value:function(){!function(e,t){var i=t.translate,o=i.instant("igo.geo.export.success.title"),n=i.instant("igo.geo.export.success.text");e.success(n,o)}(this.messageService,this.languageService)}},{key:"onImportExportChange",value:function(e){this.selectedMode=e.value}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(gy),w.Y36(Xv),w.Y36(Ce),w.Y36(Ae),w.Y36(fy),w.Y36(Zu),w.Y36(We.qu),w.Y36(he),w.Y36(w.sBO),w.Y36(De),w.Y36(yh))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-import-export"]],inputs:{selectFirstProj:"selectFirstProj",map:"map",projectionsLimitations:"projectionsLimitations",store:"store",selectedMode:"selectedMode",exportOptions$:"exportOptions$"},outputs:{selectMode:"selectMode",exportOptionsChange:"exportOptionsChange"},decls:14,vars:17,consts:[[1,"import-export-toggle","mat-typography"],[3,"value","change"],[3,"value"],["class","igo-form",3,"formGroup",4,"ngIf"],["class","mat-typography",4,"ngIf"],[1,"igo-form",3,"formGroup"],[1,"igo-input-container"],[3,"value","valueChange"],[3,"value","click",4,"ngFor","ngForOf"],["tooltip-position","below","matTooltipShowDelay","500",1,"igo-form-button-group",3,"matTooltip"],["mat-raised-button","","type","button",3,"disabled","click"],[3,"shown"],["hidden","","type","file",3,"click","change"],["fileInput",""],[3,"value","click"],["mat-line","",4,"ngIf"],["mat-line",""],[1,"mat-typography"],["multiple","",3,"value","valueChange"],["class","export-select-trigger",4,"ngIf"],[3,"ngClass","value","click",4,"ngFor","ngForOf"],["formControlName","format"],[4,"ngIf"],["disabled","true",4,"ngIf"],["class","igo-input-container",4,"ngIf"],["class","export-combine-layers mat-typography",4,"ngIf"],["class","export-separator mat-typography",4,"ngIf"],["class","export-options mat-typography",4,"ngIf"],[1,"igo-form-button-group"],[1,"export-select-trigger"],[3,"ngClass","value","click"],[3,"labelPosition","click","checked","change",4,"ngIf"],[3,"labelPosition","click","checked","change"],[3,"value",4,"ngFor","ngForOf"],["disabled","true"],["matInput","","formControlName","name",3,"placeholder"],["formControlName","encoding"],[1,"export-combine-layers","mat-typography"],["formControlName","combineLayers",3,"labelPosition"],[1,"export-separator","mat-typography"],["formControlName","separator",3,"labelPosition"],[1,"export-options","mat-typography"],["formControlName","featureInMapExtent",3,"labelPosition"]],template:function(e,t){1&e&&(w.TgZ(0,"div",0),w.TgZ(1,"mat-button-toggle-group",1),w.NdJ("change",function(e){return t.onImportExportChange(e)}),w.TgZ(2,"mat-button-toggle",2),w._uU(3),w.ALo(4,"translate"),w.qZA(),w.TgZ(5,"mat-button-toggle",2),w._uU(6),w.ALo(7,"translate"),w.qZA(),w.qZA(),w.qZA(),w.YNc(8,by,20,24,"form",3),w.YNc(9,xy,14,15,"section",4),w.YNc(10,Sy,4,3,"section",4),w.ALo(11,"async"),w.YNc(12,Ey,36,37,"form",3),w.ALo(13,"async")),2&e&&(w.xp6(1),w.Q6J("value",t.selectedMode),w.xp6(1),w.Q6J("value","import"),w.xp6(1),w.hij(" ",w.lcZ(4,9,"igo.geo.importExportForm.importTabTitle")," "),w.xp6(2),w.Q6J("value","export"),w.xp6(1),w.hij(" ",w.lcZ(7,11,"igo.geo.importExportForm.exportTabTitle")," "),w.xp6(2),w.Q6J("ngIf","import"===t.selectedMode),w.xp6(1),w.Q6J("ngIf","import"===t.selectedMode),w.xp6(1),w.Q6J("ngIf",0===w.lcZ(11,13,t.exportableLayers$).length&&"export"===t.selectedMode),w.xp6(2),w.Q6J("ngIf",w.lcZ(13,15,t.exportableLayers$).length>0&&"export"===t.selectedMode))},directives:[Al.A9,Al.Yi,F.O5,We._Y,We.JL,We.sg,Ye.KE,Ye.hX,ze.gD,F.sg,L.gM,S.lW,wn,Ve.ey,ze.$L,We.JJ,We.u,F.mk,Cl.Rr,ot.Nt,We.Fj],pipes:[ae.X$,F.Ov,sn],styles:["mat-option.igo-export-layer-mat-option[_ngcontent-%COMP%]{height:5em;line-height:1em}.import-export-toggle[_ngcontent-%COMP%]{padding:10px;text-align:center}.import-export-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]{width:100%}.import-export-toggle[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]{width:50%}h4[_ngcontent-%COMP%]{padding:0 5px}.igo-form[_ngcontent-%COMP%]{padding:15px 5px}.igo-input-container[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.igo-form-button-group[_ngcontent-%COMP%]{text-align:center;padding-top:10px}igo-spinner[_ngcontent-%COMP%]{position:absolute;padding-left:10px}.export-options[_ngcontent-%COMP%], .export-combine-layers[_ngcontent-%COMP%], .export-separator[_ngcontent-%COMP%]{overflow-x:hidden}.export-options[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%], .export-combine-layers[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%], .export-separator[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{width:100%;margin:10px}.export-options[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content, .export-combine-layers[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content, .export-separator[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content{width:calc(100% - 60px)}.export-select-trigger[_ngcontent-%COMP%]{opacity:.75;font-size:.75em}"]}),e}(),Ry=new w.OlP("styleListOptions");function Ny(e){return{provide:Ry,useValue:e}}function Uy(e,t){return function(){return e.load(t)}}var Jy=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[Ny({}),{provide:w.ip1,useFactory:Uy,multi:!0,deps:[fy,Ry]}]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[]]}),e}(),By=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[k.Ps,L.AV,We.u5,We.UX,F.ez,S.ot,Al.vV,ql.Nh,ze.LD,Ve.Ng,Ye.lN,ot.c,Cl.rP,Se,Sn,ln,wo,Jy.forRoot()],Jy]}),e}(),jy=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,Se,mo,k.Ps,S.ot,L.AV]]}),e}();function Qy(e,t){if(1&e&&(w.TgZ(0,"mat-option",5),w._uU(1),w.ALo(2,"translate"),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i),w.xp6(1),w.hij(" ",w.lcZ(2,2,"igo.geo.measure."+i)," ")}}w.B6R(Wu,[F.O5,F.mk,S.lW,L.gM,k.Hw,F.sg,tp],[ae.X$]),w.B6R(tp,[F.O5,Du],[]);var Gy=function(){var e=function(){function e(){m(this,e),this.measure$=new R.X(void 0),this._auto=!1,this.measureUnitChange=new w.vpe}return y(e,[{key:"measure",get:function(){return this.measure$.value},set:function(e){this.measure$.next(e)}},{key:"auto",get:function(){return this._auto},set:function(e){this.toggleAutoUnit(e)}},{key:"measureUnits",get:function(){return Object.values(this.measureType===Uh.Area?jh:Jh)}},{key:"ngOnDestroy",value:function(){this.toggleAutoUnit(!1)}},{key:"onMeasureUnitChange",value:function(e){this.measureUnit=e,this.measureUnitChange.emit(e)}},{key:"toggleAutoUnit",value:function(e){var t=this;void 0!==this.measure$$&&this.measure$$.unsubscribe(),!0===e&&(this.measure$$=this.measure$.subscribe(function(e){t.computeBestMeasureUnit(e)})),this._auto=e}},{key:"computeBestMeasureUnit",value:function(e){var t=this.measureUnit;this.measureType===Uh.Area?t=function(e){for(var t=jh.SquareMeters,i=e,o=[jh.SquareKilometers];i>1e6&&o.length>0;)i=tg(e,t=o.pop());return t}(e):this.measureType===Uh.Length&&(t=function(e){for(var t=Jh.Meters,i=e,o=[Jh.Kilometers];i>1e3&&o.length>0;)i=eg(e,t=o.pop());return t}(e)),t!==this.measureUnit&&this.onMeasureUnitChange(t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-measurer-item"]],inputs:{measureType:"measureType",measureUnit:"measureUnit",measure:"measure",auto:"auto",placeholder:"placeholder"},outputs:{measureUnitChange:"measureUnitChange"},decls:9,vars:11,consts:[["appearance","outline","floatLabel","always",1,"measure-field"],["matInput","",3,"readonly","value"],[1,"unit-field"],[3,"value","disabled","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-form-field",0),w.TgZ(1,"mat-label"),w._uU(2),w.qZA(),w._UZ(3,"input",1),w.ALo(4,"measureFormat"),w.ALo(5,"async"),w.qZA(),w.TgZ(6,"mat-form-field",2),w.TgZ(7,"mat-select",3),w.NdJ("selectionChange",function(e){return t.onMeasureUnitChange(e.value)}),w.YNc(8,Qy,3,4,"mat-option",4),w.qZA(),w.qZA()),2&e&&(w.xp6(2),w.Oqu(t.placeholder),w.xp6(1),w.Q6J("readonly",!0)("value",w.xi3(4,6,w.lcZ(5,9,t.measure$)||0,t.measureUnit)),w.xp6(4),w.Q6J("value",t.measureUnit)("disabled",t.auto),w.xp6(1),w.Q6J("ngForOf",t.measureUnits))},directives:[Ye.KE,Ye.hX,ot.Nt,ze.gD,F.sg,Ve.ey],pipes:[Jg,F.Ov,ae.X$],styles:["[_nghost-%COMP%]{display:flex;width:100%;padding:5px 10px}.measure-field[_ngcontent-%COMP%]{pointer-events:none;display:flex;flex-flow:column nowrap;width:100%}.unit-field[_ngcontent-%COMP%]{width:50px;margin-left:10px;margin-top:10px}"],changeDetection:0}),e}(),Yy=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,S.ot,Al.vV,k.Ps,L.AV,Ye.lN,ot.c,ze.LD,Cl.rP,kl.t,Se,Wo]]}),e}();w.B6R(Ug,[Al.A9,Al.Yi,Cl.Rr,F.O5,kl.d,Gy,S.lW,L.gM,k.Hw,Ei],[ae.X$,F.Ov]),w.B6R(Lg,[F.O5],[ae.X$,Jg]);var zy=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[],Yy]}),e}(),Vy=function(){return(e=Vy||(Vy={}))[e.None=0]="None",e[e.Move=1]="Move",e[e.Zoom=2]="Zoom",e[e.ZoomIfOutMapExtent=3]="ZoomIfOutMapExtent",Vy;var e}(),Hy=function(){var e=function(){function e(){m(this,e),this.features$=new R.X([[],void 0])}return y(e,[{key:"setFeatures",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Vy.None;this.features$.next([e,t])}},{key:"clear",value:function(){this.features$.next([[],Vy.None])}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Wy=function(){var e=function(){function e(t,i){m(this,e),this.component=t,this.overlayService=i,this.format=new Zs.Z}return y(e,[{key:"map",get:function(){return this.component.map}},{key:"ngOnInit",value:function(){var e=this;this.features$$=this.overlayService.features$.subscribe(function(t){return e.handleFeatures(t[0],t[1])})}},{key:"ngOnDestroy",value:function(){this.features$$.unsubscribe()}},{key:"handleFeatures",value:function(e,t){}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Du,2),w.Y36(Hy))},e.\u0275dir=w.lG2({type:e,selectors:[["","igoOverlay",""]]}),e}(),Xy=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[]]}),e}(),Ky=function(){var e=function(){function e(t,i,o,n){m(this,e),this.http=t,this.messageService=i,this.activityService=o,this.languageService=n}return y(e,[{key:"print",value:function(e,t){var i=this,o=new Q.xQ,n=t.paperFormat,r=+t.resolution,a=t.orientation;this.activityId=this.activityService.register();var s=new Ul.ZP({orientation:a,format:n.toLowerCase()}),l=[s.internal.pageSize.width,s.internal.pageSize.height],c=[10,10,10,10],u=l[0]-c[3]-c[1],p=l[1]-c[0]-c[2],d=[u,p],h=[0,0];if(void 0!==t.title&&(h=this.getTitleSize(t.title,u,p,s),this.addTitle(s,t.title,h[0],c[3]+h[1],h[0]*(25.4/72))),void 0!==t.subtitle){var g,f=h[0];g=this.getSubTitleSize(t.subtitle,u,p,s),this.addSubTitle(s,t.subtitle,.7*f,c[3]+g,1.7*f*(25.4/72)),c[0]=c[0]+.7*h[0]*(25.4/72)}return(!0===t.showProjection||!0===t.showScale)&&this.addProjScale(s,e,r,t.showProjection,t.showScale),""!==t.comment&&this.addComment(s,t.comment),this.addMap(s,e,r,d,c).subscribe(function(n){return(0,at.mG)(i,void 0,void 0,regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.t0=n===ne.Done,!i.t0){i.next=20;break}return i.next=4,this.addScale(s,e,c);case 4:return i.next=6,this.handleMeasureLayer(s,e,c);case 6:if("none"===t.legendPosition){i.next=18;break}if(!(["topleft","topright","bottomleft","bottomright"].indexOf(t.legendPosition)>-1)){i.next=12;break}return i.next=10,this.addLegendSamePage(s,e,c,r,t.legendPosition);case 10:i.next=16;break;case 12:if(i.t1="newpage"===t.legendPosition,!i.t1){i.next=16;break}return i.next=16,this.addLegend(s,e,c,r);case 16:i.next=20;break;case 18:return i.next=20,this.saveDoc(s);case 20:(n===ne.Done||n===ne.Error)&&(this.activityService.unregister(this.activityId),o.next(ne.Done));case 21:case"end":return i.stop()}},i,this)}))}),o}},{key:"handleMeasureLayer",value:function(e,t,i){return(0,at.mG)(this,void 0,void 0,regeneratorRuntime.mark(function o(){var n,r;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!t.layers.find(function(e){return e.visible&&e.id.startsWith("igo-measures-")})){o.next=5;break}return r=t.ol.getOverlayContainer(),o.next=4,Bl()(r,{scale:1,backgroundColor:null}).then(function(e){n=e});case 4:this.addCanvas(e,n,i);case 5:case"end":return o.stop()}},o,this)}))}},{key:"getLayersLegendHtml",value:function(e,t,i){var o=this;return new Ne.y(function(n){var r="",a=function(e,t){var i,o=[],n=p(e);try{for(n.s();!(i=n.n()).done;){var r=i.value;if(!1!==r.visible){var a,s=p(r.dataSource.getLegend(void 0,t)||[]);try{for(s.s();!(a=s.n()).done;){var l=a.value;void 0!==l.url&&o.push({title:r.title,url:l.url})}}catch(c){s.e(c)}finally{s.f()}}}}catch(c){n.e(c)}finally{n.f()}return o}(e.layers,{resolution:e.viewController.getResolution(),extent:e.viewController.getExtent(),projection:e.viewController.getOlProjection().getCode(),scale:e.viewController.getScale(i),size:e.ol.getSize()});if(0===a.length)return n.next(r),void n.complete();r+='<style media="screen" type="text/css">',r+=".html2canvas-container { width: "+t+"mm !important; height: 2000px !important; }",r+="table.tableLegend {table-layout: auto;}",r+="div.styleLegend {padding-top: 5px; padding-right:5px;padding-left:5px;padding-bottom:5px;}",r+="</style>",r+='<font size="3" face="Times" >',r+='<div class="styleLegend">',r+='<table class="tableLegend" >';var s=a.map(function(e){return o.getDataImage(e.url).pipe((0,D.U)(function(t){var i="<tr><td>"+e.title.toUpperCase()+"</td></tr>";return i+='<tr><td><img src="'+t+'"></td></tr>'}))});(0,Ya.D)(s).subscribe(function(e){r=e.reduce(function(e,t){return e+t},r),r+="</table>",r+="</div>",n.next(r),n.complete()})})}},{key:"getDataImage",value:function(e){return new $t(this.http).transform(e)}},{key:"getLayersLegendImage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"png",i=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;return(0,at.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r,a,s,l,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=new Q.xQ,n.next=3,this.getLayersLegendHtml(e,200,o).toPromise();case 3:return a=n.sent,t=t.toLowerCase(),0===a.length&&(a='<font size="12" face="Courier New" >',a+='<div align="center"><b>NO LEGEND</b></div>'),(s=window.document.createElement("div")).style.position="absolute",s.style.top="0",window.document.body.appendChild(s),s.innerHTML=a,n.next=12,this.timeout(1);case 12:return n.next=14,Bl()(s,{useCORS:!0}).catch(function(e){console.log(e)});case 14:if(l=n.sent){c=ne.Done;try{i?this.generateCanvaFileToZip(l,"legendImage."+t):this.saveCanvasImageAsFile(l,"legendImage",t),s.parentNode.removeChild(s)}catch(u){c=ne.Error}r.next(c)}return n.abrupt("return",r);case 17:case"end":return n.stop()}},n,this)}))}},{key:"getTitleSize",value:function(e,t,i,o){var n=Math.round(2*(i+145)*.05)/2;o.setFont("Times","bold"),o.getTextWidth(e);var r,a=o.getStringUnitWidth(e)*n/o.internal.scaleFactor,s=Math.round(2*(i+150)*.037)/2,l=0;return a>=t?(r=0,(l=Math.round(t/e.length*96/25.4))<s&&(l=s)):(r=(t-a)/2,l=n),[l,r]}},{key:"getSubTitleSize",value:function(e,t,i,o){var n=.7*Math.round(2*(i+145)*.05)/2;o.setFont("Times","bold");var r=o.getStringUnitWidth(e)*n/o.internal.scaleFactor;return r>=t?0:(t-r)/2}},{key:"addTitle",value:function(e,t,i,o,n){e.setFont("Times","bold"),e.setFontSize(i),e.text(t,o,n)}},{key:"addSubTitle",value:function(e,t,i,o,n){e.setFont("Times","bold"),e.setFontSize(i),e.text(t,o,n)}},{key:"addComment",value:function(e,t){var i=e.internal.pageSize.height-5;e.setFont("courier"),e.setFontSize(16),e.text(t,20,i)}},{key:"addProjScale",value:function(e,t,i,o,n){var r=this.languageService.translate,a=e.internal.pageSize.height-15,s="";!0===o&&(s+=r.instant("igo.geo.printForm.projection")+": "+t.projection),!0===n&&(!0===o&&(s+="   "),s+=r.instant("igo.geo.printForm.scale")+": ~ 1 / "+Rc(t.viewController.getScale(i))),e.setFont("courier"),e.setFontSize(16),e.text(s,20,a)}},{key:"addLegend",value:function(e,t,i,o){return(0,at.mG)(this,void 0,void 0,regeneratorRuntime.mark(function i(){var n,r,a,s,l,c;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return n=e.internal.pageSize.width,i.next=3,this.getLayersLegendHtml(t,n,o).toPromise();case 3:if(""!==(r=i.sent)){i.next=8;break}return i.next=7,this.saveDoc(e);case 7:return i.abrupt("return",!0);case 8:return(a=window.document.createElement("div")).style.position="absolute",a.style.top="0",window.document.body.appendChild(a),a.innerHTML=r,i.next=15,this.timeout(1);case 15:return i.next=17,Bl()(a,{useCORS:!0}).catch(function(e){console.log(e)});case 17:return(s=i.sent)&&(.85,l=[25.4*s.width*.85/o,25.4*s.height*.85/o],e.addPage(),c=s.toDataURL("image/png"),e.addImage(c,"PNG",10,10,l[0],l[1]),a.parentNode.removeChild(a)),i.next=21,this.saveDoc(e);case 21:case"end":return i.stop()}},i,this)}))}},{key:"addLegendSamePage",value:function(e,t,i,o,n){return(0,at.mG)(this,void 0,void 0,regeneratorRuntime.mark(function r(){var a,s,l,c,u,p;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a=e.internal.pageSize.width,r.next=3,this.getLayersLegendHtml(t,a,o).toPromise();case 3:if(""!==(s=r.sent)){r.next=8;break}return r.next=7,this.saveDoc(e);case 7:return r.abrupt("return",!0);case 8:return(l=window.document.createElement("div")).style.position="absolute",l.style.top="0",window.document.body.appendChild(l),l.innerHTML=s,r.next=15,this.timeout(1);case 15:return r.next=17,Bl()(l,{useCORS:!0}).catch(function(e){console.log(e)});case 17:if(!(c=r.sent)){r.next=25;break}return.85,p=[25.4*c.width*.85/o,25.4*c.height*.85/o],"bottomright"===n?u=[e.internal.pageSize.height-i[2]-p[1],i[1],i[2],e.internal.pageSize.width-i[1]-p[0]]:"topright"===n?u=[i[0],i[1],e.internal.pageSize.height-i[0]-p[1],e.internal.pageSize.width-i[1]-p[0]]:"bottomleft"===n?u=[e.internal.pageSize.height-i[2]-p[1]-15,e.internal.pageSize.width-i[3]-p[0],i[2]+15,i[3]]:"topleft"===n&&(u=[i[0],e.internal.pageSize.width-i[3]-p[0],e.internal.pageSize.height-i[0]-p[1],i[3]]),this.addCanvas(e,c,u),l.parentNode.removeChild(l),r.next=25,this.saveDoc(e);case 25:case"end":return r.stop()}},r,this)}))}},{key:"addScale",value:function(e,t,i){return(0,at.mG)(this,void 0,void 0,regeneratorRuntime.mark(function o(){var n,r,a,s,l,c,u;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:for(n=t.ol.getSize(),t.ol.getView().calculateExtent(n),a=t.ol.getOverlayContainerStopEvent(),s=a.getElementsByTagName("button"),l=Array.from(s),c=0,u=l;c<u.length;c++)u[c].setAttribute("data-html2canvas-ignore","true");return o.next=6,Bl()(a,{scale:1,backgroundColor:null,allowTaint:!0,useCORS:!0}).then(function(e){r=e});case 6:this.addCanvas(e,r,i);case 7:case"end":return o.stop()}},o,this)}))}},{key:"defineNbFileToProcess",value:function(e){this.nbFileToProcess=e}},{key:"timeout",value:function(e){return new Promise(function(t){return setTimeout(t,e)})}},{key:"addCanvas",value:function(e,t,i){var o;if(t&&(o=t.toDataURL("image/png")),void 0!==o){var n=this.getImageSizeToFitPdf(e,t,i);e.addImage(o,"PNG",i[3],i[0],n[0],n[1]),e.rect(i[3],i[0],n[0],n[1])}}},{key:"addMap",value:function(e,t,i,o,n){var r,a=this,s=new Q.xQ,l=t.ol.getSize(),c=t.ol.getView().calculateExtent(l),u=Math.round(o[0]*i/25.4),d=Math.round(o[1]*i/25.4);return t.ol.once("rendercomplete",function(i){var o=i.target.getViewport().getElementsByTagName("canvas"),u=t.status$.subscribe(function(i){if(clearTimeout(r),i===ne.Done){u.unsubscribe();var d=ne.Done;try{var h,g=p(o);try{for(g.s();!(h=g.n()).done;){var f=h.value;0!==f.width&&a.addCanvas(e,f,n)}}catch(m){g.e(m)}finally{g.f()}}catch(f){d=ne.Error,a.messageService.error(a.languageService.translate.instant("igo.geo.printForm.corsErrorMessageBody"),a.languageService.translate.instant("igo.geo.printForm.corsErrorMessageHeader"))}a.renderMap(t,l,c),s.next(d)}});r=window.setTimeout(function(){u.unsubscribe();var i=ne.Done;try{var r,d=p(o);try{for(d.s();!(r=d.n()).done;){var h=r.value;0!==h.width&&a.addCanvas(e,h,n)}}catch(g){d.e(g)}finally{d.f()}}catch(h){i=ne.Error,a.messageService.error(a.languageService.translate.instant("igo.geo.printForm.corsErrorMessageBody"),a.languageService.translate.instant("igo.geo.printForm.corsErrorMessageHeader"))}a.renderMap(t,l,c),s.next(i)},200)}),this.renderMap(t,[u,d],c),s}},{key:"downloadMapImage",value:function(e,t){var i=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"png",n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"",l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"",c=!(arguments.length>9&&void 0!==arguments[9])||arguments[9],u=new Q.xQ;this.activityId=this.activityService.register();var p=this.languageService.translate;return e.ol.once("rendercomplete",function(d){o=o.toLowerCase();var h=d.target.getViewport().getElementsByTagName("canvas")[0],g=document.createElement("canvas"),f=g.getContext("2d"),m=0,v=10,y=h.width,b=h.height;f.font="20px Calibri";var w=f.measureText(l).width;b=""!==a?b+30:b,b=""!==s?b+30:b;var x=(b=!1!==n||!1!==r?b+30:b)-10,S=Math.ceil(w/y),k=(b=""!==l?b+30*S:b)-20*S+5;if(g.width=y,g.height=b,"jpeg"===o&&(f.fillStyle="#ffffff",f.fillRect(0,0,y,b),f.fillStyle="#000000"),""!==a&&(f.font="26px Calibri",m=30,f.textAlign="center",f.fillText(a,y/2,20,.9*y)),""!==s&&(f.font="26px Calibri",m=60,f.textAlign="center",f.fillText(s,y/2,50,.9*y)),f.font="20px Calibri",!1!==n){var C=p.instant("igo.geo.printForm.projection");f.textAlign="start",f.fillText(C+": "+e.projection,v,x),v+=200}if(!1!==r){var T=p.instant("igo.geo.printForm.scale"),A=e.viewController.getScale(t);f.textAlign="start",f.fillText(T+": ~ 1 / "+Rc(A),v,x)}if(""!==l)if(f.textAlign="center",1===S)f.fillText(l,y/2,k);else for(var L,Z=Math.floor(l.length/S),F="",O=0,M=0;M<S;M++)S-1>M?(L=(F=l.substr(O,Z)).lastIndexOf(" "),f.fillText(F.substr(0,L),y/2,k),O+=L,k+=20):f.fillText(l.substr(O),y/2,k);f.drawImage(h,0,m);var I=ne.Done;try{c?"tiff"===o.toLowerCase()?i.generateCanvaFileToZip(g,"map"+e.projection.replace(":","_")+"."+o):i.generateCanvaFileToZip(g,"map."+o):i.saveCanvasImageAsFile(g,"map",o)}catch(C){I=ne.Error}if(u.next(I),"tiff"===o.toLowerCase()){var P=i.getWorldFileInformation(e),_=new Blob([P],{type:"text/plain;charset=utf-8"});c?i.addFileToZip("map"+e.projection.replace(":","_")+".tfw",_):((0,Nl.saveAs)(_,"map"+e.projection+".tfw"),i.saveFileProcessing())}}),e.ol.renderSync(),u}},{key:"renderMap",value:function(e,t,i){e.ol.updateSize(),e.ol.renderSync()}},{key:"saveDoc",value:function(e){return(0,at.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.save("map.pdf",{returnPromise:!0});case 2:case"end":return t.stop()}},t)}))}},{key:"getImageSizeToFitPdf",value:function(e,t,i){var o=e.internal.pageSize.getHeight()-(i[0]+i[2]),n=e.internal.pageSize.getWidth()-(i[1]+i[3]),r=t.height,a=t.width,s=r/o,l=a/n,c=s>l?s:l;return[c>1?a/c:a,c>1?r/c:r]}},{key:"getWorldFileInformation",value:function(e){var t=e.viewController.getResolution(),i=e.viewController.getExtent();return[t,0,0,-t,i[0]+t/.5,i[3]-t/.5].join("\n")}},{key:"saveCanvasImageAsFile",value:function(e,t,i){var o="image/"+i,n=this;try{e.toDataURL(),navigator.msSaveBlob?(navigator.msSaveBlob(e.msToBlob(),t+"."+i),this.saveFileProcessing()):e.toBlob(function(e){(0,Nl.saveAs)(e,t+"."+i),n.saveFileProcessing()},o)}catch(r){this.messageService.error(this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageBody"),this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageHeader"))}}},{key:"generateCanvaFileToZip",value:function(e,t){var i=this;(!this.hasOwnProperty("zipFile")||void 0===this.zipFile)&&(this.zipFile=new jl);try{e.toDataURL(),navigator.msSaveBlob?this.addFileToZip(t,e.msToBlob()):e.toBlob(function(e){i.addFileToZip(t,e)},"image/jpeg")}catch(o){this.messageService.error(this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageBody"),this.languageService.translate.instant("igo.geo.printForm.corsErrorMessageHeader"))}}},{key:"addFileToZip",value:function(e,t){this.zipFile.file(e,t),this.nbFileToProcess--,0===this.nbFileToProcess&&(this.getZipFile(),this.activityService.unregister(this.activityId))}},{key:"saveFileProcessing",value:function(){this.nbFileToProcess--,0===this.nbFileToProcess&&this.activityService.unregister(this.activityId)}},{key:"getZipFile",value:function(){var e=this;this.zipFile.generateAsync({type:"blob"}).then(function(t){(0,Nl.saveAs)(t,"map.zip"),delete e.zipFile})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(P.eN),w.LFG(Ae),w.LFG(ce),w.LFG(Ce))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),eb=te(["Pdf","Image"]),tb=te(["A0","A1","A2","A3","A4","A5","Letter","Legal"]),ib=te(["landscape","portrait"]),ob=te(["72","96","150","300"]),nb=te(["Bmp","Gif","Jpeg","Png","Tiff"]),rb=te(["none","topright","topleft","bottomleft","bottomright","newpage"]);function ab(e,t){if(1&e&&(w.TgZ(0,"mat-option",19),w._uU(1),w.ALo(2,"translate"),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i.key),w.xp6(1),w.hij(" ",w.lcZ(2,2,"igo.geo.printForm.legendPositions."+i.value)," ")}}function sb(e,t){if(1&e&&(w.TgZ(0,"mat-option",19),w._uU(1),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i.key),w.xp6(1),w.hij(" ",i.value," ")}}function lb(e,t){if(1&e&&(w.TgZ(0,"mat-option",19),w._uU(1),w.ALo(2,"translate"),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i.key),w.xp6(1),w.hij(" ",w.lcZ(2,2,"igo.geo.printForm.paperFormats."+i.value)," ")}}function cb(e,t){if(1&e&&(w.TgZ(0,"mat-option",19),w._uU(1),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i.key),w.xp6(1),w.hij(" ",i.value," ")}}function ub(e,t){if(1&e&&(w.TgZ(0,"mat-option",19),w._uU(1),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i.key),w.xp6(1),w.hij(" ",i.value+" PPI"," ")}}function pb(e,t){if(1&e&&(w.TgZ(0,"mat-option",19),w._uU(1),w.ALo(2,"translate"),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i.key),w.xp6(1),w.hij(" ",w.lcZ(2,2,"igo.geo.printForm."+i.value)," ")}}var db=function(){var e=function(){function e(t){m(this,e),this.formBuilder=t,this.outputFormats=eb,this.paperFormats=tb,this.orientations=ib,this.resolutions=ob,this.imageFormats=nb,this.legendPositions=rb,this.isPrintService=!0,this.submit=new w.vpe,this.form=this.formBuilder.group({title:["",[]],subtitle:["",[]],comment:["",[]],outputFormat:["",[We.kI.required]],paperFormat:["",[We.kI.required]],imageFormat:["",[We.kI.required]],resolution:["",[We.kI.required]],orientation:["",[We.kI.required]],legendPosition:["",[We.kI.required]],showProjection:!1,showScale:!1,showLegend:!1,doZipFile:[{hidden:this.isPrintService}]})}return y(e,[{key:"imageFormat",get:function(){return this.imageFormatField.value},set:function(e){this.imageFormatField.setValue(e||nb.Jpeg,{onlySelf:!0})}},{key:"outputFormat",get:function(){return this.outputFormatField.value},set:function(e){this.outputFormatField.setValue(e||eb.Pdf,{onlySelf:!0})}},{key:"paperFormat",get:function(){return this.paperFormatField.value},set:function(e){this.paperFormatField.setValue(e||tb.Letter,{onlySelf:!0})}},{key:"orientation",get:function(){return this.orientationField.value},set:function(e){this.orientationField.setValue(e||ib.landscape,{onlySelf:!0})}},{key:"resolution",get:function(){return this.resolutionField.value},set:function(e){this.resolutionField.setValue(e||ob[96],{onlySelf:!0})}},{key:"legendPosition",get:function(){return this.legendPositionField.value},set:function(e){this.legendPositionField.setValue(e||rb.none,{onlySelf:!0})}},{key:"title",get:function(){return this.titleField.value},set:function(e){this.titleField.setValue(e,{onlySelf:!0})}},{key:"subtitle",get:function(){return this.subtitleField.value},set:function(e){this.subtitleField.setValue(e,{onlySelf:!0})}},{key:"comment",get:function(){return this.commentField.value},set:function(e){this.commentField.setValue(e,{onlySelf:!0})}},{key:"showProjection",get:function(){return this.showProjectionField.value},set:function(e){this.showProjectionField.setValue(e,{onlySelf:!0})}},{key:"showScale",get:function(){return this.showScaleField.value},set:function(e){this.showScaleField.setValue(e,{onlySelf:!0})}},{key:"showLegend",get:function(){return this.showLegendField.value},set:function(e){this.showLegendField.setValue(e,{onlySelf:!0})}},{key:"doZipFile",get:function(){return this.doZipFileField.value},set:function(e){this.doZipFileField.setValue(e,{onlySelf:!0})}},{key:"outputFormatField",get:function(){return this.form.controls.outputFormat}},{key:"paperFormatField",get:function(){return this.form.controls.paperFormat}},{key:"imageFormatField",get:function(){return this.form.controls.imageFormat}},{key:"orientationField",get:function(){return this.form.controls.orientation}},{key:"resolutionField",get:function(){return this.form.controls.resolution}},{key:"commentField",get:function(){return this.form.controls.comment}},{key:"showProjectionField",get:function(){return this.form.controls.showProjection}},{key:"showScaleField",get:function(){return this.form.controls.showScale}},{key:"showLegendField",get:function(){return this.form.controls.showLegend}},{key:"doZipFileField",get:function(){return this.form.controls.doZipFile}},{key:"titleField",get:function(){return this.form.controls.title}},{key:"subtitleField",get:function(){return this.form.controls.subtitle}},{key:"legendPositionField",get:function(){return this.form.controls.legendPosition}},{key:"ngOnInit",value:function(){this.doZipFileField.setValue(!1)}},{key:"handleFormSubmit",value:function(e,t){e.isPrintService=this.isPrintService,t&&this.submit.emit(e)}},{key:"toggleImageSaveProp",value:function(){this.isPrintService="Image"!==this.outputFormatField.value}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(We.qu))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-print-form"]],inputs:{disabled$:"disabled$",imageFormat:"imageFormat",outputFormat:"outputFormat",paperFormat:"paperFormat",orientation:"orientation",resolution:"resolution",legendPosition:"legendPosition",title:"title",subtitle:"subtitle",comment:"comment",showProjection:"showProjection",showScale:"showScale",showLegend:"showLegend",doZipFile:"doZipFile"},outputs:{submit:"submit"},decls:65,vars:72,consts:[[1,"igo-form",3,"formGroup"],[1,"igo-input-container"],["matInput","","formControlName","title",3,"placeholder"],["matInput","","formControlName","subtitle",3,"placeholder"],["matInput","","formControlName","comment",3,"placeholder"],[1,"print-slide-toggle-container","mat-typography"],["formControlName","showProjection",1,"print-option",3,"labelPosition"],["formControlName","showScale",1,"print-option",3,"labelPosition"],["formControlName","doZipFile",1,"print-option",3,"labelPosition"],["formControlName","legendPosition",3,"placeholder"],[3,"value",4,"ngFor","ngForOf"],["formControlName","outputFormat",3,"placeholder","selectionChange"],["formControlName","paperFormat",3,"placeholder"],["formControlName","imageFormat",3,"placeholder"],[1,"igo-input-container",2,"display","none"],["formControlName","resolution",3,"placeholder"],["formControlName","orientation",3,"placeholder"],[1,"igo-form-button-group","print-button-top-padding"],["mat-raised-button","","type","button",3,"disabled","click"],[3,"value"]],template:function(e,t){1&e&&(w.TgZ(0,"form",0),w.TgZ(1,"div",1),w.TgZ(2,"mat-form-field"),w._UZ(3,"input",2),w.ALo(4,"translate"),w.qZA(),w.qZA(),w.TgZ(5,"div",1),w.TgZ(6,"mat-form-field"),w._UZ(7,"input",3),w.ALo(8,"translate"),w.qZA(),w.qZA(),w.TgZ(9,"div",1),w.TgZ(10,"mat-form-field"),w._UZ(11,"input",4),w.ALo(12,"translate"),w.qZA(),w.qZA(),w.TgZ(13,"div",1),w.TgZ(14,"div",5),w.TgZ(15,"mat-slide-toggle",6),w._uU(16),w.ALo(17,"translate"),w.qZA(),w.TgZ(18,"mat-slide-toggle",7),w._uU(19),w.ALo(20,"translate"),w.qZA(),w.TgZ(21,"mat-slide-toggle",8),w._uU(22),w.ALo(23,"translate"),w.qZA(),w.qZA(),w.qZA(),w.TgZ(24,"div",1),w.TgZ(25,"mat-form-field"),w.TgZ(26,"mat-select",9),w.ALo(27,"translate"),w.YNc(28,ab,3,4,"mat-option",10),w.ALo(29,"keyvalue"),w.qZA(),w.qZA(),w.qZA(),w.TgZ(30,"div",1),w.TgZ(31,"mat-form-field"),w.TgZ(32,"mat-select",11),w.NdJ("selectionChange",function(){return t.toggleImageSaveProp()}),w.ALo(33,"translate"),w.YNc(34,sb,2,2,"mat-option",10),w.ALo(35,"keyvalue"),w.qZA(),w.qZA(),w.qZA(),w.TgZ(36,"div",1),w.TgZ(37,"mat-form-field"),w.TgZ(38,"mat-select",12),w.ALo(39,"translate"),w.YNc(40,lb,3,4,"mat-option",10),w.ALo(41,"keyvalue"),w.qZA(),w.qZA(),w.qZA(),w.TgZ(42,"div",1),w.TgZ(43,"mat-form-field"),w.TgZ(44,"mat-select",13),w.ALo(45,"translate"),w.YNc(46,cb,2,2,"mat-option",10),w.ALo(47,"keyvalue"),w.qZA(),w.qZA(),w.qZA(),w.TgZ(48,"div",14),w.TgZ(49,"mat-form-field"),w.TgZ(50,"mat-select",15),w.ALo(51,"translate"),w.YNc(52,ub,2,2,"mat-option",10),w.ALo(53,"keyvalue"),w.qZA(),w.qZA(),w.qZA(),w.TgZ(54,"div",1),w.TgZ(55,"mat-form-field"),w.TgZ(56,"mat-select",16),w.ALo(57,"translate"),w.YNc(58,pb,3,4,"mat-option",10),w.ALo(59,"keyvalue"),w.qZA(),w.qZA(),w.qZA(),w.TgZ(60,"div",17),w.TgZ(61,"button",18),w.NdJ("click",function(){return t.handleFormSubmit(t.form.value,t.form.valid)}),w.ALo(62,"async"),w._uU(63),w.ALo(64,"translate"),w.qZA(),w.qZA(),w.qZA()),2&e&&(w.Q6J("formGroup",t.form),w.xp6(3),w.s9C("placeholder",w.lcZ(4,32,"igo.geo.printForm.title")),w.xp6(4),w.s9C("placeholder",w.lcZ(8,34,"igo.geo.printForm.subtitle")),w.xp6(4),w.s9C("placeholder",w.lcZ(12,36,"igo.geo.printForm.comment")),w.xp6(4),w.Q6J("labelPosition","before"),w.xp6(1),w.hij(" ",w.lcZ(17,38,"igo.geo.printForm.showProjection")," "),w.xp6(2),w.Q6J("labelPosition","before"),w.xp6(1),w.hij(" ",w.lcZ(20,40,"igo.geo.printForm.showScale")," "),w.xp6(2),w.Udp("display",t.isPrintService?"none":""),w.Q6J("labelPosition","before"),w.xp6(1),w.hij(" ",w.lcZ(23,42,"igo.geo.printForm.doZipFile")," "),w.xp6(4),w.s9C("placeholder",w.lcZ(27,44,"igo.geo.printForm.legendPosition")),w.xp6(2),w.Q6J("ngForOf",w.lcZ(29,46,t.legendPositions)),w.xp6(4),w.s9C("placeholder",w.lcZ(33,48,"igo.geo.printForm.outputFormat")),w.xp6(2),w.Q6J("ngForOf",w.lcZ(35,50,t.outputFormats)),w.xp6(2),w.Udp("display",t.isPrintService?"block":"none"),w.xp6(2),w.s9C("placeholder",w.lcZ(39,52,"igo.geo.printForm.paperFormat")),w.xp6(2),w.Q6J("ngForOf",w.lcZ(41,54,t.paperFormats)),w.xp6(2),w.Udp("display",t.isPrintService?"none":"block"),w.xp6(2),w.s9C("placeholder",w.lcZ(45,56,"igo.geo.printForm.imageFormat")),w.xp6(2),w.Q6J("ngForOf",w.lcZ(47,58,t.imageFormats)),w.xp6(4),w.s9C("placeholder",w.lcZ(51,60,"igo.geo.printForm.resolution")),w.xp6(2),w.Q6J("ngForOf",w.lcZ(53,62,t.resolutions)),w.xp6(2),w.Udp("display",t.isPrintService?"block":"none"),w.xp6(2),w.s9C("placeholder",w.lcZ(57,64,"igo.geo.printForm.orientation")),w.xp6(2),w.Q6J("ngForOf",w.lcZ(59,66,t.orientations)),w.xp6(3),w.Q6J("disabled",!t.form.valid||w.lcZ(62,68,t.disabled$)),w.xp6(2),w.hij(" ",w.lcZ(64,70,"igo.geo.printForm.saveBtn")," "))},directives:[We._Y,We.JL,We.sg,Ye.KE,ot.Nt,We.Fj,We.JJ,We.u,Cl.Rr,ze.gD,F.sg,S.lW,Ve.ey],pipes:[ae.X$,sn,F.Ov],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}.print-slide-toggle-container[_ngcontent-%COMP%]{overflow-x:hidden}.print-slide-toggle-container[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{width:100%;margin:10px}.print-slide-toggle-container[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]     .mat-slide-toggle-content{width:calc(100% - 60px)}.print-option[_ngcontent-%COMP%]{display:block;margin-right:10px;margin-bottom:15px}.print-button-top-padding[_ngcontent-%COMP%]{padding-top:25px}.igo-form[_ngcontent-%COMP%]{padding:10px 5px 5px}.igo-form-button-group[_ngcontent-%COMP%]{text-align:center}"]}),e}(),hb=function(){var e=function(){function e(t){m(this,e),this.printService=t,this.disabled$=new R.X(!1)}return y(e,[{key:"map",get:function(){return this._map},set:function(e){this._map=e}},{key:"outputFormat",get:function(){return this._outputFormat},set:function(e){this._outputFormat=e}},{key:"paperFormat",get:function(){return this._paperFormat},set:function(e){this._paperFormat=e}},{key:"orientation",get:function(){return this._orientation},set:function(e){this._orientation=e}},{key:"imageFormat",get:function(){return this._imageFormat},set:function(e){this._imageFormat=e}},{key:"legendPosition",get:function(){return this._legendPosition},set:function(e){this._legendPosition=e}},{key:"resolution",get:function(){return this._resolution},set:function(e){this._resolution=e}},{key:"handleFormSubmit",value:function(e){var t=this;if(this.disabled$.next(!0),!0===e.isPrintService)this.printService.print(this.map,e).pipe((0,Ge.q)(1)).subscribe(function(){t.disabled$.next(!1)});else{var i=1;e.showLegend&&i++,"tiff"===e.imageFormat.toLowerCase()&&i++,this.printService.defineNbFileToProcess(i);var o=+e.resolution,n=e.showLegend?2:1;this.printService.downloadMapImage(this.map,o,e.imageFormat,e.showProjection,e.showScale,e.showLegend,e.title,e.subtitle,e.comment,e.doZipFile).pipe((0,Ge.q)(1)).subscribe(function(){--n||t.disabled$.next(!1)}),e.showLegend&&this.printService.getLayersLegendImage(this.map,e.imageFormat,e.doZipFile,+o).then(function(){--n||t.disabled$.next(!1)})}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ky))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-print"]],inputs:{map:"map",outputFormat:"outputFormat",paperFormat:"paperFormat",orientation:"orientation",imageFormat:"imageFormat",legendPosition:"legendPosition",resolution:"resolution"},decls:1,vars:7,consts:[[3,"outputFormat","paperFormat","orientation","imageFormat","resolution","legendPosition","disabled$","submit"]],template:function(e,t){1&e&&(w.TgZ(0,"igo-print-form",0),w.NdJ("submit",function(e){return t.handleFormSubmit(e)}),w.qZA()),2&e&&w.Q6J("outputFormat",t.outputFormat)("paperFormat",t.paperFormat)("orientation",t.orientation)("imageFormat",t.imageFormat)("resolution",t.resolution)("legendPosition",t.legendPosition)("disabled$",t.disabled$)},directives:[db],encapsulation:2}),e}(),gb=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,We.u5,We.UX,k.Ps,S.ot,ze.LD,Ve.Ng,ot.c,Ye.lN,Cl.rP,Se,ln]]}),e}();function fb(e){return new Sp(e.getConfig("searchSources.".concat(Sp.id))||{})}var mb=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[{provide:xp,useFactory:fb,multi:!0,deps:[he]}]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({providers:[vp],imports:[[F.ez]]}),e}(),vb=function e(){m(this,e)},yb=function e(t){m(this,e),this.sources=t};function bb(e){return new yb(e)}var wb=function(){return(e=wb||(wb={}))[e.GeoJSON=0]="GeoJSON",e[e.JSON=1]="JSON",wb;var e}(),xb=function(){return(e=xb||(xb={})).Route="route",e.Trip="trip",xb;var e}(),Sb=function(){return(e=Sb||(Sb={})).Coord="coord",e.Text="text",Sb;var e}(),kb=function(){return(e=kb||(kb={})).Stop="stop",e.Route="route",e.Vertex="vertex",kb;var e}(),Cb=function(){return(e=Cb||(Cb={})).Start="start",e.Intermediate="intermediate",e.End="end",Cb;var e}();function Tb(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"position";e.view.sort({direction:t,valueAccessor:function(e){return e[i]}})}function Ab(e,t){var i=Cb.Intermediate;return 0===e?i=Cb.Start:e===t-1&&(i=Cb.End),i}function Lb(e){var t,i=oe(),o=e.all();t=0===e.count?[0]:o.map(function(e){return e.position});var n=Math.max.apply(Math,d(t)),r=n,a=n+1,s=e.all().find(function(e){return e.position===n});return s&&(s.position=a,s.relativePosition=Ab(a,e.count+1)),e.insert({id:i,position:r,relativePosition:Ab(r,e.count+1)}),Tb(e),e.get(i)}function Zb(e,t){var i=[new ms.ZP({geometry:e.getGeometry(),image:new xs.Z({radius:7,stroke:new ws.Z({color:"#FF0000",width:3})})})],o=Lu({text:e.get("stopText"),opacity:e.get("stopOpacity"),markerColor:e.get("stopColor"),markerOutlineColor:[255,255,255]}),n=[new ms.ZP({stroke:new ws.Z({color:"rgba(106, 121, 130, ".concat(e.get("active")?.75:0,")"),width:10})}),new ms.ZP({stroke:new ws.Z({color:"rgba(79, 169, 221, ".concat(e.get("active")?.75:0,")"),width:6})})];return e.get("type")===kb.Stop?o:"vertex"===e.get("type")?i:e.get("type")===kb.Route?n:void 0}function Fb(e){if(0!==e)return e>=1e5?ee.roundToNDecimal(Math.round(e)/1e3,1)+" km":e>=1e4||e>=1e3?ee.roundToNDecimal(Math.round(e)/100/10,1)+" km":ee.roundToNDecimal(e,0)+" m"}function Ob(e){if(e>=3600){var t=Math.floor(e/3600),i=Math.round(60*(e/3600-t));return 60===i?t+1+" h":t+" h "+i+" min"}return e>=60?Math.round(e/60)+" min":e+" s"}function Mb(e,t,i,o,n,r,a){var s,l=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=a.translate,u="forward",p="rotate-270",d=function(e,t){var i=t.translate;return e>=337||e<23?i.instant("igo.geo.cardinalPoints.n"):e<67?i.instant("igo.geo.cardinalPoints.ne"):e<113?i.instant("igo.geo.cardinalPoints.e"):e<157?i.instant("igo.geo.cardinalPoints.se"):e<203?i.instant("igo.geo.cardinalPoints.s"):e<247?i.instant("igo.geo.cardinalPoints.sw"):e<293?i.instant("igo.geo.cardinalPoints.w"):e<337?i.instant("igo.geo.cardinalPoints.nw"):void 0}(o,a),h=function(e,t){var i=t.translate;return"uturn"===e?i.instant("igo.geo.directions.uturn"):"sharp right"===e?i.instant("igo.geo.directions.sharp right"):"right"===e?i.instant("igo.geo.directions.right"):"slight right"===e?i.instant("igo.geo.directions.slight right"):"sharp left"===e?t.translate.instant("igo.geo.directions.sharp left"):"left"===e?t.translate.instant("igo.geo.directions.left"):"slight left"===e?t.translate.instant("igo.geo.directions.slight left"):"straight"===e?t.translate.instant("igo.geo.directions.straight"):e}(t,a),g=("straight"===t?"":c.instant("igo.geo.directions.modifier.prefix"))+h;if((null==t?void 0:t.search("slight"))>=0&&(g=h),"uturn"===t?(u="forward",p="rotate-90"):"sharp right"===t||"right"===t?(u="subdirectory-arrow-right",p="icon-flipped"):"slight right"===t?(u="forward",p="rotate-290"):"straight"===t?u="forward":"slight left"===t?(u="forward",p="rotate-250"):("left"===t||"sharp left"===t)&&(u="subdirectory-arrow-left",p="icon-flipped"),"turn"===e)s="straight"===t?c.instant("igo.geo.directions.turn.straight",{route:i}):"uturn"===t?c.instant("igo.geo.directions.turn.uturn",{route:i}):c.instant("igo.geo.directions.turn.else",{route:i,aggregatedDirection:g,translatedModifier:h});else if("new name"===e)s=c.instant("igo.geo.directions.new name",{route:i,translatedDirection:d}),u="compass",p="";else if("depart"===e)s=c.instant("igo.geo.directions.depart",{route:i,translatedDirection:d}),u="compass",p="";else if("arrive"===e)l?(g=h?g:"",s=c.instant("igo.geo.directions.arrive.lastStep",{coma:h?", ":"",aggregatedDirection:g})):(s=c.instant("igo.geo.directions.arrive.intermediate",{route:i}),u="map-marker",p="");else if("merge"===e)s=c.instant("igo.geo.directions.merge",{route:i}),u="forward",p="rotate-270";else if("on ramp"===e)s=c.instant("igo.geo.directions.on ramp",{aggregatedDirection:g});else if("off ramp"===e)s=c.instant("igo.geo.directions.off ramp",{aggregatedDirection:g});else if("fork"===e)s=t.search("left")>=0?c.instant("igo.geo.directions.fork.left",{route:i}):t.search("right")>=0?c.instant("igo.geo.directions.fork.right",{route:i}):c.instant("igo.geo.directions.fork.else",{route:i});else if("end of road"===e)s=c.instant("igo.geo.directions.end of road",{translatedModifier:h,route:i});else if("use lane"===e)s=c.instant("igo.geo.directions.use lane");else if("continue"===e&&"uturn"!==t)s=c.instant("igo.geo.directions.continue.notUturn",{route:i}),u="forward",p="rotate-270";else if("roundabout"===e){var f=c.instant(1===r?"igo.geo.directions.cntSuffix.first":"igo.geo.directions.cntSuffix.secondAndMore");s=c.instant("igo.geo.directions.roundabout",{exit:r,cntSuffix:f,route:i}),u="chart-donut",p=""}else"rotary"===e?(s=c.instant("igo.geo.directions.rotary"),u="chart-donut",p=""):"roundabout turn"===e?(s=c.instant("igo.geo.directions.roundabout turn"),u="chart-donut",p=""):"exit roundabout"===e?(s=c.instant("igo.geo.directions.exit roundabout",{route:i}),u="forward",p="rotate-270"):s="notification"===e?c.instant("igo.geo.directions.notification"):"uturn"===t?c.instant("igo.geo.directions.uturnText",{translatedDirection:d,route:i}):c.instant("igo.geo.directions.unknown");return u=l?"flag-variant":u,p=l?"":p,{instruction:s,image:u=0===n?"compass":u,cssClass:p=0===n?"":p}}function Ib(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",10),w.NdJ("click",function(){w.CHM(i);var e=w.oxw().$implicit;return w.oxw().clearStop(e)}),w.ALo(1,"translate"),w._UZ(2,"mat-icon",11),w.qZA()}2&e&&w.Q6J("matTooltip",w.lcZ(1,1,"igo.geo.directionsForm.clearStop"))}function Pb(e,t){if(1&e&&(w.TgZ(0,"mat-option",14),w._uU(1),w.qZA()),2&e){var i=t.$implicit;w.Q6J("value",i)("matTooltip",i.meta?i.meta.title:""),w.xp6(1),w.hij(" ",i.meta?i.meta.title:""," ")}}function _b(e,t){if(1&e&&(w.TgZ(0,"mat-optgroup",12),w.YNc(1,Pb,2,3,"mat-option",13),w.qZA()),2&e){var i=t.$implicit;w.Q6J("label",i.source.title)("disabled",!1===i.source.enabled),w.xp6(1),w.Q6J("ngForOf",i.results)}}function qb(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",20),w.NdJ("click",function(){w.CHM(i);var e=w.oxw(2).$implicit;return w.oxw().removeStop(e)}),w.ALo(1,"translate"),w._UZ(2,"mat-icon",21),w.qZA()}2&e&&w.Q6J("matTooltip",w.lcZ(1,1,"igo.geo.directionsForm.removeStop"))}function Db(e,t){1&e&&(w.TgZ(0,"button",22),w.ALo(1,"translate"),w._UZ(2,"mat-icon",23),w.qZA()),2&e&&w.Q6J("matTooltip",w.lcZ(1,1,"igo.geo.directionsForm.removeStop"))}function Eb(e,t){if(1&e&&(w.TgZ(0,"div",15),w.TgZ(1,"button",16),w.ALo(2,"translate"),w._UZ(3,"mat-icon",17),w.qZA(),w.YNc(4,qb,3,3,"button",18),w.ALo(5,"async"),w.YNc(6,Db,3,3,"button",19),w.ALo(7,"async"),w.qZA()),2&e){var i=w.oxw(2);w.xp6(1),w.Q6J("matTooltip",w.lcZ(2,3,"igo.geo.directionsForm.moveStop")),w.xp6(3),w.Q6J("ngIf",w.lcZ(5,5,i.stopsStore.count$)>2),w.xp6(2),w.Q6J("ngIf",w.lcZ(7,7,i.stopsStore.count$)<=2)}}function $b(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",2),w.NdJ("touchenter",function(){var e=w.CHM(i).$implicit;return w.oxw().onStopEnter(e)})("touchleave",function(){return w.CHM(i),w.oxw().onStopLeave()})("mouseover",function(){var e=w.CHM(i).$implicit;return w.oxw().onStopEnter(e)})("mouseleave",function(){return w.CHM(i),w.oxw().onStopLeave()})("cdkDragStarted",function(){return w.CHM(i),w.oxw().stopIsDragged=!0})("cdkDragEnded",function(){return w.CHM(i),w.oxw().stopIsDragged=!1}),w.TgZ(1,"div",3),w.TgZ(2,"mat-form-field"),w.TgZ(3,"input",4),w.NdJ("focus",function(){var e=w.CHM(i).$implicit;return w.oxw().onInputFocus(e)})("ngModelChange",function(e){return w.CHM(i).$implicit.text=e})("keyup",function(e){var t=w.CHM(i).$implicit;return w.oxw().setStopText(e,t)})("keydown.enter",function(e){return e.preventDefault()}),w.qZA(),w.YNc(4,Ib,3,3,"button",5),w.TgZ(5,"mat-autocomplete",6,7),w.NdJ("optionSelected",function(e){var t=w.CHM(i).$implicit;return w.oxw().chooseProposal(e,t)}),w.YNc(7,_b,2,3,"mat-optgroup",8),w.qZA(),w.qZA(),w.qZA(),w.YNc(8,Eb,8,9,"div",9),w.qZA()}if(2&e){var o=t.$implicit,n=w.MAs(6),r=w.oxw();w.xp6(1),w.Q6J("ngClass",r.getNgClass(o)),w.xp6(2),w.s9C("id",o.id),w.Q6J("placeholder",r.getPlaceholder(o))("matTooltip",o.text)("ngModel",o.text)("matAutocomplete",n),w.xp6(1),w.Q6J("ngIf",(o.text||o.coordinates)&&r.stopWithHover&&o.id===r.stopWithHover.id),w.xp6(1),w.Q6J("displayWith",r.getOptionText),w.xp6(2),w.Q6J("ngForOf",o.searchProposals),w.xp6(1),w.Q6J("ngIf",!r.stopIsDragged&&r.stopWithHover&&o.id===r.stopWithHover.id)}}var Rb=function(){var e=function(){function e(t){m(this,e),this.languageService=t,this.invalidKeys=["Control","Shift","Alt"],this.onMapClickEventKeys=[],this.stopIsDragged=!1,this.coordRoundedDecimals=6,this.debounce=200,this.length=2,this.stopInputHasFocus=new w.vpe(!1)}return y(e,[{key:"ngOnDestroy",value:function(){this.unlistenMapSingleClick()}},{key:"onStopEnter",value:function(e){this.stopWithHover=e}},{key:"onStopLeave",value:function(){this.stopWithHover=void 0}},{key:"getOptionText",value:function(e){return e instanceof Object?(null==e?void 0:e.meta)?e.meta.title:"":e}},{key:"chooseProposal",value:function(e,t){var i=e.option.value;if(i){var o,n=i.geometry;if("Point"===n.type)o=n.coordinates;else{var r=(0,Pl.Z)(i.geometry);o=[r.geometry.coordinates[0],r.geometry.coordinates[1]]}o&&(t.coordinates=o,t.text=i.meta.title,this.stopsStore.update(t))}}},{key:"setStopText",value:function(e,t){this.unlistenMapSingleClick();var i=e.target.value;0===i.length?this.clearStop(t):this.validateTerm(i)&&(t.text=i,this.stopsStore.update(t))}},{key:"validateTerm",value:function(e){return!(!this.keyIsValid(e)||!(e.length>=this.length||0===e.length))}},{key:"keyIsValid",value:function(e){return void 0===this.invalidKeys.find(function(t){return t===e})}},{key:"getNgClass",value:function(e){return this.stopWithHover&&e.id===this.stopWithHover.id?"igo-input-container reduce":"igo-input-container"}},{key:"getPlaceholder",value:function(e){var t="";return e.relativePosition?(e.relativePosition===Cb.Intermediate&&(t=" #"+e.position),this.languageService.translate.instant("igo.geo.directionsForm."+e.relativePosition)+t):""}},{key:"removeStop",value:function(e){!function(e,t){e.delete(t),function(e){var t=d(e.all());t.sort(function(e,t){return e.position-t.position}),t.map(function(e,i){e.position=i,e.relativePosition=Ab(e.position,t.length)}),t&&e.updateMany(t)}(e)}(this.stopsStore,e)}},{key:"clearStop",value:function(e){this.stopsStore.update({id:e.id,relativePosition:e.relativePosition,position:e.position})}},{key:"drop",value:function(e){this.moveStops(e.previousIndex,e.currentIndex)}},{key:"moveStops",value:function(e,t){if(e!==t){var i=d(this.stopsStore.view.all());(0,Ql.bA)(i,e,t),i.map(function(e,t){e.relativePosition=Ab(t,i.length),e.position=t}),this.stopsStore.updateMany(i),Tb(this.stopsStore)}}},{key:"onInputFocus",value:function(e){var t;(!e.text||0===(null===(t=e.text)||void 0===t?void 0:t.length))&&(this.unlistenMapSingleClick(),this.stopInputHasFocus.emit(!0),this.listenMapSingleClick(e))}},{key:"listenMapSingleClick",value:function(e){var t=this,i=this.stopsFeatureStore.layer.map.ol.once("singleclick",function(i){var o=Jc(ls.vs(i.coordinate,t.stopsFeatureStore.layer.map.projection,t.projection),t.coordRoundedDecimals);e.text=o.join(","),e.coordinates=o,t.stopsStore.update(e),setTimeout(function(){t.stopInputHasFocus.emit(!1)},500)});this.onMapClickEventKeys.push(i)}},{key:"unlistenMapSingleClick",value:function(){this.onMapClickEventKeys.map(function(e){Os.B(e)}),this.onMapClickEventKeys=[]}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ce))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-directions-inputs"]],inputs:{stopsStore:"stopsStore",stopsFeatureStore:"stopsFeatureStore",projection:"projection",coordRoundedDecimals:"coordRoundedDecimals",debounce:"debounce",length:"length"},outputs:{stopInputHasFocus:"stopInputHasFocus"},decls:3,vars:3,consts:[["cdkDropList","",1,"stops-list",3,"cdkDropListDropped"],["touchleave","","cdkDragLockAxis","y","class","stop-box mat-typography","cdkDrag","",3,"touchenter","touchleave","mouseover","mouseleave","cdkDragStarted","cdkDragEnded",4,"ngFor","ngForOf"],["touchleave","","cdkDragLockAxis","y","cdkDrag","",1,"stop-box","mat-typography",3,"touchenter","touchleave","mouseover","mouseleave","cdkDragStarted","cdkDragEnded"],[3,"ngClass"],["type","text","matTooltipShowDelay","500","aria-label","Number","matInput","",3,"id","placeholder","matTooltip","ngModel","matAutocomplete","focus","ngModelChange","keyup","keydown.enter"],["mat-button","","matTooltipShowDelay","500","matSuffix","","mat-icon-button","","color","warn","aria-label","Clear",3,"matTooltip","click",4,"ngIf"],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"label","disabled",4,"ngFor","ngForOf"],["class","igo-form-button-group",4,"ngIf"],["mat-button","","matTooltipShowDelay","500","matSuffix","","mat-icon-button","","color","warn","aria-label","Clear",3,"matTooltip","click"],["svgIcon","close"],[3,"label","disabled"],["matTooltipShowDelay","500",3,"value","matTooltip",4,"ngFor","ngForOf"],["matTooltipShowDelay","500",3,"value","matTooltip"],[1,"igo-form-button-group"],["cdkDragHandle","","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","primary",1,"swipe-vertical",3,"matTooltip"],["svgIcon","gesture-swipe-vertical"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip","click",4,"ngIf"],["disabled","true","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip","click"],["svgIcon","delete"],["disabled","true","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip"],["svgIcon","blank"]],template:function(e,t){1&e&&(w.TgZ(0,"div",0),w.NdJ("cdkDropListDropped",function(e){return t.drop(e)}),w.YNc(1,$b,9,10,"div",1),w.ALo(2,"async"),w.qZA()),2&e&&(w.xp6(1),w.Q6J("ngForOf",w.lcZ(2,1,t.stopsStore.view.all$())))},directives:[Ql.Wj,F.sg,Ql.Zt,F.mk,Ye.KE,ot.Nt,We.Fj,tt.ZL,L.gM,We.JJ,We.On,F.O5,tt.XC,S.lW,Ye.R9,k.Hw,Ve.Nv,Ve.ey,Ql.Bh],pipes:[F.Ov,ae.X$],styles:[".igo-input-container[_ngcontent-%COMP%]{width:100%}.igo-input-container[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.igo-input-container.reduce[_ngcontent-%COMP%]{width:70%}.igo-input-container.reduce[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.stops-list[_ngcontent-%COMP%]{max-width:100%;min-height:60px;display:block;background:white;border-radius:4px;overflow:hidden;padding:20px 10px}.swipe-vertical[_ngcontent-%COMP%]{cursor:move}.stop-box[_ngcontent-%COMP%]{height:60px;padding:20px 10px;color:#000000de;display:flex;flex-direction:row;align-items:center;justify-content:space-between;box-sizing:border-box;background:white}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.stops-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .stop-box[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"]}),e}(),Nb=function(){var e=function(){function e(t){m(this,e),this.directionsSourceService=t}return y(e,[{key:"route",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0!==e.length)return this.directionsSourceService.sources.filter(function(e){return e.enabled}).map(function(o){return t.routeSource(o,e,i)})}},{key:"routeSource",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e.route(t,i)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(yb))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function Ub(e){return void 0!==e.search}function Jb(e){return void 0!==e.reverseSearch}function Bb(e){return void 0!==e.reverseSearch&&!0===e.showInPointerSummary}function jb(e,t){var i="";return t.split("").forEach(function(t,o){t!==e.charAt(o)&&(i+=t)}),i}function Qb(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e||!t)return 0;var o=i?e:e.toLowerCase(),n=i?t:t.toLowerCase(),r=jb(o,n)+jb(n,o),a=0;return r.length&&(a=r.length/o.length*100),100-Math.floor(a)}var Gb=function(){function e(t){m(this,e),this.sources=t}return y(e,[{key:"getSources",value:function(){return this.sources}},{key:"getEnabledSources",value:function(){return this.getSources().filter(function(e){return!0===e.enabled})}},{key:"enableSourcesByType",value:function(e){this.getSources().forEach(function(t){t.enabled=t.constructor.type===e})}},{key:"setParamFromSetting",value:function(e,t){e.setParamFromSetting(t)}}]),e}(),Yb=function(){var e=function(){function e(t,i){m(this,e),this.searchSourceService=t,this.mapService=i}return y(e,[{key:"search",value:function(e){var t,i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.termIsValid(e))return[];var n,r=Ec(e,(null===(t=this.mapService.getMap())||void 0===t?void 0:t.projection)||"EPSG:3857",{forceNA:o.forceNA});return r.lonLat?this.reverseSearch(r.lonLat,{distance:r.radius,conf:r.conf}):(r.message&&console.log(r.message),o.extent=null===(i=this.mapService.getMap())||void 0===i?void 0:i.viewController.getExtent("EPSG:4326"),n=o.getEnabledOnly||void 0===o.getEnabledOnly?this.searchSourceService.getEnabledSources():this.searchSourceService.getSources(),o.sourceId?n=n.filter(function(e){return e.getId()===o.sourceId}):o.searchType&&(n=n.filter(function(e){return e.getType()===o.searchType})),n=n.filter(Ub),this.searchSources(n,e,o))}},{key:"reverseSearch",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=i?Bb:Jb,n=this.searchSourceService.getEnabledSources().filter(o);return this.reverseSearchSources(n,e,t||{})}},{key:"searchSources",value:function(e,t,i){return e.map(function(e){return{request:e.search(t,i),reverse:!1,source:e}})}},{key:"reverseSearchSources",value:function(e,t,i){return e.map(function(e){return{request:e.reverseSearch(t,i),reverse:!0,source:e}})}},{key:"termIsValid",value:function(e){return"string"==typeof e&&""!==e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(Gb),w.LFG(su))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function zb(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",5),w.NdJ("click",function(){return w.CHM(i),w.oxw().resetStops()}),w.ALo(1,"translate"),w._UZ(2,"mat-icon",6),w.qZA()}2&e&&w.Q6J("matTooltip",w.lcZ(1,1,"igo.geo.directionsForm.resetDirectionsBtn"))}function Vb(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",1),w.NdJ("click",function(){return w.CHM(i),w.oxw().zoomRoute()}),w.ALo(1,"translate"),w._UZ(2,"mat-icon",7),w.qZA()}2&e&&w.Q6J("matTooltip",w.lcZ(1,1,"igo.geo.directionsForm.zoomRoute"))}function Hb(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",1),w.NdJ("click",function(){return w.CHM(i),w.oxw().copyDirectionsToClipboard()}),w.ALo(1,"translate"),w._UZ(2,"mat-icon",8),w.qZA()}2&e&&w.Q6J("matTooltip",w.lcZ(1,1,"igo.geo.directionsForm.copy"))}function Wb(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",1),w.NdJ("click",function(){return w.CHM(i),w.oxw().copyLinkToClipboard()}),w.ALo(1,"translate"),w._UZ(2,"mat-icon",9),w.qZA()}2&e&&w.Q6J("matTooltip",w.lcZ(1,1,"igo.geo.directionsForm.link"))}var Xb=function(){var e=function(){function e(t,i,o){m(this,e),this.languageService=t,this.messageService=i,this.route=o,this.zoomToActiveRoute$=new Q.xQ}return y(e,[{key:"activeRoute",get:function(){return this.routesFeatureStore.all().find(function(e){return e.properties.active})}},{key:"resetStops",value:function(){this.stopsStore.clearStops()}},{key:"addStop",value:function(){Lb(this.stopsStore)}},{key:"copyLinkToClipboard",value:function(){if(V.copy(this.getUrl())){var e=this.languageService.translate,t=e.instant("igo.geo.directionsForm.dialog.copyTitle"),i=e.instant("igo.geo.directionsForm.dialog.copyMsgLink");this.messageService.success(i,t)}}},{key:"zoomRoute",value:function(){this.zoomToActiveRoute$.next()}},{key:"copyDirectionsToClipboard",value:function(){var e=this.directionsToText();if(V.copy(e)){var t=this.languageService.translate,i=t.instant("igo.geo.directionsForm.dialog.copyTitle"),o=t.instant("igo.geo.directionsForm.dialog.copyMsg");this.messageService.success(o,i)}}},{key:"directionsToText",value:function(){var e=this,t="\t",i=this.languageService.translate.instant("igo.geo.directionsForm.instructions")+":\n",o="",n=this.languageService.translate.instant("igo.geo.directionsForm.summary")+": \n"+t+this.activeRoute.properties.direction.title+"\n"+t+Fb(this.activeRoute.properties.direction.distance)+"\n"+t+Ob(this.activeRoute.properties.direction.duration)+"\n\n"+this.languageService.translate.instant("igo.geo.directionsForm.stopsList")+":\n",r=this.languageService.translate.instant("igo.geo.directionsForm.link")+":\n"+t+this.getUrl(),a=1;this.stopsStore.view.all().forEach(function(e){var i="",n="";e.text!==Jc(e.coordinates).join(",")?(n=e.text,i=" ( ".concat(Jc(e.coordinates).join(",")," )")):n=Jc(e.coordinates).join(","),o=o+t+a.toLocaleString()+". "+n+i+"\n",a++});var s=0;return this.activeRoute.properties.direction.steps.forEach(function(o){var n=e.formatStep(o,s).instruction,r=void 0===Fb(o.distance)?"":" ("+Fb(o.distance)+")";i=i+t+(s+1).toLocaleString()+". "+n+r+"\n",s++}),n+o+"\n"+r+"\n\n"+i}},{key:"formatStep",value:function(e,t){return Mb(e.maneuver.type,e.maneuver.modifier,e.name,e.maneuver.bearing_after,t,e.maneuver.exit,this.languageService,t===this.activeRoute.properties.direction.steps.length-1)}},{key:"getUrl",value:function(){if(this.route){var e="";this.contextUri&&(e="context=".concat(this.contextUri,"&"));var t=this.routesFeatureStore.all().map(function(e){return e.properties.id}).indexOf(this.activeRoute.properties.id),i="";0!==t&&(i="&".concat(this.route.options.directionsOptionsKey,"=result:").concat(t));var o=this.route.options.directionsCoordKey,n=this.stopsStore.view.all().map(function(e){return Jc(e.coordinates,6)}),r="";return n.length>=2?(r="".concat(o,"=").concat(n.join(";")),"".concat(location.origin).concat(location.pathname,"?").concat(e,"tool=directions&sidenav=1&").concat(r).concat(i)):void 0}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ce),w.Y36(Ae),w.Y36(Oe,8))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-directions-buttons"]],inputs:{contextUri:"contextUri",zoomToActiveRoute$:"zoomToActiveRoute$",stopsStore:"stopsStore",routesFeatureStore:"routesFeatureStore"},decls:13,vars:17,consts:[[1,"igo-form-button-group"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","primary",3,"matTooltip","click"],["svgIcon","map-marker-plus"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","primary",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500","color","warn",3,"matTooltip","click"],["svgIcon","file-restore"],["svgIcon","magnify-plus-outline"],["svgIcon","content-copy"],["svgIcon","link"]],template:function(e,t){1&e&&(w.TgZ(0,"div",0),w.TgZ(1,"button",1),w.NdJ("click",function(){return t.addStop()}),w.ALo(2,"translate"),w._UZ(3,"mat-icon",2),w.qZA(),w.YNc(4,zb,3,3,"button",3),w.ALo(5,"async"),w.ALo(6,"async"),w.YNc(7,Vb,3,3,"button",4),w.ALo(8,"async"),w.YNc(9,Hb,3,3,"button",4),w.ALo(10,"async"),w.YNc(11,Wb,3,3,"button",4),w.ALo(12,"async"),w.qZA()),2&e&&(w.xp6(1),w.Q6J("matTooltip",w.lcZ(2,5,"igo.geo.directionsForm.addStop")),w.xp6(3),w.Q6J("ngIf",w.lcZ(5,7,t.routesFeatureStore.count$)>=1||w.lcZ(6,9,t.stopsStore.count$)>=1),w.xp6(3),w.Q6J("ngIf",w.lcZ(8,11,t.routesFeatureStore.count$)>=1),w.xp6(2),w.Q6J("ngIf",w.lcZ(10,13,t.routesFeatureStore.count$)>=1),w.xp6(2),w.Q6J("ngIf",w.lcZ(12,15,t.routesFeatureStore.count$)>=1))},directives:[S.lW,L.gM,k.Hw,F.O5],pipes:[ae.X$,F.Ov],styles:[""]}),e}();function Kb(e,t){if(1&e&&(w.TgZ(0,"mat-option",9),w._uU(1),w.qZA()),2&e){var i=t.$implicit,o=t.index,n=w.oxw(3);w.Q6J("value",i),w.xp6(1),w.lnq(" Option ",o+1," : ",n.formatDistance(i.distance)," (",n.formatDuration(i.duration),") ")}}function ew(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-form-field"),w.TgZ(1,"mat-select",7),w.NdJ("selectionChange",function(){return w.CHM(i),w.oxw(2).changeRoute()})("ngModelChange",function(e){return w.CHM(i),w.oxw(2).activeDirection=e}),w.ALo(2,"translate"),w.YNc(3,Kb,2,4,"mat-option",8),w.qZA(),w.qZA()}if(2&e){var o=w.oxw(2);w.xp6(1),w.s9C("placeholder",w.lcZ(2,3,"igo.geo.directionsForm.drivingOptions")),w.Q6J("ngModel",o.activeDirection),w.xp6(2),w.Q6J("ngForOf",o.directions)}}function tw(e,t){1&e&&w._UZ(0,"mat-divider")}function iw(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-list-item",10),w.NdJ("mouseenter",function(){var e=w.CHM(i).$implicit;return w.oxw(2).showSegment(e)})("click",function(){var e=w.CHM(i).$implicit;return w.oxw(2).showSegment(e,!0)}),w._UZ(1,"mat-icon",11),w.TgZ(2,"h4",12),w._uU(3),w.qZA(),w.TgZ(4,"h4",13),w._uU(5),w.qZA(),w.qZA()}if(2&e){var o=t.$implicit,n=t.index,r=w.oxw(2);w.xp6(1),w.s9C("svgIcon",r.formatStep(o,n).image),w.Q6J("ngClass",r.formatStep(o,n).cssClass),w.xp6(2),w.AsE("",n+1,". ",r.formatStep(o,n).instruction,""),w.xp6(2),w.Oqu(r.formatDistance(o.distance))}}function ow(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",1),w.YNc(1,ew,4,5,"mat-form-field",2),w.YNc(2,tw,1,0,"mat-divider",2),w.TgZ(3,"mat-list",3),w.NdJ("mouseleave",function(){return w.CHM(i),w.oxw().onStepsListBlur()}),w.TgZ(4,"h2",4),w._uU(5),w.qZA(),w.TgZ(6,"h2",5),w._uU(7),w.qZA(),w.YNc(8,iw,6,5,"mat-list-item",6),w._UZ(9,"mat-divider"),w.qZA(),w.qZA()}if(2&e){var o=w.oxw();w.xp6(1),w.Q6J("ngIf",o.directions&&o.directions.length>1),w.xp6(1),w.Q6J("ngIf",o.directions&&0===o.directions.length),w.xp6(3),w.Oqu(o.activeDirection.title),w.xp6(2),w.AsE("",o.formatDistance(o.activeDirection.distance),", ",o.formatDuration(o.activeDirection.duration),""),w.xp6(1),w.Q6J("ngForOf",o.activeDirection.steps)}}var nw=function(){var e=function(){function e(t,i){m(this,e),this.languageService=t,this.cdRef=i}return y(e,[{key:"ngOnInit",value:function(){var e=this;this.entities$$=this.routesFeatureStore.entities$.pipe((0,E.b)(200)).subscribe(function(t){var i=t.find(function(e){return e.properties.active});e.directions=t.map(function(e){return e.properties.direction}),e.activeDirection=i?i.properties.direction:void 0,e.cdRef.detectChanges()})}},{key:"ngOnDestroy",value:function(){this.entities$$.unsubscribe()}},{key:"changeRoute",value:function(){this.routesFeatureStore.entities$.value.map(function(e){return e.properties.active=!e.properties.active}),this.routesFeatureStore.layer.ol.getSource().getFeatures().map(function(e){return e.set("active",!e.get("active"))})}},{key:"formatDistance",value:function(e){return Fb(e)}},{key:"formatDuration",value:function(e){return Ob(e)}},{key:"formatStep",value:function(e,t){return Mb(e.maneuver.type,e.maneuver.modifier,e.name,e.maneuver.bearing_after,t,e.maneuver.exit,this.languageService,t===this.activeDirection.steps.length-1)}},{key:"onStepsListBlur",value:function(){this.stepFeatureStore.clear()}},{key:"showSegment",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.showRouteSegmentGeometry(e,t)}},{key:"showRouteSegmentGeometry",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i="vertex",o=new Ls.Z(e.geometry.coordinates).transform("EPSG:4326",this.stepFeatureStore.layer.map.projection).getCoordinates()[0],n=new us.Z(o),r=new ns.Z({geometry:n}),a=(new Zs.Z).writeGeometryObject(n,{featureProjection:this.stepFeatureStore.layer.map.projection,dataProjection:this.stepFeatureStore.layer.map.projection}),s=this.stepFeatureStore.get(i);this.stepFeatureStore.update({type:ec,geometry:a,projection:this.stepFeatureStore.layer.map.projection,properties:{id:i,step:e,type:kb.Vertex},meta:{id:i,revision:(s?s.meta.revision:0)+1},ol:r}),t&&this.stepFeatureStore.layer.map.viewController.zoomToExtent(r.getGeometry().getExtent())}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ce),w.Y36(w.sBO))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-directions-results"]],inputs:{routesFeatureStore:"routesFeatureStore",stepFeatureStore:"stepFeatureStore"},decls:1,vars:1,consts:[["class","igo-input-container",4,"ngIf"],[1,"igo-input-container"],[4,"ngIf"],[3,"mouseleave"],["mat-header","",1,"igo-route-title","mat-typography"],["mat-subheader",""],["class","igo-steps","igoListItem","",3,"mouseenter","click",4,"ngFor","ngForOf"],[3,"placeholder","ngModel","selectionChange","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["igoListItem","",1,"igo-steps",3,"mouseenter","click"],["mat-list-icon","",3,"ngClass","svgIcon"],["mat-line",""],["mat-line","",1,"right"]],template:function(e,t){1&e&&w.YNc(0,ow,10,6,"div",0),2&e&&w.Q6J("ngIf",t.directions&&t.activeDirection)},directives:[F.O5,C.i$,C.gs,F.sg,kl.d,Ye.KE,ze.gD,We.JJ,We.On,Ve.ey,C.Tg,k.Hw,C.Nh,F.mk,Ve.X2],pipes:[ae.X$],styles:[".igo-input-container[_ngcontent-%COMP%]{width:100%;padding:20px 10px}.igo-input-container[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:70%}.igo-route-title[_ngcontent-%COMP%]{font-weight:bold}.igo-steps[_ngcontent-%COMP%]{cursor:pointer}.mat-line[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:pre-wrap!important}.mat-line.right[_ngcontent-%COMP%]{text-align:right}.rotate-90[_ngcontent-%COMP%]{transform:rotate(90deg)}.rotate-45[_ngcontent-%COMP%]{transform:rotate(45deg)}.rotate-270[_ngcontent-%COMP%]{transform:rotate(270deg)}.rotate-250[_ngcontent-%COMP%]{transform:rotate(250deg)}.rotate-290[_ngcontent-%COMP%]{transform:rotate(290deg)}.icon-flipped[_ngcontent-%COMP%]{transform:scaleY(-1)}"]}),e}(),rw=function(){var e=function(){function e(t,i,o,n,r){m(this,e),this.cdRef=t,this.languageService=i,this.directionsService=o,this.searchService=n,this.queryService=r,this.projection="EPSG:4326",this.routesQueries$$=[],this.focusOnStop=!1,this.isTranslating=!1,this.previousStops=[],this.searchs$$=[],this.debounce=200,this.length=2,this.coordRoundedDecimals=6,this.zoomToActiveRoute$=new Q.xQ}return y(e,[{key:"ngOnInit",value:function(){var e=this;this.queryService.queryEnabled=!1,this.initEntityStores(),setTimeout(function(){(function(e,t){var i=new xu({motion:tc.None});vu(e,new jc({isIgoInternalLayer:!0,id:"igo-direction-stops-layer",title:t.translate.instant("igo.geo.directionsForm.stopLayer"),zIndex:911,source:new _c,showInLayerList:!0,workspace:{enabled:!1},linkedLayers:{linkId:"igo-direction-stops-layer",links:[{bidirectionnal:!1,syncedDelete:!0,linkedIds:["igo-direction-route-layer"],properties:[]}]},exportable:!0,browsable:!1,style:Zb})),e.layer.visible=!0,Tu(e,i)})(e.stopsFeatureStore,e.languageService),function(e,t){var i=new xu({motion:tc.None});vu(e,new jc({isIgoInternalLayer:!0,id:"igo-direction-route-layer",title:t.translate.instant("igo.geo.directionsForm.routeLayer"),zIndex:910,source:new _c,showInLayerList:!0,workspace:{enabled:!1},linkedLayers:{linkId:"igo-direction-route-layer"},exportable:!0,browsable:!1,style:Zb})),e.layer.visible=!0,Tu(e,i)}(e.routesFeatureStore,e.languageService),function(e){var t=new xu({motion:tc.None});vu(e,new jc({isIgoInternalLayer:!0,id:"igo-direction-step-layer",title:"",zIndex:910,source:new _c,showInLayerList:!1,workspace:{enabled:!1},linkedLayers:{linkId:"igo-direction-route-layer"},exportable:!1,browsable:!1,style:Zb})),e.layer.visible=!0,Tu(e,t)}(e.stepFeatureStore),e.initOlInteraction()},1)}},{key:"ngOnDestroy",value:function(){this.queryService.queryEnabled=!0,this.storeEmpty$$.unsubscribe(),this.storeChange$$.unsubscribe(),this.routesQueries$$.map(function(e){return e.unsubscribe()}),this.zoomRoute$$.unsubscribe(),this.freezeStores()}},{key:"freezeStores",value:function(){this.stopsFeatureStore.layer.map.ol.removeInteraction(this.selectStopInteraction),this.stopsFeatureStore.layer.map.ol.removeInteraction(this.translateStop),this.routesFeatureStore.layer.map.ol.removeInteraction(this.selectedRoute),this.stopsFeatureStore.deactivateStrategyOfType(xu),this.routesFeatureStore.deactivateStrategyOfType(xu),this.stepFeatureStore.deactivateStrategyOfType(xu)}},{key:"initEntityStores",value:function(){this.watcher=new Lt(this.stopsStore,this.cdRef),this.monitorEmptyEntityStore(),this.monitorEntityStoreChange(),this.monitorActiveRouteZoom()}},{key:"monitorActiveRouteZoom",value:function(){var e=this;this.zoomRoute$$=this.zoomToActiveRoute$.subscribe(function(){if(e.routesFeatureStore.count>=1){var t=e.routesFeatureStore.all().find(function(e){return e.properties.active});if(t){t.ol.getGeometry();var i=t.ol.getGeometry().getExtent();e.routesFeatureStore.layer.map.viewController.zoomToExtent(i)}}})}},{key:"initOlInteraction",value:function(){var e=this;this.selectStopInteraction=new ds.Z({layers:[this.stopsFeatureStore.layer.ol],hitTolerance:7,condition:function(e){return"pointermove"===e.type&&!e.dragging}}),this.translateStop=new hs.Z({features:this.selectStopInteraction.getFeatures()}),this.translateStop.on("translating",function(t){e.isTranslating=!0,e.executeStopTranslation(t.features)}),this.translateStop.on("translateend",function(t){e.isTranslating=!1,e.executeStopTranslation(t.features)}),this.selectedRoute=new ds.Z({layers:[this.routesFeatureStore.layer.ol],condition:Ol.V4,hitTolerance:7,filter:function(t){return t.get("type")===kb.Route&&t.get("active")&&!e.isTranslating}}),this.selectedRoute.on("select",function(t){if(!1===e.focusOnStop){var i=Jc(ls.vs(t.mapBrowserEvent.coordinate,e.routesFeatureStore.layer.map.projection,e.projection),e.coordRoundedDecimals),o=Lb(e.stopsStore);o.text=i.join(","),o.coordinates=[i[0],i[1]]}}),this.stopsFeatureStore.layer.map.ol.addInteraction(this.selectStopInteraction),this.stopsFeatureStore.layer.map.ol.addInteraction(this.translateStop),this.routesFeatureStore.layer.map.ol.addInteraction(this.selectedRoute)}},{key:"onStopInputHasFocusChange",value:function(e){e?this.routesFeatureStore.layer.map.ol.removeInteraction(this.selectedRoute):this.routesFeatureStore.layer.map.ol.addInteraction(this.selectedRoute)}},{key:"executeStopTranslation",value:function(e){if(0!==e.getLength()){var t=e.getArray()[0],i=t.getId(),o=ls.vs(t.getGeometry().getCoordinates(),this.stopsFeatureStore.layer.map.projection,this.projection),n=this.stopsStore.get(i),r=Jc(o,this.coordRoundedDecimals);n.coordinates=r,n.text=r.join(","),this.stopsStore.update(n)}}},{key:"monitorEmptyEntityStore",value:function(){var e=this;this.storeEmpty$$=this.stopsStore.count$.pipe((0,G.x)()).subscribe(function(t){if(t<2){if(Lb(e.stopsStore),2===e.stopsStore.count)return void e.stopsStore.storeInitialized$.next(!0);e.stopsStore.storeInitialized$.next(!1)}e.routesQueries$$.map(function(e){return e.unsubscribe()})})}},{key:"monitorEntityStoreChange",value:function(){var e=this;this.storeChange$$=this.stopsStore.entities$.pipe((0,E.b)(this.debounce)).subscribe(function(t){e.handleStopDiff(t),Tb(e.stopsStore),e.handleStopsFeature(),e.getRoutes(e.isTranslating)})}},{key:"cancelSearch",value:function(){this.searchs$$.map(function(e){return e.unsubscribe()})}},{key:"handleStopDiff",value:function(e){var t=this,i=e.map(function(e){return K.removeUndefined(Object.assign({id:e.id,text:e.text,coordinates:e.coordinates}))}),o=X.findChanges(this.previousStops,i,["coordinates"]),n=o.added.concat(o.modified);n&&n.map(function(e){var i=e.newValue;if(i){var o=t.stopsStore.get(i.id),n=o.text;if(!n||0===n.length)return;var r,a=Ec(n,t.stopsFeatureStore.layer.map.projection),s=!1;a.lonLat&&(s=!0),r=t.searchService.search(n,{searchType:"Feature"}),t.cancelSearch();var l=r.map(function(e){return e.request.pipe((0,D.U)(function(e){return e.filter(function(e){return s?"Point"===e.data.geometry.type&&e.data.geometry:e.data.geometry})}))});t.searchs$$=l.map(function(e){return e.pipe((0,D.U)(function(e){return e.filter(function(e){return s?"Point"===e.data.geometry.type&&e.data.geometry:e.data.geometry})})).subscribe(function(e){if(e.length>0){var i=e[0].source,n=e[0].meta,r=e.map(function(e){return e.data});o.searchProposals||(o.searchProposals=[]),o.searchProposals=o.searchProposals.filter(function(e){return e.type===(s?Sb.Coord:Sb.Text)});var a=o.searchProposals.find(function(e){return e.source===i});a?a.results=r:o.searchProposals.push({type:s?Sb.Coord:Sb.Text,source:i,meta:n,results:r})}t.cdRef.detectChanges()})})}}),this.previousStops=i}},{key:"handleStopsFeature",value:function(){var e=this,t=this.stopsStore.all();t.filter(function(e){return e.coordinates}).map(function(t){return e.addStopOverlay(t)}),this.stopsFeatureStore.all().map(function(t){e.stopsStore.get(t.properties.id)||e.stopsFeatureStore.delete(t)}),t.filter(function(e){return!e.coordinates}).map(function(t){var i=e.stopsFeatureStore.get(t.id);i&&e.stopsFeatureStore.delete(i)})}},{key:"getRoutes",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=this.stopsStore.view.all().filter(function(e){return e.coordinates});if(i.length<2)this.routesFeatureStore.deleteMany(this.routesFeatureStore.all());else{var o=i.map(function(t){return Jc(t.coordinates,e.coordRoundedDecimals)});this.routesQueries$$.map(function(e){return e.unsubscribe()});var n=this.directionsService.route(o,t?{overview:!0,steps:!1,alternatives:!1,continue_straight:!1}:void 0);n&&n.map(function(t){return e.routesQueries$$.push(t.subscribe(function(t){e.routesFeatureStore.deleteMany(e.routesFeatureStore.all()),t.map(function(i){return function(e,t,i){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=new Ls.Z(t.geometry.coordinates).transform(i,e.map.projection),r=(new Zs.Z).writeGeometryObject(n,{featureProjection:e.map.projection,dataProjection:e.map.projection}),a=e.get(t.id),s={type:ec,geometry:r,projection:e.map.projection,properties:{id:t.id,type:kb.Route,active:o,direction:t},meta:{id:t.id,revision:(a?a.meta.revision:0)+1},ol:new ns.Z({geometry:n})};e.update(s)}(e.routesFeatureStore,i,e.projection,i===t[0])})}))})}}},{key:"addStopOverlay",value:function(e){!function(e,t,i,o,n){var r,a;switch(e.relativePosition){case Cb.Start:r="#008000",a=n.translate.instant("igo.geo.directionsForm.start");break;case Cb.End:r="#f64139",a=n.translate.instant("igo.geo.directionsForm.end");break;default:r="#ffd700",a=n.translate.instant("igo.geo.directionsForm.intermediate")+" #"+e.position}var s=new us.Z(ls.vs(e.coordinates,o,i.map.projection)),l=(new Zs.Z).writeGeometryObject(s,{featureProjection:i.map.projection,dataProjection:i.map.projection}),c=i.get(e.id),u={type:ec,geometry:l,projection:i.map.projection,properties:{id:e.id,type:kb.Stop,stopText:a,stopColor:r,stopOpacity:1,stop:e},meta:{id:e.id,revision:(c?c.meta.revision:0)+1},ol:new ns.Z({geometry:s})};i.update(u)}(e,0,this.stopsFeatureStore,this.projection,this.languageService)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(w.sBO),w.Y36(Ce),w.Y36(Nb),w.Y36(Yb),w.Y36(vp))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-directions"]],inputs:{contextUri:"contextUri",stopsStore:"stopsStore",stopsFeatureStore:"stopsFeatureStore",routesFeatureStore:"routesFeatureStore",stepFeatureStore:"stepFeatureStore",debounce:"debounce",length:"length",coordRoundedDecimals:"coordRoundedDecimals",zoomToActiveRoute$:"zoomToActiveRoute$"},decls:4,vars:12,consts:[[3,"contextUri","zoomToActiveRoute$","routesFeatureStore","stopsStore"],[3,"coordRoundedDecimals","projection","stopsFeatureStore","stopsStore","debounce","length","stopInputHasFocus"],[3,"stepFeatureStore","routesFeatureStore"]],template:function(e,t){1&e&&(w._UZ(0,"igo-directions-buttons",0),w.TgZ(1,"igo-directions-inputs",1),w.NdJ("stopInputHasFocus",function(e){return t.onStopInputHasFocusChange(e)}),w.qZA(),w._UZ(2,"br"),w._UZ(3,"igo-directions-results",2)),2&e&&(w.Q6J("contextUri",t.contextUri)("zoomToActiveRoute$",t.zoomToActiveRoute$)("routesFeatureStore",t.routesFeatureStore)("stopsStore",t.stopsStore),w.xp6(1),w.Q6J("coordRoundedDecimals",t.coordRoundedDecimals)("projection",t.projection)("stopsFeatureStore",t.stopsFeatureStore)("stopsStore",t.stopsStore)("debounce",t.debounce)("length",t.length),w.xp6(2),w.Q6J("stepFeatureStore",t.stepFeatureStore)("routesFeatureStore",t.routesFeatureStore))},directives:[Xb,Rb,nw],styles:[""]}),e}(),aw=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({providers:[{provide:yb,useFactory:bb,deps:[vb]}],imports:[[F.ez,Ql._t,We.u5,We.UX,k.Ps,S.ot,C.ie,kl.t,Ye.lN,ot.c,Ve.Ng,ze.LD,L.AV,tt.Bb,Se]]}),e}();function sw(e){return new Gb(e)}var lw=function(){var e=function(){function e(t){m(this,e),this.languageService=t}return y(e,[{key:"formatResult",value:function(e){return e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(Ce))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac}),e}(),cw=function(){function e(){m(this,e)}return y(e,[{key:"encodeKey",value:function(e){return encodeURIComponent(e)}},{key:"encodeValue",value:function(e){return encodeURIComponent(e)}},{key:"decodeKey",value:function(e){return decodeURIComponent(e)}},{key:"decodeValue",value:function(e){return decodeURIComponent(e)}}]),e}(),uw=function(){var e=function(e){o(n,e);var t=r(n);function n(e,i,o,r,a,s){var l;m(this,n),(l=t.call(this,r,o)).http=e,l.languageService=i,l.formatter=a,l.title$=new R.X(""),l.hashtagsLieuxToKeep=[],l.languageService.translate.get(l.options.title).subscribe(function(e){return l.title$.next(e)});var c=s.get(fa);return l.settings.length&&(c?c.authenticate$.subscribe(function(){l.getAllowedTypes()}):l.getAllowedTypes()),l}return y(n,[{key:"title",get:function(){return this.title$.getValue()}},{key:"getId",value:function(){return n.id}},{key:"getType",value:function(){return n.type}},{key:"getDefaultOptions",value:function(){var e,t=this.options.params&&this.options.params.limit?Number(this.options.params.limit):void 0,i=this.options.params&&this.options.params.ecmax?Number(this.options.params.ecmax):void 0,o=(null===(e=this.options.params)||void 0===e?void 0:e.type)?this.options.params.type.replace(/\s/g,"").toLowerCase().split(","):["adresses","codes-postaux","routes","intersections","municipalites","mrc","regadmin","lieux"];return{title:"igo.geo.search.icherche.name",searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/icherche",settings:[{type:"checkbox",title:"results type",name:"type",values:[{title:"igo.geo.search.icherche.type.address",value:"adresses",enabled:-1!==o.indexOf("adresses"),hashtags:["adresse"]},{title:"igo.geo.search.icherche.type.oldAddress",value:"anciennes-adresses",enabled:-1!==o.indexOf("anciennes-adresses"),hashtags:["anciennes-adresses"]},{title:"igo.geo.search.icherche.type.postalCode",value:"codes-postaux",enabled:-1!==o.indexOf("codes-postaux"),hashtags:["code-postal"]},{title:"igo.geo.search.icherche.type.road",value:"routes",enabled:-1!==o.indexOf("routes"),hashtags:["route"]},{title:"igo.geo.search.icherche.type.intersection",value:"intersections",enabled:-1!==o.indexOf("intersections"),hashtags:["intersection","+"]},{title:"igo.geo.search.icherche.type.city",value:"municipalites",enabled:-1!==o.indexOf("municipalites"),hashtags:["municipalit\xe9","mun"]},{title:"igo.geo.search.icherche.type.oldCity",value:"anciennes-municipalites",enabled:-1!==o.indexOf("anciennes-municipalites"),hashtags:["anciennes-municipalites"]},{title:"igo.geo.search.icherche.type.mrc",value:"mrc",enabled:-1!==o.indexOf("mrc"),hashtags:["mrc"]},{title:"igo.geo.search.icherche.type.regadmin",value:"regadmin",enabled:-1!==o.indexOf("regadmin"),hashtags:["r\xe9gion-administrative","regadmin"]},{title:"igo.geo.search.icherche.type.entreprise",value:"entreprises",enabled:-1!==o.indexOf("entreprises"),available:!1,hashtags:["entreprise"]},{title:"igo.geo.search.icherche.type.place",value:"lieux",enabled:-1!==o.indexOf("lieux"),hashtags:["lieu"]},{title:"igo.geo.search.icherche.type.exit",value:"sorties-autoroute",enabled:-1!==o.indexOf("sorties-autoroute"),hashtags:["sortie","sorties","exit"]},{title:"igo.geo.search.icherche.type.km",value:"bornes-km",enabled:-1!==o.indexOf("bornes-km"),hashtags:["borne","bornes","rep\xe8re","km"]},{title:"igo.geo.search.icherche.type.gcc",value:"bornes-gcc",enabled:-1!==o.indexOf("bornes-gcc"),hashtags:["borne","bornes","rep\xe8re","gcc","ccg"]},{title:"igo.geo.search.icherche.type.cn",value:"bornes-cn",enabled:-1!==o.indexOf("bornes-cn"),hashtags:["borne","bornes","cn"]},{title:"igo.geo.search.icherche.type.sumi",value:"bornes-sumi",enabled:-1!==o.indexOf("bornes-sumi"),hashtags:["borne","bornes","sumi"]},{title:"igo.geo.search.icherche.type.hq",value:"hq",enabled:-1!==o.indexOf("hq"),hashtags:["hq"]},{title:"igo.geo.search.icherche.type.cadastre",value:"cadastre",enabled:-1!==o.indexOf("cadastre"),hashtags:["cadastre"]}]},{type:"radiobutton",title:"results limit",name:"limit",values:[{title:"1",value:1,enabled:1===t},{title:"5",value:5,enabled:5===t||!t},{title:"10",value:10,enabled:10===t},{title:"25",value:25,enabled:25===t},{title:"50",value:50,enabled:50===t}]},{type:"radiobutton",title:"ecmax",name:"ecmax",values:[{title:"10 %",value:10,enabled:10===i},{title:"30 %",value:30,enabled:30===i||!i},{title:"50 %",value:50,enabled:50===i},{title:"75 %",value:75,enabled:75===i},{title:"100 %",value:100,enabled:100===i}]},{type:"radiobutton",title:"restrictExtent",name:"loc",values:[{title:"igo.geo.search.icherche.restrictExtent.map",value:"true",enabled:!1},{title:"igo.geo.search.icherche.restrictExtent.quebec",value:"false",enabled:!0}]}]}}},{key:"search",value:function(e,t){var i=this,o=this.computeRequestParams(e,t||{});return o.get("type").length?(this.options.params.page=o.get("page")||"1",this.http.get("".concat(this.searchUrl,"/geocode"),{params:o}).pipe((0,D.U)(function(t){return i.extractResults(t,e)}),(0,q.K)(function(e){throw e.error.toDisplay=!0,e.error.title=i.languageService.translate.instant(i.getDefaultOptions().title),e}))):(0,U.of)([])}},{key:"getAllowedTypes",value:function(){var e=this;return this.http.get("".concat(this.searchUrl,"/types")).subscribe(function(t){var i=e.settings.find(function(e){return"type"===e.name});i.values.forEach(function(i){var o=new RegExp("^".concat(i.value,"(\\.|$)")),n=t.filter(function(e){return o.test(e)});i.available=n.length>0,"lieux"===i.value&&(e.hashtagsLieuxToKeep=d(new Set(n.map(function(e){return e.split(".")}).reduce(function(e,t){return e.concat(t)}).filter(function(e){return"lieux"!==e}))))}),e.setParamFromSetting(i,!1)})}},{key:"computeRequestParams",value:function(e,t){var i=Object.assign({geometry:!0,bbox:!0,icon:!0,type:"adresses,codes-postaux,municipalites,mrc,regadmin,lieux,entreprises,bornes-sumi"},this.params,this.computeOptionsParam(e,t||{}).params,{q:this.computeTerm(e),page:t.page});if("true"===i.loc){var o=h(t.extent,4),n=o[0],r=o[1],a=o[2],s=o[3];i.loc="".concat(n,",").concat(r,";").concat(a,",").concat(r,";").concat(a,",").concat(s,";").concat(n,",").concat(s,";").concat(n,",").concat(r)}else"false"===i.loc&&delete i.loc;return/#[A-Za-z]+/.test(i.q)&&(i.type="lieux"),new P.LE({fromObject:K.removeUndefined(i),encoder:new cw})}},{key:"extractResults",value:function(e,t){var i=this;return e.features.map(function(o){return i.formatter.formatResult(i.dataToResult(o,t,e))})}},{key:"dataToResult",value:function(e,t,i){var o=this.computeProperties(e),n=[this.getId(),o.type,o.code].join(".");return{source:this,data:{type:ec,projection:"EPSG:4326",geometry:e.geometry,extent:e.bbox,properties:o,meta:{id:n,title:e.properties.nom}},meta:{dataType:ec,id:n,title:e.properties.nom,titleHtml:(e.highlight.title||e.properties.nom)+(e.highlight.title2?" <small> "+e.highlight.title2+"</small>":"")+(e.highlight.title3?"<br><small> "+e.highlight.title3+"</small>":""),icon:e.icon||"map-marker",score:e.score||Qb(t.trim(),e.properties.nom),nextPage:i.features.length%+this.options.params.limit==0&&+this.options.params.page<10}}}},{key:"computeProperties",value:function(e){var t=K.removeKeys(e.properties,n.propertiesBlacklist);if(!e.geometry)return Object.assign({type:e.index},t);var i,o,r={GoogleMaps:""};if("Point"===e.geometry.type)i=kp.getGoogleMapsCoordLink(e.geometry.coordinates[0],e.geometry.coordinates[1]);else{var a=(0,Pl.Z)(e.geometry);i=kp.getGoogleMapsCoordLink(a.geometry.coordinates[0],a.geometry.coordinates[1])}o=kp.getGoogleMapsNameLink("routes"===e.index?e.properties.nom+", "+e.properties.municipalite:"municipalites"===e.index?e.properties.nom+", ville":"mrc"===e.index?"mrc+"+e.properties.nom:"regadmin"===e.index?e.properties.nom+",+QC":e.properties.nom||e.highlight.title),r.GoogleMaps="<a href="+i+' target="_blank">'+this.languageService.translate.instant("igo.geo.searchByCoord")+"</a> <br /> <a href="+o+' target="_blank">'+this.languageService.translate.instant("igo.geo.searchByName")+"</a>","Point"===e.geometry.type&&(r.GoogleStreetView=kp.getGoogleStreetViewLink(e.geometry.coordinates[0],e.geometry.coordinates[1]));var s={Route:'<span class="routing"> <u>'+this.languageService.translate.instant("igo.geo.seeRouting")+"</u> </span>"};return Object.assign({type:e.index},t,r,s)}},{key:"computeTerm",value:function(e){var t=this;return(e.match(/(#[A-Za-z]+)/g)||[]).some(function(e){var i=e.substring(1);return t.hashtagsLieuxToKeep.some(function(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")===i.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")})})||(e=e.replace(/(#[A-Za-z]+)/g,"")),e.replace(/[^\w\xc0-\xff !\-\+\(\)\.\/\xbd\xbc\xbe,'#]+/g,"")}},{key:"computeOptionsParam",value:function(e,t){var o=i(c(n.prototype),"getHashtagsValid",this).call(this,e,"type");return o&&(t.params=Object.assign(t.params||{},{type:o.join(",")})),t}}]),n}(xp);return e.id="icherche",e.type=ec,e.propertiesBlacklist=[],e.\u0275fac=function(t){return new(t||e)(w.LFG(P.eN),w.LFG(Ce),w.LFG(De),w.LFG("options"),w.LFG(lw),w.LFG(w.zs3))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac}),(0,at.gn)([(0,st.q)({maxCacheCount:20})],e.prototype,"search",null),e}(),pw=function(){var e=function(e){o(i,e);var t=r(i);function i(e,o,n,r,a){var s;m(this,i),(s=t.call(this,r,n)).http=e,s.languageService=o,s.title$=new R.X(""),s.languageService.translate.get(s.options.title).subscribe(function(e){return s.title$.next(e)});var l=a.get(fa);return s.settings.length&&(l?l.authenticate$.subscribe(function(){s.getAllowedTypes()}):s.getAllowedTypes()),s}return y(i,[{key:"title",get:function(){return this.title$.getValue()}},{key:"getId",value:function(){return i.id}},{key:"getType",value:function(){return i.type}},{key:"getDefaultOptions",value:function(){var e=this.options.params&&this.options.params.type?this.options.params.type.replace(/\s/g,"").toLowerCase().split(","):["adresses","municipalites","mrc","regadmin"];return{title:"igo.geo.search.ichercheReverse.name",searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/terrapi",settings:[{type:"checkbox",title:"results type",name:"type",values:[{title:"igo.geo.search.icherche.type.address",value:"adresses",enabled:-1!==e.indexOf("adresses")},{title:"igo.geo.search.icherche.type.road",value:"routes",enabled:-1!==e.indexOf("routes"),available:!1},{title:"igo.geo.search.icherche.type.district",value:"arrondissements",enabled:-1!==e.indexOf("arrondissements")},{title:"igo.geo.search.icherche.type.city",value:"municipalites",enabled:-1!==e.indexOf("municipalites")},{title:"igo.geo.search.icherche.type.mrc",value:"mrc",enabled:-1!==e.indexOf("mrc")},{title:"igo.geo.search.icherche.type.regadmin",value:"regadmin",enabled:-1!==e.indexOf("regadmin")}]},{type:"radiobutton",title:"radius",name:"bufferInput",values:[{title:"100 m",value:100,enabled:!this.options.distance||100===this.options.distance},{title:"500 m",value:500,enabled:500===this.options.distance},{title:"1 km",value:1e3,enabled:1e3===this.options.distance},{title:"2 km",value:2e3,enabled:2e3===this.options.distance},{title:"5 km",value:5e3,enabled:5e3===this.options.distance}]}]}}},{key:"reverseSearch",value:function(e,t){var i=this,o=this.computeRequestParams(e,t||{});return o.get("type").length?this.http.get("".concat(this.searchUrl,"/locate"),{params:o}).pipe((0,D.U)(function(e){return i.extractResults(e)})):(0,U.of)([])}},{key:"getAllowedTypes",value:function(){var e=this;return this.http.get("".concat(this.searchUrl,"/types")).subscribe(function(t){var i=e.settings.find(function(e){return"type"===e.name});i.values.forEach(function(e){e.available=t.indexOf(e.value)>-1}),e.setParamFromSetting(i,!1)})}},{key:"computeRequestParams",value:function(e,t){return(t.distance||this.options.distance)&&(t.params=Object.assign(t.params||{},{bufferInput:t.distance||this.options.distance})),new P.LE({fromObject:Object.assign({loc:e.join(","),sort:"distance",geometry:!0,icon:!0},t.params||{},this.params)})}},{key:"extractResults",value:function(e){var t=this;return e.features.map(function(e){return t.dataToResult(e)})}},{key:"getSubtitle",value:function(e){if(!this.settings.length)return"";var t="";switch(e.properties.type){case"arrondissements":t=e.properties.municipalite+" (Arrondissement)";break;default:var i=this.settings.find(function(e){return"type"===e.name}).values.find(function(t){return t.value===e.properties.type});i&&(t=this.languageService.translate.instant(i.title))}return t}},{key:"dataToResult",value:function(e){var t=this.computeProperties(e),i=this.computeExtent(e),o=[this.getId(),t.type,t.code].join("."),n=e.properties.nom,r=" <small> "+this.getSubtitle(e)+"</small>";return{source:this,data:{type:ec,projection:"EPSG:4326",geometry:e.geometry,extent:i,properties:t,meta:{id:o,title:e.properties.nom}},meta:{dataType:ec,id:o,title:e.properties.nom,titleHtml:n+r,icon:e.icon||"map-marker",pointerSummaryTitle:this.getSubtitle(e)+": "+e.properties.nom}}}},{key:"computeProperties",value:function(e){var t=K.removeKeys(e.properties,i.propertiesBlacklist),o={Route:'<span class="routing"> <u>'+this.languageService.translate.instant("igo.geo.seeRouting")+"</u> </span>"};return Object.assign(t,o)}},{key:"computeExtent",value:function(e){return e.bbox?[e.bbox[0],e.bbox[2],e.bbox[1],e.bbox[3]]:void 0}}]),i}(xp);return e.id="icherchereverse",e.type=ec,e.propertiesBlacklist=[],e.\u0275fac=function(t){return new(t||e)(w.LFG(P.eN),w.LFG(Ce),w.LFG(De),w.LFG("options"),w.LFG(w.zs3))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac}),(0,at.gn)([(0,st.q)({maxCacheCount:20})],e.prototype,"reverseSearch",null),e}();function dw(e){return new lw(e)}function hw(e,t,i,o,n,r){return new uw(e,t,i,o.getConfig("searchSources.".concat(uw.id)),n,r)}function gw(e,t,i,o,n){return new pw(e,t,i,o.getConfig("searchSources.".concat(pw.id)),n)}var fw=function(){var e=function(){function e(t){m(this,e),this.languageService=t}return y(e,[{key:"formatResult",value:function(e){return e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(Ce))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac}),e}(),mw=function(){var e=function(e){o(i,e);var t=r(i);function i(e,o,n,r){var a;return m(this,i),(a=t.call(this,e,n)).languageService=o,a.title$=new R.X(""),a.projections=r,a.languageService.translate.get(a.options.title).subscribe(function(e){return a.title$.next(e)}),a}return y(i,[{key:"title",get:function(){return this.title$.getValue()}},{key:"getId",value:function(){return i.id}},{key:"getType",value:function(){return i.type}},{key:"getDefaultOptions",value:function(){return{title:"igo.geo.search.coordinates.name",order:1,showInSettings:!1}}},{key:"reverseSearch",value:function(e,t){return(0,U.of)([this.dataToResult(e,t)])}},{key:"dataToResult",value:function(e,t){var i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,i=[];return e.forEach(function(e){var o=e<0?Math.ceil(e):Math.floor(e),n=e<0?60*(o-e):60*(e-o),r=Math.floor(n),a=(60*(n-r)).toFixed(t);i.push("".concat(o,"\xb0 ").concat(r,"' ").concat(a,'"'))}),i}(e),o=function(e,t){var i=ls.vs(e,"EPSG:4326","EPSG:3857"),o=[{code:"EPSG:3857",alias:"Web Mercator",coord:i,igo2CoordFormat:"".concat(Jc(i).join(", ")," ; 3857")}],n=function(e){return Math.ceil((e[0]+180)/6)}(e),r=n<10?"EPSG:3260".concat(n):"EPSG:326".concat(n),a="UTM-".concat(n),s=ls.vs(e,"EPSG:4326",r);o.push({code:r,alias:"UTM",coord:s,igo2CoordFormat:"".concat(a," ").concat(Jc(s).join(", "))});var l=function(e){var t,i=e[0];return i<-51&&i>-54&&(t=1),i<-54&&i>-57&&(t=2),i<-57&&i>-60&&(t=3),i<-60&&i>-63&&(t=4),i<-63&&i>-66&&(t=5),i<-66&&i>-69&&(t=6),i<-69&&i>-72&&(t=7),i<-72&&i>-75&&(t=8),i<-75&&i>-78&&(t=9),i<-78&&i>-81&&(t=10),t}(e);if(l){var c=l<10?"EPSG:3218".concat(l):"EPSG:321".concat(80+l),u="MTM-".concat(l),p=ls.vs(e,"EPSG:4326",c);o.push({code:c,alias:"MTM",coord:p,igo2CoordFormat:"".concat(u," ").concat(Jc(p).join(", "))})}return t.forEach(function(t){var i=ls.vs(e,"EPSG:4326",t.code),n=t.code.split(":")[1];o.push({code:t.code,alias:t.alias||t.code,coord:i,igo2CoordFormat:"".concat(Jc(i).join(", ")," ; ").concat(n)})}),o}(e,this.projections).reduce(function(e,t){return e[t.alias]=t.igo2CoordFormat,e},{}),n=Jc(e,6).join(", "),r=i.join(", "),a={type:"Point",coordinates:[e[0],e[1]]},s={},l="";if(t.distance){s[this.languageService.translate.instant("igo.geo.search.coordinates.radius")]=t.distance,l="<br><small>Rayon: "+t.distance+" m</small>";var c=ls.vs([e[0],e[1]],"EPSG:4326","EPSG:3857"),u=new gs.Z(c,t.distance),p=(0,As.Bb)(u),d=new Zs.Z;a=JSON.parse(d.writeGeometry(p.transform("EPSG:3857","EPSG:4326")))}return t.conf&&(s[this.languageService.translate.instant("igo.geo.search.coordinates.conf")]=t.conf,l+=""===l?"<br>":"<small> - </small>",l+="<small>Confiance: "+t.conf+"%</small>"),s[this.languageService.translate.instant("igo.geo.search.coordinates.coord")]=n,s[this.languageService.translate.instant("igo.geo.search.coordinates.coordDMS")]=r,{source:this,data:{type:ec,projection:"EPSG:4326",geometry:a,extent:void 0,properties:Object.assign(s,o,{GoogleMaps:kp.getGoogleMapsCoordLink(e[0],e[1]),GoogleStreetView:kp.getGoogleStreetViewLink(e[0],e[1]),OpenStreetMap:Cp.getOpenStreetMapLink(e[0],e[1],14),Route:'<span class="routing"> <u>'+this.languageService.translate.instant("igo.geo.seeRouting")+"</u> </span>"}),meta:{id:e[0].toString()+","+e[1].toString(),title:n}},meta:{dataType:ec,id:e[0].toString()+","+e[1].toString(),title:n,titleHtml:n+l,icon:"map-marker",score:100}}}}]),i}(xp);return e.id="coordinatesreverse",e.type=ec,e.\u0275fac=function(t){return new(t||e)(w.LFG("options"),w.LFG(Ce),w.LFG(De),w.LFG("projections"))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac}),(0,at.gn)([(0,st.q)({maxCacheCount:20})],e.prototype,"reverseSearch",null),e}();function vw(e){return new fw(e)}function yw(e,t,i,o){return new mw(e.getConfig("searchSources.".concat(mw.id)),t,i,e.getConfig("projections")||[])}var bw=function(){var e=function(){function e(t){m(this,e),this.languageService=t}return y(e,[{key:"formatResult",value:function(e){var t=this,i=["title","abstract","groupTitle","metadataUrl","downloadUrl","urlInfo","name"],o=Object.entries(e.properties).filter(function(e){var t=h(e,1)[0];return-1!==i.indexOf(t)}).reduce(function(e,i){var o,n=h(i,2),r=n[0],a=n[1];try{o=t.languageService.translate.instant("igo.geo.search.ilayer.properties."+r)}catch(s){o=r}return e[o]=a||"",e},{}),n=Object.assign({},e);return n.properties=o,n}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(Ce))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac}),e}(),ww=function(){var e=function(e){o(n,e);var t=r(n);function n(e,i,o,r,a){var s;return m(this,n),(s=t.call(this,r,o)).http=e,s.languageService=i,s.formatter=a,s.title$=new R.X(""),s.languageService.translate.get(s.options.title).subscribe(function(e){return s.title$.next(e)}),s}return y(n,[{key:"title",get:function(){return this.title$.getValue()}},{key:"getId",value:function(){return n.id}},{key:"getType",value:function(){return n.type}},{key:"getDefaultOptions",value:function(){var e=this.options.params&&this.options.params.limit?Number(this.options.params.limit):void 0,t=this.options.params&&this.options.params.ecmax?Number(this.options.params.ecmax):void 0;return{title:"igo.geo.search.ilayer.name",searchUrl:"https://geoegl.msp.gouv.qc.ca/apis/layers/search",settings:[{type:"checkbox",title:"results type",name:"type",values:[{title:"igo.geo.search.ilayer.type.layer",value:"layer",enabled:!0,hashtags:["layer","layers","couche","couches"]},{title:"igo.geo.search.ilayer.type.groupLayer",value:"group",enabled:!1,hashtags:["gr-layer","gr-layers","gr-couche","gr-couches"]}]},{type:"radiobutton",title:"results limit",name:"limit",values:[{title:"1",value:1,enabled:1===e},{title:"5",value:5,enabled:5===e||!e},{title:"10",value:10,enabled:10===e},{title:"25",value:25,enabled:25===e},{title:"50",value:50,enabled:50===e}]},{type:"radiobutton",title:"ecmax",name:"ecmax",values:[{title:"10 %",value:10,enabled:10===t},{title:"30 %",value:30,enabled:30===t},{title:"50 %",value:50,enabled:50===t||!t},{title:"75 %",value:75,enabled:75===t},{title:"100 %",value:100,enabled:100===t}]}]}}},{key:"search",value:function(e,t){var i=this,o=this.computeSearchRequestParams(e,t||{});return o.get("q")&&o.get("type")?(this.options.params.page=o.get("page")||"1",this.http.get(this.searchUrl,{params:o}).pipe((0,D.U)(function(t){return i.extractResults(t,e)}))):(0,U.of)([])}},{key:"computeSearchRequestParams",value:function(e,t){return new P.LE({fromObject:K.removeUndefined(Object.assign({q:this.computeTerm(e)},this.params,this.computeOptionsParam(e,t||{}).params,{page:t.page}))})}},{key:"computeTerm",value:function(e){return e.replace(/(#[^\s]*)/g,"").replace(/[^\w\xc0-\xff !\-\(\),'#]+/g,"")}},{key:"computeOptionsParam",value:function(e,t){var o=i(c(n.prototype),"getHashtagsValid",this).call(this,e,"type");return o&&(t.params=Object.assign(t.params||{},{type:o.join(",")})),t}},{key:"extractResults",value:function(e,t){var i=this;return e.items.map(function(o){return i.dataToResult(o,t,e)})}},{key:"dataToResult",value:function(e,t,i){var o=this.computeLayerOptions(e),n=e.highlight.title||e.properties.title,r=e.highlight.groupTitle||e.properties.groupTitle,a=r?' <small style="color: #6f6969"> '+r+"</small>":"";return{source:this,meta:{dataType:Cg,id:[this.getId(),e.properties.id].join("."),title:e.properties.title,titleHtml:n+a,icon:"Layer"===e.properties.type?"layers":"map",score:e.score||Qb(t.trim(),e.properties.name),nextPage:i.items.length%+this.options.params.limit==0&&+this.options.params.page<10},data:o}}},{key:"computeLayerOptions",value:function(e){var t=e.properties.url,i=this.extractQueryParamsFromSourceUrl(t);return K.removeUndefined({sourceOptions:{id:e.properties.id,type:e.properties.format,url:t,queryFormat:i.queryFormat,queryHtmlTarget:i.queryHtmlTarget,params:"wms"===e.properties.format?{LAYERS:e.properties.name}:void 0,layer:"wms"===e.properties.format?void 0:e.properties.name,optionsFromCapabilities:!0,crossOrigin:"anonymous"},title:e.properties.title,maxResolution:Nc(Number(e.properties.maxScaleDenom)),minResolution:Nc(Number(e.properties.minScaleDenom)),metadata:{url:e.properties.metadataUrl,extern:!!e.properties.metadataUrl||void 0,abstract:e.properties.abstract||void 0},properties:this.formatter.formatResult(e).properties})}},{key:"extractQueryParamsFromSourceUrl",value:function(e){var t,i,o=this.options.queryFormat;if(o){for(var n=function(){var i=a[r],n=o[i];if("*"===n)return t=wc[i.toUpperCase()],"break";var s=n.urls;return Array.isArray(s)?(s.forEach(function(o){-1!==e.indexOf(o)&&(t=wc[i.toUpperCase()])}),"break"):void 0},r=0,a=Object.keys(o);r<a.length;r++){if("break"===n())break}(t===wc.HTML||t===wc.HTMLGML2)&&(i="iframe")}return{queryFormat:t,queryHtmlTarget:i}}}]),n}(xp);return e.id="ilayer",e.type=Cg,e.\u0275fac=function(t){return new(t||e)(w.LFG(P.eN),w.LFG(Ce),w.LFG(De),w.LFG("options"),w.LFG(bw))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac}),(0,at.gn)([(0,st.q)({maxCacheCount:20})],e.prototype,"search",null),e}();function xw(e){return new bw(e)}function Sw(e,t,i,o,n){return new ww(e,t,i,o.getConfig("searchSources.".concat(ww.id)),n)}var kw=[ec,Cg];function Cw(e,t){if(1&e&&(w.TgZ(0,"mat-radio-button",7),w._uU(1),w.ALo(2,"translate"),w.qZA()),2&e){var i=t.$implicit,o=w.oxw();w.Q6J("value",i),w.xp6(1),w.hij(" ",w.lcZ(2,2,o.getSearchTypeTitle(i))," ")}}var Tw=function(){var e=function(){function e(t){m(this,e),this.searchSourceService=t,this.searchType$=new R.X(void 0),this.searchTypes=kw,this.searchTypeChange=new w.vpe}return y(e,[{key:"searchType",get:function(){return this.searchType$.value},set:function(e){this.setSearchType(e)}},{key:"ngOnInit",value:function(){var e=this;this.searchType$$=this.searchType$.pipe((0,G.x)()).subscribe(function(t){return e.onSetSearchType(t)})}},{key:"ngOnDestroy",value:function(){this.searchType$$.unsubscribe()}},{key:"onSearchTypeChange",value:function(e){this.setSearchType(e)}},{key:"getSearchTypeTitle",value:function(e){return"igo.geo.search.".concat(e.toLowerCase(),".title")}},{key:"setSearchType",value:function(e){this.searchType$.next(e)}},{key:"onSetSearchType",value:function(e){null!=e&&(this.searchSourceService.enableSourcesByType(e),this.searchTypeChange.emit(e))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Gb))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-search-selector"]],inputs:{searchTypes:"searchTypes",searchType:"searchType"},outputs:{searchTypeChange:"searchTypeChange"},decls:9,vars:8,consts:[[1,"igo-search-selector"],["mat-icon-button","","color","primary","tooltip-position","below","matTooltipShowDelay","500",1,"igo-search-selector-button",3,"matTooltip","matMenuTriggerFor"],["svgIcon","menu-down"],["xPosition","before","yPosition","above",1,"no-border-radius"],["searchSelectorMenu","matMenu"],[1,"igo-search-selector-radio-group",3,"value","change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){if(1&e&&(w.TgZ(0,"div",0),w.TgZ(1,"button",1),w.ALo(2,"translate"),w._UZ(3,"mat-icon",2),w.qZA(),w.TgZ(4,"mat-menu",3,4),w.TgZ(6,"mat-radio-group",5),w.NdJ("change",function(e){return t.onSearchTypeChange(e.value)}),w.ALo(7,"async"),w.YNc(8,Cw,3,4,"mat-radio-button",6),w.qZA(),w.qZA(),w.qZA()),2&e){var i=w.MAs(5);w.xp6(1),w.Q6J("matTooltip",w.lcZ(2,4,"igo.geo.search.menu.tooltip"))("matMenuTriggerFor",i),w.xp6(5),w.Q6J("value",w.lcZ(7,6,t.searchType$)),w.xp6(2),w.Q6J("ngForOf",t.searchTypes)}},directives:[S.lW,L.gM,I.p6,k.Hw,I.VK,_l.VQ,F.sg,_l.U0],pipes:[ae.X$,F.Ov],styles:[".igo-search-selector-button[_ngcontent-%COMP%]     div.mat-button-ripple-round{border-radius:0}.igo-search-selector-radio-group[_ngcontent-%COMP%]{display:inline-flex;flex-direction:column}.igo-search-selector-radio-group[_ngcontent-%COMP%]   mat-radio-button[_ngcontent-%COMP%]{margin:5px}"],changeDetection:0}),e}(),Aw=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,L.AV,k.Ps,S.ot,I.Tx,_l.Fk,ql.Nh,M.p9,Se]]}),e}();function Lw(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",8),w.TgZ(1,"button",9),w.NdJ("click",function(e){return w.CHM(i),w.oxw().checkUncheckAllSources(e)}),w._uU(2),w.ALo(3,"translate"),w.ALo(4,"translate"),w.qZA(),w.qZA()}if(2&e){var o=w.oxw();w.xp6(2),w.Oqu(o.searchSourcesAllEnabled?w.lcZ(4,3,"igo.geo.search.searchSources.selectAll"):w.lcZ(3,1,"igo.geo.search.searchSources.unselectAll"))}}function Zw(e,t){if(1&e&&(w.TgZ(0,"button",15),w._uU(1),w.qZA()),2&e){var i=w.oxw().$implicit,o=w.MAs(6);w.Q6J("matMenuTriggerFor",o),w.xp6(1),w.hij("",i.title," ")}}function Fw(e,t){if(1&e&&(w.TgZ(0,"button",16),w._uU(1),w.qZA()),2&e){var i=w.oxw().$implicit;w.xp6(1),w.hij(" ",i.title," ")}}function Ow(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-radio-button",22),w.NdJ("click",function(e){return e.stopPropagation()})("change",function(e){var t=w.CHM(i).$implicit,o=w.oxw(2).$implicit,n=w.oxw().$implicit;return w.oxw().settingsValueCheckedRadioButton(e,n,o,t)}),w._uU(1),w.ALo(2,"translate"),w.qZA()}if(2&e){var o=t.$implicit,n=w.oxw(4);w.Q6J("value",o)("matTooltip",n.getAvailableHashtagsValues(o))("checked",o.enabled),w.xp6(1),w.hij(" ",w.lcZ(2,4,o.title)," ")}}function Mw(e,t){if(1&e&&(w.TgZ(0,"span"),w.TgZ(1,"mat-radio-group",20),w.YNc(2,Ow,3,6,"mat-radio-button",21),w.qZA(),w.qZA()),2&e){var i=w.oxw().$implicit;w.xp6(1),w.Q6J("value",i),w.xp6(1),w.Q6J("ngForOf",i.values)}}function Iw(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",8),w.TgZ(1,"button",9),w.NdJ("click",function(e){w.CHM(i);var t=w.oxw(2).$implicit,o=w.oxw().$implicit;return w.oxw().checkUncheckAll(e,o,t)}),w._uU(2),w.ALo(3,"translate"),w.ALo(4,"translate"),w.qZA(),w.qZA()}if(2&e){var o=w.oxw(2).$implicit;w.xp6(2),w.Oqu(o.allEnabled||void 0===o.allEnabled?w.lcZ(3,1,"igo.geo.search.searchSources.settings.unselectAll"):w.lcZ(4,3,"igo.geo.search.searchSources.settings.selectAll"))}}function Pw(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-checkbox",24),w.NdJ("click",function(e){return e.stopPropagation()})("change",function(e){var t=w.CHM(i).$implicit,o=w.oxw(2).$implicit,n=w.oxw().$implicit;return w.oxw().settingsValueCheckedCheckbox(e,n,o,t)}),w._uU(1),w.ALo(2,"translate"),w.qZA()}if(2&e){var o=t.$implicit,n=w.oxw(2).$implicit,r=w.oxw(2);w.Udp("display",r.displayBlock),w.Q6J("checked",o.enabled)("value",n)("matTooltip",r.getAvailableHashtagsValues(o)),w.xp6(1),w.hij(" ",w.lcZ(2,6,o.title)," ")}}function _w(e,t){if(1&e&&(w.TgZ(0,"span"),w.YNc(1,Iw,5,5,"div",5),w.YNc(2,Pw,3,8,"mat-checkbox",23),w.qZA()),2&e){var i=w.oxw().$implicit,o=w.oxw(2);w.xp6(1),w.Q6J("ngIf",i.values.length>3),w.xp6(1),w.Q6J("ngForOf",o.getAvailableValues(i))}}function qw(e,t){if(1&e&&(w.ynx(0),w.TgZ(1,"button",15),w._uU(2),w.ALo(3,"translate"),w.qZA(),w.TgZ(4,"mat-menu",17,18),w.YNc(6,Mw,3,2,"span",19),w.YNc(7,_w,3,2,"span",19),w.qZA(),w.BQk()),2&e){var i=t.$implicit,o=w.MAs(5);w.xp6(1),w.Q6J("matMenuTriggerFor",o),w.xp6(1),w.hij(" ",w.lcZ(3,5,"igo.geo.search.searchSources.settings."+i.title)," "),w.xp6(2),w.Q6J("ngSwitch",i.type),w.xp6(2),w.Q6J("ngSwitchCase","radiobutton"),w.xp6(1),w.Q6J("ngSwitchCase","checkbox")}}function Dw(e,t){if(1&e){var i=w.EpF();w.ynx(0),w.TgZ(1,"span",10),w.TgZ(2,"mat-checkbox",11),w.NdJ("click",function(e){return e.stopPropagation()})("change",function(e){var t=w.CHM(i).$implicit;return w.oxw().onCheckSearchSource(e,t)}),w.qZA(),w.YNc(3,Zw,2,2,"button",12),w.YNc(4,Fw,2,1,"button",13),w.qZA(),w.TgZ(5,"mat-menu",null,14),w.YNc(7,qw,8,7,"ng-container",6),w.qZA(),w.BQk()}if(2&e){var o=t.$implicit;w.xp6(2),w.Q6J("checked",o.enabled)("value",o),w.xp6(1),w.Q6J("ngIf",o.settings.length>0),w.xp6(1),w.Q6J("ngIf",0===o.settings.length),w.xp6(3),w.Q6J("ngForOf",o.settings)}}function Ew(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"span"),w._UZ(1,"mat-divider"),w.TgZ(2,"span",25),w.TgZ(3,"mat-slide-toggle",26),w.NdJ("change",function(e){return w.CHM(i),w.oxw().changePointerReverseSearch(e)})("click",function(e){return e.stopPropagation()}),w.ALo(4,"translate"),w._uU(5),w.ALo(6,"translate"),w.qZA(),w.TgZ(7,"mat-slide-toggle",26),w.NdJ("change",function(e){return w.CHM(i),w.oxw().changeSearchResultsGeometry(e)})("click",function(e){return e.stopPropagation()}),w.ALo(8,"translate"),w._uU(9),w.ALo(10,"translate"),w.qZA(),w.qZA(),w.qZA()}if(2&e){var o=w.oxw();w.xp6(3),w.Q6J("matTooltip",w.lcZ(4,8,"igo.geo.search.pointerSearchSummary.tooltip"))("checked",o.pointerSummaryEnabled)("labelPosition","after"),w.xp6(2),w.hij(" ",w.lcZ(6,10,"igo.geo.search.pointerSearchSummary.title")," "),w.xp6(2),w.Q6J("matTooltip",w.lcZ(8,12,"igo.geo.search.searchResultsGeometry.tooltip"))("checked",o.searchResultsGeometryEnabled)("labelPosition","after"),w.xp6(2),w.hij(" ",w.lcZ(10,14,"igo.geo.search.searchResultsGeometry.title")," ")}}var $w=function(){var e=function(){function e(t,i,o){m(this,e),this.searchSourceService=t,this.mediaService=i,this.storageService=o,this.hasPointerReverseSearchSource=!1,this.searchSourcesAllEnabled=!1,this.buffer=[],this.lastKeyTime=Date.now(),this.displayBlock="block",this.pointerSummaryEnabled=!1,this.searchResultsGeometryEnabled=!1,this.searchSourceChange=new w.vpe,this.pointerSummaryStatus=new w.vpe,this.searchResultsGeometryStatus=new w.vpe}return y(e,[{key:"isTouchScreen",get:function(){return this.mediaService.isTouchScreen()}},{key:"handleKeyboardEvent",value:function(e){"F2"===e.key&&(this.pointerSummaryEnabled=!this.pointerSummaryEnabled,this.pointerSummaryStatus.emit(this.pointerSummaryEnabled))}},{key:"ngOnInit",value:function(){this.hasPointerReverseSearchSource=this.hasReverseSearchSourcesForPointerSummary()}},{key:"getSearchSources",value:function(){var e=this.searchSourceService.getSources().filter(Ub).filter(function(e){return e.available&&"map"!==e.getId()&&e.showInSettings}),t=this.searchSourceService.getSources().filter(Jb).filter(function(e){return e.available&&"map"!==e.getId()&&e.showInSettings}),i=e.concat(t);return this.computeSourcesCheckAllBehavior(i),i}},{key:"hasReverseSearchSourcesForPointerSummary",value:function(){return!!this.searchSourceService.getEnabledSources().filter(Bb).length}},{key:"settingsValueCheckedCheckbox",value:function(e,t,i,o){o.enabled=e.checked,t.setParamFromSetting(i),this.searchSourceChange.emit(t)}},{key:"computeSettingCheckAllBehavior",value:function(e){e.allEnabled=void 0===e.allEnabled?!e.values.find(function(e){return e.enabled}):!e.allEnabled}},{key:"computeSourcesCheckAllBehavior",value:function(e){var t=e.filter(function(e){return e.enabled}).length,i=e.filter(function(e){return!e.enabled}).length;this.searchSourcesAllEnabled=!(t>=i)}},{key:"checkUncheckAll",value:function(e,t,i){e.stopPropagation(),this.computeSettingCheckAllBehavior(i),i.values.forEach(function(e){e.enabled=i.allEnabled}),t.setParamFromSetting(i),this.searchSourceChange.emit(t)}},{key:"checkUncheckAllSources",value:function(e){var t=this;e.stopPropagation(),this.getSearchSources().map(function(e){e.enabled=t.searchSourcesAllEnabled,t.searchSourceChange.emit(e)})}},{key:"settingsValueCheckedRadioButton",value:function(e,t,i,o){i.values.forEach(function(t){t.enabled=t.value!==o.value?!e.source.checked:e.source.checked}),t.setParamFromSetting(i),this.searchSourceChange.emit(t)}},{key:"onCheckSearchSource",value:function(e,t){t.enabled=e.checked;var i=this.storageService.get(t.getId()+".options")||{};i.enabled=t.enabled,this.storageService.set(t.getId()+".options",i),this.searchSourceChange.emit(t)}},{key:"getAvailableValues",value:function(e){return e.values.filter(function(e){return!1!==e.available})}},{key:"getAvailableHashtagsValues",value:function(e){if(e.hashtags)return e.hashtags.map(function(e){return"#"+e}).join(", ")}},{key:"stopPropagation",value:function(e){e.stopPropagation()}},{key:"changePointerReverseSearch",value:function(e){this.pointerSummaryEnabled=e.checked,this.pointerSummaryStatus.emit(this.pointerSummaryEnabled)}},{key:"changeSearchResultsGeometry",value:function(e){this.searchResultsGeometryEnabled=e.checked,this.searchResultsGeometryStatus.emit(this.searchResultsGeometryEnabled)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Gb),w.Y36(Pe),w.Y36(De))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-search-settings"]],hostBindings:function(e,t){1&e&&w.NdJ("keydown",function(e){return t.handleKeyboardEvent(e)},!1,w.evT)},inputs:{pointerSummaryEnabled:"pointerSummaryEnabled",searchResultsGeometryEnabled:"searchResultsGeometryEnabled"},outputs:{searchSourceChange:"searchSourceChange",pointerSummaryStatus:"pointerSummaryStatus",searchResultsGeometryStatus:"searchResultsGeometryStatus"},decls:9,vars:7,consts:[[1,"igo-search-settings"],["mat-icon-button","","color","primary","tooltip-position","below","matTooltipShowDelay","500",1,"igo-search-settings-button",3,"matTooltip","matMenuTriggerFor"],["svgIcon","chevron-down"],[1,"no-border-radius"],["searchSettingsMenu","matMenu"],["class","checkAllButton",4,"ngIf"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"checkAllButton"],["mat-raised-button","",3,"click"],[1,"igo-search-settings-search-source"],[1,"igo-search-settings-checkbox",3,"checked","value","click","change"],["mat-menu-item","",3,"matMenuTriggerFor",4,"ngIf"],["mat-menu-item","",4,"ngIf"],["sub_menu","matMenu"],["mat-menu-item","",3,"matMenuTriggerFor"],["mat-menu-item",""],["yPosition","above",3,"ngSwitch"],["test_sub_menu","matMenu"],[4,"ngSwitchCase"],[1,"igo-search-settings-radio-group",3,"value"],["class","mat-typography",3,"value","matTooltip","checked","click","change",4,"ngFor","ngForOf"],[1,"mat-typography",3,"value","matTooltip","checked","click","change"],["class","mat-menu-item",3,"display","checked","value","matTooltip","click","change",4,"ngFor","ngForOf"],[1,"mat-menu-item",3,"checked","value","matTooltip","click","change"],[1,"pointer-summary-slide-toggle-container","mat-typography"],["tooltip-position","below","matTooltipShowDelay","500",1,"pointer-summary-option",3,"matTooltip","checked","labelPosition","change","click"]],template:function(e,t){if(1&e&&(w.TgZ(0,"div",0),w.TgZ(1,"button",1),w.ALo(2,"translate"),w._UZ(3,"mat-icon",2),w.qZA(),w.TgZ(4,"mat-menu",3,4),w.YNc(6,Lw,5,5,"div",5),w.YNc(7,Dw,8,5,"ng-container",6),w.YNc(8,Ew,11,16,"span",7),w.qZA(),w.qZA()),2&e){var i=w.MAs(5);w.xp6(1),w.Q6J("matTooltip",w.lcZ(2,5,"igo.geo.search.menu.tooltip"))("matMenuTriggerFor",i),w.xp6(5),w.Q6J("ngIf",t.getSearchSources().length>4),w.xp6(1),w.Q6J("ngForOf",t.getSearchSources()),w.xp6(1),w.Q6J("ngIf",t.hasPointerReverseSearchSource&&!t.isTouchScreen)}},directives:[S.lW,L.gM,I.p6,k.Hw,I.VK,F.O5,F.sg,M.oG,I.OP,F.RF,F.n9,_l.VQ,_l.U0,kl.d,Cl.Rr],pipes:[ae.X$],styles:[".checkAllButton[_ngcontent-%COMP%]{text-align:center;padding:0 5px}.igo-search-settings-button[_ngcontent-%COMP%]     div.mat-button-ripple-round{border-radius:0}.igo-search-settings-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.igo-search-settings-radio-group[_ngcontent-%COMP%]   mat-radio-button[_ngcontent-%COMP%]{margin:5px}.igo-search-settings-checkbox[_ngcontent-%COMP%]   mat-radio-button[_ngcontent-%COMP%]{display:flex}.igo-search-settings-search-source[_ngcontent-%COMP%]{display:flex;width:100%}.igo-search-settings-search-source[_ngcontent-%COMP%]   mat-checkbox[_ngcontent-%COMP%]{display:flex;margin-left:5px;margin-right:5px}.pointer-summary-option[_ngcontent-%COMP%]{display:block;margin-right:10px;margin-bottom:15px}.pointer-summary-slide-toggle-container[_ngcontent-%COMP%]{overflow-x:hidden}.pointer-summary-slide-toggle-container[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{margin:10px}"],changeDetection:0}),e}(),Rw=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,L.AV,k.Ps,S.ot,I.Tx,_l.Fk,M.p9,kl.t,Cl.rP,Se]]}),e}(),Nw=["input"];function Uw(e,t){if(1&e&&(w.TgZ(0,"mat-label"),w._uU(1),w.qZA()),2&e){var i=w.oxw();w.xp6(1),w.Oqu(i.label)}}function Jw(e,t){if(1&e&&(w.TgZ(0,"button",10),w._UZ(1,"mat-icon",11),w.qZA()),2&e){var i=w.oxw();w.Q6J("color",i.color),w.xp6(1),w.s9C("svgIcon",i.searchIcon)}}function Bw(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",12),w.NdJ("click",function(){return w.CHM(i),w.oxw().onClearButtonClick()}),w._UZ(1,"mat-icon",13),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("color",o.color)}}function jw(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"igo-search-selector",14),w.NdJ("searchTypeChange",function(e){return w.CHM(i),w.oxw().onSearchTypeChange(e)}),w.ALo(1,"async"),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("searchTypes",o.searchTypes)("searchType",w.lcZ(1,2,o.searchType$))}}function Qw(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"igo-search-settings",15),w.NdJ("pointerSummaryStatus",function(e){return w.CHM(i),w.oxw().pointerSummaryStatus.emit(e)})("searchResultsGeometryStatus",function(e){return w.CHM(i),w.oxw().searchResultsGeometryStatus.emit(e)})("searchSourceChange",function(){return w.CHM(i),w.oxw().onSearchSettingsChange()}),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("pointerSummaryEnabled",o.pointerSummaryEnabled)("searchResultsGeometryEnabled",o.searchResultsGeometryEnabled)}}var Gw=function(e){return{empty:e}},Yw=function(e){return{hasSearchIcon:e}},zw=function(){var e=function(){function e(t,i,o){m(this,e),this.languageService=t,this.searchService=i,this.searchSourceService=o,this.placeholder$=new R.X("igo.geo.search.placeholder"),this.empty$=new R.X(!0),this.stream$=new R.X(""),this.searchTypes=kw,this.searchType$=new R.X(void 0),this.pointerSummaryStatus=new w.vpe,this.searchResultsGeometryStatus=new w.vpe,this.term$=new R.X(""),this.disabled$=new R.X(!1),this.pointerSummaryEnabled=!1,this.searchResultsGeometryEnabled=!1,this.floatLabel="never",this.appearance="legacy",this.color="primary",this.termSplitter="|",this.debounce=200,this.minLength=2,this.searchSelector=!1,this.searchSettings=!1,this.forceNA=!1,this.searchTermChange=new w.vpe,this.search=new w.vpe,this.searchTypeChange=new w.vpe,this.clearFeature=new w.vpe,this.searchSettingsChange=new w.vpe}return y(e,[{key:"searchType",get:function(){return this.searchType$.value},set:function(e){this.setSearchType(e)}},{key:"term",get:function(){return this.term$.value},set:function(e){this.setTerm(e)}},{key:"disabled",get:function(){return this.disabled$.value},set:function(e){this.disabled$.next(e)}},{key:"empty",get:function(){return 0===this.term.length}},{key:"ngOnInit",value:function(){var e=this;this.term$$=this.term$.subscribe(function(t){e.empty$.next(void 0===t||0===t.length)}),this.stream$$=this.stream$.pipe((0,ts.D)(function(t){return""===t?Va.E:(0,Ha.H)(e.debounce)})).subscribe(function(t){return e.onSetTerm(t)}),this.handlePlaceholder(),this.searchType$$=this.searchType$.pipe((0,G.x)()).subscribe(function(t){return e.onSetSearchType(t)})}},{key:"ngOnDestroy",value:function(){this.term$$.unsubscribe(),this.stream$$.unsubscribe(),this.searchType$$.unsubscribe()}},{key:"onKeyup",value:function(e){this.keyIsValid(e.key)&&this.setTerm(e.target.value)}},{key:"onClearButtonClick",value:function(){this.clear(),this.clearFeature.emit()}},{key:"onSearchTypeChange",value:function(e){this.setSearchType(e)}},{key:"setSearchType",value:function(e){this.searchType$.next(e)}},{key:"onSearchSettingsChange",value:function(){this.doSearch(this.term),this.searchSettingsChange.emit(),this.handlePlaceholder()}},{key:"setTerm",value:function(e){if(!this.disabled){(e=e||"")!==this.term&&this.term$.next(e);var t=e.replace(/(#[^\s]*)/g,"").trim();(t.length>=this.minLength||0===t.length)&&this.stream$.next(e)}}},{key:"clear",value:function(){this.term$.next(""),this.stream$.next(""),this.input.nativeElement.focus()}},{key:"keyIsValid",value:function(t){return-1===e.invalidKeys.indexOf(t)}},{key:"onSetTerm",value:function(e){this.searchTermChange.emit(e),this.doSearch(e)}},{key:"handlePlaceholder",value:function(){var e=d(new Set(this.searchSourceService.getEnabledSources().filter(function(e){return!["map","coordinatesreverse"].includes(e.getId())}).map(function(e){return e.getType()}))),t="igo.geo.search.placeholder";1===e.length?t="igo.geo.search.".concat(e[0].toLowerCase(),".placeholder"):0===e.length&&(t="igo.geo.search.emptyType.placeholder"),this.placeholder$.next(t)}},{key:"onSetSearchType",value:function(e){if(null!=e){this.searchTypeChange.emit(e);var t="igo.geo.search.".concat(e.toLowerCase(),".placeholder");this.placeholder$.next(t),this.setTerm(this.term)}}},{key:"doSearch",value:function(e){var t,i=this;this.researches$$&&(this.researches$$.map(function(e){return e.unsubscribe()}),this.researches$$=void 0),this.termSplitter&&e.match(new RegExp(this.termSplitter,"g"))?(t=e.split(this.termSplitter).filter(function(e){return e.length>=i.minLength}),this.store&&this.store.clear()):t=[e];var o=[];t.map(function(e){""!==(e?e.replace(/(#[^\s]*)/g,"").trim():"")?o=o.concat(i.searchService.search(e,{forceNA:i.forceNA})):void 0!==i.store&&i.store.clear()}),this.researches$$=o.map(function(e){return e.request.subscribe(function(t){i.onResearchCompleted(e,t)})})}},{key:"onResearchCompleted",value:function(e,t){if(this.search.emit({research:e,results:t}),void 0!==this.store){var i=this.store.all().filter(function(t){return t.source!==e.source}).concat(t);this.store.updateMany(i)}}}]),e}();return e.invalidKeys=["Control","Shift","Alt","ArrowDown","ArrowUp","ArrowRight","ArrowLeft"],e.\u0275fac=function(t){return new(t||e)(w.Y36(Ce),w.Y36(Yb),w.Y36(Gb))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-search-bar"]],viewQuery:function(e,t){var i;(1&e&&w.Gf(Nw,7),2&e)&&(w.iGM(i=w.CRH())&&(t.input=i.first))},inputs:{searchTypes:"searchTypes",searchType:"searchType",term:"term",disabled:"disabled",pointerSummaryEnabled:"pointerSummaryEnabled",searchResultsGeometryEnabled:"searchResultsGeometryEnabled",floatLabel:"floatLabel",appearance:"appearance",placeholder:"placeholder",label:"label",color:"color",termSplitter:"termSplitter",debounce:"debounce",minLength:"minLength",searchIcon:"searchIcon",searchSelector:"searchSelector",searchSettings:"searchSettings",forceNA:"forceNA",store:"store"},outputs:{pointerSummaryStatus:"pointerSummaryStatus",searchResultsGeometryStatus:"searchResultsGeometryStatus",searchTermChange:"searchTermChange",search:"search",searchTypeChange:"searchTypeChange",clearFeature:"clearFeature",searchSettingsChange:"searchSettingsChange"},decls:16,vars:28,consts:[[1,"igo-search-bar-container",3,"ngClass"],[3,"floatLabel","appearance"],[4,"ngIf"],["matInput","","autocomplete","off",3,"ngClass","disabled","placeholder","value","keyup","touchend"],["input",""],[1,"search-bar-buttons"],["mat-icon-button","",3,"color",4,"ngIf"],["mat-icon-button","",3,"color","click",4,"ngIf"],[3,"searchTypes","searchType","searchTypeChange",4,"ngIf"],[3,"pointerSummaryEnabled","searchResultsGeometryEnabled","pointerSummaryStatus","searchResultsGeometryStatus","searchSourceChange",4,"ngIf"],["mat-icon-button","",3,"color"],[3,"svgIcon"],["mat-icon-button","",3,"color","click"],["svgIcon","close"],[3,"searchTypes","searchType","searchTypeChange"],[3,"pointerSummaryEnabled","searchResultsGeometryEnabled","pointerSummaryStatus","searchResultsGeometryStatus","searchSourceChange"]],template:function(e,t){1&e&&(w.TgZ(0,"div",0),w.ALo(1,"async"),w.TgZ(2,"mat-form-field",1),w.YNc(3,Uw,2,1,"mat-label",2),w.TgZ(4,"input",3,4),w.NdJ("keyup",function(e){return t.onKeyup(e)})("touchend",function(e){return t.onKeyup(e)}),w.ALo(6,"async"),w.ALo(7,"async"),w.ALo(8,"translate"),w.ALo(9,"async"),w.qZA(),w.qZA(),w.TgZ(10,"div",5),w.YNc(11,Jw,2,2,"button",6),w.YNc(12,Bw,2,1,"button",7),w.ALo(13,"async"),w.YNc(14,jw,2,4,"igo-search-selector",8),w.YNc(15,Qw,1,2,"igo-search-settings",9),w.qZA(),w.qZA()),2&e&&(w.Q6J("ngClass",w.VKq(24,Gw,w.lcZ(1,12,t.empty$))),w.xp6(2),w.Q6J("floatLabel",t.floatLabel)("appearance",t.appearance),w.xp6(1),w.Q6J("ngIf",t.label),w.xp6(1),w.Q6J("ngClass",w.VKq(26,Yw,t.searchIcon))("disabled",w.lcZ(6,14,t.disabled$))("placeholder",t.placeholder?t.placeholder:w.lcZ(7,16,t.placeholder$)?w.lcZ(8,18,t.placeholder$.value):void 0)("value",w.lcZ(9,20,t.term$)),w.xp6(7),w.Q6J("ngIf",void 0!==t.searchIcon),w.xp6(1),w.Q6J("ngIf",!1===w.lcZ(13,22,t.empty$)),w.xp6(2),w.Q6J("ngIf",t.searchSelector),w.xp6(1),w.Q6J("ngIf",t.searchSettings))},directives:[F.mk,Ye.KE,F.O5,ot.Nt,Ye.hX,S.lW,k.Hw,Tw,$w],pipes:[F.Ov,ae.X$],styles:['[_nghost-%COMP%]     .mat-form-field{padding:0 5px}[_nghost-%COMP%]     .mat-form-field-wrapper{margin-bottom:-1.5em}[_nghost-%COMP%]     span.mat-form-field-label-wrapper{top:-20px}[_nghost-%COMP%]     div.mat-form-field-infix{left:5px;right:5px;padding:0 0 12px!important}[_nghost-%COMP%]     div.mat-form-field-underline{display:none}.igo-search-bar-container[_ngcontent-%COMP%]{position:relative;width:100%;display:inline-flex;overflow:hidden}.igo-search-bar-container[_ngcontent-%COMP%] > mat-form-field[_ngcontent-%COMP%]{width:calc(100% - (2 * 40px))}.igo-search-bar-container.empty[_ngcontent-%COMP%] > mat-form-field[_ngcontent-%COMP%]{width:calc(100% - 40px)}.search-bar-buttons[_ngcontent-%COMP%]{position:relative;right:0px;display:inline-flex;top:0}.search-bar-buttons[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]:nth-child(2):before{content:"";left:0px;top:5px;border-right:1px solid #ddd;height:28px}igo-search-selector[_ngcontent-%COMP%]{background-color:#fff;top:0;border-radius:0}igo-search-settings[_ngcontent-%COMP%]{background-color:#fff;top:0;border-radius:0}'],changeDetection:0}),e}(),Vw=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,We.u5,L.AV,k.Ps,S.ot,I.Tx,_l.Fk,Ye.lN,ot.c,Se,Aw,Rw]]}),e}();function Hw(e,t){if(1&e&&w._UZ(0,"mat-icon",4),2&e){var i=w.oxw();w.s9C("svgIcon",i.showIcons?i.icon:"blank")}}function Ww(e,t){if(1&e&&w._UZ(0,"h4",5),2&e){var i=w.oxw();w.Q6J("innerHtml",i.titleHtml,w.oJD)("matTooltip",i.tooltipHtml)}}function Xw(e,t){if(1&e&&(w.TgZ(0,"h4",6),w._uU(1),w.qZA()),2&e){var i=w.oxw();w.Q6J("matTooltip",i.title),w.xp6(1),w.Oqu(i.title)}}function Kw(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",7),w.NdJ("click",function(){return w.CHM(i),w.oxw().onZoomHandler()}),w._UZ(1,"mat-icon",8),w.qZA()}}var ex=[[["","igoSearchItemToolbar",""]]],tx=["[igoSearchItemToolbar]"],ix=function(){var e=function(){function e(){m(this,e),this.withZoomButton=!1,this.zoomEvent=new w.vpe,this.format=new Zs.Z}return y(e,[{key:"title",get:function(){return St(this.result)}},{key:"titleHtml",get:function(){return function(e){var t=e.meta||{};return t.titleHtml?t.titleHtml:wt(e,t.titleHtmlProperty||"titleHtml")}(this.result)}},{key:"tooltipHtml",get:function(){return this.titleHtml.replace(/<small?[^>]+(>|$)/g,"\n").replace(/<\/?[^>]+(>|$)/g,"")}},{key:"icon",get:function(){return kt(this.result)}},{key:"onZoomHandler",value:function(){var e=this.format.readFeature(this.result.data,{dataProjection:this.result.data.projection,featureProjection:this.map.projection});mu(this.map,[e],tc.Default)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-search-results-item"]],inputs:{result:"result",map:"map",showIcons:"showIcons",withZoomButton:"withZoomButton"},outputs:{zoomEvent:"zoomEvent"},ngContentSelectors:tx,decls:6,vars:4,consts:[["mat-list-avatar","",3,"svgIcon",4,"ngIf"],["matLine","","matTooltipShowDelay","500","matTooltipClass","search-result-tooltip",3,"innerHtml","matTooltip",4,"ngIf"],["matLine","","matTooltipShowDelay","500",3,"matTooltip",4,"ngIf"],["igoStopPropagation","","mat-icon-button","",3,"click",4,"ngIf"],["mat-list-avatar","",3,"svgIcon"],["matLine","","matTooltipShowDelay","500","matTooltipClass","search-result-tooltip",3,"innerHtml","matTooltip"],["matLine","","matTooltipShowDelay","500",3,"matTooltip"],["igoStopPropagation","","mat-icon-button","",3,"click"],["svgIcon","magnify"]],template:function(e,t){1&e&&(w.F$t(ex),w.TgZ(0,"mat-list-item"),w.YNc(1,Hw,1,1,"mat-icon",0),w.YNc(2,Ww,1,2,"h4",1),w.YNc(3,Xw,2,2,"h4",2),w.YNc(4,Kw,2,0,"button",3),w.Hsn(5),w.qZA()),2&e&&(w.xp6(1),w.Q6J("ngIf",t.icon),w.xp6(1),w.Q6J("ngIf",t.titleHtml),w.xp6(1),w.Q6J("ngIf",!t.titleHtml),w.xp6(1),w.Q6J("ngIf",t.withZoomButton))},directives:[C.Tg,F.O5,k.Hw,C.eA,Ve.X2,L.gM,S.lW,qt],styles:["[_nghost-%COMP%]     small{color:#8c8c8c}  .search-result-tooltip{white-space:pre-line}"],changeDetection:0}),e}(),ox=["igoSearchItemToolbar"];function nx(e,t){1&e&&w.GkF(0)}var rx=function(e){return{results:e}};function ax(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"igo-collapsible",6),w.NdJ("toggle",function(e){w.CHM(i);var t=w.oxw().$implicit;return w.oxw().collapsed[t.source.title]=e}),w.YNc(1,nx,1,0,"ng-container",7),w.qZA()}if(2&e){var o=w.oxw().$implicit,n=w.MAs(4),r=w.oxw();w.Tol(o.source.getId()),w.Q6J("title",r.computeGroupTitle(o))("collapsed",r.collapsed[o.source.title]),w.xp6(1),w.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",w.VKq(6,rx,o.results))}}function sx(e,t){1&e&&w.GkF(0)}function lx(e,t){if(1&e&&w.YNc(0,sx,1,0,"ng-container",7),2&e){var i=w.oxw().$implicit,o=w.MAs(4);w.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",w.VKq(2,rx,i.results))}}var cx=function(e){return{result:e}};function ux(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"igo-search-results-item",9),w.NdJ("focus",function(){var e=w.CHM(i).$implicit;return w.oxw(3).resultFocus.emit(e)})("unfocus",function(){var e=w.CHM(i).$implicit;return w.oxw(3).resultUnfocus.emit(e)})("select",function(){var e=w.CHM(i).$implicit;return w.oxw(3).onResultSelect(e)})("mouseenter",function(){var e=w.CHM(i).$implicit;return w.oxw(3).resultFocus.emit(e)})("mouseleave",function(){var e=w.CHM(i).$implicit;return w.oxw(3).resultUnfocus.emit(e)}),w.GkF(1,10),w.qZA()}if(2&e){var o=t.$implicit,n=w.oxw(3);w.Q6J("map",n.map)("result",o)("showIcons",n.showIcons)("withZoomButton",n.withZoomButton)("focused",n.store.state.get(o).focused)("selected",n.store.state.get(o).selected),w.xp6(1),w.Q6J("ngTemplateOutlet",n.templateSearchToolbar)("ngTemplateOutletContext",w.VKq(8,cx,o))}}function px(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"span",11),w.NdJ("click",function(){w.CHM(i);var e=w.oxw(2).$implicit;return w.oxw().displayMoreResults(e)}),w.TgZ(1,"u"),w._uU(2),w.ALo(3,"translate"),w.qZA(),w.qZA()}2&e&&(w.xp6(2),w.Oqu(w.lcZ(3,1,"igo.geo.search.displayMoreResults")))}function dx(e,t){if(1&e&&(w.YNc(0,ux,2,10,"ng-template",1),w.YNc(1,px,4,3,"span",8)),2&e){var i=t.results,o=w.oxw().$implicit,n=w.oxw();w.Q6J("ngForOf",i),w.xp6(1),w.Q6J("ngIf",n.isMoreResults(o))}}function hx(e,t){if(1&e&&(w.YNc(0,ax,2,8,"igo-collapsible",3),w.YNc(1,lx,1,4,"ng-template",null,4,w.W1O),w.YNc(3,dx,2,2,"ng-template",null,5,w.W1O)),2&e){var i=w.MAs(2),o=w.oxw();w.Q6J("ngIf",o.mode===o.searchResultMode.Grouped)("ngIfElse",i)}}var gx=function(){return(e=gx||(gx={})).Grouped="grouped",e.Flat="flat",gx;var e}(),fx=function(){var e=function(){function e(t,i){m(this,e),this.cdRef=t,this.searchService=i,this.searchResultMode=gx,this.pageIterator=[],this.collapsed=[],this.mode=gx.Grouped,this.withZoomButton=!1,this.settingsChange$=new R.X(void 0),this.termSplitter="|",this.resultFocus=new w.vpe,this.resultUnfocus=new w.vpe,this.resultSelect=new w.vpe,this.moreResults=new w.vpe,this.resultMouseenter=new w.vpe,this.resultMouseleave=new w.vpe}return y(e,[{key:"term",get:function(){return this._term},set:function(e){this._term=e,this.pageIterator=[]}},{key:"results$",get:function(){return void 0===this._results$&&(this._results$=this.liftResults()),this._results$}},{key:"ngOnInit",value:function(){var e=this;this.watcher=new Lt(this.store,this.cdRef),this.settingsChange$$=this.settingsChange$.subscribe(function(){e.pageIterator=[]})}},{key:"ngOnDestroy",value:function(){this.watcher.destroy(),this.settingsChange$$.unsubscribe()}},{key:"computeGroupTitle",value:function(e){var t=[e.source.title],i=e.results.length;return i>1&&t.push("(".concat(i,")")),t.join(" ")}},{key:"onResultSelect",value:function(e){this.store.state.get(e)&&!0===this.store.state.get(e).selected||(this.store.state.update(e,{focused:!0,selected:!0},!0),this.resultSelect.emit(e))}},{key:"liftResults",value:function(){var e=this;return this.store.stateView.all$().pipe((0,ts.D)(function(e){return 0===e.length?Va.E:(0,Ha.H)(200)}),(0,D.U)(function(t){return e.groupResults(t.map(function(e){return e.entity}).sort(e.sortByOrder))}))}},{key:"sortByOrder",value:function(e,t){return e.source.displayOrder-t.source.displayOrder}},{key:"groupResults",value:function(e){var t=this,i=new Map;return e.forEach(function(e){var t=e.source,o=i.get(t);void 0===o&&(o=[],i.set(t,o)),o.push(e)}),Array.from(i.keys()).map(function(e){return void 0===t.pageIterator[e.getId()]&&(t.pageIterator[e.getId()]=1),{source:e,results:i.get(e)}})}},{key:"isMoreResults",value:function(e){var t=this.store.getStrategyOfType(Ft);return!(null==t?void 0:t.active)&&e.results&&!0===e.results[e.results.length-1].meta.nextPage}},{key:"displayMoreResults",value:function(e){var t,i=this,o={sourceId:e.source.getId(),page:++this.pageIterator[e.source.getId()]};t=this.termSplitter&&this.term.match(new RegExp(this.termSplitter,"g"))?this.term.split(this.termSplitter):[this.term];var n=[];t.map(function(e){n=n.concat(i.searchService.search(e,o))}),n.map(function(t){t.request.subscribe(function(o){var n=e.results.concat(o);o.length||(n[n.length-1].meta.nextPage=!1),i.moreResults.emit({research:t,results:n})})})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(w.sBO),w.Y36(Yb))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-search-results"]],contentQueries:function(e,t,i){var o;(1&e&&w.Suo(i,ox,5),2&e)&&(w.iGM(o=w.CRH())&&(t.templateSearchToolbar=o.first))},inputs:{map:"map",store:"store",showIcons:"showIcons",mode:"mode",withZoomButton:"withZoomButton",term:"term",settingsChange$:"settingsChange$",termSplitter:"termSplitter"},outputs:{resultFocus:"resultFocus",resultUnfocus:"resultUnfocus",resultSelect:"resultSelect",moreResults:"moreResults",resultMouseenter:"resultMouseenter",resultMouseleave:"resultMouseleave"},decls:4,vars:4,consts:[[3,"navigation"],["ngFor","",3,"ngForOf"],["groupTemplate",""],[3,"class","title","collapsed","toggle",4,"ngIf","ngIfElse"],["flatTemplate",""],["storeItemTemplate",""],[3,"title","collapsed","toggle"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["class","moreResults mat-typography",3,"click",4,"ngIf"],["igoListItem","","color","accent",3,"map","result","showIcons","withZoomButton","focused","selected","focus","unfocus","select","mouseenter","mouseleave"],["igoSearchItemToolbar","",3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"moreResults","mat-typography",3,"click"]],template:function(e,t){1&e&&(w.TgZ(0,"igo-list",0),w.YNc(1,hx,5,2,"ng-template",1,2,w.W1O),w.ALo(3,"async"),w.qZA()),2&e&&(w.Q6J("navigation",!0),w.xp6(1),w.Q6J("ngForOf",w.lcZ(3,2,t.results$)))},directives:[dn,F.sg,F.O5,po,F.tP,ix,cn],pipes:[F.Ov,ae.X$],styles:[".moreResults[_ngcontent-%COMP%]{cursor:pointer;color:#00f;float:right;margin-right:10px;margin-top:5px}igo-list[_ngcontent-%COMP%]     mat-list{height:100%}"],changeDetection:0}),e}();function mx(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",1),w.NdJ("mouseenter",function(e){return w.CHM(i),w.oxw().onMouseEvent(e)})("mouseleave",function(e){return w.CHM(i),w.oxw().onMouseEvent(e)})("click",function(e){return w.CHM(i),w.oxw().onToggleClick(e)}),w.ALo(1,"translate"),w.ALo(2,"async"),w.ALo(3,"async"),w._UZ(4,"mat-icon",2),w.ALo(5,"async"),w.ALo(6,"async"),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("matTooltip",w.lcZ(1,4,w.lcZ(2,6,o.tooltip$)))("color",w.lcZ(3,8,o.isPreview$)?"":o.added?"warn":""),w.xp6(4),w.Q6J("matBadgeHidden",w.lcZ(5,10,o.inRange$))("svgIcon",w.lcZ(6,12,o.isPreview$)?"plus":o.added?"delete":"plus")}}var vx=function(){var e=function(){function e(t){m(this,e),this.layerService=t,this.tooltip$=new R.X("igo.geo.catalog.layer.addToMap"),this.inRange$=new R.X(!0),this.isPreview$=new R.X(!1),this.layersSubcriptions=[],this.mouseInsideAdd=!1,this._color="primary"}return y(e,[{key:"color",get:function(){return this._color},set:function(e){this._color=e}},{key:"ngOnInit",value:function(){var e=this;"Layer"===this.layer.meta.dataType&&(this.added=-1!==this.map.layers.findIndex(function(t){return t.id===e.layer.data.sourceOptions.id})),this.resolution$$=this.map.viewController.resolution$.subscribe(function(t){e.isInResolutionsRange(t),e.tooltip$.next(e.computeTooltip())})}},{key:"ngOnDestroy",value:function(){this.resolution$$.unsubscribe()}},{key:"onMouseEvent",value:function(e){this.onToggleClick(e)}},{key:"onToggleClick",value:function(e){var t=this;if(void 0!==this.lastTimeoutRequest&&clearTimeout(this.lastTimeoutRequest),"mouseenter"!==e.type||!this.mouseInsideAdd)switch(e.type){case"click":this.isPreview$.value||(this.added?this.remove():this.add()),this.isPreview$.next(!1);break;case"mouseenter":!this.isPreview$.value&&!this.added&&(this.lastTimeoutRequest=setTimeout(function(){t.add(),t.isPreview$.next(!0)},500)),this.mouseInsideAdd=!0;break;case"mouseleave":this.isPreview$.value&&(this.remove(),this.isPreview$.next(!1)),this.mouseInsideAdd=!1}}},{key:"add",value:function(){this.added||(this.added=!0,this.addLayerToMap())}},{key:"remove",value:function(){this.added&&(this.added=!1,this.removeLayerFromMap(),this.layersSubcriptions.map(function(e){return e.unsubscribe()}),this.layersSubcriptions=[])}},{key:"addLayerToMap",value:function(){var e=this;if(void 0!==this.map&&this.layer.meta.dataType===Cg){var t=this.layer.data;void 0===t.sourceOptions.optionsFromApi&&(t.sourceOptions.optionsFromApi=!0),this.layersSubcriptions.push(this.layerService.createAsyncLayer(t).subscribe(function(t){return e.map.addLayer(t)}))}}},{key:"removeLayerFromMap",value:function(){if(void 0!==this.map&&this.layer.meta.dataType===Cg){var e=this.map.getLayerById(this.layer.data.sourceOptions.id);this.map.removeLayer(e)}}},{key:"isInResolutionsRange",value:function(e){this.inRange$.next(e>=(this.layer.data.minResolution||0)&&e<=(this.layer.data.maxResolution||1/0))}},{key:"computeTooltip",value:function(){return this.added?this.inRange$.value?"igo.geo.catalog.layer.removeFromMap":"igo.geo.catalog.layer.removeFromMapOutRange":this.inRange$.value?"igo.geo.catalog.layer.addToMap":"igo.geo.catalog.layer.addToMapOutRange"}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Xu))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-search-add-button"]],inputs:{layer:"layer",added:"added",map:"map",color:"color"},decls:1,vars:1,consts:[["igoStopPropagation","","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","mouseenter","mouseleave","click",4,"ngIf"],["igoStopPropagation","","mat-icon-button","","tooltip-position","below","matTooltipShowDelay","500",3,"matTooltip","color","mouseenter","mouseleave","click"],["matBadge","icon","igoMatBadgeIcon","eye-off","igoMatBadgeInverseColor","true","matBadgeDisabled","true","matBadgeSize","small","matBadgePosition","after",3,"matBadgeHidden","svgIcon"]],template:function(e,t){1&e&&w.YNc(0,mx,7,14,"button",0),2&e&&w.Q6J("ngIf","Layer"===t.layer.meta.dataType)},directives:[F.O5,S.lW,qt,L.gM,k.Hw,ct.k,ro],pipes:[ae.X$,F.Ov],styles:[""],changeDetection:0}),e}(),yx=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,ct.g,L.AV,k.Ps,C.ie,S.ot,ho,hn,zo,Se,ao,Kl]]}),e}(),bx=function(){var e=function(){function e(t,i,o,n){m(this,e),this.component=t,this.searchService=i,this.searchSourceService=o,this.mediaService=n,this.pointerSearchStore=new At([]),this.reverseSearch$$=[],this.hasPointerReverseSearchSource=!1,this.searchPointerSummaryFeatureId="searchPointerSummaryFeatureId",this.igoSearchPointerSummaryDelay=1e3,this.igoSearchPointerSummaryEnabled=!1}return y(e,[{key:"map",get:function(){return this.component.map}},{key:"mapProjection",get:function(){return this.component.map.projection}},{key:"ngOnInit",value:function(){var e=this;this.listenToMapPointerMove(),this.subscribeToPointerStore(),this.map.status$.pipe((0,Ge.q)(1)).subscribe(function(){e.store=new yu([],{map:e.map}),e.initStore()}),this.layers$$=this.map.layers$.subscribe(function(t){e.store&&!t.find(function(e){return"searchPointerSummaryId"===e.id})&&e.initStore()})}},{key:"initStore",value:function(){vu(this.store,new jc({isIgoInternalLayer:!0,id:"searchPointerSummaryId",title:"searchPointerSummary",zIndex:900,source:new _c,showInLayerList:!1,exportable:!1,browsable:!1,style:wx}))}},{key:"ngAfterContentChecked",value:function(){this.hasPointerReverseSearchSource=!!this.searchSourceService.getEnabledSources().filter(Bb).length}},{key:"ngOnDestroy",value:function(){this.unlistenToMapPointerMove(),this.unsubscribeToPointerStore(),this.unsubscribeReverseSearch(),this.layers$$.unsubscribe()}},{key:"subscribeToPointerStore",value:function(){var e=this;this.store$$=this.pointerSearchStore.entities$.subscribe(function(t){e.entitiesToPointerOverlay(t)})}},{key:"computeSummaryClosestFeature",value:function(e){var t={};return e.map(function(e){e.data.properties.type&&e.data.properties.distance>=0&&(t.hasOwnProperty(e.data.properties.type)?e.data.properties.distance<t[e.data.properties.type].distance&&(t[e.data.properties.type]={distance:e.data.properties.distance,title:e.meta.pointerSummaryTitle||e.meta.title}):t[e.data.properties.type]={distance:e.data.properties.distance,title:e.meta.pointerSummaryTitle||e.meta.title})}),t}},{key:"entitiesToPointerOverlay",value:function(e){var t=this.computeSummaryClosestFeature(e),i=Object.keys(t),o=[],n=[];e.map(function(e){var r=i.indexOf(e.data.properties.type);-1!==r?(n.push(t[e.data.properties.type].title),i.splice(r,1),o.push(e.data.properties.type)):-1===o.indexOf(e.data.properties.type)&&n.push(e.meta.pointerSummaryTitle||e.meta.title)}),n.length&&this.addPointerOverlay(n.join("\n"))}},{key:"listenToMapPointerMove",value:function(){var e=this;this.pointerMoveListener=this.map.ol.on("pointermove",function(t){return e.onMapEvent(t)})}},{key:"unsubscribeToPointerStore",value:function(){this.store$$.unsubscribe()}},{key:"unsubscribeReverseSearch",value:function(){this.reverseSearch$$.map(function(e){return e.unsubscribe()}),this.reverseSearch$$=[]}},{key:"unlistenToMapPointerMove",value:function(){(0,Os.B)(this.pointerMoveListener),this.pointerMoveListener=void 0}},{key:"onMapEvent",value:function(e){var t=this;!e.dragging&&this.igoSearchPointerSummaryEnabled&&this.hasPointerReverseSearchSource&&!this.mediaService.isTouchScreen()?(void 0!==this.lastTimeoutRequest&&(clearTimeout(this.lastTimeoutRequest),this.clearLayer(),this.unsubscribeReverseSearch()),this.lonLat=(0,ls.vs)(e.coordinate,this.mapProjection,"EPSG:4326"),this.lastTimeoutRequest=setTimeout(function(){t.onSearchCoordinate()},this.igoSearchPointerSummaryDelay)):this.clearLayer()}},{key:"sortByOrder",value:function(e,t){return e.source.displayOrder-t.source.displayOrder}},{key:"onSearchCoordinate",value:function(){var e=this;this.pointerSearchStore.clear();var t=this.searchService.reverseSearch(this.lonLat,{params:{geometry:"false",icon:"false"}},!0),i=function(i){t.length>0&&e.reverseSearch$$.push(t[i].request.subscribe(function(o){e.onSearch({research:t[i],results:o})}))};for(var o in t)i(o)}},{key:"onSearch",value:function(e){var t=e.results,i=this.pointerSearchStore.all().filter(function(t){return t.source!==e.research.source}).concat(t);this.pointerSearchStore.load(i.sort(this.sortByOrder))}},{key:"addPointerOverlay",value:function(e){this.clearLayer();var t=new us.Z((0,ls.vs)(this.lonLat,"EPSG:4326",this.mapProjection)),i=new ns.Z({geometry:t}),o=(new Zs.Z).writeGeometryObject(t,{featureProjection:this.mapProjection,dataProjection:this.mapProjection});this.store.setLayerFeatures([{type:ec,geometry:o,projection:this.mapProjection,properties:{id:this.searchPointerSummaryFeatureId,pointerSummary:e},meta:{id:this.searchPointerSummaryFeatureId},ol:i}],tc.None)}},{key:"clearLayer",value:function(){this.store&&this.store.clearLayer()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Du,2),w.Y36(Yb),w.Y36(Gb),w.Y36(Pe))},e.\u0275dir=w.lG2({type:e,selectors:[["","igoSearchPointerSummary",""]],inputs:{igoSearchPointerSummaryDelay:"igoSearchPointerSummaryDelay",igoSearchPointerSummaryEnabled:"igoSearchPointerSummaryEnabled"}}),e}();function wx(e,t){return new ms.ZP({image:new bs.Z({src:"./assets/igo2/geo/icons/cross_black_18px.svg",imgSize:[18,18]}),text:new vs.Z({text:e.get("pointerSummary"),textAlign:"left",textBaseline:"bottom",font:"12px Calibri,sans-serif",fill:new ys.Z({color:"#000"}),backgroundFill:new ys.Z({color:"rgba(255, 255, 255, 0.5)"}),backgroundStroke:new ws.Z({color:"rgba(200, 200, 200, 0.75)",width:2}),stroke:new ws.Z({color:"#fff",width:3}),overflow:!0,offsetX:10,offsetY:-10,padding:[2.5,2.5,2.5,2.5]})})}var xx=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[Yb,{provide:Gb,useFactory:sw,deps:[xp]},{provide:lw,useFactory:dw,deps:[Ce]},{provide:fw,useFactory:vw,deps:[Ce]},{provide:bw,useFactory:xw,deps:[Ce]}]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,Vw,Aw,yx,Rw],Vw,Aw,yx,Rw]}),e}(),Sx=function(){var e=function(){function e(t){m(this,e),this.cdRef=t,this.complete=new w.vpe,this.cancel=new w.vpe}return y(e,[{key:"onUpdateInputs",value:function(){this.cdRef.detectChanges()}},{key:"onClose",value:function(){this.cancel.emit()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(w.sBO))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-ogc-filter"]],inputs:{layer:"layer",map:"map"},outputs:{complete:"complete",cancel:"cancel"},decls:1,vars:3,consts:[["igoListItem","",3,"layer","header","map"]],template:function(e,t){1&e&&w._UZ(0,"igo-ogc-filterable-item",0),2&e&&w.Q6J("layer",t.layer)("header",!1)("map",t.map)},directives:[rm],styles:[""],changeDetection:0}),e}(),kx=new w.OlP("OgcFilterWidget");function Cx(e){return e.create(Sx)}var Tx=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,S.ot,Se,Gv]]}),e}(),Ax=function(e){o(i,e);var t=r(i);function i(e){var o;return m(this,i),(o=t.call(this,e)).options=e,o.inResolutionRange$=new R.X(!0),o.map.viewController.resolution$.subscribe(function(e){o.inResolutionRange$.next(e>o.layer.minResolution&&e<o.layer.maxResolution)}),o}return y(i,[{key:"layer",get:function(){return this.options.layer}},{key:"map",get:function(){return this.options.map}},{key:"getLayerWksOptionTabQuery",value:function(){var e;return void 0===(null===(e=this.layer.options.workspace.queryOptions)||void 0===e?void 0:e.tabQuery)||this.layer.options.workspace.queryOptions.tabQuery}},{key:"getLayerWksOptionMapQuery",value:function(){var e;return void 0===(null===(e=this.layer.options.workspace.queryOptions)||void 0===e?void 0:e.mapQueryOnOpenTab)||this.layer.options.workspace.queryOptions.mapQueryOnOpenTab}},{key:"getInResolutionRange",value:function(){return this.inResolutionRange$.value}}]),i}(fr),Lx=function(){var e=function(){function e(t){m(this,e),this.storageService=t,this.ws$=new R.X(void 0)}return y(e,[{key:"zoomAuto",get:function(){return this.storageService.get("zoomAuto")}},{key:"createWorkspace",value:function(e,t){var i;if(!1!==(null===(i=e.options.workspace)||void 0===i?void 0:i.enabled)&&!e.dataSource.options.edition){e.options.workspace=Object.assign({},e.options.workspace,{srcId:e.id,workspaceId:e.id,enabled:!0});var o=new Ax({id:e.id,title:e.title,layer:e,map:t,entityStore:this.createFeatureStore(e,t),actionStore:new Gn([]),meta:{tableTemplate:void 0}});return this.createTableTemplate(o,e),o}}},{key:"createFeatureStore",value:function(e,t){var i=new yu([],{map:t});i.bindLayer(e);var o=new Su({}),n=new bu({}),r=new wu({}),a=new Ot({}),s=new Cu({layer:new jc({zIndex:300,source:new _c,style:void 0,showInLayerList:!1,exportable:!1,browsable:!1}),map:t,hitTolerance:15,motion:this.zoomAuto?tc.Default:tc.None,many:!0,dragBox:!0});return i.addStrategy(o,!0),i.addStrategy(n,!0),i.addStrategy(r,!0),i.addStrategy(s,!0),i.addStrategy(a,!1),i.addStrategy(this.createFilterInMapExtentOrResolutionStrategy(),!0),i}},{key:"createTableTemplate",value:function(e,t){var i=this,o=t.dataSource.options.sourceFields||[],n=t.dataSource.options.relations||[];if(0!==o.length){var r=o.map(function(e){return{name:"properties.".concat(e.name),title:e.alias?e.alias:e.name,renderer:vt.UnsanitizedHTML,tooltip:e.tooltip}}),a=n.map(function(e){return{name:"properties.".concat(e.name),title:e.alias?e.alias:e.name,renderer:vt.Icon,icon:e.icon,parent:e.parent,type:"relation",tooltip:e.tooltip,onClick:function(){i.ws$.next(e.title)},cellClassFunc:function(){return{class_icon:!0}}}});r.push.apply(r,d(a)),e.meta.tableTemplate={selection:!0,sort:!0,columns:r}}else e.entityStore.entities$.pipe((0,Ka.n)(function(e){return 0===e.length}),(0,Ge.q)(1)).subscribe(function(t){var i=t[0].ol,o=i.getKeys().filter(function(e){return!e.startsWith("_")&&"geometry"!==e&&e!==i.getGeometryName()&&!e.match(/boundedby/gi)}).map(function(e){return{name:"properties.".concat(e),title:e,renderer:vt.UnsanitizedHTML}});e.meta.tableTemplate={selection:!0,sort:!0,columns:o}})}},{key:"createFilterInMapExtentOrResolutionStrategy",value:function(){return new Ft({filterClauseFunc:function(e){return!0===e.state.inMapExtent&&!0===e.state.inMapResolution}})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(De))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Zx=function(){var e=function(){function e(t,i){m(this,e),this.layerService=t,this.storageService=i,this.ws$=new R.X(void 0)}return y(e,[{key:"zoomAuto",get:function(){return this.storageService.get("zoomAuto")}},{key:"createWorkspace",value:function(e,t){var i,o,n,r,a,s,l,c,u,p,d,h=this;if(e.options.workspace&&!t.layers.find(function(t){return t.id===e.id+".WfsWorkspaceTableDest"})&&!e.dataSource.options.edition){var g=e.dataSource,f=e.id+".WmsWorkspaceTableSrc",m=e.id+".WfsWorkspaceTableDest";e.options.linkedLayers||(e.options.linkedLayers={linkId:f,links:[]});var v={bidirectionnal:!0,syncedDelete:!0,linkedIds:[m],properties:[nc.ZINDEX,nc.VISIBLE]};(null===(i=e.options.workspace)||void 0===i?void 0:i.minResolution)||v.properties.push(nc.MINRESOLUTION);var y=!1;(null===(o=g.options.ogcFilters)||void 0===o?void 0:o.enabled)&&(v.properties.push(nc.OGCFILTERS),y=!0),(null===(n=e.options.workspace)||void 0===n?void 0:n.maxResolution)||v.properties.push(nc.MAXRESOLUTION);var b=[];e.options.linkedLayers.links&&(b=JSON.parse(JSON.stringify(e.options.linkedLayers.links))),b.push(v),e.options.linkedLayers.linkId=e.options.linkedLayers.linkId?e.options.linkedLayers.linkId:f,e.options.linkedLayers.links=b;var w,x={srcId:e.id,workspaceId:void 0,enabled:!1,queryOptions:{mapQueryOnOpenTab:null===(a=null===(r=e.options.workspace)||void 0===r?void 0:r.queryOptions)||void 0===a?void 0:a.mapQueryOnOpenTab,tabQuery:null===(l=null===(s=e.options.workspace)||void 0===s?void 0:s.queryOptions)||void 0===l?void 0:l.tabQuery},pageSize:null===(c=e.options.workspace)||void 0===c?void 0:c.pageSize,pageSizeOptions:null===(u=e.options.workspace)||void 0===u?void 0:u.pageSizeOptions};return this.layerService.createAsyncLayer({isIgoInternalLayer:!0,id:m,linkedLayers:{linkId:m},workspace:x,showInLayerList:!1,opacity:0,title:e.title,minResolution:(null===(p=e.options.workspace)||void 0===p?void 0:p.minResolution)||e.minResolution||0,maxResolution:(null===(d=e.options.workspace)||void 0===d?void 0:d.maxResolution)||e.maxResolution||1/0,sourceOptions:{download:g.options.download,type:"wfs",url:g.options.urlWfs||g.options.url,queryable:!0,relations:g.options.relations,queryTitle:g.options.queryTitle,queryFormatAsWms:g.options.queryFormatAsWms,params:g.options.paramsWFS,ogcFilters:Object.assign({},g.ogcFilters$.value,{enabled:y}),sourceFields:g.options.sourceFields||void 0}}).subscribe(function(i){var o,n,r,a,s,l,c;if(t.addLayer(i),e.ol.setProperties({linkedLayers:{linkId:e.options.linkedLayers.linkId,links:b}},!1),i.dataSource.ol.refresh(),null===(o=e.options.workspace)||void 0===o?void 0:o.enabled)return w=new Ax({id:e.id,title:e.title,layer:i,map:t,entityStore:h.createFeatureStore(i,t),actionStore:new Gn([]),meta:{tableTemplate:void 0}}),h.createTableTemplate(w,i),i.options.workspace.workspaceId=i.id,e.options.workspace=Object.assign({},e.options.workspace,{enabled:!0,srcId:e.id,workspaceId:i.id,queryOptions:{mapQueryOnOpenTab:null===(r=null===(n=e.options.workspace)||void 0===n?void 0:n.queryOptions)||void 0===r?void 0:r.mapQueryOnOpenTab,tabQuery:null===(s=null===(a=e.options.workspace)||void 0===a?void 0:a.queryOptions)||void 0===s?void 0:s.tabQuery},pageSize:null===(l=e.options.workspace)||void 0===l?void 0:l.pageSize,pageSizeOptions:null===(c=e.options.workspace)||void 0===c?void 0:c.pageSizeOptions}),delete g.options.download,w}),w}}},{key:"createFeatureStore",value:function(e,t){var i=new yu([],{map:t});i.bindLayer(e);var o=new Su({}),n=new bu({}),r=new wu({}),a=new Ot({}),s=new Cu({layer:new jc({zIndex:300,source:new _c,style:void 0,showInLayerList:!1,exportable:!1,browsable:!1}),map:t,hitTolerance:15,motion:this.zoomAuto?tc.Default:tc.None,many:!0,dragBox:!0});return i.addStrategy(o,!0),i.addStrategy(n,!0),i.addStrategy(r,!0),i.addStrategy(s,!0),i.addStrategy(a,!1),i.addStrategy(this.createFilterInMapExtentOrResolutionStrategy(),!0),i}},{key:"createTableTemplate",value:function(e,t){var i=this,o=t.dataSource.options.sourceFields||[],n=t.dataSource.options.relations||[];if(0!==o.length){var r=o.map(function(e){return{name:"properties.".concat(e.name),title:e.alias?e.alias:e.name,renderer:vt.UnsanitizedHTML,tooltip:e.tooltip}}),a=n.map(function(e){return{name:"properties.".concat(e.name),title:e.alias?e.alias:e.name,renderer:vt.Icon,icon:e.icon,parent:e.parent,type:"relation",tooltip:e.tooltip,onClick:function(){i.ws$.next(e.title)},cellClassFunc:function(){return{class_icon:!0}}}});r.push.apply(r,d(a)),e.meta.tableTemplate={selection:!0,sort:!0,columns:r}}else e.entityStore.entities$.pipe((0,Ka.n)(function(e){return 0===e.length}),(0,Ge.q)(1)).subscribe(function(t){var i=t[0].ol,o=i.getKeys().filter(function(e){return!e.startsWith("_")&&"geometry"!==e&&e!==i.getGeometryName()&&!e.match(/boundedby/gi)}).map(function(e){return{name:"properties.".concat(e),title:e,renderer:vt.UnsanitizedHTML}});e.meta.tableTemplate={selection:!0,sort:!0,columns:o}})}},{key:"createFilterInMapExtentOrResolutionStrategy",value:function(){return new Ft({filterClauseFunc:function(e){return!0===e.state.inMapExtent&&!0===e.state.inMapResolution}})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(Xu),w.LFG(De))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Fx=function(){var e=function(){function e(t,i,o){m(this,e),this.dialogRef=t,this.languageService=i,this.data=o}return y(e,[{key:"cancelAction",value:function(){this.data.cancel=!0,this.dialogRef.close(this.data.cancel)}},{key:"confirmedAction",value:function(){this.data.cancel=!1,this.dialogRef.close(this.data.cancel)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(ut.so),w.Y36(Ce),w.Y36(ut.WI))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-confirmation-popup-component"]],decls:8,vars:2,consts:[["mat-dialog-content",""],[1,"mat-typography"],["mat-dialog-actions",""],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","",3,"click"]],template:function(e,t){1&e&&(w.TgZ(0,"div",0),w.TgZ(1,"p",1),w._uU(2),w.qZA(),w.qZA(),w.TgZ(3,"div",2),w.TgZ(4,"button",3),w.NdJ("click",function(){return t.confirmedAction()}),w._uU(5,"Ok "),w.qZA(),w.TgZ(6,"button",4),w.NdJ("click",function(){return t.cancelAction()}),w._uU(7),w.qZA(),w.qZA()),2&e&&(w.xp6(2),w.Oqu(t.languageService.translate.instant("add"===t.data.type?"igo.geo.workspace.addConfirmation":"igo.geo.workspace.deleteConfirmation")),w.xp6(5),w.hij("",t.languageService.translate.instant("igo.geo.workspace.cancel")," "))},directives:[ut.xY,ut.H8,S.lW],styles:["div.mat-dialog-actions[_ngcontent-%COMP%]{justify-content:center}"]}),e}(),Ox=function(e){o(i,e);var t=r(i);function i(e,o,n,r){var a;return m(this,i),(a=t.call(this,e)).options=e,a.editionWorkspaceService=o,a.dialog=n,a.configService=r,a.inResolutionRange$=new R.X(!0),a.olDrawingLayerSource=new el.Z,a.geometryType=_h,a.modifyStyle=new ms.ZP({stroke:new ws.Z({color:"rgba(255,255,255,1)",width:1}),fill:new ys.Z({color:"rgba(0,161,222,1)"}),image:new xs.Z({radius:7,stroke:new ws.Z({color:"rgba(255,255,255,1)",width:1}),fill:new ys.Z({color:"rgba(0,161,222,1)"})})}),a.filterClauseFunc=function(e){return!0===e.state.newFeature},a.map.viewController.resolution$.subscribe(function(e){a.inResolutionRange$.next(e>a.layer.minResolution&&e<a.layer.maxResolution)}),a.drawControl=a.createDrawControl(),a.drawControl.setGeometryType(a.geometryType.Point),a.map.removeLayer(a.olDrawingLayer),a.olDrawingLayer=new jc({id:"igo-draw-layer",title:"edition",zIndex:300,source:new _c,showInLayerList:!1,exportable:!1,browsable:!1,workspace:{enabled:!1}}),a}return y(i,[{key:"layer",get:function(){return this.options.layer}},{key:"map",get:function(){return this.options.map}},{key:"getInResolutionRange",value:function(){return this.inResolutionRange$.value}},{key:"deleteFeature",value:function(e,t){var i=this;setTimeout(function(){i.dialog.open(Fx,{disableClose:!1,data:{type:"delete"}}).afterClosed().subscribe(function(o){if(!1===o){var n,r,a=t.layer.dataSource.options.edition.baseUrl,s=t.layer.dataSource.options.edition.deleteUrl;r=a?i.configService.getConfig("edition.url")+a+"?"+s:i.configService.getConfig("edition.url")+s;var l,c=p(t.meta.tableTemplate.columns);try{for(c.s();!(l=c.n()).done;){var u=l.value;for(var d in e.properties){var h=u.name;h.includes("properties.")&&(h=h.split(".")[1]),h===d&&!0===u.primary&&(n=e.properties[d])}}}catch(g){c.e(g)}finally{c.f()}r&&(r+=n,i.editionWorkspaceService.deleteFeature(t,r))}})},250)}},{key:"editFeature",value:function(e,t){var i=this;e.edition=!0;var o,n,r=!1,a=t.layer.dataSource.options.edition,s=p(t.meta.tableTemplate.columns);try{var l=function(){var t=n.value;if(("list"===t.type||"autocomplete"===t.type)&&i.editionWorkspaceService.getDomainValues(t.relation.table).subscribe(function(e){t.domainValues=e}),!1===r)for(var a in e.properties){var s=t.name;if(s.includes("properties.")&&(s=s.split(".")[1]),s===a&&!0===t.primary){o=e.properties[a],r=!0;break}}};for(s.s();!(n=s.n()).done;)l()}catch(c){s.e(c)}finally{s.f()}o?(e.original_properties=JSON.parse(JSON.stringify(e.properties)),e.original_geometry=e.geometry,e.idkey=o,this.addFeatureToStore(e,t)):!e.newFeature&&a.geomType&&(e.newFeature=!0,this.editionWorkspaceService.adding$.next(!0),t.entityStore.state.updateAll({newFeature:!1}),t.entityStore.stateView.filter(this.filterClauseFunc),a.addWithDraw?this.onGeometryTypeChange(a.geomType,e,t):(t.entityStore.insert(e),t.entityStore.state.update(e,{newFeature:!0},!0)))}},{key:"createDrawControl",value:function(e,t,i){return new $h({geometryType:void 0,drawingLayerSource:this.olDrawingLayerSource,drawingLayerStyle:new ms.ZP({}),interactionStyle:pg(e,t,i)})}},{key:"onGeometryTypeChange",value:function(e,t,i){this.drawControl.setGeometryType(e),this.toggleDrawControl(t,i)}},{key:"toggleDrawControl",value:function(e,t){this.deactivateDrawControl(),this.activateDrawControl(e,t)}},{key:"deactivateDrawControl",value:function(){!this.drawControl||(this.drawEnd$$&&this.drawEnd$$.unsubscribe(),this.drawControl.setOlMap(void 0))}},{key:"activateDrawControl",value:function(e,t){var i=this;this.drawEnd$$=this.drawControl.end$.subscribe(function(o){i.addFeatureToStore(e,t,o)}),this.drawControl.setOlMap(this.map.ol,!0)}},{key:"addFeatureToStore",value:function(e,t,i){var o=this.map.ol.getView().getProjection(),n=e.geometry;i&&(t.entityStore.insert(e),t.entityStore.state.update(e,{newFeature:!0},!0),n=(new Zs.Z).writeGeometryObject(i,{featureProjection:o,dataProjection:"EPSG:4326"}),e.geometry=n),e.projection="EPSG:4326";var r=hu(e,o.getCode());this.olDrawingLayer.dataSource.ol.clear(),this.olDrawingLayer.dataSource.ol.addFeature(r),this.map.addLayer(this.olDrawingLayer),this.deactivateDrawControl(),this.createModifyInteraction(r,e,t)}},{key:"deleteDrawings",value:function(){this.map.removeLayer(this.olDrawingLayer),this.olDrawingLayerSource.clear(),this.map.ol.removeInteraction(this.modify)}},{key:"createModifyInteraction",value:function(e,t,i){var o=this;this.map.ol.removeInteraction(this.modify);var n=new Gl.Z([e],{unique:!0});this.modify=new Fl.Z({features:n}),this.map.ol.addInteraction(this.modify),n.forEach(function(e){e.setStyle(o.modifyStyle)}),this.modify.on("modifyend",function(e){var n,r=null===(n=e.features.getArray()[0])||void 0===n?void 0:n.getGeometry();r&&o.addFeatureToStore(t,i,r)})}}]),i}(fr),Mx=function(){var e=function(){function e(t,i,o,n,r,a,s,l){m(this,e),this.layerService=t,this.storageService=i,this.configService=o,this.messageService=n,this.languageService=r,this.http=a,this.dialog=s,this.authInterceptor=l,this.ws$=new R.X(void 0),this.adding$=new R.X(!1),this.relationLayers$=new R.X(void 0),this.rowsInMapExtentCheckCondition$=new R.X(!0),this.loading=!1}return y(e,[{key:"zoomAuto",get:function(){return this.storageService.get("zoomAuto")}},{key:"createWorkspace",value:function(e,t){var i,o,n,r,a,s,l,c,u,p,d,h,g=this;if(!0===(null===(i=e.options.workspace)||void 0===i?void 0:i.enabled)&&!0===e.dataSource.options.edition.enabled){var f;(f=e.options.workspace?e.options.workspace:{}).srcId=e.id,f.workspaceId=e.id,f.enabled=!0,f.pageSize=null===(o=e.options.workspace)||void 0===o?void 0:o.pageSize,f.pageSizeOptions=null===(n=e.options.workspace)||void 0===n?void 0:n.pageSizeOptions;var m=e.dataSource,v=e.id+".WmsWorkspaceTableSrc",y=e.id+".WfsWorkspaceTableDest";e.options.linkedLayers||(e.options.linkedLayers={linkId:v,links:[]});var b={bidirectionnal:!0,syncedDelete:!0,linkedIds:[y],properties:[nc.ZINDEX,nc.VISIBLE]};(null===(r=e.options.workspace)||void 0===r?void 0:r.minResolution)||b.properties.push(nc.MINRESOLUTION);var w=!1;(null===(a=m.options.ogcFilters)||void 0===a?void 0:a.enabled)&&(b.properties.push(nc.OGCFILTERS),w=!0),(null===(s=e.options.workspace)||void 0===s?void 0:s.maxResolution)||b.properties.push(nc.MAXRESOLUTION);var x,S=[];return e.options.linkedLayers.links&&(S=JSON.parse(JSON.stringify(e.options.linkedLayers.links))),S.push(b),e.options.linkedLayers.linkId=e.options.linkedLayers.linkId?e.options.linkedLayers.linkId:v,e.options.linkedLayers.links=S,this.layerService.createAsyncLayer({id:y,linkedLayers:{linkId:y},workspace:{srcId:e.id,workspaceId:void 0,enabled:!1,queryOptions:{mapQueryOnOpenTab:null===(c=null===(l=e.options.workspace)||void 0===l?void 0:l.queryOptions)||void 0===c?void 0:c.mapQueryOnOpenTab,tabQuery:!1},pageSize:null===(u=e.options.workspace)||void 0===u?void 0:u.pageSize,pageSizeOptions:null===(p=e.options.workspace)||void 0===p?void 0:p.pageSizeOptions},showInLayerList:!1,opacity:0,title:e.title,minResolution:(null===(d=e.options.workspace)||void 0===d?void 0:d.minResolution)||e.minResolution||0,maxResolution:(null===(h=e.options.workspace)||void 0===h?void 0:h.maxResolution)||e.maxResolution||1/0,sourceOptions:{download:m.options.download,type:"wfs",url:m.options.urlWfs||m.options.url,queryable:!0,relations:m.options.relations,queryTitle:m.options.queryTitle,params:m.options.paramsWFS,ogcFilters:Object.assign({},m.ogcFilters$.value,{enabled:w}),sourceFields:m.options.sourceFields||void 0,edition:m.options.edition}}).subscribe(function(i){return t.addLayer(i),e.ol.setProperties({linkedLayers:{linkId:e.options.linkedLayers.linkId,links:S}},!1),i.dataSource.ol.refresh(),x=new Ox({id:e.id,title:e.title,layer:i,map:t,entityStore:g.createFeatureStore(i,t),actionStore:new Gn([]),meta:{tableTemplate:void 0}},g,g.dialog,g.configService),g.createTableTemplate(x,i),i.options.workspace.workspaceId=i.id,e.options.workspace=Object.assign({},e.options.workspace,{wksConfig:f}),delete m.options.download,x}),x}}},{key:"createFeatureStore",value:function(e,t){var i=new yu([],{map:t});i.bindLayer(e);var o=new Su({}),n=new bu({}),r=new wu({}),a=new Ot({}),s=new Cu({layer:new jc({zIndex:300,source:new _c,style:void 0,showInLayerList:!1,exportable:!1,browsable:!1}),map:t,hitTolerance:15,motion:this.zoomAuto?tc.Default:tc.None,many:!0,dragBox:!0});return i.addStrategy(o,!0),i.addStrategy(n,!0),i.addStrategy(r,!0),i.addStrategy(s,!0),i.addStrategy(a,!1),i.addStrategy(this.createFilterInMapExtentOrResolutionStrategy(),!0),i}},{key:"createTableTemplate",value:function(e,t){var i,o,n,r=this,a=t.dataSource.options.sourceFields||[],s=t.dataSource.options.relations||[],l=vt.UnsanitizedHTML,c=[],u=[];n=[{name:"edition",title:void 0,renderer:vt.ButtonGroup,primary:!1,valueAccessor:function(){return[{editMode:!1,icon:"pencil",color:"primary",click:function(t){e.editFeature(t,e)}},{editMode:!1,icon:"delete",color:"warn",click:function(t){e.deleteFeature(t,e)}},{editMode:!0,icon:"check",color:"primary",disabled:r.loading,click:function(t){r.saveFeature(t,e)}},{editMode:!0,icon:"alpha-x",color:"primary",disabled:r.loading,click:function(t){r.cancelEdit(e,t)}}]}}],0!==a.length?(c=a.map(function(e){var t={name:"properties.".concat(e.name),title:e.alias?e.alias:e.name,renderer:l,valueAccessor:void 0,cellClassFunc:function(){var t={};if(e.type)return t["class_".concat(e.type)]=!0,t},primary:!0===e.primary,visible:e.visible,validation:e.validation,type:e.type,domainValues:void 0,relation:void 0,multiple:e.multiple,step:e.step,tooltip:e.tooltip};return("list"===e.type||"autocomplete"===e.type)&&r.getDomainValues(e.relation.table).subscribe(function(i){t.domainValues=i,t.relation=e.relation}),t}),u=s.map(function(e){return{name:"properties.".concat(e.name),title:e.alias?e.alias:e.name,renderer:vt.Icon,icon:e.icon,parent:e.parent,type:"relation",tooltip:e.tooltip,onClick:function(){!1===r.adding$.getValue()&&r.ws$.next(e.title)},cellClassFunc:function(){return{class_icon:!0}}}}),(i=c).push.apply(i,d(u)),(o=c).push.apply(o,d(n)),e.meta.tableTemplate={selection:!1,sort:!0,columns:c}):e.entityStore.entities$.pipe((0,Ka.n)(function(e){return 0===e.length}),(0,Ge.q)(1)).subscribe(function(t){var i=t[0].ol,o=i.getKeys().filter(function(e){return!e.startsWith("_")&&"geometry"!==e&&e!==i.getGeometryName()&&!e.match(/boundedby/gi)}).map(function(e){return{name:"properties.".concat(e),title:e,renderer:l}});e.meta.tableTemplate={selection:!1,sort:!0,columns:o}})}},{key:"createFilterInMapExtentOrResolutionStrategy",value:function(){return new Ft({filterClauseFunc:function(e){return!0===e.state.inMapExtent&&!0===e.state.inMapResolution}})}},{key:"saveFeature",value:function(e,t){if(!this.validateFeature(e,t))return!1;this.sanitizeParameter(e,t);var i=this.configService.getConfig("edition.url");if(t.layer.dataSource.options.edition.baseUrl&&(i+=t.layer.dataSource.options.edition.baseUrl),e.newFeature){i+=t.layer.dataSource.options.edition.addUrl;var o=new P.WM(t.layer.dataSource.options.edition.addHeaders);this.addFeature(e,t,i,o)}else{i+="post"!==t.layer.dataSource.options.edition.modifyProtocol?"?"+t.layer.dataSource.options.edition.modifyUrl+e.idkey:t.layer.dataSource.options.edition.modifyUrl;var n=t.layer.dataSource.options.edition.modifyProtocol,r=new P.WM(t.layer.dataSource.options.edition.modifyHeaders);this.modifyFeature(e,t,i,r,n)}}},{key:"addFeature",value:function(e,t,i,o){var n,r=this;for(var a in t.layer.dataSource.options.edition.hasGeometry&&(e.properties.longitude=e.geometry.coordinates[0],e.properties.latitude=e.geometry.coordinates[1]),e.properties){var s,l=p(t.layer.dataSource.options.sourceFields);try{for(l.s();!(s=l.n()).done;){var c=s.value;c.name===a&&(null===(n=c.validation)||void 0===n?void 0:n.readonly)&&delete e.properties[a]}}catch(u){l.e(u)}finally{l.f()}}this.loading=!0,this.http.post("".concat(i),e.properties,{headers:o}).subscribe(function(){r.loading=!1,t.entityStore.stateView.clear(),t.deleteDrawings(),t.entityStore.delete(e);var i=r.languageService.translate.instant("igo.geo.workspace.addSuccess");r.messageService.success(i),r.refreshMap(t.layer,t.layer.map),r.adding$.next(!1),r.rowsInMapExtentCheckCondition$.next(!0)},function(e){r.loading=!1,e.error.caught=!0;var i,o=r.languageService.translate.instant("igo.geo.workspace.addError"),n=t.layer.dataSource.options.edition.messages;n?(n.forEach(function(t){var o=Object.keys(t)[0];e.error.message.includes(o)&&(i=t[o],r.messageService.error(i))}),i||r.messageService.error(o)):r.messageService.error(o)})}},{key:"deleteFeature",value:function(e,t){var i=this;this.loading=!0,this.http.delete("".concat(t),{}).subscribe(function(){i.loading=!1;var t=i.languageService.translate.instant("igo.geo.workspace.deleteSuccess");i.messageService.success(t),i.refreshMap(e.layer,e.layer.map);var o,n=p(e.layer.options.sourceOptions.relations);try{var r=function(){var t=o.value;e.map.layers.forEach(function(e){e.title===t.title&&e.dataSource.ol.refresh()})};for(n.s();!(o=n.n()).done;)r()}catch(a){n.e(a)}finally{n.f()}},function(t){i.loading=!1,t.error.caught=!0;var o,n=i.languageService.translate.instant("igo.geo.workspace.addError"),r=e.layer.dataSource.options.edition.messages;r?(r.forEach(function(e){var n=Object.keys(e)[0];t.error.message.includes(n)&&(o=e[n],i.messageService.error(o))}),o||i.messageService.error(n)):i.messageService.error(n)})}},{key:"modifyFeature",value:function(e,t,i,o){var n,r=this,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"patch";for(var s in t.layer.dataSource.options.edition.hasGeometry&&(e.properties.longitude=e.geometry.coordinates[0],e.properties.latitude=e.geometry.coordinates[1]),e.properties){var l,c=p(t.layer.dataSource.options.sourceFields);try{for(c.s();!(l=c.n()).done;){var u=l.value;(u.name===s&&(null===(n=u.validation)||void 0===n?void 0:n.readonly)||"boundedBy"===s)&&delete e.properties[s]}}catch(d){c.e(d)}finally{c.f()}}this.loading=!0,this.http[a]("".concat(i),e.properties,{headers:o}).subscribe(function(){r.loading=!1,r.cancelEdit(t,e,!0);var i=r.languageService.translate.instant("igo.geo.workspace.modifySuccess");r.messageService.success(i),r.refreshMap(t.layer,t.layer.map);var o,n=[],a=p(t.layer.options.sourceOptions.relations);try{var s=function(){var e=o.value;t.map.layers.forEach(function(t){t.title===e.title&&(n.push(t),t.dataSource.ol.refresh())})};for(a.s();!(o=a.n()).done;)s()}catch(d){a.e(d)}finally{a.f()}r.relationLayers$.next(n)},function(e){r.loading=!1,e.error.caught=!0;var i,o=r.languageService.translate.instant("igo.geo.workspace.addError"),n=t.layer.dataSource.options.edition.messages;n?(n.forEach(function(t){var o=Object.keys(t)[0];e.error.message.includes(o)&&(i=t[o],r.messageService.error(i))}),i||r.messageService.error(o)):r.messageService.error(o)})}},{key:"cancelEdit",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t.edition=!1,this.adding$.next(!1),e.deleteDrawings(),t.newFeature?(e.entityStore.stateView.clear(),e.entityStore.delete(t),e.deactivateDrawControl(),this.rowsInMapExtentCheckCondition$.next(!0)):(i||(t.properties=t.original_properties,t.geometry=t.original_geometry),delete t.original_properties,delete t.original_geometry)}},{key:"getDomainValues",value:function(e){var t=this.configService.getConfig("edition.url")+e;return this.http.get(t).pipe((0,D.U)(function(e){return e}),(0,q.K)(function(e){return(0,N._)(e)}))}},{key:"refreshMap",value:function(e,t){var i,o,n=this,r=e.dataSource.ol;r.setLoader(function(t,i,o,r,a){e.customWFSLoader(e.ol.getSource(),e.options.sourceOptions,n.authInterceptor,t,i,o,r,a,!0)}),r.refresh();var a,s=p(t.layers);try{for(s.s();!(a=s.n()).done;){var l=a.value;if(l.id!==e.id&&(null===(i=l.options.linkedLayers)||void 0===i?void 0:i.linkId.includes(e.id.substr(0,e.id.indexOf(".")-1)))&&(null===(o=l.options.linkedLayers)||void 0===o?void 0:o.linkId.includes("WmsWorkspaceTableSrc"))){var c=l.dataSource.ol,u=c.getParams();u._t=(new Date).getTime(),c.updateParams(u)}}}catch(d){s.e(d)}finally{s.f()}}},{key:"validateFeature",value:function(e,t){var i,o,n=this,r=this.languageService.translate,a=!0;return t.meta.tableTemplate.columns.forEach(function(t){t.hasOwnProperty("validation")&&t.validation&&(o=Ix(t.name),Object.keys(t.validation).forEach(function(s){switch(s){case"mandatory":t.validation[s]&&(!e.properties.hasOwnProperty(o)||!e.properties[o])&&(a=!1,i=r.instant("igo.geo.formValidation.mandatory",{column:t.title}),n.messageService.error(i));break;case"minValue":e.properties.hasOwnProperty(o)&&e.properties[o]&&e.properties[o]<t.validation[s]&&(a=!1,i=r.instant("igo.geo.formValidation.minValue",{column:t.title,value:t.validation[s]}),n.messageService.error(i));break;case"maxValue":e.properties.hasOwnProperty(o)&&e.properties[o]&&e.properties[o]>t.validation[s]&&(a=!1,i=r.instant("igo.geo.formValidation.maxValue",{column:t.title,value:t.validation[s]}),n.messageService.error(i));break;case"minLength":e.properties.hasOwnProperty(o)&&e.properties[o]&&e.properties[o].length<t.validation[s]&&(a=!1,i=r.instant("igo.geo.formValidation.minLength",{column:t.title,value:t.validation[s]}),n.messageService.error(i));break;case"maxLength":e.properties.hasOwnProperty(o)&&e.properties[o]&&e.properties[o].length>t.validation[s]&&(a=!1,i=r.instant("igo.geo.formValidation.maxLength",{column:t.title,value:t.validation[s]}),n.messageService.error(i))}}))}),a}},{key:"sanitizeParameter",value:function(e,t){t.meta.tableTemplate.columns.forEach(function(t){"list"===t.type&&e.properties[Ix(t.name)]&&(e.properties[Ix(t.name)]=e.properties[Ix(t.name)].toString())})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(Xu),w.LFG(De),w.LFG(he),w.LFG(Ae),w.LFG(Ce),w.LFG(P.eN),w.LFG(ut.uw),w.LFG(Ea))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function Ix(e){return e.includes("properties.")?e.split(".")[1]:e}var Px=function(e){o(i,e);var t=r(i);function i(e){var o;return m(this,i),(o=t.call(this,e)).options=e,o.inResolutionRange$=new R.X(!0),o.map.viewController.resolution$.subscribe(function(e){o.inResolutionRange$.next(e>o.layer.minResolution&&e<o.layer.maxResolution)}),o}return y(i,[{key:"layer",get:function(){return this.options.layer}},{key:"map",get:function(){return this.options.map}},{key:"getLayerWksOptionTabQuery",value:function(){var e;return void 0===(null===(e=this.layer.options.workspace.queryOptions)||void 0===e?void 0:e.tabQuery)||this.layer.options.workspace.queryOptions.tabQuery}},{key:"getLayerWksOptionMapQuery",value:function(){var e;return void 0===(null===(e=this.layer.options.workspace.queryOptions)||void 0===e?void 0:e.mapQueryOnOpenTab)||this.layer.options.workspace.queryOptions.mapQueryOnOpenTab}},{key:"getInResolutionRange",value:function(){return this.inResolutionRange$.value}}]),i}(fr),_x=function(){var e=function(){function e(t){m(this,e),this.storageService=t,this.ws$=new R.X(void 0)}return y(e,[{key:"zoomAuto",get:function(){return this.storageService.get("zoomAuto")}},{key:"createWorkspace",value:function(e,t){var i;if(!1!==(null===(i=e.options.workspace)||void 0===i?void 0:i.enabled)&&!e.dataSource.options.edition){e.options.workspace=Object.assign({},e.options.workspace,{srcId:e.id,workspaceId:e.id,enabled:!0});var o=new Px({id:e.id,title:e.title,layer:e,map:t,entityStore:this.createFeatureStore(e,t),actionStore:new Gn([]),meta:{tableTemplate:void 0}});return this.createTableTemplate(o,e),o}}},{key:"createFeatureStore",value:function(e,t){var i=new yu([],{map:t});i.bindLayer(e);var o=new Su({}),n=new bu({}),r=new wu({}),a=new Ot({}),s=new Cu({layer:new jc({zIndex:300,source:new _c,style:void 0,showInLayerList:!1,exportable:!1,browsable:!1}),map:t,hitTolerance:15,motion:this.zoomAuto?tc.Default:tc.None,many:!0,dragBox:!0});return i.addStrategy(o,!0),i.addStrategy(n,!0),i.addStrategy(r,!0),i.addStrategy(s,!0),i.addStrategy(a,!1),i.addStrategy(this.createFilterInMapExtentOrResolutionStrategy(),!0),i}},{key:"createTableTemplate",value:function(e,t){var i=this,o=t.dataSource.options.sourceFields||[],n=t.dataSource.options.relations||[];if(0!==o.length){var r=o.map(function(e){return{name:"properties.".concat(e.name),title:e.alias?e.alias:e.name,renderer:vt.UnsanitizedHTML,tooltip:e.tooltip}}),a=n.map(function(e){return{name:"properties.".concat(e.name),title:e.alias?e.alias:e.name,renderer:vt.Icon,icon:e.icon,parent:e.parent,type:"relation",tooltip:e.tooltip,onClick:function(){i.ws$.next(e.title)},cellClassFunc:function(){return{class_icon:!0}}}});r.push.apply(r,d(a)),e.meta.tableTemplate={selection:!0,sort:!0,columns:r}}else e.entityStore.entities$.pipe((0,Ka.n)(function(e){return 0===e.length}),(0,Ge.q)(1)).subscribe(function(t){var i=t[0].ol,o=i.getKeys().filter(function(e){return!e.startsWith("_")&&"geometry"!==e&&e!==i.getGeometryName()&&!e.match(/boundedby/gi)}).map(function(e){return{name:"properties.".concat(e),title:e,renderer:vt.UnsanitizedHTML}});e.meta.tableTemplate={selection:!0,sort:!0,columns:o}})}},{key:"createFilterInMapExtentOrResolutionStrategy",value:function(){return new Ft({filterClauseFunc:function(e){return!0===e.state.inMapExtent&&!0===e.state.inMapResolution}})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(De))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),qx=function(){var e=function(){function e(t,i,o,n,r){m(this,e),this.component=t,this.wfsWorkspaceService=i,this.wmsWorkspaceService=o,this.editionWorkspaceService=n,this.featureWorkspaceService=r,this.entities$$=[],this.changeWorkspace=new w.vpe,this.disableSwitch=new w.vpe,this.relationLayers=new w.vpe,this.rowsInMapExtentCheckCondition=new w.vpe}return y(e,[{key:"workspaceStore",get:function(){return this.component.store}},{key:"ngOnInit",value:function(){var e=this;this.layers$$=this.map.layers$.pipe((0,E.b)(50)).subscribe(function(t){return e.onLayersChange(t)}),this.featureWorkspaceService.ws$.subscribe(function(t){e.changeWorkspace.emit(t)}),this.wmsWorkspaceService.ws$.subscribe(function(t){e.changeWorkspace.emit(t)}),this.wfsWorkspaceService.ws$.subscribe(function(t){e.changeWorkspace.emit(t)}),this.editionWorkspaceService.ws$.subscribe(function(t){e.changeWorkspace.emit(t)}),this.editionWorkspaceService.adding$.subscribe(function(t){e.disableSwitch.emit(t)}),this.editionWorkspaceService.relationLayers$.subscribe(function(t){e.relationLayers.emit(t)}),this.editionWorkspaceService.rowsInMapExtentCheckCondition$.subscribe(function(t){e.rowsInMapExtentCheckCondition.emit(t)})}},{key:"ngOnDestroy",value:function(){this.layers$$.unsubscribe(),this.entities$$.map(function(e){return e.unsubscribe()})}},{key:"onLayersChange",value:function(e){var t=this,i=e.filter(function(e){return t.layerIsEditable(e)}),o=i.map(function(e){return e.id}),n=i.map(function(e){return t.getOrCreateWorkspace(e)}).filter(function(e){return void 0!==e}),r=this.workspaceStore.all().filter(function(e){return o.indexOf(e.id)<0});r.length>0&&(r.forEach(function(e){e.entityStore.deactivateStrategyOfType(bu),e.deactivate()}),this.workspaceStore.state.updateMany(r,{active:!1,selected:!1}),this.workspaceStore.deleteMany(r)),n.length>0&&this.workspaceStore.insertMany(n)}},{key:"getOrCreateWorkspace",value:function(e){var t,i,o,n;if(void 0===this.workspaceStore.get(e.id)){if(e.dataSource instanceof Yc&&!0!==(null===(t=e.dataSource.options.edition)||void 0===t?void 0:t.enabled))return this.wfsWorkspaceService.createWorkspace(e,this.map);if(e.dataSource instanceof Mc&&!0!==(null===(i=e.dataSource.options.edition)||void 0===i?void 0:i.enabled)){if(!e.dataSource.options.paramsWFS)return;var r=this.wmsWorkspaceService.createWorkspace(e,this.map);return null==r||r.inResolutionRange$.subscribe(function(t){e.dataSource.options.queryable=!t,r.layer.dataSource.options.queryable=t}),r}if(e.dataSource instanceof _c&&!0===e.exportable&&!0!==(null===(o=e.dataSource.options.edition)||void 0===o?void 0:o.enabled))return this.featureWorkspaceService.createWorkspace(e,this.map);if(e.dataSource instanceof Mc&&!0===(null===(n=e.dataSource.options.edition)||void 0===n?void 0:n.enabled))return this.editionWorkspaceService.createWorkspace(e,this.map)}}},{key:"layerIsEditable",value:function(e){var t,i,o=e.dataSource;return o instanceof Yc||o instanceof _c||o instanceof Mc&&((null===(t=(o.options||{}).ogcFilters)||void 0===t?void 0:t.enabled)||void 0!==(null===(i=o.options.paramsWFS)||void 0===i?void 0:i.featureTypes))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(ar),w.Y36(Lx),w.Y36(Zx),w.Y36(Mx),w.Y36(_x))},e.\u0275dir=w.lG2({type:e,selectors:[["","igoWorkspaceSelector",""]],inputs:{map:"map"},outputs:{changeWorkspace:"changeWorkspace",disableSwitch:"disableSwitch",relationLayers:"relationLayers",rowsInMapExtentCheckCondition:"rowsInMapExtentCheckCondition"}}),e}(),Dx=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez]]}),e}(),Ex=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez]]}),e}(),$x=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,S.ot,ut.Is,Al.vV]]}),e}(),Rx=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({providers:[{provide:kx,useFactory:Cx,deps:[nr]}],imports:[[F.ez,Se,rr,Dx,Ex,Tx,ut.Is],Dx,Ex,Tx,$x]}),e}(),Nx=function(e){o(i,e);var t=r(i);function i(){var e;return m(this,i),(e=t.apply(this,arguments)).storeInitialized$=new R.X(!1),e}return y(i,[{key:"clearStops",value:function(){this.storeInitialized$.next(!1),this.clear()}}]),i}(At),Ux=function(e){o(i,e);var t=r(i);function i(){return m(this,i),t.apply(this,arguments)}return i}(yu),Jx=function(e){o(i,e);var t=r(i);function i(){return m(this,i),t.apply(this,arguments)}return i}(yu),Bx=function(e){o(i,e);var t=r(i);function i(){return m(this,i),t.apply(this,arguments)}return i}(yu),jx=function(){var e=function(e){o(i,e);var t=r(i);function i(e,o){var n;return m(this,i),(n=t.call(this)).http=e,n.config=o,n.directionsUrl="https://geoegl.msp.gouv.qc.ca/services/itineraire/route/v1/driving/",n.options=n.config.getConfig("directionsSources.osrm")||{},n.directionsUrl=n.options.url||n.directionsUrl,n}return y(i,[{key:"enabled",get:function(){return!1!==this.options.enabled},set:function(e){this.options.enabled=e}},{key:"getName",value:function(){return i._name}},{key:"route",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=this.getRouteParams(i);return this.http.get(this.directionsUrl+e.join(";"),{params:o}).pipe((0,D.U)(function(e){return t.extractRoutesData(e)}))}},{key:"extractRoutesData",value:function(e){var t=this,i=[];return e.routes.forEach(function(o){i.push(t.formatRoute(o,e.waypoints))}),i}},{key:"getRouteParams",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.alternatives=void 0===e.alternatives||e.alternatives,e.steps=void 0===e.steps||e.steps,e.geometries=void 0!==e.geometries?e.geometries:"geojson",e.overview=void 0!==e.overview&&e.overview,e.continue_straight=void 0!==e.continue_straight&&e.continue_straight,new P.LE({fromObject:{alternatives:e.alternatives?"true":"false",overview:e.overview?"simplified":"full",steps:e.steps?"true":"false",geometries:e.geometries?e.geometries:"geojson",continue_straight:e.continue_straight?"true":"false"}})}},{key:"formatRoute",value:function(e,t){var o=[];return e.legs.forEach(function(e){e.steps.forEach(function(e){o.push(e)})}),{id:oe(),title:e.legs[0].summary,source:i._name,sourceType:xb.Route,order:1,format:wb.GeoJSON,icon:"directions",projection:"EPSG:4326",waypoints:t,distance:e.distance,duration:e.duration,geometry:e.geometry,legs:e.legs,steps:o,weight:e.weight,weight_name:e.weight_name}}}]),i}(vb);return e._name="OSRM Qu\xe9bec",e.\u0275fac=function(t){return new(t||e)(w.LFG(P.eN),w.LFG(he))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac}),(0,at.gn)([(0,st.q)({maxCacheCount:20})],e.prototype,"route",null),e}();function Qx(e,t){return new jx(e,t)}var Gx=function(){var e=function(e){o(i,e);var t=r(i);function i(e,o,n,r){var a;return m(this,i),(a=t.call(this,r,n)).http=e,a.languageService=o,a}return y(i,[{key:"getId",value:function(){return i.id}},{key:"getType",value:function(){return i.type}},{key:"getDefaultOptions",value:function(){return{title:"Cadastre (Qu\xe9bec)",searchUrl:"https://carto.cptaq.gouv.qc.ca/php/find_lot_v1.php?"}}},{key:"search",value:function(e,t){var i=this;e=(e=(e=e.endsWith(",")?e.slice(0,-1):e).startsWith(",")?e.substr(1):e).replace(/ /g,"");var o=this.computeSearchRequestParams(e,t||{});return o.get("numero")&&o.get("numero").match(/^[0-9,]+$/g)?this.http.get(this.searchUrl,{params:o,responseType:"text"}).pipe((0,D.U)(function(t){return i.extractResults(t,e)})):(0,U.of)([])}},{key:"computeSearchRequestParams",value:function(e,t){return new P.LE({fromObject:Object.assign({numero:e,epsg:"4326"},this.params,t.params||{})})}},{key:"extractResults",value:function(e,t){var i=this;return e.split("<br />").filter(function(e){return e.length>0}).map(function(e){return i.dataToResult(e,t)})}},{key:"dataToResult",value:function(e,t){var i=e.split(";"),o=i[0],n=this.computeGeometry(i[7]),r={NoLot:o,Route:'<span class="routing"> <u>'+this.languageService.translate.instant("igo.geo.seeRouting")+"</u> </span>"},a=[this.getId(),"cadastre",o].join(".");return{source:this,meta:{dataType:ec,id:a,title:o,score:Qb(t.trim(),o),icon:"map-marker"},data:{type:ec,projection:"EPSG:4326",geometry:n,properties:r,meta:{id:a,title:o}}}}},{key:"computeGeometry",value:function(e){var t=(new $s.Z).readFeature(e,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});return{type:t.getGeometry().getType(),coordinates:t.getGeometry().getCoordinates()}}}]),i}(xp);return e.id="cadastre",e.type=ec,e.\u0275fac=function(t){return new(t||e)(w.LFG(P.eN),w.LFG(Ce),w.LFG(De),w.LFG("options"))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac}),(0,at.gn)([(0,st.q)({maxCacheCount:20})],e.prototype,"search",null),e}();function Yx(e,t,i,o){return new Gx(e,t,i,o.getConfig("searchSources.".concat(Gx.id)))}var zx=function(){var e=function(e){o(n,e);var t=r(n);function n(e,i,o){var r;return m(this,n),(r=t.call(this,i,o)).http=e,r}return y(n,[{key:"getId",value:function(){return n.id}},{key:"getType",value:function(){return n.type}},{key:"getDefaultOptions",value:function(){return{title:"Nominatim (OSM)",searchUrl:"https://nominatim.openstreetmap.org/search",settings:[{type:"checkbox",title:"results type",name:"amenity",values:[{title:"igo.geo.search.nominatim.type.food",value:"bar,bbq,biergaten,cafe,drinking_water,fast_food,food_court,ice_cream,pub,restaurant",enabled:!1},{title:"igo.geo.search.nominatim.type.health",value:"baby_hatch,clinic,dentist,doctors,hospital,nursing_home,pharmacy,social_facility,veterinary",enabled:!1},{title:"igo.geo.search.nominatim.type.entertainment",value:"arts_centre,brothel,casino,cinema,community_center_fountain,gambling,nightclub,planetarium                           ,public_bookcase,social_centre,stripclub,studio,swingerclub,theatre,internet_cafe",enabled:!1},{title:"igo.geo.search.nominatim.type.finance",value:"atm,bank,bureau_de_change",enabled:!1}]},{type:"radiobutton",title:"results limit",name:"limit",values:[{title:"10",value:10,enabled:!0},{title:"20",value:20,enabled:!1},{title:"50",value:50,enabled:!1}]},{type:"radiobutton",title:"restrictExtent",name:"countrycodes",values:[{title:"igo.geo.search.nominatim.country.canada",value:"CA",enabled:!0},{title:"igo.geo.search.nominatim.country.all",value:null,enabled:!1}]},{type:"radiobutton",title:"multiple object",name:"dedupe",values:[{title:"igo.geo.search.searchSources.settings.true",value:0,enabled:!1},{title:"igo.geo.search.searchSources.settings.false",value:1,enabled:!0}]}]}}},{key:"search",value:function(e,t){var i=this,o=this.computeSearchRequestParams(e,t||{});return o.get("q")?this.http.get(this.searchUrl,{params:o}).pipe((0,D.U)(function(t){return i.extractResults(t,e)})):(0,U.of)([])}},{key:"computeSearchRequestParams",value:function(e,t){return new P.LE({fromObject:Object.assign({q:this.computeTerm(e),format:"json"},this.params,t.params||{})})}},{key:"extractResults",value:function(e,t){var i=this;return e.map(function(e){return i.dataToResult(e,t)})}},{key:"dataToResult",value:function(e,t){var i=this.computeProperties(e),o=this.computeGeometry(e),n=this.computeExtent(e),r=[this.getId(),"place",e.place_id].join(".");return{source:this,meta:{dataType:ec,id:r,title:e.display_name,icon:"map-marker",score:Qb(t.trim(),e.display_name)},data:{type:ec,projection:"EPSG:4326",geometry:o,extent:n,properties:i,meta:{id:r,title:e.display_name}}}}},{key:"computeProperties",value:function(e){return{display_name:e.display_name,place_id:e.place_id,osm_type:e.osm_type,class:e.class,type:e.type}}},{key:"computeGeometry",value:function(e){return{type:"Point",coordinates:[parseFloat(e.lon),parseFloat(e.lat)]}}},{key:"computeExtent",value:function(e){return[parseFloat(e.boundingbox[2]),parseFloat(e.boundingbox[0]),parseFloat(e.boundingbox[3]),parseFloat(e.boundingbox[1])]}},{key:"computeTerm",value:function(e){return this.computeTermTags(e)}},{key:"computeTermTags",value:function(e){var t=i(c(n.prototype),"getHashtagsValid",this).call(this,e,"amenity");return t?t.length?(e=e.replace(/(#[^\s]*)/g,""),t.forEach(function(t){e+="+["+t+"]"}),e):null:this.computeTermSettings(e)}},{key:"computeTermSettings",value:function(e){return this.options.settings.forEach(function(t){"amenity"===t.name&&t.values.forEach(function(t){t.enabled&&"string"==typeof t.value&&t.value.split(",").forEach(function(t){e+="+["+t+"]"})})}),e}}]),n}(xp);return e.id="nominatim",e.type=ec,e.\u0275fac=function(t){return new(t||e)(w.LFG(P.eN),w.LFG("options"),w.LFG(De))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac}),(0,at.gn)([(0,st.q)({maxCacheCount:20})],e.prototype,"search",null),e}();function Vx(e,t,i){return new zx(e,t.getConfig("searchSources.".concat(zx.id)),i)}var Hx=function(){var e=function(e){o(i,e);var t=r(i);function i(e,o,n,r){var s;if(m(this,i),(s=t.call(this,r,n)).http=e,s.languageService=o,s.storedQueriesOptions=r,s.storedQueriesOptions&&!s.storedQueriesOptions.available)return a(s);var l="title";if(s.storedQueriesOptions||(console.log(" No configuration for this search source (storedqueries). You will use the default values"),s.storedQueriesOptions={storedquery_id:"rtss",fields:[{name:"rtss",defaultValue:"-99"},{name:"chainage",defaultValue:"0",splitPrefix:"\\+"}],outputformat:"text/xml; subtype=gml/3.1.1",srsname:"EPSG:4326",resultTitle:l},s.resultTitle=l,console.log("Default values",s.storedQueriesOptions)),!s.storedQueriesOptions.storedquery_id)throw new Error('Stored Queries :You have to set "storedquery_id" into StoredQueries options. ex: storedquery_id: "nameofstoredquerie"');if(!s.storedQueriesOptions.fields)throw new Error('Stored Queries :You have to set "fields" into options. ex: fields: {"name": "rtss", "defaultValue": "-99"}');if(s.storedQueriesOptions.outputformat=s.storedQueriesOptions.outputformat||"text/xml; subtype=gml/3.1.1",s.storedQueriesOptions.srsname=s.storedQueriesOptions.srsname||"EPSG:4326",s.storedQueriesOptions.storedquery_id.toLowerCase().includes("getfeaturebyid")&&s.storedQueriesOptions.outputformat.toLowerCase().includes("getfeaturebyid")){throw" (wfs 1.1.0 & gml 3.1.1 limitation)",new Error("You must set a geojson format for your stored query. This is due to an openlayers issue) (wfs 1.1.0 & gml 3.1.1 limitation)")}return s.storedQueriesOptions.fields instanceof Array||(s.storedQueriesOptions.fields=[s.storedQueriesOptions.fields]),s.multipleFieldsQuery=s.storedQueriesOptions.fields.length>1,s.storedQueriesOptions.fields.forEach(function(e,t){if(s.multipleFieldsQuery&&!e.splitPrefix&&0!==t)throw new Error("Stored Queries :You must set a field spliter into your field definition (optional for the first one!)");if(!e.defaultValue)throw new Error("Stored Queries :You must set a field default value into your field definition")}),s.storedQueriesOptions.resultTitle=s.storedQueriesOptions.resultTitle||s.resultTitle,a(s)}return y(i,[{key:"getId",value:function(){return i.id}},{key:"getType",value:function(){return i.type}},{key:"getDefaultOptions",value:function(){return{title:"Stored Queries",searchUrl:"https://ws.mapserver.transports.gouv.qc.ca/swtq"}}},{key:"search",value:function(e,t){var i=this,o=this.termSplitter(e,this.storedQueriesOptions.fields),n=this.computeRequestParams(t||{},o);return this.options.params=this.options.params?this.options.params:{},this.options.params.page=t.page?String(t.page):"1",new RegExp(".*?gml.*?","i").test(this.storedQueriesOptions.outputformat)?this.http.get(this.searchUrl,{params:n,responseType:"text"}).pipe((0,D.U)(function(t){var o=i.extractResults(i.extractWFSData(t),e);if(o.sort(function(e,t){return e.meta.score>t.meta.score||e.meta.score===t.meta.score&&e.meta.titleHtml<t.meta.titleHtml?1:-1}),o.reverse(),o.length>Number(i.options.params.limit)){var n=Number(i.options.params.limit)*Number(i.options.params.page),r=o.length;(o=o.slice(0,n))[o.length-1].meta.nextPage=n<r}return o})):this.http.get(this.searchUrl,{params:n}).pipe((0,D.U)(function(t){return i.extractResults(i.extractWFSData(t),e)}))}},{key:"getFormatFromOptions",value:function(){var e,t=this.storedQueriesOptions.outputformat,i=new RegExp(".*?gml.*?","i");return new RegExp(".*?json.*?","i").test(t)&&(e=Zs.Z),i.test(t)&&(e=Rs.Z),new e}},{key:"extractWFSData",value:function(e){var t=this.getFormatFromOptions(),i=Zs.Z,o=t.readFeatures(e);return JSON.parse((new i).writeFeatures(o))}},{key:"termSplitter",value:function(e,t){var i={},o=e,n=0;return t.forEach(function(e){i[e.name]=e.defaultValue;var t=new RegExp(e.splitPrefix+"(.+)","i");t.test(o)&&(n=e.splitPrefix?n+=1:n,o=o.split(t)[1])}),0===n?(i[t[0].name]=e,i):(o=e,d(t).reverse().forEach(function(e){var t=new RegExp(e.splitPrefix||"(.+)","i");if(o||""!==o){var n=o.split(t);o=n[0],n[1]&&(i[e.name]=n[1].trim())}}),i)}},{key:"computeRequestParams",value:function(e,t){var i=this.storedQueriesOptions.storedquery_id.toLowerCase().includes("getfeaturebyid")?"2.0.0":"1.1.0";return new P.LE({fromObject:Object.assign({service:"wfs",version:i,request:"GetFeature",storedquery_id:this.storedQueriesOptions.storedquery_id,srsname:this.storedQueriesOptions.srsname,outputformat:this.storedQueriesOptions.outputformat},t,this.params,e.params||{})})}},{key:"extractResults",value:function(e,t){var i=this;return e.features.map(function(e){return i.dataToResult(e,t)})}},{key:"dataToResult",value:function(e,t){var i=this.computeProperties(e),o=[this.getId(),i.type,e.id].join("."),n=e.properties[this.storedQueriesOptions.resultTitle]?this.storedQueriesOptions.resultTitle:this.resultTitle;return{source:this,data:{type:ec,projection:"EPSG:4326",geometry:e.geometry,properties:i,meta:{id:o,title:e.properties[n]}},meta:{dataType:ec,id:o,title:e.properties.title,titleHtml:e.properties[n],icon:"map-marker",score:Qb(t.trim(),e.properties.title?e.properties.title:e.properties[n])}}}},{key:"computeProperties",value:function(e){return Object.assign({},K.removeKeys(e.properties,i.propertiesBlacklist),{Route:'<span class="routing"> <u>'+this.languageService.translate.instant("igo.geo.seeRouting")+"</u> </span>"})}}]),i}(xp);return e.id="storedqueries",e.type=ec,e.propertiesBlacklist=["boundedBy","id","coord_x","coord_y"],e.\u0275fac=function(t){return new(t||e)(w.LFG(P.eN),w.LFG(Ce),w.LFG(De),w.LFG("options"))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac}),(0,at.gn)([(0,st.q)({maxCacheCount:20})],e.prototype,"search",null),e}(),Wx=function(){var e=function(e){o(i,e);var t=r(i);function i(e,o,n,r){var s;if(m(this,i),(s=t.call(this,r,n)).http=e,s.languageService=o,s.storedQueriesOptions=r,s.storedQueriesOptions&&(!s.storedQueriesOptions||s.storedQueriesOptions.available)){if(!s.storedQueriesOptions.storedquery_id)throw new Error('Stored Queries :You have to set "storedquery_id" into StoredQueries options. ex: storedquery_id: "nameofstoredquerie"');if(!s.storedQueriesOptions.longField)throw new Error('Stored Queries :You have to set "longField" to map the longitude coordinate to the query params.');if(!s.storedQueriesOptions.latField)throw new Error('Stored Queries :You have to set "latField" to map the latitude coordinate to the query params.');s.storedQueriesOptions.outputformat=s.storedQueriesOptions.outputformat||"text/xml; subtype=gml/3.1.1",s.storedQueriesOptions.srsname=s.storedQueriesOptions.srsname||"EPSG:4326",s.storedQueriesOptions.resultTitle=s.storedQueriesOptions.resultTitle||s.resultTitle}return a(s)}return y(i,[{key:"getId",value:function(){return i.id}},{key:"getType",value:function(){return i.type}},{key:"getDefaultOptions",value:function(){return{title:"Stored Queries (reverse)",searchUrl:"https://ws.mapserver.transports.gouv.qc.ca/swtq"}}},{key:"reverseSearch",value:function(e,t){var i=this,o=this.computeRequestParams(e,t||{});return new RegExp(".*?gml.*?","i").test(this.storedQueriesOptions.outputformat)?this.http.get(this.searchUrl,{params:o,responseType:"text"}).pipe((0,D.U)(function(e){return i.extractResults(i.extractWFSData(e))})):this.http.get(this.searchUrl,{params:o}).pipe((0,D.U)(function(e){return i.extractResults(i.extractWFSData(e))}))}},{key:"getFormatFromOptions",value:function(){var e,t=this.storedQueriesOptions.outputformat,i=new RegExp(".*?gml.*?","i");return new RegExp(".*?json.*?","i").test(t)&&(e=Zs.Z),i.test(t)&&(e=Rs.Z),new e}},{key:"extractWFSData",value:function(e){var t=this.getFormatFromOptions(),i=Zs.Z,o=t.readFeatures(e);return JSON.parse((new i).writeFeatures(o))}},{key:"computeRequestParams",value:function(e,t){var i={};return i[this.storedQueriesOptions.longField]=e[0],i[this.storedQueriesOptions.latField]=e[1],new P.LE({fromObject:Object.assign({service:"WFS",version:"1.1.0",request:"GetFeature",storedquery_id:this.storedQueriesOptions.storedquery_id,srsname:this.storedQueriesOptions.srsname,outputformat:this.storedQueriesOptions.outputformat},i,this.params,t.params||{})})}},{key:"extractResults",value:function(e){var t=this;return e.features.map(function(e){return t.dataToResult(e)})}},{key:"dataToResult",value:function(e){var t=this.computeProperties(e),i=[this.getId(),t.type,e.id].join("."),o=e.properties[this.storedQueriesOptions.resultTitle]?this.storedQueriesOptions.resultTitle:this.resultTitle;return{source:this,data:{type:ec,projection:"EPSG:4326",geometry:e.geometry,properties:t,meta:{id:i,title:e.properties[o]}},meta:{dataType:ec,id:i,title:e.properties[o],icon:"map-marker"}}}},{key:"computeProperties",value:function(e){var t=K.removeKeys(e.properties,i.propertiesBlacklist),o={Route:'<span class="routing"> <u>'+this.languageService.translate.instant("igo.geo.seeRouting")+"</u> </span>"};return Object.assign(t,{type:e.properties.doc_type},o)}}]),i}(xp);return e.id="storedqueriesreverse",e.type=ec,e.propertiesBlacklist=[],e.\u0275fac=function(t){return new(t||e)(w.LFG(P.eN),w.LFG(Ce),w.LFG(De),w.LFG("options"))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac}),(0,at.gn)([(0,st.q)({maxCacheCount:20})],e.prototype,"reverseSearch",null),e}();function Xx(e,t,i,o){return new Hx(e,t,i,o.getConfig("searchSources.".concat(Hx.id)))}function Kx(e,t,i,o){return new Wx(e,t,i,o.getConfig("searchSources.".concat(Wx.id)))}function eS(e){return e.entityStore.getStrategyOfType(Ft).active$.pipe((0,D.U)(function(e){return e?"igo.geo.workspace.inMapExtent.active.tooltip":"igo.geo.workspace.inMapExtent.inactive.tooltip"}))}function tS(e){return e.entityStore.stateView.manyBy$(function(e){return!0===e.state.selected}).pipe((0,D.U)(function(e){return e.length>=1}))}function iS(e,t){if(1&e&&(w.TgZ(0,"p"),w._uU(1),w.qZA()),2&e){var i=w.oxw();w.xp6(1),w.Oqu(i.pointerCoord)}}var oS=Z.Bz.forChild([{path:"simple-map",component:function(){var e=function(){function e(t,i,o,n){var r=this;m(this,e),this.languageService=t,this.dataSourceService=i,this.layerService=o,this.mediaService=n,this.pointerCoordDelay=0,this.map=new _u({controls:{attribution:{collapsed:!0},scaleLine:!0}}),this.view={center:[-73,47.2],zoom:6,rotation:.75},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(function(e){r.map.addLayer(r.layerService.createLayer({title:"OSM",source:e}))})}return y(e,[{key:"media",get:function(){return this.mediaService.getMedia()}},{key:"isTouchScreen",get:function(){return this.mediaService.isTouchScreen()}},{key:"onPointerMove",value:function(e){this.pointerCoord=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ce),w.Y36(du),w.Y36(Xu),w.Y36(Pe))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-simple-map"]],decls:20,vars:10,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/simple-map"],["igoPointerPosition","",3,"map","view","pointerPositionDelay","pointerPositionCoord"],[3,"infoContent"],["color","primary",3,"map"],["color","primary",3,"map","showIfNoRotation"],[4,"ngIf"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Geo"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Simple Map"),w.qZA(),w.TgZ(5,"mat-card-content"),w.TgZ(6,"li"),w._uU(7,"Dependencies: LanguageService"),w.qZA(),w._UZ(8,"br"),w._uU(9," See the "),w.TgZ(10,"a",0),w._uU(11,"code of this example"),w.qZA(),w._UZ(12,"hr"),w.qZA(),w.TgZ(13,"igo-map-browser",1),w.NdJ("pointerPositionCoord",function(e){return t.onPointerMove(e)}),w._UZ(14,"igo-info-section",2),w._UZ(15,"igo-zoom-button",3),w._UZ(16,"igo-geolocate-button",3),w._UZ(17,"igo-home-extent-button",3),w._UZ(18,"igo-rotation-button",4),w.qZA(),w.qZA(),w.YNc(19,iS,2,1,"p",5)),2&e&&(w.xp6(13),w.Q6J("map",t.map)("view",t.view)("pointerPositionDelay",t.pointerCoordDelay),w.xp6(1),w.Q6J("infoContent",t.pointerCoord),w.xp6(1),w.Q6J("map",t.map),w.xp6(1),w.Q6J("map",t.map),w.xp6(1),w.Q6J("map",t.map),w.xp6(1),w.Q6J("map",t.map)("showIfNoRotation",!0),w.xp6(1),w.Q6J("ngIf",!t.isTouchScreen))},directives:[O.a8,O.$j,O.n5,O.dn,Du,Eu,ap,ju,Qu,Gu,np,F.O5],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}"]}),e}()}]),nS=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,oS,O.QW,S.ot,jy]]}),e}();function rS(e,t){if(1&e&&(w._UZ(0,"igo-metadata-button",6),w._UZ(1,"igo-download-button",6),w._UZ(2,"igo-ogc-filter-button",7),w._UZ(3,"igo-time-filter-button",7),w._UZ(4,"igo-track-feature-button",8)),2&e){var i=t.layer;w.Q6J("layer",i),w.xp6(1),w.Q6J("layer",i),w.xp6(1),w.Q6J("header",!0)("layer",i),w.xp6(1),w.Q6J("header",!0)("layer",i),w.xp6(1),w.Q6J("layer",i)("trackFeature",!0)}}var aS=Z.Bz.forChild([{path:"layer",component:function(){var e=function e(t,i,o){var n=this;m(this,e),this.languageService=t,this.dataSourceService=i,this.layerService=o,this.map=new _u({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],maxLayerZoomExtent:[-11e6,45e5,-45e5,1e7],zoom:7},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(function(e){n.map.addLayer(n.layerService.createLayer({title:"OSM",visible:!0,baseLayer:!0,source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"shp"},ogcFilters:{enabled:!0,editable:!0,filters:{operator:"PropertyIsEqualTo",propertyName:"code_municipalite",expression:"10043"}}}).subscribe(function(e){n.map.addLayer(n.layerService.createLayer({title:"WFS ",visible:!0,source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:"geojson_utf8",srsName:"EPSG:32198",outputFormatDownload:"shp"},ogcFilters:{enabled:!0,editable:!0,filters:{operator:"PropertyIsEqualTo",propertyName:"code_municipalite",expression:"12072"}},formatOptions:{dataProjection:"EPSG:32198"}}).subscribe(function(e){n.map.addLayer(n.layerService.createLayer({title:"WFS (Custom EPSG)",visible:!0,source:e,removable:!1}))}),this.layerService.createAsyncLayer({sourceOptions:{type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",optionsFromCapabilities:!0,params:{LAYERS:"parc_routier",VERSION:"1.3.0"}}}).subscribe(function(e){return n.map.addLayer(e)}),this.layerService.createAsyncLayer({title:"R\xe9seau routier",visible:!1,sourceOptions:{type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",params:{LAYERS:"bgr_v_sous_route_res_sup_act",VERSION:"1.3.0"}}}).subscribe(function(e){return n.map.addLayer(e)}),this.layerService.createAsyncLayer({title:"lieu habit\xe9",visible:!1,sourceOptions:{type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",optionsFromCapabilities:!0,params:{LAYERS:"lieuhabite",VERSION:"1.3.0"}}}).subscribe(function(e){return n.map.addLayer(e)}),this.layerService.createAsyncLayer({title:"sh_dis_eco",visible:!1,sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/mffpecofor.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"sh_dis_eco",VERSION:"1.3.0"}}}).subscribe(function(e){return n.map.addLayer(e)}),this.layerService.createAsyncLayer({title:"nurc:Arc_Sample_Parent",visible:!1,legendOptions:{display:!0,stylesAvailable:[{name:"rain",title:"Pluie"},{name:"raster",title:"D\xe9faut"}]},sourceOptions:{type:"wms",url:"https://demo.geo-solutions.it/geoserver/ows",optionsFromCapabilities:!0,params:{LAYERS:"nurc:Arc_Sample",VERSION:"1.3.0"}}}).subscribe(function(e){return n.map.addLayer(e)}),this.layerService.createAsyncLayer({title:"Avertissements routier",visible:!1,sourceOptions:{type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",params:{LAYERS:"evenements",VERSION:"1.3.0"}}}).subscribe(function(e){return n.map.addLayer(e)}),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",refreshIntervalSec:15,params:{LAYERS:"vg_observation_v_inondation_embacle_wmst",VERSION:"1.3.0"}}).subscribe(function(e){n.map.addLayer(n.layerService.createLayer({title:"Emb\xe2cle",source:e,metadata:{url:"https://www.donneesquebec.ca/recherche/fr/dataset/historique-publique-d-embacles-repertories-au-msp",extern:!0}}))})};return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ce),w.Y36(du),w.Y36(Xu))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-layer"]],decls:19,vars:7,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/layer"],[3,"map","view"],["color","primary",3,"map"],["title","Layers"],["floatLabel","never",3,"map","layers","expandLegendOfVisibleLayers","queryBadge"],["igoLayerItemToolbar",""],[3,"layer"],[3,"header","layer"],[3,"layer","trackFeature"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Geo"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Simple Map"),w.qZA(),w.TgZ(5,"mat-card-content"),w.TgZ(6,"li"),w._uU(7,"Dependencies: LanguageService"),w.qZA(),w._UZ(8,"br"),w._uU(9," See the "),w.TgZ(10,"a",0),w._uU(11,"code of this example"),w.qZA(),w._UZ(12,"hr"),w.qZA(),w.TgZ(13,"igo-map-browser",1),w._UZ(14,"igo-zoom-button",2),w.qZA(),w.TgZ(15,"igo-panel",3),w.TgZ(16,"igo-layer-list",4),w.YNc(17,rS,5,8,"ng-template",null,5,w.W1O),w.qZA(),w.qZA(),w.qZA()),2&e&&(w.xp6(13),w.Q6J("map",t.map)("view",t.view),w.xp6(1),w.Q6J("map",t.map),w.xp6(2),w.Q6J("map",t.map)("layers",t.map.layers)("expandLegendOfVisibleLayers",!1)("queryBadge",!0))},directives:[O.a8,O.$j,O.n5,O.dn,Du,ju,vn,Md,Wl,wh,pm,Hg,Qd],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),e}()}]),sS=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[aS,O.QW,S.ot,k.Ps,yn,jy,Yd,Gv,Kl,xh]]}),e}(),lS=Z.Bz.forChild([{path:"legend",component:function(){var e=function e(t,i,o){var n=this;m(this,e),this.languageService=t,this.dataSourceService=i,this.layerService=o,this.map=new _u({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:7},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(function(e){n.map.addLayer(n.layerService.createLayer({title:"OSM",visible:!0,baseLayer:!0,source:e}))}),this.layerService.createAsyncLayer({title:"legend with display:false",visible:!0,legendOptions:{display:!1,html:"test html"},sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/mffpecofor.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"sh_dis_eco",VERSION:"1.3.0"}}}).subscribe(function(e){return n.map.addLayer(e)}),this.layerService.createAsyncLayer({title:"legend in html",visible:!0,legendOptions:{display:!0,html:'<h2 style="background-color: blue;">HTML l\xe9gende</h2>'},sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/mffpecofor.fcgi",optionsFromCapabilities:!1,params:{LAYERS:"sh_sreg_eco",VERSION:"1.3.0"}}}).subscribe(function(e){return n.map.addLayer(e)}),this.layerService.createAsyncLayer({title:"legend with url param",visible:!0,legendOptions:{url:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxASEhUQEBISFRUVFRAQFRUQFRUVFRAPFRUWFhUVFRUYHSggGBolGxUVITEiJSkrLi4uFx8zODMsNygtLisBCgoKDg0OGhAQGy0dHyUtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tKy0tLS0tLS0tLf/AABEIAKgBLAMBIgACEQEDEQH/xAAbAAABBQEBAAAAAAAAAAAAAAACAQMEBQYAB//EADwQAAIBAwEGAwYFAgUEAwAAAAECAAMEESEFEjFBUWETInEGFDKBkaFCscHR8FJyFSNTYoIzQ5LxFqLh/8QAGQEAAwEBAQAAAAAAAAAAAAAAAAECAwQF/8QAJREBAQACAgEFAAEFAAAAAAAAAAECERIhAwQTMUFRYRQiI3Gh/9oADAMBAAIRAxEAPwB0QhAEMTFQhCEEQhACEIQRFEYEIQgiEIAU6IIsAWLEnQAp0KmBqSdFBY+g5D1OBGD4nxYBHQafQzLPzTDLVbYeHLObh2LARwwyD+4PQiFNJZZuMrLLqlnRJ0ZFiTp0A6KEOM4OITuF8q4L8ydVp9sc2+0atrlw/hVGLBw2MnO66gsMdBpjHeYZeoxmXGOjH0+Vx5UsSLEm7ndEM6IYAhgmEYJgCGCYRgmIBMEwjAJgAmAYRgkwAGjTxxjGniBipGo5UjcAthCEAGEIwMQhAEIGAHFEERcxgYiiBmEDADzFgAxcwA50HMXMANh5H/tA+rrJhXy8JDXJDAcSpx6jB/SE18u6uuhGnqeU4vPP8m7+PR9N34tT9V20FZD4ifMcmHSSra5V1DKdD9Qeh7yLd1d4HAOJm7W9q27NlWKE55cOozzleLLTPz4b7bPM7MrbXbC1AFRQGb4d84OemP17Rk7YYsUREJUn8XxhfjI7gzp5xyXGrjMj3l5uYVfjYeX/AGrzb15D5mRau0N0Bt3e3uAVhoO56ympms1Z6lTtgaaDHAdgBiZZ+Tc1G3i8fe60FsN0AZ1iLUzXpDTRifqpHGVh2ioGMP8AIQtm3G9WUdmbX+04nNw3Y7+Wsb/peRJ0Qz0HkOMQzokQcTBM4xCYBxgGKTBJgCEwTFJgEwBCYBMUmCTABaMvHGMacxGZeNw3jUCWwMIGNAwgYwdBhAxoGEDAHAYQMbBigwBzMIGNAwgYA4DFzGwYWYwPMXMbzCBgD1PjxxylRUuEpv4J0PDXPx9BLNDrI17bMtd2PmVgrNngHwNdZzeeTqur02dm4RquAWK4A111yOxme2tXZicaAcuZGf3/ADl7UrFtRwA68x69jM/eVGffZcBkyxA0bdAGZHjna/Jl0pKdJmuFUN8A3ufyA+UGz3jVABIOWBOez5z05fWSrxs0qV2g1DbrY/pJAx35H6yMoxWDjhq2Ou8Dp/5GdDmBYsy7yF87rnGpx/NZfWd4yrg65JGeJHM6SjpjcthUK+apUI7glifyMnUKhV9zPH4vpjT7yMpteF0tL6qwAK6j0zr6x72YY1HLlQNwNnHMnQfrIyVAujHThx0lt7MhQKqjj5W/46iRjO42zyvG6XGYhMSJmdLjdmITOJgkwBSYJMQmITAOJgkziYJMA4mATOJgEwDiYBM4mATAOYxpzCJjTGIG3MbzFcwMwCzBhAxpQekPdPSPVLcOAwgYzgxd6GjPAwsxkNFDQB7MUNGhnpDCGPVLcOAxQY3unpFzA9nQYoMaBhAxBO2bS3qijvk+g1kXbFVqlY0qWAB56jHn0EnbPfw1ZzngeExu3L2qRu0iVNVtWGclQPyyZz+T+7LTfx9Y7XdfaNvRQh2ydFAXBJY6AADhrjjMlW2jRSqCyVFLb2vlO8uobKjQj9oT2lMUmpHILbp8TGSHU6b2OIzIVwtVt1moFmUEK9IhlI7a9esMJB5Ll9L1dnqLUCk29TJJ05KSfuAT9BK/w/PpodBwGdOGny9NInsrfstSpQq+UMDuqdd0jj+hkg4Fbf5Zzj7Qm5bKq9yWHLq1QUEeqd1UffAxx5LpzPDSU9G/pl2dKTnd0YlgCfly4R72huHqV6dKjhgi4wdBvEfY6SOthUGfFZKYbG8KZLVHA5Y5SsZNdoz3vpate0agXdyuQG3X4gH85P8AZ2p4dfdfmCgP+08P0lNcW3jDK090IMIc6jHAd47sWuxanv8AEFR8wZOuul7beoMEiBmFVyTnrGjmdHbmKTBJiZnYgCExCYpWAYg4mAWiEwC0AItAJiFoBaAKTAJiFoJMA5jGnMJjG2gDTmDmKwMHBhomsFsI4trLJLaP07aepxjjtqmNn2jbWA6TRi1gNbCK4Y0TLJnvch0hrZdpc+COkcShJ4YnyyVVOzjwtO0tVoiOCkJWoXalNnANl2l74U4UIaxPtRe59oq2faXvgTnTAJ0+gkZSKm2M9pK2F8NSQeOnT9pQJbFqbVq9ZRpujGm4O2ect/amoynLZ3dfh00PUzMW9AK2uMH4S3mHbAPOeLbvderJrUO+IHXcRqjqOBekx9QGUg4+RjKW1VGyhK9cAjP/ABM0lihGFqPT64Ua/wD1kza9gXVGViMHOFpv59eBMmZ96O4xjaNBxVNTdw7ndXPEA8TIj3JBPE68wdZtKeyvGTB31ZSSrqGTB5EZOT85namyqu97rk+Lx8TAx4e98Weu7p1zNMcti46VtrSZnFRR5hkH04D6ayStlU1YAknJydSPU/WaB9jigoCbxYnLMys28Txzidsy2KKcsxzyKFQO2WzFzK4M8XXIR9/e0KsWA83TdXQQrOo6VlBXy7+8OfHiJZ7QsS2rboA1UhRnI4a6SHswO9dd4g6jkVOnYiPG7icpp6LTtwVB7RDajpBt78DRvvH/AH1ZvPPYxvilR/dlne7iSPGUwHdYf1U/C9j+TDWwgGzzHGrATkuR1mmPqML8xN8GU+Ki1LDtGv8ADzLujWUyQKAM6Zhhe3PblOmaNlBNjNT7oOkZqW4j9vEuVZr3CC1oJoDbxipZw4Q+VULUBGzb9polsIZsBF7cHJmPdD0ie5zTe4RPcu0qeKJudaJbacaMaW9ne9TH3m3tnRTMUWxMKjWllQIMfvUe3FctnFNsZdLTE40BF7lPhFL7tE92ls9CR3oGL3aOEREoR8W8NaZEdEPdo4REa2kPaFLdQky33pA2yM0mHaTl5bqqmE2yF8ErJgg4xxI4ntnjMc9N0yppgINTUYjyjkWc8PQYlvR2luVGSrndUgZ6k8FH3k7aNrTqqoqaLxWmuSSepxr+vpPPn8uxmLFwrb9Niyg6u5O4D0A+Jzrw9Jq7C/p1BuFjjucHeHHOD3GnLnrpMnteg4ICEBVyCyjSmnMKvXlnnnAwDqxb3wUhcYxhDg5wF1K/fB6lm7StS9lu/bf+5Mo8gU548vrxMpG2NW8fxd8cMbpXQjP1kKx2zcAZVsjjg8DrJr+0tXnTXPDOsXU+D+Vi1uxH+YFUDnnOR+kp9pbVpou4nDUZ46+n8/SQ7zaNWpjeY45gcBKa+vV1GBk/U6/nz/8AcJjunbqHql+w1NUlTwHEHtrofQiFb3qrh38nJQOHqU5fKV1FN3LvjH9J4N0P84QqVJqzg/g7jgOhmmmdu2pvr1t1cZ1Gc/hP04SGu2WQ7rR2nWVk3AVwowN7OCZn9s13yKemBqMYixm+itaVdtA8DJ9ttANznm4uWXnLSy2lgZzDLx/gmbZ3lbTIMrqN6d7GZWU9rqeJkb3vLgrFMP1VybaxdidJorJmHGUGwwzAEiX7XAAwY/H5ssPhOfjmS0R1Mbq0hK1nIGQY5bXe8NTOvH1Eyc98OkoUYnu8RLgR9amZtM2dxAtvOahJIEBjK5xPFEqUwJBeprJt3UAEzdzdeY6zPLzaOePbcps9e0L/AA4dJW09o1BxWSKe1+oM5OUdXE89liAodYX+KrOF6hj5wcTyXhHGODaYkZipgG3Uw5jinC/U84a3APOVhsl6wDa9GMXKjiuBVWGMGUPgVOTSXRFQcY5kNLTwRIm0LfyH0MEXbDiI1dbSBUiPotMNtawR8OOKZO7nAL/zny5a6jF3l/cU3L587ZHDRKY00HLJ4dh3mr2lvhjVpkFMtvr1A79ZE8ajcDBAD8xzHQZ+k5rdNpNswdsOiDxBlm1HLGuhx24/MSDUuVxvU9NBkdcgZ/naX+1dj7zDGCNEHYAfw/OUd7sKoDoDz4fQSsbiLMg0L9eRZTofLwJ5nEsVvSQMEHn007zPvs6qOXI4wOcdt7e4A3TqOGvDMu4xPKrK8r1GGE0zrK0lE1Ygtr9ZEqUq+8QoYZ5dPST9mbHz56p0HIx6khbtqRs62asByAz5Tkj+cZZ3VZKaGjTxvt9usgXF+f8Ap0RjGBnkO8C2UJlmbLccnv0zJ190966iws3VFwQGxqe31lZcMu8TjGekds7nVmYZz5cc4l5bEciM8MjEufKag3FvkZWQDvLLClX3TumSXtlaVtOlNTZidJodhW53gWjFCgqydZVSGzIzvS8Me29s75KaY5yBd7Wzw+0qQ5PGMuxBnJa6pjFqu1anDlJFLaeBrKRq2kAVsysUZRa0/aDdfBOk0uydso/AzynajkHIh7P2g9MhgSJ1Y7nbmuq9sN0McZWXe1FHEiZq22m1ZNG+kS22O1U5ZjD3h7azvdrKRoZlbi5JYnM1dD2YTmWPzjh2BRGm4PpJ7vdPUnw0NGgx+IYhtbCW7UpFqWy88iGhtULa68ZKS1XtHfcFJyHM6tZNyePUG3NZ9DGXsao+FozVsq/4XEVLW6/1F+kWv4Dmo3A6GMV2uRwUH5yZv3K8d0wm2qy/HSPy1ho0K2vao+ND8pY09rrzBHqIFLbFBtOB7x2rbpUGVIilB9b6mw4iQ7w02U4xwMYr7PbGglXWsXXJ1Eq5CRQ1qLGk3hnO4xGP9szW6lQgklH+IngSM66GW3+IFC6qMgtu4P4uWgme2xc+bygZGpI7Hh9dJGrs9xOb3mm3HfGOXEAc+8JNsgndIKnkCMcOEpBt5kwTjQa4568B9oR21Tc+dRoQo7aZOvpF7d+4rnPqr1LpSQB3PXGRgfpGGZs4ABGn01IP86SppIh1QkajTPLOknWTMjEE59f6c4+uknjpUy2kJqx0Hy5aZlZtO6GoB04a8AeklOzZYKJQ3jK2jNjtLwxRlkb97J8qDA4EnnOe4Pwrr8v3nF6IGCfl1hU95x/lKFX+o8Zqz2KgAmrnXiB0mh9/NWhlk0XTMzFeg40G8x68pK2O1Viafhs2RoADmFn2UokUE4IkqpSKiC9AqcEFSDqDxEnOuV1itVIrLepvHEuLeljUyBQoYOZNNWZZ1rhE4NOqtI9N51SpMuDbloDVI2z44Rlt5jhQT/aM/lJFLZF2w0oVPmMfnNJGWWSDdJvSFd6LiXjez17/AKLfMr+8hXexrofFRf5YP5TWVjew+z+0igmq2f7UAYXHGU+xvZhviqndHTnLC62Va6qr+YDkRmZZZY29LmOWu24ttpBlGCIFVWJ4mZT2c2dVQ5Z/T0mqLGLnvo+Om4DwWAPKMLCDTfbLTmtUPLEaOzRyJj2/6wg8Ogrq+yHPwuZCqbGuR8NQ/OX+8YYc9fyhqBl22Rd/6sae0vV/Eh9QZqKtZxwUn+3EHxcjJRvprFYcrJVEqf8AdoBu6a/Yxmnof8moyH+ipn9ZsPBzqAV9RKu+2dVbiiOv0Mjirki2ntCVIS4XHLe5H5y2uHpumQRqJm721qoMeE7pzUgkj+085SJfvRPlLGm3JshkPTBi3Z8nqX4RtpWtKmlR6jYPiNu4x5RMlV2Z4qnwgxUebI54zgA8M/vNPV2OtxVFWuc0qYyFzoWJzrJVrWp1AapA8FDu00XgzD8Rx3hy0VxYil7NVCm8FJAIAAGdSAePPlIdXZaqPMCOJJweWh/Oenrf1ar+HTUIAN9ieRI8oA689eEZuEWoDSuAjZ47vlA7b2fN8oTy/o4fjzZaCqcjTHCPVr8annqPUHj+8l7Z2HUouSgLodQVGcfIcJR1mA0PPryM11Kjek6zqkNkNnXnKe8phqrdznEstnWdWq2KSlsfTHrNLsj2URH8W4IJ4hAeJ7mFymI1az+yNg75B0A5F8y7q0UoEK64HBWOCra6AGLta7u97IUIg0AQ4wO3IwrfaAqLuVNQ2hBBAJ7f0kdpF3e1TU6NeDSqkKh3W6/hbtkcD2jaq1u281XXBwFVgQegbGD9Yxf7JqU8VKJ38fhPxYGvz/PSS6hS5okjRlBOD8SkcQecc/4VDWvKdUZyS3VskyOwPIymt3K1N09cazTWNMtooLHoNZVx0UyRKNJzyku12RVqHyAn0ms2T7Lu2GqkAdBrNTQtqNEYAGn84CRdLlrIbO9i3YDxHx2XUy+tfY61p6shc/7tf/yWr7RxooP/AIn8sSK+0UY+YVVPZTg/XSLo7s74NOmMU6aL6LGffQ3lzg+kYN1RByXYf8WB9eOPtHqN5bVPxjPDJGDJCsudpVkbcYadeokG6vqg83FTx04TV07ZOJdHXln9JL8OnjAVT2wBCSj4YY12chcZzoMSds72NtUqeNVyznXU6D5cJqVorn/poMcMYMSuBzXP7R446K3Y1taOBhRpwkKvbrn4BCNUE+Rs9uYjqk8xH0O04Oen3hmQaVxHQ8pKauOs7HeRd4wlJ6wCSSP/AFBL9MxsRcmAPo/Uzt8dzGgIYWMONbtAas3yhPpIdZzHsaSTV7/eMXNJXGHVWHRgD+cbWqOAEcCdY52FTfbCouhRVZAcE+G3T1z9pSXexqlNadOnh0Vt473kxrkZHMCbMiRquDpJuMPahegtOmFGMsxZyPxdsyjvL2lTfKrvMRrnXHp0mpvLEOMA4lDtL2WqMd5GGnUcfpMbhdtJlNKOl7TVN4gBR2lXdWdC8rA1PIx0O7oGMXbOzqlFt90I5EjUGVlglZ6quadUIuSCqnX7TTDH7ic7GztLBLVXRMKgAJJ1Zmmd2rdMy75JGuF5GOUPfXfd3SygkgucEjlkTrzYl61QOyAqOQPOTwvLsTKadTu2NMipwA4HnGNneEy7yjUHjnOnTEtP/itzVQhmCZ+ZxFs/YitSXcVxgnU45RzHorlNoV9cimA3MlcfvHqQtCQ7O9NyDnChlIP9XD85p7T2ctwAKi75HNjmHfez1vU0A3ca+XT6yuPSeW2HX2cUtvU7iiykg+clGHyOn3m02PbW9BQDUTqSGBLH5cpW3fskRqnm7DQ/aV52Qy6MHHqTC205I2F17UUlG7SBbvwEz9z7Q12/Hx5KMYjVts4D8DH6mFb7IqbxCocciREfR+32rWHmZyf1k239oXPHQyPU2DXOuAOgzGDs9wQCsCae020rDDYj1SiG1plfRgCJkLi2qLjcU9TLjZVZ9CYocy0sjQdf+zSz/tHGLb+Lzor8s/vJi3MJLnJ0jvRy7O0Cw/CAPU/vHDUx3iUzn4sQXccBHpBqqik7w0PUfr1jxRzqpGO/WNEQPFxwMVitomHzHkqHrEnQkI5TrmOi4nTpRDW5jouDOnRmIV2jq3ESdFQJ68YJJnToASkLqZFr7S1wonTobBErMRrG3M6dEAKxkynV0nTowi3Qpt8QBi0FpcAonToEbr2VPO9gQhTUjAnTpROWniGyTp0ZK+uwBgb/AEE6dIqofpEwy4X4hn1nToqccbxQMhRH7a7zyAnToYlXVq0ZVA3ETp0mnB1LVcaxilQXOAIk6HxSSjSAEra+8moiTppZuJnRy3vAeJklWXOQZ06R8KO+IesBlnTo7Q//2Q=="},sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/mffpecofor.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"sh_reg_eco",VERSION:"1.3.0"}}}).subscribe(function(e){return n.map.addLayer(e)}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"shp"},ogcFilters:{enabled:!0,editable:!0,filters:{operator:"PropertyIsEqualTo",propertyName:"code_municipalite",expression:"10043"}}}).subscribe(function(e){n.map.addLayer(n.layerService.createLayer({title:"WFS ",visible:!0,source:e}))}),this.layerService.createAsyncLayer({sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"MELS_CS_ANGLO_S",VERSION:"1.3.0"}}}).subscribe(function(e){return n.map.addLayer(e)}),this.layerService.createAsyncLayer({title:"R\xe9seau routier",visible:!1,sourceOptions:{type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",params:{LAYERS:"bgr_v_sous_route_res_sup_act",VERSION:"1.3.0"}}}).subscribe(function(e){return n.map.addLayer(e)}),this.layerService.createAsyncLayer({title:"lieu habit\xe9",visible:!1,sourceOptions:{type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",optionsFromCapabilities:!0,params:{LAYERS:"lieuhabite",VERSION:"1.3.0"}}}).subscribe(function(e){return n.map.addLayer(e)}),this.layerService.createAsyncLayer({title:"2 styles nurc:Arc_Sample_Parent",visible:!0,legendOptions:{display:!0,stylesAvailable:[{name:"rain",title:"Pluie"},{name:"raster",title:"D\xe9faut"}]},sourceOptions:{type:"wms",url:"https://demo.geo-solutions.it/geoserver/ows",optionsFromCapabilities:!0,params:{LAYERS:"nurc:Arc_Sample",VERSION:"1.3.0"}}}).subscribe(function(e){return n.map.addLayer(e)}),this.layerService.createAsyncLayer({title:"Avertissements routier",visible:!1,sourceOptions:{type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",params:{LAYERS:"evenements",VERSION:"1.3.0"}}}).subscribe(function(e){return n.map.addLayer(e)}),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",refreshIntervalSec:15,params:{LAYERS:"vg_observation_v_inondation_embacle_wmst",VERSION:"1.3.0"}}).subscribe(function(e){n.map.addLayer(n.layerService.createLayer({title:"Emb\xe2cle",visible:!0,source:e,metadata:{url:"https://www.donneesquebec.ca/recherche/fr/dataset/historique-publique-d-embacles-repertories-au-msp",extern:!0}}))})};return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ce),w.Y36(du),w.Y36(Xu))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-legend"]],decls:17,vars:8,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/layer"],[3,"map","view"],["color","primary",3,"map"],["title","Legends"],[3,"layers","excludeBaseLayers","allowShowAllLegends","updateLegendOnResolutionChange","showAllLegendsValue"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Geo"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Simple Map with a legend list"),w.qZA(),w.TgZ(5,"mat-card-content"),w.TgZ(6,"li"),w._uU(7,"Dependencies: LanguageService"),w.qZA(),w._UZ(8,"br"),w._uU(9," See the "),w.TgZ(10,"a",0),w._uU(11,"code of this example"),w.qZA(),w._UZ(12,"hr"),w.qZA(),w.TgZ(13,"igo-map-browser",1),w._UZ(14,"igo-zoom-button",2),w.qZA(),w.TgZ(15,"igo-panel",3),w._UZ(16,"igo-layer-legend-list",4),w.qZA(),w.qZA()),2&e&&(w.xp6(13),w.Q6J("map",t.map)("view",t.view),w.xp6(1),w.Q6J("map",t.map),w.xp6(2),w.Q6J("layers",t.map.layers)("excludeBaseLayers",!0)("allowShowAllLegends",!0)("updateLegendOnResolutionChange",!1)("showAllLegendsValue",!1))},directives:[O.a8,O.$j,O.n5,O.dn,Du,ju,vn,Bd],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),e}()}]),cS=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[lS,O.QW,S.ot,k.Ps,yn,jy,Yd,Gv,Kl,xh]]}),e}(),uS=Z.Bz.forChild([{path:"overlay",component:function(){var e=function(){function e(t,i,o){m(this,e),this.languageService=t,this.dataSourceService=i,this.layerService=o,this.map=new _u({overlay:!0,controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:6}}return y(e,[{key:"ngOnInit",value:function(){var e=this;this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(function(t){e.map.addLayer(e.layerService.createLayer({title:"OSM",source:t}))})}},{key:"ngAfterViewInit",value:function(){this.map.overlay.setFeatures([{type:ec,projection:"EPSG:4326",meta:{id:1},properties:{},geometry:{type:"Point",coordinates:[-73,46.6]}},{type:ec,projection:"EPSG:4326",meta:{id:2},properties:{},geometry:{type:"LineString",coordinates:[[-72,47.8],[-73.5,47.4],[-72.4,48.6]]}},{type:ec,projection:"EPSG:4326",meta:{id:3},properties:{},geometry:{type:"Polygon",coordinates:[[[-71,46.8],[-73,47],[-71.2,46.6]]]}}],tc.None)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ce),w.Y36(du),w.Y36(Xu))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-overlay"]],decls:15,vars:3,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/overlay"],[3,"map","view"],["color","primary",3,"map"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Geo"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Overlay"),w.qZA(),w.TgZ(5,"mat-card-content"),w.TgZ(6,"li"),w._uU(7,"Dependencies: LanguageService"),w.qZA(),w._UZ(8,"br"),w._uU(9," See the "),w.TgZ(10,"a",0),w._uU(11,"code of this example"),w.qZA(),w._UZ(12,"hr"),w.qZA(),w.TgZ(13,"igo-map-browser",1),w._UZ(14,"igo-zoom-button",2),w.qZA(),w.qZA()),2&e&&(w.xp6(13),w.Q6J("map",t.map)("view",t.view),w.xp6(1),w.Q6J("map",t.map))},directives:[O.a8,O.$j,O.n5,O.dn,Du,ju],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}"]}),e}()}]),pS=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[uS,O.QW,S.ot,jy,Xy]]}),e}();function dS(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"igo-form",4),w.NdJ("submitForm",function(e){return w.CHM(i),w.oxw().onSubmit(e)}),w.ALo(1,"async"),w._UZ(2,"igo-form-group",5),w.TgZ(3,"div",6),w.TgZ(4,"button",7),w.NdJ("click",function(){return w.CHM(i),w.oxw().fillForm()}),w._uU(5," Fill Form "),w.qZA(),w.TgZ(6,"button",7),w.NdJ("click",function(){return w.CHM(i),w.oxw().clearForm()}),w._uU(7," Clear Form "),w.qZA(),w.TgZ(8,"button",8),w._uU(9," Submit "),w.qZA(),w.qZA(),w.qZA()}if(2&e){var o=t.ngIf,n=w.oxw();w.Q6J("form",o)("formData",w.lcZ(1,4,n.data$)),w.xp6(2),w.Q6J("group",o.groups[0]),w.xp6(6),w.Q6J("disabled",n.submitDisabled)}}var hS=Z.Bz.forChild([{path:"geometry",component:function(){var e=function(){function e(t,i,o,n){m(this,e),this.languageService=t,this.formService=i,this.dataSourceService=o,this.layerService=n,this.map=new _u({controls:{attribution:{collapsed:!0},scaleLine:!0}}),this.view={center:[-73,47.2],zoom:15},this.form$=new R.X(void 0),this.data$=new R.X(void 0),this.submitDisabled=!0}return y(e,[{key:"ngOnInit",value:function(){var e=this;this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(function(t){e.map.addLayer(e.layerService.createLayer({title:"OSM",source:t}))});var t=[{name:"geometry",title:"Geometry",options:{validator:We.kI.required},type:"geometry",inputs:{map:this.map,geometryTypeField:!0,geometryType:"Polygon",drawGuideField:!0,drawGuide:50,drawGuidePlaceholder:"Draw Guide",drawStyle:new ms.ZP({stroke:new ws.Z({color:[255,0,0,1],width:2}),fill:new ys.Z({color:[255,0,0,.2]}),image:new xs.Z({radius:8,stroke:new ws.Z({color:[255,0,0,1]}),fill:new ys.Z({color:[255,0,0,.2]})})})}},{name:"name",title:"Name",options:{validator:We.kI.required}}].map(function(t){return e.formService.field(t)}),i=this.formService.form([],[this.formService.group({name:"info"},t)]);this.valueChanges$$=i.control.valueChanges.subscribe(function(){e.submitDisabled=!i.control.valid}),this.form$.next(i)}},{key:"ngOnDestroy",value:function(){this.valueChanges$$.unsubscribe()}},{key:"fillForm",value:function(){this.data$.next({name:"Place",geometry:JSON.stringify({type:"Polygon",coordinates:[[[-106,42],[-107,31],[-81,32],[-82,42],[-106,42]]]})})}},{key:"clearForm",value:function(){this.form$.value.control.reset()}},{key:"onSubmit",value:function(e){alert(JSON.stringify(e))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ce),w.Y36(qo),w.Y36(du),w.Y36(Xu))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-geometry"]],decls:13,vars:6,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/common/form"],[3,"map","view"],["color","primary",3,"map"],[3,"form","formData","submitForm",4,"ngIf"],[3,"form","formData","submitForm"],[3,"group"],["formButtons",""],["mat-stroked-button","","type","button","color","primary",3,"click"],["mat-flat-button","","type","submit","color","primary",3,"disabled"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Geo"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Geometry Form"),w.qZA(),w.TgZ(5,"mat-card-content"),w._uU(6," See the "),w.TgZ(7,"a",0),w._uU(8,"code of this example"),w.qZA(),w.qZA(),w.TgZ(9,"igo-map-browser",1),w._UZ(10,"igo-zoom-button",2),w.qZA(),w.YNc(11,dS,10,6,"igo-form",3),w.ALo(12,"async"),w.qZA()),2&e&&(w.xp6(9),w.Q6J("map",t.map)("view",t.view),w.xp6(1),w.Q6J("map",t.map),w.xp6(1),w.Q6J("ngIf",w.lcZ(12,4,t.form$)))},directives:[O.a8,O.$j,O.n5,O.dn,Du,ju,F.O5,Po,jo,S.lW],pipes:[F.Ov],styles:["pre[_ngcontent-%COMP%], code[_ngcontent-%COMP%]{font-family:monospace,monospace}pre[_ngcontent-%COMP%]{overflow:auto}pre[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{display:block;padding:1rem;word-wrap:normal}igo-map-browser[_ngcontent-%COMP%]{width:500px;height:500px}"]}),e}()}]),gS=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,hS,S.ot,O.QW,Go,Gg,jy]]}),e}(),fS=Z.Bz.forChild([{path:"feature",component:function(){var e=function(){function e(t,i,o){m(this,e),this.languageService=t,this.dataSourceService=i,this.layerService=o,this.map=new _u({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:6},this.tableTemplate={selection:!0,selectMany:!0,sort:!0,columns:[{name:"properties.id",title:"ID"},{name:"properties.name",title:"Name"},{name:"properties.description",title:"Description"}]},this.store=new yu([],{map:this.map})}return y(e,[{key:"ngOnInit",value:function(){var e=this,t=new xu({});this.store.addStrategy(t);var i=new Cu({map:this.map,motion:tc.Default});this.store.addStrategy(i),this.store.load([{meta:{id:1},type:"Feature",geometry:{type:"Point",coordinates:[-72,47.8]},projection:"EPSG:4326",properties:{id:1,name:"Name 1",description:"Description 1"}},{meta:{id:2},type:"Feature",geometry:{type:"LineString",coordinates:[[-72,47.8],[-73.5,47.4],[-72.4,48.6]]},projection:"EPSG:4326",properties:{id:2,name:"Name 2",description:"Description 2"}},{meta:{id:3},type:"Feature",geometry:{type:"Polygon",coordinates:[[[-71,46.8],[-73,47],[-71.2,46.6]]]},projection:"EPSG:4326",properties:{id:3,name:"Name 3",description:"Description 3"}}]),this.layerService.createAsyncLayer({title:"MVT test",visible:!0,sourceOptions:{type:"mvt",url:"https://ahocevar.com/geoserver/gwc/service/tms/1.0.0/ne:ne_10m_admin_0_countries@EPSG:900913@pbf/{z}/{x}/{-y}.pbf",queryable:!0},mapboxStyle:{url:"assets/mapboxStyleExample-vectortile.json",source:"ahocevar"}}).subscribe(function(t){return e.map.addLayer(t)}),this.dataSourceService.createAsyncDataSource({type:"vector"}).subscribe(function(o){var n=e.layerService.createLayer({title:"Vector Layer",source:o,animation:{duration:2e3},mapboxStyle:{url:"assets/mapboxStyleExample-feature.json",source:"source_nameX"}});e.map.addLayer(n),e.store.bindLayer(n),t.activate(),i.activate()})}},{key:"ngOnDestroy",value:function(){this.store.destroy()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ce),w.Y36(du),w.Y36(Xu))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-feature"]],decls:12,vars:5,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geom/feature"],[3,"map","view"],["color","primary",3,"map"],[3,"store","template"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Geo"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Feature"),w.qZA(),w.TgZ(5,"mat-card-content"),w._uU(6," See the "),w.TgZ(7,"a",0),w._uU(8,"code of this example"),w.qZA(),w.qZA(),w.TgZ(9,"igo-map-browser",1),w._UZ(10,"igo-zoom-button",2),w.qZA(),w._UZ(11,"igo-entity-table",3),w.qZA()),2&e&&(w.xp6(9),w.Q6J("map",t.map)("view",t.view),w.xp6(1),w.Q6J("map",t.map),w.xp6(1),w.Q6J("store",t.store)("template",t.tableTemplate))},directives:[O.a8,O.$j,O.n5,O.dn,Du,ju,Ei],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),e}()}]),mS=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[fS,F.ez,O.QW,S.ot,k.Ps,yn,Wo,jy,Sg]]}),e}(),vS=Z.Bz.forChild([{path:"hover",component:function(){var e=function(){function e(t,i,o,n){var r=this;m(this,e),this.languageService=t,this.dataSourceService=i,this.layerService=o,this.mediaService=n,this.pointerCoordDelay=0,this.pointerHoverFeatureDelay=0,this.map=new _u({controls:{attribution:{collapsed:!0},scaleLine:!0}}),this.view={center:[-73,47.2],zoom:8,projection:"EPSG:3857"},this.dataSourceService.createAsyncDataSource({type:"wmts",url:"https://geoegl.msp.gouv.qc.ca/apis/carto/wmts/1.0.0/wmts",layer:"carte_gouv_qc_public",matrixSet:"EPSG_3857",version:"1.3.0"}).subscribe(function(e){r.map.addLayer(r.layerService.createLayer({title:"Quebec",visible:!0,baseLayer:!0,source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"adn_bassin_n1_public_v",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"3.0.0",outputFormat:void 0,outputFormatDownload:"shp"}}).subscribe(function(e){r.map.addLayer(r.layerService.createLayer({title:"WFS (polygon)",visible:!0,source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"CASERNE",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"shp"}}).subscribe(function(e){r.map.addLayer(r.layerService.createLayer({title:"WFS (point)",visible:!0,source:e,styleByAttribute:{attribute:"en_caserne",data:["true","false"],stroke:["red","blue"],fill:["#ffffff","#ffffff"],radius:[7,7],width:[2,2]},hoverStyle:{label:{attribute:"Caserne: ${nom_service_incendie}\xa0\n Mun: ${ville}",style:{textAlign:"left",textBaseline:"top",font:"12px Calibri,sans-serif",fill:{color:"#000"},backgroundFill:{color:"rgba(255, 255, 255, 0.5)"},backgroundStroke:{color:"rgba(200, 200, 200, 0.75)",width:2},stroke:{color:"#fff",width:3},overflow:!0,offsetX:20,offsetY:10,padding:[2.5,2.5,2.5,2.5]}},baseStyle:{circle:{stroke:{color:"orange",width:5},width:[5],radius:15}}}}))})}return y(e,[{key:"media",get:function(){return this.mediaService.getMedia()}},{key:"isTouchScreen",get:function(){return this.mediaService.isTouchScreen()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ce),w.Y36(du),w.Y36(Xu),w.Y36(Pe))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-hover"]],decls:18,vars:9,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/hover"],["igoHoverFeature","",3,"map","view","igoHoverFeatureDelay","igoHoverFeatureEnabled"],["color","primary",3,"map"],["color","primary",3,"map","showIfNoRotation"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Geo"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Hover"),w.qZA(),w.TgZ(5,"mat-card-content"),w.TgZ(6,"li"),w._uU(7,"Dependencies: LanguageService"),w.qZA(),w._UZ(8,"br"),w._uU(9," See the "),w.TgZ(10,"a",0),w._uU(11,"code of this example"),w.qZA(),w._UZ(12,"hr"),w.qZA(),w.TgZ(13,"igo-map-browser",1),w._UZ(14,"igo-zoom-button",2),w._UZ(15,"igo-geolocate-button",2),w._UZ(16,"igo-home-extent-button",2),w._UZ(17,"igo-rotation-button",3),w.qZA(),w.qZA()),2&e&&(w.xp6(13),w.Q6J("map",t.map)("view",t.view)("igoHoverFeatureDelay",t.pointerHoverFeatureDelay)("igoHoverFeatureEnabled",!0),w.xp6(1),w.Q6J("map",t.map),w.xp6(1),w.Q6J("map",t.map),w.xp6(1),w.Q6J("map",t.map),w.xp6(1),w.Q6J("map",t.map)("showIfNoRotation",!0))},directives:[O.a8,O.$j,O.n5,O.dn,Du,Uu,ju,Qu,Gu,np],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:500px}"]}),e}()}]),yS=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,vS,O.QW,S.ot,jy]]}),e}(),bS=Z.Bz.forChild([{path:"measure",component:function(){var e=function e(t,i,o){var n=this;m(this,e),this.languageService=t,this.dataSourceService=i,this.layerService=o,this.map=new _u({controls:{attribution:{collapsed:!0},scaleLine:!0}}),this.view={center:[-73,47.2],zoom:6,projection:"EPSG:3857"},this.store=new yu([],{map:this.map}),this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(function(e){n.map.addLayer(n.layerService.createLayer({title:"OSM",source:e}))})};return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ce),w.Y36(du),w.Y36(Xu))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-measure"]],decls:16,vars:5,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/measure"],[3,"map","view"],["color","primary",3,"map"],[3,"store","map"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Geo"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Simple Map"),w.qZA(),w.TgZ(5,"mat-card-content"),w.TgZ(6,"li"),w._uU(7,"Dependencies: LanguageService"),w.qZA(),w._UZ(8,"br"),w._uU(9," See the "),w.TgZ(10,"a",0),w._uU(11,"code of this example"),w.qZA(),w._UZ(12,"hr"),w.qZA(),w.TgZ(13,"igo-map-browser",1),w._UZ(14,"igo-zoom-button",2),w.qZA(),w._UZ(15,"igo-measurer",3),w.qZA()),2&e&&(w.xp6(13),w.Q6J("map",t.map)("view",t.view),w.xp6(1),w.Q6J("map",t.map),w.xp6(1),w.Q6J("store",t.store)("map",t.map))},directives:[O.a8,O.$j,O.n5,O.dn,Du,ju,Ug],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-measurer[_ngcontent-%COMP%]     mat-divider{position:inherit!important;left:inherit!important;width:160px!important}"]}),e}()}]),wS=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[bS,O.QW,jy,zy]]}),e}(),xS=Z.Bz.forChild([{path:"draw",component:function(){var e=function e(t,i,o,n){var r=this;m(this,e),this.languageService=t,this.dataSourceService=i,this.layerService=o,this.mapService=n,this.map=new _u({controls:{attribution:{collapsed:!0},scaleLine:!0}}),this.view={center:[-73,47.2],zoom:6,projection:"EPSG:3857"},this.store=new yu([],{map:this.map}),this.mapService.setMap(this.map),this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(function(e){r.map.addLayer(r.layerService.createLayer({title:"OSM",source:e}))})};return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ce),w.Y36(du),w.Y36(Xu),w.Y36(su))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-draw"]],decls:16,vars:5,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/draw"],[3,"map","view"],["color","primary",3,"map"],[3,"store","map"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Geo"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Simple Map"),w.qZA(),w.TgZ(5,"mat-card-content"),w.TgZ(6,"li"),w._uU(7,"Dependencies: LanguageService"),w.qZA(),w._UZ(8,"br"),w._uU(9," See the "),w.TgZ(10,"a",0),w._uU(11,"code of this example"),w.qZA(),w._UZ(12,"hr"),w.qZA(),w.TgZ(13,"igo-map-browser",1),w._UZ(14,"igo-zoom-button",2),w.qZA(),w._UZ(15,"igo-draw",3),w.qZA()),2&e&&(w.xp6(13),w.Q6J("map",t.map)("view",t.view),w.xp6(1),w.Q6J("map",t.map),w.xp6(1),w.Q6J("store",t.store)("map",t.map))},directives:[O.a8,O.$j,O.n5,O.dn,Du,ju,yg],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-draw[_ngcontent-%COMP%]     mat-divider{position:inherit!important;left:inherit!important;width:160px!important}"]}),e}()}]),SS=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[xS,O.QW,jy,bg]]}),e}();function kS(e,t){if(1&e&&(w.ynx(0),w.TgZ(1,"h1"),w._uU(2,"Query Title : "),w.TgZ(3,"span",5),w._uU(4),w.qZA(),w.qZA(),w._UZ(5,"igo-feature-details",6),w.BQk()),2&e){var i=t.ngIf,o=w.oxw();w.xp6(4),w.Oqu(o.getTitle(i)),w.xp6(1),w.Q6J("feature",i)}}var CS=Z.Bz.forChild([{path:"query",component:function(){var e=function(){function e(t,i,o,n){var r=this;m(this,e),this.languageService=t,this.dataSourceService=i,this.layerService=o,this.overlayService=n,this.feature$=new R.X(void 0),this.map=new _u({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:6},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(function(e){r.map.addLayer(r.layerService.createLayer({title:"OSM",source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",queryable:!0,queryTitle:"num_rts",params:{layers:"bgr_v_sous_route_res_sup_act",version:"1.3.0"}}).subscribe(function(e){r.map.addLayer(r.layerService.createLayer({title:"WMS",source:e,sourceOptions:e.options}))}),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",queryable:!0,queryFormat:wc.HTMLGML2,queryHtmlTarget:Sc.IFRAME,params:{layers:"bgr_v_sous_route_res_sup_act",version:"1.3.0"}}).subscribe(function(e){r.map.addLayer(r.layerService.createLayer({title:"WMS html with a pre call in GML",source:e,sourceOptions:e.options}))}),this.dataSourceService.createAsyncDataSource({type:"vector",queryable:!0,queryTitle:"So beautiful ${name}",sourceFields:[{name:"name",alias:"Alias name"},{name:"description",alias:"Alias description"}]}).subscribe(function(e){r.map.addLayer(r.layerService.createLayer({title:"Vector Layer",source:e,sourceOptions:e.options})),r.addFeatures(e)})}return y(e,[{key:"addFeatures",value:function(e){var t=this,i=new ns.Z({name:"feature1",geometry:new Ls.Z([ls.vs([-72,47.8],"EPSG:4326","EPSG:3857"),ls.vs([-73.5,47.4],"EPSG:4326","EPSG:3857"),ls.vs([-72.4,48.6],"EPSG:4326","EPSG:3857")])}),o=new ns.Z({name:"feature2",geometry:new us.Z(ls.vs([-73,46.6],"EPSG:4326","EPSG:3857"))}),n=new ns.Z({name:"feature3",geometry:new As.ZP([[ls.vs([-71,46.8],"EPSG:4326","EPSG:3857"),ls.vs([-73,47],"EPSG:4326","EPSG:3857"),ls.vs([-71.2,46.6],"EPSG:4326","EPSG:3857")]])});e.ol.addFeatures([i,o,n]),this.layerService.createAsyncLayer({title:"Vector tile with custom getfeatureinfo url",visible:!0,sourceOptions:{type:"mvt",url:"https://ahocevar.com/geoserver/gwc/service/tms/1.0.0/ne:ne_10m_admin_0_countries@EPSG:900913@pbf/{z}/{x}/{-y}.pbf",queryable:!0,queryUrl:"https://geoegl.msp.gouv.qc.ca/apis/wss/amenagement.fcgi?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&FORMAT=image%2Fpng&TRANSPARENT=true&QUERY_LAYERS=SDA_REGION_S_20K&LAYERS=SDA_REGION_S_20K&DPI=96&MAP_RESOLUTION=96&FORMAT_OPTIONS=dpi%3A96&INFO_FORMAT=geojson&FEATURE_COUNT=5&I=50&J=50&CRS=EPSG:{srid}&STYLES=&WIDTH=101&HEIGHT=101&BBOX={xmin},{ymin},{xmax},{ymax}",queryLayerFeatures:!1,queryFormat:"geojson"},mapboxStyle:{url:"assets/mapboxStyleExample-vectortile.json",source:"ahocevar"}}).subscribe(function(e){return t.map.addLayer(e)}),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/wss/incendie.fcgi",queryable:!0,queryUrl:"https://geoegl.msp.gouv.qc.ca/apis/wss/amenagement.fcgi?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&FORMAT=image%2Fpng&TRANSPARENT=true&QUERY_LAYERS=SDA_MUNIC_S_20K&LAYERS=SDA_MUNIC_S_20K&DPI=96&MAP_RESOLUTION=96&FORMAT_OPTIONS=dpi%3A96&INFO_FORMAT=geojson&FEATURE_COUNT=5&I=50&J=50&CRS=EPSG:{srid}&STYLES=&WIDTH=101&HEIGHT=101&BBOX={xmin},{ymin},{xmax},{ymax}",queryFormat:"geojson",params:{layers:"caserne",version:"1.3.0"}}).subscribe(function(e){t.map.addLayer(t.layerService.createLayer({title:"WMS with custom getfeatureinfo url",source:e,sourceOptions:e.options}))})}},{key:"handleQueryResults",value:function(e){var t,i=e.features;i.length&&i[0]&&(t=i[0],this.feature$.next(t),this.map.queryResultsOverlay.setFeatures([t],tc.None))}},{key:"getTitle",value:function(e){return St(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ce),w.Y36(du),w.Y36(Xu),w.Y36(Hy))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-query"]],decls:18,vars:7,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/query"],["igoOverlay","","igoQuery","",3,"map","view","queryFeatures","query"],["color","primary",3,"map"],["title","Details"],[4,"ngIf"],[2,"background-color","#e0e0e0"],[3,"feature"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Geo"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Query"),w.qZA(),w.TgZ(5,"mat-card-content"),w.TgZ(6,"li"),w._uU(7,"Dependencies: LanguageService"),w.qZA(),w._UZ(8,"br"),w._uU(9," See the "),w.TgZ(10,"a",0),w._uU(11,"code of this example"),w.qZA(),w._UZ(12,"hr"),w.qZA(),w.TgZ(13,"igo-map-browser",1),w.NdJ("query",function(e){return t.handleQueryResults(e)}),w._UZ(14,"igo-zoom-button",2),w.qZA(),w.TgZ(15,"igo-panel",3),w.YNc(16,kS,6,2,"ng-container",4),w.ALo(17,"async"),w.qZA(),w.qZA()),2&e&&(w.xp6(13),w.Q6J("map",t.map)("view",t.view)("queryFeatures",!0),w.xp6(1),w.Q6J("map",t.map),w.xp6(2),w.Q6J("ngIf",w.lcZ(17,5,t.feature$)))},directives:[O.a8,O.$j,O.n5,O.dn,Du,Wy,wp,ju,vn,F.O5,Ph],pipes:[F.Ov],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),e}()}]),TS=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[CS,F.ez,O.QW,S.ot,k.Ps,yn,jy,Xy,mb,Sg]]}),e}(),AS=Z.Bz.forChild([{path:"catalog",component:function(){var e=function(){function e(t,i,o,n,r){m(this,e),this.configService=t,this.languageService=i,this.layerService=o,this.catalogService=n,this.storageService=r,this.map=new _u({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:7},this.catalogStore=new At([]),this.catalogItemStore=new At([])}return y(e,[{key:"ngOnInit",value:function(){var e=this;this.layerService.createAsyncLayer({title:"OSM",sourceOptions:{type:"osm"}}).subscribe(function(t){return e.map.addLayer(t)}),this.loadCatalogs()}},{key:"onCatalogSelectChange",value:function(e){this.loadCatalogItems(e.catalog)}},{key:"loadCatalogs",value:function(){var e=this;this.catalogService.loadCatalogs().subscribe(function(t){e.catalogStore.clear(),e.catalogStore.load(t.concat(e.storageService.get("addedCatalogs")||[]))})}},{key:"loadCatalogItems",value:function(e){var t=this;this.catalogService.loadCatalogItems(e).subscribe(function(e){t.catalogItemStore.clear(),t.catalogItemStore.load(e)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(he),w.Y36(Ce),w.Y36(Xu),w.Y36(Tp),w.Y36(De))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-catalog"]],decls:23,vars:6,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/catalog"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/environments"],[3,"map","view"],["color","primary",3,"map"],["title","Catalog Library"],[3,"store","catalogSelectChange"],["title","Catalog Browser"],[3,"store","map"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Geo"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Catalog"),w.qZA(),w.TgZ(5,"mat-card-content"),w.TgZ(6,"li"),w._uU(7,"Dependencies: ConfigService, LanguageService"),w.qZA(),w._UZ(8,"br"),w._uU(9," See the "),w.TgZ(10,"a",0),w._uU(11,"code of this example"),w.qZA(),w._UZ(12,"br"),w._uU(13," See catalog section of the "),w.TgZ(14,"a",1),w._uU(15," environment config"),w.qZA(),w._UZ(16,"hr"),w.qZA(),w.TgZ(17,"igo-map-browser",2),w._UZ(18,"igo-zoom-button",3),w.qZA(),w.TgZ(19,"igo-panel",4),w.TgZ(20,"igo-catalog-library",5),w.NdJ("catalogSelectChange",function(e){return t.onCatalogSelectChange(e)}),w.qZA(),w.qZA(),w.TgZ(21,"igo-panel",6),w._UZ(22,"igo-catalog-browser",7),w.qZA(),w.qZA()),2&e&&(w.xp6(17),w.Q6J("map",t.map)("view",t.view),w.xp6(1),w.Q6J("map",t.map),w.xp6(2),w.Q6J("store",t.catalogStore),w.xp6(2),w.Q6J("store",t.catalogItemStore)("map",t.map))},directives:[O.a8,O.$j,O.n5,O.dn,Du,ju,vn,rh,Fp],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}"]}),e}()}]),LS=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({providers:[fe({default:wr.igo})],imports:[[F.ez,AS,O.QW,S.ot,k.Ps,L.AV,ve,yn,jy,ph]]}),e}(),ZS=l(96330);Error,Error;var FS=function(){return(e=FS||(FS={}))[e.null=0]="null",e[e.read=1]="read",e[e.write=2]="write",FS;var e}(),OS=function(){var e=function(){function e(t,i,o,n,r,a){var s=this;m(this,e),this.http=t,this.authService=i,this.languageService=o,this.config=n,this.messageService=r,this.route=a,this.context$=new R.X(void 0),this.contexts$=new R.X({ours:[]}),this.defaultContextId$=new R.X(void 0),this.editedContext$=new R.X(void 0),this.importedContext=[],this.toolsChanged$=new Q.xQ,this.mapViewFromRoute={},this.options=Object.assign({basePath:"contexts",contextListFile:"_contexts.json",defaultContextUri:"_default"},this.config.getConfig("context")),this.baseUrl=this.options.url,this.readParamsFromRoute(),this.authService.hasAuthService?this.authService.logged$.subscribe(function(e){e&&(s.contexts$.pipe((0,Be.T)(1),(0,Wa.P)()).subscribe(function(e){s.handleContextsChange()}),s.loadContexts())}):(this.loadContexts(),this.handleContextsChange(!1))}return y(e,[{key:"defaultContextUri",get:function(){return this._defaultContextUri||this.options.defaultContextUri},set:function(e){this._defaultContextUri=e}},{key:"get",value:function(e,t){var i=this.baseUrl+"/contexts";return e&&this.authService.authenticated&&(i+="?permission="+e.join(),t&&(i+="&hidden=true")),this.http.get(i)}},{key:"getById",value:function(e){return this.http.get(this.baseUrl+"/contexts/"+e)}},{key:"getDetails",value:function(e){var t=this;return this.http.get("".concat(this.baseUrl,"/contexts/").concat(e,"/details")).pipe((0,q.K)(function(i){throw t.handleError(i,e),i}))}},{key:"getDefault",value:function(){var e=this;return this.http.get(this.baseUrl+"/contexts/default").pipe((0,oa.b)(function(t){e.defaultContextId$.next(t.id)}))}},{key:"getProfilByUser",value:function(){return this.baseUrl?this.http.get(this.baseUrl+"/profils?"):(0,U.of)([])}},{key:"setDefault",value:function(e){return this.http.post(this.baseUrl+"/contexts/default",{defaultContextId:e})}},{key:"hideContext",value:function(e){return this.http.post(this.baseUrl+"/contexts/"+e+"/hide",{})}},{key:"showContext",value:function(e){return this.http.post(this.baseUrl+"/contexts/"+e+"/show",{})}},{key:"delete",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o={ours:[]};return Object.keys(this.contexts$.value).forEach(function(i){return o[i]=t.contexts$.value[i].filter(function(t){return t.id!==e})}),i?(this.importedContext=this.importedContext.filter(function(t){return t.id!==e}),(0,U.of)(this.contexts$.next(o))):this.http.delete(this.baseUrl+"/contexts/"+e).pipe((0,oa.b)(function(e){t.contexts$.next(o)}))}},{key:"create",value:function(e){var t=this;return this.http.post(this.baseUrl+"/contexts",e).pipe((0,D.U)(function(e){return e.permission=t.authService.authenticated?FS[FS.write]:FS[FS.read],t.contexts$.value.ours.unshift(e),t.contexts$.next(t.contexts$.value),e}))}},{key:"clone",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.http.post(this.baseUrl+"/contexts/"+e+"/clone",i).pipe((0,D.U)(function(e){return e.permission=FS[FS.write],t.contexts$.value.ours.unshift(e),t.contexts$.next(t.contexts$.value),e}))}},{key:"update",value:function(e,t){return this.http.patch(this.baseUrl+"/contexts/"+e,t)}},{key:"addToolAssociation",value:function(e,t){return this.http.post("".concat(this.baseUrl,"/contexts/").concat(e,"/tools"),{toolId:t})}},{key:"deleteToolAssociation",value:function(e,t){return this.http.delete("".concat(this.baseUrl,"/contexts/").concat(e,"/tools/").concat(t))}},{key:"getPermissions",value:function(e){return this.http.get(this.baseUrl+"/contexts/"+e+"/permissions")}},{key:"addPermissionAssociation",value:function(e,t,i){var o=this;return this.http.post("".concat(this.baseUrl,"/contexts/").concat(e,"/permissions"),{profil:t,typePermission:i}).pipe((0,q.K)(function(e){throw o.handleError(e,void 0,!0),[e]}))}},{key:"deletePermissionAssociation",value:function(e,t){return this.http.delete("".concat(this.baseUrl,"/contexts/").concat(e,"/permissions/").concat(t))}},{key:"getLocalContexts",value:function(){var e=this.getPath(this.options.contextListFile);return this.http.get(e).pipe((0,D.U)(function(e){return{ours:e}}))}},{key:"getLocalContext",value:function(e){var t=this,i=this.getPath("".concat(e,".json"));return this.http.get(i).pipe((0,es.zg)(function(i){if(!i.base)return(0,U.of)(i);var o=t.getPath("".concat(i.base,".json"));return t.http.get(o).pipe((0,D.U)(function(e){var t=i;return t.map=K.mergeDeep(e.map,i.map),t.layers=(e.layers||[]).concat(i.layers||[]).reverse().filter(function(e,t,i){return!e.id||i.findIndex(function(t){return t.id===e.id})===t}).reverse(),t.toolbar=i.toolbar||e.toolbar,t.message=i.message||e.message,t.messages=i.messages||e.messages,t.tools=(i.tools||[]).concat(e.tools||[]).filter(function(e,t,i){return i.findIndex(function(t){return t.name===e.name})===t}),t}),(0,q.K)(function(i){throw t.handleError(i,e),i}))}),(0,q.K)(function(i){throw t.handleError(i,e),i}))}},{key:"loadContexts",value:function(e,t){var i=this;(this.baseUrl?this.get(e,t):this.getLocalContexts()).subscribe(function(e){e.ours=i.importedContext.concat(e.ours),i.contexts$.next(e)})}},{key:"loadDefaultContext",value:function(){var e=this,t=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!t&&e.baseUrl&&e.authService.authenticated?e.getDefault().subscribe(function(t){e.defaultContextUri=t.uri,e.addContextToList(t),e.setContext(t)},function(){e.defaultContextId$.next(void 0),e.loadContext(e.defaultContextUri)}):e.loadContext(e.defaultContextUri)};this.route&&this.route.options.contextKey?this.route.queryParams.pipe((0,E.b)(100)).subscribe(function(i){var o=i[e.route.options.contextKey],n=!1;o&&(e.defaultContextUri=o,n=!0),t(n)}):t()}},{key:"loadContext",value:function(e){var t=this,i=this.context$.value;i&&i.uri===e||this.getContextByUri(e).pipe((0,Wa.P)()).subscribe(function(e){t.addContextToList(e),t.setContext(e)},function(i){e!==t.options.defaultContextUri&&t.loadContext(t.options.defaultContextUri)})}},{key:"setContext",value:function(e){this.handleContextMessage(e);var t=this.context$.value;if(t&&e&&e.id===t.id)return void 0===e.map.view.keepCurrentView&&(e.map.view.keepCurrentView=!0),void this.context$.next(e);e.map||(e.map={view:{}}),Object.assign(e.map.view,this.mapViewFromRoute),this.context$.next(e)}},{key:"loadEditedContext",value:function(e){var t=this;this.getContextByUri(e).subscribe(function(e){t.setEditedContext(e)})}},{key:"setEditedContext",value:function(e){this.editedContext$.next(e)}},{key:"getContextFromMap",value:function(e,t){var i,o=e.ol.getView(),n=o.getProjection().getCode(),r=new us.Z(o.getCenter()).transform(n,"EPSG:4326"),a={uri:oe(),title:"",scope:"private",map:{view:{center:r.getCoordinates(),zoom:o.getZoom(),projection:n,maxZoomOnExtent:e.viewController.maxZoomOnExtent}},layers:[],tools:[]},s=0,l=p(!0===t?e.layers$.getValue().filter(function(e){return!0===e.baseLayer||"searchPointerSummaryId"===e.options.id}).sort(function(e,t){return e.zIndex-t.zIndex}):e.layers$.getValue().filter(function(e){return!e.id.includes("WfsWorkspaceTableDest")}).sort(function(e,t){return e.zIndex-t.zIndex}));try{for(l.s();!(i=l.n()).done;){var c=i.value,u={id:c.options.id?String(c.options.id):void 0,layerOptions:{title:c.options.title,zIndex:++s,visible:c.visible},sourceOptions:{type:c.dataSource.options.type,params:c.dataSource.options.params,url:c.dataSource.options.url,queryable:c.queryable}};u.sourceOptions.type&&a.layers.push(u)}}catch(d){l.e(d)}finally{l.f()}return a.tools=this.tools.map(function(e){return{id:String(e.id),global:e.global}}),a}},{key:"getContextFromLayers",value:function(e,t,i){var o=this.context$.getValue(),n=e.ol.getView(),r=n.getProjection().getCode(),a={uri:i,title:i,map:{view:{center:new us.Z(n.getCenter()).transform(r,"EPSG:4326").getCoordinates(),zoom:n.getZoom(),projection:r}},layers:[],toolbar:[],tools:[],extraFeatures:[]},s=e.layers$.getValue();return a.layers=s.filter(function(e){return e.baseLayer}).map(function(e){return{baseLayer:!0,sourceOptions:e.options.sourceOptions,title:e.options.title,visible:e.visible}}),t.forEach(function(e){var t=o.layers.find(function(t){return e.id===t.source.id&&!t.baseLayer});if(t){var i=t.style;t.styleByAttribute?i=void 0:t.clusterBaseStyle&&(i=void 0,delete t.sourceOptions.source,delete t.sourceOptions.format),a.layers.push({baseLayer:t.baseLayer,title:e.options.title,zIndex:e.zIndex,styleByAttribute:t.styleByAttribute,clusterBaseStyle:t.clusterBaseStyle,style:i,clusterParam:t.clusterParam,visible:e.visible,opacity:e.opacity,sourceOptions:t.sourceOptions})}else if(e.ol.getSource()instanceof el.Z){var n,r=new Zs.Z;if(e.ol.getSource()instanceof Ks.Z){var s=e.ol.getSource();n=r.writeFeatures(s.getFeatures(),{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"})}else{var l=e.ol.getSource();n=r.writeFeatures(l.getFeatures(),{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"})}(n=JSON.parse(n)).name=e.options.title,a.extraFeatures.push(n)}else{var c=e.options;c.zIndex=e.zIndex,delete c.source,a.layers.push(c)}}),a.toolbar=this.toolbar,a.tools=this.tools,a}},{key:"setTools",value:function(e){this.tools=e}},{key:"setToolbar",value:function(e){this.toolbar=e}},{key:"handleContextMessage",value:function(e){var t=this;this.context$.value&&e.uri&&this.context$.value.uri!==e.uri&&this.messageService.removeAllAreNotError(),e.messages=e.messages?e.messages:[],e.messages.push(e.message),e.messages.map(function(e){e&&(e.title=e.title?t.languageService.translate.instant(e.title):void 0,e.text=e.text?t.languageService.translate.instant(e.text):void 0,t.messageService.message(e))})}},{key:"getContextByUri",value:function(e){if(this.baseUrl){for(var t,i=0,o=Object.keys(this.contexts$.value);i<o.length;i++){var n=o[i];if(t=this.contexts$.value[n].find(function(t){return t.uri===e}))break}return t&&t.imported?(0,U.of)(t):this.getDetails(t?t.id:e)}var r=this.contexts$.value.ours.find(function(t){return t.uri===e&&!0===t.imported});return r?(0,U.of)(r):this.getLocalContext(e)}},{key:"getContextLayers",value:function(e){var t=[];return e.layers$.getValue().forEach(function(e){!e.baseLayer&&"searchPointerSummaryId"!==e.options.id&&t.push(e)}),t}},{key:"readParamsFromRoute",value:function(){var e=this;!this.route||this.route.queryParams.subscribe(function(t){var i=e.route.options.centerKey;i&&t[i]&&(e.mapViewFromRoute.center=t[i].split(",").map(Number),e.mapViewFromRoute.geolocate=!1);var o=e.route.options.projectionKey;o&&t[o]&&(e.mapViewFromRoute.projection=t[o]);var n=e.route.options.zoomKey;n&&t[n]&&(e.mapViewFromRoute.zoom=Number(t[n]))})}},{key:"getPath",value:function(e){return"".concat(this.options.basePath.replace(/\/$/,""),"/").concat(e)}},{key:"handleError",value:function(e,t,i){var o=this.contexts$.value.ours.find(function(e){return e.uri===t}),n=o?o.title:t;e.error.title=this.languageService.translate.instant("igo.context.contextManager.invalid.title"),e.error.message=this.languageService.translate.instant("igo.context.contextManager.invalid.text",{value:n}),e.error.toDisplay=!0,i&&(e.error.title=this.languageService.translate.instant("igo.context.contextManager.errors.addPermissionTitle"),e.error.message=this.languageService.translate.instant("igo.context.contextManager.errors.addPermission")),this.messageService.error(e.error.message,e.error.title)}},{key:"handleContextsChange",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=this.context$.value,o=this.editedContext$.value;(!i||i.uri===this.options.defaultContextUri)&&(t=!1),t&&this.findContext(i)?(this.getContextByUri(i.uri).pipe((0,Wa.P)()).subscribe(function(t){e.toolsChanged$.next(t)}),this.baseUrl&&this.authService.authenticated&&this.getDefault().subscribe()):(this.defaultContextUri=void 0,this.loadDefaultContext());var n=this.findContext(o);(!n||"write"!==n.permission)&&this.setEditedContext(void 0)}},{key:"addContextToList",value:function(e){if(!this.findContext(e)){var t={id:e.id,uri:e.uri,title:e.title,scope:e.scope,permission:FS[FS.read]};this.contexts$.value&&this.contexts$.value.public&&(this.contexts$.value.public.push(t),this.contexts$.next(this.contexts$.value))}}},{key:"findContext",value:function(e){if(!e)return!1;for(var t,i=this.contexts$.value,o=0,n=Object.keys(i);o<n.length;o++){if(t=i[n[o]].find(function(t){return e.id&&t.id===e.id||e.uri&&t.uri===e.uri}))break}return t}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(P.eN),w.LFG(fa),w.LFG(Ce),w.LFG(he),w.LFG(Ae),w.LFG(Oe,8))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),MS=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[We.u5,We.UX,F.ez,S.ot,Al.vV,kl.t,ql.Nh,ze.LD,Ve.Ng,Ye.lN,ot.c,M.p9,Se,Sn,L.AV]]}),e}(),IS=function(){var e=function(){function e(t,i,o){m(this,e),this.contextService=i,this.mediaService=o,this.component=t}return y(e,[{key:"map",get:function(){return this.component.map}},{key:"ngOnInit",value:function(){var e=this;this.context$$=this.contextService.context$.pipe((0,Qe.h)(function(e){return void 0!==e})).subscribe(function(t){return e.handleContextChange(t)})}},{key:"ngOnDestroy",value:function(){this.context$$.unsubscribe()}},{key:"handleContextChange",value:function(e){if(void 0!==e.map){var t=e.map.view;(!this.component.view||!0!==t.keepCurrentView)&&(this.component.view=t);var i=e.map.controls;if(!this.component.controls&&i){if(this.mediaService.isMobile()&&"boolean"!=typeof i.scaleLine){var o=i.scaleLine;o.minWidth||(o.minWidth=Math.min(64,o.minWidth),i.scaleLine=o)}this.component.controls=i}}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Du),w.Y36(OS),w.Y36(Pe))},e.\u0275dir=w.lG2({type:e,selectors:[["","igoMapContext",""]]}),e}(),PS=function(){var e=function(){function e(t,i,o,n,r,a,s){m(this,e),this.component=t,this.contextService=i,this.layerService=o,this.configService=n,this.styleListService=r,this.styleService=a,this.route=s,this.contextLayers=[],this.removeLayersOnContextChange=!0}return y(e,[{key:"map",get:function(){return this.component.map}},{key:"ngOnInit",value:function(){var e=this;if(this.context$$=this.contextService.context$.pipe((0,Qe.h)(function(e){return void 0!==e})).subscribe(function(t){return e.handleContextChange(t)}),this.route&&this.route.options.visibleOnLayersKey&&this.route.options.visibleOffLayersKey&&this.route.options.contextKey)var t=this.route.queryParams.subscribe(function(i){Object.keys(i).length>0&&(e.queryParams=i,t.unsubscribe())})}},{key:"ngOnDestroy",value:function(){this.context$$.unsubscribe()}},{key:"handleContextChange",value:function(e){var t=this;if(void 0!==e.layers){!0===this.removeLayersOnContextChange?this.map.removeAllLayers():this.map.removeLayers(this.contextLayers),this.contextLayers=[];var i=Je.T.apply(void 0,d(e.layers.map(function(i,o){return t.layerService.createAsyncLayer(i,e.uri)})));i.pipe((0,ZS.f)(i.pipe((0,E.b)(500)))).subscribe(function(i){i=i.filter(function(e){return void 0!==e}).map(function(e){return e.visible=t.computeLayerVisibilityFromUrl(e),e.zIndex=e.zIndex,e}),t.contextLayers.concat(i),t.map.addLayers(i),e.extraFeatures&&e.extraFeatures.forEach(function(e){var i=new Zs.Z,o=e.name;e=JSON.stringify(e),e=i.readFeatures(e,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"}),t.configService.getConfig("importWithStyle")?function(e,t,i,o,n){var r,a,s;if(o.getStyleList(i.toString()+".styleByAttribute")){var l=o.getStyleList(i.toString()+".styleByAttribute");r=function(e){return n.createStyleByAttribute(e,l)}}else if(o.getStyleList(i.toString()+".clusterStyle")){var c=o.getStyleList(i.toString()+".clusterParam");a=o.getStyleList(i.toString()+".distance");var u=n.createStyle(o.getStyleList(i.toString()+".clusterStyle"));r=function(e){return n.createClusterStyle(e,c,u)}}else r=o.getStyleList(i.toString()+".style")?n.createStyle(o.getStyleList(i.toString()+".style")):n.createStyle(o.getStyleList("default.style"));o.getStyleList(i.toString()+".clusterStyle")?(s=new qc({distance:a,type:"cluster",queryable:!0})).ol.source.addFeatures(e):(s=new _c({type:"vector",queryable:!0})).ol.addFeatures(e);var p=new jc({title:i,source:s,style:r});t.addLayer(p)}(e,t.map,o,t.styleListService,t.styleService):function(e,t,i){var o=Math.floor(255*Math.random()),n=Math.floor(255*Math.random()),r=Math.floor(255*Math.random()),a=new ws.Z({color:[o,n,r,1],width:2}),s=new ys.Z({color:[o,n,r,.4]}),l=new _c({type:"vector",queryable:!0});l.ol.addFeatures(e);var c=new jc({title:i,source:l,style:new ms.ZP({stroke:a,fill:s,image:new xs.Z({radius:5,stroke:a,fill:s})})});t.addLayer(c)}(e,t.map,o)})})}}},{key:"computeLayerVisibilityFromUrl",value:function(e){var t=this.queryParams,i=e.id,o=e.visible;if(!t||!i)return o;var n=t[this.route.options.contextKey];if(n===this.contextService.context$.value.uri||!n){var r="",a="",s=[],l=[];this.route.options.visibleOnLayersKey&&t[this.route.options.visibleOnLayersKey]&&(r=t[this.route.options.visibleOnLayersKey]),this.route.options.visibleOffLayersKey&&t[this.route.options.visibleOffLayersKey]&&(a=t[this.route.options.visibleOffLayersKey]),"*"===r&&(o=!0),"*"===a&&(o=!1),s=r.split(","),l=a.split(","),(s.indexOf(i)>-1||s.indexOf(i.toString())>-1)&&(o=!0),(l.indexOf(i)>-1||l.indexOf(i.toString())>-1)&&(o=!1)}return o}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Du),w.Y36(OS),w.Y36(Xu),w.Y36(he),w.Y36(fy),w.Y36(Zu),w.Y36(Oe,8))},e.\u0275dir=w.lG2({type:e,selectors:[["","igoLayerContext",""]],inputs:{removeLayersOnContextChange:"removeLayersOnContextChange"}}),e}(),_S=function(){return(e=_S||(_S={})).always="always",e.never="never",e.default="default",_S;var e}(),qS=function(){var e=function e(t){m(this,e),this.dialogRef=t};return e.\u0275fac=function(t){return new(t||e)(w.Y36(ut.so))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-bookmark-dialog"]],decls:14,vars:14,consts:[["mat-dialog-title","",1,"mat-typography"],["mat-dialog-content","",1,"mat-typography"],["matInput","","required","","autocomplete","off","maxlength","128",3,"placeholder","ngModel","ngModelChange"],["mat-dialog-actions",""],["mat-button","","color","primary",3,"disabled","click"],["mat-button","",3,"click"]],template:function(e,t){1&e&&(w.TgZ(0,"h1",0),w._uU(1),w.ALo(2,"translate"),w.qZA(),w.TgZ(3,"div",1),w.TgZ(4,"mat-form-field"),w.TgZ(5,"input",2),w.NdJ("ngModelChange",function(e){return t.title=e}),w.ALo(6,"translate"),w.qZA(),w.qZA(),w.qZA(),w.TgZ(7,"div",3),w.TgZ(8,"button",4),w.NdJ("click",function(){return t.dialogRef.close(t.title)}),w._uU(9),w.ALo(10,"translate"),w.qZA(),w.TgZ(11,"button",5),w.NdJ("click",function(){return t.dialogRef.close(!1)}),w._uU(12),w.ALo(13,"translate"),w.qZA(),w.qZA()),2&e&&(w.xp6(1),w.Oqu(w.lcZ(2,6,"igo.context.bookmarkButton.dialog.title")),w.xp6(4),w.Q6J("placeholder",w.lcZ(6,8,"igo.context.bookmarkButton.dialog.placeholder"))("ngModel",t.title),w.xp6(3),w.Q6J("disabled",!t.title),w.xp6(1),w.hij(" ",w.lcZ(10,10,"igo.common.confirmDialog.confirmBtn")," "),w.xp6(3),w.hij(" ",w.lcZ(13,12,"igo.common.confirmDialog.cancelBtn")," "))},directives:[ut.uh,ut.xY,Ye.KE,ot.Nt,We.Fj,We.Q7,We.nD,We.JJ,We.On,ut.H8,S.lW],pipes:[ae.X$],encapsulation:2}),e}();function DS(e,t){if(1&e&&w._UZ(0,"mat-icon",7),2&e){var i=w.oxw(2);w.s9C("svgIcon",i.context.icon?i.context.icon:"public"===i.context.scope?"earth":"star")}}function ES(e,t){if(1&e&&w._UZ(0,"img",8),2&e){var i=w.oxw(2);w.Q6J("src",i.context.iconImage,w.LSH)}}function $S(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",4),w.NdJ("click",function(){w.CHM(i);var e=w.oxw();return e.favoriteClick(e.context)}),w.ALo(1,"translate"),w.YNc(2,DS,1,1,"mat-icon",5),w.YNc(3,ES,1,1,"img",6),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("matTooltip",o.auth.authenticated?w.lcZ(1,4,"igo.context.contextManager.favorite"):"")("color",o.default?"primary":"default"),w.xp6(2),w.Q6J("ngIf",!o.context.iconImage),w.xp6(1),w.Q6J("ngIf",o.context.iconImage)}}function RS(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",20),w.NdJ("click",function(){w.CHM(i);var e=w.oxw(2);return e.save.emit(e.context)}),w.ALo(1,"translate"),w._UZ(2,"mat-icon",21),w.qZA()}if(2&e){var o=w.oxw(2);w.Q6J("matTooltip",w.lcZ(1,2,"igo.context.contextManager.save"))("color",o.color)}}function NS(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",22),w.NdJ("click",function(){w.CHM(i);var e=w.oxw(2);return e.managePermissions.emit(e.context)}),w.ALo(1,"translate"),w._UZ(2,"mat-icon",23),w.qZA()}if(2&e){var o=w.oxw(2);w.Q6J("matTooltip",w.lcZ(1,2,"igo.context.contextManager.managePermissions"))("color",o.color)}}function US(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",24),w.NdJ("click",function(){w.CHM(i);var e=w.oxw(2);return e.clone.emit(e.context)}),w.ALo(1,"translate"),w._UZ(2,"mat-icon",25),w.qZA()}if(2&e){var o=w.oxw(2);w.Q6J("matTooltip",w.lcZ(1,2,"igo.context.contextManager.clone"))("color",o.color)}}function JS(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",26),w.NdJ("click",function(){w.CHM(i);var e=w.oxw(2);return e.edit.emit(e.context)}),w.ALo(1,"translate"),w._UZ(2,"mat-icon",27),w.qZA()}if(2&e){var o=w.oxw(2);w.Q6J("color",o.color)("matTooltip",w.lcZ(1,2,"igo.context.contextManager.edit"))}}function BS(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",28),w.NdJ("click",function(){w.CHM(i);var e=w.oxw(2);return e.hide.emit(e.context)}),w.ALo(1,"translate"),w._UZ(2,"mat-icon",29),w.qZA()}if(2&e){var o=w.oxw(2);w.Q6J("color",o.color)("matTooltip",w.lcZ(1,2,"igo.context.contextManager.hide"))}}function jS(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",28),w.NdJ("click",function(){w.CHM(i);var e=w.oxw(2);return e.show.emit(e.context)}),w.ALo(1,"translate"),w._UZ(2,"mat-icon",30),w.qZA()}if(2&e){var o=w.oxw(2);w.Q6J("color",o.color)("matTooltip",w.lcZ(1,2,"igo.context.contextManager.show"))}}function QS(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",31),w.NdJ("click",function(){w.CHM(i);var e=w.oxw(2);return e.delete.emit(e.context)}),w.ALo(1,"translate"),w._UZ(2,"mat-icon",32),w.qZA()}2&e&&w.Q6J("matTooltip",w.lcZ(1,1,"igo.context.contextManager.delete"))}function GS(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",9),w.YNc(1,RS,3,4,"button",10),w.TgZ(2,"div",11,12),w.YNc(4,NS,3,4,"button",13),w.YNc(5,US,3,4,"button",14),w.YNc(6,JS,3,4,"button",15),w.YNc(7,BS,3,4,"button",16),w.YNc(8,jS,3,4,"button",16),w.YNc(9,QS,3,3,"button",17),w.qZA(),w.TgZ(10,"button",18),w.NdJ("click",function(){w.CHM(i);var e=w.oxw();return e.collapsed=!e.collapsed}),w._UZ(11,"mat-icon",19),w.qZA(),w.qZA()}if(2&e){var o=w.MAs(3),n=w.oxw();w.xp6(1),w.Q6J("ngIf",n.collapsed&&n.selected&&(n.context.permission===n.typePermission[n.typePermission.write]||n.context.imported)),w.xp6(3),w.Q6J("ngIf",n.canShare&&!n.context.imported),w.xp6(1),w.Q6J("ngIf",!n.context.imported),w.xp6(1),w.Q6J("ngIf",n.context.permission===n.typePermission[n.typePermission.write]&&!n.context.imported),w.xp6(1),w.Q6J("ngIf",!n.context.hidden&&!n.context.imported),w.xp6(1),w.Q6J("ngIf",n.context.hidden&&!n.context.imported),w.xp6(1),w.Q6J("ngIf",n.context.permission===n.typePermission[n.typePermission.write]||n.context.imported),w.xp6(1),w.Q6J("color",n.color)("target",o)("collapsed",n.collapsed)}}var YS=function(e){return{"mat-list-item-light":e}},zS=function(){var e=function(){function e(t,i){m(this,e),this.auth=t,this.storageService=i,this.typePermission=FS,this.color="primary",this.collapsed=!0,this._default=!1,this.edit=new w.vpe,this.delete=new w.vpe,this.save=new w.vpe,this.clone=new w.vpe,this.hide=new w.vpe,this.show=new w.vpe,this.favorite=new w.vpe,this.managePermissions=new w.vpe,this.manageTools=new w.vpe}return y(e,[{key:"context",get:function(){return this._context},set:function(e){this._context=e}},{key:"default",get:function(){return this._default},set:function(e){this._default=e}},{key:"hidden",get:function(){return this.context.hidden}},{key:"canShare",get:function(){return!0===this.storageService.get("canShare")}},{key:"favoriteClick",value:function(e){this.auth.authenticated&&this.favorite.emit(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(fa),w.Y36(De))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-context-item"]],inputs:{context:"context",default:"default",selected:"selected"},outputs:{edit:"edit",delete:"delete",save:"save",clone:"clone",hide:"hide",show:"show",favorite:"favorite",managePermissions:"managePermissions",manageTools:"manageTools"},decls:5,vars:6,consts:[[1,"mat-list-item",3,"ngClass"],["mat-list-avatar","","mat-icon-button","","igoStopPropagation","","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],["matLine",""],["igoStopPropagation","","class","igo-actions-container",4,"ngIf"],["mat-list-avatar","","mat-icon-button","","igoStopPropagation","","matTooltipShowDelay","500",3,"matTooltip","color","click"],[3,"svgIcon",4,"ngIf"],[3,"src",4,"ngIf"],[3,"svgIcon"],[3,"src"],["igoStopPropagation","",1,"igo-actions-container"],["class","save-button","mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],[1,"igo-actions-expand-container"],["actions",""],["mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],["class","clone-button","mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","color","click",4,"ngIf"],["class","edit-button","mat-icon-button","","matTooltipShowDelay","500",3,"color","matTooltip","click",4,"ngIf"],["class","hide-button","mat-icon-button","","matTooltipShowDelay","500",3,"color","matTooltip","click",4,"ngIf"],["class","delete-button","mat-icon-button","","color","warn","matTooltipShowDelay","500",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","igoCollapse","",1,"actions-button",3,"color","target","collapsed","click"],["svgIcon","dots-horizontal"],["mat-icon-button","","matTooltipShowDelay","500",1,"save-button",3,"matTooltip","color","click"],["svgIcon","content-save"],["mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","color","click"],["svgIcon","account-arrow-right"],["mat-icon-button","","matTooltipShowDelay","500",1,"clone-button",3,"matTooltip","color","click"],["svgIcon","content-copy"],["mat-icon-button","","matTooltipShowDelay","500",1,"edit-button",3,"color","matTooltip","click"],["svgIcon","pencil"],["mat-icon-button","","matTooltipShowDelay","500",1,"hide-button",3,"color","matTooltip","click"],["svgIcon","eye"],["svgIcon","eye-off"],["mat-icon-button","","color","warn","matTooltipShowDelay","500",1,"delete-button",3,"matTooltip","click"],["svgIcon","delete"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-list-item",0),w.YNc(1,$S,4,6,"button",1),w.TgZ(2,"h4",2),w._uU(3),w.qZA(),w.YNc(4,GS,12,10,"div",3),w.qZA()),2&e&&(w.Q6J("ngClass",w.VKq(4,YS,t.hidden)),w.xp6(1),w.Q6J("ngIf",t.auth.authenticated),w.xp6(2),w.Oqu(t.context.title),w.xp6(1),w.Q6J("ngIf",t.auth.authenticated))},directives:[C.Tg,F.mk,F.O5,Ve.X2,S.lW,C.eA,qt,L.gM,k.Hw,co],pipes:[ae.X$],styles:["[_nghost-%COMP%]{overflow:hidden}.igo-actions-container[_ngcontent-%COMP%]{flex-shrink:0}.igo-actions-expand-container[_ngcontent-%COMP%]{display:inline-flex}mat-list-item[_ngcontent-%COMP%]     .mat-list-item-content .mat-list-text{padding:0}mat-icon.disabled[_ngcontent-%COMP%]{color:#00000061}mat-list-item.mat-list-item-light[_ngcontent-%COMP%]     .mat-list-item-content{color:#969696}"],changeDetection:0}),e}();function VS(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",14),w.NdJ("click",function(){return w.CHM(i),w.oxw(2).clearFilter()}),w._UZ(1,"mat-icon",15),w.qZA()}}function HS(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-form-field",11),w.TgZ(1,"input",12),w.NdJ("ngModelChange",function(e){return w.CHM(i),w.oxw().term=e}),w.ALo(2,"translate"),w.qZA(),w.YNc(3,VS,2,0,"button",13),w.qZA()}if(2&e){var o=w.oxw();w.Q6J("ngClass",o.auth.authenticated&&o.configService.getConfig("context")?"context-filter-min-width":"context-filter-max-width"),w.xp6(1),w.Q6J("placeholder",w.lcZ(2,4,"igo.context.contextManager.filterPlaceHolder"))("ngModel",o.term),w.xp6(2),w.Q6J("ngIf",o.term.length)}}function WS(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",16),w.NdJ("click",function(){return w.CHM(i),w.oxw().toggleSort(!0)}),w.ALo(1,"translate"),w._UZ(2,"mat-icon",17),w.qZA()}2&e&&w.Q6J("matTooltip",w.lcZ(1,1,"igo.context.contextManager.sortAlphabetically"))}function XS(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"button",16),w.NdJ("click",function(){return w.CHM(i),w.oxw().toggleSort(!1)}),w.ALo(1,"translate"),w._UZ(2,"mat-icon",18),w.qZA()}2&e&&w.Q6J("matTooltip",w.lcZ(1,1,"igo.context.contextManager.sortContextOrder"))}function KS(e,t){if(1&e&&w._UZ(0,"igo-actionbar",19),2&e){var i=w.oxw();w.Q6J("iconColor",i.color)("store",i.actionStore)("withIcon",!0)("withTitle","overlay"===i.actionbarMode)("horizontal",!1)("mode",i.actionbarMode)}}function ek(e,t){if(1&e&&(w.TgZ(0,"button",20),w.ALo(1,"translate"),w._UZ(2,"mat-icon",21),w.qZA()),2&e){w.oxw();var i=w.MAs(7);w.Q6J("matTooltip",w.lcZ(1,2,"igo.context.contextManager.filterUser"))("matMenuTriggerFor",i)}}function tk(e,t){if(1&e&&(w.TgZ(0,"button",27),w._uU(1),w.qZA()),2&e){var i=w.oxw().$implicit,o=w.MAs(6);w.Q6J("matMenuTriggerFor",o),w.xp6(1),w.hij(" ",i.title," ")}}function ik(e,t){if(1&e&&(w.TgZ(0,"button",9),w._uU(1),w.qZA()),2&e){var i=w.oxw().$implicit;w.xp6(1),w.hij(" ",i.title," ")}}function ok(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"mat-checkbox",8),w.NdJ("click",function(e){return e.stopPropagation()})("change",function(){var e=w.CHM(i).$implicit,t=w.oxw().$implicit;return w.oxw().userSelection(e,t)}),w._uU(1),w.qZA()}if(2&e){var o=t.$implicit,n=w.oxw(2);w.Q6J("checked",n.getPermission(o).checked),w.xp6(1),w.hij(" ",o.title," ")}}function nk(e,t){if(1&e){var i=w.EpF();w.ynx(0),w.TgZ(1,"span",7),w.TgZ(2,"mat-checkbox",22),w.NdJ("click",function(e){return e.stopPropagation()})("change",function(){var e=w.CHM(i).$implicit;return w.oxw().userSelection(e)}),w.qZA(),w.YNc(3,tk,2,2,"button",23),w.YNc(4,ik,2,1,"button",24),w.qZA(),w.TgZ(5,"mat-menu",null,25),w.YNc(7,ok,2,2,"mat-checkbox",26),w.qZA(),w.BQk()}if(2&e){var o=t.$implicit,n=w.oxw();w.xp6(2),w.Q6J("checked",n.getPermission(o).checked)("indeterminate",n.getPermission(o).indeterminate),w.xp6(1),w.Q6J("ngIf",o.childs),w.xp6(1),w.Q6J("ngIf",!o.childs),w.xp6(3),w.Q6J("ngForOf",o.childs)}}function rk(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"igo-context-item",31),w.NdJ("edit",function(){var e=w.CHM(i).$implicit;return w.oxw(3).edit.emit(e)})("delete",function(){var e=w.CHM(i).$implicit;return w.oxw(3).delete.emit(e)})("clone",function(){var e=w.CHM(i).$implicit;return w.oxw(3).clone.emit(e)})("save",function(){var e=w.CHM(i).$implicit;return w.oxw(3).save.emit(e)})("hide",function(){var e=w.CHM(i).$implicit;return w.oxw(3).hideContext(e)})("show",function(){var e=w.CHM(i).$implicit;return w.oxw(3).showContext(e)})("favorite",function(){var e=w.CHM(i).$implicit;return w.oxw(3).favorite.emit(e)})("manageTools",function(){var e=w.CHM(i).$implicit;return w.oxw(3).manageTools.emit(e)})("managePermissions",function(){var e=w.CHM(i).$implicit;return w.oxw(3).managePermissions.emit(e)})("select",function(){var e=w.CHM(i).$implicit;return w.oxw(3).select.emit(e)})("unselect",function(){var e=w.CHM(i).$implicit;return w.oxw(3).unselect.emit(e)}),w.qZA()}if(2&e){var o=t.$implicit,n=w.oxw(3);w.Q6J("selected",n.selectedContext&&n.selectedContext.uri===o.uri)("context",o)("default",o.id&&n.defaultContextId&&n.defaultContextId===o.id)}}function ak(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"igo-collapsible",30),w.NdJ("toggle",function(e){w.CHM(i);var t=w.oxw().$implicit,o=w.oxw();return o.collapsed[o.titleMapping[t.key]]=e}),w.ALo(1,"translate"),w.YNc(2,rk,1,3,"ng-template",10),w.qZA()}if(2&e){var o=w.oxw().$implicit,n=w.oxw();w.Q6J("title",w.lcZ(1,3,n.titleMapping[o.key]))("collapsed",n.collapsed[n.titleMapping[o.key]]),w.xp6(2),w.Q6J("ngForOf",o.value)}}function sk(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"igo-context-item",32),w.NdJ("select",function(){var e=w.CHM(i).$implicit;return w.oxw(3).select.emit(e)})("unselect",function(){var e=w.CHM(i).$implicit;return w.oxw(3).unselect.emit(e)}),w.qZA()}if(2&e){var o=t.$implicit,n=w.oxw(3);w.Q6J("selected",n.selectedContext&&n.selectedContext.uri===o.uri)("context",o)("default",n.defaultContextId===o.id)}}function lk(e,t){if(1&e&&w.YNc(0,sk,1,3,"ng-template",10),2&e){var i=w.oxw().$implicit;w.Q6J("ngForOf",i.value)}}function ck(e,t){if(1&e&&(w.YNc(0,ak,3,5,"igo-collapsible",28),w.YNc(1,lk,1,1,void 0,29)),2&e){var i=t.$implicit,o=w.oxw();w.Q6J("ngIf",i.value.length&&o.auth.authenticated),w.xp6(1),w.Q6J("ngIf",i.value.length&&!o.auth.authenticated)}}var uk=function(){var e=function(){function e(t,i,o,n,r,a,s){m(this,e),this.cdRef=t,this.contextService=i,this.configService=o,this.auth=n,this.dialog=r,this.languageService=a,this.storageService=s,this.contextsInitial={ours:[]},this.contexts$=new R.X(this.contextsInitial),this.change$=new Re.t(1),this._contexts={ours:[]},this.collapsed=[],this.select=new w.vpe,this.unselect=new w.vpe,this.edit=new w.vpe,this.delete=new w.vpe,this.save=new w.vpe,this.clone=new w.vpe,this.create=new w.vpe,this.hide=new w.vpe,this.show=new w.vpe,this.showHiddenContexts=new w.vpe,this.favorite=new w.vpe,this.managePermissions=new w.vpe,this.manageTools=new w.vpe,this.filterPermissionsChanged=new w.vpe,this.titleMapping={ours:"igo.context.contextManager.ourContexts",shared:"igo.context.contextManager.sharedContexts",public:"igo.context.contextManager.publicContexts"},this.permissions=[],this.actionStore=new Gn([]),this.actionbarMode=$i.Overlay,this.color="primary",this.showHidden=!1,this._term="",this._sortedAlpha=void 0,this.showContextFilter=_S.always,this.thresholdToFilter=5}return y(e,[{key:"contexts",get:function(){return this._contexts},set:function(e){this._contexts=e,this.cdRef.detectChanges(),this.next()}},{key:"selectedContext",get:function(){return this._selectedContext},set:function(e){this._selectedContext=e,this.cdRef.detectChanges()}},{key:"map",get:function(){return this._map},set:function(e){this._map=e}},{key:"defaultContextId",get:function(){return this._defaultContextId},set:function(e){this._defaultContextId=e}},{key:"term",get:function(){return this._term},set:function(e){this._term=e,this.next()}},{key:"sortedAlpha",get:function(){return this._sortedAlpha},set:function(e){this._sortedAlpha=e,this.next()}},{key:"ngOnInit",value:function(){var e=this;this.change$$=this.change$.pipe((0,ts.D)(function(){return 0===e.contexts.ours.length?Va.E:(0,Ha.H)(50)})).subscribe(function(){e.contexts$.next(e.filterContextsList(e.contexts))}),this.actionStore.load([{id:"emptyContext",title:this.languageService.translate.instant("igo.context.contextManager.emptyContext"),icon:"map-outline",tooltip:this.languageService.translate.instant("igo.context.contextManager.emptyContextTooltip"),handler:function(){e.createContext(!0)}},{id:"contextFromMap",title:this.languageService.translate.instant("igo.context.contextManager.contextMap"),icon:"map-check",tooltip:this.languageService.translate.instant("igo.context.contextManager.contextMapTooltip"),handler:function(){e.createContext(!1)}}])}},{key:"next",value:function(){this.change$.next()}},{key:"filterContextsList",value:function(e){var t=this;if(""===this.term)return this.sortedAlpha&&(e=this.sortContextsList(e)),e;var i={ours:e.ours.filter(function(e){var i=t.term.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return e.title.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(i)})};if(this.contexts.public){var o=e.public.filter(function(e){var i=t.term.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return e.title.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(i)});i.public=o}if(this.contexts.shared){var n=e.shared.filter(function(e){var i=t.term.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return e.title.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(i)});i.shared=n}return this.sortedAlpha&&(i=this.sortContextsList(i)),i}},{key:"ngOnDestroy",value:function(){this.change$$.unsubscribe()}},{key:"showFilter",value:function(){switch(this.showContextFilter){case _S.always:return!0;case _S.never:return!1;default:var e=this.contexts.ours.length;return e+=this.contexts.public?this.contexts.public.length:0,(e+=this.contexts.shared?this.contexts.shared.length:0)>=this.thresholdToFilter}}},{key:"sortContextsList",value:function(e){var t=this;if(e){var i=JSON.parse(JSON.stringify(e));return i.ours.sort(function(e,i){return t.normalize(e.title)<t.normalize(i.title)?-1:t.normalize(e.title)>t.normalize(i.title)?1:0}),i.shared?i.shared.sort(function(e,i){return t.normalize(e.title)<t.normalize(i.title)?-1:t.normalize(e.title)>t.normalize(i.title)?1:0}):i.public&&i.public.sort(function(e,i){return t.normalize(e.title)<t.normalize(i.title)?-1:t.normalize(e.title)>t.normalize(i.title)?1:0}),i}}},{key:"normalize",value:function(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}},{key:"toggleSort",value:function(e){this.sortedAlpha=e}},{key:"clearFilter",value:function(){this.term=""}},{key:"createContext",value:function(e){var t=this;this.dialog.open(qS,{disableClose:!1}).afterClosed().pipe((0,Ge.q)(1)).subscribe(function(i){i&&t.create.emit({title:i,empty:e})})}},{key:"getPermission",value:function(e){if(e)return this.permissions.find(function(t){return t.name===e.name})}},{key:"userSelection",value:function(e,t){var i=this.getPermission(e);if(i&&(i.checked=!i.checked,this.storageService.set("contexts.permissions."+i.name,i.checked),i.indeterminate=!1),t){var o,n=!1,r=p(t.childs);try{for(r.s();!(o=r.n()).done;){var a=o.value;if(this.getPermission(a).checked!==i.checked){n=!0;break}}}catch(h){r.e(h)}finally{r.f()}var s=this.getPermission(t);s&&(s.checked=i.checked,this.storageService.set("contexts.permissions."+s.name,i.checked),s.indeterminate=n)}if(e.childs){var l,c=p(e.childs);try{for(c.s();!(l=c.n()).done;){var u=l.value,d=this.getPermission(u);d&&d.checked!==i.checked&&(d.checked=i.checked,this.storageService.set("contexts.permissions."+d.name,i.checked))}}catch(h){c.e(h)}finally{c.f()}}this.filterPermissionsChanged.emit(this.permissions)}},{key:"hideContext",value:function(e){if(e.hidden=!0,!this.showHidden){var t={ours:[],shared:[],public:[]};t.ours=this.contexts.ours.filter(function(t){return t.id!==e.id}),t.shared=this.contexts.shared.filter(function(t){return t.id!==e.id}),t.public=this.contexts.public.filter(function(t){return t.id!==e.id}),this.contexts=t}this.hide.emit(e)}},{key:"showContext",value:function(e){e.hidden=!1,this.show.emit(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(w.sBO),w.Y36(OS),w.Y36(he),w.Y36(fa),w.Y36(ut.uw),w.Y36(Ce),w.Y36(De))},e.\u0275cmp=w.Xpm({type:e,selectors:[["igo-context-list"]],inputs:{contexts:"contexts",selectedContext:"selectedContext",map:"map",defaultContextId:"defaultContextId",term:"term"},outputs:{select:"select",unselect:"unselect",edit:"edit",delete:"delete",save:"save",clone:"clone",create:"create",hide:"hide",show:"show",showHiddenContexts:"showHiddenContexts",favorite:"favorite",managePermissions:"managePermissions",manageTools:"manageTools",filterPermissionsChanged:"filterPermissionsChanged"},decls:17,vars:16,consts:[[3,"navigation"],[3,"ngClass",4,"ngIf"],["class","sort-alpha","mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","click",4,"ngIf"],["class","add-context-button","icon","plus",3,"iconColor","store","withIcon","withTitle","horizontal","mode",4,"ngIf"],["class","users-filter","mat-icon-button","","matTooltipShowDelay","500",3,"matTooltip","matMenuTriggerFor",4,"ngIf"],["accountMenu","matMenu"],[4,"ngFor","ngForOf"],[1,"profilsMenu"],[1,"mat-menu-item",3,"checked","click","change"],["mat-menu-item",""],["ngFor","",3,"ngForOf"],[3,"ngClass"],["matInput","","type","text",3,"placeholder","ngModel","ngModelChange"],["mat-button","","mat-icon-button","","matSuffix","","class","clear-button","aria-label","Clear","color","warn",3,"click",4,"ngIf"],["mat-button","","mat-icon-button","","matSuffix","","aria-label","Clear","color","warn",1,"clear-button",3,"click"],["svgIcon","close"],["mat-icon-button","","matTooltipShowDelay","500",1,"sort-alpha",3,"matTooltip","click"],["color","primary","svgIcon","sort-alphabetical-variant"],["color","warn","svgIcon","sort-variant-remove"],["icon","plus",1,"add-context-button",3,"iconColor","store","withIcon","withTitle","horizontal","mode"],["mat-icon-button","","matTooltipShowDelay","500",1,"users-filter",3,"matTooltip","matMenuTriggerFor"],["color","primary","svgIcon","filter-menu"],[1,"mat-menu-item",3,"checked","indeterminate","click","change"],["mat-menu-item","",3,"matMenuTriggerFor",4,"ngIf"],["mat-menu-item","",4,"ngIf"],["subAccountMenu","matMenu"],["class","mat-menu-item",3,"checked","click","change",4,"ngFor","ngForOf"],["mat-menu-item","",3,"matMenuTriggerFor"],[3,"title","collapsed","toggle",4,"ngIf"],[4,"ngIf"],[3,"title","collapsed","toggle"],["igoListItem","","color","accent",3,"selected","context","default","edit","delete","clone","save","hide","show","favorite","manageTools","managePermissions","select","unselect"],["igoListItem","","color","accent",3,"selected","context","default","select","unselect"]],template:function(e,t){1&e&&(w.TgZ(0,"igo-list",0),w.YNc(1,HS,4,6,"mat-form-field",1),w.YNc(2,WS,3,3,"button",2),w.YNc(3,XS,3,3,"button",2),w.YNc(4,KS,1,6,"igo-actionbar",3),w.YNc(5,ek,3,4,"button",4),w.TgZ(6,"mat-menu",null,5),w.YNc(8,nk,8,5,"ng-container",6),w.TgZ(9,"span",7),w.TgZ(10,"mat-checkbox",8),w.NdJ("click",function(e){return e.stopPropagation()})("change",function(){return t.showHiddenContexts.emit()}),w.qZA(),w.TgZ(11,"button",9),w._uU(12),w.ALo(13,"translate"),w.qZA(),w.qZA(),w.qZA(),w.YNc(14,ck,2,2,"ng-template",10),w.ALo(15,"keyvalue"),w.ALo(16,"async"),w.qZA()),2&e&&(w.Q6J("navigation",!0),w.xp6(1),w.Q6J("ngIf",t.showFilter()),w.xp6(1),w.Q6J("ngIf",!t.sortedAlpha),w.xp6(1),w.Q6J("ngIf",t.sortedAlpha),w.xp6(1),w.Q6J("ngIf",t.auth.authenticated&&t.configService.getConfig("context")),w.xp6(1),w.Q6J("ngIf",t.auth.authenticated&&t.configService.getConfig("context")),w.xp6(3),w.Q6J("ngForOf",t.users),w.xp6(2),w.Q6J("checked",t.showHidden),w.xp6(2),w.hij(" ",w.lcZ(13,10,"igo.context.contextManager.showHidden")," "),w.xp6(2),w.Q6J("ngForOf",w.lcZ(15,12,w.lcZ(16,14,t.contexts$))))},directives:[dn,F.O5,I.VK,F.sg,M.oG,I.OP,Ye.KE,F.mk,ot.Nt,We.Fj,We.JJ,We.On,S.lW,Ye.R9,k.Hw,L.gM,io,I.p6,po,zS,cn],pipes:[ae.X$,sn,F.Ov],styles:[".context-filter-max-width[_ngcontent-%COMP%]{width:calc(100% - 100px);margin:5px;padding-left:6px}.context-filter-min-width[_ngcontent-%COMP%]{width:calc(100% - 135px);margin:5px;padding-left:6px}.clear-button[_ngcontent-%COMP%]{padding-right:5px}mat-form-field[_ngcontent-%COMP%]{height:40px}.profilsMenu[_ngcontent-%COMP%]{display:flex}.profilsMenu[_ngcontent-%COMP%] > mat-checkbox[_ngcontent-%COMP%]{width:8px}.add-context-button[_ngcontent-%COMP%]{margin:0;width:40px;display:inline-flex;overflow:hidden}"],changeDetection:0}),e}(),pk=function(){var e=function(){function e(t,i,o,n,r,a,s,l){m(this,e),this.contextService=i,this.mapService=o,this.languageService=n,this.confirmDialogService=r,this.messageService=a,this.auth=s,this.storageService=l,this.component=t}return y(e,[{key:"onSelect",value:function(e){this.contextService.loadContext(e.uri)}},{key:"onEdit",value:function(e){this.contextService.loadEditedContext(e.uri)}},{key:"onSave",value:function(e){var t=this,i=this.mapService.getMap(),o=this.contextService.getContextFromMap(i),n=function(){var i=t.languageService.translate,o=i.instant("igo.context.contextManager.dialog.saveMsg",{value:e.title}),n=i.instant("igo.context.contextManager.dialog.saveTitle");t.messageService.success(o,n)};if(e.imported)return o.title=e.title,this.contextService.delete(e.id,!0),void this.contextService.create(o).subscribe(function(e){t.contextService.loadContext(e.uri),n()});this.contextService.update(e.id,{layers:o.layers,map:{view:o.map.view}}).subscribe(function(){n()})}},{key:"onFavorite",value:function(e){var t=this;this.contextService.setDefault(e.id).subscribe(function(){t.contextService.defaultContextId$.next(e.id);var i=t.languageService.translate,o=i.instant("igo.context.contextManager.dialog.favoriteMsg",{value:e.title}),n=i.instant("igo.context.contextManager.dialog.favoriteTitle");t.messageService.success(o,n)})}},{key:"onManageTools",value:function(e){this.contextService.loadEditedContext(e.uri)}},{key:"onManagePermissions",value:function(e){this.contextService.loadEditedContext(e.uri)}},{key:"onDelete",value:function(e){var t=this,i=this.languageService.translate;this.confirmDialogService.open(i.instant("igo.context.contextManager.dialog.confirmDelete")).subscribe(function(o){o&&t.contextService.delete(e.id,e.imported).subscribe(function(){var o=i.instant("igo.context.contextManager.dialog.deleteMsg",{value:e.title}),n=i.instant("igo.context.contextManager.dialog.deleteTitle");t.messageService.info(o,n)})})}},{key:"onClone",value:function(e){var t=this;this.contextService.clone(e.id,{title:e.title+"-copy",uri:e.uri+"-copy"}).subscribe(function(){var i=t.languageService.translate,o=i.instant("igo.context.contextManager.dialog.cloneMsg",{value:e.title}),n=i.instant("igo.context.contextManager.dialog.cloneTitle");t.messageService.success(o,n)})}},{key:"onCreate",value:function(e){var t=this,i=e.title,o=e.empty,n=this.contextService.getContextFromMap(this.component.map,o);n.title=i,this.contextService.create(n).subscribe(function(){var e=t.languageService.translate,i=e.instant("igo.context.bookmarkButton.dialog.createTitle"),o=e.instant("igo.context.bookmarkButton.dialog.createMsg",{value:n.title});t.messageService.success(o,i),t.contextService.loadContext(n.uri)})}},{key:"loadContexts",value:function(){var e,t=["none"],i=p(this.component.permissions);try{for(i.s();!(e=i.n()).done;){var o=e.value;(!0===o.checked||!0===o.indeterminate)&&t.push(o.name)}}catch(n){i.e(n)}finally{i.f()}this.contextService.loadContexts(t,!!this.component.showHidden)}},{key:"showHiddenContexts",value:function(){this.component.showHidden=!this.component.showHidden,this.storageService.set("contexts.showHidden",this.component.showHidden),this.loadContexts()}},{key:"onShowContext",value:function(e){this.contextService.showContext(e.id).subscribe()}},{key:"onHideContext",value:function(e){this.contextService.hideContext(e.id).subscribe()}},{key:"ngOnInit",value:function(){var e=this;this.component.contexts={ours:[]},this.component.showHidden=this.storageService.get("contexts.showHidden"),this.contexts$$=this.contextService.contexts$.subscribe(function(t){return e.handleContextsChange(t)}),this.defaultContextId$$=this.contextService.defaultContextId$.subscribe(function(t){e.component.defaultContextId=t}),this.selectedContext$$=this.contextService.context$.pipe((0,E.b)(100)).subscribe(function(t){return e.component.selectedContext=t}),this.auth.authenticate$.subscribe(function(t){t&&e.contextService.getProfilByUser().subscribe(function(t){e.component.users=t,e.component.permissions=[];var i,o=p(e.component.users.reduce(function(e,t){return e=e.concat(t),t.childs?e.concat(t.childs):e},[]));try{for(o.s();!(i=o.n()).done;){var n=i.value,r={name:n.name,checked:e.storageService.get("contexts.permissions."+n.name)};null===r.checked&&(r.checked=!0),e.component.permissions.push(r)}}catch(u){o.e(u)}finally{o.f()}var a,s=["none"],l=p(e.component.permissions);try{for(l.s();!(a=l.n()).done;){var c=a.value;(!0===c.checked||!0===c.indeterminate)&&s.push(c.name)}}catch(u){l.e(u)}finally{l.f()}e.contextService.loadContexts(s,!!e.component.showHidden)})})}},{key:"ngOnDestroy",value:function(){this.contexts$$.unsubscribe(),this.selectedContext$$.unsubscribe(),this.defaultContextId$$.unsubscribe()}},{key:"handleContextsChange",value:function(e){this.component.contexts=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(uk,2),w.Y36(OS),w.Y36(su),w.Y36(Ce),w.Y36(fo),w.Y36(Ae),w.Y36(fa),w.Y36(De))},e.\u0275dir=w.lG2({type:e,selectors:[["","igoContextListBinding",""]],hostBindings:function(e,t){1&e&&w.NdJ("select",function(e){return t.onSelect(e)})("edit",function(e){return t.onEdit(e)})("save",function(e){return t.onSave(e)})("favorite",function(e){return t.onFavorite(e)})("manageTools",function(e){return t.onManageTools(e)})("managePermissions",function(e){return t.onManagePermissions(e)})("delete",function(e){return t.onDelete(e)})("clone",function(e){return t.onClone(e)})("create",function(e){return t.onCreate(e)})("filterPermissionsChanged",function(){return t.loadContexts()})("showHiddenContexts",function(){return t.showHiddenContexts()})("show",function(e){return t.onShowContext(e)})("hide",function(e){return t.onHideContext(e)})}}),e}(),dk=function(){var e=function(){function e(t,i){m(this,e),this.http=t,this.config=i,this.baseUrl=this.config.getConfig("context.url")}return y(e,[{key:"get",value:function(){return this.baseUrl?this.http.get(this.baseUrl+"/pois"):Va.E}},{key:"delete",value:function(e){return this.http.delete(this.baseUrl+"/pois/"+e)}},{key:"create",value:function(e){return this.http.post(this.baseUrl+"/pois",e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(P.eN),w.LFG(he))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac}),e}(),hk=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({providers:[dk],imports:[[F.ez,Se,mo,zo,ja,We.u5,k.Ps,S.ot,ze.LD,Ve.Ng,L.AV,Ye.lN,ut.Is,ot.c]]}),e}(),gk=function(){var e=function(){function e(){m(this,e)}return y(e,null,[{key:"forRoot",value:function(){return{ngModule:e}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,We.u5,We.UX,Ye.lN,ot.c,k.Ps,S.ot,L.AV,C.ie,M.p9,_l.Fk,ut.Is,I.Tx,Ve.Ng,tt.Bb,ja,hn,ln,ho,zo,Se,MS,hk,oo]]}),e}(),fk=function(){return(e=fk||(fk={})).layer="layer",e.context="context",fk;var e}(),mk=function(){return(e=mk||(mk={})).import="import",e.export="export",mk;var e}(),vk=function(){var e=function(){function e(){m(this,e),this.importExportType$=new R.X(fk.layer),this.selectedMode$=new R.X(mk.import),this.exportOptions$=new R.X(void 0)}return y(e,[{key:"setImportExportType",value:function(e){this.importExportType$.next(e)}},{key:"setMode",value:function(e){this.selectedMode$.next(e)}},{key:"setsExportOptions",value:function(e){this.exportOptions$.next(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),yk=function(){var e=function(){function e(t,i){m(this,e),this.toolService=t,this.importExportState=i,this.openSidenav$=new R.X(void 0)}return y(e,[{key:"toolbox",get:function(){return this.toolService.toolbox}},{key:"toolToActivateFromOptions",value:function(e){if(e){if("importExport"===e.tool){var t=this.importExportState.exportOptions$.value;t?(t.layers=e.options.layers,t.featureInMapExtent=e.options.featureInMapExtent):t={layers:e.options.layers,featureInMapExtent:e.options.featureInMapExtent},this.importExportState.setsExportOptions(t),this.importExportState.setMode(mk.export)}this.toolbox.getTool(e.tool)&&(this.toolbox.activateTool(e.tool),this.openSidenav$.next(!0))}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(on),w.LFG(vk))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function bk(e,t){e.entityStore.getStrategyOfType(Cu).setMotion(t.get("zoomAuto")?tc.Default:tc.None)}var wk=function(){var e=function(){function e(t){m(this,e),this.igoStorageService=t}return y(e,[{key:"storageService",get:function(){return this.igoStorageService}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(De))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),xk=function(){var e=function(){function e(t,i,o,n){m(this,e),this.storageState=t,this.languageService=i,this.toolState=o,this.mediaService=n,this.maximize$=new R.X(this.storageService.get("workspaceMaximize")),this.zoomAuto$=new R.X(!1)}return y(e,[{key:"storageService",get:function(){return this.storageState.storageService}},{key:"zoomAuto",get:function(){return this.storageService.get("zoomAuto")}},{key:"ngOnDestroy",value:function(){this.storageChange$$&&this.storageChange$$.unsubscribe()}},{key:"loadActions",value:function(e,t,i){var o=this.buildActions(e,t,i);e.actionStore.load(o)}},{key:"buildActions",value:function(e,t,i){var o=this;return this.zoomAuto$.next(this.zoomAuto),this.storageChange$$=this.storageService.storageChange$.pipe((0,Ka.n)(function(e){return"zoomAuto"!==e.key||e.event===qe.CLEARED})).subscribe(function(){o.zoomAuto$.next(o.zoomAuto),bk(e,o.storageService)}),[{id:"zoomAuto",checkbox:!0,title:"igo.integration.workspace.zoomAuto.title",tooltip:"igo.integration.workspace.zoomAuto.tooltip",checkCondition:this.zoomAuto$,handler:function(){bk(e,o.storageService),o.storageService.set("zoomAuto",!o.storageService.get("zoomAuto"))}},{id:"filterInMapExtent",checkbox:!0,title:"igo.integration.workspace.inMapExtent.title",tooltip:eS(e),checkCondition:t,handler:function(){return t.next(!t.value)}},{id:"selectedOnly",checkbox:!0,title:"igo.integration.workspace.selected.title",tooltip:"igo.integration.workspace.selected.tooltip",checkCondition:i,handler:function(){return i.next(!i.value)}},{id:"clearselection",icon:"select-off",title:"igo.integration.workspace.clearSelection.title",tooltip:"igo.integration.workspace.clearSelection.tooltip",handler:function(e){e.entityStore.state.updateMany(e.entityStore.view.all(),{selected:!1})},args:[e],availability:function(e){return tS(e)}},{id:"featureDownload",icon:"file-export",title:"igo.integration.workspace.download.title",tooltip:"igo.integration.workspace.download.tooltip",handler:function(e){var t=e.entityStore.getStrategyOfType(Ft),i=e.entityStore.getStrategyOfType(Ot).active?[e.layer.id]:[];o.toolState.toolToActivateFromOptions({tool:"importExport",options:{layers:[e.layer.id],featureInMapExtent:t.active,layersWithSelection:i}})},args:[e]},{id:"maximize",title:this.languageService.translate.instant("igo.integration.workspace.maximize"),tooltip:this.languageService.translate.instant("igo.integration.workspace.maximizeTooltip"),icon:"resize",display:function(){return o.maximize$.pipe((0,D.U)(function(e){return!e&&!o.mediaService.isMobile()}))},handler:function(){o.mediaService.isMobile()||o.maximize$.next(!0)}},{id:"standardExtent",title:this.languageService.translate.instant("igo.integration.workspace.standardExtent"),tooltip:this.languageService.translate.instant("igo.integration.workspace.standardExtentTooltip"),icon:"resize",display:function(){return o.maximize$.pipe((0,D.U)(function(e){return e&&!o.mediaService.isMobile()}))},handler:function(){o.maximize$.next(!1)}}]}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(wk),w.LFG(Ce),w.LFG(yk),w.LFG(Pe))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Sk=function(){var e=function(){function e(t,i,o,n,r){m(this,e),this.ogcFilterWidget=t,this.storageState=i,this.languageService=o,this.mediaService=n,this.toolState=r,this.maximize$=new R.X(this.storageService.get("workspaceMaximize")),this.selectOnlyCheckCondition$=new R.X(!1),this.zoomAuto$=new R.X(!1)}return y(e,[{key:"storageService",get:function(){return this.storageState.storageService}},{key:"zoomAuto",get:function(){return this.storageService.get("zoomAuto")}},{key:"ngOnDestroy",value:function(){this.storageChange$$&&this.storageChange$$.unsubscribe()}},{key:"loadActions",value:function(e,t,i){var o=this.buildActions(e,t,i);e.actionStore.load(o)}},{key:"buildActions",value:function(e,t,i){var o,n,r=this;this.zoomAuto$.next(this.zoomAuto),this.storageChange$$=this.storageService.storageChange$.pipe((0,Ka.n)(function(e){return"zoomAuto"!==(null==e?void 0:e.key)||(null==e?void 0:e.event)===qe.CLEARED})).subscribe(function(){r.zoomAuto$.next(r.zoomAuto),bk(e,r.storageService)});var a=[{id:"zoomAuto",checkbox:!0,title:"igo.integration.workspace.zoomAuto.title",tooltip:"igo.integration.workspace.zoomAuto.tooltip",checkCondition:this.zoomAuto$,handler:function(){bk(e,r.storageService),r.storageService.set("zoomAuto",!r.storageService.get("zoomAuto"))}},{id:"filterInMapExtent",checkbox:!0,title:"igo.integration.workspace.inMapExtent.title",tooltip:eS(e),checkCondition:t,handler:function(){return t.next(!t.value)}},{id:"selectedOnly",checkbox:!0,title:"igo.integration.workspace.selected.title",tooltip:"igo.integration.workspace.selected.title",checkCondition:i,handler:function(){return i.next(!i.value)}},{id:"clearselection",icon:"select-off",title:"igo.integration.workspace.clearSelection.title",tooltip:"igo.integration.workspace.clearSelection.tooltip",handler:function(e){e.entityStore.state.updateMany(e.entityStore.view.all(),{selected:!1})},args:[e],availability:function(e){return tS(e)}},{id:"wfsDownload",icon:"file-export",title:"igo.integration.workspace.download.title",tooltip:"igo.integration.workspace.download.tooltip",handler:function(e){var t=e.entityStore.getStrategyOfType(Ft),i=e.entityStore.getStrategyOfType(Ot).active?[e.layer.id]:[];r.toolState.toolToActivateFromOptions({tool:"importExport",options:{layers:[e.layer.id],featureInMapExtent:t.active,layersWithSelection:i}})},args:[e]},{id:"ogcFilter",icon:"filter",title:"igo.integration.workspace.ogcFilter.title",tooltip:"igo.integration.workspace.ogcFilter.tooltip",handler:function(e,t){t.activateWidget(e,{map:t.map,layer:t.layer})},args:[this.ogcFilterWidget,e]},{id:"maximize",title:this.languageService.translate.instant("igo.integration.workspace.maximize"),tooltip:this.languageService.translate.instant("igo.integration.workspace.maximizeTooltip"),icon:"resize",display:function(){return r.maximize$.pipe((0,D.U)(function(e){return!e&&!r.mediaService.isMobile()}))},handler:function(){r.mediaService.isMobile()||r.maximize$.next(!0)}},{id:"standardExtent",title:this.languageService.translate.instant("igo.integration.workspace.standardExtent"),tooltip:this.languageService.translate.instant("igo.integration.workspace.standardExtentTooltip"),icon:"resize",display:function(){return r.maximize$.pipe((0,D.U)(function(e){return e&&!r.mediaService.isMobile()}))},handler:function(){r.maximize$.next(!1)}}];return(null===(n=null===(o=e.layer.dataSource.ogcFilters$)||void 0===o?void 0:o.value)||void 0===n?void 0:n.enabled)?a:a.filter(function(e){return"ogcFilter"!==e.id})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(kx),w.LFG(wk),w.LFG(Ce),w.LFG(Pe),w.LFG(yk))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),kk=function(){var e=function(){function e(t,i,o,n,r){m(this,e),this.ogcFilterWidget=t,this.storageState=i,this.languageService=o,this.mediaService=n,this.toolState=r,this.maximize$=new R.X(this.storageService.get("workspaceMaximize")),this.zoomAuto$=new R.X(!1)}return y(e,[{key:"storageService",get:function(){return this.storageState.storageService}},{key:"zoomAuto",get:function(){return this.storageService.get("zoomAuto")}},{key:"ngOnDestroy",value:function(){this.storageChange$$&&this.storageChange$$.unsubscribe()}},{key:"loadActions",value:function(e,t,i){var o=this.buildActions(e,t,i);e.actionStore.load(o)}},{key:"buildActions",value:function(e,t,i){var o,n,r=this;this.zoomAuto$.next(this.zoomAuto),this.storageChange$$=this.storageService.storageChange$.pipe((0,Ka.n)(function(e){return"zoomAuto"!==(null==e?void 0:e.key)||(null==e?void 0:e.event)===qe.CLEARED})).subscribe(function(){r.zoomAuto$.next(r.zoomAuto),bk(e,r.storageService)});var a=[{id:"zoomAuto",checkbox:!0,title:"igo.integration.workspace.zoomAuto.title",tooltip:"igo.integration.workspace.zoomAuto.tooltip",checkCondition:this.zoomAuto$,handler:function(){bk(e,r.storageService),r.storageService.set("zoomAuto",!r.storageService.get("zoomAuto"))}},{id:"filterInMapExtent",checkbox:!0,title:"igo.integration.workspace.inMapExtent.title",tooltip:eS(e),checkCondition:t,handler:function(){return t.next(!t.value)}},{id:"selectedOnly",checkbox:!0,title:"igo.integration.workspace.selected.title",tooltip:"igo.integration.workspace.selected.title",checkCondition:i,handler:function(){return i.next(!i.value)}},{id:"clearselection",icon:"select-off",title:"igo.integration.workspace.clearSelection.title",tooltip:"igo.integration.workspace.clearSelection.tooltip",handler:function(e){e.entityStore.state.updateMany(e.entityStore.view.all(),{selected:!1})},args:[e],availability:function(e){return tS(e)}},{id:"wfsDownload",icon:"file-export",title:"igo.integration.workspace.download.title",tooltip:"igo.integration.workspace.download.tooltip",handler:function(e){var t=e.entityStore.getStrategyOfType(Ft),i=e.entityStore.getStrategyOfType(Ot).active?[e.layer.id]:[];r.toolState.toolToActivateFromOptions({tool:"importExport",options:{layers:[e.layer.id],featureInMapExtent:t.active,layersWithSelection:i}})},args:[e]},{id:"ogcFilter",icon:"filter",title:"igo.integration.workspace.ogcFilter.title",tooltip:"igo.integration.workspace.ogcFilter.tooltip",handler:function(e,t){t.activateWidget(e,{map:t.map,layer:t.layer})},args:[this.ogcFilterWidget,e]},{id:"maximize",title:this.languageService.translate.instant("igo.integration.workspace.maximize"),tooltip:this.languageService.translate.instant("igo.integration.workspace.maximizeTooltip"),icon:"resize",display:function(){return r.maximize$.pipe((0,D.U)(function(e){return!e&&!r.mediaService.isMobile()}))},handler:function(){r.mediaService.isMobile()||r.maximize$.next(!0)}},{id:"standardExtent",title:this.languageService.translate.instant("igo.integration.workspace.standardExtent"),tooltip:this.languageService.translate.instant("igo.integration.workspace.standardExtentTooltip"),icon:"resize",display:function(){return r.maximize$.pipe((0,D.U)(function(e){return e&&!r.mediaService.isMobile()}))},handler:function(){r.maximize$.next(!1)}}];return(null===(n=null===(o=e.layer.dataSource.ogcFilters$)||void 0===o?void 0:o.value)||void 0===n?void 0:n.enabled)?a:a.filter(function(e){return"ogcFilter"!==e.id})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(kx),w.LFG(wk),w.LFG(Ce),w.LFG(Pe),w.LFG(yk))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Ck=function(){var e=function(){function e(t,i,o,n){m(this,e),this.featureActionsService=t,this.wfsActionsService=i,this.editionActionsService=o,this.storageService=n,this.workspacePanelExpanded=!1,this.workspaceEnabled$=new R.X(!1),this.rowsInMapExtentCheckCondition$=new R.X(!0),this.selectOnlyCheckCondition$=new R.X(!1),this.workspaceMaximize$=new R.X(this.storageService.get("workspaceMaximize")),this.actionMaximize$$=[],this.activeWorkspaceWidget$=new R.X(void 0),this.workspace$=new R.X(void 0),this.initWorkspaces()}return y(e,[{key:"store",get:function(){return this._store}},{key:"initWorkspaces",value:function(){var e=this;this._store=new gr([]),this._store.stateView.firstBy$(function(e){return!0===e.state.active}).subscribe(function(t){e.workspace$.next(t?t.entity:void 0)}),this._store.stateView.all$().subscribe(function(t){t.map(function(t){t.entity.actionStore.empty&&(t.entity instanceof Ax?e.wfsActionsService.loadActions(t.entity,e.rowsInMapExtentCheckCondition$,e.selectOnlyCheckCondition$):t.entity instanceof Px?e.featureActionsService.loadActions(t.entity,e.rowsInMapExtentCheckCondition$,e.selectOnlyCheckCondition$):t.entity instanceof Ox&&e.editionActionsService.loadActions(t.entity,e.rowsInMapExtentCheckCondition$,e.selectOnlyCheckCondition$))})}),this.actionMaximize$$.push(this.featureActionsService.maximize$.subscribe(function(t){e.setWorkspaceIsMaximized(t)})),this.actionMaximize$$.push(this.wfsActionsService.maximize$.subscribe(function(t){e.setWorkspaceIsMaximized(t)})),this.actionMaximize$$.push(this.editionActionsService.maximize$.subscribe(function(t){e.setWorkspaceIsMaximized(t)})),this.activeWorkspace$$=this.workspace$.subscribe(function(t){void 0!==e.activeWorkspaceWidget$$&&(e.activeWorkspaceWidget$$.unsubscribe(),e.activeWorkspaceWidget$$=void 0),void 0!==t&&(e.activeWorkspaceWidget$$=t.widget$.subscribe(function(t){return e.activeWorkspaceWidget$.next(t)}))}),this.rowsInMapExtentCheckCondition$$=this.rowsInMapExtentCheckCondition$.subscribe(function(t){e._store.stateView.all().map(function(e){if(!e.entity.actionStore.empty){var i=e.entity.entityStore.getStrategyOfType(Ft);i&&(t?i.activate():i.deactivate())}})}),this.selectOnlyCheckCondition$$=this.selectOnlyCheckCondition$.subscribe(function(t){e._store.stateView.all().map(function(e){if(!e.entity.actionStore.empty){var i=e.entity.entityStore.getStrategyOfType(Ot);i&&(t?i.activate():i.deactivate())}})})}},{key:"setWorkspaceIsMaximized",value:function(e){this.storageService.set("workspaceMaximize",e),this.workspaceMaximize$.next(e)}},{key:"setActiveWorkspaceById",value:function(e){var t=this.store.all().find(function(t){return t.id===e});t&&this.store.activateWorkspace(t)}},{key:"setActiveWorkspaceByTitle",value:function(e){var t=this.store.all().find(function(t){return t.title===e});t&&this.store.activateWorkspace(t)}},{key:"ngOnDestroy",value:function(){this.teardownWorkspaces(),this.actionMaximize$$.map(function(e){return e.unsubscribe()}),this.rowsInMapExtentCheckCondition$$&&this.selectOnlyCheckCondition$$.unsubscribe(),this.selectOnlyCheckCondition$$&&this.selectOnlyCheckCondition$$.unsubscribe()}},{key:"teardownWorkspaces",value:function(){this.store.clear(),void 0!==this.activeWorkspaceWidget$$&&this.activeWorkspaceWidget$$.unsubscribe(),void 0!==this.activeWorkspace$$&&this.activeWorkspace$$.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(xk),w.LFG(Sk),w.LFG(kk),w.LFG(De))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Tk=function(){var e=function(){function e(t,i,o){m(this,e),this.searchSourceService=t,this.storageService=i,this.configService=o,this.searchOverlayStyle={},this.searchOverlayStyleSelection={},this.searchOverlayStyleFocus={},this.searchTermSplitter$=new R.X("|"),this.searchTerm$=new R.X(void 0),this.searchType$=new R.X(void 0),this.searchDisabled$=new R.X(!1),this.searchResultsGeometryEnabled$=new R.X(!1),this.searchSettingsChange$=new R.X(void 0),this.selectedResult$=new R.X(void 0),this.store=new At([]);var n=this.configService.getConfig("searchOverlayStyle");n&&(this.searchOverlayStyle=n.base,this.searchOverlayStyleSelection=n.selection,this.searchOverlayStyleFocus=n.focus);var r=this.storageService.get("searchResultsGeometryEnabled");r&&this.searchResultsGeometryEnabled$.next(r),this.store.addStrategy(this.createCustomFilterTermStrategy(),!1)}return y(e,[{key:"searchTypes",get:function(){return this.searchSourceService.getEnabledSources().map(function(e){return e.constructor.type})}},{key:"createCustomFilterTermStrategy",value:function(){return new Ft({filterClauseFunc:function(e){return 100===e.entity.meta.score}})}},{key:"activateCustomFilterTermStrategy",value:function(){var e=this.store.getStrategyOfType(Ft);void 0!==e&&e.activate()}},{key:"deactivateCustomFilterTermStrategy",value:function(){var e=this.store.getStrategyOfType(Ft);void 0!==e&&e.deactivate()}},{key:"enableSearch",value:function(){this.searchDisabled$.next(!1)}},{key:"disableSearch",value:function(){this.searchDisabled$.next(!0)}},{key:"setSearchTerm",value:function(e){this.searchTerm$.next(e)}},{key:"setSearchType",value:function(e){this.searchSourceService.enableSourcesByType(e),this.searchType$.next(e)}},{key:"setSearchSettingsChange",value:function(){this.searchSettingsChange$.next(!0)}},{key:"setSelectedResult",value:function(e){this.selectedResult$.next(e)}},{key:"setSearchResultsGeometryStatus",value:function(e){this.storageService.set("searchResultsGeometryEnabled",e),this.searchResultsGeometryEnabled$.next(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.LFG(Gb),w.LFG(De),w.LFG(he))},e.\u0275prov=w.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Ak=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[xx]]}),e}(),Lk=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,k.Ps,ct.g,L.AV,S.ot,Se,Sg,xx,Zo,yn,wg,bo]]}),e}(),Zk=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[],Ak,Lk]}),e}(),Fk=["mapBrowser"];function Ok(e,t){1&e&&(w.TgZ(0,"span",11),w._uU(1," F2 activate/deactivate the pointer location. "),w.qZA())}function Mk(e,t){if(1&e&&w._UZ(0,"igo-search-add-button",12),2&e){var i=t.result,o=w.oxw();w.Q6J("map",o.map)("layer",i)}}function Ik(e,t){if(1&e&&(w.TgZ(0,"igo-panel",11),w._UZ(1,"igo-feature-details",13),w.qZA()),2&e){var i=w.oxw();w.xp6(1),w.Q6J("feature",i.selectedFeature)}}function Pk(e,t){if(1&e&&w._UZ(0,"igo-actionbar",14),2&e){var i=w.oxw();w.Q6J("store",i.store)("withIcon",!1)("horizontal",!0)("mode","context")}}var _k=Z.Bz.forChild([{path:"search",component:function(){var e=function(){function e(t,i,o,n,r,a,s){var l=this;m(this,e),this.languageService=t,this.projectionService=i,this.mapService=o,this.layerService=n,this.searchState=r,this.searchService=a,this.mediaService=s,this.store=new Gn([]),this.igoSearchPointerSummaryEnabled=!1,this.termSplitter="|",this.map=new _u({overlay:!0,controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:7},this.settingsChange$=new R.X(void 0),this.mapService.setMap(this.map),this.layerService.createAsyncLayer({title:"OSM",sourceOptions:{type:"osm"}}).subscribe(function(e){l.osmLayer=e,l.map.addLayer(e)})}return y(e,[{key:"searchStore",get:function(){return this.searchState.store}},{key:"isTouchScreen",get:function(){return this.mediaService.isTouchScreen()}},{key:"onPointerSummaryStatusChange",value:function(e){this.igoSearchPointerSummaryEnabled=e}},{key:"onSearchTermChange",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.term=e,e.replace(/(#[^\s]*)/g,"").trim().length<2&&(this.searchStore.clear(),this.selectedFeature=void 0)}},{key:"onSearch",value:function(e){var t=e.results;this.searchStore.state.updateAll({focused:!1,selected:!1});var i=this.searchStore.entities$.value.filter(function(t){return t.source!==e.research.source}).concat(t);this.searchStore.updateMany(i)}},{key:"onSearchSettingsChange",value:function(){this.settingsChange$.next(!0)}},{key:"onResultFocus",value:function(e){this.tryAddFeatureToMap(e),this.selectedFeature=e.data}},{key:"tryAddFeatureToMap",value:function(e){e.meta.dataType===ec&&void 0!==e.data.geometry&&this.map.searchResultsOverlay.setFeatures([e.data],tc.Default)}},{key:"ngOnInit",value:function(){this.store.load([{id:"coordinates",title:"coordinates",handler:this.onSearchCoordinate.bind(this)},{id:"googleMaps",title:"googleMap",handler:this.onOpenGoogleMaps.bind(this),args:["1"]},{id:"googleStreetView",title:"googleStreetView",handler:this.onOpenGoogleStreetView.bind(this)}])}},{key:"ngOnDestroy",value:function(){this.store.destroy()}},{key:"removeFeatureFromMap",value:function(){this.map.searchResultsOverlay.clear()}},{key:"onContextMenuOpen",value:function(e){var t=this.mapPosition(e),i=this.mapService.getMap().ol.getCoordinateFromPixel(t);this.mapProjection=this.mapService.getMap().projection,this.lonlat=ls.vs(i,this.mapProjection,"EPSG:4326")}},{key:"mapPosition",value:function(e){var t=e;return t.y=t.y-this.mapBrowser.nativeElement.getBoundingClientRect().top+window.scrollY,t.x=t.x-this.mapBrowser.nativeElement.getBoundingClientRect().left+window.scrollX,[t.x,t.y]}},{key:"onPointerSearch",value:function(e){this.lonlat=e,this.onSearchCoordinate()}},{key:"onSearchCoordinate",value:function(){var e=this;this.searchStore.clear();var t=this.searchService.reverseSearch(this.lonlat),i=function(i){t.length>0&&t[i].request.subscribe(function(o){e.onSearch({research:t[i],results:o})})};for(var o in t)i(o)}},{key:"onOpenGoogleMaps",value:function(){window.open(kp.getGoogleMapsCoordLink(this.lonlat[0],this.lonlat[1]))}},{key:"onOpenGoogleStreetView",value:function(){window.open(kp.getGoogleStreetViewLink(this.lonlat[0],this.lonlat[1]))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ce),w.Y36(pu),w.Y36(su),w.Y36(Xu),w.Y36(Tk),w.Y36(Yb),w.Y36(Pe))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-search"]],viewQuery:function(e,t){var i;(1&e&&w.Gf(Fk,7,w.SBq),2&e)&&(w.iGM(i=w.CRH())&&(t.mapBrowser=i.first))},decls:30,vars:15,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/search"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/environments"],["title","Details",4,"ngIf"],["igoOverlay","","igoSearchPointerSummary","",3,"map","view","igoContextMenu","igoSearchPointerSummaryDelay","igoSearchPointerSummaryEnabled","menuPosition"],["mapBrowser",""],["color","primary",3,"map"],["title","Search"],[3,"searchSettings","store","termSplitter","pointerSummaryStatus","searchTermChange","search","clearFeature","searchSettingsChange"],["placeholder","false",3,"store","term","termSplitter","settingsChange$","resultFocus","resultSelect","moreResults"],["igoSearchItemToolbar",""],["actionbarMenu",""],["title","Details"],[3,"map","layer"],[3,"feature"],[3,"store","withIcon","horizontal","mode"]],template:function(e,t){if(1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Geo"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Search"),w.qZA(),w.TgZ(5,"mat-card-content"),w.TgZ(6,"li"),w._uU(7,"Dependencies: ConfigService, LanguageService"),w.qZA(),w._UZ(8,"br"),w._uU(9," See the "),w.TgZ(10,"a",0),w._uU(11,"code of this example"),w.qZA(),w._UZ(12,"br"),w._uU(13," See search section of the "),w.TgZ(14,"a",1),w._uU(15," environment config"),w.qZA(),w._UZ(16,"hr"),w._UZ(17,"br"),w.YNc(18,Ok,2,0,"span",2),w.qZA(),w.TgZ(19,"igo-map-browser",3,4),w.NdJ("menuPosition",function(e){return t.onContextMenuOpen(e)}),w._UZ(21,"igo-zoom-button",5),w.qZA(),w.TgZ(22,"igo-panel",6),w.TgZ(23,"igo-search-bar",7),w.NdJ("pointerSummaryStatus",function(e){return t.onPointerSummaryStatusChange(e)})("searchTermChange",function(e){return t.onSearchTermChange(e)})("search",function(e){return t.onSearch(e)})("clearFeature",function(){return t.removeFeatureFromMap()})("searchSettingsChange",function(){return t.onSearchSettingsChange()}),w.qZA(),w.TgZ(24,"igo-search-results",8),w.NdJ("resultFocus",function(e){return t.onResultFocus(e)})("resultSelect",function(e){return t.onResultFocus(e)})("moreResults",function(e){return t.onSearch(e)}),w.YNc(25,Mk,1,2,"ng-template",null,9,w.W1O),w.qZA(),w.qZA(),w.YNc(27,Ik,2,1,"igo-panel",2),w.qZA(),w.YNc(28,Pk,1,4,"ng-template",null,10,w.W1O)),2&e){var i=w.MAs(29);w.xp6(18),w.Q6J("ngIf",!t.isTouchScreen),w.xp6(1),w.Q6J("map",t.map)("view",t.view)("igoContextMenu",i)("igoSearchPointerSummaryDelay",500)("igoSearchPointerSummaryEnabled",t.igoSearchPointerSummaryEnabled),w.xp6(2),w.Q6J("map",t.map),w.xp6(2),w.Q6J("searchSettings",!0)("store",t.searchStore)("termSplitter",t.termSplitter),w.xp6(1),w.Q6J("store",t.searchStore)("term",t.term)("termSplitter",t.termSplitter)("settingsChange$",t.settingsChange$),w.xp6(3),w.Q6J("ngIf",t.selectedFeature)}},directives:[O.a8,O.$j,O.n5,O.dn,F.O5,Du,bx,vo,ju,vn,zw,fx,vx,Ph,io],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{height:100%;width:100%;padding-top:10px}"]}),e}()}]),qk=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({providers:[{provide:xp,useFactory:yw,multi:!0,deps:[he,Ce,De,pu]},{provide:xp,useFactory:Yx,multi:!0,deps:[P.eN,Ce,De,he]},{provide:xp,useFactory:hw,multi:!0,deps:[P.eN,Ce,De,he,lw,w.zs3]},{provide:xp,useFactory:Sw,multi:!0,deps:[P.eN,Ce,De,he,bw]},{provide:xp,useFactory:Vx,multi:!0,deps:[P.eN,he,De]},{provide:xp,useFactory:gw,multi:!0,deps:[P.eN,Ce,De,he,w.zs3]},{provide:xp,useFactory:Xx,multi:!0,deps:[P.eN,Ce,De,he]},{provide:xp,useFactory:Kx,multi:!0,deps:[P.eN,Ce,De,he]}],imports:[[F.ez,_k,O.QW,S.ot,k.Ps,L.AV,ke.forRoot(),yn,jy,xx.forRoot(),Zk,oo,yo,Sg]]}),e}(),Dk=Z.Bz.forChild([{path:"print",component:function(){var e=function e(t,i){var o=this;m(this,e),this.languageService=t,this.layerService=i,this.map=new _u({controls:{attribution:{collapsed:!1}}}),this.view={center:[-73,47.2],zoom:9},this.layerService.createAsyncLayer({title:"Quebec Base Map",sourceOptions:{type:"wmts",url:"https://geoegl.msp.gouv.qc.ca/apis/carto/wmts/1.0.0/wmts",layer:"carte_gouv_qc_ro",matrixSet:"EPSG_3857",version:"1.3.0",crossOrigin:"anonymous",attributions:"\xa9 <a href='http://www.droitauteur.gouv.qc.ca/copyright.php' target='_blank'><img src='https://geoegl.msp.gouv.qc.ca/gouvouvert/public/images/quebec/gouv_qc_logo.png' width='64' height='14'>Gouvernement du Qu\xe9bec</a> / <a href='https://www.igouverte.org/' target='_blank'>IGO2</a>"}}).subscribe(function(e){return o.map.addLayer(e)}),this.layerService.createAsyncLayer({title:"School board",sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{LAYERS:"MELS_CS_ANGLO_S",VERSION:"1.3.0"},crossOrigin:"anonymous"}}).subscribe(function(e){return o.map.addLayer(e)}),this.layerService.createAsyncLayer({title:"Embacle",sourceOptions:{type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{LAYERS:"vg_observation_v_inondation_embacle_wmst",VERSION:"1.3.0"},crossOrigin:"anonymous"}}).subscribe(function(e){return o.map.addLayer(e)})};return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ce),w.Y36(Xu))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-print"]],decls:19,vars:8,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/print"],[3,"map","view"],["color","primary",3,"map"],["color","primary",3,"map","showIfNoRotation"],[3,"map"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Geo"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Print"),w.qZA(),w.TgZ(5,"mat-card-content"),w.TgZ(6,"li"),w._uU(7,"Dependencies: LanguageService"),w.qZA(),w._UZ(8,"br"),w._uU(9," See the "),w.TgZ(10,"a",0),w._uU(11,"code of this example"),w.qZA(),w._UZ(12,"hr"),w.qZA(),w.TgZ(13,"igo-map-browser",1),w._UZ(14,"igo-zoom-button",2),w._UZ(15,"igo-geolocate-button",2),w._UZ(16,"igo-home-extent-button",2),w._UZ(17,"igo-rotation-button",3),w.qZA(),w._UZ(18,"igo-print",4),w.qZA()),2&e&&(w.xp6(13),w.Q6J("map",t.map)("view",t.view),w.xp6(1),w.Q6J("map",t.map),w.xp6(1),w.Q6J("map",t.map),w.xp6(1),w.Q6J("map",t.map),w.xp6(1),w.Q6J("map",t.map)("showIfNoRotation",!1),w.xp6(1),w.Q6J("map",t.map))},directives:[O.a8,O.$j,O.n5,O.dn,Du,ju,Qu,Gu,np,hb],styles:["igo-map-browser[_ngcontent-%COMP%]{width:900px;height:1000px}"]}),e}()}]),Ek=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[Dk,O.QW,S.ot,ke,jy,gb]]}),e}(),$k=Z.Bz.forChild([{path:"import-export",component:function(){var e=function e(t,i){var o=this;m(this,e),this.languageService=t,this.layerService=i,this.map=new _u({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:9},this.store=new gr([]),this.layerService.createAsyncLayer({title:"OSM",sourceOptions:{type:"osm"}}).subscribe(function(e){return o.map.addLayer(e)})};return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ce),w.Y36(Xu))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-import-export"]],decls:16,vars:5,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/import-export"],[3,"map","view"],["color","primary",3,"map"],[3,"store","map"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Geo"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Import / Export"),w.qZA(),w.TgZ(5,"mat-card-content"),w.TgZ(6,"li"),w._uU(7,"Dependencies: LanguageService"),w.qZA(),w._UZ(8,"br"),w._uU(9," See the "),w.TgZ(10,"a",0),w._uU(11,"code of this example"),w.qZA(),w._UZ(12,"hr"),w.qZA(),w.TgZ(13,"igo-map-browser",1),w._UZ(14,"igo-zoom-button",2),w.qZA(),w._UZ(15,"igo-import-export",3),w.qZA()),2&e&&(w.xp6(13),w.Q6J("map",t.map)("view",t.view),w.xp6(1),w.Q6J("map",t.map),w.xp6(1),w.Q6J("store",t.store)("map",t.map))},directives:[O.a8,O.$j,O.n5,O.dn,Du,ju,$y],styles:["igo-map-browser[_ngcontent-%COMP%]{width:900px;height:1000px}"]}),e}()}]),Rk=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({providers:[Ny({path:"./assets/import-style.json"})],imports:[[$k,O.QW,S.ot,ke,jy,By]]}),e}(),Nk=Z.Bz.forChild([{path:"directions",component:function(){var e=function e(t,i,o,n){var r=this;m(this,e),this.projectionService=t,this.languageService=i,this.layerService=o,this.mapService=n,this.map=new _u({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:9,geolocate:!1},this.stopsStore=new Nx([]),this.stopsFeatureStore=new Ux([],{map:this.map}),this.stepFeatureStore=new Bx([],{map:this.map}),this.routesFeatureStore=new Jx([],{map:this.map}),this.zoomToActiveRoute$=new Q.xQ,this.mapService.setMap(this.map),this.layerService.createAsyncLayer({title:"OSM",sourceOptions:{type:"osm"}}).subscribe(function(e){return r.map.addLayer(e)})};return e.\u0275fac=function(t){return new(t||e)(w.Y36(pu),w.Y36(Ce),w.Y36(Xu),w.Y36(su))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-directions"]],decls:19,vars:12,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/directions"],[3,"map","view"],["color","primary",3,"map"],["color","primary",3,"map","showIfNoRotation"],[3,"stopsStore","stopsFeatureStore","stepFeatureStore","routesFeatureStore","zoomToActiveRoute$"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Geo"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Directions"),w.qZA(),w.TgZ(5,"mat-card-content"),w.TgZ(6,"li"),w._uU(7,"Dependencies: LanguageService"),w.qZA(),w._UZ(8,"br"),w._uU(9," See the "),w.TgZ(10,"a",0),w._uU(11,"code of this example"),w.qZA(),w._UZ(12,"hr"),w.qZA(),w.TgZ(13,"igo-map-browser",1),w._UZ(14,"igo-zoom-button",2),w._UZ(15,"igo-geolocate-button",2),w._UZ(16,"igo-home-extent-button",2),w._UZ(17,"igo-rotation-button",3),w.qZA(),w._UZ(18,"igo-directions",4),w.qZA()),2&e&&(w.xp6(13),w.Q6J("map",t.map)("view",t.view),w.xp6(1),w.Q6J("map",t.map),w.xp6(1),w.Q6J("map",t.map),w.xp6(1),w.Q6J("map",t.map),w.xp6(1),w.Q6J("map",t.map)("showIfNoRotation",!1),w.xp6(1),w.Q6J("stopsStore",t.stopsStore)("stopsFeatureStore",t.stopsFeatureStore)("stepFeatureStore",t.stepFeatureStore)("routesFeatureStore",t.routesFeatureStore)("zoomToActiveRoute$",t.zoomToActiveRoute$))},directives:[O.a8,O.$j,O.n5,O.dn,Du,ju,Qu,Gu,np,rw],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}"]}),e}()}]),Uk=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({providers:[{provide:vb,useFactory:Qx,multi:!0,deps:[P.eN,he]}],imports:[[Nk,O.QW,S.ot,ke,jy,aw]]}),e}(),Jk=Z.Bz.forChild([{path:"time-filter",component:function(){var e=function e(t,i,o){var n=this;m(this,e),this.languageService=t,this.dataSourceService=i,this.layerService=o,this.map=new _u({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:7},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(function(e){n.map.addLayer(n.layerService.createLayer({title:"OSM",source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://geoegl.msp.gouv.qc.ca/ws/igo_gouvouvert.fcgi",params:{LAYERS:"vg_observation_v_inondation_embacle_wmst",VERSION:"1.3.0"},timeFilterable:!0,timeFilter:{min:"2013",max:"2019",range:!1,type:ru.YEAR,style:au.SLIDER,step:1,timeInterval:2e3}}).subscribe(function(e){n.map.addLayer(n.layerService.createLayer({title:"Emb\xe2cle YEAR",visible:!0,source:e}))})};return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ce),w.Y36(du),w.Y36(Xu))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-time-filter"]],decls:21,vars:4,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/time-filter"],[3,"map","view"],["color","primary",3,"map"],["title","Layers"],[3,"layers"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Geo"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Time filter"),w.qZA(),w.TgZ(5,"mat-card-content"),w.TgZ(6,"li"),w._uU(7,"npm install --save moment@2.22.2"),w.qZA(),w.TgZ(8,"li"),w._uU(9,"npm install --save @mat-datetimepicker/core@3.0.0-beta.0"),w.qZA(),w.TgZ(10,"li"),w._uU(11,"Dependencies: LanguageService"),w.qZA(),w._UZ(12,"br"),w._uU(13," See the "),w.TgZ(14,"a",0),w._uU(15,"code of this example"),w.qZA(),w._UZ(16,"hr"),w.qZA(),w.TgZ(17,"igo-map-browser",1),w._UZ(18,"igo-zoom-button",2),w.qZA(),w.TgZ(19,"igo-panel",3),w._UZ(20,"igo-time-filter-list",4),w.qZA(),w.qZA()),2&e&&(w.xp6(17),w.Q6J("map",t.map)("view",t.view),w.xp6(1),w.Q6J("map",t.map),w.xp6(2),w.Q6J("layers",t.map.layers))},directives:[O.a8,O.$j,O.n5,O.dn,Du,ju,vn,yf],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),e}()}]),Bk=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[Jk,O.QW,S.ot,k.Ps,yn,jy,Gv]]}),e}(),jk=Z.Bz.forChild([{path:"ogc-filter",component:function(){var e=function e(t,i,o){var n=this;m(this,e),this.languageService=t,this.dataSourceService=i,this.layerService=o,this.map=new _u({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:7},this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(function(e){n.map.addLayer(n.layerService.createLayer({title:"OSM",source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"code_municipalite",alias:"# de la municipalit\xe9e"},{name:"date_observation",excludeFromOgcFilters:!0},{name:"urgence",values:["imm\xe9diate","inconnue"]}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:mc.All,filters:{logical:"Or",filters:[{operator:"PropertyIsEqualTo",propertyName:"code_municipalite",expression:"10043"},{operator:"Intersects",geometryName:"the_geom",wkt_geometry:"MULTIPOLYGON(((\n              -8379441.158019895 5844447.897707146,\n              -8379441.158019895 5936172.331649357,\n              -8134842.66750733 5936172.331649357,\n              -8134842.66750733 5844447.897707146,\n              -8379441.158019895 5844447.897707146\n            ), (\n              -8015003 5942074,\n              -8015003 5780349,\n              -7792364 5780349,\n              -7792364 5942074,\n              -8015003 5942074\n            )))"}]}}}).subscribe(function(e){n.map.addLayer(n.layerService.createLayer({title:"Emb\xe2cle (PropertyIsEqualTo OR Intersects)",source:e,style:new ms.ZP({image:new xs.Z({radius:5,fill:new ys.Z({color:"white"}),stroke:new ws.Z({color:"orange",width:1})})})}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:mc.All,filters:{operator:"During",propertyName:"date_observation",begin:"2016-01-21T00:00:00-05:00",end:"2016-01-26T00:00:00-05:00"}},minDate:"2016-01-01T00:00:00-05:00",maxDate:"2016-02-10T00:00:00-05:00",stepDate:"P2D"}).subscribe(function(e){n.map.addLayer(n.layerService.createLayer({title:"Emb\xe2cle (During, Step: P2D)",id:"1",source:e,style:new ms.ZP({image:new xs.Z({radius:5,fill:new ys.Z({color:"white"}),stroke:new ws.Z({color:"red",width:1})})})}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:mc.All,filters:{operator:"During",propertyName:"date_observation",begin:"2016-01-01T04:00:00-05:00",end:"2016-01-12T16:00:00-05:00"}},minDate:"2016-01-01T00:00:00-05:00",maxDate:"2016-02-14T20:00:00-05:00",stepDate:"PT4H"}).subscribe(function(e){n.map.addLayer(n.layerService.createLayer({title:"Emb\xe2cle (During, Step: PT4H)",id:"2",source:e,style:new ms.ZP({image:new xs.Z({radius:5,fill:new ys.Z({color:"white"}),stroke:new ws.Z({color:"blue",width:1})})})}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:mc.All,filters:{operator:"During",propertyName:"date_observation",begin:"2016-01-01T00:00:00-05:00",end:"2016-03-31T00:00:00-05:00",displayFormat:"MMMM"}},minDate:"2016-01-01T00:00:00-05:00",maxDate:"2018-12-31T00:00:00-05:00",stepDate:"P1M"}).subscribe(function(e){n.map.addLayer(n.layerService.createLayer({title:"Emb\xe2cle (During, Step: P1M)",id:"3",source:e,style:new ms.ZP({image:new xs.Z({radius:5,fill:new ys.Z({color:"white"}),stroke:new ws.Z({color:"yellow",width:1})})})}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:mc.All,filters:{operator:"During",propertyName:"date_observation",begin:"2014-01-01T00:00:00-05:00",end:"2019-12-31T00:00:00-05:00",sliderOptions:{interval:2e3,displayFormat:"YY"},displayFormat:"YYYY"}},minDate:"2014-01-01T00:00:00-05:00",maxDate:"2019-12-31T00:00:00-05:00",stepDate:"P1Y"}).subscribe(function(e){n.map.addLayer(n.layerService.createLayer({title:"Emb\xe2cle (During, Step: P1Y)",id:"4",source:e,style:new ms.ZP({image:new xs.Z({radius:5,fill:new ys.Z({color:"white"}),stroke:new ws.Z({color:"green",width:1})})})}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:mc.All,filters:{operator:"During",propertyName:"date_observation",begin:"today - 2 days",end:"today"}},minDate:"2016-01-01T00:00:00-05:00",maxDate:"2025-12-31T00:00:00-05:00",stepDate:"P1D"}).subscribe(function(e){n.map.addLayer(n.layerService.createLayer({title:"Emb\xe2cle (During, Interval from Now, Step: P1D)",id:"5",source:e,style:new ms.ZP({image:new xs.Z({radius:5,fill:new ys.Z({color:"white"}),stroke:new ws.Z({color:"black",width:1})})})}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",params:{featureTypes:"vg_observation_v_autre_wmst",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"2.0.0",outputFormat:void 0,outputFormatDownload:"SHP"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,allowedOperatorsType:mc.All,filters:{operator:"During",propertyName:"date_observation",begin:"2019-01-01 00:00:00",restrictToStep:!0}},minDate:"2016-01-01T00:00:00-05:00",maxDate:"2025-12-31T00:00:00-05:00",stepDate:"P1M"}).subscribe(function(e){n.map.addLayer(n.layerService.createLayer({title:"Emb\xe2cle (During, RestrictToStep, Step: P1M)",id:"6",source:e,style:new ms.ZP({image:new xs.Z({radius:5,fill:new ys.Z({color:"black"}),stroke:new ws.Z({color:"red",width:1})})})}))}),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://geoegl.msp.gouv.qc.ca/apis/ws/igo_gouvouvert.fcgi",optionsFromCapabilities:!0,params:{LAYERS:"vg_observation_v_inondation23avril2017_wmst",VERSION:"1.3.0"},sourceFields:[{name:"date_observation",alias:"Date de l'observation",allowedOperatorsType:"Time"}],ogcFilters:{enabled:!0,editable:!0,filters:{operator:"During",propertyName:"date_observation"},allowedOperatorsType:mc.Time}}).subscribe(function(e){n.map.addLayer(n.layerService.createLayer({title:"Inondation (During, optionsFromCapabilities)",source:e}))}),this.dataSourceService.createAsyncDataSource({type:"wms",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",urlWfs:"https://ws.mapserver.transports.gouv.qc.ca/swtq",params:{LAYERS:"radars_photos",VERSION:"1.3.0"},ogcFilters:{enabled:!0,editable:!0,pushButtons:{selectorType:"pushButton",order:2,groups:[{title:"Nom du group1 - push",name:"1 - push",ids:["id1"]}],bundles:[{id:"id1",title:"R\xe9gions",logical:"Or",vertical:!0,selectors:[{title:"Montr\xe9al & Laval",enabled:!1,tooltip:"Here a tooltip explaning ...",filters:{logical:"Or",filters:[{operator:"PropertyIsEqualTo",propertyName:"region",expression:"Montr\xe9al"},{operator:"PropertyIsEqualTo",propertyName:"region",expression:"Laval"}]}},{title:"Outside Montr\xe9al & Laval",enabled:!1,tooltip:"Here a tooltip explaning ...",filters:{logical:"And",filters:[{operator:"PropertyIsNotEqualTo",propertyName:"region",expression:"Montr\xe9al"},{operator:"PropertyIsNotEqualTo",propertyName:"region",expression:"Laval"}]}}]}]},checkboxes:{selectorType:"checkbox",order:1,groups:[{title:"Nom du group1 - checkbox",name:"1 - checkbox",ids:["id1"]}],bundles:[{id:"id1",title:"Type de radar photo",logical:"Or",selectors:[{title:"Radar photo fixe",enabled:!0,tooltip:"Here a tooltip explaning ...",filters:{operator:"PropertyIsEqualTo",propertyName:"typeAppareil",expression:"Radar photo fixe"}},{title:"Radar photo mobile",enabled:!1,tooltip:"Here a tooltip explaning ...",filters:{operator:"PropertyIsEqualTo",propertyName:"typeAppareil",expression:"Radar photo mobile"}},{title:"Radar photo fixe + feu rouge",enabled:!1,color:"0,200,0",tooltip:"Here a tooltip explaning ...",filters:{operator:"PropertyIsEqualTo",propertyName:"typeAppareil",expression:"Radar photo fixe et surveillance au feu rouge"}},{title:"Radar feu rouge",enabled:!1,color:"255,0,0",tooltip:"Here a tooltip explaning ...",filters:{operator:"PropertyIsEqualTo",propertyName:"typeAppareil",expression:"Appareil de surveillance au feu rouge"}}]}]},allowedOperatorsType:mc.Basic},paramsWFS:{featureTypes:"radars_photos",fieldNameGeometry:"geometry",maxFeatures:1e4,version:"1.1.0",outputFormat:"geojson",outputFormatDownload:"shp"}}).subscribe(function(e){n.map.addLayer(n.layerService.createLayer({title:"Filterable WMS layers with predefined filters (push buttons)",source:e}))})};return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ce),w.Y36(du),w.Y36(Xu))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-ogc-filter"]],decls:17,vars:5,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/ogc-filter"],[3,"map","view"],["color","primary",3,"map"],["title","Layers"],[3,"map","layers"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Geo"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Ogc filter"),w.qZA(),w.TgZ(5,"mat-card-content"),w.TgZ(6,"li"),w._uU(7,"Dependencies: LanguageService"),w.qZA(),w._UZ(8,"br"),w._uU(9," See the "),w.TgZ(10,"a",0),w._uU(11,"code of this example"),w.qZA(),w._UZ(12,"hr"),w.qZA(),w.TgZ(13,"igo-map-browser",1),w._UZ(14,"igo-zoom-button",2),w.qZA(),w.TgZ(15,"igo-panel",3),w._UZ(16,"igo-ogc-filterable-list",4),w.qZA(),w.qZA()),2&e&&(w.xp6(13),w.Q6J("map",t.map)("view",t.view),w.xp6(1),w.Q6J("map",t.map),w.xp6(2),w.Q6J("map",t.map)("layers",t.map.layers))},directives:[O.a8,O.$j,O.n5,O.dn,Du,ju,vn,sm],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}"]}),e}()}]),Qk=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[jk,O.QW,S.ot,k.Ps,yn,jy,Gv]]}),e}();function Gk(e,t){if(1&e&&(w.ynx(0),w._UZ(1,"igo-feature-details",8),w.BQk()),2&e){var i=t.ngIf;w.xp6(1),w.Q6J("feature",i)}}var Yk=Z.Bz.forChild([{path:"spatial-filter",component:function(){var e=function(){function e(t,i,o,n,r){var a=this;m(this,e),this.spatialFilterService=t,this.dataSourceService=i,this.layerService=o,this.messageService=n,this.languageService=r,this.map=new _u({controls:{attribution:{collapsed:!0}}}),this.view={center:[-71.9,46.9],zoom:10},this.itemType=mh.Address,this.layers=[],this.selectedFeature$=new R.X(void 0),this.format=new Zs.Z,this.store=new At([]),this.spatialListStore=new At([]),this.loading=!1,this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(function(e){a.map.addLayer(a.layerService.createLayer({title:"OSM",source:e,baseLayer:!0,visible:!0}))})}return y(e,[{key:"getOutputType",value:function(e){this.type=e,this.queryType=void 0,this.radius=void 0}},{key:"getOutputQueryType",value:function(e){this.queryType=e,this.queryType&&this.loadFilterList()}},{key:"loadFilterList",value:function(){var e=this;this.spatialFilterService.loadFilterList(this.queryType).subscribe(function(t){t.sort(function(e,t){return e.properties.nom<t.properties.nom?-1:e.properties.nom>t.properties.nom?1:0}),e.spatialListStore.clear(),e.spatialListStore.load(t)})}},{key:"getOutputToggleSearch",value:function(){this.loadThematics()}},{key:"getOutputClearSearch",value:function(){this.zone=void 0,this.queryType=void 0}},{key:"loadThematics",value:function(){var e=this;this.loading=!0,this.tryAddFeaturesToMap([this.zone]),this.thematics||(this.thematics=[{name:""}]),this.type===fh.Polygon&&(this.radius=void 0),this.thematics.forEach(function(t){e.spatialFilterService.loadFilterItem(e.zone,e.itemType,e.queryType,t,e.radius).subscribe(function(t){e.store.insertMany(t);var i,o,n=[],r=[];t.forEach(function(e){"Point"===e.geometry.type?(n.push(e),i=e.meta.id):(r.push(e),o=e.meta.id)}),e.tryAddPointToMap(n,i),e.tryAddLayerToMap(r,o),e.loading=!1,t.length>=1e4&&e.messageService.alert(e.languageService.translate.instant("igo.geo.spatialFilter.maxSizeAlert"),e.languageService.translate.instant("igo.geo.spatialFilter.warning"),{timeOut:1e4}),t.length||e.messageService.alert(e.languageService.translate.instant("igo.geo.spatialFilter.zeroResults"),e.languageService.translate.instant("igo.geo.spatialFilter.warning"),{timeOut:1e4})})})}},{key:"onZoneChange",value:function(e){this.zone=e,e&&(this.tryAddFeaturesToMap([e]),this.zoomToFeatureExtent(e))}},{key:"tryAddFeaturesToMap",value:function(e){var t,i=this,o=1,n=p(e);try{var r=function(){var n=t.value;if(i.type===fh.Predefined){var r,a=p(i.map.layers);try{for(a.s();!(r=a.n()).done;){var s=r.value;if(s.options._internal&&s.options._internal.code===n.properties.code)return{v:void 0};s.title.startsWith("Zone")&&i.map.removeLayer(s)}}catch(u){a.e(u)}finally{a.f()}}var l,c=p(i.map.layers);try{for(c.s();!(l=c.n()).done;){l.value.title.startsWith("Zone")&&o++}}catch(u){c.e(u)}finally{c.f()}i.dataSourceService.createAsyncDataSource({type:"vector",queryable:!0}).subscribe(function(t){var r=i.layerService.createLayer({title:"Zone "+o,_internal:{code:i.type===fh.Predefined?n.properties.code:void 0},source:t,visible:!0,style:function(t,o){var n=e[0].coordinates;return new ms.ZP({image:new xs.Z({radius:n?i.radius/Math.cos(Math.PI/180*n[1])/o:void 0,fill:new ys.Z({color:"rgba(200, 200, 20, 0.2)"}),stroke:new ws.Z({width:1,color:"orange"})}),stroke:new ws.Z({width:1,color:"orange"}),fill:new ys.Z({color:"rgba(200, 200, 20, 0.2)"})})}}),a=e.map(function(e){return hu(e,i.map.projection)});t.ol.addFeatures(a),i.map.addLayer(r),i.layers.push(r)})};for(n.s();!(t=n.n()).done;){var a=r();if("object"==typeof a)return a.v}}catch(s){n.e(s)}finally{n.f()}}},{key:"tryAddPointToMap",value:function(e,t){var i=this,o=1;if(e.length>=1){if(void 0===this.map)return;var n,r=p(this.map.layers);try{for(r.s();!(n=r.n()).done;){n.value.title.startsWith(e[0].meta.title)&&o++}}catch(a){r.e(a)}finally{r.f()}this.dataSourceService.createAsyncDataSource({type:"cluster",id:t,queryable:!0,distance:120,meta:{title:"Cluster"}}).subscribe(function(t){var n=i.layerService.createLayer({title:e[0].meta.title+" "+o,source:t,visible:!0,clusterParam:{clusterRanges:[{minRadius:1,maxRadius:5,style:{}}]}}),r=e.map(function(e){return hu(e,i.map.projection)});t.ol.getSource().addFeatures(r),i.map.layers.find(function(e){return e.id===n.id})&&(i.map.removeLayer(i.map.layers.find(function(e){return e.id===n.id})),o-=1,n.title=e[0].meta.title+" "+o,n.options.title=n.title),i.map.addLayer(n),i.layers.push(n)})}}},{key:"tryAddLayerToMap",value:function(e,t){var i=this,o=1;if(e.length>1){if(void 0===this.map)return;var n,r=p(this.map.layers);try{for(r.s();!(n=r.n()).done;){n.value.title.startsWith(e[0].meta.title)&&o++}}catch(a){r.e(a)}finally{r.f()}this.dataSourceService.createAsyncDataSource({type:"vector",id:t,queryable:!0}).subscribe(function(t){var n=i.layerService.createLayer({title:e[0].meta.title+" "+o,source:t,visible:!0}),r=e.map(function(e){return hu(e,i.map.projection)});t.ol.addFeatures(r),i.map.layers.find(function(e){return e.id===n.id})&&(i.map.removeLayer(i.map.layers.find(function(e){return e.id===n.id})),o-=1,n.title=e[0].meta.title+" "+o,n.options.title=n.title),i.map.addLayer(n),i.layers.push(n)})}}},{key:"zoomToFeatureExtent",value:function(e){if(e){var t=this.format.readFeature(e,{dataProjection:e.projection,featureProjection:this.map.projection});mu(this.map,[t],tc.Zoom)}}},{key:"handleQueryResults",value:function(e){var t,i=e.features;i.length&&(t=i[0]),this.selectedFeature$.next(t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(vh),w.Y36(du),w.Y36(Xu),w.Y36(Ae),w.Y36(Ce))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-spatial-filter"]],inputs:{type:"type",itemType:"itemType",freehandDrawIsActive:"freehandDrawIsActive"},decls:25,vars:17,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/spatial-filter"],["igoOverlay","","igoQuery","",3,"map","view","queryFeatures","query"],["color","primary",3,"map"],["title","Spatial Filter"],[3,"store","selectedQueryType","zone","eventType","eventQueryType","zoneChange"],[3,"type","queryType","map","zone","loading","store","layers","radiusEvent","freehandControl","drawZoneEvent","itemTypeChange","thematicChange","toggleSearch","clearButtonEvent","clearSearchEvent"],["title","Details"],[4,"ngIf"],[3,"feature"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Geo"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Spatial filter"),w.qZA(),w.TgZ(5,"mat-card-content"),w.TgZ(6,"li"),w._uU(7,"npm install --save moment@2.22.2"),w.qZA(),w.TgZ(8,"li"),w._uU(9,"npm install --save @mat-datetimepicker/core@3.0.0-beta.0"),w.qZA(),w.TgZ(10,"li"),w._uU(11,"Dependencies: LanguageService"),w.qZA(),w._UZ(12,"br"),w._uU(13," See the "),w.TgZ(14,"a",0),w._uU(15,"code of this example"),w.qZA(),w._UZ(16,"hr"),w.qZA(),w.TgZ(17,"igo-map-browser",1),w.NdJ("query",function(e){return t.handleQueryResults(e)}),w._UZ(18,"igo-zoom-button",2),w.qZA(),w.TgZ(19,"igo-panel",3),w.TgZ(20,"igo-spatial-filter-type",4),w.NdJ("eventType",function(e){return t.getOutputType(e)})("eventQueryType",function(e){return t.getOutputQueryType(e)})("zoneChange",function(e){return t.onZoneChange(e)}),w.qZA(),w.TgZ(21,"igo-spatial-filter-item",5),w.NdJ("radiusEvent",function(e){return t.radius=e})("freehandControl",function(e){return t.freehandDrawIsActive=e})("drawZoneEvent",function(e){return t.zone=e})("itemTypeChange",function(e){return t.itemType=e})("thematicChange",function(e){return t.thematics=e})("toggleSearch",function(){return t.getOutputToggleSearch()})("clearButtonEvent",function(e){return t.layers=e})("clearSearchEvent",function(){return t.getOutputClearSearch()}),w.qZA(),w.qZA(),w.TgZ(22,"igo-panel",6),w.YNc(23,Gk,2,1,"ng-container",7),w.ALo(24,"async"),w.qZA(),w.qZA()),2&e&&(w.xp6(17),w.Q6J("map",t.map)("view",t.view)("queryFeatures",!0),w.xp6(1),w.Q6J("map",t.map),w.xp6(2),w.Q6J("store",t.spatialListStore)("selectedQueryType",t.queryType)("zone",t.zone),w.xp6(1),w.Q6J("type",t.type)("queryType",t.queryType)("map",t.map)("zone",t.zone)("loading",t.loading)("store",t.store)("layers",t.layers),w.xp6(2),w.Q6J("ngIf",w.lcZ(24,15,t.selectedFeature$)))},directives:[O.a8,O.$j,O.n5,O.dn,Du,wp,ju,vn,ev,kv,F.O5,Ph],pipes:[F.Ov],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}igo-form[_ngcontent-%COMP%]{display:none}igo-spatial-filter-item[_ngcontent-%COMP%]     .thematics-header{max-width:225px}"]}),e}()}]),zk=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[Yk,O.QW,S.ot,k.Ps,yn,jy,ke,mb,Sg,wg,Gv,Go,F.ez]]}),e}();function Vk(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"igo-entity-table-paginator",6),w.NdJ("paginatorChange",function(e){return w.CHM(i),w.oxw(2).paginatorChange(e)}),w.qZA()}if(2&e){var o=w.oxw().ngIf,n=w.oxw();w.Q6J("store",o.entityStore)("paginatorOptions",n.paginatorOptions)("entitySortChange$",n.entitySortChange$)}}function Hk(e,t){if(1&e&&(w.ynx(0),w.YNc(1,Vk,1,3,"igo-entity-table-paginator",5),w.ALo(2,"async"),w.BQk()),2&e){var i=t.ngIf;w.xp6(1),w.Q6J("ngIf",w.lcZ(2,1,i.inResolutionRange$))}}function Wk(e,t){if(1&e&&w._UZ(0,"igo-actionbar",10),2&e){var i=w.oxw().ngIf,o=w.oxw();w.Q6J("store",i.actionStore)("horizontal",!0)("withToggleButton",!0)("withTitle",!0)("mode",o.actionbarMode)}}function Xk(e,t){if(1&e&&w._UZ(0,"igo-entity-table",11),2&e){var i=w.oxw().ngIf,o=w.oxw();w.Q6J("paginator",o.workspacePaginator)("scrollBehavior",o.scrollBehavior)("store",i.entityStore)("template",i.meta.tableTemplate)}}function Kk(e,t){1&e&&(w.TgZ(0,"mat-card-content"),w._uU(1," No data available at this scale. Please zoom in. "),w.qZA())}function eC(e,t){if(1&e&&(w.ynx(0),w.YNc(1,Wk,1,5,"igo-actionbar",7),w.YNc(2,Xk,1,4,"igo-entity-table",8),w.ALo(3,"async"),w.YNc(4,Kk,2,0,"mat-card-content",4),w.ALo(5,"async"),w._UZ(6,"igo-workspace-widget-outlet",9),w.BQk()),2&e){var i=t.ngIf;w.xp6(1),w.Q6J("ngIf",i.actionStore),w.xp6(1),w.Q6J("ngIf",i.entityStore&&i.meta&&i.meta.tableTemplate&&w.lcZ(3,4,i.inResolutionRange$)),w.xp6(2),w.Q6J("ngIf",!1===w.lcZ(5,6,i.inResolutionRange$)),w.xp6(2),w.Q6J("workspace",i)}}var tC=Z.Bz.forChild([{path:"workspace",component:function(){var e=function(){function e(t,i,o,n){m(this,e),this.languageService=t,this.dataSourceService=i,this.layerService=o,this.workspaceState=n,this.entitySortChange$=new R.X(!1),this.paginatorOptions={pageSize:5,pageSizeOptions:[1,5,10,15,30,50,100],showFirstLastButtons:!0},this.map=new _u({controls:{attribution:{collapsed:!0}}}),this.view={center:[-72,47.2],zoom:5},this.actionbarMode=$i.Overlay,this.scrollBehavior=yt.Instant}return y(e,[{key:"workspaceStore",get:function(){return this.workspaceState.store}},{key:"ngOnInit",value:function(){var e=this;this.selectedWorkspace$=this.workspaceStore.stateView.firstBy$(function(e){return!0===e.state.selected}).pipe((0,D.U)(function(e){var t=void 0===e?void 0:e.entity;return t&&t.actionStore.view.filter(function(e){return"wfsDownload"!==e.id}),t})),this.dataSourceService.createAsyncDataSource({type:"osm"}).subscribe(function(t){e.map.addLayer(e.layerService.createLayer({title:"OSM",source:t}))}),this.dataSourceService.createAsyncDataSource({type:"wfs",url:"https://ws.mapserver.transports.gouv.qc.ca/swtq",params:{featureTypes:"etablissement_mtq",fieldNameGeometry:"geometry",version:"2.0.0",outputFormat:"geojson"},sourceFields:[{name:"idetablis",alias:"ID"},{name:"nometablis",alias:"Name"},{name:"typetablis",alias:"Type"}]}).subscribe(function(t){e.map.addLayer(e.layerService.createLayer({title:"Simple WFS ",maxResolution:3e3,visible:!0,source:t}))})}},{key:"paginatorChange",value:function(e){this.workspacePaginator=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ce),w.Y36(du),w.Y36(Xu),w.Y36(Ck))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-workspace"]],decls:16,vars:11,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/geo/workspace"],[3,"map","view"],["color","primary",3,"map"],["igoWorkspaceSelector","",3,"store","map"],[4,"ngIf"],[3,"store","paginatorOptions","entitySortChange$","paginatorChange",4,"ngIf"],[3,"store","paginatorOptions","entitySortChange$","paginatorChange"],[3,"store","horizontal","withToggleButton","withTitle","mode",4,"ngIf"],["class","table-compact table-centered",3,"paginator","scrollBehavior","store","template",4,"ngIf"],[3,"workspace"],[3,"store","horizontal","withToggleButton","withTitle","mode"],[1,"table-compact","table-centered",3,"paginator","scrollBehavior","store","template"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Geo"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Workspace"),w.qZA(),w.TgZ(5,"mat-card-content"),w._uU(6," See the "),w.TgZ(7,"a",0),w._uU(8,"code of this example"),w.qZA(),w.qZA(),w.TgZ(9,"igo-map-browser",1),w._UZ(10,"igo-zoom-button",2),w.qZA(),w._UZ(11,"igo-workspace-selector",3),w.YNc(12,Hk,3,3,"ng-container",4),w.ALo(13,"async"),w.YNc(14,eC,7,8,"ng-container",4),w.ALo(15,"async"),w.qZA()),2&e&&(w.xp6(9),w.Q6J("map",t.map)("view",t.view),w.xp6(1),w.Q6J("map",t.map),w.xp6(1),w.Q6J("store",t.workspaceStore)("map",t.map),w.xp6(1),w.Q6J("ngIf",w.lcZ(13,7,t.selectedWorkspace$)),w.xp6(2),w.Q6J("ngIf",w.lcZ(15,9,t.selectedWorkspace$)))},directives:[O.a8,O.$j,O.n5,O.dn,Du,ju,ar,qx,F.O5,Et,cr,io,Ei],pipes:[F.Ov],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{width:100%;padding-top:10px}igo-entity-table[_ngcontent-%COMP%]{height:400px}igo-actionbar[_ngcontent-%COMP%]{height:48px}"]}),e}()}]),iC=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[F.ez,tC,O.QW,S.ot,k.Ps,no,Xo,pr,yn,jy,Rx]]}),e}();function oC(e,t){1&e&&w._UZ(0,"igo-metadata-button",10),2&e&&w.Q6J("layer",t.layer)}var nC=Z.Bz.forChild([{path:"context",component:function(){var e=function e(t,i,o){m(this,e),this.languageService=t,this.mapService=i,this.overlayService=o,this.map=new _u({controls:{attribution:{collapsed:!0}}}),this.view={center:[-73,47.2],zoom:6},this.mapService.setMap(this.map)};return e.\u0275fac=function(t){return new(t||e)(w.Y36(Ce),w.Y36(su),w.Y36(Hy))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-context"]],decls:28,vars:8,consts:[["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/app/context/context"],["href","https://github.com/infra-geo-ouverte/igo2-lib/tree/master/demo/src/contexts"],["igoMapContext","","igoLayerContext","",3,"map"],["color","primary",3,"map"],["color","primary",3,"map","showIfNoRotation"],["title","Contexts list"],["igoContextListBinding","",3,"map"],["title","Layers"],["igoLayerListBinding","",3,"map"],["igoLayerItemToolbar",""],[3,"layer"]],template:function(e,t){1&e&&(w.TgZ(0,"mat-card"),w.TgZ(1,"mat-card-subtitle"),w._uU(2,"Geo"),w.qZA(),w.TgZ(3,"mat-card-title"),w._uU(4,"Context"),w.qZA(),w.TgZ(5,"mat-card-content"),w.TgZ(6,"p"),w._uU(7,"* Dependencies: LanguageService"),w.qZA(),w._UZ(8,"br"),w._uU(9," See the "),w.TgZ(10,"a",0),w._uU(11,"code of this example"),w.qZA(),w._UZ(12,"br"),w._uU(13," See "),w.TgZ(14,"a",1),w._uU(15," contexts"),w.qZA(),w._UZ(16,"hr"),w.qZA(),w.TgZ(17,"igo-map-browser",2),w._UZ(18,"igo-zoom-button",3),w._UZ(19,"igo-geolocate-button",3),w._UZ(20,"igo-home-extent-button",3),w._UZ(21,"igo-rotation-button",4),w.qZA(),w.TgZ(22,"igo-panel",5),w._UZ(23,"igo-context-list",6),w.qZA(),w.TgZ(24,"igo-panel",7),w.TgZ(25,"igo-layer-list",8),w.YNc(26,oC,1,1,"ng-template",null,9,w.W1O),w.qZA(),w.qZA(),w.qZA()),2&e&&(w.xp6(17),w.Q6J("map",t.map),w.xp6(1),w.Q6J("map",t.map),w.xp6(1),w.Q6J("map",t.map),w.xp6(1),w.Q6J("map",t.map),w.xp6(1),w.Q6J("map",t.map)("showIfNoRotation",!0),w.xp6(2),w.Q6J("map",t.map),w.xp6(2),w.Q6J("map",t.map))},directives:[O.a8,O.$j,O.n5,O.dn,Du,IS,PS,ju,Qu,Gu,np,vn,uk,pk,Md,_d,Wl],styles:["igo-map-browser[_ngcontent-%COMP%]{width:100%;height:300px}igo-panel[_ngcontent-%COMP%]{margin-bottom:5px}"]}),e}()}]),rC=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[P.Ed,nC,O.QW,S.ot,k.Ps,yn,jy,Yd,Kl,Xy,mb,Sg,gk]]}),e}(),aC=[{path:"",redirectTo:"/home",pathMatch:"full"},{path:"**",redirectTo:"/home"}],sC=function(){var e=function e(){m(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=w.oAB({type:e}),e.\u0275inj=w.cJS({imports:[[Z.Bz.forRoot(aC,{useHash:!0})],Z.Bz]}),e}(),lC=function(){var e=function(){function e(t,i,o){m(this,e),this.changeDetectorRef=t,this.media=i,this.renderer=o,this.title="IGO",this.version=de,this.themeClass="deeppurple-theme",this.mobileQuery=i.matchMedia("(max-width: 600px)"),this._mobileQueryListener=function(){return t.detectChanges()},this.mobileQuery.addEventListener("change",this._mobileQueryListener),this.renderer.addClass(document.body,this.themeClass),this.detectOldBrowser()}return y(e,[{key:"ngOnDestroy",value:function(){this.mobileQuery.removeEventListener("change",this._mobileQueryListener)}},{key:"detectOldBrowser",value:function(){z.satisfies({ie:"<11",chrome:"<64",firefox:"<60"})&&console.log("Very old browser ! ",z.getBrowser())}}]),e}();return e.\u0275fac=function(t){return new(t||e)(w.Y36(w.sBO),w.Y36(le.vx),w.Y36(w.Qsj))},e.\u0275cmp=w.Xpm({type:e,selectors:[["app-root"]],decls:91,vars:8,consts:[[1,"example-container"],["color","primary",1,"example-toolbar"],["mat-icon-button","",3,"click"],["svgIcon","menu"],[1,"example-sidenav-container"],["opened","true","fixedTopGap","56",3,"mode","fixedInViewport"],["snav",""],["mat-list-item","","routerLink","."],["mat-list-item","","routerLink","activity"],["mat-list-item","","routerLink","config"],["mat-list-item","","routerLink","language"],["mat-list-item","","routerLink","media"],["mat-list-item","","routerLink","message"],["mat-list-item","","routerLink","request"],["mat-list-item","","routerLink","auth-form"],["mat-list-item","","routerLink","action"],["mat-list-item","","routerLink","dynamic-component"],["mat-list-item","","routerLink","entity-table"],["mat-list-item","","routerLink","entity-selector"],["mat-list-item","","routerLink","form"],["mat-list-item","","routerLink","table"],["mat-list-item","","routerLink","tool"],["mat-list-item","","routerLink","widget"],["mat-list-item","","routerLink","simple-map"],["mat-list-item","","routerLink","layer"],["mat-list-item","","routerLink","legend"],["mat-list-item","","routerLink","overlay"],["mat-list-item","","routerLink","geometry"],["mat-list-item","","routerLink","feature"],["mat-list-item","","routerLink","hover"],["mat-list-item","","routerLink","measure"],["mat-list-item","","routerLink","draw"],["mat-list-item","","routerLink","query"],["mat-list-item","","routerLink","catalog"],["mat-list-item","","routerLink","search"],["mat-list-item","","routerLink","print"],["mat-list-item","","routerLink","import-export"],["mat-list-item","","routerLink","directions"],["mat-list-item","","routerLink","time-filter"],["mat-list-item","","routerLink","ogc-filter"],["mat-list-item","","routerLink","spatial-filter"],["mat-list-item","","routerLink","workspace"],["mat-list-item","","routerLink","context"]],template:function(e,t){if(1&e){var i=w.EpF();w.TgZ(0,"div",0),w.TgZ(1,"mat-toolbar",1),w.TgZ(2,"button",2),w.NdJ("click",function(){return w.CHM(i),w.MAs(10).toggle()}),w._UZ(3,"mat-icon",3),w.qZA(),w.TgZ(4,"h1"),w._uU(5),w.qZA(),w.TgZ(6,"h5"),w._uU(7),w.qZA(),w.qZA(),w.TgZ(8,"mat-sidenav-container",4),w.TgZ(9,"mat-sidenav",5,6),w.TgZ(11,"mat-nav-list"),w.TgZ(12,"a",7),w._uU(13,"Home"),w.qZA(),w._UZ(14,"hr"),w.TgZ(15,"a",8),w._uU(16,"Activity"),w.qZA(),w.TgZ(17,"a",9),w._uU(18,"Config"),w.qZA(),w.TgZ(19,"a",10),w._uU(20,"Language"),w.qZA(),w.TgZ(21,"a",11),w._uU(22,"Media"),w.qZA(),w.TgZ(23,"a",12),w._uU(24,"Message"),w.qZA(),w.TgZ(25,"a",13),w._uU(26,"Request"),w.qZA(),w._UZ(27,"hr"),w.TgZ(28,"a",14),w._uU(29,"Authentification"),w.qZA(),w._UZ(30,"hr"),w.TgZ(31,"a",15),w._uU(32,"Action"),w.qZA(),w.TgZ(33,"a",16),w._uU(34,"Dynamic Component"),w.qZA(),w.TgZ(35,"a",17),w._uU(36,"Entity Table"),w.qZA(),w.TgZ(37,"a",18),w._uU(38,"Entity Selector"),w.qZA(),w.TgZ(39,"a",19),w._uU(40,"Form"),w.qZA(),w.TgZ(41,"a",20),w._uU(42,"Table"),w.qZA(),w.TgZ(43,"a",21),w._uU(44,"Tool"),w.qZA(),w.TgZ(45,"a",22),w._uU(46,"Widget"),w.qZA(),w._UZ(47,"hr"),w.TgZ(48,"a",23),w._uU(49,"Simple map"),w.qZA(),w.TgZ(50,"a",24),w._uU(51,"Layer"),w.qZA(),w.TgZ(52,"a",25),w._uU(53,"Legend"),w.qZA(),w.TgZ(54,"a",26),w._uU(55,"Overlay"),w.qZA(),w.TgZ(56,"a",27),w._uU(57,"Geometry"),w.qZA(),w.TgZ(58,"a",28),w._uU(59,"Feature"),w.qZA(),w.TgZ(60,"a",29),w._uU(61,"Hover"),w.qZA(),w.TgZ(62,"a",30),w._uU(63,"Measure"),w.qZA(),w.TgZ(64,"a",31),w._uU(65,"Draw"),w.qZA(),w.TgZ(66,"a",32),w._uU(67,"Query"),w.qZA(),w.TgZ(68,"a",33),w._uU(69,"Catalog"),w.qZA(),w.TgZ(70,"a",34),w._uU(71,"Search"),w.qZA(),w.TgZ(72,"a",35),w._uU(73,"Print"),w.qZA(),w.TgZ(74,"a",36),w._uU(75,"Import/Export"),w.qZA(),w.TgZ(76,"a",37),w._uU(77,"Directions"),w.qZA(),w.TgZ(78,"a",38),w._uU(79,"Time filter"),w.qZA(),w.TgZ(80,"a",39),w._uU(81,"OGC filter"),w.qZA(),w.TgZ(82,"a",40),w._uU(83,"Spatial filter"),w.qZA(),w.TgZ(84,"a",41),w._uU(85,"Workspace"),w.qZA(),w._UZ(86,"hr"),w.TgZ(87,"a",42),w._uU(88,"Context"),w.qZA(),w.qZA(),w.qZA(),w.TgZ(89,"mat-sidenav-content"),w._UZ(90,"router-outlet"),w.qZA(),w.qZA(),w.qZA()}2&e&&(w.ekj("example-is-mobile",t.mobileQuery.matches),w.xp6(5),w.Oqu(t.title),w.xp6(2),w.Oqu(t.version.lib),w.xp6(1),w.Udp("margin-top",t.mobileQuery.matches?56:0,"px"),w.xp6(1),w.Q6J("mode",t.mobileQuery.matches?"over":"side")("fixedInViewport",t.mobileQuery.matches))},directives:[A.Ye,S.lW,k.Hw,T.TM,T.JX,C.Hk,C.Tg,Z.yS,T.Rh,Z.lC],styles:["h1[_ngcontent-%COMP%]{width:100%;text-align:center;font-size:26px}.example-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:absolute;top:0;bottom:0;left:0;right:0}.example-is-mobile[_ngcontent-%COMP%]   .example-toolbar[_ngcontent-%COMP%]{position:fixed;z-index:2}.example-sidenav-container[_ngcontent-%COMP%]{flex:1}.example-is-mobile[_ngcontent-%COMP%]   .example-sidenav-container[_ngcontent-%COMP%]{flex:1 0 auto}mat-sidenav[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.031)}.example-is-mobile[_ngcontent-%COMP%]   mat-sidenav[_ngcontent-%COMP%]{background-color:#fff}mat-sidenav-content[_ngcontent-%COMP%]{padding:10px}"]}),e}(),cC=function(){var e=function e(t,i){m(this,e),t.addSvgIconSet(i.bypassSecurityTrustResourceUrl("./assets/igo2/core/icons/mdi.svg"))};return e.\u0275fac=function(t){return new(t||e)(w.LFG(k.jv),w.LFG(b.H7))},e.\u0275mod=w.oAB({type:e,bootstrap:[lC]}),e.\u0275inj=w.cJS({providers:[{provide:w.ip1,useFactory:uC,deps:[Ce],multi:!0}],imports:[[b.b2,x.PW,T.SJ,A.g0,S.ot,k.Ps,C.ie,vr,br,Sr,Cr,Ar,Zr,Or,Pr,Er,Rr,Jr,Qr,Yr,Kr,ia,Ga,nS,sS,cS,pS,gS,mS,yS,wS,SS,TS,LS,qk,Ek,Rk,Uk,Bk,Qk,zk,iC,rC,sC,b.t6]]}),e}();function uC(e){return function(){return new Promise(function(t){e.translate.getTranslation(e.getLanguage()).subscribe(function(){console.info("Successfully initialized '".concat(e.getLanguage(),"' language.'"))},function(t){console.error("Problem with '".concat(e.getLanguage(),"' language initialization.'"))},function(){t(null)})})}}l(58256),wr.production&&(0,w.G48)(),b.q6().bootstrapModule(cC).catch(function(e){return console.log(e)})},46700:function(e,t,i){var o={"./af":62275,"./af.js":62275,"./ar":90857,"./ar-dz":11218,"./ar-dz.js":11218,"./ar-kw":14754,"./ar-kw.js":14754,"./ar-ly":66680,"./ar-ly.js":66680,"./ar-ma":92178,"./ar-ma.js":92178,"./ar-sa":56522,"./ar-sa.js":56522,"./ar-tn":95682,"./ar-tn.js":95682,"./ar.js":90857,"./az":70164,"./az.js":70164,"./be":79774,"./be.js":79774,"./bg":60947,"./bg.js":60947,"./bm":21832,"./bm.js":21832,"./bn":89650,"./bn-bd":74477,"./bn-bd.js":74477,"./bn.js":89650,"./bo":66005,"./bo.js":66005,"./br":98492,"./br.js":98492,"./bs":70534,"./bs.js":70534,"./ca":52061,"./ca.js":52061,"./cs":84737,"./cs.js":84737,"./cv":61167,"./cv.js":61167,"./cy":77996,"./cy.js":77996,"./da":9528,"./da.js":9528,"./de":14540,"./de-at":49430,"./de-at.js":49430,"./de-ch":67978,"./de-ch.js":67978,"./de.js":14540,"./dv":83426,"./dv.js":83426,"./el":6616,"./el.js":6616,"./en-au":63816,"./en-au.js":63816,"./en-ca":32162,"./en-ca.js":32162,"./en-gb":83305,"./en-gb.js":83305,"./en-ie":61954,"./en-ie.js":61954,"./en-il":43060,"./en-il.js":43060,"./en-in":59923,"./en-in.js":59923,"./en-nz":13540,"./en-nz.js":13540,"./en-sg":16505,"./en-sg.js":16505,"./eo":41907,"./eo.js":41907,"./es":86640,"./es-do":41246,"./es-do.js":41246,"./es-mx":56131,"./es-mx.js":56131,"./es-us":36430,"./es-us.js":36430,"./es.js":86640,"./et":62551,"./et.js":62551,"./eu":32711,"./eu.js":32711,"./fa":54572,"./fa.js":54572,"./fi":33390,"./fi.js":33390,"./fil":87860,"./fil.js":87860,"./fo":48216,"./fo.js":48216,"./fr":99291,"./fr-ca":98527,"./fr-ca.js":98527,"./fr-ch":58407,"./fr-ch.js":58407,"./fr.js":99291,"./fy":47054,"./fy.js":47054,"./ga":49540,"./ga.js":49540,"./gd":73917,"./gd.js":73917,"./gl":51486,"./gl.js":51486,"./gom-deva":56245,"./gom-deva.js":56245,"./gom-latn":48868,"./gom-latn.js":48868,"./gu":59652,"./gu.js":59652,"./he":89019,"./he.js":89019,"./hi":42040,"./hi.js":42040,"./hr":63402,"./hr.js":63402,"./hu":79322,"./hu.js":79322,"./hy-am":27609,"./hy-am.js":27609,"./id":57942,"./id.js":57942,"./is":98275,"./is.js":98275,"./it":73053,"./it-ch":4378,"./it-ch.js":4378,"./it.js":73053,"./ja":46176,"./ja.js":46176,"./jv":679,"./jv.js":679,"./ka":92726,"./ka.js":92726,"./kk":72953,"./kk.js":72953,"./km":86957,"./km.js":86957,"./kn":59181,"./kn.js":59181,"./ko":47148,"./ko.js":47148,"./ku":27752,"./ku.js":27752,"./ky":65675,"./ky.js":65675,"./lb":41263,"./lb.js":41263,"./lo":65746,"./lo.js":65746,"./lt":11143,"./lt.js":11143,"./lv":38753,"./lv.js":38753,"./me":44054,"./me.js":44054,"./mi":31573,"./mi.js":31573,"./mk":30202,"./mk.js":30202,"./ml":68523,"./ml.js":68523,"./mn":79794,"./mn.js":79794,"./mr":56681,"./mr.js":56681,"./ms":56975,"./ms-my":39859,"./ms-my.js":39859,"./ms.js":56975,"./mt":3691,"./mt.js":3691,"./my":5152,"./my.js":5152,"./nb":7607,"./nb.js":7607,"./ne":21526,"./ne.js":21526,"./nl":86368,"./nl-be":40076,"./nl-be.js":40076,"./nl.js":86368,"./nn":68420,"./nn.js":68420,"./oc-lnc":51906,"./oc-lnc.js":51906,"./pa-in":94504,"./pa-in.js":94504,"./pl":54721,"./pl.js":54721,"./pt":74645,"./pt-br":54548,"./pt-br.js":54548,"./pt.js":74645,"./ro":71977,"./ro.js":71977,"./ru":26042,"./ru.js":26042,"./sd":78849,"./sd.js":78849,"./se":27739,"./se.js":27739,"./si":50084,"./si.js":50084,"./sk":92449,"./sk.js":92449,"./sl":23086,"./sl.js":23086,"./sq":33139,"./sq.js":33139,"./sr":30607,"./sr-cyrl":30063,"./sr-cyrl.js":30063,"./sr.js":30607,"./ss":40131,"./ss.js":40131,"./sv":21665,"./sv.js":21665,"./sw":5642,"./sw.js":5642,"./ta":33622,"./ta.js":33622,"./te":74825,"./te.js":74825,"./tet":48336,"./tet.js":48336,"./tg":39238,"./tg.js":39238,"./th":99463,"./th.js":99463,"./tk":39986,"./tk.js":39986,"./tl-ph":29672,"./tl-ph.js":29672,"./tlh":40043,"./tlh.js":40043,"./tr":51212,"./tr.js":51212,"./tzl":50110,"./tzl.js":50110,"./tzm":80482,"./tzm-latn":38309,"./tzm-latn.js":38309,"./tzm.js":80482,"./ug-cn":42495,"./ug-cn.js":42495,"./uk":54157,"./uk.js":54157,"./ur":80984,"./ur.js":80984,"./uz":64141,"./uz-latn":43662,"./uz-latn.js":43662,"./uz.js":64141,"./vi":12607,"./vi.js":12607,"./x-pseudo":66460,"./x-pseudo.js":66460,"./yo":92948,"./yo.js":92948,"./zh-cn":62658,"./zh-cn.js":62658,"./zh-hk":39352,"./zh-hk.js":39352,"./zh-mo":38274,"./zh-mo.js":38274,"./zh-tw":98451,"./zh-tw.js":98451};function n(e){var t=r(e);return i(t)}function r(e){if(!i.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}n.keys=function(){return Object.keys(o)},n.resolve=r,e.exports=n,n.id=46700},50257:function(e){"use strict";e.exports=JSON.parse('{"igo":{"auth":{"accessAnonymous":"Access as anonymous","connection":"Connection","login":"Login","password":"Password","signOut":"Sign out","user":"User","welcome":"Welcome {{name}}!","deconnection":"You are logged out.","home":"Return to the home page","error":{"Password expired":"Password expired","Maximun logins exceeded":"Maximum logins exceeded","Login lockout":"Maximum number of attempts exceeded. Your account is locked.","Wrong password":"Wrong password","Invalid username":"Invalid username"},"microsoft":{"login":"Sign in with Azure account"},"microsoftb2c":{"login":"Sign in"}}}}')},35488:function(e){"use strict";e.exports=JSON.parse('{"igo":{"common":{"confirmDialog":{"cancelBtn":"Cancel","confirmBtn":"Confirm","title":"Confirm"},"table":{"filter":"Filter"},"entity-table":{"targetHtmlUrl":"Open the external link"},"form":{"errors":{"required":"This field is required"}},"actionbar":{"scrollUp":"Scroll up","scrollDown":"Scroll down","icon":"Action list"},"interactiveTour":{"tooltipTourToolButton":"Interactive tour of the application","disaledTooltipTourToolButton":"To have access to this tool\'s tour, add contexts or layers","buttonTitle":"Discover","exitButton":"Exit","backButton":"Back","nextButton":"Next"},"paginator":{"firstPageLabel":"First page","itemsPerPageLabel":"Items per page:","lastPageLabel":"Last page","nextPageLabel":"Next page","previousPageLabel":"Previous page","of":"of"}}}}')},88952:function(e){"use strict";e.exports=JSON.parse('{"igo":{"context":{"bookmarkButton":{"create":"Create a new context","dialog":{"createMsg":"The context \'{{value}}\' was created","createTitle":"Context created","placeholder":"Title","title":"New context"}},"contextManager":{"clone":"Clone this context","delete":"Delete this context","dialog":{"cloneMsg":"The context \'{{value}}\' was cloned","cloneTitle":"Context cloned","copyMsg":"Text copied","copyTitle":"Context ID","confirmDelete":"Are you sure you want to delete this context?","deleteMsg":"The context \'{{value}}\' was deleted","deleteTitle":"Context deleted","favoriteMsg":"The context \'{{value}}\' was set as favorite","favoriteTitle":"Favorite saved","saveMsg":"The context \'{{value}}\' was saved","saveTitle":"Context saved"},"edit":"Edit this context","errors":{"uncaught":{"message":"Sorry, service is currently not available. Please try again later","title":"Error server"},"addPermission":"The permission you are trying to add is already in the context.","addPermissionEmpty":"The permission you are trying to add is not valid","addPermissionTitle":"Add permission error"},"favorite":"Set as favorite context","form":{"copy":"Copy the context ID","edit":"Save","title":"Title","titleRequired":"Title required","uri":"ID","uriRequired":"ID required"},"invalid":{"text":"Context \'{{value}}\' is invalid. The default context was loaded.","title":"Invalid context"},"managePermissions":"Manage permissions context","manageTools":"Manage tools context","ourContexts":"Our contexts","publicContexts":"Public contexts","save":"Save this context","sharedContexts":"Shared contexts","filterPlaceHolder":"Filter by name","sortAlphabetically":"Sort alphabetically","sortContextOrder":"Replace according to the creation date","userAccount":"User account","filterUser":"Filter by user group","emptyContext":"Empty context","emptyContextTooltip":"Create a new empty context","contextMap":"Context from map","contextMapTooltip":"Create a new context from map layers","hide":"Hide this context","show":"Show up this context","showHidden":"Show hidden contexts"},"contextImportExport":{"export":{"exportPlaceHolder":"Layers","exportContextName":"Context name","exportSelectAll":"Select all","success":{"text":"Context has been exported.","title":"Context export success"},"nothing":{"text":"No context could be exported.","title":"Nothing to export"},"failed":{"text":"Failed to export","title":"Failed to export context"}},"import":{"success":{"title":"Imported context","text":"The context \'{{value}}\' was added to the map"},"empty":{"text":"The context \'{{value}}\' contained nothing that could be imported.","title":"Nothing to import"},"invalid":{"text":"The context \'{{value}}\' is invalid.","title":"Invalid context"},"unreadable":{"title":"Unreadable context","text":"The context \'{{value}}\' is unreadable"},"tooLarge":{"text":"The context \'{{value}}\' is too large (Max: {{size}} MB)","title":"Context too large"}}},"permission":{"addBtn":"Add","delete":"Remove permission","dialog":{"addMsg":"The permission \'{{value}}\' was added","addTitle":"Permission added","deleteMsg":"The permission \'{{value}}\' was removed","deleteTitle":"Permission removed","scopeChangedMsg":"The scope was changed to {{value}}","scopeChangedTitle":"Scope changed"},"profil":"Profil","user":"User or group","profilRequired":"Profil required","read":"Read only","readOnlyTitle":"Read-only context","readOnlyMsg":"You can only revoke permission if the context is shared directly to your username.","scope":{"private":"Private","protected":"Protected","shared":"Shared","public":"Public"},"write":"Read and Write"},"poiButton":{"create":"Create a new zone of interest","dialog":{"confirmDelete":"Are you sure you want to delete this zone of interest?","createMsg":"The zone of interest \'{{value}}\' was created","createTitle":"Zone of interest created","deleteMsg":"The zone of interest \'{{value}}\' was deleted","deleteTitle":"Zone of interest deleted","placeholder":"Title","title":"New zone of interest"},"placeholder":"Zones of interest"},"sidenav":{"goBack":"Go Back","mainMenu":"Main Menu"},"shareMap":{"button":"Share map","refreshBtn":"Refresh sharing","copy":"Copy to clipboard","shareWithApi":"Share by context","shareWithUrl":"Share by url","dialog":{"copyMsg":"Link copied to clipboard","copyTitle":"Link"},"errorTitle":"Share Map error","placeholderLink":"Link","included":"Included in shared URL :","context":"The context when creating the sharing link.","center":"The coordinates of the center of the map (longitude, latitude).","zoom":"The zoom level of the map.","addedLayers":"The layers added by the catalog or by the search bar.","visibleInvisible":"Visibility status of layers.","excluded":"Excluded in the shared URL :","order":"The order of the layers.","opacity":"Modifications made to the opacity of the layers.","filterOgc":"Additions / modifications made to filters by attribute.","filterTime":"The current value for time filters."},"tool":{"dialog":{"addMsg":"The tool \'{{value}}\' was added","addTitle":"Tool added","deleteMsg":"The tool \'{{value}}\' was removed","deleteTitle":"Tool removed"}},"userButton":{"dialog":{"email":"Email","expiration":"Expiration","user":"User","clearPreferences":"Clear my preferences"},"infoTitle":"User info","logout":"Logout"}}}}')},63154:function(e){"use strict";e.exports=JSON.parse('{"igo":{"core":{"message":{"success":"Success","error":"Error","info":"Info","alert":"Alert"},"errors":{"uncaught":{"message":"Sorry, service is currently not available. Please try again later","title":"Error server"}},"network":{"online":{"message":"Online","title":"Status:"},"offline":{"message":"Offline","title":"Status:"}}}}}')},10711:function(e){"use strict";e.exports=JSON.parse('{"igo":{"geo":{"catalog":{"layer.addToMap":"Add to map","layer.addToMapOutRange":"Add to map. The layer is not visible at the current scale. Please zoom in/out","layer.removeFromMap":"Remove from map","layer.removeFromMapOutRange":"Remove from map. The layer is not visible at the current scale. Please zoom in/out","group.addToMap":"Add all layers from this group to map","group.removeFromMap":"Remove all layers from this group to map","baseLayers":"Baselayers","unavailableTitle":"Catalog unavailable","unavailable":"The catalog \'{{value}}\' is unavailable at the moment or you don\'t have the required permissions.","someUnavailable":"Some of the layers from the current catalog are unavailable at the moment or you don\'t have the required permissions.","externalProvider":{"catalog":"This catalog comes from an external organization.","group":"This layers comes from an external organization.","layer":"This layer comes from an external organization.","unavailableWithEmail":"The catalog \'{{value}}\' is unavailable at the moment. To add an external service to the predefined list, please contact us at {{emailAddress}}. Delays can apply if problems occurs with the provider."},"library.add":"Add this catalog to the list","library.cancel":"Cancel","library.remove":"Remove this catalog from the list","library.inlist":{"title":"Catalog already contained","message":"The catalog is already contained in the list."},"library.addTitle":"Adding a catalog","library.addBtn":"Add a catalog"},"clickOnMap":{"clickedFeature":"Clicked Feature"},"baselayersSwitcher":{"title":"Basemaps"},"dataSource":{"unavailableTitle":"Layer unavailable","optionsApiUnavailable":"Layer information could not be retrieved. Some layers may not present the correct information.","unavailable":"The layer \'{{value}}\' is unavailable at the moment or you don\'t have the required permissions."},"dropGeoFile":{"invalid":{"text":"The file \'{{value}}\' is invalid ({{mimeType}})","title":"Invalid file"},"empty":{"text":"The file \'{{value}}\' contained nothing that could be imported.","title":"Nothing to import"},"success":{"text":"The layer \'{{value}}\' was added to the map","title":"Imported file"},"unreadable":{"text":"The file \'{{value}}\' is unreadable","title":"Unreadable file"},"tooLarge":{"text":"The file \'{{value}}\' is too large (Max: {{size}} MB)","title":"File too large"},"invalidSRS":{"text":"The projection is valid. It must start with EPSG:","title":"Invalid projection"},"ogreServer":{"title":"Ogre server error 500","text":"Error in convert to geojson. Maybe file is too big, try to import that file in geojson format"}},"export":{"customList":{"text":"Some of the selected layers ( {{value}} ) limit the format\'s list","title":"Restricted list of formats"},"nothing":{"text":"No feature could be exported.","title":"Nothing to export"},"noFormat":{"text":"No export format valid for all selected layers. Please export the layers one at a time.","title":"No valid format"},"failed":{"text":"Failed to export","title":"Failed to export features"},"popupBlocked":{"text":"</br>Enable the popup in your browser. </br>For Chrome and Edge, on the right into the Address Bar.</br>{{extraMessage}}","selectAgain":"Fix it and re-select an output format.","retry":"Please retry to export","title":"Popup blocked by your browser"},"success":{"text":"Features have been exported.","title":"Features export success"},"format":{"GeoJSON":"GeoJSON","GML":"GML","GPX":"GPX","KML":"KML","Shapefile":"Shapefile","CSVcomma":"CSV (comma delimited)","CSVsemicolon":"CSV (Excel compatible)","URL":"External link"},"gpx.error.poly":{"title":"GPX error","text":"GPX format do now allow polygon features"},"encoding":{"LATIN1":"LATIN-1","UTF8":"UTF-8"},"combinedLayers":"combinedLayers"},"importExportForm":{"exportButton":"Export","exportButtonLink":"Open the link","exportButtonLinks":"Open the links","exportCombineResults":"Combine layers into one file","exportFormatPlaceholder":"Format","exportLayerPlaceholder":"Layer","exportFileNamePlaceholder":"Filename","exportSeparator":"Insert separator (empty row) between layers","encodingPlaceholder":"Encoding","exportTabTitle":"Export","exportFeatureInExtent":"Export only features in map extent","exportNoLayersExportable":"There is no exportable layer in your map","exportSelectedFeature":"Export only selected features","importButton":"Import","importProjPlaceholder":"Coordinate system of the file to import","importTabTitle":"Import","importClarifications":"Clarifications","importSizeMax":"The file size limit is {{size}} Mb","importFormatAuthorized":"Formats authorized: geojson, kml, gpx, gml, shapefile","importShpZip":"Shapefiles must be zipped AND geometries stored in Latitude Longitude coordinate (EPSG:4326/WGS:84)","other":"other","others":"others","projections":{"mtm":"MTM zone {{zone}} ({{code}})","utm":"UTM zone {{zone}} ({{code}})","webMercator":"Web Mercator ({{code}})","nad83":"Lat-Long NAD83 ({{code}})","wgs84":"Lat-Long WGS84 ({{code}})","choose":"You must choose a projection for your input file."}},"operators":{"caseSensitive":"Case sensitive","And":"And","Or":"Or","PropertyIsEqualTo":"=","PropertyIsNotEqualTo":"!=","PropertyIsLike":"\u2248","PropertyIsGreaterThan":">","PropertyIsGreaterThanOrEqualTo":">=","PropertyIsLessThan":"<","PropertyIsLessThanOrEqualTo":"<=","PropertyIsBetween":"between","During":"during (temporal)","PropertyIsNull":"is null","Intersects":"intersects (spatial)","Within":"within (spatial)","Contains":"contains (spatial)","tooltip":{"And":"Logical operator between filters where both conditions must be true","Or":"Logical operator between filters where at least one (1) condition must be true","PropertyIsEqualTo":"Identical (case sensitive)","PropertyIsNotEqualTo":"Different(case sensitive)","PropertyIsLike":"Like Example: *road* Finds any values that have \'road\' in any position. road* Finds any values that begin by \'road\'. wildCard =\'*\', singleChar = \'.\' escapeChar = \'!\' (case sensitive)","PropertyIsGreaterThan":"Greater than","PropertyIsGreaterThanOrEqualTo":"Greater than or equal to ","PropertyIsLessThan":"Lesser than","PropertyIsLessThanOrEqualTo":"Lesser than or equal to","PropertyIsBetween":"Apply a range check between the lower and upper boundary (values are included)","During":"Apply a range check for time attributes","PropertyIsNull":"Return features where the attribute is null","Intersects":"Return features in geometric intersection with the provided geometry","Within":"Return feature which are completely contained by the provided geometry","Contains":"Return feature completely containing by the provided geometry"}},"sourceFields":{"selectField":"Choose a field"},"filter":{"resetFilters":"Reset default values","addFilter":"Add an empty filter to the current list","removeFilter":"Remove the current filter from the filters\'s list","toggleFilterState":"Enable/disable the current filter","refreshFilters":"Update this datasource with the active filter(s). To enable this button, the layer must be visible (or in the defined scale ranges) or you must modify the current filter.","layerFiltered":"This layer is currently filtered","layerFilterable":"This layer is filterable","filterBy":"Filter by","advancedOgcFilters":"Advanced filters","displayMoreResults":"Display more (+)","displayLessResults":"Display less (-)","placeholder":"Enter a value","placeholderSnrc":"Ex: 21L14","selectOperator":"Select an operator","sliderModeTitle":"Time slider","reportingDate":"Reporting date"},"spatialSelector":{"fixedExtent":"Fixed extent","btnSetExtent":"Define the extent of the spatial filter to the current view","snrc":"SNRC","selectFeature":"","drawFeature":""},"layer":{"hideLayer":"Hide Layer","lowerLayer":"Bring layer backward","hideSelectedLayers":"Hide selected layers","filterLowerLayer":"The backward movement is always done according to the order of the map!","filterPlaceholder":"Filter the layers list","activateSelectionMode":"Activate multiple selection mode","deactivateSelectionMode":"Deactivate multiple selection mode","tools":"Tools","selectAll":"Select all layers","deselectAll":"Deselect all layers","zoomLayer":"Zoom To Layer Extents","zoomLayers":"Zoom To Selected Layers Extents","opacity":"Opacity","raiseLayer":"Bring layer forward","filterRaiseLayer":"The forward movement is always done according to the order of the map!","moreOptions":"Layer\'s tools","removeLayer":"Remove this layer from the map","removeSelectedLayers":"Remove selected layers from the map","removeSelectedLayersRestriction":"Some selected layers cannot be removed","showFeaturesList":"Show features list","showLayer":"Show Layer","showSelectedLayers":"Show selected layers","subsetLayersListKeyword":"Subset the layers\'s list by title or type (wms, wfs,...)","deleteKeyword":"Delete the keyword","subsetLayersListOnlyVisible":"Subset the layers\'s list by visibility","subsetLayersListOnlyInRange":"Subset the layers\'s list by resolution range","sortAlphabetically":"Sort the layers\'s list alphabetically","sortMapOrder":"Sort the layers\'s list based on layer\'s order on the map","resetLayersList":"Remove the current applied filter to layers\'s list","trackFeature":"Track the feature","legend":{"default":"Default","loadingLegendText":"Loading legend","noLegendText":"No legend available for this layer","noLegendScale":"No legend available for this scale","selectStyle":"Select the style of the legend","showAll":"Show all legends (non visible and out of range)","noLayersVisibleWithShowAllButton":"No layer currently visible. Activate the button above to see all the legends.","noLayersVisibleWithShowAllButtonButZoom":"No layer currently visible. If you zoom in the map, some layers will appear OR activate the button above to see all the legends.","noLayersVisible":"No layers currently visible.","noLayersVisibleButZoom":"No layers currently visible. However, if you zoom in the map, some layers will appear."}},"download":{"action":"Download data","title":"Downloading file","start":"Started. Check the download progression in your browser","end":"Completed"},"mapButtons":{"baselayerSwitcher":"Change base layer","geolocate":"Geolocate","home-extent":"Go to the home map extent","offline":"Offline mode","online":"Online mode","zoomIn":"Zoom in ({{zoom}})","zoomOut":"Zoom out ({{zoom}})","resetRotation":"Set map to north","tipRotation":"Hold Alt and SHIFT while dragging on map to rotate the map."},"metadata":{"show":"Show metadata"},"printForm":{"corsErrorMessageBody":"Unable to print due to non-owned access rights","corsErrorMessageHeader":"Print","comment":"Comment","doZipFile":"Zip file","outputFormat":"Output format","paperFormat":"Paper format","paperFormats":{"A0":"33.1 X 46.8\\" (A0)","A1":"23.4 X 33.1\\" (A1)","A2":"16.5 X 23.5\\" (A2)","A3":"11.7 X 16.5\\" (A3)","A4":"8.3 X 11.7\\" (A4)","A5":"5.8 X 8.3\\" (A5)","Letter":"Letter","Legal":"Legal"},"imageFormat":"Image format","orientation":"Orientation","landscape":"Landscape","portrait":"Portrait","projection":"Projection","resolution":"Resolution","saveBtn":"Save","scale":"Scale","showProjection":"Show projection","showScale":"Show scale","title":"Title","subtitle":"Subtitle","legendPosition":"Legend Position","legendPositions":{"none":"No legend","topleft":"Top left corner of the map","topright":"Top right corner of the map","bottomleft":"Bottom left corner of the map","bottomright":"Bottom right corner of the map","newpage":"On a new page"}},"directionsForm":{"stopLayer":"Directions - stops","routeLayer":"Directions - route","start":"Start","intermediate":"Intermediate","end":"End","directionsBtn":"Get route","resetDirectionsBtn":"Reset","zoomRoute":"Zoom on route","null":"","directions":"Directions","raiseStop":"Raise stop\'s priority","lowerStop":"Lower stop\'s priority","addStop":"Add a stop","clearStop":"Clear this stop","moveStop":"Move this stop","removeStop":"Remove this stop","drivingOptions":"Options","summary":"Direction\'s summary","stopsList":"Stops\'s list","instructions":"Instructions","copy":"Copy directions","geolocate":"Use current localisation as stop","link":"Link","dialog":{"copyMsg":"Directions copied to clipboard","copyMsgLink":"Link for directions copied to clipboard","copyTitle":"Directions"}},"directions":{"uturn":"u-turn","sharp right":"sharp right","right":"right","slight right":"slightly on right","sharp left":"sharp left","left":"left","slight left":"slightly on left","straight":"forward","turn":{"straight":"Continue on {{route}}","uturn":"Make u-turn on {{route}}","else":"Turn {{translatedModifier}} onto {{route}}"},"new name":"Head {{translatedDirection}} on {{route}}","depart":"Head {{translatedDirection}} on {{route}}","arrive":{"lastStep":"You have reached your destination {{coma}} {{aggregatedDirection}}","intermediate":"You have reached the intermediate stop onto {{route}}"},"merge":"Continue on {{route}}","on ramp":"Take the ramp {{aggregatedDirection}}","off ramp":"Take exit {{aggregatedDirection}}","fork":{"left":"Merge left onto {{route}}","right":"Merge right onto {{route}}","else":"Continue on {{route}}"},"end of road":"At the end of the road, turn {{translatedModifier}} onto {{route}}","use lane":"Take the lane ...","continue":{"notUturn":"Continue on {{route}}"},"roundabout":"At the roundabout, take the {{exit}}{{cntSuffix}} exit towards {{route}}","rotary":"Roundabout rotary ...","roundabout turn":"Roundabout, take the ...","exit roundabout":"Continue to {{route}}","notification":"notification ...","uturnText":"Make u-turn and head {{translatedDirection}} on {{route}}","unknown":"???","cntSuffix":{"first":"st","secondAndMore":"rd"},"modifier":{"prefix":"on the "}},"cardinalPoints":{"n":"north","ne":"northeast","e":"east","se":"southeast","s":"south","sw":"southwest","w":"west","nw":"northwest"},"search":{"placeholder":"Search for a localisation or a layer","emptyType.placeholder":"Please choose a search type","feature.title":"Localisation","feature.placeholder":"Search for a place localisation","layer.title":"Layer","layer.placeholder":"Search for a layer","ichercheReverse.name":"Search by coordinates","ilayer":{"name":"Layers","properties":{"abstract":"Abstract","groupTitle":"Group","title":"Title","type":"Type","url":"URL","metadataUrl":"Metadata","name":"Layer name","urlInfo":"URL - WMS/WFS","downloadUrl":"Data download"},"type":{"layer":"Layer","groupLayer":"Group of layers"}},"nominatim":{"type":{"food":"Food","health":"Health","entertainment":"Entertainment","finance":"Finance"},"country":{"all":"The world","canada":"Canada"}},"icherche":{"name":"iCherche","type":{"address":"Address","oldAddress":"Old address","district":"District","postalCode":"Postal Code","city":"City","oldCity":"Old city","mrc":"MRC","regadmin":"Administrative Region","road":"Road","intersection":"Intersection","place":"Place","exit":"Highway exit","cn":"CN mark","gcc":"Coast Guard mark (CCG)","sumi":"SUMI mark","km":"Mileage mark","hq":"Hydro-Quebec","entreprise":"Entreprise","cadastre":"Cadastre"},"restrictExtent":{"map":"\xc0 l\'\xe9tendue de la carte","quebec":"Au Qu\xe9bec"}},"coordinates":{"name":"Coordinates","coord":"Geographic (longitude, latitude)","coordDMS":"Geographic (longitude, latitude) (DMS)","radius":"Radius","conf":"Confidence"},"menu.tooltip":"Search Options","settings":{"title":"Settings"},"pointerSearchSummary":{"title":"Pointer position","tooltip":"Based on every search source, show the summary of the pointer location. Use F2 to activate/deactivate."},"searchResultsGeometry":{"title":"Show results geometries","tooltip":"Hide/ show the results geometries "},"searchSources":{"selectAll":"Select All","unselectAll":"Unselect All","settings":{"results type":"Results type","ecmax":"Maximum deviation","radius":"Search radius","results limit":"Number of results","multiple object":"Multiple object","restrictExtent":"Restrict the extent","selectAll":"Select All","unselectAll":"Unselect All","true":"Yes","false":"No"}},"displayMoreResults":"Display more results"},"geometry":{"geometry":"Geometry","point":"Point","line":"Line","polygon":"Polygon"},"targetHtmlUrl":"Open the external link","searchByCoord":"Search by coordinates","searchByName":"Search by name","seeRouting":"See routing","timeFilter":{"date":"Date","endDate":"End Date","startDate":"Start Date","hour":"Hour","minute":"Minute","endYear":"End Year","startYear":"Start Year"},"spatialFilter":{"spatialFilter":"Spatial filter","predefined":"Predefined Zone","draw":"Draw","polygon":"Polygon","point":"Circle","drawPolygon":"Draw a polygon","drawCircle":"Draw a circle","searchLabel":"Search by","buffer":"Buffer","search":"Search","drawControl":"Activate draw control","listLabel":"Zone","layer":"Layer","goSearch":"Launch research","removeLayer":"Remove results","exportLayer":"Export results","clearForm":"Remove draw","clearSearch":"Reset field","Address":"Addresses","Thematics":"Thematics","searchResults":"Search Results","showSearchResults":"Show search results","hideSearchResults":"Hide search results","type":"Type","radius":"Radius","radiusAlert":"Radius must be between 0 and 100 kilometers (or 100 000 meters)","bufferAlert":"Buffer must be between 0 and 100 kilometers (or 100 000 meters)","maxSizeAlert":"Search results number exceeds 10000. Some may be missing.","zeroResults":"There are no results for this search.","warning":"Warning","freehandControl":"Freehand","group":{"toponyme":"Toponym","culturel":"Cultural","education":"Education","sante":"Health","securite":"Security","sepaq":"SEPAQ","transport":"Transportation"}},"terrapi":{"AdmRegion":"Administratives region","Mun":"Municipalities","Arrond":"Boroughs","CircFed":"Federals districts","CircProv":"Provincials districts","DirReg":"Regionals directorates","MRC":"RCM","RegTour":"Touristics regions","limites":"Administrative boundaries","bornes":"Landmarks","hydro":"Hydrography","routes":"Roads","bati":"Buildings","batiment":"Buildings","camping":"Camping","equipement":"Equipment","commun":"Public","geographie":"Natural sites","parc":"Parks","secteur":"Sector","immeubles":"Tenement","sites":"Cultural sites","cpe":"Children\'s education center","public":"Public schools","prive":"Private school","gouvernemental":"Government schools","colleges":"Colleges","universites":"University","aine":"Residences for seniors","ambulance":"Ambulance zones","clinique":"Clinics","etabl":"Health institutions","gmf":"Family doctors group","naissance":"Birth house","pharmacie":"Pharmacy","casernes":"Fire stations","correctionnel":"Correctional centres","organisme":"Security organization","palais-justice":"Courthouses","penitencier-fed":"Federal penitentiaries","penitencier-prov":"Provincial penitentiaries","polices":"Police station"},"measure":{"dialog":{"title":"Sum of the selection","length.title":"Length","area.title":"Area","lengthInMeters":"m","lengthInKilometers":"km","lengthInMiles":"mi","lengthInFeet":"ft","areaInSquareMeters":"m\xb2","areaInSquareKilometers":"km\xb2","areaInSquareMiles":"mi\xb2","areaInHectares":"ha","areaInAcres":"ac","perimeterInMeters":"Perimeter in meters"},"layerTitle":"Measure on map","area":"Area","areaHeader":"Area","length":"Length","lengthHeader":"Length / Perimeter","perimeter":"Perimeter","meters":"m","m":"m","kilometers":"km","km":"km","miles":"mi","mi":"mi","feet":"ft","ft":"ft","squareMeters":"m\xb2","m\xb2":"m\xb2","squareKilometers":"km\xb2","km\xb2":"km\xb2","squareMiles":"mi\xb2","mi\xb2":"mi\xb2","squareFeet":"ft\xb2","ft\xb2":"ft\xb2","hectares":"ha","ha":"ha","acres":"ac","ac":"ac","toggleActive":"Activate measures","toggleDisplayLines":"Display distances of lines","toggleDisplayDistance":"Display distances of areas","toggleDisplayAreas":"Display areas","toggleAutoUnits":"Auto Units","actionbar":{"calculate.tooltip":"Totals & Conversions","delete.tooltip":"Delete","modify.tooltip":"Modify"}},"draw":{"abort":"Abort current drawing","cancelColorPicker":"Cancel","Circle":"Circle","colorPicker":"Click to open the color picker","dialogInstruction":"Enter your draw\'s label","dialogTitle":"Label","delete":"Remove Drawings from map","drawing":"Draws","fill":"Fill","finish":"Finish current drawing","icon":"Icons","labels":"Labels","LineString":"Line","move":"Center view on cursor","noIcon":"No icon","noLabel":"No label","Point":"Point","Polygon":"Polygon","radius":"Radius","shortcuts":"Keyboard shortcuts","stroke":"Stroke","styleSelect":"Select style","toggleMapTooltips":"Show map tooltips","undo":"Remove last vertex"},"network":{"online":{"message":"Online","title":"Status:"},"offline":{"message":"Offline","title":"Status:"}},"workspace":{"deleteConfirmation":"Do you really want to delete this entity?","addConfirmation":"Do you really wish to add an entity?","modifyConfirmation":"Do you really wish to modify this entity?","deleteSuccess":"Entity has been deleted.","addSuccess":"Entity has been added.","modifySuccess":"Entity has been modified.","deleteError":"An error has occured. Entity could not be deleted.","addError":"An error has occured. Entity could not be added.","modifyError":"An error has occured. Entity could not be modified.","cancel":"Cancel","inMapExtent.active.tooltip":"Ne montrer que les entit\xe9s contenues dans la carte","inMapExtent.inactive.tooltip":"Montrer tous les entit\xe9s"},"formValidation":{"mandatory":"{{column}} is mandatory","minValue":"{{column}} is smaller than {{value}}","maxValue":"{{column}} is bigger than {{value}}","minLength":"{{column}} is shorter than {{value}} characters","maxLength":"{{column}} is longer than {{value}} characters"}}}}')},32766:function(e){"use strict";e.exports=JSON.parse('{"igo":{"integration":{"tools":{"catalog":"Catalog","contexts":"Contexts","directions":"Directions","draw":"Draw","importExport":"Import & Export","ogcFilter":"Filter by","map":"Map","layers":"Layers","legend":"Legend","measurer":"Measure","print":"Print","searchResults":"Search Results","shareMap":"Share","timeFilter":"Time Filter","about":"About","spatialFilter":"Spatial Filter","advancedMap":"Advanced map tools"},"searchResultsTool":{"noResults":"No results","doSearch":"","examples":"<b>Search for addresses, locations, coordinates and layers using the search bar</b>.<br><br><u>Address</u> searches can be made with a combination of: <ul><li>building number</li><li>street name</li><li>city name</li><li>postal code</li></ul> <u>Location</u> search examples: <ul><li>Lac Poulin</li><li>Mcdo L\xe9vis</li><li>Saint-Isidore</li></ul> You can also use keywords to refine your search. Examples: <ul><li>#mun qu\xe9bec (to search for municipalities)</li><li>#sante L\xe9vis (to search for health establishments)</li><li>#cpe joyeux (to search for daycares)</li><li>#intersection li\xe9gois + \xe9glise (to search for an intersection, the #+ can also be used)</li></ul>*Keywords appear as tooltips when hovering the results type in the \'ICherche\' search options -> iCherche -> Results types.<br><br><u>Coordinate</u> search examples:<ul><li>Decimal degrees- DD (-68.165547, 48.644546)</li><li>Degrees, minutes and seconds- DMS(-68 9 56, 48 38 40)</li><li>Degrees and decimal minutes- DMM(-68 9.56, 48 38.40)</li><li>Projected (UTM-19 561466.861, 5388278.862)</li><li>BELL (Lat: 48 38 40N Long: 68 9 56W UNC:100 CONF:90)</li><li>Meter Meter (111594.63, 445854.74;32198)</li></ul>For more information on coordinate search : <a href=\'https://igo2.readthedocs.io/fr/next/properties.html#coordonnees\' target=\'_blank\'>Consult IGO2\'s documentation</a>","zoomOnFeatureTooltip":"Zoom on selected feature.","zoomOnFeatureTooltipOutOfView":"The feature is out of view. Zoom on selected feature."},"aboutTool":{"headerHtml":"","html":"<style>#about .bold_class{font-weight: bold;}#about .red{color: red;}#about .tool_name{border-top: 1px solid; padding-top: 10px;}#about .titre_outil{font-weight: bold; font-size: 18px; padding-bottom: 8px;}#about .subtitle{font-size: 20px; padding-bottom: 10px;}#about .align_right{text-align: right;}#about .describe{text-align: justify;}#about a img{color: black; text-decoration: none;}</style><body> <div id=\'about\'> <div class=\'bold_class subtitle\'>Features overview</div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z\'> </path> </svg></mat-icon> Search Bar </div><div class=\'describe\'>Located in the upper-left portion of the interface, the <span class=\'bold_class\'>Search Bar</span> allows the user to locate an area of interest using an address, location or GPS coordinates. It can also be used to search for a layer. <br><br> It is also possible to search for a specific element using the hashtag \\"#\\" (for example, #municipalites qu\xe9bec). Accents and capital letters don\'t have any impact on <span class=\'bold_class\'>Search Results</span> when using a hashtag. </div></div><br><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z\'></path> </svg></mat-icon> Contexts </div><div class=\'describe\'> <span class=\'bold_class\'>Contexts</span> are used to visualize groupings of layers related to a specific theme. When a context is selected, all the layers associated with it will be added to the <span class=\'bold_class\'>Map</span>. It is then possible to add other layers to the map by using the <span class=\'bold_class\'>Catalog</span> or the <span class=\'bold_class\'>Search Bar</span>. <br><br><div class=\'red\'> <span class=\'bold_class\'>WARNING :</span> If a new context is selected, all the layers displayed on the <span class=\'bold_class\'>Map</span> will be replaced by the ones associated with the newly selected context. <br><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M15,19L9,16.89V5L15,7.11M20.5,3C20.44,3 20.39,3 20.34,3L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21C3.55,21 3.61,21 3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3Z\'> </path> </svg></mat-icon> Map </div><div class=\'describe\'>It is possible to personalize the <span class=\'bold_class\'>Map</span> by using the <span class=\'bold_class\'>Catalog</span> or the <span class=\'bold_class\'>Search Bar</span>. This space allows the user to add, delete, interrogate, filter and sort the displayed layers. It is also possible to visualize the legends associated with the layers. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M2 4C2 2.89 2.9 2 4 2H7V4H4V7H2V4M22 4V7H20V4H17V2H20C21.1 2 22 2.89 22 4M2 20V17H4V20H7V22H4C2.9 22 2 21.11 2 20M10 2H14V4H10V2M10 20H14V22H10V20M2 10H4V14H2V10M18.5 13C20.4 13 22 14.6 22 16.5C22 19.1 18.5 23 18.5 23C18.5 23 15 19.1 15 16.5C15 14.6 16.6 13 18.5 13M18.5 17.8C19.2 17.8 19.8 17.2 19.7 16.6C19.7 16 19.1 15.4 18.5 15.4C17.9 15.4 17.3 15.9 17.3 16.6C17.3 17.2 17.8 17.8 18.5 17.8M20 10H22V12.34C21.42 11.84 20.74 11.45 20 11.23V10Z\'> </path> </svg></mat-icon> Spatial Filter </div><div class=\'describe\'> The <span class=\'bold_class\'>Spatial Filter</span> can be used to search for adresses or themes by specifying a predefined zone (for example, electoral districts) or by drawing an area on the map. The results can then be exported by using the <span class=\'bold_class\'>Import & Export</span> tool. </div></div><br><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M1.39,18.36L3.16,16.6L4.58,18L5.64,16.95L4.22,15.54L5.64,14.12L8.11,16.6L9.17,15.54L6.7,13.06L8.11,11.65L9.53,13.06L10.59,12L9.17,10.59L10.59,9.17L13.06,11.65L14.12,10.59L11.65,8.11L13.06,6.7L14.47,8.11L15.54,7.05L14.12,5.64L15.54,4.22L18,6.7L19.07,5.64L16.6,3.16L18.36,1.39L22.61,5.64L5.64,22.61L1.39,18.36Z\'> </path> </svg></mat-icon> Measure </div><div class=\'describe\'>This tool gives the option to either <span class=\'bold_class\'>Measure</span> distances or areas on the map.</div><br></div><div class=\'tool_name\'><div class=\'titre_outil\'><mat-icon class=\'mat-icon\'><svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'><path d=\'M9.75 20.85C11.53 20.15 11.14 18.22 10.24 17C9.35 15.75 8.12 14.89 6.88 14.06C6 13.5 5.19 12.8 4.54 12C4.26 11.67 3.69 11.06 4.27 10.94C4.86 10.82 5.88 11.4 6.4 11.62C7.31 12 8.21 12.44 9.05 12.96L10.06 11.26C8.5 10.23 6.5 9.32 4.64 9.05C3.58 8.89 2.46 9.11 2.1 10.26C1.78 11.25 2.29 12.25 2.87 13.03C4.24 14.86 6.37 15.74 7.96 17.32C8.3 17.65 8.71 18.04 8.91 18.5C9.12 18.94 9.07 18.97 8.6 18.97C7.36 18.97 5.81 18 4.8 17.36L3.79 19.06C5.32 20 7.88 21.47 9.75 20.85M20.84 5.25C21.06 5.03 21.06 4.67 20.84 4.46L19.54 3.16C19.33 2.95 18.97 2.95 18.76 3.16L17.74 4.18L19.82 6.26M11 10.92V13H13.08L19.23 6.85L17.15 4.77L11 10.92Z\'></path></svg></mat-icon> Draw </div><div class=\'describe\'> The <span class=\'bold_class\'>Draw</span> tool can be used to draw points, lines, polygons or circles with labels. The color of the fill and the stroke can be set with the given selectors. <br><br> A Drawings layer can be exported by using the <span class=\'bold_class\'>Import & Export</span> tool. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M14,14.5V12H10V15H8V11A1,1 0 0,1 9,10H14V7.5L17.5,11M21.71,11.29L12.71,2.29H12.7C12.31,1.9 11.68,1.9 11.29,2.29L2.29,11.29C1.9,11.68 1.9,12.32 2.29,12.71L11.29,21.71C11.68,22.09 12.31,22.1 12.71,21.71L21.71,12.71C22.1,12.32 22.1,11.68 21.71,11.29Z\'> </path> </svg></mat-icon> Directions </div><div class=\'describe\'> It is possible to build a route and get <span class=\'bold_class\'>Directions</span> between two points by placing them on the map or by searching for addresses. It is also possible to add stops and copy the description or the link of the route to the clipboard.</div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M17,14H19V17H22V19H19V22H17V19H14V17H17V14M11,16L2,9L11,2L20,9L11,16M11,18.54L12,17.75V18C12,18.71 12.12,19.39 12.35,20L11,21.07L2,14.07L3.62,12.81L11,18.54Z\'></path> </svg></mat-icon> Catalog </div><div class=\'describe\'> The <span class=\'bold_class\'>Catalog</span> contains all the layers that can be added to the <span class=\'bold_class\'>Map</span>. Click on the + of desired layer to add it. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M14,17H18V14L23,18.5L18,23V20H14V17M13,9H18.5L13,3.5V9M6,2H14L20,8V12.34C19.37,12.12 18.7,12 18,12A6,6 0 0,0 12,18C12,19.54 12.58,20.94 13.53,22H6C4.89,22 4,21.1 4,20V4A2,2 0 0,1 6,2Z\'></path> </svg></mat-icon> Import & Export </div><div class=\'describe\'> It is possible to <span class=\'bold_class\'>Import</span> vector data by specifying a coordinate system or a projection. <br><br> It is possible to <span class=\'bold_class\'>Export</span> one or many layers in multiple formats. <br><br> It is also possible to <span class=\'bold_class\'>Import</span> or <span class=\'bold_class\'>Export</span> a context locally. This feature is useful to save contexts when the user is not authenticated. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z\'></path> </svg></mat-icon> Print </div><div class=\'describe\'>This tool is used to <span class=\'bold_class\'>Print</span> the map displayed on-screen. Multiple options can be specified like a title, a comment, the output format, the paper size and the orientation. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M18,16.08C17.24,16.08 16.56,16.38 16.04,16.85L8.91,12.7C8.96,12.47 9,12.24 9,12C9,11.76 8.96,11.53 8.91,11.3L15.96,7.19C16.5,7.69 17.21,8 18,8A3,3 0 0,0 21,5A3,3 0 0,0 18,2A3,3 0 0,0 15,5C15,5.24 15.04,5.47 15.09,5.7L8.04,9.81C7.5,9.31 6.79,9 6,9A3,3 0 0,0 3,12A3,3 0 0,0 6,15C6.79,15 7.5,14.69 8.04,14.19L15.16,18.34C15.11,18.55 15.08,18.77 15.08,19C15.08,20.61 16.39,21.91 18,21.91C19.61,21.91 20.92,20.61 20.92,19A2.92,2.92 0 0,0 18,16.08Z\'> </path> </svg></mat-icon> Share</div><div class=\'describe\'> The <span class=\'bold_class\'>Share</span> tool is used to create an URL that redirects to an exact representation of the map. This link can be shared or distributed in a document and allows the user to \\"save\\" the map for later use. </div><br></div><div class=\'tool_name\'> <p> <a href=\'http://igouverte.org/\' target=\'_blank\'><img src=\'./assets/igo2/core/logo.png\' alt=\'IGO\' height=32>IGO2</a> is a open source geospatial solution developed by collaborators and specialists from several departments and agencies of the Government of Quebec. <p> Version: {{version.lib}}</p></div>","trainingGuide":"Training guide","trainingGuideTooltip":"Click here to access IGO2\'s self-training guide"},"mapTool":{"empty":"No layer is currently active on this map. ","customize":"Customize it by adding layer from the : ","search-tool":"Search tool","catalog-tool":"Data catalog","context-tool":"Context manager","noLayersVisible":"There is no visible layers.","noLayersInRange":"There is no visible layers at the current scale. Please zoom in or out to discover theses layers."},"importExportTool":{"importExportData":"Layer","importExportContext":"Context"},"workspace":{"toggleWorkspace":"Open/Close the table view","ogcFilter.close":"Close","ogcFilter.title":"Filters","ogcFilter.tooltip":"Apply filters","download.title":"Download","download.tooltip":"Download","inMapExtent.title":"Show records contained in map","inMapExtent.active.tooltip":"Show records contained in map","inMapExtent.inactive.tooltip":"Show all records","zoomAuto.title":"Zoom auto","zoomAuto.tooltip":"Zoom auto","selected.title":"Show selected records only","selected.tooltip":"Show selected records only","clearSelection.title":"Deselect all","clearSelection.tooltip":"Deselect all records","maximize":"Extend","maximizeTooltip":"Extend panel","standardExtent":"Reduce","standardExtentTooltip":"Reduce panel"},"directions":{"warning":{"title":"Warning","message":"The route proposed in this tool does not take into account current road conditions, road congestion, obstacles present on the network and ferry schedules (daily and seasonal opening)."}},"advanced-map-tool":{"advanced-swipe":{"swipe-select":"select the layers for swiping","selectAll":"Select all","empty":"No layer is currently active on this map. ","customize":"Customize it by adding layer from the : ","search-tool":"Search tool","catalog-tool":"Data catalog","context-tool":"Context manager","swipe":"Swipe","swipe-tool":"Swipe-Tool"},"advanced-coordinates":{"copy":"Copy coordinates","lon":"Longitude","lat":"Latitude","est":"Est","nord":"North","coordinates":"Coordinates","copyMsg":"Coordinates copied to clipboard","copyTitle":"Coordinates of cetre","center":"Center","coordSystem":"Systeme of coordinates","zoom":"Current zoom level: ","scale":"Current scale: ","resolution":"Current resolution: "}}}}}')},10503:function(e){"use strict";e.exports=JSON.parse('{"igo":{"auth":{"accessAnonymous":"Access as anonymous","connection":"Connection","login":"Login","password":"Password","signOut":"Sign out","user":"User","welcome":"Welcome {{name}}!","deconnection":"You are logged out.","home":"Return to the home page","error":{"Password expired":"Password expired","Maximun logins exceeded":"Maximum logins exceeded","Login lockout":"Maximum number of attempts exceeded. Your account is locked.","Wrong password":"Wrong password","Invalid username":"Invalid username"},"microsoft":{"login":"Sign in with Azure account"},"microsoftb2c":{"login":"Sign in"}},"common":{"confirmDialog":{"cancelBtn":"Cancel","confirmBtn":"Confirm","title":"Confirm"},"table":{"filter":"Filter"},"entity-table":{"targetHtmlUrl":"Open the external link"},"form":{"errors":{"required":"This field is required"}},"actionbar":{"scrollUp":"Scroll up","scrollDown":"Scroll down","icon":"Action list"},"interactiveTour":{"tooltipTourToolButton":"Interactive tour of the application","disaledTooltipTourToolButton":"To have access to this tool\'s tour, add contexts or layers","buttonTitle":"Discover","exitButton":"Exit","backButton":"Back","nextButton":"Next"},"paginator":{"firstPageLabel":"First page","itemsPerPageLabel":"Items per page:","lastPageLabel":"Last page","nextPageLabel":"Next page","previousPageLabel":"Previous page","of":"of"}},"context":{"bookmarkButton":{"create":"Create a new context","dialog":{"createMsg":"The context \'{{value}}\' was created","createTitle":"Context created","placeholder":"Title","title":"New context"}},"contextManager":{"clone":"Clone this context","delete":"Delete this context","dialog":{"cloneMsg":"The context \'{{value}}\' was cloned","cloneTitle":"Context cloned","copyMsg":"Text copied","copyTitle":"Context ID","confirmDelete":"Are you sure you want to delete this context?","deleteMsg":"The context \'{{value}}\' was deleted","deleteTitle":"Context deleted","favoriteMsg":"The context \'{{value}}\' was set as favorite","favoriteTitle":"Favorite saved","saveMsg":"The context \'{{value}}\' was saved","saveTitle":"Context saved"},"edit":"Edit this context","errors":{"uncaught":{"message":"Sorry, service is currently not available. Please try again later","title":"Error server"},"addPermission":"The permission you are trying to add is already in the context.","addPermissionEmpty":"The permission you are trying to add is not valid","addPermissionTitle":"Add permission error"},"favorite":"Set as favorite context","form":{"copy":"Copy the context ID","edit":"Save","title":"Title","titleRequired":"Title required","uri":"ID","uriRequired":"ID required"},"invalid":{"text":"Context \'{{value}}\' is invalid. The default context was loaded.","title":"Invalid context"},"managePermissions":"Manage permissions context","manageTools":"Manage tools context","ourContexts":"Our contexts","publicContexts":"Public contexts","save":"Save this context","sharedContexts":"Shared contexts","filterPlaceHolder":"Filter by name","sortAlphabetically":"Sort alphabetically","sortContextOrder":"Replace according to the creation date","userAccount":"User account","filterUser":"Filter by user group","emptyContext":"Empty context","emptyContextTooltip":"Create a new empty context","contextMap":"Context from map","contextMapTooltip":"Create a new context from map layers","hide":"Hide this context","show":"Show up this context","showHidden":"Show hidden contexts"},"contextImportExport":{"export":{"exportPlaceHolder":"Layers","exportContextName":"Context name","exportSelectAll":"Select all","success":{"text":"Context has been exported.","title":"Context export success"},"nothing":{"text":"No context could be exported.","title":"Nothing to export"},"failed":{"text":"Failed to export","title":"Failed to export context"}},"import":{"success":{"title":"Imported context","text":"The context \'{{value}}\' was added to the map"},"empty":{"text":"The context \'{{value}}\' contained nothing that could be imported.","title":"Nothing to import"},"invalid":{"text":"The context \'{{value}}\' is invalid.","title":"Invalid context"},"unreadable":{"title":"Unreadable context","text":"The context \'{{value}}\' is unreadable"},"tooLarge":{"text":"The context \'{{value}}\' is too large (Max: {{size}} MB)","title":"Context too large"}}},"permission":{"addBtn":"Add","delete":"Remove permission","dialog":{"addMsg":"The permission \'{{value}}\' was added","addTitle":"Permission added","deleteMsg":"The permission \'{{value}}\' was removed","deleteTitle":"Permission removed","scopeChangedMsg":"The scope was changed to {{value}}","scopeChangedTitle":"Scope changed"},"profil":"Profil","user":"User or group","profilRequired":"Profil required","read":"Read only","readOnlyTitle":"Read-only context","readOnlyMsg":"You can only revoke permission if the context is shared directly to your username.","scope":{"private":"Private","protected":"Protected","shared":"Shared","public":"Public"},"write":"Read and Write"},"poiButton":{"create":"Create a new zone of interest","dialog":{"confirmDelete":"Are you sure you want to delete this zone of interest?","createMsg":"The zone of interest \'{{value}}\' was created","createTitle":"Zone of interest created","deleteMsg":"The zone of interest \'{{value}}\' was deleted","deleteTitle":"Zone of interest deleted","placeholder":"Title","title":"New zone of interest"},"placeholder":"Zones of interest"},"sidenav":{"goBack":"Go Back","mainMenu":"Main Menu"},"shareMap":{"button":"Share map","refreshBtn":"Refresh sharing","copy":"Copy to clipboard","shareWithApi":"Share by context","shareWithUrl":"Share by url","dialog":{"copyMsg":"Link copied to clipboard","copyTitle":"Link"},"errorTitle":"Share Map error","placeholderLink":"Link","included":"Included in shared URL :","context":"The context when creating the sharing link.","center":"The coordinates of the center of the map (longitude, latitude).","zoom":"The zoom level of the map.","addedLayers":"The layers added by the catalog or by the search bar.","visibleInvisible":"Visibility status of layers.","excluded":"Excluded in the shared URL :","order":"The order of the layers.","opacity":"Modifications made to the opacity of the layers.","filterOgc":"Additions / modifications made to filters by attribute.","filterTime":"The current value for time filters."},"tool":{"dialog":{"addMsg":"The tool \'{{value}}\' was added","addTitle":"Tool added","deleteMsg":"The tool \'{{value}}\' was removed","deleteTitle":"Tool removed"}},"userButton":{"dialog":{"email":"Email","expiration":"Expiration","user":"User","clearPreferences":"Clear my preferences"},"infoTitle":"User info","logout":"Logout"}},"core":{"message":{"success":"Success","error":"Error","info":"Info","alert":"Alert"},"errors":{"uncaught":{"message":"Sorry, service is currently not available. Please try again later","title":"Error server"}},"network":{"online":{"message":"Online","title":"Status:"},"offline":{"message":"Offline","title":"Status:"}}},"geo":{"catalog":{"layer.addToMap":"Add to map","layer.addToMapOutRange":"Add to map. The layer is not visible at the current scale. Please zoom in/out","layer.removeFromMap":"Remove from map","layer.removeFromMapOutRange":"Remove from map. The layer is not visible at the current scale. Please zoom in/out","group.addToMap":"Add all layers from this group to map","group.removeFromMap":"Remove all layers from this group to map","baseLayers":"Baselayers","unavailableTitle":"Catalog unavailable","unavailable":"The catalog \'{{value}}\' is unavailable at the moment or you don\'t have the required permissions.","someUnavailable":"Some of the layers from the current catalog are unavailable at the moment or you don\'t have the required permissions.","externalProvider":{"catalog":"This catalog comes from an external organization.","group":"This layers comes from an external organization.","layer":"This layer comes from an external organization.","unavailableWithEmail":"The catalog \'{{value}}\' is unavailable at the moment. To add an external service to the predefined list, please contact us at {{emailAddress}}. Delays can apply if problems occurs with the provider."},"library.add":"Add this catalog to the list","library.cancel":"Cancel","library.remove":"Remove this catalog from the list","library.inlist":{"title":"Catalog already contained","message":"The catalog is already contained in the list."},"library.addTitle":"Adding a catalog","library.addBtn":"Add a catalog"},"clickOnMap":{"clickedFeature":"Clicked Feature"},"baselayersSwitcher":{"title":"Basemaps"},"dataSource":{"unavailableTitle":"Layer unavailable","optionsApiUnavailable":"Layer information could not be retrieved. Some layers may not present the correct information.","unavailable":"The layer \'{{value}}\' is unavailable at the moment or you don\'t have the required permissions."},"dropGeoFile":{"invalid":{"text":"The file \'{{value}}\' is invalid ({{mimeType}})","title":"Invalid file"},"empty":{"text":"The file \'{{value}}\' contained nothing that could be imported.","title":"Nothing to import"},"success":{"text":"The layer \'{{value}}\' was added to the map","title":"Imported file"},"unreadable":{"text":"The file \'{{value}}\' is unreadable","title":"Unreadable file"},"tooLarge":{"text":"The file \'{{value}}\' is too large (Max: {{size}} MB)","title":"File too large"},"invalidSRS":{"text":"The projection is valid. It must start with EPSG:","title":"Invalid projection"},"ogreServer":{"title":"Ogre server error 500","text":"Error in convert to geojson. Maybe file is too big, try to import that file in geojson format"}},"export":{"customList":{"text":"Some of the selected layers ( {{value}} ) limit the format\'s list","title":"Restricted list of formats"},"nothing":{"text":"No feature could be exported.","title":"Nothing to export"},"noFormat":{"text":"No export format valid for all selected layers. Please export the layers one at a time.","title":"No valid format"},"failed":{"text":"Failed to export","title":"Failed to export features"},"popupBlocked":{"text":"</br>Enable the popup in your browser. </br>For Chrome and Edge, on the right into the Address Bar.</br>{{extraMessage}}","selectAgain":"Fix it and re-select an output format.","retry":"Please retry to export","title":"Popup blocked by your browser"},"success":{"text":"Features have been exported.","title":"Features export success"},"format":{"GeoJSON":"GeoJSON","GML":"GML","GPX":"GPX","KML":"KML","Shapefile":"Shapefile","CSVcomma":"CSV (comma delimited)","CSVsemicolon":"CSV (Excel compatible)","URL":"External link"},"gpx.error.poly":{"title":"GPX error","text":"GPX format do now allow polygon features"},"encoding":{"LATIN1":"LATIN-1","UTF8":"UTF-8"},"combinedLayers":"combinedLayers"},"importExportForm":{"exportButton":"Export","exportButtonLink":"Open the link","exportButtonLinks":"Open the links","exportCombineResults":"Combine layers into one file","exportFormatPlaceholder":"Format","exportLayerPlaceholder":"Layer","exportFileNamePlaceholder":"Filename","exportSeparator":"Insert separator (empty row) between layers","encodingPlaceholder":"Encoding","exportTabTitle":"Export","exportFeatureInExtent":"Export only features in map extent","exportNoLayersExportable":"There is no exportable layer in your map","exportSelectedFeature":"Export only selected features","importButton":"Import","importProjPlaceholder":"Coordinate system of the file to import","importTabTitle":"Import","importClarifications":"Clarifications","importSizeMax":"The file size limit is {{size}} Mb","importFormatAuthorized":"Formats authorized: geojson, kml, gpx, gml, shapefile","importShpZip":"Shapefiles must be zipped AND geometries stored in Latitude Longitude coordinate (EPSG:4326/WGS:84)","other":"other","others":"others","projections":{"mtm":"MTM zone {{zone}} ({{code}})","utm":"UTM zone {{zone}} ({{code}})","webMercator":"Web Mercator ({{code}})","nad83":"Lat-Long NAD83 ({{code}})","wgs84":"Lat-Long WGS84 ({{code}})","choose":"You must choose a projection for your input file."}},"operators":{"caseSensitive":"Case sensitive","And":"And","Or":"Or","PropertyIsEqualTo":"=","PropertyIsNotEqualTo":"!=","PropertyIsLike":"\u2248","PropertyIsGreaterThan":">","PropertyIsGreaterThanOrEqualTo":">=","PropertyIsLessThan":"<","PropertyIsLessThanOrEqualTo":"<=","PropertyIsBetween":"between","During":"during (temporal)","PropertyIsNull":"is null","Intersects":"intersects (spatial)","Within":"within (spatial)","Contains":"contains (spatial)","tooltip":{"And":"Logical operator between filters where both conditions must be true","Or":"Logical operator between filters where at least one (1) condition must be true","PropertyIsEqualTo":"Identical (case sensitive)","PropertyIsNotEqualTo":"Different(case sensitive)","PropertyIsLike":"Like Example: *road* Finds any values that have \'road\' in any position. road* Finds any values that begin by \'road\'. wildCard =\'*\', singleChar = \'.\' escapeChar = \'!\' (case sensitive)","PropertyIsGreaterThan":"Greater than","PropertyIsGreaterThanOrEqualTo":"Greater than or equal to ","PropertyIsLessThan":"Lesser than","PropertyIsLessThanOrEqualTo":"Lesser than or equal to","PropertyIsBetween":"Apply a range check between the lower and upper boundary (values are included)","During":"Apply a range check for time attributes","PropertyIsNull":"Return features where the attribute is null","Intersects":"Return features in geometric intersection with the provided geometry","Within":"Return feature which are completely contained by the provided geometry","Contains":"Return feature completely containing by the provided geometry"}},"sourceFields":{"selectField":"Choose a field"},"filter":{"resetFilters":"Reset default values","addFilter":"Add an empty filter to the current list","removeFilter":"Remove the current filter from the filters\'s list","toggleFilterState":"Enable/disable the current filter","refreshFilters":"Update this datasource with the active filter(s). To enable this button, the layer must be visible (or in the defined scale ranges) or you must modify the current filter.","layerFiltered":"This layer is currently filtered","layerFilterable":"This layer is filterable","filterBy":"Filter by","advancedOgcFilters":"Advanced filters","displayMoreResults":"Display more (+)","displayLessResults":"Display less (-)","placeholder":"Enter a value","placeholderSnrc":"Ex: 21L14","selectOperator":"Select an operator","sliderModeTitle":"Time slider","reportingDate":"Reporting date"},"spatialSelector":{"fixedExtent":"Fixed extent","btnSetExtent":"Define the extent of the spatial filter to the current view","snrc":"SNRC","selectFeature":"","drawFeature":""},"layer":{"hideLayer":"Hide Layer","lowerLayer":"Bring layer backward","hideSelectedLayers":"Hide selected layers","filterLowerLayer":"The backward movement is always done according to the order of the map!","filterPlaceholder":"Filter the layers list","activateSelectionMode":"Activate multiple selection mode","deactivateSelectionMode":"Deactivate multiple selection mode","tools":"Tools","selectAll":"Select all layers","deselectAll":"Deselect all layers","zoomLayer":"Zoom To Layer Extents","zoomLayers":"Zoom To Selected Layers Extents","opacity":"Opacity","raiseLayer":"Bring layer forward","filterRaiseLayer":"The forward movement is always done according to the order of the map!","moreOptions":"Layer\'s tools","removeLayer":"Remove this layer from the map","removeSelectedLayers":"Remove selected layers from the map","removeSelectedLayersRestriction":"Some selected layers cannot be removed","showFeaturesList":"Show features list","showLayer":"Show Layer","showSelectedLayers":"Show selected layers","subsetLayersListKeyword":"Subset the layers\'s list by title or type (wms, wfs,...)","deleteKeyword":"Delete the keyword","subsetLayersListOnlyVisible":"Subset the layers\'s list by visibility","subsetLayersListOnlyInRange":"Subset the layers\'s list by resolution range","sortAlphabetically":"Sort the layers\'s list alphabetically","sortMapOrder":"Sort the layers\'s list based on layer\'s order on the map","resetLayersList":"Remove the current applied filter to layers\'s list","trackFeature":"Track the feature","legend":{"default":"Default","loadingLegendText":"Loading legend","noLegendText":"No legend available for this layer","noLegendScale":"No legend available for this scale","selectStyle":"Select the style of the legend","showAll":"Show all legends (non visible and out of range)","noLayersVisibleWithShowAllButton":"No layer currently visible. Activate the button above to see all the legends.","noLayersVisibleWithShowAllButtonButZoom":"No layer currently visible. If you zoom in the map, some layers will appear OR activate the button above to see all the legends.","noLayersVisible":"No layers currently visible.","noLayersVisibleButZoom":"No layers currently visible. However, if you zoom in the map, some layers will appear."}},"download":{"action":"Download data","title":"Downloading file","start":"Started. Check the download progression in your browser","end":"Completed"},"mapButtons":{"baselayerSwitcher":"Change base layer","geolocate":"Geolocate","home-extent":"Go to the home map extent","offline":"Offline mode","online":"Online mode","zoomIn":"Zoom in ({{zoom}})","zoomOut":"Zoom out ({{zoom}})","resetRotation":"Set map to north","tipRotation":"Hold Alt and SHIFT while dragging on map to rotate the map."},"metadata":{"show":"Show metadata"},"printForm":{"corsErrorMessageBody":"Unable to print due to non-owned access rights","corsErrorMessageHeader":"Print","comment":"Comment","doZipFile":"Zip file","outputFormat":"Output format","paperFormat":"Paper format","paperFormats":{"A0":"33.1 X 46.8\\" (A0)","A1":"23.4 X 33.1\\" (A1)","A2":"16.5 X 23.5\\" (A2)","A3":"11.7 X 16.5\\" (A3)","A4":"8.3 X 11.7\\" (A4)","A5":"5.8 X 8.3\\" (A5)","Letter":"Letter","Legal":"Legal"},"imageFormat":"Image format","orientation":"Orientation","landscape":"Landscape","portrait":"Portrait","projection":"Projection","resolution":"Resolution","saveBtn":"Save","scale":"Scale","showProjection":"Show projection","showScale":"Show scale","title":"Title","subtitle":"Subtitle","legendPosition":"Legend Position","legendPositions":{"none":"No legend","topleft":"Top left corner of the map","topright":"Top right corner of the map","bottomleft":"Bottom left corner of the map","bottomright":"Bottom right corner of the map","newpage":"On a new page"}},"directionsForm":{"stopLayer":"Directions - stops","routeLayer":"Directions - route","start":"Start","intermediate":"Intermediate","end":"End","directionsBtn":"Get route","resetDirectionsBtn":"Reset","zoomRoute":"Zoom on route","null":"","directions":"Directions","raiseStop":"Raise stop\'s priority","lowerStop":"Lower stop\'s priority","addStop":"Add a stop","clearStop":"Clear this stop","moveStop":"Move this stop","removeStop":"Remove this stop","drivingOptions":"Options","summary":"Direction\'s summary","stopsList":"Stops\'s list","instructions":"Instructions","copy":"Copy directions","geolocate":"Use current localisation as stop","link":"Link","dialog":{"copyMsg":"Directions copied to clipboard","copyMsgLink":"Link for directions copied to clipboard","copyTitle":"Directions"}},"directions":{"uturn":"u-turn","sharp right":"sharp right","right":"right","slight right":"slightly on right","sharp left":"sharp left","left":"left","slight left":"slightly on left","straight":"forward","turn":{"straight":"Continue on {{route}}","uturn":"Make u-turn on {{route}}","else":"Turn {{translatedModifier}} onto {{route}}"},"new name":"Head {{translatedDirection}} on {{route}}","depart":"Head {{translatedDirection}} on {{route}}","arrive":{"lastStep":"You have reached your destination {{coma}} {{aggregatedDirection}}","intermediate":"You have reached the intermediate stop onto {{route}}"},"merge":"Continue on {{route}}","on ramp":"Take the ramp {{aggregatedDirection}}","off ramp":"Take exit {{aggregatedDirection}}","fork":{"left":"Merge left onto {{route}}","right":"Merge right onto {{route}}","else":"Continue on {{route}}"},"end of road":"At the end of the road, turn {{translatedModifier}} onto {{route}}","use lane":"Take the lane ...","continue":{"notUturn":"Continue on {{route}}"},"roundabout":"At the roundabout, take the {{exit}}{{cntSuffix}} exit towards {{route}}","rotary":"Roundabout rotary ...","roundabout turn":"Roundabout, take the ...","exit roundabout":"Continue to {{route}}","notification":"notification ...","uturnText":"Make u-turn and head {{translatedDirection}} on {{route}}","unknown":"???","cntSuffix":{"first":"st","secondAndMore":"rd"},"modifier":{"prefix":"on the "}},"cardinalPoints":{"n":"north","ne":"northeast","e":"east","se":"southeast","s":"south","sw":"southwest","w":"west","nw":"northwest"},"search":{"placeholder":"Search for a localisation or a layer","emptyType.placeholder":"Please choose a search type","feature.title":"Localisation","feature.placeholder":"Search for a place localisation","layer.title":"Layer","layer.placeholder":"Search for a layer","ichercheReverse.name":"Search by coordinates","ilayer":{"name":"Layers","properties":{"abstract":"Abstract","groupTitle":"Group","title":"Title","type":"Type","url":"URL","metadataUrl":"Metadata","name":"Layer name","urlInfo":"URL - WMS/WFS","downloadUrl":"Data download"},"type":{"layer":"Layer","groupLayer":"Group of layers"}},"nominatim":{"type":{"food":"Food","health":"Health","entertainment":"Entertainment","finance":"Finance"},"country":{"all":"The world","canada":"Canada"}},"icherche":{"name":"iCherche","type":{"address":"Address","oldAddress":"Old address","district":"District","postalCode":"Postal Code","city":"City","oldCity":"Old city","mrc":"MRC","regadmin":"Administrative Region","road":"Road","intersection":"Intersection","place":"Place","exit":"Highway exit","cn":"CN mark","gcc":"Coast Guard mark (CCG)","sumi":"SUMI mark","km":"Mileage mark","hq":"Hydro-Quebec","entreprise":"Entreprise","cadastre":"Cadastre"},"restrictExtent":{"map":"\xc0 l\'\xe9tendue de la carte","quebec":"Au Qu\xe9bec"}},"coordinates":{"name":"Coordinates","coord":"Geographic (longitude, latitude)","coordDMS":"Geographic (longitude, latitude) (DMS)","radius":"Radius","conf":"Confidence"},"menu.tooltip":"Search Options","settings":{"title":"Settings"},"pointerSearchSummary":{"title":"Pointer position","tooltip":"Based on every search source, show the summary of the pointer location. Use F2 to activate/deactivate."},"searchResultsGeometry":{"title":"Show results geometries","tooltip":"Hide/ show the results geometries "},"searchSources":{"selectAll":"Select All","unselectAll":"Unselect All","settings":{"results type":"Results type","ecmax":"Maximum deviation","radius":"Search radius","results limit":"Number of results","multiple object":"Multiple object","restrictExtent":"Restrict the extent","selectAll":"Select All","unselectAll":"Unselect All","true":"Yes","false":"No"}},"displayMoreResults":"Display more results"},"geometry":{"geometry":"Geometry","point":"Point","line":"Line","polygon":"Polygon"},"targetHtmlUrl":"Open the external link","searchByCoord":"Search by coordinates","searchByName":"Search by name","seeRouting":"See routing","timeFilter":{"date":"Date","endDate":"End Date","startDate":"Start Date","hour":"Hour","minute":"Minute","endYear":"End Year","startYear":"Start Year"},"spatialFilter":{"spatialFilter":"Spatial filter","predefined":"Predefined Zone","draw":"Draw","polygon":"Polygon","point":"Circle","drawPolygon":"Draw a polygon","drawCircle":"Draw a circle","searchLabel":"Search by","buffer":"Buffer","search":"Search","drawControl":"Activate draw control","listLabel":"Zone","layer":"Layer","goSearch":"Launch research","removeLayer":"Remove results","exportLayer":"Export results","clearForm":"Remove draw","clearSearch":"Reset field","Address":"Addresses","Thematics":"Thematics","searchResults":"Search Results","showSearchResults":"Show search results","hideSearchResults":"Hide search results","type":"Type","radius":"Radius","radiusAlert":"Radius must be between 0 and 100 kilometers (or 100 000 meters)","bufferAlert":"Buffer must be between 0 and 100 kilometers (or 100 000 meters)","maxSizeAlert":"Search results number exceeds 10000. Some may be missing.","zeroResults":"There are no results for this search.","warning":"Warning","freehandControl":"Freehand","group":{"toponyme":"Toponym","culturel":"Cultural","education":"Education","sante":"Health","securite":"Security","sepaq":"SEPAQ","transport":"Transportation"}},"terrapi":{"AdmRegion":"Administratives region","Mun":"Municipalities","Arrond":"Boroughs","CircFed":"Federals districts","CircProv":"Provincials districts","DirReg":"Regionals directorates","MRC":"RCM","RegTour":"Touristics regions","limites":"Administrative boundaries","bornes":"Landmarks","hydro":"Hydrography","routes":"Roads","bati":"Buildings","batiment":"Buildings","camping":"Camping","equipement":"Equipment","commun":"Public","geographie":"Natural sites","parc":"Parks","secteur":"Sector","immeubles":"Tenement","sites":"Cultural sites","cpe":"Children\'s education center","public":"Public schools","prive":"Private school","gouvernemental":"Government schools","colleges":"Colleges","universites":"University","aine":"Residences for seniors","ambulance":"Ambulance zones","clinique":"Clinics","etabl":"Health institutions","gmf":"Family doctors group","naissance":"Birth house","pharmacie":"Pharmacy","casernes":"Fire stations","correctionnel":"Correctional centres","organisme":"Security organization","palais-justice":"Courthouses","penitencier-fed":"Federal penitentiaries","penitencier-prov":"Provincial penitentiaries","polices":"Police station"},"measure":{"dialog":{"title":"Sum of the selection","length.title":"Length","area.title":"Area","lengthInMeters":"m","lengthInKilometers":"km","lengthInMiles":"mi","lengthInFeet":"ft","areaInSquareMeters":"m\xb2","areaInSquareKilometers":"km\xb2","areaInSquareMiles":"mi\xb2","areaInHectares":"ha","areaInAcres":"ac","perimeterInMeters":"Perimeter in meters"},"layerTitle":"Measure on map","area":"Area","areaHeader":"Area","length":"Length","lengthHeader":"Length / Perimeter","perimeter":"Perimeter","meters":"m","m":"m","kilometers":"km","km":"km","miles":"mi","mi":"mi","feet":"ft","ft":"ft","squareMeters":"m\xb2","m\xb2":"m\xb2","squareKilometers":"km\xb2","km\xb2":"km\xb2","squareMiles":"mi\xb2","mi\xb2":"mi\xb2","squareFeet":"ft\xb2","ft\xb2":"ft\xb2","hectares":"ha","ha":"ha","acres":"ac","ac":"ac","toggleActive":"Activate measures","toggleDisplayLines":"Display distances of lines","toggleDisplayDistance":"Display distances of areas","toggleDisplayAreas":"Display areas","toggleAutoUnits":"Auto Units","actionbar":{"calculate.tooltip":"Totals & Conversions","delete.tooltip":"Delete","modify.tooltip":"Modify"}},"draw":{"abort":"Abort current drawing","cancelColorPicker":"Cancel","Circle":"Circle","colorPicker":"Click to open the color picker","dialogInstruction":"Enter your draw\'s label","dialogTitle":"Label","delete":"Remove Drawings from map","drawing":"Draws","fill":"Fill","finish":"Finish current drawing","icon":"Icons","labels":"Labels","LineString":"Line","move":"Center view on cursor","noIcon":"No icon","noLabel":"No label","Point":"Point","Polygon":"Polygon","radius":"Radius","shortcuts":"Keyboard shortcuts","stroke":"Stroke","styleSelect":"Select style","toggleMapTooltips":"Show map tooltips","undo":"Remove last vertex"},"network":{"online":{"message":"Online","title":"Status:"},"offline":{"message":"Offline","title":"Status:"}},"workspace":{"deleteConfirmation":"Do you really want to delete this entity?","addConfirmation":"Do you really wish to add an entity?","modifyConfirmation":"Do you really wish to modify this entity?","deleteSuccess":"Entity has been deleted.","addSuccess":"Entity has been added.","modifySuccess":"Entity has been modified.","deleteError":"An error has occured. Entity could not be deleted.","addError":"An error has occured. Entity could not be added.","modifyError":"An error has occured. Entity could not be modified.","cancel":"Cancel","inMapExtent.active.tooltip":"Ne montrer que les entit\xe9s contenues dans la carte","inMapExtent.inactive.tooltip":"Montrer tous les entit\xe9s"},"formValidation":{"mandatory":"{{column}} is mandatory","minValue":"{{column}} is smaller than {{value}}","maxValue":"{{column}} is bigger than {{value}}","minLength":"{{column}} is shorter than {{value}} characters","maxLength":"{{column}} is longer than {{value}} characters"}},"integration":{"tools":{"catalog":"Catalog","contexts":"Contexts","directions":"Directions","draw":"Draw","importExport":"Import & Export","ogcFilter":"Filter by","map":"Map","layers":"Layers","legend":"Legend","measurer":"Measure","print":"Print","searchResults":"Search Results","shareMap":"Share","timeFilter":"Time Filter","about":"About","spatialFilter":"Spatial Filter","advancedMap":"Advanced map tools"},"searchResultsTool":{"noResults":"No results","doSearch":"","examples":"<b>Search for addresses, locations, coordinates and layers using the search bar</b>.<br><br><u>Address</u> searches can be made with a combination of: <ul><li>building number</li><li>street name</li><li>city name</li><li>postal code</li></ul> <u>Location</u> search examples: <ul><li>Lac Poulin</li><li>Mcdo L\xe9vis</li><li>Saint-Isidore</li></ul> You can also use keywords to refine your search. Examples: <ul><li>#mun qu\xe9bec (to search for municipalities)</li><li>#sante L\xe9vis (to search for health establishments)</li><li>#cpe joyeux (to search for daycares)</li><li>#intersection li\xe9gois + \xe9glise (to search for an intersection, the #+ can also be used)</li></ul>*Keywords appear as tooltips when hovering the results type in the \'ICherche\' search options -> iCherche -> Results types.<br><br><u>Coordinate</u> search examples:<ul><li>Decimal degrees- DD (-68.165547, 48.644546)</li><li>Degrees, minutes and seconds- DMS(-68 9 56, 48 38 40)</li><li>Degrees and decimal minutes- DMM(-68 9.56, 48 38.40)</li><li>Projected (UTM-19 561466.861, 5388278.862)</li><li>BELL (Lat: 48 38 40N Long: 68 9 56W UNC:100 CONF:90)</li><li>Meter Meter (111594.63, 445854.74;32198)</li></ul>For more information on coordinate search : <a href=\'https://igo2.readthedocs.io/fr/next/properties.html#coordonnees\' target=\'_blank\'>Consult IGO2\'s documentation</a>","zoomOnFeatureTooltip":"Zoom on selected feature.","zoomOnFeatureTooltipOutOfView":"The feature is out of view. Zoom on selected feature."},"aboutTool":{"headerHtml":"","html":"<style>#about .bold_class{font-weight: bold;}#about .red{color: red;}#about .tool_name{border-top: 1px solid; padding-top: 10px;}#about .titre_outil{font-weight: bold; font-size: 18px; padding-bottom: 8px;}#about .subtitle{font-size: 20px; padding-bottom: 10px;}#about .align_right{text-align: right;}#about .describe{text-align: justify;}#about a img{color: black; text-decoration: none;}</style><body> <div id=\'about\'> <div class=\'bold_class subtitle\'>Features overview</div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z\'> </path> </svg></mat-icon> Search Bar </div><div class=\'describe\'>Located in the upper-left portion of the interface, the <span class=\'bold_class\'>Search Bar</span> allows the user to locate an area of interest using an address, location or GPS coordinates. It can also be used to search for a layer. <br><br> It is also possible to search for a specific element using the hashtag \\"#\\" (for example, #municipalites qu\xe9bec). Accents and capital letters don\'t have any impact on <span class=\'bold_class\'>Search Results</span> when using a hashtag. </div></div><br><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z\'></path> </svg></mat-icon> Contexts </div><div class=\'describe\'> <span class=\'bold_class\'>Contexts</span> are used to visualize groupings of layers related to a specific theme. When a context is selected, all the layers associated with it will be added to the <span class=\'bold_class\'>Map</span>. It is then possible to add other layers to the map by using the <span class=\'bold_class\'>Catalog</span> or the <span class=\'bold_class\'>Search Bar</span>. <br><br><div class=\'red\'> <span class=\'bold_class\'>WARNING :</span> If a new context is selected, all the layers displayed on the <span class=\'bold_class\'>Map</span> will be replaced by the ones associated with the newly selected context. <br><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M15,19L9,16.89V5L15,7.11M20.5,3C20.44,3 20.39,3 20.34,3L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21C3.55,21 3.61,21 3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3Z\'> </path> </svg></mat-icon> Map </div><div class=\'describe\'>It is possible to personalize the <span class=\'bold_class\'>Map</span> by using the <span class=\'bold_class\'>Catalog</span> or the <span class=\'bold_class\'>Search Bar</span>. This space allows the user to add, delete, interrogate, filter and sort the displayed layers. It is also possible to visualize the legends associated with the layers. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M2 4C2 2.89 2.9 2 4 2H7V4H4V7H2V4M22 4V7H20V4H17V2H20C21.1 2 22 2.89 22 4M2 20V17H4V20H7V22H4C2.9 22 2 21.11 2 20M10 2H14V4H10V2M10 20H14V22H10V20M2 10H4V14H2V10M18.5 13C20.4 13 22 14.6 22 16.5C22 19.1 18.5 23 18.5 23C18.5 23 15 19.1 15 16.5C15 14.6 16.6 13 18.5 13M18.5 17.8C19.2 17.8 19.8 17.2 19.7 16.6C19.7 16 19.1 15.4 18.5 15.4C17.9 15.4 17.3 15.9 17.3 16.6C17.3 17.2 17.8 17.8 18.5 17.8M20 10H22V12.34C21.42 11.84 20.74 11.45 20 11.23V10Z\'> </path> </svg></mat-icon> Spatial Filter </div><div class=\'describe\'> The <span class=\'bold_class\'>Spatial Filter</span> can be used to search for adresses or themes by specifying a predefined zone (for example, electoral districts) or by drawing an area on the map. The results can then be exported by using the <span class=\'bold_class\'>Import & Export</span> tool. </div></div><br><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M1.39,18.36L3.16,16.6L4.58,18L5.64,16.95L4.22,15.54L5.64,14.12L8.11,16.6L9.17,15.54L6.7,13.06L8.11,11.65L9.53,13.06L10.59,12L9.17,10.59L10.59,9.17L13.06,11.65L14.12,10.59L11.65,8.11L13.06,6.7L14.47,8.11L15.54,7.05L14.12,5.64L15.54,4.22L18,6.7L19.07,5.64L16.6,3.16L18.36,1.39L22.61,5.64L5.64,22.61L1.39,18.36Z\'> </path> </svg></mat-icon> Measure </div><div class=\'describe\'>This tool gives the option to either <span class=\'bold_class\'>Measure</span> distances or areas on the map.</div><br></div><div class=\'tool_name\'><div class=\'titre_outil\'><mat-icon class=\'mat-icon\'><svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'><path d=\'M9.75 20.85C11.53 20.15 11.14 18.22 10.24 17C9.35 15.75 8.12 14.89 6.88 14.06C6 13.5 5.19 12.8 4.54 12C4.26 11.67 3.69 11.06 4.27 10.94C4.86 10.82 5.88 11.4 6.4 11.62C7.31 12 8.21 12.44 9.05 12.96L10.06 11.26C8.5 10.23 6.5 9.32 4.64 9.05C3.58 8.89 2.46 9.11 2.1 10.26C1.78 11.25 2.29 12.25 2.87 13.03C4.24 14.86 6.37 15.74 7.96 17.32C8.3 17.65 8.71 18.04 8.91 18.5C9.12 18.94 9.07 18.97 8.6 18.97C7.36 18.97 5.81 18 4.8 17.36L3.79 19.06C5.32 20 7.88 21.47 9.75 20.85M20.84 5.25C21.06 5.03 21.06 4.67 20.84 4.46L19.54 3.16C19.33 2.95 18.97 2.95 18.76 3.16L17.74 4.18L19.82 6.26M11 10.92V13H13.08L19.23 6.85L17.15 4.77L11 10.92Z\'></path></svg></mat-icon> Draw </div><div class=\'describe\'> The <span class=\'bold_class\'>Draw</span> tool can be used to draw points, lines, polygons or circles with labels. The color of the fill and the stroke can be set with the given selectors. <br><br> A Drawings layer can be exported by using the <span class=\'bold_class\'>Import & Export</span> tool. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M14,14.5V12H10V15H8V11A1,1 0 0,1 9,10H14V7.5L17.5,11M21.71,11.29L12.71,2.29H12.7C12.31,1.9 11.68,1.9 11.29,2.29L2.29,11.29C1.9,11.68 1.9,12.32 2.29,12.71L11.29,21.71C11.68,22.09 12.31,22.1 12.71,21.71L21.71,12.71C22.1,12.32 22.1,11.68 21.71,11.29Z\'> </path> </svg></mat-icon> Directions </div><div class=\'describe\'> It is possible to build a route and get <span class=\'bold_class\'>Directions</span> between two points by placing them on the map or by searching for addresses. It is also possible to add stops and copy the description or the link of the route to the clipboard.</div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M17,14H19V17H22V19H19V22H17V19H14V17H17V14M11,16L2,9L11,2L20,9L11,16M11,18.54L12,17.75V18C12,18.71 12.12,19.39 12.35,20L11,21.07L2,14.07L3.62,12.81L11,18.54Z\'></path> </svg></mat-icon> Catalog </div><div class=\'describe\'> The <span class=\'bold_class\'>Catalog</span> contains all the layers that can be added to the <span class=\'bold_class\'>Map</span>. Click on the + of desired layer to add it. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M14,17H18V14L23,18.5L18,23V20H14V17M13,9H18.5L13,3.5V9M6,2H14L20,8V12.34C19.37,12.12 18.7,12 18,12A6,6 0 0,0 12,18C12,19.54 12.58,20.94 13.53,22H6C4.89,22 4,21.1 4,20V4A2,2 0 0,1 6,2Z\'></path> </svg></mat-icon> Import & Export </div><div class=\'describe\'> It is possible to <span class=\'bold_class\'>Import</span> vector data by specifying a coordinate system or a projection. <br><br> It is possible to <span class=\'bold_class\'>Export</span> one or many layers in multiple formats. <br><br> It is also possible to <span class=\'bold_class\'>Import</span> or <span class=\'bold_class\'>Export</span> a context locally. This feature is useful to save contexts when the user is not authenticated. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z\'></path> </svg></mat-icon> Print </div><div class=\'describe\'>This tool is used to <span class=\'bold_class\'>Print</span> the map displayed on-screen. Multiple options can be specified like a title, a comment, the output format, the paper size and the orientation. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M18,16.08C17.24,16.08 16.56,16.38 16.04,16.85L8.91,12.7C8.96,12.47 9,12.24 9,12C9,11.76 8.96,11.53 8.91,11.3L15.96,7.19C16.5,7.69 17.21,8 18,8A3,3 0 0,0 21,5A3,3 0 0,0 18,2A3,3 0 0,0 15,5C15,5.24 15.04,5.47 15.09,5.7L8.04,9.81C7.5,9.31 6.79,9 6,9A3,3 0 0,0 3,12A3,3 0 0,0 6,15C6.79,15 7.5,14.69 8.04,14.19L15.16,18.34C15.11,18.55 15.08,18.77 15.08,19C15.08,20.61 16.39,21.91 18,21.91C19.61,21.91 20.92,20.61 20.92,19A2.92,2.92 0 0,0 18,16.08Z\'> </path> </svg></mat-icon> Share</div><div class=\'describe\'> The <span class=\'bold_class\'>Share</span> tool is used to create an URL that redirects to an exact representation of the map. This link can be shared or distributed in a document and allows the user to \\"save\\" the map for later use. </div><br></div><div class=\'tool_name\'> <p> <a href=\'http://igouverte.org/\' target=\'_blank\'><img src=\'./assets/igo2/core/logo.png\' alt=\'IGO\' height=32>IGO2</a> is a open source geospatial solution developed by collaborators and specialists from several departments and agencies of the Government of Quebec. <p> Version: {{version.lib}}</p></div>","trainingGuide":"Training guide","trainingGuideTooltip":"Click here to access IGO2\'s self-training guide"},"mapTool":{"empty":"No layer is currently active on this map. ","customize":"Customize it by adding layer from the : ","search-tool":"Search tool","catalog-tool":"Data catalog","context-tool":"Context manager","noLayersVisible":"There is no visible layers.","noLayersInRange":"There is no visible layers at the current scale. Please zoom in or out to discover theses layers."},"importExportTool":{"importExportData":"Layer","importExportContext":"Context"},"workspace":{"toggleWorkspace":"Open/Close the table view","ogcFilter.close":"Close","ogcFilter.title":"Filters","ogcFilter.tooltip":"Apply filters","download.title":"Download","download.tooltip":"Download","inMapExtent.title":"Show records contained in map","inMapExtent.active.tooltip":"Show records contained in map","inMapExtent.inactive.tooltip":"Show all records","zoomAuto.title":"Zoom auto","zoomAuto.tooltip":"Zoom auto","selected.title":"Show selected records only","selected.tooltip":"Show selected records only","clearSelection.title":"Deselect all","clearSelection.tooltip":"Deselect all records","maximize":"Extend","maximizeTooltip":"Extend panel","standardExtent":"Reduce","standardExtentTooltip":"Reduce panel"},"directions":{"warning":{"title":"Warning","message":"The route proposed in this tool does not take into account current road conditions, road congestion, obstacles present on the network and ferry schedules (daily and seasonal opening)."}},"advanced-map-tool":{"advanced-swipe":{"swipe-select":"select the layers for swiping","selectAll":"Select all","empty":"No layer is currently active on this map. ","customize":"Customize it by adding layer from the : ","search-tool":"Search tool","catalog-tool":"Data catalog","context-tool":"Context manager","swipe":"Swipe","swipe-tool":"Swipe-Tool"},"advanced-coordinates":{"copy":"Copy coordinates","lon":"Longitude","lat":"Latitude","est":"Est","nord":"North","coordinates":"Coordinates","copyMsg":"Coordinates copied to clipboard","copyTitle":"Coordinates of cetre","center":"Center","coordSystem":"Systeme of coordinates","zoom":"Current zoom level: ","scale":"Current scale: ","resolution":"Current resolution: "}}}}}')},8555:function(e){"use strict";e.exports=JSON.parse('{"igo":{"auth":{"accessAnonymous":"Rester anonyme","connection":"Connexion","login":"Connecter","password":"Mot de passe","signOut":"Se d\xe9connecter","user":"Utilisateur","welcome":"Bienvenue {{name}}!","deconnection":"Vous \xeates d\xe9connect\xe9","home":"Retourner \xe0 la page d\'accueil","error":{"Password expired":"Votre mot de passe est expir\xe9","Maximun logins exceeded":"Nombre maximal de connexions d\xe9pass\xe9","Login lockout":"Nombre maximal d\'essai d\xe9pass\xe9. Votre compte est verrouill\xe9.","Wrong password":"Mot de passe incorrect","Invalid username":"Utilisateur invalide"},"google":{"login":"Se connecter avec Google","logged":"Connect\xe9 avec Google"},"microsoft":{"login":"Se connecter avec compte Azure"},"microsoftb2c":{"login":"Se connecter"}}}}')},20551:function(e){"use strict";e.exports=JSON.parse('{"igo":{"common":{"confirmDialog":{"cancelBtn":"Annuler","confirmBtn":"Confirmer","title":"Confirmation"},"table":{"filter":"Filtre"},"entity-table":{"targetHtmlUrl":"Ouvrir le lien externe"},"form":{"errors":{"required":"Ce champ est requis"}},"actionbar":{"scrollUp":"D\xe9filer vers le haut","scrollDown":"D\xe9filer vers le bas","icon":"Actions suppl\xe9mentaires"},"interactiveTour":{"tooltipTourToolButton":"Aide interactive sur l\'outil","disaledTooltipTourToolButton":"Pour avoir acc\xe8s au tour interactif de cet outil, ajouter des contextes ou des couches","buttonTitle":"D\xe9couvrir","exitButton":"Quitter","backButton":"Pr\xe9c\xe9dent","nextButton":"Suivant"},"paginator":{"firstPageLabel":"Premi\xe8re page","itemsPerPageLabel":"Entit\xe9s par page:","lastPageLabel":"Derni\xe8re page","nextPageLabel":"Page suivante","previousPageLabel":"Page pr\xe9c\xe9dente","of":"de"}}}}')},68079:function(e){"use strict";e.exports=JSON.parse('{"igo":{"context":{"bookmarkButton":{"create":"Cr\xe9er un contexte","dialog":{"createMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 cr\xe9\xe9","createTitle":"Contexte cr\xe9\xe9","placeholder":"Titre","title":"Nouveau contexte"}},"contextManager":{"clone":"Cloner ce contexte","delete":"Supprimer ce contexte","dialog":{"cloneMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 clon\xe9","cloneTitle":"Contexte clon\xe9","copyMsg":"Texte copi\xe9","copyTitle":"Identifiant du contexte","confirmDelete":"\xcates-vous s\xfbr de vouloir supprimer ce contexte ?","deleteMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 supprim\xe9","deleteTitle":"Contexte supprim\xe9","favoriteMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 d\xe9fini comme favori","favoriteTitle":"Favori enregistr\xe9","saveMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 enregistr\xe9","saveTitle":"Contexte enregistr\xe9"},"edit":"\xc9diter ce contexte","errors":{"uncaught":{"message":"D\xe9sol\xe9! Le service que vous voulez utiliser n\u2019est malheureusement pas disponible pour le moment. Essayez plus tard!","title":"Erreur de serveur"},"addPermission":"La permission que vous tentez d\'ajouter est d\xe9j\xe0 pr\xe9sente dans le contexte.","addPermissionEmpty":"La permission que vous tentez d\'ajouter n\'est pas valide","addPermissionTitle":"Erreur d\'ajout de permission"},"favorite":"D\xe9finir comme contexte favori","form":{"copy":"Copier l\'identifiant du contexte","edit":"Enregistrer","title":"Titre","titleRequired":"Le titre est obligatoire","uri":"Identifiant","uriRequired":"L\'identifiant est obligatoire"},"invalid":{"text":"Le contexte \\"{{value}}\\" est invalide. Le contexte par d\xe9faut a \xe9t\xe9 charg\xe9.","title":"Contexte invalide"},"managePermissions":"G\xe9rer les permissions du contexte","manageTools":"G\xe9rer les outils du contexte","ourContexts":"Mes contextes","publicContexts":"Contextes publics","save":"Sauvegarder ce contexte","sharedContexts":"Contextes partag\xe9s","filterPlaceHolder":"Filtrer par nom","sortAlphabetically":"Trier en ordre alphab\xe9tique","sortContextOrder":"Replacer selon la date de cr\xe9ation","userAccount":"Profils utilisateurs","filterUser":"Filtrer par groupe d\'utilisateur","emptyContext":"Contexte vide","emptyContextTooltip":"Cr\xe9er un nouveau contexte vide","contextMap":"Contexte \xe0 partir de la carte","contextMapTooltip":"Cr\xe9er un nouveau contexte \xe0 partir des couches la carte","hide":"Masquer ce contexte","show":"Montrer ce contexte","showHidden":"Montrer les contextes masqu\xe9s"},"contextImportExport":{"export":{"exportPlaceHolder":"Couches","exportContextName":"Nom du contexte","exportSelectAll":"Tout s\xe9lectionner","success":{"text":"Contexte export\xe9 avec succ\xe8s.","title":"Exportation r\xe9ussie"},"nothing":{"text":"Impossible d\u2019exporter, contexte non valide ou aucun contexte s\xe9lectionn\xe9.","title":"Donn\xe9e non valide ou non pr\xe9sente"},"failed":{"text":"Impossible d\u2019exporter, probl\xe8me de contexte rencontr\xe9.","title":"Probl\xe8me d\u2019exportation"}},"import":{"success":{"title":"Contexte import\xe9","text":"Le contexte \'{{value}}\' a \xe9t\xe9 ajout\xe9 \xe0 la carte"},"empty":{"text":"Le contexte \'{{value}}\' est vide, impossible d\'importer","title":"Contexte vide"},"invalid":{"text":"Le contexte \'{{value}}\' est invalide.","title":"Context invalide"},"unreadable":{"text":"Le contexte \'{{value}}\' est impossible \xe0 lire","title":"Context illisible"},"tooLarge":{"text":"Le contexte \'{{value}}\' est trop volumineux (Maximum: {{size}} Mo)","title":"Context trop volumineux"}}},"permission":{"addBtn":"Ajouter","delete":"Retirer la permission","dialog":{"addMsg":"La permission \'{{value}}\' a \xe9t\xe9 ajout\xe9e","addTitle":"Permission ajout\xe9e","deleteMsg":"La permission \'{{value}}\' a \xe9t\xe9 supprim\xe9e","deleteTitle":"Permission retir\xe9e","scopeChangedMsg":"La port\xe9e du contexte a \xe9t\xe9 chang\xe9e pour {{value}}","scopeChangedTitle":"Changement de la port\xe9e"},"profil":"Profil","user":"Utilisateur ou groupe","profilRequired":"Le profil est obligatoire","read":"Lecture seule","readOnlyTitle":"Contexte en lecture seule","readOnlyMsg":"Vous pouvez seulement retirer la permission si le contexte est directement partag\xe9 \xe0 votre nom d\'utilisateur.","scope":{"private":"Priv\xe9","protected":"Prot\xe9g\xe9","shared":"Partag\xe9","public":"Public"},"write":"Lecture et \xe9criture"},"poiButton":{"create":"Cr\xe9er une zone d\'int\xe9r\xeat","dialog":{"confirmDelete":"\xcates-vous s\xfbr de vouloir supprimer cette zone d\'int\xe9r\xeat ?","createMsg":"La zone d\'int\xe9r\xeat \'{{value}}\' a \xe9t\xe9 cr\xe9\xe9e","createTitle":"Zone d\'int\xe9r\xeat cr\xe9\xe9e","deleteMsg":"La zone d\'int\xe9r\xeat \'{{value}}\' a \xe9t\xe9 supprim\xe9e","deleteTitle":"Zone d\'int\xe9r\xeat supprim\xe9e","placeholder":"Titre","title":"Nouvelle zone d\'int\xe9r\xeat"},"placeholder":"Zones d\'int\xe9r\xeat"},"sidenav":{"goBack":"Revenir","mainMenu":"Revenir au menu principal"},"shareMap":{"button":"Partager la carte","refreshBtn":"Actualiser le partage","copy":"Copier le lien","shareWithApi":"Partage par contexte","shareWithUrl":"Partage par url","dialog":{"copyMsg":"Lien copi\xe9","copyTitle":"Lien"},"errorTitle":"Erreur lors du partage","placeholderLink":"Lien","included":"Inclus dans le lien de partage :","context":"Le contexte ouvert lors de la cr\xe9ation du lien de partage.","center":"Les coordonn\xe9es du centre de la carte (longitude, latitude).","zoom":"Le niveau de zoom de la carte.","addedLayers":"Les couches ajout\xe9es via le catalogue ou via la barre de recherche.","visibleInvisible":"Le statut de visibilit\xe9 des couches.","excluded":"Exclus dans le lien de partage :","order":"L\'ordre des couches.","opacity":"Les modifications effectu\xe9es \xe0 l\'opacit\xe9 des couches.","filterOgc":"Les ajouts/modifications faits aux filtres par attribut.","filterTime":"La valeur en cours pour les filtres temporels."},"tool":{"dialog":{"addMsg":"L\'outil a \xe9t\xe9 ajout\xe9","addTitle":"Outil ajout\xe9","deleteMsg":"L\'outil a \xe9t\xe9 supprim\xe9","deleteTitle":"Outil retir\xe9"}},"userButton":{"dialog":{"email":"Courriel","expiration":"Expiration","user":"Utilisateur","clearPreferences":"Supprimer mes pr\xe9f\xe9rences"},"infoTitle":"Info sur l\'utilisateur","logout":"Se d\xe9connecter"}}}}')},5415:function(e){"use strict";e.exports=JSON.parse('{"igo":{"core":{"message":{"success":"Succ\xe8s","error":"Erreur","info":"Info","alert":"Alerte"},"errors":{"uncaught":{"message":"D\xe9sol\xe9! Le service que vous voulez utiliser n\u2019est malheureusement pas disponible pour le moment. Essayez plus tard!","title":"Erreur serveur"}},"network":{"online":{"message":"En ligne","title":"Statut:"},"offline":{"message":"Hors-Ligne","title":"Statut:"}}}}}')},27268:function(e){"use strict";e.exports=JSON.parse('{"igo":{"geo":{"catalog":{"layer.addToMap":"Ajouter \xe0 la carte","layer.addToMapOutRange":"Ajouter \xe0 la carte. La donn\xe9e est non visible \xe0 l\'\xe9chelle active. Veuillez zoomer +/- si vous voulez l\'apercevoir \xe0 la carte.","layer.removeFromMap":"Retirer de la carte","layer.removeFromMapOutRange":"Retirer de la carte. La donn\xe9e est non visible \xe0 l\'\xe9chelle active. Veuillez zoomer +/- si vous voulez l\'apercevoir \xe0 la carte.","group.addToMap":"Ajouter toutes les couches de ce groupe \xe0 la carte","group.removeFromMap":"Retirer toutes les couches de ce groupe de la carte","baseLayers":"Fonds de carte","unavailableTitle":"Catalogue indisponible","unavailable":"Le catalogue \'{{value}}\' est indisponible pour le moment ou vous n\'avez pas les permissions requises.","someUnavailable":"Certaines couches d\'information du catalogue sont indisponible pour le moment ou vous n\'avez pas les permissions requises.","externalProvider":{"catalog":"Ce catalogue provient d\'une organisation externe.","group":"Ces couches proviennent d\'une organisation externe.","layer":"Cette couche provient d\'une organisation externe.","unavailableWithEmail":"Le catalogue \'{{value}}\' est indisponible pour le moment. Pour ajouter un service externe \xe0 la liste pr\xe9d\xe9finie, veuillez contacter {{email}}. Des d\xe9lais peuvent s\'appliquer si probl\xe8me il y a avec le fournisseur externe."},"library.add":"Ajouter ce catalogue","library.cancel":"Annuler","library.remove":"Retirer ce catalogue de la liste","library.inlist":{"title":"Catalogue d\xe9j\xe0 contenu","message":"Le catalogue \xe0 ajouter est d\xe9j\xe0 dans la liste"},"library.addTitle":"Ajout d\'un catalogue","library.addBtn":"Ajouter un catalogue"},"clickOnMap":{"clickedFeature":"Entit\xe9s cliqu\xe9es"},"baselayersSwitcher":{"title":"Fonds de carte"},"dataSource":{"unavailableTitle":"Couche indisponible","optionsApiUnavailable":"L\'information sur les couches n\'a pas pu \xeatre r\xe9cup\xe9r\xe9e. Certaines couches pourraient ne pas pr\xe9senter la bonne information.","unavailable":"La couche \'{{value}}\' est indisponible pour le moment ou vous n\'avez pas les permissions requises."},"dropGeoFile":{"invalid":{"text":"Le fichier \'{{value}}\' est invalide. ({{mimeType}})","title":"Fichier invalide"},"empty":{"text":"Le fichier \'{{value}}\' est vide, impossible d\'importer","title":"Fichier vide"},"success":{"text":"La couche \'{{value}}\' a \xe9t\xe9 ajout\xe9e \xe0 la carte","title":"Fichier import\xe9"},"unreadable":{"text":"Le fichier \'{{value}}\' est impossible \xe0 lire","title":"Fichier illisible"},"tooLarge":{"text":"Le fichier \'{{value}}\' est trop volumineux (Maximum: {{size}} Mo)","title":"Fichier trop volumineux"},"invalidSRS":{"text":"La projection est valide. Elle doit commencer par EPSG:","title":"Projection invalid"},"ogreServer":{"title":"Erreur 500 du service Ogre","text":"Erreur de la conversion du fichier en geojson. Il est possible que le fichier soit trop volumineux, essayer de l\'importer en format geojson"}},"export":{"customList":{"text":"Certaines couches s\xe9lectionn\xe9es ( {{value}} ) r\xe9duisent la liste des formats possible","title":"Liste restreinte de formats"},"nothing":{"text":"Impossible d\u2019exporter, donn\xe9e non valide ou aucune donn\xe9e s\xe9lectionn\xe9e.","title":"Donn\xe9e non valide ou non pr\xe9sente"},"noFormat":{"text":"Aucun format d\'exportation valide pour toutes les couches s\xe9lectionn\xe9es. Veuillez exporter les couches une \xe0 la fois.","title":"Aucun format disponible"},"failed":{"text":"Impossible d\u2019exporter, probl\xe8me de donn\xe9e rencontr\xe9.","title":"Probl\xe8me d\u2019exportation"},"popupBlocked":{"text":"</br>Veuillez autoriser l\'ouverture des fen\xeatres (popup) dans votre fureteur. </br>Pour Chrome and Edge, \xe0 droite dans la barre d\'adresse).</br>{{extraMessage}}","selectAgain":"Faites le correctif et s\xe9lectionner \xe0 nouveau un format.","retry":"Veuillez recommencer l\'exportation.","title":"Ouverture de fen\xeatre bloqu\xe9e par votre fureteur"},"success":{"text":"Donn\xe9es export\xe9es avec succ\xe8s.","title":"Exportation r\xe9ussie"},"format":{"GeoJSON":"GeoJSON","GML":"GML","GPX":"GPX","KML":"KML","Shapefile":"Shapefile","CSVcomma":"CSV (s\xe9parateur virgule)","CSVsemicolon":"CSV (compatible Excel)","URL":"Lien externe"},"gpx.error.poly":{"title":"GPX en erreur","text":"Le format GPX ne permet pas de stocker les polygones"},"encoding":{"LATIN1":"LATIN-1","UTF8":"UTF-8"},"combinedLayers":"couchesCombinees"},"importExportForm":{"exportButton":"Exporter","exportButtonLink":"Ouvrir le lien","exportButtonLinks":"Ouvrir les liens","exportCombineResults":"Combiner les couches dans un seul fichier","exportFormatPlaceholder":"Format","exportLayerPlaceholder":"Couche(s)","exportFileNamePlaceholder":"Nom du fichier","exportSeparator":"Ins\xe9rer un s\xe9parateur (ligne vide) entre les couches","encodingPlaceholder":"Encodage","exportTabTitle":"Exporter","exportFeatureInExtent":"Seulement les entit\xe9s contenues dans la carte","exportNoLayersExportable":"Aucune couche exportable dans la carte courante","exportSelectedFeature":"Seulement les entit\xe9s s\xe9lectionn\xe9es","importButton":"Importer","importProjPlaceholder":"Syst\xe8me de coordonn\xe9es du fichier \xe0 importer","importTabTitle":"Importer","importClarifications":"Pr\xe9cisions","importSizeMax":"La taille limite du fichier est de {{size}} Mo","importFormatAuthorized":"Formats autoris\xe9s: geojson, kml, gpx, gml, shapefile","importShpZip":"Les shapefiles doivent \xeatre compress\xe9s (zipp\xe9s) ET leurs g\xe9om\xe9tries doivent \xeatre en coordonn\xe9es Latitude Longitude (EPSG:4326/WGS84)","other":"autre","others":"autres","projections":{"mtm":"MTM {{zone}} ({{code}})","utm":"UTM {{zone}} ({{code}})","webMercator":"Web Mercator ({{code}})","nad83":"Lat-Long NAD83 ({{code}})","wgs84":"Lat-Long WGS84 ({{code}})","choose":"Vous devez choisir une projection avant d\'importer le fichier."}},"operators":{"caseSensitive":"Sensible \xe0 la case","And":"Et","Or":"Ou","PropertyIsEqualTo":"=","PropertyIsNotEqualTo":"!=","PropertyIsLike":"\u2248","PropertyIsGreaterThan":">","PropertyIsGreaterThanOrEqualTo":">=","PropertyIsLessThan":"<","PropertyIsLessThanOrEqualTo":"<=","PropertyIsBetween":"entre","During":"durant (temporel)","PropertyIsNull":"est nul","Intersects":"intersecte (g\xe9om\xe9trique)","Within":"contenu dans (g\xe9om\xe9trique)","Contains":"contient (g\xe9om\xe9trique)","tooltip":{"And":"Op\xe9rateur logique entre les filtres o\xf9 les deux conditions doivent \xeatre remplies","Or":"Op\xe9rateur logique entre les filtres o\xf9 au moins une (1) condition doit \xeatre vraie","PropertyIsEqualTo":"Identique (sensible \xe0 la case)","PropertyIsNotEqualTo":"Diff\xe9rent (sensible \xe0 la case)","PropertyIsLike":"Comme. Exemple: *route* trouve toutes les valeurs contenent \'route\', peu importe sa position dans l\'attribut. route* trouve toutes les valeurs commencant par \'route\'. Options avanc\xe9es : wildCard =\'*\', singleChar = \'.\' escapeChar = \'!\' (sensible \xe0 la case)","PropertyIsGreaterThan":"Plus grand","PropertyIsGreaterThanOrEqualTo":"Plus grand ou \xe9gal","PropertyIsLessThan":"Plus petit","PropertyIsLessThanOrEqualTo":"Plus petit ou \xe9gal","PropertyIsBetween":"Doit \xeatre contenu entre les limites inf\xe9rieure et sup\xe9rieure (les valeurs sont incluses)","During":"Doit \xeatre contenu entre les p\xe9riodes de temps sp\xe9cifi\xe9es","PropertyIsNull":"Dont l\'attribut est nul","Intersects":"Retourne les entit\xe9s \xe9tant en intersection g\xe9om\xe9trique avec la g\xe9om\xe9trie fournie","Within":"Retourne les entit\xe9s \xe9tant enti\xe8rement contenue par la g\xe9om\xe9trie fournie (Within)","Contains":"Retourne les entit\xe9s compl\xe8tement contenues par la g\xe9om\xe9trie fournie (Contains)"}},"sourceFields":{"selectField":"Choisir un champ"},"filter":{"resetFilters":"R\xe9initialiser les valeurs par d\xe9faut","addFilter":"Ajouter un filtre vide \xe0 la liste courante","removeFilter":"Supprimer le pr\xe9sent filtre \xe0 la liste des filtres","toggleFilterState":"Activer/d\xe9sactiver le pr\xe9sent filtre","refreshFilters":"Mettre \xe0 jour la source de donn\xe9e avec les filtres actifs de la liste. Pour activer ce boutton, la couche doit etre visible (et dans les \xe9chelles permises) ou veillez modifier le pr\xe9sent filtre.","layerFiltered":"Cette couche d\'information est pr\xe9sentement filtr\xe9e.","layerFilterable":"Cette couche d\'information est filtrable","filterBy":"Filtrer par","advancedOgcFilters":"Filtres avanc\xe9s","displayMoreResults":"Afficher plus (+)","displayLessResults":"Afficher moins (-)","placeholder":"Saisir une valeur","placeholderSnrc":"Ex: 21L14","selectOperator":"Choisir un op\xe9rateur","sliderModeTitle":"Curseur temporel","reportingDate":"Date de signalement"},"spatialSelector":{"fixedExtent":"\xc9tendue fixe","btnSetExtent":"D\xe9finir l\'\xe9tendue du filtre selon l\'\xe9tendue courante de la carte","snrc":"SNRC","selectFeature":"","drawFeature":""},"layer":{"hideLayer":"Masquer la couche","hideSelectedLayers":"Masquer les couches s\xe9lectionn\xe9es","lowerLayer":"Mettre en arri\xe8re","filterLowerLayer":"Le d\xe9placement arri\xe8re se fait toujours selon l\'ordre de la carte!","filterPlaceholder":"Filtrer la liste de couches","activateSelectionMode":"Activer le mode de s\xe9lection multiple","deactivateSelectionMode":"D\xe9sactiver le mode de s\xe9lection multiple","tools":"Outils","selectAll":"S\xe9lectionner toutes les couches","deselectAll":"D\xe9s\xe9lectionner toutes les couches","zoomLayer":"Cadrer sur l\'\xe9tendue de la couche","zoomLayers":"Cadrer sur l\'\xe9tendue des couches s\xe9lectionn\xe9es","opacity":"Opacit\xe9","raiseLayer":"Mettre en avant","filterRaiseLayer":"Le d\xe9placement avant se fait toujours selon l\'ordre de la carte!","moreOptions":"Outils de la couche","removeLayer":"Retirer la couche de la carte","removeSelectedLayers":"Retirer les couches s\xe9lectionn\xe9es de la carte","removeSelectedLayersRestriction":"Certaines couches s\xe9lectionn\xe9es ne peuvent \xeatre supprim\xe9es","showFeaturesList":"Afficher la liste des entit\xe9s","showLayer":"Afficher la couche","showSelectedLayers":"Afficher les couches s\xe9lectionn\xe9es","subsetLayersListKeyword":"Limiter l\'affichage de la liste selon le titre ou  par type (wms, wfs,...)","deleteKeyword":"Supprimer le mot-cl\xe9","subsetLayersListOnlyVisible":"Conserver seulement les couches visibles","subsetLayersListOnlyInRange":"Conserver seulement les couches de la plage d\'\xe9chelle active","sortAlphabetically":"Trier la liste des couches en ordre alphab\xe9tique","sortMapOrder":"Replacer les couches selon l\'ordre cartographique","resetLayersList":"R\xe9tablir l\'affichage de l\'ensemble des couches","trackFeature":"Suivre l\'entit\xe9","legend":{"default":"D\xe9faut","loadingLegendText":"Chargement de la l\xe9gende","noLegendText":"Aucune symbologie disponible pour cette couche","noLegendScale":"Aucune symbologie disponible pour cette \xe9chelle","selectStyle":"S\xe9lectionner le style de la l\xe9gende","showAll":"Montrer toutes les couches (non visible et hors \xe9chelle)","noLayersVisibleWithShowAllButton":"Aucune couche actuellement visible. Activez le bouton ci haut pour voir toutes les l\xe9gendes.","noLayersVisibleWithShowAllButtonButZoom":"Aucune couche actuellement visible. Si vous zoomez dans la carte, certaines couches appara\xeetront OU activez le bouton ci haut pour voir toutes les l\xe9gendes.","noLayersVisible":"Aucune couche actuellement visible.","noLayersVisibleButZoom":"Aucune couche actuellement visible. Par contre, si vous zoomez dans la carte, certaines couches appara\xeetront."}},"download":{"action":"T\xe9l\xe9charger les donn\xe9es associ\xe9es","title":"T\xe9l\xe9chargement des donn\xe9es","start":"V\xe9rifiez la progression du t\xe9l\xe9chargement dans votre navigateur","end":"Termin\xe9"},"mapButtons":{"baselayerSwitcher":"Changer le fond de carte","geolocate":"Afficher votre position","home-extent":"Aller \xe0 l\'\xe9tendue de la carte","offline":"Passer en mode hors-ligne","online":"Passer en mode en ligne","zoomIn":"Zoomer ({{zoom}})","zoomOut":"D\xe9zoomer ({{zoom}})","resetRotation":"R\xe9initialiser la carte vers le nord","tipRotation":"Maintenez les touches Alt et Majuscule (shift) tout en cliquant sur la carte pour faire pivoter la carte"},"metadata":{"show":"Montrer les m\xe9tadonn\xe9es"},"printForm":{"corsErrorMessageBody":"Impossible d\'imprimer d\xfb \xe0 des droits d\'acc\xe8s non d\xe9tenus","corsErrorMessageHeader":"Impression","comment":"Commentaire","doZipFile":"Compresser le fichier","outputFormat":"Format de sortie","paperFormat":"Format du papier","paperFormats":{"A0":"33.1 X 46.8\\" (A0)","A1":"23.4 X 33.1\\" (A1)","A2":"16.5 X 23.5\\" (A2)","A3":"11.7 X 16.5\\" (A3)","A4":"8.3 X 11.7\\" (A4)","A5":"5.8 X 8.3\\" (A5)","Letter":"Lettre","Legal":"L\xe9gal"},"imageFormat":"Format de l\'image","orientation":"Orientation","landscape":"Paysage","portrait":"Portrait","projection":"Projection","resolution":"R\xe9solution","saveBtn":"Sauvegarder","scale":"\xc9chelle","showProjection":"Afficher la projection","showScale":"Afficher l\'\xe9chelle","title":"Titre","subtitle":"Sous-titre","legendPosition":"Position de la l\xe9gende","legendPositions":{"none":"Aucune l\xe9gende","topleft":"Coin haut gauche de la carte","topright":"Coin haut droit de la carte","bottomleft":"Coin bas gauche de la carte","bottomright":"Coin bas droit de la carte","newpage":"Sur une nouvelle page"}},"directionsForm":{"stopLayer":"Itin\xe9raire - Arr\xeats","routeLayer":"Itin\xe9raire - Trac\xe9","start":"D\xe9but","intermediate":"Interm\xe9diaire","end":"Fin","directionsBtn":"Obtenir l\'itin\xe9raire","resetDirectionsBtn":"Supprimer l\'itin\xe9raire","zoomRoute":"Zoomer sur l\'itin\xe9raire","null":"","directions":"Itin\xe9raire","raiseStop":"Prioriser l\'arr\xeat","lowerStop":"Reporter l\'arr\xeat plus loin dans le parcours","addStop":"Ajouter un arr\xeat","clearStop":"R\xe9initialiser cet arr\xeat","moveStop":"D\xe9placer cet arr\xeat","removeStop":"Supprimer l\'arr\xeat","drivingOptions":"Choix d\'itin\xe9raires","summary":"R\xe9sum\xe9 de l\'itin\xe9raire","stopsList":"Liste des lieux d\'arr\xeats","instructions":"Indications","copy":"Copier l\'itin\xe9raire","geolocate":"Utiliser sa localisation comme point d\'arr\xeat","link":"Lien","dialog":{"copyMsg":"Itin\xe9raire copi\xe9 dans le presse-papier","copyMsgLink":"Le lien de l\'itin\xe9raire est copi\xe9 dans le presse-papier","copyTitle":"Itin\xe9raire"}},"directions":{"uturn":"demi-tour","sharp right":"fortement \xe0 droite","right":"droite","slight right":"l\xe9g\xe8rement \xe0 droite","sharp left":"fortement \xe0 gauche","left":"gauche","slight left":"l\xe9g\xe8rement \xe0 gauche","straight":"tout droit","turn":{"straight":"Continuer sur {{route}}","uturn":"Faire demi-tour sur {{route}}","else":"Tourner {{aggregatedDirection}} sur {{route}}"},"new name":"Continuer en direction {{translatedDirection}} sur {{route}}","depart":"Aller en direction {{translatedDirection}} sur {{route}}","arrive":{"lastStep":"Vous \xeates arriv\xe9 {{coma}} {{aggregatedDirection}}","intermediate":"Vous atteignez le point interm\xe9diaire sur {{route}}"},"merge":"Continuer sur {{route}}","on ramp":"Prendre l\'entr\xe9e d\'autoroute {{aggregatedDirection}}","off ramp":"Prendre la sortie d\'autoroute {{aggregatedDirection}}","fork":{"left":"Garder la gauche sur {{route}}","right":"Garder la droite sur {{route}}","else":"Continuer sur {{route}}"},"end of road":"\xc0 la fin de la route, tourner {{translatedModifier}} sur {{route}}","use lane":"Prendre la voie de ...","continue":{"notUturn":"Continuer sur {{route}}"},"roundabout":"Au rond-point, prendre la {{exit}}{{cntSuffix}} sortie vers {{route}}","rotary":"Rond-point rotary ...","roundabout turn":"Rond-point, prendre la ...","exit roundabout":"Poursuivre vers {{route}}","notification":"notification ...","uturnText":"Faire demi-tour et continuer en direction {{translatedDirection}} sur {{route}}","unknown":"???","cntSuffix":{"first":"\xe8re","secondAndMore":"e"},"modifier":{"prefix":"\xe0 "}},"cardinalPoints":{"n":"nord","ne":"nord-est","e":"est","se":"sud-est","s":"sud","sw":"sud-ouest","w":"ouest","nw":"nord-ouest"},"search":{"placeholder":"Rechercher une localisation ou une couche de donn\xe9es","emptyType.placeholder":"Veuillez choisir un type de recherche","feature.title":"Localisation","feature.placeholder":"Rechercher une localisation","layer.title":"Couche de donn\xe9es","layer.placeholder":"Rechercher une couche de donn\xe9es.","ichercheReverse.name":"Recherche par coordonn\xe9es","ilayer":{"name":"Couches","properties":{"abstract":"Description","groupTitle":"Groupe","title":"Titre","type":"Type","url":"URL","metadataUrl":"M\xe9tadonn\xe9es","name":"Nom de la couche","urlInfo":"Lien du service web WMS/WFS","downloadUrl":"Lien de t\xe9l\xe9chargement de la donn\xe9es"},"type":{"layer":"Couche","groupLayer":"Groupe de couches"}},"nominatim":{"type":{"food":"Restauration","health":"Sant\xe9","entertainment":"Divertissement","finance":"Finance"},"country":{"all":"Le monde","canada":"Canada"}},"icherche":{"name":"iCherche","type":{"address":"Adresse","oldAddress":"Ancienne adresse","district":"Arrondissement","postalCode":"Code Postal","city":"Municipalit\xe9","oldCity":"Ancienne municipalit\xe9","mrc":"MRC","regadmin":"R\xe9gion administrative","road":"Route","intersection":"Intersection","place":"Lieu","exit":"Sortie d\'autoroute","cn":"Borne du CN","gcc":"Rep\xe8re de la garde coti\xe8re (GCC)","sumi":"Borne SUMI","km":"Rep\xe8re kilom\xe9trique","hq":"Hydro-Qu\xe9bec","entreprise":"Entreprise","cadastre":"Cadastre"},"restrictExtent":{"map":"\xc0 l\'\xe9tendue de la carte","quebec":"Au Qu\xe9bec"}},"coordinates":{"name":"Coordonn\xe9es","coord":"Coordonn\xe9e (longitude, latitude)","coordDMS":"Coordonn\xe9e (longitude, latitude) (DMS)","radius":"Rayon","conf":"Confiance"},"menu.tooltip":"Options de recherche","settings":{"title":"Param\xe8tres"},"pointerSearchSummary":{"title":"Position du curseur","tooltip":"Afficher les coordonn\xe9es du curseur ainsi que d\'autres informations sur sa position en fonction des types de r\xe9sultats activ\xe9es. Utiliser F2 pour activer / d\xe9sactiver."},"searchResultsGeometry":{"title":"Montrer tous les r\xe9sultats","tooltip":"Afficher/cacher la g\xe9om\xe9trie des r\xe9sultats"},"searchSources":{"selectAll":"Tout s\xe9lectionner","unselectAll":"Tout d\xe9s\xe9lectionner","settings":{"results type":"Type de r\xe9sultat","ecmax":"\xc9cart maximal","radius":"Rayon de recherche","results limit":"Nombre de r\xe9sultats","multiple object":"Objet multiple","restrictExtent":"Restreint l\'\xe9tendue","selectAll":"Tout s\xe9lectionner","unselectAll":"Tout d\xe9s\xe9lectionner","true":"Oui","false":"Non"}},"displayMoreResults":"Afficher plus de r\xe9sultats"},"geometry":{"geometry":"Geometrie","point":"Point","line":"Ligne","polygon":"Surface"},"targetHtmlUrl":"Ouvrir le lien externe","searchByCoord":"Rechercher par coordonn\xe9es","searchByName":"Rechercher par nom","seeRouting":"Voir l\'itin\xe9raire","timeFilter":{"date":"Date","endDate":"Date de fin","startDate":"Date de d\xe9but","hour":"Heure","minute":"Minute","endYear":"Ann\xe9e de fin","startYear":"Ann\xe9e de d\xe9but"},"spatialFilter":{"spatialFilter":"Filtre spatial","predefined":"Zone Pr\xe9d\xe9finie","draw":"Dessin","polygon":"Polygone","point":"Cercle","drawPolygon":"Dessiner un polygone","drawCircle":"Dessiner un cercle","searchLabel":"Rechercher par","buffer":"Zone tampon","search":"Recherche","drawControl":"Activer le contr\xf4le de dessin","listLabel":"Zone","entity":"Entit\xe9","layer":"Couche","goSearch":"Lancer la recherche","removeLayer":"Retirer les r\xe9sultats","exportLayer":"Exporter les r\xe9sultats","clearForm":"Retirer le dessin","clearSearch":"R\xe9initialiser","Address":"Adresses","Thematics":"Th\xe9matiques","searchResults":"R\xe9sultats de la recherche","showSearchResults":"Afficher les r\xe9sultats de la recherche","hideSearchResults":"Masquer les r\xe9sultats de la recherche","type":"Type","radius":"Rayon","radiusAlert":"Le rayon doit \xeatre compris entre 0 et 100 kilom\xe8tres (ou 100 000 m\xe8tres)","bufferAlert":"La zone tampon doit \xeatre comprise entre 0 et 100 kilom\xe8tres (ou 100 000 m\xe8tres)","maxSizeAlert":"Le nombre de r\xe9sultats exc\xe8de 10000. Certains pourraient \xeatre manquants.","zeroResults":"Aucun r\xe9sultat ne correspond \xe0 cette recherche.","warning":"Avertissement","freehandControl":"\xc0 main lev\xe9e","group":{"toponyme":"Toponyme","culturel":"Culturel","education":"\xc9ducation","sante":"Sant\xe9","securite":"S\xe9curit\xe9","sepaq":"S\xc9PAQ","transport":"Transport"}},"terrapi":{"AdmRegion":"R\xe9gions administratives","Mun":"Municipalit\xe9s","Arrond":"Arrondissements","CircFed":"Circonscriptions f\xe9d\xe9rales","CircProv":"Circonscriptions provinciales","DirReg":"Directions r\xe9gionales","MRC":"MRC","RegTour":"R\xe9gions touristiques","limites":"Limites administratives","bornes":"Bornes sumi","hydro":"Hydrographie","routes":"Routes","bati":"B\xe2timents","batiment":"B\xe2timents","camping":"Camping","equipement":"\xc9quipements","commun":"Commun","geographie":"Lieux naturels","parc":"Parcs","secteur":"Secteurs","immeubles":"Immeubles patrimoniaux","sites":"Sites patrimoniaux","cpe":"Centre de la petite enfance","public":"\xc9coles publiques","prive":"\xc9coles priv\xe9s","gouvernemental":"\xc9coles gouvernementales","colleges":"Coll\xe8ges","universites":"Universit\xe9s","aine":"R\xe9sidences pour a\xeen\xe9s","ambulance":"Zones d\'ambulance","clinique":"Cliniques","etabl":"\xc9tablissements de sant\xe9","gmf":"Groupes de m\xe9decins de famille","naissance":"Maisons de naissances","pharmacie":"Pharmacies","casernes":"Casernes de pompiers","correctionnel":"Centres correctionnels","organisme":"Organismes de s\xe9curit\xe9","palais-justice":"Palais de justice","penitencier-fed":"P\xe9nitenciers f\xe9d\xe9raux","penitencier-prov":"P\xe9nitenciers provinciaux","polices":"Poste de police"},"measure":{"dialog":{"title":"Sommes de la s\xe9lection","length.title":"Distance","area.title":"Superficie","lengthInMeters":"m","lengthInKilometers":"km","lengthInMiles":"mi","lengthInFeet":"pi","areaInSquareMeters":"m\xb2","areaInSquareKilometers":"km\xb2","areaInSquareMiles":"mi\xb2","areaInHectares":"ha","areaInAcres":"ac","perimeterInMeters":"P\xe9rim\xe8tre en m\xe8tres"},"layerTitle":"Mesure \xe0 la carte","area":"Superficie","areaHeader":"Superficie","length":"Distance","lengthHeader":"Distance / P\xe9rim\xe8tre","perimeter":"P\xe9rim\xe8tre","meters":"m","m":"m","kilometers":"km","km":"km","miles":"mi","mi":"mi","feet":"pi","ft":"pi","squareMeters":"m\xb2","m\xb2":"m\xb2","squareKilometers":"km\xb2","km\xb2":"km\xb2","squareMiles":"mi\xb2","mi\xb2":"mi\xb2","squareFeet":"pi\xb2","ft\xb2":"pi\xb2","hectares":"ha","ha":"ha","acres":"ac","ac":"ac","toggleActive":"Activer le contr\xf4le de mesure","toggleDisplayLines":"Afficher les distances pour les lignes","toggleDisplayDistance":"Afficher les distances pour les superficies","toggleDisplayAreas":"Afficher les superficies","toggleAutoUnits":"Unit\xe9s automatiques","actionbar":{"calculate.tooltip":"Totaux et conversions","delete.tooltip":"Supprimer","modify.tooltip":"Modifier"}},"draw":{"abort":"Annuler le dessin en cours","cancelColorPicker":"Annuler","Circle":"Cercle","colorPicker":"Cliquer pour ouvrir le s\xe9lecteur de couleurs","dialogInstruction":"Veuillez entrer l\'\xe9tiquette de votre dessin","dialogTitle":"\xc9tiquette","delete":"Retirer les dessins de la carte","drawing":"Dessins","fill":"Remplissage","finish":"Terminer le dessin en cours","icon":"Ic\xf4nes","labels":"\xc9tiquettes","LineString":"Ligne","move":"Centrer la vue sur le curseur","noIcon":"Aucune ic\xf4ne","noLabel":"Aucune \xe9tiquette","Point":"Point","Polygon":"Polygone","radius":"Rayon","shortcuts":"Raccourcis clavier","stroke":"Contour","styleSelect":"S\xe9lectionner le style","toggleMapTooltips":"Afficher les \xe9tiquettes","undo":"Retirer le dernier sommet"},"network":{"online":{"message":"En ligne","title":"Statut:"},"offline":{"message":"Hors-Ligne","title":"Statut:"}},"workspace":{"deleteConfirmation":"Voulez-vous vraiment supprimer cette entit\xe9?","addConfirmation":"Voulez-vous vraiment ajouter une entit\xe9?","modifyConfirmation":"Voulez-vous vraiment modifier une entit\xe9?","deleteSuccess":"L\'entit\xe9 a \xe9t\xe9 supprim\xe9e.","addSuccess":"L\'entit\xe9 a \xe9t\xe9 ajout\xe9e.","modifySuccess":"L\'entit\xe9 a \xe9t\xe9 modifi\xe9e.","deleteError":"Un probl\xe8me est survenu. L\'entit\xe9 n\'a pas pu \xeatre supprim\xe9e.","addError":"Un probl\xe8me est survenu. L\'entit\xe9 n\'a pas pu \xeatre ajout\xe9e.","modifyError":"Un probl\xe8me est survenu. L\'entit\xe9 n\'a pas pu \xeatre modifi\xe9e.","cancel":"Annuler","inMapExtent.active.tooltip":"Ne montrer que les enregistrements contenus dans la carte","inMapExtent.inactive.tooltip":"Montrer tous les enregistrements"},"formValidation":{"mandatory":"{{column}}est un champ obligatoire","minValue":"{{column}} doit \xeatre plus grand que {{value}}","maxValue":"{{column}}doit \xeatre plus petit que {{value}}","minLength":"{{column}} doit \xeatre plus long que {{value}} caract\xe8res","maxLength":"{{column}} doit \xeatre plus court que {{value}} caract\xe8res"}}}}')},63031:function(e){"use strict";e.exports=JSON.parse("{\"igo\":{\"integration\":{\"tools\":{\"catalog\":\"Catalogue\",\"contexts\":\"Contextes\",\"directions\":\"Itin\xe9raire\",\"draw\":\"Dessin\",\"importExport\":\"Importer et exporter\",\"ogcFilter\":\"Filtrer par\",\"map\":\"Carte\",\"layers\":\"Couches\",\"legend\":\"L\xe9gende\",\"measurer\":\"Mesurer\",\"print\":\"Imprimer\",\"searchResults\":\"R\xe9sultats de recherche\",\"shareMap\":\"Partager\",\"timeFilter\":\"Filtre temporel\",\"about\":\"\xc0 propos\",\"spatialFilter\":\"Filtre spatial\",\"advancedMap\":\"Outils avanc\xe9s\"},\"searchResultsTool\":{\"noResults\":\"Aucun r\xe9sultat\",\"doSearch\":\"Veuillez effectuer une recherche dans la barre de recherche ci-dessus.\",\"examples\":\"<b>Permet de rechercher des adresses, des lieux, des coordonn\xe9es ou des couches</b>.<br><br>Les recherches d'<u>adresses</u> peuvent \xeatre effectu\xe9es selon une combinaison: <ul><li>du no. immeuble</li><li>du nom de la rue</li><li>de la ville</li><li>du code postal</li></ul> Exemples pour les <u>lieux</u>: <ul><li>Lac Poulin</li><li>Mcdo L\xe9vis</li><li>Saint-Isidore</li></ul> Vous pouvez aussi utiliser des mots cl\xe9s pour pr\xe9ciser votre recherche. Exemples: <ul><li>#mun qu\xe9bec (pour rechercher une municipalit\xe9)</li><li>#sante L\xe9vis (pour rechercher un \xe9tablissement de sant\xe9)</li><li>#cpe joyeux (pour rechercher un centre de la petite enfance)</li><li>#intersection li\xe9gois + \xe9glise (pour rechercher une intersection, le #+ peut aussi \xeatre utilis\xe9)</li></ul>*Les mots cl\xe9s apparaissent au survol d'un type dans l'onglet des param\xe8tres de recherche -> iCherche -> Type de r\xe9sultat.<br><br>Exemple pour les <u>coordonn\xe9es</u> :<ul><li>Degr\xe9 d\xe9cimal (-68.165547, 48.644546)</li><li>Degr\xe9 minute seconde (-68 9 56, 48 38 40)</li><li>Degr\xe9 minute d\xe9cimal (-68 9.56, 48 38.40)</li><li>Projet\xe9 (UTM-19 561466.861, 5388278.862)</li><li>BELL (Lat: 48 38 40N Long: 68 9 56W UNC:100 CONF:90)</li><li>Metre Metre (111594.63, 445854.74;32198)</li></ul>Pour plus d'informations sur la recherche par coordonn\xe9es : <a href='https://igo2.readthedocs.io/fr/next/properties.html#coordonnees' target='_blank'>Consulter la documentation d'IGO2</a>\",\"zoomOnFeatureTooltip\":\"Zoomer sur l'entit\xe9 s\xe9lectionn\xe9e.\",\"zoomOnFeatureTooltipOutOfView\":\"L'entit\xe9 est hors de la vue. Zoomer sur l'entit\xe9 s\xe9lectionn\xe9e.\"},\"aboutTool\":{\"headerHtml\":\"\",\"html\":\"<style>#about .bold_class{font-weight: bold;}#about .red{color: red;}#about .tool_name{border-top: 1px solid; padding-top: 10px;}#about .titre_outil{font-weight: bold; font-size: 18px; padding-bottom: 8px;}#about .subtitle{font-size: 20px; padding-bottom: 10px;}#about .align_right{text-align: right;}#about .describe{text-align: justify;}#about a img{color: black; text-decoration: none;}</style><body> <div id='about'> <div class='bold_class subtitle'>Aper\xe7u des fonctionnalit\xe9s</div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z'> </path> </svg></mat-icon> Recherche </div><div class='describe'> Situ\xe9e dans la portion sup\xe9rieure gauche de l\u2019interface, la barre de <span class='bold_class'>Recherche</span> permet de se positionner \xe0 l\u2019aide d\u2019une adresse, d\u2019un lieu ou de coordonn\xe9es GPS et peut \xe9galement servir \xe0 rechercher une couche. <br><br> Il est \xe9galement possible de rechercher un \xe9l\xe9ment par type de r\xe9sultats en utilisant le hashtag \xab # \xbb (par exemple, #municipalites qu\xe9bec). Les accents et les lettres majuscules n'importent pas lors de l'utilisation du hashtag et n'ont pas d'impact sur les <span class='bold_class'>R\xe9sultats de recherche</span>.</div></div><br><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z'></path> </svg></mat-icon> Contextes </div><div class='describe'> Les <span class='bold_class'>Contextes</span> permettent de visualiser des regroupements de couches faits par th\xe8me ou par contexte de travail. Lorsqu'un contexte est s\xe9lectionn\xe9, toutes les couches qu'il contient se retrouvent alors dans la <span class='bold_class'>Carte</span>. Il est possible d'ajouter d\u2019autres couches \xe0 partir du <span class='bold_class'>Catalogue</span> ou de l\u2019outil <span class='bold_class'>Recherche.</span> </div><br><div class='red'> <span class='bold_class'>ATTENTION :</span> Si un nouveau contexte est s\xe9lectionn\xe9, toutes les couches affich\xe9es dans la <span class='bold_class'>Carte</span> seront remplac\xe9es par celles de ce nouveau contexte. </div><br><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M15,19L9,16.89V5L15,7.11M20.5,3C20.44,3 20.39,3 20.34,3L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21C3.55,21 3.61,21 3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3Z'> </path> </svg></mat-icon> Carte </div><div class='describe'> Il est possible de personnaliser la <span class='bold_class'>Carte</span> \xe0 partir du <span class='bold_class'>Catalogue</span> ou de l\u2019outil <span class='bold_class'>Recherche.</span> Cet espace permet entre autres d\u2019ajouter, de supprimer, d\u2019interroger, de filtrer et de trier les couches pr\xe9sent\xe9es. Il est \xe9galement possible d'afficher les l\xe9gendes des couches.</div><br></div><div class='tool_name'><div class='titre_outil'><mat-icon class='mat-icon'><svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'><path d='M2 4C2 2.89 2.9 2 4 2H7V4H4V7H2V4M22 4V7H20V4H17V2H20C21.1 2 22 2.89 22 4M2 20V17H4V20H7V22H4C2.9 22 2 21.11 2 20M10 2H14V4H10V2M10 20H14V22H10V20M2 10H4V14H2V10M18.5 13C20.4 13 22 14.6 22 16.5C22 19.1 18.5 23 18.5 23C18.5 23 15 19.1 15 16.5C15 14.6 16.6 13 18.5 13M18.5 17.8C19.2 17.8 19.8 17.2 19.7 16.6C19.7 16 19.1 15.4 18.5 15.4C17.9 15.4 17.3 15.9 17.3 16.6C17.3 17.2 17.8 17.8 18.5 17.8M20 10H22V12.34C21.42 11.84 20.74 11.45 20 11.23V10Z'></path></svg></mat-icon> Filtre spatial </div><div class='describe'> Le <span class='bold_class'>Filtre spatial</span> permet de rechercher des adresses ou des th\xe9matiques selon des zones pr\xe9d\xe9finies (par exemple, par arrondissement ou par MRC) ou selon un dessin r\xe9alis\xe9 par l'utilisateur. Les r\xe9sultats du filtre peuvent \xeatre export\xe9s \xe0 l'aide de l'outil <span class='bold_class'>Importer et exporter</span>. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M1.39,18.36L3.16,16.6L4.58,18L5.64,16.95L4.22,15.54L5.64,14.12L8.11,16.6L9.17,15.54L6.7,13.06L8.11,11.65L9.53,13.06L10.59,12L9.17,10.59L10.59,9.17L13.06,11.65L14.12,10.59L11.65,8.11L13.06,6.7L14.47,8.11L15.54,7.05L14.12,5.64L15.54,4.22L18,6.7L19.07,5.64L16.6,3.16L18.36,1.39L22.61,5.64L5.64,22.61L1.39,18.36Z'> </path> </svg></mat-icon> Mesurer </div><div class='describe'> Cet outil permet de <span class='bold_class'>Mesurer</span> des distances ou des superficies directement sur la carte. </div><br></div><div class='tool_name'><div class='titre_outil'><mat-icon class='mat-icon'><svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'><path d='M9.75 20.85C11.53 20.15 11.14 18.22 10.24 17C9.35 15.75 8.12 14.89 6.88 14.06C6 13.5 5.19 12.8 4.54 12C4.26 11.67 3.69 11.06 4.27 10.94C4.86 10.82 5.88 11.4 6.4 11.62C7.31 12 8.21 12.44 9.05 12.96L10.06 11.26C8.5 10.23 6.5 9.32 4.64 9.05C3.58 8.89 2.46 9.11 2.1 10.26C1.78 11.25 2.29 12.25 2.87 13.03C4.24 14.86 6.37 15.74 7.96 17.32C8.3 17.65 8.71 18.04 8.91 18.5C9.12 18.94 9.07 18.97 8.6 18.97C7.36 18.97 5.81 18 4.8 17.36L3.79 19.06C5.32 20 7.88 21.47 9.75 20.85M20.84 5.25C21.06 5.03 21.06 4.67 20.84 4.46L19.54 3.16C19.33 2.95 18.97 2.95 18.76 3.16L17.74 4.18L19.82 6.26M11 10.92V13H13.08L19.23 6.85L17.15 4.77L11 10.92Z'></path></svg></mat-icon> Dessin </div><div class='describe'> L'outil <span class='bold_class'>Dessin</span> permet de dessiner des entit\xe9s ponctuelles, lin\xe9aires, polygonales ou circulaires accompagn\xe9es ou non d'\xe9tiquettes. La couleur de remplissage et du contour des entit\xe9s peuvent \xeatre choisies \xe0 l'aide des s\xe9lecteurs correspondants. <br><br> Une couche Dessins peut \xeatre export\xe9e \xe0 l'aide de l'outil <span class='bold_class'>Importer et exporter</span>. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M14,14.5V12H10V15H8V11A1,1 0 0,1 9,10H14V7.5L17.5,11M21.71,11.29L12.71,2.29H12.7C12.31,1.9 11.68,1.9 11.29,2.29L2.29,11.29C1.9,11.68 1.9,12.32 2.29,12.71L11.29,21.71C11.68,22.09 12.31,22.1 12.71,21.71L21.71,12.71C22.1,12.32 22.1,11.68 21.71,11.29Z'> </path> </svg></mat-icon> Itin\xe9raire </div><div class='describe'> Il est possible de construire un <span class='bold_class'>Itin\xe9raire</span> entre deux points en s\xe9lectionnant un point de d\xe9part et un point d'arriv\xe9e dans la carte ou en recherchant des adresses. Il est ensuite possible d'ajouter des points d'arr\xeat interm\xe9diaires et de copier la description ou le lien de l'itin\xe9raire dans le presse-papier. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M17,14H19V17H22V19H19V22H17V19H14V17H17V14M11,16L2,9L11,2L20,9L11,16M11,18.54L12,17.75V18C12,18.71 12.12,19.39 12.35,20L11,21.07L2,14.07L3.62,12.81L11,18.54Z'></path> </svg></mat-icon> Catalogue </div><div class='describe'> Le <span class='bold_class'>Catalogue</span> contient toutes les couches qui peuvent \xeatre ajout\xe9es \xe0 la <span class='bold_class'>Carte</span>. L'utilisateur doit cliquer sur + de la couche d\xe9sir\xe9e afin de l\u2019ajouter \xe0 la <span class='bold_class'>Carte</span>. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M14,17H18V14L23,18.5L18,23V20H14V17M13,9H18.5L13,3.5V9M6,2H14L20,8V12.34C19.37,12.12 18.7,12 18,12A6,6 0 0,0 12,18C12,19.54 12.58,20.94 13.53,22H6C4.89,22 4,21.1 4,20V4A2,2 0 0,1 6,2Z'></path> </svg></mat-icon> Importer et exporter </div><div class='describe'> Il est possible d'<span class='bold_class'>Importer</span> un fichier vectoriel tout en sp\xe9cifiant un syst\xe8me de coordonn\xe9es ou une projection. <br><br> Il est possible d'<span class='bold_class'>Exporter</span> une ou plusieurs couches dans plusieurs formats courants. <br><br> Il est \xe9galement possible d'<span class='bold_class'>Importer</span> ou d'<span class='bold_class'>Exporter</span> un contexte localement. Cette derni\xe8re fonctionnalit\xe9 permet ainsi de sauvegarder des contextes en mode non-authentifi\xe9 ou anonyme. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z'></path> </svg></mat-icon> Imprimer </div><div class='describe'> Cet outil permet d'<span class='bold_class'>Imprimer</span> la carte affich\xe9e \xe0 l\u2019\xe9cran en sp\xe9cifiant plusieurs options telles qu'un titre, un commentaire, le format de sortie, le format du papier et l'orientation de l'impression. </div><br></div><div class='tool_name'> <div class='titre_outil'> <mat-icon class='mat-icon'> <svg viewBox='0 0 24 24' fit='' height='100%' width='100%' preserveAspectRatio='xMidYMid meet' focusable='false'> <path d='M18,16.08C17.24,16.08 16.56,16.38 16.04,16.85L8.91,12.7C8.96,12.47 9,12.24 9,12C9,11.76 8.96,11.53 8.91,11.3L15.96,7.19C16.5,7.69 17.21,8 18,8A3,3 0 0,0 21,5A3,3 0 0,0 18,2A3,3 0 0,0 15,5C15,5.24 15.04,5.47 15.09,5.7L8.04,9.81C7.5,9.31 6.79,9 6,9A3,3 0 0,0 3,12A3,3 0 0,0 6,15C6.79,15 7.5,14.69 8.04,14.19L15.16,18.34C15.11,18.55 15.08,18.77 15.08,19C15.08,20.61 16.39,21.91 18,21.91C19.61,21.91 20.92,20.61 20.92,19A2.92,2.92 0 0,0 18,16.08Z'> </path> </svg></mat-icon> Partager </div><div class='describe'> L'outil <span class='bold_class'>Partager</span> permet de cr\xe9er une adresse URL qui redirige vers une repr\xe9sentation exacte de la <span class='bold_class'>Carte</span> affich\xe9e \xe0 l\u2019\xe9cran. Ce lien peut, par exemple, \xeatre partag\xe9 ou diffus\xe9 dans un document, permettant ainsi de \xab&nbspsauvegarder \xbb la carte pour une utilisation ult\xe9rieure. </div><br></div><div class='tool_name'> <p> <a href='http://igouverte.org/' target='_blank'><img src='./assets/igo2/core/logo.png' alt='IGO' height=32>IGO2</a> est une solution Web libre g\xe9omatique d\xe9velopp\xe9e en mode collaboratif par des sp\xe9cialistes provenant de plusieurs minist\xe8res et organismes du gouvernement du Qu\xe9bec.</p><p>Version: {{version.lib}}</p></div>\",\"trainingGuide\":\"Guide de formation\",\"trainingGuideTooltip\":\"Cliquez ici pour acc\xe9der au guide d'autoformation de IGO2\"},\"mapTool\":{\"empty\":\"La carte ne contient aucune couche de donn\xe9es.\",\"customize\":\"Personnalisez-l\xe0 en ajoutant des couches \xe0 partir des outils suivants : \",\"search-tool\":\"Recherche\",\"catalog-tool\":\"Catalogue de donn\xe9es\",\"context-tool\":\"Gestionnaire de contextes\",\"noLayersVisible\":\"Aucune couche visible.\",\"noLayersInRange\":\"Aucune couche visible dans la plage d'\xe9chelle active. Veuillez zoomer ou d\xe9zoomer pour d\xe9couvrir ces couches.\"},\"importExportTool\":{\"importExportData\":\"Couche\",\"importExportContext\":\"Contexte\"},\"workspace\":{\"toggleWorkspace\":\"Ouvrir/fermer la vue tabulaire\",\"ogcFilter.close\":\"Fermer\",\"ogcFilter.title\":\"Filtres\",\"ogcFilter.tooltip\":\"Appliquer des filtres sur la couche\",\"download.title\":\"T\xe9l\xe9charger les donn\xe9es associ\xe9es\",\"download.tooltip\":\"T\xe9l\xe9charger les donn\xe9es associ\xe9es\",\"inMapExtent.title\":\"Montrer les entit\xe9s contenues dans la carte\",\"inMapExtent.active.tooltip\":\"Montrer les entit\xe9s contenues dans la carte\",\"inMapExtent.inactive.tooltip\":\"Montrer toutes les entit\xe9s\",\"zoomAuto.title\":\"Zoom auto\",\"zoomAuto.tooltip\":\"Zoom auto\",\"selected.title\":\"Montrer les entit\xe9s s\xe9lectionn\xe9es\",\"selected.tooltip\":\"Montrer les entit\xe9s s\xe9lectionn\xe9es\",\"clearSelection.title\":\"Tout d\xe9s\xe9lectionner\",\"clearSelection.tooltip\":\"D\xe9s\xe9lectionner les enregistrements s\xe9lectionn\xe9s\",\"maximize\":\"Agrandir\",\"maximizeTooltip\":\"Agrandir la fen\xeatre\",\"standardExtent\":\"R\xe9duire\",\"standardExtentTooltip\":\"R\xe9duire la fen\xeatre\"},\"directions\":{\"warning\":{\"title\":\"Avertissement\",\"message\":\"L'itin\xe9raire propos\xe9 dans cet outil ne tient pas compte des conditions routi\xe8res actuelles, de la congestion routi\xe8re, des entraves pr\xe9sente sur le r\xe9seau et des horaires de traversiers (ouverture quotidienne et saisonni\xe8re).\"}},\"advanced-map-tool\":{\"advanced-swipe\":{\"swipe-select\":\"Choisir les couches \xe0 comparer\",\"selectAll\":\"Tout s\xe9lectionner\",\"empty\":\"La carte ne contient aucune couche de donn\xe9es.\",\"customize\":\"Personnalisez-l\xe0 en ajoutant des couches \xe0 partir des outils suivants : \",\"search-tool\":\"Recherche\",\"catalog-tool\":\"Catalogue de donn\xe9es\",\"context-tool\":\"Gestionnaire de contextes\",\"swipe\":\"Activer\",\"swipe-tool\":\"Outil de comparaison\"},\"advanced-coordinates\":{\"copy\":\"Copier\",\"lon\":\"Longitude\",\"lat\":\"Latitude\",\"nord\":\"Nord\",\"est\":\"Est\",\"coordinates\":\"Coordonn\xe9es du centre de la carte\",\"copyMsg\":\"Coordonn\xe9es copi\xe9es\",\"copyTitle\":\"Coordonn\xe9es du centre\",\"center\":\"Centre\",\"coordSystem\":\"Syst\xe8me de coordonn\xe9es\",\"zoom\":\"Niveau de zoom courant: \",\"scale\":\"\xc9chelle cartographique: \",\"resolution\":\"R\xe9solution cartographique: \"}}}}}")},65962:function(e){"use strict";e.exports=JSON.parse('{"igo":{"auth":{"accessAnonymous":"Rester anonyme","connection":"Connexion","login":"Connecter","password":"Mot de passe","signOut":"Se d\xe9connecter","user":"Utilisateur","welcome":"Bienvenue {{name}}!","deconnection":"Vous \xeates d\xe9connect\xe9","home":"Retourner \xe0 la page d\'accueil","error":{"Password expired":"Votre mot de passe est expir\xe9","Maximun logins exceeded":"Nombre maximal de connexions d\xe9pass\xe9","Login lockout":"Nombre maximal d\'essai d\xe9pass\xe9. Votre compte est verrouill\xe9.","Wrong password":"Mot de passe incorrect","Invalid username":"Utilisateur invalide"},"google":{"login":"Se connecter avec Google","logged":"Connect\xe9 avec Google"},"microsoft":{"login":"Se connecter avec compte Azure"},"microsoftb2c":{"login":"Se connecter"}},"common":{"confirmDialog":{"cancelBtn":"Annuler","confirmBtn":"Confirmer","title":"Confirmation"},"table":{"filter":"Filtre"},"entity-table":{"targetHtmlUrl":"Ouvrir le lien externe"},"form":{"errors":{"required":"Ce champ est requis"}},"actionbar":{"scrollUp":"D\xe9filer vers le haut","scrollDown":"D\xe9filer vers le bas","icon":"Actions suppl\xe9mentaires"},"interactiveTour":{"tooltipTourToolButton":"Aide interactive sur l\'outil","disaledTooltipTourToolButton":"Pour avoir acc\xe8s au tour interactif de cet outil, ajouter des contextes ou des couches","buttonTitle":"D\xe9couvrir","exitButton":"Quitter","backButton":"Pr\xe9c\xe9dent","nextButton":"Suivant"},"paginator":{"firstPageLabel":"Premi\xe8re page","itemsPerPageLabel":"Entit\xe9s par page:","lastPageLabel":"Derni\xe8re page","nextPageLabel":"Page suivante","previousPageLabel":"Page pr\xe9c\xe9dente","of":"de"}},"context":{"bookmarkButton":{"create":"Cr\xe9er un contexte","dialog":{"createMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 cr\xe9\xe9","createTitle":"Contexte cr\xe9\xe9","placeholder":"Titre","title":"Nouveau contexte"}},"contextManager":{"clone":"Cloner ce contexte","delete":"Supprimer ce contexte","dialog":{"cloneMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 clon\xe9","cloneTitle":"Contexte clon\xe9","copyMsg":"Texte copi\xe9","copyTitle":"Identifiant du contexte","confirmDelete":"\xcates-vous s\xfbr de vouloir supprimer ce contexte ?","deleteMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 supprim\xe9","deleteTitle":"Contexte supprim\xe9","favoriteMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 d\xe9fini comme favori","favoriteTitle":"Favori enregistr\xe9","saveMsg":"Le contexte \'{{value}}\' a \xe9t\xe9 enregistr\xe9","saveTitle":"Contexte enregistr\xe9"},"edit":"\xc9diter ce contexte","errors":{"uncaught":{"message":"D\xe9sol\xe9! Le service que vous voulez utiliser n\u2019est malheureusement pas disponible pour le moment. Essayez plus tard!","title":"Erreur de serveur"},"addPermission":"La permission que vous tentez d\'ajouter est d\xe9j\xe0 pr\xe9sente dans le contexte.","addPermissionEmpty":"La permission que vous tentez d\'ajouter n\'est pas valide","addPermissionTitle":"Erreur d\'ajout de permission"},"favorite":"D\xe9finir comme contexte favori","form":{"copy":"Copier l\'identifiant du contexte","edit":"Enregistrer","title":"Titre","titleRequired":"Le titre est obligatoire","uri":"Identifiant","uriRequired":"L\'identifiant est obligatoire"},"invalid":{"text":"Le contexte \\"{{value}}\\" est invalide. Le contexte par d\xe9faut a \xe9t\xe9 charg\xe9.","title":"Contexte invalide"},"managePermissions":"G\xe9rer les permissions du contexte","manageTools":"G\xe9rer les outils du contexte","ourContexts":"Mes contextes","publicContexts":"Contextes publics","save":"Sauvegarder ce contexte","sharedContexts":"Contextes partag\xe9s","filterPlaceHolder":"Filtrer par nom","sortAlphabetically":"Trier en ordre alphab\xe9tique","sortContextOrder":"Replacer selon la date de cr\xe9ation","userAccount":"Profils utilisateurs","filterUser":"Filtrer par groupe d\'utilisateur","emptyContext":"Contexte vide","emptyContextTooltip":"Cr\xe9er un nouveau contexte vide","contextMap":"Contexte \xe0 partir de la carte","contextMapTooltip":"Cr\xe9er un nouveau contexte \xe0 partir des couches la carte","hide":"Masquer ce contexte","show":"Montrer ce contexte","showHidden":"Montrer les contextes masqu\xe9s"},"contextImportExport":{"export":{"exportPlaceHolder":"Couches","exportContextName":"Nom du contexte","exportSelectAll":"Tout s\xe9lectionner","success":{"text":"Contexte export\xe9 avec succ\xe8s.","title":"Exportation r\xe9ussie"},"nothing":{"text":"Impossible d\u2019exporter, contexte non valide ou aucun contexte s\xe9lectionn\xe9.","title":"Donn\xe9e non valide ou non pr\xe9sente"},"failed":{"text":"Impossible d\u2019exporter, probl\xe8me de contexte rencontr\xe9.","title":"Probl\xe8me d\u2019exportation"}},"import":{"success":{"title":"Contexte import\xe9","text":"Le contexte \'{{value}}\' a \xe9t\xe9 ajout\xe9 \xe0 la carte"},"empty":{"text":"Le contexte \'{{value}}\' est vide, impossible d\'importer","title":"Contexte vide"},"invalid":{"text":"Le contexte \'{{value}}\' est invalide.","title":"Context invalide"},"unreadable":{"text":"Le contexte \'{{value}}\' est impossible \xe0 lire","title":"Context illisible"},"tooLarge":{"text":"Le contexte \'{{value}}\' est trop volumineux (Maximum: {{size}} Mo)","title":"Context trop volumineux"}}},"permission":{"addBtn":"Ajouter","delete":"Retirer la permission","dialog":{"addMsg":"La permission \'{{value}}\' a \xe9t\xe9 ajout\xe9e","addTitle":"Permission ajout\xe9e","deleteMsg":"La permission \'{{value}}\' a \xe9t\xe9 supprim\xe9e","deleteTitle":"Permission retir\xe9e","scopeChangedMsg":"La port\xe9e du contexte a \xe9t\xe9 chang\xe9e pour {{value}}","scopeChangedTitle":"Changement de la port\xe9e"},"profil":"Profil","user":"Utilisateur ou groupe","profilRequired":"Le profil est obligatoire","read":"Lecture seule","readOnlyTitle":"Contexte en lecture seule","readOnlyMsg":"Vous pouvez seulement retirer la permission si le contexte est directement partag\xe9 \xe0 votre nom d\'utilisateur.","scope":{"private":"Priv\xe9","protected":"Prot\xe9g\xe9","shared":"Partag\xe9","public":"Public"},"write":"Lecture et \xe9criture"},"poiButton":{"create":"Cr\xe9er une zone d\'int\xe9r\xeat","dialog":{"confirmDelete":"\xcates-vous s\xfbr de vouloir supprimer cette zone d\'int\xe9r\xeat ?","createMsg":"La zone d\'int\xe9r\xeat \'{{value}}\' a \xe9t\xe9 cr\xe9\xe9e","createTitle":"Zone d\'int\xe9r\xeat cr\xe9\xe9e","deleteMsg":"La zone d\'int\xe9r\xeat \'{{value}}\' a \xe9t\xe9 supprim\xe9e","deleteTitle":"Zone d\'int\xe9r\xeat supprim\xe9e","placeholder":"Titre","title":"Nouvelle zone d\'int\xe9r\xeat"},"placeholder":"Zones d\'int\xe9r\xeat"},"sidenav":{"goBack":"Revenir","mainMenu":"Revenir au menu principal"},"shareMap":{"button":"Partager la carte","refreshBtn":"Actualiser le partage","copy":"Copier le lien","shareWithApi":"Partage par contexte","shareWithUrl":"Partage par url","dialog":{"copyMsg":"Lien copi\xe9","copyTitle":"Lien"},"errorTitle":"Erreur lors du partage","placeholderLink":"Lien","included":"Inclus dans le lien de partage :","context":"Le contexte ouvert lors de la cr\xe9ation du lien de partage.","center":"Les coordonn\xe9es du centre de la carte (longitude, latitude).","zoom":"Le niveau de zoom de la carte.","addedLayers":"Les couches ajout\xe9es via le catalogue ou via la barre de recherche.","visibleInvisible":"Le statut de visibilit\xe9 des couches.","excluded":"Exclus dans le lien de partage :","order":"L\'ordre des couches.","opacity":"Les modifications effectu\xe9es \xe0 l\'opacit\xe9 des couches.","filterOgc":"Les ajouts/modifications faits aux filtres par attribut.","filterTime":"La valeur en cours pour les filtres temporels."},"tool":{"dialog":{"addMsg":"L\'outil a \xe9t\xe9 ajout\xe9","addTitle":"Outil ajout\xe9","deleteMsg":"L\'outil a \xe9t\xe9 supprim\xe9","deleteTitle":"Outil retir\xe9"}},"userButton":{"dialog":{"email":"Courriel","expiration":"Expiration","user":"Utilisateur","clearPreferences":"Supprimer mes pr\xe9f\xe9rences"},"infoTitle":"Info sur l\'utilisateur","logout":"Se d\xe9connecter"}},"core":{"message":{"success":"Succ\xe8s","error":"Erreur","info":"Info","alert":"Alerte"},"errors":{"uncaught":{"message":"D\xe9sol\xe9! Le service que vous voulez utiliser n\u2019est malheureusement pas disponible pour le moment. Essayez plus tard!","title":"Erreur serveur"}},"network":{"online":{"message":"En ligne","title":"Statut:"},"offline":{"message":"Hors-Ligne","title":"Statut:"}}},"geo":{"catalog":{"layer.addToMap":"Ajouter \xe0 la carte","layer.addToMapOutRange":"Ajouter \xe0 la carte. La donn\xe9e est non visible \xe0 l\'\xe9chelle active. Veuillez zoomer +/- si vous voulez l\'apercevoir \xe0 la carte.","layer.removeFromMap":"Retirer de la carte","layer.removeFromMapOutRange":"Retirer de la carte. La donn\xe9e est non visible \xe0 l\'\xe9chelle active. Veuillez zoomer +/- si vous voulez l\'apercevoir \xe0 la carte.","group.addToMap":"Ajouter toutes les couches de ce groupe \xe0 la carte","group.removeFromMap":"Retirer toutes les couches de ce groupe de la carte","baseLayers":"Fonds de carte","unavailableTitle":"Catalogue indisponible","unavailable":"Le catalogue \'{{value}}\' est indisponible pour le moment ou vous n\'avez pas les permissions requises.","someUnavailable":"Certaines couches d\'information du catalogue sont indisponible pour le moment ou vous n\'avez pas les permissions requises.","externalProvider":{"catalog":"Ce catalogue provient d\'une organisation externe.","group":"Ces couches proviennent d\'une organisation externe.","layer":"Cette couche provient d\'une organisation externe.","unavailableWithEmail":"Le catalogue \'{{value}}\' est indisponible pour le moment. Pour ajouter un service externe \xe0 la liste pr\xe9d\xe9finie, veuillez contacter {{email}}. Des d\xe9lais peuvent s\'appliquer si probl\xe8me il y a avec le fournisseur externe."},"library.add":"Ajouter ce catalogue","library.cancel":"Annuler","library.remove":"Retirer ce catalogue de la liste","library.inlist":{"title":"Catalogue d\xe9j\xe0 contenu","message":"Le catalogue \xe0 ajouter est d\xe9j\xe0 dans la liste"},"library.addTitle":"Ajout d\'un catalogue","library.addBtn":"Ajouter un catalogue"},"clickOnMap":{"clickedFeature":"Entit\xe9s cliqu\xe9es"},"baselayersSwitcher":{"title":"Fonds de carte"},"dataSource":{"unavailableTitle":"Couche indisponible","optionsApiUnavailable":"L\'information sur les couches n\'a pas pu \xeatre r\xe9cup\xe9r\xe9e. Certaines couches pourraient ne pas pr\xe9senter la bonne information.","unavailable":"La couche \'{{value}}\' est indisponible pour le moment ou vous n\'avez pas les permissions requises."},"dropGeoFile":{"invalid":{"text":"Le fichier \'{{value}}\' est invalide. ({{mimeType}})","title":"Fichier invalide"},"empty":{"text":"Le fichier \'{{value}}\' est vide, impossible d\'importer","title":"Fichier vide"},"success":{"text":"La couche \'{{value}}\' a \xe9t\xe9 ajout\xe9e \xe0 la carte","title":"Fichier import\xe9"},"unreadable":{"text":"Le fichier \'{{value}}\' est impossible \xe0 lire","title":"Fichier illisible"},"tooLarge":{"text":"Le fichier \'{{value}}\' est trop volumineux (Maximum: {{size}} Mo)","title":"Fichier trop volumineux"},"invalidSRS":{"text":"La projection est valide. Elle doit commencer par EPSG:","title":"Projection invalid"},"ogreServer":{"title":"Erreur 500 du service Ogre","text":"Erreur de la conversion du fichier en geojson. Il est possible que le fichier soit trop volumineux, essayer de l\'importer en format geojson"}},"export":{"customList":{"text":"Certaines couches s\xe9lectionn\xe9es ( {{value}} ) r\xe9duisent la liste des formats possible","title":"Liste restreinte de formats"},"nothing":{"text":"Impossible d\u2019exporter, donn\xe9e non valide ou aucune donn\xe9e s\xe9lectionn\xe9e.","title":"Donn\xe9e non valide ou non pr\xe9sente"},"noFormat":{"text":"Aucun format d\'exportation valide pour toutes les couches s\xe9lectionn\xe9es. Veuillez exporter les couches une \xe0 la fois.","title":"Aucun format disponible"},"failed":{"text":"Impossible d\u2019exporter, probl\xe8me de donn\xe9e rencontr\xe9.","title":"Probl\xe8me d\u2019exportation"},"popupBlocked":{"text":"</br>Veuillez autoriser l\'ouverture des fen\xeatres (popup) dans votre fureteur. </br>Pour Chrome and Edge, \xe0 droite dans la barre d\'adresse).</br>{{extraMessage}}","selectAgain":"Faites le correctif et s\xe9lectionner \xe0 nouveau un format.","retry":"Veuillez recommencer l\'exportation.","title":"Ouverture de fen\xeatre bloqu\xe9e par votre fureteur"},"success":{"text":"Donn\xe9es export\xe9es avec succ\xe8s.","title":"Exportation r\xe9ussie"},"format":{"GeoJSON":"GeoJSON","GML":"GML","GPX":"GPX","KML":"KML","Shapefile":"Shapefile","CSVcomma":"CSV (s\xe9parateur virgule)","CSVsemicolon":"CSV (compatible Excel)","URL":"Lien externe"},"gpx.error.poly":{"title":"GPX en erreur","text":"Le format GPX ne permet pas de stocker les polygones"},"encoding":{"LATIN1":"LATIN-1","UTF8":"UTF-8"},"combinedLayers":"couchesCombinees"},"importExportForm":{"exportButton":"Exporter","exportButtonLink":"Ouvrir le lien","exportButtonLinks":"Ouvrir les liens","exportCombineResults":"Combiner les couches dans un seul fichier","exportFormatPlaceholder":"Format","exportLayerPlaceholder":"Couche(s)","exportFileNamePlaceholder":"Nom du fichier","exportSeparator":"Ins\xe9rer un s\xe9parateur (ligne vide) entre les couches","encodingPlaceholder":"Encodage","exportTabTitle":"Exporter","exportFeatureInExtent":"Seulement les entit\xe9s contenues dans la carte","exportNoLayersExportable":"Aucune couche exportable dans la carte courante","exportSelectedFeature":"Seulement les entit\xe9s s\xe9lectionn\xe9es","importButton":"Importer","importProjPlaceholder":"Syst\xe8me de coordonn\xe9es du fichier \xe0 importer","importTabTitle":"Importer","importClarifications":"Pr\xe9cisions","importSizeMax":"La taille limite du fichier est de {{size}} Mo","importFormatAuthorized":"Formats autoris\xe9s: geojson, kml, gpx, gml, shapefile","importShpZip":"Les shapefiles doivent \xeatre compress\xe9s (zipp\xe9s) ET leurs g\xe9om\xe9tries doivent \xeatre en coordonn\xe9es Latitude Longitude (EPSG:4326/WGS84)","other":"autre","others":"autres","projections":{"mtm":"MTM {{zone}} ({{code}})","utm":"UTM {{zone}} ({{code}})","webMercator":"Web Mercator ({{code}})","nad83":"Lat-Long NAD83 ({{code}})","wgs84":"Lat-Long WGS84 ({{code}})","choose":"Vous devez choisir une projection avant d\'importer le fichier."}},"operators":{"caseSensitive":"Sensible \xe0 la case","And":"Et","Or":"Ou","PropertyIsEqualTo":"=","PropertyIsNotEqualTo":"!=","PropertyIsLike":"\u2248","PropertyIsGreaterThan":">","PropertyIsGreaterThanOrEqualTo":">=","PropertyIsLessThan":"<","PropertyIsLessThanOrEqualTo":"<=","PropertyIsBetween":"entre","During":"durant (temporel)","PropertyIsNull":"est nul","Intersects":"intersecte (g\xe9om\xe9trique)","Within":"contenu dans (g\xe9om\xe9trique)","Contains":"contient (g\xe9om\xe9trique)","tooltip":{"And":"Op\xe9rateur logique entre les filtres o\xf9 les deux conditions doivent \xeatre remplies","Or":"Op\xe9rateur logique entre les filtres o\xf9 au moins une (1) condition doit \xeatre vraie","PropertyIsEqualTo":"Identique (sensible \xe0 la case)","PropertyIsNotEqualTo":"Diff\xe9rent (sensible \xe0 la case)","PropertyIsLike":"Comme. Exemple: *route* trouve toutes les valeurs contenent \'route\', peu importe sa position dans l\'attribut. route* trouve toutes les valeurs commencant par \'route\'. Options avanc\xe9es : wildCard =\'*\', singleChar = \'.\' escapeChar = \'!\' (sensible \xe0 la case)","PropertyIsGreaterThan":"Plus grand","PropertyIsGreaterThanOrEqualTo":"Plus grand ou \xe9gal","PropertyIsLessThan":"Plus petit","PropertyIsLessThanOrEqualTo":"Plus petit ou \xe9gal","PropertyIsBetween":"Doit \xeatre contenu entre les limites inf\xe9rieure et sup\xe9rieure (les valeurs sont incluses)","During":"Doit \xeatre contenu entre les p\xe9riodes de temps sp\xe9cifi\xe9es","PropertyIsNull":"Dont l\'attribut est nul","Intersects":"Retourne les entit\xe9s \xe9tant en intersection g\xe9om\xe9trique avec la g\xe9om\xe9trie fournie","Within":"Retourne les entit\xe9s \xe9tant enti\xe8rement contenue par la g\xe9om\xe9trie fournie (Within)","Contains":"Retourne les entit\xe9s compl\xe8tement contenues par la g\xe9om\xe9trie fournie (Contains)"}},"sourceFields":{"selectField":"Choisir un champ"},"filter":{"resetFilters":"R\xe9initialiser les valeurs par d\xe9faut","addFilter":"Ajouter un filtre vide \xe0 la liste courante","removeFilter":"Supprimer le pr\xe9sent filtre \xe0 la liste des filtres","toggleFilterState":"Activer/d\xe9sactiver le pr\xe9sent filtre","refreshFilters":"Mettre \xe0 jour la source de donn\xe9e avec les filtres actifs de la liste. Pour activer ce boutton, la couche doit etre visible (et dans les \xe9chelles permises) ou veillez modifier le pr\xe9sent filtre.","layerFiltered":"Cette couche d\'information est pr\xe9sentement filtr\xe9e.","layerFilterable":"Cette couche d\'information est filtrable","filterBy":"Filtrer par","advancedOgcFilters":"Filtres avanc\xe9s","displayMoreResults":"Afficher plus (+)","displayLessResults":"Afficher moins (-)","placeholder":"Saisir une valeur","placeholderSnrc":"Ex: 21L14","selectOperator":"Choisir un op\xe9rateur","sliderModeTitle":"Curseur temporel","reportingDate":"Date de signalement"},"spatialSelector":{"fixedExtent":"\xc9tendue fixe","btnSetExtent":"D\xe9finir l\'\xe9tendue du filtre selon l\'\xe9tendue courante de la carte","snrc":"SNRC","selectFeature":"","drawFeature":""},"layer":{"hideLayer":"Masquer la couche","hideSelectedLayers":"Masquer les couches s\xe9lectionn\xe9es","lowerLayer":"Mettre en arri\xe8re","filterLowerLayer":"Le d\xe9placement arri\xe8re se fait toujours selon l\'ordre de la carte!","filterPlaceholder":"Filtrer la liste de couches","activateSelectionMode":"Activer le mode de s\xe9lection multiple","deactivateSelectionMode":"D\xe9sactiver le mode de s\xe9lection multiple","tools":"Outils","selectAll":"S\xe9lectionner toutes les couches","deselectAll":"D\xe9s\xe9lectionner toutes les couches","zoomLayer":"Cadrer sur l\'\xe9tendue de la couche","zoomLayers":"Cadrer sur l\'\xe9tendue des couches s\xe9lectionn\xe9es","opacity":"Opacit\xe9","raiseLayer":"Mettre en avant","filterRaiseLayer":"Le d\xe9placement avant se fait toujours selon l\'ordre de la carte!","moreOptions":"Outils de la couche","removeLayer":"Retirer la couche de la carte","removeSelectedLayers":"Retirer les couches s\xe9lectionn\xe9es de la carte","removeSelectedLayersRestriction":"Certaines couches s\xe9lectionn\xe9es ne peuvent \xeatre supprim\xe9es","showFeaturesList":"Afficher la liste des entit\xe9s","showLayer":"Afficher la couche","showSelectedLayers":"Afficher les couches s\xe9lectionn\xe9es","subsetLayersListKeyword":"Limiter l\'affichage de la liste selon le titre ou  par type (wms, wfs,...)","deleteKeyword":"Supprimer le mot-cl\xe9","subsetLayersListOnlyVisible":"Conserver seulement les couches visibles","subsetLayersListOnlyInRange":"Conserver seulement les couches de la plage d\'\xe9chelle active","sortAlphabetically":"Trier la liste des couches en ordre alphab\xe9tique","sortMapOrder":"Replacer les couches selon l\'ordre cartographique","resetLayersList":"R\xe9tablir l\'affichage de l\'ensemble des couches","trackFeature":"Suivre l\'entit\xe9","legend":{"default":"D\xe9faut","loadingLegendText":"Chargement de la l\xe9gende","noLegendText":"Aucune symbologie disponible pour cette couche","noLegendScale":"Aucune symbologie disponible pour cette \xe9chelle","selectStyle":"S\xe9lectionner le style de la l\xe9gende","showAll":"Montrer toutes les couches (non visible et hors \xe9chelle)","noLayersVisibleWithShowAllButton":"Aucune couche actuellement visible. Activez le bouton ci haut pour voir toutes les l\xe9gendes.","noLayersVisibleWithShowAllButtonButZoom":"Aucune couche actuellement visible. Si vous zoomez dans la carte, certaines couches appara\xeetront OU activez le bouton ci haut pour voir toutes les l\xe9gendes.","noLayersVisible":"Aucune couche actuellement visible.","noLayersVisibleButZoom":"Aucune couche actuellement visible. Par contre, si vous zoomez dans la carte, certaines couches appara\xeetront."}},"download":{"action":"T\xe9l\xe9charger les donn\xe9es associ\xe9es","title":"T\xe9l\xe9chargement des donn\xe9es","start":"V\xe9rifiez la progression du t\xe9l\xe9chargement dans votre navigateur","end":"Termin\xe9"},"mapButtons":{"baselayerSwitcher":"Changer le fond de carte","geolocate":"Afficher votre position","home-extent":"Aller \xe0 l\'\xe9tendue de la carte","offline":"Passer en mode hors-ligne","online":"Passer en mode en ligne","zoomIn":"Zoomer ({{zoom}})","zoomOut":"D\xe9zoomer ({{zoom}})","resetRotation":"R\xe9initialiser la carte vers le nord","tipRotation":"Maintenez les touches Alt et Majuscule (shift) tout en cliquant sur la carte pour faire pivoter la carte"},"metadata":{"show":"Montrer les m\xe9tadonn\xe9es"},"printForm":{"corsErrorMessageBody":"Impossible d\'imprimer d\xfb \xe0 des droits d\'acc\xe8s non d\xe9tenus","corsErrorMessageHeader":"Impression","comment":"Commentaire","doZipFile":"Compresser le fichier","outputFormat":"Format de sortie","paperFormat":"Format du papier","paperFormats":{"A0":"33.1 X 46.8\\" (A0)","A1":"23.4 X 33.1\\" (A1)","A2":"16.5 X 23.5\\" (A2)","A3":"11.7 X 16.5\\" (A3)","A4":"8.3 X 11.7\\" (A4)","A5":"5.8 X 8.3\\" (A5)","Letter":"Lettre","Legal":"L\xe9gal"},"imageFormat":"Format de l\'image","orientation":"Orientation","landscape":"Paysage","portrait":"Portrait","projection":"Projection","resolution":"R\xe9solution","saveBtn":"Sauvegarder","scale":"\xc9chelle","showProjection":"Afficher la projection","showScale":"Afficher l\'\xe9chelle","title":"Titre","subtitle":"Sous-titre","legendPosition":"Position de la l\xe9gende","legendPositions":{"none":"Aucune l\xe9gende","topleft":"Coin haut gauche de la carte","topright":"Coin haut droit de la carte","bottomleft":"Coin bas gauche de la carte","bottomright":"Coin bas droit de la carte","newpage":"Sur une nouvelle page"}},"directionsForm":{"stopLayer":"Itin\xe9raire - Arr\xeats","routeLayer":"Itin\xe9raire - Trac\xe9","start":"D\xe9but","intermediate":"Interm\xe9diaire","end":"Fin","directionsBtn":"Obtenir l\'itin\xe9raire","resetDirectionsBtn":"Supprimer l\'itin\xe9raire","zoomRoute":"Zoomer sur l\'itin\xe9raire","null":"","directions":"Itin\xe9raire","raiseStop":"Prioriser l\'arr\xeat","lowerStop":"Reporter l\'arr\xeat plus loin dans le parcours","addStop":"Ajouter un arr\xeat","clearStop":"R\xe9initialiser cet arr\xeat","moveStop":"D\xe9placer cet arr\xeat","removeStop":"Supprimer l\'arr\xeat","drivingOptions":"Choix d\'itin\xe9raires","summary":"R\xe9sum\xe9 de l\'itin\xe9raire","stopsList":"Liste des lieux d\'arr\xeats","instructions":"Indications","copy":"Copier l\'itin\xe9raire","geolocate":"Utiliser sa localisation comme point d\'arr\xeat","link":"Lien","dialog":{"copyMsg":"Itin\xe9raire copi\xe9 dans le presse-papier","copyMsgLink":"Le lien de l\'itin\xe9raire est copi\xe9 dans le presse-papier","copyTitle":"Itin\xe9raire"}},"directions":{"uturn":"demi-tour","sharp right":"fortement \xe0 droite","right":"droite","slight right":"l\xe9g\xe8rement \xe0 droite","sharp left":"fortement \xe0 gauche","left":"gauche","slight left":"l\xe9g\xe8rement \xe0 gauche","straight":"tout droit","turn":{"straight":"Continuer sur {{route}}","uturn":"Faire demi-tour sur {{route}}","else":"Tourner {{aggregatedDirection}} sur {{route}}"},"new name":"Continuer en direction {{translatedDirection}} sur {{route}}","depart":"Aller en direction {{translatedDirection}} sur {{route}}","arrive":{"lastStep":"Vous \xeates arriv\xe9 {{coma}} {{aggregatedDirection}}","intermediate":"Vous atteignez le point interm\xe9diaire sur {{route}}"},"merge":"Continuer sur {{route}}","on ramp":"Prendre l\'entr\xe9e d\'autoroute {{aggregatedDirection}}","off ramp":"Prendre la sortie d\'autoroute {{aggregatedDirection}}","fork":{"left":"Garder la gauche sur {{route}}","right":"Garder la droite sur {{route}}","else":"Continuer sur {{route}}"},"end of road":"\xc0 la fin de la route, tourner {{translatedModifier}} sur {{route}}","use lane":"Prendre la voie de ...","continue":{"notUturn":"Continuer sur {{route}}"},"roundabout":"Au rond-point, prendre la {{exit}}{{cntSuffix}} sortie vers {{route}}","rotary":"Rond-point rotary ...","roundabout turn":"Rond-point, prendre la ...","exit roundabout":"Poursuivre vers {{route}}","notification":"notification ...","uturnText":"Faire demi-tour et continuer en direction {{translatedDirection}} sur {{route}}","unknown":"???","cntSuffix":{"first":"\xe8re","secondAndMore":"e"},"modifier":{"prefix":"\xe0 "}},"cardinalPoints":{"n":"nord","ne":"nord-est","e":"est","se":"sud-est","s":"sud","sw":"sud-ouest","w":"ouest","nw":"nord-ouest"},"search":{"placeholder":"Rechercher une localisation ou une couche de donn\xe9es","emptyType.placeholder":"Veuillez choisir un type de recherche","feature.title":"Localisation","feature.placeholder":"Rechercher une localisation","layer.title":"Couche de donn\xe9es","layer.placeholder":"Rechercher une couche de donn\xe9es.","ichercheReverse.name":"Recherche par coordonn\xe9es","ilayer":{"name":"Couches","properties":{"abstract":"Description","groupTitle":"Groupe","title":"Titre","type":"Type","url":"URL","metadataUrl":"M\xe9tadonn\xe9es","name":"Nom de la couche","urlInfo":"Lien du service web WMS/WFS","downloadUrl":"Lien de t\xe9l\xe9chargement de la donn\xe9es"},"type":{"layer":"Couche","groupLayer":"Groupe de couches"}},"nominatim":{"type":{"food":"Restauration","health":"Sant\xe9","entertainment":"Divertissement","finance":"Finance"},"country":{"all":"Le monde","canada":"Canada"}},"icherche":{"name":"iCherche","type":{"address":"Adresse","oldAddress":"Ancienne adresse","district":"Arrondissement","postalCode":"Code Postal","city":"Municipalit\xe9","oldCity":"Ancienne municipalit\xe9","mrc":"MRC","regadmin":"R\xe9gion administrative","road":"Route","intersection":"Intersection","place":"Lieu","exit":"Sortie d\'autoroute","cn":"Borne du CN","gcc":"Rep\xe8re de la garde coti\xe8re (GCC)","sumi":"Borne SUMI","km":"Rep\xe8re kilom\xe9trique","hq":"Hydro-Qu\xe9bec","entreprise":"Entreprise","cadastre":"Cadastre"},"restrictExtent":{"map":"\xc0 l\'\xe9tendue de la carte","quebec":"Au Qu\xe9bec"}},"coordinates":{"name":"Coordonn\xe9es","coord":"Coordonn\xe9e (longitude, latitude)","coordDMS":"Coordonn\xe9e (longitude, latitude) (DMS)","radius":"Rayon","conf":"Confiance"},"menu.tooltip":"Options de recherche","settings":{"title":"Param\xe8tres"},"pointerSearchSummary":{"title":"Position du curseur","tooltip":"Afficher les coordonn\xe9es du curseur ainsi que d\'autres informations sur sa position en fonction des types de r\xe9sultats activ\xe9es. Utiliser F2 pour activer / d\xe9sactiver."},"searchResultsGeometry":{"title":"Montrer tous les r\xe9sultats","tooltip":"Afficher/cacher la g\xe9om\xe9trie des r\xe9sultats"},"searchSources":{"selectAll":"Tout s\xe9lectionner","unselectAll":"Tout d\xe9s\xe9lectionner","settings":{"results type":"Type de r\xe9sultat","ecmax":"\xc9cart maximal","radius":"Rayon de recherche","results limit":"Nombre de r\xe9sultats","multiple object":"Objet multiple","restrictExtent":"Restreint l\'\xe9tendue","selectAll":"Tout s\xe9lectionner","unselectAll":"Tout d\xe9s\xe9lectionner","true":"Oui","false":"Non"}},"displayMoreResults":"Afficher plus de r\xe9sultats"},"geometry":{"geometry":"Geometrie","point":"Point","line":"Ligne","polygon":"Surface"},"targetHtmlUrl":"Ouvrir le lien externe","searchByCoord":"Rechercher par coordonn\xe9es","searchByName":"Rechercher par nom","seeRouting":"Voir l\'itin\xe9raire","timeFilter":{"date":"Date","endDate":"Date de fin","startDate":"Date de d\xe9but","hour":"Heure","minute":"Minute","endYear":"Ann\xe9e de fin","startYear":"Ann\xe9e de d\xe9but"},"spatialFilter":{"spatialFilter":"Filtre spatial","predefined":"Zone Pr\xe9d\xe9finie","draw":"Dessin","polygon":"Polygone","point":"Cercle","drawPolygon":"Dessiner un polygone","drawCircle":"Dessiner un cercle","searchLabel":"Rechercher par","buffer":"Zone tampon","search":"Recherche","drawControl":"Activer le contr\xf4le de dessin","listLabel":"Zone","entity":"Entit\xe9","layer":"Couche","goSearch":"Lancer la recherche","removeLayer":"Retirer les r\xe9sultats","exportLayer":"Exporter les r\xe9sultats","clearForm":"Retirer le dessin","clearSearch":"R\xe9initialiser","Address":"Adresses","Thematics":"Th\xe9matiques","searchResults":"R\xe9sultats de la recherche","showSearchResults":"Afficher les r\xe9sultats de la recherche","hideSearchResults":"Masquer les r\xe9sultats de la recherche","type":"Type","radius":"Rayon","radiusAlert":"Le rayon doit \xeatre compris entre 0 et 100 kilom\xe8tres (ou 100 000 m\xe8tres)","bufferAlert":"La zone tampon doit \xeatre comprise entre 0 et 100 kilom\xe8tres (ou 100 000 m\xe8tres)","maxSizeAlert":"Le nombre de r\xe9sultats exc\xe8de 10000. Certains pourraient \xeatre manquants.","zeroResults":"Aucun r\xe9sultat ne correspond \xe0 cette recherche.","warning":"Avertissement","freehandControl":"\xc0 main lev\xe9e","group":{"toponyme":"Toponyme","culturel":"Culturel","education":"\xc9ducation","sante":"Sant\xe9","securite":"S\xe9curit\xe9","sepaq":"S\xc9PAQ","transport":"Transport"}},"terrapi":{"AdmRegion":"R\xe9gions administratives","Mun":"Municipalit\xe9s","Arrond":"Arrondissements","CircFed":"Circonscriptions f\xe9d\xe9rales","CircProv":"Circonscriptions provinciales","DirReg":"Directions r\xe9gionales","MRC":"MRC","RegTour":"R\xe9gions touristiques","limites":"Limites administratives","bornes":"Bornes sumi","hydro":"Hydrographie","routes":"Routes","bati":"B\xe2timents","batiment":"B\xe2timents","camping":"Camping","equipement":"\xc9quipements","commun":"Commun","geographie":"Lieux naturels","parc":"Parcs","secteur":"Secteurs","immeubles":"Immeubles patrimoniaux","sites":"Sites patrimoniaux","cpe":"Centre de la petite enfance","public":"\xc9coles publiques","prive":"\xc9coles priv\xe9s","gouvernemental":"\xc9coles gouvernementales","colleges":"Coll\xe8ges","universites":"Universit\xe9s","aine":"R\xe9sidences pour a\xeen\xe9s","ambulance":"Zones d\'ambulance","clinique":"Cliniques","etabl":"\xc9tablissements de sant\xe9","gmf":"Groupes de m\xe9decins de famille","naissance":"Maisons de naissances","pharmacie":"Pharmacies","casernes":"Casernes de pompiers","correctionnel":"Centres correctionnels","organisme":"Organismes de s\xe9curit\xe9","palais-justice":"Palais de justice","penitencier-fed":"P\xe9nitenciers f\xe9d\xe9raux","penitencier-prov":"P\xe9nitenciers provinciaux","polices":"Poste de police"},"measure":{"dialog":{"title":"Sommes de la s\xe9lection","length.title":"Distance","area.title":"Superficie","lengthInMeters":"m","lengthInKilometers":"km","lengthInMiles":"mi","lengthInFeet":"pi","areaInSquareMeters":"m\xb2","areaInSquareKilometers":"km\xb2","areaInSquareMiles":"mi\xb2","areaInHectares":"ha","areaInAcres":"ac","perimeterInMeters":"P\xe9rim\xe8tre en m\xe8tres"},"layerTitle":"Mesure \xe0 la carte","area":"Superficie","areaHeader":"Superficie","length":"Distance","lengthHeader":"Distance / P\xe9rim\xe8tre","perimeter":"P\xe9rim\xe8tre","meters":"m","m":"m","kilometers":"km","km":"km","miles":"mi","mi":"mi","feet":"pi","ft":"pi","squareMeters":"m\xb2","m\xb2":"m\xb2","squareKilometers":"km\xb2","km\xb2":"km\xb2","squareMiles":"mi\xb2","mi\xb2":"mi\xb2","squareFeet":"pi\xb2","ft\xb2":"pi\xb2","hectares":"ha","ha":"ha","acres":"ac","ac":"ac","toggleActive":"Activer le contr\xf4le de mesure","toggleDisplayLines":"Afficher les distances pour les lignes","toggleDisplayDistance":"Afficher les distances pour les superficies","toggleDisplayAreas":"Afficher les superficies","toggleAutoUnits":"Unit\xe9s automatiques","actionbar":{"calculate.tooltip":"Totaux et conversions","delete.tooltip":"Supprimer","modify.tooltip":"Modifier"}},"draw":{"abort":"Annuler le dessin en cours","cancelColorPicker":"Annuler","Circle":"Cercle","colorPicker":"Cliquer pour ouvrir le s\xe9lecteur de couleurs","dialogInstruction":"Veuillez entrer l\'\xe9tiquette de votre dessin","dialogTitle":"\xc9tiquette","delete":"Retirer les dessins de la carte","drawing":"Dessins","fill":"Remplissage","finish":"Terminer le dessin en cours","icon":"Ic\xf4nes","labels":"\xc9tiquettes","LineString":"Ligne","move":"Centrer la vue sur le curseur","noIcon":"Aucune ic\xf4ne","noLabel":"Aucune \xe9tiquette","Point":"Point","Polygon":"Polygone","radius":"Rayon","shortcuts":"Raccourcis clavier","stroke":"Contour","styleSelect":"S\xe9lectionner le style","toggleMapTooltips":"Afficher les \xe9tiquettes","undo":"Retirer le dernier sommet"},"network":{"online":{"message":"En ligne","title":"Statut:"},"offline":{"message":"Hors-Ligne","title":"Statut:"}},"workspace":{"deleteConfirmation":"Voulez-vous vraiment supprimer cette entit\xe9?","addConfirmation":"Voulez-vous vraiment ajouter une entit\xe9?","modifyConfirmation":"Voulez-vous vraiment modifier une entit\xe9?","deleteSuccess":"L\'entit\xe9 a \xe9t\xe9 supprim\xe9e.","addSuccess":"L\'entit\xe9 a \xe9t\xe9 ajout\xe9e.","modifySuccess":"L\'entit\xe9 a \xe9t\xe9 modifi\xe9e.","deleteError":"Un probl\xe8me est survenu. L\'entit\xe9 n\'a pas pu \xeatre supprim\xe9e.","addError":"Un probl\xe8me est survenu. L\'entit\xe9 n\'a pas pu \xeatre ajout\xe9e.","modifyError":"Un probl\xe8me est survenu. L\'entit\xe9 n\'a pas pu \xeatre modifi\xe9e.","cancel":"Annuler","inMapExtent.active.tooltip":"Ne montrer que les enregistrements contenus dans la carte","inMapExtent.inactive.tooltip":"Montrer tous les enregistrements"},"formValidation":{"mandatory":"{{column}}est un champ obligatoire","minValue":"{{column}} doit \xeatre plus grand que {{value}}","maxValue":"{{column}}doit \xeatre plus petit que {{value}}","minLength":"{{column}} doit \xeatre plus long que {{value}} caract\xe8res","maxLength":"{{column}} doit \xeatre plus court que {{value}} caract\xe8res"}},"integration":{"tools":{"catalog":"Catalogue","contexts":"Contextes","directions":"Itin\xe9raire","draw":"Dessin","importExport":"Importer et exporter","ogcFilter":"Filtrer par","map":"Carte","layers":"Couches","legend":"L\xe9gende","measurer":"Mesurer","print":"Imprimer","searchResults":"R\xe9sultats de recherche","shareMap":"Partager","timeFilter":"Filtre temporel","about":"\xc0 propos","spatialFilter":"Filtre spatial","advancedMap":"Outils avanc\xe9s"},"searchResultsTool":{"noResults":"Aucun r\xe9sultat","doSearch":"Veuillez effectuer une recherche dans la barre de recherche ci-dessus.","examples":"<b>Permet de rechercher des adresses, des lieux, des coordonn\xe9es ou des couches</b>.<br><br>Les recherches d\'<u>adresses</u> peuvent \xeatre effectu\xe9es selon une combinaison: <ul><li>du no. immeuble</li><li>du nom de la rue</li><li>de la ville</li><li>du code postal</li></ul> Exemples pour les <u>lieux</u>: <ul><li>Lac Poulin</li><li>Mcdo L\xe9vis</li><li>Saint-Isidore</li></ul> Vous pouvez aussi utiliser des mots cl\xe9s pour pr\xe9ciser votre recherche. Exemples: <ul><li>#mun qu\xe9bec (pour rechercher une municipalit\xe9)</li><li>#sante L\xe9vis (pour rechercher un \xe9tablissement de sant\xe9)</li><li>#cpe joyeux (pour rechercher un centre de la petite enfance)</li><li>#intersection li\xe9gois + \xe9glise (pour rechercher une intersection, le #+ peut aussi \xeatre utilis\xe9)</li></ul>*Les mots cl\xe9s apparaissent au survol d\'un type dans l\'onglet des param\xe8tres de recherche -> iCherche -> Type de r\xe9sultat.<br><br>Exemple pour les <u>coordonn\xe9es</u> :<ul><li>Degr\xe9 d\xe9cimal (-68.165547, 48.644546)</li><li>Degr\xe9 minute seconde (-68 9 56, 48 38 40)</li><li>Degr\xe9 minute d\xe9cimal (-68 9.56, 48 38.40)</li><li>Projet\xe9 (UTM-19 561466.861, 5388278.862)</li><li>BELL (Lat: 48 38 40N Long: 68 9 56W UNC:100 CONF:90)</li><li>Metre Metre (111594.63, 445854.74;32198)</li></ul>Pour plus d\'informations sur la recherche par coordonn\xe9es : <a href=\'https://igo2.readthedocs.io/fr/next/properties.html#coordonnees\' target=\'_blank\'>Consulter la documentation d\'IGO2</a>","zoomOnFeatureTooltip":"Zoomer sur l\'entit\xe9 s\xe9lectionn\xe9e.","zoomOnFeatureTooltipOutOfView":"L\'entit\xe9 est hors de la vue. Zoomer sur l\'entit\xe9 s\xe9lectionn\xe9e."},"aboutTool":{"headerHtml":"","html":"<style>#about .bold_class{font-weight: bold;}#about .red{color: red;}#about .tool_name{border-top: 1px solid; padding-top: 10px;}#about .titre_outil{font-weight: bold; font-size: 18px; padding-bottom: 8px;}#about .subtitle{font-size: 20px; padding-bottom: 10px;}#about .align_right{text-align: right;}#about .describe{text-align: justify;}#about a img{color: black; text-decoration: none;}</style><body> <div id=\'about\'> <div class=\'bold_class subtitle\'>Aper\xe7u des fonctionnalit\xe9s</div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z\'> </path> </svg></mat-icon> Recherche </div><div class=\'describe\'> Situ\xe9e dans la portion sup\xe9rieure gauche de l\u2019interface, la barre de <span class=\'bold_class\'>Recherche</span> permet de se positionner \xe0 l\u2019aide d\u2019une adresse, d\u2019un lieu ou de coordonn\xe9es GPS et peut \xe9galement servir \xe0 rechercher une couche. <br><br> Il est \xe9galement possible de rechercher un \xe9l\xe9ment par type de r\xe9sultats en utilisant le hashtag \xab # \xbb (par exemple, #municipalites qu\xe9bec). Les accents et les lettres majuscules n\'importent pas lors de l\'utilisation du hashtag et n\'ont pas d\'impact sur les <span class=\'bold_class\'>R\xe9sultats de recherche</span>.</div></div><br><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z\'></path> </svg></mat-icon> Contextes </div><div class=\'describe\'> Les <span class=\'bold_class\'>Contextes</span> permettent de visualiser des regroupements de couches faits par th\xe8me ou par contexte de travail. Lorsqu\'un contexte est s\xe9lectionn\xe9, toutes les couches qu\'il contient se retrouvent alors dans la <span class=\'bold_class\'>Carte</span>. Il est possible d\'ajouter d\u2019autres couches \xe0 partir du <span class=\'bold_class\'>Catalogue</span> ou de l\u2019outil <span class=\'bold_class\'>Recherche.</span> </div><br><div class=\'red\'> <span class=\'bold_class\'>ATTENTION :</span> Si un nouveau contexte est s\xe9lectionn\xe9, toutes les couches affich\xe9es dans la <span class=\'bold_class\'>Carte</span> seront remplac\xe9es par celles de ce nouveau contexte. </div><br><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M15,19L9,16.89V5L15,7.11M20.5,3C20.44,3 20.39,3 20.34,3L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21C3.55,21 3.61,21 3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3Z\'> </path> </svg></mat-icon> Carte </div><div class=\'describe\'> Il est possible de personnaliser la <span class=\'bold_class\'>Carte</span> \xe0 partir du <span class=\'bold_class\'>Catalogue</span> ou de l\u2019outil <span class=\'bold_class\'>Recherche.</span> Cet espace permet entre autres d\u2019ajouter, de supprimer, d\u2019interroger, de filtrer et de trier les couches pr\xe9sent\xe9es. Il est \xe9galement possible d\'afficher les l\xe9gendes des couches.</div><br></div><div class=\'tool_name\'><div class=\'titre_outil\'><mat-icon class=\'mat-icon\'><svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'><path d=\'M2 4C2 2.89 2.9 2 4 2H7V4H4V7H2V4M22 4V7H20V4H17V2H20C21.1 2 22 2.89 22 4M2 20V17H4V20H7V22H4C2.9 22 2 21.11 2 20M10 2H14V4H10V2M10 20H14V22H10V20M2 10H4V14H2V10M18.5 13C20.4 13 22 14.6 22 16.5C22 19.1 18.5 23 18.5 23C18.5 23 15 19.1 15 16.5C15 14.6 16.6 13 18.5 13M18.5 17.8C19.2 17.8 19.8 17.2 19.7 16.6C19.7 16 19.1 15.4 18.5 15.4C17.9 15.4 17.3 15.9 17.3 16.6C17.3 17.2 17.8 17.8 18.5 17.8M20 10H22V12.34C21.42 11.84 20.74 11.45 20 11.23V10Z\'></path></svg></mat-icon> Filtre spatial </div><div class=\'describe\'> Le <span class=\'bold_class\'>Filtre spatial</span> permet de rechercher des adresses ou des th\xe9matiques selon des zones pr\xe9d\xe9finies (par exemple, par arrondissement ou par MRC) ou selon un dessin r\xe9alis\xe9 par l\'utilisateur. Les r\xe9sultats du filtre peuvent \xeatre export\xe9s \xe0 l\'aide de l\'outil <span class=\'bold_class\'>Importer et exporter</span>. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M1.39,18.36L3.16,16.6L4.58,18L5.64,16.95L4.22,15.54L5.64,14.12L8.11,16.6L9.17,15.54L6.7,13.06L8.11,11.65L9.53,13.06L10.59,12L9.17,10.59L10.59,9.17L13.06,11.65L14.12,10.59L11.65,8.11L13.06,6.7L14.47,8.11L15.54,7.05L14.12,5.64L15.54,4.22L18,6.7L19.07,5.64L16.6,3.16L18.36,1.39L22.61,5.64L5.64,22.61L1.39,18.36Z\'> </path> </svg></mat-icon> Mesurer </div><div class=\'describe\'> Cet outil permet de <span class=\'bold_class\'>Mesurer</span> des distances ou des superficies directement sur la carte. </div><br></div><div class=\'tool_name\'><div class=\'titre_outil\'><mat-icon class=\'mat-icon\'><svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'><path d=\'M9.75 20.85C11.53 20.15 11.14 18.22 10.24 17C9.35 15.75 8.12 14.89 6.88 14.06C6 13.5 5.19 12.8 4.54 12C4.26 11.67 3.69 11.06 4.27 10.94C4.86 10.82 5.88 11.4 6.4 11.62C7.31 12 8.21 12.44 9.05 12.96L10.06 11.26C8.5 10.23 6.5 9.32 4.64 9.05C3.58 8.89 2.46 9.11 2.1 10.26C1.78 11.25 2.29 12.25 2.87 13.03C4.24 14.86 6.37 15.74 7.96 17.32C8.3 17.65 8.71 18.04 8.91 18.5C9.12 18.94 9.07 18.97 8.6 18.97C7.36 18.97 5.81 18 4.8 17.36L3.79 19.06C5.32 20 7.88 21.47 9.75 20.85M20.84 5.25C21.06 5.03 21.06 4.67 20.84 4.46L19.54 3.16C19.33 2.95 18.97 2.95 18.76 3.16L17.74 4.18L19.82 6.26M11 10.92V13H13.08L19.23 6.85L17.15 4.77L11 10.92Z\'></path></svg></mat-icon> Dessin </div><div class=\'describe\'> L\'outil <span class=\'bold_class\'>Dessin</span> permet de dessiner des entit\xe9s ponctuelles, lin\xe9aires, polygonales ou circulaires accompagn\xe9es ou non d\'\xe9tiquettes. La couleur de remplissage et du contour des entit\xe9s peuvent \xeatre choisies \xe0 l\'aide des s\xe9lecteurs correspondants. <br><br> Une couche Dessins peut \xeatre export\xe9e \xe0 l\'aide de l\'outil <span class=\'bold_class\'>Importer et exporter</span>. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M14,14.5V12H10V15H8V11A1,1 0 0,1 9,10H14V7.5L17.5,11M21.71,11.29L12.71,2.29H12.7C12.31,1.9 11.68,1.9 11.29,2.29L2.29,11.29C1.9,11.68 1.9,12.32 2.29,12.71L11.29,21.71C11.68,22.09 12.31,22.1 12.71,21.71L21.71,12.71C22.1,12.32 22.1,11.68 21.71,11.29Z\'> </path> </svg></mat-icon> Itin\xe9raire </div><div class=\'describe\'> Il est possible de construire un <span class=\'bold_class\'>Itin\xe9raire</span> entre deux points en s\xe9lectionnant un point de d\xe9part et un point d\'arriv\xe9e dans la carte ou en recherchant des adresses. Il est ensuite possible d\'ajouter des points d\'arr\xeat interm\xe9diaires et de copier la description ou le lien de l\'itin\xe9raire dans le presse-papier. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M17,14H19V17H22V19H19V22H17V19H14V17H17V14M11,16L2,9L11,2L20,9L11,16M11,18.54L12,17.75V18C12,18.71 12.12,19.39 12.35,20L11,21.07L2,14.07L3.62,12.81L11,18.54Z\'></path> </svg></mat-icon> Catalogue </div><div class=\'describe\'> Le <span class=\'bold_class\'>Catalogue</span> contient toutes les couches qui peuvent \xeatre ajout\xe9es \xe0 la <span class=\'bold_class\'>Carte</span>. L\'utilisateur doit cliquer sur + de la couche d\xe9sir\xe9e afin de l\u2019ajouter \xe0 la <span class=\'bold_class\'>Carte</span>. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M14,17H18V14L23,18.5L18,23V20H14V17M13,9H18.5L13,3.5V9M6,2H14L20,8V12.34C19.37,12.12 18.7,12 18,12A6,6 0 0,0 12,18C12,19.54 12.58,20.94 13.53,22H6C4.89,22 4,21.1 4,20V4A2,2 0 0,1 6,2Z\'></path> </svg></mat-icon> Importer et exporter </div><div class=\'describe\'> Il est possible d\'<span class=\'bold_class\'>Importer</span> un fichier vectoriel tout en sp\xe9cifiant un syst\xe8me de coordonn\xe9es ou une projection. <br><br> Il est possible d\'<span class=\'bold_class\'>Exporter</span> une ou plusieurs couches dans plusieurs formats courants. <br><br> Il est \xe9galement possible d\'<span class=\'bold_class\'>Importer</span> ou d\'<span class=\'bold_class\'>Exporter</span> un contexte localement. Cette derni\xe8re fonctionnalit\xe9 permet ainsi de sauvegarder des contextes en mode non-authentifi\xe9 ou anonyme. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z\'></path> </svg></mat-icon> Imprimer </div><div class=\'describe\'> Cet outil permet d\'<span class=\'bold_class\'>Imprimer</span> la carte affich\xe9e \xe0 l\u2019\xe9cran en sp\xe9cifiant plusieurs options telles qu\'un titre, un commentaire, le format de sortie, le format du papier et l\'orientation de l\'impression. </div><br></div><div class=\'tool_name\'> <div class=\'titre_outil\'> <mat-icon class=\'mat-icon\'> <svg viewBox=\'0 0 24 24\' fit=\'\' height=\'100%\' width=\'100%\' preserveAspectRatio=\'xMidYMid meet\' focusable=\'false\'> <path d=\'M18,16.08C17.24,16.08 16.56,16.38 16.04,16.85L8.91,12.7C8.96,12.47 9,12.24 9,12C9,11.76 8.96,11.53 8.91,11.3L15.96,7.19C16.5,7.69 17.21,8 18,8A3,3 0 0,0 21,5A3,3 0 0,0 18,2A3,3 0 0,0 15,5C15,5.24 15.04,5.47 15.09,5.7L8.04,9.81C7.5,9.31 6.79,9 6,9A3,3 0 0,0 3,12A3,3 0 0,0 6,15C6.79,15 7.5,14.69 8.04,14.19L15.16,18.34C15.11,18.55 15.08,18.77 15.08,19C15.08,20.61 16.39,21.91 18,21.91C19.61,21.91 20.92,20.61 20.92,19A2.92,2.92 0 0,0 18,16.08Z\'> </path> </svg></mat-icon> Partager </div><div class=\'describe\'> L\'outil <span class=\'bold_class\'>Partager</span> permet de cr\xe9er une adresse URL qui redirige vers une repr\xe9sentation exacte de la <span class=\'bold_class\'>Carte</span> affich\xe9e \xe0 l\u2019\xe9cran. Ce lien peut, par exemple, \xeatre partag\xe9 ou diffus\xe9 dans un document, permettant ainsi de \xab&nbspsauvegarder \xbb la carte pour une utilisation ult\xe9rieure. </div><br></div><div class=\'tool_name\'> <p> <a href=\'http://igouverte.org/\' target=\'_blank\'><img src=\'./assets/igo2/core/logo.png\' alt=\'IGO\' height=32>IGO2</a> est une solution Web libre g\xe9omatique d\xe9velopp\xe9e en mode collaboratif par des sp\xe9cialistes provenant de plusieurs minist\xe8res et organismes du gouvernement du Qu\xe9bec.</p><p>Version: {{version.lib}}</p></div>","trainingGuide":"Guide de formation","trainingGuideTooltip":"Cliquez ici pour acc\xe9der au guide d\'autoformation de IGO2"},"mapTool":{"empty":"La carte ne contient aucune couche de donn\xe9es.","customize":"Personnalisez-l\xe0 en ajoutant des couches \xe0 partir des outils suivants : ","search-tool":"Recherche","catalog-tool":"Catalogue de donn\xe9es","context-tool":"Gestionnaire de contextes","noLayersVisible":"Aucune couche visible.","noLayersInRange":"Aucune couche visible dans la plage d\'\xe9chelle active. Veuillez zoomer ou d\xe9zoomer pour d\xe9couvrir ces couches."},"importExportTool":{"importExportData":"Couche","importExportContext":"Contexte"},"workspace":{"toggleWorkspace":"Ouvrir/fermer la vue tabulaire","ogcFilter.close":"Fermer","ogcFilter.title":"Filtres","ogcFilter.tooltip":"Appliquer des filtres sur la couche","download.title":"T\xe9l\xe9charger les donn\xe9es associ\xe9es","download.tooltip":"T\xe9l\xe9charger les donn\xe9es associ\xe9es","inMapExtent.title":"Montrer les entit\xe9s contenues dans la carte","inMapExtent.active.tooltip":"Montrer les entit\xe9s contenues dans la carte","inMapExtent.inactive.tooltip":"Montrer toutes les entit\xe9s","zoomAuto.title":"Zoom auto","zoomAuto.tooltip":"Zoom auto","selected.title":"Montrer les entit\xe9s s\xe9lectionn\xe9es","selected.tooltip":"Montrer les entit\xe9s s\xe9lectionn\xe9es","clearSelection.title":"Tout d\xe9s\xe9lectionner","clearSelection.tooltip":"D\xe9s\xe9lectionner les enregistrements s\xe9lectionn\xe9s","maximize":"Agrandir","maximizeTooltip":"Agrandir la fen\xeatre","standardExtent":"R\xe9duire","standardExtentTooltip":"R\xe9duire la fen\xeatre"},"directions":{"warning":{"title":"Avertissement","message":"L\'itin\xe9raire propos\xe9 dans cet outil ne tient pas compte des conditions routi\xe8res actuelles, de la congestion routi\xe8re, des entraves pr\xe9sente sur le r\xe9seau et des horaires de traversiers (ouverture quotidienne et saisonni\xe8re)."}},"advanced-map-tool":{"advanced-swipe":{"swipe-select":"Choisir les couches \xe0 comparer","selectAll":"Tout s\xe9lectionner","empty":"La carte ne contient aucune couche de donn\xe9es.","customize":"Personnalisez-l\xe0 en ajoutant des couches \xe0 partir des outils suivants : ","search-tool":"Recherche","catalog-tool":"Catalogue de donn\xe9es","context-tool":"Gestionnaire de contextes","swipe":"Activer","swipe-tool":"Outil de comparaison"},"advanced-coordinates":{"copy":"Copier","lon":"Longitude","lat":"Latitude","nord":"Nord","est":"Est","coordinates":"Coordonn\xe9es du centre de la carte","copyMsg":"Coordonn\xe9es copi\xe9es","copyTitle":"Coordonn\xe9es du centre","center":"Centre","coordSystem":"Syst\xe8me de coordonn\xe9es","zoom":"Niveau de zoom courant: ","scale":"\xc9chelle cartographique: ","resolution":"R\xe9solution cartographique: "}}}}}')}},function(e){e.O(0,[736],function(){return e(e.s=88214)}),e.O()}])}();
//# sourceMappingURL=main-es5.a5d50b91fe5ad54e00fd.js.map